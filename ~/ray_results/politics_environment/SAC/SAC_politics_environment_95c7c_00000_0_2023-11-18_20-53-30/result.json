{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 896, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2688, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2688, "num_agent_steps_trained": 0, "num_env_steps_sampled": 896, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 689.5396118237414, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 896, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2688, "timers": {"training_iteration_time_ms": 1299.392, "sample_time_ms": 695.644}, "counters": {"num_env_steps_sampled": 896, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2688, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 1, "trial_id": "95c7c_00000", "date": "2023-11-18_20-53-40", "timestamp": 1700369620, "time_this_iter_s": 1.3020479679107666, "time_total_s": 1.3020479679107666, "pid": 5649, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16bd42660>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 1.3020479679107666, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 46.9, "ram_util_percent": 65.55}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.050556182861328, "actor_loss": -4.049216270446777, "critic_loss": 4.295738220214844, "alpha_loss": 0.0, "alpha_value": 1.0, "log_alpha_value": 0.0, "target_entropy": -6.0, "policy_t": -0.006508339196443558, "mean_q": 0.0015679469797760248, "max_q": 0.054749708622694016, "min_q": -0.00023859497741796076}, "td_error": [7.340012550354004, 5.712408065795898, 3.764486312866211, 5.105151176452637, 5.447477340698242, 5.533641815185547, 3.3840999603271484, 3.767378568649292, 5.201617240905762, 5.424076080322266, 4.79489803314209, 5.225550651550293, 5.529343128204346, 3.2487738132476807, 3.159298896789551, 6.4748430252075195, 5.108455657958984, 6.734471797943115, 5.933239936828613, 4.589761734008789, 4.188896179199219, 3.853435754776001, 5.346311569213867, 4.085625648498535, 4.003632068634033, 3.858346939086914, 6.580499649047852, 5.463837623596191, 5.881504535675049, 5.646738529205322, 4.166234016418457, 4.027527809143066, 3.8199520111083984, 5.899088382720947, 5.352118492126465, 4.31828498840332, 4.315094947814941, 6.008605480194092, 6.295197486877441, 5.30904483795166, 5.162444114685059, 4.807470798492432, 4.862522125244141, 5.221161842346191, 4.007434844970703, 3.6518445014953613, 6.072458267211914, 5.844212055206299, 5.73348331451416, 4.375730514526367, 2.7441632747650146, 4.613483428955078, 3.2470333576202393, 4.1141357421875, 4.926604270935059, 6.591375350952148, 4.335023880004883, 4.020247936248779, 3.305075168609619, 6.787117958068848, 6.60225772857666, 1.888872504234314, 5.419342994689941, 5.251281261444092, 4.452606678009033, 5.212900638580322, 3.2730469703674316, 5.4273176193237305, 5.523350715637207, 3.9101991653442383, 4.659411430358887, 2.4689106941223145, 5.140852928161621, 5.0593461990356445, 2.92880916595459, 4.28302526473999, 5.606278419494629, 4.728400230407715, 3.8372039794921875, 6.068756103515625, 6.172847270965576, 3.7518439292907715, 2.629395008087158, 4.95003604888916, 5.655725479125977, 3.2094979286193848], "mean_td_error": 4.795738220214844, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1.0, "diff_num_grad_updates_vs_sampler_policy": 0.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.952093124389648, "actor_loss": -3.9495608806610107, "critic_loss": 2.223104953765869, "alpha_loss": 0.0, "alpha_value": 1.0, "log_alpha_value": 0.0, "target_entropy": -6.0, "policy_t": 0.05893339216709137, "mean_q": -0.0021473541855812073, "max_q": -0.0015656991163268685, "min_q": -0.015103597193956375}, "td_error": [1.643784523010254, 2.4242782592773438, 4.105737686157227, 2.8081538677215576, 2.996608018875122, 0.8909066319465637, 0.9536978006362915, 0.9523332118988037, 1.365862488746643, 3.162566900253296, 0.18665575981140137, 1.9711642265319824, 1.3049626350402832, 3.0751214027404785, 1.0428032875061035, 4.008161544799805, 2.2675938606262207, 3.9290223121643066, 3.200545310974121, 2.7120110988616943, 4.172676086425781, 2.6827940940856934, 2.4708447456359863, 2.8731892108917236, 6.769059181213379, 2.628754138946533, 0.35931533575057983, 2.917217254638672, 2.9687931537628174, 1.3246746063232422, 6.048587799072266, 4.901349067687988, 2.8598175048828125, 4.177565574645996, 3.8357949256896973, 2.369637966156006, 1.4331623315811157, 2.2090847492218018, 3.617330551147461, 3.4953231811523438, 1.4597350358963013, 1.233217716217041, 3.721177577972412, 3.4247331619262695, 5.325876235961914, 2.0300276279449463, 3.9457807540893555, 3.3553519248962402, 2.917471408843994, 4.240796089172363, 3.0174808502197266, 1.419292688369751, 4.796690464019775, 1.2012304067611694, 2.73466157913208, 1.635277271270752, 1.252683401107788, 3.3607943058013916, 2.5134072303771973, 2.4398369789123535, 2.7361550331115723, 3.4522156715393066, 4.734851360321045, 1.5704057216644287, 2.317351818084717, 3.907602548599243, 3.7818057537078857, 2.362098217010498, 3.4183855056762695, 2.255303382873535, 5.151176452636719, 0.2683470845222473, 4.0594868659973145, 0.29828327894210815, 1.8905102014541626, 2.1054203510284424, 2.0493006706237793, 3.7292165756225586, 2.971254348754883, 1.896157145500183, 1.7386060953140259, 2.4033596515655518, 0.5697134733200073, 2.133549213409424, 3.7515625953674316, 2.3418521881103516], "mean_td_error": 2.709726095199585, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1.0, "diff_num_grad_updates_vs_sampler_policy": 0.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.966870307922363, "actor_loss": -3.966198205947876, "critic_loss": 2.1695287227630615, "alpha_loss": 0.0, "alpha_value": 1.0, "log_alpha_value": 0.0, "target_entropy": -6.0, "policy_t": -0.022184856235980988, "mean_q": -0.0020744784269481897, "max_q": 0.002645751228556037, "min_q": -0.05999085307121277}, "td_error": [1.8074028491973877, 3.129115581512451, 0.8777416944503784, 1.979438304901123, 0.5021651983261108, 1.2776503562927246, 1.8661181926727295, 0.6667567491531372, 3.473886013031006, 0.8351523876190186, 1.3983967304229736, 1.7047207355499268, 4.286552906036377, 3.993088722229004, 3.4569315910339355, 4.254189491271973, 3.0405025482177734, 1.836533784866333, 1.199310302734375, 3.6319823265075684, 3.1276001930236816, 2.279632568359375, 1.3546602725982666, 0.9970351457595825, 2.133187770843506, 2.9755592346191406, 1.6655752658843994, 3.284101963043213, 0.7915993332862854, 1.7582817077636719, 3.903496503829956, 2.95188045501709, 1.8060457706451416, 3.0822978019714355, 4.132303237915039, 4.027104377746582, 2.876434326171875, 2.4507923126220703, 3.106393814086914, 2.9664146900177, 3.619170665740967, 3.0982913970947266, 1.6328539848327637, 1.8837312459945679, 1.860628366470337, 3.662503242492676, 3.042719841003418, 2.0637598037719727, 2.745237350463867, 2.2044973373413086, 3.498445987701416, 3.197021484375, 2.616006851196289, 0.894043505191803, 2.1030967235565186, 3.030012845993042, 4.541218280792236, 3.150398015975952, 4.987864971160889, 3.285818338394165, 2.5110912322998047, 2.958361864089966, 2.52492618560791, 2.48494553565979, 3.1615965366363525, 2.4859089851379395, 3.2387685775756836, 2.8463783264160156, 3.1704955101013184, 3.456075668334961, 1.7109813690185547, 4.7591400146484375, 3.2327170372009277, 3.211747169494629, 2.824131488800049, 2.1560356616973877, 2.8366870880126953, 1.8919391632080078, 2.8353075981140137, 2.3538503646850586, 3.7030861377716064, 2.0744566917419434, 3.4447779655456543, 1.9477988481521606, 3.6809725761413574, 3.8436803817749023], "mean_td_error": 2.666874647140503, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1.0, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 1792, "num_env_steps_trained": 258, "num_agent_steps_sampled": 5376, "num_agent_steps_trained": 258, "last_target_update_ts": 1792, "num_target_updates": 1}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5376, "num_agent_steps_trained": 258, "num_env_steps_sampled": 1792, "num_env_steps_trained": 258, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 862.1678132883311, "num_env_steps_trained_throughput_per_sec": 248.25814266561318, "timesteps_total": 1792, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 5376, "timers": {"training_iteration_time_ms": 1169.307, "sample_time_ms": 723.174, "load_time_ms": 0.322, "load_throughput": 801578.098, "learn_time_ms": 41.149, "learn_throughput": 6269.912, "synch_weights_time_ms": 10.921}, "counters": {"num_env_steps_sampled": 1792, "num_env_steps_trained": 258, "num_agent_steps_sampled": 5376, "num_agent_steps_trained": 258, "last_target_update_ts": 1792, "num_target_updates": 1}, "done": false, "episodes_total": 0, "training_iteration": 2, "trial_id": "95c7c_00000", "date": "2023-11-18_20-53-42", "timestamp": 1700369622, "time_this_iter_s": 1.049185037612915, "time_total_s": 2.3512330055236816, "pid": 5649, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16bd43a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 2.3512330055236816, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 59.400000000000006, "ram_util_percent": 65.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.985047340393066, "actor_loss": -4.00895881652832, "critic_loss": 3.9534459114074707, "alpha_loss": -0.00599153246730566, "alpha_value": 0.9994001388549805, "log_alpha_value": -0.0006000504363328218, "target_entropy": -6.0, "policy_t": 0.00380098563618958, "mean_q": 0.0426359660923481, "max_q": 0.44750210642814636, "min_q": 0.021621014922857285}, "td_error": [4.517636299133301, 5.113367080688477, 5.63917350769043, 4.967158794403076, 5.861229419708252, 6.974740505218506, 3.0765466690063477, 5.093749046325684, 4.713927268981934, 3.8176989555358887, 5.041952610015869, 4.576066017150879, 4.444131851196289, 4.578768253326416, 3.0859615802764893, 2.3317997455596924, 3.5791773796081543, 4.576860427856445, 3.9005258083343506, 5.529699325561523, 4.641419410705566, 4.5118489265441895, 2.7899277210235596, 4.107891082763672, 5.1437668800354, 4.142436981201172, 5.589413642883301, 4.590275764465332, 4.73922061920166, 4.373152732849121, 4.450005531311035, 6.098840713500977, 4.381793022155762, 3.7954554557800293, 3.5377988815307617, 3.3350954055786133, 5.051867961883545, 5.868770599365234, 3.330319881439209, 4.90753173828125, 3.397693395614624, 3.1363399028778076, 3.9715752601623535, 4.25443696975708, 3.769035816192627, 5.3253278732299805, 6.056270599365234, 2.762026309967041, 6.092676639556885, 6.970909118652344, 5.339375972747803, 4.638517379760742, 3.87387752532959, 2.710951328277588, 4.0844621658325195, 4.848592758178711, 4.5289506912231445, 6.407395839691162, 4.985955238342285, 4.369585990905762, 4.8037261962890625, 3.6063568592071533, 5.361400127410889, 1.1571433544158936, 4.839944839477539, 4.751069068908691, 7.031105995178223, 5.648859977722168, 6.801854133605957, 4.958979606628418, 4.072065353393555, 2.222527027130127, 4.934534072875977, 4.841370105743408, 5.4947404861450195, 5.407613754272461, 5.644719123840332, 2.2435390949249268, 3.68110728263855, 4.13004207611084, 3.2788705825805664, 4.0862884521484375, 4.188798904418945, 3.1575331687927246, 5.8046369552612305, 4.583885192871094], "mean_td_error": 4.523996353149414, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 3.0, "diff_num_grad_updates_vs_sampler_policy": 2.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.042634010314941, "actor_loss": -4.061981201171875, "critic_loss": 0.9739824533462524, "alpha_loss": -0.006026221439242363, "alpha_value": 0.9994001388549805, "log_alpha_value": -0.0006000638240948319, "target_entropy": -6.0, "policy_t": 0.020736686885356903, "mean_q": 0.026911213994026184, "max_q": 0.19672232866287231, "min_q": 0.016982074826955795}, "td_error": [4.067657470703125, 0.9589002728462219, 4.006752967834473, 1.5842113494873047, 2.3964624404907227, 1.293016791343689, 3.5685970783233643, 1.5874736309051514, 1.1773364543914795, 3.078423500061035, 0.39326584339141846, 1.7186667919158936, 1.173931360244751, 3.374478340148926, 3.6320385932922363, 2.6089999675750732, 1.9913363456726074, 3.749295949935913, 1.3399629592895508, 2.5305020809173584, 1.9732120037078857, 2.334585666656494, 1.9741424322128296, 1.0239529609680176, 2.6210732460021973, 1.441561222076416, 2.9276978969573975, 1.4279358386993408, 2.5618808269500732, 1.6030588150024414, 2.480989456176758, 2.9704627990722656, 2.0791139602661133, 3.056225299835205, 1.4858760833740234, 3.2686758041381836, 2.2383036613464355, 1.909027099609375, 1.1401883363723755, 4.387284278869629, 2.437530994415283, 2.6179797649383545, 2.444838285446167, 0.9717369079589844, 2.5059924125671387, 4.116625785827637, 3.01568603515625, 3.2821736335754395, 2.4523215293884277, 1.8647167682647705, 1.3446435928344727, 1.5503337383270264, 2.8511767387390137, 3.440861701965332, 3.0478105545043945, 2.2803945541381836, 4.552438259124756, 1.886117935180664, 1.9762797355651855, 3.9625892639160156, 3.163076877593994, 3.0605955123901367, 1.886935830116272, 3.5590929985046387, 3.0496606826782227, 2.455465793609619, 3.548841953277588, 3.4376230239868164, 2.294635772705078, 3.9083824157714844, 2.611823558807373, 2.6292271614074707, 2.9285342693328857, 4.001641750335693, 2.33223557472229, 2.142519474029541, 3.3327219486236572, 3.3617022037506104, 1.9147732257843018, 1.101142406463623, 1.8536286354064941, 4.062017917633057, 1.6352174282073975, 0.6999320983886719, 3.6856517791748047, 1.643235683441162], "mean_td_error": 2.4888269901275635, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 3.0, "diff_num_grad_updates_vs_sampler_policy": 2.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.06477165222168, "actor_loss": -4.089915752410889, "critic_loss": 1.3850631713867188, "alpha_loss": -0.0060389055870473385, "alpha_value": 0.9994001984596252, "log_alpha_value": -0.0006000042194500566, "target_entropy": -6.0, "policy_t": 0.013718039728701115, "mean_q": 0.031112676486372948, "max_q": 0.23058158159255981, "min_q": 0.026332583278417587}, "td_error": [1.156700849533081, 2.092895030975342, 3.3476505279541016, 1.4776523113250732, 2.9465510845184326, 2.4497780799865723, 3.8007640838623047, 3.129168748855591, 1.7453116178512573, 4.318395614624023, 3.4758005142211914, 2.071981191635132, 1.8803513050079346, 3.040529251098633, 2.9749441146850586, 2.7818074226379395, 1.4895551204681396, 3.356635093688965, 3.1466846466064453, 1.7982395887374878, 2.149013042449951, 3.600961923599243, 2.7274179458618164, 3.626446008682251, 3.2093281745910645, 2.761056900024414, 1.873667597770691, 1.7803449630737305, 2.0600063800811768, 3.7328391075134277, 3.4879331588745117, 2.8823020458221436, 2.0116477012634277, 3.0672240257263184, 1.7834184169769287, 2.614820957183838, 2.6749267578125, 2.7744669914245605, 3.4468960762023926, 2.141150951385498, 3.622042655944824, 2.7211360931396484, 2.445096492767334, 2.0827174186706543, 2.314505100250244, 3.498983144760132, 2.445629596710205, 2.878432273864746, 3.371048927307129, 2.047248125076294, 3.071549415588379, 3.95340895652771, 3.9038052558898926, 2.937448024749756, 2.4370439052581787, 0.4940037131309509, 3.1751279830932617, 2.557450294494629, 3.524710178375244, 1.6230552196502686, 2.927919864654541, 2.0608949661254883, 1.8721768856048584, 3.503553867340088, 3.9277119636535645, 1.7726428508758545, 1.8263201713562012, 3.7027831077575684, 1.7634449005126953, 2.1290791034698486, 3.4347634315490723, 2.4646215438842773, 1.0189398527145386, 2.533677339553833, 1.3794918060302734, 2.4903390407562256, 4.123867988586426, 1.0093166828155518, 1.7177226543426514, 3.8000802993774414, 3.5681796073913574, 1.6267716884613037, 1.767505407333374, 2.564746856689453, 2.4476258754730225, 2.064131736755371], "mean_td_error": 2.6219770908355713, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 3.0, "diff_num_grad_updates_vs_sampler_policy": 2.0}}, "num_env_steps_sampled": 3584, "num_env_steps_trained": 774, "num_agent_steps_sampled": 10752, "num_agent_steps_trained": 774, "last_target_update_ts": 3584, "num_target_updates": 3}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10752, "num_agent_steps_trained": 774, "num_env_steps_sampled": 3584, "num_env_steps_trained": 774, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 893.503526728218, "num_env_steps_trained_throughput_per_sec": 257.28114943736637, "timesteps_total": 3584, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 10752, "timers": {"training_iteration_time_ms": 1086.029, "sample_time_ms": 694.136, "load_time_ms": 0.322, "load_throughput": 801380.226, "learn_time_ms": 26.39, "learn_throughput": 9776.579, "synch_weights_time_ms": 10.708}, "counters": {"num_env_steps_sampled": 3584, "num_env_steps_trained": 774, "num_agent_steps_sampled": 10752, "num_agent_steps_trained": 774, "last_target_update_ts": 3584, "num_target_updates": 3}, "done": false, "episodes_total": 0, "training_iteration": 3, "trial_id": "95c7c_00000", "date": "2023-11-18_20-53-44", "timestamp": 1700369624, "time_this_iter_s": 2.0160131454467773, "time_total_s": 4.367246150970459, "pid": 5649, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16bd437e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 4.367246150970459, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 65.2, "ram_util_percent": 65.96666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.128864288330078, "actor_loss": -4.164239406585693, "critic_loss": 4.132668495178223, "alpha_loss": -0.009115719236433506, "alpha_value": 0.9991004467010498, "log_alpha_value": -0.0008999745477922261, "target_entropy": -6.0, "policy_t": -0.027543604373931885, "mean_q": 0.08346480131149292, "max_q": 0.6522296071052551, "min_q": 0.03324706852436066}, "td_error": [3.8109169006347656, 4.990566253662109, 4.763097763061523, 5.592411994934082, 6.144526958465576, 4.376034736633301, 5.932669639587402, 5.80982780456543, 5.227931022644043, 5.659068584442139, 4.579143524169922, 5.279306411743164, 5.153692245483398, 3.6571199893951416, 4.492885112762451, 4.696261405944824, 5.532536506652832, 5.821569442749023, 5.649796485900879, 3.178945541381836, 4.5784759521484375, 4.752803802490234, 3.054565906524658, 6.214970588684082, 5.247183322906494, 6.869035243988037, 5.440986633300781, 5.987967491149902, 4.8937835693359375, 4.494403839111328, 5.312856674194336, 3.9353904724121094, 4.078107833862305, 3.706890106201172, 4.200689315795898, 4.281994819641113, 3.3382012844085693, 4.129950523376465, 5.97505521774292, 6.736772537231445, 6.396981716156006, 4.355217456817627, 4.796520709991455, 5.7630109786987305, 4.247549057006836, 5.948390483856201, 6.699300765991211, 6.170544624328613, 5.1738104820251465, 3.5421738624572754, 5.207155227661133, 2.981595039367676, 5.67600679397583, 5.811404228210449, 4.840160846710205, 3.975641965866089, 5.557775497436523, 3.8917880058288574, 3.787558078765869, 6.018083572387695, 2.703977346420288, 4.244576930999756, 3.782836437225342, 4.347476959228516, 4.355775833129883, 3.769066333770752, 6.006321907043457, 2.53229022026062, 4.55598783493042, 4.489795684814453, 5.760045528411865, 6.166419982910156, 3.9898695945739746, 3.1757194995880127, 6.366813659667969, 5.790097236633301, 5.923259735107422, 5.521949291229248, 4.403770446777344, 5.636551380157471, 5.718451023101807, 5.558108329772949, 6.140859603881836, 6.230140686035156, 2.494015693664551, 2.3810312747955322], "mean_td_error": 4.8891191482543945, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 4.0, "diff_num_grad_updates_vs_sampler_policy": 3.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.089449882507324, "actor_loss": -4.11860466003418, "critic_loss": 1.1350133419036865, "alpha_loss": -0.009082059375941753, "alpha_value": 0.9991002678871155, "log_alpha_value": -0.0009001540020108223, "target_entropy": -6.0, "policy_t": -0.009610517881810665, "mean_q": 0.0520392470061779, "max_q": 0.36840787529945374, "min_q": 0.026363100856542587}, "td_error": [2.6496942043304443, 3.2358951568603516, 5.218976974487305, 2.8369593620300293, 1.1862871646881104, 3.601468563079834, 1.3069992065429688, 1.4616641998291016, 2.9142918586730957, 2.686065196990967, 3.7108917236328125, 3.6651272773742676, 3.357922077178955, 3.943924903869629, 1.1030466556549072, 2.349465847015381, 2.360178232192993, 1.7305340766906738, 2.548656463623047, 4.019594192504883, 2.7972328662872314, 2.545100688934326, 4.005899906158447, 2.8337011337280273, 2.9158411026000977, 0.7738168239593506, 4.2219462394714355, 2.9117751121520996, 2.143749475479126, 5.050498008728027, 1.1238094568252563, 2.581390857696533, 3.9374120235443115, 1.7739994525909424, 3.255119562149048, 1.777116060256958, 3.3053383827209473, 0.8719104528427124, 3.088712215423584, 2.9516239166259766, 1.0936787128448486, 4.6803083419799805, 2.887097120285034, 2.555541515350342, 2.7241036891937256, 2.3631134033203125, 3.961054801940918, 0.7733389139175415, 3.744337558746338, 1.0179558992385864, 3.816265821456909, 3.1716084480285645, 1.4532768726348877, 2.660233974456787, 3.0655980110168457, 3.8567614555358887, 3.614372730255127, 3.6252293586730957, 2.608798027038574, 3.331648349761963, 3.684321880340576, 2.9738411903381348, 2.5949079990386963, 1.7566686868667603, 2.9699010848999023, 4.579937934875488, 1.9872090816497803, 2.1994223594665527, 1.1892175674438477, 2.8355586528778076, 1.8336915969848633, 3.5902748107910156, 1.9360694885253906, 3.8993453979492188, 4.484880447387695, 2.946885585784912, 2.5782980918884277, 2.4774584770202637, 1.4939708709716797, 4.131217956542969, 3.5190234184265137, 2.69154691696167, 2.5839309692382812, 2.825711250305176, 2.275700569152832, 0.9500340819358826], "mean_td_error": 2.776127815246582, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 4.0, "diff_num_grad_updates_vs_sampler_policy": 3.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.081055641174316, "actor_loss": -4.119118690490723, "critic_loss": 1.5148630142211914, "alpha_loss": -0.009074006229639053, "alpha_value": 0.9991003274917603, "log_alpha_value": -0.0009001047583296895, "target_entropy": -6.0, "policy_t": 0.0036080083809792995, "mean_q": 0.049100469797849655, "max_q": 0.3241066038608551, "min_q": 0.038393039256334305}, "td_error": [0.7244707345962524, 2.7681221961975098, 1.826440453529358, 2.377089023590088, 3.149857759475708, 3.2293949127197266, 1.5570745468139648, 1.9150779247283936, 3.2058205604553223, 2.713139533996582, 4.287351131439209, 5.205521583557129, 2.319444179534912, 1.4694790840148926, 2.504364490509033, 2.4658167362213135, 1.0866881608963013, 4.468266487121582, 4.140087604522705, 2.5241832733154297, 3.812959671020508, 3.0695009231567383, 3.3633475303649902, 3.7662606239318848, 2.92645525932312, 2.257518768310547, 2.453157901763916, 1.5426673889160156, 3.436253070831299, 2.6222684383392334, 2.0956974029541016, 3.2756237983703613, 1.1823914051055908, 0.6878386735916138, 2.7205305099487305, 3.6927239894866943, 2.5671331882476807, 2.7318310737609863, 2.497074604034424, 2.7553839683532715, 2.1403446197509766, 2.2138352394104004, 2.98018217086792, 3.0325205326080322, 1.7760058641433716, 1.8318650722503662, 3.4113755226135254, 2.5288290977478027, 2.7257907390594482, 0.8515639305114746, 4.052391052246094, 3.21115779876709, 3.860137462615967, 3.3814892768859863, 3.7601757049560547, 3.490635633468628, 3.9495606422424316, 3.34432315826416, 4.175265312194824, 3.56842041015625, 2.5427582263946533, 1.8096569776535034, 2.786972999572754, 2.1585335731506348, 3.2298693656921387, 2.9458670616149902, 3.01466703414917, 1.6048959493637085, 2.5061731338500977, 4.7084641456604, 4.422479629516602, 1.7393443584442139, 2.157252311706543, 3.182255744934082, 3.1012043952941895, 4.489452362060547, 3.151031732559204, 2.965376853942871, 3.745959520339966, 1.9363493919372559, 2.539989948272705, 4.783657073974609, 1.8785088062286377, 4.040901184082031, 3.757760524749756, 2.414463520050049], "mean_td_error": 2.8522558212280273, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 4.0, "diff_num_grad_updates_vs_sampler_policy": 3.0}}, "num_env_steps_sampled": 4480, "num_env_steps_trained": 1032, "num_agent_steps_sampled": 13440, "num_agent_steps_trained": 1032, "last_target_update_ts": 4480, "num_target_updates": 4}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13440, "num_agent_steps_trained": 1032, "num_env_steps_sampled": 4480, "num_env_steps_trained": 1032, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 884.9234351290994, "num_env_steps_trained_throughput_per_sec": 254.81054270458444, "timesteps_total": 4480, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 13440, "timers": {"training_iteration_time_ms": 1071.318, "sample_time_ms": 700.593, "load_time_ms": 0.318, "load_throughput": 811953.053, "learn_time_ms": 24.434, "learn_throughput": 10559.096, "synch_weights_time_ms": 10.366}, "counters": {"num_env_steps_sampled": 4480, "num_env_steps_trained": 1032, "num_agent_steps_sampled": 13440, "num_agent_steps_trained": 1032, "last_target_update_ts": 4480, "num_target_updates": 4}, "done": false, "episodes_total": 0, "training_iteration": 4, "trial_id": "95c7c_00000", "date": "2023-11-18_20-53-45", "timestamp": 1700369625, "time_this_iter_s": 1.0214910507202148, "time_total_s": 5.388737201690674, "pid": 5649, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16bd432e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 5.388737201690674, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 75.3, "ram_util_percent": 66.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.991878509521484, "actor_loss": -4.041743755340576, "critic_loss": 4.0866804122924805, "alpha_loss": -0.011990380473434925, "alpha_value": 0.9988006949424744, "log_alpha_value": -0.0012000126298516989, "target_entropy": -6.0, "policy_t": -0.03792022913694382, "mean_q": 0.07399820536375046, "max_q": 0.8686668872833252, "min_q": 0.04543989524245262}, "td_error": [3.8143765926361084, 4.199717044830322, 4.197203159332275, 2.9558053016662598, 3.630105972290039, 3.9874191284179688, 6.265690326690674, 4.445230007171631, 7.457673072814941, 3.3756651878356934, 5.380492210388184, 6.451541900634766, 5.868980407714844, 2.0957605838775635, 3.541637420654297, 6.245866298675537, 4.887646675109863, 6.022164821624756, 3.5263257026672363, 4.041787147521973, 4.14201545715332, 5.3120317459106445, 4.6051530838012695, 5.212932586669922, 7.239880561828613, 3.0053179264068604, 3.217477321624756, 5.594559669494629, 4.51957893371582, 4.844555854797363, 4.094696521759033, 2.8069581985473633, 4.026557922363281, 4.441183567047119, 3.2782130241394043, 3.8590173721313477, 6.068282127380371, 5.165677070617676, 7.383890628814697, 4.236192226409912, 4.888110637664795, 4.209792613983154, 5.851892471313477, 3.52431058883667, 4.930732727050781, 4.815958499908447, 4.61368989944458, 4.294646739959717, 3.6057024002075195, 4.160612106323242, 5.000840187072754, 4.409173965454102, 4.915848731994629, 4.45591926574707, 6.967255592346191, 3.747164726257324, 6.683432102203369, 4.053322792053223, 3.307713031768799, 5.281537055969238, 2.59193754196167, 3.8248393535614014, 4.753350257873535, 4.619935035705566, 5.674080848693848, 4.490685939788818, 4.146407127380371, 6.373859882354736, 4.404620170593262, 4.669942855834961, 6.25670862197876, 5.786399841308594, 3.5292272567749023, 3.533967971801758, 4.663508415222168, 5.072263717651367, 3.858952522277832, 4.8217997550964355, 4.836724281311035, 6.485088348388672, 4.618067741394043, 5.39385986328125, 5.426307201385498, 4.158050060272217, 4.744330406188965, 3.735560417175293], "mean_td_error": 4.6701555252075195, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 5.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.037817001342773, "actor_loss": -4.078432083129883, "critic_loss": 1.1830008029937744, "alpha_loss": -0.012048503383994102, "alpha_value": 0.9988003969192505, "log_alpha_value": -0.001200311235152185, "target_entropy": -6.0, "policy_t": 0.025126736611127853, "mean_q": 0.05865871533751488, "max_q": 0.46134746074676514, "min_q": 0.036275871098041534}, "td_error": [5.48563814163208, 4.466022491455078, 2.5425338745117188, 3.696119785308838, 1.2323486804962158, 2.8329949378967285, 2.647336721420288, 3.2985997200012207, 3.6802008152008057, 2.700599193572998, 3.8038902282714844, 2.2448487281799316, 2.1035115718841553, 2.89686918258667, 1.0678184032440186, 1.6875550746917725, 2.6331465244293213, 2.324280261993408, 3.617506980895996, 2.9341540336608887, 3.742208480834961, 1.815589189529419, 4.621233940124512, 3.663018226623535, 2.4381017684936523, 3.7227187156677246, 1.9134666919708252, 4.421414852142334, 0.6073383688926697, 2.1100034713745117, 3.701935291290283, 1.3234777450561523, 2.5780792236328125, 1.6494574546813965, 2.2877140045166016, 2.3816614151000977, 5.099607944488525, 4.673898220062256, 3.049983024597168, 4.2992706298828125, 5.055266380310059, 4.409908294677734, 2.1439208984375, 2.206005573272705, 2.8850603103637695, 2.632969379425049, 2.589798927307129, 2.215473175048828, 1.6130056381225586, 2.950263023376465, 3.793259620666504, 4.204950332641602, 2.629589319229126, 3.3081164360046387, 3.7926316261291504, 2.062587261199951, 1.93257737159729, 3.867631196975708, 0.4240206182003021, 2.255096912384033, 2.300685405731201, 1.6129237413406372, 4.17909049987793, 3.3166160583496094, 1.2351281642913818, 0.9693425893783569, 3.192136287689209, 2.488497495651245, 2.6844165325164795, 3.277256488800049, 3.193023681640625, 3.4071621894836426, 2.3115954399108887, 1.618992567062378, 3.113464117050171, 2.9662415981292725, 2.8627700805664062, 2.904722213745117, 2.8398139476776123, 4.039783954620361, 4.365535736083984, 3.648595094680786, 2.545797348022461, 3.2460145950317383, 2.982748031616211, 2.1670432090759277], "mean_td_error": 2.888810157775879, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 5.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.150842666625977, "actor_loss": -4.201748371124268, "critic_loss": 1.3117339611053467, "alpha_loss": -0.012183754704892635, "alpha_value": 0.9988004565238953, "log_alpha_value": -0.0012002703733742237, "target_entropy": -6.0, "policy_t": 0.05322102829813957, "mean_q": 0.06899795681238174, "max_q": 0.5470305681228638, "min_q": 0.051172394305467606}, "td_error": [3.064497232437134, 1.748148798942566, 2.359008312225342, 2.367173433303833, 2.9259018898010254, 0.8529766201972961, 3.210935592651367, 2.406010150909424, 2.31712007522583, 4.554003715515137, 2.6276426315307617, 3.072326183319092, 3.2862226963043213, 1.9320569038391113, 1.532820701599121, 2.2515604496002197, 2.6950769424438477, 2.655949115753174, 2.9249444007873535, 2.350278615951538, 2.4952917098999023, 1.9566113948822021, 1.7376304864883423, 2.229774236679077, 3.7985758781433105, 2.474699020385742, 4.5742411613464355, 2.1613776683807373, 1.9356698989868164, 3.216200828552246, 1.5719881057739258, 2.155345916748047, 2.584301471710205, 2.0494790077209473, 1.5347775220870972, 0.5291179418563843, 1.3677281141281128, 2.648124933242798, 2.8336615562438965, 2.934342861175537, 4.359268665313721, 2.851109027862549, 1.0128543376922607, 1.3697004318237305, 2.30875301361084, 1.5558602809906006, 2.780771255493164, 2.6845479011535645, 5.268760681152344, 0.4036937355995178, 2.8617546558380127, 1.8264987468719482, 4.485483169555664, 3.033721446990967, 3.546247959136963, 2.541221857070923, 0.5205385684967041, 2.605652332305908, 2.1349740028381348, 0.8743751049041748, 2.491405487060547, 2.21523380279541, 3.0000338554382324, 2.5912060737609863, 2.65391206741333, 4.465051651000977, 1.7041994333267212, 1.836701512336731, 2.674405813217163, 2.0712554454803467, 1.7334686517715454, 4.754697322845459, 1.2778964042663574, 4.3664045333862305, 1.555009126663208, 1.8362724781036377, 4.120840072631836, 4.444756507873535, 3.1299242973327637, 3.2231273651123047, 1.1639832258224487, 1.1793909072875977, 1.825598955154419, 2.051621675491333, 0.87153160572052, 3.3323910236358643], "mean_td_error": 2.4827873706817627, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 5.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 5376, "num_env_steps_trained": 1290, "num_agent_steps_sampled": 16128, "num_agent_steps_trained": 1290, "last_target_update_ts": 5376, "num_target_updates": 5}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16128, "num_agent_steps_trained": 1290, "num_env_steps_sampled": 5376, "num_env_steps_trained": 1290, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 892.8554352546735, "num_env_steps_trained_throughput_per_sec": 257.0945338121716, "timesteps_total": 5376, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 16128, "timers": {"training_iteration_time_ms": 1060.016, "sample_time_ms": 702.712, "load_time_ms": 0.32, "load_throughput": 806236.352, "learn_time_ms": 23.332, "learn_throughput": 11057.605, "synch_weights_time_ms": 10.701}, "counters": {"num_env_steps_sampled": 5376, "num_env_steps_trained": 1290, "num_agent_steps_sampled": 16128, "num_agent_steps_trained": 1290, "last_target_update_ts": 5376, "num_target_updates": 5}, "done": false, "episodes_total": 0, "training_iteration": 5, "trial_id": "95c7c_00000", "date": "2023-11-18_20-53-46", "timestamp": 1700369626, "time_this_iter_s": 1.0130081176757812, "time_total_s": 6.401745319366455, "pid": 5649, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16bd423e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 6.401745319366455, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 70.35, "ram_util_percent": 66.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.088308334350586, "actor_loss": -4.152406692504883, "critic_loss": 3.9569640159606934, "alpha_loss": -0.01513182558119297, "alpha_value": 0.998501181602478, "log_alpha_value": -0.0014999369159340858, "target_entropy": -6.0, "policy_t": -0.020310286432504654, "mean_q": 0.10941766947507858, "max_q": 1.0021131038665771, "min_q": 0.05867818370461464}, "td_error": [4.053662300109863, 6.405645370483398, 5.495169639587402, 4.644065856933594, 3.6346025466918945, 4.78688383102417, 5.527251243591309, 4.064541816711426, 2.435655117034912, 4.6455078125, 6.114378929138184, 4.2476654052734375, 4.061157703399658, 4.7198920249938965, 5.547548770904541, 5.111356258392334, 5.552150726318359, 4.2087178230285645, 3.3392767906188965, 4.750639915466309, 4.749377727508545, 4.887971878051758, 3.7623291015625, 4.448664665222168, 4.9090776443481445, 4.549152374267578, 5.536447048187256, 3.237274646759033, 4.3600053787231445, 3.9656286239624023, 5.390349388122559, 5.591373920440674, 3.008960247039795, 5.91834831237793, 3.133296251296997, 7.524752616882324, 3.5660183429718018, 4.594823360443115, 5.361008644104004, 4.970683574676514, 6.061745643615723, 3.709245443344116, 4.408438682556152, 4.720671653747559, 5.720525741577148, 5.021752834320068, 5.0622406005859375, 3.8586463928222656, 3.1345927715301514, 4.898379325866699, 5.61805534362793, 3.904517650604248, 4.947427749633789, 3.6875290870666504, 4.421393394470215, 3.450153112411499, 6.141469955444336, 3.520674467086792, 3.7621865272521973, 2.1194543838500977, 6.205072402954102, 4.472594738006592, 3.3154988288879395, 4.381792068481445, 4.682253837585449, 5.257131576538086, 5.682736396789551, 4.338512897491455, 3.8638391494750977, 6.91463041305542, 5.507908821105957, 5.041175365447998, 4.61003303527832, 4.077727317810059, 5.926447868347168, 4.625032424926758, 5.151827335357666, 3.925848960876465, 2.405547618865967, 5.799846172332764, 7.405637741088867, 5.052539825439453, 3.946956157684326, 4.892637729644775, 4.463254928588867, 2.6501171588897705], "mean_td_error": 4.646245002746582, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 6.0, "diff_num_grad_updates_vs_sampler_policy": 5.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.013218879699707, "actor_loss": -4.065179824829102, "critic_loss": 1.11712646484375, "alpha_loss": -0.015024229884147644, "alpha_value": 0.9985007047653198, "log_alpha_value": -0.0015004395972937346, "target_entropy": -6.0, "policy_t": -0.07682255655527115, "mean_q": 0.0853859931230545, "max_q": 0.6549065113067627, "min_q": 0.04685235768556595}, "td_error": [1.8734633922576904, 3.158090114593506, 1.2698984146118164, 1.9513800144195557, 3.105825901031494, 1.184643030166626, 3.5022401809692383, 2.7852344512939453, 3.0211119651794434, 2.442678213119507, 5.411938667297363, 3.3338112831115723, 3.210639476776123, 3.7782082557678223, 1.823746681213379, 2.7975237369537354, 0.9440890550613403, 2.880908489227295, 2.521688461303711, 4.34318733215332, 4.598494529724121, 2.2500057220458984, 2.4097938537597656, 3.3642477989196777, 3.5082578659057617, 4.199183464050293, 4.08380126953125, 0.9720199108123779, 4.675815105438232, 2.326306104660034, 1.6379649639129639, 3.3877172470092773, 3.729410409927368, 1.760143518447876, 2.90887451171875, 4.140768051147461, 2.2690441608428955, 1.4128940105438232, 4.602892875671387, 2.138098955154419, 1.9514590501785278, 1.1603233814239502, 1.444936752319336, 2.655696392059326, 1.8968838453292847, 2.1311380863189697, 4.059846878051758, 3.615210771560669, 1.8634583950042725, 2.2866647243499756, 4.066971778869629, 4.272589683532715, 2.49725341796875, 3.2152321338653564, 2.431107521057129, 4.697305202484131, 1.560403823852539, 2.8975749015808105, 5.10905122756958, 3.030080795288086, 2.4015228748321533, 3.3625593185424805, 3.463540554046631, 1.4530394077301025, 3.6268625259399414, 2.2392563819885254, 2.059622287750244, 3.073263645172119, 0.9473540782928467, 3.3228724002838135, 2.088818073272705, 2.1922779083251953, 2.7445881366729736, 2.7822508811950684, 1.5211055278778076, 3.001582145690918, 2.1783766746520996, 2.7757315635681152, 3.1470210552215576, 2.107536554336548, 3.074777126312256, 2.053023338317871, 2.9739513397216797, 2.5233912467956543, 2.597827911376953, 0.25930413603782654], "mean_td_error": 2.750356912612915, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 6.0, "diff_num_grad_updates_vs_sampler_policy": 5.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.103078842163086, "actor_loss": -4.168114185333252, "critic_loss": 1.3745508193969727, "alpha_loss": -0.015160279348492622, "alpha_value": 0.9985005855560303, "log_alpha_value": -0.001500560436397791, "target_entropy": -6.0, "policy_t": 0.02203475311398506, "mean_q": 0.08782932162284851, "max_q": 0.710381031036377, "min_q": 0.06488814949989319}, "td_error": [4.254552364349365, 0.7629648447036743, 2.7818641662597656, 2.145944595336914, 2.125655174255371, 3.7636666297912598, 3.89513897895813, 2.7353692054748535, 4.078906059265137, 2.7496728897094727, 1.1801649332046509, 1.8605817556381226, 1.6765646934509277, 2.498769760131836, 2.3139963150024414, 3.041426658630371, 3.7040581703186035, 2.0113136768341064, 1.6133599281311035, 3.0013084411621094, 3.167625665664673, 2.129883050918579, 2.302363157272339, 2.9728269577026367, 2.8906025886535645, 1.9425158500671387, 1.6795499324798584, 2.1495442390441895, 2.3297972679138184, 3.177398681640625, 2.6906321048736572, 2.7929344177246094, 1.0784640312194824, 1.1360104084014893, 1.1986908912658691, 4.208113670349121, 3.105377435684204, 4.997897624969482, 3.983466625213623, 2.2360119819641113, 1.7931721210479736, 3.166781187057495, 4.25623893737793, 1.6834107637405396, 0.9889819622039795, 3.1748790740966797, 1.1208631992340088, 2.240776538848877, 3.118900775909424, 1.6550440788269043, 2.87542724609375, 2.086379289627075, 1.8160052299499512, 1.548949122428894, 2.377368450164795, 3.050325870513916, 4.483249664306641, 2.244494915008545, 3.1262660026550293, 3.0974020957946777, 2.1498942375183105, 3.3174047470092773, 2.978177785873413, 3.0997986793518066, 2.2644643783569336, 2.3067753314971924, 0.5104016065597534, 2.2241790294647217, 2.040769338607788, 1.9829862117767334, 3.3938498497009277, 3.674459457397461, 4.44238805770874, 2.1489362716674805, 1.8493419885635376, 3.1135191917419434, 3.170651912689209, 3.7052831649780273, 3.9800586700439453, 1.6281635761260986, 2.773118019104004, 2.836097002029419, 0.8302514553070068, 1.0705809593200684, 3.8688652515411377, 4.467041015625], "mean_td_error": 2.605783224105835, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 6.0, "diff_num_grad_updates_vs_sampler_policy": 5.0}}, "num_env_steps_sampled": 6272, "num_env_steps_trained": 1548, "num_agent_steps_sampled": 18816, "num_agent_steps_trained": 1548, "last_target_update_ts": 6272, "num_target_updates": 6}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18816, "num_agent_steps_trained": 1548, "num_env_steps_sampled": 6272, "num_env_steps_trained": 1548, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 774.2298864024986, "num_env_steps_trained_throughput_per_sec": 222.9367306828623, "timesteps_total": 6272, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 18816, "timers": {"training_iteration_time_ms": 1073.909, "sample_time_ms": 729.011, "load_time_ms": 0.321, "load_throughput": 804458.257, "learn_time_ms": 22.475, "learn_throughput": 11479.541, "synch_weights_time_ms": 10.792}, "counters": {"num_env_steps_sampled": 6272, "num_env_steps_trained": 1548, "num_agent_steps_sampled": 18816, "num_agent_steps_trained": 1548, "last_target_update_ts": 6272, "num_target_updates": 6}, "done": false, "episodes_total": 0, "training_iteration": 6, "trial_id": "95c7c_00000", "date": "2023-11-18_20-53-47", "timestamp": 1700369627, "time_this_iter_s": 1.166827917098999, "time_total_s": 7.568573236465454, "pid": 5649, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16bd436a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 7.568573236465454, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 74.3, "ram_util_percent": 66.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.040509223937988, "actor_loss": -4.119388103485107, "critic_loss": 3.8735122680664062, "alpha_loss": -0.01807214505970478, "alpha_value": 0.9982016682624817, "log_alpha_value": -0.0017999231349676847, "target_entropy": -6.0, "policy_t": -0.018079698085784912, "mean_q": 0.11098557710647583, "max_q": 1.233646035194397, "min_q": 0.07280570268630981}, "td_error": [4.02547550201416, 5.9191508293151855, 3.84124755859375, 4.966139316558838, 4.438542366027832, 4.984941005706787, 4.259164810180664, 4.5903825759887695, 6.211616516113281, 4.097390174865723, 3.743502616882324, 3.521970272064209, 3.307711124420166, 6.158730506896973, 4.746748924255371, 5.147855758666992, 3.9676389694213867, 1.87353515625, 0.6391734480857849, 2.8802690505981445, 5.394401550292969, 4.650639533996582, 3.3714699745178223, 3.679091453552246, 2.7724356651306152, 2.776324510574341, 4.288759231567383, 3.19987416267395, 4.123457431793213, 7.4304351806640625, 2.928293228149414, 5.207331657409668, 4.629545211791992, 6.605462074279785, 5.603401184082031, 3.8629021644592285, 5.005548000335693, 4.278298854827881, 5.180911064147949, 5.322876930236816, 4.846435546875, 5.907417297363281, 3.653019428253174, 5.911744594573975, 6.446658611297607, 3.6083946228027344, 5.989785194396973, 5.342975616455078, 5.690765380859375, 5.862837791442871, 2.0306954383850098, 4.859938144683838, 6.498322010040283, 3.1739463806152344, 4.292150974273682, 4.146379470825195, 6.4029083251953125, 4.853180885314941, 6.1039276123046875, 4.186020374298096, 5.971129417419434, 4.470128059387207, 5.649930477142334, 5.964504718780518, 5.0774335861206055, 3.3372642993927, 5.739209175109863, 3.459115743637085, 4.069990158081055, 3.1664209365844727, 2.908475160598755, 4.390136241912842, 4.892312049865723, 2.961179733276367, 4.574436664581299, 3.636242389678955, 3.58518648147583, 4.27122688293457, 4.073548316955566, 6.7919206619262695, 4.993436813354492, 4.516158103942871, 4.884416580200195, 4.981679916381836, 3.5209357738494873, 3.6222658157348633], "mean_td_error": 4.522661209106445, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 7.0, "diff_num_grad_updates_vs_sampler_policy": 6.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0845308303833, "actor_loss": -4.146847248077393, "critic_loss": 1.1690818071365356, "alpha_loss": -0.018157344311475754, "alpha_value": 0.9982011318206787, "log_alpha_value": -0.0018005145248025656, "target_entropy": -6.0, "policy_t": -0.05543796345591545, "mean_q": 0.07550891488790512, "max_q": 0.6694100499153137, "min_q": 0.05828062817454338}, "td_error": [2.63714337348938, 2.007312297821045, 4.379185199737549, 3.1255736351013184, 3.095829963684082, 1.3508923053741455, 2.3394417762756348, 5.4198503494262695, 2.5387392044067383, 2.379530429840088, 1.3794150352478027, 1.8347117900848389, 3.940648078918457, 1.2499535083770752, 1.4578332901000977, 2.0166754722595215, 4.196642875671387, 5.168951034545898, 2.713866710662842, 2.971043348312378, 5.27726411819458, 3.3793435096740723, 3.010697364807129, 3.276498317718506, 1.5661513805389404, 2.0553717613220215, 3.2756261825561523, 3.4382071495056152, 4.618762969970703, 1.4259350299835205, 2.248413562774658, 3.8790807723999023, 3.6908974647521973, 3.3620448112487793, 3.3669800758361816, 4.3063836097717285, 2.0252466201782227, 2.7280240058898926, 2.664503574371338, 3.308074712753296, 4.087355613708496, 2.534113883972168, 3.4416894912719727, 1.8506965637207031, 2.962066173553467, 4.903473854064941, 2.7366130352020264, 3.821739673614502, 3.3851466178894043, 4.5696611404418945, 0.7382909059524536, 2.612644910812378, 4.061001300811768, 2.0743207931518555, 2.209591865539551, 3.1842172145843506, 3.165773391723633, 1.36397385597229, 3.3673136234283447, 3.172323703765869, 3.4052681922912598, 0.2945043444633484, 4.413660049438477, 1.4088842868804932, 3.0693721771240234, 1.3910412788391113, 3.1986358165740967, 2.565394401550293, 0.7218164205551147, 4.0899505615234375, 3.3696298599243164, 1.6447575092315674, 2.3843441009521484, 2.219660997390747, 2.491483688354492, 1.6887342929840088, 5.002065181732178, 4.570049285888672, 2.965209484100342, 3.262021064758301, 2.023355484008789, 2.621356964111328, 1.7726085186004639, 2.7007453441619873, 0.8323516845703125, 2.3744871616363525], "mean_td_error": 2.858489990234375, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 7.0, "diff_num_grad_updates_vs_sampler_policy": 6.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.11491870880127, "actor_loss": -4.197160720825195, "critic_loss": 1.3211088180541992, "alpha_loss": -0.018215596675872803, "alpha_value": 0.9982007741928101, "log_alpha_value": -0.0018008645856752992, "target_entropy": -6.0, "policy_t": -0.016630319878458977, "mean_q": 0.12540993094444275, "max_q": 0.8888098001480103, "min_q": 0.07967217266559601}, "td_error": [3.3112144470214844, 1.4904533624649048, 0.42287978529930115, 2.2313408851623535, 2.0735580921173096, 1.9824153184890747, 2.6208009719848633, 3.2765402793884277, 2.993560791015625, 3.8112168312072754, 0.9237668514251709, 4.482351303100586, 4.145606994628906, 3.592803478240967, 1.533764123916626, 2.213286876678467, 2.3871278762817383, 2.146894693374634, 2.274601459503174, 2.9378857612609863, 1.8612127304077148, 3.6508994102478027, 3.7459466457366943, 3.4371514320373535, 4.108423233032227, 2.7855796813964844, 2.10768723487854, 1.371971607208252, 2.0501952171325684, 3.8576698303222656, 1.839775800704956, 2.2705788612365723, 2.1824636459350586, 2.0147950649261475, 2.368199348449707, 1.1285512447357178, 5.977505207061768, 2.144878387451172, 2.348782539367676, 3.4738149642944336, 3.2945263385772705, 1.4613375663757324, 3.6918816566467285, 2.4502015113830566, 2.158320426940918, 1.5214389562606812, 1.931858777999878, 0.8602904081344604, 2.2510194778442383, 2.57635498046875, 0.49278247356414795, 1.9915170669555664, 2.8551371097564697, 3.4300076961517334, 1.9401321411132812, 2.9290201663970947, 1.3583533763885498, 1.8062907457351685, 1.2266433238983154, 2.5974225997924805, 2.069943428039551, 2.7215492725372314, 3.691155195236206, 1.5052950382232666, 3.5484304428100586, 1.7676262855529785, 3.587299346923828, 2.9282753467559814, 1.648606777191162, 2.115367889404297, 3.355638027191162, 3.0239052772521973, 3.593167781829834, 2.6125171184539795, 3.0825376510620117, 3.993868350982666, 4.043271064758301, 2.183460235595703, 1.9762017726898193, 1.9655110836029053, 2.5842528343200684, 2.8511509895324707, 4.035799026489258, 1.7395620346069336, 1.3002943992614746, 1.5338598489761353], "mean_td_error": 2.5332701206207275, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 7.0, "diff_num_grad_updates_vs_sampler_policy": 6.0}}, "num_env_steps_sampled": 7168, "num_env_steps_trained": 1806, "num_agent_steps_sampled": 21504, "num_agent_steps_trained": 1806, "last_target_update_ts": 7168, "num_target_updates": 7}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 21504, "num_agent_steps_trained": 1806, "num_env_steps_sampled": 7168, "num_env_steps_trained": 1806, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 870.4540058618641, "num_env_steps_trained_throughput_per_sec": 250.6441222236171, "timesteps_total": 7168, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 21504, "timers": {"training_iteration_time_ms": 1068.337, "sample_time_ms": 733.107, "load_time_ms": 0.32, "load_throughput": 805841.811, "learn_time_ms": 21.913, "learn_throughput": 11774.025, "synch_weights_time_ms": 10.61}, "counters": {"num_env_steps_sampled": 7168, "num_env_steps_trained": 1806, "num_agent_steps_sampled": 21504, "num_agent_steps_trained": 1806, "last_target_update_ts": 7168, "num_target_updates": 7}, "done": false, "episodes_total": 0, "training_iteration": 7, "trial_id": "95c7c_00000", "date": "2023-11-18_20-53-48", "timestamp": 1700369628, "time_this_iter_s": 1.0378623008728027, "time_total_s": 8.606435537338257, "pid": 5649, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16bd43420>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 8.606435537338257, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 75.2, "ram_util_percent": 66.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.109352111816406, "actor_loss": -4.221278190612793, "critic_loss": 3.3614251613616943, "alpha_loss": -0.02426115609705448, "alpha_value": 0.9976029992103577, "log_alpha_value": -0.002399872522801161, "target_entropy": -6.0, "policy_t": 0.02245737798511982, "mean_q": 0.17084719240665436, "max_q": 1.7391306161880493, "min_q": 0.10471901297569275}, "td_error": [5.286459922790527, 4.348344326019287, 5.760284900665283, 6.106925964355469, 4.055780410766602, 5.70730447769165, 2.198172092437744, 4.93125581741333, 4.523990631103516, 2.1052680015563965, 5.697466850280762, 3.7955169677734375, 5.507767677307129, 3.9606189727783203, 3.244032382965088, 4.386224746704102, 3.7582287788391113, 5.12535285949707, 4.368250846862793, 3.7656402587890625, 5.130117416381836, 3.3391613960266113, 5.724069595336914, 4.768433570861816, 4.51434850692749, 3.986196517944336, 7.752204895019531, 6.2273850440979, 5.38216495513916, 5.129045009613037, 3.6619091033935547, 1.930267572402954, 4.42230224609375, 3.0582826137542725, 6.7681355476379395, 2.84580135345459, 4.836098670959473, 3.077065944671631, 5.862241744995117, 5.730812072753906, 5.531693458557129, 5.686735153198242, 4.267714500427246, 5.797972202301025, 5.920146942138672, 3.581824541091919, 4.334010124206543, 4.056556701660156, 4.490583896636963, 4.6368818283081055, 2.689422607421875, 4.288922309875488, 1.539738655090332, 4.262393474578857, 1.557801365852356, 5.579811096191406, 4.065296649932861, 4.77595329284668, 5.657449722290039, 3.4536633491516113, 4.499964714050293, 5.188479900360107, 3.705573081970215, 4.102666854858398, 3.919862985610962, 4.9477949142456055, 5.314122200012207, 5.207963466644287, 4.55573034286499, 4.004947185516357, 4.606202125549316, 5.711142539978027, 5.851212501525879, 4.768963813781738, 4.007781028747559, 1.918346643447876, 4.42997932434082, 4.390236854553223, 2.10483980178833, 3.452486515045166, 3.552948236465454, 3.7169508934020996, 5.2037434577941895, 5.4774909019470215, 5.367757797241211, 3.0315492153167725], "mean_td_error": 4.441770553588867, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 9.0, "diff_num_grad_updates_vs_sampler_policy": 8.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.159700393676758, "actor_loss": -4.2506537437438965, "critic_loss": 1.014657735824585, "alpha_loss": -0.024390891194343567, "alpha_value": 0.997602105140686, "log_alpha_value": -0.0024007491301745176, "target_entropy": -6.0, "policy_t": 0.015385030768811703, "mean_q": 0.14713695645332336, "max_q": 1.1691486835479736, "min_q": 0.08386862277984619}, "td_error": [2.865149974822998, 4.294129371643066, 2.7134125232696533, 3.8364691734313965, 3.2727296352386475, 1.5189651250839233, 1.4257328510284424, 2.4576003551483154, 3.021223545074463, 2.8744022846221924, 1.418212890625, 2.5396294593811035, 2.754591941833496, 3.3934264183044434, 1.9099171161651611, 1.6399223804473877, 3.2648797035217285, 0.1699378490447998, 3.5041043758392334, 1.0971180200576782, 2.756366729736328, 3.8403713703155518, 4.745631217956543, 2.031750202178955, 4.15423583984375, 2.7483737468719482, 3.6399848461151123, 1.6951491832733154, 2.8506264686584473, 2.1763675212860107, 2.1987216472625732, 3.123965263366699, 1.1782279014587402, 2.376641035079956, 3.2307682037353516, 3.0892231464385986, 2.4902329444885254, 0.40805262327194214, 1.996835708618164, 3.7553391456604004, 3.4554381370544434, 3.4514174461364746, 3.08927845954895, 3.087467908859253, 2.116795063018799, 2.5347657203674316, 4.0011115074157715, 3.6838011741638184, 3.608820915222168, 1.1902599334716797, 2.5942931175231934, 4.109829902648926, 2.7119550704956055, 0.18404144048690796, 3.994520664215088, 1.7880651950836182, 4.810689926147461, 2.110491991043091, 2.8005781173706055, 3.2342729568481445, 1.4309914112091064, 2.065790891647339, 0.5105056762695312, 5.140176296234131, 1.8089408874511719, 4.106539726257324, 3.639747381210327, 2.1825151443481445, 2.0298666954040527, 2.643009662628174, 1.7412805557250977, 2.0573911666870117, 2.2203805446624756, 2.0537447929382324, 2.3163700103759766, 2.099208354949951, 2.7609214782714844, 2.507558822631836, 3.2256674766540527, 3.494267463684082, 0.4306980073451996, 1.3312747478485107, 1.5733416080474854, 2.989130973815918, 2.797055959701538, 1.6067402362823486], "mean_td_error": 2.6020865440368652, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 9.0, "diff_num_grad_updates_vs_sampler_policy": 8.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.119420051574707, "actor_loss": -4.235450744628906, "critic_loss": 1.0611324310302734, "alpha_loss": -0.024302132427692413, "alpha_value": 0.997601330280304, "log_alpha_value": -0.002401534467935562, "target_entropy": -6.0, "policy_t": 0.0331595316529274, "mean_q": 0.1625097393989563, "max_q": 1.2953593730926514, "min_q": 0.11293353885412216}, "td_error": [2.722787857055664, 2.3276071548461914, 2.155318021774292, 2.924813747406006, 3.247404098510742, 3.290304660797119, 1.7012120485305786, 3.893944263458252, 3.893240451812744, 4.89991569519043, 1.0638290643692017, 1.9950175285339355, 3.655008316040039, 3.027562141418457, 2.5039381980895996, 0.45545101165771484, 3.245030403137207, 1.9478890895843506, 2.0040416717529297, 0.33840733766555786, 0.6255199909210205, 0.3658096194267273, 2.183778762817383, 2.4621095657348633, 0.27968788146972656, 1.8777458667755127, 4.698249816894531, 2.0421433448791504, 1.6395435333251953, 3.12705135345459, 2.343397617340088, 2.6069626808166504, 2.0504209995269775, 2.381108045578003, 2.273716449737549, 2.4252681732177734, 3.3535609245300293, 1.4486671686172485, 2.3157331943511963, 2.2508788108825684, 4.103375434875488, 2.3977723121643066, 1.2002441883087158, 3.5773208141326904, 2.9212446212768555, 4.219475746154785, 2.102691650390625, 1.6407999992370605, 2.8547511100769043, 2.964599609375, 1.712991714477539, 2.4245800971984863, 1.6818668842315674, 2.3858256340026855, 1.9217610359191895, 1.7291020154953003, 1.7838982343673706, 2.695462703704834, 2.290376663208008, 0.8953568935394287, 0.07865650951862335, 1.441280484199524, 3.1195523738861084, 1.6069402694702148, 1.916338324546814, 3.139878749847412, 2.8303160667419434, 2.7465429306030273, 0.9603462219238281, 3.270563840866089, 0.1543865203857422, 3.2253408432006836, 2.92136812210083, 1.806050419807434, 1.6626033782958984, 1.393953561782837, 3.267892599105835, 3.6768388748168945, 2.2849888801574707, 3.859391212463379, 0.8016461133956909, 1.0735554695129395, 2.579911708831787, 1.9810611009597778, 1.2991187572479248, 4.134142875671387], "mean_td_error": 2.3113982677459717, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 9.0, "diff_num_grad_updates_vs_sampler_policy": 8.0}}, "num_env_steps_sampled": 8960, "num_env_steps_trained": 2322, "num_agent_steps_sampled": 26880, "num_agent_steps_trained": 2322, "last_target_update_ts": 8960, "num_target_updates": 9}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 26880, "num_agent_steps_trained": 2322, "num_env_steps_sampled": 8960, "num_env_steps_trained": 2322, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 870.7005505221, "num_env_steps_trained_throughput_per_sec": 250.7151138780154, "timesteps_total": 8960, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 26880, "timers": {"training_iteration_time_ms": 1060.476, "sample_time_ms": 723.18, "load_time_ms": 0.318, "load_throughput": 811057.119, "learn_time_ms": 21.02, "learn_throughput": 12274.263, "synch_weights_time_ms": 10.612}, "counters": {"num_env_steps_sampled": 8960, "num_env_steps_trained": 2322, "num_agent_steps_sampled": 26880, "num_agent_steps_trained": 2322, "last_target_update_ts": 8960, "num_target_updates": 9}, "done": false, "episodes_total": 0, "training_iteration": 8, "trial_id": "95c7c_00000", "date": "2023-11-18_20-53-50", "timestamp": 1700369630, "time_this_iter_s": 2.0666139125823975, "time_total_s": 10.673049449920654, "pid": 5649, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16bd43880>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 10.673049449920654, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 63.56666666666666, "ram_util_percent": 66.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.094441413879395, "actor_loss": -4.22648286819458, "critic_loss": 3.458024501800537, "alpha_loss": -0.027254387736320496, "alpha_value": 0.9973037242889404, "log_alpha_value": -0.002699939999729395, "target_entropy": -6.0, "policy_t": 0.037256598472595215, "mean_q": 0.16301101446151733, "max_q": 1.4209084510803223, "min_q": 0.12229626625776291}, "td_error": [6.602563858032227, 3.4629387855529785, 3.5567898750305176, 4.2707319259643555, 4.288612365722656, 5.316374778747559, 2.5853981971740723, 4.105815887451172, 4.837337017059326, 3.276625633239746, 5.5794525146484375, 3.1863372325897217, 4.328080177307129, 6.256054878234863, 5.201076507568359, 2.6441707611083984, 4.5217766761779785, 4.51014518737793, 2.246220111846924, 4.591718673706055, 5.803777694702148, 3.996387243270874, 3.4678680896759033, 5.294358253479004, 3.805875778198242, 3.881012439727783, 3.5797929763793945, 5.62332820892334, 4.353804588317871, 6.56091833114624, 4.937559604644775, 4.445704460144043, 2.6371476650238037, 5.006443977355957, 3.9846038818359375, 2.4034512042999268, 3.3635201454162598, 4.780463695526123, 4.010436058044434, 4.252710819244385, 3.5152335166931152, 5.684342384338379, 4.0040693283081055, 4.418103218078613, 5.383462429046631, 4.2126994132995605, 5.132437229156494, 3.7944254875183105, 4.582724571228027, 5.095789432525635, 5.099194049835205, 5.719089508056641, 3.5797860622406006, 3.9786343574523926, 5.3548479080200195, 5.5753045082092285, 4.710602760314941, 2.247303009033203, 4.8434906005859375, 4.544247627258301, 4.854803085327148, 4.772381782531738, 5.720623016357422, 5.34102725982666, 6.548844337463379, 5.8650665283203125, 2.5780489444732666, 4.397322654724121, 4.382965087890625, 4.797053337097168, 5.363712787628174, 3.987391710281372, 2.8467183113098145, 4.57984733581543, 3.4606857299804688, 5.193178176879883, 4.896316051483154, 4.49597692489624, 5.151739120483398, 5.12508487701416, 3.672883987426758, 4.971242904663086, 5.551691055297852, 4.166357040405273, 4.826862335205078, 4.582148551940918], "mean_td_error": 4.478641033172607, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 10.0, "diff_num_grad_updates_vs_sampler_policy": 9.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.04517936706543, "actor_loss": -4.1508469581604, "critic_loss": 1.0329113006591797, "alpha_loss": -0.02713220939040184, "alpha_value": 0.9973026514053345, "log_alpha_value": -0.0027010177727788687, "target_entropy": -6.0, "policy_t": -0.021810324862599373, "mean_q": 0.15299636125564575, "max_q": 1.00007963180542, "min_q": 0.09834443032741547}, "td_error": [3.2712154388427734, 2.458928108215332, 1.1601934432983398, 2.4382457733154297, 2.4206812381744385, 3.6019835472106934, 0.9072587490081787, 3.1955299377441406, 2.359790802001953, 2.5854437351226807, 1.540409803390503, 1.7884526252746582, 2.4608473777770996, 1.653261661529541, 3.1824474334716797, 1.9925475120544434, 1.7851133346557617, 2.6439857482910156, 2.9231228828430176, 3.0161266326904297, 2.7441599369049072, 1.8271958827972412, 3.6865148544311523, 3.2452101707458496, 3.2722649574279785, 4.614012718200684, 1.5617140531539917, 1.302232027053833, 1.9466643333435059, 1.4374909400939941, 4.496007919311523, 3.5183849334716797, 1.6975996494293213, 1.893706202507019, 3.110422134399414, 3.220583438873291, 4.213434219360352, 2.4068069458007812, 2.536479949951172, 2.9849624633789062, 3.40022873878479, 2.3471970558166504, 4.1939239501953125, 3.1525659561157227, 1.1128871440887451, 4.142889022827148, 2.414438486099243, 2.293309211730957, 3.1610796451568604, 3.020846128463745, 2.3720662593841553, 4.325084209442139, 2.4775495529174805, 1.7370117902755737, 3.4508795738220215, 1.3427516222000122, 2.317042827606201, 1.3476555347442627, 1.6121580600738525, 1.8645892143249512, 3.2991557121276855, 2.65341854095459, 0.9489246010780334, 3.3923933506011963, 3.106024980545044, 2.442214012145996, 3.7479443550109863, 2.8684258460998535, 2.8007760047912598, 2.3404977321624756, 1.988682508468628, 1.914196252822876, 3.027482032775879, 2.0044806003570557, 2.3863577842712402, 2.6082069873809814, 3.713439702987671, 0.6488409042358398, 1.2216665744781494, 2.219102144241333, 1.6324501037597656, 3.7293758392333984, 2.488114356994629, 3.4167158603668213, 3.28011155128479, 2.1901772022247314], "mean_td_error": 2.5727529525756836, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 10.0, "diff_num_grad_updates_vs_sampler_policy": 9.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.030132293701172, "actor_loss": -4.167280197143555, "critic_loss": 0.9863505959510803, "alpha_loss": -0.027100348845124245, "alpha_value": 0.9973017573356628, "log_alpha_value": -0.0027018936816602945, "target_entropy": -6.0, "policy_t": -0.0015687517588958144, "mean_q": 0.18304505944252014, "max_q": 1.5235075950622559, "min_q": 0.1314685344696045}, "td_error": [1.0910024642944336, 1.945951223373413, 0.9820098876953125, 3.1592540740966797, 4.010628700256348, 2.4980478286743164, 1.0572501420974731, 3.0381386280059814, 2.486767530441284, 2.603567361831665, 1.4240578413009644, 3.1856985092163086, 0.24704104661941528, 0.7029329538345337, 2.5919625759124756, 2.759103536605835, 3.2958617210388184, 0.9780911207199097, 2.265410900115967, 1.710019826889038, 2.531193256378174, 2.6067004203796387, 1.150583028793335, 3.9214775562286377, 1.7245008945465088, 1.0785658359527588, 3.3285770416259766, 2.6234400272369385, 2.798366069793701, 2.8905551433563232, 2.107254981994629, 1.4051263332366943, 4.0248236656188965, 0.9269819259643555, 1.9526653289794922, 1.646528959274292, 1.2072594165802002, 2.2581982612609863, 3.506016731262207, 2.3902759552001953, 3.211358070373535, 3.397047996520996, 1.449437141418457, 3.865157127380371, 2.0297508239746094, 4.106839656829834, 2.4471445083618164, 3.1845622062683105, 0.5730132460594177, 3.905386447906494, 2.718681812286377, 2.0309438705444336, 4.737069129943848, 4.351463317871094, 2.440514087677002, 1.8285799026489258, 1.99250328540802, 3.5927882194519043, 2.7634077072143555, 1.4452072381973267, 1.5929431915283203, 1.7470428943634033, 2.8553218841552734, 1.8244695663452148, 0.7032446265220642, 2.308103084564209, 1.7766475677490234, 3.3893685340881348, 2.383113384246826, 1.4554903507232666, 3.1728885173797607, 3.865614891052246, 2.9036192893981934, 0.5357477068901062, 2.1187071800231934, 2.9158058166503906, 2.440709114074707, 2.49442195892334, 3.0135858058929443, 3.5391478538513184, 1.2856076955795288, 2.408883571624756, 2.291245222091675, 3.3115627765655518, 2.6312036514282227, 1.4912049770355225], "mean_td_error": 2.379516839981079, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 10.0, "diff_num_grad_updates_vs_sampler_policy": 9.0}}, "num_env_steps_sampled": 9856, "num_env_steps_trained": 2580, "num_agent_steps_sampled": 29568, "num_agent_steps_trained": 2580, "last_target_update_ts": 9856, "num_target_updates": 10}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 29568, "num_agent_steps_trained": 2580, "num_env_steps_sampled": 9856, "num_env_steps_trained": 2580, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 876.8409300155158, "num_env_steps_trained_throughput_per_sec": 252.48321422321771, "timesteps_total": 9856, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 29568, "timers": {"training_iteration_time_ms": 1032.72, "sample_time_ms": 728.715, "load_time_ms": 0.317, "load_throughput": 813142.795, "learn_time_ms": 20.708, "learn_throughput": 12458.931, "synch_weights_time_ms": 10.637}, "counters": {"num_env_steps_sampled": 9856, "num_env_steps_trained": 2580, "num_agent_steps_sampled": 29568, "num_agent_steps_trained": 2580, "last_target_update_ts": 9856, "num_target_updates": 10}, "done": false, "episodes_total": 0, "training_iteration": 9, "trial_id": "95c7c_00000", "date": "2023-11-18_20-53-51", "timestamp": 1700369631, "time_this_iter_s": 1.0318427085876465, "time_total_s": 11.7048921585083, "pid": 5649, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16bdf4860>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 11.7048921585083, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 75.6, "ram_util_percent": 66.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.049644470214844, "actor_loss": -4.202182769775391, "critic_loss": 3.3173580169677734, "alpha_loss": -0.030149364843964577, "alpha_value": 0.9970044493675232, "log_alpha_value": -0.0030000433325767517, "target_entropy": -6.0, "policy_t": 0.029791520908474922, "mean_q": 0.3032509982585907, "max_q": 2.319422483444214, "min_q": 0.1413961946964264}, "td_error": [4.708597183227539, 4.090324401855469, 3.5752205848693848, 3.361787796020508, 4.093600273132324, 4.661462783813477, 5.175164699554443, 4.422280788421631, 4.672576904296875, 4.355647087097168, 3.446476936340332, 5.242321014404297, 3.186798572540283, 3.6729915142059326, 5.139283657073975, 3.575395107269287, 4.992387771606445, 4.0629167556762695, 4.942519187927246, 3.4119739532470703, 4.7957353591918945, 2.575934410095215, 4.246882915496826, 4.545546054840088, 3.6478865146636963, 4.202261924743652, 5.619180202484131, 5.234711647033691, 5.680245399475098, 5.260946750640869, 5.563271999359131, 3.742388963699341, 3.931974411010742, 5.679912567138672, 3.563657283782959, 2.904597282409668, 3.590378761291504, 3.612727642059326, 6.44627571105957, 4.474798202514648, 4.294536590576172, 3.7400403022766113, 2.1151533126831055, 3.1312689781188965, 3.950369358062744, 5.445974349975586, 4.803182125091553, 3.8749618530273438, 1.3450183868408203, 6.253392219543457, 1.9752047061920166, 6.304536819458008, 5.411163330078125, 3.810365676879883, 3.5681138038635254, 3.809828758239746, 3.622735023498535, 4.097991943359375, 6.330957889556885, 3.7958693504333496, 5.148860454559326, 4.8441877365112305, 5.524986267089844, 0.8355775475502014, 5.1439666748046875, 4.321881294250488, 4.646299362182617, 3.834197759628296, 4.83148193359375, 4.582906723022461, 5.278829097747803, 6.2285237312316895, 4.447964191436768, 4.104674816131592, 3.4479212760925293, 3.1592140197753906, 3.3328285217285156, 4.986971855163574, 5.20344352722168, 5.139840126037598, 4.670019626617432, 5.133448600769043, 4.3845930099487305, 5.598108768463135, 3.975767135620117, 4.183244705200195], "mean_td_error": 4.334644794464111, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 11.0, "diff_num_grad_updates_vs_sampler_policy": 10.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.165035247802734, "actor_loss": -4.286031246185303, "critic_loss": 0.9077425599098206, "alpha_loss": -0.030507700517773628, "alpha_value": 0.9970032572746277, "log_alpha_value": -0.003001239150762558, "target_entropy": -6.0, "policy_t": 0.01982922852039337, "mean_q": 0.1783246397972107, "max_q": 1.586320161819458, "min_q": 0.11407658457756042}, "td_error": [0.7181352376937866, 1.967111587524414, 2.0011119842529297, 3.2708423137664795, 3.126462936401367, 1.900456190109253, 2.552525520324707, 1.253432273864746, 3.8281259536743164, 1.3048778772354126, 0.47142502665519714, 2.8858730792999268, 1.346997618675232, 2.4844565391540527, 2.1250669956207275, 1.8957698345184326, 1.3445249795913696, 3.8295135498046875, 1.4497485160827637, 2.204010486602783, 2.151421070098877, 2.3716111183166504, 3.120068311691284, 0.7076394557952881, 3.5535221099853516, 3.5699782371520996, 1.7521967887878418, 1.5013959407806396, 3.75490140914917, 3.294830322265625, 3.3851284980773926, 1.6009024381637573, 2.8501007556915283, 1.527234673500061, 1.540023684501648, 3.6165244579315186, 1.8814091682434082, 1.1339430809020996, 2.652644395828247, 2.1555323600769043, 1.9774763584136963, 1.2647937536239624, 4.0724663734436035, 3.9274003505706787, 2.6752126216888428, 3.6027636528015137, 2.1393520832061768, 2.0210630893707275, 1.9119850397109985, 4.9225263595581055, 0.31801337003707886, 1.565700888633728, 4.581596374511719, 3.64516544342041, 2.6187305450439453, 2.658886671066284, 2.495976448059082, 2.149150848388672, 2.6769347190856934, 2.3227081298828125, 1.7845640182495117, 2.451808452606201, 2.0358340740203857, 2.8036141395568848, 2.698671817779541, 4.288727760314941, 2.667952060699463, 2.5809850692749023, 3.1067168712615967, 0.5689417719841003, 0.43056559562683105, 1.5182020664215088, 0.42248839139938354, 1.9667036533355713, 3.5642788410186768, 1.8826364278793335, 2.8079357147216797, 1.068244218826294, 1.3177101612091064, 2.055861234664917, 3.6117143630981445, 2.3882598876953125, 2.7827367782592773, 3.867091655731201, 2.698071002960205, 3.279461145401001], "mean_td_error": 2.3753387928009033, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 11.0, "diff_num_grad_updates_vs_sampler_policy": 10.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.147493362426758, "actor_loss": -4.303540229797363, "critic_loss": 1.095236897468567, "alpha_loss": -0.030464040115475655, "alpha_value": 0.997002363204956, "log_alpha_value": -0.00300212437286973, "target_entropy": -6.0, "policy_t": 0.0023443163372576237, "mean_q": 0.24415279924869537, "max_q": 1.7695631980895996, "min_q": 0.1513451337814331}, "td_error": [1.9826889038085938, 3.6801395416259766, 2.4353084564208984, 2.597014904022217, 2.350944757461548, 3.2799999713897705, 1.9010601043701172, 2.284287452697754, 2.4811129570007324, 1.1427996158599854, 0.8274329304695129, 1.752364993095398, 2.410672664642334, 1.3038787841796875, 1.177423357963562, 4.243104934692383, 3.1673390865325928, 2.054600715637207, 2.838587760925293, 2.5279369354248047, 1.4359221458435059, 2.0319888591766357, 2.278531074523926, 3.745614528656006, 3.351713180541992, 4.706402778625488, 2.67309308052063, 1.9061651229858398, 3.9740850925445557, 2.0837883949279785, 0.9334490299224854, 3.829277992248535, 3.323509454727173, 2.079468011856079, 3.740917205810547, 1.9758533239364624, 3.29752779006958, 2.493468999862671, 1.9752271175384521, 4.103254795074463, 1.626434564590454, 2.7960739135742188, 5.295487403869629, 2.1492812633514404, 1.014564037322998, 3.401059150695801, 2.9943299293518066, 2.9711532592773438, 2.3122355937957764, 2.837132453918457, 1.7662752866744995, 3.608745574951172, 3.3118252754211426, 3.5891711711883545, 2.7748398780822754, 3.1474785804748535, 3.8873748779296875, 2.497612953186035, 0.9882279634475708, 1.9357175827026367, 2.7003698348999023, 3.279517412185669, 2.451287269592285, 4.148920059204102, 3.086074113845825, 0.7542428970336914, 2.086001396179199, 3.6660680770874023, 3.4903454780578613, 1.1153497695922852, 1.9547311067581177, 4.009676933288574, 3.7811055183410645, 0.5882808566093445, 2.390787363052368, 3.7640461921691895, 2.7416653633117676, 1.0741631984710693, 2.1973328590393066, 2.3637137413024902, 2.493701934814453, 1.1728665828704834, 3.044735908508301, 2.0938541889190674, 1.1757872104644775, 2.40814208984375], "mean_td_error": 2.573438882827759, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 11.0, "diff_num_grad_updates_vs_sampler_policy": 10.0}}, "num_env_steps_sampled": 10752, "num_env_steps_trained": 2838, "num_agent_steps_sampled": 32256, "num_agent_steps_trained": 2838, "last_target_update_ts": 10752, "num_target_updates": 11}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32256, "num_agent_steps_trained": 2838, "num_env_steps_sampled": 10752, "num_env_steps_trained": 2838, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 790.2584915912597, "num_env_steps_trained_throughput_per_sec": 227.55211030194755, "timesteps_total": 10752, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 32256, "timers": {"training_iteration_time_ms": 1042.176, "sample_time_ms": 739.54, "load_time_ms": 0.317, "load_throughput": 814121.601, "learn_time_ms": 18.366, "learn_throughput": 14047.439, "synch_weights_time_ms": 10.428}, "counters": {"num_env_steps_sampled": 10752, "num_env_steps_trained": 2838, "num_agent_steps_sampled": 32256, "num_agent_steps_trained": 2838, "last_target_update_ts": 10752, "num_target_updates": 11}, "done": false, "episodes_total": 0, "training_iteration": 10, "trial_id": "95c7c_00000", "date": "2023-11-18_20-53-52", "timestamp": 1700369632, "time_this_iter_s": 1.143876314163208, "time_total_s": 12.848768472671509, "pid": 5649, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16bd41c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 12.848768472671509, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 75.45, "ram_util_percent": 66.05}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.109809875488281, "actor_loss": -4.305216312408447, "critic_loss": 2.48746395111084, "alpha_loss": -0.03639701008796692, "alpha_value": 0.9964063167572021, "log_alpha_value": -0.003600167576223612, "target_entropy": -6.0, "policy_t": 0.011087572202086449, "mean_q": 0.36529359221458435, "max_q": 3.293482780456543, "min_q": 0.18480157852172852}, "td_error": [0.9433842897415161, 1.9765992164611816, 3.9463510513305664, 2.727703332901001, 2.7517218589782715, 4.482998847961426, 1.8056695461273193, 4.201959609985352, 2.914834499359131, 5.115915298461914, 4.541225433349609, 4.759087562561035, 4.218952655792236, 4.17579460144043, 4.99332332611084, 4.898510932922363, 2.2456164360046387, 4.193392753601074, 2.859297037124634, 3.583885431289673, 6.1222076416015625, 6.302477836608887, 3.2831339836120605, 3.9504036903381348, 5.626270294189453, 4.596126556396484, 3.3915910720825195, 5.141777038574219, 5.83526611328125, 2.8725156784057617, 4.810335159301758, 4.313506126403809, 6.253018379211426, 4.862612247467041, 5.964191436767578, 5.192177772521973, 4.058189392089844, 4.6861772537231445, 2.2600502967834473, 4.240320205688477, 4.443892478942871, 4.239752769470215, 5.902734279632568, 4.221334934234619, 3.5149855613708496, 3.0311474800109863, 5.520572662353516, 5.69377326965332, 5.48723030090332, 5.8763298988342285, 4.891138076782227, 5.341023921966553, 5.6846513748168945, 4.770610809326172, 3.986008644104004, 3.8821945190429688, 5.687950134277344, 6.805655479431152, 2.863884925842285, 5.393525123596191, 5.435431480407715, 3.210348606109619, 4.485921859741211, 2.7038302421569824, 2.7121963500976562, 2.3236305713653564, 3.8129260540008545, 3.134986400604248, 3.693856716156006, 5.536086082458496, 3.626281261444092, 5.491139888763428, 1.2238260507583618, 5.89759635925293, 3.6285147666931152, 4.753968238830566, 2.935574531555176, 5.7011308670043945, 4.765088081359863, 4.054355144500732, 5.523789405822754, 4.617278099060059, 4.883668899536133, 5.869015693664551, 6.059822082519531, 3.5861289501190186], "mean_td_error": 4.325620651245117, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 13.0, "diff_num_grad_updates_vs_sampler_policy": 12.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.096890449523926, "actor_loss": -4.252850532531738, "critic_loss": 0.7625004053115845, "alpha_loss": -0.03636845946311951, "alpha_value": 0.9964045286178589, "log_alpha_value": -0.0036019464023411274, "target_entropy": -6.0, "policy_t": -0.0025091480929404497, "mean_q": 0.2503845989704132, "max_q": 2.079531192779541, "min_q": 0.14951524138450623}, "td_error": [1.5249537229537964, 4.650465965270996, 3.9394781589508057, 3.5179691314697266, 3.0587406158447266, 3.4655134677886963, 2.0798227787017822, 6.288352966308594, 2.3155810832977295, 3.329982042312622, 3.6250882148742676, 2.5474114418029785, 3.3890371322631836, 2.5274481773376465, 1.9012396335601807, 1.9641289710998535, 1.8373773097991943, 4.795395374298096, 0.8918128609657288, 1.499010443687439, 3.5992228984832764, 1.032940149307251, 2.1875388622283936, 4.300107002258301, 2.7302393913269043, 3.219539165496826, 1.785167932510376, 3.077108144760132, 2.4795126914978027, 2.7533228397369385, 2.8683218955993652, 4.875880718231201, 2.239183187484741, 2.7455530166625977, 2.5499260425567627, 2.2544517517089844, 3.235785484313965, 2.7672266960144043, 2.918471336364746, 0.12703458964824677, 3.990980625152588, 2.194812297821045, 3.242093563079834, 0.3665367364883423, 2.393803358078003, 2.2927207946777344, 2.181910514831543, 3.2026047706604004, 2.0425963401794434, 2.059462547302246, 3.9461748600006104, 4.2035813331604, 2.7570693492889404, 1.961835503578186, 2.0751523971557617, 2.725644111633301, 2.6828956604003906, 3.291975975036621, 4.320405006408691, 3.2643566131591797, 2.0462772846221924, 2.998004913330078, 2.454761505126953, 1.3008944988250732, 2.896418571472168, 1.346257209777832, 3.8476085662841797, 0.9315202236175537, 2.7184393405914307, 1.8967690467834473, 1.3275383710861206, 3.3939013481140137, 0.26052844524383545, 2.253915309906006, 1.7575786113739014, 2.4138760566711426, 1.0203139781951904, 3.3228254318237305, 2.6454715728759766, 2.283327102661133, 2.6241490840911865, 1.5813813209533691, 3.2491683959960938, 1.2009564638137817, 1.3398330211639404, 2.430985450744629], "mean_td_error": 2.60040283203125, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 13.0, "diff_num_grad_updates_vs_sampler_policy": 12.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.057740211486816, "actor_loss": -4.261799335479736, "critic_loss": 0.9710984826087952, "alpha_loss": -0.03623589500784874, "alpha_value": 0.996403694152832, "log_alpha_value": -0.0036027871537953615, "target_entropy": -6.0, "policy_t": -0.01473917718976736, "mean_q": 0.30691030621528625, "max_q": 1.9157397747039795, "min_q": 0.19563564658164978}, "td_error": [1.760099172592163, 3.0331411361694336, 1.6067535877227783, 0.8479318618774414, 1.9148585796356201, 1.0190374851226807, 3.3497486114501953, 1.5079147815704346, 1.0531023740768433, 3.229201316833496, 1.8300340175628662, 3.9320130348205566, 1.2241578102111816, 2.590709686279297, 1.141021728515625, 2.336388111114502, 3.1364879608154297, 2.025351047515869, 1.7770299911499023, 1.201297640800476, 2.4377307891845703, 3.659473419189453, 2.746320962905884, 2.7267491817474365, 2.4488444328308105, 2.288973331451416, 3.32155179977417, 3.4347691535949707, 3.587277889251709, 2.665609359741211, 3.0794239044189453, 3.106231689453125, 3.4588637351989746, 1.6204776763916016, 2.2128653526306152, 1.5126941204071045, 3.5466251373291016, 2.6304070949554443, 1.6974972486495972, 2.3503293991088867, 1.2176449298858643, 3.1976170539855957, 0.5641158819198608, 1.7900099754333496, 3.962672233581543, 2.6812233924865723, 3.662684679031372, 1.063859224319458, 4.025486469268799, 2.705949068069458, 0.2075953483581543, 2.512167453765869, 1.2476766109466553, 2.8540101051330566, 1.8582980632781982, 2.5566210746765137, 3.321528911590576, 2.445713520050049, 2.912205696105957, 2.246894359588623, 2.50590181350708, 2.942270278930664, 3.1268208026885986, 0.1993558704853058, 3.0839650630950928, 2.526515007019043, 0.7816149592399597, 3.0580222606658936, 4.399024486541748, 1.8137483596801758, 2.2760403156280518, 2.422457695007324, 1.3465263843536377, 1.0734717845916748, 2.8015213012695312, 2.037490129470825, 2.390420436859131, 0.9370843172073364, 0.2753768563270569, 3.923572540283203, 2.5470569133758545, 2.002349853515625, 2.4077064990997314, 2.7123117446899414, 1.6638851165771484, 2.4425840377807617], "mean_td_error": 2.323024034500122, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 13.0, "diff_num_grad_updates_vs_sampler_policy": 12.0}}, "num_env_steps_sampled": 12544, "num_env_steps_trained": 3354, "num_agent_steps_sampled": 37632, "num_agent_steps_trained": 3354, "last_target_update_ts": 12544, "num_target_updates": 13}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37632, "num_agent_steps_trained": 3354, "num_env_steps_sampled": 12544, "num_env_steps_trained": 3354, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 922.0041727101615, "num_env_steps_trained_throughput_per_sec": 265.4878086598456, "timesteps_total": 12544, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 37632, "timers": {"training_iteration_time_ms": 1035.983, "sample_time_ms": 745.425, "load_time_ms": 0.315, "load_throughput": 818989.202, "learn_time_ms": 18.12, "learn_throughput": 14238.596, "synch_weights_time_ms": 10.676}, "counters": {"num_env_steps_sampled": 12544, "num_env_steps_trained": 3354, "num_agent_steps_sampled": 37632, "num_agent_steps_trained": 3354, "last_target_update_ts": 12544, "num_target_updates": 13}, "done": false, "episodes_total": 0, "training_iteration": 11, "trial_id": "95c7c_00000", "date": "2023-11-18_20-53-54", "timestamp": 1700369634, "time_this_iter_s": 1.9526240825653076, "time_total_s": 14.801392555236816, "pid": 5649, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16bd43920>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 14.801392555236816, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 68.46666666666667, "ram_util_percent": 66.03333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.100591659545898, "actor_loss": -4.319757461547852, "critic_loss": 2.445807933807373, "alpha_loss": -0.039395298808813095, "alpha_value": 0.996107280254364, "log_alpha_value": -0.003900296287611127, "target_entropy": -6.0, "policy_t": 0.00460090022534132, "mean_q": 0.32941415905952454, "max_q": 3.711625814437866, "min_q": 0.2086937427520752}, "td_error": [4.154938697814941, 5.514412879943848, 5.086851119995117, 2.651150941848755, 6.4963483810424805, 3.5223031044006348, 3.8865771293640137, 4.146821975708008, 4.575410842895508, 5.5331315994262695, 4.984800338745117, 4.126982688903809, 3.8950448036193848, 4.4318718910217285, 5.255526542663574, 2.7169618606567383, 3.472872495651245, 5.652792930603027, 5.2957000732421875, 4.546271800994873, 1.5205328464508057, 5.46817684173584, 1.9931588172912598, 5.712594985961914, 4.433971405029297, 2.412799835205078, 3.8047385215759277, 5.052873611450195, 6.331630706787109, 3.997859477996826, 1.4668952226638794, 5.823176383972168, 5.1763014793396, 3.9862875938415527, 3.4130587577819824, 5.543740272521973, 5.075592517852783, 2.665174961090088, 3.6560113430023193, 3.58111834526062, 5.604550361633301, 4.570775032043457, 5.15703010559082, 1.8294841051101685, 2.6029582023620605, 3.5291099548339844, 4.283538341522217, 4.116674423217773, 3.8929343223571777, 4.914196968078613, 5.6348114013671875, 5.133098602294922, 5.671288013458252, 3.6449294090270996, 3.7386727333068848, 6.650965690612793, 2.1317386627197266, 3.087430477142334, 3.51708984375, 5.710265159606934, 2.878535032272339, 6.084733963012695, 5.967287063598633, 6.01116943359375, 4.634120941162109, 4.3668413162231445, 4.291243553161621, 5.935781478881836, 3.8328466415405273, 2.8840599060058594, 5.27214241027832, 3.5758588314056396, 3.6781253814697266, 3.331258773803711, 3.922142505645752, 4.579200744628906, 4.708161354064941, 3.4086525440216064, 4.733120441436768, 3.868044853210449, 5.554070949554443, 2.727898359298706, 5.429286956787109, 2.4102485179901123, 4.665729522705078, 3.6394600868225098], "mean_td_error": 4.2892327308654785, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 14.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.059530258178711, "actor_loss": -4.237884521484375, "critic_loss": 0.7111632227897644, "alpha_loss": -0.03925526514649391, "alpha_value": 0.9961053133010864, "log_alpha_value": -0.0039022958371788263, "target_entropy": -6.0, "policy_t": -0.02160211279988289, "mean_q": 0.3066861927509308, "max_q": 1.9348729848861694, "min_q": 0.16916495561599731}, "td_error": [2.694908618927002, 1.2035624980926514, 1.909677505493164, 3.3623337745666504, 2.665295362472534, 3.8886919021606445, 2.137881278991699, 2.9778096675872803, 3.671879768371582, 0.10230422019958496, 0.9668517708778381, 2.2064621448516846, 0.22808343172073364, 2.4422948360443115, 2.845162868499756, 0.9301772117614746, 2.6491942405700684, 1.9681947231292725, 2.7180261611938477, 2.7066776752471924, 1.7198867797851562, 1.7714529037475586, 3.0364298820495605, 3.1376445293426514, 1.5338385105133057, 3.4900918006896973, 2.036062717437744, 2.2521309852600098, 1.8772170543670654, 3.3050217628479004, 3.9367294311523438, 0.775357723236084, 3.8441362380981445, 0.9782249331474304, 1.608357310295105, 2.7632293701171875, 1.6219687461853027, 2.7815377712249756, 2.610581398010254, 4.079522609710693, 2.150773525238037, 2.9950053691864014, 4.228447437286377, 2.44467830657959, 2.863748073577881, 3.4117016792297363, 4.971705436706543, 2.137375831604004, 3.73150897026062, 2.0142602920532227, 3.0756773948669434, 0.22808343172073364, 4.087221145629883, 3.93563175201416, 1.221326231956482, 1.375396490097046, 1.491019606590271, 0.6261390447616577, 2.4822592735290527, 2.999873161315918, 2.3212013244628906, 2.402958869934082, 3.3023948669433594, 1.7927757501602173, 2.387138843536377, 1.8606535196304321, 3.0050320625305176, 3.4248290061950684, 2.352233409881592, 1.9150629043579102, 3.2970402240753174, 0.3122214674949646, 3.207131862640381, 3.6048169136047363, 1.4067270755767822, 2.5728492736816406, 3.7874202728271484, 0.73935467004776, 0.6697779297828674, 1.8532795906066895, 4.130754470825195, 4.43002986907959, 3.126824140548706, 3.3619251251220703, 2.2505736351013184, 1.9118499755859375], "mean_td_error": 2.457366943359375, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 14.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.076859474182129, "actor_loss": -4.307673931121826, "critic_loss": 1.0105150938034058, "alpha_loss": -0.03933042287826538, "alpha_value": 0.9961045384407043, "log_alpha_value": -0.003903043922036886, "target_entropy": -6.0, "policy_t": -0.008901714347302914, "mean_q": 0.2913978397846222, "max_q": 2.652769088745117, "min_q": 0.220173180103302}, "td_error": [1.4607517719268799, 2.278139114379883, 2.5298972129821777, 3.7868714332580566, 1.4289460182189941, 3.913667917251587, 3.720738172531128, 2.9943442344665527, 4.5259857177734375, 2.689711570739746, 0.5121055841445923, 3.351917266845703, 2.7524352073669434, 1.431785225868225, 1.686186671257019, 2.023007869720459, 2.1795811653137207, 2.5743720531463623, 2.3339009284973145, 0.9644641876220703, 0.9774268865585327, 2.8498220443725586, 3.2908952236175537, 1.5505019426345825, 3.0579593181610107, 3.4611105918884277, 3.2731566429138184, 2.9386749267578125, 1.0112483501434326, 2.6585886478424072, 2.00404691696167, 1.2876827716827393, 2.4016265869140625, 0.6782863140106201, 4.527863502502441, 1.5166981220245361, 1.3248353004455566, 2.1336727142333984, 1.4397356510162354, 2.416485071182251, 2.0370497703552246, 2.7709908485412598, 1.4641404151916504, 1.6115995645523071, 3.236743927001953, 2.591742992401123, 3.139401435852051, 1.37269926071167, 1.198415994644165, 3.420806884765625, 2.3361425399780273, 3.213487148284912, 3.228299617767334, 1.4229846000671387, 4.047836780548096, 0.6042037606239319, 2.6074106693267822, 3.1024489402770996, 1.768435001373291, 0.8408674597740173, 3.546286106109619, 2.9101412296295166, 2.151017427444458, 1.82785964012146, 2.506054639816284, 1.7999004125595093, 3.5795745849609375, 1.006624698638916, 1.8979160785675049, 2.392279624938965, 4.663442611694336, 4.098896503448486, 4.072071552276611, 1.5643224716186523, 1.8534826040267944, 4.396759986877441, 4.102935314178467, 2.618896007537842, 2.8047571182250977, 1.8656338453292847, 1.0616966485977173, 1.797884464263916, 1.2249099016189575, 3.286888360977173, 2.8684754371643066, 1.6987476348876953], "mean_td_error": 2.4133989810943604, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 14.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 13440, "num_env_steps_trained": 3612, "num_agent_steps_sampled": 40320, "num_agent_steps_trained": 3612, "last_target_update_ts": 13440, "num_target_updates": 14}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40320, "num_agent_steps_trained": 3612, "num_env_steps_sampled": 13440, "num_env_steps_trained": 3612, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 840.9583152264152, "num_env_steps_trained_throughput_per_sec": 242.15094344689186, "timesteps_total": 13440, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 40320, "timers": {"training_iteration_time_ms": 1041.279, "sample_time_ms": 753.372, "load_time_ms": 0.319, "load_throughput": 809493.142, "learn_time_ms": 18.044, "learn_throughput": 14298.537, "synch_weights_time_ms": 10.724}, "counters": {"num_env_steps_sampled": 13440, "num_env_steps_trained": 3612, "num_agent_steps_sampled": 40320, "num_agent_steps_trained": 3612, "last_target_update_ts": 13440, "num_target_updates": 14}, "done": false, "episodes_total": 0, "training_iteration": 12, "trial_id": "95c7c_00000", "date": "2023-11-18_20-53-55", "timestamp": 1700369635, "time_this_iter_s": 1.0742347240447998, "time_total_s": 15.875627279281616, "pid": 5649, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16bdf5260>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 15.875627279281616, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 82.1, "ram_util_percent": 66.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.073997497558594, "actor_loss": -4.324913024902344, "critic_loss": 2.4116148948669434, "alpha_loss": -0.04231543093919754, "alpha_value": 0.9958083629608154, "log_alpha_value": -0.00420045992359519, "target_entropy": -6.0, "policy_t": 0.01213741023093462, "mean_q": 0.2895929515361786, "max_q": 1.9162299633026123, "min_q": 0.23373961448669434}, "td_error": [4.482856750488281, 2.6145846843719482, 4.341188430786133, 1.7881187200546265, 2.821362018585205, 4.994416236877441, 4.177328586578369, 4.376395225524902, 4.450007915496826, 4.832606315612793, 4.565154075622559, 1.3397877216339111, 3.390237808227539, 5.6384992599487305, 3.4490880966186523, 4.432196617126465, 3.3452885150909424, 4.083170413970947, 2.6646645069122314, 5.643902778625488, 3.9318113327026367, 4.583743095397949, 4.850423812866211, 3.9562630653381348, 4.0228657722473145, 3.473862886428833, 4.412118911743164, 5.106528282165527, 4.116133689880371, 5.9736480712890625, 4.721471786499023, 5.780591011047363, 2.8715109825134277, 3.826094627380371, 3.2301511764526367, 3.5603771209716797, 4.9075469970703125, 2.443009376525879, 4.4236226081848145, 4.129920959472656, 4.245906829833984, 5.24903678894043, 4.075380325317383, 3.433271646499634, 5.791647434234619, 5.42529296875, 3.5402936935424805, 3.690119743347168, 3.4520692825317383, 2.898629665374756, 3.2811806201934814, 3.5349209308624268, 3.7302513122558594, 2.7508816719055176, 4.8347930908203125, 3.764435291290283, 6.559320449829102, 3.6211204528808594, 4.996737480163574, 5.486227035522461, 5.277033805847168, 6.116354942321777, 3.3565797805786133, 3.5380427837371826, 2.8925821781158447, 3.2268927097320557, 4.834224700927734, 5.364725112915039, 3.077512741088867, 4.925570011138916, 3.6555824279785156, 3.7243971824645996, 3.6830945014953613, 5.034154891967773, 5.300005912780762, 4.047411918640137, 3.805495500564575, 4.490231513977051, 5.107793807983398, 6.695103168487549, 4.634522438049316, 5.500547885894775, 3.9013423919677734, 4.187672138214111, 4.334878921508789, 3.6303329467773438], "mean_td_error": 4.19135046005249, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 15.0, "diff_num_grad_updates_vs_sampler_policy": 14.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.090401649475098, "actor_loss": -4.292730808258057, "critic_loss": 0.7934988737106323, "alpha_loss": -0.042405866086483, "alpha_value": 0.9958062171936035, "log_alpha_value": -0.004202594514936209, "target_entropy": -6.0, "policy_t": 0.006722554564476013, "mean_q": 0.2544468641281128, "max_q": 1.9423186779022217, "min_q": 0.1902112066745758}, "td_error": [0.4484819769859314, 3.4189279079437256, 1.6361734867095947, 2.3301219940185547, 0.7526098489761353, 2.389247179031372, 2.6573634147644043, 4.326236724853516, 3.204228401184082, 3.288952350616455, 3.044358730316162, 2.119231700897217, 2.4810938835144043, 3.233826160430908, 1.3477840423583984, 0.13008219003677368, 0.9947893023490906, 3.803776264190674, 2.613931655883789, 3.360438346862793, 2.660740613937378, 1.7734540700912476, 3.1657752990722656, 3.4643940925598145, 2.5251870155334473, 2.7493486404418945, 2.948314666748047, 3.167055130004883, 2.8387131690979004, 2.4582340717315674, 4.350093841552734, 0.4541768729686737, 1.8180794715881348, 3.979790687561035, 2.641528606414795, 3.781116008758545, 1.8293014764785767, 3.952158212661743, 3.8000271320343018, 0.8167442679405212, 0.7051909565925598, 3.5910024642944336, 2.3994460105895996, 4.117668151855469, 1.1715266704559326, 2.2253193855285645, 5.628017425537109, 2.5497641563415527, 0.6542048454284668, 3.9257724285125732, 4.108538627624512, 1.1063262224197388, 3.4506964683532715, 3.7959673404693604, 3.10945725440979, 3.295896530151367, 2.405380964279175, 1.3825281858444214, 4.784645080566406, 3.520254135131836, 4.044203758239746, 0.9117802381515503, 4.292360305786133, 2.762620687484741, 3.661738395690918, 2.1429851055145264, 0.11051884293556213, 2.857530117034912, 2.913529872894287, 2.483705759048462, 1.4925885200500488, 2.505833387374878, 3.2362265586853027, 5.461647033691406, 2.695568561553955, 1.758819818496704, 2.8999786376953125, 3.6835269927978516, 1.319912314414978, 3.4958462715148926, 1.0070942640304565, 1.7977373600006104, 2.3171162605285645, 2.084045886993408, 3.4486241340637207, 5.180013179779053], "mean_td_error": 2.6889421939849854, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 15.0, "diff_num_grad_updates_vs_sampler_policy": 14.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.069841384887695, "actor_loss": -4.3288068771362305, "critic_loss": 0.9662390351295471, "alpha_loss": -0.042326174676418304, "alpha_value": 0.995805561542511, "log_alpha_value": -0.004203260876238346, "target_entropy": -6.0, "policy_t": 0.04225483164191246, "mean_q": 0.4890809655189514, "max_q": 2.9832677841186523, "min_q": 0.24633488059043884}, "td_error": [0.9825258255004883, 3.9733591079711914, 3.559725522994995, 2.6399528980255127, 2.0147979259490967, 0.08720636367797852, 3.3656005859375, 1.8168977499008179, 0.09092593193054199, 3.755404472351074, 1.8677632808685303, 1.8956137895584106, 4.057949066162109, 0.8391057252883911, 1.8287358283996582, 2.267866849899292, 1.668069839477539, 1.6296356916427612, 0.4311497211456299, 2.470604419708252, 1.1138992309570312, 4.329110622406006, 2.014329433441162, 1.6134226322174072, 3.080288887023926, 0.3895599842071533, 1.0922802686691284, 1.4401918649673462, 0.9341194033622742, 3.2328193187713623, 1.56269109249115, 2.146313190460205, 2.541102886199951, 3.8032782077789307, 2.469778060913086, 3.5500874519348145, 2.9506611824035645, 3.489856719970703, 2.8885226249694824, 3.402754068374634, 1.7587239742279053, 1.9584418535232544, 2.7581911087036133, 3.8102164268493652, 2.2748119831085205, 1.8653738498687744, 4.906508445739746, 2.4218759536743164, 2.323995590209961, 2.155514717102051, 2.977066993713379, 2.8987202644348145, 3.0224642753601074, 2.2321524620056152, 0.4638468027114868, 1.721088171005249, 2.4911227226257324, 2.4892005920410156, 3.0537571907043457, 3.197068452835083, 2.2384345531463623, 0.5796908140182495, 1.2224055528640747, 1.8301161527633667, 2.9321494102478027, 2.7052645683288574, 2.60446834564209, 2.840359926223755, 1.8245043754577637, 2.232445001602173, 1.4334757328033447, 2.6771769523620605, 2.440500259399414, 1.9198194742202759, 2.8465757369995117, 0.12824726104736328, 5.080129623413086, 2.846200466156006, 1.826220989227295, 1.8467971086502075, 0.7073927521705627, 2.9267921447753906, 3.194504976272583, 0.9591782093048096, 4.8209228515625, 2.188133716583252], "mean_td_error": 2.313023567199707, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 15.0, "diff_num_grad_updates_vs_sampler_policy": 14.0}}, "num_env_steps_sampled": 14336, "num_env_steps_trained": 3870, "num_agent_steps_sampled": 43008, "num_agent_steps_trained": 3870, "last_target_update_ts": 14336, "num_target_updates": 15}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 43008, "num_agent_steps_trained": 3870, "num_env_steps_sampled": 14336, "num_env_steps_trained": 3870, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 856.3443701245109, "num_env_steps_trained_throughput_per_sec": 246.58130300460246, "timesteps_total": 14336, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 43008, "timers": {"training_iteration_time_ms": 1045.557, "sample_time_ms": 758.969, "load_time_ms": 0.318, "load_throughput": 811070.628, "learn_time_ms": 18.059, "learn_throughput": 14286.361, "synch_weights_time_ms": 10.508}, "counters": {"num_env_steps_sampled": 14336, "num_env_steps_trained": 3870, "num_agent_steps_sampled": 43008, "num_agent_steps_trained": 3870, "last_target_update_ts": 14336, "num_target_updates": 15}, "done": false, "episodes_total": 0, "training_iteration": 13, "trial_id": "95c7c_00000", "date": "2023-11-18_20-53-56", "timestamp": 1700369636, "time_this_iter_s": 1.055124044418335, "time_total_s": 16.93075132369995, "pid": 5649, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16bd41c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 16.93075132369995, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 70.35, "ram_util_percent": 66.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.039875030517578, "actor_loss": -4.320031642913818, "critic_loss": 2.459561347961426, "alpha_loss": -0.04518551751971245, "alpha_value": 0.9955095052719116, "log_alpha_value": -0.0045006051659584045, "target_entropy": -6.0, "policy_t": 0.05079234391450882, "mean_q": 0.3907061219215393, "max_q": 3.366084575653076, "min_q": 0.26035550236701965}, "td_error": [4.40333366394043, 2.613311529159546, 3.9392380714416504, 4.615302085876465, 3.858081102371216, 4.5824995040893555, 3.7307567596435547, 5.264469146728516, 5.234238147735596, 4.670651435852051, 3.936400890350342, 4.456949234008789, 3.981837749481201, 6.4393630027771, 3.3994572162628174, 3.8668503761291504, 4.4960222244262695, 3.3203206062316895, 1.4485104084014893, 5.268571853637695, 3.4459896087646484, 3.3183107376098633, 2.674583911895752, 3.8274316787719727, 2.677067756652832, 3.593834400177002, 3.1897850036621094, 4.396288871765137, 4.696526527404785, 2.0672740936279297, 5.739141464233398, 4.475276470184326, 5.651816368103027, 3.3621630668640137, 4.376708984375, 2.9849321842193604, 6.801582336425781, 4.166081428527832, 3.461287260055542, 5.289966106414795, 4.1350860595703125, 4.079012870788574, 6.3248186111450195, 4.960848808288574, 3.3984951972961426, 4.4571943283081055, 3.043532609939575, 4.0871381759643555, 3.5482983589172363, 3.516604423522949, 3.5133907794952393, 4.320234298706055, 4.326897621154785, 4.774184703826904, 4.23585844039917, 4.630856513977051, 4.922987937927246, 6.8484392166137695, 5.779569149017334, 3.5425758361816406, 3.447842836380005, 3.4696121215820312, 5.743661880493164, 4.642904281616211, 4.6003899574279785, 5.596668243408203, 3.2549829483032227, 4.411632537841797, 4.913569927215576, 4.636517524719238, 4.496718406677246, 4.088503837585449, 4.921255588531494, 3.6603617668151855, 4.741535186767578, 3.5696558952331543, 5.441864013671875, 7.927127838134766, 4.263511657714844, 5.134209632873535, 3.2231693267822266, 4.491308689117432, 4.532777309417725, 4.148616790771484, 5.1431403160095215, 1.0382288694381714], "mean_td_error": 4.275674343109131, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 16.0, "diff_num_grad_updates_vs_sampler_policy": 15.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.087949752807617, "actor_loss": -4.315023899078369, "critic_loss": 0.6187587976455688, "alpha_loss": -0.04542507231235504, "alpha_value": 0.9955072402954102, "log_alpha_value": -0.00450290460139513, "target_entropy": -6.0, "policy_t": -0.028341438621282578, "mean_q": 0.30858248472213745, "max_q": 2.698138952255249, "min_q": 0.21259769797325134}, "td_error": [2.5013351440429688, 4.2821431159973145, 1.8601481914520264, 1.031334400177002, 1.8746756315231323, 0.4469182789325714, 0.9977139234542847, 0.06922277808189392, 1.626368761062622, 1.7741968631744385, 1.3509029150009155, 3.362208127975464, 1.3703880310058594, 1.1867516040802002, 2.7156944274902344, 2.697066307067871, 2.960756540298462, 2.3984007835388184, 1.468780755996704, 1.0619736909866333, 3.0660407543182373, 3.7812280654907227, 2.7482590675354004, 2.182323694229126, 1.9322242736816406, 3.5567703247070312, 0.2279057502746582, 2.6556549072265625, 3.7583837509155273, 2.1072897911071777, 2.9544577598571777, 0.27032071352005005, 2.6501128673553467, 2.810655117034912, 3.7261276245117188, 3.4624271392822266, 1.3617439270019531, 2.3442845344543457, 0.8275362253189087, 2.5787153244018555, 2.6117663383483887, 2.932114362716675, 0.42176440358161926, 0.3449352979660034, 1.9583845138549805, 1.212714672088623, 0.4941976070404053, 1.7466750144958496, 3.4226505756378174, 2.729424476623535, 2.6648755073547363, 2.955623149871826, 2.7565364837646484, 1.8084161281585693, 1.5865650177001953, 2.5756990909576416, 1.7419071197509766, 1.6025402545928955, 2.218414306640625, 1.8120265007019043, 0.6841658353805542, 4.133431434631348, 2.1790523529052734, 3.313433885574341, 2.9705286026000977, 1.1626718044281006, 1.4471980333328247, 2.047914743423462, 2.141306161880493, 1.3005859851837158, 4.9235124588012695, 2.376753807067871, 1.8196595907211304, 2.3056042194366455, 0.870310366153717, 3.7162303924560547, 1.719226360321045, 3.062311887741089, 1.7566893100738525, 3.9104690551757812, 2.4762754440307617, 3.819333553314209, 3.2502737045288086, 2.2491631507873535, 1.4274568557739258, 3.071349620819092], "mean_td_error": 2.206646203994751, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 16.0, "diff_num_grad_updates_vs_sampler_policy": 15.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.132539749145508, "actor_loss": -4.420450687408447, "critic_loss": 1.0394408702850342, "alpha_loss": -0.04563120752573013, "alpha_value": 0.9955067038536072, "log_alpha_value": -0.004503432661294937, "target_entropy": -6.0, "policy_t": -0.008501238189637661, "mean_q": 0.37895140051841736, "max_q": 2.128201723098755, "min_q": 0.2739051282405853}, "td_error": [1.3849049806594849, 2.476558208465576, 2.8062667846679688, 4.813595294952393, 2.0868754386901855, 3.2196013927459717, 2.476524829864502, 3.347100257873535, 2.0231802463531494, 2.7920446395874023, 1.2595146894454956, 0.9666475653648376, 2.404237747192383, 3.010859727859497, 4.522773742675781, 1.949123501777649, 3.009183645248413, 4.048063278198242, 0.7088388204574585, 2.9101080894470215, 2.6330692768096924, 2.582686424255371, 2.2183985710144043, 0.7322015762329102, 1.781375765800476, 2.3124446868896484, 1.4588160514831543, 4.407486438751221, 3.456505060195923, 2.6255433559417725, 2.9482312202453613, 3.5672645568847656, 3.124791145324707, 1.7000279426574707, 2.667065143585205, 2.5327367782592773, 2.3585681915283203, 2.4568512439727783, 1.8171799182891846, 3.1334245204925537, 2.737104892730713, 3.2391858100891113, 1.09751558303833, 2.8951849937438965, 2.1925430297851562, 3.1999454498291016, 2.1698217391967773, 2.3206095695495605, 1.492297887802124, 1.185282588005066, 3.0339736938476562, 2.1787190437316895, 1.8847910165786743, 1.1917648315429688, 1.6686491966247559, 3.4587044715881348, 1.443251132965088, 3.010495185852051, 2.068681240081787, 3.318678379058838, 1.1307250261306763, 3.109988212585449, 2.227957010269165, 1.3764954805374146, 2.2061963081359863, 2.5626392364501953, 3.000192642211914, 1.4273786544799805, 1.530303955078125, 0.9906216859817505, 2.9124581813812256, 3.891190528869629, 1.036045789718628, 2.5286381244659424, 2.7631540298461914, 2.998034954071045, 2.3358542919158936, 3.2606983184814453, 2.4516491889953613, 0.3302958011627197, 2.9090969562530518, 2.838416337966919, 4.8057026863098145, 3.2006092071533203, 4.646265506744385, 1.2049074172973633], "mean_td_error": 2.467365026473999, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 16.0, "diff_num_grad_updates_vs_sampler_policy": 15.0}}, "num_env_steps_sampled": 15232, "num_env_steps_trained": 4128, "num_agent_steps_sampled": 45696, "num_agent_steps_trained": 4128, "last_target_update_ts": 15232, "num_target_updates": 16}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 45696, "num_agent_steps_trained": 4128, "num_env_steps_sampled": 15232, "num_env_steps_trained": 4128, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 741.0648825300308, "num_env_steps_trained_throughput_per_sec": 213.38698626422763, "timesteps_total": 15232, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 45696, "timers": {"training_iteration_time_ms": 1050.736, "sample_time_ms": 746.868, "load_time_ms": 0.318, "load_throughput": 810888.297, "learn_time_ms": 18.17, "learn_throughput": 14199.23, "synch_weights_time_ms": 10.307}, "counters": {"num_env_steps_sampled": 15232, "num_env_steps_trained": 4128, "num_agent_steps_sampled": 45696, "num_agent_steps_trained": 4128, "last_target_update_ts": 15232, "num_target_updates": 16}, "done": false, "episodes_total": 0, "training_iteration": 14, "trial_id": "95c7c_00000", "date": "2023-11-18_20-53-58", "timestamp": 1700369638, "time_this_iter_s": 1.2196228504180908, "time_total_s": 18.150374174118042, "pid": 5649, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16bd43920>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 18.150374174118042, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 59.6, "ram_util_percent": 66.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.112269401550293, "actor_loss": -4.414783000946045, "critic_loss": 2.428070306777954, "alpha_loss": -0.0485457144677639, "alpha_value": 0.9952108263969421, "log_alpha_value": -0.0048006740398705006, "target_entropy": -6.0, "policy_t": 0.008466335944831371, "mean_q": 0.5050522089004517, "max_q": 5.086731910705566, "min_q": 0.288563072681427}, "td_error": [4.875911235809326, 4.210650444030762, 4.0262770652771, 2.4229235649108887, 3.480609893798828, 3.9815049171447754, 4.678962707519531, 4.108642578125, 3.08158540725708, 4.646548271179199, 4.356792449951172, 4.260652542114258, 6.225188732147217, 5.895700454711914, 5.866497039794922, 2.2685368061065674, 3.0726664066314697, 3.8851494789123535, 2.7999231815338135, 6.909722328186035, 3.818819999694824, 4.376702785491943, 4.167057037353516, 5.684096336364746, 5.173449993133545, 4.707776069641113, 2.4263110160827637, 4.903446197509766, 4.957608222961426, 2.1099295616149902, 4.33164644241333, 2.7820959091186523, 5.756346225738525, 4.47348690032959, 4.608506202697754, 2.451942205429077, 4.88565731048584, 4.876599311828613, 3.1452174186706543, 4.833454608917236, 3.268240451812744, 4.771171569824219, 4.607299327850342, 3.4213523864746094, 6.700250625610352, 4.747593879699707, 4.6480302810668945, 3.280665159225464, 5.792402744293213, 4.796243190765381, 5.167929649353027, 5.0960845947265625, 5.033167362213135, 5.573665618896484, 4.583038330078125, 5.088160037994385, 0.8623548150062561, 3.0797834396362305, 4.772371292114258, 3.7875728607177734, 4.502169132232666, 4.484585762023926, 3.829925537109375, 5.487101078033447, 2.709554433822632, 0.4607844352722168, 4.353099346160889, 4.141032695770264, 4.353802680969238, 5.180947303771973, 1.9713290929794312, 1.9751017093658447, 4.633085250854492, 4.121461868286133, 4.375026702880859, 4.517253875732422, 2.8022830486297607, 5.041725158691406, 4.038632392883301, 5.093204975128174, 2.633364200592041, 5.979292869567871, 3.7201855182647705, 5.03802490234375, 3.805920124053955, 4.904906272888184], "mean_td_error": 4.218090534210205, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 17.0, "diff_num_grad_updates_vs_sampler_policy": 16.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.133914947509766, "actor_loss": -4.38415002822876, "critic_loss": 0.711203396320343, "alpha_loss": -0.04867541417479515, "alpha_value": 0.9952083230018616, "log_alpha_value": -0.004803218878805637, "target_entropy": -6.0, "policy_t": -0.008049015887081623, "mean_q": 0.34185540676116943, "max_q": 2.9956440925598145, "min_q": 0.23641633987426758}, "td_error": [1.5497997999191284, 2.351029872894287, 1.8643759489059448, 2.7791714668273926, 0.49020180106163025, 2.456251382827759, 3.3488447666168213, 2.8259148597717285, 3.283933162689209, 1.745788812637329, 1.475651741027832, 1.6426341533660889, 2.2056617736816406, 2.6005959510803223, 2.984849214553833, 3.019099712371826, 0.6209065914154053, 2.323373317718506, 2.917656183242798, 1.9300652742385864, 2.6011266708374023, 2.7121710777282715, 1.9409006834030151, 1.9793256521224976, 2.8810431957244873, 2.933872699737549, 2.9027645587921143, 3.0912747383117676, 2.005117416381836, 2.8428516387939453, 2.088871479034424, 2.6221351623535156, 2.1919946670532227, 1.484573245048523, 2.217014789581299, 2.9154491424560547, 3.2359352111816406, 1.646802306175232, 2.725797653198242, 1.2881829738616943, 2.8835062980651855, 0.18633189797401428, 2.452039957046509, 4.133843421936035, 3.2470409870147705, 2.7686452865600586, 3.128419876098633, 3.5161304473876953, 2.9021668434143066, 0.6024747490882874, 1.4427907466888428, 2.6199491024017334, 3.194952964782715, 3.6285793781280518, 2.344280242919922, 0.7713117599487305, 1.4048612117767334, 2.90726900100708, 3.1047000885009766, 0.3480563163757324, 2.5233678817749023, 3.460465669631958, 2.6206841468811035, 3.4522571563720703, 2.2433364391326904, 0.6314022541046143, 1.851926565170288, 2.3614416122436523, 2.4319443702697754, 2.417464256286621, 2.9423367977142334, 2.9003114700317383, 2.5908923149108887, 2.865692615509033, 2.639476776123047, 3.7825331687927246, 3.8164567947387695, 2.7171382904052734, 2.565215826034546, 4.147661209106445, 3.3324403762817383, 2.303237199783325, 2.4300785064697266, 2.755502700805664, 3.375332832336426, 2.3020167350769043], "mean_td_error": 2.4624528884887695, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 17.0, "diff_num_grad_updates_vs_sampler_policy": 16.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0526704788208, "actor_loss": -4.3738508224487305, "critic_loss": 0.8925706148147583, "alpha_loss": -0.04828978702425957, "alpha_value": 0.9952078461647034, "log_alpha_value": -0.0048036775551736355, "target_entropy": -6.0, "policy_t": -0.06391690671443939, "mean_q": 0.47073546051979065, "max_q": 3.65704345703125, "min_q": 0.3033548891544342}, "td_error": [2.5771570205688477, 2.808619976043701, 1.6221429109573364, 2.4553170204162598, 3.114992618560791, 3.1356072425842285, 1.6907925605773926, 2.2392005920410156, 0.24134302139282227, 2.5249691009521484, 4.699153900146484, 2.5941691398620605, 2.3118410110473633, 1.176963210105896, 1.8090791702270508, 2.5436463356018066, 1.8538057804107666, 2.4812419414520264, 4.932936191558838, 2.8030078411102295, 0.11227893829345703, 2.415107250213623, 2.9027132987976074, 1.9811336994171143, 1.2796214818954468, 1.9146361351013184, 3.6855015754699707, 1.527637004852295, 2.4083776473999023, 2.491478443145752, 0.4828515350818634, 2.138601303100586, 2.2201294898986816, 1.0601439476013184, 2.456393003463745, 1.155912160873413, 4.400454521179199, 2.115790843963623, 1.4701166152954102, 1.824204921722412, 2.0103940963745117, 3.9077725410461426, 3.962759494781494, 2.7261693477630615, 3.2397634983062744, 2.759829521179199, 1.620351791381836, 1.1895898580551147, 1.0237915515899658, 3.670116424560547, 4.554546356201172, 1.1452887058258057, 0.9042645692825317, 0.7070648670196533, 3.261491298675537, 2.278175115585327, 0.3071933388710022, 1.6070953607559204, 2.776488780975342, 2.5376148223876953, 0.5515033006668091, 2.888561725616455, 1.0090184211730957, 1.337566614151001, 1.4752336740493774, 2.4469664096832275, 3.0655572414398193, 2.0903730392456055, 1.7372409105300903, 1.8616225719451904, 2.8700809478759766, 2.1043479442596436, 3.3467369079589844, 3.6905887126922607, 0.8030859231948853, 1.4054696559906006, 1.9259123802185059, 1.5136654376983643, 3.0665054321289062, 2.861307382583618, 1.649420976638794, 2.5399584770202637, 0.019853323698043823, 1.270017147064209, 0.1060035228729248, 3.4118471145629883], "mean_td_error": 2.1732239723205566, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 17.0, "diff_num_grad_updates_vs_sampler_policy": 16.0}}, "num_env_steps_sampled": 16128, "num_env_steps_trained": 4386, "num_agent_steps_sampled": 48384, "num_agent_steps_trained": 4386, "last_target_update_ts": 16128, "num_target_updates": 17}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48384, "num_agent_steps_trained": 4386, "num_env_steps_sampled": 16128, "num_env_steps_trained": 4386, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 845.0173550151101, "num_env_steps_trained_throughput_per_sec": 243.3197294574759, "timesteps_total": 16128, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 48384, "timers": {"training_iteration_time_ms": 1053.834, "sample_time_ms": 749.888, "load_time_ms": 0.322, "load_throughput": 801756.266, "learn_time_ms": 18.192, "learn_throughput": 14182.351, "synch_weights_time_ms": 10.319}, "counters": {"num_env_steps_sampled": 16128, "num_env_steps_trained": 4386, "num_agent_steps_sampled": 48384, "num_agent_steps_trained": 4386, "last_target_update_ts": 16128, "num_target_updates": 17}, "done": false, "episodes_total": 0, "training_iteration": 15, "trial_id": "95c7c_00000", "date": "2023-11-18_20-53-59", "timestamp": 1700369639, "time_this_iter_s": 1.069890022277832, "time_total_s": 19.220264196395874, "pid": 5649, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16bd43380>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 19.220264196395874, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 90.4, "ram_util_percent": 66.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.100322723388672, "actor_loss": -4.4372429847717285, "critic_loss": 2.4552464485168457, "alpha_loss": -0.05151982232928276, "alpha_value": 0.9949122071266174, "log_alpha_value": -0.005100809503346682, "target_entropy": -6.0, "policy_t": 0.05123350769281387, "mean_q": 0.4392105042934418, "max_q": 4.082572937011719, "min_q": 0.3186829388141632}, "td_error": [4.069061279296875, 3.2224984169006348, 2.648036003112793, 3.811924695968628, 4.303389072418213, 6.105189323425293, 4.228629112243652, 4.059841632843018, 3.9939746856689453, 2.7668237686157227, 3.0547351837158203, 2.998493194580078, 4.020456314086914, 5.1529645919799805, 4.763580322265625, 4.5860595703125, 4.788809776306152, 3.763249635696411, 3.5041043758392334, 4.523157119750977, 2.1942970752716064, 4.695826530456543, 4.5875654220581055, 3.1157383918762207, 4.131639003753662, 2.896439790725708, 4.693482875823975, 3.2760233879089355, 4.565662860870361, 6.084443092346191, 3.6169116497039795, 4.158970832824707, 4.311758995056152, 5.012270927429199, 4.921708583831787, 4.671659469604492, 3.417106866836548, 4.909012317657471, 5.725052833557129, 3.4539225101470947, 4.0540289878845215, 4.109576225280762, 5.561745643615723, 3.169503688812256, 4.011042594909668, 4.399243354797363, 3.8680505752563477, 4.357120513916016, 5.612671852111816, 6.819956302642822, 5.906278610229492, 3.841268539428711, 4.558170318603516, 7.09608268737793, 3.445927143096924, 5.787573337554932, 3.3371729850769043, 6.119397163391113, 2.81477689743042, 3.5406713485717773, 4.203641414642334, 2.820294141769409, 4.989589214324951, 3.3110909461975098, 5.606910705566406, 4.73889684677124, 5.092192649841309, 4.449942588806152, 2.83969783782959, 4.52509880065918, 5.388059616088867, 3.6063647270202637, 3.708205223083496, 4.217399597167969, 4.1092000007629395, 6.585212707519531, 3.7495315074920654, 5.399179935455322, 5.1880950927734375, 4.474270343780518, 3.881166458129883, 3.672783851623535, 3.253002643585205, 4.976708889007568, 5.90620231628418, 1.771493911743164], "mean_td_error": 4.298592567443848, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 18.0, "diff_num_grad_updates_vs_sampler_policy": 17.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.057116508483887, "actor_loss": -4.332476615905762, "critic_loss": 0.6612952947616577, "alpha_loss": -0.05132768303155899, "alpha_value": 0.994909405708313, "log_alpha_value": -0.005103618372231722, "target_entropy": -6.0, "policy_t": -0.05818811431527138, "mean_q": 0.3260536789894104, "max_q": 2.9901123046875, "min_q": 0.26179882884025574}, "td_error": [0.8831156492233276, 3.88238525390625, 0.759052038192749, 1.726322054862976, 2.7399754524230957, 2.3034772872924805, 2.86163330078125, 2.858389139175415, 2.2305197715759277, 1.1961956024169922, 2.642454147338867, 2.1724700927734375, 0.6580973863601685, 2.870384454727173, 0.2897166609764099, 1.452972650527954, 2.9729695320129395, 1.1422405242919922, 1.9320112466812134, 1.3419489860534668, 3.77101993560791, 2.1138503551483154, 2.6968092918395996, 2.277040481567383, 2.5561954975128174, 3.471794605255127, 2.9060373306274414, 3.379843235015869, 2.2208292484283447, 0.6917614936828613, 2.6828789710998535, 2.1961007118225098, 1.2982733249664307, 1.8001728057861328, 0.8320112824440002, 2.6463613510131836, 2.460381031036377, 1.8267735242843628, 2.6481399536132812, 3.4996628761291504, 2.920250654220581, 1.850290298461914, 3.3636484146118164, 2.9326462745666504, 3.532034397125244, 3.533867359161377, 1.6105592250823975, 3.3714916706085205, 2.0389795303344727, 3.465608596801758, 0.7032004594802856, 4.245833396911621, 2.346428394317627, 1.2892460823059082, 0.609289288520813, 3.2644524574279785, 3.666691303253174, 2.731565475463867, 1.8189585208892822, 1.8368330001831055, 5.031996726989746, 1.9932501316070557, 2.711724281311035, 3.62257719039917, 3.4872589111328125, 1.5183794498443604, 3.312150001525879, 1.4300733804702759, 0.46527886390686035, 2.4214353561401367, 1.9708908796310425, 1.5580576658248901, 2.511399269104004, 3.281459093093872, 2.61985182762146, 2.462806224822998, 2.180868148803711, 2.72713041305542, 1.8253095149993896, 1.9744527339935303, 2.432845115661621, 2.3072776794433594, 1.6282262802124023, 1.1997113227844238, 4.514322280883789, 0.25343167781829834], "mean_td_error": 2.31937575340271, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 18.0, "diff_num_grad_updates_vs_sampler_policy": 17.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.12082290649414, "actor_loss": -4.471602916717529, "critic_loss": 0.6568784713745117, "alpha_loss": -0.05165505036711693, "alpha_value": 0.9949091672897339, "log_alpha_value": -0.005103838164359331, "target_entropy": -6.0, "policy_t": 0.006240338087081909, "mean_q": 0.4419194161891937, "max_q": 3.6390466690063477, "min_q": 0.3343327045440674}, "td_error": [2.1099185943603516, 2.60713529586792, 1.2699408531188965, 3.6526310443878174, 3.339846134185791, 3.677042007446289, 2.348832845687866, 2.7231640815734863, 1.9103517532348633, 0.7391722202301025, 1.9185893535614014, 2.466085433959961, 2.1107544898986816, 2.0730457305908203, 1.783421516418457, 1.371025562286377, 1.387758493423462, 2.4209651947021484, 2.9519429206848145, 0.23720383644104004, 3.4181289672851562, 1.6679480075836182, 3.5054001808166504, 0.0583551824092865, 3.0198848247528076, 3.7235026359558105, 2.9038403034210205, 2.243152379989624, 2.739569902420044, 4.643646240234375, 2.5210371017456055, 0.5863596200942993, 0.5460245609283447, 2.9343974590301514, 1.364904522895813, 1.2614192962646484, 3.023287773132324, 1.6840739250183105, 2.732682466506958, 2.2975330352783203, 3.4868664741516113, 1.5663783550262451, 1.901155948638916, 2.6049280166625977, 1.497313141822815, 1.1577785015106201, 2.7879326343536377, 2.258336305618286, 2.3207221031188965, 3.101127862930298, 0.039988890290260315, 3.404735803604126, 0.8670197129249573, 1.1129707098007202, 1.9705780744552612, 3.423370361328125, 1.117983102798462, 2.6443841457366943, 2.8258910179138184, 2.2863221168518066, 3.212507724761963, 0.32282179594039917, 2.149569034576416, 3.616222381591797, 2.1313934326171875, 1.7208889722824097, 1.217376708984375, 3.4080004692077637, 1.3442180156707764, 2.889007806777954, 1.580857515335083, 3.0292229652404785, 0.9912073612213135, 2.213095188140869, 2.1511669158935547, 1.6762328147888184, 1.1937800645828247, 1.9814648628234863, 1.2078191041946411, 2.004763603210449, 2.419586658477783, 2.8020691871643066, 1.575998067855835, 3.047794818878174, 3.850909471511841, 0.8806924819946289], "mean_td_error": 2.174051284790039, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 18.0, "diff_num_grad_updates_vs_sampler_policy": 17.0}}, "num_env_steps_sampled": 17024, "num_env_steps_trained": 4644, "num_agent_steps_sampled": 51072, "num_agent_steps_trained": 4644, "last_target_update_ts": 17024, "num_target_updates": 18}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51072, "num_agent_steps_trained": 4644, "num_env_steps_sampled": 17024, "num_env_steps_trained": 4644, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 843.4527222984058, "num_env_steps_trained_throughput_per_sec": 242.86919905467488, "timesteps_total": 17024, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 51072, "timers": {"training_iteration_time_ms": 1064.877, "sample_time_ms": 761.892, "load_time_ms": 0.325, "load_throughput": 794807.515, "learn_time_ms": 18.183, "learn_throughput": 14189.325, "synch_weights_time_ms": 10.234}, "counters": {"num_env_steps_sampled": 17024, "num_env_steps_trained": 4644, "num_agent_steps_sampled": 51072, "num_agent_steps_trained": 4644, "last_target_update_ts": 17024, "num_target_updates": 18}, "done": false, "episodes_total": 0, "training_iteration": 16, "trial_id": "95c7c_00000", "date": "2023-11-18_20-54-00", "timestamp": 1700369640, "time_this_iter_s": 1.071051836013794, "time_total_s": 20.291316032409668, "pid": 5649, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16bd41c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 20.291316032409668, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 65.0, "ram_util_percent": 66.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.122118949890137, "actor_loss": -4.523501873016357, "critic_loss": 2.2544450759887695, "alpha_loss": -0.0577082596719265, "alpha_value": 0.9943150281906128, "log_alpha_value": -0.005701203364878893, "target_entropy": -6.0, "policy_t": -0.009679463692009449, "mean_q": 0.7259678244590759, "max_q": 6.055404186248779, "min_q": 0.38457807898521423}, "td_error": [5.772199630737305, 4.014456272125244, 4.274998664855957, 4.136429786682129, 5.185362815856934, 3.881953716278076, 3.4256696701049805, 5.076447010040283, 5.766525745391846, 3.7800612449645996, 0.5286331176757812, 4.645881652832031, 4.930191993713379, 5.060214042663574, 3.859086513519287, 4.0540618896484375, 4.714775085449219, 4.97332763671875, 3.5949296951293945, 3.1038107872009277, 3.9267072677612305, 2.7299060821533203, 3.473294258117676, 1.4002585411071777, 5.002359390258789, 2.1357576847076416, 4.248050689697266, 5.544760704040527, 1.2567832469940186, 5.410970687866211, 4.029683589935303, 5.055078506469727, 4.058245658874512, 2.6337265968322754, 2.4696907997131348, 2.685349941253662, 3.181776523590088, 4.295454025268555, 4.746406555175781, 5.0059919357299805, 4.524960517883301, 3.124856472015381, 5.08963680267334, 4.757683753967285, 6.416562080383301, 4.738063812255859, 5.348792552947998, 3.7853965759277344, 4.176783084869385, 5.776578903198242, 3.985483169555664, 6.10521125793457, 3.6519575119018555, 5.147878646850586, 4.081088066101074, 3.115841865539551, 5.394752025604248, 3.524008274078369, 4.335847854614258, 7.06276798248291, 3.557816743850708, 5.493072509765625, 1.958600640296936, 3.9474151134490967, 5.110670566558838, 2.608602523803711, 5.8740692138671875, 3.561163902282715, 2.7930006980895996, 2.4308533668518066, 4.207104206085205, 3.5717692375183105, 0.5286250114440918, 3.384546995162964, 5.606058120727539, 5.1711297035217285, 4.767592430114746, 3.5485665798187256, 2.788299083709717, 3.666011333465576, 5.784899711608887, 2.1793360710144043, 6.164098739624023, 3.488626003265381, 3.7633209228515625, 2.6371712684631348], "mean_td_error": 4.079137802124023, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 20.0, "diff_num_grad_updates_vs_sampler_policy": 19.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.092155456542969, "actor_loss": -4.428504943847656, "critic_loss": 0.6730247735977173, "alpha_loss": -0.0575682669878006, "alpha_value": 0.9943119883537292, "log_alpha_value": -0.005704258568584919, "target_entropy": -6.0, "policy_t": 0.007101660594344139, "mean_q": 0.5857222080230713, "max_q": 4.330014228820801, "min_q": 0.3166936933994293}, "td_error": [2.7267961502075195, 3.4945478439331055, 1.7284399271011353, 2.6825976371765137, 3.283477544784546, 2.873884916305542, 4.166658401489258, 3.273548126220703, 3.8842391967773438, 1.9151103496551514, 2.728189706802368, 1.917822241783142, 2.1110451221466064, 2.31108021736145, 3.77016544342041, 0.9630786180496216, 0.5381951332092285, 3.0714926719665527, 1.9565130472183228, 2.0123860836029053, 2.425172805786133, 2.2024521827697754, 2.3188648223876953, 1.8758825063705444, 2.115145206451416, 2.6746346950531006, 1.4436237812042236, 0.3277336359024048, 3.6716489791870117, 0.9675204753875732, 2.307018756866455, 4.785818099975586, 2.1500182151794434, 3.980454444885254, 1.4281983375549316, 4.064377307891846, 1.92554771900177, 3.7079689502716064, 2.3008737564086914, 1.5623090267181396, 3.2314107418060303, 2.1082923412323, 0.5418310165405273, 2.6489405632019043, 0.4943201243877411, 1.525005578994751, 1.5118772983551025, 3.2725675106048584, 1.8873932361602783, 3.1435256004333496, 2.7406749725341797, 1.4621503353118896, 0.41020166873931885, 2.5834336280822754, 2.011331081390381, 1.6289867162704468, 1.8717122077941895, 3.751160144805908, 3.787311553955078, 2.210008382797241, 0.8855780363082886, 0.338344544172287, 2.0629353523254395, 3.08071231842041, 2.3992834091186523, 2.5908942222595215, 0.8055906295776367, 1.5385819673538208, 2.805332660675049, 2.2689077854156494, 2.056838035583496, 1.3916947841644287, 3.4692623615264893, 3.6590123176574707, 1.4967700242996216, 4.399168014526367, 4.643279075622559, 3.2628047466278076, 2.794617176055908, 2.5601179599761963, 0.8581496477127075, 2.572788953781128, 1.4087907075881958, 1.4119665622711182, 3.7272849082946777, 3.4262821674346924], "mean_td_error": 2.376530885696411, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 20.0, "diff_num_grad_updates_vs_sampler_policy": 19.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.170650482177734, "actor_loss": -4.592175483703613, "critic_loss": 0.7084400653839111, "alpha_loss": -0.058016709983348846, "alpha_value": 0.9943119287490845, "log_alpha_value": -0.005704325623810291, "target_entropy": -6.0, "policy_t": -0.024105729535222054, "mean_q": 0.5296682715415955, "max_q": 4.211446285247803, "min_q": 0.39971357583999634}, "td_error": [1.9978227615356445, 1.7159677743911743, 1.5549767017364502, 4.0603203773498535, 2.4169182777404785, 2.0741679668426514, 1.700911283493042, 1.602176547050476, 2.602768898010254, 2.650574207305908, 2.5212206840515137, 3.4466347694396973, 1.1993670463562012, 3.1558151245117188, 1.9327888488769531, 1.451115608215332, 1.4660000801086426, 5.229061603546143, 1.5558621883392334, 2.6589083671569824, 1.7595977783203125, 3.6981472969055176, 1.7472991943359375, 1.105658769607544, 5.797121047973633, 1.4638333320617676, 1.9365291595458984, 4.169898509979248, 2.763979196548462, 2.3414933681488037, 2.1843719482421875, 2.640655994415283, 1.9835267066955566, 2.719761610031128, 2.8366799354553223, 3.0216708183288574, 0.6216498613357544, 1.8951605558395386, 1.9217396974563599, 2.809141159057617, 1.3576971292495728, 1.7556507587432861, 1.2136280536651611, 1.0819835662841797, 2.9443821907043457, 4.95521354675293, 2.6551294326782227, 2.1351141929626465, 5.190180778503418, 3.096255302429199, 3.3455066680908203, 3.8144681453704834, 1.1556378602981567, 0.6631346940994263, 1.539426565170288, 2.939746379852295, 1.5180578231811523, 3.379798173904419, 0.7662864923477173, 1.7432852983474731, 2.8890018463134766, 3.383761405944824, 2.024813175201416, 1.1038535833358765, 3.6073250770568848, 2.827997922897339, 1.7613253593444824, 3.5332467555999756, 3.249952793121338, 2.8906168937683105, 1.0556819438934326, 1.6711065769195557, 1.4330165386199951, 2.5089664459228516, 1.4101853370666504, 3.1823763847351074, 2.557321786880493, 2.07416033744812, 0.643398642539978, 1.6932740211486816, 3.5936450958251953, 2.8957159519195557, 2.408282995223999, 0.7996633052825928, 3.034327745437622, 0.4275592267513275], "mean_td_error": 2.352586507797241, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 20.0, "diff_num_grad_updates_vs_sampler_policy": 19.0}}, "num_env_steps_sampled": 18816, "num_env_steps_trained": 5160, "num_agent_steps_sampled": 56448, "num_agent_steps_trained": 5160, "last_target_update_ts": 18816, "num_target_updates": 20}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56448, "num_agent_steps_trained": 5160, "num_env_steps_sampled": 18816, "num_env_steps_trained": 5160, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 896.3952701215958, "num_env_steps_trained_throughput_per_sec": 258.1138166198345, "timesteps_total": 18816, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 56448, "timers": {"training_iteration_time_ms": 1051.98, "sample_time_ms": 761.654, "load_time_ms": 0.327, "load_throughput": 789876.228, "learn_time_ms": 18.171, "learn_throughput": 14198.615, "synch_weights_time_ms": 10.063}, "counters": {"num_env_steps_sampled": 18816, "num_env_steps_trained": 5160, "num_agent_steps_sampled": 56448, "num_agent_steps_trained": 5160, "last_target_update_ts": 18816, "num_target_updates": 20}, "done": false, "episodes_total": 0, "training_iteration": 17, "trial_id": "95c7c_00000", "date": "2023-11-18_20-54-02", "timestamp": 1700369642, "time_this_iter_s": 2.0092151165008545, "time_total_s": 22.300531148910522, "pid": 5649, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16bdf5260>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 22.300531148910522, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 70.36666666666666, "ram_util_percent": 66.16666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.077010154724121, "actor_loss": -4.521759510040283, "critic_loss": 2.3361051082611084, "alpha_loss": -0.06047705188393593, "alpha_value": 0.9940164685249329, "log_alpha_value": -0.006001487374305725, "target_entropy": -6.0, "policy_t": 0.029450269415974617, "mean_q": 0.5851069688796997, "max_q": 5.248712062835693, "min_q": 0.4194346070289612}, "td_error": [3.539738416671753, 3.587961196899414, 2.4022412300109863, 2.766998767852783, 5.403077125549316, 2.395904779434204, 3.7934212684631348, 3.3522706031799316, 6.784703254699707, 4.837329864501953, 5.364839553833008, 5.355926513671875, 4.071052074432373, 3.51889705657959, 3.9339776039123535, 2.3861544132232666, 4.128190040588379, 5.033694267272949, 3.4076454639434814, 4.289363861083984, 4.5417070388793945, 4.040087699890137, 5.3405632972717285, 5.099235534667969, 4.159560203552246, 3.7134485244750977, 3.9128031730651855, 0.8964121341705322, 3.640110969543457, 4.5026960372924805, 4.589934349060059, 3.643479585647583, 3.342564582824707, 5.143458366394043, 4.079377174377441, 3.087831735610962, 5.1828813552856445, 5.149556636810303, 4.527242660522461, 5.0183892250061035, 3.696629047393799, 6.516399383544922, 4.96702766418457, 3.7059597969055176, 4.5852837562561035, 3.4748213291168213, 5.231846332550049, 4.395838260650635, 1.3286802768707275, 4.071032524108887, 6.86155891418457, 3.5779104232788086, 3.6663362979888916, 1.5973581075668335, 5.105784893035889, 3.4252867698669434, 5.553164482116699, 3.5605154037475586, 4.49974250793457, 5.8293657302856445, 3.6222782135009766, 4.3689866065979, 4.879575252532959, 2.3200643062591553, 4.008296489715576, 5.661005020141602, 4.8948073387146, 3.025796413421631, 4.585566997528076, 4.805326461791992, 0.3378716707229614, 1.5106449127197266, 3.6790192127227783, 4.147851943969727, 3.5557899475097656, 4.206550598144531, 6.774843215942383, 4.727883338928223, 4.526491165161133, 5.41135311126709, 4.24644660949707, 5.052284240722656, 4.589068412780762, 3.7422616481781006, 4.431491851806641, 4.920841217041016], "mean_td_error": 4.158693313598633, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 21.0, "diff_num_grad_updates_vs_sampler_policy": 20.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.07921314239502, "actor_loss": -4.445701599121094, "critic_loss": 0.6080636382102966, "alpha_loss": -0.06052141264081001, "alpha_value": 0.9940134286880493, "log_alpha_value": -0.006004576571285725, "target_entropy": -6.0, "policy_t": -0.000474675209261477, "mean_q": 0.6390912532806396, "max_q": 4.648252487182617, "min_q": 0.3459970951080322}, "td_error": [1.4314322471618652, 0.4073927402496338, 4.229520797729492, 3.8085479736328125, 1.801236629486084, 2.076171398162842, 3.146425485610962, 3.7291626930236816, 1.6859745979309082, 2.1215145587921143, 2.107433319091797, 0.9956203103065491, 1.5090891122817993, 1.3408451080322266, 2.762998580932617, 2.1403675079345703, 1.5828750133514404, 0.9485857486724854, 1.891623854637146, 1.8388868570327759, 2.733274459838867, 3.327629804611206, 2.6771252155303955, 2.7392334938049316, 2.30776047706604, 0.34553414583206177, 3.267693281173706, 0.9734314680099487, 4.3318400382995605, 2.0815606117248535, 1.9198431968688965, 3.2173118591308594, 2.6090993881225586, 0.5478358864784241, 2.624591827392578, 1.2385122776031494, 2.0506932735443115, 2.2793631553649902, 1.8809033632278442, 2.8988308906555176, 3.6719741821289062, 2.18178653717041, 3.904940128326416, 0.2676653563976288, 3.144141674041748, 5.020838737487793, 0.6686068773269653, 1.352613925933838, 2.0516061782836914, 1.878050684928894, 0.781559944152832, 1.4408011436462402, 2.8281893730163574, 3.7320923805236816, 1.4444706439971924, 2.3181769847869873, 3.1265363693237305, 1.782922387123108, 1.5911245346069336, 1.418027639389038, 1.0859146118164062, 0.7006076574325562, 1.9130265712738037, 1.739689826965332, 2.3520641326904297, 1.7813339233398438, 2.074409008026123, 2.5433645248413086, 3.958146810531616, 4.502777576446533, 1.4181156158447266, 1.556541919708252, 2.3764026165008545, 2.055142879486084, 1.5588219165802002, 2.3665056228637695, 1.4210689067840576, 5.054183006286621, 2.483013153076172, 2.065690279006958, 2.5483522415161133, 2.1830716133117676, 0.45640552043914795, 1.0189982652664185, 3.593475103378296, 1.9702682495117188], "mean_td_error": 2.197573184967041, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 21.0, "diff_num_grad_updates_vs_sampler_policy": 20.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.133479118347168, "actor_loss": -4.589456558227539, "critic_loss": 0.650307297706604, "alpha_loss": -0.060848768800497055, "alpha_value": 0.994013249874115, "log_alpha_value": -0.006004726514220238, "target_entropy": -6.0, "policy_t": -0.03569438308477402, "mean_q": 0.5636336803436279, "max_q": 4.912614822387695, "min_q": 0.4343375563621521}, "td_error": [4.0760297775268555, 1.3310960531234741, 2.8221077919006348, 1.0204904079437256, 0.2683910131454468, 0.8805588483810425, 1.239181637763977, 2.509220600128174, 2.094235897064209, 2.268505573272705, 3.0226292610168457, 3.7930362224578857, 1.2326490879058838, 1.3849866390228271, 2.1091132164001465, 1.8647398948669434, 1.2888081073760986, 1.2255258560180664, 2.8805084228515625, 2.713465690612793, 2.3715767860412598, 3.2227697372436523, 2.8914246559143066, 3.0981526374816895, 1.7679264545440674, 2.7670397758483887, 1.494484782218933, 1.2821645736694336, 2.9173169136047363, 1.4383729696273804, 4.117855072021484, 2.7120838165283203, 1.234443187713623, 1.867232322692871, 2.1676151752471924, 2.174971580505371, 2.232067584991455, 0.33911585807800293, 1.6984343528747559, 1.5545662641525269, 3.997138500213623, 3.503290891647339, 2.266164779663086, 1.5261597633361816, 4.601222991943359, 0.4433085024356842, 1.3197213411331177, 2.8254761695861816, 1.8547108173370361, 2.5250890254974365, 1.4613035917282104, 2.1831512451171875, 0.7541388273239136, 3.7411773204803467, 3.8839125633239746, 0.9404622316360474, 2.2011117935180664, 3.4042608737945557, 1.60811448097229, 2.297123432159424, 1.2147953510284424, 1.0124688148498535, 2.7634694576263428, 3.3276708126068115, 3.3979713916778564, 0.5303661227226257, 3.0560173988342285, 2.421321392059326, 2.951547622680664, 1.6834574937820435, 2.0687663555145264, 3.6598386764526367, 2.040276050567627, 2.460587978363037, 1.4763461351394653, 2.3535468578338623, 1.7886513471603394, 1.5557900667190552, 3.6448748111724854, 1.4396920204162598, 1.2207818031311035, 2.523153781890869, 3.4126272201538086, 2.313920736312866, 2.236011505126953, 1.7417774200439453], "mean_td_error": 2.197763442993164, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 21.0, "diff_num_grad_updates_vs_sampler_policy": 20.0}}, "num_env_steps_sampled": 19712, "num_env_steps_trained": 5418, "num_agent_steps_sampled": 59136, "num_agent_steps_trained": 5418, "last_target_update_ts": 19712, "num_target_updates": 21}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 59136, "num_agent_steps_trained": 5418, "num_env_steps_sampled": 19712, "num_env_steps_trained": 5418, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 874.9134849624901, "num_env_steps_trained_throughput_per_sec": 251.92821330393127, "timesteps_total": 19712, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 59136, "timers": {"training_iteration_time_ms": 1041.01, "sample_time_ms": 751.793, "load_time_ms": 0.327, "load_throughput": 790106.916, "learn_time_ms": 18.243, "learn_throughput": 14142.409, "synch_weights_time_ms": 10.214}, "counters": {"num_env_steps_sampled": 19712, "num_env_steps_trained": 5418, "num_agent_steps_sampled": 59136, "num_agent_steps_trained": 5418, "last_target_update_ts": 19712, "num_target_updates": 21}, "done": false, "episodes_total": 0, "training_iteration": 18, "trial_id": "95c7c_00000", "date": "2023-11-18_20-54-03", "timestamp": 1700369643, "time_this_iter_s": 1.0316979885101318, "time_total_s": 23.332229137420654, "pid": 5649, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16bdf5760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 23.332229137420654, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 86.0, "ram_util_percent": 66.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.053153038024902, "actor_loss": -4.569969654083252, "critic_loss": 2.311145782470703, "alpha_loss": -0.06637098640203476, "alpha_value": 0.9934197664260864, "log_alpha_value": -0.0066020069643855095, "target_entropy": -6.0, "policy_t": -0.019121816381812096, "mean_q": 0.7577425837516785, "max_q": 8.259190559387207, "min_q": 0.4943099915981293}, "td_error": [3.144434928894043, 5.8185319900512695, 4.522342205047607, 3.591610908508301, 4.114222526550293, 4.124346733093262, 4.6124162673950195, 3.3406150341033936, 4.393004417419434, 3.336334228515625, 5.044729232788086, 2.0510473251342773, 5.720941066741943, 3.8117451667785645, 5.056644439697266, 5.404677391052246, 4.192668914794922, 2.9537837505340576, 4.0780720710754395, 4.627621650695801, 4.194976806640625, 3.8961181640625, 2.992222309112549, 3.9353880882263184, 4.205313682556152, 3.3315391540527344, 3.0608420372009277, 3.381361961364746, 3.752410411834717, 5.140902996063232, 5.474931716918945, 3.6968071460723877, 5.330936431884766, 2.987420082092285, 3.6896309852600098, 1.6903074979782104, 1.7486485242843628, 3.977703809738159, 5.031722545623779, 2.2433218955993652, 4.896716117858887, 4.019086837768555, 3.59566593170166, 4.4511518478393555, 3.4936413764953613, 4.709263324737549, 5.540563583374023, 2.991210699081421, 2.851485252380371, 5.100959300994873, 2.9296135902404785, 2.053215742111206, 4.513810634613037, 5.086182117462158, 4.10420036315918, 4.144120693206787, 2.7074246406555176, 3.9656906127929688, 4.97772741317749, 2.489490509033203, 4.853481292724609, 5.18605899810791, 3.976372241973877, 4.812843322753906, 3.7774806022644043, 4.102203369140625, 2.857714891433716, 4.85526180267334, 3.390012264251709, 5.766741752624512, 3.1043148040771484, 2.8278849124908447, 4.696442127227783, 3.682307481765747, 5.795994758605957, 4.457579612731934, 4.383986949920654, 5.924691677093506, 4.108380317687988, 4.3474907875061035, 4.058722972869873, 4.619762420654297, 3.271904945373535, 2.828035831451416, 5.22715950012207, 6.07103157043457], "mean_td_error": 4.061713695526123, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 23.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.047934532165527, "actor_loss": -4.476150989532471, "critic_loss": 0.594056248664856, "alpha_loss": -0.06636811047792435, "alpha_value": 0.9934166073799133, "log_alpha_value": -0.006605149246752262, "target_entropy": -6.0, "policy_t": 0.02526300773024559, "mean_q": 0.5925445556640625, "max_q": 5.177132606506348, "min_q": 0.4079815745353699}, "td_error": [1.3505338430404663, 1.586852788925171, 3.658430576324463, 0.41053080558776855, 1.5757672786712646, 0.7806406021118164, 2.6057910919189453, 3.417518138885498, 2.752431869506836, 1.0586695671081543, 1.6896065473556519, 2.2474119663238525, 1.41093909740448, 1.1104234457015991, 2.9058854579925537, 0.7201666235923767, 2.137688159942627, 1.8457226753234863, 3.0188355445861816, 4.695228099822998, 2.2328879833221436, 0.7052302956581116, 0.8315795660018921, 2.7258341312408447, 1.8002630472183228, 3.9081664085388184, 2.338250160217285, 1.6495928764343262, 1.7448854446411133, 2.0010645389556885, 0.3025144636631012, 3.242124557495117, 0.7664461135864258, 3.435718297958374, 2.6087734699249268, 1.4573227167129517, 3.479351282119751, 3.208083391189575, 1.9100887775421143, 0.37933868169784546, 2.2277936935424805, 1.253884196281433, 4.781405448913574, 1.9498543739318848, 4.77451229095459, 2.20760178565979, 0.8602449893951416, 1.2663612365722656, 2.690040349960327, 1.9544011354446411, 2.8748061656951904, 1.922990083694458, 3.34440279006958, 2.101693868637085, 1.1093904972076416, 2.5975141525268555, 1.7622225284576416, 3.033679246902466, 2.587491512298584, 2.8109631538391113, 2.7308197021484375, 1.5416016578674316, 2.740516185760498, 2.6022331714630127, 2.3872299194335938, 3.536787509918213, 2.7037484645843506, 3.9099724292755127, 1.776963710784912, 0.8078924417495728, 2.7711615562438965, 1.4246701002120972, 2.162142038345337, 0.9263384938240051, 0.6293609142303467, 0.7624003887176514, 1.7110893726348877, 4.272719383239746, 2.1422672271728516, 1.3815590143203735, 2.4161739349365234, 2.5984020233154297, 1.0249016284942627, 2.9036426544189453, 0.3158687353134155, 2.319956064224243], "mean_td_error": 2.143235921859741, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 23.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0799560546875, "actor_loss": -4.617419719696045, "critic_loss": 0.5996259450912476, "alpha_loss": -0.06658363342285156, "alpha_value": 0.9934162497520447, "log_alpha_value": -0.0066055478528141975, "target_entropy": -6.0, "policy_t": 0.0037851121742278337, "mean_q": 0.6814428567886353, "max_q": 5.4291090965271, "min_q": 0.507396399974823}, "td_error": [3.3510284423828125, 2.6524574756622314, 1.6770644187927246, 0.702016294002533, 2.708465337753296, 2.495135545730591, 4.530243873596191, 1.5198776721954346, 1.1277439594268799, 1.0679562091827393, 1.802716612815857, 1.7919936180114746, 2.642881393432617, 2.966826915740967, 3.5698351860046387, 2.7083094120025635, 2.973907232284546, 2.6170616149902344, 1.8771171569824219, 3.040865898132324, 2.3278439044952393, 0.6757245063781738, 2.1644599437713623, 0.9105578660964966, 0.6881628036499023, 2.5535223484039307, 1.9196851253509521, 1.9934237003326416, 1.6641407012939453, 1.4399380683898926, 2.6844630241394043, 3.175889253616333, 2.251771926879883, 2.3189139366149902, 2.4548773765563965, 4.0097808837890625, 2.119767189025879, 3.5724878311157227, 0.4589582681655884, 2.8937506675720215, 2.3231308460235596, 1.0550872087478638, 1.2746760845184326, 0.7342555522918701, 1.15755033493042, 2.12308931350708, 1.3186497688293457, 1.3529744148254395, 0.9743238687515259, 2.478468418121338, 3.5121943950653076, 2.118623733520508, 1.878004550933838, 1.5211129188537598, 0.13223481178283691, 2.5587096214294434, 0.985598087310791, 2.0826640129089355, 3.393871545791626, 2.0930352210998535, 2.321320056915283, 0.603291392326355, 3.7366321086883545, 1.444949984550476, 5.046866416931152, 1.8703703880310059, 2.5571517944335938, 0.8396660089492798, 3.3080413341522217, 0.6768642663955688, 3.084886312484741, 0.6968598365783691, 2.9825735092163086, 2.3747141361236572, 2.100191593170166, 1.0957777500152588, 3.1363282203674316, 1.4629796743392944, 1.9263883829116821, 2.362316370010376, 1.3803757429122925, 2.2729687690734863, 0.7737658023834229, 3.089029312133789, 1.3167483806610107, 2.89457368850708], "mean_td_error": 2.0991337299346924, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 23.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 21504, "num_env_steps_trained": 5934, "num_agent_steps_sampled": 64512, "num_agent_steps_trained": 5934, "last_target_update_ts": 21504, "num_target_updates": 23}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64512, "num_agent_steps_trained": 5934, "num_env_steps_sampled": 21504, "num_env_steps_trained": 5934, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 876.1469138061872, "num_env_steps_trained_throughput_per_sec": 252.28337473437085, "timesteps_total": 21504, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 64512, "timers": {"training_iteration_time_ms": 1051.183, "sample_time_ms": 761.902, "load_time_ms": 0.326, "load_throughput": 792073.219, "learn_time_ms": 18.257, "learn_throughput": 14131.9, "synch_weights_time_ms": 9.893}, "counters": {"num_env_steps_sampled": 21504, "num_env_steps_trained": 5934, "num_agent_steps_sampled": 64512, "num_agent_steps_trained": 5934, "last_target_update_ts": 21504, "num_target_updates": 23}, "done": false, "episodes_total": 0, "training_iteration": 19, "trial_id": "95c7c_00000", "date": "2023-11-18_20-54-05", "timestamp": 1700369645, "time_this_iter_s": 2.0546629428863525, "time_total_s": 25.386892080307007, "pid": 5649, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16bd42520>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 25.386892080307007, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 73.43333333333334, "ram_util_percent": 66.26666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.182153701782227, "actor_loss": -4.744998931884766, "critic_loss": 2.2190234661102295, "alpha_loss": -0.07027921825647354, "alpha_value": 0.9931215643882751, "log_alpha_value": -0.006902195513248444, "target_entropy": -6.0, "policy_t": -0.009181132540106773, "mean_q": 0.614860475063324, "max_q": 4.090079307556152, "min_q": 0.5347921848297119}, "td_error": [4.095099449157715, 3.936673402786255, 4.197201728820801, 4.325970649719238, 4.156450271606445, 3.4962804317474365, 6.194387912750244, 2.322042942047119, 2.7161293029785156, 2.2287983894348145, 4.711520195007324, 2.5952420234680176, 4.794914245605469, 6.023891925811768, 3.987285614013672, 1.4377700090408325, 4.225888729095459, 4.016576290130615, 5.401897430419922, 2.544912815093994, 3.624645471572876, 4.907378196716309, 2.1877150535583496, 4.114246368408203, 4.18418025970459, 2.226663589477539, 3.8943142890930176, 5.601848602294922, 5.613643646240234, 3.120344877243042, 4.210281848907471, 3.7863283157348633, 4.715463638305664, 4.169885635375977, 4.404138565063477, 4.5238494873046875, 4.711188316345215, 3.351513385772705, 2.5332937240600586, 4.114123344421387, 3.740967273712158, 2.4142508506774902, 3.189021110534668, 3.521818161010742, 2.8187456130981445, 5.79865837097168, 4.083895683288574, 3.6686699390411377, 4.559723854064941, 3.317112445831299, 3.6347556114196777, 3.2403817176818848, 4.266725540161133, 2.772641658782959, 2.4551515579223633, 3.400115966796875, 3.0829689502716064, 4.816607475280762, 4.35276985168457, 4.842437744140625, 3.2916359901428223, 5.027133941650391, 4.468822002410889, 6.571814060211182, 4.317018032073975, 3.4219412803649902, 2.592777729034424, 6.471259117126465, 2.9470319747924805, 4.626687049865723, 2.5528452396392822, 5.39476203918457, 3.8852977752685547, 3.0902185440063477, 3.8772354125976562, 4.78769588470459, 2.6150131225585938, 3.84161376953125, 3.8833916187286377, 3.297258138656616, 1.0868924856185913, 4.775544166564941, 5.122379302978516, 4.02879524230957, 2.7411563396453857, 3.51214599609375], "mean_td_error": 3.879183053970337, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 24.0, "diff_num_grad_updates_vs_sampler_policy": 23.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.097309112548828, "actor_loss": -4.553248882293701, "critic_loss": 0.5860152244567871, "alpha_loss": -0.06972543895244598, "alpha_value": 0.9931184649467468, "log_alpha_value": -0.00690534757450223, "target_entropy": -6.0, "policy_t": 0.008801043033599854, "mean_q": 0.6679220199584961, "max_q": 5.428173065185547, "min_q": 0.44124746322631836}, "td_error": [1.0620450973510742, 2.492703437805176, 2.548459529876709, 0.5234739780426025, 1.5084811449050903, 1.6928400993347168, 1.4571185111999512, 1.5499353408813477, 2.435758113861084, 1.0881271362304688, 1.9414788484573364, 2.7187771797180176, 1.4437023401260376, 2.9916982650756836, 2.6682653427124023, 1.9832220077514648, 2.0523171424865723, 1.124826431274414, 1.73496675491333, 2.7003726959228516, 1.5521812438964844, 1.5918116569519043, 3.9619028568267822, 1.08519446849823, 1.9389711618423462, 1.1501233577728271, 3.2326087951660156, 4.073338508605957, 2.530916213989258, 2.2097840309143066, 4.603573799133301, 2.340768575668335, 1.7008216381072998, 2.7301907539367676, 3.230600595474243, 2.0519049167633057, 3.03151273727417, 3.9192495346069336, 3.3372962474823, 4.105754375457764, 0.8380225896835327, 2.653773307800293, 0.4101616442203522, 2.9253859519958496, 2.1905598640441895, 1.744875431060791, 3.9270005226135254, 2.6776108741760254, 1.7951416969299316, 1.7842587232589722, 2.9226839542388916, 2.0035600662231445, 2.238598346710205, 1.6682465076446533, 3.9312524795532227, 0.29224973917007446, 4.211699485778809, 1.0259385108947754, 1.691925048828125, 1.739804744720459, 2.288300037384033, 0.9642548561096191, 4.002249717712402, 0.0932915210723877, 2.949535369873047, 2.357060432434082, 2.4641590118408203, 1.3111722469329834, 2.4097354412078857, 1.7071034908294678, 1.2478365898132324, 0.41724324226379395, 1.8993161916732788, 1.7339468002319336, 0.6289458274841309, 2.506903648376465, 0.6334490776062012, 2.332425117492676, 1.1970481872558594, 1.8730764389038086, 3.8595871925354004, 4.796804428100586, 1.2753297090530396, 2.3539955615997314, 1.278702974319458, 0.3159986734390259], "mean_td_error": 2.1356661319732666, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 24.0, "diff_num_grad_updates_vs_sampler_policy": 23.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.145914077758789, "actor_loss": -4.721548557281494, "critic_loss": 0.6156549453735352, "alpha_loss": -0.07006631046533585, "alpha_value": 0.9931179285049438, "log_alpha_value": -0.006905865389853716, "target_entropy": -6.0, "policy_t": -0.013805896043777466, "mean_q": 0.8293957114219666, "max_q": 5.660106182098389, "min_q": 0.5459103584289551}, "td_error": [1.1553345918655396, 1.8863635063171387, 4.851778984069824, 1.3765575885772705, 2.942765712738037, 1.3896968364715576, 3.8742477893829346, 1.4987311363220215, 3.1370465755462646, 3.161323308944702, 1.6055529117584229, 2.617508888244629, 3.1773149967193604, 2.9734249114990234, 1.2877438068389893, 4.530302047729492, 2.2389349937438965, 1.728461503982544, 1.1969342231750488, 1.6706609725952148, 3.843616008758545, 3.3993115425109863, 0.1998429298400879, 0.6925603151321411, 0.9057626128196716, 1.4285681247711182, 0.6689075231552124, 2.251328945159912, 0.3884847164154053, 3.3206522464752197, 3.4653024673461914, 1.9147181510925293, 0.7667343616485596, 0.5278614163398743, 1.1353459358215332, 1.0180020332336426, 3.136293888092041, 0.1275528073310852, 1.5783637762069702, 3.0871896743774414, 0.847138524055481, 2.3479647636413574, 2.59829044342041, 2.2391510009765625, 0.8445808291435242, 1.0205204486846924, 2.0421738624572754, 2.286482810974121, 1.9028427600860596, 2.936336040496826, 2.3813889026641846, 2.008282423019409, 1.7615149021148682, 4.275080680847168, 2.312138080596924, 2.5233206748962402, 2.6586484909057617, 2.041532516479492, 2.7909650802612305, 2.1986842155456543, 0.44105905294418335, 0.8583317995071411, 2.101689338684082, 1.4744744300842285, 2.582277774810791, 2.7436013221740723, 1.5288686752319336, 1.790108323097229, 1.4447277784347534, 2.801354169845581, 3.5616989135742188, 3.2820897102355957, 2.562991142272949, 2.9176888465881348, 1.5982189178466797, 1.2272233963012695, 2.1331818103790283, 1.5841288566589355, 3.6325411796569824, 2.403827667236328, 2.0813956260681152, 0.4091538190841675, 3.324713945388794, 2.201711654663086, 1.524417519569397, 1.5245486497879028], "mean_td_error": 2.0919783115386963, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 24.0, "diff_num_grad_updates_vs_sampler_policy": 23.0}}, "num_env_steps_sampled": 22400, "num_env_steps_trained": 6192, "num_agent_steps_sampled": 67200, "num_agent_steps_trained": 6192, "last_target_update_ts": 22400, "num_target_updates": 24}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 67200, "num_agent_steps_trained": 6192, "num_env_steps_sampled": 22400, "num_env_steps_trained": 6192, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 838.366575418375, "num_env_steps_trained_throughput_per_sec": 241.4046612253803, "timesteps_total": 22400, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 67200, "timers": {"training_iteration_time_ms": 1051.512, "sample_time_ms": 760.794, "load_time_ms": 0.322, "load_throughput": 800510.75, "learn_time_ms": 18.282, "learn_throughput": 14112.198, "synch_weights_time_ms": 10.061}, "counters": {"num_env_steps_sampled": 22400, "num_env_steps_trained": 6192, "num_agent_steps_sampled": 67200, "num_agent_steps_trained": 6192, "last_target_update_ts": 22400, "num_target_updates": 24}, "done": false, "episodes_total": 0, "training_iteration": 20, "trial_id": "95c7c_00000", "date": "2023-11-18_20-54-06", "timestamp": 1700369646, "time_this_iter_s": 1.0794198513031006, "time_total_s": 26.466311931610107, "pid": 5649, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16bdf5120>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 26.466311931610107, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 61.8, "ram_util_percent": 66.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.093465805053711, "actor_loss": -4.685354709625244, "critic_loss": 2.275998115539551, "alpha_loss": -0.07269886136054993, "alpha_value": 0.9928233027458191, "log_alpha_value": -0.00720256706699729, "target_entropy": -6.0, "policy_t": -0.07954558730125427, "mean_q": 0.8353955745697021, "max_q": 9.363984107971191, "min_q": 0.5777601599693298}, "td_error": [5.150200366973877, 4.538320541381836, 3.5029520988464355, 5.863188743591309, 5.494970798492432, 5.220440864562988, 4.164471626281738, 1.9908066987991333, 4.7784552574157715, 4.939697265625, 3.9381823539733887, 4.2728190422058105, 5.311002254486084, 3.9328575134277344, 4.2536468505859375, 4.688869953155518, 3.644174814224243, 4.194991111755371, 4.884014129638672, 4.650609016418457, 4.738040924072266, 3.928305149078369, 4.0611724853515625, 5.160055637359619, 4.951495170593262, 4.031671047210693, 3.0510811805725098, 5.462743759155273, 4.802030086517334, 3.1142306327819824, 3.4856128692626953, 4.4058027267456055, 3.904923439025879, 2.5685644149780273, 3.6603641510009766, 4.708463668823242, 3.1696548461914062, 2.4814348220825195, 2.199463129043579, 4.132017135620117, 5.004322528839111, 4.042891502380371, 2.9915151596069336, 3.9932093620300293, 4.512453556060791, 3.5806784629821777, 3.4188995361328125, 5.421876907348633, 2.6444449424743652, 4.600362777709961, 3.5404343605041504, 3.0436336994171143, 3.406558036804199, 6.282517433166504, 5.026322841644287, 4.14202880859375, 3.5064444541931152, 4.320234298706055, 2.957174777984619, 3.1645889282226562, 3.607992649078369, 5.692055702209473, 3.653653621673584, 2.2745189666748047, 0.3928811550140381, 0.26675498485565186, 4.571053981781006, 2.668656349182129, 2.9702107906341553, 6.43142557144165, 4.38553524017334, 4.9036712646484375, 5.084307670593262, 4.33733606338501, 2.566403388977051, 2.706397533416748, 1.3769686222076416, 2.8517260551452637, 2.617734909057617, 2.76552677154541, 4.042451858520508, 4.18653678894043, 5.3980255126953125, 5.031550407409668, 5.857635498046875, 3.5879287719726562], "mean_td_error": 3.9681549072265625, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 25.0, "diff_num_grad_updates_vs_sampler_policy": 24.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.128633499145508, "actor_loss": -4.609733581542969, "critic_loss": 0.5821341276168823, "alpha_loss": -0.07298266142606735, "alpha_value": 0.9928203225135803, "log_alpha_value": -0.007205577567219734, "target_entropy": -6.0, "policy_t": 0.0015202427748590708, "mean_q": 0.6128039956092834, "max_q": 4.6434221267700195, "min_q": 0.47562649846076965}, "td_error": [2.2815237045288086, 3.1886794567108154, 2.627532720565796, 2.9901089668273926, 1.5375951528549194, 1.6219136714935303, 3.852659225463867, 0.9635664224624634, 3.1455559730529785, 2.9493541717529297, 2.504790782928467, 1.2998648881912231, 2.4506301879882812, 3.2162046432495117, 1.0058238506317139, 2.521364212036133, 3.308676242828369, 1.4585041999816895, 2.084583282470703, 2.4795727729797363, 1.3260164260864258, 0.9361550807952881, 2.7621896266937256, 3.141364574432373, 1.1119956970214844, 1.3794331550598145, 2.2142152786254883, 1.2966793775558472, 2.9109761714935303, 0.5338649749755859, 5.0131635665893555, 0.8522874116897583, 1.5299699306488037, 1.3041138648986816, 2.9021105766296387, 2.01397705078125, 1.3723366260528564, 1.4149012565612793, 3.147006034851074, 0.8660996556282043, 2.2286834716796875, 2.4966766834259033, 0.9278073310852051, 0.3211807608604431, 2.1238443851470947, 2.6850533485412598, 3.9371860027313232, 2.0214571952819824, 3.4287307262420654, 0.33783209323883057, 0.7986552715301514, 1.9508142471313477, 0.7640088796615601, 2.335142135620117, 1.167888879776001, 2.5075299739837646, 2.865117311477661, 2.8719773292541504, 3.0552892684936523, 2.7711615562438965, 1.7277116775512695, 1.3704912662506104, 1.5144355297088623, 2.7047595977783203, 2.8607187271118164, 1.8140952587127686, 0.244890958070755, 2.871249198913574, 4.043132305145264, 2.1522278785705566, 2.8446080684661865, 0.39961913228034973, 2.182260274887085, 1.0389153957366943, 2.194833517074585, 0.8894697427749634, 2.423187494277954, 1.8246188163757324, 2.668386459350586, 3.1014180183410645, 2.49185848236084, 3.974496841430664, 2.1914896965026855, 0.4730803668498993, 1.1075793504714966, 0.2923849821090698], "mean_td_error": 2.0757596492767334, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 25.0, "diff_num_grad_updates_vs_sampler_policy": 24.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.130887985229492, "actor_loss": -4.744714736938477, "critic_loss": 0.5926500558853149, "alpha_loss": -0.07300577312707901, "alpha_value": 0.9928196668624878, "log_alpha_value": -0.007206256035715342, "target_entropy": -6.0, "policy_t": 0.01797463744878769, "mean_q": 0.9751508831977844, "max_q": 5.845920562744141, "min_q": 0.5852253437042236}, "td_error": [4.740285873413086, 2.1965320110321045, 3.0575051307678223, 1.7994135618209839, 1.9559506177902222, 0.605502724647522, 0.8057730197906494, 2.483336925506592, 2.4726343154907227, 2.568476676940918, 2.468268394470215, 1.6000025272369385, 3.320796251296997, 1.1283364295959473, 1.3825490474700928, 1.2313311100006104, 0.5960562229156494, 4.528800964355469, 4.651376724243164, 2.666731357574463, 0.2703828811645508, 3.3216233253479004, 0.530108630657196, 0.26051950454711914, 1.661105990409851, 2.5493249893188477, 3.5857977867126465, 3.7401909828186035, 1.677482008934021, 2.771397352218628, 1.9067339897155762, 3.11700701713562, 1.7287027835845947, 3.5333142280578613, 2.321298360824585, 1.9126543998718262, 1.4860615730285645, 0.5669940114021301, 2.526461124420166, 3.553668737411499, 1.6380164623260498, 1.103996753692627, 2.111164093017578, 3.677687644958496, 2.1277916431427, 3.5248281955718994, 2.815373659133911, 1.6606769561767578, 0.8162364959716797, 1.56158447265625, 2.5044331550598145, 1.8085813522338867, 3.146127462387085, 1.4921059608459473, 2.3471319675445557, 2.0848636627197266, 1.3376938104629517, 1.7764095067977905, 2.1960933208465576, 1.6776723861694336, 3.4781527519226074, 2.37878680229187, 2.0428466796875, 0.5893785953521729, 1.9571287631988525, 1.6245627403259277, 2.6084694862365723, 0.236935555934906, 2.6875884532928467, 4.785879135131836, 0.837009072303772, 1.2430708408355713, 3.752286911010742, 2.8752639293670654, 3.3180065155029297, 0.9886260032653809, 1.6128389835357666, 0.34320926666259766, 0.319002628326416, 0.8666882514953613, 1.0357747077941895, 0.06229722499847412, 1.7833447456359863, 1.3115990161895752, 0.8058253526687622, 1.8304789066314697], "mean_td_error": 2.0472559928894043, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 25.0, "diff_num_grad_updates_vs_sampler_policy": 24.0}}, "num_env_steps_sampled": 23296, "num_env_steps_trained": 6450, "num_agent_steps_sampled": 69888, "num_agent_steps_trained": 6450, "last_target_update_ts": 23296, "num_target_updates": 25}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 69888, "num_agent_steps_trained": 6450, "num_env_steps_sampled": 23296, "num_env_steps_trained": 6450, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 675.58453443658, "num_env_steps_trained_throughput_per_sec": 194.5321538891045, "timesteps_total": 23296, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 69888, "timers": {"training_iteration_time_ms": 1079.506, "sample_time_ms": 768.048, "load_time_ms": 0.322, "load_throughput": 801875.089, "learn_time_ms": 18.225, "learn_throughput": 14156.71, "synch_weights_time_ms": 10.069}, "counters": {"num_env_steps_sampled": 23296, "num_env_steps_trained": 6450, "num_agent_steps_sampled": 69888, "num_agent_steps_trained": 6450, "last_target_update_ts": 23296, "num_target_updates": 25}, "done": false, "episodes_total": 0, "training_iteration": 21, "trial_id": "95c7c_00000", "date": "2023-11-18_20-54-07", "timestamp": 1700369647, "time_this_iter_s": 1.3352758884429932, "time_total_s": 27.8015878200531, "pid": 5649, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16bd43ce0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 27.8015878200531, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 88.6, "ram_util_percent": 66.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.159472465515137, "actor_loss": -4.844877243041992, "critic_loss": 2.162123680114746, "alpha_loss": -0.07927767932415009, "alpha_value": 0.9922270178794861, "log_alpha_value": -0.0078033264726400375, "target_entropy": -6.0, "policy_t": -0.024887654930353165, "mean_q": 1.083669662475586, "max_q": 9.387832641601562, "min_q": 0.6672471165657043}, "td_error": [2.8679816722869873, 4.072885036468506, 5.020895957946777, 3.0254509449005127, 5.721756935119629, 4.702462196350098, 3.2232441902160645, 3.159099578857422, 3.699864387512207, 3.2678308486938477, 3.532999038696289, 3.2467169761657715, 5.683750152587891, 3.4589054584503174, 3.895869731903076, 2.6140151023864746, 3.0635292530059814, 4.097484111785889, 4.5912885665893555, 4.31804895401001, 3.4693353176116943, 3.5314764976501465, 3.023329257965088, 3.8491694927215576, 5.525261878967285, 3.8285021781921387, 5.553501129150391, 2.0623624324798584, 4.60433292388916, 2.8954989910125732, 3.0835084915161133, 2.8106861114501953, 5.664983749389648, 4.163420677185059, 3.6410069465637207, 3.8524627685546875, 2.754781484603882, 3.8082895278930664, 3.8575711250305176, 2.7567310333251953, 4.470284461975098, 3.185243844985962, 4.795166969299316, 5.559444427490234, 1.89286470413208, 4.548917770385742, 2.435946464538574, 3.261821746826172, 4.3414998054504395, 4.332435607910156, 3.5343503952026367, 2.019033432006836, 3.7453765869140625, 4.00650691986084, 3.752579927444458, 2.0610318183898926, 4.4263916015625, 5.8522844314575195, 2.720407485961914, 5.6347737312316895, 2.861666679382324, 5.319045066833496, 3.8259878158569336, 4.779754638671875, 4.7940168380737305, 3.027365207672119, 4.525108337402344, 5.288806915283203, 5.156530857086182, 3.6200575828552246, 4.779657363891602, 2.8621773719787598, 2.2726688385009766, 4.327187538146973, 2.2908174991607666, 4.0409440994262695, 2.256582021713257, 3.8085694313049316, 4.5242414474487305, 4.518468856811523, 4.016348838806152, 4.327060222625732, 4.255382537841797, 2.9531631469726562, 4.604435920715332, 3.3529951572418213], "mean_td_error": 3.848438262939453, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 27.0, "diff_num_grad_updates_vs_sampler_policy": 26.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.059362411499023, "actor_loss": -4.611358165740967, "critic_loss": 0.566495418548584, "alpha_loss": -0.07852531969547272, "alpha_value": 0.9922242164611816, "log_alpha_value": -0.007806192152202129, "target_entropy": -6.0, "policy_t": -0.013291092589497566, "mean_q": 0.6494948267936707, "max_q": 3.3682782649993896, "min_q": 0.5489377379417419}, "td_error": [1.5573599338531494, 2.5301308631896973, 1.521911382675171, 0.7084227204322815, 0.03704345226287842, 2.436066150665283, 2.3332223892211914, 2.038029193878174, 0.8983772993087769, 3.1332857608795166, 2.019213914871216, 3.0200395584106445, 2.2767863273620605, 1.6324106454849243, 0.16659745573997498, 2.4407382011413574, 2.048774242401123, 3.156308650970459, 2.155958414077759, 0.4383338391780853, 3.3691153526306152, 1.7347623109817505, 2.027498960494995, 2.3766109943389893, 0.1717909872531891, 1.613332986831665, 1.7258777618408203, 2.611351490020752, 2.8430709838867188, 1.046843409538269, 1.5464133024215698, 2.7441301345825195, 2.740920066833496, 1.678107738494873, 1.311154842376709, 2.5199949741363525, 2.876826763153076, 2.6905362606048584, 1.513300895690918, 2.293196201324463, 3.6144726276397705, 0.48720782995224, 1.808822751045227, 1.7497977018356323, 2.7470173835754395, 2.74721622467041, 2.0763602256774902, 3.165564775466919, 1.041754126548767, 1.414703607559204, 3.460861921310425, 2.9815754890441895, 3.2988100051879883, 3.409736156463623, 0.9137238264083862, 2.17529296875, 4.682180404663086, 1.2180423736572266, 4.59392786026001, 1.8885889053344727, 2.1673569679260254, 2.156585216522217, 2.1152849197387695, 2.2064857482910156, 2.6013941764831543, 3.4441006183624268, 1.375313639640808, 2.2212648391723633, 2.235610008239746, 0.9415270686149597, 2.754641532897949, 1.595844030380249, 3.2056186199188232, 2.1593854427337646, 0.31249547004699707, 0.3486053943634033, 0.22755840420722961, 0.4752875566482544, 2.614692449569702, 0.3163102865219116, 2.595750331878662, 3.027928113937378, 1.1434463262557983, 2.10428524017334, 3.3800888061523438, 0.2642338275909424], "mean_td_error": 2.040123224258423, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 27.0, "diff_num_grad_updates_vs_sampler_policy": 26.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.084498405456543, "actor_loss": -4.785463333129883, "critic_loss": 0.6128407716751099, "alpha_loss": -0.07872939109802246, "alpha_value": 0.9922234416007996, "log_alpha_value": -0.0078069716691970825, "target_entropy": -6.0, "policy_t": 0.00635059317573905, "mean_q": 0.901524543762207, "max_q": 5.006562232971191, "min_q": 0.6651564836502075}, "td_error": [1.5980684757232666, 2.3251609802246094, 1.7689764499664307, 2.63692045211792, 1.9876041412353516, 2.702425956726074, 2.2427561283111572, 1.1637190580368042, 0.758377194404602, 1.9699857234954834, 0.6263127326965332, 1.6981812715530396, 1.6773920059204102, 1.36124587059021, 1.8527655601501465, 2.552088499069214, 4.076940536499023, 2.045328140258789, 0.09452784061431885, 4.246115684509277, 2.964432954788208, 3.5213375091552734, 0.1905888020992279, 3.8765954971313477, 2.735682487487793, 2.615252733230591, 2.477015972137451, 3.750235080718994, 1.836759328842163, 2.0275566577911377, 2.1332321166992188, 1.6830191612243652, 1.322263479232788, 1.9274123907089233, 1.486032485961914, 1.731710433959961, 3.6186888217926025, 2.2801523208618164, 1.433107852935791, 2.5387401580810547, 0.3806360065937042, 1.1510989665985107, 3.716785192489624, 1.0436327457427979, 3.1520934104919434, 3.118983507156372, 2.1654696464538574, 1.771819829940796, 2.5652270317077637, 2.4526095390319824, 4.274194717407227, 0.17302003502845764, 0.19234848022460938, 1.4224653244018555, 2.8498215675354004, 1.621816635131836, 2.777088165283203, 1.861886978149414, 0.46115148067474365, 3.041018486022949, 2.726921558380127, 2.8107972145080566, 0.4024122357368469, 3.4836108684539795, 1.4235968589782715, 1.0681002140045166, 1.3197522163391113, 2.089935779571533, 3.530364990234375, 2.231907844543457, 2.5295357704162598, 2.201657772064209, 2.6359870433807373, 2.1701672077178955, 1.3149336576461792, 1.776991844177246, 2.0678606033325195, 2.431553840637207, 0.5144739747047424, 3.8870232105255127, 1.464853286743164, 2.3666324615478516, 2.5876102447509766, 1.676163673400879, 0.062183499336242676, 2.1890439987182617], "mean_td_error": 2.0778133869171143, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 27.0, "diff_num_grad_updates_vs_sampler_policy": 26.0}}, "num_env_steps_sampled": 25088, "num_env_steps_trained": 6966, "num_agent_steps_sampled": 75264, "num_agent_steps_trained": 6966, "last_target_update_ts": 25088, "num_target_updates": 27}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 75264, "num_agent_steps_trained": 6966, "num_env_steps_sampled": 25088, "num_env_steps_trained": 6966, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 946.4965813787996, "num_env_steps_trained_throughput_per_sec": 272.54031026309184, "timesteps_total": 25088, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 75264, "timers": {"training_iteration_time_ms": 1041.896, "sample_time_ms": 746.527, "load_time_ms": 0.314, "load_throughput": 820479.515, "learn_time_ms": 17.962, "learn_throughput": 14363.387, "synch_weights_time_ms": 10.043}, "counters": {"num_env_steps_sampled": 25088, "num_env_steps_trained": 6966, "num_agent_steps_sampled": 75264, "num_agent_steps_trained": 6966, "last_target_update_ts": 25088, "num_target_updates": 27}, "done": false, "episodes_total": 0, "training_iteration": 22, "trial_id": "95c7c_00000", "date": "2023-11-18_20-54-09", "timestamp": 1700369649, "time_this_iter_s": 1.9033310413360596, "time_total_s": 29.70491886138916, "pid": 5649, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16bdf5f80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 29.70491886138916, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 65.76666666666667, "ram_util_percent": 66.43333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.076668739318848, "actor_loss": -4.823084831237793, "critic_loss": 2.2505650520324707, "alpha_loss": -0.0816597267985344, "alpha_value": 0.9919289350509644, "log_alpha_value": -0.008103841915726662, "target_entropy": -6.0, "policy_t": 0.0007443982758559287, "mean_q": 0.9053456783294678, "max_q": 8.750722885131836, "min_q": 0.7127726078033447}, "td_error": [5.4759039878845215, 3.839799642562866, 3.977698802947998, 3.8910439014434814, 3.412750244140625, 0.35120630264282227, 3.765324592590332, 4.840786933898926, 5.343290328979492, 4.252483367919922, 4.646810054779053, 2.254075288772583, 4.2855987548828125, 4.158031940460205, 4.293721675872803, 4.068086624145508, 4.903891563415527, 2.4653501510620117, 2.1881659030914307, 5.017788410186768, 5.102479457855225, 3.067784070968628, 5.167518615722656, 4.7515363693237305, 2.9753670692443848, 3.729414463043213, 5.680686950683594, 3.544145107269287, 2.9823648929595947, 3.2987396717071533, 2.9367475509643555, 4.3789496421813965, 5.153082370758057, 3.757321834564209, 4.151668548583984, 5.582912445068359, 2.656589984893799, 4.501834869384766, 2.8512213230133057, 5.679390907287598, 3.5788068771362305, 2.7894554138183594, 2.4020142555236816, 4.654010772705078, 3.326050043106079, 4.099023818969727, 4.838173866271973, 4.622668266296387, 4.192771911621094, 4.728483200073242, 4.840579032897949, 4.14104700088501, 4.457914352416992, 3.2915868759155273, 2.882748603820801, 4.5555243492126465, 4.799943923950195, 1.4357566833496094, 3.762463331222534, 4.927677631378174, 4.562310218811035, 2.481569766998291, 5.2307586669921875, 2.2090225219726562, 4.3213300704956055, 2.9899356365203857, 4.662840366363525, 3.9478187561035156, 2.7256946563720703, 2.3873355388641357, 5.123541355133057, 4.016325950622559, 5.332517623901367, 5.2639312744140625, 4.733083724975586, 4.591865539550781, 2.630153179168701, 2.7626614570617676, 3.303356170654297, 3.3731517791748047, 1.1876437664031982, 5.195507049560547, 4.7456769943237305, 3.0470099449157715, 3.7127840518951416, 3.842777729034424], "mean_td_error": 3.908010482788086, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 28.0, "diff_num_grad_updates_vs_sampler_policy": 27.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.12125015258789, "actor_loss": -4.707124710083008, "critic_loss": 0.6318091154098511, "alpha_loss": -0.08204717189073563, "alpha_value": 0.9919263124465942, "log_alpha_value": -0.00810642633587122, "target_entropy": -6.0, "policy_t": 0.01797438971698284, "mean_q": 0.9616034626960754, "max_q": 6.1732048988342285, "min_q": 0.5883989334106445}, "td_error": [0.9491037130355835, 2.9549074172973633, 3.7038304805755615, 2.892270565032959, 3.390352249145508, 1.5824875831604004, 1.0735427141189575, 1.9333947896957397, 2.0457212924957275, 2.508589267730713, 2.6885199546813965, 1.5468740463256836, 1.6005947589874268, 0.3124011754989624, 3.3556227684020996, 6.18536901473999, 1.9071197509765625, 2.666982650756836, 3.495673656463623, 0.5339019894599915, 2.527637481689453, 2.252279758453369, 0.9225155115127563, 3.534528970718384, 1.8389451503753662, 0.7248533964157104, 1.042677402496338, 1.335908055305481, 3.5663747787475586, 2.345688581466675, 3.2148590087890625, 0.07708993554115295, 2.776754856109619, 2.268616199493408, 2.5443100929260254, 1.6498658657073975, 3.5326459407806396, 1.3630046844482422, 1.9065994024276733, 2.777576446533203, 1.4643192291259766, 1.802030324935913, 0.7943265438079834, 1.595168113708496, 2.6535706520080566, 3.007535934448242, 2.5603156089782715, 1.0491070747375488, 2.222022533416748, 1.870314121246338, 3.840400218963623, 2.620217800140381, 1.146788239479065, 1.857587456703186, 3.4076430797576904, 1.4358892440795898, 3.873713254928589, 1.4244581460952759, 1.6607331037521362, 3.8345789909362793, 1.9921703338623047, 1.901076078414917, 3.718320846557617, 1.427383542060852, 2.8749289512634277, 2.30446720123291, 3.929788827896118, 1.6960437297821045, 3.114840030670166, 4.152108669281006, 2.4922196865081787, 1.9442704916000366, 1.4797580242156982, 3.414231300354004, 2.560467004776001, 2.006671190261841, 4.156595230102539, 1.8316638469696045, 1.5284583568572998, 2.1633667945861816, 3.4600815773010254, 3.24967622756958, 1.6732747554779053, 1.5204744338989258, 2.1675379276275635, 0.7567424774169922], "mean_td_error": 2.2926433086395264, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 28.0, "diff_num_grad_updates_vs_sampler_policy": 27.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.124122619628906, "actor_loss": -4.863494396209717, "critic_loss": 0.5268992185592651, "alpha_loss": -0.08207844942808151, "alpha_value": 0.9919255375862122, "log_alpha_value": -0.008107215166091919, "target_entropy": -6.0, "policy_t": 0.02545543760061264, "mean_q": 0.8817231059074402, "max_q": 6.167864799499512, "min_q": 0.7073862552642822}, "td_error": [0.4254564344882965, 1.6429736614227295, 1.3539373874664307, 2.0643069744110107, 2.498734474182129, 2.291842460632324, 0.3652867376804352, 1.3706741333007812, 0.9735075831413269, 0.9694794416427612, 1.5081225633621216, 0.7404196262359619, 2.8649051189422607, 0.8038733005523682, 2.0345444679260254, 1.3016583919525146, 0.6395676136016846, 2.1385154724121094, 1.3057785034179688, 3.5287747383117676, 1.5231126546859741, 0.20977452397346497, 2.892989158630371, 2.7670373916625977, 2.1798040866851807, 0.9781022071838379, 1.2691733837127686, 3.1714015007019043, 2.0991601943969727, 0.2766084372997284, 2.12507963180542, 1.768387794494629, 1.895612120628357, 1.2262673377990723, 3.0522773265838623, 0.8971682786941528, 3.1329612731933594, 1.8739882707595825, 2.232607364654541, 2.3232805728912354, 2.075223922729492, 1.966158390045166, 0.24733027815818787, 2.180300712585449, 2.238717555999756, 2.055215358734131, 1.9218788146972656, 3.0571231842041016, 1.4230931997299194, 2.4474387168884277, 2.6684634685516357, 1.244199275970459, 2.4127087593078613, 1.3738117218017578, 1.5718753337860107, 1.9514954090118408, 1.5174946784973145, 3.206087589263916, 1.184329867362976, 0.3784829080104828, 2.6391587257385254, 2.270325183868408, 0.8970764875411987, 1.308010458946228, 1.2613203525543213, 2.529158592224121, 3.394078493118286, 0.167080819606781, 2.0562186241149902, 1.0688543319702148, 0.22738048434257507, 1.7459497451782227, 3.2827515602111816, 3.4186582565307617, 1.7462173700332642, 0.9866875410079956, 2.670513868331909, 3.9021174907684326, 2.305022716522217, 3.6729001998901367, 2.5440049171447754, 1.2143752574920654, 2.7742578983306885, 1.2855805158615112, 2.2356953620910645, 1.716127872467041], "mean_td_error": 1.8506757020950317, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 28.0, "diff_num_grad_updates_vs_sampler_policy": 27.0}}, "num_env_steps_sampled": 25984, "num_env_steps_trained": 7224, "num_agent_steps_sampled": 77952, "num_agent_steps_trained": 7224, "last_target_update_ts": 25984, "num_target_updates": 28}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 77952, "num_agent_steps_trained": 7224, "num_env_steps_sampled": 25984, "num_env_steps_trained": 7224, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 872.2510774624039, "num_env_steps_trained_throughput_per_sec": 251.16158257287972, "timesteps_total": 25984, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 77952, "timers": {"training_iteration_time_ms": 1038.389, "sample_time_ms": 741.568, "load_time_ms": 0.311, "load_throughput": 830874.103, "learn_time_ms": 18.103, "learn_throughput": 14251.816, "synch_weights_time_ms": 10.207}, "counters": {"num_env_steps_sampled": 25984, "num_env_steps_trained": 7224, "num_agent_steps_sampled": 77952, "num_agent_steps_trained": 7224, "last_target_update_ts": 25984, "num_target_updates": 28}, "done": false, "episodes_total": 0, "training_iteration": 23, "trial_id": "95c7c_00000", "date": "2023-11-18_20-54-10", "timestamp": 1700369650, "time_this_iter_s": 1.037473201751709, "time_total_s": 30.74239206314087, "pid": 5649, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16bdf5120>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 30.74239206314087, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 67.75, "ram_util_percent": 66.55}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.063824653625488, "actor_loss": -4.8681230545043945, "critic_loss": 2.114654064178467, "alpha_loss": -0.08457919210195541, "alpha_value": 0.9916309118270874, "log_alpha_value": -0.008404278196394444, "target_entropy": -6.0, "policy_t": 0.018792055547237396, "mean_q": 1.3055332899093628, "max_q": 10.988545417785645, "min_q": 0.7607537508010864}, "td_error": [4.002735614776611, 3.284104824066162, 0.7440977096557617, 2.410848617553711, 2.622677803039551, 5.550907135009766, 4.04491662979126, 5.226280212402344, 5.705141067504883, 4.068304538726807, 4.931340217590332, 2.708167552947998, 3.239331007003784, 3.508423328399658, 3.4795877933502197, 4.247984409332275, 5.735952377319336, 3.2301697731018066, 5.012656211853027, 2.4004299640655518, 3.2453949451446533, 3.1799964904785156, 2.6886799335479736, 2.4121415615081787, 4.188174247741699, 3.2992844581604004, 0.8762626647949219, 5.325708866119385, 3.2401866912841797, 2.9600768089294434, 3.1323113441467285, 4.30722713470459, 3.1827168464660645, 5.660504341125488, 3.760117530822754, 1.2682080268859863, 3.551494598388672, 3.176724433898926, 4.883634567260742, 2.4738657474517822, 4.767228603363037, 0.424471378326416, 3.599048614501953, 4.196506500244141, 5.207309722900391, 4.86981201171875, 5.316736221313477, 4.321727752685547, 3.326932430267334, 3.5314598083496094, 4.550100326538086, 2.525416851043701, 3.2256007194519043, 3.375199556350708, 3.2239205837249756, 5.348624229431152, 5.828375816345215, 4.578763008117676, 3.703481674194336, 3.389192819595337, 4.444989204406738, 3.483045816421509, 4.14875602722168, 4.046018600463867, 3.959421157836914, 4.844790458679199, 0.847954273223877, 1.7189147472381592, 4.004824638366699, 2.4062857627868652, 3.126835584640503, 4.309587478637695, 3.3601651191711426, 4.869603157043457, 1.1236547231674194, 1.9046416282653809, 2.6873412132263184, 5.452465534210205, 4.1026716232299805, 4.855324745178223, 1.6984566450119019, 4.244048595428467, 3.597714424133301, 4.316920280456543, 5.173992156982422, 6.03123664855957], "mean_td_error": 3.686469554901123, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 29.0, "diff_num_grad_updates_vs_sampler_policy": 28.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.083739280700684, "actor_loss": -4.701806545257568, "critic_loss": 0.6198424100875854, "alpha_loss": -0.08477131277322769, "alpha_value": 0.9916285276412964, "log_alpha_value": -0.008406734094023705, "target_entropy": -6.0, "policy_t": 0.04001764580607414, "mean_q": 0.7140127420425415, "max_q": 5.7245774269104, "min_q": 0.6279634237289429}, "td_error": [3.938264846801758, 1.4795594215393066, 2.6643035411834717, 3.174074411392212, 3.2729058265686035, 2.4333412647247314, 2.8606338500976562, 3.079989433288574, 1.7806684970855713, 1.7988649606704712, 2.8886284828186035, 2.633449077606201, 2.681705951690674, 4.623249053955078, 2.8115508556365967, 4.018272399902344, 1.6902705430984497, 0.061857521533966064, 1.3553400039672852, 2.5266146659851074, 2.103933811187744, 1.5530740022659302, 1.973947525024414, 3.1521246433258057, 3.6959009170532227, 1.0649306774139404, 0.5680732727050781, 2.161098003387451, 1.069584608078003, 1.2580499649047852, 1.8830775022506714, 3.3377997875213623, 0.23984846472740173, 2.123378276824951, 1.2787013053894043, 1.856989860534668, 1.5911996364593506, 3.304762363433838, 2.8113479614257812, 1.3756530284881592, 2.9262895584106445, 1.372528076171875, 2.6385207176208496, 2.940258502960205, 2.4900550842285156, 1.824394941329956, 3.42022442817688, 0.2900357246398926, 3.125006675720215, 2.214292049407959, 2.26735520362854, 1.403395652770996, 2.492810010910034, 1.8344027996063232, 3.5584821701049805, 1.7542178630828857, 1.9453679323196411, 1.6168851852416992, 2.50342059135437, 0.5767017602920532, 0.08018839359283447, 1.7401163578033447, 4.642945289611816, 1.6267491579055786, 2.5643062591552734, 2.9468045234680176, 1.9769835472106934, 0.5412060022354126, 0.5701614618301392, 3.0722858905792236, 3.2736406326293945, 1.5319797992706299, 2.5431289672851562, 3.3667218685150146, 1.7214823961257935, 2.4767863750457764, 3.3420419692993164, 3.137864828109741, 1.6255005598068237, 0.6870633363723755, 0.9705003499984741, 3.783749580383301, 4.260100841522217, 0.8212451934814453, 1.3853260278701782, 0.6207836866378784], "mean_td_error": 2.1939687728881836, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 29.0, "diff_num_grad_updates_vs_sampler_policy": 28.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.100250244140625, "actor_loss": -4.884551048278809, "critic_loss": 0.6076481342315674, "alpha_loss": -0.0849178209900856, "alpha_value": 0.9916277527809143, "log_alpha_value": -0.00840749591588974, "target_entropy": -6.0, "policy_t": -0.024247724562883377, "mean_q": 1.031181812286377, "max_q": 6.267547607421875, "min_q": 0.7516545057296753}, "td_error": [0.6636951565742493, 1.5855224132537842, 1.000006914138794, 2.8897576332092285, 1.9667272567749023, 1.7242722511291504, 1.6688714027404785, 1.2854645252227783, 2.548111915588379, 1.9211037158966064, 3.113778829574585, 2.906513214111328, 2.2047486305236816, 1.4687690734863281, 1.922741413116455, 2.0338168144226074, 1.4833170175552368, 1.8996517658233643, 1.7008007764816284, 2.9744982719421387, 2.333803176879883, 2.607233762741089, 3.2323951721191406, 2.974886417388916, 0.8798826932907104, 1.4551061391830444, 4.143899440765381, 2.9046030044555664, 1.5658724308013916, 3.372166156768799, 0.6817024946212769, 1.5290461778640747, 1.1685583591461182, 2.6586251258850098, 3.1879920959472656, 1.4417941570281982, 1.855061411857605, 1.0907461643218994, 0.22258621454238892, 1.415257215499878, 0.4038664698600769, 0.3030645251274109, 3.996108055114746, 1.47163724899292, 4.444911956787109, 3.953235626220703, 2.439927101135254, 3.7846713066101074, 3.3322391510009766, 1.6067898273468018, 1.1799290180206299, 1.998878836631775, 1.9218432903289795, 1.9097100496292114, 1.8346858024597168, 0.935255765914917, 2.760368824005127, 1.7615606784820557, 3.936344623565674, 0.8603675365447998, 3.4003875255584717, 0.33850881457328796, 3.2565054893493652, 2.491267204284668, 1.860109806060791, 3.0652976036071777, 0.8622385859489441, 0.08991044759750366, 1.453491449356079, 0.32336586713790894, 2.137258529663086, 1.4578561782836914, 2.07926607131958, 3.838231325149536, 3.3407649993896484, 3.8118648529052734, 1.5918015241622925, 1.3043437004089355, 2.7390360832214355, 2.986699342727661, 1.8674062490463257, 3.374091625213623, 3.545499563217163, 0.9782695770263672, 1.2083133459091187, 2.195694923400879], "mean_td_error": 2.0943751335144043, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 29.0, "diff_num_grad_updates_vs_sampler_policy": 28.0}}, "num_env_steps_sampled": 26880, "num_env_steps_trained": 7482, "num_agent_steps_sampled": 80640, "num_agent_steps_trained": 7482, "last_target_update_ts": 26880, "num_target_updates": 29}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80640, "num_agent_steps_trained": 7482, "num_env_steps_sampled": 26880, "num_env_steps_trained": 7482, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 759.6929900207444, "num_env_steps_trained_throughput_per_sec": 218.7508832872233, "timesteps_total": 26880, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 80640, "timers": {"training_iteration_time_ms": 1064.044, "sample_time_ms": 767.161, "load_time_ms": 0.312, "load_throughput": 826937.515, "learn_time_ms": 18.157, "learn_throughput": 14209.261, "synch_weights_time_ms": 10.007}, "counters": {"num_env_steps_sampled": 26880, "num_env_steps_trained": 7482, "num_agent_steps_sampled": 80640, "num_agent_steps_trained": 7482, "last_target_update_ts": 26880, "num_target_updates": 29}, "done": false, "episodes_total": 0, "training_iteration": 24, "trial_id": "95c7c_00000", "date": "2023-11-18_20-54-12", "timestamp": 1700369652, "time_this_iter_s": 1.1897249221801758, "time_total_s": 31.932116985321045, "pid": 5649, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16bd425c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 31.932116985321045, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 78.4, "ram_util_percent": 66.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.092738151550293, "actor_loss": -4.944948196411133, "critic_loss": 2.21059513092041, "alpha_loss": -0.08785343915224075, "alpha_value": 0.9913331270217896, "log_alpha_value": -0.00870461855083704, "target_entropy": -6.0, "policy_t": 0.013428889214992523, "mean_q": 1.6866443157196045, "max_q": 11.302618026733398, "min_q": 0.8102260828018188}, "td_error": [3.938309669494629, 3.2283143997192383, 4.803869724273682, 3.1120047569274902, 1.7156813144683838, 4.744405746459961, 3.653163433074951, 4.158449172973633, 2.4968738555908203, 6.003742218017578, 2.6392767429351807, 2.808468818664551, 4.058124542236328, 3.6921205520629883, 3.202916145324707, 2.7915964126586914, 4.191839218139648, 6.591910362243652, 3.3677258491516113, 2.091029644012451, 5.657632350921631, 4.122454643249512, 2.834346294403076, 2.9336042404174805, 4.218015670776367, 1.4357473850250244, 3.1785287857055664, 4.812508583068848, 2.433073043823242, 3.289334774017334, 5.049849510192871, 3.107093095779419, 2.864104747772217, 4.903522491455078, 5.927680969238281, 3.60892915725708, 2.607182025909424, 3.8567862510681152, 3.3151960372924805, 3.7124030590057373, 3.635291814804077, 4.605205059051514, 6.291747093200684, 2.6341514587402344, 4.1708269119262695, 3.167349100112915, 2.865216016769409, 3.022291660308838, 1.7414485216140747, 5.5575666427612305, 4.505740642547607, 0.42581772804260254, 4.78030252456665, 4.624378204345703, 4.208737373352051, 4.551932334899902, 5.998747825622559, 3.6472420692443848, 3.8799664974212646, 4.412635803222656, 1.4202287197113037, 4.781608581542969, 5.3238019943237305, 4.225281238555908, 4.167362213134766, 4.847620964050293, 3.77896785736084, 3.6172242164611816, 3.124877691268921, 3.8867151737213135, 4.073796272277832, 5.283773422241211, 2.9096744060516357, 3.1910157203674316, 4.9145731925964355, 3.4415178298950195, 5.213523864746094, 3.557058811187744, 3.956804037094116, 2.9077467918395996, 5.822731018066406, 3.7276744842529297, 5.441854476928711, 5.195788383483887, 3.566746234893799, 2.917858600616455], "mean_td_error": 3.850933313369751, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 30.0, "diff_num_grad_updates_vs_sampler_policy": 29.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.076667785644531, "actor_loss": -4.739562511444092, "critic_loss": 0.6460140943527222, "alpha_loss": -0.08773782104253769, "alpha_value": 0.9913307428359985, "log_alpha_value": -0.008707026951014996, "target_entropy": -6.0, "policy_t": 0.03897412121295929, "mean_q": 0.811914324760437, "max_q": 6.386696815490723, "min_q": 0.6700029969215393}, "td_error": [2.908510446548462, 1.9445757865905762, 1.1241413354873657, 2.161930561065674, 2.4161407947540283, 1.8991210460662842, 2.0155041217803955, 1.7799370288848877, 1.6292600631713867, 2.871809959411621, 2.961885929107666, 2.192246437072754, 3.387324333190918, 2.0144951343536377, 3.160945177078247, 2.4479832649230957, 1.405619502067566, 2.1575779914855957, 2.1421666145324707, 3.1724209785461426, 2.2010467052459717, 2.2134623527526855, 1.7424001693725586, 1.5168706178665161, 1.3983591794967651, 2.4609899520874023, 1.3751888275146484, 3.364452362060547, 1.4053837060928345, 2.6590402126312256, 2.4087891578674316, 1.8228144645690918, 2.48063325881958, 5.976263999938965, 1.84470534324646, 2.608264923095703, 1.6633274555206299, 3.6239209175109863, 2.1447319984436035, 1.5613279342651367, 0.4932580590248108, 1.780355453491211, 2.2202775478363037, 4.350805759429932, 2.6458489894866943, 2.8784258365631104, 2.8141238689422607, 3.354375123977661, 1.9651589393615723, 1.2357207536697388, 2.4781529903411865, 2.5789637565612793, 3.8648741245269775, 0.4270085096359253, 3.524512767791748, 3.0487890243530273, 3.2442197799682617, 2.9119861125946045, 2.9280457496643066, 3.223025321960449, 2.054671049118042, 2.7441611289978027, 0.9884517192840576, 2.1042191982269287, 2.636523723602295, 3.032097339630127, 1.8844118118286133, 1.9532039165496826, 2.6002602577209473, 2.5417065620422363, 3.4161667823791504, 1.3251094818115234, 2.498291492462158, 1.3843226432800293, 1.2918226718902588, 0.073306143283844, 0.449509859085083, 1.6216694116592407, 1.7639334201812744, 2.9629292488098145, 1.394357442855835, 0.9993550777435303, 2.3003530502319336, 4.224123001098633, 1.8550602197647095, 2.2931318283081055], "mean_td_error": 2.2863564491271973, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 30.0, "diff_num_grad_updates_vs_sampler_policy": 29.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.092408180236816, "actor_loss": -4.925830364227295, "critic_loss": 0.5151677131652832, "alpha_loss": -0.08788226544857025, "alpha_value": 0.9913300275802612, "log_alpha_value": -0.008707759901881218, "target_entropy": -6.0, "policy_t": -0.05085549131035805, "mean_q": 0.9736044406890869, "max_q": 6.337163925170898, "min_q": 0.7970545291900635}, "td_error": [2.127267360687256, 0.8451070785522461, 1.371037244796753, 3.3867647647857666, 2.278909206390381, 2.2576913833618164, 0.7366385459899902, 0.36082759499549866, 0.17388832569122314, 2.6738734245300293, 0.6889477968215942, 4.132025718688965, 1.0122846364974976, 2.497694492340088, 0.19844266772270203, 0.2998282015323639, 2.903831958770752, 2.00313401222229, 4.1494364738464355, 0.7120652794837952, 1.3386645317077637, 2.253169536590576, 1.7933626174926758, 0.657972514629364, 1.6579139232635498, 1.1174907684326172, 1.3896708488464355, 2.638309955596924, 1.5493707656860352, 0.9903714656829834, 1.2649881839752197, 1.8496456146240234, 1.3661305904388428, 1.0611954927444458, 1.6895604133605957, 1.530749797821045, 2.4031403064727783, 3.439176559448242, 2.4129233360290527, 2.531773090362549, 1.9002063274383545, 1.4691777229309082, 1.027894377708435, 1.9036669731140137, 4.8165082931518555, 2.157900810241699, 2.3940629959106445, 3.081240177154541, 2.600615978240967, 1.9110209941864014, 3.163412094116211, 1.309281349182129, 0.738435685634613, 1.6757287979125977, 1.190117597579956, 3.262726306915283, 0.2875065505504608, 0.48372000455856323, 0.45822709798812866, 1.5047498941421509, 2.1081039905548096, 1.5859349966049194, 0.962358295917511, 3.0903005599975586, 3.7896459102630615, 2.4334006309509277, 0.5317651033401489, 1.8484523296356201, 2.435758590698242, 2.310431957244873, 4.471879959106445, 2.183887481689453, 3.445535182952881, 1.0083014965057373, 1.9046530723571777, 1.2867095470428467, 2.026709794998169, 1.6249110698699951, 1.2421917915344238, 0.6115478873252869, 3.0782582759857178, 0.482567697763443, 2.3505496978759766, 2.527820587158203, 2.501742362976074, 1.92795991897583], "mean_td_error": 1.8703819513320923, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 30.0, "diff_num_grad_updates_vs_sampler_policy": 29.0}}, "num_env_steps_sampled": 27776, "num_env_steps_trained": 7740, "num_agent_steps_sampled": 83328, "num_agent_steps_trained": 7740, "last_target_update_ts": 27776, "num_target_updates": 30}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 83328, "num_agent_steps_trained": 7740, "num_env_steps_sampled": 27776, "num_env_steps_trained": 7740, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 840.9300886825081, "num_env_steps_trained_throughput_per_sec": 242.1428157143829, "timesteps_total": 27776, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 83328, "timers": {"training_iteration_time_ms": 1062.968, "sample_time_ms": 768.253, "load_time_ms": 0.31, "load_throughput": 831257.053, "learn_time_ms": 18.109, "learn_throughput": 14246.825, "synch_weights_time_ms": 10.202}, "counters": {"num_env_steps_sampled": 27776, "num_env_steps_trained": 7740, "num_agent_steps_sampled": 83328, "num_agent_steps_trained": 7740, "last_target_update_ts": 27776, "num_target_updates": 30}, "done": false, "episodes_total": 0, "training_iteration": 25, "trial_id": "95c7c_00000", "date": "2023-11-18_20-54-13", "timestamp": 1700369653, "time_this_iter_s": 1.0757770538330078, "time_total_s": 33.00789403915405, "pid": 5649, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16bd42e80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 33.00789403915405, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 74.25, "ram_util_percent": 66.85}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.137344360351562, "actor_loss": -5.029613971710205, "critic_loss": 2.0342836380004883, "alpha_loss": -0.09128613024950027, "alpha_value": 0.9910354614257812, "log_alpha_value": -0.009004935622215271, "target_entropy": -6.0, "policy_t": -0.00759434700012207, "mean_q": 1.2754486799240112, "max_q": 10.459561347961426, "min_q": 0.8581744432449341}, "td_error": [3.9537229537963867, 3.686676025390625, 3.5506818294525146, 3.511312961578369, 4.513051986694336, 5.085346698760986, 1.7377997636795044, 3.317336082458496, 2.920907974243164, 5.696669578552246, 3.588897228240967, 3.4396824836730957, 4.237727165222168, 4.288345813751221, 4.846287727355957, 0.32567429542541504, 2.7612171173095703, 3.673403024673462, 0.7443757057189941, 2.343660354614258, 5.940692901611328, 4.673999786376953, 2.0354104042053223, 3.5713303089141846, 2.5677695274353027, 3.5585317611694336, 3.461285352706909, 5.44666862487793, 4.5237135887146, 5.583502769470215, 4.162396430969238, 5.9201860427856445, 3.967017650604248, 3.469210147857666, 4.13922643661499, 2.062811851501465, 4.428140640258789, 2.9851348400115967, 1.4834368228912354, 4.846471786499023, 5.15480375289917, 3.7322754859924316, 3.093266725540161, 1.3629915714263916, 1.1217737197875977, 4.286693572998047, 4.909210681915283, 4.582956314086914, 4.879429817199707, 4.758190155029297, 3.634471893310547, 3.448807716369629, 3.0307705402374268, 3.228771686553955, 4.909045219421387, 1.4812768697738647, 1.9676682949066162, 3.4563629627227783, 3.6763522624969482, 2.7932729721069336, 4.186612129211426, 5.402861595153809, 0.29353153705596924, 2.1964802742004395, 3.1130471229553223, 3.0691490173339844, 3.316856861114502, 5.847375869750977, 3.1226420402526855, 3.4349539279937744, 1.0734450817108154, 2.75960111618042, 3.8338100910186768, 3.863154888153076, 5.510852813720703, 4.3227219581604, 3.060903549194336, 4.655901908874512, 3.3628745079040527, 4.220699310302734, 3.5277786254882812, 1.879544973373413, 3.469984531402588, 3.0044431686401367, 4.751595973968506, 4.791282653808594], "mean_td_error": 3.5887234210968018, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 31.0, "diff_num_grad_updates_vs_sampler_policy": 30.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.061761856079102, "actor_loss": -4.756342887878418, "critic_loss": 0.5614899396896362, "alpha_loss": -0.0906292200088501, "alpha_value": 0.991033136844635, "log_alpha_value": -0.009007291868329048, "target_entropy": -6.0, "policy_t": 0.02546173334121704, "mean_q": 0.9399782419204712, "max_q": 6.492013931274414, "min_q": 0.7141169309616089}, "td_error": [3.2387375831604004, 0.26827532052993774, 1.246084213256836, 2.505509376525879, 3.9955320358276367, 0.8021488189697266, 1.036663293838501, 0.1819591522216797, 1.8002208471298218, 4.021428108215332, 1.6432815790176392, 2.1662814617156982, 0.7244086861610413, 2.5393266677856445, 0.17325255274772644, 1.5931756496429443, 2.3889236450195312, 3.0265328884124756, 3.717255115509033, 2.695941925048828, 0.9564988613128662, 3.0024261474609375, 1.2214505672454834, 0.9029456377029419, 1.3250951766967773, 1.9966967105865479, 2.751084804534912, 3.0055994987487793, 2.8680849075317383, 3.261725902557373, 0.9397999048233032, 2.8205204010009766, 4.4889655113220215, 1.105513095855713, 4.667318344116211, 1.6157066822052002, 1.146418809890747, 1.866377592086792, 2.2374958992004395, 3.665055274963379, 2.3053359985351562, 1.380925178527832, 1.927201271057129, 0.4487415552139282, 2.2321324348449707, 2.2204930782318115, 3.0078988075256348, 3.001046657562256, 0.631371796131134, 1.4359676837921143, 1.4699196815490723, 2.849546432495117, 2.89778470993042, 2.0000216960906982, 1.2178452014923096, 1.874719500541687, 0.03365790843963623, 1.659442663192749, 3.2392148971557617, 2.166018486022949, 1.4492075443267822, 1.3091063499450684, 0.7040866613388062, 0.910165011882782, 2.3451995849609375, 3.960918426513672, 3.074950933456421, 1.9620414972305298, 2.711962938308716, 1.3272672891616821, 2.915034294128418, 1.6452869176864624, 3.485696792602539, 1.28819739818573, 1.1763395071029663, 0.46168839931488037, 2.317927837371826, 1.6078946590423584, 0.2956431806087494, 2.873823881149292, 1.6483505964279175, 3.7934484481811523, 2.1155765056610107, 3.9030661582946777, 2.1351521015167236, 0.7933788895606995], "mean_td_error": 2.0444235801696777, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 31.0, "diff_num_grad_updates_vs_sampler_policy": 30.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.086986541748047, "actor_loss": -4.964471817016602, "critic_loss": 0.5643563270568848, "alpha_loss": -0.09086349606513977, "alpha_value": 0.9910324811935425, "log_alpha_value": -0.009007991291582584, "target_entropy": -6.0, "policy_t": -0.018786797299981117, "mean_q": 1.08766770362854, "max_q": 6.395933628082275, "min_q": 0.8440511226654053}, "td_error": [0.6129859685897827, 2.6571950912475586, 3.8728747367858887, 0.5510537028312683, 0.5811066627502441, 0.8177051544189453, 3.0948688983917236, 0.9555724859237671, 2.000162363052368, 0.8679203987121582, 1.4285643100738525, 2.0641531944274902, 0.14838549494743347, 2.9954729080200195, 3.5555968284606934, 0.48994436860084534, 2.4202678203582764, 3.5240814685821533, 1.6990792751312256, 2.0903420448303223, 2.7805016040802, 3.364243507385254, 3.5405311584472656, 1.3458399772644043, 1.6277258396148682, 2.292818546295166, 2.7770252227783203, 1.239213466644287, 3.9463000297546387, 1.777206301689148, 2.7365386486053467, 2.6648569107055664, 2.795581102371216, 0.0445481538772583, 3.283231735229492, 1.2462952136993408, 2.2488760948181152, 0.7253108024597168, 2.585200786590576, 1.1019551753997803, 1.0925781726837158, 2.495788097381592, 2.149653434753418, 2.8454298973083496, 3.5604019165039062, 4.072566986083984, 1.6687167882919312, 2.635885715484619, 0.7948179841041565, 2.8376128673553467, 1.6755459308624268, 1.511626958847046, 1.1590304374694824, 0.7107561230659485, 1.179840326309204, 1.3823966979980469, 1.074380874633789, 1.543543815612793, 4.412296295166016, 0.5492833852767944, 2.595402479171753, 1.1500197649002075, 2.5456721782684326, 1.7667638063430786, 2.5493574142456055, 0.9121474027633667, 3.792283058166504, 2.7210769653320312, 0.620904803276062, 4.722661018371582, 1.9264419078826904, 1.74483060836792, 2.510672092437744, 1.2600631713867188, 1.7052569389343262, 1.7893571853637695, 0.017361342906951904, 4.242170333862305, 1.3256542682647705, 2.2197272777557373, 1.650207757949829, 0.13874459266662598, 0.6956018209457397, 0.7701377272605896, 1.4162659645080566, 2.912508964538574], "mean_td_error": 1.9721461534500122, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 31.0, "diff_num_grad_updates_vs_sampler_policy": 30.0}}, "num_env_steps_sampled": 28672, "num_env_steps_trained": 7998, "num_agent_steps_sampled": 86016, "num_agent_steps_trained": 7998, "last_target_update_ts": 28672, "num_target_updates": 31}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 86016, "num_agent_steps_trained": 7998, "num_env_steps_sampled": 28672, "num_env_steps_trained": 7998, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 758.4607444066972, "num_env_steps_trained_throughput_per_sec": 218.3960625635356, "timesteps_total": 28672, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 86016, "timers": {"training_iteration_time_ms": 1078.692, "sample_time_ms": 782.368, "load_time_ms": 0.311, "load_throughput": 830746.532, "learn_time_ms": 18.31, "learn_throughput": 14090.735, "synch_weights_time_ms": 10.54}, "counters": {"num_env_steps_sampled": 28672, "num_env_steps_trained": 7998, "num_agent_steps_sampled": 86016, "num_agent_steps_trained": 7998, "last_target_update_ts": 28672, "num_target_updates": 31}, "done": false, "episodes_total": 0, "training_iteration": 26, "trial_id": "95c7c_00000", "date": "2023-11-18_20-54-14", "timestamp": 1700369654, "time_this_iter_s": 1.1901209354400635, "time_total_s": 34.198014974594116, "pid": 5649, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16bd42520>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 34.198014974594116, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 67.75, "ram_util_percent": 67.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.122613906860352, "actor_loss": -5.0822434425354, "critic_loss": 2.170260190963745, "alpha_loss": -0.09419422596693039, "alpha_value": 0.9907378554344177, "log_alpha_value": -0.009305325336754322, "target_entropy": -6.0, "policy_t": 0.01872904971241951, "mean_q": 1.550767421722412, "max_q": 11.644962310791016, "min_q": 0.9083153009414673}, "td_error": [3.221719741821289, 2.048671245574951, 2.69016432762146, 5.35997200012207, 4.744748115539551, 2.9017786979675293, 7.769704818725586, 5.675321578979492, 4.488333225250244, 4.965986251831055, 5.1332621574401855, 3.543315887451172, 3.1460022926330566, 4.601810455322266, 4.015780448913574, 4.232364654541016, 3.4272537231445312, 3.1828949451446533, 4.58261775970459, 1.6363162994384766, 3.288623332977295, 4.336637496948242, 3.885571241378784, 0.63410484790802, 4.435356140136719, 0.9544203281402588, 2.187828540802002, 4.582690715789795, 4.41200590133667, 2.549471855163574, 3.95084810256958, 4.5191569328308105, 4.344620704650879, 2.7021799087524414, 4.727976322174072, 5.404783248901367, 5.641537666320801, 3.4362950325012207, 1.4027729034423828, 4.516718864440918, 4.278237819671631, 4.683907508850098, 2.2982378005981445, 4.026031494140625, 3.5000813007354736, 6.452227592468262, 5.246026039123535, 4.758760452270508, 3.2990427017211914, 3.7639851570129395, 4.103640556335449, 5.037378311157227, 4.085640907287598, 3.6485300064086914, 2.2206058502197266, 4.352151870727539, 3.7032809257507324, 4.385296821594238, 3.177255153656006, 4.30015230178833, 2.8134350776672363, 3.6645474433898926, 3.384110450744629, 2.886544942855835, 4.007314205169678, 4.4433488845825195, 5.05526876449585, 0.9625332355499268, 1.24928879737854, 5.853558540344238, 2.226559638977051, 3.300790548324585, 2.303913116455078, 4.533935546875, 3.746842384338379, 3.4707021713256836, 4.174560546875, 1.646651029586792, 4.679818153381348, 3.806525230407715, 2.1844332218170166, 5.017009735107422, 4.436966419219971, 3.4229211807250977, 3.320669174194336, 3.692873477935791], "mean_td_error": 3.7777581214904785, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 32.0, "diff_num_grad_updates_vs_sampler_policy": 31.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.111920356750488, "actor_loss": -4.848003387451172, "critic_loss": 0.5665866136550903, "alpha_loss": -0.0941166952252388, "alpha_value": 0.9907357096672058, "log_alpha_value": -0.00930749997496605, "target_entropy": -6.0, "policy_t": -0.025028083473443985, "mean_q": 1.0137604475021362, "max_q": 6.572163105010986, "min_q": 0.7597721219062805}, "td_error": [2.002845287322998, 1.8962962627410889, 0.21845003962516785, 2.646164655685425, 1.0838203430175781, 1.7317184209823608, 2.940797805786133, 2.3048598766326904, 2.98691987991333, 3.886618137359619, 1.1482020616531372, 2.079461097717285, 1.660132646560669, 1.8479294776916504, 3.6934454441070557, 3.35626220703125, 2.179600954055786, 2.0447535514831543, 1.263336420059204, 3.0446205139160156, 2.922189950942993, 1.5792269706726074, 0.8199851512908936, 3.547545909881592, 2.4790244102478027, 4.214168548583984, 2.08683443069458, 0.0354522168636322, 2.9453883171081543, 3.975648880004883, 0.8312342166900635, 0.7734331488609314, 0.059405237436294556, 0.6739996075630188, 1.9867570400238037, 2.0474159717559814, 1.9021567106246948, 1.2575924396514893, 0.39665687084198, 1.5610787868499756, 1.4639531373977661, 3.215484142303467, 1.8106268644332886, 1.9221978187561035, 0.8440841436386108, 2.7098183631896973, 1.750138521194458, 2.263537883758545, 1.3099825382232666, 2.4575977325439453, 1.65189528465271, 1.2555608749389648, 1.099280595779419, 3.3874692916870117, 2.652543067932129, 4.0788068771362305, 2.828225612640381, 0.47529304027557373, 0.3691128194332123, 1.5240840911865234, 2.3721909523010254, 1.1793839931488037, 3.358157157897949, 2.4789342880249023, 2.669682502746582, 2.485156536102295, 2.843923568725586, 2.9072375297546387, 1.6249381303787231, 2.605670928955078, 2.784498453140259, 1.9233580827713013, 3.5607080459594727, 1.5884227752685547, 2.200434446334839, 0.5328041911125183, 1.692734956741333, 0.7508565187454224, 2.1427931785583496, 4.4275922775268555, 1.3020989894866943, 0.5199946165084839, 0.4402034878730774, 2.0538036823272705, 2.6892337799072266, 3.4869179725646973], "mean_td_error": 2.0442192554473877, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 32.0, "diff_num_grad_updates_vs_sampler_policy": 31.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.122446060180664, "actor_loss": -5.042710304260254, "critic_loss": 0.5564370155334473, "alpha_loss": -0.09422159194946289, "alpha_value": 0.9907349944114685, "log_alpha_value": -0.009308183565735817, "target_entropy": -6.0, "policy_t": 0.02590775117278099, "mean_q": 1.1306469440460205, "max_q": 6.439555644989014, "min_q": 0.8924190402030945}, "td_error": [2.4654977321624756, 2.352522850036621, 2.4689059257507324, 0.2194577157497406, 2.782139778137207, 1.1343631744384766, 1.9411165714263916, 2.41212797164917, 2.5152676105499268, 2.333890438079834, 0.9571647047996521, 3.5504817962646484, 0.9363224506378174, 2.4761247634887695, 0.44248053431510925, 3.0497922897338867, 0.03314530849456787, 3.349255323410034, 2.4954800605773926, 2.340735912322998, 2.4162065982818604, 2.0677051544189453, 2.9142417907714844, 2.7442376613616943, 0.8906904458999634, 1.5435525178909302, 3.2927067279815674, 2.256734848022461, 1.8881502151489258, 1.379544973373413, 1.9573314189910889, 3.1536412239074707, 0.8847979307174683, 2.5790891647338867, 1.0365478992462158, 0.8921234607696533, 1.7912640571594238, 1.8960261344909668, 2.373852014541626, 2.7579877376556396, 1.8170616626739502, 2.3705976009368896, 2.232861042022705, 3.6242835521698, 0.562131941318512, 1.295121192932129, 1.2813700437545776, 3.593738079071045, 0.8001638650894165, 1.5028250217437744, 2.380876302719116, 1.9660396575927734, 2.824789047241211, 0.47443756461143494, 2.023710250854492, 1.628122329711914, 0.727873682975769, 3.2772626876831055, 0.6617065668106079, 1.5036453008651733, 2.7393975257873535, 2.7792365550994873, 2.3140387535095215, 1.7173261642456055, 2.2652597427368164, 2.4826765060424805, 1.830411434173584, 1.4205949306488037, 3.5193207263946533, 4.787683010101318, 0.897451639175415, 0.7570056319236755, 1.5321757793426514, 0.7188749313354492, 1.1046488285064697, 0.8044804334640503, 2.2471697330474854, 1.8451108932495117, 1.2987627983093262, 1.5471190214157104, 2.8693056106567383, 0.5216687917709351, 2.0786259174346924, 0.4429861009120941, 3.38940167427063, 3.9550304412841797], "mean_td_error": 1.969617247581482, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 32.0, "diff_num_grad_updates_vs_sampler_policy": 31.0}}, "num_env_steps_sampled": 29568, "num_env_steps_trained": 8256, "num_agent_steps_sampled": 88704, "num_agent_steps_trained": 8256, "last_target_update_ts": 29568, "num_target_updates": 32}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88704, "num_agent_steps_trained": 8256, "num_env_steps_sampled": 29568, "num_env_steps_trained": 8256, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 681.80330061983, "num_env_steps_trained_throughput_per_sec": 196.3228254016921, "timesteps_total": 29568, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 88704, "timers": {"training_iteration_time_ms": 1111.694, "sample_time_ms": 815.167, "load_time_ms": 0.31, "load_throughput": 832664.229, "learn_time_ms": 18.855, "learn_throughput": 13683.079, "synch_weights_time_ms": 10.513}, "counters": {"num_env_steps_sampled": 29568, "num_env_steps_trained": 8256, "num_agent_steps_sampled": 88704, "num_agent_steps_trained": 8256, "last_target_update_ts": 29568, "num_target_updates": 32}, "done": false, "episodes_total": 0, "training_iteration": 27, "trial_id": "95c7c_00000", "date": "2023-11-18_20-54-15", "timestamp": 1700369655, "time_this_iter_s": 1.324204921722412, "time_total_s": 35.52221989631653, "pid": 5649, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16bd43920>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 35.52221989631653, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 75.9, "ram_util_percent": 68.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.148812294006348, "actor_loss": -5.139396667480469, "critic_loss": 2.150099992752075, "alpha_loss": -0.09748692065477371, "alpha_value": 0.9904402494430542, "log_alpha_value": -0.00960574671626091, "target_entropy": -6.0, "policy_t": -0.00028173683676868677, "mean_q": 1.2476215362548828, "max_q": 10.6827392578125, "min_q": 0.9574475288391113}, "td_error": [3.466851234436035, 3.1916937828063965, 4.6859893798828125, 3.372892141342163, 3.882878065109253, 5.581340789794922, 4.013586044311523, 4.804697036743164, 2.605473518371582, 4.08734130859375, 3.605992317199707, 5.62843656539917, 4.127239227294922, 3.8935775756835938, 3.0156149864196777, 4.103381633758545, 5.07437801361084, 3.275550365447998, 3.773719549179077, 3.3103139400482178, 2.821943521499634, 2.776832103729248, 3.7612414360046387, 4.0896806716918945, 4.809900283813477, 3.797344207763672, 4.2309722900390625, 5.021158695220947, 5.045522689819336, 4.5274658203125, 4.31312370300293, 5.253570556640625, 3.890904188156128, 4.644469261169434, 3.5260133743286133, 2.837650775909424, 4.060894012451172, 5.925750255584717, 3.340146780014038, 6.213580131530762, 1.9082789421081543, 2.9623870849609375, 3.639090061187744, 3.3662607669830322, 1.9968459606170654, 4.542891502380371, 4.837516784667969, 4.976927280426025, 4.225323677062988, 3.8794217109680176, 3.637535572052002, 4.69749641418457, 2.724844217300415, 4.242630958557129, 4.733541488647461, 2.0595829486846924, 4.1652984619140625, 2.735617160797119, 4.120425224304199, 6.2801923751831055, 2.2279117107391357, 3.3493669033050537, 2.7217109203338623, 4.830002307891846, 2.3509750366210938, 4.632626533508301, 5.226329803466797, 3.283353090286255, 1.9687581062316895, 2.958940267562866, 3.2463536262512207, 4.153252601623535, 4.891962051391602, 2.7147626876831055, 4.065386772155762, 4.367978572845459, 4.512495994567871, 3.1644279956817627, 3.433652400970459, 4.668276309967041, 3.752004861831665, 4.293458461761475, 4.211801528930664, 5.0337724685668945, 4.588779449462891, 3.104257822036743], "mean_td_error": 3.9287655353546143, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 33.0, "diff_num_grad_updates_vs_sampler_policy": 32.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.141931533813477, "actor_loss": -4.927099704742432, "critic_loss": 0.5183279514312744, "alpha_loss": -0.09744128584861755, "alpha_value": 0.9904382228851318, "log_alpha_value": -0.009607764892280102, "target_entropy": -6.0, "policy_t": -0.002614573808386922, "mean_q": 1.10050630569458, "max_q": 6.63087272644043, "min_q": 0.8070835471153259}, "td_error": [2.353205680847168, 1.2883074283599854, 1.7463675737380981, 0.2576819658279419, 2.742743968963623, 2.530841588973999, 2.0290355682373047, 1.6343469619750977, 2.2344002723693848, 1.8177244663238525, 1.9899988174438477, 3.3567252159118652, 7.069993495941162, 1.2540366649627686, 2.813505172729492, 1.011781930923462, 1.5100421905517578, 0.4153043031692505, 1.7534804344177246, 1.5233104228973389, 1.243083119392395, 3.16514253616333, 2.9306976795196533, 3.4033873081207275, 3.374185562133789, 2.7369565963745117, 0.09027665853500366, 0.7792573571205139, 2.328824281692505, 2.2211828231811523, 0.982903778553009, 2.192394971847534, 0.46581077575683594, 2.0748913288116455, 1.4004173278808594, 2.164673328399658, 3.1066508293151855, 3.1785802841186523, 1.0506339073181152, 1.2427493333816528, 0.03952866792678833, 1.568241834640503, 1.4538862705230713, 1.5099016427993774, 3.504589080810547, 1.4684025049209595, 1.2095558643341064, 2.1317250728607178, 1.7271201610565186, 2.1445205211639404, 1.8504040241241455, 1.9916908740997314, 2.706049919128418, 3.654909610748291, 1.674816608428955, 3.39699387550354, 0.5269626379013062, 2.9760208129882812, 2.037050485610962, 1.012790322303772, 1.1593017578125, 1.4430216550827026, 2.5745019912719727, 2.408170700073242, 1.1121352910995483, 2.3472704887390137, 1.3196676969528198, 3.3035080432891846, 1.2496254444122314, 1.6813089847564697, 2.0395727157592773, 2.400041103363037, 2.8468360900878906, 0.052768707275390625, 2.69240140914917, 1.5024185180664062, 1.5008068084716797, 2.22288179397583, 3.3913040161132812, 2.256657123565674, 1.3362298011779785, 1.2576924562454224, 1.1535351276397705, 2.0714597702026367, 0.319104939699173, 1.0676548480987549], "mean_td_error": 1.9390764236450195, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 33.0, "diff_num_grad_updates_vs_sampler_policy": 32.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.127772331237793, "actor_loss": -5.101439952850342, "critic_loss": 0.4159449338912964, "alpha_loss": -0.09731185436248779, "alpha_value": 0.9904376268386841, "log_alpha_value": -0.009608415886759758, "target_entropy": -6.0, "policy_t": -0.04371881112456322, "mean_q": 1.1604145765304565, "max_q": 5.908936023712158, "min_q": 0.9424641728401184}, "td_error": [2.1996870040893555, 1.7444645166397095, 0.6158517599105835, 0.6257404685020447, 2.170159101486206, 2.3816728591918945, 0.8236235976219177, 0.04619121551513672, 2.3550119400024414, 0.7902536392211914, 2.0821194648742676, 0.43232762813568115, 2.1487886905670166, 0.5111439228057861, 0.5075190663337708, 1.4841121435165405, 3.1602256298065186, 3.1006078720092773, 1.4205988645553589, 0.6685877442359924, 1.1734204292297363, 2.3692994117736816, 2.430877447128296, 0.5738574266433716, 1.1986494064331055, 1.63621985912323, 0.535834789276123, 0.25822585821151733, 1.1354037523269653, 3.0262339115142822, 1.4137659072875977, 0.017140120267868042, 2.3797192573547363, 1.4079829454421997, 3.0605082511901855, 1.8126537799835205, 2.23470401763916, 1.4483623504638672, 0.6405712366104126, 1.0737121105194092, 1.9125659465789795, 3.1833157539367676, 1.8172106742858887, 1.3202769756317139, 0.015426427125930786, 1.3675894737243652, 1.2619645595550537, 1.6840096712112427, 2.36907696723938, 1.7786144018173218, 0.14396926760673523, 1.6756539344787598, 1.571321725845337, 1.1076288223266602, 2.7560856342315674, 0.8306571245193481, 2.1263742446899414, 1.8526196479797363, 1.2083193063735962, 0.7116687297821045, 0.7403038740158081, 2.054993152618408, 0.8350756168365479, 0.8000677227973938, 0.9912473559379578, 2.2335140705108643, 2.8343052864074707, 3.3182992935180664, 1.4803959131240845, 2.705655097961426, 4.020595073699951, 0.264353483915329, 2.7054567337036133, 0.7744647264480591, 1.9933435916900635, 2.054612159729004, 1.7104732990264893, 0.07288533449172974, 2.760559558868408, 0.44347620010375977, 2.3043341636657715, 2.9071273803710938, 0.937257707118988, 3.008384943008423, 2.1727406978607178, 0.31523823738098145], "mean_td_error": 1.584061861038208, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 33.0, "diff_num_grad_updates_vs_sampler_policy": 32.0}}, "num_env_steps_sampled": 30464, "num_env_steps_trained": 8514, "num_agent_steps_sampled": 91392, "num_agent_steps_trained": 8514, "last_target_update_ts": 30464, "num_target_updates": 33}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 91392, "num_agent_steps_trained": 8514, "num_env_steps_sampled": 30464, "num_env_steps_trained": 8514, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 807.4332625611951, "num_env_steps_trained_throughput_per_sec": 232.4975242642727, "timesteps_total": 30464, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 91392, "timers": {"training_iteration_time_ms": 1116.543, "sample_time_ms": 820.532, "load_time_ms": 0.311, "load_throughput": 829663.752, "learn_time_ms": 18.955, "learn_throughput": 13611.532, "synch_weights_time_ms": 10.507}, "counters": {"num_env_steps_sampled": 30464, "num_env_steps_trained": 8514, "num_agent_steps_sampled": 91392, "num_agent_steps_trained": 8514, "last_target_update_ts": 30464, "num_target_updates": 33}, "done": false, "episodes_total": 0, "training_iteration": 28, "trial_id": "95c7c_00000", "date": "2023-11-18_20-54-16", "timestamp": 1700369656, "time_this_iter_s": 1.1195011138916016, "time_total_s": 36.64172101020813, "pid": 5649, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16bd42160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 36.64172101020813, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 91.0, "ram_util_percent": 67.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.111958503723145, "actor_loss": -5.167402267456055, "critic_loss": 1.7715122699737549, "alpha_loss": -0.10017159581184387, "alpha_value": 0.9901426434516907, "log_alpha_value": -0.009906250052154064, "target_entropy": -6.0, "policy_t": 0.016570450738072395, "mean_q": 1.543720006942749, "max_q": 10.742630004882812, "min_q": 1.008655071258545}, "td_error": [1.7475887537002563, 2.4449548721313477, 1.7506805658340454, 4.098409652709961, 4.662927150726318, 4.790362358093262, 3.6091909408569336, 3.194349527359009, 3.7038025856018066, 2.336780071258545, 4.150102615356445, 3.2487480640411377, 4.085002899169922, 3.100776433944702, 3.5301740169525146, 4.6991729736328125, 3.07975172996521, 4.099156379699707, 2.555199146270752, 4.081368446350098, 3.945085048675537, 1.3880600929260254, 1.2894458770751953, 2.573054075241089, 1.869194507598877, 3.077223777770996, 2.3351335525512695, 3.6415464878082275, 2.9259033203125, 4.05856466293335, 3.7293970584869385, 1.6718316078186035, 2.7385425567626953, 5.162328720092773, 1.5809004306793213, 2.276010513305664, 3.3000223636627197, 3.9713950157165527, 3.7007088661193848, 1.5584867000579834, 3.8120365142822266, 2.704648017883301, 2.433605670928955, 5.166716575622559, 2.9598071575164795, 4.357973575592041, 2.82232403755188, 2.8545541763305664, 1.9978842735290527, 4.3088579177856445, 2.5480265617370605, 3.5307443141937256, 2.4715962409973145, 3.680257797241211, 3.0494611263275146, 2.8171801567077637, 4.290093421936035, 3.56178879737854, 4.1796979904174805, 2.9590258598327637, 2.160269260406494, 3.232551097869873, 3.5868701934814453, 3.9908640384674072, 4.499900817871094, 0.2272195816040039, 2.6014726161956787, 4.768881797790527, 3.2462353706359863, 1.792675256729126, 4.525547981262207, 2.9455008506774902, 3.490415334701538, 5.854681015014648, 4.454241752624512, 3.4217138290405273, 4.864403247833252, 2.4688546657562256, 4.200048923492432, 4.503348350524902, 3.4428651332855225, 4.138075351715088, 1.9166955947875977, 4.471756935119629, 2.961395502090454, 3.724674701690674], "mean_td_error": 3.299520492553711, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 34.0, "diff_num_grad_updates_vs_sampler_policy": 33.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.11886978149414, "actor_loss": -4.939002990722656, "critic_loss": 0.4498051106929779, "alpha_loss": -0.10025922954082489, "alpha_value": 0.9901407957077026, "log_alpha_value": -0.009908144362270832, "target_entropy": -6.0, "policy_t": -0.03736398369073868, "mean_q": 1.070788860321045, "max_q": 6.645291805267334, "min_q": 0.8551680445671082}, "td_error": [1.5072038173675537, 2.0929031372070312, 2.9220685958862305, 1.5762484073638916, 0.6527189016342163, 1.938454031944275, 1.701012134552002, 1.966644525527954, 3.1232171058654785, 4.844455718994141, 3.024709463119507, 0.8371779918670654, 0.18040511012077332, 2.318485975265503, 0.5123840570449829, 2.6608266830444336, 0.3905496597290039, 2.979520082473755, 2.7872848510742188, 3.4135518074035645, 2.4312548637390137, 1.9228343963623047, 2.2717831134796143, 1.0635082721710205, 0.7778010368347168, 2.48500394821167, 1.0848188400268555, 2.0246200561523438, 0.9539669752120972, 0.8518672585487366, 1.8819122314453125, 0.7529759407043457, 0.7759063243865967, 0.7017043828964233, 1.6105499267578125, 1.579312801361084, 1.3298346996307373, 0.2238052487373352, 2.298604965209961, 2.4443130493164062, 3.178624391555786, 2.6779215335845947, 2.525388717651367, 1.3628807067871094, 1.3837010860443115, 2.4225540161132812, 2.323643207550049, 1.197831630706787, 1.8076465129852295, 1.1285266876220703, 0.21425798535346985, 0.37587374448776245, 0.3577198386192322, 3.031705856323242, 1.6569344997406006, 1.4898933172225952, 2.968139171600342, 1.764021635055542, 0.40021392703056335, 3.1450295448303223, 0.3609550893306732, 0.6707452535629272, 0.8559739589691162, 0.45037397742271423, 0.5922256708145142, 1.0904662609100342, 1.4873058795928955, 1.045910358428955, 1.5336881875991821, 2.9359893798828125, 1.9693444967269897, 2.489539623260498, 2.6884818077087402, 2.384044885635376, 1.6014349460601807, 2.291369676589966, 2.567514419555664, 2.151550769805908, 2.5966999530792236, 0.9813941717147827, 2.4372103214263916, 0.64383864402771, 0.9824351668357849, 1.1278612613677979, 2.7840566635131836, 2.7755866050720215], "mean_td_error": 1.7419153451919556, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 34.0, "diff_num_grad_updates_vs_sampler_policy": 33.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.16136646270752, "actor_loss": -5.185641765594482, "critic_loss": 0.4600188136100769, "alpha_loss": -0.10068587213754654, "alpha_value": 0.9901402592658997, "log_alpha_value": -0.009908693842589855, "target_entropy": -6.0, "policy_t": -0.019467143341898918, "mean_q": 1.30511474609375, "max_q": 6.512019157409668, "min_q": 0.9946950078010559}, "td_error": [3.180391311645508, 1.8135024309158325, 0.13481682538986206, 3.1347250938415527, 0.6328975558280945, 1.748239278793335, 4.395791053771973, 0.8198120594024658, 2.4744644165039062, 0.12729063630104065, 2.1713104248046875, 1.5380747318267822, 4.117728233337402, 0.8638697862625122, 0.4560471177101135, 1.080031156539917, 1.7159702777862549, 1.1666932106018066, 1.2691738605499268, 0.520287036895752, 4.3819451332092285, 2.6816775798797607, 0.5354371070861816, 1.803537130355835, 2.8756041526794434, 1.4674606323242188, 0.2367798388004303, 1.7666687965393066, 2.681262969970703, 1.3668452501296997, 1.9617977142333984, 2.5222373008728027, 0.9174150228500366, 2.769209623336792, 1.7879102230072021, 1.4876720905303955, 1.4315135478973389, 0.4442710876464844, 0.15792375802993774, 0.8109517097473145, 2.414896011352539, 1.9582717418670654, 2.014960527420044, 2.4673309326171875, 1.1079916954040527, 1.1672914028167725, 2.0516042709350586, 0.9322696924209595, 1.5193428993225098, 4.406081199645996, 0.41086041927337646, 2.95991849899292, 0.33855992555618286, 1.2796649932861328, 0.523514986038208, 1.0071386098861694, 0.33219093084335327, 1.4985209703445435, 2.441819667816162, 1.456535816192627, 1.8714473247528076, 1.9295250177383423, 0.6997120380401611, 2.182588815689087, 2.0246949195861816, 3.480316162109375, 2.9579813480377197, 1.0714597702026367, 1.5236108303070068, 1.6616442203521729, 1.1581945419311523, 5.626123428344727, 2.876321315765381, 0.2834051549434662, 4.0428595542907715, 2.2973134517669678, 1.9515528678894043, 0.9138355851173401, 0.8010355830192566, 1.7347164154052734, 1.7119369506835938, 2.229367733001709, 1.7228084802627563, 1.169368028640747, 2.2760252952575684, 1.2930562496185303], "mean_td_error": 1.7584755420684814, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 34.0, "diff_num_grad_updates_vs_sampler_policy": 33.0}}, "num_env_steps_sampled": 31360, "num_env_steps_trained": 8772, "num_agent_steps_sampled": 94080, "num_agent_steps_trained": 8772, "last_target_update_ts": 31360, "num_target_updates": 34}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 94080, "num_agent_steps_trained": 8772, "num_env_steps_sampled": 31360, "num_env_steps_trained": 8772, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 822.4991259803039, "num_env_steps_trained_throughput_per_sec": 236.83568582915, "timesteps_total": 31360, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 94080, "timers": {"training_iteration_time_ms": 1118.602, "sample_time_ms": 823.067, "load_time_ms": 0.313, "load_throughput": 823476.472, "learn_time_ms": 19.191, "learn_throughput": 13443.85, "synch_weights_time_ms": 10.381}, "counters": {"num_env_steps_sampled": 31360, "num_env_steps_trained": 8772, "num_agent_steps_sampled": 94080, "num_agent_steps_trained": 8772, "last_target_update_ts": 31360, "num_target_updates": 34}, "done": false, "episodes_total": 0, "training_iteration": 29, "trial_id": "95c7c_00000", "date": "2023-11-18_20-54-17", "timestamp": 1700369657, "time_this_iter_s": 1.1006138324737549, "time_total_s": 37.742334842681885, "pid": 5649, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16bd43380>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 37.742334842681885, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 69.6, "ram_util_percent": 67.35}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.153593063354492, "actor_loss": -5.252128601074219, "critic_loss": 2.1402978897094727, "alpha_loss": -0.10363514721393585, "alpha_value": 0.9898451566696167, "log_alpha_value": -0.010206745937466621, "target_entropy": -6.0, "policy_t": -0.0010639572283253074, "mean_q": 1.2617442607879639, "max_q": 10.760262489318848, "min_q": 1.0606157779693604}, "td_error": [3.49409556388855, 4.809835910797119, 5.386312484741211, 1.9767751693725586, 5.505063056945801, 4.443489074707031, 4.475176811218262, 4.9263081550598145, 3.822098731994629, 3.1627912521362305, 4.202017784118652, 5.240301132202148, 2.9686279296875, 3.637744188308716, 3.562453031539917, 3.8760528564453125, 2.997023344039917, 4.0568437576293945, 2.304133892059326, 4.251286506652832, 3.272484302520752, 4.366323471069336, 3.1059789657592773, 1.3156358003616333, 4.741939544677734, 3.1426093578338623, 4.261145114898682, 3.8986334800720215, 3.0529417991638184, 3.8810744285583496, 6.122057914733887, 2.4349474906921387, 2.531379222869873, 3.5918288230895996, 3.736060857772827, 4.6138105392456055, 4.8436598777771, 4.465202808380127, 4.199413299560547, 3.793128728866577, 4.6402716636657715, 5.236061096191406, 4.280423641204834, 2.3619656562805176, 4.331125259399414, 2.910698652267456, 3.9362292289733887, 3.575444221496582, 3.491861343383789, 5.72104549407959, 3.3482909202575684, 2.835679769515991, 2.8516998291015625, 3.4627790451049805, 2.6189842224121094, 3.5861973762512207, 5.206998825073242, 5.2137041091918945, 4.0300469398498535, 2.444423198699951, 4.0420331954956055, 2.7163543701171875, 4.3302741050720215, 3.3238778114318848, 5.546224117279053, 4.780059814453125, 5.218619346618652, 5.097461223602295, 1.7257835865020752, 4.292031288146973, 3.0946271419525146, 4.947588920593262, 3.6206066608428955, 3.928236961364746, 4.902828216552734, 2.7619009017944336, 3.29868221282959, 3.4965033531188965, 4.231911659240723, 2.4280905723571777, 6.323155403137207, 2.436858892440796, 3.6404836177825928, 3.3581643104553223, 3.3216328620910645, 3.602590560913086], "mean_td_error": 3.849060297012329, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 35.0, "diff_num_grad_updates_vs_sampler_policy": 34.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.091415405273438, "actor_loss": -4.956060886383057, "critic_loss": 0.5086381435394287, "alpha_loss": -0.10301894694566727, "alpha_value": 0.9898433685302734, "log_alpha_value": -0.010208572261035442, "target_entropy": -6.0, "policy_t": 0.05567632615566254, "mean_q": 1.2845659255981445, "max_q": 6.651611804962158, "min_q": 0.9051516652107239}, "td_error": [2.459359884262085, 0.046774059534072876, 1.1460485458374023, 0.8380009531974792, 1.9011163711547852, 0.20115867257118225, 0.46675145626068115, 1.948815107345581, 1.1978113651275635, 1.7902576923370361, 2.7519209384918213, 2.3614344596862793, 1.858860731124878, 1.1937878131866455, 0.5607404112815857, 1.8970961570739746, 3.349116325378418, 1.2675411701202393, 0.12367132306098938, 2.891541004180908, 2.159228563308716, 0.3926713466644287, 2.424452066421509, 3.7130932807922363, 2.275468587875366, 2.6606335639953613, 1.3205492496490479, 1.3315863609313965, 2.5585899353027344, 1.0071040391921997, 1.02824068069458, 2.2044248580932617, 1.6954834461212158, 2.933898448944092, 1.5277525186538696, 2.917079448699951, 4.389585971832275, 2.3670568466186523, 1.8739416599273682, 1.8052048683166504, 2.2996225357055664, 2.2261204719543457, 2.469956159591675, 1.386885643005371, 0.604190468788147, 1.6081552505493164, 2.3669588565826416, 1.658933401107788, 2.3737058639526367, 1.7729333639144897, 1.246178388595581, 1.0357897281646729, 1.7837769985198975, 0.8862018585205078, 2.3473215103149414, 1.3516044616699219, 2.675410270690918, 2.5791640281677246, 0.20329633355140686, 2.3736090660095215, 3.069828987121582, 4.160767555236816, 0.6481506824493408, 2.0172884464263916, 1.3011541366577148, 1.3694934844970703, 3.081402540206909, 4.051120281219482, 2.16336727142334, 0.12708693742752075, 1.2821974754333496, 2.7895212173461914, 1.8085029125213623, 3.290881633758545, 0.9373145699501038, 2.445249557495117, 3.4522545337677, 2.6562840938568115, 1.428926944732666, 3.4013733863830566, 1.553450345993042, 1.8128960132598877, 0.41673463582992554, 1.0149307250976562, 1.4728260040283203, 2.3436243534088135], "mean_td_error": 1.8858637809753418, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 35.0, "diff_num_grad_updates_vs_sampler_policy": 34.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.102094650268555, "actor_loss": -5.1774444580078125, "critic_loss": 0.4046841859817505, "alpha_loss": -0.10313312709331512, "alpha_value": 0.9898428320884705, "log_alpha_value": -0.01020908448845148, "target_entropy": -6.0, "policy_t": -0.0034301241394132376, "mean_q": 1.2386257648468018, "max_q": 5.964131832122803, "min_q": 1.0476570129394531}, "td_error": [0.7877923846244812, 2.1504077911376953, 2.63364315032959, 2.146958589553833, 1.2325658798217773, 1.3090925216674805, 3.0356483459472656, 0.9335278272628784, 2.347635269165039, 3.3359909057617188, 0.37595248222351074, 1.397324800491333, 3.973496675491333, 0.44554126262664795, 2.7910361289978027, 0.7240796089172363, 2.83478045463562, 0.17488276958465576, 0.3884354829788208, 0.523169755935669, 2.5784249305725098, 0.20819568634033203, 0.8329682350158691, 1.4814410209655762, 2.4772653579711914, 1.4973050355911255, 1.1191660165786743, 1.9009060859680176, 1.4141732454299927, 2.1113672256469727, 2.117739677429199, 1.7381021976470947, 0.07241415977478027, 2.083019256591797, 2.282562017440796, 1.1219151020050049, 0.4475319981575012, 1.6906074285507202, 2.126560688018799, 3.1462082862854004, 2.6289312839508057, 0.942075252532959, 3.402759552001953, 1.7023324966430664, 2.0794968605041504, 1.8175463676452637, 2.6935625076293945, 2.846407413482666, 0.054596781730651855, 2.5563888549804688, 0.18889808654785156, 3.0919013023376465, 1.820840835571289, 0.26011908054351807, 1.413182020187378, 1.705318570137024, 1.6969527006149292, 0.5399869680404663, 3.1500182151794434, 1.1353933811187744, 1.0965378284454346, 2.169142484664917, 0.9262533783912659, 0.7511489987373352, 0.9754467010498047, 1.8496503829956055, 0.1861799955368042, 2.462742328643799, 2.750925064086914, 1.0240439176559448, 1.2076321840286255, 2.215311050415039, 0.925843358039856, 0.9342421293258667, 1.1442558765411377, 1.0336991548538208, 0.12568891048431396, 0.8560073375701904, 2.2545406818389893, 0.5363991260528564, 1.6327381134033203, 1.7157964706420898, 0.14280247688293457, 2.9420840740203857, 2.2053205966949463, 2.134629249572754], "mean_td_error": 1.6036697626113892, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 35.0, "diff_num_grad_updates_vs_sampler_policy": 34.0}}, "num_env_steps_sampled": 32256, "num_env_steps_trained": 9030, "num_agent_steps_sampled": 96768, "num_agent_steps_trained": 9030, "last_target_update_ts": 32256, "num_target_updates": 35}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96768, "num_agent_steps_trained": 9030, "num_env_steps_sampled": 32256, "num_env_steps_trained": 9030, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 739.2312396853529, "num_env_steps_trained_throughput_per_sec": 212.85899535582706, "timesteps_total": 32256, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 96768, "timers": {"training_iteration_time_ms": 1107.186, "sample_time_ms": 831.918, "load_time_ms": 0.314, "load_throughput": 822537.574, "learn_time_ms": 19.192, "learn_throughput": 13443.015, "synch_weights_time_ms": 10.485}, "counters": {"num_env_steps_sampled": 32256, "num_env_steps_trained": 9030, "num_agent_steps_sampled": 96768, "num_agent_steps_trained": 9030, "last_target_update_ts": 32256, "num_target_updates": 35}, "done": false, "episodes_total": 0, "training_iteration": 30, "trial_id": "95c7c_00000", "date": "2023-11-18_20-54-19", "timestamp": 1700369659, "time_this_iter_s": 1.2208352088928223, "time_total_s": 38.96317005157471, "pid": 5649, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16bdf4d60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 38.96317005157471, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 80.2, "ram_util_percent": 67.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.118172645568848, "actor_loss": -5.27741003036499, "critic_loss": 1.9019584655761719, "alpha_loss": -0.10631492733955383, "alpha_value": 0.9895476698875427, "log_alpha_value": -0.010507323779165745, "target_entropy": -6.0, "policy_t": 0.010444947518408298, "mean_q": 1.4449436664581299, "max_q": 10.7972993850708, "min_q": 1.1156127452850342}, "td_error": [1.3587620258331299, 3.1357851028442383, 2.243523359298706, 2.759270668029785, 6.127701282501221, 4.184380531311035, 3.8859128952026367, 0.4870619773864746, 1.550562858581543, 3.9125566482543945, 3.641860008239746, 3.212787628173828, 2.4129152297973633, 3.458292245864868, 2.2007956504821777, 3.5603530406951904, 2.022714138031006, 3.398801326751709, 4.375226974487305, 3.613187789916992, 3.5916290283203125, 2.856375217437744, 2.30843448638916, 3.3308730125427246, 3.3493762016296387, 3.3256278038024902, 3.0078091621398926, 3.9639439582824707, 4.389612197875977, 6.324749946594238, 4.211145401000977, 0.9209823608398438, 3.127431869506836, 3.9598164558410645, 4.592791557312012, 3.2277889251708984, 2.5417017936706543, 2.9446239471435547, 2.974057197570801, 3.4890222549438477, 4.815866947174072, 5.203126430511475, 3.210193634033203, 2.988438606262207, 4.10343074798584, 3.2213668823242188, 2.7143735885620117, 3.1191205978393555, 5.134610176086426, 3.3681557178497314, 2.7324538230895996, 2.2620604038238525, 2.710965633392334, 3.3725485801696777, 3.243967056274414, 3.4474332332611084, 4.747807502746582, 3.939847469329834, 3.928510904312134, 1.805094838142395, 3.015599250793457, 4.672369003295898, 1.8578554391860962, 2.7265515327453613, 5.341045379638672, 4.254984378814697, 2.6219935417175293, 5.085693359375, 4.998745918273926, 4.383874893188477, 5.648456573486328, 1.8248872756958008, 0.4399658441543579, 3.6418004035949707, 4.495792388916016, 2.138702392578125, 3.954293727874756, 4.463373184204102, 4.792511940002441, 3.8753957748413086, 2.779797077178955, 3.940460205078125, 2.9099464416503906, 2.292088508605957, 3.8673055171966553, 4.375155448913574], "mean_td_error": 3.423816680908203, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 36.0, "diff_num_grad_updates_vs_sampler_policy": 35.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.096470832824707, "actor_loss": -5.014644145965576, "critic_loss": 0.5056162476539612, "alpha_loss": -0.10610365122556686, "alpha_value": 0.9895460605621338, "log_alpha_value": -0.010508982464671135, "target_entropy": -6.0, "policy_t": 0.07382702082395554, "mean_q": 1.1239721775054932, "max_q": 4.926607608795166, "min_q": 0.9560316801071167}, "td_error": [2.091578483581543, 1.9836697578430176, 1.8809500932693481, 3.557098865509033, 2.881225824356079, 1.4139609336853027, 2.7208640575408936, 0.7596347332000732, 3.7343859672546387, 3.5525379180908203, 0.43036091327667236, 0.6048831343650818, 0.5545957088470459, 2.27917218208313, 0.9143693447113037, 1.165152907371521, 0.08382993936538696, 0.7132322788238525, 2.2433218955993652, 0.35251063108444214, 3.2209489345550537, 1.3701567649841309, 0.2919858992099762, 3.4095306396484375, 2.2066493034362793, 3.989469051361084, 2.1525492668151855, 1.224374532699585, 2.759948492050171, 2.0727412700653076, 1.298326015472412, 0.5499134063720703, 1.7524795532226562, 3.1236796379089355, 1.9003243446350098, 2.9421839714050293, 1.3431140184402466, 2.68925142288208, 3.195143938064575, 3.3057680130004883, 2.137221097946167, 1.8049852848052979, 0.4660131633281708, 0.5510374903678894, 1.4355359077453613, 1.3061509132385254, 1.0561764240264893, 4.241352558135986, 0.9572317004203796, 0.0639544427394867, 1.2275018692016602, 0.3212471604347229, 0.8267945051193237, 1.1819143295288086, 1.739549994468689, 2.8577494621276855, 2.520432949066162, 2.97676420211792, 1.3392852544784546, 0.477066308259964, 1.9150962829589844, 1.6710565090179443, 1.3581058979034424, 1.6995147466659546, 2.7085623741149902, 1.6856627464294434, 1.8288674354553223, 2.241456985473633, 1.762169361114502, 1.464132308959961, 0.7872732281684875, 2.9948368072509766, 2.726950168609619, 2.351166248321533, 1.9548656940460205, 2.0627822875976562, 4.318575382232666, 1.0407192707061768, 1.12578547000885, 2.5500593185424805, 2.661844491958618, 2.517062187194824, 2.8117687702178955, 1.9969606399536133, 3.4354519844055176, 1.2454073429107666], "mean_td_error": 1.896743893623352, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 36.0, "diff_num_grad_updates_vs_sampler_policy": 35.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.07841968536377, "actor_loss": -5.218688011169434, "critic_loss": 0.4754970669746399, "alpha_loss": -0.10591859370470047, "alpha_value": 0.9895455837249756, "log_alpha_value": -0.010509444400668144, "target_entropy": -6.0, "policy_t": -0.014272928237915039, "mean_q": 1.2062022686004639, "max_q": 5.960810661315918, "min_q": 1.101811170578003}, "td_error": [1.6704089641571045, 3.0477142333984375, 2.460824728012085, 2.5283443927764893, 0.9696036577224731, 2.0431954860687256, 1.1154236793518066, 1.5473445653915405, 1.5668177604675293, 2.911667585372925, 3.3128862380981445, 0.5068202614784241, 3.29463791847229, 0.6804049015045166, 2.346829652786255, 0.824044942855835, 3.700242519378662, 0.43231260776519775, 1.7477004528045654, 1.6358098983764648, 1.1907908916473389, 1.3450262546539307, 1.3652135133743286, 3.0011260509490967, 2.0898423194885254, 1.2602089643478394, 1.669429898262024, 1.718935489654541, 2.9799535274505615, 1.3665134906768799, 0.9856225252151489, 3.2660787105560303, 3.092456102371216, 0.2231971025466919, 0.08613795042037964, 1.6583622694015503, 1.269371509552002, 2.2971115112304688, 1.5709257125854492, 2.6202945709228516, 1.72878098487854, 0.10879987478256226, 2.3030149936676025, 2.303051710128784, 0.7122538089752197, 1.8019801378250122, 0.3070577383041382, 0.07353520393371582, 1.1070295572280884, 0.02958965301513672, 1.5746090412139893, 1.5522351264953613, 3.940622091293335, 2.601253032684326, 3.323542356491089, 1.6091631650924683, 1.406011939048767, 0.6785637736320496, 2.8032736778259277, 0.02317357063293457, 1.5510004758834839, 1.6871745586395264, 3.011429786682129, 1.521504282951355, 1.3579127788543701, 1.6361212730407715, 1.7736577987670898, 3.6527671813964844, 1.0758256912231445, 1.3593794107437134, 2.709620475769043, 1.5288432836532593, 2.0264816284179688, 2.59559965133667, 1.5767427682876587, 0.39218056201934814, 0.30526477098464966, 1.6721258163452148, 2.8906779289245605, 3.4915502071380615, 2.57527756690979, 1.5529332160949707, 3.5481019020080566, 1.4455945491790771, 1.6712602376937866, 1.524671196937561], "mean_td_error": 1.7851264476776123, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 36.0, "diff_num_grad_updates_vs_sampler_policy": 35.0}}, "num_env_steps_sampled": 33152, "num_env_steps_trained": 9288, "num_agent_steps_sampled": 99456, "num_agent_steps_trained": 9288, "last_target_update_ts": 33152, "num_target_updates": 36}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 99456, "num_agent_steps_trained": 9288, "num_env_steps_sampled": 33152, "num_env_steps_trained": 9288, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 851.9776423948437, "num_env_steps_trained_throughput_per_sec": 245.32391935030097, "timesteps_total": 33152, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 99456, "timers": {"training_iteration_time_ms": 1116.476, "sample_time_ms": 842.686, "load_time_ms": 0.315, "load_throughput": 818927.223, "learn_time_ms": 19.189, "learn_throughput": 13445.303, "synch_weights_time_ms": 10.533}, "counters": {"num_env_steps_sampled": 33152, "num_env_steps_trained": 9288, "num_agent_steps_sampled": 99456, "num_agent_steps_trained": 9288, "last_target_update_ts": 33152, "num_target_updates": 36}, "done": false, "episodes_total": 0, "training_iteration": 31, "trial_id": "95c7c_00000", "date": "2023-11-18_20-54-20", "timestamp": 1700369660, "time_this_iter_s": 1.0594780445098877, "time_total_s": 40.022648096084595, "pid": 5649, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16bdf6020>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 40.022648096084595, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 76.3, "ram_util_percent": 67.35}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.07456111907959, "actor_loss": -5.294525623321533, "critic_loss": 2.025561571121216, "alpha_loss": -0.10888480395078659, "alpha_value": 0.9892503023147583, "log_alpha_value": -0.010807895101606846, "target_entropy": -6.0, "policy_t": 0.024966243654489517, "mean_q": 1.3191030025482178, "max_q": 10.838582992553711, "min_q": 1.1731606721878052}, "td_error": [4.207562446594238, 2.5038819313049316, 3.518662452697754, 2.518723487854004, 5.387124538421631, 5.039379596710205, 2.1526880264282227, 3.73791241645813, 2.7307820320129395, 3.1990718841552734, 1.513413906097412, 2.3249025344848633, 5.061059951782227, 3.743960380554199, 4.3914031982421875, 3.07899808883667, 3.336332321166992, 4.448044776916504, 4.451776027679443, 3.221827983856201, 3.050503730773926, 3.7871103286743164, 2.728487968444824, 5.0217437744140625, 3.1170244216918945, 4.560305118560791, 2.1833767890930176, 5.82529354095459, 1.9260995388031006, 4.029569625854492, 2.134047031402588, 5.019841194152832, 1.0556230545043945, 4.226628303527832, 3.4397146701812744, 3.0469937324523926, 4.2102370262146, 4.565166473388672, 3.655803680419922, 3.886331081390381, 2.297091007232666, 1.936153769493103, 7.053585529327393, 3.601456642150879, 3.9269981384277344, 4.95896053314209, 4.684311866760254, 2.7218830585479736, 3.491006374359131, 4.801951885223389, 2.2813000679016113, 3.512968063354492, 3.8362107276916504, 4.558725357055664, 4.110621452331543, 3.1703076362609863, 5.048016548156738, 2.618563413619995, 4.054195880889893, 2.1685914993286133, 3.3143770694732666, 2.165168285369873, 0.6892471313476562, 4.418434143066406, 2.681509494781494, 5.1433868408203125, 2.8406982421875, 3.2499213218688965, 4.590635299682617, 4.264321327209473, 4.583733558654785, 3.316776990890503, 5.287786960601807, 3.8931684494018555, 4.228023529052734, 3.9119420051574707, 3.7661008834838867, 5.652668476104736, 6.435477256774902, 2.5997681617736816, 2.2705955505371094, 3.3144168853759766, 4.623285293579102, 4.485082626342773, 4.183514595031738, 4.715376377105713], "mean_td_error": 3.691810369491577, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 37.0, "diff_num_grad_updates_vs_sampler_policy": 36.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.07033634185791, "actor_loss": -5.027113914489746, "critic_loss": 0.4706040024757385, "alpha_loss": -0.10885415971279144, "alpha_value": 0.9892488121986389, "log_alpha_value": -0.01080938708037138, "target_entropy": -6.0, "policy_t": 0.04915452003479004, "mean_q": 1.1293065547943115, "max_q": 6.044737815856934, "min_q": 1.0095256567001343}, "td_error": [3.139944076538086, 2.678316354751587, 2.350836753845215, 2.368013381958008, 1.2556058168411255, 0.7430816888809204, 0.9897689819335938, 0.4654425382614136, 2.2432820796966553, 1.4442968368530273, 0.29803961515426636, 0.9882534742355347, 2.256831407546997, 1.5682682991027832, 2.1869313716888428, 2.5273544788360596, 1.979586124420166, 1.867716670036316, 0.9067928791046143, 0.7184579372406006, 2.1900086402893066, 0.2691272497177124, 3.8368303775787354, 1.5725822448730469, 2.608686923980713, 1.6169378757476807, 1.193758487701416, 1.2179077863693237, 1.0119024515151978, 2.1574363708496094, 2.539543628692627, 1.2963160276412964, 0.24868535995483398, 2.3420801162719727, 1.5809085369110107, 1.0537101030349731, 1.0561193227767944, 1.5491678714752197, 1.7469667196273804, 0.14106914401054382, 3.202882766723633, 1.977264404296875, 1.2902679443359375, 2.0175254344940186, 0.8928224444389343, 1.7175970077514648, 1.4188122749328613, 3.161430835723877, 1.561233639717102, 3.4750452041625977, 0.7113350629806519, 2.3087549209594727, 2.249751091003418, 2.701110363006592, 1.4798636436462402, 1.1098110675811768, 2.8496155738830566, 1.8050529956817627, 1.9701484441757202, 0.9793952703475952, 2.743199110031128, 3.421745777130127, 2.0735883712768555, 0.5171048641204834, 2.072406768798828, 1.7617264986038208, 0.6871833801269531, 0.11747556924819946, 0.9848265051841736, 2.6482722759246826, 1.761205792427063, 2.026378631591797, 3.3296597003936768, 0.6384134292602539, 1.4428203105926514, 1.6858874559402466, 0.35811617970466614, 2.894765853881836, 1.432219386100769, 1.5571751594543457, 0.6120637059211731, 4.003909111022949, 1.2716195583343506, 3.352231025695801, 3.2815141677856445, 3.1707706451416016], "mean_td_error": 1.7782857418060303, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 37.0, "diff_num_grad_updates_vs_sampler_policy": 36.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.18453311920166, "actor_loss": -5.3710126876831055, "critic_loss": 0.3848891854286194, "alpha_loss": -0.11009199917316437, "alpha_value": 0.989248514175415, "log_alpha_value": -0.010809723287820816, "target_entropy": -6.0, "policy_t": 0.0009425568860024214, "mean_q": 1.2799290418624878, "max_q": 6.523372173309326, "min_q": 1.1584763526916504}, "td_error": [0.056162118911743164, 0.992391049861908, 1.46980619430542, 2.6008005142211914, 0.9967011213302612, 0.6325977444648743, 3.10825514793396, 2.579944610595703, 2.125804901123047, 5.298910140991211, 2.090933084487915, 0.8990200757980347, 1.967362403869629, 2.645070791244507, 1.5947535037994385, 0.18919861316680908, 0.8582051396369934, 1.4629417657852173, 1.4655206203460693, 2.724266529083252, 1.157328486442566, 0.24357253313064575, 0.0657118558883667, 0.02893996238708496, 0.24660271406173706, 2.153998374938965, 3.1271681785583496, 0.9646598100662231, 2.0410900115966797, 0.3122328519821167, 0.24652844667434692, 0.8712668418884277, 2.6639814376831055, 2.845496416091919, 0.49760377407073975, 1.382263422012329, 0.9338244795799255, 0.7493412494659424, 0.20709294080734253, 2.5127482414245605, 1.7382220029830933, 2.959840774536133, 0.9158948659896851, 1.2451021671295166, 1.877021074295044, 3.3596463203430176, 2.8747549057006836, 0.436199426651001, 0.453544557094574, 1.6839865446090698, 2.4232993125915527, 1.130437970161438, 2.8842899799346924, 1.1148319244384766, 3.1273601055145264, 3.1936206817626953, 0.9955325722694397, 3.216360569000244, 0.09093761444091797, 2.614813804626465, 0.7560222744941711, 3.194214344024658, 2.0127885341644287, 1.9760663509368896, 1.7151648998260498, 1.6512596607208252, 0.8276680707931519, 1.7128422260284424, 0.21420162916183472, 0.9272890090942383, 2.497743844985962, 0.09622043371200562, 0.10120749473571777, 0.5011608600616455, 1.8987758159637451, 1.2221386432647705, 1.5193567276000977, 1.1905146837234497, 2.5505857467651367, 1.092144250869751, 1.522237777709961, 1.8589777946472168, 0.6729099154472351, 2.104860544204712, 1.4617645740509033, 0.22130751609802246], "mean_td_error": 1.5447118282318115, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 37.0, "diff_num_grad_updates_vs_sampler_policy": 36.0}}, "num_env_steps_sampled": 34048, "num_env_steps_trained": 9546, "num_agent_steps_sampled": 102144, "num_agent_steps_trained": 9546, "last_target_update_ts": 34048, "num_target_updates": 37}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 102144, "num_agent_steps_trained": 9546, "num_env_steps_sampled": 34048, "num_env_steps_trained": 9546, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 765.8969750290975, "num_env_steps_trained_throughput_per_sec": 220.5372986132892, "timesteps_total": 34048, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 102144, "timers": {"training_iteration_time_ms": 1140.007, "sample_time_ms": 868.032, "load_time_ms": 0.315, "load_throughput": 818122.35, "learn_time_ms": 19.311, "learn_throughput": 13360.493, "synch_weights_time_ms": 10.61}, "counters": {"num_env_steps_sampled": 34048, "num_env_steps_trained": 9546, "num_agent_steps_sampled": 102144, "num_agent_steps_trained": 9546, "last_target_update_ts": 34048, "num_target_updates": 37}, "done": false, "episodes_total": 0, "training_iteration": 32, "trial_id": "95c7c_00000", "date": "2023-11-18_20-54-21", "timestamp": 1700369661, "time_this_iter_s": 1.1808040142059326, "time_total_s": 41.20345211029053, "pid": 5649, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16bdf5080>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 41.20345211029053, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 58.35, "ram_util_percent": 67.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.065863609313965, "actor_loss": -5.394994735717773, "critic_loss": 1.8475468158721924, "alpha_loss": -0.11483774334192276, "alpha_value": 0.988656222820282, "log_alpha_value": -0.011408633552491665, "target_entropy": -6.0, "policy_t": -0.019695919007062912, "mean_q": 1.555177927017212, "max_q": 12.025164604187012, "min_q": 1.2980482578277588}, "td_error": [2.008528470993042, 1.1981801986694336, 3.6202077865600586, 0.9049630165100098, 4.62929630279541, 3.894601345062256, 1.6055468320846558, 2.45676326751709, 1.900907039642334, 3.7422637939453125, 3.7064270973205566, 3.275110960006714, 4.057177543640137, 3.1425750255584717, 4.300797939300537, 3.8986244201660156, 3.8608956336975098, 3.7399697303771973, 4.341907501220703, 3.585545301437378, 3.878424644470215, 5.108508110046387, 4.0382981300354, 1.954296350479126, 4.996171951293945, 3.3699073791503906, 5.088794231414795, 3.3006415367126465, 2.8681211471557617, 1.8388570547103882, 2.46742582321167, 2.5129690170288086, 2.1280837059020996, 2.5633630752563477, 2.083707332611084, 2.4628219604492188, 2.155123233795166, 2.998103141784668, 4.428042411804199, 1.8094501495361328, 2.12663197517395, 4.217187881469727, 2.9541878700256348, 3.6426970958709717, 0.41066980361938477, 5.043214797973633, 4.440295219421387, 4.5889434814453125, 2.4428420066833496, 1.613866925239563, 3.514824390411377, 3.779529094696045, 4.0687055587768555, 1.7652257680892944, 3.921205997467041, 4.029203414916992, 3.830721378326416, 4.48411750793457, 3.460702419281006, 3.9442782402038574, 3.0142621994018555, 3.0835375785827637, 3.693690776824951, 4.52618932723999, 4.480554580688477, 3.1299896240234375, 1.9065707921981812, 4.009284973144531, 3.0409064292907715, 2.5559988021850586, 4.164250373840332, 2.1576898097991943, 4.15870475769043, 2.5216574668884277, 4.829265594482422, 3.039252996444702, 3.486504077911377, 4.125819206237793, 3.3754374980926514, 1.1009409427642822, 4.2198486328125, 3.74582576751709, 6.874575138092041, 4.764036178588867, 4.365924835205078, 2.5016024112701416], "mean_td_error": 3.338055372238159, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 39.0, "diff_num_grad_updates_vs_sampler_policy": 38.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.062725067138672, "actor_loss": -5.139654159545898, "critic_loss": 0.438227117061615, "alpha_loss": -0.1148158460855484, "alpha_value": 0.9886548519134521, "log_alpha_value": -0.01141001470386982, "target_entropy": -6.0, "policy_t": 0.0038131324108690023, "mean_q": 1.3657193183898926, "max_q": 6.602252960205078, "min_q": 1.1241750717163086}, "td_error": [1.7450594902038574, 2.8552191257476807, 2.109464168548584, 1.522630214691162, 0.49261558055877686, 1.1802467107772827, 1.4675703048706055, 1.1066067218780518, 1.3559023141860962, 1.7646064758300781, 2.0722031593322754, 3.0591378211975098, 1.871755838394165, 2.7340354919433594, 2.1556262969970703, 2.3063881397247314, 3.2624707221984863, 1.956917405128479, 1.9156715869903564, 1.2702693939208984, 0.05887120962142944, 3.1187429428100586, 1.105526328086853, 1.2734370231628418, 0.6503113508224487, 1.3653956651687622, 0.745214581489563, 1.146052598953247, 0.46849703788757324, 0.768072247505188, 0.8086139559745789, 1.9125242233276367, 2.202294111251831, 1.9413961172103882, 4.319561958312988, 2.1783313751220703, 3.5368738174438477, 0.9543867111206055, 1.6488544940948486, 2.6770381927490234, 2.4334182739257812, 2.1650960445404053, 1.0430876016616821, 0.968543529510498, 2.2498698234558105, 2.1767001152038574, 1.6934444904327393, 2.129704236984253, 0.6371256113052368, 1.1499782800674438, 2.5057106018066406, 0.8688567280769348, 0.2334694266319275, 0.8134549856185913, 2.0041990280151367, 0.43612563610076904, 2.1355817317962646, 1.9073127508163452, 3.1953330039978027, 0.3406216502189636, 0.29323697090148926, 1.3096380233764648, 1.5011816024780273, 3.644970178604126, 4.056949138641357, 0.2893422842025757, 2.8795697689056396, 1.9355697631835938, 0.28151071071624756, 1.8463226556777954, 0.6663790345191956, 0.9743826389312744, 2.2495975494384766, 0.7582175135612488, 1.20778489112854, 0.29532843828201294, 0.4152548313140869, 2.0904784202575684, 0.0585399866104126, 1.785791277885437, 0.901218593120575, 3.7480175495147705, 2.554389715194702, 0.5555609464645386, 1.8278844356536865, 1.9620726108551025], "mean_td_error": 1.6542001962661743, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 39.0, "diff_num_grad_updates_vs_sampler_policy": 38.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.064445495605469, "actor_loss": -5.375666618347168, "critic_loss": 0.41196107864379883, "alpha_loss": -0.11484039574861526, "alpha_value": 0.988654375076294, "log_alpha_value": -0.011410504579544067, "target_entropy": -6.0, "policy_t": 0.00012277078349143267, "mean_q": 1.3772088289260864, "max_q": 6.499850273132324, "min_q": 1.2746303081512451}, "td_error": [1.5511541366577148, 1.440220832824707, 0.3979331851005554, 0.15608030557632446, 2.165477752685547, 4.127045631408691, 0.45733559131622314, 1.5025196075439453, 2.3157525062561035, 1.2407569885253906, 2.853156566619873, 1.7270697355270386, 2.177854537963867, 1.3224806785583496, 1.1707433462142944, 1.8077857494354248, 0.1967259645462036, 2.6966891288757324, 1.2253659963607788, 1.2369823455810547, 0.6317311525344849, 0.43676555156707764, 0.030538499355316162, 1.9386135339736938, 2.161215305328369, 3.9416284561157227, 0.09525495767593384, 1.6237905025482178, 1.8563251495361328, 1.5167603492736816, 1.8338308334350586, 2.6947715282440186, 1.9752105474472046, 0.8527385592460632, 1.889608383178711, 1.650939702987671, 2.095018148422241, 0.8468486070632935, 1.6752805709838867, 2.048170328140259, 0.025723636150360107, 1.059199571609497, 2.807819366455078, 1.2473139762878418, 2.099341869354248, 2.075547695159912, 1.404416561126709, 1.2942911386489868, 0.5195202231407166, 1.9361332654953003, 1.0957913398742676, 1.5121080875396729, 2.700185775756836, 2.230287551879883, 1.4684557914733887, 1.4758292436599731, 1.8952250480651855, 2.9530258178710938, 3.6963284015655518, 0.20256400108337402, 0.6773889064788818, 2.4066669940948486, 2.3403353691101074, 2.4236934185028076, 1.120531439781189, 3.2071259021759033, 0.25521183013916016, 1.3206149339675903, 1.002862572669983, 1.3531363010406494, 1.9776313304901123, 1.2786228656768799, 1.0621330738067627, 2.661961555480957, 1.0280382633209229, 1.3240296840667725, 1.393660068511963, 0.5868193507194519, 3.0690016746520996, 1.139884114265442, 0.7517462372779846, 3.204526424407959, 0.5235134959220886, 1.5632238388061523, 1.8316726684570312, 0.037629783153533936], "mean_td_error": 1.5907552242279053, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 39.0, "diff_num_grad_updates_vs_sampler_policy": 38.0}}, "num_env_steps_sampled": 35840, "num_env_steps_trained": 10062, "num_agent_steps_sampled": 107520, "num_agent_steps_trained": 10062, "last_target_update_ts": 35840, "num_target_updates": 39}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 107520, "num_agent_steps_trained": 10062, "num_env_steps_sampled": 35840, "num_env_steps_trained": 10062, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 888.8928692775589, "num_env_steps_trained_throughput_per_sec": 255.9535270910828, "timesteps_total": 35840, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 107520, "timers": {"training_iteration_time_ms": 1120.941, "sample_time_ms": 850.507, "load_time_ms": 0.318, "load_throughput": 812593.251, "learn_time_ms": 19.228, "learn_throughput": 13418.095, "synch_weights_time_ms": 10.823}, "counters": {"num_env_steps_sampled": 35840, "num_env_steps_trained": 10062, "num_agent_steps_sampled": 107520, "num_agent_steps_trained": 10062, "last_target_update_ts": 35840, "num_target_updates": 39}, "done": false, "episodes_total": 0, "training_iteration": 33, "trial_id": "95c7c_00000", "date": "2023-11-18_20-54-23", "timestamp": 1700369663, "time_this_iter_s": 2.023932933807373, "time_total_s": 43.2273850440979, "pid": 5649, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16bd439c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 43.2273850440979, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 69.93333333333334, "ram_util_percent": 67.06666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.115143775939941, "actor_loss": -5.519039154052734, "critic_loss": 1.7996623516082764, "alpha_loss": -0.11843636631965637, "alpha_value": 0.9883594512939453, "log_alpha_value": -0.011708816513419151, "target_entropy": -6.0, "policy_t": -0.0019435958238318563, "mean_q": 1.4692362546920776, "max_q": 10.004549026489258, "min_q": 1.3648178577423096}, "td_error": [2.1898021697998047, 3.705761671066284, 3.886874198913574, 2.800621747970581, 3.7456703186035156, 2.8202157020568848, 6.129460334777832, 4.8276686668396, 1.4525822401046753, 1.4788774251937866, 2.092453956604004, 4.093050956726074, 3.19268798828125, 4.222362518310547, 1.8823496103286743, 3.7685861587524414, 4.205399513244629, 3.9290926456451416, 1.735312581062317, 2.2558908462524414, 2.3653507232666016, 2.966014862060547, 3.612551212310791, 4.232033729553223, 3.879953622817993, 3.150317668914795, 3.533781051635742, 4.052462577819824, 2.975064277648926, 3.294455051422119, 3.472222328186035, 5.144896507263184, 5.625821590423584, 5.005062103271484, 3.241823196411133, 5.0214033126831055, 1.6149348020553589, 3.363356113433838, 4.598661422729492, 3.7139718532562256, 2.382009983062744, 4.126592636108398, 3.3541407585144043, 2.8088808059692383, 2.0710744857788086, 2.96486234664917, 1.1713283061981201, 2.3372416496276855, 1.7137926816940308, 4.118556499481201, 2.872164726257324, 2.0273075103759766, 3.994236469268799, 2.7741053104400635, 2.473433256149292, 2.592284679412842, 2.640133857727051, 3.5978851318359375, 4.7703752517700195, 3.3304617404937744, 0.9238110780715942, 3.3267905712127686, 2.8979504108428955, 3.7079925537109375, 3.3242602348327637, 2.5019006729125977, 4.592579364776611, 3.2977986335754395, 2.997950553894043, 3.762678861618042, 2.6003952026367188, 3.388216972351074, 2.284214973449707, 3.033291816711426, 3.177623748779297, 3.200596809387207, 3.2118306159973145, 3.7386279106140137, 3.1836600303649902, 3.562371253967285, 2.035287380218506, 5.216595649719238, 3.0763561725616455, 2.233288288116455, 3.1669461727142334, 2.6663408279418945], "mean_td_error": 3.238477945327759, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 40.0, "diff_num_grad_updates_vs_sampler_policy": 39.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.076884269714355, "actor_loss": -5.201186656951904, "critic_loss": 0.43892738223075867, "alpha_loss": -0.11800266802310944, "alpha_value": 0.9883580803871155, "log_alpha_value": -0.011710233055055141, "target_entropy": -6.0, "policy_t": 0.011625546962022781, "mean_q": 1.4641920328140259, "max_q": 6.571728229522705, "min_q": 1.184240698814392}, "td_error": [3.1871142387390137, 1.2508430480957031, 3.225477695465088, 1.9595385789871216, 1.8441463708877563, 1.2895588874816895, 1.0784335136413574, 1.978645920753479, 2.48520565032959, 2.034608840942383, 0.6627413630485535, 1.0752959251403809, 1.0368452072143555, 4.140511989593506, 3.0339882373809814, 3.2979788780212402, 1.955559492111206, 0.2961353659629822, 1.0654118061065674, 1.5233027935028076, 0.21588313579559326, 0.8178058862686157, 2.518991470336914, 0.4559372067451477, 1.260926604270935, 1.4395300149917603, 1.9821233749389648, 1.7618508338928223, 0.21258783340454102, 1.6203209161758423, 0.4772019386291504, 2.3951034545898438, 0.1538514494895935, 1.5388636589050293, 2.888723850250244, 1.7131166458129883, 0.46954792737960815, 3.1408705711364746, 0.7266702651977539, 2.3165173530578613, 1.1729340553283691, 2.9161341190338135, 1.44718337059021, 1.5869979858398438, 1.6074614524841309, 0.3347921371459961, 2.7222394943237305, 2.825511932373047, 0.3070552349090576, 2.7518763542175293, 2.3543787002563477, 0.2769884467124939, 0.572672963142395, 2.4438767433166504, 2.9931178092956543, 2.231651782989502, 1.2860370874404907, 3.543781280517578, 1.7490234375, 2.4762566089630127, 1.8675711154937744, 0.9921945333480835, 0.5608776211738586, 1.5839548110961914, 1.472002387046814, 1.0922462940216064, 0.8001413941383362, 1.607085943222046, 0.6412924528121948, 2.4282784461975098, 0.40399354696273804, 0.3135939836502075, 0.4302128553390503, 2.028386116027832, 2.5246739387512207, 2.079061508178711, 2.043123245239258, 0.06400513648986816, 1.8628697395324707, 2.3301262855529785, 0.520604133605957, 3.3589112758636475, 2.1931605339050293, 3.9597973823547363, 1.4895519018173218, 0.06133168935775757], "mean_td_error": 1.6608929634094238, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 40.0, "diff_num_grad_updates_vs_sampler_policy": 39.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.011621475219727, "actor_loss": -5.393655300140381, "critic_loss": 0.39320987462997437, "alpha_loss": -0.11724340170621872, "alpha_value": 0.9883575439453125, "log_alpha_value": -0.011710730381309986, "target_entropy": -6.0, "policy_t": 0.029855579137802124, "mean_q": 1.620368242263794, "max_q": 5.92648983001709, "min_q": 1.3347489833831787}, "td_error": [0.16010689735412598, 3.354452133178711, 0.4958380460739136, 1.2487921714782715, 2.5274617671966553, 1.1624048948287964, 2.2470881938934326, 1.9948979616165161, 0.7716861367225647, 0.6640018820762634, 0.36766594648361206, 2.0334441661834717, 1.3514142036437988, 1.644319772720337, 1.5378309488296509, 2.7404985427856445, 2.5652408599853516, 1.6535958051681519, 0.4608805179595947, 2.2538959980010986, 1.8450024127960205, 0.4962640404701233, 0.8263785243034363, 0.7892176508903503, 0.21290498971939087, 3.6088953018188477, 3.1663126945495605, 0.9955649375915527, 0.6783287525177002, 0.3781200647354126, 2.761848211288452, 0.02912425994873047, 0.30932754278182983, 2.178452491760254, 0.8420934081077576, 0.26155543327331543, 3.812014102935791, 2.561030387878418, 0.8334748148918152, 0.7877598404884338, 0.8594460487365723, 1.3474717140197754, 1.939846158027649, 1.8606904745101929, 1.464465856552124, 1.8578755855560303, 3.2325706481933594, 3.6139698028564453, 1.429349422454834, 1.148842215538025, 0.44889575242996216, 0.03624528646469116, 0.43727242946624756, 3.1577155590057373, 2.368272304534912, 0.9669976830482483, 1.2983288764953613, 0.2475159764289856, 0.15361881256103516, 2.027096748352051, 3.740999698638916, 0.12978816032409668, 3.432636022567749, 1.370882272720337, 2.6812071800231934, 2.268219470977783, 2.260040521621704, 1.5488145351409912, 1.43505859375, 3.2756128311157227, 3.206052303314209, 0.4236069917678833, 1.527052402496338, 1.9508039951324463, 2.59470534324646, 1.44286048412323, 1.0312331914901733, 0.6291263699531555, 0.4782470464706421, 0.4187147617340088, 1.284980058670044, 0.7075653672218323, 1.9534642696380615, 1.3369059562683105, 1.1866803169250488, 1.4633302688598633], "mean_td_error": 1.538189172744751, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 40.0, "diff_num_grad_updates_vs_sampler_policy": 39.0}}, "num_env_steps_sampled": 36736, "num_env_steps_trained": 10320, "num_agent_steps_sampled": 110208, "num_agent_steps_trained": 10320, "last_target_update_ts": 36736, "num_target_updates": 40}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 110208, "num_agent_steps_trained": 10320, "num_env_steps_sampled": 36736, "num_env_steps_trained": 10320, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 825.4608798027555, "num_env_steps_trained_throughput_per_sec": 237.68851226463272, "timesteps_total": 36736, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 110208, "timers": {"training_iteration_time_ms": 1122.936, "sample_time_ms": 851.86, "load_time_ms": 0.319, "load_throughput": 810038.5, "learn_time_ms": 19.281, "learn_throughput": 13380.995, "synch_weights_time_ms": 10.652}, "counters": {"num_env_steps_sampled": 36736, "num_env_steps_trained": 10320, "num_agent_steps_sampled": 110208, "num_agent_steps_trained": 10320, "last_target_update_ts": 36736, "num_target_updates": 40}, "done": false, "episodes_total": 0, "training_iteration": 34, "trial_id": "95c7c_00000", "date": "2023-11-18_20-54-24", "timestamp": 1700369664, "time_this_iter_s": 1.0947928428649902, "time_total_s": 44.32217788696289, "pid": 5649, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16bd422a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 44.32217788696289, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 83.4, "ram_util_percent": 67.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.03880500793457, "actor_loss": -5.60233211517334, "critic_loss": 1.8037548065185547, "alpha_loss": -0.12356932461261749, "alpha_value": 0.9877662658691406, "log_alpha_value": -0.012309166602790356, "target_entropy": -6.0, "policy_t": 0.020615261048078537, "mean_q": 1.7472972869873047, "max_q": 11.215324401855469, "min_q": 1.5082324743270874}, "td_error": [2.921201229095459, 2.8076634407043457, 2.364356517791748, 2.603728771209717, 1.7462348937988281, 4.023416042327881, 4.9435224533081055, 4.031678199768066, 3.4768929481506348, 3.2014150619506836, 3.7473535537719727, 3.393235206604004, 3.578782081604004, 4.705007553100586, 3.6022462844848633, 3.1551475524902344, 0.8656090497970581, 3.4958720207214355, 2.6835813522338867, 3.694148063659668, 4.869119167327881, 4.019631385803223, 4.1949238777160645, 3.2096567153930664, 2.964388847351074, 3.821140766143799, 3.2025468349456787, 4.08414888381958, 2.37786865234375, 5.819266319274902, 3.6832127571105957, 3.3197250366210938, 2.135044574737549, 4.020249366760254, 4.116536617279053, 2.277195930480957, 6.288306713104248, 1.8406274318695068, 3.237581491470337, 3.225205659866333, 0.8668674230575562, 3.2823445796966553, 3.7216429710388184, 2.5779027938842773, 3.034226655960083, 3.351369857788086, 3.250873565673828, 3.4891438484191895, 3.060269832611084, 5.122795104980469, 3.762786388397217, 2.1856820583343506, 3.750452756881714, 3.7057816982269287, 2.5919041633605957, 2.3617544174194336, 2.332763195037842, 2.866054058074951, 2.489119529724121, 2.6836748123168945, 2.8008170127868652, 2.8411362171173096, 2.801938056945801, 4.116133689880371, 4.838146686553955, 3.2505886554718018, 2.9531850814819336, 2.060337543487549, 5.764575958251953, 2.3017189502716064, 2.435121536254883, 2.7522239685058594, 3.83424711227417, 3.527492046356201, 3.2769510746002197, 1.4716459512710571, 3.100116729736328, 2.316283702850342, 3.151193857192993, 3.946258783340454, 5.631332874298096, 2.177950382232666, 2.601609468460083, 2.2691049575805664, 0.4852635860443115, 4.510214805603027], "mean_td_error": 3.2494239807128906, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 42.0, "diff_num_grad_updates_vs_sampler_policy": 41.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.093230247497559, "actor_loss": -5.333285808563232, "critic_loss": 0.3715069890022278, "alpha_loss": -0.12425434589385986, "alpha_value": 0.9877647757530212, "log_alpha_value": -0.012310662306845188, "target_entropy": -6.0, "policy_t": 0.013707908801734447, "mean_q": 1.4495878219604492, "max_q": 5.951756000518799, "min_q": 1.3099925518035889}, "td_error": [0.07869821786880493, 1.542572021484375, 2.39022159576416, 0.868043065071106, 3.346367359161377, 1.8875718116760254, 0.3603464365005493, 0.9569487571716309, 2.2049436569213867, 0.6949248909950256, 1.2876337766647339, 2.1258673667907715, 1.6506614685058594, 1.1635026931762695, 0.3250030279159546, 1.4846110343933105, 1.1492431163787842, 1.6375283002853394, 0.5076397657394409, 0.4409196376800537, 2.3591811656951904, 0.9879003167152405, 0.4162105917930603, 1.319080114364624, 1.1479905843734741, 0.17325925827026367, 1.13446843624115, 0.7587464451789856, 0.6594198942184448, 3.476369857788086, 2.426220417022705, 2.7528367042541504, 1.4978489875793457, 1.0256640911102295, 1.9437613487243652, 2.0075838565826416, 1.743572473526001, 2.831185817718506, 1.3737857341766357, 1.0024573802947998, 1.03013014793396, 1.0817617177963257, 1.7228624820709229, 1.3481979370117188, 1.0180293321609497, 1.729022741317749, 2.3978543281555176, 0.7670307755470276, 2.507072925567627, 0.20828032493591309, 1.7972568273544312, 1.5189216136932373, 1.0003422498703003, 1.560800552368164, 2.2678918838500977, 1.4044103622436523, 1.031212568283081, 2.527177333831787, 2.360427141189575, 1.2810683250427246, 1.4459445476531982, 3.529399871826172, 1.973867654800415, 0.6056157946586609, 1.0192606449127197, 1.9748835563659668, 0.8808203935623169, 0.7450096607208252, 0.5663203597068787, 0.738939642906189, 3.656139373779297, 1.1348092555999756, 1.6245630979537964, 2.054804801940918, 1.713268518447876, 2.99161434173584, 2.1448476314544678, 0.9242135286331177, 0.6928711533546448, 0.5430411100387573, 1.8570277690887451, 0.8622533679008484, 0.944473385810852, 3.236464023590088, 2.364290475845337, 0.8814212083816528], "mean_td_error": 1.4977525472640991, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 42.0, "diff_num_grad_updates_vs_sampler_policy": 41.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.109256744384766, "actor_loss": -5.623818397521973, "critic_loss": 0.3706508278846741, "alpha_loss": -0.12445272505283356, "alpha_value": 0.9877647161483765, "log_alpha_value": -0.012310768477618694, "target_entropy": -6.0, "policy_t": -0.02824653871357441, "mean_q": 1.7501850128173828, "max_q": 6.395526885986328, "min_q": 1.4596643447875977}, "td_error": [2.7517945766448975, 0.4078274965286255, 0.49406641721725464, 1.12357759475708, 0.7299008369445801, 3.0784311294555664, 3.0302913188934326, 3.1380395889282227, 0.32075202465057373, 1.486180067062378, 1.4546204805374146, 0.7680587768554688, 2.377911329269409, 1.090467929840088, 2.7472903728485107, 0.03483206033706665, 1.457829475402832, 2.2827670574188232, 2.1590826511383057, 0.4071732759475708, 1.381028175354004, 0.4623776078224182, 1.6654675006866455, 2.723273754119873, 1.1090126037597656, 2.627631664276123, 0.6272308230400085, 1.6562104225158691, 0.2721753716468811, 1.47055983543396, 0.7176381945610046, 2.206796407699585, 0.0723346471786499, 0.3698594570159912, 0.5309052467346191, 2.6490707397460938, 5.732125282287598, 1.9427731037139893, 0.6412307024002075, 0.12496399879455566, 1.7766097784042358, 1.4636859893798828, 0.3826932907104492, 1.11354398727417, 1.6117268800735474, 1.960418939590454, 0.3668326139450073, 1.258581280708313, 0.24585652351379395, 0.5382665395736694, 1.714902400970459, 0.7432121634483337, 1.0062386989593506, 2.5947866439819336, 1.880903720855713, 1.9027507305145264, 1.500252604484558, 1.7043122053146362, 0.4431905150413513, 2.3248322010040283, 2.265500068664551, 2.696017265319824, 0.8616015911102295, 2.0854477882385254, 0.10799145698547363, 2.7786364555358887, 2.269548177719116, 0.9518014192581177, 1.9152628183364868, 1.6383402347564697, 1.364997148513794, 2.177703857421875, 1.0326509475708008, 1.9236775636672974, 1.390805721282959, 0.9381208419799805, 0.5072921514511108, 3.928720474243164, 0.6480129957199097, 1.7048182487487793, 0.663488507270813, 1.2069368362426758, 1.4511628150939941, 1.8879492282867432, 2.7282302379608154, 1.5731292963027954], "mean_td_error": 1.5064533948898315, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 42.0, "diff_num_grad_updates_vs_sampler_policy": 41.0}}, "num_env_steps_sampled": 38528, "num_env_steps_trained": 10836, "num_agent_steps_sampled": 115584, "num_agent_steps_trained": 10836, "last_target_update_ts": 38528, "num_target_updates": 42}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 115584, "num_agent_steps_trained": 10836, "num_env_steps_sampled": 38528, "num_env_steps_trained": 10836, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 821.6961542632648, "num_env_steps_trained_throughput_per_sec": 236.60447299098476, "timesteps_total": 38528, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 115584, "timers": {"training_iteration_time_ms": 1091.469, "sample_time_ms": 821.685, "load_time_ms": 0.323, "load_throughput": 799505.306, "learn_time_ms": 18.673, "learn_throughput": 13817.047, "synch_weights_time_ms": 10.374}, "counters": {"num_env_steps_sampled": 38528, "num_env_steps_trained": 10836, "num_agent_steps_sampled": 115584, "num_agent_steps_trained": 10836, "last_target_update_ts": 38528, "num_target_updates": 42}, "done": false, "episodes_total": 0, "training_iteration": 35, "trial_id": "95c7c_00000", "date": "2023-11-18_20-54-26", "timestamp": 1700369666, "time_this_iter_s": 2.1903672218322754, "time_total_s": 46.512545108795166, "pid": 5649, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16bd43240>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 46.512545108795166, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 71.83333333333333, "ram_util_percent": 67.93333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.03344440460205, "actor_loss": -5.663913249969482, "critic_loss": 1.6959903240203857, "alpha_loss": -0.12651334702968597, "alpha_value": 0.9874699711799622, "log_alpha_value": -0.012609165161848068, "target_entropy": -6.0, "policy_t": 0.028413070365786552, "mean_q": 2.332003593444824, "max_q": 12.35036849975586, "min_q": 1.5843737125396729}, "td_error": [0.1028822660446167, 3.3877344131469727, 2.741048574447632, 2.5027730464935303, 2.7753353118896484, 2.251420736312866, 1.7162790298461914, 3.1439054012298584, 4.191623687744141, 1.4844112396240234, 4.496603012084961, 2.6941981315612793, 3.2013368606567383, 3.630520820617676, 5.754979610443115, 2.341660976409912, 2.917745590209961, 2.2528302669525146, 3.394754409790039, 3.147026538848877, 2.903266429901123, 4.300949573516846, 3.9738550186157227, 2.5530877113342285, 4.8645429611206055, 2.085294008255005, 3.5692787170410156, 2.3524065017700195, 3.2160987854003906, 3.641526460647583, 3.2660021781921387, 3.8412537574768066, 3.5669751167297363, 2.824793815612793, 1.4963458776474, 2.7688417434692383, 2.6367735862731934, 2.2329726219177246, 2.5645649433135986, 3.9133896827697754, 3.556154727935791, 3.586822986602783, 1.833631157875061, 2.7126173973083496, 1.3330438137054443, 1.11581289768219, 3.3565547466278076, 2.2234630584716797, 1.6888655424118042, 4.431506633758545, 3.6020543575286865, 1.4229631423950195, 3.6315951347351074, 3.2516231536865234, 4.348047256469727, 2.306983470916748, 2.675595998764038, 7.2047858238220215, 3.684657096862793, 5.367508888244629, 3.776989459991455, 3.3089675903320312, 2.9193639755249023, 3.86639404296875, 2.9878692626953125, 2.345933437347412, 4.081357002258301, 2.846324920654297, 3.8716659545898438, 3.9291324615478516, 3.2568445205688477, 3.924384117126465, 1.4758150577545166, 2.5761971473693848, 4.395456790924072, 3.005162239074707, 3.9939446449279785, 2.9535646438598633, 3.608945369720459, 2.6055660247802734, 4.322117328643799, 3.742389678955078, 1.377100944519043, 4.269463062286377, 4.270325183868408, 1.8296351432800293], "mean_td_error": 3.134610652923584, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 43.0, "diff_num_grad_updates_vs_sampler_policy": 42.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.111143112182617, "actor_loss": -5.396566867828369, "critic_loss": 0.35429608821868896, "alpha_loss": -0.1275106966495514, "alpha_value": 0.9874683022499084, "log_alpha_value": -0.0126109067350626, "target_entropy": -6.0, "policy_t": -0.023102939128875732, "mean_q": 1.5933234691619873, "max_q": 6.476029396057129, "min_q": 1.3774986267089844}, "td_error": [0.4233860969543457, 0.8818241357803345, 2.1196296215057373, 1.220951795578003, 0.07154273986816406, 0.4200208783149719, 0.6956673264503479, 1.357669472694397, 0.5575457811355591, 2.079869270324707, 2.2629690170288086, 0.9469716548919678, 0.13746678829193115, 1.706855297088623, 3.0113725662231445, 2.572164535522461, 1.4209280014038086, 0.6728636622428894, 0.8333765268325806, 1.2674121856689453, 0.8084511160850525, 2.2927112579345703, 1.2180463075637817, 0.9348647594451904, 1.1878318786621094, 0.26922065019607544, 1.4822216033935547, 2.7807183265686035, 0.2254200577735901, 3.0961833000183105, 3.330057382583618, 0.994537353515625, 2.2123303413391113, 2.5004777908325195, 2.478253126144409, 1.959743857383728, 0.38053739070892334, 1.4645628929138184, 0.7055747509002686, 2.0670254230499268, 2.5837907791137695, 2.3954198360443115, 2.7672297954559326, 1.143458604812622, 0.9616217613220215, 2.0224785804748535, 0.3464055061340332, 0.5643962621688843, 0.5661991834640503, 1.2309445142745972, 1.6354432106018066, 2.297183036804199, 0.19533222913742065, 0.23026907444000244, 0.24757838249206543, 1.6878249645233154, 2.6239988803863525, 1.2552944421768188, 1.5114524364471436, 1.699272871017456, 1.423987627029419, 1.884080171585083, 1.476641297340393, 0.6829776763916016, 2.1138720512390137, 2.8157951831817627, 1.7333521842956543, 0.5843088030815125, 2.1890077590942383, 1.713808298110962, 0.618870735168457, 1.6148834228515625, 0.21975332498550415, 2.8734238147735596, 1.7129573822021484, 0.8087384700775146, 1.8931454420089722, 1.018143892288208, 1.2338459491729736, 1.7150647640228271, 0.6025723814964294, 2.6113829612731934, 1.5130746364593506, 0.6980751752853394, 0.5594059228897095, 2.3484790325164795], "mean_td_error": 1.4380755424499512, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 43.0, "diff_num_grad_updates_vs_sampler_policy": 42.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.072773933410645, "actor_loss": -5.63020133972168, "critic_loss": 0.3925977647304535, "alpha_loss": -0.1270260065793991, "alpha_value": 0.9874683618545532, "log_alpha_value": -0.012610825709998608, "target_entropy": -6.0, "policy_t": 0.04127875715494156, "mean_q": 1.7388522624969482, "max_q": 5.285041809082031, "min_q": 1.5248774290084839}, "td_error": [0.7517515420913696, 0.31706148386001587, 1.3419245481491089, 0.6596589088439941, 1.4822344779968262, 1.38321852684021, 0.6820159554481506, 1.618565320968628, 0.4619024395942688, 0.11475014686584473, 0.036171138286590576, 2.8178892135620117, 0.3128169775009155, 2.814957618713379, 0.4244997501373291, 1.1301765441894531, 2.4297397136688232, 3.5180883407592773, 2.5438995361328125, 0.3121873140335083, 2.275148868560791, 3.6776537895202637, 1.1648553609848022, 1.6983249187469482, 0.33551734685897827, 0.915635347366333, 2.501460313796997, 1.4583806991577148, 0.430561900138855, 1.3982934951782227, 1.768852710723877, 3.411452531814575, 0.1906883716583252, 1.5384063720703125, 2.615247964859009, 1.4521286487579346, 0.9047501683235168, 2.4357104301452637, 2.524827480316162, 1.5966899394989014, 0.44478440284729004, 1.924483299255371, 2.5186843872070312, 2.818131923675537, 1.0039478540420532, 2.4564390182495117, 1.015270471572876, 1.8283298015594482, 0.9988937377929688, 1.5463379621505737, 0.21968090534210205, 2.6137194633483887, 2.1762537956237793, 0.2373470664024353, 1.5855357646942139, 4.026470184326172, 1.9834569692611694, 0.7151685357093811, 1.8179141283035278, 0.3715220093727112, 2.08571457862854, 0.8461543321609497, 0.04399693012237549, 1.5896046161651611, 1.2841674089431763, 2.9289629459381104, 1.7937408685684204, 3.674675703048706, 0.7900623679161072, 0.49423646926879883, 2.7669363021850586, 0.8234943151473999, 2.2459194660186768, 1.0025819540023804, 1.1150814294815063, 1.2775386571884155, 1.8271279335021973, 3.2196788787841797, 1.3349915742874146, 2.53181529045105, 1.0417687892913818, 0.17880284786224365, 2.7758474349975586, 0.35581839084625244, 1.3827009201049805, 2.0880842208862305], "mean_td_error": 1.5494184494018555, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 43.0, "diff_num_grad_updates_vs_sampler_policy": 42.0}}, "num_env_steps_sampled": 39424, "num_env_steps_trained": 11094, "num_agent_steps_sampled": 118272, "num_agent_steps_trained": 11094, "last_target_update_ts": 39424, "num_target_updates": 43}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 118272, "num_agent_steps_trained": 11094, "num_env_steps_sampled": 39424, "num_env_steps_trained": 11094, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 815.5217684259684, "num_env_steps_trained_throughput_per_sec": 234.8265806405132, "timesteps_total": 39424, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 118272, "timers": {"training_iteration_time_ms": 1090.369, "sample_time_ms": 819.153, "load_time_ms": 0.323, "load_throughput": 798031.292, "learn_time_ms": 18.603, "learn_throughput": 13868.649, "synch_weights_time_ms": 10.998}, "counters": {"num_env_steps_sampled": 39424, "num_env_steps_trained": 11094, "num_agent_steps_sampled": 118272, "num_agent_steps_trained": 11094, "last_target_update_ts": 39424, "num_target_updates": 43}, "done": false, "episodes_total": 0, "training_iteration": 36, "trial_id": "95c7c_00000", "date": "2023-11-18_20-54-27", "timestamp": 1700369667, "time_this_iter_s": 1.1134259700775146, "time_total_s": 47.62597107887268, "pid": 5649, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16bd42520>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 47.62597107887268, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 78.85, "ram_util_percent": 68.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.09841537475586, "actor_loss": -5.792353630065918, "critic_loss": 1.311574935913086, "alpha_loss": -0.13036075234413147, "alpha_value": 0.9871739149093628, "log_alpha_value": -0.01290903240442276, "target_entropy": -6.0, "policy_t": 0.03088587522506714, "mean_q": 2.0051162242889404, "max_q": 11.274792671203613, "min_q": 1.659264326095581}, "td_error": [1.7405741214752197, 2.0640511512756348, 2.6820743083953857, 2.4218711853027344, 3.992314100265503, 2.768172025680542, 2.903942108154297, 2.371988296508789, 1.6387109756469727, 2.3901233673095703, 3.8185677528381348, 3.258251428604126, 1.6843582391738892, 1.230818748474121, 4.530943393707275, 1.9799997806549072, 3.787745475769043, 2.5928759574890137, 2.678701639175415, 1.9424705505371094, 0.7124814391136169, 3.148740768432617, 1.1329594850540161, 1.5466554164886475, 2.7255325317382812, 3.257028102874756, 3.335892677307129, 2.365572690963745, 1.6071710586547852, 2.833517074584961, 1.2095208168029785, 6.101380348205566, 2.9018630981445312, 3.3781521320343018, 3.303226947784424, 2.478395938873291, 3.864926815032959, 1.1659772396087646, 2.5041139125823975, 2.945521593093872, 2.926621913909912, 3.44035005569458, 3.78554105758667, 3.2434208393096924, 2.7587757110595703, 2.9861679077148438, 3.1198439598083496, 1.271073818206787, 1.6314871311187744, 3.386460542678833, 2.9109935760498047, 2.5456454753875732, 2.939244270324707, 3.3145651817321777, 4.642294883728027, 3.1437325477600098, 3.2430644035339355, 3.2588798999786377, 2.218715190887451, 1.790871500968933, 2.9678046703338623, 3.1353530883789062, 2.461855411529541, 4.702878952026367, 4.381313323974609, 5.19575834274292, 2.251879930496216, 3.5225095748901367, 3.028228282928467, 2.299598455429077, 4.150934219360352, 1.6473808288574219, 1.992102861404419, 1.8595216274261475, 3.951409339904785, 2.275853157043457, 4.1445631980896, 3.797818660736084, 4.984743118286133, 2.41485595703125, 3.010721206665039, 1.288826823234558, 3.5009145736694336, 4.293971538543701, 3.7369019985198975, 4.364649772644043], "mean_td_error": 2.8943870067596436, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 44.0, "diff_num_grad_updates_vs_sampler_policy": 43.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.074485778808594, "actor_loss": -5.449591636657715, "critic_loss": 0.3866872787475586, "alpha_loss": -0.130073681473732, "alpha_value": 0.9871717691421509, "log_alpha_value": -0.012911197729408741, "target_entropy": -6.0, "policy_t": -0.00619706092402339, "mean_q": 1.6474119424819946, "max_q": 6.437211990356445, "min_q": 1.4462087154388428}, "td_error": [2.99055814743042, 1.6877617835998535, 1.4640238285064697, 0.8255188465118408, 1.856600046157837, 0.5426578521728516, 2.6232919692993164, 0.319010853767395, 0.2569032907485962, 1.7094128131866455, 2.852342128753662, 1.0178362131118774, 2.3526010513305664, 0.3998967409133911, 1.6069743633270264, 0.4302581548690796, 1.3753876686096191, 2.324315071105957, 3.0234813690185547, 1.296464443206787, 1.215383529663086, 0.07273614406585693, 3.015177011489868, 0.4570960998535156, 0.8326308131217957, 0.9404271245002747, 2.326012134552002, 1.1992816925048828, 0.09481370449066162, 1.8560407161712646, 0.07506883144378662, 0.6190524101257324, 1.9608776569366455, 2.990323066711426, 2.5147337913513184, 1.1644850969314575, 0.2919120788574219, 1.991748571395874, 2.834268093109131, 0.29688382148742676, 0.07974511384963989, 1.4599074125289917, 0.6209911704063416, 2.367175579071045, 2.0599558353424072, 2.070904016494751, 1.3434412479400635, 2.9165713787078857, 1.321251630783081, 1.817162275314331, 0.7949041724205017, 2.947873115539551, 1.5556972026824951, 2.0241141319274902, 0.11949676275253296, 0.7209976315498352, 2.8841097354888916, 1.835017442703247, 1.4377245903015137, 1.3941123485565186, 1.097745656967163, 0.19993478059768677, 3.7437379360198975, 0.15885156393051147, 0.32994627952575684, 2.768822193145752, 1.3880634307861328, 0.5003859996795654, 2.2121076583862305, 0.21875876188278198, 2.183701992034912, 1.8192027807235718, 1.4072444438934326, 2.5431699752807617, 2.0238280296325684, 1.23470139503479, 1.6143168210983276, 2.580099105834961, 1.271043062210083, 1.0500397682189941, 1.7103655338287354, 2.5940065383911133, 0.0997956395149231, 1.1318542957305908, 2.02888822555542, 2.371417999267578], "mean_td_error": 1.5088075399398804, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 44.0, "diff_num_grad_updates_vs_sampler_policy": 43.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.061788558959961, "actor_loss": -5.694417476654053, "critic_loss": 0.2632412612438202, "alpha_loss": -0.12990596890449524, "alpha_value": 0.9871721863746643, "log_alpha_value": -0.012910821475088596, "target_entropy": -6.0, "policy_t": 0.006528932135552168, "mean_q": 1.7035032510757446, "max_q": 6.285920143127441, "min_q": 1.5712454319000244}, "td_error": [0.6931418776512146, 0.9361505508422852, 2.111132860183716, 0.8483355641365051, 1.1771936416625977, 0.36216211318969727, 0.4858466386795044, 1.901367425918579, 0.5133510231971741, 2.199976921081543, 0.08079326152801514, 2.7486820220947266, 2.7362122535705566, 0.09605085849761963, 0.3937993049621582, 1.1582499742507935, 1.5075550079345703, 0.7194451689720154, 2.118791341781616, 0.19414019584655762, 0.7723132967948914, 0.0494081974029541, 0.9699928760528564, 1.5704495906829834, 0.845486581325531, 1.9021145105361938, 2.2186450958251953, 1.0971311330795288, 1.6013619899749756, 0.8535327911376953, 0.9715011119842529, 2.606926202774048, 1.3269420862197876, 0.7148308753967285, 1.1375787258148193, 3.217341899871826, 0.9645839929580688, 1.3987728357315063, 1.183821201324463, 2.502655506134033, 0.47481536865234375, 1.598798394203186, 1.2251627445220947, 0.2827194333076477, 0.28266799449920654, 0.15494990348815918, 3.408916473388672, 0.6525949835777283, 0.9078319072723389, 0.48770612478256226, 1.2355605363845825, 0.5389209985733032, 3.1922998428344727, 0.03861743211746216, 1.1965301036834717, 1.7689284086227417, 0.9034264087677002, 2.227212905883789, 0.5118848085403442, 1.2790000438690186, 2.70465087890625, 1.6425758600234985, 2.868312120437622, 1.0773154497146606, 0.7954396605491638, 0.6672786474227905, 1.324415683746338, 0.2589840888977051, 0.7767038345336914, 0.6526451110839844, 0.6512913703918457, 0.9379488229751587, 0.5686070322990417, 1.1206753253936768, 0.998704731464386, 0.9089530110359192, 1.256422758102417, 0.9156192541122437, 1.4656963348388672, 0.04097616672515869, 1.3898141384124756, 0.8507686257362366, 0.1256389617919922, 0.6255708932876587, 0.38288938999176025, 1.56825852394104], "mean_td_error": 1.1608426570892334, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 44.0, "diff_num_grad_updates_vs_sampler_policy": 43.0}}, "num_env_steps_sampled": 40320, "num_env_steps_trained": 11352, "num_agent_steps_sampled": 120960, "num_agent_steps_trained": 11352, "last_target_update_ts": 40320, "num_target_updates": 44}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120960, "num_agent_steps_trained": 11352, "num_env_steps_sampled": 40320, "num_env_steps_trained": 11352, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 824.2930758306053, "num_env_steps_trained_throughput_per_sec": 237.35224728158056, "timesteps_total": 40320, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 120960, "timers": {"training_iteration_time_ms": 1090.133, "sample_time_ms": 818.13, "load_time_ms": 0.321, "load_throughput": 803542.312, "learn_time_ms": 18.414, "learn_throughput": 14010.863, "synch_weights_time_ms": 10.934}, "counters": {"num_env_steps_sampled": 40320, "num_env_steps_trained": 11352, "num_agent_steps_sampled": 120960, "num_agent_steps_trained": 11352, "last_target_update_ts": 40320, "num_target_updates": 44}, "done": false, "episodes_total": 0, "training_iteration": 37, "trial_id": "95c7c_00000", "date": "2023-11-18_20-54-29", "timestamp": 1700369669, "time_this_iter_s": 1.0965559482574463, "time_total_s": 48.72252702713013, "pid": 5649, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16bdf62a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 48.72252702713013, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 63.0, "ram_util_percent": 67.45}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.106502532958984, "actor_loss": -5.882699012756348, "critic_loss": 1.2405452728271484, "alpha_loss": -0.13349615037441254, "alpha_value": 0.9868779182434082, "log_alpha_value": -0.013208935037255287, "target_entropy": -6.0, "policy_t": 0.027339516207575798, "mean_q": 1.830830454826355, "max_q": 7.126502990722656, "min_q": 1.7360823154449463}, "td_error": [2.5399327278137207, 2.8219165802001953, 2.9012532234191895, 3.576143503189087, 2.260373592376709, 2.8531529903411865, 2.5512537956237793, 1.3583288192749023, 2.0896735191345215, 2.8938302993774414, 2.843961238861084, 2.1398515701293945, 2.751011848449707, 0.46477484703063965, 2.276813507080078, 4.762502670288086, 1.5718839168548584, 2.134228229522705, 4.11644172668457, 3.3590612411499023, 2.234179973602295, 2.39487624168396, 2.2159321308135986, 3.784688949584961, 2.8448238372802734, 2.529444932937622, 4.304692268371582, 3.137150764465332, 2.739015579223633, 0.8090291023254395, 2.7633275985717773, 3.069749355316162, 1.9834849834442139, 3.4326744079589844, 2.2986814975738525, 2.6536471843719482, 3.9166641235351562, 4.094759464263916, 1.5209176540374756, 0.9962249398231506, 3.2713913917541504, 2.596693515777588, 3.6160483360290527, 2.113882303237915, 4.378386497497559, 4.444638729095459, 2.466679096221924, 3.4852805137634277, 4.894159317016602, 2.622149705886841, 3.296848773956299, 5.7197489738464355, 2.608020305633545, 1.6796399354934692, 2.2972006797790527, 1.8857841491699219, 3.4092793464660645, 3.5994226932525635, 0.27993321418762207, 3.300570487976074, 2.219607353210449, 2.641818046569824, 2.354961633682251, 2.2146575450897217, 2.9619312286376953, 2.8477225303649902, 4.448752403259277, 2.3117661476135254, 3.354069709777832, 0.7034721970558167, 3.4908249378204346, 3.604679822921753, 2.7640843391418457, 3.5788583755493164, 3.8689489364624023, 1.7006995677947998, 3.6651151180267334, 3.892056941986084, 3.263359546661377, 4.411564350128174, 2.705733299255371, 0.4949057698249817, 1.8682769536972046, 2.2422895431518555, 4.445013046264648, 3.0412044525146484], "mean_td_error": 2.8261914253234863, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 45.0, "diff_num_grad_updates_vs_sampler_policy": 44.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.073450088500977, "actor_loss": -5.504911422729492, "critic_loss": 0.39905476570129395, "alpha_loss": -0.13308483362197876, "alpha_value": 0.9868754148483276, "log_alpha_value": -0.013211444020271301, "target_entropy": -6.0, "policy_t": 0.018167730420827866, "mean_q": 1.8664320707321167, "max_q": 6.3774566650390625, "min_q": 1.5172855854034424}, "td_error": [0.09070301055908203, 2.343729257583618, 2.8426852226257324, 3.356869697570801, 3.2117056846618652, 2.2018375396728516, 1.1705238819122314, 0.9149953126907349, 2.329310417175293, 2.3424344062805176, 1.2836570739746094, 0.8706930875778198, 1.0277738571166992, 1.197082757949829, 4.833321571350098, 1.9999825954437256, 0.36236482858657837, 0.18728399276733398, 0.4946010708808899, 1.642636775970459, 1.1279079914093018, 2.5147616863250732, 1.9421043395996094, 2.438896656036377, 0.9352468252182007, 1.8410825729370117, 2.4428257942199707, 0.42282360792160034, 2.7681844234466553, 2.7514123916625977, 1.3494641780853271, 1.1393153667449951, 0.959927499294281, 2.130511522293091, 0.9514440894126892, 0.1852055788040161, 1.8133835792541504, 2.609344244003296, 0.41451942920684814, 2.750993251800537, 2.5120301246643066, 1.16266667842865, 3.8585026264190674, 1.4223437309265137, 1.4579076766967773, 2.758939504623413, 0.3319910764694214, 1.3790662288665771, 1.0052969455718994, 3.3775877952575684, 0.7851917743682861, 0.30707454681396484, 1.5386521816253662, 1.0280827283859253, 0.09275925159454346, 1.0519639253616333, 1.1910037994384766, 1.5630934238433838, 0.2898394465446472, 0.8664150238037109, 1.8270106315612793, 0.6880167126655579, 1.600044846534729, 0.3167857527732849, 1.5886566638946533, 0.6897680759429932, 1.7685229778289795, 0.6287341713905334, 1.9832561016082764, 2.0294885635375977, 0.6503464579582214, 1.5968046188354492, 3.7225375175476074, 0.4279855489730835, 1.2193796634674072, 0.4696734547615051, 1.6716363430023193, 2.6160006523132324, 1.6314362287521362, 0.9114402532577515, 2.7151412963867188, 0.6371852159500122, 1.4773399829864502, 2.569943428039551, 1.9913849830627441, 2.2135837078094482], "mean_td_error": 1.579256296157837, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 45.0, "diff_num_grad_updates_vs_sampler_policy": 44.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.077640533447266, "actor_loss": -5.780323028564453, "critic_loss": 0.2840995788574219, "alpha_loss": -0.13313306868076324, "alpha_value": 0.9868761301040649, "log_alpha_value": -0.013210738077759743, "target_entropy": -6.0, "policy_t": 0.007332071661949158, "mean_q": 1.7224706411361694, "max_q": 4.676677703857422, "min_q": 1.6591932773590088}, "td_error": [0.8276426792144775, 0.6297999620437622, 1.984900712966919, 1.292427659034729, 0.5819317102432251, 1.7765876054763794, 0.05739116668701172, 0.11208868026733398, 1.944098711013794, 1.700555682182312, 0.41348594427108765, 0.11617034673690796, 0.5861083269119263, 0.8714372515678406, 0.8270885944366455, 2.4121828079223633, 0.7987375259399414, 1.6497018337249756, 0.2913280129432678, 0.16514283418655396, 1.8323121070861816, 1.1465721130371094, 0.5368711948394775, 0.9810782074928284, 1.2520318031311035, 1.5093867778778076, 1.3559248447418213, 0.3199436664581299, 2.396414279937744, 0.6839592456817627, 1.2178094387054443, 0.36261123418807983, 0.03948301076889038, 0.6240295767784119, 0.8674659729003906, 0.7460092902183533, 1.8126263618469238, 0.7986446022987366, 1.723645806312561, 0.41997992992401123, 1.0633504390716553, 2.028615951538086, 1.1828935146331787, 1.7744026184082031, 1.0287326574325562, 0.4618825316429138, 1.3821234703063965, 0.2512948513031006, 0.3433374762535095, 0.055685997009277344, 1.029172420501709, 0.5821963548660278, 1.5054523944854736, 1.9227864742279053, 2.240741014480591, 3.3184428215026855, 1.6348130702972412, 1.166069746017456, 2.596975326538086, 1.0417606830596924, 2.307307243347168, 0.7194222211837769, 1.2452982664108276, 1.2892632484436035, 2.160027503967285, 0.8531182408332825, 0.26843059062957764, 1.7322697639465332, 1.5233659744262695, 2.1924867630004883, 0.29068928956985474, 1.0949101448059082, 0.4697685241699219, 0.9921185970306396, 1.5846998691558838, 0.44207316637039185, 1.021934986114502, 2.7600653171539307, 0.05390125513076782, 2.548945426940918, 1.413103461265564, 2.9537513256073, 2.04616379737854, 0.21136504411697388, 2.709296226501465, 3.127514362335205], "mean_td_error": 1.2126468420028687, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 45.0, "diff_num_grad_updates_vs_sampler_policy": 44.0}}, "num_env_steps_sampled": 41216, "num_env_steps_trained": 11610, "num_agent_steps_sampled": 123648, "num_agent_steps_trained": 11610, "last_target_update_ts": 41216, "num_target_updates": 45}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 123648, "num_agent_steps_trained": 11610, "num_env_steps_sampled": 41216, "num_env_steps_trained": 11610, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 822.9773373884038, "num_env_steps_trained_throughput_per_sec": 236.97338509621449, "timesteps_total": 41216, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 123648, "timers": {"training_iteration_time_ms": 1077.799, "sample_time_ms": 806.936, "load_time_ms": 0.32, "load_throughput": 806056.188, "learn_time_ms": 18.42, "learn_throughput": 14006.475, "synch_weights_time_ms": 10.754}, "counters": {"num_env_steps_sampled": 41216, "num_env_steps_trained": 11610, "num_agent_steps_sampled": 123648, "num_agent_steps_trained": 11610, "last_target_update_ts": 41216, "num_target_updates": 45}, "done": false, "episodes_total": 0, "training_iteration": 38, "trial_id": "95c7c_00000", "date": "2023-11-18_20-54-30", "timestamp": 1700369670, "time_this_iter_s": 1.0984830856323242, "time_total_s": 49.82101011276245, "pid": 5649, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16bd420c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 49.82101011276245, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 90.9, "ram_util_percent": 67.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.09182357788086, "actor_loss": -5.955876350402832, "critic_loss": 1.2545478343963623, "alpha_loss": -0.1363292932510376, "alpha_value": 0.9865819215774536, "log_alpha_value": -0.013508887030184269, "target_entropy": -6.0, "policy_t": 0.02799774520099163, "mean_q": 1.9934768676757812, "max_q": 11.304882049560547, "min_q": 1.818314552307129}, "td_error": [4.035056114196777, 0.32434284687042236, 2.170238971710205, 3.228930950164795, 1.4689170122146606, 3.5749073028564453, 1.1092376708984375, 1.5986696481704712, 4.890712738037109, 3.3920633792877197, 3.5811476707458496, 2.4687323570251465, 4.556174278259277, 3.3163509368896484, 2.6863651275634766, 2.7454090118408203, 0.4258298873901367, 2.3695154190063477, 3.4100236892700195, 3.34407377243042, 2.105417251586914, 1.7725379467010498, 2.4461498260498047, 2.158299207687378, 3.0403647422790527, 2.421762228012085, 3.164393424987793, 3.8570351600646973, 2.9304871559143066, 2.2834978103637695, 3.1121673583984375, 0.3537263870239258, 3.1286942958831787, 1.8636894226074219, 1.757053256034851, 2.0204710960388184, 4.356472969055176, 4.8210601806640625, 1.685018539428711, 2.66689395904541, 1.8066143989562988, 4.047809600830078, 3.3855466842651367, 2.0686423778533936, 3.650371551513672, 5.233887195587158, 0.5867016315460205, 1.936028242111206, 2.9548494815826416, 3.732447385787964, 4.135749340057373, 2.9574453830718994, 4.175461769104004, 2.454465866088867, 2.503084182739258, 2.274095058441162, 2.314915895462036, 3.852717876434326, 4.487691879272461, 2.5344347953796387, 1.9803249835968018, 3.0522961616516113, 3.1261701583862305, 3.44887113571167, 3.648036241531372, 2.319143056869507, 1.6519945859909058, 4.225125312805176, 3.4167990684509277, 1.5406187772750854, 3.4916863441467285, 2.4853453636169434, 1.2886894941329956, 3.5479934215545654, 1.6876468658447266, 3.045391798019409, 2.876657009124756, 2.15997052192688, 1.0766935348510742, 3.180786609649658, 1.084230661392212, 4.993669033050537, 4.808588027954102, 3.0152463912963867, 2.030663013458252, 3.4240684509277344], "mean_td_error": 2.7946693897247314, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 46.0, "diff_num_grad_updates_vs_sampler_policy": 45.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.123682975769043, "actor_loss": -5.6075029373168945, "critic_loss": 0.3387226462364197, "alpha_loss": -0.13678763806819916, "alpha_value": 0.9865792393684387, "log_alpha_value": -0.01351164747029543, "target_entropy": -6.0, "policy_t": 0.002978316508233547, "mean_q": 1.66392183303833, "max_q": 5.242337226867676, "min_q": 1.5740562677383423}, "td_error": [1.0494935512542725, 1.6090435981750488, 0.9656569957733154, 0.3637734651565552, 0.866753101348877, 0.6888722777366638, 0.23514503240585327, 1.285505771636963, 0.3309042453765869, 0.0802111029624939, 0.9900555610656738, 1.9400147199630737, 2.237234115600586, 1.9743543863296509, 2.7156002521514893, 1.7008987665176392, 2.430635929107666, 0.9638598561286926, 1.0193209648132324, 0.45759040117263794, 1.044732928276062, 1.0253373384475708, 1.4550368785858154, 1.005779504776001, 1.5745493173599243, 2.583261251449585, 2.057717800140381, 0.32269930839538574, 0.4979938268661499, 2.6215403079986572, 1.2896126508712769, 0.8097155094146729, 1.3444361686706543, 1.0445775985717773, 1.6113739013671875, 1.7748126983642578, 2.581456184387207, 0.29357725381851196, 0.3515968918800354, 0.30589592456817627, 3.025926113128662, 0.09870767593383789, 0.4568343758583069, 1.4608726501464844, 1.139503002166748, 1.9311821460723877, 0.7165613174438477, 0.5603089332580566, 0.5263671875, 1.154116153717041, 3.4484472274780273, 2.3100829124450684, 2.0273351669311523, 0.6394517421722412, 0.08169567584991455, 1.4066767692565918, 1.8715980052947998, 1.5039182901382446, 0.2522357702255249, 0.4245069622993469, 0.07970863580703735, 1.1756091117858887, 2.638782262802124, 2.161139965057373, 1.3941248655319214, 1.5627644062042236, 0.5134817361831665, 0.7597037553787231, 1.8849031925201416, 1.3623377084732056, 0.9551795125007629, 0.08714652061462402, 1.1781868934631348, 1.8277318477630615, 2.272324562072754, 3.373906135559082, 2.7274389266967773, 0.7007876038551331, 3.3978426456451416, 3.197072982788086, 2.3664097785949707, 0.16229230165481567, 3.437995433807373, 1.5193428993225098, 1.5883023738861084, 0.14637517929077148], "mean_td_error": 1.3605563640594482, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 46.0, "diff_num_grad_updates_vs_sampler_policy": 45.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.101314544677734, "actor_loss": -5.861821174621582, "critic_loss": 0.23818758130073547, "alpha_loss": -0.13647502660751343, "alpha_value": 0.9865802526473999, "log_alpha_value": -0.013510622084140778, "target_entropy": -6.0, "policy_t": 0.020615315064787865, "mean_q": 1.925256371498108, "max_q": 5.675316333770752, "min_q": 1.7305998802185059}, "td_error": [1.7728540897369385, 0.044907569885253906, 0.6109473705291748, 0.8441280126571655, 0.30446869134902954, 1.4712581634521484, 0.12749749422073364, 1.506589412689209, 1.968178629875183, 0.49809587001800537, 0.24019593000411987, 1.7806166410446167, 0.30628490447998047, 0.20460057258605957, 0.07859504222869873, 2.3185997009277344, 0.5525352954864502, 1.5424919128417969, 1.6146011352539062, 0.847527027130127, 2.7892374992370605, 1.4120665788650513, 0.6669935584068298, 0.6772000789642334, 1.994850754737854, 0.6818039417266846, 1.3959224224090576, 1.0365853309631348, 1.7198281288146973, 0.15109145641326904, 1.4669530391693115, 1.0635807514190674, 1.3817588090896606, 0.14736902713775635, 0.907248318195343, 0.16088742017745972, 0.06357979774475098, 1.1519955396652222, 1.0236321687698364, 1.3935490846633911, 0.34353435039520264, 1.3222068548202515, 2.712698459625244, 0.702203094959259, 0.9031171798706055, 0.25327128171920776, 0.11744087934494019, 0.7455341815948486, 1.186797857284546, 0.24703264236450195, 1.8918697834014893, 1.1464072465896606, 1.2246763706207275, 0.49206089973449707, 0.7234275341033936, 3.682722568511963, 1.3242075443267822, 0.055678606033325195, 0.535711407661438, 1.3046855926513672, 2.4293508529663086, 1.9163362979888916, 0.8398157358169556, 0.3725307583808899, 1.1075819730758667, 1.9796026945114136, 0.5322064161300659, 0.14356547594070435, 0.3989163041114807, 0.8175710439682007, 1.7388243675231934, 0.9369131326675415, 1.8039915561676025, 0.08873838186264038, 2.4214110374450684, 0.5401087403297424, 0.9847598671913147, 1.1555850505828857, 0.4113426208496094, 1.9417612552642822, 2.6841468811035156, 1.619593858718872, 1.6446075439453125, 2.1573843955993652, 0.25143176317214966, 0.34029465913772583], "mean_td_error": 1.0708693265914917, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 46.0, "diff_num_grad_updates_vs_sampler_policy": 45.0}}, "num_env_steps_sampled": 42112, "num_env_steps_trained": 11868, "num_agent_steps_sampled": 126336, "num_agent_steps_trained": 11868, "last_target_update_ts": 42112, "num_target_updates": 46}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 126336, "num_agent_steps_trained": 11868, "num_env_steps_sampled": 42112, "num_env_steps_trained": 11868, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 800.4338981664613, "num_env_steps_trained_throughput_per_sec": 230.48208228453908, "timesteps_total": 42112, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 126336, "timers": {"training_iteration_time_ms": 1084.573, "sample_time_ms": 810.115, "load_time_ms": 0.319, "load_throughput": 808585.842, "learn_time_ms": 18.529, "learn_throughput": 13924.022, "synch_weights_time_ms": 10.892}, "counters": {"num_env_steps_sampled": 42112, "num_env_steps_trained": 11868, "num_agent_steps_sampled": 126336, "num_agent_steps_trained": 11868, "last_target_update_ts": 42112, "num_target_updates": 46}, "done": false, "episodes_total": 0, "training_iteration": 39, "trial_id": "95c7c_00000", "date": "2023-11-18_20-54-31", "timestamp": 1700369671, "time_this_iter_s": 1.1272523403167725, "time_total_s": 50.948262453079224, "pid": 5649, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16bdf4cc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 50.948262453079224, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 72.75, "ram_util_percent": 67.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.061262130737305, "actor_loss": -5.999334812164307, "critic_loss": 1.1977355480194092, "alpha_loss": -0.1389344483613968, "alpha_value": 0.9862860441207886, "log_alpha_value": -0.013808848336338997, "target_entropy": -6.0, "policy_t": 0.011972879990935326, "mean_q": 2.282465696334839, "max_q": 12.43907356262207, "min_q": 1.9040436744689941}, "td_error": [3.6301112174987793, 1.7493722438812256, 2.637336015701294, 3.2245988845825195, 0.5359871983528137, 2.6625277996063232, 1.6356401443481445, 0.9928379058837891, 1.7118855714797974, 4.784074783325195, 3.23238205909729, 7.2180681228637695, 4.114893436431885, 2.978168249130249, 3.042360305786133, 2.885913372039795, 4.4061174392700195, 2.5893666744232178, 2.4427504539489746, 5.3212738037109375, 0.5551908016204834, 3.3591830730438232, 0.4087675213813782, 2.400867462158203, 4.633975982666016, 2.632969856262207, 0.9208603501319885, 3.084591865539551, 1.0592436790466309, 2.857672929763794, 0.8926713466644287, 4.708665370941162, 4.304880142211914, 2.0932369232177734, 1.0103939771652222, 2.2850193977355957, 2.458585739135742, 2.474113941192627, 3.3908560276031494, 1.305017113685608, 0.7437578439712524, 0.9410957098007202, 1.6197586059570312, 3.774418830871582, 1.9955135583877563, 3.4363207817077637, 2.420274257659912, 1.153799295425415, 2.662417411804199, 2.3463027477264404, 2.88226318359375, 1.7244937419891357, 4.037978172302246, 3.2889065742492676, 3.7631354331970215, 3.6696133613586426, 1.3600432872772217, 1.1841437816619873, 3.917311668395996, 2.579063653945923, 1.421311378479004, 2.7500810623168945, 2.5768070220947266, 2.7659335136413574, 3.4082539081573486, 2.292797088623047, 2.0299267768859863, 3.0167503356933594, 2.766401767730713, 2.624734401702881, 0.36275696754455566, 1.4204685688018799, 3.5729434490203857, 2.569319248199463, 2.870260238647461, 0.8402834534645081, 4.709671497344971, 1.772067666053772, 2.4989538192749023, 2.4460480213165283, 1.942084789276123, 2.397155284881592, 1.379549264907837, 5.079370975494385, 2.2606821060180664, 4.614333152770996], "mean_td_error": 2.610720634460449, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 47.0, "diff_num_grad_updates_vs_sampler_policy": 46.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.14925479888916, "actor_loss": -5.70292854309082, "critic_loss": 0.3305444121360779, "alpha_loss": -0.1401807963848114, "alpha_value": 0.986283004283905, "log_alpha_value": -0.013811931014060974, "target_entropy": -6.0, "policy_t": -0.015607569366693497, "mean_q": 1.7563705444335938, "max_q": 4.6815643310546875, "min_q": 1.6633037328720093}, "td_error": [1.9432382583618164, 1.0476062297821045, 1.487209439277649, 2.3996386528015137, 0.23934131860733032, 0.37952786684036255, 1.1091148853302002, 1.1724551916122437, 2.2306735515594482, 2.7078967094421387, 2.024118661880493, 0.8547599911689758, 0.7849001884460449, 0.9301469922065735, 0.35589975118637085, 2.716578245162964, 2.5828933715820312, 1.166736364364624, 0.8363548517227173, 2.622851848602295, 2.07371187210083, 2.1294808387756348, 0.9662147760391235, 1.707464575767517, 1.4830355644226074, 0.2670600414276123, 2.0683979988098145, 0.9483117461204529, 0.4094167947769165, 1.6532373428344727, 0.20983803272247314, 1.2910001277923584, 1.853698968887329, 1.269732117652893, 2.5721540451049805, 2.7005293369293213, 0.5877608060836792, 1.1679943799972534, 3.1585097312927246, 0.3502621650695801, 1.098790168762207, 0.7774226069450378, 0.3759775161743164, 1.2952572107315063, 2.2581300735473633, 0.28582555055618286, 1.9539718627929688, 0.7439677715301514, 0.7843459844589233, 0.08790868520736694, 2.2762887477874756, 2.7916243076324463, 0.8484408855438232, 1.7867929935455322, 2.1425743103027344, 0.2183694839477539, 2.1434504985809326, 0.557096540927887, 2.194180965423584, 1.8596904277801514, 1.5663161277770996, 1.9378373622894287, 0.6151456236839294, 1.2805103063583374, 2.0943398475646973, 1.7505505084991455, 1.2510573863983154, 1.2800695896148682, 3.775254964828491, 2.703582763671875, 1.4565210342407227, 0.3019394278526306, 1.1276216506958008, 0.08513563871383667, 0.0910537838935852, 0.8243269920349121, 1.315963625907898, 0.29106271266937256, 0.2393590807914734, 1.5531847476959229, 1.2672877311706543, 1.3068010807037354, 1.0729806423187256, 1.0482332706451416, 0.14748519659042358, 0.11952340602874756], "mean_td_error": 1.3423606157302856, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 47.0, "diff_num_grad_updates_vs_sampler_policy": 46.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.133047103881836, "actor_loss": -5.967116355895996, "critic_loss": 0.23500241339206696, "alpha_loss": -0.13994279503822327, "alpha_value": 0.9862843751907349, "log_alpha_value": -0.013810532167553902, "target_entropy": -6.0, "policy_t": 0.000793145620264113, "mean_q": 1.9809536933898926, "max_q": 6.121112823486328, "min_q": 1.8019620180130005}, "td_error": [0.7466262578964233, 0.35275799036026, 0.24420535564422607, 0.49403905868530273, 1.4361995458602905, 0.34100890159606934, 0.34917783737182617, 3.290705680847168, 2.6190993785858154, 0.5941213965415955, 0.308574378490448, 1.6560848951339722, 0.363231360912323, 1.8424673080444336, 0.7720575332641602, 0.6936032772064209, 0.3741897940635681, 0.36677980422973633, 2.1755664348602295, 1.006880760192871, 1.5241515636444092, 0.37609565258026123, 1.401482343673706, 0.5458287596702576, 2.1384847164154053, 2.171170234680176, 1.5053784847259521, 0.17367887496948242, 0.3870614767074585, 0.2601296901702881, 2.1129345893859863, 2.19443941116333, 1.056511402130127, 1.558523178100586, 0.6982495188713074, 1.188096284866333, 1.1341859102249146, 0.8587347865104675, 1.9886417388916016, 0.8911089897155762, 0.724966824054718, 1.0185811519622803, 1.2341485023498535, 1.1383236646652222, 1.7493896484375, 0.04229879379272461, 1.834273338317871, 2.9538540840148926, 1.0287038087844849, 1.5750646591186523, 2.3765876293182373, 0.8350310921669006, 0.9115000367164612, 0.2006428837776184, 1.225076675415039, 0.7427425384521484, 0.302201509475708, 1.5674443244934082, 1.6964731216430664, 0.8935332894325256, 1.220428705215454, 3.037644624710083, 0.5759159326553345, 0.12637245655059814, 1.0757179260253906, 0.4667130708694458, 0.774954080581665, 1.2911651134490967, 0.34185826778411865, 1.148578405380249, 0.3632248640060425, 1.4842053651809692, 0.7611013054847717, 0.04454076290130615, 1.5757520198822021, 0.6675191521644592, 0.5049479007720947, 1.6843912601470947, 0.8211533427238464, 0.23120641708374023, 1.2510045766830444, 1.3521517515182495, 0.49749910831451416, 0.3743266463279724, 2.3152825832366943, 2.441361904144287], "mean_td_error": 1.1008386611938477, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 47.0, "diff_num_grad_updates_vs_sampler_policy": 46.0}}, "num_env_steps_sampled": 43008, "num_env_steps_trained": 12126, "num_agent_steps_sampled": 129024, "num_agent_steps_trained": 12126, "last_target_update_ts": 43008, "num_target_updates": 47}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 129024, "num_agent_steps_trained": 12126, "num_env_steps_sampled": 43008, "num_env_steps_trained": 12126, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 740.0118942341792, "num_env_steps_trained_throughput_per_sec": 213.08378204510964, "timesteps_total": 43008, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 129024, "timers": {"training_iteration_time_ms": 1088.666, "sample_time_ms": 811.549, "load_time_ms": 0.319, "load_throughput": 807560.024, "learn_time_ms": 18.658, "learn_throughput": 13827.818, "synch_weights_time_ms": 11.269}, "counters": {"num_env_steps_sampled": 43008, "num_env_steps_trained": 12126, "num_agent_steps_sampled": 129024, "num_agent_steps_trained": 12126, "last_target_update_ts": 43008, "num_target_updates": 47}, "done": false, "episodes_total": 0, "training_iteration": 40, "trial_id": "95c7c_00000", "date": "2023-11-18_20-54-32", "timestamp": 1700369672, "time_this_iter_s": 1.2192339897155762, "time_total_s": 52.1674964427948, "pid": 5649, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16bd42520>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 52.1674964427948, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 69.25, "ram_util_percent": 67.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.091228485107422, "actor_loss": -6.115804195404053, "critic_loss": 1.2721800804138184, "alpha_loss": -0.14237460494041443, "alpha_value": 0.9859902858734131, "log_alpha_value": -0.014108747243881226, "target_entropy": -6.0, "policy_t": 0.021294692531228065, "mean_q": 2.5729589462280273, "max_q": 12.500288963317871, "min_q": 1.991443395614624}, "td_error": [4.526427268981934, 0.6265521049499512, 8.345902442932129, 1.6672208309173584, 1.1274478435516357, 3.2154369354248047, 2.321488857269287, 2.66446590423584, 3.2837703227996826, 3.137784004211426, 2.5954458713531494, 1.9743545055389404, 2.1718263626098633, 4.604708671569824, 1.78716242313385, 3.595099449157715, 2.5097200870513916, 2.652621030807495, 3.341136932373047, 2.4308834075927734, 1.5636329650878906, 5.341843128204346, 2.234919548034668, 2.890078544616699, 1.4099056720733643, 3.4949071407318115, 0.5185096859931946, 1.5353820323944092, 2.637369394302368, 1.8693126440048218, 4.631096839904785, 2.1861438751220703, 2.6914243698120117, 2.774333953857422, 3.974618673324585, 2.8078207969665527, 1.5846302509307861, 3.2318944931030273, 0.5779669284820557, 3.813720226287842, 4.03660249710083, 2.7195887565612793, 1.9697372913360596, 2.9428300857543945, 3.292104959487915, 2.2325782775878906, 4.670211315155029, 2.4638113975524902, 1.2725273370742798, 2.3122620582580566, 2.2218852043151855, 0.5787742137908936, 2.804386854171753, 1.311995267868042, 1.0400586128234863, 0.5306921005249023, 1.8620836734771729, 2.632267951965332, 4.833372116088867, 1.9149789810180664, 6.628389835357666, 2.5144760608673096, 1.7847412824630737, 3.986807107925415, 3.738802909851074, 1.6695027351379395, 1.0558850765228271, 2.755746841430664, 3.345118999481201, 3.252053737640381, 2.61859130859375, 2.5455269813537598, 2.631972312927246, 2.0018815994262695, 3.1542561054229736, 1.540677547454834, 1.5542961359024048, 4.674501419067383, 3.277543306350708, 3.83427095413208, 3.099555253982544, 2.6943562030792236, 2.457026243209839, 4.248324871063232, 3.231163263320923, 2.909849166870117], "mean_td_error": 2.734849452972412, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 48.0, "diff_num_grad_updates_vs_sampler_policy": 47.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.093734741210938, "actor_loss": -5.727875232696533, "critic_loss": 0.2885624170303345, "alpha_loss": -0.14244624972343445, "alpha_value": 0.9859867691993713, "log_alpha_value": -0.01411234401166439, "target_entropy": -6.0, "policy_t": 0.02349630743265152, "mean_q": 1.8627569675445557, "max_q": 6.121694564819336, "min_q": 1.7402276992797852}, "td_error": [1.2715942859649658, 0.6211268305778503, 1.6491484642028809, 2.762910842895508, 2.6375765800476074, 3.0856270790100098, 0.9587095379829407, 0.4817267656326294, 0.8122153878211975, 1.665169596672058, 0.30861783027648926, 0.8911579847335815, 0.876491904258728, 1.0638623237609863, 2.4600114822387695, 1.4045584201812744, 0.6582856178283691, 1.288750171661377, 0.5472829937934875, 1.5480173826217651, 1.13025963306427, 0.1438685655593872, 2.523733139038086, 1.9389278888702393, 0.7461504936218262, 1.3456735610961914, 0.987096905708313, 2.5629360675811768, 0.6710261106491089, 0.39724957942962646, 2.6566755771636963, 0.2565087080001831, 1.0978522300720215, 0.6714673638343811, 1.4107894897460938, 0.08845460414886475, 0.8189882636070251, 1.1356416940689087, 1.1315903663635254, 1.2303855419158936, 0.6377903819084167, 1.0242266654968262, 1.3280020952224731, 2.423198699951172, 0.09618467092514038, 0.34513962268829346, 1.774667501449585, 3.0295753479003906, 0.5354043245315552, 1.6244992017745972, 0.6330967545509338, 1.9303061962127686, 2.0306365489959717, 0.5860282182693481, 0.9431953430175781, 1.863539457321167, 0.08648431301116943, 2.7619643211364746, 0.9476193785667419, 0.08838915824890137, 0.8505825996398926, 0.9499911665916443, 0.09619903564453125, 1.2218971252441406, 1.9521986246109009, 1.10677170753479, 0.6680647134780884, 2.322129726409912, 1.0162856578826904, 1.620835781097412, 0.2659876346588135, 2.2771689891815186, 0.270715594291687, 0.5728474855422974, 1.8749258518218994, 2.5360798835754395, 0.1392955183982849, 0.33082419633865356, 2.815861701965332, 1.1824874877929688, 1.9095094203948975, 0.8111176490783691, 1.6506571769714355, 0.31415414810180664, 1.3175663948059082, 1.4791277647018433], "mean_td_error": 1.2346668243408203, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 48.0, "diff_num_grad_updates_vs_sampler_policy": 47.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.114883422851562, "actor_loss": -6.003757953643799, "critic_loss": 0.2242133915424347, "alpha_loss": -0.14272648096084595, "alpha_value": 0.9859885573387146, "log_alpha_value": -0.01411054003983736, "target_entropy": -6.0, "policy_t": 0.03014511801302433, "mean_q": 2.2305502891540527, "max_q": 6.033007621765137, "min_q": 1.8736770153045654}, "td_error": [1.823028326034546, 1.5584748983383179, 1.705386996269226, 1.0020604133605957, 0.07982242107391357, 0.6777576208114624, 1.2185173034667969, 1.577162265777588, 0.6410791873931885, 0.19382619857788086, 0.3133965730667114, 0.5191667079925537, 0.0667983889579773, 1.6490592956542969, 0.45778876543045044, 1.2490737438201904, 1.1470409631729126, 1.1536586284637451, 0.6148333549499512, 0.5045254826545715, 0.7518998384475708, 0.14149385690689087, 0.30209797620773315, 0.2721564769744873, 0.3121352195739746, 1.754878044128418, 1.4417977333068848, 0.7426098585128784, 2.532667875289917, 1.2724093198776245, 0.04774266481399536, 0.2403661012649536, 0.5349827408790588, 2.3207290172576904, 0.9336570501327515, 0.22960907220840454, 0.9174384474754333, 0.5905323624610901, 2.415010929107666, 0.6153312921524048, 2.80279278755188, 1.1543002128601074, 0.4520391821861267, 1.3013994693756104, 1.9366846084594727, 0.8196088075637817, 1.052268385887146, 1.709481120109558, 1.6116535663604736, 2.1924633979797363, 0.3008309602737427, 1.7703161239624023, 0.7666488289833069, 0.3974728584289551, 2.288630485534668, 0.15297657251358032, 1.800257921218872, 4.601949214935303, 0.04611098766326904, 0.6276387572288513, 0.34834301471710205, 0.07417774200439453, 2.7526803016662598, 0.12507683038711548, 1.15867018699646, 0.050732970237731934, 0.7206023931503296, 0.9551295042037964, 1.625580072402954, 0.35019075870513916, 2.2431998252868652, 0.044276416301727295, 0.6338118314743042, 0.10745644569396973, 0.8223116397857666, 1.9684553146362305, 2.6499569416046143, 0.18584507703781128, 1.2839789390563965, 0.05074167251586914, 0.1928703784942627, 0.8355523943901062, 0.8153259754180908, 0.2233736515045166, 0.5613396167755127, 0.45355093479156494], "mean_td_error": 0.994659960269928, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 48.0, "diff_num_grad_updates_vs_sampler_policy": 47.0}}, "num_env_steps_sampled": 43904, "num_env_steps_trained": 12384, "num_agent_steps_sampled": 131712, "num_agent_steps_trained": 12384, "last_target_update_ts": 43904, "num_target_updates": 48}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 131712, "num_agent_steps_trained": 12384, "num_env_steps_sampled": 43904, "num_env_steps_trained": 12384, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 814.7268803329584, "num_env_steps_trained_throughput_per_sec": 234.59769545301708, "timesteps_total": 43904, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 131712, "timers": {"training_iteration_time_ms": 1101.512, "sample_time_ms": 823.865, "load_time_ms": 0.318, "load_throughput": 811618.114, "learn_time_ms": 18.622, "learn_throughput": 13854.692, "synch_weights_time_ms": 11.342}, "counters": {"num_env_steps_sampled": 43904, "num_env_steps_trained": 12384, "num_agent_steps_sampled": 131712, "num_agent_steps_trained": 12384, "last_target_update_ts": 43904, "num_target_updates": 48}, "done": false, "episodes_total": 0, "training_iteration": 41, "trial_id": "95c7c_00000", "date": "2023-11-18_20-54-33", "timestamp": 1700369673, "time_this_iter_s": 1.1080358028411865, "time_total_s": 53.275532245635986, "pid": 5649, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16bdf5bc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 53.275532245635986, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 89.3, "ram_util_percent": 67.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.040523529052734, "actor_loss": -6.150720119476318, "critic_loss": 1.2006583213806152, "alpha_loss": -0.1446705311536789, "alpha_value": 0.9856946468353271, "log_alpha_value": -0.014408661052584648, "target_entropy": -6.0, "policy_t": -0.02735849842429161, "mean_q": 2.5667591094970703, "max_q": 12.511615753173828, "min_q": 2.0812582969665527}, "td_error": [1.1637203693389893, 2.1754636764526367, 2.7405498027801514, 2.8294191360473633, 2.525123357772827, 3.252431869506836, 1.7928414344787598, 6.1307902336120605, 4.063912391662598, 3.19940185546875, 0.6916747093200684, 1.730328917503357, 3.499678611755371, 1.8423303365707397, 3.4668431282043457, 2.89949107170105, 2.287755250930786, 1.929624080657959, 2.480379581451416, 2.974039077758789, 7.295884132385254, 3.609963893890381, 2.7175841331481934, 3.699496030807495, 1.3592830896377563, 1.8591301441192627, 2.9061408042907715, 1.2216413021087646, 1.9521193504333496, 3.7160391807556152, 3.5881147384643555, 2.624119758605957, 1.5516412258148193, 1.9244160652160645, 2.91995906829834, 2.0521888732910156, 3.793243408203125, 1.6018619537353516, 3.1930065155029297, 2.5008673667907715, 4.617000579833984, 3.7877626419067383, 2.803657054901123, 1.913155436515808, 0.7469472885131836, 3.0118308067321777, 1.6660422086715698, 2.654168128967285, 1.757673978805542, 1.3924169540405273, 3.7580018043518066, 2.8798675537109375, 1.8813254833221436, 3.2785983085632324, 3.1315665245056152, 2.550650119781494, 2.8087551593780518, 0.9467190504074097, 2.629016399383545, 1.9110585451126099, 1.4808591604232788, 2.79128360748291, 2.058112621307373, 2.2644100189208984, 0.9528924226760864, 3.7108569145202637, 3.938863754272461, 2.177724838256836, 2.953866720199585, 2.6687018871307373, 2.280571937561035, 0.0154191255569458, 2.0750489234924316, 1.8624756336212158, 3.0172863006591797, 3.5916223526000977, 1.4974181652069092, 2.6690258979797363, 2.9748144149780273, 9.236712455749512, 4.358219623565674, 1.8995583057403564, 1.4733829498291016, 3.0490646362304688, 1.8027740716934204, 2.1632070541381836], "mean_td_error": 2.6610798835754395, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 49.0, "diff_num_grad_updates_vs_sampler_policy": 48.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.178764343261719, "actor_loss": -5.874613285064697, "critic_loss": 0.2767457365989685, "alpha_loss": -0.14670386910438538, "alpha_value": 0.9856906533241272, "log_alpha_value": -0.014412740245461464, "target_entropy": -6.0, "policy_t": -0.0015398097457364202, "mean_q": 2.0524215698242188, "max_q": 6.044460773468018, "min_q": 1.8191373348236084}, "td_error": [1.9242794513702393, 2.176912784576416, 2.3013694286346436, 1.012498378753662, 0.9602310657501221, 1.144811749458313, 0.7467767000198364, 1.1176283359527588, 0.12605875730514526, 2.9078636169433594, 2.8873562812805176, 2.052034854888916, 0.5826716423034668, 0.661372184753418, 0.25177186727523804, 0.8576070666313171, 0.5723330974578857, 1.776911973953247, 1.111182689666748, 0.11290669441223145, 2.1776931285858154, 0.5017923712730408, 1.210001826286316, 0.13341468572616577, 1.930723786354065, 0.34616756439208984, 2.2845497131347656, 0.20985865592956543, 0.36632049083709717, 2.1328284740448, 1.8895913362503052, 0.09335505962371826, 0.33761441707611084, 1.4991505146026611, 0.7940595149993896, 2.419248580932617, 0.24094682931900024, 1.7638682126998901, 2.8841395378112793, 1.0988190174102783, 0.3505927324295044, 0.9761072993278503, 2.410224437713623, 0.09167987108230591, 0.3677259087562561, 1.827605962753296, 0.6524389386177063, 0.09300053119659424, 3.390260696411133, 3.514457941055298, 2.8456857204437256, 1.4841301441192627, 1.2076904773712158, 0.5368543863296509, 0.13310956954956055, 0.09643685817718506, 0.37161630392074585, 3.0192220211029053, 0.4061318039894104, 1.2853972911834717, 0.8437843322753906, 2.1010937690734863, 1.9563301801681519, 0.09129494428634644, 0.48783159255981445, 0.21788263320922852, 1.7672622203826904, 1.754846215248108, 0.6112435460090637, 2.223916530609131, 0.4072412848472595, 0.22512710094451904, 1.9774056673049927, 0.5484369397163391, 0.23009949922561646, 1.482190489768982, 2.023632049560547, 1.1629798412322998, 2.131946086883545, 1.2712980508804321, 0.360359787940979, 0.36324357986450195, 0.5705336332321167, 0.2432752251625061, 1.300429344177246, 1.0678811073303223], "mean_td_error": 1.1869843006134033, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 49.0, "diff_num_grad_updates_vs_sampler_policy": 48.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.068854331970215, "actor_loss": -6.0234246253967285, "critic_loss": 0.2557932734489441, "alpha_loss": -0.14509813487529755, "alpha_value": 0.9856927394866943, "log_alpha_value": -0.014410591684281826, "target_entropy": -6.0, "policy_t": 0.03479418531060219, "mean_q": 2.1236886978149414, "max_q": 5.395404815673828, "min_q": 1.9402825832366943}, "td_error": [2.1344704627990723, 0.07077175378799438, 0.401491641998291, 2.3029603958129883, 0.9488980770111084, 2.3126537799835205, 1.6609687805175781, 0.7900364398956299, 1.5038284063339233, 2.2973687648773193, 1.9973845481872559, 0.7397118806838989, 1.0501437187194824, 0.35431790351867676, 0.6087087988853455, 1.0660113096237183, 1.323331356048584, 1.1891475915908813, 1.0675380229949951, 0.550102949142456, 1.350920557975769, 2.1953563690185547, 0.8115276098251343, 1.5219621658325195, 1.0364762544631958, 1.9857947826385498, 1.3160983324050903, 0.7371773719787598, 1.5904078483581543, 0.5178558826446533, 1.1911990642547607, 1.2767168283462524, 1.642633318901062, 1.0478349924087524, 1.7817894220352173, 0.04650259017944336, 1.8860893249511719, 0.8806698322296143, 0.6938610076904297, 1.267085313796997, 1.4713904857635498, 2.0258471965789795, 1.0316641330718994, 0.15382564067840576, 2.5900673866271973, 1.562727451324463, 0.709338903427124, 1.5931216478347778, 0.3091990351676941, 0.32396936416625977, 0.08205938339233398, 0.22750544548034668, 0.5741103887557983, 1.0121526718139648, 1.3798950910568237, 2.5983872413635254, 0.35722285509109497, 0.35207056999206543, 0.6809303164482117, 0.49223434925079346, 0.43912839889526367, 0.9358998537063599, 0.8064802289009094, 0.5720748901367188, 0.8266260027885437, 0.04797166585922241, 0.1973298192024231, 0.048415184020996094, 0.7182778716087341, 0.6358634829521179, 1.1263996362686157, 2.902698040008545, 0.748202919960022, 1.8925634622573853, 0.5912103652954102, 0.37511932849884033, 1.2470084428787231, 2.3348307609558105, 2.987362861633301, 2.628357410430908, 2.574126958847046, 0.7502429485321045, 2.223989963531494, 0.27164995670318604, 1.3454806804656982, 0.7871987819671631], "mean_td_error": 1.1475584506988525, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 49.0, "diff_num_grad_updates_vs_sampler_policy": 48.0}}, "num_env_steps_sampled": 44800, "num_env_steps_trained": 12642, "num_agent_steps_sampled": 134400, "num_agent_steps_trained": 12642, "last_target_update_ts": 44800, "num_target_updates": 49}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 134400, "num_agent_steps_trained": 12642, "num_env_steps_sampled": 44800, "num_env_steps_trained": 12642, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 870.1232806649813, "num_env_steps_trained_throughput_per_sec": 250.54889108433613, "timesteps_total": 44800, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 134400, "timers": {"training_iteration_time_ms": 1100.013, "sample_time_ms": 822.731, "load_time_ms": 0.319, "load_throughput": 809553.701, "learn_time_ms": 18.673, "learn_throughput": 13816.73, "synch_weights_time_ms": 11.037}, "counters": {"num_env_steps_sampled": 44800, "num_env_steps_trained": 12642, "num_agent_steps_sampled": 134400, "num_agent_steps_trained": 12642, "last_target_update_ts": 44800, "num_target_updates": 49}, "done": false, "episodes_total": 0, "training_iteration": 42, "trial_id": "95c7c_00000", "date": "2023-11-18_20-54-34", "timestamp": 1700369674, "time_this_iter_s": 1.0401642322540283, "time_total_s": 54.315696477890015, "pid": 5649, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16bdf63e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 54.315696477890015, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 70.6, "ram_util_percent": 67.25}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.125202178955078, "actor_loss": -6.324276447296143, "critic_loss": 0.7015305757522583, "alpha_loss": -0.14892621338367462, "alpha_value": 0.9853991866111755, "log_alpha_value": -0.01470846775919199, "target_entropy": -6.0, "policy_t": -0.015093722380697727, "mean_q": 2.6954987049102783, "max_q": 12.51230525970459, "min_q": 2.173384666442871}, "td_error": [2.4750137329101562, 3.995960235595703, 3.912513256072998, 3.204472064971924, 3.392402172088623, 3.608741283416748, 2.4992291927337646, 4.144999027252197, 1.7404309511184692, 2.7341256141662598, 2.5259408950805664, 3.346663475036621, 2.460970878601074, 2.5996031761169434, 3.2178001403808594, 3.598550319671631, 2.3091516494750977, 2.745814323425293, 1.733567714691162, 3.0186963081359863, 2.842621326446533, 1.5112940073013306, 1.6009678840637207, 2.5902962684631348, 1.4252800941467285, 2.4111342430114746, 3.068495273590088, 3.064159393310547, 2.2446112632751465, 2.4380011558532715, 2.851886749267578, 1.682915210723877, 1.846876859664917, 2.25821852684021, 0.15465450286865234, 3.525839328765869, 0.21837913990020752, 2.245251178741455, 1.8240396976470947, 2.7196619510650635, 0.633074164390564, 0.49648797512054443, 1.5491670370101929, 3.1213088035583496, 1.5449867248535156, 5.23060417175293, 2.4240126609802246, 1.9300411939620972, 7.248266220092773, 2.6531331539154053, 1.6076406240463257, 1.6801166534423828, 2.27146577835083, 4.680814743041992, 3.1275625228881836, 4.184230327606201, 0.5703449249267578, 1.3608932495117188, 1.9021011590957642, 1.9294929504394531, 6.780117034912109, 3.3017382621765137, 1.8283302783966064, 3.0472841262817383, 2.9413070678710938, 0.9755048751831055, 2.346426010131836, 2.6921987533569336, 3.0786054134368896, 2.5003669261932373, 2.2663629055023193, 3.3188090324401855, 2.607362985610962, 1.573890209197998, 2.7949061393737793, 1.042635202407837, 2.0722804069519043, 0.9022725820541382, 4.212757587432861, 2.0803346633911133, 1.5962423086166382, 2.566326856613159, 2.3624496459960938, 2.5040860176086426, 1.5504719018936157, 3.1582469940185547], "mean_td_error": 2.5353057384490967, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 50.0, "diff_num_grad_updates_vs_sampler_policy": 49.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.067110061645508, "actor_loss": -5.8659892082214355, "critic_loss": 0.31697878241539, "alpha_loss": -0.14812064170837402, "alpha_value": 0.9853943586349487, "log_alpha_value": -0.01471332274377346, "target_entropy": -6.0, "policy_t": -0.0793856680393219, "mean_q": 2.127143621444702, "max_q": 5.936688423156738, "min_q": 1.7696878910064697}, "td_error": [1.190237283706665, 0.18119633197784424, 1.5978455543518066, 0.11735928058624268, 2.9695749282836914, 0.09347367286682129, 2.3782382011413574, 2.52571964263916, 0.5523333549499512, 1.7208189964294434, 1.7857552766799927, 0.9660278558731079, 2.3544206619262695, 1.0132479667663574, 1.2028241157531738, 0.703558623790741, 0.4423072934150696, 1.2763502597808838, 1.4160187244415283, 1.2708868980407715, 1.4580670595169067, 2.199077606201172, 0.21255964040756226, 2.123234748840332, 0.982549786567688, 1.3218169212341309, 0.13439178466796875, 2.543881416320801, 1.3619558811187744, 2.577284574508667, 0.9039185047149658, 0.45202988386154175, 2.047569751739502, 1.3352454900741577, 0.5141603946685791, 0.7485038042068481, 2.5539581775665283, 1.8316364288330078, 0.09612423181533813, 0.7093023061752319, 1.2450847625732422, 0.5491061210632324, 1.9052212238311768, 1.8848485946655273, 0.0925707221031189, 0.5208901762962341, 3.1222996711730957, 2.13859486579895, 0.9411253929138184, 1.3365596532821655, 0.2420160174369812, 0.998051643371582, 1.3685734272003174, 3.459327220916748, 0.12787222862243652, 1.1199541091918945, 0.42830049991607666, 1.956648826599121, 4.279335021972656, 2.202103853225708, 0.5612848997116089, 2.2014999389648438, 0.25397610664367676, 2.6554503440856934, 1.1171345710754395, 1.073850154876709, 2.315399408340454, 0.1484355330467224, 0.6401888132095337, 1.5621366500854492, 1.330810785293579, 1.0892713069915771, 0.5443835258483887, 2.892601728439331, 2.9997944831848145, 0.14139103889465332, 0.11411714553833008, 0.09303712844848633, 1.2304720878601074, 0.17680436372756958, 2.319636821746826, 0.889755368232727, 3.824096441268921, 0.09993892908096313, 1.59040367603302, 0.09257495403289795], "mean_td_error": 1.3225860595703125, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 50.0, "diff_num_grad_updates_vs_sampler_policy": 49.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.08768081665039, "actor_loss": -6.1402907371521, "critic_loss": 0.22497987747192383, "alpha_loss": -0.1483955681324005, "alpha_value": 0.9853971004486084, "log_alpha_value": -0.014710572548210621, "target_entropy": -6.0, "policy_t": 0.0012045985786244273, "mean_q": 2.124577045440674, "max_q": 5.707268238067627, "min_q": 2.0071847438812256}, "td_error": [0.9931849241256714, 0.7130317687988281, 1.6482179164886475, 0.8482856750488281, 1.2389112710952759, 1.2573471069335938, 1.3977558612823486, 0.8309075832366943, 0.049378156661987305, 0.5506198406219482, 0.9043412208557129, 0.33475279808044434, 0.04940235614776611, 0.28813493251800537, 1.5017188787460327, 1.3874115943908691, 0.5355340242385864, 0.051671624183654785, 1.1600887775421143, 1.7835726737976074, 1.0932705402374268, 0.14032721519470215, 1.045593023300171, 1.8337700366973877, 0.49952220916748047, 1.4284799098968506, 1.6404187679290771, 0.05031847953796387, 0.5372569561004639, 0.6393337249755859, 1.1000229120254517, 0.31203675270080566, 2.446267604827881, 1.5349071025848389, 2.1325671672821045, 1.7576278448104858, 1.1043596267700195, 0.2644932270050049, 0.05017507076263428, 0.8222204446792603, 1.2476797103881836, 0.6108136177062988, 0.7614096403121948, 2.100069761276245, 1.1376731395721436, 1.697147250175476, 2.605112075805664, 0.22383904457092285, 0.7795944213867188, 1.4120134115219116, 0.8319393396377563, 2.593810558319092, 1.0113495588302612, 2.5661582946777344, 1.3034857511520386, 0.6808338165283203, 0.04982125759124756, 1.4792312383651733, 0.41002869606018066, 0.713090181350708, 0.1023033857345581, 2.2890963554382324, 1.7987136840820312, 0.4641517400741577, 0.1065828800201416, 1.4746623039245605, 0.42267751693725586, 0.6805671453475952, 1.0575560331344604, 0.24360132217407227, 0.704269289970398, 0.3811894655227661, 1.9009003639221191, 0.8225743770599365, 1.167703628540039, 0.3589590787887573, 0.5942970514297485, 0.5313209295272827, 2.3231897354125977, 1.3047994375228882, 3.6774234771728516, 0.45956432819366455, 1.8044475317001343, 0.8823626041412354, 0.06981527805328369, 0.7596151828765869], "mean_td_error": 1.02970552444458, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 50.0, "diff_num_grad_updates_vs_sampler_policy": 49.0}}, "num_env_steps_sampled": 45696, "num_env_steps_trained": 12900, "num_agent_steps_sampled": 137088, "num_agent_steps_trained": 12900, "last_target_update_ts": 45696, "num_target_updates": 50}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 137088, "num_agent_steps_trained": 12900, "num_env_steps_sampled": 45696, "num_env_steps_trained": 12900, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 691.6121057355405, "num_env_steps_trained_throughput_per_sec": 199.1472358033141, "timesteps_total": 45696, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 137088, "timers": {"training_iteration_time_ms": 1121.022, "sample_time_ms": 814.617, "load_time_ms": 0.321, "load_throughput": 803721.355, "learn_time_ms": 18.726, "learn_throughput": 13777.291, "synch_weights_time_ms": 11.095}, "counters": {"num_env_steps_sampled": 45696, "num_env_steps_trained": 12900, "num_agent_steps_sampled": 137088, "num_agent_steps_trained": 12900, "last_target_update_ts": 45696, "num_target_updates": 50}, "done": false, "episodes_total": 0, "training_iteration": 43, "trial_id": "95c7c_00000", "date": "2023-11-18_20-54-36", "timestamp": 1700369676, "time_this_iter_s": 1.3044538497924805, "time_total_s": 55.620150327682495, "pid": 5649, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16bdf6980>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 55.620150327682495, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 59.349999999999994, "ram_util_percent": 67.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.089641571044922, "actor_loss": -6.394098281860352, "critic_loss": 0.6832423210144043, "alpha_loss": -0.1514291912317276, "alpha_value": 0.9851036667823792, "log_alpha_value": -0.015008381567895412, "target_entropy": -6.0, "policy_t": 0.018172351643443108, "mean_q": 2.525273084640503, "max_q": 12.470977783203125, "min_q": 2.264049530029297}, "td_error": [1.0826362371444702, 4.145752906799316, 0.08354425430297852, 2.9394519329071045, 3.603642702102661, 6.29970645904541, 4.2030534744262695, 1.958932876586914, 2.2361998558044434, 1.7853026390075684, 4.815024375915527, 0.7833559513092041, 2.2053067684173584, 2.442225456237793, 3.346050262451172, 1.6162025928497314, 2.9867372512817383, 0.9770476818084717, 2.1867563724517822, 2.2950172424316406, 2.995716094970703, 1.5944082736968994, 3.6590428352355957, 1.9797489643096924, 2.9293534755706787, 0.9900052547454834, 2.186328411102295, 1.0241436958312988, 3.705695390701294, 2.0031845569610596, 0.48777735233306885, 3.015488624572754, 2.732074737548828, 0.7958481311798096, 2.839637517929077, 3.12618088722229, 1.861732840538025, 3.1672134399414062, 2.6212892532348633, 1.3910528421401978, 4.0192766189575195, 3.1108109951019287, 2.7184038162231445, 2.2817444801330566, 2.7513632774353027, 1.6576638221740723, 2.2125160694122314, 2.2462971210479736, 3.1139466762542725, 1.513630747795105, 3.427370071411133, 2.1351194381713867, 1.5578244924545288, 1.6433597803115845, 1.1048165559768677, 3.6410727500915527, 2.2204267978668213, 4.807871341705322, 2.461836099624634, 3.416640520095825, 2.472198486328125, 2.11761736869812, 2.1699070930480957, 2.2637641429901123, 2.788058280944824, 1.0874454975128174, 1.2965788841247559, 0.9342478513717651, 6.1386494636535645, 3.215585470199585, 3.123326301574707, 0.9042274951934814, 4.1430253982543945, 2.1471071243286133, 1.8001599311828613, 2.5315093994140625, 2.3285610675811768, 1.5180364847183228, 0.5513674020767212, 3.330035448074341, 0.16095507144927979, 2.692831039428711, 0.8849060535430908, 1.5876970291137695, 2.7013847827911377, 2.2560606002807617], "mean_td_error": 2.3986639976501465, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 51.0, "diff_num_grad_updates_vs_sampler_policy": 50.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.151927947998047, "actor_loss": -6.000838756561279, "critic_loss": 0.2792014181613922, "alpha_loss": -0.15241903066635132, "alpha_value": 0.9850983619689941, "log_alpha_value": -0.01501380279660225, "target_entropy": -6.0, "policy_t": -0.020032338798046112, "mean_q": 2.207038402557373, "max_q": 5.3478569984436035, "min_q": 1.8153555393218994}, "td_error": [1.7824430465698242, 0.7279251217842102, 1.9428919553756714, 0.9307012557983398, 1.5656853914260864, 0.2233109474182129, 0.11818981170654297, 3.5728466510772705, 0.09651827812194824, 2.0994672775268555, 1.195021152496338, 1.9534934759140015, 1.8637789487838745, 0.8345911502838135, 2.7685837745666504, 0.7945374846458435, 1.7465198040008545, 2.556736946105957, 1.4584155082702637, 0.8333526849746704, 0.15458452701568604, 0.3726062774658203, 0.8710188865661621, 0.5724811553955078, 1.1624008417129517, 1.5581603050231934, 2.853682279586792, 0.26549017429351807, 0.22623991966247559, 1.3571869134902954, 0.19541996717453003, 1.9809718132019043, 0.7837534546852112, 0.18457704782485962, 1.4939053058624268, 1.3510777950286865, 0.6254112124443054, 0.4731851816177368, 0.984809160232544, 1.526519536972046, 1.3055462837219238, 0.8788592219352722, 1.857376217842102, 2.123981237411499, 0.5600430369377136, 0.09495311975479126, 0.11175239086151123, 0.8049752116203308, 1.4605114459991455, 0.3976508378982544, 1.7629601955413818, 2.3494763374328613, 0.542464554309845, 0.5636329650878906, 0.09501463174819946, 0.9748804569244385, 0.5368648767471313, 0.8694592714309692, 1.9552147388458252, 0.6705496311187744, 2.1577811241149902, 0.18806642293930054, 0.4778625965118408, 1.194495439529419, 1.8086230754852295, 0.8458061218261719, 0.5432416200637817, 1.4496147632598877, 0.9584301710128784, 0.5826124548912048, 1.308643102645874, 1.518205165863037, 0.3907288908958435, 3.8662824630737305, 3.4395711421966553, 0.5484200119972229, 0.6021872162818909, 2.5674781799316406, 0.8322245478630066, 0.13724184036254883, 1.1819590330123901, 1.6533331871032715, 1.1132850646972656, 2.847130298614502, 0.3040722608566284, 0.5570448040962219], "mean_td_error": 1.1749883890151978, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 51.0, "diff_num_grad_updates_vs_sampler_policy": 50.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.04766845703125, "actor_loss": -6.187192916870117, "critic_loss": 0.18447759747505188, "alpha_loss": -0.15082088112831116, "alpha_value": 0.985101580619812, "log_alpha_value": -0.015010536648333073, "target_entropy": -6.0, "policy_t": -0.02835894003510475, "mean_q": 2.1424148082733154, "max_q": 4.6436767578125, "min_q": 1.8428423404693604}, "td_error": [0.4883817434310913, 1.035723328590393, 0.6446100473403931, 0.5658535957336426, 0.09877312183380127, 0.8600966930389404, 0.29428255558013916, 0.7832274436950684, 1.1009942293167114, 0.5214927196502686, 0.3076843023300171, 0.8283383846282959, 1.5145587921142578, 0.9006808996200562, 0.5443926453590393, 0.15348994731903076, 0.9588236808776855, 1.7129312753677368, 1.2333966493606567, 1.3529599905014038, 1.5200344324111938, 0.36052024364471436, 0.5213004350662231, 0.134873628616333, 1.7170838117599487, 3.1378567218780518, 0.46210741996765137, 1.0916956663131714, 1.2843849658966064, 0.28420019149780273, 0.9014264345169067, 0.21602213382720947, 0.8381565809249878, 0.8751039505004883, 0.19983112812042236, 1.8542382717132568, 0.7059372663497925, 1.589829683303833, 1.7925812005996704, 1.2958241701126099, 2.180271625518799, 1.1902061700820923, 0.40487563610076904, 3.6362433433532715, 1.7390410900115967, 0.9889523983001709, 0.46103787422180176, 0.1393054723739624, 1.5295977592468262, 1.5226430892944336, 0.057385802268981934, 2.106363534927368, 0.6311044692993164, 1.9175220727920532, 0.2981613874435425, 0.39526593685150146, 0.6108812093734741, 0.8091378211975098, 0.19322633743286133, 0.61165452003479, 2.44303035736084, 0.27705860137939453, 0.7142429351806641, 0.525524377822876, 2.150006055831909, 0.48605549335479736, 2.770350694656372, 0.94020676612854, 0.31380319595336914, 0.7077367305755615, 0.4702647924423218, 1.6193722486495972, 0.4418184757232666, 0.2000030279159546, 0.33593106269836426, 0.4243483543395996, 0.05926513671875, 0.07522010803222656, 1.3643959760665894, 0.7659621238708496, 1.1816680431365967, 0.22787189483642578, 0.6977726221084595, 1.363979697227478, 0.45647239685058594, 0.1726975440979004], "mean_td_error": 0.9219957590103149, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 51.0, "diff_num_grad_updates_vs_sampler_policy": 50.0}}, "num_env_steps_sampled": 46592, "num_env_steps_trained": 13158, "num_agent_steps_sampled": 139776, "num_agent_steps_trained": 13158, "last_target_update_ts": 46592, "num_target_updates": 51}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 139776, "num_agent_steps_trained": 13158, "num_env_steps_sampled": 46592, "num_env_steps_trained": 13158, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 815.8902123908791, "num_env_steps_trained_throughput_per_sec": 234.93267276433795, "timesteps_total": 46592, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 139776, "timers": {"training_iteration_time_ms": 1132.007, "sample_time_ms": 825.154, "load_time_ms": 0.32, "load_throughput": 805936.123, "learn_time_ms": 18.576, "learn_throughput": 13888.549, "synch_weights_time_ms": 10.987}, "counters": {"num_env_steps_sampled": 46592, "num_env_steps_trained": 13158, "num_agent_steps_sampled": 139776, "num_agent_steps_trained": 13158, "last_target_update_ts": 46592, "num_target_updates": 51}, "done": false, "episodes_total": 0, "training_iteration": 44, "trial_id": "95c7c_00000", "date": "2023-11-18_20-54-37", "timestamp": 1700369677, "time_this_iter_s": 1.1093571186065674, "time_total_s": 56.72950744628906, "pid": 5649, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16bdf5f80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 56.72950744628906, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 90.5, "ram_util_percent": 67.0}}
