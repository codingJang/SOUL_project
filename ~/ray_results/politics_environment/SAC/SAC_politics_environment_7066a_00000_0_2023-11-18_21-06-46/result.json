{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 896, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2688, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2688, "num_agent_steps_trained": 0, "num_env_steps_sampled": 896, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 771.1851699847163, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 896, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2688, "timers": {"training_iteration_time_ms": 1161.823, "sample_time_ms": 554.813}, "counters": {"num_env_steps_sampled": 896, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2688, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 1, "trial_id": "7066a_00000", "date": "2023-11-18_21-06-56", "timestamp": 1700370416, "time_this_iter_s": 1.1644718647003174, "time_total_s": 1.1644718647003174, "pid": 7187, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x31039e660>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 1.1644718647003174, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 37.3, "ram_util_percent": 64.75}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.962129592895508, "actor_loss": -3.971541404724121, "critic_loss": 4.07787561416626, "alpha_loss": -0.002988638589158654, "alpha_value": 0.9997000694274902, "log_alpha_value": -0.00029999998514540493, "target_entropy": -6.0, "policy_t": -0.0024315437767654657, "mean_q": 0.0141771100461483, "max_q": 0.120955690741539, "min_q": 0.00898316502571106}, "td_error": [3.8396971225738525, 4.171543598175049, 5.289741516113281, 3.64554762840271, 3.268326997756958, 5.20505428314209, 3.668304443359375, 3.025068998336792, 4.208470821380615, 5.864114761352539, 4.543537616729736, 4.990632057189941, 5.3881072998046875, 5.023879051208496, 4.365830898284912, 3.9606661796569824, 4.748971939086914, 5.713850021362305, 6.046505928039551, 3.3304452896118164, 3.3977019786834717, 5.023559093475342, 2.7395997047424316, 4.398979187011719, 3.618431568145752, 6.472537517547607, 5.378310203552246, 5.270953178405762, 3.980846881866455, 3.2523739337921143, 5.379071235656738, 5.61628532409668, 5.707067489624023, 4.573544502258301, 5.709346294403076, 6.534712791442871, 4.075718879699707, 7.033880233764648, 4.452470779418945, 6.579795837402344, 3.5704588890075684, 5.597116947174072, 5.724605083465576, 5.195784091949463, 4.292572021484375, 4.693319320678711, 4.500796318054199, 5.660110950469971, 3.2157528400421143, 4.504426002502441, 3.804290771484375, 3.6498780250549316, 3.6303412914276123, 6.354972839355469, 5.191557884216309, 5.205809593200684, 3.9748034477233887, 4.025674343109131, 5.712576866149902, 5.880331039428711, 3.9800593852996826, 5.301825523376465, 6.484764099121094, 4.070663928985596, 2.7314391136169434, 3.7160305976867676, 4.437018871307373, 5.261180877685547, 4.647461891174316, 6.432255744934082, 2.700320243835449, 2.5035924911499023, 3.5001935958862305, 5.8616743087768555, 5.2479047775268555, 4.913722038269043, 4.094223976135254, 3.3920533657073975, 6.464317321777344, 6.844330310821533, 4.453252792358398, 5.069147109985352, 6.23312520980835, 5.616632461547852, 4.982046127319336, 3.57741641998291], "mean_td_error": 4.725526809692383, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 2.0, "diff_num_grad_updates_vs_sampler_policy": 1.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.933462142944336, "actor_loss": -3.9413061141967773, "critic_loss": 1.8928589820861816, "alpha_loss": -0.0029800385236740112, "alpha_value": 0.9997000694274902, "log_alpha_value": -0.00029999998514540493, "target_entropy": -6.0, "policy_t": 0.00802621804177761, "mean_q": 0.012274248525500298, "max_q": 0.10413086414337158, "min_q": 0.007395112421363592}, "td_error": [2.188772678375244, 3.053624153137207, 3.3466098308563232, 2.4150052070617676, 2.5764636993408203, 2.121394157409668, 1.5047099590301514, 2.028182029724121, 3.2909345626831055, 2.728071689605713, 1.9741191864013672, 1.86692214012146, 1.9647871255874634, 3.100581407546997, 3.2210488319396973, 2.650517225265503, 2.875110626220703, 2.975499153137207, 1.6860307455062866, 2.302311420440674, 2.924222946166992, 3.234182357788086, 3.5170164108276367, 3.130718946456909, 3.28131365776062, 1.1062753200531006, 1.5394883155822754, 4.896548271179199, 2.6760506629943848, 2.381753444671631, 3.091256856918335, 3.7405195236206055, 1.8868882656097412, 3.902693748474121, 0.614355206489563, 2.93774676322937, 3.2977395057678223, 2.31929874420166, 3.78523588180542, 2.6039986610412598, 2.01065993309021, 2.4655470848083496, 3.578899383544922, 2.0601565837860107, 2.367785930633545, 2.8855886459350586, 2.4735536575317383, 0.5139282941818237, 2.655581474304199, 0.8803707361221313, 1.6227612495422363, 3.6261067390441895, 3.658560276031494, 1.2839062213897705, 4.7939863204956055, 4.145260334014893, 2.53885555267334, 5.703319549560547, 1.4664855003356934, 2.3845062255859375, 2.207063674926758, 3.050062656402588, 3.971426486968994, 3.585728645324707, 3.1171607971191406, 2.1997714042663574, 2.1288528442382812, 3.3879904747009277, 1.773116111755371, 3.1477818489074707, 1.669432520866394, 1.040217399597168, 1.5528442859649658, 2.6623449325561523, 3.9530200958251953, 3.3953912258148193, 3.9477224349975586, 1.306577205657959, 2.308572769165039, 2.773969888687134, 4.842233657836914, 2.2121329307556152, 6.042794227600098, 3.9001898765563965, 2.3229613304138184, 2.2823755741119385], "mean_td_error": 2.728320360183716, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 2.0, "diff_num_grad_updates_vs_sampler_policy": 1.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.939355850219727, "actor_loss": -3.9491422176361084, "critic_loss": 1.1233384609222412, "alpha_loss": -0.0029818061739206314, "alpha_value": 0.9997000694274902, "log_alpha_value": -0.00029999998514540493, "target_entropy": -6.0, "policy_t": -0.039268895983695984, "mean_q": 0.019237956032156944, "max_q": 0.1444142609834671, "min_q": 0.011939223855733871}, "td_error": [5.456707000732422, 3.351027488708496, 1.7908499240875244, 3.3811745643615723, 2.804485321044922, 3.198655128479004, 1.8940008878707886, 2.8070857524871826, 4.843233108520508, 1.7062878608703613, 0.43171238899230957, 2.26222562789917, 3.2998809814453125, 2.200404167175293, 4.639664649963379, 4.808982849121094, 3.50893497467041, 2.992079257965088, 3.5654168128967285, 4.125182151794434, 4.13255500793457, 3.5285539627075195, 2.273066520690918, 3.3143129348754883, 4.25261116027832, 2.4762725830078125, 4.088477611541748, 2.050938129425049, 2.1054482460021973, 3.5394132137298584, 3.174008846282959, 3.2624340057373047, 4.423561096191406, 2.2442851066589355, 4.356804370880127, 2.168830156326294, 3.0154125690460205, 2.028217315673828, 1.9703776836395264, 1.8307186365127563, 4.042695045471191, 2.697446823120117, 3.330155372619629, 3.1130833625793457, 2.2793402671813965, 2.5215096473693848, 1.2477163076400757, 0.4646843373775482, 1.8286445140838623, 5.380563735961914, 5.449380874633789, 4.8252716064453125, 2.1467514038085938, 2.501945972442627, 2.575838565826416, 2.751469850540161, 5.202332019805908, 1.4085049629211426, 2.0528061389923096, 1.830458164215088, 2.19783616065979, 1.0692968368530273, 2.6352100372314453, 1.1775959730148315, 4.545635223388672, 2.6164145469665527, 1.5818077325820923, 2.504258632659912, 3.385563373565674, 1.1913044452667236, 3.505297899246216, 0.5041689276695251, 1.4151043891906738, 3.6212637424468994, 2.288440227508545, 2.8241684436798096, 1.9564189910888672, 2.2023158073425293, 3.9732136726379395, 2.4563255310058594, 1.7813825607299805, 1.8470534086227417, 4.931302070617676, 3.6368298530578613, 1.7515254020690918, 2.5546698570251465], "mean_td_error": 2.8501081466674805, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 2.0, "diff_num_grad_updates_vs_sampler_policy": 1.0}}, "num_env_steps_sampled": 2688, "num_env_steps_trained": 516, "num_agent_steps_sampled": 8064, "num_agent_steps_trained": 516, "last_target_update_ts": 2688, "num_target_updates": 2}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8064, "num_agent_steps_trained": 516, "num_env_steps_sampled": 2688, "num_env_steps_trained": 516, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 1048.2260551130182, "num_env_steps_trained_throughput_per_sec": 301.83294890531107, "timesteps_total": 2688, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 8064, "timers": {"training_iteration_time_ms": 957.11, "sample_time_ms": 566.211, "load_time_ms": 0.312, "load_throughput": 825738.597, "learn_time_ms": 29.339, "learn_throughput": 8793.769, "synch_weights_time_ms": 9.545}, "counters": {"num_env_steps_sampled": 2688, "num_env_steps_trained": 516, "num_agent_steps_sampled": 8064, "num_agent_steps_trained": 516, "last_target_update_ts": 2688, "num_target_updates": 2}, "done": false, "episodes_total": 0, "training_iteration": 2, "trial_id": "7066a_00000", "date": "2023-11-18_21-06-58", "timestamp": 1700370418, "time_this_iter_s": 1.718564748764038, "time_total_s": 2.8830366134643555, "pid": 7187, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x31039f880>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 2.8830366134643555, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 56.93333333333334, "ram_util_percent": 64.86666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.028017044067383, "actor_loss": -4.060174465179443, "critic_loss": 3.8121023178100586, "alpha_loss": -0.009024051018059254, "alpha_value": 0.9991005063056946, "log_alpha_value": -0.000899883802048862, "target_entropy": -6.0, "policy_t": 0.001238451455719769, "mean_q": 0.0462668314576149, "max_q": 0.4048382043838501, "min_q": 0.030922621488571167}, "td_error": [5.42970085144043, 4.211134910583496, 2.2052083015441895, 3.586674213409424, 3.1165266036987305, 4.493398666381836, 4.504519462585449, 3.179853677749634, 4.285913467407227, 3.3043417930603027, 4.365869998931885, 2.6685073375701904, 5.655209541320801, 4.160447120666504, 4.802839756011963, 5.8397979736328125, 3.405104875564575, 3.7462291717529297, 3.7062950134277344, 4.734810829162598, 5.792183876037598, 6.536088466644287, 3.5669708251953125, 4.530134201049805, 4.46578311920166, 4.329813480377197, 3.949826240539551, 4.1545329093933105, 3.8254408836364746, 3.589280605316162, 3.695685863494873, 5.207128524780273, 5.443676948547363, 4.172727584838867, 7.535157203674316, 2.346330165863037, 4.456464767456055, 5.109615325927734, 6.802897930145264, 4.182811737060547, 5.190014839172363, 4.107541561126709, 3.559286117553711, 4.82167911529541, 4.432724475860596, 5.318575859069824, 4.607410430908203, 5.3894548416137695, 5.172595977783203, 5.848170280456543, 4.998602867126465, 3.886565685272217, 3.8378777503967285, 5.479881286621094, 3.8470654487609863, 3.0850753784179688, 2.930975914001465, 4.441506862640381, 6.07887601852417, 2.614025115966797, 4.068966865539551, 3.797247886657715, 5.483112812042236, 4.881484508514404, 4.039804935455322, 3.2227871417999268, 4.395084381103516, 5.119637966156006, 4.489030361175537, 4.380377769470215, 4.675207138061523, 4.443933963775635, 4.399188041687012, 6.746649265289307, 3.243165969848633, 2.420991897583008, 5.658501625061035, 4.397454261779785, 4.249222755432129, 3.8969101905822754, 3.8666343688964844, 4.920009613037109, 6.1285719871521, 4.152518272399902, 5.543276309967041, 3.9812240600585938], "mean_td_error": 4.434230804443359, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 4.0, "diff_num_grad_updates_vs_sampler_policy": 3.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.133679389953613, "actor_loss": -4.162439346313477, "critic_loss": 0.849197506904602, "alpha_loss": -0.009119176305830479, "alpha_value": 0.9991005063056946, "log_alpha_value": -0.0008998879930004478, "target_entropy": -6.0, "policy_t": -0.003568853484466672, "mean_q": 0.05493820458650589, "max_q": 0.38515767455101013, "min_q": 0.028783293440937996}, "td_error": [2.6775572299957275, 2.2348384857177734, 2.8508148193359375, 4.767480850219727, 3.2881417274475098, 3.379047393798828, 1.0232446193695068, 2.0969648361206055, 2.5045437812805176, 3.585264205932617, 1.286192774772644, 1.5166466236114502, 2.2244863510131836, 2.262639284133911, 1.296701192855835, 2.8051228523254395, 0.6408757567405701, 2.0177931785583496, 3.4536590576171875, 1.0401808023452759, 1.4391300678253174, 1.734020709991455, 3.8041019439697266, 2.06380033493042, 0.9157616496086121, 1.2584590911865234, 1.8971614837646484, 2.6817550659179688, 2.8236656188964844, 2.7791085243225098, 3.8012638092041016, 1.2065154314041138, 3.192816734313965, 4.851273536682129, 1.5927181243896484, 2.027128219604492, 1.5719860792160034, 2.670781373977661, 2.166200637817383, 3.3318305015563965, 3.303065299987793, 0.018269795924425125, 1.411794900894165, 2.8313755989074707, 4.718331813812256, 2.979048728942871, 3.9994378089904785, 2.2000069618225098, 2.570845127105713, 1.6438839435577393, 3.3978919982910156, 1.7726354598999023, 4.2171149253845215, 1.6763994693756104, 3.3389244079589844, 2.5393357276916504, 0.7176801562309265, 2.3367767333984375, 2.4557223320007324, 1.361952543258667, 3.3199503421783447, 3.8632237911224365, 1.7447928190231323, 1.6400587558746338, 2.7538020610809326, 1.5989840030670166, 1.6201093196868896, 2.7407987117767334, 3.1220812797546387, 2.760788917541504, 1.411882758140564, 1.4710404872894287, 0.7006301879882812, 1.9620285034179688, 2.5410499572753906, 4.589449882507324, 1.8094003200531006, 2.695725679397583, 2.7985477447509766, 1.0472488403320312, 3.236894130706787, 0.3239595890045166, 3.431230068206787, 1.7573460340499878, 1.4828087091445923, 1.935603141784668], "mean_td_error": 2.3559491634368896, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 4.0, "diff_num_grad_updates_vs_sampler_policy": 3.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.046797752380371, "actor_loss": -4.075015068054199, "critic_loss": 1.0655405521392822, "alpha_loss": -0.009040516801178455, "alpha_value": 0.9991005659103394, "log_alpha_value": -0.0008998406119644642, "target_entropy": -6.0, "policy_t": 0.01457057986408472, "mean_q": 0.043827977031469345, "max_q": 0.32246488332748413, "min_q": 0.03326794505119324}, "td_error": [3.730440616607666, 2.493269920349121, 1.651327133178711, 3.3433589935302734, 2.4559779167175293, 1.3306704759597778, 2.1928834915161133, 4.011261940002441, 2.6473569869995117, 2.8336658477783203, 2.0914926528930664, 3.0874829292297363, 2.4108641147613525, 1.5321803092956543, 2.6984763145446777, 3.5517325401306152, 1.3233656883239746, 4.161405086517334, 3.825430393218994, 3.144287109375, 2.0558857917785645, 2.2501914501190186, 1.9815351963043213, 3.8023874759674072, 2.769793748855591, 1.6846210956573486, 2.537656307220459, 1.8953876495361328, 4.451598644256592, 3.977320671081543, 4.338443756103516, 2.4382996559143066, 3.4955554008483887, 0.6393827199935913, 0.9214589595794678, 4.089082717895508, 1.9721399545669556, 1.6989092826843262, 0.6742533445358276, 0.8960930109024048, 2.657741069793701, 3.7345616817474365, 3.4890799522399902, 2.1721410751342773, 0.8289824724197388, 1.4822056293487549, 2.0588555335998535, 1.7351303100585938, 3.337843656539917, 2.1037936210632324, 1.4863735437393188, 4.994024276733398, 2.36855411529541, 2.801018238067627, 4.439637184143066, 4.358562469482422, 2.0884604454040527, 3.333587169647217, 3.4265899658203125, 2.35768985748291, 2.1599066257476807, 3.3199105262756348, 4.162929534912109, 2.227602243423462, 2.253589153289795, 2.260495185852051, 4.159824371337891, 3.687433958053589, 2.284050464630127, 5.286646366119385, 3.8927719593048096, 2.021345853805542, 4.119780540466309, 0.8523969650268555, 2.937021017074585, 2.6611995697021484, 2.24100661277771, 2.4920272827148438, 4.505236625671387, 1.9364463090896606, 4.526891708374023, 2.8126087188720703, 3.533003091812134, 1.1671388149261475, 1.7988591194152832, 4.010092735290527], "mean_td_error": 2.7401394844055176, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 4.0, "diff_num_grad_updates_vs_sampler_policy": 3.0}}, "num_env_steps_sampled": 4480, "num_env_steps_trained": 1032, "num_agent_steps_sampled": 13440, "num_agent_steps_trained": 1032, "last_target_update_ts": 4480, "num_target_updates": 4}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13440, "num_agent_steps_trained": 1032, "num_env_steps_sampled": 4480, "num_env_steps_trained": 1032, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 988.5057937106025, "num_env_steps_trained_throughput_per_sec": 284.6367129211333, "timesteps_total": 4480, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 13440, "timers": {"training_iteration_time_ms": 936.823, "sample_time_ms": 564.485, "load_time_ms": 0.309, "load_throughput": 834816.148, "learn_time_ms": 23.965, "learn_throughput": 10765.699, "synch_weights_time_ms": 9.384}, "counters": {"num_env_steps_sampled": 4480, "num_env_steps_trained": 1032, "num_agent_steps_sampled": 13440, "num_agent_steps_trained": 1032, "last_target_update_ts": 4480, "num_target_updates": 4}, "done": false, "episodes_total": 0, "training_iteration": 3, "trial_id": "7066a_00000", "date": "2023-11-18_21-07-00", "timestamp": 1700370420, "time_this_iter_s": 1.8216478824615479, "time_total_s": 4.704684495925903, "pid": 7187, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x31039e980>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 4.704684495925903, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 65.15, "ram_util_percent": 64.75}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.135744094848633, "actor_loss": -4.189319610595703, "critic_loss": 4.003974914550781, "alpha_loss": -0.015203219838440418, "alpha_value": 0.998501181602478, "log_alpha_value": -0.0014999608974903822, "target_entropy": -6.0, "policy_t": -0.05568353831768036, "mean_q": 0.08359619230031967, "max_q": 0.7200795412063599, "min_q": 0.05520008131861687}, "td_error": [6.234711647033691, 5.933036804199219, 4.882519721984863, 6.00834846496582, 3.6369614601135254, 4.821167469024658, 2.603188991546631, 1.716849684715271, 3.4714832305908203, 3.6825900077819824, 2.755784511566162, 4.758359432220459, 4.5351362228393555, 4.676662445068359, 3.407287836074829, 4.774161338806152, 4.269442558288574, 5.27747917175293, 4.060639381408691, 4.71186637878418, 3.616879940032959, 3.5075299739837646, 3.1200966835021973, 3.436685562133789, 3.6296329498291016, 5.260284900665283, 4.294470310211182, 5.2570085525512695, 5.814560890197754, 4.451123237609863, 4.355600357055664, 4.81879997253418, 5.290119171142578, 6.971991062164307, 5.967302322387695, 6.619945049285889, 4.855067253112793, 4.029472351074219, 4.656866550445557, 2.456693410873413, 5.397000789642334, 5.663633346557617, 4.611797332763672, 5.557048797607422, 3.930108070373535, 3.782474994659424, 4.352234840393066, 4.221740245819092, 3.5549628734588623, 3.568033218383789, 5.759391784667969, 5.258768081665039, 6.420746803283691, 4.66263484954834, 4.269730567932129, 2.082881450653076, 5.716237545013428, 3.7337074279785156, 3.404109001159668, 5.625940322875977, 4.906949520111084, 4.07135009765625, 4.300668239593506, 5.0393877029418945, 5.204908847808838, 4.30544900894165, 4.256531715393066, 5.10679292678833, 4.910892486572266, 4.767253398895264, 5.438236236572266, 5.4412736892700195, 4.071255683898926, 4.156280994415283, 4.612133979797363, 5.583187103271484, 7.0222296714782715, 6.513140678405762, 7.275827407836914, 4.957695960998535, 3.8942975997924805, 4.584010601043701, 4.756004810333252, 4.343818187713623, 2.649606466293335, 5.214567184448242], "mean_td_error": 4.623077869415283, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 6.0, "diff_num_grad_updates_vs_sampler_policy": 5.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.173260688781738, "actor_loss": -4.224767208099365, "critic_loss": 0.8566997051239014, "alpha_loss": -0.015261400490999222, "alpha_value": 0.9985010027885437, "log_alpha_value": -0.0015001483261585236, "target_entropy": -6.0, "policy_t": 0.030731964856386185, "mean_q": 0.06527620553970337, "max_q": 0.682178258895874, "min_q": 0.051281750202178955}, "td_error": [2.632932662963867, 2.4496641159057617, 5.2470293045043945, 2.7766902446746826, 1.355297327041626, 2.3647656440734863, 2.0179409980773926, 1.3898240327835083, 2.525895595550537, 3.9398300647735596, 3.938932418823242, 2.601215362548828, 2.7472071647644043, 3.089674472808838, 4.060111999511719, 2.738450765609741, 3.6071348190307617, 3.1883015632629395, 1.342980146408081, 2.8887391090393066, 1.7526090145111084, 3.9450268745422363, 3.1172776222229004, 4.340608596801758, 2.124802589416504, 0.8308921456336975, 4.321859359741211, 2.4918160438537598, 4.900062084197998, 3.3194637298583984, 2.443925380706787, 1.7261583805084229, 2.720003366470337, 4.92237663269043, 2.2138137817382812, 1.8059794902801514, 3.968920946121216, 3.5521039962768555, 2.5086421966552734, 1.2489988803863525, 4.3666276931762695, 2.2447586059570312, 3.286196231842041, 1.9427553415298462, 2.9817514419555664, 2.6483407020568848, 3.1753177642822266, 2.617271900177002, 3.879837989807129, 2.7983222007751465, 3.403249740600586, 2.7686092853546143, 1.759548544883728, 1.672982931137085, 4.420960426330566, 1.0702816247940063, 3.1543867588043213, 2.3883347511291504, 4.176048755645752, 2.588899612426758, 2.538086414337158, 2.406625747680664, 4.0199174880981445, 2.02305269241333, 3.1939549446105957, 1.6782503128051758, 2.342019557952881, 3.8936424255371094, 0.916144847869873, 4.073947906494141, 1.8716559410095215, 1.6787257194519043, 1.7964943647384644, 2.7026190757751465, 2.575448513031006, 2.8345632553100586, 2.554368495941162, 3.2105045318603516, 2.0767574310302734, 4.202463150024414, 2.164900779724121, 3.3211820125579834, 2.6941986083984375, 1.7751209735870361, 3.574486255645752, 1.0892914533615112], "mean_td_error": 2.7873358726501465, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 6.0, "diff_num_grad_updates_vs_sampler_policy": 5.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.079164505004883, "actor_loss": -4.1284284591674805, "critic_loss": 1.0042955875396729, "alpha_loss": -0.015116989612579346, "alpha_value": 0.9985013008117676, "log_alpha_value": -0.0014998256228864193, "target_entropy": -6.0, "policy_t": -0.02412734366953373, "mean_q": 0.08363194018602371, "max_q": 0.5568709373474121, "min_q": 0.05656379088759422}, "td_error": [2.492403984069824, 2.667654037475586, 2.0827691555023193, 2.848255157470703, 1.7232016324996948, 3.120497226715088, 0.8587392568588257, 4.082220554351807, 1.6230242252349854, 3.9130635261535645, 2.626950740814209, 1.0383813381195068, 2.5646491050720215, 3.216742515563965, 2.152818202972412, 2.504500389099121, 2.215043544769287, 2.644843101501465, 2.331015110015869, 1.4406942129135132, 3.010568141937256, 0.029988110065460205, 3.8100216388702393, 1.864506721496582, 2.1767497062683105, 2.299281597137451, 2.0461392402648926, 3.0696868896484375, 2.347900390625, 3.2349162101745605, 1.0590016841888428, 3.168267250061035, 0.550311803817749, 0.6064156293869019, 2.236330032348633, 3.1777026653289795, 3.123518943786621, 1.1034588813781738, 4.841553688049316, 1.5846643447875977, 2.12469744682312, 2.6352219581604004, 2.8124678134918213, 2.7092134952545166, 2.480760097503662, 3.7146801948547363, 5.200773239135742, 3.442108631134033, 1.5734403133392334, 3.3416287899017334, 3.125922203063965, 3.2228903770446777, 1.7664504051208496, 3.390625476837158, 5.532325744628906, 2.4798200130462646, 3.0240092277526855, 2.1819581985473633, 1.7715543508529663, 3.7947120666503906, 2.3805289268493652, 1.3228905200958252, 3.508453845977783, 3.1357579231262207, 4.684988975524902, 4.757299900054932, 0.6993432641029358, 1.5379014015197754, 2.4475631713867188, 4.412446975708008, 4.795485496520996, 3.6687042713165283, 2.914304733276367, 2.060598134994507, 2.165259838104248, 0.8925608396530151, 2.975539207458496, 3.339468002319336, 4.5491485595703125, 3.6984548568725586, 1.08854341506958, 3.1741013526916504, 1.7572424411773682, 4.503386497497559, 3.3536298274993896, 2.4385130405426025], "mean_td_error": 2.675300359725952, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 6.0, "diff_num_grad_updates_vs_sampler_policy": 5.0}}, "num_env_steps_sampled": 6272, "num_env_steps_trained": 1548, "num_agent_steps_sampled": 18816, "num_agent_steps_trained": 1548, "last_target_update_ts": 6272, "num_target_updates": 6}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18816, "num_agent_steps_trained": 1548, "num_env_steps_sampled": 6272, "num_env_steps_trained": 1548, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 1045.0246946794507, "num_env_steps_trained_throughput_per_sec": 300.9111286018954, "timesteps_total": 6272, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 18816, "timers": {"training_iteration_time_ms": 914.123, "sample_time_ms": 568.411, "load_time_ms": 0.309, "load_throughput": 835729.514, "learn_time_ms": 22.061, "learn_throughput": 11695.041, "synch_weights_time_ms": 8.923}, "counters": {"num_env_steps_sampled": 6272, "num_env_steps_trained": 1548, "num_agent_steps_sampled": 18816, "num_agent_steps_trained": 1548, "last_target_update_ts": 6272, "num_target_updates": 6}, "done": false, "episodes_total": 0, "training_iteration": 4, "trial_id": "7066a_00000", "date": "2023-11-18_21-07-02", "timestamp": 1700370422, "time_this_iter_s": 1.7243688106536865, "time_total_s": 6.42905330657959, "pid": 7187, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x31039dee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 6.42905330657959, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 64.46666666666665, "ram_util_percent": 64.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.097240447998047, "actor_loss": -4.179169654846191, "critic_loss": 3.7921385765075684, "alpha_loss": -0.021207205951213837, "alpha_value": 0.9979019165039062, "log_alpha_value": -0.002100297249853611, "target_entropy": -6.0, "policy_t": -0.01662290096282959, "mean_q": 0.12767432630062103, "max_q": 0.9907283782958984, "min_q": 0.0833035260438919}, "td_error": [4.7896647453308105, 4.182330131530762, 3.499485492706299, 5.737088680267334, 3.1448535919189453, 3.9659423828125, 4.255443572998047, 4.3067779541015625, 6.396502494812012, 4.652504920959473, 5.476070404052734, 3.3438901901245117, 3.407355308532715, 2.8922338485717773, 4.328967094421387, 3.5342659950256348, 3.1130313873291016, 3.505880832672119, 4.810955047607422, 5.150893211364746, 4.481329917907715, 3.5160021781921387, 4.226092338562012, 4.11214542388916, 5.049312114715576, 5.287640571594238, 3.7840960025787354, 6.78251838684082, 4.538137435913086, 5.702279090881348, 4.510703086853027, 4.49981689453125, 4.023919105529785, 6.549539089202881, 3.586757183074951, 4.942296981811523, 3.670884609222412, 5.146051406860352, 6.165278434753418, 3.473043441772461, 5.188675880432129, 4.891552925109863, 5.008963584899902, 4.569396495819092, 4.4065070152282715, 4.878630638122559, 4.323946952819824, 3.9290928840637207, 4.609236717224121, 5.705527305603027, 4.907999038696289, 4.092899322509766, 3.4149670600891113, 4.005287170410156, 3.295623302459717, 4.561461448669434, 4.495494842529297, 5.144852161407471, 4.17340612411499, 3.4942588806152344, 2.543917655944824, 5.2190842628479, 5.581066608428955, 4.2659196853637695, 5.7943549156188965, 5.693150520324707, 2.663646697998047, 4.48729133605957, 5.685763359069824, 3.7871756553649902, 6.714935302734375, 5.136613368988037, 5.012603759765625, 4.243244171142578, 3.351398468017578, 3.6966681480407715, 4.795909881591797, 4.560830116271973, 5.321514129638672, 3.3148088455200195, 3.498079299926758, 3.1145987510681152, 4.716459274291992, 5.174342155456543, 3.999187469482422, 5.629459857940674], "mean_td_error": 4.484206676483154, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 8.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.09451675415039, "actor_loss": -4.169421672821045, "critic_loss": 0.7472040057182312, "alpha_loss": -0.02120560221374035, "alpha_value": 0.9979014992713928, "log_alpha_value": -0.0021007051691412926, "target_entropy": -6.0, "policy_t": 0.013659875839948654, "mean_q": 0.1355113387107849, "max_q": 0.9789491891860962, "min_q": 0.07538194954395294}, "td_error": [2.3168325424194336, 1.7347631454467773, 2.232815980911255, 3.1262590885162354, 0.7378972768783569, 3.0896739959716797, 2.280385971069336, 4.343044281005859, 4.045248031616211, 3.9438610076904297, 2.9838480949401855, 2.284759044647217, 2.2302584648132324, 3.7468109130859375, 2.4722609519958496, 2.8611621856689453, 2.961282730102539, 1.513477087020874, 2.626347064971924, 1.9971890449523926, 3.57391619682312, 3.49573016166687, 2.9874377250671387, 2.1107888221740723, 4.016565799713135, 1.5435750484466553, 2.789127826690674, 2.107698440551758, 4.267609596252441, 2.5802249908447266, 1.8908591270446777, 2.66510009765625, 3.4957480430603027, 0.7438576221466064, 4.40518856048584, 3.0283195972442627, 3.7979440689086914, 1.6969454288482666, 1.5949279069900513, 3.9895458221435547, 2.512873649597168, 2.4931726455688477, 3.1088192462921143, 1.975219964981079, 1.373211145401001, 1.5941503047943115, 2.6871767044067383, 3.4980945587158203, 2.4621052742004395, 3.9022464752197266, 1.5764284133911133, 0.22768950462341309, 4.329740524291992, 0.3532670736312866, 3.387479782104492, 0.8568625450134277, 2.3712711334228516, 1.7607721090316772, 3.1335673332214355, 3.1704800128936768, 2.3040385246276855, 1.8472602367401123, 1.155857801437378, 1.9310939311981201, 4.537006378173828, 4.146359443664551, 1.0933479070663452, 0.4668331742286682, 2.4694552421569824, 2.0426394939422607, 4.480190277099609, 2.4914679527282715, 1.2735309600830078, 0.28148069977760315, 2.2127461433410645, 1.7773470878601074, 1.332180380821228, 2.15919828414917, 3.5952534675598145, 2.6413774490356445, 1.863241195678711, 2.0707263946533203, 3.103271961212158, 3.097999095916748, 0.5101607441902161, 1.1827523708343506], "mean_td_error": 2.478496789932251, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 8.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.087064743041992, "actor_loss": -4.158452033996582, "critic_loss": 0.9444175958633423, "alpha_loss": -0.021181510761380196, "alpha_value": 0.9979023337364197, "log_alpha_value": -0.002099868841469288, "target_entropy": -6.0, "policy_t": -0.020816780626773834, "mean_q": 0.13835041224956512, "max_q": 1.2955739498138428, "min_q": 0.08327601104974747}, "td_error": [2.9411816596984863, 2.9819531440734863, 2.7875258922576904, 2.592357635498047, 2.091155529022217, 3.189455986022949, 3.3584492206573486, 3.801055669784546, 0.8284717798233032, 2.7952253818511963, 3.5534684658050537, 1.7800058126449585, 3.737508773803711, 3.7071073055267334, 2.0462253093719482, 3.744945526123047, 1.6915239095687866, 3.0294389724731445, 3.880347967147827, 2.8396031856536865, 3.304396629333496, 1.373034954071045, 4.028652191162109, 2.5170235633850098, 1.2564942836761475, 3.401015281677246, 3.598947286605835, 2.6562867164611816, 3.2342257499694824, 0.8876522779464722, 2.5786335468292236, 4.619564056396484, 4.071524620056152, 1.544266700744629, 1.9281147718429565, 3.631800651550293, 3.484621047973633, 3.9241204261779785, 2.2860608100891113, 2.8261022567749023, 2.942141056060791, 1.8929097652435303, 1.677133560180664, 2.6916651725769043, 1.7906174659729004, 2.9785046577453613, 2.4517111778259277, 2.3675761222839355, 2.976045608520508, 3.2055039405822754, 1.1345276832580566, 3.148935317993164, 2.6952743530273438, 3.772092580795288, 4.831342697143555, 3.5328264236450195, 1.7081105709075928, 3.2104945182800293, 3.516958713531494, 2.421750545501709, 1.708074688911438, 3.691959857940674, 1.7925407886505127, 1.1875141859054565, 1.862121820449829, 2.6347546577453613, 2.65297794342041, 3.048374652862549, 2.522153615951538, 2.7473835945129395, 3.06650972366333, 2.1101484298706055, 4.650940418243408, 2.2877349853515625, 0.9380564093589783, 4.346622943878174, 3.8671016693115234, 0.5683931708335876, 2.047783374786377, 1.900355577468872, 2.837709426879883, 0.6608567237854004, 4.1233930587768555, 3.9470152854919434, 3.0454630851745605, 1.2688729763031006], "mean_td_error": 2.732447385787964, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 8.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 8064, "num_env_steps_trained": 2064, "num_agent_steps_sampled": 24192, "num_agent_steps_trained": 2064, "last_target_update_ts": 8064, "num_target_updates": 8}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24192, "num_agent_steps_trained": 2064, "num_env_steps_sampled": 8064, "num_env_steps_trained": 2064, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 984.5867871475159, "num_env_steps_trained_throughput_per_sec": 283.50824897774453, "timesteps_total": 8064, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 24192, "timers": {"training_iteration_time_ms": 913.209, "sample_time_ms": 584.685, "load_time_ms": 0.306, "load_throughput": 844095.501, "learn_time_ms": 21.059, "learn_throughput": 12251.394, "synch_weights_time_ms": 9.091}, "counters": {"num_env_steps_sampled": 8064, "num_env_steps_trained": 2064, "num_agent_steps_sampled": 24192, "num_agent_steps_trained": 2064, "last_target_update_ts": 8064, "num_target_updates": 8}, "done": false, "episodes_total": 0, "training_iteration": 5, "trial_id": "7066a_00000", "date": "2023-11-18_21-07-04", "timestamp": 1700370424, "time_this_iter_s": 1.8294920921325684, "time_total_s": 8.258545398712158, "pid": 7187, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x31039e700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 8.258545398712158, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 68.75, "ram_util_percent": 64.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.11915397644043, "actor_loss": -4.218266487121582, "critic_loss": 4.133242607116699, "alpha_loss": -0.024290794506669044, "alpha_value": 0.9976024031639099, "log_alpha_value": -0.0024004769511520863, "target_entropy": -6.0, "policy_t": 0.024910956621170044, "mean_q": 0.12157399207353592, "max_q": 0.94972825050354, "min_q": 0.09906576573848724}, "td_error": [3.540053367614746, 4.815621376037598, 4.593056678771973, 6.089804649353027, 4.8459672927856445, 4.4022417068481445, 4.453934669494629, 5.594442367553711, 4.883268356323242, 5.450716018676758, 6.021707534790039, 4.741756916046143, 5.357961177825928, 4.691535949707031, 4.29744815826416, 4.731928825378418, 5.728604316711426, 4.641365051269531, 4.48998498916626, 5.14019250869751, 3.699828624725342, 4.449311256408691, 3.5290513038635254, 5.335315704345703, 3.4134719371795654, 5.902853488922119, 4.94135046005249, 2.7699708938598633, 4.057574272155762, 4.39872932434082, 4.20033073425293, 5.300070762634277, 4.752415657043457, 4.502749443054199, 5.740091323852539, 3.7264938354492188, 4.316082954406738, 5.101005554199219, 5.693960189819336, 4.704169273376465, 3.70817232131958, 4.067622184753418, 4.561981201171875, 4.629670143127441, 5.058107376098633, 5.562164306640625, 3.866123676300049, 5.5284929275512695, 3.9253125190734863, 3.4691591262817383, 4.754940986633301, 7.007709503173828, 4.538969993591309, 4.716479301452637, 4.015085220336914, 6.94936466217041, 2.3940205574035645, 6.478353500366211, 3.617847442626953, 6.060626983642578, 5.110561370849609, 5.271533966064453, 5.107390880584717, 4.210952281951904, 5.153007507324219, 4.137091636657715, 5.957757949829102, 3.2537264823913574, 5.354690074920654, 3.8986783027648926, 4.06227970123291, 6.093633651733398, 4.165470123291016, 4.527976989746094, 6.304105758666992, 2.6907448768615723, 4.602257251739502, 4.697235107421875, 4.838811874389648, 5.000923156738281, 5.072711944580078, 6.281887054443359, 6.053193092346191, 5.378299713134766, 5.321028709411621, 5.779996871948242], "mean_td_error": 4.793983459472656, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 9.0, "diff_num_grad_updates_vs_sampler_policy": 8.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.073824882507324, "actor_loss": -4.16069221496582, "critic_loss": 0.809442937374115, "alpha_loss": -0.024186911061406136, "alpha_value": 0.9976019263267517, "log_alpha_value": -0.0024009658955037594, "target_entropy": -6.0, "policy_t": 0.01177307590842247, "mean_q": 0.16343387961387634, "max_q": 1.1411617994308472, "min_q": 0.08844508975744247}, "td_error": [3.0441112518310547, 0.5514140725135803, 1.2436373233795166, 3.181997776031494, 3.018500328063965, 3.07061505317688, 0.44489550590515137, 2.57861590385437, 2.112661838531494, 0.9291713237762451, 4.743233680725098, 1.9119493961334229, 0.810981035232544, 2.637260913848877, 2.231785774230957, 3.445519208908081, 2.3842406272888184, 2.3416781425476074, 1.5049278736114502, 2.5849690437316895, 0.12938237190246582, 4.179771900177002, 3.103893280029297, 3.3337302207946777, 4.038122177124023, 4.083208084106445, 2.700070381164551, 1.446648359298706, 2.949697494506836, 3.1297712326049805, 3.1171138286590576, 0.7499113082885742, 3.2447264194488525, 2.7080655097961426, 0.09845227003097534, 3.3331451416015625, 3.3452296257019043, 3.8845412731170654, 3.126983642578125, 3.095907688140869, 2.794156551361084, 0.9931464195251465, 3.777776002883911, 2.800708770751953, 3.7791903018951416, 3.3931899070739746, 4.281724452972412, 2.414872169494629, 2.5122642517089844, 4.815286636352539, 3.2492871284484863, 3.343921661376953, 3.0530872344970703, 1.1530981063842773, 3.520902633666992, 0.9652652740478516, 1.7174623012542725, 1.6305679082870483, 3.8899333477020264, 2.9656271934509277, 3.21657657623291, 2.616800308227539, 0.5316766500473022, 3.852461576461792, 2.9969029426574707, 1.6272401809692383, 2.596121311187744, 2.527991533279419, 3.683765411376953, 2.7881226539611816, 1.2688238620758057, 2.23048996925354, 3.3690967559814453, 4.072971343994141, 2.5755786895751953, 1.9977763891220093, 3.326773166656494, 1.4783661365509033, 2.4860944747924805, 1.7990208864212036, 4.397583961486816, 4.079498767852783, 3.2546546459198, 2.5101318359375, 2.7588071823120117, 2.220895290374756], "mean_td_error": 2.6498398780822754, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 9.0, "diff_num_grad_updates_vs_sampler_policy": 8.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.035829544067383, "actor_loss": -4.12229061126709, "critic_loss": 0.8591548800468445, "alpha_loss": -0.024085210636258125, "alpha_value": 0.9976029396057129, "log_alpha_value": -0.0023999223485589027, "target_entropy": -6.0, "policy_t": -0.02099268138408661, "mean_q": 0.1447511911392212, "max_q": 1.3979355096817017, "min_q": 0.09821893274784088}, "td_error": [3.269827127456665, 0.9565486907958984, 3.133913278579712, 2.8545033931732178, 3.6651296615600586, 1.1189234256744385, 2.9756431579589844, 1.563649296760559, 2.6935224533081055, 1.995115876197815, 0.8446595072746277, 2.3341751098632812, 2.574367046356201, 1.6443681716918945, 0.48356980085372925, 3.1849617958068848, 1.9584414958953857, 4.412214279174805, 2.495025157928467, 4.273402690887451, 4.168607234954834, 1.1554431915283203, 2.2500267028808594, 2.569492816925049, 3.045210838317871, 3.677830219268799, 0.8902507424354553, 3.4784250259399414, 3.546478509902954, 1.38823401927948, 3.8839898109436035, 3.861297607421875, 2.6672511100769043, 3.651859760284424, 0.8807111978530884, 2.009492874145508, 1.288384199142456, 3.4254326820373535, 5.480053901672363, 2.1176352500915527, 2.167867660522461, 3.159728527069092, 3.031222343444824, 3.0394680500030518, 2.166033983230591, 3.400927782058716, 1.7116265296936035, 3.899829864501953, 0.9368726015090942, 3.2117276191711426, 3.3037543296813965, 1.5216585397720337, 3.223207473754883, 3.369816780090332, 2.627589225769043, 3.7957987785339355, 0.97545325756073, 1.4633796215057373, 1.8105571269989014, 2.6719002723693848, 3.31258487701416, 1.6046568155288696, 1.811718225479126, 1.7951172590255737, 2.3777711391448975, 1.9472392797470093, 3.807126522064209, 3.80189847946167, 3.4887382984161377, 3.083578109741211, 2.277719497680664, 1.8395757675170898, 1.5532736778259277, 2.9804515838623047, 2.7021689414978027, 2.753627300262451, 1.704864740371704, 2.7971205711364746, 1.6220452785491943, 3.538914203643799, 2.5421395301818848, 2.6880531311035156, 3.0098698139190674, 3.163438320159912, 0.30200380086898804, 3.9211173057556152], "mean_td_error": 2.5788755416870117, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 9.0, "diff_num_grad_updates_vs_sampler_policy": 8.0}}, "num_env_steps_sampled": 8960, "num_env_steps_trained": 2322, "num_agent_steps_sampled": 26880, "num_agent_steps_trained": 2322, "last_target_update_ts": 8960, "num_target_updates": 9}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 26880, "num_agent_steps_trained": 2322, "num_env_steps_sampled": 8960, "num_env_steps_trained": 2322, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 778.7559628320378, "num_env_steps_trained_throughput_per_sec": 224.23999822618944, "timesteps_total": 8960, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 26880, "timers": {"training_iteration_time_ms": 936.94, "sample_time_ms": 600.506, "load_time_ms": 0.306, "load_throughput": 842124.85, "learn_time_ms": 20.679, "learn_throughput": 12476.251, "synch_weights_time_ms": 8.978}, "counters": {"num_env_steps_sampled": 8960, "num_env_steps_trained": 2322, "num_agent_steps_sampled": 26880, "num_agent_steps_trained": 2322, "last_target_update_ts": 8960, "num_target_updates": 9}, "done": false, "episodes_total": 0, "training_iteration": 6, "trial_id": "7066a_00000", "date": "2023-11-18_21-07-05", "timestamp": 1700370425, "time_this_iter_s": 1.1613709926605225, "time_total_s": 9.41991639137268, "pid": 7187, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x31039e160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 9.41991639137268, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 72.55, "ram_util_percent": 64.35}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.077749252319336, "actor_loss": -4.210975646972656, "critic_loss": 3.6794371604919434, "alpha_loss": -0.030243460088968277, "alpha_value": 0.9970034956932068, "log_alpha_value": -0.003001013770699501, "target_entropy": -6.0, "policy_t": -0.023149283602833748, "mean_q": 0.28078630566596985, "max_q": 1.768584132194519, "min_q": 0.13444870710372925}, "td_error": [6.320178985595703, 3.9428396224975586, 3.4533143043518066, 3.51015567779541, 4.176929473876953, 4.259714126586914, 4.245553970336914, 2.765995502471924, 4.538150787353516, 3.068613052368164, 4.228254318237305, 4.926649570465088, 4.342221736907959, 3.713209390640259, 4.172421932220459, 5.888710975646973, 4.141779899597168, 6.985204696655273, 5.092223167419434, 3.9125161170959473, 2.4007248878479004, 4.277927875518799, 3.2414283752441406, 4.8144683837890625, 4.815785884857178, 3.943018913269043, 2.9649996757507324, 4.307727813720703, 4.7320332527160645, 4.867436408996582, 4.9333953857421875, 5.747649192810059, 4.906071662902832, 3.43043851852417, 4.7182769775390625, 4.418690204620361, 2.4628524780273438, 3.2947494983673096, 4.225547790527344, 2.7422170639038086, 4.468816757202148, 6.38090705871582, 3.81111741065979, 5.070736408233643, 6.993158340454102, 2.849170446395874, 4.769205093383789, 2.210045337677002, 3.8525660037994385, 5.889862060546875, 3.935640811920166, 3.692626953125, 2.9978315830230713, 3.3994126319885254, 3.9783935546875, 4.9386701583862305, 4.66052770614624, 1.1470818519592285, 4.344079494476318, 5.446991920471191, 4.492865085601807, 3.4611129760742188, 5.05126953125, 4.625768661499023, 5.02880334854126, 5.895266056060791, 4.268321990966797, 4.17958402633667, 4.113969802856445, 4.0823588371276855, 6.587292671203613, 2.201307773590088, 5.510082244873047, 6.384158134460449, 6.531956195831299, 4.576988220214844, 3.650205135345459, 3.421998977661133, 4.284537315368652, 5.39968204498291, 6.365637302398682, 3.6903626918792725, 5.920925140380859, 3.4586472511291504, 4.276451110839844, 4.528783321380615], "mean_td_error": 4.369246959686279, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 11.0, "diff_num_grad_updates_vs_sampler_policy": 10.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.11075496673584, "actor_loss": -4.224399089813232, "critic_loss": 0.7031188011169434, "alpha_loss": -0.030346591025590897, "alpha_value": 0.9970030784606934, "log_alpha_value": -0.0030014170333743095, "target_entropy": -6.0, "policy_t": -0.016902264207601547, "mean_q": 0.20165185630321503, "max_q": 1.5121421813964844, "min_q": 0.11771254241466522}, "td_error": [0.7521040439605713, 0.2903163433074951, 1.621726393699646, 3.0292506217956543, 1.2046616077423096, 2.616894245147705, 2.9817824363708496, 3.904498338699341, 1.7941889762878418, 2.8723669052124023, 2.098748207092285, 1.8603692054748535, 4.4044599533081055, 1.3636271953582764, 0.2640417814254761, 2.1667606830596924, 3.32253360748291, 2.529512405395508, 2.0171830654144287, 3.607748031616211, 1.4366133213043213, 3.039607048034668, 3.373483180999756, 4.53236198425293, 3.281052589416504, 2.850344657897949, 0.8817480206489563, 1.9115774631500244, 3.1918768882751465, 2.7281365394592285, 3.5487051010131836, 1.6403471231460571, 2.6900601387023926, 1.1900372505187988, 3.7009410858154297, 0.48637592792510986, 1.0413907766342163, 2.654451370239258, 2.0689358711242676, 2.8646903038024902, 1.5011892318725586, 1.7286590337753296, 2.6714019775390625, 4.287937164306641, 1.7806843519210815, 3.0494866371154785, 3.605098247528076, 2.71981143951416, 2.3400797843933105, 3.077960968017578, 2.281708240509033, 1.4209538698196411, 1.0824711322784424, 1.6843979358673096, 2.9709718227386475, 4.387295246124268, 3.2551259994506836, 1.9904801845550537, 3.1984732151031494, 1.0629265308380127, 2.826216697692871, 1.0931439399719238, 2.999457359313965, 2.1098217964172363, 1.0220082998275757, 1.0707837343215942, 2.7734055519104004, 4.856740474700928, 2.3796067237854004, 2.5910637378692627, 3.7533349990844727, 3.9078640937805176, 2.4754478931427, 2.040459632873535, 2.5058016777038574, 3.577091932296753, 0.6882438659667969, 0.9804458618164062, 3.6068382263183594, 0.5702227354049683, 1.7139313220977783, 2.9277451038360596, 1.4790160655975342, 2.3546247482299805, 1.8806493282318115, 3.19006609916687], "mean_td_error": 2.387054204940796, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 11.0, "diff_num_grad_updates_vs_sampler_policy": 10.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.01746654510498, "actor_loss": -4.135657787322998, "critic_loss": 0.9161438941955566, "alpha_loss": -0.03005208447575569, "alpha_value": 0.997004508972168, "log_alpha_value": -0.002999968593940139, "target_entropy": -6.0, "policy_t": 0.004451652988791466, "mean_q": 0.2743273377418518, "max_q": 1.8940891027450562, "min_q": 0.13184064626693726}, "td_error": [1.5134382247924805, 1.5852339267730713, 2.444394111633301, 4.825902462005615, 2.496152877807617, 3.7310597896575928, 2.4888885021209717, 2.4552130699157715, 4.158254623413086, 2.3539204597473145, 2.1533403396606445, 2.2429466247558594, 3.718799114227295, 3.2407078742980957, 2.010824203491211, 2.787517547607422, 2.417243242263794, 0.7030662298202515, 3.4843311309814453, 0.89955735206604, 1.9600450992584229, 3.023263931274414, 2.4486517906188965, 1.2914800643920898, 3.0006370544433594, 3.9840874671936035, 3.040189266204834, 2.8259241580963135, 2.2027764320373535, 3.3981103897094727, 2.260742425918579, 4.277657508850098, 3.550856828689575, 3.316650629043579, 2.279266357421875, 2.2138519287109375, 3.1879677772521973, 2.878051280975342, 3.5292253494262695, 2.7178092002868652, 2.1531050205230713, 3.3974170684814453, 1.2494535446166992, 0.6001489162445068, 3.4647600650787354, 3.593299150466919, 1.917899489402771, 2.8745689392089844, 2.113813638687134, 2.370053291320801, 1.513289451599121, 1.66509211063385, 1.3748259544372559, 1.8230124711990356, 3.4416260719299316, 4.2613115310668945, 1.3930864334106445, 2.8658227920532227, 0.6537830829620361, 2.8397984504699707, 3.8671536445617676, 2.579939603805542, 4.486757755279541, 1.597947120666504, 0.7580092549324036, 3.2662506103515625, 1.991844654083252, 2.533803939819336, 2.8544869422912598, 2.6820409297943115, 2.419602394104004, 4.079524517059326, 0.15966510772705078, 3.340693473815918, 3.2748074531555176, 3.589909791946411, 3.6803200244903564, 3.6211888790130615, 0.35508984327316284, 3.9208219051361084, 3.22642183303833, 4.409943580627441, 3.015742540359497, 2.327536106109619, 1.5432453155517578, 5.064499378204346], "mean_td_error": 2.666412353515625, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 11.0, "diff_num_grad_updates_vs_sampler_policy": 10.0}}, "num_env_steps_sampled": 10752, "num_env_steps_trained": 2838, "num_agent_steps_sampled": 32256, "num_agent_steps_trained": 2838, "last_target_update_ts": 10752, "num_target_updates": 11}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32256, "num_agent_steps_trained": 2838, "num_env_steps_sampled": 10752, "num_env_steps_trained": 2838, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 1028.1696720980704, "num_env_steps_trained_throughput_per_sec": 296.0577850460961, "timesteps_total": 10752, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 32256, "timers": {"training_iteration_time_ms": 918.125, "sample_time_ms": 614.532, "load_time_ms": 0.307, "load_throughput": 840359.115, "learn_time_ms": 18.321, "learn_throughput": 14081.916, "synch_weights_time_ms": 9.024}, "counters": {"num_env_steps_sampled": 10752, "num_env_steps_trained": 2838, "num_agent_steps_sampled": 32256, "num_agent_steps_trained": 2838, "last_target_update_ts": 10752, "num_target_updates": 11}, "done": false, "episodes_total": 0, "training_iteration": 7, "trial_id": "7066a_00000", "date": "2023-11-18_21-07-06", "timestamp": 1700370426, "time_this_iter_s": 1.7526698112487793, "time_total_s": 11.17258620262146, "pid": 7187, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x31039f380>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 11.17258620262146, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 59.5, "ram_util_percent": 64.55000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.085566520690918, "actor_loss": -4.256542682647705, "critic_loss": 3.6077418327331543, "alpha_loss": -0.036323629319667816, "alpha_value": 0.9964049458503723, "log_alpha_value": -0.003601545700803399, "target_entropy": -6.0, "policy_t": -0.05826502665877342, "mean_q": 0.41393470764160156, "max_q": 2.3172688484191895, "min_q": 0.17560377717018127}, "td_error": [2.667076587677002, 4.130001544952393, 4.557343482971191, 4.531494140625, 5.609858989715576, 2.690584897994995, 3.530592918395996, 4.61398983001709, 5.039562702178955, 5.124060153961182, 3.084324598312378, 4.908005714416504, 5.937719345092773, 5.030688285827637, 3.6483113765716553, 3.9501793384552, 3.4530248641967773, 3.547987222671509, 2.4081661701202393, 4.229937553405762, 4.998675346374512, 6.7581682205200195, 5.042292594909668, 5.9197797775268555, 4.545610427856445, 4.051823616027832, 2.9222583770751953, 5.6164679527282715, 2.3968281745910645, 4.974769592285156, 5.488909721374512, 5.329430103302002, 3.695033073425293, 4.610904693603516, 3.405397415161133, 5.412206649780273, 4.65231990814209, 3.478423595428467, 2.875901937484741, 2.2288284301757812, 5.470584869384766, 4.684694290161133, 3.951747179031372, 4.936220645904541, 4.391315937042236, 4.896469593048096, 7.353765487670898, 2.7446279525756836, 4.08903169631958, 3.806448459625244, 4.56373405456543, 5.20845890045166, 5.464257717132568, 2.248593330383301, 6.117672920227051, 3.7569351196289062, 3.4059224128723145, 4.319660186767578, 2.364386796951294, 3.108567237854004, 5.355375289916992, 5.724945545196533, 3.665799856185913, 2.0828328132629395, 5.519380569458008, 3.576176404953003, 5.387739181518555, 5.889806270599365, 4.198491096496582, 6.8430376052856445, 1.4732626676559448, 5.388265609741211, 5.040911674499512, 5.3053879737854, 3.9041759967803955, 3.65374755859375, 5.218880653381348, 3.808441638946533, 4.29606819152832, 3.699239730834961, 4.217051029205322, 3.4202001094818115, 4.24152135848999, 4.454226493835449, 3.8632278442382812, 3.4127743244171143], "mean_td_error": 4.321174621582031, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 13.0, "diff_num_grad_updates_vs_sampler_policy": 12.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.096894264221191, "actor_loss": -4.244256496429443, "critic_loss": 0.6938174962997437, "alpha_loss": -0.03636917099356651, "alpha_value": 0.9964044690132141, "log_alpha_value": -0.003602015320211649, "target_entropy": -6.0, "policy_t": -0.017157888039946556, "mean_q": 0.24630986154079437, "max_q": 1.7670369148254395, "min_q": 0.1510118693113327}, "td_error": [0.40337884426116943, 2.3920516967773438, 3.031872272491455, 2.9731485843658447, 3.765141725540161, 4.446658134460449, 2.638538122177124, 3.149501323699951, 3.834498405456543, 0.6163000464439392, 1.8272407054901123, 3.099703788757324, 1.6936826705932617, 1.687407374382019, 3.54915714263916, 1.3871641159057617, 1.4000768661499023, 1.0561702251434326, 3.0259203910827637, 3.8558712005615234, 3.735647678375244, 4.813816547393799, 3.2943153381347656, 3.939603328704834, 3.087766647338867, 2.3179759979248047, 2.8936657905578613, 2.5976502895355225, 1.4840315580368042, 2.537059783935547, 2.370647430419922, 2.6232006549835205, 1.0865716934204102, 2.44809627532959, 2.3036131858825684, 3.8535594940185547, 1.121816635131836, 2.536311626434326, 3.403759479522705, 1.8675885200500488, 0.7807372808456421, 0.885269284248352, 0.7039228081703186, 1.312835693359375, 2.139669895172119, 2.970034599304199, 2.088435173034668, 1.2187011241912842, 2.8415627479553223, 0.5297740697860718, 0.964311957359314, 1.8848587274551392, 3.0736196041107178, 2.722715377807617, 1.8265321254730225, 2.393616199493408, 2.776610851287842, 2.8562965393066406, 0.7222365140914917, 2.4364914894104004, 2.783881664276123, 3.336252212524414, 2.029048204421997, 2.5652570724487305, 1.6238617897033691, 3.419497489929199, 3.722161293029785, 3.5872421264648438, 0.6667075157165527, 3.4409430027008057, 1.7436316013336182, 1.1380681991577148, 1.8559143543243408, 2.9337658882141113, 0.8482205271720886, 1.8300825357437134, 3.4490814208984375, 3.110523223876953, 4.155352592468262, 1.8220019340515137, 1.9059487581253052, 1.1902259588241577, 2.512829303741455, 3.041012763977051, 2.933549404144287, 3.478825569152832], "mean_td_error": 2.400026798248291, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 13.0, "diff_num_grad_updates_vs_sampler_policy": 12.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.046449661254883, "actor_loss": -4.197613716125488, "critic_loss": 0.835792064666748, "alpha_loss": -0.03616657480597496, "alpha_value": 0.9964065551757812, "log_alpha_value": -0.0035999356769025326, "target_entropy": -6.0, "policy_t": 0.0471547469496727, "mean_q": 0.30722296237945557, "max_q": 2.723367691040039, "min_q": 0.17104236781597137}, "td_error": [1.6640456914901733, 2.782721519470215, 2.9805407524108887, 2.630387306213379, 2.6075119972229004, 2.3569154739379883, 2.4811899662017822, 3.3892757892608643, 2.6675825119018555, 1.6574496030807495, 3.965881109237671, 3.1313328742980957, 4.903728485107422, 3.6324868202209473, 2.983212471008301, 3.3162083625793457, 3.776949405670166, 2.178292751312256, 1.4782459735870361, 2.5260846614837646, 1.4411405324935913, 2.0181262493133545, 2.251056671142578, 2.386596202850342, 2.8411307334899902, 2.706009864807129, 4.857481002807617, 1.9935778379440308, 2.4727039337158203, 1.6197032928466797, 2.2515017986297607, 1.712097406387329, 2.757042407989502, 2.380157470703125, 2.4313390254974365, 0.7664381861686707, 1.966360092163086, 4.5062336921691895, 2.667848825454712, 3.6787006855010986, 2.710740089416504, 2.1916966438293457, 2.945847749710083, 3.3162569999694824, 1.1259186267852783, 2.5210771560668945, 1.1426723003387451, 2.288848638534546, 4.333318710327148, 1.4808952808380127, 2.013308048248291, 2.277118682861328, 1.7708903551101685, 2.4406843185424805, 3.0704925060272217, 1.0272119045257568, 0.460753470659256, 1.7208915948867798, 1.0371735095977783, 2.9451375007629395, 1.0967589616775513, 2.8794021606445312, 2.546149730682373, 3.386293888092041, 3.217726945877075, 4.117137432098389, 2.875826835632324, 1.519029140472412, 2.222205638885498, 1.8473773002624512, 2.8454394340515137, 2.7591071128845215, 3.388756275177002, 2.1371371746063232, 2.384305238723755, 3.2269363403320312, 2.3533847332000732, 0.4830484390258789, 2.9437124729156494, 2.788816452026367, 1.9399863481521606, 2.0435924530029297, 1.9991486072540283, 2.186643600463867, 1.22324800491333, 4.643557548522949], "mean_td_error": 2.496406316757202, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 13.0, "diff_num_grad_updates_vs_sampler_policy": 12.0}}, "num_env_steps_sampled": 12544, "num_env_steps_trained": 3354, "num_agent_steps_sampled": 37632, "num_agent_steps_trained": 3354, "last_target_update_ts": 12544, "num_target_updates": 13}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37632, "num_agent_steps_trained": 3354, "num_env_steps_sampled": 12544, "num_env_steps_trained": 3354, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 890.1074446767291, "num_env_steps_trained_throughput_per_sec": 256.3032597395046, "timesteps_total": 12544, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 37632, "timers": {"training_iteration_time_ms": 927.412, "sample_time_ms": 636.732, "load_time_ms": 0.304, "load_throughput": 847865.261, "learn_time_ms": 18.181, "learn_throughput": 14190.776, "synch_weights_time_ms": 9.234}, "counters": {"num_env_steps_sampled": 12544, "num_env_steps_trained": 3354, "num_agent_steps_sampled": 37632, "num_agent_steps_trained": 3354, "last_target_update_ts": 12544, "num_target_updates": 13}, "done": false, "episodes_total": 0, "training_iteration": 8, "trial_id": "7066a_00000", "date": "2023-11-18_21-07-09", "timestamp": 1700370429, "time_this_iter_s": 2.025109052658081, "time_total_s": 13.197695255279541, "pid": 7187, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x312468860>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 13.197695255279541, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 72.83333333333333, "ram_util_percent": 64.30000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.109124183654785, "actor_loss": -4.3301801681518555, "critic_loss": 3.667257070541382, "alpha_loss": -0.04247967153787613, "alpha_value": 0.9958066940307617, "log_alpha_value": -0.004202112555503845, "target_entropy": -6.0, "policy_t": -0.0325423888862133, "mean_q": 0.38901376724243164, "max_q": 2.955069065093994, "min_q": 0.22320739924907684}, "td_error": [5.026076316833496, 5.2279253005981445, 3.4432101249694824, 2.913882255554199, 4.604488372802734, 4.895782947540283, 6.628594398498535, 2.208137035369873, 2.7367637157440186, 6.0304107666015625, 2.4564144611358643, 2.564441680908203, 4.932672500610352, 4.91941499710083, 5.072108268737793, 4.617420673370361, 4.493758201599121, 4.757366180419922, 3.7379136085510254, 5.107367515563965, 2.560084819793701, 4.5340375900268555, 4.475945949554443, 4.6048808097839355, 4.874034881591797, 5.42887020111084, 5.4894514083862305, 4.777466773986816, 3.5290608406066895, 5.224794387817383, 5.587091445922852, 5.81272029876709, 3.667693614959717, 6.1890716552734375, 2.423352003097534, 5.525844573974609, 5.248414993286133, 3.0810399055480957, 4.582776069641113, 2.835393190383911, 4.2400007247924805, 3.858412265777588, 4.712828159332275, 4.866513252258301, 3.3919506072998047, 3.0882532596588135, 5.910154342651367, 4.758678436279297, 2.254110813140869, 2.352259874343872, 3.6883974075317383, 4.255159378051758, 4.10128116607666, 4.733462333679199, 3.6567039489746094, 3.7954540252685547, 6.1651506423950195, 2.962785243988037, 3.143704891204834, 4.534278869628906, 4.88302755355835, 6.836629867553711, 3.1850712299346924, 5.7854413986206055, 5.718781471252441, 4.472716331481934, 4.6829423904418945, 3.7934367656707764, 5.107152938842773, 5.620566368103027, 2.9802026748657227, 3.7888431549072266, 3.4017510414123535, 1.8575620651245117, 5.616788864135742, 5.842918395996094, 3.258129119873047, 4.40106725692749, 3.518850803375244, 4.218036651611328, 4.5836639404296875, 4.250698089599609, 1.8601408004760742, 5.086750507354736, 4.270256996154785, 3.871849298477173], "mean_td_error": 4.30452299118042, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 15.0, "diff_num_grad_updates_vs_sampler_policy": 14.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.110464096069336, "actor_loss": -4.297144889831543, "critic_loss": 0.6776441931724548, "alpha_loss": -0.04249013960361481, "alpha_value": 0.9958062171936035, "log_alpha_value": -0.004202590323984623, "target_entropy": -6.0, "policy_t": 0.0035479660145938396, "mean_q": 0.3011602461338043, "max_q": 2.434544563293457, "min_q": 0.1894332319498062}, "td_error": [0.7118600606918335, 1.826397180557251, 0.8641993403434753, 3.2260937690734863, 0.9984725117683411, 2.6279852390289307, 1.5493247509002686, 1.4478578567504883, 1.9357216358184814, 2.0202927589416504, 1.5490005016326904, 5.151480674743652, 2.9549319744110107, 1.636566400527954, 2.032027006149292, 2.730198621749878, 1.7521785497665405, 3.166198492050171, 1.4753801822662354, 2.767711639404297, 2.7122113704681396, 1.3561086654663086, 2.4395904541015625, 1.1048305034637451, 2.422358751296997, 3.0294861793518066, 3.0437309741973877, 4.651210308074951, 2.821061611175537, 2.815866708755493, 2.2976016998291016, 1.2381795644760132, 2.876131534576416, 2.610670804977417, 4.408219337463379, 1.4496746063232422, 1.974470615386963, 3.3961639404296875, 2.190211296081543, 2.4017693996429443, 3.7350850105285645, 1.9060858488082886, 2.7964582443237305, 0.6786439418792725, 0.12879842519760132, 0.9665055871009827, 2.5668888092041016, 3.7412686347961426, 1.9421494007110596, 2.062652111053467, 3.1668920516967773, 1.4847402572631836, 1.1843993663787842, 4.433529853820801, 2.464901924133301, 2.572645902633667, 2.849705934524536, 1.1386308670043945, 2.627875566482544, 3.62841796875, 0.5490884780883789, 4.20089054107666, 3.429777145385742, 1.5500767230987549, 3.1089930534362793, 1.9814214706420898, 2.3545541763305664, 1.9975953102111816, 3.0393810272216797, 1.762350082397461, 2.794666051864624, 3.3651299476623535, 2.133174419403076, 2.3226068019866943, 2.9260921478271484, 2.469606876373291, 1.4630494117736816, 3.1215310096740723, 3.998868703842163, 0.6940231919288635, 2.6882920265197754, 1.9546021223068237, 3.1118521690368652, 0.6247813701629639, 1.1186814308166504, 2.0204296112060547], "mean_td_error": 2.331641912460327, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 15.0, "diff_num_grad_updates_vs_sampler_policy": 14.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.098703384399414, "actor_loss": -4.285446643829346, "critic_loss": 0.8586854934692383, "alpha_loss": -0.04241393879055977, "alpha_value": 0.9958088397979736, "log_alpha_value": -0.004199938848614693, "target_entropy": -6.0, "policy_t": -0.012395390309393406, "mean_q": 0.3607185184955597, "max_q": 3.4574692249298096, "min_q": 0.21635736525058746}, "td_error": [0.9738560318946838, 2.338554859161377, 4.647117614746094, 3.799044609069824, 1.4499262571334839, 2.794879674911499, 4.146511077880859, 2.424710273742676, 2.692277431488037, 1.2885208129882812, 1.683334231376648, 2.0716476440429688, 3.1035165786743164, 3.0872321128845215, 1.623525619506836, 1.7952886819839478, 2.016024589538574, 4.154971599578857, 1.5622998476028442, 1.6772544384002686, 2.382870674133301, 3.2787210941314697, 2.4791460037231445, 1.55243718624115, 1.0497214794158936, 1.4590643644332886, 3.6208415031433105, 4.784460067749023, 2.5647196769714355, 0.5621050000190735, 2.683340072631836, 2.2121429443359375, 3.5833587646484375, 2.4804933071136475, 3.141618251800537, 4.247148513793945, 4.395627021789551, 3.901547431945801, 2.7258167266845703, 3.1806488037109375, 5.222596168518066, 0.3010302782058716, 0.25749826431274414, 2.593505382537842, 2.326946258544922, 2.1782898902893066, 1.5925078392028809, 2.4569034576416016, 0.7333468198776245, 1.8377642631530762, 2.6740903854370117, 1.8116354942321777, 2.821906089782715, 4.748830795288086, 1.7343865633010864, 0.5207915306091309, 3.563546657562256, 3.39412784576416, 2.6865530014038086, 2.563570261001587, 2.042189121246338, 1.9260032176971436, 1.9606741666793823, 3.416958808898926, 2.7080397605895996, 1.340559482574463, 3.7019386291503906, 2.304020404815674, 2.3453292846679688, 3.457256317138672, 3.908304452896118, 2.9401278495788574, 0.6422771215438843, 3.5919013023376465, 2.5725531578063965, 3.4146347045898438, 3.184852361679077, 1.699874997138977, 3.3643252849578857, 3.3674306869506836, 4.324174880981445, 3.318603754043579, 0.6101272106170654, 0.4004734754562378, 2.7329013347625732, 2.5448107719421387], "mean_td_error": 2.5518195629119873, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 15.0, "diff_num_grad_updates_vs_sampler_policy": 14.0}}, "num_env_steps_sampled": 14336, "num_env_steps_trained": 3870, "num_agent_steps_sampled": 43008, "num_agent_steps_trained": 3870, "last_target_update_ts": 14336, "num_target_updates": 15}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 43008, "num_agent_steps_trained": 3870, "num_env_steps_sampled": 14336, "num_env_steps_trained": 3870, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 967.4322178329636, "num_env_steps_trained_throughput_per_sec": 278.5686520099382, "timesteps_total": 14336, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 43008, "timers": {"training_iteration_time_ms": 941.807, "sample_time_ms": 652.067, "load_time_ms": 0.325, "load_throughput": 794574.074, "learn_time_ms": 18.338, "learn_throughput": 14069.155, "synch_weights_time_ms": 9.941}, "counters": {"num_env_steps_sampled": 14336, "num_env_steps_trained": 3870, "num_agent_steps_sampled": 43008, "num_agent_steps_trained": 3870, "last_target_update_ts": 14336, "num_target_updates": 15}, "done": false, "episodes_total": 0, "training_iteration": 9, "trial_id": "7066a_00000", "date": "2023-11-18_21-07-10", "timestamp": 1700370430, "time_this_iter_s": 1.8631980419158936, "time_total_s": 15.060893297195435, "pid": 7187, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x31039e840>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 15.060893297195435, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 73.43333333333334, "ram_util_percent": 64.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.100513458251953, "actor_loss": -4.349318504333496, "critic_loss": 3.666916608810425, "alpha_loss": -0.04547698050737381, "alpha_value": 0.9955076575279236, "log_alpha_value": -0.004502442199736834, "target_entropy": -6.0, "policy_t": 0.010689984075725079, "mean_q": 0.33159103989601135, "max_q": 3.3115551471710205, "min_q": 0.24971166253089905}, "td_error": [3.218681812286377, 4.312707901000977, 4.309567451477051, 5.120722770690918, 4.896021366119385, 4.229062080383301, 4.89267110824585, 5.2449493408203125, 4.502806663513184, 4.212857723236084, 3.742237091064453, 5.38168478012085, 5.517538070678711, 3.2259716987609863, 4.809335708618164, 6.3512864112854, 5.630417346954346, 4.863615036010742, 1.861875295639038, 3.471153974533081, 3.733034610748291, 4.623848915100098, 1.7965577840805054, 2.9390435218811035, 3.561253309249878, 3.6003522872924805, 6.369406223297119, 4.4522294998168945, 4.484125137329102, 4.846529960632324, 4.836732864379883, 2.9167635440826416, 2.6954092979431152, 4.630839824676514, 5.767812252044678, 2.0430638790130615, 4.132737159729004, 3.6765670776367188, 3.767357349395752, 6.151350975036621, 3.388572931289673, 5.898677825927734, 5.674445152282715, 3.769219160079956, 4.12653923034668, 5.460302352905273, 3.89033842086792, 4.461273670196533, 4.652704238891602, 5.201659202575684, 6.004830360412598, 4.563692092895508, 4.703588485717773, 3.8275563716888428, 2.833916425704956, 4.553160190582275, 4.4712042808532715, 3.697047233581543, 2.327005624771118, 6.185737609863281, 0.7039323449134827, 3.443563222885132, 5.093871593475342, 3.01255202293396, 2.975832939147949, 2.783994674682617, 4.6216630935668945, 4.241623878479004, 5.7022905349731445, 4.465244293212891, 5.894327640533447, 3.8720884323120117, 4.81974983215332, 4.556421756744385, 4.785096168518066, 5.2963457107543945, 4.411145210266113, 3.4837069511413574, 5.1818132400512695, 4.19453239440918, 5.0895233154296875, 4.888065338134766, 4.566186904907227, 4.84381103515625, 5.48482608795166, 5.63442325592041], "mean_td_error": 4.355328559875488, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 16.0, "diff_num_grad_updates_vs_sampler_policy": 15.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.194437026977539, "actor_loss": -4.399982452392578, "critic_loss": 0.762597918510437, "alpha_loss": -0.045904044061899185, "alpha_value": 0.9955072999000549, "log_alpha_value": -0.004502852447330952, "target_entropy": -6.0, "policy_t": -0.01801621913909912, "mean_q": 0.25281354784965515, "max_q": 1.7331385612487793, "min_q": 0.2105535864830017}, "td_error": [4.837231636047363, 4.358183860778809, 4.701108932495117, 3.1760902404785156, 1.116382122039795, 3.1317267417907715, 3.287759780883789, 1.1665997505187988, 2.0907535552978516, 2.3439388275146484, 3.1911919116973877, 1.5287153720855713, 1.1240060329437256, 2.6896259784698486, 0.7348056435585022, 2.564695119857788, 2.2451891899108887, 2.746506929397583, 2.357074499130249, 3.1012401580810547, 1.6269512176513672, 1.5509610176086426, 0.14598003029823303, 3.2164435386657715, 1.5937778949737549, 4.084626197814941, 2.708540916442871, 1.8647663593292236, 3.7559189796447754, 0.6686177253723145, 2.874035596847534, 3.3332602977752686, 1.565302848815918, 1.9052116870880127, 0.8247888088226318, 0.9292578101158142, 2.5282139778137207, 2.6682443618774414, 0.8706757426261902, 2.123673915863037, 1.2585127353668213, 2.8400659561157227, 1.4116992950439453, 1.8224552869796753, 1.5332732200622559, 3.2645270824432373, 4.209693908691406, 3.9569950103759766, 3.0015673637390137, 2.6683425903320312, 3.1403889656066895, 3.732142686843872, 5.157927513122559, 5.137655258178711, 2.0826921463012695, 2.547591209411621, 2.236790657043457, 1.752469539642334, 2.196136236190796, 2.1202144622802734, 3.0266213417053223, 1.76829195022583, 1.2069172859191895, 3.344686508178711, 2.1569552421569824, 2.2261297702789307, 2.0660533905029297, 2.0254340171813965, 1.5886286497116089, 5.266069412231445, 3.1454601287841797, 2.7818331718444824, 4.7495880126953125, 4.249577522277832, 2.8331220149993896, 2.7598509788513184, 2.014375686645508, 0.1376912146806717, 2.690322160720825, 0.978851318359375, 3.698812484741211, 3.715273857116699, 2.800185203552246, 4.7173357009887695, 2.4402730464935303, 0.6715996861457825], "mean_td_error": 2.540269374847412, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 16.0, "diff_num_grad_updates_vs_sampler_policy": 15.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.125304222106934, "actor_loss": -4.341785907745361, "critic_loss": 0.7971347570419312, "alpha_loss": -0.04556415230035782, "alpha_value": 0.9955101013183594, "log_alpha_value": -0.00450002821162343, "target_entropy": -6.0, "policy_t": -0.005035197827965021, "mean_q": 0.3338380753993988, "max_q": 3.8118138313293457, "min_q": 0.240990549325943}, "td_error": [3.1602683067321777, 1.3264745473861694, 2.4050517082214355, 2.0306057929992676, 1.2957737445831299, 2.818655014038086, 2.02353572845459, 2.36116623878479, 2.430217742919922, 1.5792827606201172, 2.9307541847229004, 3.2077925205230713, 3.9005002975463867, 3.8925909996032715, 3.3579230308532715, 2.149005889892578, 3.1912341117858887, 4.2727813720703125, 0.8549584150314331, 0.5148308277130127, 3.92592453956604, 2.5305912494659424, 2.831789493560791, 0.8421463370323181, 2.8353536128997803, 4.094951629638672, 2.392871856689453, 4.22569465637207, 1.3666929006576538, 2.504612445831299, 3.477034091949463, 2.3638906478881836, 2.256021499633789, 3.508854866027832, 3.432373285293579, 1.8710335493087769, 3.253258228302002, 0.33601370453834534, 0.890863299369812, 2.5913283824920654, 2.0679893493652344, 1.4772558212280273, 3.973297595977783, 3.0384676456451416, 1.8197002410888672, 3.0084781646728516, 1.7316977977752686, 2.820431709289551, 4.32969856262207, 0.2120838463306427, 2.8335866928100586, 3.452066421508789, 2.400520086288452, 1.3189619779586792, 0.94419264793396, 1.6381630897521973, 1.4298863410949707, 1.7122936248779297, 2.6744697093963623, 3.507331371307373, 2.770479679107666, 2.5908260345458984, 2.9629440307617188, 2.2341196537017822, 1.1343050003051758, 2.033043384552002, 3.109011650085449, 3.2047507762908936, 2.286865711212158, 3.114597797393799, 1.5110692977905273, 2.6881778240203857, 0.43971532583236694, 1.1161985397338867, 3.872877836227417, 0.22788208723068237, 2.584174633026123, 0.45917201042175293, 2.555521011352539, 3.113530397415161, 1.7336702346801758, 1.886056661605835, 2.5986251831054688, 3.3856778144836426, 3.5072426795959473, 3.3735318183898926], "mean_td_error": 2.419992208480835, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 16.0, "diff_num_grad_updates_vs_sampler_policy": 15.0}}, "num_env_steps_sampled": 15232, "num_env_steps_trained": 4128, "num_agent_steps_sampled": 45696, "num_agent_steps_trained": 4128, "last_target_update_ts": 15232, "num_target_updates": 16}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 45696, "num_agent_steps_trained": 4128, "num_env_steps_sampled": 15232, "num_env_steps_trained": 4128, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 673.49892427525, "num_env_steps_trained_throughput_per_sec": 193.93160989175726, "timesteps_total": 15232, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 45696, "timers": {"training_iteration_time_ms": 990.927, "sample_time_ms": 683.184, "load_time_ms": 0.329, "load_throughput": 784493.571, "learn_time_ms": 18.511, "learn_throughput": 13937.975, "synch_weights_time_ms": 10.466}, "counters": {"num_env_steps_sampled": 15232, "num_env_steps_trained": 4128, "num_agent_steps_sampled": 45696, "num_agent_steps_trained": 4128, "last_target_update_ts": 15232, "num_target_updates": 16}, "done": false, "episodes_total": 0, "training_iteration": 10, "trial_id": "7066a_00000", "date": "2023-11-18_21-07-12", "timestamp": 1700370432, "time_this_iter_s": 1.3391330242156982, "time_total_s": 16.400026321411133, "pid": 7187, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x312468f40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 16.400026321411133, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 71.3, "ram_util_percent": 65.55}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.050137519836426, "actor_loss": -4.326186180114746, "critic_loss": 3.2482542991638184, "alpha_loss": -0.04826854169368744, "alpha_value": 0.995208740234375, "log_alpha_value": -0.0048027741722762585, "target_entropy": -6.0, "policy_t": -0.005890467204153538, "mean_q": 0.39879053831100464, "max_q": 2.698593854904175, "min_q": 0.2778793275356293}, "td_error": [3.527641773223877, 3.5885934829711914, 2.9027037620544434, 4.013926982879639, 3.5831527709960938, 4.043679237365723, 3.6295061111450195, 5.201376914978027, 3.9234585762023926, 4.6148762702941895, 3.1222169399261475, 5.157462120056152, 3.035721778869629, 4.317582130432129, 2.8406763076782227, 4.00171422958374, 5.688825607299805, 4.264408111572266, 6.084795951843262, 5.284664630889893, 3.3869636058807373, 2.5680408477783203, 4.5402727127075195, 4.374608993530273, 4.451931953430176, 4.2003631591796875, 3.8597586154937744, 4.768662452697754, 2.856060266494751, 5.299581050872803, 5.173357009887695, 5.377643585205078, 2.3410327434539795, 5.292451858520508, 4.897353172302246, 5.341787338256836, 4.802128791809082, 5.354804039001465, 4.21230411529541, 2.3570101261138916, 5.036802291870117, 6.384163856506348, 3.368588447570801, 4.394204139709473, 5.174357891082764, 3.4347715377807617, 2.987825393676758, 5.025827884674072, 3.3397796154022217, 3.38714599609375, 3.04241943359375, 4.729947090148926, 6.694644927978516, 4.548470973968506, 6.4373602867126465, 2.835176467895508, 4.243889808654785, 4.440258026123047, 4.104303359985352, 2.860872268676758, 1.2487479448318481, 3.840909719467163, 4.437832832336426, 5.914482116699219, 7.139858245849609, 3.4182615280151367, 6.0377044677734375, 3.2579293251037598, 4.486354827880859, 4.742242336273193, 3.886970043182373, 6.137239456176758, 3.4607362747192383, 3.154477834701538, 1.0060601234436035, 4.0253520011901855, 5.298985004425049, 1.8035874366760254, 4.360610008239746, 3.6140804290771484, 4.277168273925781, 3.966475009918213, 6.177704811096191, 5.713250160217285, 3.200314998626709, 4.240467548370361], "mean_td_error": 4.227926731109619, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 17.0, "diff_num_grad_updates_vs_sampler_policy": 16.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.042533874511719, "actor_loss": -4.272698402404785, "critic_loss": 0.7484383583068848, "alpha_loss": -0.04823684319853783, "alpha_value": 0.9952082633972168, "log_alpha_value": -0.0048032538034021854, "target_entropy": -6.0, "policy_t": 0.013447693549096584, "mean_q": 0.3595268726348877, "max_q": 2.711723804473877, "min_q": 0.2331571877002716}, "td_error": [1.9297006130218506, 2.080575466156006, 1.8323943614959717, 0.8611181378364563, 3.3770179748535156, 3.5033516883850098, 1.770156741142273, 1.3676953315734863, 2.5666518211364746, 3.421567440032959, 4.099855422973633, 2.124448299407959, 2.070413112640381, 3.270968437194824, 0.7944117784500122, 3.80100417137146, 3.6282668113708496, 2.800537109375, 2.0975892543792725, 0.05019985884428024, 3.3801608085632324, 3.398019313812256, 2.180826187133789, 4.267024993896484, 4.232741355895996, 3.0665671825408936, 1.9793872833251953, 2.9636125564575195, 0.496809184551239, 3.620706081390381, 1.9911208152770996, 3.361137866973877, 2.643366813659668, 2.5735878944396973, 2.4510059356689453, 2.761536121368408, 1.752298355102539, 3.266655445098877, 3.0203239917755127, 2.9024739265441895, 2.2641191482543945, 3.265990734100342, 1.0503121614456177, 2.1161398887634277, 1.7556276321411133, 2.0054187774658203, 1.6726274490356445, 3.6491222381591797, 2.1142916679382324, 0.6848037838935852, 5.769498348236084, 4.1263957023620605, 2.944979667663574, 4.195553779602051, 0.2581775188446045, 2.6863515377044678, 2.094503879547119, 1.8454580307006836, 2.501776695251465, 2.6722865104675293, 1.820091962814331, 3.945605754852295, 1.5914876461029053, 2.6692299842834473, 1.3518366813659668, 0.6557567119598389, 3.9526877403259277, 2.0103001594543457, 1.6736500263214111, 2.9276084899902344, 2.050248622894287, 3.6502137184143066, 1.7390062808990479, 3.6833810806274414, 2.5375185012817383, 3.456526756286621, 2.6276047229766846, 0.9756798148155212, 1.6089394092559814, 3.0896055698394775, 3.108229160308838, 1.4830703735351562, 0.9180392026901245, 3.2863311767578125, 0.9366833567619324, 1.52399742603302], "mean_td_error": 2.4733030796051025, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 17.0, "diff_num_grad_updates_vs_sampler_policy": 16.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.12978744506836, "actor_loss": -4.368006229400635, "critic_loss": 0.7512600421905518, "alpha_loss": -0.04862525314092636, "alpha_value": 0.9952113032341003, "log_alpha_value": -0.004800224211066961, "target_entropy": -6.0, "policy_t": -0.017627878114581108, "mean_q": 0.35165151953697205, "max_q": 3.420689821243286, "min_q": 0.2671223282814026}, "td_error": [1.838894009590149, 1.967695951461792, 2.3182880878448486, 0.918839693069458, 3.7649331092834473, 3.4043128490448, 2.2491209506988525, 0.11763643473386765, 1.425239086151123, 2.7314717769622803, 1.0320566892623901, 2.2739920616149902, 0.3167720437049866, 1.1795734167099, 2.8360838890075684, 4.051595211029053, 0.9535272121429443, 2.6312873363494873, 1.939391016960144, 4.352779388427734, 2.535065174102783, 2.878774404525757, 2.659822463989258, 2.9149951934814453, 1.9631532430648804, 4.30476188659668, 3.3212733268737793, 3.284672737121582, 2.1786913871765137, 1.3600749969482422, 1.8461267948150635, 3.54496693611145, 2.854520320892334, 2.7383880615234375, 1.6754578351974487, 3.288177013397217, 2.755387544631958, 2.0671563148498535, 1.9074773788452148, 1.7016246318817139, 0.9671140909194946, 2.6999528408050537, 1.544497013092041, 2.109346389770508, 0.4267275929450989, 1.418357253074646, 2.2149832248687744, 2.632077693939209, 1.1802005767822266, 1.67434823513031, 3.182281017303467, 1.9566380977630615, 2.876093864440918, 2.395834445953369, 3.2921574115753174, 2.226398468017578, 0.37685543298721313, 2.4662184715270996, 3.990694522857666, 1.8004318475723267, 2.013500452041626, 3.50062894821167, 2.3836145401000977, 0.4349236786365509, 2.0881640911102295, 2.6508283615112305, 1.2150744199752808, 2.9735159873962402, 2.559932231903076, 2.5843591690063477, 0.7509406208992004, 3.075634479522705, 3.7318663597106934, 1.553515911102295, 3.5756936073303223, 2.64107084274292, 0.6566486954689026, 2.0724167823791504, 2.4498541355133057, 4.79548454284668, 2.976163148880005, 0.41987067461013794, 2.0892090797424316, 1.953333854675293, 2.2590746879577637, 2.132962226867676], "mean_td_error": 2.2680647373199463, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 17.0, "diff_num_grad_updates_vs_sampler_policy": 16.0}}, "num_env_steps_sampled": 16128, "num_env_steps_trained": 4386, "num_agent_steps_sampled": 48384, "num_agent_steps_trained": 4386, "last_target_update_ts": 16128, "num_target_updates": 17}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48384, "num_agent_steps_trained": 4386, "num_env_steps_sampled": 16128, "num_env_steps_trained": 4386, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 731.610177413838, "num_env_steps_trained_throughput_per_sec": 210.66453769282387, "timesteps_total": 16128, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 48384, "timers": {"training_iteration_time_ms": 1024.686, "sample_time_ms": 716.808, "load_time_ms": 0.33, "load_throughput": 781886.15, "learn_time_ms": 18.486, "learn_throughput": 13956.454, "synch_weights_time_ms": 10.46}, "counters": {"num_env_steps_sampled": 16128, "num_env_steps_trained": 4386, "num_agent_steps_sampled": 48384, "num_agent_steps_trained": 4386, "last_target_update_ts": 16128, "num_target_updates": 17}, "done": false, "episodes_total": 0, "training_iteration": 11, "trial_id": "7066a_00000", "date": "2023-11-18_21-07-13", "timestamp": 1700370433, "time_this_iter_s": 1.2344489097595215, "time_total_s": 17.634475231170654, "pid": 7187, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x3124680e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 17.634475231170654, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 68.3, "ram_util_percent": 65.30000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.080538749694824, "actor_loss": -4.421180725097656, "critic_loss": 2.201315402984619, "alpha_loss": -0.05446817725896835, "alpha_value": 0.9946112632751465, "log_alpha_value": -0.005403300281614065, "target_entropy": -6.0, "policy_t": 0.006024334579706192, "mean_q": 0.45155563950538635, "max_q": 4.103494644165039, "min_q": 0.33948662877082825}, "td_error": [3.6238627433776855, 5.617524147033691, 4.846377372741699, 4.151601791381836, 3.8299121856689453, 4.890914440155029, 3.4768471717834473, 4.172847747802734, 2.8708996772766113, 3.1214070320129395, 4.062738418579102, 4.266263008117676, 4.508551120758057, 4.516544342041016, 0.36814606189727783, 6.5979485511779785, 6.736320495605469, 2.6810953617095947, 2.6653404235839844, 5.5576276779174805, 4.974944114685059, 5.4045000076293945, 4.552568435668945, 3.1874799728393555, 5.1082763671875, 2.205446720123291, 3.467998504638672, 6.359282493591309, 6.294114112854004, 3.6571290493011475, 4.437831401824951, 4.493656158447266, 2.679976463317871, 2.8768248558044434, 3.4238009452819824, 2.3004274368286133, 5.242187976837158, 4.5382537841796875, 2.696190357208252, 4.154593467712402, 4.733683109283447, 3.720714569091797, 2.8066582679748535, 5.7688446044921875, 4.190238952636719, 4.8472137451171875, 5.3284687995910645, 3.262688636779785, 3.4795074462890625, 3.9638829231262207, 4.929490089416504, 3.5064473152160645, 2.01806902885437, 5.019351959228516, 3.3213868141174316, 3.4420089721679688, 4.431673049926758, 4.457459449768066, 4.971670150756836, 3.6919784545898438, 3.306346893310547, 4.530075550079346, 3.162123680114746, 0.6308441162109375, 2.1450867652893066, 4.660309314727783, 3.7398128509521484, 4.657529830932617, 3.8837902545928955, 5.92860221862793, 3.763014554977417, 3.473745346069336, 3.91145658493042, 5.384303569793701, 3.2788360118865967, 3.3934218883514404, 4.563176155090332, 4.605862617492676, 4.098994255065918, 6.727860450744629, 5.300057411193848, 4.086299896240234, 3.7333385944366455, 3.422884464263916, 3.6841816902160645, 4.565442085266113], "mean_td_error": 4.083105564117432, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 19.0, "diff_num_grad_updates_vs_sampler_policy": 18.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.07953929901123, "actor_loss": -4.358700752258301, "critic_loss": 0.7781698107719421, "alpha_loss": -0.05446699634194374, "alpha_value": 0.9946108460426331, "log_alpha_value": -0.0054037184454500675, "target_entropy": -6.0, "policy_t": 0.01525957603007555, "mean_q": 0.38832709193229675, "max_q": 3.2604827880859375, "min_q": 0.2826805114746094}, "td_error": [1.781433343887329, 4.441878318786621, 0.8478431701660156, 2.649265766143799, 3.1136465072631836, 1.6221789121627808, 3.413634777069092, 0.037953197956085205, 2.921050548553467, 5.776427745819092, 1.5393507480621338, 1.6119657754898071, 4.747444152832031, 2.3305628299713135, 2.815560817718506, 1.9860336780548096, 3.4948794841766357, 5.0259246826171875, 2.815885066986084, 0.6359680891036987, 4.026950836181641, 2.833174705505371, 2.5102438926696777, 2.8804550170898438, 2.2133641242980957, 2.090541362762451, 2.0534915924072266, 0.8618818521499634, 2.290156364440918, 4.270569324493408, 1.331465721130371, 4.110669136047363, 5.088986396789551, 0.7158258557319641, 2.9434587955474854, 0.1773080825805664, 2.5678062438964844, 2.060080051422119, 1.433631420135498, 1.5849897861480713, 1.741066575050354, 2.142759323120117, 1.466878890991211, 0.16048967838287354, 3.115347385406494, 4.182324409484863, 1.391401767730713, 3.5288453102111816, 1.2254748344421387, 4.849850654602051, 3.1049017906188965, 3.804826259613037, 0.022059068083763123, 2.1624789237976074, 2.0946803092956543, 2.806032180786133, 2.508012056350708, 3.6141157150268555, 3.756847381591797, 2.1438539028167725, 3.236769199371338, 1.229687213897705, 2.0847408771514893, 2.1581954956054688, 2.926036834716797, 2.294065237045288, 0.5262718200683594, 3.04545259475708, 1.8088722229003906, 2.1058859825134277, 2.9726738929748535, 2.800985813140869, 3.5931098461151123, 0.8117697238922119, 3.440478801727295, 3.081209897994995, 2.6887502670288086, 4.872541427612305, 3.539426326751709, 3.510632038116455, 2.156742572784424, 4.134219169616699, 2.9754104614257812, 3.726773262023926, 2.194763422012329, 2.4813263416290283], "mean_td_error": 2.579918384552002, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 19.0, "diff_num_grad_updates_vs_sampler_policy": 18.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.113234519958496, "actor_loss": -4.403686046600342, "critic_loss": 0.8215982913970947, "alpha_loss": -0.05461987853050232, "alpha_value": 0.9946137070655823, "log_alpha_value": -0.005400831811130047, "target_entropy": -6.0, "policy_t": -0.015931542962789536, "mean_q": 0.41714149713516235, "max_q": 3.9570093154907227, "min_q": 0.32337167859077454}, "td_error": [1.1603310108184814, 2.8853957653045654, 0.39517730474472046, 2.4657959938049316, 3.097003221511841, 1.7828369140625, 3.4187088012695312, 0.5600786209106445, 1.9227993488311768, 1.782778024673462, 4.034495830535889, 2.659893751144409, 3.038106918334961, 1.9346833229064941, 4.101463317871094, 2.8043551445007324, 2.5348737239837646, 0.8343003392219543, 2.4615285396575928, 3.091046094894409, 0.1460612267255783, 3.1128692626953125, 1.5914674997329712, 2.4434444904327393, 2.4531302452087402, 3.8067450523376465, 2.3726444244384766, 4.1165008544921875, 1.2502974271774292, 1.3437919616699219, 4.644472122192383, 2.4541125297546387, 3.699510097503662, 2.255882740020752, 1.227786898612976, 2.2527413368225098, 2.430131196975708, 2.5491952896118164, 1.4925366640090942, 3.897111415863037, 5.3515753746032715, 0.7205336689949036, 2.3257946968078613, 1.9902077913284302, 3.3041207790374756, 2.5568361282348633, 0.5455448031425476, 1.079516887664795, 2.620738983154297, 4.06143856048584, 2.8832855224609375, 2.716634750366211, 1.9697227478027344, 2.756467342376709, 2.5624709129333496, 3.2297582626342773, 3.6444177627563477, 2.538264036178589, 2.7994768619537354, 3.0476784706115723, 3.032790422439575, 2.672813892364502, 1.477445363998413, 2.4029719829559326, 2.6050429344177246, 2.2382078170776367, 2.176680326461792, 2.686476707458496, 2.2184348106384277, 2.230768918991089, 2.203622817993164, 1.6601139307022095, 2.0442237854003906, 3.262258529663086, 2.5045862197875977, 2.4590115547180176, 2.184563636779785, 3.0566885471343994, 1.0212445259094238, 2.8091211318969727, 1.566390872001648, 3.8478574752807617, 2.9747397899627686, 2.15366792678833, 1.7491508722305298, 4.021914482116699], "mean_td_error": 2.4705970287323, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 19.0, "diff_num_grad_updates_vs_sampler_policy": 18.0}}, "num_env_steps_sampled": 17920, "num_env_steps_trained": 4902, "num_agent_steps_sampled": 53760, "num_agent_steps_trained": 4902, "last_target_update_ts": 17920, "num_target_updates": 19}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 53760, "num_agent_steps_trained": 4902, "num_env_steps_sampled": 17920, "num_env_steps_trained": 4902, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 932.6915474824737, "num_env_steps_trained_throughput_per_sec": 268.5652000563373, "timesteps_total": 17920, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 53760, "timers": {"training_iteration_time_ms": 1008.47, "sample_time_ms": 714.673, "load_time_ms": 0.333, "load_throughput": 775553.954, "learn_time_ms": 18.637, "learn_throughput": 13843.721, "synch_weights_time_ms": 10.848}, "counters": {"num_env_steps_sampled": 17920, "num_env_steps_trained": 4902, "num_agent_steps_sampled": 53760, "num_agent_steps_trained": 4902, "last_target_update_ts": 17920, "num_target_updates": 19}, "done": false, "episodes_total": 0, "training_iteration": 12, "trial_id": "7066a_00000", "date": "2023-11-18_21-07-15", "timestamp": 1700370435, "time_this_iter_s": 1.93068528175354, "time_total_s": 19.565160512924194, "pid": 7187, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x31039e840>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 19.565160512924194, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 69.46666666666665, "ram_util_percent": 64.89999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.088539123535156, "actor_loss": -4.4647393226623535, "critic_loss": 2.2499518394470215, "alpha_loss": -0.057540539652109146, "alpha_value": 0.9943127036094666, "log_alpha_value": -0.005703555420041084, "target_entropy": -6.0, "policy_t": 0.04366574063897133, "mean_q": 0.48432350158691406, "max_q": 4.93408203125, "min_q": 0.3723602294921875}, "td_error": [2.3128092288970947, 5.799715995788574, 4.902105808258057, 2.0712461471557617, 5.297729015350342, 5.839362621307373, 5.013823509216309, 5.72153902053833, 4.206873416900635, 3.696845531463623, 3.942276954650879, 3.6536989212036133, 4.758317947387695, 4.362438201904297, 5.76773738861084, 3.5729568004608154, 3.4321937561035156, 6.071127891540527, 4.272739410400391, 4.563509464263916, 5.667296409606934, 3.6558241844177246, 5.340034008026123, 3.119048595428467, 4.471340179443359, 3.7915754318237305, 3.983527660369873, 5.400046348571777, 4.770949840545654, 6.233503818511963, 5.638944149017334, 2.461040496826172, 4.5347394943237305, 5.109283447265625, 3.756563663482666, 5.257106781005859, 5.029944896697998, 3.188349962234497, 2.7876553535461426, 4.103092193603516, 0.3779933452606201, 4.973922252655029, 3.7068004608154297, 2.666564702987671, 4.593210697174072, 3.127312183380127, 3.3781113624572754, 6.34486198425293, 1.9276565313339233, 4.506075859069824, 6.264695167541504, 5.280983924865723, 3.389036178588867, 3.6371538639068604, 3.7295925617218018, 5.003677845001221, 4.536100387573242, 4.086459636688232, 4.9947662353515625, 4.505858421325684, 3.5363354682922363, 4.87554931640625, 4.5918378829956055, 4.814062118530273, 5.316835403442383, 3.3292551040649414, 5.340178489685059, 3.351890802383423, 4.095627784729004, 3.6059436798095703, 5.755509376525879, 5.624764919281006, 3.4497885704040527, 2.6415867805480957, 5.724053859710693, 0.37453174591064453, 4.671680450439453, 3.159883975982666, 4.222342014312744, 4.4865875244140625, 3.3680219650268555, 4.638096809387207, 4.721660614013672, 5.241761207580566, 5.0399675369262695, 4.197690010070801], "mean_td_error": 4.287967205047607, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 20.0, "diff_num_grad_updates_vs_sampler_policy": 19.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.137776374816895, "actor_loss": -4.438136100769043, "critic_loss": 0.7136393785476685, "alpha_loss": -0.057824622839689255, "alpha_value": 0.9943123459815979, "log_alpha_value": -0.005703875795006752, "target_entropy": -6.0, "policy_t": -0.025875307619571686, "mean_q": 0.45724108815193176, "max_q": 3.5486018657684326, "min_q": 0.309339702129364}, "td_error": [2.328883171081543, 2.1806724071502686, 3.273775577545166, 2.403446674346924, 0.5376018285751343, 2.5321578979492188, 2.7133371829986572, 3.814122200012207, 2.0930309295654297, 2.8337831497192383, 2.506129264831543, 2.524928331375122, 3.216616153717041, 0.967108964920044, 1.394300937652588, 1.6221753358840942, 3.1796228885650635, 1.9366230964660645, 1.8777984380722046, 1.188086986541748, 2.0518856048583984, 2.388643264770508, 4.522573471069336, 3.01847505569458, 3.6786375045776367, 2.446352958679199, 3.5781092643737793, 2.6567249298095703, 1.8672813177108765, 2.2700862884521484, 2.7395591735839844, 1.8842445611953735, 2.0333614349365234, 2.9699158668518066, 2.872495174407959, 1.7332823276519775, 0.7532666921615601, 3.3944954872131348, 2.7799830436706543, 1.6798914670944214, 2.0914461612701416, 2.879786968231201, 3.3944449424743652, 3.0076441764831543, 3.8599441051483154, 1.9561567306518555, 1.7176015377044678, 2.4467670917510986, 3.5000240802764893, 4.42929744720459, 0.07915949821472168, 3.730515718460083, 1.7073205709457397, 4.1464385986328125, 3.246175765991211, 1.445582628250122, 0.31800639629364014, 4.023340225219727, 2.019204616546631, 1.9745674133300781, 3.0285744667053223, 2.9153425693511963, 3.3687472343444824, 2.3192081451416016, 3.014118194580078, 0.9349620342254639, 1.8384132385253906, 3.5743441581726074, 0.4240199327468872, 1.8094894886016846, 2.5396411418914795, 1.9543509483337402, 2.6258373260498047, 3.6589834690093994, 1.9790931940078735, 0.6091152429580688, 2.051313877105713, 0.8978601694107056, 4.528216361999512, 3.4925923347473145, 1.972549319267273, 1.9603183269500732, 3.617375135421753, 1.2419123649597168, 3.145681858062744, 2.700979471206665], "mean_td_error": 2.4490692615509033, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 20.0, "diff_num_grad_updates_vs_sampler_policy": 19.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.120133399963379, "actor_loss": -4.437191963195801, "critic_loss": 0.8094924688339233, "alpha_loss": -0.05769683048129082, "alpha_value": 0.9943150281906128, "log_alpha_value": -0.005701192654669285, "target_entropy": -6.0, "policy_t": -0.0017344873631373048, "mean_q": 0.5524877309799194, "max_q": 4.6657304763793945, "min_q": 0.35375523567199707}, "td_error": [2.0982604026794434, 2.8898544311523438, 2.0216190814971924, 1.167325735092163, 3.0403664112091064, 1.4088389873504639, 0.14027516543865204, 2.725703239440918, 4.038384914398193, 3.9777958393096924, 3.472567558288574, 1.499569058418274, 1.6346914768218994, 3.2243239879608154, 2.834444761276245, 3.6287357807159424, 1.6201552152633667, 3.968985080718994, 2.6122350692749023, 2.177245616912842, 3.213270664215088, 1.4190292358398438, 1.0867698192596436, 2.1816015243530273, 3.205075740814209, 4.599208354949951, 3.2749338150024414, 2.5348622798919678, 2.1486473083496094, 2.4491024017333984, 1.806601643562317, 3.331658124923706, 0.8541281819343567, 3.5085396766662598, 4.2577972412109375, 1.7329062223434448, 3.195197582244873, 3.1772336959838867, 2.2580738067626953, 2.6013665199279785, 2.1763885021209717, 1.017749309539795, 3.4050064086914062, 2.885909080505371, 2.006033420562744, 5.918990135192871, 1.7494003772735596, 1.3524168729782104, 4.317376613616943, 2.1602132320404053, 3.080822229385376, 1.9477486610412598, 3.403151035308838, 0.8340802192687988, 3.1951887607574463, 0.8730467557907104, 2.1880128383636475, 3.064770460128784, 0.6072100400924683, 1.4257824420928955, 2.31904935836792, 2.7163991928100586, 2.037546157836914, 3.1364877223968506, 1.1441060304641724, 0.3511168956756592, 3.129511833190918, 1.6959308385849, 2.601555824279785, 1.4296985864639282, 3.992337226867676, 2.023369073867798, 1.8068597316741943, 0.7424739599227905, 3.368072986602783, 2.4752602577209473, 2.0964841842651367, 1.9252557754516602, 1.9748414754867554, 3.379516124725342, 2.2645225524902344, 2.1102981567382812, 3.518343448638916, 2.642939567565918, 2.7283926010131836, 0.9443675875663757], "mean_td_error": 2.432342052459717, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 20.0, "diff_num_grad_updates_vs_sampler_policy": 19.0}}, "num_env_steps_sampled": 18816, "num_env_steps_trained": 5160, "num_agent_steps_sampled": 56448, "num_agent_steps_trained": 5160, "last_target_update_ts": 18816, "num_target_updates": 20}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56448, "num_agent_steps_trained": 5160, "num_env_steps_sampled": 18816, "num_env_steps_trained": 5160, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 874.3260403352226, "num_env_steps_trained_throughput_per_sec": 251.75906072152617, "timesteps_total": 18816, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 56448, "timers": {"training_iteration_time_ms": 1023.979, "sample_time_ms": 731.735, "load_time_ms": 0.332, "load_throughput": 776722.963, "learn_time_ms": 18.799, "learn_throughput": 13724.208, "synch_weights_time_ms": 10.873}, "counters": {"num_env_steps_sampled": 18816, "num_env_steps_trained": 5160, "num_agent_steps_sampled": 56448, "num_agent_steps_trained": 5160, "last_target_update_ts": 18816, "num_target_updates": 20}, "done": false, "episodes_total": 0, "training_iteration": 13, "trial_id": "7066a_00000", "date": "2023-11-18_21-07-16", "timestamp": 1700370436, "time_this_iter_s": 1.0391652584075928, "time_total_s": 20.604325771331787, "pid": 7187, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x31039fd80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 20.604325771331787, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 91.1, "ram_util_percent": 64.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.053633689880371, "actor_loss": -4.504330158233643, "critic_loss": 1.881207823753357, "alpha_loss": -0.06337834149599075, "alpha_value": 0.9937158226966858, "log_alpha_value": -0.00630402285605669, "target_entropy": -6.0, "policy_t": 0.017351001501083374, "mean_q": 0.632915735244751, "max_q": 4.268004417419434, "min_q": 0.4417162835597992}, "td_error": [2.8769068717956543, 4.252606391906738, 4.147670745849609, 6.002000331878662, 5.919996738433838, 6.097947120666504, 4.67257022857666, 2.479860305786133, 4.663912773132324, 5.664638519287109, 4.402153015136719, 5.81326961517334, 3.740377426147461, 5.172703266143799, 4.67583703994751, 2.761319637298584, 5.45741081237793, 2.9187240600585938, 6.050488471984863, 5.289214134216309, 6.541683197021484, 5.184737205505371, 5.716470718383789, 3.398209571838379, 3.9217050075531006, 3.651005744934082, 3.7133545875549316, 3.1825170516967773, 0.32994818687438965, 1.9866327047348022, 3.896940231323242, 4.528848648071289, 1.29352867603302, 5.708266258239746, 3.5687150955200195, 4.674643516540527, 4.508284568786621, 2.949474334716797, 2.603851318359375, 4.790698528289795, 1.8439886569976807, 4.102395057678223, 3.2133002281188965, 4.696152687072754, 3.6546883583068848, 2.31181001663208, 3.3449456691741943, 4.009350776672363, 5.367538928985596, 3.057621955871582, 4.888919830322266, 2.851442813873291, 4.368185043334961, 2.9131674766540527, 6.300169467926025, 3.6521224975585938, 5.043825149536133, 4.778016567230225, 3.910172462463379, 0.47411131858825684, 2.481114387512207, 4.560570240020752, 3.69321346282959, 5.208335876464844, 2.713294506072998, 4.366684913635254, 3.1409473419189453, 5.154109954833984, 1.642795443534851, 4.058819770812988, 4.705972671508789, 3.5489039421081543, 5.4362993240356445, 3.917731761932373, 4.201481819152832, 4.606258869171143, 3.4277641773223877, 4.80357027053833, 4.51215934753418, 3.842506170272827, 2.682854175567627, 3.752800464630127, 5.418963432312012, 5.197388648986816, 4.961916923522949, 4.3576884269714355], "mean_td_error": 4.074246406555176, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 22.0, "diff_num_grad_updates_vs_sampler_policy": 21.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.054325103759766, "actor_loss": -4.426461219787598, "critic_loss": 0.647805392742157, "alpha_loss": -0.06338462978601456, "alpha_value": 0.9937156438827515, "log_alpha_value": -0.006304215174168348, "target_entropy": -6.0, "policy_t": 0.005553587805479765, "mean_q": 0.4528498947620392, "max_q": 2.5546746253967285, "min_q": 0.3684135377407074}, "td_error": [2.333549976348877, 2.1903772354125977, 3.715810775756836, 0.557546854019165, 1.632757544517517, 1.263653039932251, 2.9175751209259033, 0.40946391224861145, 2.1415467262268066, 1.5547528266906738, 2.9196720123291016, 3.5526535511016846, 1.1255733966827393, 2.114318370819092, 4.023776054382324, 2.5167160034179688, 2.0680413246154785, 1.9734270572662354, 0.16944631934165955, 0.47965455055236816, 4.138570785522461, 4.004874229431152, 2.767294406890869, 3.3627400398254395, 4.54050350189209, 0.845581591129303, 3.124208927154541, 1.528583288192749, 1.866887092590332, 2.3994174003601074, 5.3076090812683105, 2.5951991081237793, 2.770535469055176, 3.0199527740478516, 2.827918291091919, 1.429447889328003, 2.0418248176574707, 2.5452396869659424, 2.455761432647705, 2.2127654552459717, 2.5181331634521484, 1.701080560684204, 1.6821413040161133, 1.1417346000671387, 2.6077730655670166, 0.5795729160308838, 2.4618031978607178, 0.8066462278366089, 2.8274550437927246, 0.9440866112709045, 1.9611396789550781, 2.9857900142669678, 3.299891948699951, 1.720568299293518, 4.105344772338867, 2.653287410736084, 1.320581078529358, 0.7873437404632568, 1.4986979961395264, 0.2604287266731262, 3.019606351852417, 2.657747745513916, 3.3813750743865967, 1.6759686470031738, 3.859814405441284, 2.1459150314331055, 2.139535903930664, 3.5794482231140137, 0.5901508331298828, 0.41675978899002075, 2.6265783309936523, 3.376542568206787, 2.258880138397217, 0.8739700317382812, 1.1657381057739258, 1.2572859525680542, 2.9931349754333496, 4.220205783843994, 2.2545018196105957, 2.7193915843963623, 2.285358428955078, 0.7574938535690308, 2.8379006385803223, 2.096877336502075, 2.1869592666625977, 1.430678129196167], "mean_td_error": 2.2339134216308594, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 22.0, "diff_num_grad_updates_vs_sampler_policy": 21.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.097818374633789, "actor_loss": -4.482332229614258, "critic_loss": 0.7892081141471863, "alpha_loss": -0.06363614648580551, "alpha_value": 0.9937178492546082, "log_alpha_value": -0.006301970686763525, "target_entropy": -6.0, "policy_t": 0.015197175554931164, "mean_q": 0.5976171493530273, "max_q": 5.1618194580078125, "min_q": 0.41900068521499634}, "td_error": [1.8026024103164673, 1.9006123542785645, 2.5681490898132324, 1.8220733404159546, 1.6141438484191895, 4.7318010330200195, 2.5277230739593506, 1.7853875160217285, 2.4325616359710693, 0.20122432708740234, 2.477072238922119, 2.509641647338867, 2.4216840267181396, 1.6080708503723145, 2.542534828186035, 0.5116759538650513, 4.003670692443848, 2.5481393337249756, 3.661454677581787, 3.82700514793396, 2.9948503971099854, 4.870543479919434, 3.1854376792907715, 0.4739956855773926, 4.113401412963867, 2.69149112701416, 2.503274917602539, 1.8958594799041748, 4.020143508911133, 2.7585742473602295, 2.081340789794922, 1.0355665683746338, 2.2095611095428467, 3.0939383506774902, 2.180048704147339, 1.6171960830688477, 0.3619738817214966, 3.3880538940429688, 2.876213312149048, 1.6260194778442383, 0.8509462475776672, 3.328029155731201, 2.372436046600342, 3.0779805183410645, 2.8642008304595947, 2.6069533824920654, 2.0124197006225586, 3.3679869174957275, 2.5584959983825684, 1.391251564025879, 2.447120189666748, 0.14362965524196625, 2.3491930961608887, 2.2791950702667236, 2.60153865814209, 2.831479072570801, 0.9186973571777344, 3.546743392944336, 3.9652583599090576, 2.0263192653656006, 2.699239730834961, 1.7095390558242798, 3.877413749694824, 2.2305145263671875, 3.490112781524658, 1.7717702388763428, 2.580893039703369, 1.6539331674575806, 3.407275676727295, 2.0816128253936768, 1.7695268392562866, 2.9691569805145264, 0.4504373073577881, 3.419508457183838, 3.45361590385437, 4.112114906311035, 3.390657663345337, 3.9803919792175293, 1.9921815395355225, 0.9558050632476807, 1.4465224742889404, 2.835007667541504, 1.4651319980621338, 1.0842645168304443, 1.4578425884246826, 1.8990694284439087], "mean_td_error": 2.40928053855896, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 22.0, "diff_num_grad_updates_vs_sampler_policy": 21.0}}, "num_env_steps_sampled": 20608, "num_env_steps_trained": 5676, "num_agent_steps_sampled": 61824, "num_agent_steps_trained": 5676, "last_target_update_ts": 20608, "num_target_updates": 22}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 61824, "num_agent_steps_trained": 5676, "num_env_steps_sampled": 20608, "num_env_steps_trained": 5676, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 956.7528224502732, "num_env_steps_trained_throughput_per_sec": 275.4935582501903, "timesteps_total": 20608, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 61824, "timers": {"training_iteration_time_ms": 1029.184, "sample_time_ms": 737.743, "load_time_ms": 0.332, "load_throughput": 777504.262, "learn_time_ms": 18.785, "learn_throughput": 13734.136, "synch_weights_time_ms": 10.99}, "counters": {"num_env_steps_sampled": 20608, "num_env_steps_trained": 5676, "num_agent_steps_sampled": 61824, "num_agent_steps_trained": 5676, "last_target_update_ts": 20608, "num_target_updates": 22}, "done": false, "episodes_total": 0, "training_iteration": 14, "trial_id": "7066a_00000", "date": "2023-11-18_21-07-18", "timestamp": 1700370438, "time_this_iter_s": 1.883124828338623, "time_total_s": 22.48745059967041, "pid": 7187, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x3124684a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 22.48745059967041, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 67.7, "ram_util_percent": 64.86666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.10653018951416, "actor_loss": -4.586357593536377, "critic_loss": 1.8880391120910645, "alpha_loss": -0.06674525886774063, "alpha_value": 0.9934175610542297, "log_alpha_value": -0.006604171358048916, "target_entropy": -6.0, "policy_t": 0.037652257829904556, "mean_q": 0.5954392552375793, "max_q": 4.049947738647461, "min_q": 0.47835269570350647}, "td_error": [4.240788459777832, 3.2875828742980957, 5.339620113372803, 5.117671012878418, 1.431518316268921, 3.1524200439453125, 4.291163444519043, 4.190866470336914, 2.5532238483428955, 4.578548431396484, 4.731311798095703, 3.4546828269958496, 2.895691156387329, 5.162460803985596, 1.3088483810424805, 5.487909317016602, 4.540583610534668, 5.474077224731445, 5.139186382293701, 4.989262104034424, 3.7420027256011963, 4.138639450073242, 3.576046943664551, 4.584040641784668, 3.578307628631592, 4.858615398406982, 5.150749683380127, 4.688502311706543, 4.754055976867676, 5.394608020782471, 3.047473430633545, 3.0843966007232666, 3.3659560680389404, 3.259249687194824, 2.2368907928466797, 3.80397367477417, 4.2331132888793945, 1.9577598571777344, 6.169727325439453, 5.433680057525635, 3.1998772621154785, 4.622745513916016, 3.7505886554718018, 3.51779842376709, 4.71943473815918, 4.076641082763672, 2.152024269104004, 2.751856803894043, 3.002448081970215, 4.46284294128418, 3.9414100646972656, 3.4419069290161133, 4.968522071838379, 4.7928385734558105, 3.563678026199341, 3.6502180099487305, 4.194167137145996, 3.9539918899536133, 3.3814332485198975, 3.4450626373291016, 5.091094017028809, 4.431870460510254, 5.235536575317383, 1.8861665725708008, 5.711200714111328, 5.749425888061523, 5.068488121032715, 2.0385758876800537, 3.0175201892852783, 4.882117748260498, 5.447427749633789, 3.3234946727752686, 3.4802422523498535, 4.328271389007568, 4.328840255737305, 2.4346120357513428, 2.1287739276885986, 3.7349400520324707, 4.477290630340576, 2.567272663116455, 3.284414291381836, 3.4929921627044678, 4.121094226837158, 5.156644821166992, 4.084567070007324, 4.418659210205078], "mean_td_error": 3.9760029315948486, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 23.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.131291389465332, "actor_loss": -4.530007362365723, "critic_loss": 0.6124165654182434, "alpha_loss": -0.06690948456525803, "alpha_value": 0.993417501449585, "log_alpha_value": -0.006604240741580725, "target_entropy": -6.0, "policy_t": 0.02112257480621338, "mean_q": 0.677014172077179, "max_q": 4.529904365539551, "min_q": 0.4007098078727722}, "td_error": [1.7547760009765625, 1.6859604120254517, 2.3456497192382812, 1.3394806385040283, 1.1874232292175293, 2.885748863220215, 2.0788474082946777, 1.2633883953094482, 1.9949153661727905, 2.4571917057037354, 1.9419382810592651, 1.103240728378296, 2.1945042610168457, 1.9342641830444336, 4.551976203918457, 0.41695135831832886, 1.8931488990783691, 1.2527799606323242, 0.6612124443054199, 3.5893020629882812, 1.6174969673156738, 0.3295482397079468, 2.230908155441284, 2.7618229389190674, 3.988180637359619, 2.2913427352905273, 2.897411823272705, 2.3694310188293457, 2.0062975883483887, 4.0874199867248535, 1.7834155559539795, 3.0098721981048584, 2.6640138626098633, 2.4372613430023193, 1.8602584600448608, 4.4643144607543945, 3.042959451675415, 1.8355002403259277, 0.05063638091087341, 1.7848522663116455, 1.7872860431671143, 0.6985703706741333, 0.9610206484794617, 0.7412431836128235, 1.2609071731567383, 1.9637926816940308, 2.654259443283081, 1.716278076171875, 2.3281118869781494, 2.504520893096924, 3.6081581115722656, 1.8639795780181885, 3.6645519733428955, 1.2946314811706543, 2.345104455947876, 2.3033385276794434, 2.0575337409973145, 2.202596664428711, 3.948115825653076, 3.1980366706848145, 0.9443297386169434, 2.19736385345459, 2.73185396194458, 1.1683571338653564, 2.6570091247558594, 2.547102451324463, 0.49652421474456787, 1.271437644958496, 2.168750047683716, 3.640270233154297, 2.5996623039245605, 1.6230870485305786, 2.215268611907959, 2.947101593017578, 0.6442121267318726, 1.0664563179016113, 1.4618921279907227, 0.4374508261680603, 2.2714929580688477, 1.7868990898132324, 1.336310625076294, 2.6786816120147705, 2.6195383071899414, 1.5566105842590332, 3.777294635772705, 3.0565381050109863], "mean_td_error": 2.1052231788635254, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 23.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.119980812072754, "actor_loss": -4.527876377105713, "critic_loss": 0.7841695547103882, "alpha_loss": -0.0668155774474144, "alpha_value": 0.9934194087982178, "log_alpha_value": -0.006602342240512371, "target_entropy": -6.0, "policy_t": -0.015062066726386547, "mean_q": 0.5937045812606812, "max_q": 4.3074259757995605, "min_q": 0.4535332918167114}, "td_error": [2.71193790435791, 2.357814311981201, 2.362236976623535, 2.7927589416503906, 1.4012665748596191, 1.5672385692596436, 1.3844934701919556, 1.225456714630127, 2.8992443084716797, 1.8077852725982666, 1.1959915161132812, 1.3446711301803589, 2.3662261962890625, 1.7585430145263672, 1.7566872835159302, 1.3857049942016602, 3.9192235469818115, 2.298492431640625, 2.690427541732788, 2.483353853225708, 2.548165798187256, 2.2176740169525146, 2.00095272064209, 2.805009365081787, 3.2021539211273193, 2.544189929962158, 3.6616644859313965, 2.9157841205596924, 3.882744789123535, 4.167488098144531, 3.699551820755005, 2.444246292114258, 2.3584725856781006, 2.6492555141448975, 1.109532117843628, 4.157118797302246, 0.23230385780334473, 2.365954637527466, 1.3737123012542725, 0.948164165019989, 1.5235590934753418, 0.12619878351688385, 2.573503255844116, 1.7076103687286377, 1.1612021923065186, 0.8599718809127808, 2.922377109527588, 2.161402940750122, 4.546149253845215, 3.8678770065307617, 3.1531243324279785, 1.1265965700149536, 2.88501238822937, 2.996997594833374, 2.3805575370788574, 2.108031749725342, 2.511383056640625, 3.6990509033203125, 1.265791416168213, 3.265994071960449, 3.4706568717956543, 3.0316014289855957, 3.5303359031677246, 2.9661905765533447, 1.7765154838562012, 2.5064549446105957, 3.7460684776306152, 3.2063629627227783, 2.8667049407958984, 0.7849164009094238, 2.4182162284851074, 1.7955663204193115, 1.1889010667800903, 1.8454604148864746, 3.051950454711914, 2.0029165744781494, 3.5370631217956543, 0.9798058867454529, 2.4482321739196777, 0.7651785016059875, 2.444772720336914, 1.8014487028121948, 1.4089391231536865, 4.536299228668213, 4.242436408996582, 2.3912601470947266], "mean_td_error": 2.3788411617279053, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 23.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 21504, "num_env_steps_trained": 5934, "num_agent_steps_sampled": 64512, "num_agent_steps_trained": 5934, "last_target_update_ts": 21504, "num_target_updates": 23}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64512, "num_agent_steps_trained": 5934, "num_env_steps_sampled": 21504, "num_env_steps_trained": 5934, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 885.1199754301896, "num_env_steps_trained_throughput_per_sec": 254.86713578235367, "timesteps_total": 21504, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 64512, "timers": {"training_iteration_time_ms": 1023.862, "sample_time_ms": 731.954, "load_time_ms": 0.332, "load_throughput": 777783.679, "learn_time_ms": 18.724, "learn_throughput": 13779.151, "synch_weights_time_ms": 10.945}, "counters": {"num_env_steps_sampled": 21504, "num_env_steps_trained": 5934, "num_agent_steps_sampled": 64512, "num_agent_steps_trained": 5934, "last_target_update_ts": 21504, "num_target_updates": 23}, "done": false, "episodes_total": 0, "training_iteration": 15, "trial_id": "7066a_00000", "date": "2023-11-18_21-07-19", "timestamp": 1700370439, "time_this_iter_s": 1.021162986755371, "time_total_s": 23.50861358642578, "pid": 7187, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x312468720>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 23.50861358642578, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 76.3, "ram_util_percent": 64.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.062919616699219, "actor_loss": -4.589044094085693, "critic_loss": 1.960239291191101, "alpha_loss": -0.06947800517082214, "alpha_value": 0.9931194186210632, "log_alpha_value": -0.006904358975589275, "target_entropy": -6.0, "policy_t": 0.022163856774568558, "mean_q": 0.632882297039032, "max_q": 6.753783702850342, "min_q": 0.5164090991020203}, "td_error": [4.004782676696777, 4.3420610427856445, 4.989211082458496, 4.600411415100098, 3.5496976375579834, 5.891150951385498, 4.089448928833008, 3.245739221572876, 5.151880264282227, 4.410588264465332, 5.2067461013793945, 4.773292541503906, 2.8892016410827637, 4.099924087524414, 5.634042263031006, 3.831123113632202, 6.021276950836182, 3.812258720397949, 4.48249626159668, 2.9119129180908203, 4.368331432342529, 4.149932861328125, 3.8700296878814697, 3.9427943229675293, 6.8070783615112305, 4.463359832763672, 3.146677017211914, 4.017086982727051, 4.187719345092773, 5.614076614379883, 5.0583977699279785, 2.34948992729187, 6.190708637237549, 2.926290273666382, 4.585263252258301, 3.557532787322998, 3.8569464683532715, 6.000738143920898, 1.431736946105957, 3.98435378074646, 5.81689977645874, 6.500868797302246, 3.6633784770965576, 2.8091793060302734, 1.9460468292236328, 5.469247817993164, 3.7275099754333496, 6.135144233703613, 4.242031097412109, 4.417492866516113, 4.32137393951416, 3.072514772415161, 2.441053867340088, 6.008583068847656, 4.746175765991211, 3.3091635704040527, 6.245980739593506, 4.638720512390137, 4.2936811447143555, 3.1345341205596924, 3.926393747329712, 2.4143552780151367, 3.0387325286865234, 5.32108736038208, 2.8119704723358154, 4.431437015533447, 3.5627834796905518, 3.3716540336608887, 3.5669608116149902, 4.267107009887695, 3.4754221439361572, 5.427968978881836, 6.051339149475098, 3.7189273834228516, 3.42341685295105, 5.5489821434021, 3.396183490753174, 3.478717803955078, 6.810912132263184, 6.015467166900635, 3.4061622619628906, 3.7254695892333984, 4.246185302734375, 4.259262561798096, 3.9561808109283447, 2.945446491241455], "mean_td_error": 4.255626678466797, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 24.0, "diff_num_grad_updates_vs_sampler_policy": 23.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.089792251586914, "actor_loss": -4.523319721221924, "critic_loss": 0.6366414427757263, "alpha_loss": -0.06966327130794525, "alpha_value": 0.993119478225708, "log_alpha_value": -0.006904330104589462, "target_entropy": -6.0, "policy_t": 0.021830104291439056, "mean_q": 0.6207740902900696, "max_q": 5.272919654846191, "min_q": 0.4338437020778656}, "td_error": [3.1427948474884033, 2.0560450553894043, 4.0555267333984375, 1.8922654390335083, 2.4223427772521973, 3.5304670333862305, 3.55375599861145, 3.399533748626709, 0.9230600595474243, 2.3281688690185547, 1.795947551727295, 1.6848645210266113, 2.5340447425842285, 1.1780762672424316, 2.26888370513916, 3.7041265964508057, 0.6517955660820007, 3.1224465370178223, 3.9742631912231445, 1.6839818954467773, 1.8334991931915283, 1.6296943426132202, 3.4240057468414307, 1.1760447025299072, 2.4027605056762695, 2.0118215084075928, 1.415363073348999, 0.09639950096607208, 2.892387866973877, 1.3669546842575073, 0.09128043055534363, 2.869302272796631, 3.5571227073669434, 3.7702274322509766, 3.338134765625, 2.1091718673706055, 1.4085265398025513, 2.6045942306518555, 1.2575055360794067, 3.4365577697753906, 0.26041465997695923, 3.6594748497009277, 1.292465329170227, 2.089406967163086, 3.045448064804077, 3.228085994720459, 2.5821690559387207, 0.13181114196777344, 3.274747371673584, 3.614147901535034, 1.2598984241485596, 2.5609006881713867, 1.6340150833129883, 2.9166030883789062, 1.9376533031463623, 1.3739922046661377, 2.724421739578247, 2.5545544624328613, 0.12282833456993103, 1.7329463958740234, 1.7636072635650635, 1.378283977508545, 3.2196741104125977, 0.4108019769191742, 2.097017765045166, 1.4528189897537231, 3.2818284034729004, 0.9515612125396729, 0.6291416883468628, 3.606870651245117, 2.166665554046631, 2.9950485229492188, 3.0862226486206055, 1.5508519411087036, 3.4616332054138184, 2.0569229125976562, 1.319993019104004, 1.3632616996765137, 2.33811354637146, 2.2560060024261475, 1.012209177017212, 2.6319093704223633, 0.9130238890647888, 1.610304594039917, 2.40791654586792, 2.623297691345215], "mean_td_error": 2.17645001411438, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 24.0, "diff_num_grad_updates_vs_sampler_policy": 23.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.06179428100586, "actor_loss": -4.514451026916504, "critic_loss": 0.6547309160232544, "alpha_loss": -0.0694541484117508, "alpha_value": 0.9931210279464722, "log_alpha_value": -0.006902760826051235, "target_entropy": -6.0, "policy_t": 0.009548287838697433, "mean_q": 0.6527113914489746, "max_q": 4.998252868652344, "min_q": 0.4899574816226959}, "td_error": [3.1955509185791016, 0.765468418598175, 3.4254138469696045, 1.2019855976104736, 3.3679752349853516, 2.663329601287842, 0.21022240817546844, 2.229672908782959, 4.59514856338501, 0.8739686012268066, 2.1503219604492188, 1.9415936470031738, 2.337867259979248, 1.28654146194458, 3.47556209564209, 2.4733293056488037, 1.2674988508224487, 1.7034876346588135, 1.843889594078064, 1.3830865621566772, 0.30580925941467285, 2.9058797359466553, 3.039057970046997, 2.1567070484161377, 0.690090000629425, 3.027301549911499, 4.100461959838867, 0.3045322597026825, 1.7619354724884033, 2.5963337421417236, 0.5916320085525513, 3.678992509841919, 2.354262351989746, 0.7886670231819153, 2.8543450832366943, 2.7915191650390625, 2.3182308673858643, 1.8320094347000122, 2.6226534843444824, 1.5508573055267334, 3.047271728515625, 3.3972864151000977, 2.242372989654541, 2.67604923248291, 2.7183971405029297, 2.504948616027832, 1.1342768669128418, 2.855031728744507, 0.4592466354370117, 2.5340754985809326, 2.08770751953125, 1.9151012897491455, 3.565598249435425, 2.1877307891845703, 0.8511031866073608, 4.352282524108887, 1.9267158508300781, 3.953547477722168, 1.6631357669830322, 2.3906662464141846, 1.0152807235717773, 1.0626497268676758, 0.7013782262802124, 0.9095574021339417, 1.4723663330078125, 1.7862210273742676, 3.266983985900879, 0.2726253867149353, 3.478278160095215, 0.27209389209747314, 1.233816146850586, 2.3796355724334717, 0.8901891708374023, 1.97335684299469, 1.4987670183181763, 0.5153803825378418, 1.8076248168945312, 0.8434223532676697, 2.10254168510437, 2.6412770748138428, 1.859442949295044, 2.0269289016723633, 3.16900634765625, 2.816781520843506, 1.7599809169769287, 3.0684869289398193], "mean_td_error": 2.069183826446533, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 24.0, "diff_num_grad_updates_vs_sampler_policy": 23.0}}, "num_env_steps_sampled": 22400, "num_env_steps_trained": 6192, "num_agent_steps_sampled": 67200, "num_agent_steps_trained": 6192, "last_target_update_ts": 22400, "num_target_updates": 24}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 67200, "num_agent_steps_trained": 6192, "num_env_steps_sampled": 22400, "num_env_steps_trained": 6192, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 837.1813917037407, "num_env_steps_trained_throughput_per_sec": 241.06339180755035, "timesteps_total": 22400, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 67200, "timers": {"training_iteration_time_ms": 1039.011, "sample_time_ms": 748.168, "load_time_ms": 0.33, "load_throughput": 782055.671, "learn_time_ms": 18.779, "learn_throughput": 13738.6, "synch_weights_time_ms": 10.972}, "counters": {"num_env_steps_sampled": 22400, "num_env_steps_trained": 6192, "num_agent_steps_sampled": 67200, "num_agent_steps_trained": 6192, "last_target_update_ts": 22400, "num_target_updates": 24}, "done": false, "episodes_total": 0, "training_iteration": 16, "trial_id": "7066a_00000", "date": "2023-11-18_21-07-20", "timestamp": 1700370440, "time_this_iter_s": 1.079653263092041, "time_total_s": 24.588266849517822, "pid": 7187, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x31039fd80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 24.588266849517822, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 71.45, "ram_util_percent": 64.75}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.155759811401367, "actor_loss": -4.714095115661621, "critic_loss": 1.930514931678772, "alpha_loss": -0.0731671005487442, "alpha_value": 0.9928213953971863, "log_alpha_value": -0.007204493507742882, "target_entropy": -6.0, "policy_t": 0.006828428246080875, "mean_q": 0.8379600048065186, "max_q": 7.218549728393555, "min_q": 0.555546224117279}, "td_error": [5.394948959350586, 3.5821590423583984, 2.109482765197754, 4.556899547576904, 4.515523910522461, 3.7304062843322754, 4.084809303283691, 5.339194297790527, 1.7771527767181396, 1.2426402568817139, 4.084275245666504, 3.8969550132751465, 3.785858154296875, 4.626255989074707, 3.474238395690918, 7.366783618927002, 4.341325283050537, 3.634002208709717, 4.437109470367432, 4.732249736785889, 2.0436506271362305, 4.7707037925720215, 5.008693695068359, 5.996337890625, 4.676174163818359, 5.542640686035156, 4.516328811645508, 4.619541168212891, 4.412538051605225, 6.7558817863464355, 3.2705113887786865, 5.391007423400879, 4.885849952697754, 0.5003609657287598, 2.732795476913452, 3.9566800594329834, 5.578444957733154, 3.5747382640838623, 5.651588439941406, 3.5198678970336914, 6.031355857849121, 4.5427021980285645, 5.518166542053223, 5.133190631866455, 4.59822416305542, 5.099457740783691, 3.9768810272216797, 5.556656837463379, 4.8490095138549805, 3.097075939178467, 4.852585792541504, 2.1680550575256348, 3.3165483474731445, 3.4148898124694824, 0.3155539035797119, 2.549644947052002, 3.9414029121398926, 4.4596757888793945, 5.381031036376953, 3.844377040863037, 4.701546669006348, 4.931858062744141, 4.420823097229004, 3.696702718734741, 3.053875684738159, 3.058009147644043, 5.7357587814331055, 1.728947401046753, 3.2087368965148926, 3.6175570487976074, 2.848761796951294, 4.702533721923828, 3.247889995574951, 4.565350532531738, 2.3948326110839844, 5.429709434509277, 3.421949863433838, 4.45717716217041, 4.994970321655273, 5.178962230682373, 5.246957778930664, 2.9591755867004395, 4.627264976501465, 3.590996742248535, 1.770329236984253, 4.185173988342285], "mean_td_error": 4.099290370941162, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 25.0, "diff_num_grad_updates_vs_sampler_policy": 24.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.08669662475586, "actor_loss": -4.549041748046875, "critic_loss": 0.6627658605575562, "alpha_loss": -0.07266853004693985, "alpha_value": 0.9928215146064758, "log_alpha_value": -0.007204391993582249, "target_entropy": -6.0, "policy_t": 0.011641029268503189, "mean_q": 0.6921343803405762, "max_q": 5.538255214691162, "min_q": 0.4682057201862335}, "td_error": [1.4895858764648438, 1.1192610263824463, 3.7145285606384277, 2.8887362480163574, 0.9919916391372681, 3.128399133682251, 3.3830618858337402, 2.3798201084136963, 1.6868395805358887, 1.565036654472351, 2.476792335510254, 1.4101288318634033, 3.852024793624878, 2.1276473999023438, 0.9308044910430908, 3.661346435546875, 2.502371311187744, 0.07699579000473022, 1.94624662399292, 2.637885093688965, 3.4279232025146484, 2.4534547328948975, 2.600409984588623, 2.368837594985962, 4.627198219299316, 3.8199710845947266, 2.4348363876342773, 1.9730651378631592, 2.98801326751709, 1.900527000427246, 1.3527324199676514, 1.3440592288970947, 1.6306042671203613, 0.9633659720420837, 0.17561578750610352, 2.648552656173706, 2.229609966278076, 2.0966525077819824, 2.1226110458374023, 2.2605960369110107, 1.1197810173034668, 2.7618579864501953, 2.585941791534424, 2.0894765853881836, 4.279331207275391, 3.3348731994628906, 2.0344161987304688, 2.7325921058654785, 2.61234712600708, 1.4822194576263428, 3.243955612182617, 1.134359359741211, 1.8505558967590332, 2.5334067344665527, 2.8678805828094482, 2.0549466609954834, 2.5721449851989746, 1.5396679639816284, 2.7063851356506348, 1.7557997703552246, 0.8645302653312683, 3.238307476043701, 3.4648847579956055, 3.5402779579162598, 4.702462196350098, 2.6115965843200684, 0.6056766510009766, 0.7007983922958374, 1.4485464096069336, 2.6871109008789062, 0.815001368522644, 1.6899549961090088, 2.368673801422119, 1.7115473747253418, 1.2217228412628174, 3.5810766220092773, 2.370466709136963, 4.331770896911621, 2.9730944633483887, 1.9968254566192627, 2.539116859436035, 2.4336912631988525, 2.6320323944091797, 2.8901760578155518, 1.106483817100525, 1.7180767059326172], "mean_td_error": 2.28981351852417, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 25.0, "diff_num_grad_updates_vs_sampler_policy": 24.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.073771476745605, "actor_loss": -4.567591667175293, "critic_loss": 0.7211154699325562, "alpha_loss": -0.07256242632865906, "alpha_value": 0.9928227663040161, "log_alpha_value": -0.0072031039744615555, "target_entropy": -6.0, "policy_t": 0.06322478502988815, "mean_q": 0.7507344484329224, "max_q": 6.249898910522461, "min_q": 0.5277570486068726}, "td_error": [2.93961238861084, 2.0265040397644043, 2.809765100479126, 0.9922935366630554, 3.945620059967041, 0.6394679546356201, 2.3747525215148926, 3.541926860809326, 2.573817491531372, 3.012608528137207, 0.761182427406311, 2.322145462036133, 1.6197859048843384, 3.3632662296295166, 2.8889033794403076, 2.7313361167907715, 0.17246019840240479, 2.8968522548675537, 0.8993270397186279, 0.5818049907684326, 2.4976367950439453, 2.3283605575561523, 2.738724708557129, 0.9013363718986511, 2.000032901763916, 1.8421025276184082, 2.6779122352600098, 1.7872159481048584, 2.3491435050964355, 2.314183235168457, 3.8689050674438477, 3.1754724979400635, 1.5870165824890137, 1.8657475709915161, 2.024149179458618, 1.5765509605407715, 4.205087661743164, 0.9568793773651123, 2.4077095985412598, 3.360288619995117, 0.9344303607940674, 2.0185859203338623, 3.8416473865509033, 2.4858598709106445, 2.489025115966797, 1.9171215295791626, 1.8194563388824463, 1.3319774866104126, 3.8561513423919678, 1.6936007738113403, 3.5222678184509277, 2.345551013946533, 2.3687949180603027, 1.1905397176742554, 2.9412639141082764, 3.847431182861328, 2.028381824493408, 1.2326526641845703, 1.4530375003814697, 2.257464647293091, 1.2190653085708618, 3.072413444519043, 1.9976798295974731, 2.407726764678955, 0.3550160229206085, 3.2482800483703613, 2.2840723991394043, 2.100369453430176, 1.7395068407058716, 2.7825100421905518, 3.918447971343994, 1.149031162261963, 0.560623049736023, 1.327510118484497, 2.293633460998535, 2.1766395568847656, 2.3908870220184326, 2.5242810249328613, 3.149256706237793, 2.5400781631469727, 3.274524688720703, 3.131687641143799, 0.623443067073822, 2.373852014541626, 0.49776938557624817, 1.8858489990234375], "mean_td_error": 2.2111313343048096, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 25.0, "diff_num_grad_updates_vs_sampler_policy": 24.0}}, "num_env_steps_sampled": 23296, "num_env_steps_trained": 6450, "num_agent_steps_sampled": 69888, "num_agent_steps_trained": 6450, "last_target_update_ts": 23296, "num_target_updates": 25}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 69888, "num_agent_steps_trained": 6450, "num_env_steps_sampled": 23296, "num_env_steps_trained": 6450, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 848.9197409663974, "num_env_steps_trained_throughput_per_sec": 244.44340755505638, "timesteps_total": 23296, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 69888, "timers": {"training_iteration_time_ms": 1051.199, "sample_time_ms": 741.747, "load_time_ms": 0.309, "load_throughput": 833626.402, "learn_time_ms": 18.626, "learn_throughput": 13851.535, "synch_weights_time_ms": 10.363}, "counters": {"num_env_steps_sampled": 23296, "num_env_steps_trained": 6450, "num_agent_steps_sampled": 69888, "num_agent_steps_trained": 6450, "last_target_update_ts": 23296, "num_target_updates": 25}, "done": false, "episodes_total": 0, "training_iteration": 17, "trial_id": "7066a_00000", "date": "2023-11-18_21-07-21", "timestamp": 1700370441, "time_this_iter_s": 1.0649328231811523, "time_total_s": 25.653199672698975, "pid": 7187, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x312468d60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 25.653199672698975, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 72.8, "ram_util_percent": 64.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.111959457397461, "actor_loss": -4.768386363983154, "critic_loss": 1.7827293872833252, "alpha_loss": -0.07892533391714096, "alpha_value": 0.9922252297401428, "log_alpha_value": -0.0078051467426121235, "target_entropy": -6.0, "policy_t": 0.0029891682788729668, "mean_q": 0.8350878953933716, "max_q": 5.964660167694092, "min_q": 0.6372115612030029}, "td_error": [2.585723400115967, 4.63457727432251, 5.677200794219971, 2.470946788787842, 2.639606237411499, 4.216919898986816, 4.394506931304932, 3.554309606552124, 3.8671836853027344, 4.545407295227051, 4.508399963378906, 4.270848274230957, 5.03980827331543, 0.4159412384033203, 3.4970879554748535, 2.28159236907959, 2.810122489929199, 2.6208505630493164, 4.185206413269043, 5.335836410522461, 2.8355135917663574, 4.495367050170898, 5.050484657287598, 2.9947798252105713, 3.3197782039642334, 2.4328341484069824, 2.583467483520508, 4.839218616485596, 4.723153114318848, 4.146446228027344, 4.819980621337891, 5.215001583099365, 3.8537755012512207, 0.8099357485771179, 3.18520450592041, 4.052029132843018, 4.410445213317871, 5.343362808227539, 3.6950736045837402, 4.345300674438477, 2.5661778450012207, 3.8666937351226807, 3.9704477787017822, 3.4401023387908936, 4.405254364013672, 3.894473075866699, 4.821490287780762, 4.770950794219971, 3.9711568355560303, 5.302637577056885, 1.5286426544189453, 3.5945467948913574, 3.4321088790893555, 4.948216438293457, 3.5094239711761475, 4.667461395263672, 5.173614978790283, 3.8603339195251465, 5.002353191375732, 3.5333666801452637, 3.852806568145752, 3.380737543106079, 4.834080696105957, 4.078344345092773, 5.602518081665039, 3.9913177490234375, 5.507234573364258, 4.7442216873168945, 4.079516410827637, 3.8789515495300293, 1.4645549058914185, 5.5972747802734375, 3.017909526824951, 1.8918821811676025, 5.59716796875, 4.986820220947266, 2.8115806579589844, 2.2287025451660156, 5.656129837036133, 1.3684067726135254, 3.482497215270996, 3.576883316040039, 3.672184944152832, 4.528413772583008, 5.315237998962402, 3.6408567428588867], "mean_td_error": 3.880801200866699, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 27.0, "diff_num_grad_updates_vs_sampler_policy": 26.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.097321510314941, "actor_loss": -4.625035285949707, "critic_loss": 0.6052323579788208, "alpha_loss": -0.07880353182554245, "alpha_value": 0.9922260046005249, "log_alpha_value": -0.007804399821907282, "target_entropy": -6.0, "policy_t": 0.030926600098609924, "mean_q": 0.923641562461853, "max_q": 5.933476448059082, "min_q": 0.5403000116348267}, "td_error": [2.1246118545532227, 3.7952797412872314, 1.8926849365234375, 2.41194486618042, 2.4800970554351807, 0.16682982444763184, 0.5562032461166382, 1.6562652587890625, 2.0992064476013184, 2.97664475440979, 2.5370540618896484, 3.2904443740844727, 2.7589902877807617, 1.9647945165634155, 3.769658327102661, 2.82242488861084, 1.6475903987884521, 1.4925472736358643, 1.8657370805740356, 2.8268074989318848, 1.0313894748687744, 2.4131386280059814, 0.5625496506690979, 0.7280750274658203, 1.3877615928649902, 2.7393383979797363, 4.360287189483643, 0.6852958798408508, 2.620347499847412, 1.7536981105804443, 3.7286217212677, 3.4082915782928467, 1.6665477752685547, 3.559149742126465, 1.6904916763305664, 1.7395060062408447, 2.47265625, 1.5984389781951904, 2.13822340965271, 3.1692824363708496, 0.7749025821685791, 2.328885555267334, 0.7675588130950928, 1.3867815732955933, 0.48507165908813477, 2.7680420875549316, 3.247319221496582, 1.6612012386322021, 2.1638457775115967, 1.6128089427947998, 3.4531211853027344, 2.622638463973999, 1.3670763969421387, 1.6291172504425049, 3.155200481414795, 1.5940918922424316, 1.640045166015625, 2.44191312789917, 0.44294846057891846, 2.4544873237609863, 3.822482109069824, 1.3059650659561157, 0.7430732846260071, 1.993298888206482, 3.1487526893615723, 3.799158811569214, 0.9799858927726746, 3.423922538757324, 1.0754101276397705, 1.1880409717559814, 3.3405585289001465, 2.4530088901519775, 3.104639768600464, 0.8617127537727356, 3.1379683017730713, 2.950129508972168, 2.9376065731048584, 2.9197754859924316, 0.5375641584396362, 3.192999839782715, 1.662848711013794, 2.37510347366333, 0.384006530046463, 1.4694581031799316, 1.1170775890350342, 2.3484339714050293], "mean_td_error": 2.1262669563293457, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 27.0, "diff_num_grad_updates_vs_sampler_policy": 26.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.07862377166748, "actor_loss": -4.63257360458374, "critic_loss": 0.6618102788925171, "alpha_loss": -0.07864925265312195, "alpha_value": 0.992226779460907, "log_alpha_value": -0.007803570944815874, "target_entropy": -6.0, "policy_t": 0.0154950562864542, "mean_q": 0.8590101003646851, "max_q": 5.3971266746521, "min_q": 0.6082628965377808}, "td_error": [3.283514976501465, 2.1344738006591797, 3.310873508453369, 3.3016388416290283, 3.316136121749878, 1.497839093208313, 2.034343957901001, 1.9056501388549805, 2.7765088081359863, 3.1222267150878906, 2.228153705596924, 1.3241162300109863, 4.626212120056152, 2.4116122722625732, 1.7170230150222778, 3.651585340499878, 2.2594218254089355, 1.9174623489379883, 2.124624252319336, 2.82797908782959, 2.2042953968048096, 1.0081658363342285, 2.1953001022338867, 1.1996111869812012, 3.5790696144104004, 1.705481767654419, 2.648613452911377, 2.5877556800842285, 0.11642801761627197, 0.23780173063278198, 2.3527252674102783, 1.9043810367584229, 1.2037880420684814, 2.5263187885284424, 3.331857442855835, 1.2915315628051758, 1.0329828262329102, 3.9597580432891846, 1.3498165607452393, 2.3661282062530518, 0.05171757936477661, 0.99381422996521, 1.5892987251281738, 2.2832553386688232, 1.7096422910690308, 1.612959384918213, 1.1735734939575195, 2.404792308807373, 2.103825092315674, 3.228501081466675, 1.7325475215911865, 0.9331179857254028, 2.794245719909668, 2.3946480751037598, 1.4247496128082275, 1.1809767484664917, 3.73129940032959, 1.5718915462493896, 2.2601637840270996, 3.404512882232666, 3.1600136756896973, 1.975492238998413, 0.27090853452682495, 0.8070874214172363, 4.335074424743652, 3.0636773109436035, 2.2070348262786865, 4.000145435333252, 2.1926236152648926, 2.7387032508850098, 1.9880913496017456, 1.2831699848175049, 2.885373592376709, 0.7018420696258545, 0.6903653740882874, 1.8086086511611938, 2.9818849563598633, 1.8201218843460083, 0.04929324984550476, 1.777500867843628, 1.1884183883666992, 1.7953813076019287, 0.21751955151557922, 0.9907715916633606, 1.6802611351013184, 3.2557501792907715], "mean_td_error": 2.0816028118133545, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 27.0, "diff_num_grad_updates_vs_sampler_policy": 26.0}}, "num_env_steps_sampled": 25088, "num_env_steps_trained": 6966, "num_agent_steps_sampled": 75264, "num_agent_steps_trained": 6966, "last_target_update_ts": 25088, "num_target_updates": 27}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 75264, "num_agent_steps_trained": 6966, "num_env_steps_sampled": 25088, "num_env_steps_trained": 6966, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 1006.3447590344105, "num_env_steps_trained_throughput_per_sec": 289.7733792755334, "timesteps_total": 25088, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 75264, "timers": {"training_iteration_time_ms": 973.764, "sample_time_ms": 682.397, "load_time_ms": 0.307, "load_throughput": 840946.87, "learn_time_ms": 18.397, "learn_throughput": 14024.009, "synch_weights_time_ms": 10.025}, "counters": {"num_env_steps_sampled": 25088, "num_env_steps_trained": 6966, "num_agent_steps_sampled": 75264, "num_agent_steps_trained": 6966, "last_target_update_ts": 25088, "num_target_updates": 27}, "done": false, "episodes_total": 0, "training_iteration": 18, "trial_id": "7066a_00000", "date": "2023-11-18_21-07-23", "timestamp": 1700370443, "time_this_iter_s": 1.7896971702575684, "time_total_s": 27.442896842956543, "pid": 7187, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x312468720>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 27.442896842956543, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 62.56666666666666, "ram_util_percent": 64.56666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.073090553283691, "actor_loss": -4.8107099533081055, "critic_loss": 1.7627131938934326, "alpha_loss": -0.08467263728380203, "alpha_value": 0.991629421710968, "log_alpha_value": -0.008405824191868305, "target_entropy": -6.0, "policy_t": 0.04520827531814575, "mean_q": 1.4024832248687744, "max_q": 9.016988754272461, "min_q": 0.7245317101478577}, "td_error": [5.438200950622559, 5.257597923278809, 4.144161224365234, 1.940831184387207, 4.851740837097168, 0.8935351371765137, 2.576141357421875, 4.361030101776123, 5.476606845855713, 4.179431915283203, 1.2172634601593018, 4.297568321228027, 4.017153739929199, 5.517246723175049, 1.9223437309265137, 5.346019268035889, 5.754825592041016, 3.780965566635132, 5.54586124420166, 4.503439426422119, 4.315462112426758, 4.8142266273498535, 3.4692940711975098, 3.9443206787109375, 4.915815353393555, 4.601646900177002, 2.1847128868103027, 4.312436103820801, 1.5955497026443481, 4.198770523071289, 4.020818710327148, 3.882896900177002, 3.7610602378845215, 3.765364408493042, 3.101487159729004, 3.8361620903015137, 3.767146110534668, 4.749050140380859, 3.3939332962036133, 0.02545475959777832, 3.5208895206451416, 1.087526559829712, 4.950198173522949, 4.876096248626709, 3.8896074295043945, 2.2171692848205566, 4.161798477172852, 3.4655559062957764, 4.891465663909912, 3.0685057640075684, 4.596126556396484, 4.6109771728515625, 3.405613899230957, 2.880037784576416, 5.409346103668213, 5.128510475158691, 3.196580410003662, 2.5507946014404297, 3.1890804767608643, 2.0775721073150635, 3.2517266273498535, 4.145522594451904, 6.856302261352539, 4.623266220092773, 4.678768157958984, 4.903249263763428, 5.109256744384766, 3.0646305084228516, 3.9862804412841797, 2.0304343700408936, 4.181976795196533, 2.7288646697998047, 3.726994276046753, 4.860065460205078, 3.9112794399261475, 3.9626853466033936, 2.3400144577026367, 4.183127403259277, 0.8504849672317505, 4.651458740234375, 4.428640365600586, 4.993491172790527, 5.29945707321167, 4.204961776733398, 3.7320756912231445, 4.5894269943237305], "mean_td_error": 3.862156629562378, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 29.0, "diff_num_grad_updates_vs_sampler_policy": 28.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.110363006591797, "actor_loss": -4.700690269470215, "critic_loss": 0.6089011430740356, "alpha_loss": -0.08497178554534912, "alpha_value": 0.9916307926177979, "log_alpha_value": -0.008404424414038658, "target_entropy": -6.0, "policy_t": 0.0048723709769546986, "mean_q": 0.8608803749084473, "max_q": 5.074498176574707, "min_q": 0.6159956455230713}, "td_error": [1.6181215047836304, 0.8498836755752563, 0.8935309052467346, 3.2435426712036133, 0.8044424057006836, 0.561752200126648, 2.389291763305664, 3.9391121864318848, 2.06897234916687, 3.0785422325134277, 2.7088584899902344, 0.837695837020874, 1.281965732574463, 1.369217872619629, 0.6514573097229004, 2.712982416152954, 2.1241493225097656, 3.2742908000946045, 2.5213208198547363, 2.095731735229492, 2.128526449203491, 2.3253777027130127, 2.237020492553711, 2.423252582550049, 3.3855371475219727, 3.236704111099243, 4.0079569816589355, 1.621830940246582, 3.155150890350342, 2.2245547771453857, 2.86421275138855, 3.7508037090301514, 2.8126325607299805, 3.786733627319336, 1.9517896175384521, 2.2811598777770996, 1.6942591667175293, 1.1379189491271973, 3.0407752990722656, 1.5107039213180542, 0.37942102551460266, 0.88767409324646, 2.861259698867798, 1.6858317852020264, 0.8836366534233093, 1.1910314559936523, 1.8187694549560547, 2.4883358478546143, 3.088008165359497, 2.1836695671081543, 3.9386935234069824, 0.9558421969413757, 3.036029815673828, 3.4982566833496094, 1.715497374534607, 1.6819933652877808, 2.568312644958496, 1.4390935897827148, 3.696822166442871, 0.226808100938797, 2.50826096534729, 1.9829460382461548, 2.289604663848877, 1.6438852548599243, 3.312018632888794, 3.9593591690063477, 2.145378828048706, 1.5498569011688232, 2.8786182403564453, 1.456088662147522, 1.4028748273849487, 0.3784295916557312, 0.7423382997512817, 1.1474831104278564, 2.25689697265625, 0.4826602339744568, 0.6601244807243347, 3.473763942718506, 1.327240228652954, 0.8220043182373047, 3.586576461791992, 3.61143159866333, 1.75448477268219, 2.687553882598877, 0.07749691605567932, 1.3122466802597046], "mean_td_error": 2.0962369441986084, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 29.0, "diff_num_grad_updates_vs_sampler_policy": 28.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.118315696716309, "actor_loss": -4.752774238586426, "critic_loss": 0.6603004932403564, "alpha_loss": -0.08503391593694687, "alpha_value": 0.991631269454956, "log_alpha_value": -0.00840395875275135, "target_entropy": -6.0, "policy_t": -0.009185179136693478, "mean_q": 0.9105932712554932, "max_q": 6.67390775680542, "min_q": 0.692326545715332}, "td_error": [2.9109444618225098, 2.2960219383239746, 2.463312864303589, 2.2943801879882812, 2.3402886390686035, 4.712027072906494, 1.4400287866592407, 2.2979471683502197, 1.7334575653076172, 2.230344533920288, 2.6211140155792236, 2.7170252799987793, 2.01336932182312, 3.7430567741394043, 3.4974842071533203, 2.4736528396606445, 2.3422203063964844, 1.840205430984497, 0.2757980227470398, 0.5462679862976074, 1.7707809209823608, 0.4961535334587097, 2.7519404888153076, 0.8767023086547852, 0.7427107095718384, 1.025434970855713, 2.5010085105895996, 2.9013519287109375, 1.6951642036437988, 3.076530694961548, 1.3753275871276855, 2.9420700073242188, 2.2893319129943848, 1.488800287246704, 0.42991015315055847, 2.9601285457611084, 2.256971597671509, 1.5848698616027832, 1.559773564338684, 3.2394895553588867, 2.794539451599121, 1.2011594772338867, 0.6714562177658081, 1.5492123365402222, 4.3923139572143555, 2.757460117340088, 3.4476261138916016, 3.610851287841797, 2.820333957672119, 2.5185282230377197, 1.8021454811096191, 2.5739574432373047, 3.518449306488037, 1.7005722522735596, 0.623579740524292, 0.9290634393692017, 2.3162753582000732, 1.1038540601730347, 2.0549678802490234, 0.6159000992774963, 0.9698728322982788, 0.0532400906085968, 3.695056438446045, 2.7672553062438965, 0.36281442642211914, 1.2056794166564941, 1.0848270654678345, 2.7358195781707764, 0.9821259379386902, 4.557100296020508, 2.15521240234375, 4.461984634399414, 1.967366337776184, 2.5013108253479004, 1.9641656875610352, 1.1851246356964111, 3.0289547443389893, 1.6273746490478516, 1.1143920421600342, 0.3032914996147156, 0.0777958333492279, 1.0808906555175781, 3.1192121505737305, 3.712825298309326, 3.0481910705566406, 1.0128753185272217], "mean_td_error": 2.075935125350952, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 29.0, "diff_num_grad_updates_vs_sampler_policy": 28.0}}, "num_env_steps_sampled": 26880, "num_env_steps_trained": 7482, "num_agent_steps_sampled": 80640, "num_agent_steps_trained": 7482, "last_target_update_ts": 26880, "num_target_updates": 29}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80640, "num_agent_steps_trained": 7482, "num_env_steps_sampled": 26880, "num_env_steps_trained": 7482, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 912.4556431190517, "num_env_steps_trained_throughput_per_sec": 262.73834366597697, "timesteps_total": 26880, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 80640, "timers": {"training_iteration_time_ms": 978.025, "sample_time_ms": 686.372, "load_time_ms": 0.305, "load_throughput": 846207.72, "learn_time_ms": 18.229, "learn_throughput": 14153.266, "synch_weights_time_ms": 10.325}, "counters": {"num_env_steps_sampled": 26880, "num_env_steps_trained": 7482, "num_agent_steps_sampled": 80640, "num_agent_steps_trained": 7482, "last_target_update_ts": 26880, "num_target_updates": 29}, "done": false, "episodes_total": 0, "training_iteration": 19, "trial_id": "7066a_00000", "date": "2023-11-18_21-07-25", "timestamp": 1700370445, "time_this_iter_s": 1.9721171855926514, "time_total_s": 29.415014028549194, "pid": 7187, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x312469580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 29.415014028549194, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 64.26666666666667, "ram_util_percent": 64.86666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.11439037322998, "actor_loss": -4.937077045440674, "critic_loss": 1.2184367179870605, "alpha_loss": -0.09109267592430115, "alpha_value": 0.991034209728241, "log_alpha_value": -0.00900624506175518, "target_entropy": -6.0, "policy_t": 0.04775464907288551, "mean_q": 1.4189717769622803, "max_q": 9.623658180236816, "min_q": 0.8110020160675049}, "td_error": [4.404607772827148, 4.520610809326172, 2.96781063079834, 5.245905876159668, 0.6192482709884644, 5.72605037689209, 5.063665390014648, 4.010878562927246, 2.2582380771636963, 4.4995880126953125, 4.269816875457764, 2.4018774032592773, 2.753787040710449, 3.4560370445251465, 4.608287811279297, 3.151106357574463, 3.248265266418457, 3.5265259742736816, 3.2747621536254883, 2.0881423950195312, 1.3216829299926758, 3.615558624267578, 4.21103048324585, 3.706115961074829, 1.8679327964782715, 2.699453830718994, 3.8008460998535156, 3.5839955806732178, 2.9545321464538574, 1.565873384475708, 4.129818439483643, 5.791311264038086, 4.889835357666016, 3.0328540802001953, 2.598017454147339, 4.5092573165893555, 4.989255428314209, 2.6946685314178467, 2.7303519248962402, 3.0748183727264404, 4.512055397033691, 3.080842971801758, 3.8401131629943848, 5.133317947387695, 1.566612720489502, 4.087503910064697, 4.742287635803223, 4.810271263122559, 5.396005630493164, 4.328916549682617, 5.072162628173828, 4.427196502685547, 3.0956716537475586, 5.169157028198242, 4.16774845123291, 5.994809150695801, 3.475294589996338, 5.276279926300049, 0.5512814521789551, 3.491506338119507, 3.8313164710998535, 0.4466724395751953, 2.113107204437256, 4.1238179206848145, 3.069899559020996, 3.2913384437561035, 4.148226737976074, 3.351837635040283, 4.659499168395996, 4.789422988891602, 4.549995422363281, 2.3844356536865234, 1.8720457553863525, 3.527651309967041, 3.003938674926758, 1.892953634262085, 5.016068458557129, 3.931342124938965, 3.339907646179199, 4.466113090515137, 4.659454345703125, 3.213886022567749, 4.772014141082764, 4.746164798736572, 3.566396951675415, 1.7845418453216553], "mean_td_error": 3.635272979736328, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 31.0, "diff_num_grad_updates_vs_sampler_policy": 30.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.067718505859375, "actor_loss": -4.743422508239746, "critic_loss": 0.6232898235321045, "alpha_loss": -0.09065508842468262, "alpha_value": 0.9910358786582947, "log_alpha_value": -0.009004531428217888, "target_entropy": -6.0, "policy_t": 0.006173267029225826, "mean_q": 0.9751327633857727, "max_q": 6.383630752563477, "min_q": 0.6997738480567932}, "td_error": [1.149939775466919, 2.523454189300537, 0.3572384715080261, 2.8968091011047363, 2.936978816986084, 2.269808769226074, 2.6597065925598145, 1.487574577331543, 1.4115365743637085, 1.7979507446289062, 1.907911777496338, 1.8711824417114258, 1.8088643550872803, 2.8909928798675537, 2.5259323120117188, 2.0277116298675537, 1.7270677089691162, 3.5893144607543945, 0.7523772716522217, 3.139702320098877, 1.8262250423431396, 3.5514416694641113, 1.77016019821167, 0.9856683611869812, 2.6594905853271484, 2.891968250274658, 4.637797832489014, 1.8544948101043701, 1.2791666984558105, 1.4698200225830078, 1.3725519180297852, 0.7927080392837524, 1.876600742340088, 1.7639150619506836, 2.9697303771972656, 2.8197009563446045, 2.0626235008239746, 2.763360023498535, 2.529552459716797, 1.3241548538208008, 2.5605340003967285, 1.6042650938034058, 0.8902916312217712, 1.1192938089370728, 2.0081372261047363, 1.5772194862365723, 0.9560847282409668, 3.9673376083374023, 1.3250311613082886, 4.264800071716309, 2.41023850440979, 1.9942452907562256, 0.7983101606369019, 2.054898500442505, 2.511869430541992, 1.6875512599945068, 1.3286693096160889, 1.3097445964813232, 3.8294312953948975, 2.139190673828125, 2.275456428527832, 1.8020930290222168, 4.583548545837402, 2.8480453491210938, 3.110111713409424, 2.9491734504699707, 2.609558343887329, 3.682290554046631, 2.68105411529541, 3.6277213096618652, 2.648712635040283, 2.3911895751953125, 1.4682345390319824, 1.649733543395996, 1.688671588897705, 0.024789631366729736, 2.103158950805664, 3.588378667831421, 0.670577883720398, 3.9905261993408203, 2.0182671546936035, 0.8716270327568054, 2.12750244140625, 0.13537025451660156, 0.8973754644393921, 1.1291252374649048], "mean_td_error": 2.126077175140381, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 31.0, "diff_num_grad_updates_vs_sampler_policy": 30.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.118118286132812, "actor_loss": -4.841250419616699, "critic_loss": 0.5619902014732361, "alpha_loss": -0.09110939502716064, "alpha_value": 0.9910358190536499, "log_alpha_value": -0.009004578925669193, "target_entropy": -6.0, "policy_t": -0.020145094022154808, "mean_q": 1.0994895696640015, "max_q": 5.573833465576172, "min_q": 0.7826409935951233}, "td_error": [1.0921952724456787, 0.7425730228424072, 1.3262076377868652, 2.436436891555786, 0.8522888422012329, 0.7842572927474976, 3.091167688369751, 2.6170639991760254, 2.068049907684326, 1.2324402332305908, 0.8215664625167847, 1.9980775117874146, 0.18274378776550293, 2.655992031097412, 2.89087176322937, 1.330290675163269, 1.5287108421325684, 1.798952579498291, 3.1407527923583984, 2.252842903137207, 2.813002586364746, 0.7584195137023926, 0.17498880624771118, 3.504500389099121, 2.6369786262512207, 1.7176709175109863, 0.18762287497520447, 2.569563865661621, 0.7718062400817871, 2.1918227672576904, 2.4840705394744873, 0.5934244394302368, 3.0926449298858643, 1.935624361038208, 1.6195504665374756, 3.5082459449768066, 2.575484275817871, 0.3154221475124359, 3.009446382522583, 3.6631171703338623, 1.6910111904144287, 2.686582565307617, 1.9954378604888916, 1.2268407344818115, 0.31264060735702515, 0.08964338898658752, 1.1441304683685303, 0.574541449546814, 1.2215999364852905, 1.3415837287902832, 1.3828336000442505, 0.9691631197929382, 1.2071120738983154, 1.3203742504119873, 2.9195210933685303, 0.912163496017456, 2.181001901626587, 2.938258647918701, 1.7629984617233276, 1.189071536064148, 1.9580376148223877, 1.564941644668579, 1.729081392288208, 3.6318931579589844, 1.5355994701385498, 3.9758429527282715, 3.2008323669433594, 2.584822177886963, 1.8950618505477905, 0.05764365196228027, 1.471208930015564, 0.3757935166358948, 1.54437255859375, 2.1272406578063965, 2.3916220664978027, 0.24362224340438843, 1.4966059923171997, 0.7071921825408936, 3.1818037033081055, 3.5364532470703125, 0.25393497943878174, 2.004375457763672, 1.8418519496917725, 3.0897202491760254, 1.2669546604156494, 0.8799396753311157], "mean_td_error": 1.7741843461990356, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 31.0, "diff_num_grad_updates_vs_sampler_policy": 30.0}}, "num_env_steps_sampled": 28672, "num_env_steps_trained": 7998, "num_agent_steps_sampled": 86016, "num_agent_steps_trained": 7998, "last_target_update_ts": 28672, "num_target_updates": 31}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 86016, "num_agent_steps_trained": 7998, "num_env_steps_sampled": 28672, "num_env_steps_trained": 7998, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 984.2033608451885, "num_env_steps_trained_throughput_per_sec": 283.397842743369, "timesteps_total": 28672, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 86016, "timers": {"training_iteration_time_ms": 960.584, "sample_time_ms": 667.925, "load_time_ms": 0.306, "load_throughput": 843240.421, "learn_time_ms": 18.184, "learn_throughput": 14187.967, "synch_weights_time_ms": 10.34}, "counters": {"num_env_steps_sampled": 28672, "num_env_steps_trained": 7998, "num_agent_steps_sampled": 86016, "num_agent_steps_trained": 7998, "last_target_update_ts": 28672, "num_target_updates": 31}, "done": false, "episodes_total": 0, "training_iteration": 20, "trial_id": "7066a_00000", "date": "2023-11-18_21-07-27", "timestamp": 1700370447, "time_this_iter_s": 1.8291089534759521, "time_total_s": 31.244122982025146, "pid": 7187, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x312468d60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 31.244122982025146, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 71.95, "ram_util_percent": 65.05}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.125101089477539, "actor_loss": -4.993957996368408, "critic_loss": 1.3231444358825684, "alpha_loss": -0.0942290872335434, "alpha_value": 0.9907366633415222, "log_alpha_value": -0.009306482039391994, "target_entropy": -6.0, "policy_t": 0.03465797379612923, "mean_q": 1.1662321090698242, "max_q": 8.975116729736328, "min_q": 0.8533412218093872}, "td_error": [2.670729398727417, 3.796616554260254, 3.705810070037842, 3.4622695446014404, 4.7002058029174805, 2.4884042739868164, 2.9785141944885254, 3.970036745071411, 4.806466102600098, 4.0038862228393555, 4.551843643188477, 6.43405818939209, 3.6350765228271484, 5.3194475173950195, 3.6087589263916016, 4.78055477142334, 3.5572094917297363, 3.9497175216674805, 1.0090045928955078, 4.190010070800781, 3.762305736541748, 1.4681600332260132, 3.328601360321045, 3.274026393890381, 4.032514572143555, 4.0219950675964355, 6.738940238952637, 3.227944850921631, 3.9121837615966797, 3.803173542022705, 3.701967716217041, 4.201562881469727, 2.332742691040039, 3.354426860809326, 2.5054900646209717, 2.9360713958740234, 5.115194320678711, 3.7999374866485596, 3.4459424018859863, 3.798055410385132, 6.286801338195801, 5.894171714782715, 3.8442697525024414, 4.738325119018555, 2.4789624214172363, 2.8762378692626953, 2.0116429328918457, 2.934019088745117, 3.131422996520996, 2.431849241256714, 2.9642884731292725, 3.889554023742676, 3.2851805686950684, 4.299758434295654, 2.4326391220092773, 4.98414421081543, 6.0653076171875, 3.880471706390381, 3.371993064880371, 4.195757865905762, 4.574909210205078, 4.398542404174805, 3.636817455291748, 3.1135447025299072, 4.653698921203613, 2.53574275970459, 2.3765416145324707, 3.802565574645996, 3.1047682762145996, 4.445768356323242, 4.867359161376953, 3.177905559539795, 3.682772159576416, 3.3252902030944824, 4.477770805358887, 2.94107723236084, 4.295083999633789, 3.8844871520996094, 4.076471328735352, 4.69776725769043, 4.676518440246582, 4.72947883605957, 3.6183252334594727, 3.855185031890869, 5.0990519523620605, 4.628896713256836], "mean_td_error": 3.8261971473693848, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 32.0, "diff_num_grad_updates_vs_sampler_policy": 31.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.080109596252441, "actor_loss": -4.779396057128906, "critic_loss": 0.6173460483551025, "alpha_loss": -0.09379041939973831, "alpha_value": 0.9907386302947998, "log_alpha_value": -0.009304502978920937, "target_entropy": -6.0, "policy_t": 0.008080389350652695, "mean_q": 1.0798938274383545, "max_q": 6.479554176330566, "min_q": 0.7442575693130493}, "td_error": [2.293734312057495, 2.0837783813476562, 3.840397596359253, 0.5541594624519348, 0.3699014484882355, 1.8737843036651611, 3.10201358795166, 2.480135917663574, 0.8898428678512573, 1.2930763959884644, 2.782442569732666, 3.2492384910583496, 1.590022087097168, 1.973988652229309, 2.3919169902801514, 1.5462126731872559, 3.6970877647399902, 1.8244471549987793, 2.314009666442871, 3.4597115516662598, 0.8866803646087646, 1.051130771636963, 3.5718116760253906, 1.2167346477508545, 3.503265380859375, 1.697366714477539, 2.9453248977661133, 4.099555969238281, 1.3564776182174683, 3.056713581085205, 2.3808438777923584, 3.130568504333496, 1.7964601516723633, 2.7679951190948486, 1.8806458711624146, 1.8835060596466064, 1.6665761470794678, 2.45412540435791, 2.4417197704315186, 1.489828109741211, 2.8549067974090576, 1.7911326885223389, 2.636657238006592, 1.2886838912963867, 1.0140656232833862, 0.3614928126335144, 1.5185046195983887, 3.0320968627929688, 1.7704393863677979, 2.1336159706115723, 1.6274977922439575, 1.4620835781097412, 2.0522592067718506, 1.4696221351623535, 1.6914551258087158, 3.365264415740967, 2.860067844390869, 1.0882455110549927, 4.63804292678833, 4.286290168762207, 3.1127853393554688, 2.4739484786987305, 1.4460563659667969, 3.9269561767578125, 0.842699408531189, 1.6407713890075684, 1.8372589349746704, 2.6597750186920166, 1.4190171957015991, 1.7251417636871338, 4.599087715148926, 0.6168390512466431, 2.345319986343384, 0.8852904438972473, 1.0194659233093262, 2.0785927772521973, 1.2479726076126099, 1.5693488121032715, 2.1300601959228516, 2.773566484451294, 2.7491722106933594, 1.8821516036987305, 1.8952971696853638, 3.781672954559326, 1.4032397270202637, 1.4662234783172607], "mean_td_error": 2.155318260192871, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 32.0, "diff_num_grad_updates_vs_sampler_policy": 31.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.12523365020752, "actor_loss": -4.8914899826049805, "critic_loss": 0.5991348028182983, "alpha_loss": -0.09421484172344208, "alpha_value": 0.9907382130622864, "log_alpha_value": -0.009304954670369625, "target_entropy": -6.0, "policy_t": -0.053519878536462784, "mean_q": 1.1701058149337769, "max_q": 5.569119453430176, "min_q": 0.8295464515686035}, "td_error": [0.14685645699501038, 1.533670425415039, 0.3269229233264923, 0.09166553616523743, 3.243772506713867, 2.0252749919891357, 2.439258098602295, 1.5544614791870117, 0.6679004430770874, 3.4079809188842773, 0.3791593611240387, 0.7560277581214905, 2.394482135772705, 0.23616820573806763, 3.131979465484619, 2.393049955368042, 1.8560166358947754, 1.8187843561172485, 3.4491875171661377, 0.5152513980865479, 1.5774321556091309, 2.0716891288757324, 3.0151216983795166, 1.764404058456421, 1.3786964416503906, 2.84570574760437, 2.2447314262390137, 3.6114375591278076, 2.499613046646118, 1.8601934909820557, 0.4409140348434448, 2.200636863708496, 1.9946634769439697, 1.8817732334136963, 2.034945011138916, 0.0895693302154541, 2.8556878566741943, 2.0288302898406982, 0.5851103067398071, 1.9812729358673096, 1.8192522525787354, 2.2306838035583496, 0.9483059048652649, 2.0764431953430176, 3.3154714107513428, 0.8265091180801392, 1.7258174419403076, 0.25122588872909546, 1.2407803535461426, 0.7187856435775757, 0.7428327798843384, 2.3816475868225098, 1.2463221549987793, 4.084597587585449, 3.747042655944824, 1.3389368057250977, 1.820785403251648, 1.9024770259857178, 3.2455153465270996, 0.657849907875061, 1.1172590255737305, 3.8241167068481445, 0.5733543634414673, 2.0810153484344482, 1.373041033744812, 1.54791259765625, 0.30751070380210876, 0.6184262633323669, 0.18578362464904785, 1.7970150709152222, 2.4752848148345947, 2.957005023956299, 2.244582414627075, 2.640547752380371, 2.323249340057373, 2.857882261276245, 0.6596623659133911, 2.253519058227539, 2.1886141300201416, 2.938375473022461, 1.5207555294036865, 4.991432189941406, 3.26576566696167, 2.4396445751190186, 1.0317226648330688, 1.865779161453247], "mean_td_error": 1.8573354482650757, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 32.0, "diff_num_grad_updates_vs_sampler_policy": 31.0}}, "num_env_steps_sampled": 29568, "num_env_steps_trained": 8256, "num_agent_steps_sampled": 88704, "num_agent_steps_trained": 8256, "last_target_update_ts": 29568, "num_target_updates": 32}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88704, "num_agent_steps_trained": 8256, "num_env_steps_sampled": 29568, "num_env_steps_trained": 8256, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 787.9305850538559, "num_env_steps_trained_throughput_per_sec": 226.88179792845403, "timesteps_total": 29568, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 88704, "timers": {"training_iteration_time_ms": 984.037, "sample_time_ms": 689.945, "load_time_ms": 0.307, "load_throughput": 841208.358, "learn_time_ms": 18.334, "learn_throughput": 14072.43, "synch_weights_time_ms": 10.631}, "counters": {"num_env_steps_sampled": 29568, "num_env_steps_trained": 8256, "num_agent_steps_sampled": 88704, "num_agent_steps_trained": 8256, "last_target_update_ts": 29568, "num_target_updates": 32}, "done": false, "episodes_total": 0, "training_iteration": 21, "trial_id": "7066a_00000", "date": "2023-11-18_21-07-28", "timestamp": 1700370448, "time_this_iter_s": 1.1448469161987305, "time_total_s": 32.38896989822388, "pid": 7187, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x312468180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 32.38896989822388, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 72.3, "ram_util_percent": 65.05}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.108567237854004, "actor_loss": -5.056400299072266, "critic_loss": 1.2669143676757812, "alpha_loss": -0.10014662891626358, "alpha_value": 0.9901418089866638, "log_alpha_value": -0.009907105006277561, "target_entropy": -6.0, "policy_t": -0.030316924676299095, "mean_q": 1.2379169464111328, "max_q": 10.160862922668457, "min_q": 0.9385819435119629}, "td_error": [2.651272773742676, 4.121695041656494, 0.44353771209716797, 5.480800151824951, 3.1183207035064697, 5.4536638259887695, 3.7638602256774902, 2.3300836086273193, 5.017854690551758, 2.1826114654541016, 4.1653852462768555, 3.663433313369751, 5.092309474945068, 5.5096540451049805, 4.372507095336914, 5.125802993774414, 2.734337091445923, 5.005964279174805, 4.044493675231934, 2.888139247894287, 3.8021111488342285, 4.372520446777344, 3.1287965774536133, 3.481884717941284, 3.643481492996216, 3.6354517936706543, 5.434326171875, 4.579928874969482, 3.11350154876709, 2.5484566688537598, 3.3129758834838867, 4.514660358428955, 1.6976678371429443, 2.685375452041626, 4.003300189971924, 5.698091506958008, 2.8906161785125732, 3.7511024475097656, 3.327281951904297, 2.7786436080932617, 3.8266353607177734, 5.590959548950195, 2.952535629272461, 3.7803287506103516, 4.628597259521484, 3.074031352996826, 2.0252063274383545, 3.1128573417663574, 3.6070170402526855, 4.19051456451416, 3.7327287197113037, 4.3601884841918945, 3.626641273498535, 1.6189908981323242, 3.1163508892059326, 4.839774131774902, 4.6134538650512695, 3.3861067295074463, 2.1644368171691895, 4.163515090942383, 5.073945999145508, 4.336001873016357, 5.163033962249756, 3.9242804050445557, 4.350788116455078, 4.402507305145264, 4.182601451873779, 5.0812201499938965, 5.141031742095947, 2.6248619556427, 3.176095962524414, 4.968214511871338, 4.479032516479492, 2.5789244174957275, 4.062000274658203, 2.6972947120666504, 2.488407611846924, 3.9113738536834717, 4.230014324188232, 2.701348304748535, 4.284201622009277, 3.131937026977539, 2.1993956565856934, 5.015981674194336, 2.6307950019836426, 3.0881218910217285], "mean_td_error": 3.743025302886963, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 34.0, "diff_num_grad_updates_vs_sampler_policy": 33.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.161282539367676, "actor_loss": -4.954159259796143, "critic_loss": 0.5348195433616638, "alpha_loss": -0.1006397232413292, "alpha_value": 0.990144670009613, "log_alpha_value": -0.009904234670102596, "target_entropy": -6.0, "policy_t": 0.00438411021605134, "mean_q": 1.2854015827178955, "max_q": 6.572622299194336, "min_q": 0.8363285660743713}, "td_error": [0.7223641276359558, 2.2818431854248047, 0.9805899858474731, 2.201777935028076, 3.0507540702819824, 2.2246861457824707, 3.501460313796997, 2.3989479541778564, 1.8536314964294434, 0.04690814018249512, 2.115841865539551, 1.449954628944397, 2.317275047302246, 2.312849521636963, 2.091733694076538, 0.8977339267730713, 0.8291540145874023, 1.8597946166992188, 3.436331272125244, 1.7489500045776367, 2.612852096557617, 0.8972504138946533, 1.3665833473205566, 1.308227777481079, 2.761752128601074, 3.8189525604248047, 0.8206596374511719, 3.302924156188965, 3.2306575775146484, 1.7049024105072021, 1.3402462005615234, 0.5563120245933533, 2.2518584728240967, 2.205744743347168, 2.9744577407836914, 1.0675358772277832, 2.2627570629119873, 1.5478066205978394, 0.3747117519378662, 1.2026169300079346, 2.6898131370544434, 0.15944263339042664, 0.9015519618988037, 3.013558864593506, 1.569628357887268, 2.395756959915161, 1.6223444938659668, 3.300992727279663, 1.1766688823699951, 1.3853541612625122, 2.269287586212158, 1.6582858562469482, 1.948835849761963, 3.845332145690918, 0.20853674411773682, 2.9481639862060547, 2.3410801887512207, 1.9288235902786255, 2.1884331703186035, 0.34583449363708496, 0.5111682415008545, 1.9807851314544678, 0.9008222222328186, 4.940580368041992, 0.9565725922584534, 0.0991591215133667, 1.5861337184906006, 1.1288931369781494, 0.5827372670173645, 0.8955609798431396, 2.7628893852233887, 2.337130546569824, 2.6390926837921143, 2.1945881843566895, 0.8278532028198242, 2.4920547008514404, 1.6873447895050049, 3.1150963306427, 1.9787214994430542, 2.879692554473877, 1.9035323858261108, 3.5086610317230225, 1.6895067691802979, 0.1024230420589447, 3.260535955429077, 1.9924908876419067], "mean_td_error": 1.8928272724151611, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 34.0, "diff_num_grad_updates_vs_sampler_policy": 33.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.09189510345459, "actor_loss": -4.9544453620910645, "critic_loss": 0.5656867027282715, "alpha_loss": -0.09996701031923294, "alpha_value": 0.9901432394981384, "log_alpha_value": -0.009905673563480377, "target_entropy": -6.0, "policy_t": -0.04089123010635376, "mean_q": 1.3157098293304443, "max_q": 6.602055072784424, "min_q": 0.9233372211456299}, "td_error": [3.61908221244812, 2.7098464965820312, 2.0518410205841064, 1.3716635704040527, 0.32567596435546875, 3.683573007583618, 0.9370017647743225, 4.0180158615112305, 0.32957375049591064, 2.098759412765503, 3.2369890213012695, 0.7823612689971924, 3.722360610961914, 2.507733106613159, 1.5195121765136719, 1.7802742719650269, 2.2017340660095215, 2.4101712703704834, 0.5889838933944702, 2.201359272003174, 0.8707745671272278, 2.434906005859375, 3.274358034133911, 1.6190009117126465, 2.15101957321167, 2.9997382164001465, 1.001094937324524, 1.8644628524780273, 1.0648810863494873, 0.45525166392326355, 1.5196011066436768, 1.6871273517608643, 0.14185675978660583, 2.699495553970337, 2.2557759284973145, 0.5605757236480713, 0.4873845875263214, 0.5425013899803162, 3.073582887649536, 2.2022433280944824, 2.8370132446289062, 1.293680191040039, 1.9906010627746582, 0.6239200830459595, 0.6753548383712769, 2.809920310974121, 0.7970569133758545, 2.2656588554382324, 2.216763734817505, 0.17751049995422363, 2.5626637935638428, 1.3041954040527344, 3.0442113876342773, 1.2509320974349976, 0.6225097179412842, 1.786461353302002, 3.116452217102051, 2.81418776512146, 0.9066376686096191, 1.9561753273010254, 0.5647903680801392, 1.9978911876678467, 0.6658561825752258, 1.9718689918518066, 2.355462074279785, 0.8013514876365662, 0.5010887980461121, 1.6950881481170654, 2.4111971855163574, 1.5991089344024658, 2.9424924850463867, 1.0489075183868408, 2.5724682807922363, 1.2498178482055664, 0.6059072017669678, 3.010033130645752, 1.901207685470581, 2.6660375595092773, 1.2665315866470337, 3.1139535903930664, 1.692223310470581, 2.4587807655334473, 2.1846139430999756, 0.2740166485309601, 1.1969022750854492, 2.7525763511657715], "mean_td_error": 1.8087700605392456, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 34.0, "diff_num_grad_updates_vs_sampler_policy": 33.0}}, "num_env_steps_sampled": 31360, "num_env_steps_trained": 8772, "num_agent_steps_sampled": 94080, "num_agent_steps_trained": 8772, "last_target_update_ts": 31360, "num_target_updates": 34}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 94080, "num_agent_steps_trained": 8772, "num_env_steps_sampled": 31360, "num_env_steps_trained": 8772, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 979.7895263759459, "num_env_steps_trained_throughput_per_sec": 282.1268948716451, "timesteps_total": 31360, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 94080, "timers": {"training_iteration_time_ms": 958.679, "sample_time_ms": 664.865, "load_time_ms": 0.309, "load_throughput": 834912.763, "learn_time_ms": 18.194, "learn_throughput": 14180.883, "synch_weights_time_ms": 10.485}, "counters": {"num_env_steps_sampled": 31360, "num_env_steps_trained": 8772, "num_agent_steps_sampled": 94080, "num_agent_steps_trained": 8772, "last_target_update_ts": 31360, "num_target_updates": 34}, "done": false, "episodes_total": 0, "training_iteration": 22, "trial_id": "7066a_00000", "date": "2023-11-18_21-07-30", "timestamp": 1700370450, "time_this_iter_s": 1.8370411396026611, "time_total_s": 34.22601103782654, "pid": 7187, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x31039e3e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 34.22601103782654, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 64.83333333333333, "ram_util_percent": 64.93333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.081086158752441, "actor_loss": -5.117195129394531, "critic_loss": 1.279418706893921, "alpha_loss": -0.10592962056398392, "alpha_value": 0.9895472526550293, "log_alpha_value": -0.010507757775485516, "target_entropy": -6.0, "policy_t": -0.009817888960242271, "mean_q": 1.1361382007598877, "max_q": 8.630155563354492, "min_q": 1.0274248123168945}, "td_error": [3.123697519302368, 2.3105993270874023, 4.584834575653076, 3.4368057250976562, 2.196688652038574, 4.223124980926514, 4.46320915222168, 4.767784118652344, 4.677271842956543, 6.388577461242676, 3.5636017322540283, 3.2969160079956055, 2.9325270652770996, 5.118845462799072, 3.261202335357666, 2.6696693897247314, 2.762099266052246, 5.278465270996094, 3.4134392738342285, 4.710906028747559, 3.707329750061035, 3.0397720336914062, 3.173468828201294, 4.050347328186035, 3.936357021331787, 2.806304454803467, 5.105386734008789, 3.448768377304077, 3.382538318634033, 2.5961694717407227, 5.392523288726807, 2.799488067626953, 3.06103777885437, 4.241291046142578, 3.1914689540863037, 4.21657657623291, 3.2891757488250732, 3.152736186981201, 4.264526844024658, 2.9299230575561523, 3.152700185775757, 3.717696189880371, 4.079626083374023, 4.419248104095459, 3.572305679321289, 3.370856285095215, 4.913570404052734, 4.836549758911133, 2.698671817779541, 4.311332702636719, 2.6019275188446045, 3.494899272918701, 2.597137689590454, 1.9102195501327515, 4.645040512084961, 5.432032108306885, 4.7924346923828125, 2.979804754257202, 6.681575775146484, 3.9499101638793945, 4.083487033843994, 3.714808225631714, 3.883246660232544, 4.527829170227051, 4.964770317077637, 4.64023494720459, 4.3906145095825195, 3.843449354171753, 2.8459532260894775, 4.209225177764893, 4.652667999267578, 3.1437010765075684, 3.723416328430176, 4.388453483581543, 2.912356376647949, 3.3487234115600586, 2.5900073051452637, 3.9636034965515137, 4.61924934387207, 4.684664726257324, 5.86784553527832, 3.700415849685669, 5.781731128692627, 2.463141918182373, 2.9971113204956055, 2.800060272216797], "mean_td_error": 3.835625171661377, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 36.0, "diff_num_grad_updates_vs_sampler_policy": 35.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.09383773803711, "actor_loss": -4.96115255355835, "critic_loss": 0.5606259107589722, "alpha_loss": -0.10602644830942154, "alpha_value": 0.9895508885383606, "log_alpha_value": -0.01050407811999321, "target_entropy": -6.0, "policy_t": 0.005763969849795103, "mean_q": 1.153435468673706, "max_q": 6.573298454284668, "min_q": 0.9322383403778076}, "td_error": [1.3146510124206543, 2.274892807006836, 1.6371126174926758, 2.1670608520507812, 2.005049228668213, 2.8331010341644287, 3.0927700996398926, 2.3697428703308105, 3.2787928581237793, 1.028659701347351, 1.997519612312317, 0.20553657412528992, 2.1436028480529785, 1.0636093616485596, 0.9264066219329834, 1.825073003768921, 3.3842430114746094, 1.337237000465393, 3.1268088817596436, 1.6065468788146973, 2.1942758560180664, 2.537362575531006, 1.8028762340545654, 0.7630802392959595, 1.7805633544921875, 1.258014440536499, 0.934912919998169, 3.807805061340332, 2.739846706390381, 3.1642141342163086, 1.0506333112716675, 3.557443141937256, 3.4906342029571533, 4.180890083312988, 1.8030202388763428, 1.6331069469451904, 1.3180216550827026, 1.3915581703186035, 1.3887830972671509, 0.8608754873275757, 1.1962995529174805, 1.7040468454360962, 2.7976796627044678, 2.8928544521331787, 1.556140661239624, 2.3203542232513428, 1.203961968421936, 2.6248984336853027, 3.5568456649780273, 1.457374095916748, 1.2862493991851807, 2.524479627609253, 0.9416214227676392, 0.8968796730041504, 2.2182958126068115, 3.500683307647705, 1.5176488161087036, 3.1410274505615234, 2.4503674507141113, 1.1788573265075684, 0.03978648781776428, 0.8088592290878296, 3.2469449043273926, 0.6989372968673706, 1.6482551097869873, 2.7990217208862305, 1.0062683820724487, 0.9282534718513489, 1.9766579866409302, 2.0789308547973633, 3.2248358726501465, 2.685483694076538, 3.2574000358581543, 2.1971988677978516, 0.5025200843811035, 1.9272658824920654, 0.7857986688613892, 2.0604143142700195, 1.1529521942138672, 2.055077314376831, 2.054527759552002, 1.5112857818603516, 2.377488613128662, 1.4276244640350342, 1.8317358493804932, 2.187384843826294], "mean_td_error": 1.9617884159088135, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 36.0, "diff_num_grad_updates_vs_sampler_policy": 35.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.12378215789795, "actor_loss": -5.054937839508057, "critic_loss": 0.46831101179122925, "alpha_loss": -0.10636376589536667, "alpha_value": 0.9895486831665039, "log_alpha_value": -0.010506326332688332, "target_entropy": -6.0, "policy_t": -0.03042617067694664, "mean_q": 1.1228388547897339, "max_q": 5.311746597290039, "min_q": 1.0211682319641113}, "td_error": [1.6688096523284912, 1.2843658924102783, 1.1669907569885254, 1.9265697002410889, 2.9712636470794678, 1.072635531425476, 2.7563018798828125, 1.9841458797454834, 2.3685927391052246, 2.4483067989349365, 0.06802815198898315, 0.46117454767227173, 1.9096184968948364, 0.7440048456192017, 1.3272743225097656, 2.0970683097839355, 0.1076849102973938, 0.9383484125137329, 2.33657169342041, 2.4272921085357666, 0.3762442469596863, 2.534942626953125, 0.5972731709480286, 1.3977975845336914, 2.2621188163757324, 0.995964765548706, 2.4034178256988525, 0.38025665283203125, 0.720097005367279, 0.08143159747123718, 2.5036869049072266, 0.7912647724151611, 0.4030536413192749, 0.4893275499343872, 0.6003409624099731, 1.8887264728546143, 0.7636823654174805, 1.8521339893341064, 1.6979718208312988, 3.2971296310424805, 0.286705881357193, 1.6414384841918945, 1.1624774932861328, 1.9869468212127686, 1.4489641189575195, 3.383392810821533, 3.15014386177063, 1.9272315502166748, 2.5823497772216797, 1.6549937725067139, 0.8591598868370056, 2.6322245597839355, 1.5927568674087524, 1.7903984785079956, 1.198390007019043, 0.20074337720870972, 2.0417988300323486, 0.9296425580978394, 2.7913365364074707, 2.6544952392578125, 1.9449987411499023, 2.0661041736602783, 0.6015572547912598, 0.7572056651115417, 2.240902900695801, 2.486548900604248, 2.7531657218933105, 2.366520881652832, 3.9505670070648193, 3.1302971839904785, 1.9459948539733887, 0.7795326709747314, 0.5956780910491943, 1.8076767921447754, 0.6004686951637268, 0.30947983264923096, 1.651576280593872, 1.018722653388977, 2.7277626991271973, 0.838226318359375, 1.413114309310913, 0.09550362825393677, 1.0023229122161865, 0.906442403793335, 2.104844570159912, 0.0690341591835022], "mean_td_error": 1.5602529048919678, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 36.0, "diff_num_grad_updates_vs_sampler_policy": 35.0}}, "num_env_steps_sampled": 33152, "num_env_steps_trained": 9288, "num_agent_steps_sampled": 99456, "num_agent_steps_trained": 9288, "last_target_update_ts": 33152, "num_target_updates": 36}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 99456, "num_agent_steps_trained": 9288, "num_env_steps_sampled": 33152, "num_env_steps_trained": 9288, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 1038.872944094008, "num_env_steps_trained_throughput_per_sec": 299.139753991355, "timesteps_total": 33152, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 99456, "timers": {"training_iteration_time_ms": 939.675, "sample_time_ms": 665.658, "load_time_ms": 0.31, "load_throughput": 831320.913, "learn_time_ms": 18.109, "learn_throughput": 14247.125, "synch_weights_time_ms": 10.646}, "counters": {"num_env_steps_sampled": 33152, "num_env_steps_trained": 9288, "num_agent_steps_sampled": 99456, "num_agent_steps_trained": 9288, "last_target_update_ts": 33152, "num_target_updates": 36}, "done": false, "episodes_total": 0, "training_iteration": 23, "trial_id": "7066a_00000", "date": "2023-11-18_21-07-32", "timestamp": 1700370452, "time_this_iter_s": 1.7351901531219482, "time_total_s": 35.961201190948486, "pid": 7187, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x31039e840>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 35.961201190948486, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 71.9, "ram_util_percent": 64.69999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.099687576293945, "actor_loss": -5.161279201507568, "critic_loss": 1.0989811420440674, "alpha_loss": -0.10915768146514893, "alpha_value": 0.9892501831054688, "log_alpha_value": -0.010808025486767292, "target_entropy": -6.0, "policy_t": -0.011569813825190067, "mean_q": 1.615022897720337, "max_q": 9.679773330688477, "min_q": 1.0746045112609863}, "td_error": [5.325684547424316, 3.7405545711517334, 1.9605076313018799, 3.981818437576294, 2.308330774307251, 4.179962158203125, 2.954911231994629, 3.8487093448638916, 3.4515786170959473, 1.3378019332885742, 4.575582504272461, 2.4295105934143066, 3.3465538024902344, 2.0778932571411133, 2.7067084312438965, 2.374295234680176, 4.392184257507324, 3.565969467163086, 2.8577792644500732, 3.518251657485962, 4.103294372558594, 3.4176318645477295, 3.7922463417053223, 2.907240629196167, 3.8457562923431396, 3.209285259246826, 2.906966209411621, 2.5173938274383545, 2.8245785236358643, 2.8141398429870605, 4.199333190917969, 4.009507656097412, 2.11391544342041, 2.4265098571777344, 3.227325916290283, 3.253596305847168, 1.822298288345337, 2.294551372528076, 2.6357197761535645, 2.659219741821289, 2.78067946434021, 3.9200427532196045, 2.9127237796783447, 4.557805061340332, 3.4305074214935303, 4.968111038208008, 4.199268817901611, 3.526432514190674, 4.160270690917969, 3.5505642890930176, 4.080453395843506, 4.019452095031738, 1.0507837533950806, 5.668070316314697, 3.4566707611083984, 2.970890998840332, 3.8568875789642334, 2.6119444370269775, 5.001706123352051, 0.19814419746398926, 3.5601837635040283, 3.350717782974243, 3.3480849266052246, 4.078016757965088, 4.732565402984619, 4.769045829772949, 3.3043131828308105, 4.301023483276367, 1.741215705871582, 2.212825298309326, 4.722345352172852, 3.916990280151367, 4.024711608886719, 3.348994016647339, 4.167628288269043, 3.0664937496185303, 4.1562018394470215, 3.226644992828369, 2.0897934436798096, 1.701920747756958, 3.9111669063568115, 3.4994657039642334, 2.696577787399292, 3.4584898948669434, 2.687803030014038, 3.2646820545196533], "mean_td_error": 3.3276093006134033, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 37.0, "diff_num_grad_updates_vs_sampler_policy": 36.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.032464027404785, "actor_loss": -4.9614081382751465, "critic_loss": 0.46190381050109863, "alpha_loss": -0.1083904504776001, "alpha_value": 0.9892541766166687, "log_alpha_value": -0.010803970508277416, "target_entropy": -6.0, "policy_t": 0.03503487631678581, "mean_q": 1.2792174816131592, "max_q": 6.578947067260742, "min_q": 0.9837889671325684}, "td_error": [2.503230571746826, 0.11739286780357361, 1.3145204782485962, 2.123931884765625, 3.1450490951538086, 1.208155870437622, 1.453809142112732, 0.8887349367141724, 0.8708368539810181, 3.3263485431671143, 3.3209903240203857, 2.7872490882873535, 3.0431628227233887, 1.9563249349594116, 3.3910675048828125, 1.856780767440796, 0.7967842817306519, 1.8901634216308594, 3.430795431137085, 1.5931499004364014, 2.275895833969116, 0.40372157096862793, 1.1313351392745972, 1.7503488063812256, 0.05505603551864624, 1.3312638998031616, 0.5983960628509521, 1.44236159324646, 2.3888065814971924, 3.037571907043457, 1.721598505973816, 2.4980878829956055, 0.3093143105506897, 3.791290283203125, 0.4316504895687103, 0.20503243803977966, 0.7707417011260986, 2.9408907890319824, 1.2171987295150757, 1.667022705078125, 1.7024251222610474, 1.7253997325897217, 1.055635690689087, 0.44694840908050537, 1.2891424894332886, 0.4869658946990967, 2.0031728744506836, 1.036839485168457, 0.5604406595230103, 0.9878840446472168, 1.8040072917938232, 1.0876741409301758, 3.432447910308838, 1.95956289768219, 0.42914149165153503, 2.187300682067871, 1.5006492137908936, 2.401998996734619, 3.536120891571045, 4.5458083152771, 0.3556992709636688, 1.160619854927063, 2.394582748413086, 5.912864685058594, 1.054448127746582, 1.7321020364761353, 1.8634556531906128, 0.9215476512908936, 1.4710865020751953, 2.6004581451416016, 1.1720123291015625, 1.309823751449585, 2.858017921447754, 0.7628806829452515, 0.06755265593528748, 1.4170492887496948, 1.9617316722869873, 1.9530012607574463, 1.4095152616500854, 2.1378049850463867, 1.7894651889801025, 0.3439881503582001, 0.34553271532058716, 1.4732418060302734, 1.4205234050750732, 1.312870979309082], "mean_td_error": 1.701947808265686, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 37.0, "diff_num_grad_updates_vs_sampler_policy": 36.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.053706169128418, "actor_loss": -5.041000843048096, "critic_loss": 0.5291774272918701, "alpha_loss": -0.1086478978395462, "alpha_value": 0.989251434803009, "log_alpha_value": -0.010806752368807793, "target_entropy": -6.0, "policy_t": 0.008303762413561344, "mean_q": 1.1866666078567505, "max_q": 5.270227432250977, "min_q": 1.0750904083251953}, "td_error": [1.6127744913101196, 0.6526451110839844, 1.5564184188842773, 2.3106143474578857, 1.3407341241836548, 1.9336243867874146, 2.1315765380859375, 1.669898271560669, 1.4797275066375732, 2.494021415710449, 1.191833257675171, 0.35528838634490967, 2.2694828510284424, 1.251828908920288, 0.8061373233795166, 1.6938599348068237, 0.9529863595962524, 1.8872950077056885, 1.2159597873687744, 1.1308345794677734, 1.4121317863464355, 0.9056564569473267, 2.363870620727539, 2.4493041038513184, 0.38429009914398193, 2.3048200607299805, 1.720841407775879, 1.2945067882537842, 2.5958738327026367, 0.07010045647621155, 0.5758934020996094, 0.808917760848999, 0.6466898918151855, 1.2866711616516113, 0.3671827018260956, 2.0683774948120117, 1.4050610065460205, 3.0077126026153564, 1.9096256494522095, 1.8030644655227661, 1.6817519664764404, 2.7855312824249268, 2.4099137783050537, 1.6609593629837036, 1.4227758646011353, 0.15618830919265747, 1.594923973083496, 2.49660587310791, 2.6339592933654785, 2.3714776039123535, 1.996164083480835, 3.0814738273620605, 2.570197105407715, 2.2357568740844727, 2.9840548038482666, 2.368082284927368, 2.25369930267334, 1.8436957597732544, 1.7838925123214722, 0.07622942328453064, 2.192452907562256, 3.603142499923706, 2.1852293014526367, 1.5454999208450317, 2.2496261596679688, 1.7351679801940918, 0.8993550539016724, 1.0141303539276123, 2.5654382705688477, 3.808300018310547, 3.851950168609619, 1.369465947151184, 0.598871648311615, 3.4659385681152344, 2.0559964179992676, 3.433539867401123, 1.4538908004760742, 0.4878593683242798, 1.9922658205032349, 0.10987657308578491, 2.1626017093658447, 0.9231721758842468, 1.3286256790161133, 1.1942942142486572, 2.535897731781006, 1.3386764526367188], "mean_td_error": 1.7421714067459106, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 37.0, "diff_num_grad_updates_vs_sampler_policy": 36.0}}, "num_env_steps_sampled": 34048, "num_env_steps_trained": 9546, "num_agent_steps_sampled": 102144, "num_agent_steps_trained": 9546, "last_target_update_ts": 34048, "num_target_updates": 37}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 102144, "num_agent_steps_trained": 9546, "num_env_steps_sampled": 34048, "num_env_steps_trained": 9546, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 790.5306167095544, "num_env_steps_trained_throughput_per_sec": 227.63046775788507, "timesteps_total": 34048, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 102144, "timers": {"training_iteration_time_ms": 960.898, "sample_time_ms": 664.963, "load_time_ms": 0.31, "load_throughput": 833177.111, "learn_time_ms": 18.137, "learn_throughput": 14225.213, "synch_weights_time_ms": 10.391}, "counters": {"num_env_steps_sampled": 34048, "num_env_steps_trained": 9546, "num_agent_steps_sampled": 102144, "num_agent_steps_trained": 9546, "last_target_update_ts": 34048, "num_target_updates": 37}, "done": false, "episodes_total": 0, "training_iteration": 24, "trial_id": "7066a_00000", "date": "2023-11-18_21-07-33", "timestamp": 1700370453, "time_this_iter_s": 1.1423590183258057, "time_total_s": 37.10356020927429, "pid": 7187, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x31039ef20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 37.10356020927429, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 54.35, "ram_util_percent": 64.75}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.114646911621094, "actor_loss": -5.283434867858887, "critic_loss": 1.2462313175201416, "alpha_loss": -0.11539258807897568, "alpha_value": 0.9886563420295715, "log_alpha_value": -0.011408464051783085, "target_entropy": -6.0, "policy_t": 0.02560601569712162, "mean_q": 1.8626962900161743, "max_q": 10.827381134033203, "min_q": 1.1713356971740723}, "td_error": [3.7003769874572754, 3.1271941661834717, 4.341387748718262, 5.794951915740967, 3.580657958984375, 3.9668126106262207, 5.891604423522949, 2.333292245864868, 2.750922918319702, 5.037868022918701, 3.7248592376708984, 4.5254716873168945, 2.6692006587982178, 4.2212419509887695, 3.2881107330322266, 4.649091720581055, 3.5669679641723633, 5.0774102210998535, 3.0713977813720703, 3.0930354595184326, 4.423065662384033, 2.7692818641662598, 6.835505485534668, 3.387631893157959, 4.234945297241211, 3.2954816818237305, 2.150002956390381, 5.469773769378662, 3.5506105422973633, 3.2166028022766113, 3.7272443771362305, 1.8925771713256836, 3.458531379699707, 4.522760391235352, 4.653367519378662, 4.425407886505127, 4.41746711730957, 5.329680919647217, 1.8414297103881836, 3.003908157348633, 2.5422122478485107, 4.605738162994385, 3.9098305702209473, 3.9943783283233643, 4.36143684387207, 3.7350611686706543, 3.7381086349487305, 4.467092037200928, 3.884334087371826, 3.209510326385498, 2.3607494831085205, 2.346402168273926, 2.640867233276367, 4.200418949127197, 3.6489479541778564, 2.827033281326294, 2.158196449279785, 3.3241658210754395, 4.4643096923828125, 0.8270740509033203, 4.2128801345825195, 4.847508907318115, 2.461555004119873, 2.702390670776367, 3.3956637382507324, 3.69459867477417, 4.407705783843994, 5.282736778259277, 1.8462969064712524, 6.135408401489258, 3.3105273246765137, 3.35162353515625, 3.5767605304718018, 2.798896312713623, 2.4570610523223877, 4.547626495361328, 2.9611310958862305, 4.529047012329102, 3.4905309677124023, 0.367167592048645, 3.4569151401519775, 3.739668846130371, 4.57737922668457, 2.9932703971862793, 3.7055957317352295, 4.605105400085449], "mean_td_error": 3.671140193939209, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 39.0, "diff_num_grad_updates_vs_sampler_policy": 38.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.110761642456055, "actor_loss": -5.122806072235107, "critic_loss": 0.46970322728157043, "alpha_loss": -0.11529804766178131, "alpha_value": 0.9886612892150879, "log_alpha_value": -0.01140349730849266, "target_entropy": -6.0, "policy_t": 0.03355647996068001, "mean_q": 1.2533278465270996, "max_q": 6.595904350280762, "min_q": 1.0923254489898682}, "td_error": [3.35502290725708, 3.4724016189575195, 2.087723970413208, 3.0614078044891357, 1.6786309480667114, 0.23378002643585205, 1.5530729293823242, 1.2777425050735474, 1.9740662574768066, 0.42562517523765564, 0.7912328839302063, 1.6274707317352295, 0.27645164728164673, 2.3975133895874023, 1.940429925918579, 1.6522414684295654, 1.1336036920547485, 1.0397058725357056, 1.9476163387298584, 1.5269533395767212, 1.9968647956848145, 0.7758380174636841, 2.1186394691467285, 2.1972503662109375, 0.9836095571517944, 2.136192798614502, 1.1633415222167969, 2.8682861328125, 0.5937877893447876, 0.9438015222549438, 1.8136285543441772, 0.28597575426101685, 3.034839630126953, 0.43749070167541504, 1.6294559240341187, 2.7873899936676025, 0.8276413679122925, 2.9550201892852783, 0.5320224761962891, 0.5840235352516174, 3.7608437538146973, 1.3106430768966675, 0.4983772039413452, 3.0348525047302246, 1.657673954963684, 1.4293930530548096, 1.5966057777404785, 3.2032241821289062, 1.4298598766326904, 1.6578624248504639, 1.6256628036499023, 4.0220255851745605, 0.9889834523200989, 2.1714529991149902, 0.06095999479293823, 1.0486921072006226, 1.8018629550933838, 2.822119951248169, 1.754967451095581, 2.953937530517578, 0.7017274498939514, 1.5237131118774414, 4.028338432312012, 2.076767921447754, 1.5064949989318848, 0.1784573197364807, 0.729739785194397, 1.0268892049789429, 0.2671557068824768, 1.6201393604278564, 3.713496208190918, 1.7253965139389038, 2.258481979370117, 3.051525592803955, 1.71723473072052, 1.5141863822937012, 2.2680959701538086, 1.385965347290039, 2.0176568031311035, 2.637350559234619, 1.7978718280792236, 1.713039755821228, 3.8137717247009277, 0.10348689556121826, 2.270595073699951, 2.598292827606201], "mean_td_error": 1.7580658197402954, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 39.0, "diff_num_grad_updates_vs_sampler_policy": 38.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.028109550476074, "actor_loss": -5.140578746795654, "critic_loss": 0.5471445918083191, "alpha_loss": -0.11439365893602371, "alpha_value": 0.988657534122467, "log_alpha_value": -0.011407299898564816, "target_entropy": -6.0, "policy_t": -0.012670736759901047, "mean_q": 1.4354089498519897, "max_q": 4.705179214477539, "min_q": 1.1910799741744995}, "td_error": [1.902051568031311, 0.42330867052078247, 0.8998806476593018, 0.30132079124450684, 1.1642756462097168, 1.546320915222168, 3.7176079750061035, 0.8044093251228333, 1.6570148468017578, 0.4341340661048889, 0.36775779724121094, 2.304116725921631, 2.1570346355438232, 0.7618362903594971, 0.3155864477157593, 2.785654067993164, 3.0531487464904785, 3.024632453918457, 0.8782086372375488, 2.389026641845703, 3.349506139755249, 1.7959601879119873, 0.3677753806114197, 2.2383928298950195, 2.060898780822754, 1.905942440032959, 1.2413877248764038, 2.2439448833465576, 2.3538975715637207, 2.0589523315429688, 0.9051730632781982, 1.9386507272720337, 0.9372032880783081, 1.1541228294372559, 1.4195538759231567, 3.889187812805176, 1.252887487411499, 2.298569679260254, 1.5534000396728516, 1.70693039894104, 0.9798980355262756, 2.128035068511963, 0.6255808472633362, 3.0239315032958984, 0.22242379188537598, 1.0484963655471802, 2.6019153594970703, 1.03513503074646, 2.0278337001800537, 3.690521717071533, 1.2534444332122803, 0.7495636940002441, 1.6947910785675049, 3.567746162414551, 1.0952174663543701, 1.8662930727005005, 2.305860757827759, 4.068035125732422, 1.7924607992172241, 3.6506614685058594, 0.9905811548233032, 0.3384717106819153, 2.051093578338623, 2.318547010421753, 2.825063705444336, 1.710461974143982, 0.41042476892471313, 3.1728954315185547, 0.2794945240020752, 1.3766236305236816, 1.6245757341384888, 1.607784390449524, 2.245798110961914, 2.683884382247925, 0.8909202814102173, 0.570688009262085, 1.6899206638336182, 2.0131354331970215, 0.4869433641433716, 1.520936369895935, 3.041151285171509, 3.573538064956665, 2.4516468048095703, 1.3084375858306885, 1.8864309787750244, 2.1186602115631104], "mean_td_error": 1.769484043121338, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 39.0, "diff_num_grad_updates_vs_sampler_policy": 38.0}}, "num_env_steps_sampled": 35840, "num_env_steps_trained": 10062, "num_agent_steps_sampled": 107520, "num_agent_steps_trained": 10062, "last_target_update_ts": 35840, "num_target_updates": 39}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 107520, "num_agent_steps_trained": 10062, "num_env_steps_sampled": 35840, "num_env_steps_trained": 10062, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 1062.8299012368443, "num_env_steps_trained_throughput_per_sec": 306.0380742400735, "timesteps_total": 35840, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 107520, "timers": {"training_iteration_time_ms": 933.11, "sample_time_ms": 633.908, "load_time_ms": 0.312, "load_throughput": 826747.981, "learn_time_ms": 18.223, "learn_throughput": 14158.303, "synch_weights_time_ms": 9.968}, "counters": {"num_env_steps_sampled": 35840, "num_env_steps_trained": 10062, "num_agent_steps_sampled": 107520, "num_agent_steps_trained": 10062, "last_target_update_ts": 35840, "num_target_updates": 39}, "done": false, "episodes_total": 0, "training_iteration": 25, "trial_id": "7066a_00000", "date": "2023-11-18_21-07-34", "timestamp": 1700370454, "time_this_iter_s": 1.6939821243286133, "time_total_s": 38.797542333602905, "pid": 7187, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x31039f4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 38.797542333602905, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 68.4, "ram_util_percent": 64.55}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.116703033447266, "actor_loss": -5.380248546600342, "critic_loss": 1.1444059610366821, "alpha_loss": -0.12148995697498322, "alpha_value": 0.9880629777908325, "log_alpha_value": -0.01200884860008955, "target_entropy": -6.0, "policy_t": 0.028584154322743416, "mean_q": 1.6879897117614746, "max_q": 10.9236421585083, "min_q": 1.2700903415679932}, "td_error": [1.4585341215133667, 1.8517441749572754, 4.163096904754639, 4.378155708312988, 4.393542289733887, 3.046926498413086, 2.724184036254883, 2.9561872482299805, 3.309415340423584, 2.1424570083618164, 4.138532638549805, 3.0681815147399902, 2.4062511920928955, 0.9363543391227722, 3.2772414684295654, 4.715212345123291, 3.7168350219726562, 2.8348898887634277, 2.142855167388916, 4.6320085525512695, 4.057615280151367, 2.9819893836975098, 3.6929380893707275, 2.8224263191223145, 2.8718068599700928, 3.90539288520813, 5.519909381866455, 5.725456714630127, 1.4665942192077637, 3.973153591156006, 3.4683022499084473, 4.282978057861328, 2.9237279891967773, 0.35162055492401123, 3.0218451023101807, 4.232110023498535, 5.262914657592773, 3.341449022293091, 0.3225209712982178, 2.5731732845306396, 3.576369285583496, 1.4501959085464478, 2.5686326026916504, 3.3183624744415283, 0.9567078351974487, 4.035464286804199, 3.669351577758789, 4.818984508514404, 4.422065258026123, 4.460078239440918, 3.469858169555664, 1.5741817951202393, 4.0793561935424805, 4.206942558288574, 3.50630521774292, 2.8514578342437744, 3.3998618125915527, 3.8819408416748047, 1.6899887323379517, 3.365269660949707, 3.1701645851135254, 3.587472915649414, 3.2798361778259277, 2.1663966178894043, 2.5113401412963867, 4.583538055419922, 3.132497549057007, 2.326603412628174, 3.9873218536376953, 4.191174030303955, 3.4435644149780273, 2.9064927101135254, 4.500634670257568, 4.178964614868164, 5.339488506317139, 4.818280220031738, 4.554446697235107, 4.685592174530029, 2.6785194873809814, 4.209209442138672, 6.287259101867676, 3.6873722076416016, 3.862003803253174, 4.420802593231201, 5.471122741699219, 2.2322750091552734], "mean_td_error": 3.425631523132324, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 41.0, "diff_num_grad_updates_vs_sampler_policy": 40.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.169843673706055, "actor_loss": -5.2725043296813965, "critic_loss": 0.3604219853878021, "alpha_loss": -0.12206985801458359, "alpha_value": 0.9880686402320862, "log_alpha_value": -0.012003120966255665, "target_entropy": -6.0, "policy_t": -0.024196051061153412, "mean_q": 1.309478759765625, "max_q": 4.970780372619629, "min_q": 1.2117152214050293}, "td_error": [0.9744790196418762, 0.007141768932342529, 0.7332203388214111, 0.7146114110946655, 1.3772249221801758, 1.7714729309082031, 1.726712942123413, 1.7769877910614014, 2.3803601264953613, 1.0983176231384277, 0.19458991289138794, 0.4114859104156494, 1.5327578783035278, 1.8912616968154907, 3.864528179168701, 1.1531500816345215, 0.4580865502357483, 2.0364596843719482, 2.391507148742676, 1.9832091331481934, 3.488679885864258, 0.30330413579940796, 0.9084271788597107, 1.610891580581665, 2.0051631927490234, 1.798301339149475, 0.055781006813049316, 1.0391812324523926, 1.0160109996795654, 1.3482297658920288, 1.5423898696899414, 0.0694780945777893, 0.3128334879875183, 1.6514122486114502, 2.381929397583008, 2.7790873050689697, 0.3404237627983093, 1.422714114189148, 1.5252678394317627, 0.679716944694519, 1.2603018283843994, 3.5061140060424805, 0.5212770700454712, 1.9799673557281494, 0.4734940528869629, 1.3788130283355713, 0.8934085369110107, 1.1178510189056396, 0.26610249280929565, 1.0029023885726929, 1.0832245349884033, 0.2841942310333252, 0.22508275508880615, 1.903356671333313, 1.9689512252807617, 1.235077142715454, 2.3346073627471924, 0.4134427309036255, 2.3298709392547607, 3.909383773803711, 1.0683146715164185, 2.9759116172790527, 0.6147089600563049, 0.8072446584701538, 3.074286937713623, 0.6892383694648743, 0.5362308025360107, 1.1913673877716064, 2.0904409885406494, 1.8992482423782349, 2.764683723449707, 2.0598888397216797, 0.9537126421928406, 1.4258887767791748, 0.9635484218597412, 1.863602638244629, 0.29762768745422363, 0.7168981432914734, 2.496793746948242, 1.5120923519134521, 1.1030776500701904, 0.700799286365509, 1.9828226566314697, 0.7737952470779419, 0.8205458521842957, 2.139641284942627], "mean_td_error": 1.3996119499206543, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 41.0, "diff_num_grad_updates_vs_sampler_policy": 40.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.077220916748047, "actor_loss": -5.281121730804443, "critic_loss": 0.4819641709327698, "alpha_loss": -0.12100113183259964, "alpha_value": 0.9880644083023071, "log_alpha_value": -0.012007390148937702, "target_entropy": -6.0, "policy_t": 0.00855124369263649, "mean_q": 1.661355972290039, "max_q": 6.121357440948486, "min_q": 1.3117326498031616}, "td_error": [2.295274257659912, 1.279828429222107, 1.5230436325073242, 2.9117379188537598, 0.7885040640830994, 1.379564881324768, 1.9310050010681152, 0.7315072417259216, 2.201270818710327, 0.08644580841064453, 2.3707518577575684, 1.5984385013580322, 0.12070751190185547, 1.128937005996704, 1.2279908657073975, 2.1038355827331543, 0.8902866840362549, 1.3701484203338623, 2.0505614280700684, 0.3381859064102173, 0.8727139234542847, 1.7313302755355835, 0.8437076210975647, 1.9439797401428223, 0.8768304586410522, 0.661990761756897, 0.2824622392654419, 1.1082813739776611, 3.0157971382141113, 5.805997848510742, 0.36440128087997437, 1.2443606853485107, 2.891329288482666, 0.4031074643135071, 1.9142457246780396, 0.18420201539993286, 2.3727529048919678, 2.679743766784668, 0.2757149934768677, 4.000377655029297, 0.7446510791778564, 0.5916703939437866, 1.600543737411499, 1.7713857889175415, 0.6159906387329102, 0.901929497718811, 2.552140474319458, 2.2977561950683594, 0.8070893883705139, 1.764944314956665, 0.33554184436798096, 1.5279407501220703, 1.9732856750488281, 0.9805655479431152, 2.4243063926696777, 2.582484722137451, 1.4837710857391357, 3.34151554107666, 0.8770594596862793, 1.402407169342041, 0.19496893882751465, 0.9156873226165771, 2.569183826446533, 2.510863780975342, 1.7066015005111694, 3.516327142715454, 1.7257466316223145, 1.4880269765853882, 0.7604727745056152, 3.231478214263916, 0.3708781599998474, 0.11748069524765015, 5.406370639801025, 2.1567695140838623, 1.5308091640472412, 0.9932432174682617, 3.682622194290161, 2.0000813007354736, 0.6777799129486084, 0.8498960733413696, 0.5075328350067139, 0.4039219617843628, 2.0196924209594727, 2.1980202198028564, 3.0232906341552734, 2.544255495071411], "mean_td_error": 1.6218643188476562, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 41.0, "diff_num_grad_updates_vs_sampler_policy": 40.0}}, "num_env_steps_sampled": 37632, "num_env_steps_trained": 10578, "num_agent_steps_sampled": 112896, "num_agent_steps_trained": 10578, "last_target_update_ts": 37632, "num_target_updates": 41}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112896, "num_agent_steps_trained": 10578, "num_env_steps_sampled": 37632, "num_env_steps_trained": 10578, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 1012.1793412976895, "num_env_steps_trained_throughput_per_sec": 291.4534264004508, "timesteps_total": 37632, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 112896, "timers": {"training_iteration_time_ms": 928.078, "sample_time_ms": 629.166, "load_time_ms": 0.313, "load_throughput": 823225.89, "learn_time_ms": 18.162, "learn_throughput": 14205.475, "synch_weights_time_ms": 10.314}, "counters": {"num_env_steps_sampled": 37632, "num_env_steps_trained": 10578, "num_agent_steps_sampled": 112896, "num_agent_steps_trained": 10578, "last_target_update_ts": 37632, "num_target_updates": 41}, "done": false, "episodes_total": 0, "training_iteration": 26, "trial_id": "7066a_00000", "date": "2023-11-18_21-07-36", "timestamp": 1700370456, "time_this_iter_s": 1.7795331478118896, "time_total_s": 40.577075481414795, "pid": 7187, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x31039e840>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 40.577075481414795, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 64.7, "ram_util_percent": 64.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.105826377868652, "actor_loss": -5.463841438293457, "critic_loss": 1.166611909866333, "alpha_loss": -0.1274271011352539, "alpha_value": 0.9874699115753174, "log_alpha_value": -0.012609269469976425, "target_entropy": -6.0, "policy_t": -0.008720571175217628, "mean_q": 1.8080135583877563, "max_q": 10.13232707977295, "min_q": 1.3778035640716553}, "td_error": [1.0553107261657715, 2.7454707622528076, 3.994805335998535, 3.947585105895996, 3.5785574913024902, 5.485256671905518, 1.0044031143188477, 6.856696605682373, 2.0012550354003906, 5.196457862854004, 3.603123188018799, 4.893960952758789, 3.269008159637451, 3.778717041015625, 2.867478847503662, 3.4181790351867676, 2.6186556816101074, 2.4749393463134766, 4.240135192871094, 2.671442985534668, 2.6917409896850586, 3.5932729244232178, 2.809575080871582, 4.638662338256836, 3.0377540588378906, 3.620741844177246, 3.8356966972351074, 3.278264284133911, 1.5338501930236816, 2.7769887447357178, 2.4799716472625732, 3.888237476348877, 3.194854974746704, 2.285036563873291, 4.355533123016357, 4.997976303100586, 4.3470458984375, 5.182320594787598, 3.739619493484497, 4.305911540985107, 2.3589391708374023, 2.971764326095581, 2.781414031982422, 2.1551434993743896, 5.161066055297852, 2.267906665802002, 2.0353987216949463, 4.712735176086426, 1.520944595336914, 5.202496528625488, 4.490262031555176, 3.515085220336914, 3.3510966300964355, 4.562222003936768, 5.977792739868164, 3.5884337425231934, 3.725306987762451, 3.1090145111083984, 3.9684457778930664, 3.904719114303589, 2.158214569091797, 4.437822341918945, 4.663485050201416, 4.022222518920898, 2.9044902324676514, 3.9704227447509766, 3.433929920196533, 4.586499214172363, 1.3669102191925049, 4.461114883422852, 2.9585371017456055, 3.718712329864502, 1.28401780128479, 3.6721508502960205, 3.0253703594207764, 5.004586696624756, 3.6056060791015625, 3.2936062812805176, 2.765376567840576, 2.2703123092651367, 3.73384690284729, 3.709185838699341, 2.577324390411377, 2.4840567111968994, 3.2497944831848145, 3.0381102561950684], "mean_td_error": 3.4657020568847656, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 43.0, "diff_num_grad_updates_vs_sampler_policy": 42.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.116399765014648, "actor_loss": -5.350265979766846, "critic_loss": 0.2852187752723694, "alpha_loss": -0.12749797105789185, "alpha_value": 0.9874759912490845, "log_alpha_value": -0.012603100389242172, "target_entropy": -6.0, "policy_t": 0.008449948392808437, "mean_q": 1.4304332733154297, "max_q": 5.060993194580078, "min_q": 1.3419487476348877}, "td_error": [0.7029523849487305, 2.377455234527588, 2.874260425567627, 1.684084415435791, 1.311192274093628, 1.5210202932357788, 0.8997381925582886, 0.5950638651847839, 0.14315783977508545, 1.0648633241653442, 1.3390884399414062, 0.4813498258590698, 1.5661897659301758, 2.025078058242798, 0.9807801842689514, 4.034426212310791, 0.6930934190750122, 1.5864691734313965, 0.769371509552002, 0.4376407861709595, 0.6310811638832092, 2.1347270011901855, 0.45842063426971436, 2.533005714416504, 1.2955368757247925, 0.14726030826568604, 3.5367588996887207, 0.5744621753692627, 1.5405439138412476, 0.8197053074836731, 0.8974276185035706, 1.364189624786377, 1.697521686553955, 1.0295958518981934, 1.4280173778533936, 0.6427357196807861, 0.3962762951850891, 0.8084719181060791, 2.63326358795166, 0.3702481985092163, 2.014214515686035, 1.946598768234253, 2.187490701675415, 2.3197455406188965, 1.7401201725006104, 2.2100954055786133, 1.0051383972167969, 1.5218069553375244, 2.8921360969543457, 0.4181119203567505, 2.106886625289917, 1.0666018724441528, 1.8463255167007446, 2.0241780281066895, 1.7329350709915161, 3.2780110836029053, 1.8255765438079834, 2.05625057220459, 1.859581708908081, 3.839390277862549, 0.40496206283569336, 0.7823432087898254, 2.3287808895111084, 0.36042696237564087, 0.08690816164016724, 0.5107381939888, 0.41173410415649414, 2.0270581245422363, 3.221832752227783, 1.2871426343917847, 0.456632137298584, 0.0610508918762207, 0.8084364533424377, 0.9844444990158081, 0.10289609432220459, 2.054813861846924, 3.1274237632751465, 2.0856966972351074, 0.6890174746513367, 1.5705504417419434, 1.7547950744628906, 2.232001781463623, 0.8652949333190918, 0.8366864919662476, 0.47800594568252563, 2.5988521575927734], "mean_td_error": 1.442398190498352, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 43.0, "diff_num_grad_updates_vs_sampler_policy": 42.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.052565574645996, "actor_loss": -5.369918346405029, "critic_loss": 0.4018053710460663, "alpha_loss": -0.12673667073249817, "alpha_value": 0.9874717593193054, "log_alpha_value": -0.012607394717633724, "target_entropy": -6.0, "policy_t": 0.025176653638482094, "mean_q": 1.6420164108276367, "max_q": 5.850032329559326, "min_q": 1.4353089332580566}, "td_error": [0.4770396947860718, 0.846513569355011, 1.6747419834136963, 1.6505725383758545, 0.21031224727630615, 2.456151008605957, 2.4883952140808105, 1.5901905298233032, 1.3047528266906738, 2.2405710220336914, 1.6575870513916016, 0.10811740159988403, 0.47542041540145874, 1.48348069190979, 2.7282752990722656, 2.52959942817688, 2.0753633975982666, 1.6602072715759277, 0.21104055643081665, 1.3491997718811035, 0.5060369372367859, 1.8033981323242188, 0.9502742886543274, 3.196986198425293, 1.6617099046707153, 1.3405104875564575, 0.5450732707977295, 3.0446395874023438, 1.5055221319198608, 3.407388687133789, 4.096055507659912, 1.389716386795044, 0.5472034215927124, 0.5300006866455078, 0.4145216941833496, 1.9217702150344849, 0.5275090932846069, 0.5503778457641602, 0.6311537027359009, 1.6217098236083984, 1.2264167070388794, 0.7208621501922607, 2.715297222137451, 0.5156559348106384, 0.18869531154632568, 0.09053540229797363, 0.4827035069465637, 1.0191049575805664, 1.0729817152023315, 1.7142202854156494, 1.3100621700286865, 0.9229109287261963, 1.5176331996917725, 1.1606841087341309, 0.41054362058639526, 2.9974350929260254, 1.3434867858886719, 0.21294879913330078, 1.8157522678375244, 2.285921812057495, 0.8574463725090027, 1.2318155765533447, 1.0749067068099976, 0.8379241228103638, 3.7716407775878906, 1.2113471031188965, 1.700238823890686, 1.9750893115997314, 0.5784873962402344, 0.18773972988128662, 1.4370219707489014, 2.0358877182006836, 3.2314157485961914, 2.2823195457458496, 0.8039647340774536, 1.4664115905761719, 1.9546716213226318, 2.00637149810791, 2.1914119720458984, 0.4624636769294739, 3.4058637619018555, 0.44901180267333984, 0.3098381757736206, 1.4528261423110962, 0.5825191140174866, 0.12569022178649902], "mean_td_error": 1.4041541814804077, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 43.0, "diff_num_grad_updates_vs_sampler_policy": 42.0}}, "num_env_steps_sampled": 39424, "num_env_steps_trained": 11094, "num_agent_steps_sampled": 118272, "num_agent_steps_trained": 11094, "last_target_update_ts": 39424, "num_target_updates": 43}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 118272, "num_agent_steps_trained": 11094, "num_env_steps_sampled": 39424, "num_env_steps_trained": 11094, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 963.7708848641331, "num_env_steps_trained_throughput_per_sec": 277.5143842577526, "timesteps_total": 39424, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 118272, "timers": {"training_iteration_time_ms": 907.945, "sample_time_ms": 610.562, "load_time_ms": 0.312, "load_throughput": 826937.515, "learn_time_ms": 18.1, "learn_throughput": 14253.769, "synch_weights_time_ms": 9.947}, "counters": {"num_env_steps_sampled": 39424, "num_env_steps_trained": 11094, "num_agent_steps_sampled": 118272, "num_agent_steps_trained": 11094, "last_target_update_ts": 39424, "num_target_updates": 43}, "done": false, "episodes_total": 0, "training_iteration": 27, "trial_id": "7066a_00000", "date": "2023-11-18_21-07-38", "timestamp": 1700370458, "time_this_iter_s": 1.8686819076538086, "time_total_s": 42.4457573890686, "pid": 7187, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x3124687c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 42.4457573890686, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 74.45, "ram_util_percent": 64.75}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.116660118103027, "actor_loss": -5.589132785797119, "critic_loss": 1.100656509399414, "alpha_loss": -0.1336386650800705, "alpha_value": 0.9868770837783813, "log_alpha_value": -0.013209761120378971, "target_entropy": -6.0, "policy_t": 0.07426121830940247, "mean_q": 1.6566845178604126, "max_q": 11.199918746948242, "min_q": 1.492747187614441}, "td_error": [4.83149528503418, 1.6686549186706543, 2.6204404830932617, 3.065969705581665, 5.819024085998535, 3.0836477279663086, 3.7989323139190674, 3.583883285522461, 2.857081651687622, 0.28345948457717896, 4.224458694458008, 4.460105895996094, 3.751307725906372, 3.283815383911133, 2.280390501022339, 3.561624526977539, 0.6249405145645142, 2.976670026779175, 2.437795639038086, 2.61507248878479, 2.097975969314575, 1.653083324432373, 3.375426769256592, 4.942076683044434, 1.8410788774490356, 2.62453031539917, 2.831676721572876, 3.382634162902832, 3.344686508178711, 3.8710145950317383, 4.905459403991699, 1.9966952800750732, 4.325588226318359, 4.669537544250488, 2.57761549949646, 3.1432385444641113, 2.692532777786255, 2.907576084136963, 2.042464256286621, 7.234981060028076, 3.3461227416992188, 3.763054847717285, 4.216397285461426, 3.231826066970825, 2.6092746257781982, 2.726597547531128, 2.0529398918151855, 2.5419082641601562, 3.3783867359161377, 4.924575328826904, 2.2442753314971924, 2.0861785411834717, 2.7846405506134033, 1.93463933467865, 2.2165815830230713, 3.3855185508728027, 2.2170233726501465, 5.493547439575195, 3.31539249420166, 4.359436511993408, 3.0495266914367676, 2.739436388015747, 3.779101848602295, 3.722677707672119, 4.219525337219238, 3.533874988555908, 3.601280927658081, 1.776045560836792, 4.050063133239746, 4.593843460083008, 3.8010663986206055, 3.925262928009033, 2.0941054821014404, 3.984683036804199, 3.4874961376190186, 3.5635457038879395, 4.7057905197143555, 3.1967320442199707, 3.0673437118530273, 3.321580410003662, 3.6895992755889893, 3.7784013748168945, 3.2212555408477783, 2.514150619506836, 2.84138560295105, 3.4739725589752197], "mean_td_error": 3.2656824588775635, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 45.0, "diff_num_grad_updates_vs_sampler_policy": 44.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.093889236450195, "actor_loss": -5.483260154724121, "critic_loss": 0.2499331831932068, "alpha_loss": -0.13327236473560333, "alpha_value": 0.9868835210800171, "log_alpha_value": -0.01320327166467905, "target_entropy": -6.0, "policy_t": 0.01325291208922863, "mean_q": 1.6329691410064697, "max_q": 5.18889856338501, "min_q": 1.4796533584594727}, "td_error": [0.44501346349716187, 0.4054771661758423, 0.40540260076522827, 0.9753251671791077, 1.44358229637146, 2.034860134124756, 1.5573493242263794, 0.7208170294761658, 2.6168980598449707, 0.9023637771606445, 1.8283240795135498, 0.9570080637931824, 0.2843024730682373, 0.20835280418395996, 0.29971981048583984, 0.2604480981826782, 0.6402465105056763, 0.6985548138618469, 0.9745959043502808, 0.830847978591919, 0.0684736967086792, 2.911911964416504, 1.1647248268127441, 1.4543148279190063, 0.08570772409439087, 0.6633108258247375, 0.7603391408920288, 0.5549908876419067, 1.517336130142212, 1.1534565687179565, 0.11537957191467285, 1.9205759763717651, 0.21143925189971924, 3.5264580249786377, 4.66583776473999, 1.4757885932922363, 2.959730863571167, 1.6191753149032593, 0.6158921122550964, 0.61121666431427, 1.6351265907287598, 1.8118071556091309, 1.9137535095214844, 0.47425776720046997, 0.4357680678367615, 1.4696815013885498, 0.08320403099060059, 1.0628492832183838, 1.983604073524475, 0.7045077085494995, 1.9184026718139648, 0.3584693670272827, 2.499042510986328, 2.244901180267334, 0.8728177547454834, 0.5037441253662109, 0.5589905977249146, 0.49665284156799316, 1.3815275430679321, 1.2379405498504639, 2.2218899726867676, 0.43435126543045044, 1.3631908893585205, 0.17957335710525513, 2.3735849857330322, 1.2715466022491455, 2.4227328300476074, 1.9365026950836182, 1.8857954740524292, 0.1909501552581787, 0.1708691120147705, 0.5803322792053223, 1.5568958520889282, 2.5024938583374023, 0.8193691968917847, 2.745037317276001, 0.6553291082382202, 0.21262967586517334, 2.2987401485443115, 2.356522560119629, 0.3878275752067566, 1.2217228412628174, 1.4389827251434326, 2.4517502784729004, 2.514782428741455, 2.758103847503662], "mean_td_error": 1.2691174745559692, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 45.0, "diff_num_grad_updates_vs_sampler_policy": 44.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.05709457397461, "actor_loss": -5.521328926086426, "critic_loss": 0.38965505361557007, "alpha_loss": -0.13282813131809235, "alpha_value": 0.9868794083595276, "log_alpha_value": -0.013207404874265194, "target_entropy": -6.0, "policy_t": 0.0029071758035570383, "mean_q": 1.7294325828552246, "max_q": 5.638230323791504, "min_q": 1.5700292587280273}, "td_error": [0.13953649997711182, 1.9642277956008911, 1.4909002780914307, 2.199331283569336, 2.006093978881836, 1.5684741735458374, 1.3613576889038086, 1.2841286659240723, 1.8688520193099976, 1.011366605758667, 1.1431193351745605, 1.4951250553131104, 0.13701725006103516, 1.3864526748657227, 2.9432806968688965, 0.806068480014801, 2.7073962688446045, 2.556670665740967, 1.9303805828094482, 1.3040308952331543, 0.5639857053756714, 0.5566706657409668, 0.13710135221481323, 0.8855393528938293, 2.4972825050354004, 0.7189174890518188, 4.639867305755615, 1.6631815433502197, 0.33920180797576904, 2.101395606994629, 1.6257667541503906, 0.37042248249053955, 0.2992650866508484, 1.8585976362228394, 0.9714025259017944, 2.4430596828460693, 0.5697161555290222, 0.8777133226394653, 1.5050795078277588, 0.8857289552688599, 2.855947971343994, 0.39145195484161377, 0.08827078342437744, 0.4986421465873718, 0.399000346660614, 2.3695836067199707, 1.8307617902755737, 0.7462929487228394, 1.4704536199569702, 1.4645471572875977, 0.17093050479888916, 2.289318561553955, 1.251800775527954, 1.8645374774932861, 3.1134543418884277, 2.030956745147705, 3.966905117034912, 0.09485220909118652, 1.8942115306854248, 0.842317521572113, 0.7945979833602905, 0.10669100284576416, 1.5008468627929688, 1.515984296798706, 1.4230682849884033, 0.6795873045921326, 0.4954352378845215, 2.439518928527832, 0.3233245015144348, 0.9989867806434631, 0.4325089454650879, 1.625533103942871, 1.0139294862747192, 1.2670719623565674, 2.05855655670166, 1.8241432905197144, 2.006432056427002, 2.766268491744995, 1.5453953742980957, 1.9760383367538452, 1.0213215351104736, 0.4476722478866577, 0.3435293436050415, 1.3123407363891602, 0.08837085962295532, 1.3495113849639893], "mean_td_error": 1.3698209524154663, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 45.0, "diff_num_grad_updates_vs_sampler_policy": 44.0}}, "num_env_steps_sampled": 41216, "num_env_steps_trained": 11610, "num_agent_steps_sampled": 123648, "num_agent_steps_trained": 11610, "last_target_update_ts": 41216, "num_target_updates": 45}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 123648, "num_agent_steps_trained": 11610, "num_env_steps_sampled": 41216, "num_env_steps_trained": 11610, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 928.1380464973381, "num_env_steps_trained_throughput_per_sec": 267.254035710171, "timesteps_total": 41216, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 123648, "timers": {"training_iteration_time_ms": 924.673, "sample_time_ms": 626.594, "load_time_ms": 0.312, "load_throughput": 826937.515, "learn_time_ms": 18.239, "learn_throughput": 14145.366, "synch_weights_time_ms": 9.773}, "counters": {"num_env_steps_sampled": 41216, "num_env_steps_trained": 11610, "num_agent_steps_sampled": 123648, "num_agent_steps_trained": 11610, "last_target_update_ts": 41216, "num_target_updates": 45}, "done": false, "episodes_total": 0, "training_iteration": 28, "trial_id": "7066a_00000", "date": "2023-11-18_21-07-40", "timestamp": 1700370460, "time_this_iter_s": 1.9404270648956299, "time_total_s": 44.38618445396423, "pid": 7187, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x3124682c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 44.38618445396423, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 71.2, "ram_util_percent": 64.86666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.157309532165527, "actor_loss": -5.723658084869385, "critic_loss": 1.0260417461395264, "alpha_loss": -0.14027619361877441, "alpha_value": 0.9862845540046692, "log_alpha_value": -0.013810369186103344, "target_entropy": -6.0, "policy_t": -0.02627677284181118, "mean_q": 1.9636099338531494, "max_q": 10.412304878234863, "min_q": 1.6179531812667847}, "td_error": [1.89408540725708, 3.7017173767089844, 2.8639984130859375, 2.902569532394409, 3.810389518737793, 3.2969295978546143, 1.8123308420181274, 3.3494269847869873, 6.162010669708252, 3.1041603088378906, 2.395475149154663, 1.595293641090393, 2.238879680633545, 3.123037338256836, 3.627408981323242, 4.657956600189209, 3.7613227367401123, 3.759105682373047, 2.3432350158691406, 2.7965474128723145, 3.718599796295166, 3.0813281536102295, 2.9137139320373535, 4.745379447937012, 2.4808685779571533, 2.8162925243377686, 5.153653144836426, 2.4680142402648926, 2.791208267211914, 1.7794767618179321, 4.620421409606934, 4.316960334777832, 2.847594738006592, 4.197254657745361, 1.9281320571899414, 0.8724765181541443, 3.450242757797241, 2.545064926147461, 4.582843780517578, 2.9060516357421875, 3.4730982780456543, 1.6428654193878174, 2.699610710144043, 4.430051326751709, 2.1420578956604004, 2.363269805908203, 4.15548038482666, 2.3877902030944824, 3.3690474033355713, 2.6043214797973633, 2.7285070419311523, 0.5908393859863281, 1.120779037475586, 2.7308664321899414, 3.800692319869995, 4.52958345413208, 3.637996196746826, 4.221512317657471, 3.6481809616088867, 1.6650757789611816, 5.258461952209473, 3.710446357727051, 1.1684916019439697, 0.7919169664382935, 3.081648349761963, 2.7049784660339355, 3.5479135513305664, 2.751124143600464, 3.021786689758301, 4.157525062561035, 3.092172145843506, 3.522153615951538, 1.1800389289855957, 2.373655080795288, 2.4069857597351074, 2.2755706310272217, 5.572415828704834, 3.508751392364502, 2.1585090160369873, 1.9391789436340332, 5.197339057922363, 1.6357598304748535, 7.308645725250244, 2.310704469680786, 2.206491470336914, 3.708890914916992], "mean_td_error": 3.092379570007324, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 47.0, "diff_num_grad_updates_vs_sampler_policy": 46.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.088871002197266, "actor_loss": -5.589033126831055, "critic_loss": 0.2573167085647583, "alpha_loss": -0.13926135003566742, "alpha_value": 0.9862913489341736, "log_alpha_value": -0.013803462497889996, "target_entropy": -6.0, "policy_t": -0.013920607976615429, "mean_q": 1.73973548412323, "max_q": 6.3610615730285645, "min_q": 1.6163625717163086}, "td_error": [2.018270969390869, 0.4967465400695801, 1.6974396705627441, 2.3431124687194824, 1.173779845237732, 0.4047214388847351, 3.0264618396759033, 0.287389874458313, 1.2895419597625732, 0.7544353604316711, 2.317575454711914, 1.0170114040374756, 0.9471933841705322, 1.2850439548492432, 0.5239078402519226, 0.8353455066680908, 1.345164179801941, 2.104964256286621, 1.8974974155426025, 1.901403784751892, 0.47096753120422363, 2.713233470916748, 1.4960734844207764, 3.2696781158447266, 1.821037769317627, 1.2797582149505615, 1.0234525203704834, 0.8637452721595764, 2.1484737396240234, 1.4042670726776123, 2.9659903049468994, 1.117790937423706, 0.3686426281929016, 2.2686767578125, 1.6091985702514648, 2.5620956420898438, 2.6786630153656006, 0.3726038932800293, 0.888251006603241, 0.4418426752090454, 1.3891128301620483, 0.41318273544311523, 0.5125776529312134, 0.5804057717323303, 2.248441219329834, 0.5877213478088379, 0.54274982213974, 0.07967162132263184, 0.1669391393661499, 0.8775491118431091, 1.8363583087921143, 0.6309385299682617, 1.4942690134048462, 0.26850640773773193, 0.9784919023513794, 1.2602717876434326, 0.9238971471786499, 1.7700116634368896, 1.5672844648361206, 0.1075480580329895, 2.0421090126037598, 1.5209814310073853, 1.5529417991638184, 1.1818076372146606, 1.792504906654358, 1.124133586883545, 1.1582791805267334, 0.16261959075927734, 0.7736503481864929, 0.7226052284240723, 0.5557349920272827, 1.5516304969787598, 1.117401123046875, 0.545414388179779, 3.4461677074432373, 0.0788109302520752, 2.53439998626709, 2.017854690551758, 0.22713541984558105, 0.4269537925720215, 1.5322010517120361, 2.7442474365234375, 2.7781503200531006, 0.5806086659431458, 0.07726496458053589, 3.756544589996338], "mean_td_error": 1.3217387199401855, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 47.0, "diff_num_grad_updates_vs_sampler_policy": 46.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.081290245056152, "actor_loss": -5.639371871948242, "critic_loss": 0.4169090688228607, "alpha_loss": -0.1391969621181488, "alpha_value": 0.9862874150276184, "log_alpha_value": -0.013807456009089947, "target_entropy": -6.0, "policy_t": 0.09419478476047516, "mean_q": 1.9107677936553955, "max_q": 5.421717643737793, "min_q": 1.7146294116973877}, "td_error": [1.275890588760376, 1.0065631866455078, 0.9389568567276001, 0.8343278169631958, 2.450284004211426, 0.5987390875816345, 1.4710404872894287, 0.5403205752372742, 1.2182831764221191, 0.18326705694198608, 2.0969531536102295, 0.7763668298721313, 1.4305931329727173, 1.643941044807434, 0.27127498388290405, 0.9536393284797668, 0.6280230283737183, 2.610429048538208, 1.3370124101638794, 1.5522973537445068, 2.765239953994751, 0.41830992698669434, 0.3309962749481201, 0.8915877342224121, 0.597992479801178, 1.028445839881897, 2.851398468017578, 1.4570943117141724, 0.8781644701957703, 0.10055816173553467, 0.9806488156318665, 1.9115171432495117, 1.5852627754211426, 1.944869875907898, 0.42658531665802, 2.2489089965820312, 2.0237832069396973, 1.2133095264434814, 1.2576627731323242, 1.0296390056610107, 1.3620939254760742, 2.572496175765991, 1.2196142673492432, 2.770498275756836, 0.7059551477432251, 1.9061294794082642, 1.3911612033843994, 1.810617208480835, 1.7084181308746338, 0.871928870677948, 1.2515846490859985, 3.1300506591796875, 1.723456621170044, 1.8593230247497559, 1.4050440788269043, 1.92253839969635, 1.2309221029281616, 0.7130633592605591, 0.5694491863250732, 2.645723819732666, 1.2311837673187256, 0.44672954082489014, 1.8461759090423584, 2.4792628288269043, 2.09614896774292, 0.9549624919891357, 0.753730833530426, 0.9311666488647461, 2.608656406402588, 2.0544867515563965, 2.9374470710754395, 0.520054817199707, 2.234285831451416, 2.088654041290283, 0.8363745212554932, 0.9546151757240295, 0.47430485486984253, 2.9763646125793457, 1.3891403675079346, 1.0644524097442627, 1.9325839281082153, 1.8166658878326416, 1.225435733795166, 2.4961705207824707, 0.18416917324066162, 3.1585376262664795], "mean_td_error": 1.4444420337677002, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 47.0, "diff_num_grad_updates_vs_sampler_policy": 46.0}}, "num_env_steps_sampled": 43008, "num_env_steps_trained": 12126, "num_agent_steps_sampled": 129024, "num_agent_steps_trained": 12126, "last_target_update_ts": 43008, "num_target_updates": 47}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 129024, "num_agent_steps_trained": 12126, "num_env_steps_sampled": 43008, "num_env_steps_trained": 12126, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 975.4424474515922, "num_env_steps_trained_throughput_per_sec": 280.87516902065937, "timesteps_total": 43008, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 129024, "timers": {"training_iteration_time_ms": 908.355, "sample_time_ms": 632.399, "load_time_ms": 0.313, "load_throughput": 824605.983, "learn_time_ms": 18.27, "learn_throughput": 14121.37, "synch_weights_time_ms": 9.968}, "counters": {"num_env_steps_sampled": 43008, "num_env_steps_trained": 12126, "num_agent_steps_sampled": 129024, "num_agent_steps_trained": 12126, "last_target_update_ts": 43008, "num_target_updates": 47}, "done": false, "episodes_total": 0, "training_iteration": 29, "trial_id": "7066a_00000", "date": "2023-11-18_21-07-42", "timestamp": 1700370462, "time_this_iter_s": 1.84645676612854, "time_total_s": 46.23264122009277, "pid": 7187, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x31039e840>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 46.23264122009277, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 65.76666666666667, "ram_util_percent": 64.83333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.087291717529297, "actor_loss": -5.8191728591918945, "critic_loss": 1.0085222721099854, "alpha_loss": -0.14537030458450317, "alpha_value": 0.9856920838356018, "log_alpha_value": -0.014411231502890587, "target_entropy": -6.0, "policy_t": 0.034818682819604874, "mean_q": 2.1801908016204834, "max_q": 11.520727157592773, "min_q": 1.752212405204773}, "td_error": [2.009561538696289, 2.0157673358917236, 4.372689723968506, 5.8165669441223145, 4.094211578369141, 3.421767234802246, 4.580589294433594, 4.440980911254883, 2.0811057090759277, 3.412731409072876, 2.6451804637908936, 2.995039939880371, 2.05246639251709, 1.7003580331802368, 2.084287166595459, 1.9722707271575928, 3.6317389011383057, 1.6522736549377441, 2.196178913116455, 4.213331699371338, 4.020705699920654, 2.007229804992676, 3.308713912963867, 5.285863876342773, 2.482863426208496, 2.5424580574035645, 1.3611540794372559, 2.8261022567749023, 2.984701633453369, 2.5022051334381104, 2.6112723350524902, 4.322940826416016, 3.355340003967285, 7.535215854644775, 7.314524173736572, 1.4447698593139648, 3.1435294151306152, 1.2638471126556396, 3.746077060699463, 3.642369508743286, 4.138800621032715, 1.566634178161621, 3.444028854370117, 2.5886144638061523, 2.7823567390441895, 1.5345507860183716, 3.7774596214294434, 2.6443610191345215, 1.74434494972229, 4.694228649139404, 2.514495611190796, 4.1531782150268555, 3.5478429794311523, 2.0427284240722656, 3.4546279907226562, 8.408428192138672, 1.5814093351364136, 1.9605306386947632, 4.8783111572265625, 3.0149097442626953, 2.8978190422058105, 0.06325089931488037, 1.9265100955963135, 1.584522008895874, 3.39760160446167, 2.3990025520324707, 4.7029242515563965, 1.9925563335418701, 2.5120553970336914, 2.588529586791992, 2.2403697967529297, 3.425450086593628, 2.753093719482422, 5.063448905944824, 4.017434597015381, 0.605147659778595, 1.8546828031539917, 1.9465821981430054, 1.3930189609527588, 3.015517234802246, 1.389723300933838, 4.1583781242370605, 1.750715970993042, 3.4623661041259766, 2.286284923553467, 3.398047924041748], "mean_td_error": 3.0277657508850098, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 49.0, "diff_num_grad_updates_vs_sampler_policy": 48.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.05878734588623, "actor_loss": -5.66484260559082, "critic_loss": 0.2806333899497986, "alpha_loss": -0.144882470369339, "alpha_value": 0.9856996536254883, "log_alpha_value": -0.01440357230603695, "target_entropy": -6.0, "policy_t": 0.009453488513827324, "mean_q": 1.973446011543274, "max_q": 6.3408379554748535, "min_q": 1.756148338317871}, "td_error": [0.058738529682159424, 0.3558104634284973, 0.8197259902954102, 1.94461989402771, 4.176069259643555, 0.6106324195861816, 1.6230543851852417, 0.37374454736709595, 2.0165767669677734, 1.8140124082565308, 1.427431344985962, 0.35410791635513306, 2.9869871139526367, 1.3549401760101318, 1.0635044574737549, 0.6928789615631104, 1.0122389793395996, 1.296255350112915, 1.1230335235595703, 0.36971473693847656, 1.7387921810150146, 0.20126420259475708, 2.423537254333496, 1.9770317077636719, 0.3363211154937744, 2.158143997192383, 2.0457394123077393, 1.3568344116210938, 1.3855700492858887, 2.180016040802002, 1.3934576511383057, 4.718845844268799, 1.339492678642273, 0.9289574027061462, 2.3063344955444336, 1.3399341106414795, 1.1277098655700684, 2.413633108139038, 1.3989086151123047, 0.6880577206611633, 2.0392541885375977, 2.1525824069976807, 2.48237943649292, 1.7143651247024536, 2.7936229705810547, 0.7185925245285034, 1.0551055669784546, 1.1621699333190918, 1.9739493131637573, 0.3565150499343872, 3.0975208282470703, 3.968127489089966, 2.0599749088287354, 0.8235383033752441, 0.15375947952270508, 0.13541483879089355, 0.7537168264389038, 0.08448505401611328, 1.4582966566085815, 1.1577163934707642, 1.8424437046051025, 0.1761952042579651, 2.7581570148468018, 0.09807878732681274, 0.9015712141990662, 1.996885895729065, 0.31791579723358154, 1.7398161888122559, 2.594862222671509, 1.7980892658233643, 1.0419518947601318, 1.214031457901001, 0.9467617869377136, 1.0893363952636719, 1.254400610923767, 0.18819314241409302, 0.13738012313842773, 2.0460333824157715, 2.813312530517578, 2.4617526531219482, 2.271390438079834, 0.27878832817077637, 0.8059449791908264, 0.15084987878799438, 0.0830720067024231, 0.32810699939727783], "mean_td_error": 1.4001054763793945, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 49.0, "diff_num_grad_updates_vs_sampler_policy": 48.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.054238319396973, "actor_loss": -5.79557991027832, "critic_loss": 0.31230151653289795, "alpha_loss": -0.14485833048820496, "alpha_value": 0.9856956005096436, "log_alpha_value": -0.01440768875181675, "target_entropy": -6.0, "policy_t": -0.0014520144322887063, "mean_q": 2.0931503772735596, "max_q": 5.171903610229492, "min_q": 1.867984414100647}, "td_error": [0.4592171907424927, 2.0393199920654297, 0.4988534450531006, 0.09148740768432617, 0.2424917221069336, 2.646616220474243, 1.2023465633392334, 0.0982828140258789, 1.1586284637451172, 1.4539783000946045, 2.938835620880127, 0.21321475505828857, 0.6852405071258545, 1.946983814239502, 1.1327557563781738, 1.6307990550994873, 1.224656105041504, 0.9513543248176575, 1.421610951423645, 0.09412914514541626, 0.5714657306671143, 0.1003645658493042, 1.5655653476715088, 0.9357897043228149, 1.6074395179748535, 0.29493600130081177, 0.4885690212249756, 0.657708466053009, 0.35903531312942505, 0.46885406970977783, 0.5042275190353394, 0.27861112356185913, 0.42472684383392334, 0.6277140974998474, 1.2456867694854736, 1.195702075958252, 0.11161470413208008, 4.186004161834717, 1.4600553512573242, 0.1268024444580078, 1.742018461227417, 0.6005237698554993, 1.5217560529708862, 1.9709683656692505, 3.522427558898926, 1.6534879207611084, 0.5699553489685059, 0.48878949880599976, 1.2326277494430542, 0.38310927152633667, 1.970474362373352, 0.9702939987182617, 0.42782062292099, 1.3492178916931152, 0.25015151500701904, 1.7698259353637695, 1.601698637008667, 1.1412595510482788, 1.9499804973602295, 1.3612321615219116, 0.9649441242218018, 0.7480926513671875, 0.5635508298873901, 0.5445427894592285, 2.4704461097717285, 0.7645704746246338, 1.2786747217178345, 1.8256680965423584, 0.10403305292129517, 0.4016087055206299, 0.4559437036514282, 0.9950995445251465, 1.2127395868301392, 1.664825201034546, 2.0614452362060547, 0.09918016195297241, 2.2406036853790283, 1.3620953559875488, 0.7718023657798767, 2.0412707328796387, 1.8736953735351562, 1.6226098537445068, 2.2007131576538086, 0.28022944927215576, 0.9493069648742676, 3.5264089107513428], "mean_td_error": 1.1493417024612427, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 49.0, "diff_num_grad_updates_vs_sampler_policy": 48.0}}, "num_env_steps_sampled": 44800, "num_env_steps_trained": 12642, "num_agent_steps_sampled": 134400, "num_agent_steps_trained": 12642, "last_target_update_ts": 44800, "num_target_updates": 49}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 134400, "num_agent_steps_trained": 12642, "num_env_steps_sampled": 44800, "num_env_steps_trained": 12642, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 1008.6932158934624, "num_env_steps_trained_throughput_per_sec": 290.44960904075145, "timesteps_total": 44800, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 134400, "timers": {"training_iteration_time_ms": 917.404, "sample_time_ms": 644.647, "load_time_ms": 0.31, "load_throughput": 831704.275, "learn_time_ms": 18.251, "learn_throughput": 14135.906, "synch_weights_time_ms": 10.142}, "counters": {"num_env_steps_sampled": 44800, "num_env_steps_trained": 12642, "num_agent_steps_sampled": 134400, "num_agent_steps_trained": 12642, "last_target_update_ts": 44800, "num_target_updates": 49}, "done": false, "episodes_total": 0, "training_iteration": 30, "trial_id": "7066a_00000", "date": "2023-11-18_21-07-44", "timestamp": 1700370464, "time_this_iter_s": 1.785128116607666, "time_total_s": 48.01776933670044, "pid": 7187, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x312468680>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 48.01776933670044, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 65.44999999999999, "ram_util_percent": 64.75}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.073051452636719, "actor_loss": -5.922616481781006, "critic_loss": 0.942070722579956, "alpha_loss": -0.1512167751789093, "alpha_value": 0.9851000905036926, "log_alpha_value": -0.015012011863291264, "target_entropy": -6.0, "policy_t": -0.005867479369044304, "mean_q": 2.151885747909546, "max_q": 10.672773361206055, "min_q": 1.8964903354644775}, "td_error": [2.0247488021850586, 2.780909538269043, 1.0211071968078613, 2.290971279144287, 1.6854338645935059, 2.7593061923980713, 1.6618704795837402, 5.859989643096924, 2.1484408378601074, 3.9450080394744873, 2.534644603729248, 1.8897440433502197, 3.8847737312316895, 2.6554627418518066, 2.4995312690734863, 2.816434383392334, 2.317931652069092, 3.1801629066467285, 3.1035561561584473, 4.589099407196045, 5.481934070587158, 1.6629550457000732, 1.907875895500183, 2.854403018951416, 2.702204942703247, 4.39019775390625, 3.642101764678955, 2.6272525787353516, 2.5341968536376953, 3.2960705757141113, 1.1435413360595703, 2.953685760498047, 2.244014024734497, 3.200991630554199, 2.4946930408477783, 0.8991379737854004, 3.3994269371032715, 1.684037685394287, 2.9236745834350586, 2.8244218826293945, 7.33200740814209, 1.3521547317504883, 4.987576484680176, 3.765709638595581, 3.8327412605285645, 3.094266891479492, 2.3333168029785156, 2.252647876739502, 0.7232853770256042, 2.797257661819458, 0.6910221576690674, 3.049527883529663, 2.1840038299560547, 3.6597678661346436, 3.543510913848877, 1.862666130065918, 0.9878909587860107, 3.243274211883545, 2.2756495475769043, 2.4741978645324707, 3.565162181854248, 2.6564712524414062, 1.580750823020935, 1.5078363418579102, 1.2214314937591553, 3.252249240875244, 4.135311126708984, 3.8805055618286133, 3.7965519428253174, 1.6409204006195068, 2.7753167152404785, 2.8348097801208496, 3.3603663444519043, 2.6514687538146973, 3.524665117263794, 2.1467044353485107, 6.734872341156006, 2.3993582725524902, 3.3065483570098877, 3.725219488143921, 3.7856075763702393, 3.4660158157348633, 4.431022644042969, 2.7596046924591064, 2.759084939956665, 4.0929765701293945], "mean_td_error": 2.894758701324463, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 51.0, "diff_num_grad_updates_vs_sampler_policy": 50.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.07778263092041, "actor_loss": -5.850800037384033, "critic_loss": 0.25815218687057495, "alpha_loss": -0.1512029767036438, "alpha_value": 0.9851083755493164, "log_alpha_value": -0.015003597363829613, "target_entropy": -6.0, "policy_t": 0.02072572335600853, "mean_q": 2.2633707523345947, "max_q": 6.835360527038574, "min_q": 1.8702086210250854}, "td_error": [2.575000762939453, 2.658602714538574, 0.45919305086135864, 0.824994683265686, 0.7542832493782043, 1.3821182250976562, 0.45742934942245483, 1.7915852069854736, 0.08980178833007812, 1.547356367111206, 2.0798659324645996, 0.5057335495948792, 0.09697669744491577, 1.4097099304199219, 1.8436756134033203, 0.14974647760391235, 1.712942123413086, 1.1895363330841064, 1.0037635564804077, 1.2438831329345703, 0.3968484401702881, 0.105560302734375, 2.5956196784973145, 2.3112072944641113, 0.20861315727233887, 0.2032153606414795, 1.0960283279418945, 1.369840383529663, 6.53897762298584, 1.5110793113708496, 1.0573657751083374, 0.16373181343078613, 0.9541376233100891, 2.7096683979034424, 0.12809902429580688, 0.8025079965591431, 0.9963419437408447, 0.1042255163192749, 0.4092363119125366, 0.38617217540740967, 0.9393818378448486, 1.6404842138290405, 1.6003066301345825, 0.6101908683776855, 0.5423540472984314, 0.42118966579437256, 1.0885980129241943, 3.1563608646392822, 1.9601850509643555, 0.2548341155052185, 1.3530761003494263, 1.5742878913879395, 0.33508604764938354, 1.0053696632385254, 1.145263910293579, 1.2183125019073486, 1.0912114381790161, 1.0778439044952393, 2.8692336082458496, 0.08536714315414429, 0.25649869441986084, 0.08103251457214355, 1.9976608753204346, 1.5730557441711426, 0.8788551688194275, 7.308209419250488, 1.761306643486023, 2.0182173252105713, 1.5543020963668823, 1.8696976900100708, 0.8508365750312805, 2.04581880569458, 2.4151673316955566, 0.3762511610984802, 1.7209371328353882, 0.18811380863189697, 0.8037447333335876, 0.12839877605438232, 3.3481969833374023, 0.5375015139579773, 0.10196822881698608, 0.7567514777183533, 1.132320523262024, 2.1637399196624756, 0.5800440907478333, 0.24968594312667847], "mean_td_error": 1.2615340948104858, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 51.0, "diff_num_grad_updates_vs_sampler_policy": 50.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.095504760742188, "actor_loss": -5.979409217834473, "critic_loss": 0.30171746015548706, "alpha_loss": -0.1515127271413803, "alpha_value": 0.9851041436195374, "log_alpha_value": -0.01500794105231762, "target_entropy": -6.0, "policy_t": -0.021577736362814903, "mean_q": 2.119039297103882, "max_q": 4.081968307495117, "min_q": 1.8674037456512451}, "td_error": [0.13212472200393677, 1.4390639066696167, 2.0064196586608887, 0.2404429316520691, 0.6159914135932922, 0.7987619638442993, 1.0288867950439453, 1.0461291074752808, 0.8787985444068909, 0.5054945945739746, 0.5146125555038452, 0.16848814487457275, 0.7527197599411011, 0.4128533601760864, 0.9238641262054443, 1.5168980360031128, 0.6943331956863403, 1.3408949375152588, 1.3788642883300781, 0.8429545164108276, 2.5329577922821045, 0.16972148418426514, 0.6208269596099854, 2.1122426986694336, 0.042473673820495605, 1.5167276859283447, 1.87498140335083, 0.42891812324523926, 0.14975202083587646, 1.1503021717071533, 1.2155416011810303, 0.8107017278671265, 2.5181498527526855, 1.6730060577392578, 0.9666644334793091, 2.709117889404297, 0.3974342942237854, 1.109372615814209, 1.7378251552581787, 1.8367693424224854, 1.682706356048584, 1.326673984527588, 0.5753399133682251, 2.4078969955444336, 1.3927133083343506, 0.9167582988739014, 2.529506206512451, 1.428552269935608, 0.7113061547279358, 1.2918293476104736, 1.3281059265136719, 1.0031437873840332, 1.5756862163543701, 0.876307487487793, 0.09539532661437988, 0.5715624094009399, 0.8580293655395508, 1.9881596565246582, 1.094188928604126, 2.2791788578033447, 0.37517255544662476, 1.3348082304000854, 1.831223964691162, 1.555302619934082, 2.4407012462615967, 0.25972598791122437, 1.3935649394989014, 1.9518353939056396, 0.4211472272872925, 0.6864825487136841, 1.3834798336029053, 1.0235164165496826, 2.2862489223480225, 1.7434468269348145, 1.6386667490005493, 2.661923885345459, 0.8120142817497253, 1.528000831604004, 0.6292946338653564, 0.9014053344726562, 0.3726351857185364, 0.14207381010055542, 1.1044118404388428, 0.8692296743392944, 0.0940278172492981, 0.45717036724090576], "mean_td_error": 1.1470073461532593, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 51.0, "diff_num_grad_updates_vs_sampler_policy": 50.0}}, "num_env_steps_sampled": 46592, "num_env_steps_trained": 13158, "num_agent_steps_sampled": 139776, "num_agent_steps_trained": 13158, "last_target_update_ts": 46592, "num_target_updates": 51}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 139776, "num_agent_steps_trained": 13158, "num_env_steps_sampled": 46592, "num_env_steps_trained": 13158, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 810.693192638456, "num_env_steps_trained_throughput_per_sec": 233.43620948741258, "timesteps_total": 46592, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 139776, "timers": {"training_iteration_time_ms": 961.405, "sample_time_ms": 660.951, "load_time_ms": 0.311, "load_throughput": 829282.268, "learn_time_ms": 18.163, "learn_throughput": 14204.617, "synch_weights_time_ms": 9.574}, "counters": {"num_env_steps_sampled": 46592, "num_env_steps_trained": 13158, "num_agent_steps_sampled": 139776, "num_agent_steps_trained": 13158, "last_target_update_ts": 46592, "num_target_updates": 51}, "done": false, "episodes_total": 0, "training_iteration": 31, "trial_id": "7066a_00000", "date": "2023-11-18_21-07-46", "timestamp": 1700370466, "time_this_iter_s": 2.22015118598938, "time_total_s": 50.23792052268982, "pid": 7187, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x31039dee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 50.23792052268982, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 62.0, "ram_util_percent": 64.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.121391296386719, "actor_loss": -6.144321918487549, "critic_loss": 0.8918496370315552, "alpha_loss": -0.15802133083343506, "alpha_value": 0.9845086336135864, "log_alpha_value": -0.015612608753144741, "target_entropy": -6.0, "policy_t": 0.013970525935292244, "mean_q": 2.2867629528045654, "max_q": 10.824315071105957, "min_q": 2.0537283420562744}, "td_error": [1.8509032726287842, 3.8524556159973145, 3.438858985900879, 1.4843292236328125, 1.9765335321426392, 3.484100818634033, 3.7898807525634766, 2.9180099964141846, 2.6980409622192383, 2.6301074028015137, 1.21783447265625, 2.25726318359375, 1.1468640565872192, 3.561312198638916, 3.157259225845337, 2.087649345397949, 4.025437831878662, 2.853449821472168, 2.9518280029296875, 2.1235194206237793, 3.370522975921631, 3.7253265380859375, 3.3011796474456787, 2.350261926651001, 0.8970038890838623, 1.0634710788726807, 3.7155444622039795, 2.297565460205078, 2.87078857421875, 4.613115310668945, 1.9230124950408936, 3.4358670711517334, 1.2324128150939941, 1.9692927598953247, 1.6241012811660767, 3.0951356887817383, 2.0298445224761963, 1.1620556116104126, 4.539827346801758, 1.6530983448028564, 2.586029529571533, 4.273262023925781, 3.3395795822143555, 2.5849111080169678, 4.431416988372803, 0.9914302825927734, 2.8068251609802246, 1.9862827062606812, 2.967081069946289, 4.396482944488525, 3.8092830181121826, 2.936488151550293, 1.7203937768936157, 3.023184299468994, 3.096892833709717, 2.4609951972961426, 2.848599672317505, 2.7566380500793457, 3.408405303955078, 3.506082773208618, 1.361196756362915, 3.5497043132781982, 3.005904197692871, 3.4496803283691406, 3.0145511627197266, 2.1964597702026367, 4.012272834777832, 3.52091121673584, 3.6580612659454346, 2.970980167388916, 2.476517915725708, 1.7215787172317505, 1.5102989673614502, 2.9907827377319336, 3.8520379066467285, 1.7780489921569824, 2.4564363956451416, 2.9435126781463623, 3.1728124618530273, 2.5138978958129883, 4.1721038818359375, 2.322117328643799, 5.574680805206299, 2.6734843254089355, 1.5291011333465576, 3.271476984024048], "mean_td_error": 2.790743350982666, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 53.0, "diff_num_grad_updates_vs_sampler_policy": 52.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.092935562133789, "actor_loss": -5.979063510894775, "critic_loss": 0.22535163164138794, "alpha_loss": -0.15748590230941772, "alpha_value": 0.984517514705658, "log_alpha_value": -0.015603574924170971, "target_entropy": -6.0, "policy_t": 0.022038636729121208, "mean_q": 2.198431968688965, "max_q": 6.627317428588867, "min_q": 1.9504141807556152}, "td_error": [1.6049189567565918, 1.3957653045654297, 0.9030061960220337, 0.15811705589294434, 0.6986100077629089, 0.5667158365249634, 2.2940385341644287, 0.6000351905822754, 2.8832168579101562, 0.9948813915252686, 0.8898274898529053, 2.36287260055542, 0.9506632089614868, 0.09169906377792358, 0.4175187349319458, 0.505959153175354, 2.190446376800537, 0.9566202759742737, 1.6001006364822388, 1.1444367170333862, 1.6387641429901123, 1.529939889907837, 0.8344782590866089, 4.361225605010986, 2.496079921722412, 0.3607116937637329, 1.579824686050415, 0.5341479778289795, 1.6455439329147339, 0.6371803283691406, 1.3428218364715576, 1.3360332250595093, 0.337618350982666, 2.288428783416748, 0.6778526306152344, 0.3732452392578125, 0.9459923505783081, 0.30385446548461914, 1.7088069915771484, 0.10745388269424438, 1.3511731624603271, 0.748641312122345, 2.3147659301757812, 1.1732856035232544, 1.7453258037567139, 0.08634400367736816, 1.117459774017334, 1.9726297855377197, 0.9306848049163818, 1.5231372117996216, 0.8159182071685791, 1.0980290174484253, 1.5145158767700195, 0.8045310378074646, 0.34738099575042725, 0.6035131216049194, 0.7249110341072083, 2.408433675765991, 0.027027130126953125, 1.4241271018981934, 0.8153699636459351, 0.9258934259414673, 2.200314998626709, 3.09159517288208, 0.9030153751373291, 1.658881664276123, 1.9733409881591797, 0.14603495597839355, 0.10534131526947021, 0.10624778270721436, 0.10582661628723145, 0.37051355838775635, 1.3789153099060059, 0.26260876655578613, 2.143131732940674, 0.36137908697128296, 0.12184834480285645, 0.14213454723358154, 0.37422966957092285, 0.7926476001739502, 2.0073695182800293, 0.5595096349716187, 1.2856154441833496, 3.9991989135742188, 2.200836181640625, 1.5780832767486572], "mean_td_error": 1.169664740562439, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 53.0, "diff_num_grad_updates_vs_sampler_policy": 52.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.054064750671387, "actor_loss": -6.164356231689453, "critic_loss": 0.2669692039489746, "alpha_loss": -0.15692713856697083, "alpha_value": 0.9845128655433655, "log_alpha_value": -0.015608328394591808, "target_entropy": -6.0, "policy_t": -0.027226397767663002, "mean_q": 2.2636771202087402, "max_q": 4.263444900512695, "min_q": 1.9762648344039917}, "td_error": [1.18918776512146, 0.5806032419204712, 2.934169292449951, 1.6767605543136597, 1.2850065231323242, 0.3657306432723999, 0.9726512432098389, 1.3953609466552734, 0.8157436847686768, 1.207769751548767, 0.48771047592163086, 0.8125007152557373, 0.5606220960617065, 1.319975733757019, 0.09396505355834961, 0.5090981721878052, 1.7020299434661865, 1.8980072736740112, 0.2579822540283203, 0.28559422492980957, 0.425811767578125, 3.3441944122314453, 1.9199645519256592, 0.09049755334854126, 0.2068730592727661, 1.0173505544662476, 1.4976537227630615, 0.5440104007720947, 0.8081603050231934, 0.5798799991607666, 0.48674845695495605, 0.2241274118423462, 1.5741468667984009, 1.0498918294906616, 2.0422794818878174, 0.9473713636398315, 0.27486300468444824, 1.1050894260406494, 1.3643430471420288, 0.8728424310684204, 0.09240090847015381, 2.4254865646362305, 0.38926243782043457, 0.22653484344482422, 1.6404633522033691, 2.8420605659484863, 2.0752758979797363, 0.5838730335235596, 1.3653075695037842, 0.568628191947937, 0.2138526439666748, 3.0992109775543213, 0.273242712020874, 1.1437830924987793, 1.090545654296875, 1.1244556903839111, 0.3431529998779297, 1.5809595584869385, 0.09897017478942871, 0.10128748416900635, 1.0766470432281494, 1.1036486625671387, 0.5240999460220337, 1.990790843963623, 2.0067663192749023, 1.1047941446304321, 1.6891112327575684, 0.3370852470397949, 0.10366737842559814, 1.0136096477508545, 1.6651006937026978, 1.9898512363433838, 0.09233665466308594, 1.082183837890625, 0.35713517665863037, 0.34563612937927246, 1.1877055168151855, 1.059213638305664, 0.34207797050476074, 0.2453368902206421, 3.4092495441436768, 0.2071443796157837, 1.4035618305206299, 0.9085150957107544, 1.509585976600647, 1.0374664068222046], "mean_td_error": 1.044158697128296, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 53.0, "diff_num_grad_updates_vs_sampler_policy": 52.0}}, "num_env_steps_sampled": 48384, "num_env_steps_trained": 13674, "num_agent_steps_sampled": 145152, "num_agent_steps_trained": 13674, "last_target_update_ts": 48384, "num_target_updates": 53}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 145152, "num_agent_steps_trained": 13674, "num_env_steps_sampled": 48384, "num_env_steps_trained": 13674, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 1041.2460231129633, "num_env_steps_trained_throughput_per_sec": 299.8230736195809, "timesteps_total": 48384, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 145152, "timers": {"training_iteration_time_ms": 947.569, "sample_time_ms": 643.855, "load_time_ms": 0.312, "load_throughput": 825675.593, "learn_time_ms": 18.13, "learn_throughput": 14230.844, "synch_weights_time_ms": 9.77}, "counters": {"num_env_steps_sampled": 48384, "num_env_steps_trained": 13674, "num_agent_steps_sampled": 145152, "num_agent_steps_trained": 13674, "last_target_update_ts": 48384, "num_target_updates": 53}, "done": false, "episodes_total": 0, "training_iteration": 32, "trial_id": "7066a_00000", "date": "2023-11-18_21-07-48", "timestamp": 1700370468, "time_this_iter_s": 1.7307426929473877, "time_total_s": 51.96866321563721, "pid": 7187, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x3124693a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 51.96866321563721, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 71.8, "ram_util_percent": 64.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.184154510498047, "actor_loss": -6.379185676574707, "critic_loss": 0.8272754549980164, "alpha_loss": -0.16511845588684082, "alpha_value": 0.9839174747467041, "log_alpha_value": -0.016213269904255867, "target_entropy": -6.0, "policy_t": -0.002053047763183713, "mean_q": 2.5959370136260986, "max_q": 11.978925704956055, "min_q": 2.2232041358947754}, "td_error": [1.5449309349060059, 1.6379752159118652, 6.560351848602295, 1.7833160161972046, 2.3428354263305664, 2.415376901626587, 2.024125337600708, 2.746565103530884, 1.8775664567947388, 3.2802200317382812, 2.289937973022461, 4.404543876647949, 2.18143892288208, 1.7298787832260132, 2.1123528480529785, 2.2595114707946777, 4.258934020996094, 2.13036847114563, 3.4028143882751465, 2.812337875366211, 2.5485711097717285, 4.043191909790039, 0.9535254240036011, 1.7113025188446045, 3.033082962036133, 2.094618082046509, 3.646028518676758, 2.166339874267578, 4.306657314300537, 3.1933987140655518, 3.696791172027588, 2.2877609729766846, 1.8727256059646606, 3.36244797706604, 2.4096946716308594, 2.4062693119049072, 2.7428689002990723, 1.4909898042678833, 2.66635799407959, 2.4761037826538086, 2.005128860473633, 3.179196834564209, 3.334895610809326, 2.1364898681640625, 3.048922061920166, 3.703613758087158, 1.2398871183395386, 3.5723469257354736, 3.418184995651245, 4.0662126541137695, 2.002580165863037, 1.570103406906128, 3.4778411388397217, 1.634981393814087, 3.6628201007843018, 2.4565653800964355, 2.1748390197753906, 4.052234649658203, 3.83609676361084, 2.2837252616882324, 1.607564926147461, 1.8809576034545898, 1.5632628202438354, 2.041658878326416, 2.5544567108154297, 2.8850812911987305, 2.5977373123168945, 2.1576988697052, 0.8082880973815918, 1.1352297067642212, 2.5753815174102783, 2.5898520946502686, 3.4179654121398926, 2.6475915908813477, 2.562807321548462, 3.08844256401062, 2.0861706733703613, 5.889620304107666, 3.2351298332214355, 3.366938591003418, 1.2026106119155884, 1.8088994026184082, 1.214441180229187, 1.4355137348175049, 1.307515263557434, 4.4501519203186035], "mean_td_error": 2.626415491104126, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 55.0, "diff_num_grad_updates_vs_sampler_policy": 54.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.06983470916748, "actor_loss": -6.109714031219482, "critic_loss": 0.20804929733276367, "alpha_loss": -0.16316603124141693, "alpha_value": 0.9839271306991577, "log_alpha_value": -0.016203446313738823, "target_entropy": -6.0, "policy_t": -0.04183655604720116, "mean_q": 2.3397977352142334, "max_q": 6.369503498077393, "min_q": 2.176908016204834}, "td_error": [0.10768991708755493, 0.5085216760635376, 0.2017883062362671, 0.09610724449157715, 1.0944205522537231, 0.31955409049987793, 0.8540723323822021, 0.5410861968994141, 1.4524136781692505, 1.8580090999603271, 0.7562648057937622, 0.9096947908401489, 0.316311240196228, 0.22723698616027832, 2.5916757583618164, 0.8938885927200317, 1.4474499225616455, 2.1959824562072754, 0.9251132011413574, 1.1614543199539185, 1.0971641540527344, 0.08927726745605469, 0.5630666017532349, 0.24087584018707275, 0.7766691446304321, 0.15684688091278076, 0.0936880111694336, 1.2105995416641235, 3.329829692840576, 0.9771838188171387, 0.9823285341262817, 1.7999467849731445, 0.5130032300949097, 0.19045841693878174, 1.6198039054870605, 1.3976459503173828, 1.8728749752044678, 2.234811305999756, 1.0365163087844849, 2.2659263610839844, 0.0944591760635376, 1.4630537033081055, 0.7811899185180664, 0.09347069263458252, 3.704986572265625, 4.158795356750488, 0.8247318267822266, 1.4726053476333618, 0.7013521194458008, 2.0451645851135254, 0.18934428691864014, 0.5208866596221924, 0.26922523975372314, 1.5392593145370483, 1.0836169719696045, 2.341536521911621, 2.746159791946411, 1.1135289669036865, 2.3968541622161865, 2.9077553749084473, 0.6944544315338135, 1.1498422622680664, 0.3021831512451172, 0.34465789794921875, 0.2174384593963623, 1.709852695465088, 1.3358136415481567, 1.3495241403579712, 2.782538890838623, 0.23622643947601318, 1.0628794431686401, 2.2260239124298096, 0.5398564338684082, 0.31231528520584106, 2.558053970336914, 0.3051403760910034, 0.353163480758667, 0.13868653774261475, 0.3278658390045166, 2.3005928993225098, 0.1369304656982422, 0.5147648453712463, 0.11384069919586182, 1.1233222484588623, 0.7793724536895752, 0.5041790008544922], "mean_td_error": 1.102031946182251, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 55.0, "diff_num_grad_updates_vs_sampler_policy": 54.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.093563079833984, "actor_loss": -6.354856967926025, "critic_loss": 0.21841204166412354, "alpha_loss": -0.16360415518283844, "alpha_value": 0.9839218854904175, "log_alpha_value": -0.01620876044034958, "target_entropy": -6.0, "policy_t": 0.005737860221415758, "mean_q": 2.4230918884277344, "max_q": 4.094219207763672, "min_q": 2.09012508392334}, "td_error": [0.22585713863372803, 0.46983516216278076, 2.1944756507873535, 1.168144941329956, 0.10839653015136719, 3.035618782043457, 0.3044060468673706, 1.429993748664856, 3.6337547302246094, 0.09098982810974121, 0.09126365184783936, 2.6665189266204834, 0.27853989601135254, 0.43179333209991455, 0.36945903301239014, 0.7342174053192139, 0.11158335208892822, 0.5188596248626709, 1.985782504081726, 0.5712193250656128, 1.002435564994812, 1.9284989833831787, 1.8368780612945557, 1.6579475402832031, 0.49832355976104736, 0.09670019149780273, 0.9443707466125488, 1.1406015157699585, 0.9783698320388794, 0.2613260746002197, 0.7052373886108398, 0.14301574230194092, 0.5375328063964844, 1.1886659860610962, 0.48613762855529785, 0.3576768636703491, 1.307593584060669, 0.14010822772979736, 0.2395615577697754, 0.4317277669906616, 1.0250999927520752, 0.49650001525878906, 1.8921754360198975, 0.4417635202407837, 1.0694327354431152, 0.18114936351776123, 0.20295536518096924, 0.7736178636550903, 0.3262031078338623, 1.1740167140960693, 0.9113246202468872, 1.5662723779678345, 0.4558168649673462, 1.450042724609375, 0.09418535232543945, 0.7446463108062744, 1.161408543586731, 2.081592082977295, 0.7263935804367065, 0.18659496307373047, 1.4435995817184448, 1.7967240810394287, 1.1846179962158203, 0.627915620803833, 1.628907561302185, 1.0140292644500732, 0.6405332088470459, 1.5239062309265137, 0.1202852725982666, 0.0944293737411499, 0.8895018100738525, 0.09169042110443115, 0.09094619750976562, 1.2866898775100708, 0.3625760078430176, 1.3431605100631714, 0.09445047378540039, 0.44442856311798096, 0.22275137901306152, 1.3775473833084106, 1.3377678394317627, 1.678267240524292, 1.0222113132476807, 0.8024135828018188, 1.2450157403945923, 0.7297265529632568], "mean_td_error": 0.8878918886184692, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 55.0, "diff_num_grad_updates_vs_sampler_policy": 54.0}}, "num_env_steps_sampled": 50176, "num_env_steps_trained": 14190, "num_agent_steps_sampled": 150528, "num_agent_steps_trained": 14190, "last_target_update_ts": 50176, "num_target_updates": 55}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 150528, "num_agent_steps_trained": 14190, "num_env_steps_sampled": 50176, "num_env_steps_trained": 14190, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 993.5854530975845, "num_env_steps_trained_throughput_per_sec": 286.0993826999741, "timesteps_total": 50176, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 150528, "timers": {"training_iteration_time_ms": 934.846, "sample_time_ms": 632.353, "load_time_ms": 0.315, "load_throughput": 819920.012, "learn_time_ms": 18.244, "learn_throughput": 14141.263, "synch_weights_time_ms": 9.869}, "counters": {"num_env_steps_sampled": 50176, "num_env_steps_trained": 14190, "num_agent_steps_sampled": 150528, "num_agent_steps_trained": 14190, "last_target_update_ts": 50176, "num_target_updates": 55}, "done": false, "episodes_total": 0, "training_iteration": 33, "trial_id": "7066a_00000", "date": "2023-11-18_21-07-50", "timestamp": 1700370470, "time_this_iter_s": 1.8124852180480957, "time_total_s": 53.7811484336853, "pid": 7187, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x3124680e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 53.7811484336853, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 63.300000000000004, "ram_util_percent": 64.83333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.1058931350708, "actor_loss": -6.485291004180908, "critic_loss": 0.7846899628639221, "alpha_loss": -0.16992168128490448, "alpha_value": 0.9833264350891113, "log_alpha_value": -0.01681411825120449, "target_entropy": -6.0, "policy_t": -0.04996360465884209, "mean_q": 2.8620338439941406, "max_q": 12.048633575439453, "min_q": 2.401399850845337}, "td_error": [6.5425639152526855, 1.9651739597320557, 2.8449649810791016, 4.9814252853393555, 1.1083810329437256, 1.747419834136963, 8.270757675170898, 2.807648181915283, 2.0222973823547363, 2.4621124267578125, 3.682842969894409, 1.7677638530731201, 3.368293285369873, 1.2055073976516724, 3.540626287460327, 1.3918101787567139, 1.8288755416870117, 1.152235507965088, 3.5615992546081543, 3.204360246658325, 3.004260778427124, 3.8142318725585938, 1.8890774250030518, 2.0018959045410156, 3.0511138439178467, 1.5510796308517456, 3.664642333984375, 2.1264638900756836, 4.343156814575195, 2.66399884223938, 2.1190614700317383, 1.8183528184890747, 2.657910108566284, 2.6067678928375244, 2.2823586463928223, 2.9006803035736084, 3.012814998626709, 2.772737741470337, 2.0302162170410156, 1.505738615989685, 3.4080429077148438, 1.6543684005737305, 2.2502803802490234, 1.9769774675369263, 1.3058756589889526, 2.255098342895508, 0.9222946166992188, 1.9334529638290405, 0.46553075313568115, 2.241722583770752, 2.683043956756592, 2.545473575592041, 2.585996150970459, 4.645440101623535, 3.461827278137207, 2.7035603523254395, 2.4866950511932373, 2.4021341800689697, 1.7315455675125122, 1.8507936000823975, 3.2536728382110596, 2.8707306385040283, 2.2922966480255127, 2.587585687637329, 3.417215347290039, 2.641721248626709, 0.5805317163467407, 1.129500150680542, 2.4669365882873535, 2.367779016494751, 2.7053136825561523, 3.2060837745666504, 1.6650192737579346, 2.878478527069092, 2.242936611175537, 1.984851598739624, 0.7016270160675049, 3.2236599922180176, 2.2370619773864746, 2.599334716796875, 1.4817190170288086, 1.7479090690612793, 2.2146458625793457, 2.1364974975585938, 1.3337122201919556, 2.8981690406799316], "mean_td_error": 2.5075392723083496, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 57.0, "diff_num_grad_updates_vs_sampler_policy": 56.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.078239440917969, "actor_loss": -6.224959850311279, "critic_loss": 0.17699383199214935, "alpha_loss": -0.16934643685817719, "alpha_value": 0.9833372235298157, "log_alpha_value": -0.016803177073597908, "target_entropy": -6.0, "policy_t": -0.0430653877556324, "mean_q": 2.4911954402923584, "max_q": 6.024598121643066, "min_q": 2.2645864486694336}, "td_error": [1.3319000005722046, 0.08587539196014404, 1.4833452701568604, 0.27216851711273193, 0.8529608249664307, 2.0092291831970215, 0.9337934255599976, 0.6742472648620605, 0.6546540260314941, 0.4356672763824463, 1.7659603357315063, 1.1225138902664185, 0.9047253131866455, 1.2184655666351318, 0.6452069282531738, 1.8759543895721436, 2.9532251358032227, 0.9657808542251587, 1.0091753005981445, 1.0229547023773193, 1.3727481365203857, 0.10902941226959229, 0.24925851821899414, 0.31912529468536377, 0.3715064525604248, 0.09501016139984131, 0.6136291027069092, 0.692995548248291, 0.9639228582382202, 0.5007274150848389, 1.017166256904602, 0.09366655349731445, 2.3729710578918457, 1.259292483329773, 1.6069090366363525, 0.3019530773162842, 1.2687320709228516, 0.9620984792709351, 0.09273624420166016, 2.619746446609497, 0.665036678314209, 1.1998507976531982, 3.8998286724090576, 1.8534462451934814, 1.346031665802002, 0.28415632247924805, 0.5743565559387207, 0.4270440340042114, 0.10966014862060547, 0.3700277805328369, 2.253183364868164, 0.1508321762084961, 1.0578540563583374, 0.08328819274902344, 0.8471430540084839, 1.683392882347107, 1.0607287883758545, 0.10765457153320312, 3.0687389373779297, 0.09325361251831055, 0.2787243127822876, 1.8381109237670898, 0.9946541786193848, 1.439602255821228, 0.15583455562591553, 0.4599282741546631, 0.09083163738250732, 0.7805604934692383, 0.8567278385162354, 0.34874069690704346, 0.9609322547912598, 1.1324090957641602, 0.8322101831436157, 0.7215921878814697, 0.21371984481811523, 0.08899486064910889, 0.7031577825546265, 1.4548652172088623, 0.4233517646789551, 0.9208039045333862, 4.198543548583984, 1.5250136852264404, 2.053229331970215, 1.2447761297225952, 0.8209632635116577, 2.07515811920166], "mean_td_error": 1.0098834037780762, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 57.0, "diff_num_grad_updates_vs_sampler_policy": 56.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.159029960632324, "actor_loss": -6.562631130218506, "critic_loss": 0.1833588182926178, "alpha_loss": -0.17076699435710907, "alpha_value": 0.9833310842514038, "log_alpha_value": -0.016809381544589996, "target_entropy": -6.0, "policy_t": 0.007475556340068579, "mean_q": 2.587284803390503, "max_q": 3.9532573223114014, "min_q": 2.2003157138824463}, "td_error": [0.4459773302078247, 1.2759017944335938, 0.8352762460708618, 0.7568750381469727, 0.241746187210083, 1.6152033805847168, 1.3511344194412231, 0.09821510314941406, 0.9407498836517334, 0.9670320749282837, 1.7895363569259644, 0.6932041645050049, 0.2244112491607666, 1.4192636013031006, 0.272752046585083, 0.5663762092590332, 0.6991763114929199, 0.8189297914505005, 0.12181973457336426, 0.18921029567718506, 0.1571972370147705, 0.5847055912017822, 2.1181538105010986, 0.09726452827453613, 1.315821647644043, 0.8048437833786011, 0.6971340179443359, 0.17968130111694336, 1.3863186836242676, 0.33384060859680176, 0.5976455211639404, 1.5188310146331787, 0.3467271327972412, 0.7639178037643433, 0.5853489637374878, 0.6803029775619507, 1.2482333183288574, 1.5936185121536255, 0.11797666549682617, 0.3964730501174927, 1.7047374248504639, 0.9292559623718262, 0.8772099018096924, 0.3008904457092285, 2.20686411857605, 0.14287316799163818, 0.385054349899292, 0.0869591236114502, 0.33972764015197754, 0.9749763011932373, 1.401462197303772, 0.7633011341094971, 1.0160877704620361, 0.688782811164856, 0.29541659355163574, 0.12467288970947266, 0.5339078903198242, 0.5430301427841187, 0.11068916320800781, 0.8997371196746826, 0.5806007385253906, 2.1098527908325195, 0.09237217903137207, 0.9866553544998169, 0.7427370548248291, 0.8749842643737793, 0.8789526224136353, 0.323261022567749, 1.4594926834106445, 1.3029292821884155, 0.8330159187316895, 0.09975016117095947, 0.9498910903930664, 0.9846826791763306, 0.35711491107940674, 0.8095403909683228, 0.5643565654754639, 0.6189035177230835, 1.4940840005874634, 0.08013129234313965, 1.9756444692611694, 2.198117733001709, 1.7542742490768433, 0.45465195178985596, 1.236134648323059, 0.9742835760116577], "mean_td_error": 0.8128938674926758, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 57.0, "diff_num_grad_updates_vs_sampler_policy": 56.0}}, "num_env_steps_sampled": 51968, "num_env_steps_trained": 14706, "num_agent_steps_sampled": 155904, "num_agent_steps_trained": 14706, "last_target_update_ts": 51968, "num_target_updates": 57}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 155904, "num_agent_steps_trained": 14706, "num_env_steps_sampled": 51968, "num_env_steps_trained": 14706, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 982.6328115899587, "num_env_steps_trained_throughput_per_sec": 282.94560869443006, "timesteps_total": 51968, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 155904, "timers": {"training_iteration_time_ms": 933.5, "sample_time_ms": 630.992, "load_time_ms": 0.314, "load_throughput": 820977.492, "learn_time_ms": 18.411, "learn_throughput": 14013.004, "synch_weights_time_ms": 9.61}, "counters": {"num_env_steps_sampled": 51968, "num_env_steps_trained": 14706, "num_agent_steps_sampled": 155904, "num_agent_steps_trained": 14706, "last_target_update_ts": 51968, "num_target_updates": 57}, "done": false, "episodes_total": 0, "training_iteration": 34, "trial_id": "7066a_00000", "date": "2023-11-18_21-07-51", "timestamp": 1700370471, "time_this_iter_s": 1.8324382305145264, "time_total_s": 55.61358666419983, "pid": 7187, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x31039fba0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 55.61358666419983, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 70.7, "ram_util_percent": 64.80000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.091793060302734, "actor_loss": -6.650582790374756, "critic_loss": 0.7894699573516846, "alpha_loss": -0.17574560642242432, "alpha_value": 0.9827360510826111, "log_alpha_value": -0.01741470769047737, "target_entropy": -6.0, "policy_t": -0.025479819625616074, "mean_q": 3.17812180519104, "max_q": 12.019852638244629, "min_q": 2.588568687438965}, "td_error": [1.1579251289367676, 0.21780729293823242, 3.5507709980010986, 0.6757248640060425, 2.325246572494507, 5.444580078125, 2.7344279289245605, 1.776017665863037, 3.6149423122406006, 0.9862616062164307, 2.5707619190216064, 4.267911911010742, 4.047754287719727, 2.6154189109802246, 3.034372329711914, 3.318941831588745, 2.5362536907196045, 7.55963659286499, 4.687514305114746, 4.051781177520752, 1.3530603647232056, 0.6908239126205444, 0.3264594078063965, 2.9650001525878906, 0.7853343486785889, 2.90822172164917, 0.08872079849243164, 1.5238502025604248, 2.4015793800354004, 2.9409995079040527, 3.9848363399505615, 2.626180410385132, 3.058443069458008, 1.4392627477645874, 7.738458156585693, 0.08056843280792236, 3.8755991458892822, 2.5403249263763428, 3.5720415115356445, 0.8949722051620483, 0.6940534114837646, 1.1290087699890137, 3.1092112064361572, 1.965289831161499, 1.2730998992919922, 3.5822019577026367, 0.14202022552490234, 4.534450054168701, 1.9451954364776611, 2.3773155212402344, 3.0695505142211914, 2.2113001346588135, 0.8411715030670166, 3.2083494663238525, 1.7630399465560913, 3.4775919914245605, 7.839644432067871, 1.3315924406051636, 1.2397029399871826, 1.060659408569336, 2.6458969116210938, 3.4730982780456543, 1.1015589237213135, 1.9862699508666992, 2.6174304485321045, 0.6121208667755127, 0.9223573207855225, 2.956181287765503, 2.645935535430908, 2.150724411010742, 1.7002249956130981, 2.8078742027282715, 4.154428958892822, 3.3127291202545166, 1.217434048652649, 2.5854225158691406, 3.0682504177093506, 2.9223215579986572, 1.0498056411743164, 2.323047161102295, 2.5733954906463623, 1.5655944347381592, 1.249348521232605, 3.564178943634033, 2.7552294731140137, 2.5160999298095703], "mean_td_error": 2.4911651611328125, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 59.0, "diff_num_grad_updates_vs_sampler_policy": 58.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.065820693969727, "actor_loss": -6.362334728240967, "critic_loss": 0.12985233962535858, "alpha_loss": -0.17517434060573578, "alpha_value": 0.9827476739883423, "log_alpha_value": -0.01740288734436035, "target_entropy": -6.0, "policy_t": -0.027898211032152176, "mean_q": 2.504317283630371, "max_q": 5.1765360832214355, "min_q": 2.4267659187316895}, "td_error": [0.168157696723938, 0.7845810651779175, 1.486674427986145, 0.5593656301498413, 0.8888331651687622, 0.7595862150192261, 0.6519201993942261, 0.7533023357391357, 0.4871041774749756, 0.4225105047225952, 1.2355132102966309, 1.273969054222107, 0.29314160346984863, 0.24210941791534424, 1.056445837020874, 1.3184208869934082, 3.059497594833374, 0.9683029651641846, 0.6514465808868408, 0.9024536609649658, 0.2891799211502075, 1.0514439344406128, 0.344295859336853, 1.3895728588104248, 0.5978134870529175, 0.7715796232223511, 2.244602680206299, 0.09220683574676514, 0.1827486753463745, 0.5487452745437622, 0.49676263332366943, 1.0883817672729492, 0.9206373691558838, 0.28834712505340576, 0.2339416742324829, 0.24847304821014404, 0.41037511825561523, 0.18825936317443848, 0.5550954341888428, 1.1892940998077393, 0.8060940504074097, 2.2696661949157715, 0.3374248743057251, 0.4329209327697754, 0.08749020099639893, 0.08173239231109619, 0.6855707168579102, 0.8950368165969849, 1.1320832967758179, 0.6793218851089478, 1.0339494943618774, 0.08094751834869385, 2.217710018157959, 0.9278689622879028, 0.8404293060302734, 0.7630171775817871, 0.9239124059677124, 0.07933425903320312, 1.5045573711395264, 0.3848581314086914, 0.4196256399154663, 1.0865020751953125, 2.580200433731079, 1.6365315914154053, 1.2265920639038086, 0.35917234420776367, 1.791229248046875, 0.13923954963684082, 0.09999632835388184, 0.3033231496810913, 0.25446319580078125, 0.09837853908538818, 0.8549931049346924, 1.4059550762176514, 0.17183756828308105, 1.1354968547821045, 0.10649633407592773, 0.16712439060211182, 0.9760147333145142, 0.23440873622894287, 1.4898003339767456, 1.498654842376709, 0.4665940999984741, 1.175847053527832, 0.09015977382659912, 2.0204224586486816], "mean_td_error": 0.8028847575187683, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 59.0, "diff_num_grad_updates_vs_sampler_policy": 58.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.064618110656738, "actor_loss": -6.681453227996826, "critic_loss": 0.2072044014930725, "alpha_loss": -0.17522840201854706, "alpha_value": 0.9827403426170349, "log_alpha_value": -0.017410339787602425, "target_entropy": -6.0, "policy_t": -0.048951711505651474, "mean_q": 2.6961448192596436, "max_q": 3.745934009552002, "min_q": 2.2903077602386475}, "td_error": [0.08777260780334473, 2.4811434745788574, 0.718178391456604, 0.8463526964187622, 1.311232328414917, 0.6890004873275757, 0.3131978511810303, 0.42193925380706787, 2.574207305908203, 0.9944014549255371, 1.779646873474121, 0.3120163679122925, 0.26470136642456055, 2.047227382659912, 0.6079835891723633, 0.4661378860473633, 0.8167574405670166, 0.3866007328033447, 0.380462646484375, 0.4501781463623047, 0.07634246349334717, 0.1507803201675415, 1.618142008781433, 0.8697892427444458, 1.7562156915664673, 0.44105732440948486, 0.07631897926330566, 1.2321391105651855, 0.3186812400817871, 0.9966526031494141, 0.17830097675323486, 1.0530709028244019, 0.8756425380706787, 0.924291729927063, 0.3558025360107422, 2.25351881980896, 1.4032604694366455, 0.4382055997848511, 0.13670778274536133, 1.9550678730010986, 0.25592148303985596, 0.09877932071685791, 1.9868108034133911, 0.36722075939178467, 0.2705315351486206, 1.2250381708145142, 0.8695242404937744, 0.2923945188522339, 0.6038476228713989, 0.3349686861038208, 0.18683719635009766, 1.6321876049041748, 0.5403562784194946, 0.13343119621276855, 0.09070265293121338, 0.9701696634292603, 1.6624267101287842, 0.11850345134735107, 0.6989021301269531, 0.42632901668548584, 1.480863332748413, 1.0537093877792358, 0.5159412622451782, 0.5390430688858032, 0.08922839164733887, 0.1478043794631958, 1.1320737600326538, 0.7830091714859009, 0.6848611831665039, 1.7272398471832275, 1.2586939334869385, 0.14748191833496094, 1.686275839805603, 0.3426065444946289, 1.076180100440979, 0.6641048192977905, 1.4264795780181885, 0.3979893922805786, 1.4001749753952026, 1.3724486827850342, 0.17414426803588867, 2.4018056392669678, 1.7188358306884766, 1.4298604726791382, 0.9191960096359253, 1.4211211204528809], "mean_td_error": 0.8583161234855652, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 59.0, "diff_num_grad_updates_vs_sampler_policy": 58.0}}, "num_env_steps_sampled": 53760, "num_env_steps_trained": 15222, "num_agent_steps_sampled": 161280, "num_agent_steps_trained": 15222, "last_target_update_ts": 53760, "num_target_updates": 59}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 161280, "num_agent_steps_trained": 15222, "num_env_steps_sampled": 53760, "num_env_steps_trained": 15222, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 974.7914410941352, "num_env_steps_trained_throughput_per_sec": 280.6877140650523, "timesteps_total": 53760, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 161280, "timers": {"training_iteration_time_ms": 939.677, "sample_time_ms": 637.546, "load_time_ms": 0.314, "load_throughput": 821787.995, "learn_time_ms": 18.415, "learn_throughput": 14010.428, "synch_weights_time_ms": 9.598}, "counters": {"num_env_steps_sampled": 53760, "num_env_steps_trained": 15222, "num_agent_steps_sampled": 161280, "num_agent_steps_trained": 15222, "last_target_update_ts": 53760, "num_target_updates": 59}, "done": false, "episodes_total": 0, "training_iteration": 35, "trial_id": "7066a_00000", "date": "2023-11-18_21-07-53", "timestamp": 1700370473, "time_this_iter_s": 1.8460040092468262, "time_total_s": 57.459590673446655, "pid": 7187, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x312469120>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 57.459590673446655, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 68.36666666666667, "ram_util_percent": 64.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.113300323486328, "actor_loss": -6.876767158508301, "critic_loss": 0.6975817084312439, "alpha_loss": -0.18219219148159027, "alpha_value": 0.9821462035179138, "log_alpha_value": -0.01801510713994503, "target_entropy": -6.0, "policy_t": -0.02570844441652298, "mean_q": 3.2777702808380127, "max_q": 11.892416954040527, "min_q": 2.7826175689697266}, "td_error": [2.318573474884033, 2.9925739765167236, 3.3613955974578857, 1.125657081604004, 2.8207294940948486, 1.318509578704834, 0.17994964122772217, 3.799794912338257, 0.40744662284851074, 1.1654226779937744, 1.5841476917266846, 4.312626838684082, 2.0232577323913574, 2.673081874847412, 1.6073040962219238, 1.231182336807251, 1.5792204141616821, 1.9799489974975586, 2.2901086807250977, 1.8883326053619385, 2.7153422832489014, 2.279534339904785, 2.144263744354248, 1.8307194709777832, 3.708364725112915, 1.5436837673187256, 0.06752824783325195, 0.15013611316680908, 4.314002990722656, 2.2577269077301025, 0.5064765214920044, 1.938218593597412, 1.8045036792755127, 2.6095409393310547, 1.0028027296066284, 2.163261890411377, 0.15045857429504395, 0.9400264024734497, 2.5103187561035156, 3.4400525093078613, 3.179295539855957, 2.2648911476135254, 2.3711133003234863, 0.6212506294250488, 2.6365373134613037, 2.5702085494995117, 4.298779010772705, 5.463464260101318, 2.9599556922912598, 1.8854690790176392, 3.1860716342926025, 6.757845401763916, 3.928356170654297, 0.3957021236419678, 5.052760124206543, 1.148248553276062, 2.611279010772705, 1.3612109422683716, 1.6843057870864868, 1.4518303871154785, 3.9840550422668457, 1.063060998916626, 2.2011218070983887, 0.7099696397781372, 2.17495059967041, 0.9712380170822144, 0.6959810256958008, 2.214707374572754, 1.5013847351074219, 2.412748336791992, 0.4313333034515381, 7.961215972900391, 0.36490559577941895, 2.670523166656494, 0.967410683631897, 1.1851942539215088, 1.9303133487701416, 3.2436418533325195, 2.093508720397949, 1.9309064149856567, 2.517613410949707, 1.5911232233047485, 2.1162097454071045, 2.812703847885132, 2.838573455810547, 3.358746290206909], "mean_td_error": 2.2152085304260254, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 61.0, "diff_num_grad_updates_vs_sampler_policy": 60.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.066641807556152, "actor_loss": -6.484527111053467, "critic_loss": 0.15678639709949493, "alpha_loss": -0.18122343719005585, "alpha_value": 0.9821587204933167, "log_alpha_value": -0.01800237037241459, "target_entropy": -6.0, "policy_t": -0.02900226041674614, "mean_q": 2.6295127868652344, "max_q": 4.860019683837891, "min_q": 2.4374279975891113}, "td_error": [0.8654987812042236, 1.2566231489181519, 0.975447416305542, 0.8126370906829834, 0.554814338684082, 1.3761045932769775, 0.6071441173553467, 2.670785903930664, 0.34916937351226807, 0.09988641738891602, 1.3170896768569946, 0.4720778465270996, 0.6577341556549072, 0.8490810394287109, 0.7508056163787842, 0.1304609775543213, 0.6563297510147095, 0.7396306991577148, 0.07499372959136963, 0.5889012813568115, 0.9588019847869873, 0.47508537769317627, 3.3106343746185303, 1.1185657978057861, 0.7137112617492676, 0.6727350950241089, 0.24657952785491943, 0.6352393627166748, 0.5002517700195312, 0.9797461032867432, 0.7527949810028076, 0.17014062404632568, 0.46148812770843506, 0.48498475551605225, 1.3869518041610718, 0.57514488697052, 0.34751367568969727, 1.5833231210708618, 1.7805346250534058, 0.7539863586425781, 1.1548583507537842, 0.794697642326355, 1.5208823680877686, 1.343001127243042, 1.1873102188110352, 0.1357135772705078, 0.7517584562301636, 0.8995440006256104, 0.8661651611328125, 1.2087215185165405, 1.189764380455017, 1.2871202230453491, 1.1400537490844727, 1.71189284324646, 0.1440333127975464, 0.9679917097091675, 2.135985851287842, 0.42972278594970703, 2.0028417110443115, 0.23289275169372559, 2.956562042236328, 1.7054263353347778, 0.4911264181137085, 0.8220793008804321, 1.0405794382095337, 2.7462124824523926, 0.6564432382583618, 0.7073229551315308, 1.839611291885376, 0.10286056995391846, 0.49158406257629395, 1.3873112201690674, 0.4445316791534424, 0.5977679491043091, 0.2906355857849121, 1.5425961017608643, 0.6352653503417969, 0.824019193649292, 0.48839807510375977, 1.0624775886535645, 0.5892058610916138, 0.8342173099517822, 1.1874996423721313, 1.093023419380188, 0.7881110906600952, 0.06779825687408447], "mean_td_error": 0.9326866269111633, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 61.0, "diff_num_grad_updates_vs_sampler_policy": 60.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.164048194885254, "actor_loss": -6.883533477783203, "critic_loss": 0.15365387499332428, "alpha_loss": -0.18306416273117065, "alpha_value": 0.9821502566337585, "log_alpha_value": -0.018010949715971947, "target_entropy": -6.0, "policy_t": -0.05811392888426781, "mean_q": 2.8371784687042236, "max_q": 3.529261589050293, "min_q": 2.7993826866149902}, "td_error": [1.1762412786483765, 1.659732460975647, 0.18736302852630615, 0.1526787281036377, 0.7310917377471924, 0.20661604404449463, 0.6739567518234253, 0.7805577516555786, 0.8703595399856567, 1.2420647144317627, 0.13003063201904297, 0.7458667755126953, 1.5171847343444824, 0.320736289024353, 0.9542508125305176, 0.23222661018371582, 0.08611464500427246, 0.4803272485733032, 1.884821891784668, 0.9305704832077026, 0.2839064598083496, 1.8196637630462646, 1.229758381843567, 0.3656799793243408, 0.32001352310180664, 1.9255551099777222, 0.14488840103149414, 0.06636464595794678, 0.3886544704437256, 0.1306067705154419, 1.2390655279159546, 0.6684712171554565, 0.98288893699646, 0.06275081634521484, 0.21027207374572754, 0.27041852474212646, 0.8407957553863525, 0.8096554279327393, 0.6729514598846436, 0.10307276248931885, 0.07649707794189453, 0.07804203033447266, 1.3132994174957275, 0.5203700065612793, 0.5228116512298584, 0.5056977272033691, 1.02028489112854, 1.2421690225601196, 0.9089169502258301, 0.22179734706878662, 0.4049617052078247, 0.7070236206054688, 1.0428006649017334, 2.0752623081207275, 1.2966949939727783, 0.26706790924072266, 0.7183154821395874, 0.17716073989868164, 0.618668794631958, 1.1464203596115112, 0.5205843448638916, 0.6774053573608398, 0.06608057022094727, 0.09697592258453369, 0.8513081073760986, 0.07862186431884766, 1.4006367921829224, 1.1166273355484009, 0.5069296360015869, 1.1513563394546509, 0.36680853366851807, 0.14077377319335938, 0.34927141666412354, 1.6184836626052856, 0.6757279634475708, 0.2561720609664917, 1.3171255588531494, 1.5460644960403442, 2.3629329204559326, 0.175667405128479, 0.2974107265472412, 0.7149704694747925, 0.2913641929626465, 0.6648248434066772, 1.8252314329147339, 0.4526599645614624], "mean_td_error": 0.7195872664451599, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 61.0, "diff_num_grad_updates_vs_sampler_policy": 60.0}}, "num_env_steps_sampled": 55552, "num_env_steps_trained": 15738, "num_agent_steps_sampled": 166656, "num_agent_steps_trained": 15738, "last_target_update_ts": 55552, "num_target_updates": 61}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 166656, "num_agent_steps_trained": 15738, "num_env_steps_sampled": 55552, "num_env_steps_trained": 15738, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 1037.9041788794955, "num_env_steps_trained_throughput_per_sec": 298.86080150771187, "timesteps_total": 55552, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 166656, "timers": {"training_iteration_time_ms": 891.287, "sample_time_ms": 616.069, "load_time_ms": 0.314, "load_throughput": 820977.492, "learn_time_ms": 18.38, "learn_throughput": 14037.308, "synch_weights_time_ms": 9.645}, "counters": {"num_env_steps_sampled": 55552, "num_env_steps_trained": 15738, "num_agent_steps_sampled": 166656, "num_agent_steps_trained": 15738, "last_target_update_ts": 55552, "num_target_updates": 61}, "done": false, "episodes_total": 0, "training_iteration": 36, "trial_id": "7066a_00000", "date": "2023-11-18_21-07-55", "timestamp": 1700370475, "time_this_iter_s": 1.735713005065918, "time_total_s": 59.19530367851257, "pid": 7187, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x3124693a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 59.19530367851257, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 59.9, "ram_util_percent": 64.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.11580753326416, "actor_loss": -7.040870666503906, "critic_loss": 0.5510282516479492, "alpha_loss": -0.18831007182598114, "alpha_value": 0.98155677318573, "log_alpha_value": -0.01861542835831642, "target_entropy": -6.0, "policy_t": 0.012287361547350883, "mean_q": 3.3873116970062256, "max_q": 11.736027717590332, "min_q": 2.988704204559326}, "td_error": [1.705849289894104, 1.485832691192627, 2.504793167114258, 1.4822335243225098, 0.08057081699371338, 2.42961049079895, 1.043494462966919, 0.6414178609848022, 1.2532634735107422, 1.6613012552261353, 2.6635067462921143, 2.661424160003662, 1.4473769664764404, 0.9425283670425415, 3.1897411346435547, 1.706822395324707, 0.6846898794174194, 1.040590763092041, 2.7650206089019775, 2.6364738941192627, 2.1109156608581543, 2.5768487453460693, 0.7822521924972534, 3.671078681945801, 0.7943596839904785, 2.621206283569336, 0.11921000480651855, 1.6878235340118408, 2.0333094596862793, 2.4535465240478516, 2.3962225914001465, 3.0546464920043945, 2.782783269882202, 1.0736291408538818, 8.646711349487305, 2.8521361351013184, 2.413792848587036, 1.0575568675994873, 2.9742579460144043, 0.9346537590026855, 2.201817035675049, 0.22319400310516357, 1.3284697532653809, 0.9772207736968994, 1.3073900938034058, 1.6233464479446411, 0.14444732666015625, 0.4174109697341919, 3.283008098602295, 1.1066370010375977, 0.16798746585845947, 1.6521975994110107, 0.20248329639434814, 1.246290683746338, 1.7896225452423096, 1.5477479696273804, 2.05842924118042, 0.346432089805603, 0.8013049364089966, 1.8163766860961914, 1.1437253952026367, 0.3879127502441406, 2.522061347961426, 1.9743515253067017, 0.7888600826263428, 1.9638996124267578, 4.009897708892822, 1.681234359741211, 1.3441216945648193, 1.0437783002853394, 4.437949180603027, 2.998478889465332, 0.8947113752365112, 1.9458696842193604, 1.4543572664260864, 0.5827536582946777, 3.459418296813965, 3.1134824752807617, 1.6213382482528687, 4.134531021118164, 2.6714725494384766, 1.3577808141708374, 3.7662410736083984, 0.7928339242935181, 1.0134837627410889, 2.08261775970459], "mean_td_error": 1.842935562133789, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 63.0, "diff_num_grad_updates_vs_sampler_policy": 62.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.06016731262207, "actor_loss": -6.588439464569092, "critic_loss": 0.13892383873462677, "alpha_loss": -0.18713460862636566, "alpha_value": 0.9815704226493835, "log_alpha_value": -0.018601542338728905, "target_entropy": -6.0, "policy_t": 0.014304992742836475, "mean_q": 2.7122268676757812, "max_q": 4.151456832885742, "min_q": 2.6557674407958984}, "td_error": [0.07853055000305176, 0.6690897941589355, 0.6714684963226318, 2.6005496978759766, 0.09074258804321289, 0.09403705596923828, 0.6194139719009399, 0.5324311256408691, 0.4201514720916748, 0.09404587745666504, 0.2675663232803345, 0.45056653022766113, 0.1474459171295166, 0.7603664398193359, 0.6009364128112793, 0.6300250291824341, 0.42092645168304443, 1.2908886671066284, 0.5324256420135498, 1.5756304264068604, 1.4693076610565186, 1.4692108631134033, 2.360680103302002, 0.8722714185714722, 0.13925635814666748, 1.4931284189224243, 0.3153369426727295, 1.7165659666061401, 1.4684849977493286, 1.5898302793502808, 2.1189017295837402, 0.6199789047241211, 0.1525890827178955, 0.7267029285430908, 1.6663284301757812, 1.601083517074585, 0.19993901252746582, 1.7339287996292114, 0.33348846435546875, 1.0131655931472778, 0.9903680086135864, 1.2496683597564697, 1.8558299541473389, 0.8560115098953247, 0.8856357336044312, 0.08110904693603516, 0.8377138376235962, 0.05263233184814453, 0.07625138759613037, 0.29800546169281006, 0.33429718017578125, 2.1683502197265625, 1.1261515617370605, 0.0711967945098877, 0.2213270664215088, 1.581812858581543, 0.9223538637161255, 0.514258623123169, 0.5973056554794312, 1.5685248374938965, 0.48553013801574707, 0.7517906427383423, 0.9095075130462646, 0.0891108512878418, 0.4412713050842285, 0.48290348052978516, 0.2546015977859497, 1.1044974327087402, 0.10618162155151367, 1.686523199081421, 0.7362446784973145, 0.29976654052734375, 0.47124409675598145, 1.3524448871612549, 1.3566124439239502, 1.0325562953948975, 0.8161360025405884, 1.5847828388214111, 1.9717075824737549, 0.2789475917816162, 0.8253462314605713, 0.969626784324646, 1.478003740310669, 0.9159998893737793, 0.20959687232971191, 0.4832535982131958], "mean_td_error": 0.8487257957458496, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 63.0, "diff_num_grad_updates_vs_sampler_policy": 62.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.045280456542969, "actor_loss": -6.930081367492676, "critic_loss": 0.24496757984161377, "alpha_loss": -0.18696008622646332, "alpha_value": 0.9815604090690613, "log_alpha_value": -0.018611732870340347, "target_entropy": -6.0, "policy_t": -0.02861092798411846, "mean_q": 2.881122350692749, "max_q": 2.9850220680236816, "min_q": 2.338258981704712}, "td_error": [2.541707992553711, 1.5021873712539673, 0.29827404022216797, 1.2742598056793213, 0.13851475715637207, 0.7113105058670044, 0.045476675033569336, 1.1085630655288696, 0.25942444801330566, 1.3508135080337524, 0.7100229263305664, 2.519456386566162, 0.7476125955581665, 1.9245984554290771, 1.7158035039901733, 1.970916986465454, 0.11724388599395752, 0.061026811599731445, 0.05106401443481445, 2.26548433303833, 0.5795454978942871, 0.4907873868942261, 0.2485826015472412, 0.9900890588760376, 2.208836078643799, 1.3597955703735352, 0.19912075996398926, 0.25511109828948975, 0.05420100688934326, 2.201298236846924, 2.109133720397949, 0.5701253414154053, 0.4030989408493042, 0.8285050392150879, 0.06074094772338867, 1.0191211700439453, 3.067216157913208, 0.4248368740081787, 0.24084770679473877, 1.705834150314331, 0.2391831874847412, 0.4113471508026123, 0.40505361557006836, 0.527564525604248, 0.31944453716278076, 1.655775547027588, 0.06005978584289551, 0.43718791007995605, 0.3193866014480591, 0.40909314155578613, 0.14831912517547607, 0.666181206703186, 0.6752585172653198, 0.4845881462097168, 0.5077435970306396, 1.1089426279067993, 0.905123233795166, 0.04540705680847168, 0.6861673593521118, 0.9582239389419556, 0.38722169399261475, 2.177395820617676, 1.5327990055084229, 1.3490618467330933, 2.782454490661621, 1.5718860626220703, 1.6003050804138184, 1.6960275173187256, 0.9458396434783936, 1.2369192838668823, 0.3620879650115967, 0.33430027961730957, 0.8818926811218262, 1.2699851989746094, 1.313849687576294, 1.9841398000717163, 0.7051095962524414, 1.7887953519821167, 0.30485761165618896, 2.8471226692199707, 0.3359701633453369, 0.05580770969390869, 1.8654816150665283, 0.7040640115737915, 1.5816686153411865, 1.5323611497879028], "mean_td_error": 0.9819539189338684, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 63.0, "diff_num_grad_updates_vs_sampler_policy": 62.0}}, "num_env_steps_sampled": 57344, "num_env_steps_trained": 16254, "num_agent_steps_sampled": 172032, "num_agent_steps_trained": 16254, "last_target_update_ts": 57344, "num_target_updates": 63}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 172032, "num_agent_steps_trained": 16254, "num_env_steps_sampled": 57344, "num_env_steps_trained": 16254, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 1006.1938731647239, "num_env_steps_trained_throughput_per_sec": 289.7299322282352, "timesteps_total": 57344, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 172032, "timers": {"training_iteration_time_ms": 897.282, "sample_time_ms": 624.109, "load_time_ms": 0.312, "load_throughput": 825864.636, "learn_time_ms": 18.365, "learn_throughput": 14048.479, "synch_weights_time_ms": 9.654}, "counters": {"num_env_steps_sampled": 57344, "num_env_steps_trained": 16254, "num_agent_steps_sampled": 172032, "num_agent_steps_trained": 16254, "last_target_update_ts": 57344, "num_target_updates": 63}, "done": false, "episodes_total": 0, "training_iteration": 37, "trial_id": "7066a_00000", "date": "2023-11-18_21-07-57", "timestamp": 1700370477, "time_this_iter_s": 1.790419101715088, "time_total_s": 60.98572278022766, "pid": 7187, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x312469080>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 60.98572278022766, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 70.63333333333334, "ram_util_percent": 64.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.00269889831543, "actor_loss": -7.205893516540527, "critic_loss": 0.5799880027770996, "alpha_loss": -0.19220924377441406, "alpha_value": 0.9809677004814148, "log_alpha_value": -0.019215738400816917, "target_entropy": -6.0, "policy_t": 0.0006457276176661253, "mean_q": 3.616960048675537, "max_q": 11.531728744506836, "min_q": 3.2055678367614746}, "td_error": [0.9624934196472168, 1.7451236248016357, 2.398956060409546, 6.63818359375, 3.7973556518554688, 1.2868540287017822, 2.7922372817993164, 2.33023738861084, 2.626215696334839, 1.548018455505371, 2.6609785556793213, 0.2033933401107788, 1.7491910457611084, 2.3219685554504395, 1.6569325923919678, 1.220043420791626, 1.9853185415267944, 2.8734476566314697, 2.013394832611084, 6.832709789276123, 0.7397047281265259, 2.124163866043091, 1.6580971479415894, 2.25144362449646, 0.8494065999984741, 1.677811861038208, 6.7742390632629395, 1.5614460706710815, 1.1591390371322632, 2.234741687774658, 2.28926944732666, 2.3864355087280273, 2.548985004425049, 2.5330729484558105, 1.619014024734497, 0.8393608331680298, 1.4005945920944214, 1.570440649986267, 1.5236434936523438, 2.561563014984131, 1.006912112236023, 2.12853741645813, 0.30822980403900146, 1.6745893955230713, 1.8099437952041626, 1.822377324104309, 0.4714980125427246, 1.3323906660079956, 1.4410988092422485, 0.8450511693954468, 2.7673678398132324, 3.226428508758545, 1.3117613792419434, 1.0502512454986572, 2.3981845378875732, 1.1448376178741455, 0.3815206289291382, 0.987450361251831, 2.6954104900360107, 1.6672109365463257, 2.2148289680480957, 1.6226146221160889, 2.8315064907073975, 0.41823363304138184, 2.4576451778411865, 4.023453712463379, 0.08325111865997314, 2.6517181396484375, 2.027247428894043, 2.6014556884765625, 2.774531364440918, 2.14860463142395, 2.058194637298584, 0.7946637868881226, 1.9066262245178223, 0.07953858375549316, 0.0822974443435669, 5.249581813812256, 1.3294620513916016, 2.741734504699707, 1.8503531217575073, 2.360739231109619, 0.9592714309692383, 0.8079955577850342, 0.8869765996932983, 3.3359763622283936], "mean_td_error": 1.9850600957870483, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 65.0, "diff_num_grad_updates_vs_sampler_policy": 64.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.03115177154541, "actor_loss": -6.636513710021973, "critic_loss": 0.14925096929073334, "alpha_loss": -0.19260439276695251, "alpha_value": 0.9809825420379639, "log_alpha_value": -0.019200624898076057, "target_entropy": -6.0, "policy_t": -0.010050257667899132, "mean_q": 2.7723894119262695, "max_q": 4.136177062988281, "min_q": 2.2010676860809326}, "td_error": [2.1106109619140625, 1.3702555894851685, 1.8609426021575928, 1.2722132205963135, 1.8191375732421875, 0.9655416011810303, 0.05805361270904541, 0.10346639156341553, 1.695101022720337, 0.17700374126434326, 1.1673152446746826, 1.8570458889007568, 0.16256213188171387, 0.3833721876144409, 0.499750018119812, 0.5940585136413574, 0.4617118835449219, 1.7906795740127563, 0.5344455242156982, 0.08359861373901367, 0.15598976612091064, 0.9499627351760864, 0.9871484041213989, 0.5503807067871094, 0.2869277000427246, 0.5077970027923584, 0.26815640926361084, 0.07248532772064209, 0.6572753190994263, 1.098498821258545, 1.6460356712341309, 0.19908154010772705, 0.7539077997207642, 0.2685509920120239, 0.8610427379608154, 0.25830066204071045, 1.6575520038604736, 0.12711071968078613, 1.4645311832427979, 0.057948946952819824, 0.618299126625061, 1.3192294836044312, 0.7103379964828491, 1.5725393295288086, 1.5631844997406006, 0.23389649391174316, 0.8525242805480957, 1.2056740522384644, 0.49294137954711914, 0.08229875564575195, 0.8402881622314453, 2.1378014087677, 0.10368621349334717, 1.6578038930892944, 0.22471213340759277, 1.3417279720306396, 0.6872740983963013, 1.1962815523147583, 0.962037205696106, 0.8783113956451416, 0.6156692504882812, 0.8302723169326782, 2.4443576335906982, 0.7102136611938477, 0.16519570350646973, 0.7252106666564941, 1.3531798124313354, 0.5837185382843018, 0.05649685859680176, 1.3269624710083008, 2.9138689041137695, 0.6064492464065552, 0.3910715579986572, 0.9609848260879517, 0.7640480995178223, 0.24975931644439697, 1.040933609008789, 0.08068788051605225, 0.864007830619812, 1.7331924438476562, 1.3561664819717407, 1.8346349000930786, 1.2612804174423218, 1.451659083366394, 0.6578493118286133, 0.2934783697128296], "mean_td_error": 0.8807878494262695, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 65.0, "diff_num_grad_updates_vs_sampler_policy": 64.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.076395034790039, "actor_loss": -7.016749382019043, "critic_loss": 0.14763645827770233, "alpha_loss": -0.1935872882604599, "alpha_value": 0.9809713959693909, "log_alpha_value": -0.019211959093809128, "target_entropy": -6.0, "policy_t": 0.0023263657931238413, "mean_q": 2.922259569168091, "max_q": 3.048834800720215, "min_q": 2.092500686645508}, "td_error": [1.3311349153518677, 1.460466742515564, 0.8004595041275024, 0.37778449058532715, 0.9434736967086792, 0.9151979684829712, 2.0000264644622803, 1.36676025390625, 1.0947656631469727, 0.1761608123779297, 0.06601607799530029, 0.20657682418823242, 0.990005373954773, 0.15291213989257812, 0.6827760934829712, 0.5507019758224487, 0.8656089305877686, 0.5874253511428833, 0.802080512046814, 0.1802196502685547, 0.30871033668518066, 1.0926027297973633, 1.4629640579223633, 0.15574896335601807, 1.1717848777770996, 0.20867037773132324, 0.34933316707611084, 0.41767752170562744, 0.8136985301971436, 1.2226784229278564, 1.90083646774292, 0.3321577310562134, 0.6524304151535034, 0.8164777755737305, 0.8149350881576538, 0.6506662368774414, 0.3606748580932617, 1.1651380062103271, 1.629360556602478, 0.19631004333496094, 0.1674189567565918, 0.09302520751953125, 0.4783836603164673, 1.2239340543746948, 1.3754123449325562, 0.4143848419189453, 1.3973398208618164, 1.4772038459777832, 1.5057694911956787, 0.7569741010665894, 0.1608562469482422, 0.41309309005737305, 0.5028541088104248, 1.4670722484588623, 1.914421558380127, 1.4687392711639404, 0.54905104637146, 0.04736506938934326, 0.030825376510620117, 0.03005242347717285, 0.7356340885162354, 0.06268799304962158, 0.26171112060546875, 0.11943697929382324, 0.42912161350250244, 0.09314370155334473, 0.6609091758728027, 0.11953747272491455, 1.9056658744812012, 0.32110118865966797, 0.6606003046035767, 1.075461506843567, 0.5098347663879395, 0.8065012693405151, 0.5759867429733276, 0.15422821044921875, 0.7173664569854736, 0.8307453393936157, 0.46406543254852295, 0.9930341243743896, 1.0804609060287476, 0.5522449016571045, 0.08136928081512451, 0.16496729850769043, 0.33777880668640137, 0.6135356426239014], "mean_td_error": 0.7101711630821228, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 65.0, "diff_num_grad_updates_vs_sampler_policy": 64.0}}, "num_env_steps_sampled": 59136, "num_env_steps_trained": 16770, "num_agent_steps_sampled": 177408, "num_agent_steps_trained": 16770, "last_target_update_ts": 59136, "num_target_updates": 65}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 177408, "num_agent_steps_trained": 16770, "num_env_steps_sampled": 59136, "num_env_steps_trained": 16770, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 989.5086296736496, "num_env_steps_trained_throughput_per_sec": 284.9254759551357, "timesteps_total": 59136, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 177408, "timers": {"training_iteration_time_ms": 898.026, "sample_time_ms": 625.919, "load_time_ms": 0.313, "load_throughput": 824354.713, "learn_time_ms": 18.169, "learn_throughput": 14199.826, "synch_weights_time_ms": 9.554}, "counters": {"num_env_steps_sampled": 59136, "num_env_steps_trained": 16770, "num_agent_steps_sampled": 177408, "num_agent_steps_trained": 16770, "last_target_update_ts": 59136, "num_target_updates": 65}, "done": false, "episodes_total": 0, "training_iteration": 38, "trial_id": "7066a_00000", "date": "2023-11-18_21-07-59", "timestamp": 1700370479, "time_this_iter_s": 1.8192431926727295, "time_total_s": 62.80496597290039, "pid": 7187, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x31246ab60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 62.80496597290039, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 61.56666666666666, "ram_util_percent": 64.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.135369300842285, "actor_loss": -7.548377513885498, "critic_loss": 0.41520369052886963, "alpha_loss": -0.2008380889892578, "alpha_value": 0.9803794622421265, "log_alpha_value": -0.019815567880868912, "target_entropy": -6.0, "policy_t": 0.022403310984373093, "mean_q": 3.8395674228668213, "max_q": 11.322344779968262, "min_q": 3.4365458488464355}, "td_error": [0.3189202547073364, 1.9881747961044312, 0.6023906469345093, 0.0633164644241333, 1.125038504600525, 0.7437742948532104, 0.7864736318588257, 1.7763714790344238, 0.7646100521087646, 2.218132257461548, 0.07967329025268555, 0.13364803791046143, 2.082486152648926, 0.9211007356643677, 0.2464834451675415, 2.9188098907470703, 0.7125364542007446, 1.092764139175415, 2.4042606353759766, 0.523714542388916, 3.1669461727142334, 2.016761302947998, 1.116208553314209, 0.8782624006271362, 2.3988256454467773, 2.02144718170166, 1.2906042337417603, 2.757380485534668, 1.8903181552886963, 0.9882621765136719, 0.4951202869415283, 1.4186022281646729, 1.4375923871994019, 0.9181585311889648, 2.1688361167907715, 1.7247514724731445, 6.593713760375977, 1.6358636617660522, 1.4089531898498535, 1.3099409341812134, 0.9282757043838501, 2.755735397338867, 2.4096710681915283, 0.9997161626815796, 1.4413248300552368, 0.9992491006851196, 0.7511520385742188, 2.3863589763641357, 0.7772740125656128, 1.7966878414154053, 1.5903102159500122, 1.2431491613388062, 0.4802318811416626, 2.436737060546875, 0.4295358657836914, 0.729140043258667, 2.00224232673645, 2.107604503631592, 1.4650235176086426, 0.2410755157470703, 2.1489005088806152, 1.5529651641845703, 0.23619616031646729, 0.9510388374328613, 0.6416127681732178, 1.5003067255020142, 1.0307958126068115, 0.49338579177856445, 2.200531244277954, 2.2217705249786377, 2.8566534519195557, 0.5273115634918213, 7.4600677490234375, 0.4092588424682617, 0.0748831033706665, 1.4949095249176025, 0.4745582342147827, 2.170666456222534, 1.8728318214416504, 2.1397454738616943, 1.774145483970642, 0.41589343547821045, 0.11452364921569824, 4.14097785949707, 0.08510875701904297, 1.1780321598052979], "mean_td_error": 1.479962706565857, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 67.0, "diff_num_grad_updates_vs_sampler_policy": 66.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.1320219039917, "actor_loss": -6.795194625854492, "critic_loss": 0.11343660205602646, "alpha_loss": -0.20061002671718597, "alpha_value": 0.9803951382637024, "log_alpha_value": -0.01979960687458515, "target_entropy": -6.0, "policy_t": 0.0020678217988461256, "mean_q": 2.8302059173583984, "max_q": 4.0292887687683105, "min_q": 2.241368293762207}, "td_error": [1.3835086822509766, 0.10011136531829834, 0.9799617528915405, 0.6861542463302612, 0.26166343688964844, 0.2490377426147461, 0.1894989013671875, 0.39554476737976074, 1.5887203216552734, 0.8472172021865845, 1.2868274450302124, 0.6643564701080322, 0.1682729721069336, 0.04191327095031738, 1.212288737297058, 1.3724193572998047, 0.653794527053833, 0.04437267780303955, 0.9957869052886963, 0.07531392574310303, 0.18844640254974365, 1.646453619003296, 0.4325824975967407, 2.0930216312408447, 2.5035974979400635, 0.7298922538757324, 2.069329261779785, 0.30621349811553955, 0.26416122913360596, 2.160517454147339, 0.7006875276565552, 0.4147043228149414, 0.9409016370773315, 0.8353135585784912, 2.6276707649230957, 1.172877311706543, 0.23283863067626953, 0.06981778144836426, 1.9563556909561157, 1.0096588134765625, 0.39863431453704834, 0.14343535900115967, 0.04205644130706787, 0.04140210151672363, 0.6368730068206787, 1.0670912265777588, 0.9080550670623779, 0.16463160514831543, 2.0563180446624756, 0.850996732711792, 0.9182271957397461, 1.6398394107818604, 1.075486660003662, 0.14178133010864258, 0.11771595478057861, 0.32309794425964355, 0.44848716259002686, 0.9449508190155029, 0.253994345664978, 0.31515932083129883, 0.6332986354827881, 0.10034716129302979, 1.0001174211502075, 0.4474383592605591, 0.4391418695449829, 0.8436707258224487, 0.41997992992401123, 0.549990177154541, 0.05008268356323242, 0.674178957939148, 0.40487146377563477, 0.9679790735244751, 0.506416916847229, 0.6113972663879395, 0.33475804328918457, 1.1394516229629517, 1.2679173946380615, 0.24557554721832275, 0.5423544645309448, 0.31822896003723145, 0.2223203182220459, 1.46015465259552, 0.6991887092590332, 0.17462480068206787, 0.7006901502609253, 0.10082423686981201], "mean_td_error": 0.7313377261161804, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 67.0, "diff_num_grad_updates_vs_sampler_policy": 66.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.1015625, "actor_loss": -7.043481349945068, "critic_loss": 0.20955811440944672, "alpha_loss": -0.20012979209423065, "alpha_value": 0.9803832173347473, "log_alpha_value": -0.01981176622211933, "target_entropy": -6.0, "policy_t": 0.0001299501454923302, "mean_q": 2.9329094886779785, "max_q": 3.0786197185516357, "min_q": 1.8530648946762085}, "td_error": [0.03421056270599365, 0.5847568511962891, 0.24999797344207764, 0.298602819442749, 1.6535133123397827, 1.1897730827331543, 0.4606238603591919, 0.05130207538604736, 1.1357827186584473, 1.1453115940093994, 0.33688342571258545, 1.434884786605835, 1.1952629089355469, 0.9746814966201782, 0.7778308391571045, 1.6412079334259033, 0.1570655107498169, 0.46150827407836914, 1.3466752767562866, 0.017077207565307617, 0.1389319896697998, 1.384564995765686, 0.2895582914352417, 1.908545970916748, 2.209420680999756, 0.24340879917144775, 2.148002862930298, 0.2574605941772461, 1.1401132345199585, 1.9974411725997925, 3.22300386428833, 0.08089804649353027, 1.2762706279754639, 1.5661629438400269, 0.9992058277130127, 0.025537967681884766, 1.4176703691482544, 1.135143518447876, 0.1273893117904663, 0.13587164878845215, 0.1190192699432373, 2.4460701942443848, 1.554595708847046, 0.19630277156829834, 0.6811180114746094, 1.5144025087356567, 0.9472802877426147, 1.0561155080795288, 0.7640135288238525, 0.4295670986175537, 0.24838364124298096, 1.2456780672073364, 0.2250828742980957, 1.6174448728561401, 0.02258157730102539, 0.7882356643676758, 0.30374813079833984, 0.92052161693573, 0.11320757865905762, 2.533489227294922, 0.3474869728088379, 0.9610215425491333, 2.463061809539795, 0.309283971786499, 0.13416314125061035, 0.6780786514282227, 0.34894800186157227, 0.6466245651245117, 0.9699461460113525, 0.7786799669265747, 1.4279533624649048, 0.9622995853424072, 0.36244380474090576, 0.34780001640319824, 0.8104474544525146, 1.9100526571273804, 0.28953003883361816, 1.4217901229858398, 0.8994626998901367, 0.7649441957473755, 0.8050254583358765, 0.19507694244384766, 0.2095019817352295, 0.10959887504577637, 0.7326952219009399, 0.9619392156600952], "mean_td_error": 0.8654218316078186, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 67.0, "diff_num_grad_updates_vs_sampler_policy": 66.0}}, "num_env_steps_sampled": 60928, "num_env_steps_trained": 17286, "num_agent_steps_sampled": 182784, "num_agent_steps_trained": 17286, "last_target_update_ts": 60928, "num_target_updates": 67}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 182784, "num_agent_steps_trained": 17286, "num_env_steps_sampled": 60928, "num_env_steps_trained": 17286, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 1006.7399710656745, "num_env_steps_trained_throughput_per_sec": 289.8871791684643, "timesteps_total": 60928, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 182784, "timers": {"training_iteration_time_ms": 893.656, "sample_time_ms": 620.564, "load_time_ms": 0.312, "load_throughput": 826621.673, "learn_time_ms": 18.101, "learn_throughput": 14253.318, "synch_weights_time_ms": 9.905}, "counters": {"num_env_steps_sampled": 60928, "num_env_steps_trained": 17286, "num_agent_steps_sampled": 182784, "num_agent_steps_trained": 17286, "last_target_update_ts": 60928, "num_target_updates": 67}, "done": false, "episodes_total": 0, "training_iteration": 39, "trial_id": "7066a_00000", "date": "2023-11-18_21-08-01", "timestamp": 1700370481, "time_this_iter_s": 1.788710117340088, "time_total_s": 64.59367609024048, "pid": 7187, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x31039fe20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 64.59367609024048, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 74.9, "ram_util_percent": 64.75}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.115850448608398, "actor_loss": -7.7296319007873535, "critic_loss": 0.42978978157043457, "alpha_loss": -0.20652054250240326, "alpha_value": 0.9797914624214172, "log_alpha_value": -0.020415538921952248, "target_entropy": -6.0, "policy_t": -0.024553418159484863, "mean_q": 3.906491756439209, "max_q": 11.069573402404785, "min_q": 3.671903610229492}, "td_error": [0.8961601257324219, 3.4094653129577637, 2.6526384353637695, 3.3739824295043945, 2.964921712875366, 2.0426578521728516, 1.7023494243621826, 2.588923931121826, 0.5781935453414917, 2.36277437210083, 3.054366111755371, 0.6263102293014526, 0.2610377073287964, 1.9992763996124268, 0.5459350347518921, 2.223898410797119, 1.1622446775436401, 2.0713181495666504, 0.19183409214019775, 1.640926718711853, 3.024559736251831, 1.6745331287384033, 0.6472923755645752, 1.2086251974105835, 0.3867924213409424, 2.7986202239990234, 0.7507432699203491, 1.7212557792663574, 0.7102367877960205, 1.8002511262893677, 1.445197582244873, 2.3617405891418457, 1.9498484134674072, 0.14098715782165527, 0.8770649433135986, 0.1795252561569214, 0.44136714935302734, 1.7197598218917847, 1.9517860412597656, 1.9558353424072266, 0.4296417236328125, 2.586460590362549, 0.6626431941986084, 1.3085033893585205, 4.8769917488098145, 2.343773603439331, 0.0997774600982666, 1.2832238674163818, 2.326343536376953, 2.624938488006592, 0.9881356954574585, 0.6854933500289917, 1.8820858001708984, 0.45780670642852783, 0.3057059049606323, 0.7470042705535889, 1.8138622045516968, 1.1518138647079468, 1.9934992790222168, 1.1894676685333252, 0.08363926410675049, 1.0803285837173462, 3.0259571075439453, 1.6740387678146362, 2.2253122329711914, 0.22732460498809814, 1.0811570882797241, 0.3915741443634033, 2.5680413246154785, 1.050278663635254, 2.227267265319824, 0.5492948293685913, 0.6533725261688232, 1.9981690645217896, 0.3520311117172241, 1.0369535684585571, 1.2157974243164062, 2.4569787979125977, 0.14940977096557617, 1.2173676490783691, 0.8049544095993042, 0.8207104206085205, 1.5568859577178955, 6.993388652801514, 0.26823198795318604, 1.7920095920562744], "mean_td_error": 1.527359127998352, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 69.0, "diff_num_grad_updates_vs_sampler_policy": 68.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.102663040161133, "actor_loss": -6.846580505371094, "critic_loss": 0.1354156732559204, "alpha_loss": -0.20608296990394592, "alpha_value": 0.9798077940940857, "log_alpha_value": -0.020398875698447227, "target_entropy": -6.0, "policy_t": -0.03771644085645676, "mean_q": 2.8667924404144287, "max_q": 3.6143369674682617, "min_q": 2.0863780975341797}, "td_error": [1.783852219581604, 0.9707622528076172, 1.461565613746643, 2.2549285888671875, 0.617876410484314, 1.0451946258544922, 0.13798201084136963, 0.3195919990539551, 0.37461400032043457, 1.0140557289123535, 1.8262343406677246, 0.29678308963775635, 0.45454978942871094, 0.9035608768463135, 0.4712529182434082, 0.15346693992614746, 0.19085049629211426, 0.5008245706558228, 0.9556351900100708, 0.7963056564331055, 1.5136959552764893, 0.15160202980041504, 0.21510815620422363, 1.5624181032180786, 2.118250846862793, 0.4107954502105713, 0.03439140319824219, 1.6427819728851318, 1.3476734161376953, 0.17007899284362793, 0.45429015159606934, 0.12833666801452637, 0.8818372488021851, 0.15289974212646484, 0.5415757894515991, 1.3626201152801514, 1.0637600421905518, 0.05090904235839844, 0.4262343645095825, 0.4510633945465088, 1.1599663496017456, 0.17946994304656982, 0.37670302391052246, 0.9275906085968018, 0.5034109354019165, 0.2730666399002075, 0.6444497108459473, 1.0300133228302002, 0.3761634826660156, 0.790703535079956, 0.9452966451644897, 1.326363444328308, 0.3794606924057007, 1.131044864654541, 1.9336020946502686, 0.923643946647644, 0.5426557064056396, 1.7300677299499512, 0.6862607002258301, 0.2388134002685547, 0.14732813835144043, 0.5489081144332886, 2.2539255619049072, 0.2485642433166504, 0.9023621082305908, 1.5296382904052734, 1.7583893537521362, 0.8609111309051514, 0.35067570209503174, 0.7986382246017456, 1.3225778341293335, 0.29120731353759766, 1.6140639781951904, 1.090315580368042, 0.15192508697509766, 0.22513997554779053, 0.5531659126281738, 0.5080387592315674, 0.60642409324646, 0.0553135871887207, 1.6422032117843628, 2.8441109657287598, 0.2991369962692261, 2.271963119506836, 0.6986889839172363, 0.031158447265625], "mean_td_error": 0.8245782852172852, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 69.0, "diff_num_grad_updates_vs_sampler_policy": 68.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.108380317687988, "actor_loss": -7.022647380828857, "critic_loss": 0.18105053901672363, "alpha_loss": -0.20632697641849518, "alpha_value": 0.9797954559326172, "log_alpha_value": -0.020411476492881775, "target_entropy": -6.0, "policy_t": -0.02881419099867344, "mean_q": 2.889324903488159, "max_q": 3.0727758407592773, "min_q": 1.6910052299499512}, "td_error": [1.0189673900604248, 0.2711702585220337, 1.550747036933899, 1.301814317703247, 0.3140296936035156, 2.6020002365112305, 0.32223671674728394, 0.8901073932647705, 0.7304443120956421, 0.0794069766998291, 0.8137260675430298, 1.753875970840454, 1.2829359769821167, 1.1548774242401123, 0.48082494735717773, 1.501451015472412, 0.7063283920288086, 0.5657858848571777, 0.5232288837432861, 1.0924787521362305, 1.2230606079101562, 3.373292922973633, 3.0863609313964844, 1.094765543937683, 0.6075022220611572, 1.1732903718948364, 0.40661633014678955, 0.6408239603042603, 1.9525485038757324, 0.028242111206054688, 0.5075256824493408, 0.8818144798278809, 1.2711962461471558, 2.3735146522521973, 0.49267423152923584, 0.7561278343200684, 0.9761337041854858, 0.49167513847351074, 1.8112561702728271, 1.9075160026550293, 0.7509323358535767, 0.18444180488586426, 0.28387027978897095, 0.798577070236206, 0.11024510860443115, 0.23708266019821167, 0.23112702369689941, 0.47857868671417236, 0.9344305992126465, 0.23882675170898438, 0.28760695457458496, 1.344874382019043, 1.1374094486236572, 1.150144338607788, 2.3879432678222656, 0.3530620336532593, 1.1813794374465942, 1.2306934595108032, 1.784515142440796, 0.17029857635498047, 0.41194260120391846, 1.520699143409729, 1.392275094985962, 1.0830847024917603, 0.5768337249755859, 0.5454756021499634, 0.6907811164855957, 0.529778242111206, 0.3720991611480713, 2.7282347679138184, 0.9034199714660645, 1.3014787435531616, 1.5625957250595093, 1.345262050628662, 1.0372339487075806, 0.8769129514694214, 0.1462993621826172, 0.33860182762145996, 0.23892426490783691, 0.7576569318771362, 0.8430613279342651, 2.255955219268799, 0.011659979820251465, 0.5627875328063965, 0.860535740852356, 0.4787248373031616], "mean_td_error": 0.9611713290214539, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 69.0, "diff_num_grad_updates_vs_sampler_policy": 68.0}}, "num_env_steps_sampled": 62720, "num_env_steps_trained": 17802, "num_agent_steps_sampled": 188160, "num_agent_steps_trained": 17802, "last_target_update_ts": 62720, "num_target_updates": 69}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 188160, "num_agent_steps_trained": 17802, "num_env_steps_sampled": 62720, "num_env_steps_trained": 17802, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 814.8936499989267, "num_env_steps_trained_throughput_per_sec": 234.64571618272666, "timesteps_total": 62720, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 188160, "timers": {"training_iteration_time_ms": 929.726, "sample_time_ms": 656.892, "load_time_ms": 0.314, "load_throughput": 821102.081, "learn_time_ms": 18.164, "learn_throughput": 14204.3, "synch_weights_time_ms": 9.925}, "counters": {"num_env_steps_sampled": 62720, "num_env_steps_trained": 17802, "num_agent_steps_sampled": 188160, "num_agent_steps_trained": 17802, "last_target_update_ts": 62720, "num_target_updates": 69}, "done": false, "episodes_total": 0, "training_iteration": 40, "trial_id": "7066a_00000", "date": "2023-11-18_21-08-03", "timestamp": 1700370483, "time_this_iter_s": 2.208099126815796, "time_total_s": 66.80177521705627, "pid": 7187, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x31039e520>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 66.80177521705627, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 59.9, "ram_util_percent": 64.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.109460830688477, "actor_loss": -7.937525749206543, "critic_loss": 0.289714515209198, "alpha_loss": -0.21245701611042023, "alpha_value": 0.9792036414146423, "log_alpha_value": -0.02101566269993782, "target_entropy": -6.0, "policy_t": 0.0010269159683957696, "mean_q": 4.3084869384765625, "max_q": 10.795934677124023, "min_q": 3.910348415374756}, "td_error": [1.468794822692871, 0.3945692777633667, 0.7436131238937378, 0.5117144584655762, 1.8083771467208862, 0.0810922384262085, 1.2102659940719604, 0.2652379274368286, 2.650024890899658, 0.31014764308929443, 1.004584550857544, 0.23540866374969482, 1.0016241073608398, 0.4635685682296753, 0.08344292640686035, 0.676446795463562, 0.5051981210708618, 0.5920323133468628, 0.07365655899047852, 1.1800243854522705, 1.7366199493408203, 0.6053422689437866, 0.8719838857650757, 0.14915406703948975, 1.7881540060043335, 0.28233909606933594, 1.4003762006759644, 1.2604409456253052, 0.40786635875701904, 0.40754663944244385, 0.8720331192016602, 2.9849462509155273, 0.2658989429473877, 1.4182263612747192, 0.42389488220214844, 2.282203197479248, 0.15401959419250488, 1.3614698648452759, 0.13206636905670166, 0.600318193435669, 1.3088914155960083, 0.5486476421356201, 0.92760169506073, 0.47515761852264404, 0.6349242925643921, 1.5062675476074219, 3.222963333129883, 0.17641150951385498, 2.6867003440856934, 1.323846459388733, 2.1907596588134766, 0.33061683177948, 0.19724774360656738, 0.5762602090835571, 0.582411527633667, 1.6362547874450684, 0.07155048847198486, 0.08166837692260742, 5.463274955749512, 1.495497465133667, 0.17201972007751465, 7.231760025024414, 0.6458604335784912, 1.2696062326431274, 0.15890491008758545, 3.2948455810546875, 0.6587381362915039, 3.1268835067749023, 0.2974212169647217, 0.9668298959732056, 1.5585119724273682, 0.5196471214294434, 2.09336256980896, 2.3650927543640137, 2.887140989303589, 0.20747864246368408, 2.2305500507354736, 0.2553989887237549, 0.7950329780578613, 1.1291553974151611, 0.6081722974777222, 1.027264952659607, 1.976374626159668, 1.0895591974258423, 0.9473001956939697, 0.5162807703018188], "mean_td_error": 1.1410566568374634, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 71.0, "diff_num_grad_updates_vs_sampler_policy": 70.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.056672096252441, "actor_loss": -6.876205921173096, "critic_loss": 0.13750611245632172, "alpha_loss": -0.21117255091667175, "alpha_value": 0.9792206883430481, "log_alpha_value": -0.020998256281018257, "target_entropy": -6.0, "policy_t": -0.06372015923261642, "mean_q": 2.8481757640838623, "max_q": 2.917815923690796, "min_q": 1.9485447406768799}, "td_error": [0.6633751392364502, 0.4898040294647217, 0.19904577732086182, 0.2877986431121826, 0.14494800567626953, 0.7884753942489624, 0.6865699291229248, 0.3803567886352539, 3.0632925033569336, 0.9086469411849976, 0.9961123466491699, 0.6613001823425293, 1.787916660308838, 0.8065365552902222, 1.2263805866241455, 0.6964130401611328, 0.5503138303756714, 0.18193519115447998, 0.060561180114746094, 1.48189115524292, 0.016502976417541504, 0.21947360038757324, 1.4630205631256104, 2.3554110527038574, 1.1684590578079224, 1.0128114223480225, 1.1848576068878174, 0.5374174118041992, 0.24554288387298584, 0.1567476987838745, 1.0758697986602783, 0.3734109401702881, 0.5350527763366699, 0.744957447052002, 0.6711654663085938, 0.5048511028289795, 0.6664196252822876, 0.03400444984436035, 1.753311038017273, 0.9280122518539429, 0.07836747169494629, 0.37440061569213867, 0.044931888580322266, 1.0962731838226318, 0.9986251592636108, 0.8573299646377563, 0.20153725147247314, 0.21658098697662354, 3.107764959335327, 0.011084198951721191, 0.7141650915145874, 1.0272430181503296, 1.3639321327209473, 1.5570133924484253, 0.8210470676422119, 1.8752233982086182, 0.5681953430175781, 1.9897645711898804, 0.5044957399368286, 0.6286704540252686, 0.41590213775634766, 0.270763635635376, 0.09816348552703857, 0.20613718032836914, 0.6499087810516357, 0.24890923500061035, 1.6272737979888916, 0.6114152669906616, 0.2811187505722046, 0.7266499996185303, 1.5259156227111816, 1.4830248355865479, 0.7222731113433838, 0.018158555030822754, 2.186154365539551, 0.9438444375991821, 0.04027879238128662, 0.1539149284362793, 1.8192801475524902, 0.43359267711639404, 0.4307488203048706, 0.8842481374740601, 1.4957536458969116, 1.4116743803024292, 1.080762267112732, 1.4456312656402588], "mean_td_error": 0.8250827193260193, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 71.0, "diff_num_grad_updates_vs_sampler_policy": 70.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.08165168762207, "actor_loss": -6.969202995300293, "critic_loss": 0.1784902811050415, "alpha_loss": -0.2118280827999115, "alpha_value": 0.9792079329490662, "log_alpha_value": -0.021011246368288994, "target_entropy": -6.0, "policy_t": 0.0032912667375057936, "mean_q": 2.8755719661712646, "max_q": 3.04933500289917, "min_q": 1.5717120170593262}, "td_error": [0.43331456184387207, 0.8811477422714233, 0.2845221757888794, 0.9653228521347046, 0.7321350574493408, 0.6222401857376099, 1.011132001876831, 0.7176040410995483, 0.9761819839477539, 1.8683853149414062, 1.4371453523635864, 0.641217827796936, 0.6157993078231812, 1.2479228973388672, 0.049880027770996094, 1.2841731309890747, 1.1416637897491455, 0.5042920112609863, 0.3393329381942749, 0.10221350193023682, 1.0109386444091797, 0.33993589878082275, 1.7347909212112427, 0.5190958976745605, 0.016625046730041504, 0.5570172071456909, 0.3438093662261963, 0.8558186292648315, 0.9408725500106812, 1.387225866317749, 0.8448331356048584, 0.036188721656799316, 1.1114541292190552, 0.39247846603393555, 1.1883132457733154, 0.7021685838699341, 1.9264217615127563, 0.01227569580078125, 0.48212766647338867, 2.723842144012451, 0.9532856941223145, 0.5154225826263428, 1.6131174564361572, 0.3545374870300293, 0.2682673931121826, 0.07171738147735596, 0.9637550115585327, 0.9909225702285767, 1.5676202774047852, 2.3790016174316406, 1.0073826313018799, 0.8200544118881226, 1.1771624088287354, 2.046588897705078, 0.22966623306274414, 2.4733121395111084, 0.8516236543655396, 1.2261661291122437, 1.2158998250961304, 1.123961091041565, 0.45310187339782715, 0.9456887245178223, 1.397683024406433, 1.5701953172683716, 1.9278019666671753, 0.5295631885528564, 1.1289215087890625, 1.6241668462753296, 0.0964125394821167, 0.009331464767456055, 1.8303807973861694, 0.8623137474060059, 1.6320228576660156, 0.761135458946228, 0.1541292667388916, 1.5144554376602173, 1.52544367313385, 0.15760040283203125, 1.8561549186706543, 0.9758026599884033, 0.6594419479370117, 2.5417797565460205, 0.780569314956665, 1.246799349784851, 0.9465295076370239, 0.24065256118774414], "mean_td_error": 0.9558069705963135, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 71.0, "diff_num_grad_updates_vs_sampler_policy": 70.0}}, "num_env_steps_sampled": 64512, "num_env_steps_trained": 18318, "num_agent_steps_sampled": 193536, "num_agent_steps_trained": 18318, "last_target_update_ts": 64512, "num_target_updates": 71}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 193536, "num_agent_steps_trained": 18318, "num_env_steps_sampled": 64512, "num_env_steps_trained": 18318, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 1059.1185738508414, "num_env_steps_trained_throughput_per_sec": 304.9694107740146, "timesteps_total": 64512, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 193536, "timers": {"training_iteration_time_ms": 926.268, "sample_time_ms": 653.8, "load_time_ms": 0.313, "load_throughput": 823163.268, "learn_time_ms": 18.249, "learn_throughput": 14137.605, "synch_weights_time_ms": 9.917}, "counters": {"num_env_steps_sampled": 64512, "num_env_steps_trained": 18318, "num_agent_steps_sampled": 193536, "num_agent_steps_trained": 18318, "last_target_update_ts": 64512, "num_target_updates": 71}, "done": false, "episodes_total": 0, "training_iteration": 41, "trial_id": "7066a_00000", "date": "2023-11-18_21-08-05", "timestamp": 1700370485, "time_this_iter_s": 1.7024431228637695, "time_total_s": 68.50421833992004, "pid": 7187, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x31039fe20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 68.50421833992004, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 61.6, "ram_util_percent": 64.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.015384674072266, "actor_loss": -8.16616439819336, "critic_loss": 0.2359689176082611, "alpha_loss": -0.2164909690618515, "alpha_value": 0.9786161184310913, "log_alpha_value": -0.02161583863198757, "target_entropy": -6.0, "policy_t": -0.012999200262129307, "mean_q": 4.284183502197266, "max_q": 8.794082641601562, "min_q": 4.1360650062561035}, "td_error": [0.24652743339538574, 0.42699766159057617, 0.7219853401184082, 0.6703062057495117, 2.7870564460754395, 0.5389668941497803, 2.3392324447631836, 0.8445289134979248, 0.055022478103637695, 1.7728571891784668, 0.9057972431182861, 2.6499087810516357, 1.145809531211853, 0.25384521484375, 0.1348360776901245, 0.5289080142974854, 0.7945892810821533, 1.1029002666473389, 1.0251202583312988, 0.14078617095947266, 0.3670670986175537, 1.3896751403808594, 0.5279362201690674, 1.3727264404296875, 0.8676419258117676, 0.832075834274292, 1.1002624034881592, 0.7454020977020264, 0.16313910484313965, 0.5446529388427734, 0.07715964317321777, 0.7156660556793213, 0.3792552947998047, 0.062003374099731445, 0.5744423866271973, 2.7785041332244873, 0.48069334030151367, 0.7277965545654297, 0.06432151794433594, 0.8802905082702637, 4.602761268615723, 2.938943862915039, 0.15343666076660156, 0.10025310516357422, 0.42778778076171875, 1.1252028942108154, 1.7812321186065674, 2.0521240234375, 0.7514224052429199, 1.6848881244659424, 1.5484158992767334, 0.5080406665802002, 0.21028804779052734, 1.015669584274292, 1.9177777767181396, 1.789201259613037, 0.4541471004486084, 0.5281727313995361, 0.4293503761291504, 1.1599560976028442, 1.5852762460708618, 0.5073158740997314, 0.1461031436920166, 0.7548742294311523, 0.1452791690826416, 0.36289525032043457, 0.48834776878356934, 0.1208343505859375, 4.9489359855651855, 0.7352333068847656, 0.8770170211791992, 0.7372622489929199, 1.0409791469573975, 0.8278908729553223, 1.8538100719451904, 0.33507657051086426, 0.07630348205566406, 0.0755457878112793, 0.6378626823425293, 2.3569581508636475, 0.9818110466003418, 0.07980585098266602, 0.4386584758758545, 0.2274632453918457, 1.6556193828582764, 3.001570463180542], "mean_td_error": 0.9757499694824219, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 73.0, "diff_num_grad_updates_vs_sampler_policy": 72.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.068326950073242, "actor_loss": -6.839457035064697, "critic_loss": 0.159525528550148, "alpha_loss": -0.21745185554027557, "alpha_value": 0.9786339402198792, "log_alpha_value": -0.021597612649202347, "target_entropy": -6.0, "policy_t": -0.016590343788266182, "mean_q": 2.845187187194824, "max_q": 2.916829824447632, "min_q": 1.8220798969268799}, "td_error": [0.6716221570968628, 1.0212602615356445, 0.5751789808273315, 0.08207893371582031, 1.028580904006958, 0.18330097198486328, 1.28355073928833, 1.0134130716323853, 2.416560173034668, 0.655892014503479, 0.9526394605636597, 0.32768547534942627, 0.2650071382522583, 0.8267858028411865, 0.3228648900985718, 1.016264796257019, 1.2673834562301636, 1.460549235343933, 0.5738710165023804, 0.024001598358154297, 0.5142803192138672, 1.2737889289855957, 0.12455189228057861, 0.5468306541442871, 0.6112256050109863, 0.7317080497741699, 0.17065179347991943, 1.1842658519744873, 0.37698471546173096, 1.6303448677062988, 1.5381546020507812, 0.32876110076904297, 0.5202924013137817, 1.1295685768127441, 0.2533242702484131, 0.47870779037475586, 1.1509302854537964, 0.49378836154937744, 0.6315659284591675, 0.3064885139465332, 1.093714714050293, 1.8689143657684326, 0.6121037006378174, 0.22691643238067627, 0.40552592277526855, 1.9581561088562012, 1.6200147867202759, 1.9618054628372192, 2.1516122817993164, 0.7038083076477051, 1.335471272468567, 0.30516529083251953, 0.7089971303939819, 0.6033227443695068, 1.5163052082061768, 0.12024295330047607, 1.2740586996078491, 1.489169955253601, 0.21819710731506348, 0.5508843660354614, 0.759751558303833, 0.84053635597229, 0.41538238525390625, 0.45868897438049316, 0.8339940309524536, 0.34002745151519775, 0.05978912115097046, 0.6938745975494385, 0.47254860401153564, 1.4953422546386719, 2.8804919719696045, 1.7361985445022583, 0.8587690591812134, 0.9089224338531494, 2.1487715244293213, 1.1177918910980225, 2.3114562034606934, 0.5355758666992188, 0.4803781509399414, 1.1625350713729858, 2.8971407413482666, 1.7242285013198853, 0.018787264823913574, 0.9112430810928345, 2.0761876106262207, 1.5494608879089355], "mean_td_error": 0.9346159100532532, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 73.0, "diff_num_grad_updates_vs_sampler_policy": 72.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.066761016845703, "actor_loss": -7.010220050811768, "critic_loss": 0.1821439266204834, "alpha_loss": -0.21755287051200867, "alpha_value": 0.9786208271980286, "log_alpha_value": -0.021611008793115616, "target_entropy": -6.0, "policy_t": -0.10521014779806137, "mean_q": 2.8380610942840576, "max_q": 3.0097832679748535, "min_q": 1.5770827531814575}, "td_error": [1.3875538110733032, 0.9198167324066162, 1.25917387008667, 0.06275367736816406, 2.1783878803253174, 0.4643815755844116, 1.0562591552734375, 1.317553997039795, 1.1545324325561523, 0.3101670742034912, 0.9145909547805786, 0.7007300853729248, 0.14980721473693848, 2.220926284790039, 0.3740578889846802, 0.3471081256866455, 0.927386999130249, 1.3737624883651733, 1.5057379007339478, 0.49702560901641846, 1.855223536491394, 0.521146297454834, 2.7456541061401367, 1.0429447889328003, 0.6053166389465332, 0.9025005102157593, 1.5310722589492798, 2.531067371368408, 0.381184458732605, 0.11249315738677979, 0.3657951354980469, 2.0396437644958496, 0.4149364233016968, 1.178491473197937, 1.5674612522125244, 0.7320308685302734, 0.18649113178253174, 0.3580203056335449, 1.0283870697021484, 1.244889736175537, 0.8670892715454102, 0.3064829111099243, 0.4484114646911621, 0.3915752172470093, 0.38084137439727783, 2.1691970825195312, 0.46918153762817383, 0.3435690402984619, 1.5877364873886108, 1.284716010093689, 0.5526361465454102, 0.8553485870361328, 0.45633888244628906, 0.9806464910507202, 1.4500501155853271, 1.099576711654663, 1.6160837411880493, 2.9562337398529053, 2.955930709838867, 0.24009835720062256, 0.6145344972610474, 0.04218411445617676, 1.422692060470581, 1.8699703216552734, 1.4144001007080078, 1.56502366065979, 0.7698733806610107, 1.3985025882720947, 0.18054413795471191, 0.8467812538146973, 0.07933628559112549, 1.4852014780044556, 0.1546425223350525, 1.0783003568649292, 0.13546371459960938, 1.2729367017745972, 0.5036351084709167, 0.4383881092071533, 0.30259084701538086, 0.3105003833770752, 0.6366961002349854, 0.6084518432617188, 0.14758551120758057, 0.8548474311828613, 0.27511656284332275, 2.0593652725219727], "mean_td_error": 0.9575089812278748, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 73.0, "diff_num_grad_updates_vs_sampler_policy": 72.0}}, "num_env_steps_sampled": 66304, "num_env_steps_trained": 18834, "num_agent_steps_sampled": 198912, "num_agent_steps_trained": 18834, "last_target_update_ts": 66304, "num_target_updates": 73}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 198912, "num_agent_steps_trained": 18834, "num_env_steps_sampled": 66304, "num_env_steps_trained": 18834, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 991.3055615748376, "num_env_steps_trained_throughput_per_sec": 285.4428960784689, "timesteps_total": 66304, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 198912, "timers": {"training_iteration_time_ms": 928.946, "sample_time_ms": 656.372, "load_time_ms": 0.316, "load_throughput": 815225.578, "learn_time_ms": 18.254, "learn_throughput": 14133.709, "synch_weights_time_ms": 10.197}, "counters": {"num_env_steps_sampled": 66304, "num_env_steps_trained": 18834, "num_agent_steps_sampled": 198912, "num_agent_steps_trained": 18834, "last_target_update_ts": 66304, "num_target_updates": 73}, "done": false, "episodes_total": 0, "training_iteration": 42, "trial_id": "7066a_00000", "date": "2023-11-18_21-08-06", "timestamp": 1700370486, "time_this_iter_s": 1.8154659271240234, "time_total_s": 70.31968426704407, "pid": 7187, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x31039f4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 70.31968426704407, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 66.96666666666665, "ram_util_percent": 64.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.067414283752441, "actor_loss": -8.469727516174316, "critic_loss": 0.17585673928260803, "alpha_loss": -0.22365370392799377, "alpha_value": 0.9780293703079224, "log_alpha_value": -0.022215604782104492, "target_entropy": -6.0, "policy_t": -0.034271351993083954, "mean_q": 4.452914714813232, "max_q": 6.990665435791016, "min_q": 4.351810455322266}, "td_error": [0.587691068649292, 0.9705049991607666, 0.7251801490783691, 0.13648557662963867, 0.7836670875549316, 0.9642186164855957, 0.16201233863830566, 0.11452841758728027, 0.691664457321167, 0.7213244438171387, 0.8588290214538574, 0.8043613433837891, 1.340503215789795, 1.6801509857177734, 0.05241036415100098, 1.213827133178711, 0.6284623146057129, 1.5784413814544678, 1.236466407775879, 0.8197407722473145, 0.5411467552185059, 0.9300413131713867, 0.411052942276001, 1.6487889289855957, 0.0655510425567627, 1.2234418392181396, 1.3633646965026855, 0.1006021499633789, 1.2845180034637451, 0.44742298126220703, 0.7049331665039062, 0.36959290504455566, 0.49840664863586426, 0.6565415859222412, 0.40650129318237305, 0.5005571842193604, 0.24909472465515137, 0.6005442142486572, 0.3995659351348877, 0.7484409809112549, 0.8549213409423828, 1.0889747142791748, 1.0000171661376953, 0.2828092575073242, 0.18354129791259766, 0.16833019256591797, 2.950876235961914, 0.47109222412109375, 2.668761968612671, 0.1280515193939209, 0.8137879371643066, 1.4976325035095215, 0.3424973487854004, 1.7754266262054443, 0.48496484756469727, 0.16231870651245117, 0.5748600959777832, 0.0738377571105957, 0.4755091667175293, 0.46093201637268066, 1.9671783447265625, 0.06779789924621582, 1.1082980632781982, 1.1389105319976807, 1.0847382545471191, 1.0857963562011719, 0.8841080665588379, 1.4791374206542969, 0.6141953468322754, 1.0022480487823486, 0.06731271743774414, 0.3097879886627197, 0.8459439277648926, 1.6664776802062988, 2.1898488998413086, 0.7215845584869385, 0.2613701820373535, 0.26689982414245605, 0.8907310962677002, 0.5161604881286621, 3.237196922302246, 0.31523609161376953, 0.05228781700134277, 0.07380080223083496, 0.9919657707214355, 1.3718490600585938], "mean_td_error": 0.812681257724762, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 75.0, "diff_num_grad_updates_vs_sampler_policy": 74.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.088935852050781, "actor_loss": -6.858994483947754, "critic_loss": 0.1547648012638092, "alpha_loss": -0.22394202649593353, "alpha_value": 0.9780477285385132, "log_alpha_value": -0.02219679206609726, "target_entropy": -6.0, "policy_t": -0.004257522989064455, "mean_q": 2.8738064765930176, "max_q": 2.9073145389556885, "min_q": 2.847722053527832}, "td_error": [0.5750675201416016, 0.13717281818389893, 0.603226900100708, 1.5875043869018555, 0.5400054454803467, 1.311559796333313, 0.4452630281448364, 0.8482297658920288, 1.0579112768173218, 0.34029829502105713, 1.649522304534912, 2.2825582027435303, 0.7684948444366455, 1.589524269104004, 0.6682378053665161, 2.17459774017334, 1.844050407409668, 1.5269807577133179, 0.5559247732162476, 0.7829527854919434, 0.04504978656768799, 2.306882381439209, 0.2304598093032837, 0.5646951198577881, 1.36747145652771, 0.9995297193527222, 0.8707932233810425, 1.545198917388916, 0.0176619291305542, 0.09872579574584961, 1.2148761749267578, 0.9646918773651123, 1.3214534521102905, 2.081127643585205, 0.3268064260482788, 0.5920306444168091, 0.6587139368057251, 0.4776262044906616, 2.5638623237609863, 1.462844729423523, 1.179861307144165, 0.913815975189209, 0.5728607177734375, 1.0426630973815918, 0.9136688709259033, 1.7520992755889893, 0.5370786190032959, 0.6060812473297119, 1.7163225412368774, 0.4116729497909546, 0.09247970581054688, 0.015466451644897461, 1.3109320402145386, 0.4947934150695801, 0.7988051176071167, 0.38945257663726807, 2.1988472938537598, 1.1063361167907715, 0.43628060817718506, 0.0532301664352417, 0.2565082311630249, 2.255754232406616, 1.1630637645721436, 1.5959570407867432, 0.10546767711639404, 0.7832666635513306, 0.15795588493347168, 0.9528104066848755, 0.8995705842971802, 0.35570502281188965, 0.2504526376724243, 1.208634614944458, 1.0807281732559204, 0.42448174953460693, 0.6943281888961792, 0.342349648475647, 0.13601553440093994, 0.37247753143310547, 0.06647515296936035, 0.04096567630767822, 0.4359797239303589, 1.208877682685852, 0.6712887287139893, 0.2523559331893921, 2.10402774810791, 1.723140835762024], "mean_td_error": 0.8962903618812561, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 75.0, "diff_num_grad_updates_vs_sampler_policy": 74.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.108182907104492, "actor_loss": -6.924391746520996, "critic_loss": 0.1403665840625763, "alpha_loss": -0.22450914978981018, "alpha_value": 0.9780341982841492, "log_alpha_value": -0.022210631519556046, "target_entropy": -6.0, "policy_t": -0.08627405017614365, "mean_q": 2.7255938053131104, "max_q": 2.935537815093994, "min_q": 1.4358134269714355}, "td_error": [0.739799976348877, 1.208820104598999, 0.2436838150024414, 0.3020303249359131, 2.4214863777160645, 1.0086948871612549, 1.8846588134765625, 0.08883082866668701, 0.16362214088439941, 0.8128058910369873, 1.16017484664917, 0.05772364139556885, 1.3804361820220947, 1.4803781509399414, 1.1535131931304932, 0.1551046371459961, 0.8966926336288452, 0.989409327507019, 1.4850417375564575, 0.09331345558166504, 0.5733155012130737, 0.07567310333251953, 0.6754189729690552, 1.2304211854934692, 0.9003268480300903, 1.4463081359863281, 0.5467120409011841, 0.2311948537826538, 0.5686750411987305, 0.5064681768417358, 0.4770756959915161, 1.1068536043167114, 0.08621740341186523, 0.23448574542999268, 0.6501948833465576, 0.620989203453064, 0.06026768684387207, 0.5118018388748169, 0.5204101800918579, 0.8388427495956421, 0.037879228591918945, 1.1336113214492798, 2.390399217605591, 0.7077195644378662, 2.296154737472534, 0.6540879011154175, 0.09756159782409668, 0.40615010261535645, 0.6026461124420166, 1.7479313611984253, 0.2351241111755371, 1.366384744644165, 0.4427206516265869, 0.478213906288147, 1.3927654027938843, 0.12831568717956543, 1.3129593133926392, 0.3801567554473877, 1.9971297979354858, 1.4827032089233398, 0.39040708541870117, 0.9171093702316284, 0.939307451248169, 0.2683711051940918, 1.318228006362915, 1.141308307647705, 1.2275550365447998, 0.1779482364654541, 0.4674769639968872, 0.4946023225784302, 0.9006731510162354, 0.168623685836792, 1.0847465991973877, 1.109336018562317, 0.863501787185669, 1.0013976097106934, 0.5210754871368408, 0.852020263671875, 0.056665897369384766, 0.059899330139160156, 1.0156646966934204, 0.13332092761993408, 2.4087891578674316, 1.2614326477050781, 1.0687094926834106, 0.7488378286361694], "mean_td_error": 0.8078546524047852, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 75.0, "diff_num_grad_updates_vs_sampler_policy": 74.0}}, "num_env_steps_sampled": 68096, "num_env_steps_trained": 19350, "num_agent_steps_sampled": 204288, "num_agent_steps_trained": 19350, "last_target_update_ts": 68096, "num_target_updates": 75}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 204288, "num_agent_steps_trained": 19350, "num_env_steps_sampled": 68096, "num_env_steps_trained": 19350, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 970.483489808377, "num_env_steps_trained_throughput_per_sec": 279.44725487785854, "timesteps_total": 68096, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 204288, "timers": {"training_iteration_time_ms": 932.499, "sample_time_ms": 658.31, "load_time_ms": 0.319, "load_throughput": 808344.238, "learn_time_ms": 18.327, "learn_throughput": 14077.739, "synch_weights_time_ms": 10.468}, "counters": {"num_env_steps_sampled": 68096, "num_env_steps_trained": 19350, "num_agent_steps_sampled": 204288, "num_agent_steps_trained": 19350, "last_target_update_ts": 68096, "num_target_updates": 75}, "done": false, "episodes_total": 0, "training_iteration": 43, "trial_id": "7066a_00000", "date": "2023-11-18_21-08-08", "timestamp": 1700370488, "time_this_iter_s": 1.8547229766845703, "time_total_s": 72.17440724372864, "pid": 7187, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x312468900>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 72.17440724372864, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 63.03333333333333, "ram_util_percent": 64.83333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.150752067565918, "actor_loss": -8.716404914855957, "critic_loss": 0.2425270974636078, "alpha_loss": -0.23159277439117432, "alpha_value": 0.9774429798126221, "log_alpha_value": -0.02281533181667328, "target_entropy": -6.0, "policy_t": -0.018788544461131096, "mean_q": 4.612417697906494, "max_q": 6.6826629638671875, "min_q": 4.545401573181152}, "td_error": [2.4929308891296387, 0.6137948036193848, 3.1742706298828125, 0.1439809799194336, 1.1339585781097412, 2.020442485809326, 1.146413803100586, 1.9179394245147705, 0.7216687202453613, 0.4417567253112793, 0.055590152740478516, 0.37972331047058105, 0.5408575534820557, 0.2236795425415039, 0.8181900978088379, 0.7914295196533203, 0.04091691970825195, 2.7850892543792725, 0.922616720199585, 0.7742557525634766, 0.3298673629760742, 1.2180755138397217, 0.5815615653991699, 0.45787882804870605, 0.05551481246948242, 1.347121238708496, 0.18172287940979004, 0.8155548572540283, 0.6981124877929688, 2.8846890926361084, 0.900874137878418, 2.4277005195617676, 1.0098114013671875, 0.14363574981689453, 1.212005615234375, 0.7315874099731445, 0.7460927963256836, 0.03754091262817383, 2.0150299072265625, 1.4555411338806152, 0.2615513801574707, 1.409820318222046, 2.1555120944976807, 0.8367624282836914, 1.5197780132293701, 0.4995269775390625, 1.433866262435913, 0.09712624549865723, 0.9161026477813721, 1.0131559371948242, 0.5182466506958008, 1.119952917098999, 0.7971539497375488, 0.8714141845703125, 2.799450397491455, 1.2209751605987549, 1.172609567642212, 1.4545793533325195, 1.959458351135254, 1.0735054016113281, 2.6116108894348145, 0.2788081169128418, 0.5676021575927734, 0.5984699726104736, 0.1267099380493164, 0.20436406135559082, 0.8600118160247803, 0.4657614231109619, 0.556765079498291, 1.1141161918640137, 0.6891498565673828, 0.14148855209350586, 1.0896062850952148, 0.4585123062133789, 0.07166624069213867, 1.5700461864471436, 1.3648977279663086, 0.4800295829772949, 1.1052591800689697, 0.3200387954711914, 1.3088045120239258, 2.081932544708252, 2.3296258449554443, 0.7680926322937012, 1.050788402557373, 0.5006246566772461], "mean_td_error": 1.0027297735214233, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 77.0, "diff_num_grad_updates_vs_sampler_policy": 76.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.000784873962402, "actor_loss": -6.816778182983398, "critic_loss": 0.12963253259658813, "alpha_loss": -0.22797806560993195, "alpha_value": 0.9774618744850159, "log_alpha_value": -0.022796019911766052, "target_entropy": -6.0, "policy_t": -0.05696679651737213, "mean_q": 2.8258345127105713, "max_q": 2.902719497680664, "min_q": 1.6888221502304077}, "td_error": [0.2584676742553711, 0.8129050731658936, 0.029076695442199707, 0.9811968803405762, 2.8974857330322266, 0.3888556957244873, 0.5167732238769531, 1.826072335243225, 2.1335015296936035, 1.2293061017990112, 2.0457265377044678, 1.7637606859207153, 0.7098981142044067, 0.031881093978881836, 1.3185820579528809, 1.0700492858886719, 0.49702978134155273, 1.9922795295715332, 1.0469359159469604, 1.7039449214935303, 0.03400576114654541, 0.23775863647460938, 1.470017671585083, 0.10805702209472656, 0.13973581790924072, 1.5888018608093262, 0.9608458280563354, 0.9522521495819092, 0.21569132804870605, 0.3865612745285034, 0.3307778835296631, 0.7479138374328613, 0.04309821128845215, 0.9117356538772583, 1.4751524925231934, 0.26100218296051025, 0.7699142694473267, 0.29422974586486816, 0.41333866119384766, 0.03184068202972412, 1.6217128038406372, 1.295393705368042, 0.7135438919067383, 1.5808534622192383, 1.077040433883667, 0.04251301288604736, 0.7416596412658691, 0.6529558897018433, 0.5039045214653015, 0.02874588966369629, 0.19527363777160645, 0.5500576496124268, 0.011493921279907227, 0.38116466999053955, 0.16718745231628418, 2.822780132293701, 1.0478525161743164, 0.5039017200469971, 0.8443681001663208, 0.828567385673523, 0.19265329837799072, 0.12330400943756104, 0.034976959228515625, 0.8061983585357666, 0.541580319404602, 0.5618734359741211, 0.9008607864379883, 0.4215465784072876, 0.1858689785003662, 1.521506667137146, 0.46267926692962646, 1.9878922700881958, 0.19920825958251953, 1.8294068574905396, 0.15515446662902832, 1.3791096210479736, 0.4956855773925781, 0.41246962547302246, 0.0825878381729126, 0.052399516105651855, 0.23384785652160645, 0.4028940200805664, 0.5410016775131226, 0.38761067390441895, 0.759963870048523, 2.208472728729248], "mean_td_error": 0.7804440259933472, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 77.0, "diff_num_grad_updates_vs_sampler_policy": 76.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.10202407836914, "actor_loss": -6.920982837677002, "critic_loss": 0.17460206151008606, "alpha_loss": -0.23042914271354675, "alpha_value": 0.9774479866027832, "log_alpha_value": -0.0228101946413517, "target_entropy": -6.0, "policy_t": -0.04720759391784668, "mean_q": 2.709129571914673, "max_q": 2.9174985885620117, "min_q": 1.4326657056808472}, "td_error": [1.304835319519043, 1.606711745262146, 0.7994183301925659, 0.031931161880493164, 0.5339407920837402, 0.4324660301208496, 0.933168888092041, 1.3651131391525269, 0.081076979637146, 0.8661508560180664, 2.3543431758880615, 0.035115599632263184, 0.859390139579773, 0.028841733932495117, 0.09097802639007568, 0.4809798002243042, 0.19156265258789062, 1.5329928398132324, 1.2645277976989746, 0.3696225881576538, 0.10225939750671387, 0.07341921329498291, 1.528380036354065, 0.3434818387031555, 0.2887111306190491, 0.026686549186706543, 3.8910484313964844, 1.5818120241165161, 0.910916805267334, 0.9746623039245605, 0.4851539134979248, 1.418228268623352, 1.5601433515548706, 0.9809833765029907, 0.9207158088684082, 0.8243240118026733, 0.17108368873596191, 2.137009859085083, 1.1716363430023193, 0.5980237722396851, 1.227929949760437, 0.18108057975769043, 1.5516964197158813, 0.04612851142883301, 0.48768091201782227, 1.2031886577606201, 0.6549841165542603, 0.2542001008987427, 0.5482709407806396, 2.014141321182251, 0.36987102031707764, 1.9259518384933472, 1.1138224601745605, 0.6652510166168213, 0.13439369201660156, 1.8505233526229858, 1.993129014968872, 0.8544334173202515, 0.8534060716629028, 0.7199441194534302, 1.127411961555481, 0.7738279104232788, 0.42430579662323, 0.266190767288208, 0.19698810577392578, 0.6437300443649292, 0.3565598726272583, 3.19912052154541, 1.3898087739944458, 0.8442237377166748, 2.023252010345459, 0.892056941986084, 1.0595544576644897, 0.7565121650695801, 0.2028285264968872, 0.6808470487594604, 0.6983515024185181, 0.23555421829223633, 0.8215415477752686, 0.14818060398101807, 0.040152788162231445, 1.5611823797225952, 0.36762142181396484, 3.366131544113159, 1.7436041831970215, 1.1807529926300049], "mean_td_error": 0.9163042902946472, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 77.0, "diff_num_grad_updates_vs_sampler_policy": 76.0}}, "num_env_steps_sampled": 69888, "num_env_steps_trained": 19866, "num_agent_steps_sampled": 209664, "num_agent_steps_trained": 19866, "last_target_update_ts": 69888, "num_target_updates": 77}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 209664, "num_agent_steps_trained": 19866, "num_env_steps_sampled": 69888, "num_env_steps_trained": 19866, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 954.6432586082075, "num_env_steps_trained_throughput_per_sec": 274.886116876024, "timesteps_total": 69888, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 209664, "timers": {"training_iteration_time_ms": 942.217, "sample_time_ms": 667.345, "load_time_ms": 0.318, "load_throughput": 811253.041, "learn_time_ms": 18.394, "learn_throughput": 14026.136, "synch_weights_time_ms": 10.135}, "counters": {"num_env_steps_sampled": 69888, "num_env_steps_trained": 19866, "num_agent_steps_sampled": 209664, "num_agent_steps_trained": 19866, "last_target_update_ts": 69888, "num_target_updates": 77}, "done": false, "episodes_total": 0, "training_iteration": 44, "trial_id": "7066a_00000", "date": "2023-11-18_21-08-10", "timestamp": 1700370490, "time_this_iter_s": 1.8864340782165527, "time_total_s": 74.06084132194519, "pid": 7187, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x31246a3e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 74.06084132194519, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 74.19999999999999, "ram_util_percent": 64.75}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.106433868408203, "actor_loss": -8.80014419555664, "critic_loss": 0.24595558643341064, "alpha_loss": -0.23664629459381104, "alpha_value": 0.9768565893173218, "log_alpha_value": -0.02341540902853012, "target_entropy": -6.0, "policy_t": -0.016911165788769722, "mean_q": 4.797869682312012, "max_q": 8.112512588500977, "min_q": 4.242963790893555}, "td_error": [1.3187885284423828, 0.7243621349334717, 0.6748857498168945, 1.9260225296020508, 1.158775806427002, 1.1766653060913086, 1.870532512664795, 1.6900551319122314, 4.5043044090271, 1.036430835723877, 1.6534452438354492, 1.599717140197754, 1.4774177074432373, 1.3917584419250488, 0.4420762062072754, 0.9989910125732422, 0.19446134567260742, 0.7501430511474609, 0.02902960777282715, 0.24452495574951172, 0.49866247177124023, 1.7544257640838623, 1.6078710556030273, 0.9759845733642578, 0.5112566947937012, 0.4803049564361572, 0.7742586135864258, 0.3014554977416992, 0.17860937118530273, 0.6131448745727539, 0.4122328758239746, 0.3762521743774414, 1.180086612701416, 1.860924482345581, 1.1249721050262451, 0.1636793613433838, 0.20876264572143555, 1.4531276226043701, 0.24765706062316895, 0.06293129920959473, 0.0711069107055664, 0.7461555004119873, 0.8932027816772461, 1.2659189701080322, 0.10516929626464844, 0.9796218872070312, 1.8201920986175537, 0.7640807628631592, 1.099836826324463, 1.496337652206421, 3.2198190689086914, 0.8746435642242432, 4.277846813201904, 1.7674503326416016, 0.5187253952026367, 0.15241432189941406, 1.420783519744873, 0.9403033256530762, 1.9860920906066895, 0.28340601921081543, 0.9632389545440674, 0.8798699378967285, 1.5562844276428223, 0.7896113395690918, 0.9702625274658203, 1.1755764484405518, 0.5999126434326172, 1.2716665267944336, 0.7051410675048828, 0.3483433723449707, 1.7677876949310303, 1.6710443496704102, 0.3764216899871826, 0.03517603874206543, 0.09372210502624512, 0.16777849197387695, 1.2297754287719727, 1.2420649528503418, 0.15778040885925293, 2.6946487426757812, 0.24014639854431152, 0.6204111576080322, 0.5575659275054932, 0.6114141941070557, 0.5110552310943604, 0.9394755363464355], "mean_td_error": 1.0059101581573486, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 79.0, "diff_num_grad_updates_vs_sampler_policy": 78.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.060449600219727, "actor_loss": -6.7913312911987305, "critic_loss": 0.12232549488544464, "alpha_loss": -0.23536497354507446, "alpha_value": 0.976876437664032, "log_alpha_value": -0.023395076394081116, "target_entropy": -6.0, "policy_t": -0.012271834537386894, "mean_q": 2.7761220932006836, "max_q": 2.8781208992004395, "min_q": 1.6825941801071167}, "td_error": [0.09122049808502197, 2.3070435523986816, 0.8766425848007202, 0.6013216972351074, 1.609354019165039, 0.03873264789581299, 0.16001415252685547, 0.6014680862426758, 1.0234768390655518, 0.9876973628997803, 0.23363196849822998, 0.09402632713317871, 0.12857425212860107, 1.1643791198730469, 0.3312032222747803, 0.2203993797302246, 0.18382740020751953, 0.24267375469207764, 0.16607666015625, 0.8843339681625366, 0.3052455186843872, 0.49918437004089355, 1.1929354667663574, 0.08551168441772461, 2.376492500305176, 0.10368728637695312, 0.7903467416763306, 0.39462339878082275, 0.3998450040817261, 0.1841444969177246, 0.330796480178833, 0.17919611930847168, 0.2518155574798584, 3.7792186737060547, 0.4082871675491333, 1.0562385320663452, 0.8253374099731445, 0.36388957500457764, 1.0451643466949463, 1.8068927526474, 0.8049006462097168, 1.531070590019226, 0.018589019775390625, 0.5468745231628418, 1.0780918598175049, 0.9969218969345093, 0.018535137176513672, 1.541229486465454, 0.5840054750442505, 0.5391616821289062, 1.2956600189208984, 0.30295658111572266, 1.7101000547409058, 0.12577450275421143, 0.2336282730102539, 1.4302794933319092, 1.7417104244232178, 0.6363155841827393, 0.6965590715408325, 0.1000291109085083, 1.712083339691162, 0.7220466136932373, 0.5927776098251343, 0.28166651725769043, 0.8398702144622803, 0.3731236457824707, 0.9177858829498291, 0.5420018434524536, 0.6124753952026367, 2.0013039112091064, 1.1376185417175293, 0.8978427648544312, 0.5124988555908203, 0.18049442768096924, 0.31039953231811523, 1.8243303298950195, 1.0099387168884277, 0.6059536933898926, 0.3847825527191162, 1.9704114198684692, 0.15647709369659424, 1.790964961051941, 1.6811988353729248, 0.4373210668563843, 0.2556248903274536, 0.05697542428970337], "mean_td_error": 0.7682013511657715, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 79.0, "diff_num_grad_updates_vs_sampler_policy": 78.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0960693359375, "actor_loss": -6.797904014587402, "critic_loss": 0.16243621706962585, "alpha_loss": -0.23634569346904755, "alpha_value": 0.9768621921539307, "log_alpha_value": -0.023409675806760788, "target_entropy": -6.0, "policy_t": -0.04675295576453209, "mean_q": 2.7208547592163086, "max_q": 2.8747618198394775, "min_q": 1.507181167602539}, "td_error": [1.9820173978805542, 0.0500035285949707, 0.8758677244186401, 0.17448675632476807, 1.4903819561004639, 2.112616539001465, 1.4219869375228882, 1.4359508752822876, 0.2881762981414795, 0.7155380249023438, 0.8741180896759033, 1.0998064279556274, 0.6020212173461914, 0.2130035161972046, 0.5835853815078735, 1.9169178009033203, 0.2820199728012085, 0.6619229316711426, 2.629883050918579, 0.5158318281173706, 0.5012102127075195, 0.14172279834747314, 0.14026117324829102, 0.31502866744995117, 0.5677502155303955, 0.30996155738830566, 1.3129279613494873, 0.4769362211227417, 0.3703727722167969, 0.7347730398178101, 0.17960381507873535, 0.3591824769973755, 0.33409857749938965, 0.5181624889373779, 0.9423458576202393, 0.1327066421508789, 0.553652286529541, 0.8618955612182617, 0.6384286880493164, 2.434382915496826, 2.5586137771606445, 2.9476990699768066, 2.486825942993164, 0.24540472030639648, 0.7536599636077881, 0.22523272037506104, 1.542024850845337, 2.2822635173797607, 2.6517152786254883, 1.6248160600662231, 0.8469973802566528, 0.5206807851791382, 0.6298983097076416, 0.39187324047088623, 2.020266532897949, 1.185973048210144, 1.2133687734603882, 0.7414816617965698, 0.7353366613388062, 1.506173849105835, 0.4342076778411865, 1.8606055974960327, 0.040941834449768066, 0.337094783782959, 1.7943516969680786, 0.027418971061706543, 0.1787257194519043, 0.8568086624145508, 1.0389090776443481, 0.9733285903930664, 0.2740497589111328, 0.2751591205596924, 0.24070274829864502, 0.17497873306274414, 1.119994878768921, 2.1262075901031494, 0.29026269912719727, 0.8381592035293579, 0.8273617029190063, 0.8182001113891602, 0.12206387519836426, 0.7880449295043945, 0.9978692531585693, 0.518373966217041, 0.15422320365905762, 0.45338869094848633], "mean_td_error": 0.8886428475379944, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 79.0, "diff_num_grad_updates_vs_sampler_policy": 78.0}}, "num_env_steps_sampled": 71680, "num_env_steps_trained": 20382, "num_agent_steps_sampled": 215040, "num_agent_steps_trained": 20382, "last_target_update_ts": 71680, "num_target_updates": 79}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 215040, "num_agent_steps_trained": 20382, "num_env_steps_sampled": 71680, "num_env_steps_trained": 20382, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 966.4769639514367, "num_env_steps_trained_throughput_per_sec": 278.2935900663735, "timesteps_total": 71680, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 215040, "timers": {"training_iteration_time_ms": 907.726, "sample_time_ms": 631.881, "load_time_ms": 0.315, "load_throughput": 819547.434, "learn_time_ms": 18.259, "learn_throughput": 14129.685, "synch_weights_time_ms": 9.98}, "counters": {"num_env_steps_sampled": 71680, "num_env_steps_trained": 20382, "num_agent_steps_sampled": 215040, "num_agent_steps_trained": 20382, "last_target_update_ts": 71680, "num_target_updates": 79}, "done": false, "episodes_total": 0, "training_iteration": 45, "trial_id": "7066a_00000", "date": "2023-11-18_21-08-12", "timestamp": 1700370492, "time_this_iter_s": 1.863476276397705, "time_total_s": 75.9243175983429, "pid": 7187, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x31039e520>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 75.9243175983429, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 74.3, "ram_util_percent": 64.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.029086112976074, "actor_loss": -8.860696792602539, "critic_loss": 0.2045021802186966, "alpha_loss": -0.2408524453639984, "alpha_value": 0.9762706756591797, "log_alpha_value": -0.02401539497077465, "target_entropy": -6.0, "policy_t": 0.03921589255332947, "mean_q": 4.854558944702148, "max_q": 5.724736213684082, "min_q": 4.25106143951416}, "td_error": [1.2838990688323975, 1.835982084274292, 1.9019875526428223, 0.19197845458984375, 1.08937406539917, 1.430544376373291, 0.3058638572692871, 0.717949628829956, 0.9714052677154541, 0.21197032928466797, 0.4135289192199707, 0.19626879692077637, 0.11572909355163574, 0.07998061180114746, 1.0155551433563232, 1.9465768337249756, 0.9042906761169434, 0.8899896144866943, 0.8983216285705566, 2.3730955123901367, 0.3578791618347168, 0.9831523895263672, 0.4737091064453125, 1.8001677989959717, 1.3014063835144043, 0.6902341842651367, 0.5750296115875244, 1.8806443214416504, 0.8751587867736816, 0.30953145027160645, 0.21498489379882812, 1.6423711776733398, 1.1869211196899414, 0.48336291313171387, 0.23290538787841797, 0.2916133403778076, 0.3393440246582031, 0.32111549377441406, 1.0421271324157715, 0.5946311950683594, 1.4819576740264893, 0.9810385704040527, 0.08677530288696289, 0.39055776596069336, 0.6986641883850098, 0.342090368270874, 2.338489532470703, 0.6847186088562012, 0.23141145706176758, 0.6041903495788574, 1.8160381317138672, 0.32397913932800293, 0.9011788368225098, 0.7822773456573486, 0.6914849281311035, 0.8058867454528809, 0.08468270301818848, 2.0531110763549805, 2.0874688625335693, 0.8540172576904297, 0.38664698600769043, 1.605909824371338, 0.02514791488647461, 0.1761302947998047, 2.4396109580993652, 0.14555716514587402, 0.7057180404663086, 1.8221769332885742, 0.7627320289611816, 1.1836516857147217, 2.1899213790893555, 1.6240363121032715, 1.2527289390563965, 0.19467830657958984, 0.13608026504516602, 0.3728151321411133, 0.5653872489929199, 2.7252449989318848, 1.554471731185913, 0.22285175323486328, 0.8896002769470215, 0.23029661178588867, 0.5496401786804199, 0.7904980182647705, 0.38652944564819336, 1.5342748165130615], "mean_td_error": 0.8963131308555603, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 81.0, "diff_num_grad_updates_vs_sampler_policy": 80.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.098438262939453, "actor_loss": -6.803760051727295, "critic_loss": 0.14219966530799866, "alpha_loss": -0.2423032969236374, "alpha_value": 0.9762914180755615, "log_alpha_value": -0.02399413287639618, "target_entropy": -6.0, "policy_t": 0.0004069352289661765, "mean_q": 2.742565870285034, "max_q": 2.8566646575927734, "min_q": 1.7659165859222412}, "td_error": [0.22365450859069824, 0.29421401023864746, 0.9118415117263794, 0.31832051277160645, 1.8174870014190674, 0.5176270008087158, 0.6688796281814575, 0.25201332569122314, 0.7620944976806641, 0.7783619165420532, 0.5996682643890381, 0.9572913646697998, 1.1393473148345947, 0.4034620523452759, 0.6115063428878784, 0.2381824254989624, 0.21660375595092773, 1.0393710136413574, 0.5929239988327026, 1.5359435081481934, 0.04680585861206055, 1.1823540925979614, 1.5819926261901855, 0.03719532489776611, 0.5434569120407104, 1.8053547143936157, 0.34836745262145996, 0.5889971256256104, 0.3475005626678467, 1.174964189529419, 2.0504579544067383, 0.5944235324859619, 0.9000329971313477, 2.420872211456299, 0.10885012149810791, 0.2570819854736328, 1.2307679653167725, 1.9079697132110596, 0.21108222007751465, 0.2202157974243164, 0.4656803607940674, 0.5019408464431763, 0.9303810596466064, 0.9887204170227051, 2.8846960067749023, 1.5368152856826782, 0.48276758193969727, 1.1348916292190552, 0.6036092042922974, 0.7734583616256714, 0.8961904048919678, 0.09451401233673096, 2.6175856590270996, 1.3784396648406982, 0.7902806997299194, 0.9286531209945679, 0.950300931930542, 0.9842135906219482, 1.3319313526153564, 0.8308306932449341, 1.2768611907958984, 1.5382840633392334, 0.4616440534591675, 0.5957623720169067, 1.4497928619384766, 0.9591876268386841, 0.46122539043426514, 0.5521326065063477, 0.043515682220458984, 0.6414437294006348, 0.9119752645492554, 0.03733408451080322, 0.7872862815856934, 0.582878589630127, 1.9229624271392822, 1.6135101318359375, 0.28657102584838867, 1.6276353597640991, 0.24113476276397705, 0.03722190856933594, 0.18813371658325195, 1.4574183225631714, 1.6401557922363281, 1.6687837839126587, 0.8400775194168091, 0.8596502542495728], "mean_td_error": 0.874721109867096, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 81.0, "diff_num_grad_updates_vs_sampler_policy": 80.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.033891677856445, "actor_loss": -6.788978099822998, "critic_loss": 0.15502715110778809, "alpha_loss": -0.24090443551540375, "alpha_value": 0.9762768745422363, "log_alpha_value": -0.024009067565202713, "target_entropy": -6.0, "policy_t": -0.051107075065374374, "mean_q": 2.690298318862915, "max_q": 2.83833646774292, "min_q": 1.6081078052520752}, "td_error": [0.6975135803222656, 0.5067592859268188, 1.198480486869812, 0.25493407249450684, 0.9476456046104431, 0.3077763319015503, 1.1187083721160889, 1.1674611568450928, 0.4080820083618164, 1.0377594232559204, 1.0447709560394287, 1.0764639377593994, 0.1655808687210083, 0.038146018981933594, 0.4919092655181885, 1.2613449096679688, 0.1962205171585083, 0.03599226474761963, 0.3298603296279907, 2.036367416381836, 0.6534154415130615, 0.2529945373535156, 0.4913473129272461, 0.17423605918884277, 0.27809882164001465, 1.0781831741333008, 0.47323012351989746, 0.3175278902053833, 0.8249895572662354, 0.28799641132354736, 0.27139103412628174, 0.20325732231140137, 1.3335809707641602, 1.1063477993011475, 2.7517752647399902, 1.8578766584396362, 1.9998443126678467, 1.5060155391693115, 2.068136215209961, 0.7225797176361084, 0.5158474445343018, 0.18498051166534424, 1.1535418033599854, 0.25687313079833984, 0.6777781248092651, 0.4704333543777466, 1.2961511611938477, 0.7441341876983643, 0.25296497344970703, 0.9505774974822998, 0.5016289949417114, 1.157936453819275, 0.46814537048339844, 1.0226154327392578, 0.2386571168899536, 0.47541749477386475, 1.2577463388442993, 0.2833811044692993, 2.329913377761841, 0.897565484046936, 1.1615630388259888, 1.5455759763717651, 0.7209286689758301, 2.5947422981262207, 1.0435106754302979, 1.1397150754928589, 0.9003520011901855, 1.2794370651245117, 0.4350426197052002, 1.8190886974334717, 1.3635175228118896, 0.10928881168365479, 1.3981146812438965, 1.1314561367034912, 0.5364954471588135, 0.1290755271911621, 0.36746227741241455, 0.2886432409286499, 1.09401535987854, 2.176436424255371, 2.345576286315918, 0.4434936046600342, 1.0555713176727295, 0.7050679922103882, 1.3815792798995972, 1.3045834302902222], "mean_td_error": 0.890479326248169, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 81.0, "diff_num_grad_updates_vs_sampler_policy": 80.0}}, "num_env_steps_sampled": 73472, "num_env_steps_trained": 20898, "num_agent_steps_sampled": 220416, "num_agent_steps_trained": 20898, "last_target_update_ts": 73472, "num_target_updates": 81}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 220416, "num_agent_steps_trained": 20898, "num_env_steps_sampled": 73472, "num_env_steps_trained": 20898, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 979.5497220813985, "num_env_steps_trained_throughput_per_sec": 282.0578440814741, "timesteps_total": 73472, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 220416, "timers": {"training_iteration_time_ms": 921.47, "sample_time_ms": 648.091, "load_time_ms": 0.312, "load_throughput": 827127.136, "learn_time_ms": 18.187, "learn_throughput": 14185.735, "synch_weights_time_ms": 10.063}, "counters": {"num_env_steps_sampled": 73472, "num_env_steps_trained": 20898, "num_agent_steps_sampled": 220416, "num_agent_steps_trained": 20898, "last_target_update_ts": 73472, "num_target_updates": 81}, "done": false, "episodes_total": 0, "training_iteration": 46, "trial_id": "7066a_00000", "date": "2023-11-18_21-08-14", "timestamp": 1700370494, "time_this_iter_s": 1.8387031555175781, "time_total_s": 77.76302075386047, "pid": 7187, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x312468b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 77.76302075386047, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 70.73333333333333, "ram_util_percent": 64.66666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.97636890411377, "actor_loss": -8.95444393157959, "critic_loss": 0.17091497778892517, "alpha_loss": -0.2455669492483139, "alpha_value": 0.9756855964660645, "log_alpha_value": -0.024614861235022545, "target_entropy": -6.0, "policy_t": -0.055041395127773285, "mean_q": 4.928898811340332, "max_q": 5.698052406311035, "min_q": 4.236293792724609}, "td_error": [0.7444562911987305, 0.04877018928527832, 0.08070516586303711, 1.7732679843902588, 0.23338842391967773, 1.3939385414123535, 0.08137679100036621, 0.44097065925598145, 1.5004472732543945, 0.7363138198852539, 0.2033851146697998, 1.1795237064361572, 2.119757890701294, 0.32214999198913574, 0.9377443790435791, 0.8334310054779053, 2.8095786571502686, 0.19256138801574707, 0.7739090919494629, 0.2783946990966797, 1.3413844108581543, 0.83089280128479, 0.8370141983032227, 0.6861801147460938, 2.319709062576294, 2.437826156616211, 0.04283928871154785, 0.2859916687011719, 1.0658977031707764, 0.15375781059265137, 0.275972843170166, 0.2415456771850586, 0.1139669418334961, 0.7506799697875977, 0.897907018661499, 1.394282341003418, 0.718252420425415, 0.805107593536377, 1.508667230606079, 0.240037202835083, 1.5865662097930908, 0.5542571544647217, 0.34255146980285645, 1.7498764991760254, 0.08722662925720215, 1.0385968685150146, 1.1453702449798584, 1.5643022060394287, 0.560340166091919, 0.4979395866394043, 0.7764933109283447, 0.5026335716247559, 0.7713832855224609, 0.6190707683563232, 1.6595213413238525, 0.19684982299804688, 0.19292449951171875, 0.5422542095184326, 0.7468392848968506, 0.8718316555023193, 1.3483493328094482, 0.09448504447937012, 1.6110377311706543, 0.6035990715026855, 0.20050287246704102, 1.65627121925354, 0.05435967445373535, 0.1398012638092041, 0.050348758697509766, 2.0660319328308105, 0.541182279586792, 1.5020933151245117, 0.17729496955871582, 1.1601967811584473, 1.2288715839385986, 1.3713767528533936, 0.5356619358062744, 0.5982787609100342, 0.6186244487762451, 2.10119366645813, 0.43529272079467773, 1.3466272354125977, 0.8812389373779297, 0.46909546852111816, 0.6186361312866211, 0.05250906944274902], "mean_td_error": 0.8267648220062256, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 83.0, "diff_num_grad_updates_vs_sampler_policy": 82.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.01339054107666, "actor_loss": -6.716042995452881, "critic_loss": 0.13443773984909058, "alpha_loss": -0.24626335501670837, "alpha_value": 0.9757065773010254, "log_alpha_value": -0.024593405425548553, "target_entropy": -6.0, "policy_t": -0.03209180384874344, "mean_q": 2.733407735824585, "max_q": 2.847778797149658, "min_q": 1.8832722902297974}, "td_error": [0.421794056892395, 0.20408201217651367, 0.5932550430297852, 0.5807807445526123, 0.7470678091049194, 1.4914132356643677, 0.8361473083496094, 0.863457202911377, 0.18425822257995605, 0.244154155254364, 0.9085723161697388, 0.8779637813568115, 1.2752015590667725, 0.7296640872955322, 2.5264196395874023, 0.21966814994812012, 1.2912418842315674, 0.1876673698425293, 1.0676443576812744, 1.9532603025436401, 0.6570936441421509, 0.7239360809326172, 0.23250579833984375, 0.20026028156280518, 1.0497292280197144, 1.4376193284988403, 0.7401306629180908, 0.5935708284378052, 1.1591448783874512, 0.8307889699935913, 2.3173420429229736, 0.686524510383606, 0.42145371437072754, 0.17964386940002441, 0.2068721055984497, 0.13179731369018555, 1.122645616531372, 0.2627217769622803, 0.31694698333740234, 0.26510000228881836, 0.8936176300048828, 0.26638150215148926, 0.8235296010971069, 1.3627607822418213, 0.24543213844299316, 0.5780380964279175, 2.11985445022583, 0.4981297254562378, 1.473146677017212, 0.7543199062347412, 3.1619620323181152, 0.41954636573791504, 0.46770644187927246, 1.8356345891952515, 0.11638164520263672, 0.8970110416412354, 1.6094080209732056, 0.21964991092681885, 0.3882533311843872, 1.8805557489395142, 0.020626544952392578, 0.07265818119049072, 2.22282338142395, 1.661204218864441, 0.03540349006652832, 0.04139149188995361, 0.43740153312683105, 0.5245862007141113, 1.2004008293151855, 1.468488097190857, 1.2851299047470093, 1.57743501663208, 0.9647887945175171, 1.0054681301116943, 0.2521103620529175, 0.14223670959472656, 0.5082293748855591, 0.5985279083251953, 0.1381208896636963, 0.6570912599563599, 1.2003426551818848, 0.035550713539123535, 0.8522775173187256, 0.7289875745773315, 2.305060863494873, 0.38224899768829346], "mean_td_error": 0.826388955116272, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 83.0, "diff_num_grad_updates_vs_sampler_policy": 82.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.103955268859863, "actor_loss": -6.780216693878174, "critic_loss": 0.18276065587997437, "alpha_loss": -0.24863983690738678, "alpha_value": 0.9756921529769897, "log_alpha_value": -0.024608168751001358, "target_entropy": -6.0, "policy_t": 0.003516495693475008, "mean_q": 2.663104295730591, "max_q": 2.8119354248046875, "min_q": 1.7752007246017456}, "td_error": [1.5937583446502686, 0.9924366474151611, 1.310265064239502, 0.03299593925476074, 0.07298672199249268, 1.0731357336044312, 0.5857822895050049, 0.9492701292037964, 1.9841755628585815, 1.657907247543335, 2.5312142372131348, 1.0913490056991577, 0.8914130926132202, 0.4244731664657593, 0.7657061815261841, 0.25805962085723877, 1.733587384223938, 1.3169360160827637, 1.2656294107437134, 0.39416420459747314, 1.6294360160827637, 0.1695706844329834, 0.033533334732055664, 0.5434792041778564, 1.659611701965332, 1.3323509693145752, 1.4324082136154175, 0.36543428897857666, 1.4815542697906494, 0.2578752040863037, 0.5815646648406982, 0.03765237331390381, 2.0946707725524902, 1.0062267780303955, 0.3293328285217285, 1.025957465171814, 0.26985323429107666, 1.7093828916549683, 1.0153932571411133, 0.9016631841659546, 0.5095866918563843, 1.6576828956604004, 0.4444758892059326, 1.299323320388794, 1.3226571083068848, 0.3892498016357422, 1.9005982875823975, 3.262150526046753, 0.42198848724365234, 0.6572867631912231, 0.48219406604766846, 1.4298174381256104, 0.42601943016052246, 0.04011416435241699, 1.2479794025421143, 1.511570692062378, 0.9822227954864502, 0.5516633987426758, 0.39536356925964355, 0.337612509727478, 0.6363933086395264, 2.414369583129883, 0.9635698795318604, 1.1634657382965088, 0.457211971282959, 0.06110429763793945, 1.34285569190979, 1.208533525466919, 0.8490772247314453, 0.4096614122390747, 0.7615636587142944, 1.7638583183288574, 1.3547695875167847, 1.1404377222061157, 1.0012694597244263, 0.5658166408538818, 1.5902297496795654, 0.3971315622329712, 0.7651022672653198, 0.7602298259735107, 1.484192132949829, 0.7539434432983398, 1.0157711505889893, 0.4893859624862671, 1.8600356578826904, 1.532796025276184], "mean_td_error": 0.9862154722213745, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 83.0, "diff_num_grad_updates_vs_sampler_policy": 82.0}}, "num_env_steps_sampled": 75264, "num_env_steps_trained": 21414, "num_agent_steps_sampled": 225792, "num_agent_steps_trained": 21414, "last_target_update_ts": 75264, "num_target_updates": 83}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 225792, "num_agent_steps_trained": 21414, "num_env_steps_sampled": 75264, "num_env_steps_trained": 21414, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 903.8350396650268, "num_env_steps_trained_throughput_per_sec": 260.25607168925995, "timesteps_total": 75264, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 225792, "timers": {"training_iteration_time_ms": 938.964, "sample_time_ms": 662.137, "load_time_ms": 0.321, "load_throughput": 803840.761, "learn_time_ms": 18.699, "learn_throughput": 13797.827, "synch_weights_time_ms": 10.173}, "counters": {"num_env_steps_sampled": 75264, "num_env_steps_trained": 21414, "num_agent_steps_sampled": 225792, "num_agent_steps_trained": 21414, "last_target_update_ts": 75264, "num_target_updates": 83}, "done": false, "episodes_total": 0, "training_iteration": 47, "trial_id": "7066a_00000", "date": "2023-11-18_21-08-16", "timestamp": 1700370496, "time_this_iter_s": 1.9933393001556396, "time_total_s": 79.75636005401611, "pid": 7187, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x31246ab60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 79.75636005401611, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 80.15, "ram_util_percent": 64.75}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.012295722961426, "actor_loss": -9.02029800415039, "critic_loss": 0.18589600920677185, "alpha_loss": -0.24944953620433807, "alpha_value": 0.9753934741020203, "log_alpha_value": -0.024914320558309555, "target_entropy": -6.0, "policy_t": -0.02079501748085022, "mean_q": 4.962600231170654, "max_q": 6.352194309234619, "min_q": 4.098553657531738}, "td_error": [1.1092171669006348, 0.014943599700927734, 0.3697824478149414, 0.8417880535125732, 0.43056535720825195, 0.33989906311035156, 0.05133628845214844, 0.8731775283813477, 1.0228495597839355, 0.2103428840637207, 0.32236576080322266, 0.571014404296875, 0.8130614757537842, 0.04256439208984375, 1.5587515830993652, 1.0957274436950684, 0.33988523483276367, 0.27839088439941406, 0.1381969451904297, 0.24445390701293945, 1.3619701862335205, 1.73146390914917, 0.28087878227233887, 0.6502528190612793, 0.32568931579589844, 0.01761913299560547, 0.0465545654296875, 0.6887974739074707, 0.6837127208709717, 0.26195216178894043, 0.6685223579406738, 0.9922025203704834, 1.6294922828674316, 1.1750636100769043, 1.3369979858398438, 0.1694493293762207, 0.18958067893981934, 5.1724653244018555, 1.0298991203308105, 0.02214646339416504, 0.784144401550293, 0.3742702007293701, 0.855168342590332, 0.25121259689331055, 0.20071935653686523, 0.07670187950134277, 1.4087574481964111, 3.101444959640503, 0.05758523941040039, 1.724386215209961, 0.6129961013793945, 0.4103868007659912, 2.0194783210754395, 0.9315853118896484, 2.082331657409668, 0.7060854434967041, 1.3372461795806885, 1.18569016456604, 1.4424145221710205, 2.0070650577545166, 0.16345500946044922, 1.3926887512207031, 0.5744569301605225, 1.6778671741485596, 0.3041074275970459, 1.8602299690246582, 0.2433929443359375, 0.06834077835083008, 1.9014859199523926, 0.5541877746582031, 0.532698392868042, 0.4504518508911133, 1.1097474098205566, 0.16153764724731445, 0.06926083564758301, 0.19035625457763672, 0.06280708312988281, 1.142939567565918, 1.4825236797332764, 2.21061372756958, 0.7270727157592773, 2.26546049118042, 1.6602439880371094, 0.8155181407928467, 0.6533956527709961, 0.6989727020263672], "mean_td_error": 0.8563547134399414, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 84.0, "diff_num_grad_updates_vs_sampler_policy": 83.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.137263298034668, "actor_loss": -6.817577362060547, "critic_loss": 0.1299569308757782, "alpha_loss": -0.25234612822532654, "alpha_value": 0.9754143357276917, "log_alpha_value": -0.02489292249083519, "target_entropy": -6.0, "policy_t": -0.0329081267118454, "mean_q": 2.7289233207702637, "max_q": 2.8414931297302246, "min_q": 1.8515126705169678}, "td_error": [0.05876600742340088, 1.1396774053573608, 2.278996229171753, 1.3824526071548462, 0.4049801826477051, 0.35558199882507324, 1.018230676651001, 1.6051980257034302, 0.6884081363677979, 0.38588666915893555, 1.0678247213363647, 0.14251172542572021, 0.024296879768371582, 0.7650240659713745, 0.2211754322052002, 2.7628583908081055, 0.42884647846221924, 0.19304418563842773, 0.6198247671127319, 1.2428230047225952, 1.013308048248291, 0.3789921998977661, 0.1458733081817627, 1.4933617115020752, 0.8415952920913696, 1.7823466062545776, 0.10687804222106934, 0.5790774822235107, 0.2513068914413452, 1.2336963415145874, 0.06102955341339111, 1.4760195016860962, 0.6668785810470581, 0.5603339672088623, 0.1692107915878296, 0.46119236946105957, 1.321511149406433, 0.3566398620605469, 1.3390311002731323, 0.6130778789520264, 0.37140822410583496, 0.035408616065979004, 1.2123894691467285, 0.7501233816146851, 0.2877616882324219, 1.0931429862976074, 0.8810397386550903, 0.4733612537384033, 1.977372169494629, 1.2751232385635376, 0.3314779996871948, 1.1250741481781006, 2.2368409633636475, 0.8494751453399658, 1.1094475984573364, 0.6294819116592407, 0.5399808883666992, 0.4910745620727539, 1.4812778234481812, 0.32855141162872314, 0.49347424507141113, 0.269481897354126, 0.6483008861541748, 0.4330275058746338, 0.45090794563293457, 0.8338358402252197, 0.2898886203765869, 0.930574893951416, 0.5239697694778442, 0.5968214273452759, 1.5150647163391113, 0.6435947418212891, 2.010037899017334, 2.410771131515503, 0.33903002738952637, 0.2518637180328369, 1.1649938821792603, 2.2312703132629395, 0.2822476625442505, 0.8678722381591797, 0.6856371164321899, 0.1723003387451172, 1.4574357271194458, 0.23007416725158691, 1.1039743423461914, 0.2788386344909668], "mean_td_error": 0.8166612982749939, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 84.0, "diff_num_grad_updates_vs_sampler_policy": 83.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.05054759979248, "actor_loss": -6.72243070602417, "critic_loss": 0.18529117107391357, "alpha_loss": -0.2503373920917511, "alpha_value": 0.9753997921943665, "log_alpha_value": -0.02490783855319023, "target_entropy": -6.0, "policy_t": -0.029190421104431152, "mean_q": 2.677229166030884, "max_q": 2.802429676055908, "min_q": 1.8408554792404175}, "td_error": [1.0766468048095703, 0.6792211532592773, 0.8719513416290283, 1.1449942588806152, 1.4592657089233398, 1.6086505651474, 0.44305551052093506, 1.263182282447815, 0.19945085048675537, 0.6095166206359863, 1.4683369398117065, 1.5723758935928345, 0.3836684226989746, 0.4414128065109253, 0.059676170349121094, 0.049842000007629395, 0.5361217260360718, 0.23197853565216064, 0.608138918876648, 1.0993586778640747, 1.8677377700805664, 0.8547918796539307, 0.7290871143341064, 1.7441819906234741, 1.580280065536499, 0.14093756675720215, 1.4850490093231201, 0.5928133726119995, 0.9880915880203247, 0.6086437702178955, 0.879841685295105, 1.5998897552490234, 0.7802189588546753, 0.11842918395996094, 0.785942554473877, 0.8454903364181519, 1.4479362964630127, 0.3149944543838501, 1.2378596067428589, 0.8446846008300781, 1.774096131324768, 1.394389271736145, 0.7153036594390869, 0.13007783889770508, 1.822581171989441, 0.8105292320251465, 2.141972064971924, 1.0439538955688477, 0.4937248229980469, 0.5202710628509521, 1.1248559951782227, 2.6535582542419434, 0.09028768539428711, 0.9346705675125122, 1.5389078855514526, 0.10083794593811035, 0.37263500690460205, 0.35254502296447754, 1.1799187660217285, 3.6331095695495605, 0.28236067295074463, 0.9580178260803223, 0.5658597946166992, 0.6103464365005493, 1.5221692323684692, 0.20961177349090576, 0.6794998645782471, 0.952878475189209, 1.180544376373291, 1.3907657861709595, 2.930178642272949, 2.2258033752441406, 1.199690818786621, 1.2243565320968628, 0.5842095613479614, 0.3884131908416748, 0.3386436700820923, 1.4692519903182983, 1.2691150903701782, 0.5603928565979004, 2.0313313007354736, 0.6141948699951172, 1.6512593030929565, 1.0901213884353638, 0.6827092170715332, 0.29168105125427246], "mean_td_error": 0.9882020950317383, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 84.0, "diff_num_grad_updates_vs_sampler_policy": 83.0}}, "num_env_steps_sampled": 76160, "num_env_steps_trained": 21672, "num_agent_steps_sampled": 228480, "num_agent_steps_trained": 21672, "last_target_update_ts": 76160, "num_target_updates": 84}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 228480, "num_agent_steps_trained": 21672, "num_env_steps_sampled": 76160, "num_env_steps_trained": 21672, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 661.4046134868522, "num_env_steps_trained_throughput_per_sec": 190.44909629420522, "timesteps_total": 76160, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 228480, "timers": {"training_iteration_time_ms": 981.178, "sample_time_ms": 702.855, "load_time_ms": 0.317, "load_throughput": 813448.419, "learn_time_ms": 18.65, "learn_throughput": 13833.792, "synch_weights_time_ms": 10.166}, "counters": {"num_env_steps_sampled": 76160, "num_env_steps_trained": 21672, "num_agent_steps_sampled": 228480, "num_agent_steps_trained": 21672, "last_target_update_ts": 76160, "num_target_updates": 84}, "done": false, "episodes_total": 0, "training_iteration": 48, "trial_id": "7066a_00000", "date": "2023-11-18_21-08-17", "timestamp": 1700370497, "time_this_iter_s": 1.364387035369873, "time_total_s": 81.12074708938599, "pid": 7187, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x312468720>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 81.12074708938599, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 78.3, "ram_util_percent": 65.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.036792755126953, "actor_loss": -9.041805267333984, "critic_loss": 0.1744518280029297, "alpha_loss": -0.25606995820999146, "alpha_value": 0.9748095870018005, "log_alpha_value": -0.02551312744617462, "target_entropy": -6.0, "policy_t": -0.051828183233737946, "mean_q": 4.993454456329346, "max_q": 6.140012741088867, "min_q": 4.927099704742432}, "td_error": [1.6536478996276855, 1.2403748035430908, 0.4677772521972656, 0.07420682907104492, 1.2002902030944824, 0.24913311004638672, 0.9086973667144775, 0.8954205513000488, 0.15712594985961914, 0.9537758827209473, 1.8341186046600342, 1.2336466312408447, 0.5402383804321289, 1.1833782196044922, 1.2179584503173828, 1.5066123008728027, 0.6618340015411377, 0.3302450180053711, 0.6126477718353271, 0.36414647102355957, 0.4414796829223633, 0.7010891437530518, 0.06842422485351562, 0.995448112487793, 1.3609824180603027, 0.1612255573272705, 0.04462265968322754, 1.9940943717956543, 0.6282038688659668, 0.2335672378540039, 1.9907264709472656, 2.5077943801879883, 1.9279320240020752, 0.7874574661254883, 0.6131863594055176, 1.0919756889343262, 0.55838942527771, 0.2650148868560791, 1.0195341110229492, 0.679175615310669, 0.04137420654296875, 1.0167529582977295, 1.0995004177093506, 0.16514134407043457, 0.1834697723388672, 1.2377171516418457, 2.556657314300537, 0.10031580924987793, 1.5268397331237793, 0.6782858371734619, 0.6657516956329346, 2.7406063079833984, 1.1676857471466064, 0.6569533348083496, 0.1518402099609375, 0.3760409355163574, 1.293501377105713, 1.1854619979858398, 1.0721991062164307, 3.3328909873962402, 0.13660383224487305, 1.776766300201416, 0.9506931304931641, 0.8292710781097412, 1.1222243309020996, 1.335630178451538, 0.833146333694458, 0.9980752468109131, 0.16202425956726074, 1.0498394966125488, 0.028902292251586914, 1.6167845726013184, 0.17739319801330566, 1.0461454391479492, 0.19863176345825195, 0.007619380950927734, 0.011959552764892578, 0.540773868560791, 0.4663825035095215, 0.1165614128112793, 0.8979775905609131, 0.8106546401977539, 0.3232715129852295, 1.948319911956787, 0.12894940376281738, 0.7340953350067139], "mean_td_error": 0.870387077331543, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 86.0, "diff_num_grad_updates_vs_sampler_policy": 85.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.111868858337402, "actor_loss": -6.749457836151123, "critic_loss": 0.14621560275554657, "alpha_loss": -0.25777527689933777, "alpha_value": 0.9748298525810242, "log_alpha_value": -0.0254923477768898, "target_entropy": -6.0, "policy_t": -0.012815737165510654, "mean_q": 2.7275452613830566, "max_q": 2.8292272090911865, "min_q": 1.9773595333099365}, "td_error": [0.30444061756134033, 0.6201670169830322, 0.3535367250442505, 0.1994032859802246, 2.140401840209961, 0.5157876014709473, 1.4045658111572266, 2.1246981620788574, 1.4806251525878906, 0.5166498422622681, 0.691423773765564, 0.6316912174224854, 2.429417610168457, 1.2546701431274414, 1.793372392654419, 0.45823657512664795, 0.9980953931808472, 0.04040682315826416, 0.3748481273651123, 0.756983757019043, 1.3831366300582886, 0.11479520797729492, 0.08819162845611572, 0.8470557928085327, 0.7143031358718872, 0.7914259433746338, 0.7318404912948608, 0.9835491180419922, 1.6166703701019287, 1.040373682975769, 0.5617491006851196, 0.949802041053772, 1.4739329814910889, 0.7015295028686523, 2.0136260986328125, 0.49597883224487305, 2.4354748725891113, 0.6333532333374023, 0.06641995906829834, 1.534036636352539, 0.633291482925415, 0.7016937732696533, 0.8365674018859863, 0.4001274108886719, 0.508908748626709, 0.3104267120361328, 1.422534465789795, 1.0759711265563965, 0.7720378637313843, 0.948332667350769, 0.39968109130859375, 0.6296607255935669, 0.7704542875289917, 0.5679126977920532, 0.6100096702575684, 1.7916383743286133, 0.05150473117828369, 0.06865251064300537, 1.8109906911849976, 0.15188586711883545, 1.2972633838653564, 0.3918609619140625, 0.29671502113342285, 0.5311940908432007, 0.2519153356552124, 0.9833766222000122, 0.7607141733169556, 0.5384014844894409, 0.12388396263122559, 1.3240852355957031, 1.3627839088439941, 0.936194896697998, 0.8410115242004395, 0.6299571990966797, 0.8997926712036133, 1.0928645133972168, 2.1584103107452393, 0.3601186275482178, 0.04597330093383789, 1.5528734922409058, 2.0881807804107666, 1.3462752103805542, 0.1268622875213623, 1.6800758838653564, 0.9866310358047485, 0.8925299644470215], "mean_td_error": 0.886382520198822, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 86.0, "diff_num_grad_updates_vs_sampler_policy": 85.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.008995056152344, "actor_loss": -6.694468021392822, "critic_loss": 0.1699029952287674, "alpha_loss": -0.2552986145019531, "alpha_value": 0.9748156070709229, "log_alpha_value": -0.025506917387247086, "target_entropy": -6.0, "policy_t": -0.0560339093208313, "mean_q": 2.6483867168426514, "max_q": 2.7867021560668945, "min_q": 1.978736400604248}, "td_error": [0.030644536018371582, 0.03183114528656006, 0.07908296585083008, 1.367488980293274, 0.9454221725463867, 0.7193938493728638, 0.697333812713623, 1.0717766284942627, 0.5771164894104004, 0.24046051502227783, 0.8699672222137451, 0.08923745155334473, 0.8230248689651489, 1.4741064310073853, 0.6792464256286621, 0.6847834587097168, 0.027254223823547363, 0.918482780456543, 0.19294798374176025, 0.19807755947113037, 0.062105774879455566, 2.276737689971924, 0.2011181116104126, 0.6766562461853027, 2.7254838943481445, 1.4599231481552124, 0.08330059051513672, 0.6078211069107056, 0.47545790672302246, 0.8394745588302612, 0.9615174531936646, 0.14461863040924072, 0.7256444692611694, 1.888435959815979, 0.9326152801513672, 1.8555569648742676, 1.5888006687164307, 1.6806755065917969, 2.4585909843444824, 0.07600545883178711, 1.1509548425674438, 0.5689021348953247, 2.4320228099823, 0.49649620056152344, 0.5662792921066284, 0.07159090042114258, 0.5986403226852417, 2.733511447906494, 0.7918974161148071, 2.2035679817199707, 1.6097936630249023, 1.0508344173431396, 1.9560844898223877, 0.21818864345550537, 0.7283401489257812, 0.4342106580734253, 0.24230360984802246, 2.0693705081939697, 1.431607723236084, 1.2328641414642334, 1.7089532613754272, 1.183716893196106, 2.1928043365478516, 0.6396667957305908, 0.5447454452514648, 0.01596677303314209, 1.0434026718139648, 0.6558676958084106, 0.9332114458084106, 0.9597272872924805, 0.7637752294540405, 1.262467384338379, 1.143927812576294, 0.21735072135925293, 0.07727706432342529, 0.16051197052001953, 1.4321863651275635, 0.5434155464172363, 0.358081579208374, 0.14554762840270996, 0.9760053157806396, 0.7425621747970581, 0.5308676958084106, 2.3324108123779297, 1.0368297100067139, 0.9964725971221924], "mean_td_error": 0.9142261147499084, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 86.0, "diff_num_grad_updates_vs_sampler_policy": 85.0}}, "num_env_steps_sampled": 77952, "num_env_steps_trained": 22188, "num_agent_steps_sampled": 233856, "num_agent_steps_trained": 22188, "last_target_update_ts": 77952, "num_target_updates": 86}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 233856, "num_agent_steps_trained": 22188, "num_env_steps_sampled": 77952, "num_env_steps_trained": 22188, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 945.8760080978803, "num_env_steps_trained_throughput_per_sec": 272.3616184031843, "timesteps_total": 77952, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 233856, "timers": {"training_iteration_time_ms": 985.143, "sample_time_ms": 708.188, "load_time_ms": 0.315, "load_throughput": 817813.204, "learn_time_ms": 18.588, "learn_throughput": 13879.962, "synch_weights_time_ms": 10.314}, "counters": {"num_env_steps_sampled": 77952, "num_env_steps_trained": 22188, "num_agent_steps_sampled": 233856, "num_agent_steps_trained": 22188, "last_target_update_ts": 77952, "num_target_updates": 86}, "done": false, "episodes_total": 0, "training_iteration": 49, "trial_id": "7066a_00000", "date": "2023-11-18_21-08-19", "timestamp": 1700370499, "time_this_iter_s": 1.9032268524169922, "time_total_s": 83.02397394180298, "pid": 7187, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x31039f2e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 83.02397394180298, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 78.16666666666666, "ram_util_percent": 65.93333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.957489967346191, "actor_loss": -9.010435104370117, "critic_loss": 0.13616031408309937, "alpha_loss": -0.26000937819480896, "alpha_value": 0.9742260575294495, "log_alpha_value": -0.026111936196684837, "target_entropy": -6.0, "policy_t": -0.0565674751996994, "mean_q": 4.883222579956055, "max_q": 5.130062580108643, "min_q": 3.4497764110565186}, "td_error": [1.8283891677856445, 0.5056405067443848, 0.7316231727600098, 1.3883798122406006, 0.7668633460998535, 0.9297614097595215, 0.6267726421356201, 1.271486759185791, 0.3363766670227051, 0.7251143455505371, 1.4297683238983154, 0.3923308849334717, 0.831960916519165, 0.6210362911224365, 0.8897819519042969, 0.22643756866455078, 1.2552225589752197, 0.02128767967224121, 0.554044246673584, 0.25683021545410156, 1.0929687023162842, 0.6488583087921143, 2.428802967071533, 1.008800983428955, 0.26036643981933594, 2.3277652263641357, 1.1032488346099854, 0.204481840133667, 1.464371919631958, 2.6993844509124756, 0.8711063861846924, 0.11041474342346191, 1.0438928604125977, 0.01244354248046875, 0.29221808910369873, 1.1873176097869873, 1.0100018978118896, 0.9014520645141602, 1.8800528049468994, 2.107311725616455, 1.6307377815246582, 0.24688196182250977, 0.956836462020874, 1.7266411781311035, 1.8933441638946533, 0.6250772476196289, 0.9730720520019531, 0.6805214881896973, 0.31978750228881836, 0.14048504829406738, 0.31188154220581055, 0.9328422546386719, 0.13892269134521484, 0.5891256332397461, 0.7746932506561279, 0.8983480930328369, 2.058227062225342, 0.5176692008972168, 0.5375092029571533, 0.4790980815887451, 1.1681411266326904, 0.6667618751525879, 1.1070716381072998, 0.6154685020446777, 0.45209836959838867, 1.951719045639038, 0.4611220359802246, 0.3343982696533203, 0.21745061874389648, 1.2713291645050049, 1.3833191394805908, 0.41759777069091797, 0.12995004653930664, 0.1943049430847168, 0.344740629196167, 0.7198340892791748, 0.23575544357299805, 0.7514756917953491, 1.3856878280639648, 1.144425392150879, 0.4234139919281006, 1.100984811782837, 0.9489080905914307, 0.36901259422302246, 0.7795865535736084, 0.054688215255737305], "mean_td_error": 0.8523873686790466, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 88.0, "diff_num_grad_updates_vs_sampler_policy": 87.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.055434226989746, "actor_loss": -6.72158670425415, "critic_loss": 0.12837669253349304, "alpha_loss": -0.2623659670352936, "alpha_value": 0.9742454886436462, "log_alpha_value": -0.026091957464814186, "target_entropy": -6.0, "policy_t": -0.026051536202430725, "mean_q": 2.7282087802886963, "max_q": 2.844529867172241, "min_q": 1.9873696565628052}, "td_error": [1.5466235876083374, 3.1233181953430176, 2.662971019744873, 0.723645806312561, 0.8205430507659912, 0.2499154806137085, 0.1555788516998291, 0.6826819181442261, 0.22891902923583984, 0.10811996459960938, 1.404392123222351, 1.163435459136963, 0.11922276020050049, 2.2755043506622314, 0.38375627994537354, 0.3354344367980957, 1.21819007396698, 0.813190221786499, 0.5292763710021973, 0.3440135717391968, 1.41939377784729, 0.9723186492919922, 1.0024993419647217, 1.5368671417236328, 1.769761085510254, 0.9106787443161011, 1.7499074935913086, 0.5112812519073486, 0.1708301305770874, 0.3282433748245239, 0.07818830013275146, 0.18261361122131348, 1.1846940517425537, 1.4831629991531372, 0.2984386682510376, 0.496478796005249, 3.838809013366699, 0.49071812629699707, 0.7324817180633545, 0.8028217554092407, 0.9751230478286743, 0.7388455867767334, 0.4629093408584595, 1.1169754266738892, 0.4611457586288452, 0.5128819942474365, 0.9265621900558472, 0.31234192848205566, 1.0294594764709473, 0.5041357278823853, 1.459827184677124, 0.7886350154876709, 0.7788510322570801, 0.5689209699630737, 0.44724559783935547, 0.02467811107635498, 0.1651904582977295, 0.3008178472518921, 0.8333578109741211, 0.2947772741317749, 0.5959874391555786, 2.0342047214508057, 0.38872408866882324, 1.163827896118164, 0.8936746120452881, 1.143259882926941, 0.16879487037658691, 0.28159499168395996, 1.3469955921173096, 1.547647476196289, 0.01812577247619629, 0.6914305686950684, 0.8383283615112305, 0.16639113426208496, 0.24765944480895996, 0.9113291501998901, 1.3461297750473022, 0.24824023246765137, 0.18886268138885498, 0.1380995512008667, 0.8284242153167725, 0.14417946338653564, 0.03651440143585205, 0.4353295564651489, 0.6522748470306396, 1.019195795059204], "mean_td_error": 0.8026375770568848, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 88.0, "diff_num_grad_updates_vs_sampler_policy": 87.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.07909870147705, "actor_loss": -6.702854633331299, "critic_loss": 0.1604185700416565, "alpha_loss": -0.26312145590782166, "alpha_value": 0.9742321372032166, "log_alpha_value": -0.026105651631951332, "target_entropy": -6.0, "policy_t": -0.043229132890701294, "mean_q": 2.6520659923553467, "max_q": 2.772578716278076, "min_q": 2.065680980682373}, "td_error": [1.1243640184402466, 1.540425181388855, 0.1745384931564331, 0.8691495656967163, 2.8839335441589355, 0.5447896718978882, 0.7434417009353638, 0.06884348392486572, 0.9812493324279785, 0.9070357084274292, 0.4065204858779907, 0.8902970552444458, 0.3003624677658081, 0.8362300395965576, 1.658342719078064, 2.2747676372528076, 1.9501487016677856, 0.07130885124206543, 0.879481315612793, 0.3757052421569824, 1.7279796600341797, 0.33821117877960205, 0.21886730194091797, 0.5304244756698608, 0.3679664134979248, 1.204634189605713, 0.3405334949493408, 1.3879714012145996, 0.1953589916229248, 0.09896910190582275, 0.6707421541213989, 0.249059796333313, 0.7014085054397583, 0.7157279253005981, 0.9172719717025757, 1.7811188697814941, 0.7399873733520508, 0.7824342250823975, 1.1835746765136719, 0.17213034629821777, 0.5751330852508545, 0.6506733894348145, 1.5920021533966064, 0.017876267433166504, 0.8876274824142456, 1.1496013402938843, 0.836683988571167, 1.0507113933563232, 0.9439892768859863, 1.7001625299453735, 0.8504631519317627, 0.33569395542144775, 2.0547499656677246, 1.1199685335159302, 0.11487770080566406, 1.9725829362869263, 1.1799182891845703, 1.6872353553771973, 0.35305190086364746, 0.16744983196258545, 1.2043826580047607, 0.20811820030212402, 2.812432289123535, 0.4197448492050171, 1.405235767364502, 0.5596275329589844, 0.3616492748260498, 0.27883195877075195, 0.47312605381011963, 0.1662580966949463, 1.1714881658554077, 0.23153305053710938, 0.25886011123657227, 1.5471540689468384, 1.328471302986145, 1.5330913066864014, 0.2458803653717041, 0.8673710823059082, 0.39070045948028564, 1.3743246793746948, 1.0216909646987915, 0.6039324998855591, 1.2174791097640991, 0.935907244682312, 2.8018412590026855, 0.10914015769958496], "mean_td_error": 0.8903957009315491, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 88.0, "diff_num_grad_updates_vs_sampler_policy": 87.0}}, "num_env_steps_sampled": 79744, "num_env_steps_trained": 22704, "num_agent_steps_sampled": 239232, "num_agent_steps_trained": 22704, "last_target_update_ts": 79744, "num_target_updates": 88}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 239232, "num_agent_steps_trained": 22704, "num_env_steps_sampled": 79744, "num_env_steps_trained": 22704, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 959.704155159599, "num_env_steps_trained_throughput_per_sec": 276.3433839633667, "timesteps_total": 79744, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 239232, "timers": {"training_iteration_time_ms": 987.799, "sample_time_ms": 712.038, "load_time_ms": 0.315, "load_throughput": 819547.434, "learn_time_ms": 18.49, "learn_throughput": 13953.449, "synch_weights_time_ms": 10.511}, "counters": {"num_env_steps_sampled": 79744, "num_env_steps_trained": 22704, "num_agent_steps_sampled": 239232, "num_agent_steps_trained": 22704, "last_target_update_ts": 79744, "num_target_updates": 88}, "done": false, "episodes_total": 0, "training_iteration": 50, "trial_id": "7066a_00000", "date": "2023-11-18_21-08-21", "timestamp": 1700370501, "time_this_iter_s": 1.8772778511047363, "time_total_s": 84.90125179290771, "pid": 7187, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x31246ab60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 84.90125179290771, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 74.39999999999999, "ram_util_percent": 65.73333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.98328971862793, "actor_loss": -9.018564224243164, "critic_loss": 0.14384695887565613, "alpha_loss": -0.2636691629886627, "alpha_value": 0.9739346504211426, "log_alpha_value": -0.02641105279326439, "target_entropy": -6.0, "policy_t": -0.061929065734148026, "mean_q": 4.924774169921875, "max_q": 5.152774810791016, "min_q": 3.503519058227539}, "td_error": [0.11214923858642578, 1.0517187118530273, 0.6460094451904297, 1.378586769104004, 0.5618691444396973, 0.18785548210144043, 0.9190363883972168, 0.2998032569885254, 0.41256237030029297, 0.11147332191467285, 1.4164228439331055, 1.1054835319519043, 0.8964231014251709, 0.5550644397735596, 0.5266141891479492, 1.4642488956451416, 0.7028300762176514, 0.8340706825256348, 1.157686710357666, 0.03076004981994629, 2.100184440612793, 0.6606886386871338, 0.6038479804992676, 1.464320421218872, 0.5438790321350098, 1.9974474906921387, 0.46436619758605957, 0.4305605888366699, 0.1110072135925293, 0.30771970748901367, 2.2943673133850098, 0.865006685256958, 0.001714944839477539, 0.3524439334869385, 0.8125903606414795, 0.9499044418334961, 1.1141784191131592, 2.0912482738494873, 2.1761529445648193, 0.9867734909057617, 2.5273914337158203, 0.22895145416259766, 1.2965898513793945, 0.9664220809936523, 2.5020179748535156, 0.3642442226409912, 0.4247312545776367, 0.4653048515319824, 0.3048279285430908, 0.36487436294555664, 0.22394609451293945, 0.6082446575164795, 0.912555456161499, 0.8639962673187256, 1.8987467288970947, 1.0560503005981445, 0.16793346405029297, 0.08122611045837402, 0.45952296257019043, 0.5847573280334473, 0.39112257957458496, 0.32721877098083496, 0.6865558624267578, 0.3521614074707031, 1.145892858505249, 0.2587294578552246, 1.3049983978271484, 0.0441136360168457, 0.778888463973999, 0.6122710704803467, 1.280634880065918, 0.7191119194030762, 1.1731231212615967, 1.748861312866211, 0.2524275779724121, 0.8980262279510498, 0.7977211475372314, 1.7163746356964111, 0.10431551933288574, 2.0737273693084717, 1.0597288608551025, 0.37254905700683594, 2.038882255554199, 1.2436528205871582, 0.45964789390563965, 1.5405995845794678], "mean_td_error": 0.8649156093597412, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 89.0, "diff_num_grad_updates_vs_sampler_policy": 88.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.109190940856934, "actor_loss": -6.736850261688232, "critic_loss": 0.1749744415283203, "alpha_loss": -0.26679858565330505, "alpha_value": 0.9739535450935364, "log_alpha_value": -0.026391685009002686, "target_entropy": -6.0, "policy_t": -0.03472662344574928, "mean_q": 2.70947527885437, "max_q": 2.808932304382324, "min_q": 2.0164525508880615}, "td_error": [0.9604905843734741, 0.8273190259933472, 0.6267011165618896, 0.9224370718002319, 1.9665387868881226, 0.6075509786605835, 0.8497847318649292, 1.6881446838378906, 0.2070610523223877, 2.0037639141082764, 0.723116397857666, 1.6927177906036377, 1.447892427444458, 0.8810945749282837, 0.7321940660476685, 2.528073787689209, 0.7845839262008667, 1.044836401939392, 0.2636880874633789, 0.16856670379638672, 0.4051854610443115, 1.817069172859192, 0.622248649597168, 0.1736011505126953, 0.6224178075790405, 2.2490997314453125, 0.10973405838012695, 1.4012339115142822, 0.3519643545150757, 3.329453945159912, 1.1821366548538208, 1.4165235757827759, 0.3255804777145386, 0.21802127361297607, 1.8398962020874023, 0.2047138214111328, 0.6092855930328369, 2.3176920413970947, 0.475772500038147, 0.8574075698852539, 0.7101624011993408, 1.615201473236084, 0.04556894302368164, 1.3689544200897217, 0.846877932548523, 0.0770493745803833, 0.9048275947570801, 1.9649269580841064, 2.3814315795898438, 0.6355615854263306, 1.0107766389846802, 1.6730432510375977, 1.1005984544754028, 1.2339173555374146, 0.4388672113418579, 0.2848353385925293, 0.51731276512146, 0.4961313009262085, 0.49332571029663086, 0.19405913352966309, 1.0618125200271606, 0.017531871795654297, 0.450484037399292, 0.798896312713623, 0.779868483543396, 0.8674056529998779, 0.8010153770446777, 1.0586339235305786, 0.1413964033126831, 2.2157363891601562, 1.1873371601104736, 1.6075716018676758, 0.11332428455352783, 1.1198701858520508, 2.4689831733703613, 1.144282341003418, 0.42684483528137207, 0.35390233993530273, 0.5487425327301025, 2.1421618461608887, 1.0726525783538818, 0.23791372776031494, 0.11765599250793457, 0.8194786310195923, 2.2831320762634277, 0.9521967172622681], "mean_td_error": 0.9795099496841431, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 89.0, "diff_num_grad_updates_vs_sampler_policy": 88.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.03753662109375, "actor_loss": -6.668086051940918, "critic_loss": 0.17388899624347687, "alpha_loss": -0.26504242420196533, "alpha_value": 0.9739404320716858, "log_alpha_value": -0.026405123993754387, "target_entropy": -6.0, "policy_t": -0.03489719331264496, "mean_q": 2.6621594429016113, "max_q": 2.841465473175049, "min_q": 2.116250514984131}, "td_error": [0.4011420011520386, 1.6138708591461182, 1.6579755544662476, 0.5824133157730103, 0.5544466972351074, 0.7108207941055298, 0.8612285852432251, 0.12325525283813477, 0.3167208433151245, 0.2659783363342285, 2.837226390838623, 0.8811748027801514, 0.6439467668533325, 1.7695304155349731, 1.2834745645523071, 0.13881230354309082, 0.6799454689025879, 0.27934277057647705, 0.8090479373931885, 0.7896205186843872, 0.4370349645614624, 0.19874107837677002, 0.0681159496307373, 0.08352899551391602, 1.3894461393356323, 0.9824814796447754, 0.11752748489379883, 2.528848648071289, 2.2904043197631836, 0.110443115234375, 1.7278960943222046, 2.4087305068969727, 1.7585614919662476, 0.24902188777923584, 0.730750322341919, 1.0492485761642456, 1.791841983795166, 0.9439710378646851, 1.6363474130630493, 1.6679922342300415, 0.26402103900909424, 2.3761372566223145, 0.0510174036026001, 0.6805195808410645, 1.3888483047485352, 0.548997163772583, 0.1651848554611206, 1.1103154420852661, 1.7179385423660278, 2.01698637008667, 1.6994425058364868, 1.6812800168991089, 0.9066257476806641, 0.027309417724609375, 0.019667625427246094, 0.1729729175567627, 0.6641830205917358, 0.7038511037826538, 0.13009023666381836, 0.7823047637939453, 0.7209988832473755, 0.2501492500305176, 0.33248257637023926, 0.2643033266067505, 1.8352320194244385, 1.6439627408981323, 0.7217075824737549, 0.9061669111251831, 0.019126415252685547, 1.3984602689743042, 1.3227273225784302, 0.5558044910430908, 1.0839500427246094, 0.728514552116394, 2.1338915824890137, 1.0766043663024902, 0.9567348957061768, 0.11007940769195557, 0.06264209747314453, 0.05945003032684326, 1.0898888111114502, 1.1594494581222534, 0.21491551399230957, 1.3063931465148926, 0.5957562923431396, 1.3535280227661133], "mean_td_error": 0.9114130735397339, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 89.0, "diff_num_grad_updates_vs_sampler_policy": 88.0}}, "num_env_steps_sampled": 80640, "num_env_steps_trained": 22962, "num_agent_steps_sampled": 241920, "num_agent_steps_trained": 22962, "last_target_update_ts": 80640, "num_target_updates": 89}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 241920, "num_agent_steps_trained": 22962, "num_env_steps_sampled": 80640, "num_env_steps_trained": 22962, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 631.9182825177346, "num_env_steps_trained_throughput_per_sec": 181.9586125999727, "timesteps_total": 80640, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 241920, "timers": {"training_iteration_time_ms": 1034.626, "sample_time_ms": 757.838, "load_time_ms": 0.32, "load_throughput": 807258.808, "learn_time_ms": 18.583, "learn_throughput": 13883.613, "synch_weights_time_ms": 10.611}, "counters": {"num_env_steps_sampled": 80640, "num_env_steps_trained": 22962, "num_agent_steps_sampled": 241920, "num_agent_steps_trained": 22962, "last_target_update_ts": 80640, "num_target_updates": 89}, "done": false, "episodes_total": 0, "training_iteration": 51, "trial_id": "7066a_00000", "date": "2023-11-18_21-08-23", "timestamp": 1700370503, "time_this_iter_s": 1.4275991916656494, "time_total_s": 86.32885098457336, "pid": 7187, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x31039f2e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 86.32885098457336, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 78.25, "ram_util_percent": 67.30000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.071928977966309, "actor_loss": -9.045175552368164, "critic_loss": 0.11442285776138306, "alpha_loss": -0.26902106404304504, "alpha_value": 0.9736436009407043, "log_alpha_value": -0.026709984987974167, "target_entropy": -6.0, "policy_t": -0.06061382591724396, "mean_q": 4.9417829513549805, "max_q": 5.1568603515625, "min_q": 3.419494152069092}, "td_error": [2.3011951446533203, 0.7707560062408447, 1.2374651432037354, 1.7747316360473633, 0.9633150100708008, 0.9527990818023682, 1.7968871593475342, 1.7729661464691162, 0.03265690803527832, 0.8973672389984131, 1.3691864013671875, 0.23502039909362793, 1.1047248840332031, 0.5086359977722168, 1.5932362079620361, 0.42006826400756836, 2.7618820667266846, 1.8067665100097656, 0.7156157493591309, 0.4207141399383545, 1.944014072418213, 1.9294648170471191, 0.24419403076171875, 0.4382314682006836, 1.038583755493164, 0.7126893997192383, 1.5290677547454834, 0.33562755584716797, 1.6329834461212158, 0.12059879302978516, 1.4382431507110596, 0.04937934875488281, 0.0035538673400878906, 0.3733351230621338, 0.466890811920166, 0.13188719749450684, 0.7810530662536621, 0.2502751350402832, 0.14197278022766113, 1.5052599906921387, 1.902400016784668, 0.3988504409790039, 1.3313333988189697, 0.20240020751953125, 1.5210182666778564, 1.5718767642974854, 1.2153751850128174, 0.2218632698059082, 0.043787479400634766, 1.3911147117614746, 1.6388864517211914, 0.06536436080932617, 1.551067590713501, 0.9787070751190186, 0.32485032081604004, 0.19026565551757812, 0.8505668640136719, 0.17772746086120605, 0.032685279846191406, 0.4294240474700928, 1.0831646919250488, 1.1879363059997559, 0.22699809074401855, 0.8013873100280762, 0.7752377986907959, 0.2558560371398926, 1.5323340892791748, 0.13548064231872559, 0.8093667030334473, 2.2906723022460938, 0.08943819999694824, 0.35643625259399414, 0.6013650894165039, 0.4445610046386719, 0.9988088607788086, 1.6197199821472168, 2.4134442806243896, 1.516627550125122, 1.1729145050048828, 1.6659934520721436, 0.42403602600097656, 1.262303352355957, 0.5201358795166016, 0.022451162338256836, 1.152374029159546, 0.6153304576873779], "mean_td_error": 0.9129911661148071, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 90.0, "diff_num_grad_updates_vs_sampler_policy": 89.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.995492935180664, "actor_loss": -6.652229309082031, "critic_loss": 0.13640929758548737, "alpha_loss": -0.2667946517467499, "alpha_value": 0.9736616015434265, "log_alpha_value": -0.02669149823486805, "target_entropy": -6.0, "policy_t": -0.05678559094667435, "mean_q": 2.7150819301605225, "max_q": 2.7982115745544434, "min_q": 2.194289207458496}, "td_error": [1.508860468864441, 1.106229305267334, 1.0110810995101929, 0.8542029857635498, 1.2955200672149658, 0.7472646236419678, 0.7171292304992676, 1.762373924255371, 0.6820287704467773, 1.1543055772781372, 1.3363759517669678, 0.655250072479248, 0.012581944465637207, 1.753868579864502, 0.5337396860122681, 1.2416409254074097, 0.6751480102539062, 0.8742287158966064, 0.04307913780212402, 0.48038744926452637, 0.551039457321167, 0.9637953042984009, 0.6438566446304321, 0.5079869031906128, 0.7472113370895386, 0.1962214708328247, 0.3682512044906616, 0.8234690427780151, 0.15072107315063477, 1.5986144542694092, 0.4146285057067871, 0.0485682487487793, 0.09135961532592773, 0.5741826295852661, 0.9411466121673584, 0.496970534324646, 0.3301318883895874, 0.5925509929656982, 0.6855059862136841, 0.17130303382873535, 0.798234224319458, 0.2701530456542969, 0.14062297344207764, 0.5642633438110352, 0.04696238040924072, 0.706002950668335, 0.9070519208908081, 1.0385388135910034, 0.5260840654373169, 0.2481212615966797, 0.6918870210647583, 1.5945454835891724, 1.282700538635254, 1.1414134502410889, 0.2885793447494507, 1.0990209579467773, 0.7111060619354248, 2.2375662326812744, 0.4580378532409668, 1.0325278043746948, 0.45859861373901367, 2.2517473697662354, 0.4356100559234619, 0.28211915493011475, 0.28062963485717773, 1.3121669292449951, 1.2099673748016357, 0.18272638320922852, 0.233132004737854, 0.3377723693847656, 0.825393557548523, 2.6199538707733154, 1.958045482635498, 1.6339671611785889, 3.638333320617676, 0.06689941883087158, 0.4106243848800659, 1.1274815797805786, 1.7642196416854858, 0.9836732149124146, 0.16135478019714355, 0.9310578107833862, 1.2698556184768677, 1.3068344593048096, 0.9317492246627808, 1.1382206678390503], "mean_td_error": 0.8474228382110596, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 90.0, "diff_num_grad_updates_vs_sampler_policy": 89.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.086234092712402, "actor_loss": -6.67529296875, "critic_loss": 0.12227064371109009, "alpha_loss": -0.26934829354286194, "alpha_value": 0.9736488461494446, "log_alpha_value": -0.026704544201493263, "target_entropy": -6.0, "policy_t": -0.01921488530933857, "mean_q": 2.6427483558654785, "max_q": 2.7532472610473633, "min_q": 2.156900405883789}, "td_error": [0.2939714193344116, 1.0052635669708252, 2.325263023376465, 0.30797410011291504, 0.41542017459869385, 0.3882366418838501, 0.02885127067565918, 0.638822078704834, 0.3573857545852661, 0.3298368453979492, 1.694077491760254, 1.1529948711395264, 1.0868864059448242, 0.7595944404602051, 2.07759952545166, 1.7034204006195068, 0.7791726589202881, 0.7163203954696655, 1.4938714504241943, 1.063765525817871, 0.7058261632919312, 0.2773306369781494, 0.5333601236343384, 0.11574029922485352, 1.1696058511734009, 0.12418293952941895, 0.32778191566467285, 0.30970823764801025, 1.3552188873291016, 0.3308868408203125, 0.11404180526733398, 1.1713041067123413, 0.9789196252822876, 1.1132174730300903, 0.5425176620483398, 0.8063672780990601, 0.9226000308990479, 0.08079850673675537, 0.2703216075897217, 0.2560105323791504, 1.100892186164856, 0.9774508476257324, 0.10554957389831543, 0.17004835605621338, 0.3796072006225586, 0.08452713489532471, 0.9780468940734863, 0.11796224117279053, 0.8521561622619629, 0.4201958179473877, 1.358201026916504, 0.4930863380432129, 0.10622823238372803, 1.1100289821624756, 1.365786075592041, 0.3192027807235718, 0.1441211700439453, 0.2884865999221802, 2.4566612243652344, 1.5324627161026, 0.02522444725036621, 0.99433434009552, 1.3199856281280518, 0.23505949974060059, 0.49946045875549316, 0.07917952537536621, 0.4400768280029297, 0.8170034885406494, 0.778661847114563, 0.7448683977127075, 0.09372210502624512, 0.11152493953704834, 1.2338392734527588, 0.7366863489151001, 0.6863553524017334, 1.1531803607940674, 1.5250730514526367, 0.5137957334518433, 0.14211905002593994, 1.0596799850463867, 1.1431840658187866, 1.9778169393539429, 0.5940124988555908, 1.2519954442977905, 1.1914300918579102, 0.21507060527801514], "mean_td_error": 0.7447500824928284, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 90.0, "diff_num_grad_updates_vs_sampler_policy": 89.0}}, "num_env_steps_sampled": 81536, "num_env_steps_trained": 23220, "num_agent_steps_sampled": 244608, "num_agent_steps_trained": 23220, "last_target_update_ts": 81536, "num_target_updates": 90}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 244608, "num_agent_steps_trained": 23220, "num_env_steps_sampled": 81536, "num_env_steps_trained": 23220, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 633.1546490268487, "num_env_steps_trained_throughput_per_sec": 182.31461992067742, "timesteps_total": 81536, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 244608, "timers": {"training_iteration_time_ms": 1085.999, "sample_time_ms": 766.326, "load_time_ms": 0.322, "load_throughput": 801518.726, "learn_time_ms": 18.57, "learn_throughput": 13893.702, "synch_weights_time_ms": 10.737}, "counters": {"num_env_steps_sampled": 81536, "num_env_steps_trained": 23220, "num_agent_steps_sampled": 244608, "num_agent_steps_trained": 23220, "last_target_update_ts": 81536, "num_target_updates": 90}, "done": false, "episodes_total": 0, "training_iteration": 52, "trial_id": "7066a_00000", "date": "2023-11-18_21-08-24", "timestamp": 1700370504, "time_this_iter_s": 1.4236998558044434, "time_total_s": 87.75255084037781, "pid": 7187, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x3124687c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 87.75255084037781, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 65.75, "ram_util_percent": 66.35}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.017849922180176, "actor_loss": -8.949468612670898, "critic_loss": 0.12526319921016693, "alpha_loss": -0.2735668420791626, "alpha_value": 0.9730615615844727, "log_alpha_value": -0.027307942509651184, "target_entropy": -6.0, "policy_t": -0.09284781664609909, "mean_q": 4.80673885345459, "max_q": 5.141195297241211, "min_q": 3.01821231842041}, "td_error": [1.070145845413208, 0.012040376663208008, 0.22042131423950195, 0.40339064598083496, 1.1184897422790527, 0.8256490230560303, 0.2368612289428711, 1.3628170490264893, 0.3805522918701172, 0.6553544998168945, 0.15601634979248047, 0.07262682914733887, 2.6595661640167236, 1.736098289489746, 0.043409109115600586, 0.4025113582611084, 0.5295834541320801, 0.3939242362976074, 0.6667501926422119, 1.3844029903411865, 0.7323586940765381, 0.7798867225646973, 0.5997529029846191, 0.9745216369628906, 1.1565229892730713, 1.3120663166046143, 0.41164183616638184, 0.6352267265319824, 1.7583670616149902, 1.5845320224761963, 1.5705273151397705, 1.867509365081787, 1.0431127548217773, 0.4613041877746582, 0.06570649147033691, 0.5486416816711426, 0.8810243606567383, 0.21286535263061523, 0.5478672981262207, 0.5993108749389648, 2.0787439346313477, 0.29361629486083984, 0.6027766466140747, 0.29035449028015137, 1.631746768951416, 1.8297040462493896, 0.17248058319091797, 1.3280411958694458, 0.2267458438873291, 1.5858383178710938, 2.101968288421631, 0.18724846839904785, 0.853294849395752, 0.8050575256347656, 0.8852179050445557, 0.49337315559387207, 1.8882651329040527, 0.7803318500518799, 0.7189676761627197, 0.38492631912231445, 3.626552104949951, 1.6043918132781982, 1.524656057357788, 1.925048828125, 0.42833876609802246, 0.9016463756561279, 1.0443718433380127, 0.5310797691345215, 0.5863742828369141, 2.504607915878296, 2.1141743659973145, 1.9456849098205566, 1.535857915878296, 1.501932144165039, 0.22239923477172852, 1.3075041770935059, 0.9328229427337646, 2.5419552326202393, 0.36479663848876953, 0.5554068088531494, 0.4630310535430908, 2.1247408390045166, 0.4001598358154297, 0.7405025959014893, 1.8298265933990479, 0.20103907585144043], "mean_td_error": 0.9845460653305054, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 92.0, "diff_num_grad_updates_vs_sampler_policy": 91.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.134272575378418, "actor_loss": -6.7017693519592285, "critic_loss": 0.17280477285385132, "alpha_loss": -0.27656999230384827, "alpha_value": 0.9730784296989441, "log_alpha_value": -0.02729056403040886, "target_entropy": -6.0, "policy_t": 0.013308259658515453, "mean_q": 2.700782537460327, "max_q": 2.7772104740142822, "min_q": 2.0710344314575195}, "td_error": [0.42734014987945557, 0.4445037841796875, 0.4704974889755249, 1.219858169555664, 2.0858139991760254, 0.9503111839294434, 1.485406517982483, 0.3288031816482544, 1.3784188032150269, 0.5996572971343994, 1.1526451110839844, 0.6804249286651611, 1.2345720529556274, 0.8991786241531372, 0.4319138526916504, 1.0950486660003662, 2.3496718406677246, 0.6367462873458862, 1.1929950714111328, 0.8846279382705688, 0.8036987781524658, 1.4335074424743652, 0.2630801200866699, 1.4785500764846802, 2.45173716545105, 0.603546142578125, 2.531616687774658, 0.06412351131439209, 0.19946372509002686, 0.9993870258331299, 0.7334778308868408, 1.5810811519622803, 0.21187710762023926, 0.7255102396011353, 0.7193338871002197, 1.0794172286987305, 0.9370183944702148, 2.5784108638763428, 0.9376041889190674, 0.300373911857605, 0.7807382345199585, 0.7202152013778687, 0.34043264389038086, 0.23048746585845947, 1.6981301307678223, 1.5474296808242798, 0.7314109802246094, 0.1816093921661377, 2.081664562225342, 0.07318294048309326, 2.0933282375335693, 0.6760284900665283, 0.2691274881362915, 1.087499737739563, 0.5646699666976929, 0.019255518913269043, 0.6243796348571777, 0.9527995586395264, 1.0794525146484375, 1.406199336051941, 0.8616899251937866, 0.3097914457321167, 1.0726474523544312, 0.05399680137634277, 1.4451593160629272, 0.1972646713256836, 0.8784626722335815, 0.8437806367874146, 1.30812668800354, 0.3574707508087158, 1.1750211715698242, 0.6187536716461182, 0.4266774654388428, 0.4303518533706665, 2.105496406555176, 0.8716628551483154, 1.2180299758911133, 0.28347694873809814, 1.32548987865448, 0.4484504461288452, 2.2369637489318848, 1.8327664136886597, 1.5220201015472412, 1.6961323022842407, 2.9357166290283203, 0.1839601993560791], "mean_td_error": 0.9811472296714783, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 92.0, "diff_num_grad_updates_vs_sampler_policy": 91.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.085700988769531, "actor_loss": -6.648744583129883, "critic_loss": 0.14146213233470917, "alpha_loss": -0.27537617087364197, "alpha_value": 0.9730657339096069, "log_alpha_value": -0.027303623035550117, "target_entropy": -6.0, "policy_t": -0.020745784044265747, "mean_q": 2.646597146987915, "max_q": 2.740722179412842, "min_q": 2.3504061698913574}, "td_error": [0.964645504951477, 0.2142326831817627, 2.260277271270752, 1.301933765411377, 0.2795664072036743, 2.2225916385650635, 0.5862873792648315, 0.49993467330932617, 0.6665847301483154, 0.010805487632751465, 0.9085901975631714, 0.33131706714630127, 0.9820970296859741, 0.8628853559494019, 0.025213956832885742, 0.3219742774963379, 0.6345692873001099, 0.6630921363830566, 0.14883816242218018, 0.2683144807815552, 1.7965118885040283, 0.8632371425628662, 0.5141962766647339, 0.9136824607849121, 0.5630919933319092, 0.8948723077774048, 0.3592400550842285, 0.15726768970489502, 0.6198629140853882, 0.343015193939209, 0.8499289751052856, 0.9019489288330078, 0.7906323671340942, 0.297204852104187, 0.06971228122711182, 1.4009759426116943, 1.2435004711151123, 0.18425703048706055, 0.06876575946807861, 0.7917922735214233, 0.5083969831466675, 0.8466916084289551, 0.4194149971008301, 0.19205522537231445, 0.9221711158752441, 2.210153818130493, 0.9248700141906738, 1.722196340560913, 0.7669382095336914, 1.8430291414260864, 1.0656120777130127, 0.5891872644424438, 0.47944962978363037, 0.25139153003692627, 0.7264348268508911, 1.5288833379745483, 0.13719892501831055, 0.270153284072876, 0.5595488548278809, 0.8331735134124756, 0.25110912322998047, 0.3532191514968872, 1.8160022497177124, 2.936713457107544, 0.08302712440490723, 1.1836779117584229, 0.14372992515563965, 1.0199275016784668, 0.17853784561157227, 0.8681677579879761, 0.5556564331054688, 0.6937209367752075, 1.3822360038757324, 1.6121448278427124, 2.131674289703369, 2.569828987121582, 1.4483222961425781, 0.654822826385498, 0.38436973094940186, 0.038811683654785156, 2.338475465774536, 0.8556140661239624, 0.15323472023010254, 1.0210702419281006, 0.801193118095398, 0.25931358337402344], "mean_td_error": 0.8175466060638428, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 92.0, "diff_num_grad_updates_vs_sampler_policy": 91.0}}, "num_env_steps_sampled": 83328, "num_env_steps_trained": 23736, "num_agent_steps_sampled": 249984, "num_agent_steps_trained": 23736, "last_target_update_ts": 83328, "num_target_updates": 92}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 249984, "num_agent_steps_trained": 23736, "num_env_steps_sampled": 83328, "num_env_steps_trained": 23736, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 989.5964388081436, "num_env_steps_trained_throughput_per_sec": 284.9507602818092, "timesteps_total": 83328, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 249984, "timers": {"training_iteration_time_ms": 1083.155, "sample_time_ms": 760.685, "load_time_ms": 0.324, "load_throughput": 795801.171, "learn_time_ms": 18.733, "learn_throughput": 13772.662, "synch_weights_time_ms": 10.774}, "counters": {"num_env_steps_sampled": 83328, "num_env_steps_trained": 23736, "num_agent_steps_sampled": 249984, "num_agent_steps_trained": 23736, "last_target_update_ts": 83328, "num_target_updates": 92}, "done": false, "episodes_total": 0, "training_iteration": 53, "trial_id": "7066a_00000", "date": "2023-11-18_21-08-26", "timestamp": 1700370506, "time_this_iter_s": 1.8202149868011475, "time_total_s": 89.57276582717896, "pid": 7187, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x312468f40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 89.57276582717896, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 73.25, "ram_util_percent": 66.05}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.97461986541748, "actor_loss": -8.947314262390137, "critic_loss": 0.1118946224451065, "alpha_loss": -0.27834880352020264, "alpha_value": 0.972480058670044, "log_alpha_value": -0.02790570631623268, "target_entropy": -6.0, "policy_t": -0.10738006234169006, "mean_q": 4.854443073272705, "max_q": 5.118969917297363, "min_q": 2.866132974624634}, "td_error": [0.1826004981994629, 1.6767175197601318, 1.0288150310516357, 1.9826011657714844, 1.6484951972961426, 0.8057570457458496, 0.7187113761901855, 0.4449729919433594, 0.1445014476776123, 0.06000995635986328, 0.893867015838623, 0.48960208892822266, 0.3510096073150635, 0.6361832618713379, 2.275949716567993, 1.1989991664886475, 0.15548062324523926, 3.4065189361572266, 1.4123389720916748, 0.16964125633239746, 0.03944969177246094, 0.3629417419433594, 0.1388394832611084, 0.04862546920776367, 1.4566230773925781, 0.5007519721984863, 2.0051286220550537, 1.7863209247589111, 0.48689866065979004, 0.39548492431640625, 1.9054365158081055, 0.5750296115875244, 0.2688028812408447, 0.6148955821990967, 0.8033649921417236, 1.2442882061004639, 1.2731399536132812, 0.059970855712890625, 0.16690587997436523, 1.6172893047332764, 1.7275006771087646, 0.9402012825012207, 1.1652052402496338, 0.5696120262145996, 0.363940954208374, 1.7586607933044434, 0.794893741607666, 0.8888225555419922, 0.5793304443359375, 0.5467698574066162, 0.4903583526611328, 1.0098814964294434, 2.022261381149292, 0.6833040714263916, 2.23443341255188, 0.16889739036560059, 1.1543638706207275, 0.46414971351623535, 0.9488120079040527, 0.7660274505615234, 0.6135716438293457, 0.1740703582763672, 1.7754197120666504, 1.166743278503418, 3.319674015045166, 0.24068331718444824, 0.05300569534301758, 0.9227607250213623, 0.6345775127410889, 0.579535722732544, 0.8027715682983398, 0.02999401092529297, 0.9302902221679688, 1.6474623680114746, 0.5510015487670898, 1.4712300300598145, 1.2508926391601562, 1.548112392425537, 0.7056388854980469, 1.174988031387329, 0.43184852600097656, 1.128204584121704, 0.6541738510131836, 0.2138361930847168, 0.13616681098937988, 2.3915035724639893], "mean_td_error": 0.9216110110282898, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 94.0, "diff_num_grad_updates_vs_sampler_policy": 93.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.952290534973145, "actor_loss": -6.565342903137207, "critic_loss": 0.16661876440048218, "alpha_loss": -0.27756765484809875, "alpha_value": 0.9724954962730408, "log_alpha_value": -0.027889825403690338, "target_entropy": -6.0, "policy_t": -0.04740697145462036, "mean_q": 2.666588544845581, "max_q": 2.753803253173828, "min_q": 2.172773838043213}, "td_error": [0.5037528276443481, 0.2513788938522339, 1.768397331237793, 1.8448941707611084, 0.2899566888809204, 1.1100126504898071, 2.167332649230957, 0.536819577217102, 0.7439390420913696, 0.5978726148605347, 1.8342492580413818, 0.8660352230072021, 0.09621655941009521, 0.08144450187683105, 1.5403982400894165, 0.6490094661712646, 1.209484577178955, 0.7054378986358643, 0.24130916595458984, 0.749679684638977, 0.8396209478378296, 0.2390228509902954, 2.482288360595703, 1.4610618352890015, 0.4369131326675415, 1.498368501663208, 1.74834144115448, 0.7673946619033813, 2.553497314453125, 0.5050246715545654, 0.9661357402801514, 0.7498352527618408, 0.142716646194458, 1.856447458267212, 0.9561644792556763, 0.8912625312805176, 0.3911151885986328, 1.873497724533081, 0.5672894716262817, 1.0109964609146118, 1.3822728395462036, 0.3225514888763428, 0.4437828063964844, 0.6325128078460693, 1.802370548248291, 1.1762306690216064, 1.894608497619629, 0.22928476333618164, 0.2502419948577881, 0.6383969783782959, 1.1969410181045532, 0.6109262704849243, 1.3295044898986816, 0.8868408203125, 3.30526065826416, 0.5946834087371826, 1.1444737911224365, 0.6062170267105103, 0.9452459812164307, 1.7030916213989258, 0.10207390785217285, 0.4949086904525757, 0.4983370304107666, 1.397355079650879, 0.38690876960754395, 0.27958381175994873, 1.0548417568206787, 1.1614570617675781, 1.9721136093139648, 0.7931622266769409, 1.5958225727081299, 0.9470514059066772, 0.14090991020202637, 2.53818941116333, 0.15563905239105225, 0.25744175910949707, 0.5573487281799316, 2.2758021354675293, 0.00865638256072998, 0.48738348484039307, 0.8008878231048584, 0.22152280807495117, 1.2037397623062134, 0.6265524625778198, 0.8485977649688721, 0.14197421073913574], "mean_td_error": 0.9507942795753479, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 94.0, "diff_num_grad_updates_vs_sampler_policy": 93.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.984556198120117, "actor_loss": -6.596004009246826, "critic_loss": 0.10498514771461487, "alpha_loss": -0.2785983383655548, "alpha_value": 0.9724827408790588, "log_alpha_value": -0.02790292724967003, "target_entropy": -6.0, "policy_t": -0.04124613478779793, "mean_q": 2.6447508335113525, "max_q": 3.574108362197876, "min_q": 2.233342170715332}, "td_error": [0.2539786100387573, 0.783393383026123, 1.6161017417907715, 0.13439702987670898, 0.5589405298233032, 0.7627509832382202, 0.0196990966796875, 0.4364302158355713, 3.624725818634033, 1.995251178741455, 0.8227131366729736, 0.8978108167648315, 0.3813457489013672, 0.2482074499130249, 1.0953601598739624, 0.1053551435470581, 0.8323817253112793, 0.21935617923736572, 0.20853805541992188, 1.1591569185256958, 0.38445281982421875, 0.8761931657791138, 1.494760513305664, 1.5523252487182617, 1.666200041770935, 2.4362730979919434, 0.8019481897354126, 0.5535025596618652, 0.042615413665771484, 0.3196299076080322, 1.1810381412506104, 1.030845046043396, 0.10858464241027832, 0.4834434986114502, 0.24564754962921143, 0.6146800518035889, 0.7213586568832397, 1.6698647737503052, 1.837926983833313, 1.2478642463684082, 0.5019605159759521, 0.34953248500823975, 0.621822714805603, 1.2564373016357422, 0.15251171588897705, 0.206329345703125, 0.17898094654083252, 1.0341914892196655, 0.7050844430923462, 0.0803227424621582, 1.6924519538879395, 0.8116358518600464, 0.07672548294067383, 2.0495681762695312, 0.2401202917098999, 0.5656728744506836, 0.13166403770446777, 0.06453227996826172, 1.8052269220352173, 0.5960849523544312, 1.0344432592391968, 2.2054522037506104, 0.40043771266937256, 0.5853335857391357, 1.1482369899749756, 1.9449894428253174, 0.9396772384643555, 0.7480559349060059, 0.6293383836746216, 0.24832892417907715, 0.9278167486190796, 0.9033143520355225, 0.08982992172241211, 0.5842956304550171, 0.2928735017776489, 0.34889209270477295, 0.8305767774581909, 1.0001931190490723, 0.5875777006149292, 0.1248859167098999, 1.0227339267730713, 1.917688250541687, 0.04951882362365723, 0.08698010444641113, 0.3503812551498413, 0.22928452491760254], "mean_td_error": 0.7881050705909729, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 94.0, "diff_num_grad_updates_vs_sampler_policy": 93.0}}, "num_env_steps_sampled": 85120, "num_env_steps_trained": 24252, "num_agent_steps_sampled": 255360, "num_agent_steps_trained": 24252, "last_target_update_ts": 85120, "num_target_updates": 94}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 255360, "num_agent_steps_trained": 24252, "num_env_steps_sampled": 85120, "num_env_steps_trained": 24252, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 959.0492600032486, "num_env_steps_trained_throughput_per_sec": 276.1548092420069, "timesteps_total": 85120, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 255360, "timers": {"training_iteration_time_ms": 1027.399, "sample_time_ms": 707.993, "load_time_ms": 0.314, "load_throughput": 821351.372, "learn_time_ms": 18.302, "learn_throughput": 14096.83, "synch_weights_time_ms": 10.889}, "counters": {"num_env_steps_sampled": 85120, "num_env_steps_trained": 24252, "num_agent_steps_sampled": 255360, "num_agent_steps_trained": 24252, "last_target_update_ts": 85120, "num_target_updates": 94}, "done": false, "episodes_total": 0, "training_iteration": 54, "trial_id": "7066a_00000", "date": "2023-11-18_21-08-28", "timestamp": 1700370508, "time_this_iter_s": 1.878960132598877, "time_total_s": 91.45172595977783, "pid": 7187, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x31246b6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 91.45172595977783, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 74.13333333333333, "ram_util_percent": 65.86666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.893661499023438, "actor_loss": -8.883909225463867, "critic_loss": 0.09682973474264145, "alpha_loss": -0.27904489636421204, "alpha_value": 0.9721896052360535, "log_alpha_value": -0.028204411268234253, "target_entropy": -6.0, "policy_t": -0.11112189292907715, "mean_q": 4.7660393714904785, "max_q": 5.0982537269592285, "min_q": 2.8127548694610596}, "td_error": [0.029629945755004883, 0.1511693000793457, 2.183793544769287, 0.8695881366729736, 0.46222829818725586, 0.25606632232666016, 1.0867528915405273, 2.5697343349456787, 0.22406744956970215, 0.8938999176025391, 0.19903326034545898, 0.5910847187042236, 0.687575101852417, 0.08218526840209961, 1.645094633102417, 1.5428707599639893, 0.6966948509216309, 0.6778671741485596, 2.2913966178894043, 0.022360563278198242, 0.4820833206176758, 0.3644139766693115, 0.39008045196533203, 0.1577897071838379, 0.7098422050476074, 1.4036214351654053, 1.4004197120666504, 0.43741464614868164, 1.058450698852539, 0.8969964981079102, 0.9781949520111084, 0.8837454319000244, 0.7121686935424805, 1.4571418762207031, 0.01454615592956543, 1.2908406257629395, 1.2177364826202393, 0.07361459732055664, 1.359105110168457, 1.0789451599121094, 0.829010009765625, 2.7276504039764404, 1.3172862529754639, 0.3043956756591797, 1.0674970149993896, 0.9362709522247314, 1.1346518993377686, 0.4724278450012207, 0.10624504089355469, 0.019868135452270508, 0.38063669204711914, 0.9884040355682373, 0.02195143699645996, 1.8396673202514648, 0.575298547744751, 2.1406455039978027, 0.38805603981018066, 0.7819538116455078, 1.2566232681274414, 0.13553571701049805, 0.12686824798583984, 0.4183228015899658, 1.0116469860076904, 0.18014311790466309, 0.7632732391357422, 0.7515420913696289, 2.1440322399139404, 2.2734642028808594, 0.6457139253616333, 0.5823493003845215, 0.6250255107879639, 0.7537903785705566, 0.8359310626983643, 1.473268747329712, 0.14148521423339844, 0.07661271095275879, 0.362870454788208, 0.18237781524658203, 1.1644179821014404, 0.4825131893157959, 0.25379180908203125, 0.8858535289764404, 0.0690450668334961, 0.9989902973175049, 3.055081844329834, 0.28032445907592773], "mean_td_error": 0.8313146233558655, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 95.0, "diff_num_grad_updates_vs_sampler_policy": 94.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.043856620788574, "actor_loss": -6.609790325164795, "critic_loss": 0.14814013242721558, "alpha_loss": -0.28312745690345764, "alpha_value": 0.9722045063972473, "log_alpha_value": -0.028189117088913918, "target_entropy": -6.0, "policy_t": -0.04817855730652809, "mean_q": 2.6416115760803223, "max_q": 3.2416958808898926, "min_q": 2.0833020210266113}, "td_error": [1.3518877029418945, 1.4089370965957642, 1.2069501876831055, 1.6360794305801392, 0.17677736282348633, 0.5978121757507324, 0.5561783313751221, 0.912102460861206, 0.05685389041900635, 1.0841950178146362, 1.1157852411270142, 0.6186549663543701, 1.020378589630127, 1.423179030418396, 1.4675132036209106, 1.0047358274459839, 0.3268427848815918, 0.14610207080841064, 0.31705784797668457, 1.5934257507324219, 2.109222412109375, 0.4689981937408447, 2.0006611347198486, 0.0058438777923583984, 0.6187777519226074, 2.9624946117401123, 0.6483575105667114, 1.8481318950653076, 0.9062560796737671, 1.0338103771209717, 0.22536325454711914, 0.22267329692840576, 0.750983476638794, 0.24188363552093506, 1.025869369506836, 0.7655881643295288, 0.08022463321685791, 1.9323232173919678, 0.32193470001220703, 1.0280375480651855, 1.074798822402954, 0.31995582580566406, 0.6226019859313965, 0.9420840740203857, 0.8951246738433838, 1.6841548681259155, 0.059850335121154785, 0.7123072147369385, 1.4156012535095215, 1.0155164003372192, 2.006357431411743, 2.0643835067749023, 0.17036223411560059, 0.42474961280822754, 2.495584011077881, 0.9183957576751709, 0.8048419952392578, 0.6739093065261841, 0.49670279026031494, 0.9022822380065918, 0.06057143211364746, 0.3423982858657837, 1.1499769687652588, 0.8662421703338623, 1.710334062576294, 0.3779517412185669, 0.04015994071960449, 0.25699174404144287, 0.792204737663269, 0.5987118482589722, 0.49411511421203613, 1.05842924118042, 0.3667614459991455, 0.8226444721221924, 0.9565188884735107, 0.46448278427124023, 0.6440894603729248, 0.21205627918243408, 1.4574024677276611, 0.01889622211456299, 1.3666476011276245, 0.8116223812103271, 1.3366901874542236, 0.07560873031616211, 1.5136703252792358, 0.6740996837615967], "mean_td_error": 0.8766014575958252, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 95.0, "diff_num_grad_updates_vs_sampler_policy": 94.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.109304428100586, "actor_loss": -6.6557297706604, "critic_loss": 0.1000840812921524, "alpha_loss": -0.28510645031929016, "alpha_value": 0.972191572189331, "log_alpha_value": -0.028202379122376442, "target_entropy": -6.0, "policy_t": -0.023805098608136177, "mean_q": 2.640538454055786, "max_q": 3.0266265869140625, "min_q": 2.5834031105041504}, "td_error": [0.07266712188720703, 0.5343563556671143, 0.0158689022064209, 0.11293399333953857, 0.028356313705444336, 0.3292914628982544, 1.9810864925384521, 1.2584197521209717, 0.37935590744018555, 0.9835950136184692, 0.31037187576293945, 0.2786552906036377, 1.16853666305542, 0.6099725961685181, 1.5676870346069336, 0.7447758913040161, 0.0051735639572143555, 0.07631540298461914, 0.75749671459198, 0.8540831804275513, 0.015812039375305176, 0.49693727493286133, 0.2854348421096802, 2.394106388092041, 1.5224721431732178, 0.30993950366973877, 1.3759973049163818, 0.5203372240066528, 0.5738201141357422, 0.28259873390197754, 0.878257155418396, 1.047864317893982, 2.277165412902832, 1.365218997001648, 0.1812812089920044, 0.051146626472473145, 0.4172213077545166, 0.6020931005477905, 1.0753591060638428, 0.809599757194519, 0.1978771686553955, 0.7120736837387085, 0.2220536470413208, 1.9338732957839966, 0.6817097663879395, 1.8022260665893555, 0.9674301147460938, 0.035535454750061035, 1.4344367980957031, 0.4181877374649048, 0.6196058988571167, 2.2468557357788086, 0.5815500020980835, 0.4116201400756836, 0.8165794610977173, 0.5496084690093994, 0.27271437644958496, 0.5566457509994507, 0.9120609760284424, 0.40384602546691895, 0.5249388217926025, 0.4661445617675781, 1.8835068941116333, 0.8256332874298096, 1.151350498199463, 0.5342739820480347, 0.19927048683166504, 0.8062731027603149, 0.4128296375274658, 0.8058114051818848, 0.8169002532958984, 0.33149123191833496, 0.4624969959259033, 0.3130837678909302, 1.2575476169586182, 0.9056370258331299, 0.38222670555114746, 1.529636025428772, 0.9482918977737427, 2.5632433891296387, 0.1002955436706543, 1.818521499633789, 0.6465022563934326, 0.20796418190002441, 1.8376753330230713, 0.4399000406265259], "mean_td_error": 0.7732511758804321, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 95.0, "diff_num_grad_updates_vs_sampler_policy": 94.0}}, "num_env_steps_sampled": 86016, "num_env_steps_trained": 24510, "num_agent_steps_sampled": 258048, "num_agent_steps_trained": 24510, "last_target_update_ts": 86016, "num_target_updates": 95}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 258048, "num_agent_steps_trained": 24510, "num_env_steps_sampled": 86016, "num_env_steps_trained": 24510, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 859.8849879555123, "num_env_steps_trained_throughput_per_sec": 247.60081126397563, "timesteps_total": 86016, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 258048, "timers": {"training_iteration_time_ms": 1032.017, "sample_time_ms": 712.359, "load_time_ms": 0.316, "load_throughput": 816209.407, "learn_time_ms": 18.268, "learn_throughput": 14123.213, "synch_weights_time_ms": 10.998}, "counters": {"num_env_steps_sampled": 86016, "num_env_steps_trained": 24510, "num_agent_steps_sampled": 258048, "num_agent_steps_trained": 24510, "last_target_update_ts": 86016, "num_target_updates": 95}, "done": false, "episodes_total": 0, "training_iteration": 55, "trial_id": "7066a_00000", "date": "2023-11-18_21-08-29", "timestamp": 1700370509, "time_this_iter_s": 1.0514750480651855, "time_total_s": 92.50320100784302, "pid": 7187, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x31039e020>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 92.50320100784302, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 67.35, "ram_util_percent": 66.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.893026351928711, "actor_loss": -8.798298835754395, "critic_loss": 0.1196722537279129, "alpha_loss": -0.2849302887916565, "alpha_value": 0.9716096520423889, "log_alpha_value": -0.028801124542951584, "target_entropy": -6.0, "policy_t": -0.11733779311180115, "mean_q": 4.813763618469238, "max_q": 5.051593780517578, "min_q": 3.0122110843658447}, "td_error": [0.4064260721206665, 0.6082072257995605, 1.3704807758331299, 1.3187572956085205, 0.6273126602172852, 2.242875814437866, 0.11701297760009766, 0.1687607765197754, 0.23981285095214844, 0.5159766674041748, 1.3408911228179932, 1.6918888092041016, 0.5166387557983398, 0.43253159523010254, 0.946232795715332, 0.2362654209136963, 2.2911200523376465, 0.30704331398010254, 0.8258414268493652, 0.5748109817504883, 1.763129711151123, 0.25701379776000977, 0.3902168273925781, 1.2519218921661377, 0.1721491813659668, 1.9210619926452637, 2.1422080993652344, 0.6130313873291016, 1.3281140327453613, 0.47359514236450195, 1.6865041255950928, 0.7337384223937988, 2.04580020904541, 0.26370906829833984, 0.4917128086090088, 1.9469490051269531, 1.630997896194458, 0.713580846786499, 2.237924575805664, 0.2179088592529297, 0.21322941780090332, 1.3758447170257568, 0.3861844539642334, 0.03916311264038086, 2.3089587688446045, 0.052507877349853516, 1.0892648696899414, 1.6808114051818848, 0.8793489933013916, 1.3911361694335938, 1.7990045547485352, 0.24782776832580566, 1.0317087173461914, 0.4829990863800049, 1.207282543182373, 0.5375585556030273, 1.5322747230529785, 1.5563933849334717, 1.4098360538482666, 0.7940614223480225, 0.0460209846496582, 1.8626677989959717, 1.2243609428405762, 2.8137481212615967, 0.9169325828552246, 1.61368989944458, 0.3614006042480469, 1.1462159156799316, 0.8695940971374512, 0.5459578037261963, 0.6755213737487793, 0.9735031127929688, 1.5233898162841797, 0.20506048202514648, 1.7358996868133545, 0.48516392707824707, 0.15596914291381836, 0.5734972953796387, 0.9903943538665771, 0.24256253242492676, 1.0953567028045654, 0.6723637580871582, 0.3991391658782959, 0.27247190475463867, 0.48934149742126465, 1.521545648574829], "mean_td_error": 0.9591549038887024, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 97.0, "diff_num_grad_updates_vs_sampler_policy": 96.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.083255767822266, "actor_loss": -6.589284420013428, "critic_loss": 0.13472062349319458, "alpha_loss": -0.2902737855911255, "alpha_value": 0.9716227054595947, "log_alpha_value": -0.028787704184651375, "target_entropy": -6.0, "policy_t": -0.06055992469191551, "mean_q": 2.6194002628326416, "max_q": 3.089712619781494, "min_q": 2.115816831588745}, "td_error": [0.9480702877044678, 0.8000422716140747, 0.6248867511749268, 1.227635383605957, 0.2180541753768921, 1.0354779958724976, 2.1526732444763184, 0.38672125339508057, 1.401793360710144, 1.028799295425415, 0.07155990600585938, 0.9512271881103516, 0.4790787696838379, 0.299690842628479, 1.3812758922576904, 0.17829716205596924, 0.5599724054336548, 0.21609210968017578, 1.2482320070266724, 0.5029268264770508, 0.07110607624053955, 0.6982970237731934, 2.232391357421875, 1.6498957872390747, 0.005456686019897461, 0.9309322834014893, 0.6950312852859497, 2.002368927001953, 1.1080033779144287, 1.3988380432128906, 0.17917382717132568, 1.029500961303711, 2.05928373336792, 2.0969910621643066, 0.9240930080413818, 0.07530510425567627, 0.8891966342926025, 0.3993903398513794, 0.9157426357269287, 0.679397463798523, 0.21920621395111084, 1.0138096809387207, 2.8416733741760254, 0.005251049995422363, 1.1076266765594482, 2.787440538406372, 0.1407862901687622, 0.5101301670074463, 0.028666377067565918, 0.3973785638809204, 2.281923294067383, 0.6302679777145386, 1.1120691299438477, 1.036643147468567, 0.08251690864562988, 2.036731719970703, 0.9837751388549805, 0.5954749584197998, 0.9091987609863281, 0.31053149700164795, 0.5234088897705078, 0.5468848943710327, 1.3683785200119019, 0.3298851251602173, 0.5553171634674072, 0.638495683670044, 0.22966980934143066, 2.880323886871338, 1.446790337562561, 1.260264277458191, 1.594065546989441, 0.04918551445007324, 1.0355453491210938, 1.2958662509918213, 0.18986248970031738, 0.42898988723754883, 1.3703134059906006, 0.8777636289596558, 0.13019776344299316, 0.8771522045135498, 1.8243530988693237, 1.3834702968597412, 0.33705151081085205, 0.31790411472320557, 0.3873404264450073, 1.0590918064117432], "mean_td_error": 0.9037392139434814, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 97.0, "diff_num_grad_updates_vs_sampler_policy": 96.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.126808166503906, "actor_loss": -6.665745735168457, "critic_loss": 0.11932644248008728, "alpha_loss": -0.2916683256626129, "alpha_value": 0.9716092348098755, "log_alpha_value": -0.028801606968045235, "target_entropy": -6.0, "policy_t": -0.01162323821336031, "mean_q": 2.6383168697357178, "max_q": 3.5071067810058594, "min_q": 2.2853000164031982}, "td_error": [1.0370320081710815, 0.6992050409317017, 1.3488849401474, 2.4064080715179443, 0.5814409255981445, 0.7052390575408936, 3.5527327060699463, 0.5554455518722534, 0.6438281536102295, 1.0595805644989014, 0.9851351976394653, 0.149408221244812, 0.35379505157470703, 0.6110142469406128, 0.39520692825317383, 3.09464693069458, 0.658784031867981, 0.05189800262451172, 1.8690239191055298, 0.7718167304992676, 2.065551280975342, 0.3578556776046753, 1.259934902191162, 1.2602323293685913, 0.20898199081420898, 2.1541202068328857, 1.2756240367889404, 0.05942893028259277, 1.9499139785766602, 0.8242744207382202, 0.35719943046569824, 0.47228550910949707, 0.11033070087432861, 0.20991790294647217, 0.581428050994873, 0.20880842208862305, 1.2171064615249634, 0.7877005338668823, 0.17623865604400635, 0.40199947357177734, 0.3586435317993164, 0.20157504081726074, 0.4651983976364136, 1.2422446012496948, 0.34705305099487305, 1.1001267433166504, 0.1419464349746704, 0.7754839658737183, 0.11815404891967773, 1.0642955303192139, 0.47073209285736084, 0.691332221031189, 0.35329174995422363, 0.7545462846755981, 0.17923033237457275, 2.759671688079834, 0.08253848552703857, 0.9465994834899902, 0.6891293525695801, 0.018147706985473633, 0.6773555278778076, 0.08651447296142578, 0.7514611482620239, 1.0879892110824585, 0.18788301944732666, 1.6791809797286987, 0.59519362449646, 0.9189040660858154, 0.7823649644851685, 3.272517442703247, 1.0734803676605225, 0.30884695053100586, 0.007392406463623047, 0.7518937587738037, 2.201780319213867, 0.8587944507598877, 0.46758997440338135, 2.4738001823425293, 0.7383667230606079, 0.701040506362915, 0.6047862768173218, 0.5543041229248047, 0.557263970375061, 0.7216713428497314, 0.24560034275054932, 0.9277418851852417], "mean_td_error": 0.854222297668457, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 97.0, "diff_num_grad_updates_vs_sampler_policy": 96.0}}, "num_env_steps_sampled": 87808, "num_env_steps_trained": 25026, "num_agent_steps_sampled": 263424, "num_agent_steps_trained": 25026, "last_target_update_ts": 87808, "num_target_updates": 97}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 263424, "num_agent_steps_trained": 25026, "num_env_steps_sampled": 87808, "num_env_steps_trained": 25026, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 916.443579017882, "num_env_steps_trained_throughput_per_sec": 263.8866555654169, "timesteps_total": 87808, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 263424, "timers": {"training_iteration_time_ms": 1047.169, "sample_time_ms": 725.329, "load_time_ms": 0.319, "load_throughput": 809008.995, "learn_time_ms": 18.447, "learn_throughput": 13985.928, "synch_weights_time_ms": 10.972}, "counters": {"num_env_steps_sampled": 87808, "num_env_steps_trained": 25026, "num_agent_steps_sampled": 263424, "num_agent_steps_trained": 25026, "last_target_update_ts": 87808, "num_target_updates": 97}, "done": false, "episodes_total": 0, "training_iteration": 56, "trial_id": "7066a_00000", "date": "2023-11-18_21-08-31", "timestamp": 1700370511, "time_this_iter_s": 1.9660990238189697, "time_total_s": 94.46930003166199, "pid": 7187, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x31039f380>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 94.46930003166199, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 82.25, "ram_util_percent": 66.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.959124565124512, "actor_loss": -8.839795112609863, "critic_loss": 0.11809932440519333, "alpha_loss": -0.2898022532463074, "alpha_value": 0.9713201522827148, "log_alpha_value": -0.02909916825592518, "target_entropy": -6.0, "policy_t": -0.07553233951330185, "mean_q": 4.796920299530029, "max_q": 5.038517951965332, "min_q": 2.70735764503479}, "td_error": [0.16181039810180664, 0.5223445892333984, 0.5409245491027832, 2.1692452430725098, 2.3881914615631104, 1.1057560443878174, 2.1967034339904785, 0.7177071571350098, 0.27962350845336914, 0.28742218017578125, 0.15887737274169922, 0.794379472732544, 0.9768034219741821, 1.7084007263183594, 0.5688686370849609, 0.23061656951904297, 0.12704133987426758, 2.4707465171813965, 1.0144624710083008, 0.463489294052124, 0.7822825908660889, 0.09696459770202637, 1.1861565113067627, 2.0819761753082275, 1.3241028785705566, 0.9354128837585449, 1.6170616149902344, 0.366657018661499, 0.7473776340484619, 0.42259693145751953, 1.5261998176574707, 0.3772268295288086, 3.4915170669555664, 1.2600605487823486, 0.06685662269592285, 0.2399606704711914, 0.21961069107055664, 0.1706101894378662, 1.2692618370056152, 0.8930366039276123, 0.35347115993499756, 0.24725008010864258, 0.023741722106933594, 0.3993690013885498, 0.5333101749420166, 0.23902320861816406, 0.5535402297973633, 0.22183489799499512, 0.9046070575714111, 0.2902259826660156, 0.8885726928710938, 2.0207340717315674, 1.375722885131836, 1.55208158493042, 1.470599889755249, 0.059877872467041016, 1.0030746459960938, 0.26314830780029297, 0.5359237194061279, 0.7080914974212646, 1.6554934978485107, 0.7585408687591553, 1.5558769702911377, 1.0562357902526855, 1.1043121814727783, 0.4346342086791992, 2.098271131515503, 0.7518975734710693, 0.8609015941619873, 0.1504218578338623, 1.1071925163269043, 1.1449861526489258, 2.5157599449157715, 1.7863824367523193, 0.8949992656707764, 2.515878200531006, 1.5296440124511719, 0.025391340255737305, 1.742314100265503, 2.164569854736328, 0.8901338577270508, 0.4038662910461426, 0.04830455780029297, 0.2996772527694702, 0.5138568878173828, 0.31423091888427734], "mean_td_error": 0.9293757677078247, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 98.0, "diff_num_grad_updates_vs_sampler_policy": 97.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.047792434692383, "actor_loss": -6.544105052947998, "critic_loss": 0.14073210954666138, "alpha_loss": -0.2922610938549042, "alpha_value": 0.9713318347930908, "log_alpha_value": -0.02908710017800331, "target_entropy": -6.0, "policy_t": -0.06799104809761047, "mean_q": 2.655991792678833, "max_q": 3.5388619899749756, "min_q": 2.579763174057007}, "td_error": [0.8400070667266846, 1.6558165550231934, 0.9334568977355957, 0.1576603651046753, 1.7913769483566284, 0.15845263004302979, 0.1883171796798706, 0.6668993234634399, 1.8589107990264893, 1.536026120185852, 0.15760064125061035, 0.32117581367492676, 1.5745596885681152, 2.072648286819458, 0.19918763637542725, 1.1144946813583374, 0.8524036407470703, 0.6177961826324463, 1.3363077640533447, 1.0908229351043701, 0.740351676940918, 0.8486210107803345, 0.019098639488220215, 0.017173171043395996, 1.7634344100952148, 2.0600972175598145, 0.48014724254608154, 1.035839319229126, 0.11951553821563721, 0.40428972244262695, 0.8808963298797607, 0.9739797115325928, 0.08853805065155029, 0.5364404916763306, 1.012359619140625, 1.1582666635513306, 2.2308027744293213, 0.8954558372497559, 1.7553385496139526, 0.017154216766357422, 0.9023739099502563, 0.06704568862915039, 0.5718621015548706, 1.2179396152496338, 0.3435826301574707, 2.0724778175354004, 1.0265326499938965, 0.13464248180389404, 0.3051213026046753, 0.8008536100387573, 1.6269676685333252, 0.29923808574676514, 1.49823796749115, 1.4138613939285278, 1.742174744606018, 0.2442646026611328, 0.764445424079895, 0.5619058609008789, 1.3466424942016602, 1.276655673980713, 0.844794511795044, 1.6887052059173584, 1.3366873264312744, 0.24675893783569336, 0.9601109027862549, 0.17527985572814941, 1.8226381540298462, 1.2491669654846191, 0.4477236270904541, 1.446475625038147, 1.2055141925811768, 1.5607194900512695, 0.38228416442871094, 0.3725261688232422, 0.6471347808837891, 1.415008783340454, 0.17863094806671143, 0.004614591598510742, 2.8194022178649902, 0.10479974746704102, 0.3535304069519043, 1.618731141090393, 0.23666656017303467, 1.888558268547058, 1.4009308815002441, 0.05653238296508789], "mean_td_error": 0.9167729020118713, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 98.0, "diff_num_grad_updates_vs_sampler_policy": 97.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.025221824645996, "actor_loss": -6.600808620452881, "critic_loss": 0.12796266376972198, "alpha_loss": -0.2917480766773224, "alpha_value": 0.9713179469108582, "log_alpha_value": -0.029101410880684853, "target_entropy": -6.0, "policy_t": -0.04540599510073662, "mean_q": 2.6198673248291016, "max_q": 3.112135410308838, "min_q": 2.3547329902648926}, "td_error": [0.5559879541397095, 0.3790154457092285, 1.0261898040771484, 1.0858162641525269, 0.31679069995880127, 2.131169319152832, 0.03197062015533447, 0.5585827827453613, 1.7786407470703125, 1.6815603971481323, 0.36729955673217773, 0.16128158569335938, 1.8741075992584229, 1.1180514097213745, 0.4332003593444824, 0.04568684101104736, 1.2526003122329712, 1.0670884847640991, 2.5876805782318115, 1.7667133808135986, 2.7017064094543457, 0.2638735771179199, 1.9211480617523193, 0.7906395196914673, 0.0769963264465332, 1.39210844039917, 1.3286460638046265, 0.92778480052948, 0.4583030939102173, 0.7375948429107666, 0.8881552219390869, 0.24700820446014404, 1.0486546754837036, 0.8004915714263916, 1.2616300582885742, 1.5762277841567993, 0.43753159046173096, 0.4713404178619385, 1.6775321960449219, 0.009067654609680176, 1.848334550857544, 0.2066340446472168, 0.15570330619812012, 0.10751736164093018, 1.3021979331970215, 0.04337596893310547, 1.8321995735168457, 0.348421573638916, 0.49762284755706787, 1.3339440822601318, 0.7683688402175903, 0.28421735763549805, 1.5400928258895874, 1.087999939918518, 1.6614184379577637, 0.09105205535888672, 0.15034019947052002, 1.4971444606781006, 0.21688449382781982, 1.2569844722747803, 1.6041514873504639, 1.3701934814453125, 0.22026193141937256, 1.6821305751800537, 0.18325865268707275, 0.44487011432647705, 1.2619526386260986, 1.6998666524887085, 0.8732128143310547, 0.5054103136062622, 1.273987054824829, 1.0517843961715698, 1.0983245372772217, 1.7165398597717285, 0.7508754730224609, 1.0685299634933472, 0.11764860153198242, 0.8197051286697388, 0.7587471008300781, 0.3856159448623657, 1.69058358669281, 0.09591209888458252, 0.9856746196746826, 0.5596034526824951, 0.7863593101501465, 0.1076575517654419], "mean_td_error": 0.9137114882469177, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 98.0, "diff_num_grad_updates_vs_sampler_policy": 97.0}}, "num_env_steps_sampled": 88704, "num_env_steps_trained": 25284, "num_agent_steps_sampled": 266112, "num_agent_steps_trained": 25284, "last_target_update_ts": 88704, "num_target_updates": 98}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 266112, "num_agent_steps_trained": 25284, "num_env_steps_sampled": 88704, "num_env_steps_trained": 25284, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 767.4433446112074, "num_env_steps_trained_throughput_per_sec": 220.9825702117093, "timesteps_total": 88704, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 266112, "timers": {"training_iteration_time_ms": 1067.708, "sample_time_ms": 745.672, "load_time_ms": 0.319, "load_throughput": 810038.5, "learn_time_ms": 18.36, "learn_throughput": 14052.346, "synch_weights_time_ms": 11.069}, "counters": {"num_env_steps_sampled": 88704, "num_env_steps_trained": 25284, "num_agent_steps_sampled": 266112, "num_agent_steps_trained": 25284, "last_target_update_ts": 88704, "num_target_updates": 98}, "done": false, "episodes_total": 0, "training_iteration": 57, "trial_id": "7066a_00000", "date": "2023-11-18_21-08-32", "timestamp": 1700370512, "time_this_iter_s": 1.177175760269165, "time_total_s": 95.64647579193115, "pid": 7187, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x31246bb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 95.64647579193115, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 80.9, "ram_util_percent": 65.65}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.021098136901855, "actor_loss": -8.856216430664062, "critic_loss": 0.11777439713478088, "alpha_loss": -0.29459115862846375, "alpha_value": 0.9710307717323303, "log_alpha_value": -0.029397092759609222, "target_entropy": -6.0, "policy_t": -0.10616862773895264, "mean_q": 4.727563858032227, "max_q": 5.015227794647217, "min_q": 2.6816189289093018}, "td_error": [1.1161918640136719, 0.9644067287445068, 0.5700387954711914, 0.8510515689849854, 0.681384801864624, 0.29186582565307617, 1.3887014389038086, 0.25042295455932617, 0.9108784198760986, 0.5660467147827148, 0.7543871402740479, 0.08716487884521484, 0.37049436569213867, 2.1083123683929443, 0.2613682746887207, 0.7906720638275146, 0.6000268459320068, 1.2063305377960205, 1.7423095703125, 0.11426234245300293, 1.1180901527404785, 0.3002438545227051, 1.287132978439331, 0.311476469039917, 0.26986098289489746, 1.839092493057251, 0.15351200103759766, 0.6798624992370605, 0.7237913608551025, 0.0771949291229248, 1.5903568267822266, 3.415642261505127, 1.9958827495574951, 0.5278921127319336, 1.194916009902954, 1.8088452816009521, 1.3272287845611572, 1.0084161758422852, 1.3245189189910889, 1.6786835193634033, 0.7804409265518188, 0.4286010265350342, 1.1796550750732422, 0.6623489856719971, 1.61665678024292, 1.2378315925598145, 0.6448202133178711, 2.770155429840088, 2.3272526264190674, 0.5366241931915283, 0.569044828414917, 0.8568131923675537, 1.714766502380371, 1.2642009258270264, 0.3580050468444824, 0.7403481006622314, 0.1311250925064087, 1.2032182216644287, 0.819582462310791, 0.5766475200653076, 0.32674503326416016, 0.8179080486297607, 0.8198308944702148, 1.3675825595855713, 0.6964297294616699, 0.9312185049057007, 0.5719339847564697, 0.5199325084686279, 0.36668848991394043, 2.418828010559082, 0.14429974555969238, 0.640113353729248, 0.0513763427734375, 1.026750087738037, 1.7665367126464844, 0.232452392578125, 1.3102357387542725, 0.558457612991333, 2.2561233043670654, 0.864715576171875, 1.6679668426513672, 1.1096713542938232, 1.4177634716033936, 1.4970999956130981, 0.7431387901306152, 0.7635757923126221], "mean_td_error": 0.9716798663139343, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 99.0, "diff_num_grad_updates_vs_sampler_policy": 98.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.05367374420166, "actor_loss": -6.553639888763428, "critic_loss": 0.1507580727338791, "alpha_loss": -0.2954419255256653, "alpha_value": 0.9710411429405212, "log_alpha_value": -0.02938646264374256, "target_entropy": -6.0, "policy_t": -0.046996086835861206, "mean_q": 2.626492738723755, "max_q": 3.491567850112915, "min_q": 2.1528568267822266}, "td_error": [0.44375312328338623, 2.6607985496520996, 1.7927788496017456, 1.1396465301513672, 1.3996365070343018, 1.2932569980621338, 0.6953816413879395, 0.8580796718597412, 1.5853476524353027, 0.6754484176635742, 0.0502471923828125, 1.2893311977386475, 0.13405132293701172, 0.8722844123840332, 0.2433946132659912, 0.2457563877105713, 0.7107396125793457, 0.7433556318283081, 0.11320531368255615, 1.4824237823486328, 0.19204437732696533, 0.27296924591064453, 0.7633535861968994, 2.8790082931518555, 0.7816184759140015, 0.5134209394454956, 1.355621576309204, 1.4655320644378662, 0.7104699611663818, 1.5574218034744263, 1.7102643251419067, 1.3894068002700806, 0.8100849390029907, 0.33406245708465576, 1.3551141023635864, 2.835925579071045, 1.0883805751800537, 0.07933187484741211, 0.6569745540618896, 0.5389434099197388, 0.630452036857605, 1.2476446628570557, 1.7036197185516357, 0.6475435495376587, 0.7228050231933594, 1.0008008480072021, 2.295109510421753, 0.7336699962615967, 2.1269419193267822, 0.5735479593276978, 1.4966179132461548, 0.2751288414001465, 0.3072904348373413, 0.20890474319458008, 0.6077227592468262, 0.8703944683074951, 1.6345973014831543, 2.606182098388672, 0.2110074758529663, 0.28128087520599365, 0.1648426055908203, 2.010128974914551, 2.4374184608459473, 0.1564648151397705, 1.7563834190368652, 1.209236979484558, 0.5307513475418091, 2.1301939487457275, 0.14760076999664307, 0.6626960039138794, 0.4878891706466675, 0.23750579357147217, 1.0376415252685547, 0.22726202011108398, 1.6966919898986816, 1.8579751253128052, 1.0211074352264404, 1.3708759546279907, 1.4622348546981812, 0.1964120864868164, 0.9958211183547974, 0.8366217613220215, 0.2407550811767578, 0.7493730783462524, 1.175927996635437, 0.2511613368988037], "mean_td_error": 0.9878035187721252, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 99.0, "diff_num_grad_updates_vs_sampler_policy": 98.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.046818733215332, "actor_loss": -6.581769943237305, "critic_loss": 0.1004147082567215, "alpha_loss": -0.2953874468803406, "alpha_value": 0.9710268974304199, "log_alpha_value": -0.02940109558403492, "target_entropy": -6.0, "policy_t": -0.018149500712752342, "mean_q": 2.631751298904419, "max_q": 2.926240921020508, "min_q": 2.3646187782287598}, "td_error": [0.36215174198150635, 0.07250463962554932, 1.3301503658294678, 0.586529016494751, 0.8974273204803467, 0.7509500980377197, 1.7055919170379639, 0.12679719924926758, 1.5957014560699463, 0.9586265087127686, 0.5332417488098145, 0.6719194650650024, 1.668553352355957, 1.432007074356079, 0.00785672664642334, 0.1324007511138916, 0.5696051120758057, 0.5139486789703369, 0.8924980163574219, 1.4996687173843384, 1.3792895078659058, 1.599975347518921, 0.335476279258728, 0.025889873504638672, 1.8629029989242554, 1.0863337516784668, 0.36218905448913574, 0.3249884843826294, 0.7474629878997803, 0.7429864406585693, 0.7148599624633789, 0.46566641330718994, 0.9612658023834229, 1.1678534746170044, 0.6808557510375977, 1.8436859846115112, 1.4044724702835083, 1.2226758003234863, 1.8896992206573486, 0.21139371395111084, 0.7080560922622681, 1.8156826496124268, 0.00601041316986084, 0.2633165121078491, 1.0267486572265625, 0.13300621509552002, 0.2855278253555298, 1.2384740114212036, 0.9568724632263184, 0.7690683603286743, 1.0375795364379883, 1.3629565238952637, 0.2884446382522583, 0.5779927968978882, 0.9263095855712891, 0.2087796926498413, 0.3387643098831177, 2.497581720352173, 1.5847707986831665, 0.234527587890625, 0.6361745595932007, 0.3437906503677368, 1.090585708618164, 0.29321444034576416, 0.5454866886138916, 1.1237170696258545, 1.0690439939498901, 1.2665694952011108, 0.35695600509643555, 0.3061792850494385, 0.5073850154876709, 0.07019269466400146, 1.0249683856964111, 0.660489559173584, 0.18803644180297852, 0.3661755323410034, 0.2336902618408203, 0.050066471099853516, 0.34016335010528564, 1.3607885837554932, 0.3712726831436157, 0.5294498205184937, 0.5966852903366089, 0.47068774700164795, 1.2665832042694092, 0.14109575748443604], "mean_td_error": 0.7768369317054749, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 99.0, "diff_num_grad_updates_vs_sampler_policy": 98.0}}, "num_env_steps_sampled": 89600, "num_env_steps_trained": 25542, "num_agent_steps_sampled": 268800, "num_agent_steps_trained": 25542, "last_target_update_ts": 89600, "num_target_updates": 99}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 268800, "num_agent_steps_trained": 25542, "num_env_steps_sampled": 89600, "num_env_steps_trained": 25542, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 869.930725382784, "num_env_steps_trained_throughput_per_sec": 250.49344547852485, "timesteps_total": 89600, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 268800, "timers": {"training_iteration_time_ms": 1028.915, "sample_time_ms": 707.925, "load_time_ms": 0.314, "load_throughput": 821289.035, "learn_time_ms": 18.277, "learn_throughput": 14116.469, "synch_weights_time_ms": 11.051}, "counters": {"num_env_steps_sampled": 89600, "num_env_steps_trained": 25542, "num_agent_steps_sampled": 268800, "num_agent_steps_trained": 25542, "last_target_update_ts": 89600, "num_target_updates": 99}, "done": false, "episodes_total": 0, "training_iteration": 58, "trial_id": "7066a_00000", "date": "2023-11-18_21-08-33", "timestamp": 1700370513, "time_this_iter_s": 1.0389792919158936, "time_total_s": 96.68545508384705, "pid": 7187, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x3124684a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 96.68545508384705, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 73.65, "ram_util_percent": 65.85}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.055703163146973, "actor_loss": -8.792498588562012, "critic_loss": 0.11333338171243668, "alpha_loss": -0.2986048758029938, "alpha_value": 0.9707415103912354, "log_alpha_value": -0.02969507686793804, "target_entropy": -6.0, "policy_t": -0.04560166969895363, "mean_q": 4.718207836151123, "max_q": 4.993143558502197, "min_q": 2.664975166320801}, "td_error": [2.796900749206543, 0.4762308597564697, 0.628413200378418, 0.842644453048706, 1.3107404708862305, 1.4134283065795898, 0.6166632175445557, 1.4867160320281982, 0.04663681983947754, 0.014486312866210938, 0.7122883796691895, 0.5473599433898926, 1.4419426918029785, 0.8493247032165527, 1.0011012554168701, 1.416599988937378, 1.4822361469268799, 0.9215793609619141, 0.6670808792114258, 0.8002612590789795, 0.36389899253845215, 0.8804492950439453, 1.7195165157318115, 0.05656099319458008, 1.0764999389648438, 0.27584171295166016, 1.8419604301452637, 0.3681159019470215, 0.6384317874908447, 0.5641794204711914, 2.039191246032715, 0.32360410690307617, 0.01348423957824707, 1.177462100982666, 2.565288543701172, 1.147430658340454, 1.6699392795562744, 0.4097929000854492, 0.4563934803009033, 1.3667571544647217, 0.1993875503540039, 1.1347007751464844, 0.8990216255187988, 1.7608575820922852, 2.174516439437866, 0.014571428298950195, 1.4411253929138184, 0.6869184970855713, 0.7536289691925049, 1.5513451099395752, 1.4055581092834473, 2.1076278686523438, 0.47501063346862793, 1.5063629150390625, 1.005819320678711, 2.124440908432007, 0.7948744297027588, 0.8869907855987549, 0.30819833278656006, 0.21552634239196777, 0.43424463272094727, 2.142460346221924, 0.6005635261535645, 0.7388832569122314, 1.026698112487793, 1.496993064880371, 0.24611449241638184, 0.9161503314971924, 0.3117039203643799, 0.21045565605163574, 1.050215482711792, 1.5164532661437988, 1.0021655559539795, 2.326172113418579, 1.2042515277862549, 0.09634542465209961, 0.03217434883117676, 1.5485575199127197, 1.0926942825317383, 0.522118091583252, 0.7502593994140625, 0.60392165184021, 0.5505695343017578, 0.22494983673095703, 0.5129551887512207, 0.6242830753326416], "mean_td_error": 0.949491560459137, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 100.0, "diff_num_grad_updates_vs_sampler_policy": 99.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.130889892578125, "actor_loss": -6.5656538009643555, "critic_loss": 0.13640227913856506, "alpha_loss": -0.3007436692714691, "alpha_value": 0.9707505106925964, "log_alpha_value": -0.029685810208320618, "target_entropy": -6.0, "policy_t": -0.009680505841970444, "mean_q": 2.5821449756622314, "max_q": 2.6627016067504883, "min_q": 2.1824231147766113}, "td_error": [0.5501807928085327, 0.6449880599975586, 0.4195857048034668, 1.6553139686584473, 0.6740695238113403, 0.8314042091369629, 1.428945541381836, 0.39252519607543945, 1.9069757461547852, 0.6815512180328369, 0.2113339900970459, 1.0828142166137695, 0.7388871908187866, 0.4291706085205078, 0.3419680595397949, 1.0181288719177246, 1.0894643068313599, 0.23926234245300293, 1.3882558345794678, 1.1579784154891968, 0.7509640455245972, 1.3287997245788574, 0.12473678588867188, 0.3312786817550659, 0.54343581199646, 0.682784914970398, 0.368973970413208, 0.8587213754653931, 1.306626796722412, 0.38758385181427, 2.659653663635254, 0.8817135095596313, 2.495572566986084, 0.7979457378387451, 0.8694801330566406, 1.7714382410049438, 1.2012102603912354, 1.6181164979934692, 0.08132493495941162, 0.6203980445861816, 1.317603349685669, 2.362837076187134, 1.1984256505966187, 1.1456780433654785, 1.2511847019195557, 0.042188048362731934, 0.16006243228912354, 0.17430472373962402, 0.7222200632095337, 1.8514870405197144, 0.3864525556564331, 0.6628241539001465, 0.1483304500579834, 0.06009256839752197, 0.23739361763000488, 1.293929934501648, 0.6706719398498535, 1.2413010597229004, 1.0133864879608154, 0.5242495536804199, 0.5889402627944946, 1.6701304912567139, 1.4070799350738525, 0.1211167573928833, 0.11502254009246826, 2.101858615875244, 0.039525628089904785, 0.04166138172149658, 2.0614705085754395, 1.833438754081726, 2.0572292804718018, 0.8995943069458008, 0.8963792324066162, 0.05740213394165039, 0.04084420204162598, 0.0888824462890625, 1.1804052591323853, 1.786895751953125, 0.8757903575897217, 1.7662265300750732, 0.16925263404846191, 2.018314838409424, 0.16401374340057373, 1.8440254926681519, 0.46258318424224854, 0.31778085231781006], "mean_td_error": 0.9027214050292969, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 100.0, "diff_num_grad_updates_vs_sampler_policy": 99.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.103914260864258, "actor_loss": -6.589537143707275, "critic_loss": 0.12703865766525269, "alpha_loss": -0.3000936210155487, "alpha_value": 0.970736026763916, "log_alpha_value": -0.029700733721256256, "target_entropy": -6.0, "policy_t": -0.013730325736105442, "mean_q": 2.658907175064087, "max_q": 3.8045454025268555, "min_q": 2.292841911315918}, "td_error": [0.5908763408660889, 0.43446826934814453, 0.06853687763214111, 4.591697692871094, 2.557668924331665, 0.950728178024292, 1.1406365633010864, 1.6913427114486694, 0.15232110023498535, 1.2873255014419556, 1.1705172061920166, 0.46456217765808105, 1.3035624027252197, 1.1151139736175537, 0.15422344207763672, 0.5365678071975708, 0.5386757850646973, 0.14419782161712646, 0.23329055309295654, 0.9841852188110352, 0.3784598112106323, 1.179311990737915, 0.7297143936157227, 1.5878864526748657, 0.6411335468292236, 0.828662633895874, 0.8971239328384399, 0.16976940631866455, 1.3512604236602783, 0.3214132785797119, 0.8807334899902344, 0.20682048797607422, 1.3556689023971558, 0.37124645709991455, 1.081470251083374, 0.9780356884002686, 1.2941670417785645, 0.12315022945404053, 1.35975980758667, 1.5753958225250244, 0.4969511032104492, 0.195792555809021, 1.2634155750274658, 1.0382853746414185, 0.5428529977798462, 2.639759063720703, 0.007178544998168945, 1.8083374500274658, 0.3619648218154907, 0.9697846174240112, 0.8268572092056274, 1.7722586393356323, 0.9677462577819824, 0.10702657699584961, 1.876761555671692, 0.37555360794067383, 0.5124568939208984, 0.43278980255126953, 2.1506621837615967, 0.32099926471710205, 0.5862990617752075, 1.4316293001174927, 0.6894875764846802, 3.3217811584472656, 0.08902335166931152, 0.014968156814575195, 1.9289605617523193, 0.8332297801971436, 0.4949249029159546, 0.40841495990753174, 1.1968374252319336, 0.09279584884643555, 1.5784637928009033, 0.4545978307723999, 2.2246224880218506, 0.5875399112701416, 0.4223567247390747, 0.09297740459442139, 0.43541955947875977, 0.2970602512359619, 0.5831199884414673, 1.0118873119354248, 0.5596921443939209, 0.27210676670074463, 0.11716032028198242, 0.24105548858642578], "mean_td_error": 0.8843665719032288, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 100.0, "diff_num_grad_updates_vs_sampler_policy": 99.0}}, "num_env_steps_sampled": 90496, "num_env_steps_trained": 25800, "num_agent_steps_sampled": 271488, "num_agent_steps_trained": 25800, "last_target_update_ts": 90496, "num_target_updates": 100}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 271488, "num_agent_steps_trained": 25800, "num_env_steps_sampled": 90496, "num_env_steps_trained": 25800, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 755.9171191727687, "num_env_steps_trained_throughput_per_sec": 217.6636347618017, "timesteps_total": 90496, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 271488, "timers": {"training_iteration_time_ms": 1005.933, "sample_time_ms": 720.915, "load_time_ms": 0.318, "load_throughput": 812288.269, "learn_time_ms": 18.714, "learn_throughput": 13786.295, "synch_weights_time_ms": 11.494}, "counters": {"num_env_steps_sampled": 90496, "num_env_steps_trained": 25800, "num_agent_steps_sampled": 271488, "num_agent_steps_trained": 25800, "last_target_update_ts": 90496, "num_target_updates": 100}, "done": false, "episodes_total": 0, "training_iteration": 59, "trial_id": "7066a_00000", "date": "2023-11-18_21-08-34", "timestamp": 1700370514, "time_this_iter_s": 1.1961619853973389, "time_total_s": 97.88161706924438, "pid": 7187, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x31246bec0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 97.88161706924438, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 85.7, "ram_util_percent": 67.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.909393310546875, "actor_loss": -8.713653564453125, "critic_loss": 0.1022428423166275, "alpha_loss": -0.2972145080566406, "alpha_value": 0.9704521298408508, "log_alpha_value": -0.02999320812523365, "target_entropy": -6.0, "policy_t": -0.09371811896562576, "mean_q": 4.693115234375, "max_q": 4.973320007324219, "min_q": 2.8430120944976807}, "td_error": [0.7037067413330078, 1.666415810585022, 0.4534285068511963, 0.47666501998901367, 1.6590979099273682, 0.4473123550415039, 0.4587275981903076, 0.06274056434631348, 1.4175453186035156, 0.7144296169281006, 1.1184515953063965, 0.4333682060241699, 0.5382294654846191, 1.5159571170806885, 0.8677401542663574, 0.19134068489074707, 0.45078539848327637, 0.5916333198547363, 0.05326986312866211, 0.1291060447692871, 0.13757610321044922, 0.7719168663024902, 2.200251340866089, 0.0532984733581543, 0.11022782325744629, 0.9162449836730957, 0.7503149509429932, 0.05002307891845703, 0.48281359672546387, 0.35176515579223633, 0.0756683349609375, 2.2144885063171387, 0.07137608528137207, 1.0436384677886963, 1.0664634704589844, 0.9159646034240723, 0.15846872329711914, 1.7722444534301758, 1.4423069953918457, 0.6204533576965332, 0.8046083450317383, 1.5839354991912842, 0.12712621688842773, 0.549799919128418, 0.8517823219299316, 1.0216419696807861, 0.7704763412475586, 1.0690624713897705, 0.0865318775177002, 2.60017991065979, 0.9327497482299805, 1.2862913608551025, 0.09313249588012695, 2.109389066696167, 0.43552350997924805, 1.6560091972351074, 1.5951907634735107, 2.5339765548706055, 0.5263004302978516, 1.0165276527404785, 0.3251302242279053, 1.6760597229003906, 0.24079442024230957, 0.1658487319946289, 0.49132251739501953, 0.7246770858764648, 0.21822667121887207, 0.17197000980377197, 0.034317970275878906, 0.564068078994751, 2.070788860321045, 0.33839917182922363, 0.8782405853271484, 2.0978217124938965, 0.2139444351196289, 1.3074913024902344, 1.0154471397399902, 2.527271032333374, 0.7583580017089844, 1.5968611240386963, 0.44684553146362305, 0.7124748229980469, 0.3671693801879883, 1.165473222732544, 1.545971393585205, 0.7121412754058838], "mean_td_error": 0.8508466482162476, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 101.0, "diff_num_grad_updates_vs_sampler_policy": 100.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.060487747192383, "actor_loss": -6.501716136932373, "critic_loss": 0.11925558000802994, "alpha_loss": -0.3016672432422638, "alpha_value": 0.9704597592353821, "log_alpha_value": -0.029985349625349045, "target_entropy": -6.0, "policy_t": -0.045805227011442184, "mean_q": 2.5916879177093506, "max_q": 3.2006611824035645, "min_q": 2.0656991004943848}, "td_error": [0.31287455558776855, 0.6843844652175903, 0.42229163646698, 0.6291561126708984, 0.9292067289352417, 1.3077735900878906, 0.31731700897216797, 0.14546465873718262, 0.5763581991195679, 1.051284909248352, 0.2907531261444092, 0.5408345460891724, 1.4048858880996704, 0.8364062309265137, 0.659747838973999, 0.72055983543396, 0.3372073173522949, 0.3680446147918701, 0.8411378860473633, 0.35185718536376953, 0.8023196458816528, 0.04016828536987305, 0.7785953283309937, 0.9621798992156982, 0.3404262065887451, 1.8555878400802612, 0.20470571517944336, 2.3554487228393555, 0.12298107147216797, 1.5144761800765991, 0.100799560546875, 1.4666866064071655, 1.151492714881897, 0.723249077796936, 1.8354034423828125, 1.0014790296554565, 0.3405575752258301, 1.0229793787002563, 1.500326156616211, 0.16856765747070312, 0.8205587863922119, 1.279918909072876, 0.13633358478546143, 0.8116757869720459, 0.717646598815918, 1.503359079360962, 0.04146265983581543, 0.3482619524002075, 0.891159176826477, 0.08188867568969727, 1.959771752357483, 1.0060991048812866, 0.7574564218521118, 1.2939784526824951, 1.2457118034362793, 0.6241830587387085, 0.2281501293182373, 0.8193037509918213, 0.8910287618637085, 1.3376034498214722, 1.2161273956298828, 1.686275839805603, 1.4371205568313599, 0.887271523475647, 0.016706228256225586, 1.3107424974441528, 0.2965536117553711, 0.40537548065185547, 1.8424642086029053, 1.5533477067947388, 0.3991987705230713, 0.851241946220398, 1.3383089303970337, 1.062607765197754, 1.5545984506607056, 0.1300349235534668, 0.10816240310668945, 1.2193493843078613, 1.2421653270721436, 1.2596030235290527, 1.071458101272583, 0.06475687026977539, 2.5014054775238037, 0.3161470890045166, 0.4349426031112671, 1.1326353549957275], "mean_td_error": 0.8505828976631165, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 101.0, "diff_num_grad_updates_vs_sampler_policy": 100.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.094062805175781, "actor_loss": -6.623025417327881, "critic_loss": 0.10362699627876282, "alpha_loss": -0.30282676219940186, "alpha_value": 0.9704450368881226, "log_alpha_value": -0.030000481754541397, "target_entropy": -6.0, "policy_t": -0.018796740099787712, "mean_q": 2.6150057315826416, "max_q": 3.1403098106384277, "min_q": 2.240673542022705}, "td_error": [0.015132665634155273, 0.7071183919906616, 0.4334949254989624, 0.26180148124694824, 0.09032988548278809, 1.9503811597824097, 0.7001738548278809, 0.3630181550979614, 0.8106372356414795, 0.20712697505950928, 0.38393211364746094, 0.08721232414245605, 1.4756872653961182, 0.20636868476867676, 0.380218505859375, 0.7827087640762329, 1.098970651626587, 0.17178070545196533, 0.4968993663787842, 1.1049816608428955, 1.0051120519638062, 0.9964122772216797, 0.11194777488708496, 0.13464176654815674, 1.044813871383667, 0.8763937950134277, 2.12641978263855, 1.296183705329895, 0.9717429876327515, 0.9345217943191528, 1.278573751449585, 1.6352547407150269, 0.43582701683044434, 0.9441471099853516, 0.2658611536026001, 0.014061808586120605, 1.392796277999878, 0.6589446067810059, 1.4444689750671387, 0.29542434215545654, 1.2844960689544678, 1.0968438386917114, 2.5970726013183594, 1.8814103603363037, 1.3070993423461914, 0.9662258625030518, 0.40130913257598877, 0.216269850730896, 0.18619132041931152, 0.9544081687927246, 0.9438995122909546, 0.8907842636108398, 1.6830683946609497, 0.2490297555923462, 0.8910889625549316, 0.323186993598938, 0.12294578552246094, 0.9997498989105225, 0.7676445245742798, 1.2598987817764282, 0.796751856803894, 0.04482269287109375, 1.6284340620040894, 1.4088205099105835, 1.295378565788269, 0.7576848268508911, 1.7933335304260254, 0.410048246383667, 0.23658204078674316, 2.0799083709716797, 0.965212345123291, 1.3719761371612549, 0.38318932056427, 0.8100203275680542, 0.8299373388290405, 1.4092611074447632, 0.22860312461853027, 0.18428218364715576, 0.4064037799835205, 0.435558557510376, 0.23288273811340332, 0.713564395904541, 0.7433403730392456, 0.3987772464752197, 0.10249638557434082, 0.5206667184829712], "mean_td_error": 0.8000242710113525, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 101.0, "diff_num_grad_updates_vs_sampler_policy": 100.0}}, "num_env_steps_sampled": 91392, "num_env_steps_trained": 26058, "num_agent_steps_sampled": 274176, "num_agent_steps_trained": 26058, "last_target_update_ts": 91392, "num_target_updates": 101}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 274176, "num_agent_steps_trained": 26058, "num_env_steps_sampled": 91392, "num_env_steps_trained": 26058, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 641.4331248871376, "num_env_steps_trained_throughput_per_sec": 184.6983774786624, "timesteps_total": 91392, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 274176, "timers": {"training_iteration_time_ms": 1054.979, "sample_time_ms": 767.376, "load_time_ms": 0.316, "load_throughput": 816640.58, "learn_time_ms": 18.738, "learn_throughput": 13768.842, "synch_weights_time_ms": 11.628}, "counters": {"num_env_steps_sampled": 91392, "num_env_steps_trained": 26058, "num_agent_steps_sampled": 274176, "num_agent_steps_trained": 26058, "last_target_update_ts": 91392, "num_target_updates": 101}, "done": false, "episodes_total": 0, "training_iteration": 60, "trial_id": "7066a_00000", "date": "2023-11-18_21-08-36", "timestamp": 1700370516, "time_this_iter_s": 1.4050369262695312, "time_total_s": 99.28665399551392, "pid": 7187, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x31246b740>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 99.28665399551392, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 83.35, "ram_util_percent": 67.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.04504108428955, "actor_loss": -8.752374649047852, "critic_loss": 0.0974084883928299, "alpha_loss": -0.30427515506744385, "alpha_value": 0.970163106918335, "log_alpha_value": -0.030291082337498665, "target_entropy": -6.0, "policy_t": -0.04394691064953804, "mean_q": 4.726092338562012, "max_q": 4.953514099121094, "min_q": 3.0709824562072754}, "td_error": [1.7118089199066162, 0.12210559844970703, 0.7758302688598633, 1.028069019317627, 0.34069061279296875, 0.44408202171325684, 0.2567591667175293, 0.35111546516418457, 2.6629886627197266, 0.3504178524017334, 1.2066774368286133, 0.06551599502563477, 1.112983226776123, 0.9401113986968994, 0.5244042873382568, 0.6994507312774658, 1.7312722206115723, 0.7634100914001465, 0.871990442276001, 0.03764796257019043, 0.3298187255859375, 1.1999156475067139, 0.9627594947814941, 0.011849641799926758, 0.9600863456726074, 0.7177507877349854, 1.0172600746154785, 2.0624732971191406, 0.7921409606933594, 0.26791810989379883, 0.7949633598327637, 0.9759488105773926, 1.2602005004882812, 0.7346348762512207, 0.6615471839904785, 0.37699460983276367, 1.2906975746154785, 0.8147411346435547, 0.12471175193786621, 0.8161892890930176, 1.403540849685669, 2.158043622970581, 0.11680245399475098, 0.4477558135986328, 1.1715497970581055, 1.4528183937072754, 1.6454336643218994, 1.3089845180511475, 1.312514066696167, 0.21875405311584473, 0.8167233467102051, 0.23829007148742676, 0.9587578773498535, 0.6765785217285156, 0.8422939777374268, 0.9229719638824463, 1.0572104454040527, 0.030850648880004883, 0.5185117721557617, 0.20595955848693848, 0.3005547523498535, 0.07548713684082031, 1.3939926624298096, 1.1391897201538086, 2.0371198654174805, 0.05522012710571289, 1.3036446571350098, 0.9325437545776367, 1.008498191833496, 0.6523029804229736, 0.16136813163757324, 0.5232007503509521, 2.110628604888916, 0.8872814178466797, 0.5923724174499512, 1.8381032943725586, 0.5299782752990723, 0.4536004066467285, 1.627845048904419, 2.89705753326416, 0.8851141929626465, 0.18337416648864746, 0.6079423427581787, 0.8439795970916748, 1.2323851585388184, 0.14378535747528076], "mean_td_error": 0.8615215420722961, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 102.0, "diff_num_grad_updates_vs_sampler_policy": 101.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.203152656555176, "actor_loss": -6.597084045410156, "critic_loss": 0.10367205739021301, "alpha_loss": -0.30900120735168457, "alpha_value": 0.9701691269874573, "log_alpha_value": -0.030284874141216278, "target_entropy": -6.0, "policy_t": -0.03292619436979294, "mean_q": 2.587738275527954, "max_q": 3.3779959678649902, "min_q": 2.1423912048339844}, "td_error": [1.1300010681152344, 0.8725656270980835, 1.4826991558074951, 0.7284921407699585, 1.1329641342163086, 0.8080343008041382, 1.4471566677093506, 1.6570141315460205, 0.6491703987121582, 0.15873849391937256, 0.39337122440338135, 1.2079845666885376, 1.2768980264663696, 1.240382194519043, 0.6367499828338623, 0.7359269857406616, 1.1581828594207764, 1.3392094373703003, 1.7704780101776123, 0.8581582307815552, 0.9986176490783691, 1.5734225511550903, 0.3791799545288086, 1.0709035396575928, 0.6485921144485474, 1.1426221132278442, 0.5103806257247925, 0.20781636238098145, 0.0516815185546875, 0.6128823757171631, 2.173909902572632, 0.368236780166626, 0.28555548191070557, 0.9766690731048584, 0.19299185276031494, 0.578845739364624, 0.47441232204437256, 0.24902546405792236, 0.03396487236022949, 1.692192554473877, 1.266648530960083, 0.2973148822784424, 1.2966783046722412, 1.1488087177276611, 0.006931781768798828, 0.45438551902770996, 0.7391903400421143, 0.4586024284362793, 0.3839970827102661, 0.3548358678817749, 0.04565441608428955, 2.0800092220306396, 0.7549426555633545, 1.03883695602417, 1.2106890678405762, 1.3093332052230835, 1.5672212839126587, 1.6467806100845337, 0.08306717872619629, 1.2065516710281372, 0.23091137409210205, 0.02735745906829834, 0.16879761219024658, 0.1833949089050293, 0.2851046323776245, 0.7091150283813477, 1.0543264150619507, 0.946772575378418, 0.9705805778503418, 0.6840353012084961, 0.7419681549072266, 0.3492422103881836, 1.0920848846435547, 0.5106348991394043, 0.5639722347259521, 1.0929228067398071, 0.7186011075973511, 0.3106421232223511, 1.133309006690979, 1.7928723096847534, 0.25039708614349365, 0.15564727783203125, 0.07260406017303467, 0.8909295797348022, 0.4430077075958252, 0.29102206230163574], "mean_td_error": 0.789846658706665, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 102.0, "diff_num_grad_updates_vs_sampler_policy": 101.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.129037857055664, "actor_loss": -6.638519763946533, "critic_loss": 0.11515966802835464, "alpha_loss": -0.30691292881965637, "alpha_value": 0.9701541662216187, "log_alpha_value": -0.030300302430987358, "target_entropy": -6.0, "policy_t": 0.0204527098685503, "mean_q": 2.620163917541504, "max_q": 3.1557934284210205, "min_q": 2.2471518516540527}, "td_error": [0.5192617177963257, 0.13554465770721436, 0.07172322273254395, 0.11787891387939453, 0.07143473625183105, 1.4652886390686035, 1.7448291778564453, 0.8296558856964111, 1.1413345336914062, 0.8687535524368286, 0.3918142318725586, 1.104318618774414, 1.1388651132583618, 2.059117317199707, 1.484758734703064, 0.0906827449798584, 0.7373563051223755, 0.7038841247558594, 0.9102709293365479, 0.36214661598205566, 0.8994933366775513, 0.14323318004608154, 2.1301279067993164, 0.4757136106491089, 0.7649881839752197, 0.5860313177108765, 1.9903732538223267, 0.4590296745300293, 1.068743109703064, 0.12729430198669434, 0.013734579086303711, 0.7339744567871094, 0.0032655000686645508, 0.6209688186645508, 0.3137935400009155, 1.7369118928909302, 1.9128249883651733, 0.10826659202575684, 1.385424256324768, 0.24520516395568848, 1.0540823936462402, 0.817359447479248, 0.08601486682891846, 0.5751751661300659, 0.5224545001983643, 0.06771612167358398, 0.19852125644683838, 0.5834988355636597, 0.7559837102890015, 0.8821797370910645, 1.6920769214630127, 1.1952338218688965, 0.2533080577850342, 1.275273323059082, 0.3707050085067749, 2.1105074882507324, 1.7595423460006714, 0.1969292163848877, 0.0706486701965332, 0.7306332588195801, 0.5748873949050903, 1.9675050973892212, 1.670271635055542, 1.7911127805709839, 0.5553958415985107, 1.362404704093933, 1.2922395467758179, 0.11783862113952637, 0.7354750633239746, 1.106190800666809, 1.72511887550354, 0.4811875820159912, 0.9412566423416138, 0.33918511867523193, 0.2370467185974121, 1.4739351272583008, 0.07817697525024414, 1.172104001045227, 2.5621631145477295, 0.9112330675125122, 1.8938299417495728, 0.1722736358642578, 1.5876832008361816, 0.678063154220581, 0.16084718704223633, 0.33252060413360596], "mean_td_error": 0.8463501334190369, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 102.0, "diff_num_grad_updates_vs_sampler_policy": 101.0}}, "num_env_steps_sampled": 92288, "num_env_steps_trained": 26316, "num_agent_steps_sampled": 276864, "num_agent_steps_trained": 26316, "last_target_update_ts": 92288, "num_target_updates": 102}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 276864, "num_agent_steps_trained": 26316, "num_env_steps_sampled": 92288, "num_env_steps_trained": 26316, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 645.9193542759607, "num_env_steps_trained_throughput_per_sec": 185.99017120892617, "timesteps_total": 92288, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 276864, "timers": {"training_iteration_time_ms": 1103.252, "sample_time_ms": 811.383, "load_time_ms": 0.316, "load_throughput": 817195.614, "learn_time_ms": 18.697, "learn_throughput": 13799.199, "synch_weights_time_ms": 11.801}, "counters": {"num_env_steps_sampled": 92288, "num_env_steps_trained": 26316, "num_agent_steps_sampled": 276864, "num_agent_steps_trained": 26316, "last_target_update_ts": 92288, "num_target_updates": 102}, "done": false, "episodes_total": 0, "training_iteration": 61, "trial_id": "7066a_00000", "date": "2023-11-18_21-08-37", "timestamp": 1700370517, "time_this_iter_s": 1.3969550132751465, "time_total_s": 100.68360900878906, "pid": 7187, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x31039f560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 100.68360900878906, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 83.25, "ram_util_percent": 66.45}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.01513671875, "actor_loss": -8.6798677444458, "critic_loss": 0.12595456838607788, "alpha_loss": -0.306353896856308, "alpha_value": 0.9698740243911743, "log_alpha_value": -0.030589092522859573, "target_entropy": -6.0, "policy_t": -0.08797406405210495, "mean_q": 4.702670097351074, "max_q": 4.931621551513672, "min_q": 2.656728744506836}, "td_error": [0.5501992702484131, 0.30361270904541016, 0.25046873092651367, 1.4780387878417969, 0.011530399322509766, 1.7583377361297607, 1.1084213256835938, 1.9040849208831787, 1.9678146839141846, 1.1455657482147217, 1.9533405303955078, 0.21368098258972168, 1.3016102313995361, 1.84242844581604, 0.616889238357544, 0.2531394958496094, 0.9914774894714355, 0.13322901725769043, 0.3833911418914795, 2.8426170349121094, 0.6031124591827393, 0.6090812683105469, 1.4477391242980957, 1.1189255714416504, 1.370197057723999, 0.9701461791992188, 0.46665382385253906, 0.03436136245727539, 1.3289203643798828, 0.05684947967529297, 2.358640193939209, 1.0162100791931152, 1.369236707687378, 0.687739372253418, 1.7849454879760742, 1.0849790573120117, 1.7375779151916504, 0.5433084964752197, 0.8813369274139404, 0.8507583141326904, 0.9932425022125244, 1.1526293754577637, 0.7272264957427979, 0.9849708080291748, 2.3506972789764404, 0.2853274345397949, 0.808718204498291, 1.83929443359375, 0.49748873710632324, 0.742525577545166, 0.5601840019226074, 0.9327521324157715, 0.11760139465332031, 0.19089055061340332, 1.0100123882293701, 1.365086555480957, 2.2247490882873535, 0.848167896270752, 1.1830291748046875, 1.5603644847869873, 0.030534744262695312, 0.5400378704071045, 0.7427949905395508, 1.0838220119476318, 1.4670050144195557, 0.20493531227111816, 1.1583385467529297, 1.2646760940551758, 1.1520602703094482, 0.6054801940917969, 0.08999419212341309, 0.048567771911621094, 0.8582580089569092, 1.199390172958374, 0.17366361618041992, 0.8897559642791748, 1.048340082168579, 1.7703720331192017, 1.2408239841461182, 0.5296549797058105, 0.08942031860351562, 3.7470738887786865, 0.9687376022338867, 0.030082225799560547, 1.524707317352295, 1.3830113410949707], "mean_td_error": 0.9947336912155151, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 103.0, "diff_num_grad_updates_vs_sampler_policy": 102.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.098498344421387, "actor_loss": -6.528192043304443, "critic_loss": 0.10897214710712433, "alpha_loss": -0.3088602125644684, "alpha_value": 0.9698781967163086, "log_alpha_value": -0.03058476559817791, "target_entropy": -6.0, "policy_t": -0.0009631944121792912, "mean_q": 2.5780651569366455, "max_q": 2.761976957321167, "min_q": 2.0523321628570557}, "td_error": [0.368009090423584, 0.9084882736206055, 0.11938989162445068, 1.058112382888794, 1.2854372262954712, 0.3210940361022949, 1.6857953071594238, 0.8766782283782959, 0.662013053894043, 0.7517753839492798, 0.671974778175354, 0.11021888256072998, 0.0938572883605957, 2.0926921367645264, 1.5345267057418823, 0.5468858480453491, 0.5659763813018799, 1.6771807670593262, 1.1112687587738037, 0.6714601516723633, 0.046010732650756836, 0.4430866241455078, 1.7762420177459717, 1.4812536239624023, 1.1920232772827148, 0.5872114896774292, 0.8184897899627686, 0.12271237373352051, 0.9236613512039185, 0.7015130519866943, 1.41800057888031, 0.48471665382385254, 2.129155158996582, 0.3452976942062378, 0.26014506816864014, 0.6894664764404297, 0.40936875343322754, 0.15438389778137207, 0.07852685451507568, 0.24809134006500244, 0.02197742462158203, 0.5985879898071289, 0.5893397331237793, 1.3606185913085938, 0.22512125968933105, 0.9231460094451904, 0.46403324604034424, 0.42807531356811523, 0.9320409297943115, 1.3497681617736816, 1.4858193397521973, 1.2087085247039795, 0.4133610725402832, 0.7199558019638062, 1.5207605361938477, 1.109891653060913, 0.408488392829895, 0.49729323387145996, 0.21695399284362793, 0.9259219169616699, 0.07585644721984863, 2.5792152881622314, 0.40094172954559326, 1.0218889713287354, 0.1805800199508667, 0.9174036979675293, 0.5834436416625977, 1.0773794651031494, 0.4018242359161377, 1.2278167009353638, 0.4885222911834717, 1.3433773517608643, 0.8200151920318604, 0.5284684896469116, 0.3775125741958618, 0.5023961067199707, 2.002095937728882, 0.6497073173522949, 1.3582487106323242, 1.1304247379302979, 0.20706260204315186, 1.0546170473098755, 0.44572365283966064, 0.15337812900543213, 2.738537311553955, 0.2804896831512451], "mean_td_error": 0.8066161274909973, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 103.0, "diff_num_grad_updates_vs_sampler_policy": 102.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.070698738098145, "actor_loss": -6.5990190505981445, "critic_loss": 0.12136143445968628, "alpha_loss": -0.30816617608070374, "alpha_value": 0.9698631763458252, "log_alpha_value": -0.030600281432271004, "target_entropy": -6.0, "policy_t": -0.037430521100759506, "mean_q": 2.61883807182312, "max_q": 3.1673905849456787, "min_q": 2.2508792877197266}, "td_error": [0.23369717597961426, 1.1106048822402954, 0.3005458116531372, 0.4832005500793457, 1.1305571794509888, 0.38229846954345703, 0.00926971435546875, 0.32094359397888184, 0.6091088056564331, 0.1257491111755371, 1.0509134531021118, 0.8414506912231445, 2.3468406200408936, 0.7503604888916016, 0.9894027709960938, 1.8240797519683838, 0.7406743764877319, 0.7098382711410522, 0.5111038684844971, 0.09150910377502441, 0.4901556968688965, 0.40827274322509766, 0.7096618413925171, 2.27459454536438, 1.0983800888061523, 0.7007116079330444, 0.13296043872833252, 0.8107258081436157, 2.0605757236480713, 0.7601141929626465, 0.08701705932617188, 0.691669225692749, 0.7912989854812622, 0.647232174873352, 1.156166672706604, 1.7177727222442627, 0.630881667137146, 0.2699037790298462, 0.19514024257659912, 0.14751875400543213, 0.07668447494506836, 1.5090594291687012, 0.7631838321685791, 0.0413205623626709, 0.03869795799255371, 1.9255297183990479, 0.03574514389038086, 0.13161957263946533, 0.8043639659881592, 0.5919457674026489, 1.0622920989990234, 1.678772211074829, 0.21040916442871094, 1.6676669120788574, 1.3597100973129272, 0.4370584487915039, 0.6224067211151123, 0.8996763229370117, 0.4291214942932129, 0.8466223478317261, 1.371671438217163, 0.9366908073425293, 0.9099229574203491, 1.1644586324691772, 4.9171142578125, 0.09701430797576904, 0.5627467632293701, 1.7717971801757812, 2.210634469985962, 1.3382984399795532, 1.10023033618927, 0.12557005882263184, 0.15295779705047607, 1.9485576152801514, 0.332517147064209, 0.23633229732513428, 1.033577799797058, 0.14197421073913574, 1.5265042781829834, 0.7767640352249146, 1.3623862266540527, 2.049431085586548, 0.5113859176635742, 1.1653876304626465, 0.8492740392684937, 0.035469651222229004], "mean_td_error": 0.8616681694984436, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 103.0, "diff_num_grad_updates_vs_sampler_policy": 102.0}}, "num_env_steps_sampled": 93184, "num_env_steps_trained": 26574, "num_agent_steps_sampled": 279552, "num_agent_steps_trained": 26574, "last_target_update_ts": 93184, "num_target_updates": 103}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 279552, "num_agent_steps_trained": 26574, "num_env_steps_sampled": 93184, "num_env_steps_trained": 26574, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 763.3276543591533, "num_env_steps_trained_throughput_per_sec": 219.79747190252405, "timesteps_total": 93184, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 279552, "timers": {"training_iteration_time_ms": 1131.75, "sample_time_ms": 835.8, "load_time_ms": 0.319, "load_throughput": 809069.482, "learn_time_ms": 18.825, "learn_throughput": 13704.879, "synch_weights_time_ms": 11.981}, "counters": {"num_env_steps_sampled": 93184, "num_env_steps_trained": 26574, "num_agent_steps_sampled": 279552, "num_agent_steps_trained": 26574, "last_target_update_ts": 93184, "num_target_updates": 103}, "done": false, "episodes_total": 0, "training_iteration": 62, "trial_id": "7066a_00000", "date": "2023-11-18_21-08-38", "timestamp": 1700370518, "time_this_iter_s": 1.186582088470459, "time_total_s": 101.87019109725952, "pid": 7187, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x31246a200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 101.87019109725952, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 83.9, "ram_util_percent": 66.25}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.050588607788086, "actor_loss": -8.698604583740234, "critic_loss": 0.10558507591485977, "alpha_loss": -0.3104339838027954, "alpha_value": 0.9695850014686584, "log_alpha_value": -0.030887143686413765, "target_entropy": -6.0, "policy_t": -0.06282084435224533, "mean_q": 4.662825107574463, "max_q": 4.913404941558838, "min_q": 2.6941895484924316}, "td_error": [0.23723077774047852, 0.18486475944519043, 2.1546194553375244, 0.17950749397277832, 0.6681101322174072, 1.7330741882324219, 1.1494355201721191, 0.8275532722473145, 0.36661791801452637, 1.1628828048706055, 1.6414437294006348, 0.38805460929870605, 0.04934883117675781, 0.6804749965667725, 0.6175632476806641, 1.5870985984802246, 0.30344152450561523, 1.29876708984375, 1.0360727310180664, 1.8049142360687256, 1.9421470165252686, 1.1140170097351074, 1.941904067993164, 2.3341286182403564, 1.2289645671844482, 1.1770410537719727, 1.1070051193237305, 1.4922618865966797, 0.6257257461547852, 1.5960540771484375, 1.1168239116668701, 0.4302065372467041, 1.2668418884277344, 0.6606864929199219, 1.0487170219421387, 1.323869228363037, 0.17644166946411133, 0.8620944023132324, 1.0944139957427979, 0.15210652351379395, 1.6310641765594482, 0.21207070350646973, 1.4304566383361816, 1.4726523160934448, 1.0187196731567383, 0.7525594234466553, 0.6886656284332275, 0.5171301364898682, 0.6547839641571045, 0.10521435737609863, 0.6780095100402832, 1.7755889892578125, 0.03791308403015137, 0.8801333904266357, 0.14249348640441895, 0.10158395767211914, 0.6315256357192993, 1.9819490909576416, 1.3947622776031494, 0.34324169158935547, 0.6818757057189941, 0.3875408172607422, 2.1156742572784424, 0.6419174671173096, 0.7533600330352783, 0.6410598754882812, 0.030855894088745117, 0.520371675491333, 0.5026085376739502, 0.5412633419036865, 0.39809322357177734, 0.19018983840942383, 0.6235635280609131, 0.19634079933166504, 0.16900861263275146, 1.1531057357788086, 1.0287189483642578, 0.6822292804718018, 0.10067486763000488, 0.13841915130615234, 0.16960501670837402, 0.06185317039489746, 1.9553239345550537, 2.541640043258667, 2.1309804916381836, 0.11015653610229492], "mean_td_error": 0.8799938559532166, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 104.0, "diff_num_grad_updates_vs_sampler_policy": 103.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.059154510498047, "actor_loss": -6.468657970428467, "critic_loss": 0.13309350609779358, "alpha_loss": -0.3106740415096283, "alpha_value": 0.9695873260498047, "log_alpha_value": -0.03088470548391342, "target_entropy": -6.0, "policy_t": -0.01856907084584236, "mean_q": 2.5868334770202637, "max_q": 3.2551004886627197, "min_q": 2.044337749481201}, "td_error": [1.652925729751587, 0.7650730609893799, 0.11784160137176514, 0.9556140899658203, 0.12579882144927979, 1.8748469352722168, 1.2936005592346191, 0.32907843589782715, 1.2745243310928345, 0.6347461938858032, 1.1609339714050293, 1.0684058666229248, 0.16432487964630127, 0.632297158241272, 2.4387683868408203, 0.28584718704223633, 0.740463376045227, 0.14766252040863037, 0.9810649156570435, 0.474698543548584, 0.020488619804382324, 1.7157838344573975, 0.5217640399932861, 0.23729372024536133, 0.05279660224914551, 1.1290799379348755, 0.5283360481262207, 0.39577317237854004, 0.8801792860031128, 0.9037988185882568, 1.6577364206314087, 0.45610249042510986, 2.852344512939453, 1.5584468841552734, 2.883692741394043, 0.2447575330734253, 0.8653576374053955, 1.101401686668396, 0.8444517850875854, 1.392492651939392, 1.9779324531555176, 0.5004301071166992, 0.7070784568786621, 0.5180840492248535, 0.8863620758056641, 1.5332626104354858, 2.2819881439208984, 1.3556909561157227, 0.1830388307571411, 0.27508652210235596, 0.7991018295288086, 2.373490810394287, 0.02051258087158203, 1.5446382761001587, 1.024903655052185, 0.0890049934387207, 0.6025986671447754, 0.7122513055801392, 0.22786474227905273, 0.34712672233581543, 0.6701102256774902, 0.3944380283355713, 0.5087193250656128, 1.6962335109710693, 0.921013593673706, 0.18063604831695557, 0.8741998672485352, 0.7098041772842407, 1.0250654220581055, 2.2080793380737305, 2.1631827354431152, 0.3311185836791992, 0.08970022201538086, 0.04018270969390869, 1.0027120113372803, 0.3730645179748535, 0.43736493587493896, 0.9681954383850098, 1.528111219406128, 0.43083882331848145, 0.737001895904541, 1.6294631958007812, 0.21588146686553955, 1.3054519891738892, 1.5157601833343506, 1.1164791584014893], "mean_td_error": 0.9115564227104187, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 104.0, "diff_num_grad_updates_vs_sampler_policy": 103.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.031563758850098, "actor_loss": -6.596603870391846, "critic_loss": 0.11815637350082397, "alpha_loss": -0.30997779965400696, "alpha_value": 0.9695723056793213, "log_alpha_value": -0.030900243669748306, "target_entropy": -6.0, "policy_t": -0.04769391193985939, "mean_q": 2.6320128440856934, "max_q": 3.8214609622955322, "min_q": 2.254775047302246}, "td_error": [0.05986452102661133, 0.6081972122192383, 0.9246393442153931, 0.33774375915527344, 0.568333625793457, 0.9388394355773926, 2.1348488330841064, 0.34648025035858154, 0.3183540105819702, 1.6820142269134521, 1.6840636730194092, 1.6510080099105835, 0.02715778350830078, 0.18647193908691406, 1.7190831899642944, 0.5163698196411133, 1.055516004562378, 0.8460003137588501, 0.3002133369445801, 0.7588070631027222, 0.6870641708374023, 0.8632756471633911, 0.009523868560791016, 0.2568897008895874, 1.0492132902145386, 0.9488157033920288, 0.5694108009338379, 0.18618929386138916, 0.9996984004974365, 1.5502264499664307, 0.2629936933517456, 0.7709618806838989, 0.3716750144958496, 1.6816020011901855, 0.691215991973877, 1.0260963439941406, 0.9497923851013184, 0.4198625087738037, 0.720280647277832, 2.1037800312042236, 1.070613145828247, 0.3133586645126343, 0.8150074481964111, 0.8316148519515991, 0.0519481897354126, 1.5728015899658203, 0.7685651779174805, 0.3791310787200928, 1.0774354934692383, 1.441529393196106, 0.7385547161102295, 0.506903886795044, 1.15964674949646, 3.1828134059906006, 0.4601616859436035, 1.548155426979065, 1.0218867063522339, 0.799402117729187, 0.05505108833312988, 0.8283714056015015, 1.367255687713623, 0.06454837322235107, 0.6188477277755737, 1.2132112979888916, 0.5782015323638916, 0.4313465356826782, 1.8895689249038696, 0.3439897298812866, 1.1826417446136475, 0.9308340549468994, 1.3606773614883423, 0.09776020050048828, 1.0243773460388184, 1.0719321966171265, 1.2742199897766113, 1.524056315422058, 1.8013687133789062, 0.3239251375198364, 0.8958958387374878, 0.4301280975341797, 0.47512948513031006, 2.569100856781006, 0.03548240661621094, 2.0542373657226562, 0.588391900062561, 0.05326712131500244], "mean_td_error": 0.8791385889053345, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 104.0, "diff_num_grad_updates_vs_sampler_policy": 103.0}}, "num_env_steps_sampled": 94080, "num_env_steps_trained": 26832, "num_agent_steps_sampled": 282240, "num_agent_steps_trained": 26832, "last_target_update_ts": 94080, "num_target_updates": 104}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 282240, "num_agent_steps_trained": 26832, "num_env_steps_sampled": 94080, "num_env_steps_trained": 26832, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 839.9720755562101, "num_env_steps_trained_throughput_per_sec": 241.8669592561409, "timesteps_total": 94080, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 282240, "timers": {"training_iteration_time_ms": 1140.452, "sample_time_ms": 845.614, "load_time_ms": 0.32, "load_throughput": 805996.151, "learn_time_ms": 18.926, "learn_throughput": 13631.817, "synch_weights_time_ms": 12.4}, "counters": {"num_env_steps_sampled": 94080, "num_env_steps_trained": 26832, "num_agent_steps_sampled": 282240, "num_agent_steps_trained": 26832, "last_target_update_ts": 94080, "num_target_updates": 104}, "done": false, "episodes_total": 0, "training_iteration": 63, "trial_id": "7066a_00000", "date": "2023-11-18_21-08-39", "timestamp": 1700370519, "time_this_iter_s": 1.0798840522766113, "time_total_s": 102.95007514953613, "pid": 7187, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x31246b2e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 102.95007514953613, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 77.0, "ram_util_percent": 66.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.047324180603027, "actor_loss": -8.686846733093262, "critic_loss": 0.12472295761108398, "alpha_loss": -0.31332916021347046, "alpha_value": 0.9692959189414978, "log_alpha_value": -0.0311853289604187, "target_entropy": -6.0, "policy_t": -0.0714421421289444, "mean_q": 4.659486293792725, "max_q": 4.896681785583496, "min_q": 3.3773317337036133}, "td_error": [1.2932403087615967, 0.20568037033081055, 0.07930445671081543, 0.11790919303894043, 0.1535511016845703, 0.2772555351257324, 1.2926254272460938, 1.827209234237671, 0.025348663330078125, 0.4108409881591797, 0.9868719577789307, 0.91290283203125, 1.5380922555923462, 1.9404873847961426, 1.1599267721176147, 1.1639561653137207, 1.1488370895385742, 1.6784965991973877, 2.3307032585144043, 1.908078670501709, 0.8540472984313965, 1.4499950408935547, 1.3267250061035156, 1.253338098526001, 0.25345659255981445, 0.5267000198364258, 0.640507698059082, 0.4375026226043701, 0.3775320053100586, 0.6020832061767578, 1.504610300064087, 0.2968015670776367, 1.0575695037841797, 0.2845759391784668, 1.4207775592803955, 0.11148548126220703, 0.4261434078216553, 0.1503584384918213, 0.8966200351715088, 0.8594543933868408, 1.6215717792510986, 0.2918863296508789, 3.3008439540863037, 0.9796543121337891, 2.8235254287719727, 0.35012149810791016, 0.3332219123840332, 1.2084565162658691, 0.4431633949279785, 0.2240161895751953, 1.6031367778778076, 1.7455713748931885, 0.13498544692993164, 0.886106014251709, 1.4043076038360596, 1.496380090713501, 0.13022184371948242, 0.8352859020233154, 1.3303616046905518, 0.34633684158325195, 0.6597797870635986, 1.1493310928344727, 1.639876127243042, 3.2331583499908447, 1.480130672454834, 2.0436904430389404, 0.0865473747253418, 0.5603137016296387, 1.3742351531982422, 0.551025390625, 1.7153222560882568, 1.1704189777374268, 1.1201696395874023, 0.9369807243347168, 2.484480619430542, 0.7931783199310303, 1.3030896186828613, 0.2078256607055664, 0.8081049919128418, 0.05636787414550781, 0.34392833709716797, 2.9220080375671387, 0.3822932243347168, 1.0416998863220215, 1.3542652130126953, 0.5014026165008545], "mean_td_error": 1.0068649053573608, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 105.0, "diff_num_grad_updates_vs_sampler_policy": 104.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.04593563079834, "actor_loss": -6.498745441436768, "critic_loss": 0.11568811535835266, "alpha_loss": -0.31327831745147705, "alpha_value": 0.9692966341972351, "log_alpha_value": -0.03118458390235901, "target_entropy": -6.0, "policy_t": -0.03466127812862396, "mean_q": 2.5638561248779297, "max_q": 2.7767863273620605, "min_q": 2.1940765380859375}, "td_error": [1.8345123529434204, 0.07831788063049316, 0.48540186882019043, 0.630614161491394, 1.1505634784698486, 0.30684638023376465, 1.6460238695144653, 0.374969482421875, 0.9381022453308105, 0.26998066902160645, 1.1454118490219116, 0.5613486766815186, 2.193946361541748, 1.28277587890625, 0.0411607027053833, 0.07481050491333008, 1.0056465864181519, 1.142834186553955, 0.8133480548858643, 0.12014555931091309, 0.9071621894836426, 1.4229097366333008, 1.5577374696731567, 0.7969088554382324, 0.35683774948120117, 0.4773721694946289, 0.653304934501648, 0.9052218198776245, 0.8958327770233154, 0.3251763582229614, 1.2586604356765747, 0.6479887962341309, 0.23730802536010742, 1.116428256034851, 1.2313629388809204, 0.7582666873931885, 1.0946710109710693, 1.2805758714675903, 1.3974326848983765, 0.6791216135025024, 0.1604166030883789, 0.5337951183319092, 0.9300453662872314, 0.6935839653015137, 0.21739482879638672, 0.6349643468856812, 0.021709084510803223, 0.3110121488571167, 0.3242039680480957, 2.4340522289276123, 0.5882829427719116, 0.1937084197998047, 0.43294429779052734, 1.6663801670074463, 1.2327263355255127, 0.8569188117980957, 0.2549619674682617, 1.2041276693344116, 1.142683744430542, 1.596764326095581, 0.0508960485458374, 0.006290078163146973, 0.10290491580963135, 1.3846144676208496, 0.0875091552734375, 0.38588082790374756, 0.2509499788284302, 0.43266963958740234, 0.2020045518875122, 0.41735994815826416, 1.1461851596832275, 2.3379664421081543, 0.5885041952133179, 0.3044157028198242, 0.9518204927444458, 0.1667625904083252, 2.223820924758911, 0.8388184309005737, 1.372268795967102, 0.012233614921569824, 1.4174569845199585, 2.426398515701294, 1.3063178062438965, 0.3838975429534912, 1.0407747030258179, 1.4867087602615356], "mean_td_error": 0.8238738179206848, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 105.0, "diff_num_grad_updates_vs_sampler_policy": 104.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.168170928955078, "actor_loss": -6.724142551422119, "critic_loss": 0.10570116341114044, "alpha_loss": -0.31724783778190613, "alpha_value": 0.9692816138267517, "log_alpha_value": -0.031200088560581207, "target_entropy": -6.0, "policy_t": 0.0015969201922416687, "mean_q": 2.6174845695495605, "max_q": 2.709015130996704, "min_q": 2.2609896659851074}, "td_error": [0.8262524604797363, 0.10659468173980713, 0.6792473793029785, 0.18795382976531982, 1.1132173538208008, 0.588653564453125, 1.4314075708389282, 0.9726210832595825, 0.46576178073883057, 0.8643063306808472, 0.8921834230422974, 1.8286452293395996, 0.8349908590316772, 1.2891504764556885, 0.4588116407394409, 0.16577422618865967, 0.43558835983276367, 1.5834404230117798, 1.2655894756317139, 0.6761236190795898, 0.4565463066101074, 0.8800315856933594, 0.549246072769165, 0.3183128833770752, 1.2159910202026367, 0.24399292469024658, 2.232365608215332, 2.855550765991211, 0.7332936525344849, 2.0520362854003906, 0.8229279518127441, 1.2743146419525146, 0.22736752033233643, 0.2794349193572998, 0.9959862232208252, 1.143074870109558, 0.8535770177841187, 1.3900086879730225, 0.6470983028411865, 0.8027439117431641, 0.5386534929275513, 0.8772317171096802, 1.5150132179260254, 1.8956489562988281, 0.7927632331848145, 0.5623079538345337, 2.225433111190796, 0.2015146017074585, 1.0832139253616333, 1.1084142923355103, 1.8470160961151123, 0.24987292289733887, 1.3878391981124878, 0.10704326629638672, 0.3571937084197998, 0.42163825035095215, 0.12052154541015625, 0.2605412006378174, 0.3813244104385376, 0.40013837814331055, 0.12316310405731201, 0.140128493309021, 0.7264449596405029, 0.9243459701538086, 0.06221461296081543, 0.4580730199813843, 1.2398055791854858, 0.5017372369766235, 0.029503464698791504, 0.28131628036499023, 0.6645393371582031, 1.0687804222106934, 0.05138206481933594, 0.04439282417297363, 0.7568851709365845, 0.6813250780105591, 1.1824979782104492, 0.7624467611312866, 0.6693642139434814, 0.6175497770309448, 0.23703551292419434, 1.1168403625488281, 2.2986602783203125, 1.6681660413742065, 0.895745038986206, 0.3138178586959839], "mean_td_error": 0.8196476697921753, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 105.0, "diff_num_grad_updates_vs_sampler_policy": 104.0}}, "num_env_steps_sampled": 94976, "num_env_steps_trained": 27090, "num_agent_steps_sampled": 284928, "num_agent_steps_trained": 27090, "last_target_update_ts": 94976, "num_target_updates": 105}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 284928, "num_agent_steps_trained": 27090, "num_env_steps_sampled": 94976, "num_env_steps_trained": 27090, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 734.4414262807202, "num_env_steps_trained_throughput_per_sec": 211.47978569243952, "timesteps_total": 94976, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 284928, "timers": {"training_iteration_time_ms": 1158.247, "sample_time_ms": 855.296, "load_time_ms": 0.318, "load_throughput": 810706.047, "learn_time_ms": 18.827, "learn_throughput": 13703.422, "synch_weights_time_ms": 12.287}, "counters": {"num_env_steps_sampled": 94976, "num_env_steps_trained": 27090, "num_agent_steps_sampled": 284928, "num_agent_steps_trained": 27090, "last_target_update_ts": 94976, "num_target_updates": 105}, "done": false, "episodes_total": 0, "training_iteration": 64, "trial_id": "7066a_00000", "date": "2023-11-18_21-08-41", "timestamp": 1700370521, "time_this_iter_s": 1.228039026260376, "time_total_s": 104.17811417579651, "pid": 7187, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x31246a520>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 104.17811417579651, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 89.7, "ram_util_percent": 66.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.077224731445312, "actor_loss": -8.665492057800293, "critic_loss": 0.09341373294591904, "alpha_loss": -0.31726762652397156, "alpha_value": 0.9690068364143372, "log_alpha_value": -0.03148362785577774, "target_entropy": -6.0, "policy_t": -0.04571323096752167, "mean_q": 4.640712738037109, "max_q": 4.882094383239746, "min_q": 2.960806369781494}, "td_error": [0.4855051040649414, 1.2579975128173828, 1.9596965312957764, 0.5343227386474609, 1.0120601654052734, 0.04982304573059082, 0.6982691287994385, 0.5518214702606201, 0.22385311126708984, 1.253899335861206, 0.42557430267333984, 0.591071605682373, 0.4098234176635742, 0.12229156494140625, 2.625392198562622, 0.6868069171905518, 1.3801891803741455, 0.5394501686096191, 0.24877715110778809, 2.122634172439575, 0.4986915588378906, 1.6479918956756592, 0.594702959060669, 1.0514440536499023, 0.49831461906433105, 0.7445096969604492, 0.0878908634185791, 1.0906774997711182, 0.050127506256103516, 0.944777250289917, 0.6547930240631104, 1.756394386291504, 0.7336280345916748, 0.48363423347473145, 1.2259106636047363, 0.740623950958252, 1.4622893333435059, 2.2002358436584473, 0.9637818336486816, 0.1377100944519043, 1.0231103897094727, 0.571244478225708, 0.3347599506378174, 1.8911864757537842, 1.7421178817749023, 0.43522214889526367, 1.392646074295044, 0.5488708019256592, 0.5203456878662109, 0.6853976249694824, 1.6176369190216064, 0.503758430480957, 0.5617804527282715, 1.1693370342254639, 0.4780287742614746, 1.1795074939727783, 0.011126041412353516, 0.7005228996276855, 1.4759669303894043, 0.8434183597564697, 1.5275254249572754, 0.7904040813446045, 0.11811041831970215, 0.6236395835876465, 0.04445457458496094, 0.278841495513916, 0.01996016502380371, 0.7534902095794678, 1.6819167137145996, 0.3831338882446289, 0.12271499633789062, 0.5073039531707764, 0.769096851348877, 0.9630022048950195, 0.3240063190460205, 0.5847439765930176, 0.6119468212127686, 0.8261673450469971, 0.6372330188751221, 0.04308128356933594, 0.7318296432495117, 1.3485805988311768, 1.1475858688354492, 3.663684368133545, 0.6259098052978516, 0.5016655921936035], "mean_td_error": 0.8379465341567993, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 106.0, "diff_num_grad_updates_vs_sampler_policy": 105.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.074910163879395, "actor_loss": -6.487339973449707, "critic_loss": 0.1171068325638771, "alpha_loss": -0.3172021806240082, "alpha_value": 0.9690061211585999, "log_alpha_value": -0.031484369188547134, "target_entropy": -6.0, "policy_t": -0.04935319349169731, "mean_q": 2.5658113956451416, "max_q": 2.632930278778076, "min_q": 2.064999580383301}, "td_error": [1.0094259977340698, 0.7988159656524658, 0.6515493392944336, 0.06393265724182129, 0.40049123764038086, 0.8987047672271729, 1.176391363143921, 0.25239694118499756, 0.7278714179992676, 0.1301710605621338, 0.7470461130142212, 1.2187055349349976, 0.1126711368560791, 0.02279210090637207, 0.29998135566711426, 1.4609861373901367, 0.7261286973953247, 0.1523076295852661, 1.5007944107055664, 1.0286961793899536, 0.3454713821411133, 0.20030665397644043, 1.353829264640808, 0.8686378002166748, 0.29221057891845703, 0.4909888505935669, 1.7613179683685303, 1.059873104095459, 1.7232482433319092, 1.0283031463623047, 1.6302605867385864, 0.4722963571548462, 0.4344102144241333, 0.6904556751251221, 0.6674143075942993, 0.5715585947036743, 0.43388545513153076, 1.147923469543457, 2.79978084564209, 0.16207599639892578, 0.8883000612258911, 1.1977823972702026, 1.3394052982330322, 0.6748436689376831, 1.697007417678833, 1.9316301345825195, 0.7416924238204956, 2.0769362449645996, 0.6555448770523071, 1.235904574394226, 0.3461071252822876, 1.6874451637268066, 0.20606136322021484, 0.6192346811294556, 0.6557183265686035, 0.5952847003936768, 0.06701862812042236, 0.2736244201660156, 0.34197425842285156, 1.6046510934829712, 1.1730101108551025, 0.8426419496536255, 0.6135523319244385, 1.3282179832458496, 1.100935459136963, 0.436816930770874, 0.6923950910568237, 0.5339422225952148, 1.6960525512695312, 1.4034087657928467, 0.08052301406860352, 0.7354234457015991, 0.04202425479888916, 1.5717110633850098, 1.2487603425979614, 0.9605553150177002, 0.36212897300720215, 2.0371785163879395, 0.3237004280090332, 2.1471338272094727, 0.5773975849151611, 0.3030436038970947, 0.14356887340545654, 0.6966387033462524, 0.09642291069030762, 0.3324483633041382], "mean_td_error": 0.8352314233779907, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 106.0, "diff_num_grad_updates_vs_sampler_policy": 105.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.061691284179688, "actor_loss": -6.617331027984619, "critic_loss": 0.12275545299053192, "alpha_loss": -0.31694522500038147, "alpha_value": 0.9689907431602478, "log_alpha_value": -0.031500194221735, "target_entropy": -6.0, "policy_t": -0.03547130897641182, "mean_q": 2.6547956466674805, "max_q": 3.7869200706481934, "min_q": 2.491947889328003}, "td_error": [0.5422141551971436, 0.7647433280944824, 0.5559055805206299, 0.4105476140975952, 0.9674649238586426, 0.1460016965866089, 1.4278849363327026, 0.15706682205200195, 0.8124922513961792, 0.4908031225204468, 0.8987832069396973, 0.6896927356719971, 1.4043753147125244, 1.5630238056182861, 1.2177293300628662, 0.2703416347503662, 0.8721632957458496, 0.12300801277160645, 0.22713994979858398, 1.2642799615859985, 0.19656813144683838, 3.4302573204040527, 1.9922430515289307, 0.00648951530456543, 1.0612678527832031, 0.3756284713745117, 1.1464259624481201, 0.6233757734298706, 0.4040038585662842, 0.6544060707092285, 1.5757958889007568, 1.9758899211883545, 0.44884002208709717, 0.2553173303604126, 0.11728191375732422, 0.28057861328125, 1.35507333278656, 1.682546854019165, 0.08499252796173096, 0.3079763650894165, 0.7603496313095093, 1.5993350744247437, 2.233386516571045, 0.517717719078064, 0.11470746994018555, 0.10602641105651855, 0.47055840492248535, 1.305242657661438, 2.297661304473877, 0.2671685218811035, 0.6367470026016235, 1.673816442489624, 0.6822019815444946, 0.6139645576477051, 0.7541161775588989, 0.9403809309005737, 0.6717021465301514, 0.8408794403076172, 2.120389938354492, 0.0952613353729248, 0.5157501697540283, 0.7165857553482056, 1.652767300605774, 0.24006986618041992, 0.9914348125457764, 0.9692156314849854, 1.4805660247802734, 0.12814056873321533, 0.3023488521575928, 0.7878667116165161, 1.4478974342346191, 1.5694705247879028, 1.0208680629730225, 0.3138461112976074, 0.030089497566223145, 0.682425856590271, 1.98848295211792, 0.4675561189651489, 1.168271780014038, 0.9883338212966919, 0.41861891746520996, 2.384575605392456, 0.5524001121520996, 1.426252007484436, 0.852266788482666, 1.6835427284240723], "mean_td_error": 0.8867660164833069, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 106.0, "diff_num_grad_updates_vs_sampler_policy": 105.0}}, "num_env_steps_sampled": 95872, "num_env_steps_trained": 27348, "num_agent_steps_sampled": 287616, "num_agent_steps_trained": 27348, "last_target_update_ts": 95872, "num_target_updates": 106}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 287616, "num_agent_steps_trained": 27348, "num_env_steps_sampled": 95872, "num_env_steps_trained": 27348, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 885.5241680869327, "num_env_steps_trained_throughput_per_sec": 254.9835216143177, "timesteps_total": 95872, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 287616, "timers": {"training_iteration_time_ms": 1166.718, "sample_time_ms": 864.256, "load_time_ms": 0.325, "load_throughput": 792769.547, "learn_time_ms": 18.845, "learn_throughput": 13690.887, "synch_weights_time_ms": 12.365}, "counters": {"num_env_steps_sampled": 95872, "num_env_steps_trained": 27348, "num_agent_steps_sampled": 287616, "num_agent_steps_trained": 27348, "last_target_update_ts": 95872, "num_target_updates": 106}, "done": false, "episodes_total": 0, "training_iteration": 65, "trial_id": "7066a_00000", "date": "2023-11-18_21-08-42", "timestamp": 1700370522, "time_this_iter_s": 1.0215330123901367, "time_total_s": 105.19964718818665, "pid": 7187, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x312468b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 105.19964718818665, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 82.0, "ram_util_percent": 66.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.99895191192627, "actor_loss": -8.619451522827148, "critic_loss": 0.10258311033248901, "alpha_loss": -0.3207712769508362, "alpha_value": 0.9684286117553711, "log_alpha_value": -0.03208049014210701, "target_entropy": -6.0, "policy_t": -0.08376292884349823, "mean_q": 4.637688636779785, "max_q": 4.857438087463379, "min_q": 2.839235544204712}, "td_error": [1.2409694194793701, 1.825793743133545, 0.2460474967956543, 0.09890866279602051, 0.9262027740478516, 0.5986027717590332, 1.3958170413970947, 1.2651112079620361, 0.24703025817871094, 0.9666621685028076, 0.6217098236083984, 0.7220497131347656, 1.0530033111572266, 0.04024314880371094, 1.6415824890136719, 0.2640724182128906, 0.7229452133178711, 0.052861928939819336, 1.8356361389160156, 1.5480055809020996, 1.9469397068023682, 1.834211826324463, 1.846261978149414, 0.6754050254821777, 0.23906731605529785, 0.03881645202636719, 0.07060456275939941, 0.19968318939208984, 0.5114622116088867, 2.2912657260894775, 2.1559929847717285, 0.19638514518737793, 0.43361473083496094, 0.22187519073486328, 0.06378817558288574, 1.5960006713867188, 0.22231769561767578, 0.6085550785064697, 0.9931159019470215, 0.37943053245544434, 0.540985107421875, 1.867842674255371, 0.5771617889404297, 0.482180118560791, 0.047074317932128906, 0.2172374725341797, 0.5203530788421631, 0.868903636932373, 0.485623836517334, 1.0378103256225586, 0.40363359451293945, 0.48995304107666016, 0.7891585826873779, 0.7131814956665039, 0.3361330032348633, 2.271106004714966, 0.0804593563079834, 0.1089482307434082, 1.3290512561798096, 1.7686059474945068, 1.0064492225646973, 0.9820139408111572, 0.1777963638305664, 0.07979249954223633, 1.2160141468048096, 0.4563727378845215, 1.9345734119415283, 1.8061411380767822, 0.9255857467651367, 0.14118075370788574, 1.3943681716918945, 0.5600626468658447, 0.8863987922668457, 0.8153431415557861, 0.2715766429901123, 0.4626636505126953, 0.09913754463195801, 1.266489028930664, 1.0907649993896484, 0.5116848945617676, 0.7742242813110352, 2.008272886276245, 2.4267563819885254, 1.4498729705810547, 0.8181959390640259, 1.498478651046753], "mean_td_error": 0.8585309982299805, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 108.0, "diff_num_grad_updates_vs_sampler_policy": 107.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.139007568359375, "actor_loss": -6.547063827514648, "critic_loss": 0.09558424353599548, "alpha_loss": -0.3253006637096405, "alpha_value": 0.9684251546859741, "log_alpha_value": -0.03208407387137413, "target_entropy": -6.0, "policy_t": -0.026172878220677376, "mean_q": 2.570826768875122, "max_q": 2.6472439765930176, "min_q": 2.0129339694976807}, "td_error": [0.08368265628814697, 1.3037728071212769, 0.2172466516494751, 1.1508103609085083, 0.9988057613372803, 0.9572563171386719, 0.21259617805480957, 0.20998382568359375, 0.3828340768814087, 0.2880436182022095, 1.3641151189804077, 1.0390900373458862, 0.6080656051635742, 1.7118330001831055, 0.4286355972290039, 2.025872230529785, 0.410650372505188, 0.39412248134613037, 0.5356731414794922, 0.1959059238433838, 1.037419319152832, 0.298193097114563, 0.18700361251831055, 0.9590691328048706, 0.4775662422180176, 0.38712751865386963, 1.0326437950134277, 0.5754716396331787, 0.0906057357788086, 0.49054789543151855, 1.2172482013702393, 0.2433335781097412, 0.6355533599853516, 0.23961007595062256, 1.4464972019195557, 0.8547713756561279, 0.14405155181884766, 0.20631837844848633, 0.17334020137786865, 0.09437787532806396, 0.8263731002807617, 0.2253183126449585, 0.4474862813949585, 0.48510003089904785, 0.6950265169143677, 0.26772844791412354, 2.147277593612671, 0.45557165145874023, 1.6340004205703735, 0.9125758409500122, 0.8180394172668457, 0.4578835964202881, 0.9992488622665405, 0.24222218990325928, 0.4497032165527344, 0.9759680032730103, 0.6076738834381104, 0.3868147134780884, 0.11242961883544922, 0.5782018899917603, 0.30993354320526123, 1.6919695138931274, 1.3584898710250854, 1.1367104053497314, 1.508758306503296, 2.672273635864258, 2.3930068016052246, 0.14632821083068848, 1.4345406293869019, 0.040691375732421875, 0.7698889970779419, 0.3669530153274536, 0.7990550994873047, 0.3977022171020508, 0.5457018613815308, 1.2565829753875732, 0.2832425832748413, 1.5673305988311768, 0.7230762243270874, 0.29002833366394043, 0.07999444007873535, 1.904758334159851, 0.3242422342300415, 0.582721471786499, 0.05605769157409668, 0.7113054990768433], "mean_td_error": 0.7254155278205872, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 108.0, "diff_num_grad_updates_vs_sampler_policy": 107.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.018301010131836, "actor_loss": -6.612646579742432, "critic_loss": 0.1296055018901825, "alpha_loss": -0.3215905427932739, "alpha_value": 0.9684094190597534, "log_alpha_value": -0.03210030496120453, "target_entropy": -6.0, "policy_t": -0.04887747764587402, "mean_q": 2.6472721099853516, "max_q": 3.169506311416626, "min_q": 2.34110426902771}, "td_error": [0.884666919708252, 1.519294261932373, 0.6178396940231323, 0.25773680210113525, 1.9659132957458496, 1.2814526557922363, 0.6413049697875977, 2.284245491027832, 0.9723758697509766, 1.0753061771392822, 0.013227343559265137, 0.24282658100128174, 0.8350358009338379, 1.3936716318130493, 0.21064496040344238, 0.2556753158569336, 0.5718400478363037, 0.1946161985397339, 0.6232212781906128, 0.514663815498352, 0.0693439245223999, 0.9786627292633057, 0.26123297214508057, 1.454322338104248, 0.10117316246032715, 0.2816809415817261, 0.7121460437774658, 1.6251484155654907, 1.737500548362732, 2.1374893188476562, 0.2530587911605835, 1.8061813116073608, 1.9369174242019653, 1.8063945770263672, 0.905398964881897, 0.5443754196166992, 2.2232613563537598, 1.3497000932693481, 1.2728315591812134, 0.2540585994720459, 0.0840764045715332, 0.30412042140960693, 1.6542540788650513, 0.49622488021850586, 0.777161717414856, 2.078557014465332, 0.6920297145843506, 0.31864356994628906, 0.022376418113708496, 0.9050828218460083, 0.36497020721435547, 1.39189612865448, 0.6912356615066528, 1.908299446105957, 1.087322473526001, 1.1699851751327515, 1.171380639076233, 0.30100417137145996, 0.40736210346221924, 0.9455146789550781, 1.4691762924194336, 1.825833797454834, 0.3518354892730713, 1.803313136100769, 0.5590579509735107, 0.03658890724182129, 1.0547524690628052, 0.0570753812789917, 0.08721590042114258, 1.0285346508026123, 0.6477140188217163, 2.010014057159424, 0.6098952293395996, 1.0152721405029297, 1.0205878019332886, 1.5517853498458862, 2.211425304412842, 0.44835638999938965, 0.6182551383972168, 0.07103264331817627, 0.7393708229064941, 0.5281244516372681, 0.2837228775024414, 1.9426740407943726, 0.9282152652740479, 0.5277348756790161], "mean_td_error": 0.9100639820098877, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 108.0, "diff_num_grad_updates_vs_sampler_policy": 107.0}}, "num_env_steps_sampled": 97664, "num_env_steps_trained": 27864, "num_agent_steps_sampled": 292992, "num_agent_steps_trained": 27864, "last_target_update_ts": 97664, "num_target_updates": 108}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 292992, "num_agent_steps_trained": 27864, "num_env_steps_sampled": 97664, "num_env_steps_trained": 27864, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 883.8723963710889, "num_env_steps_trained_throughput_per_sec": 254.50789984792516, "timesteps_total": 97664, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 292992, "timers": {"training_iteration_time_ms": 1149.886, "sample_time_ms": 851.028, "load_time_ms": 0.325, "load_throughput": 793816.338, "learn_time_ms": 18.83, "learn_throughput": 13701.843, "synch_weights_time_ms": 12.098}, "counters": {"num_env_steps_sampled": 97664, "num_env_steps_trained": 27864, "num_agent_steps_sampled": 292992, "num_agent_steps_trained": 27864, "last_target_update_ts": 97664, "num_target_updates": 108}, "done": false, "episodes_total": 0, "training_iteration": 66, "trial_id": "7066a_00000", "date": "2023-11-18_21-08-44", "timestamp": 1700370524, "time_this_iter_s": 2.037868022918701, "time_total_s": 107.23751521110535, "pid": 7187, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x31246b100>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 107.23751521110535, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 73.76666666666667, "ram_util_percent": 66.03333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.033956527709961, "actor_loss": -8.552005767822266, "critic_loss": 0.11654368788003922, "alpha_loss": -0.3278835117816925, "alpha_value": 0.9678507447242737, "log_alpha_value": -0.032677389681339264, "target_entropy": -6.0, "policy_t": -0.039159536361694336, "mean_q": 4.63734769821167, "max_q": 4.835577011108398, "min_q": 3.077084541320801}, "td_error": [1.3173785209655762, 0.04568815231323242, 0.2403092384338379, 0.13201141357421875, 0.876166820526123, 1.1622183322906494, 2.07088565826416, 1.124124526977539, 0.8587636947631836, 1.56044340133667, 1.2767395973205566, 1.0354650020599365, 0.09609532356262207, 2.150301933288574, 2.300490140914917, 1.8389627933502197, 0.013241291046142578, 0.13749170303344727, 1.5767199993133545, 0.9896728992462158, 0.09074926376342773, 2.405524492263794, 1.3050451278686523, 0.4464888572692871, 0.3227396011352539, 0.4221768379211426, 0.8326797485351562, 0.4316399097442627, 1.6101880073547363, 0.7386069297790527, 0.29289913177490234, 0.5267772674560547, 0.19355463981628418, 2.7236669063568115, 1.058308482170105, 0.031922101974487305, 2.0931568145751953, 1.1728136539459229, 0.9423291683197021, 0.22545838356018066, 0.7512316703796387, 0.048235416412353516, 1.2470383644104004, 0.43497395515441895, 0.08748674392700195, 1.2774291038513184, 1.2721688747406006, 0.02619647979736328, 0.014354467391967773, 2.497375249862671, 0.14536428451538086, 1.4152235984802246, 0.11347341537475586, 1.6656808853149414, 1.077082633972168, 0.09343242645263672, 2.223600387573242, 1.268805742263794, 0.059450387954711914, 0.2801249027252197, 1.2221307754516602, 0.3313305377960205, 0.04131627082824707, 0.6061289310455322, 0.3238365650177002, 1.9945602416992188, 1.3334717750549316, 1.074880838394165, 2.6982550621032715, 0.9034769535064697, 1.7568809986114502, 0.2265605926513672, 0.3979630470275879, 1.4866564273834229, 1.9727568626403809, 0.12645578384399414, 0.11728429794311523, 1.6140506267547607, 1.0788404941558838, 0.8733296394348145, 0.583275318145752, 0.08327269554138184, 0.8846592903137207, 1.5805258750915527, 0.06634736061096191, 0.06516098976135254], "mean_td_error": 0.9082794189453125, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 110.0, "diff_num_grad_updates_vs_sampler_policy": 109.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.047675132751465, "actor_loss": -6.496510982513428, "critic_loss": 0.13113239407539368, "alpha_loss": -0.32840049266815186, "alpha_value": 0.9678441286087036, "log_alpha_value": -0.03268422558903694, "target_entropy": -6.0, "policy_t": -0.0384652279317379, "mean_q": 2.588465690612793, "max_q": 2.724599838256836, "min_q": 2.014910936355591}, "td_error": [0.7089532613754272, 0.3076108694076538, 0.7677174806594849, 2.2525877952575684, 1.266270399093628, 1.9289551973342896, 1.2734757661819458, 1.1572622060775757, 0.7740381956100464, 0.14025437831878662, 0.6101703643798828, 0.7947739362716675, 0.6673707962036133, 1.0173745155334473, 0.8174383640289307, 1.3808174133300781, 0.3014037609100342, 0.03732609748840332, 0.7310061454772949, 0.06827664375305176, 0.7377227544784546, 2.2752938270568848, 0.892532467842102, 0.8543705940246582, 1.3736393451690674, 0.2967108488082886, 0.6470241546630859, 1.231123924255371, 0.9230399131774902, 0.8156118392944336, 1.1671934127807617, 0.29669392108917236, 0.6759806871414185, 0.8155131340026855, 0.13763248920440674, 1.9898834228515625, 1.491472840309143, 0.36232948303222656, 0.2077646255493164, 1.997251272201538, 0.6356453895568848, 0.852827787399292, 1.6313207149505615, 1.3040457963943481, 0.1428152322769165, 0.10142230987548828, 0.8445029258728027, 0.3447185754776001, 1.4189283847808838, 1.3314921855926514, 0.8881908655166626, 1.4723923206329346, 2.298478364944458, 1.007651448249817, 0.05192303657531738, 2.215137481689453, 0.48067593574523926, 1.4633691310882568, 1.1571028232574463, 0.7176744937896729, 1.124895453453064, 1.4504199028015137, 0.6107723712921143, 0.39534544944763184, 1.38429856300354, 0.08115696907043457, 0.728561282157898, 0.6270946264266968, 0.711310625076294, 0.6897150278091431, 0.612646222114563, 0.1031191349029541, 1.053399920463562, 1.6155757904052734, 1.05290949344635, 0.024942636489868164, 1.110624074935913, 0.21791815757751465, 0.4096177816390991, 0.2788848876953125, 2.639620780944824, 1.698849081993103, 0.4168107509613037, 1.0808744430541992, 1.1523789167404175, 1.262270450592041], "mean_td_error": 0.9196069240570068, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 110.0, "diff_num_grad_updates_vs_sampler_policy": 109.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.100454330444336, "actor_loss": -6.662735939025879, "critic_loss": 0.1361023336648941, "alpha_loss": -0.3302846848964691, "alpha_value": 0.9678288698196411, "log_alpha_value": -0.032699983566999435, "target_entropy": -6.0, "policy_t": -0.0015446058241650462, "mean_q": 2.6732614040374756, "max_q": 3.651139736175537, "min_q": 2.3833084106445312}, "td_error": [0.14089298248291016, 0.7129032611846924, 1.8023638725280762, 0.41416335105895996, 0.13389921188354492, 1.5624626874923706, 0.5559465885162354, 1.327954649925232, 1.3208203315734863, 0.4486140012741089, 0.5666153430938721, 0.8164409399032593, 2.7996716499328613, 0.1820281744003296, 0.8302327394485474, 0.2379399538040161, 0.6781041622161865, 0.40368974208831787, 0.8835136890411377, 0.5818216800689697, 0.16220033168792725, 0.16399645805358887, 1.0350958108901978, 0.231101393699646, 1.189210057258606, 0.7641029357910156, 1.6195762157440186, 0.17795336246490479, 2.547550678253174, 0.6680358648300171, 0.7398935556411743, 1.1906291246414185, 1.211655855178833, 0.1580827236175537, 0.0027587413787841797, 1.182495355606079, 0.02596724033355713, 1.4524084329605103, 1.343495488166809, 1.7426837682724, 0.21120047569274902, 0.5143066644668579, 1.117677927017212, 1.6035114526748657, 1.6731727123260498, 0.230820894241333, 1.443560004234314, 1.115527629852295, 0.1946796178817749, 2.1954550743103027, 0.7934213876724243, 0.7159590721130371, 2.9041523933410645, 0.1076514720916748, 0.5900356769561768, 0.2844966650009155, 0.3403726816177368, 3.3404507637023926, 0.5425032377243042, 1.7796214818954468, 1.1820268630981445, 0.03168129920959473, 0.9998918771743774, 0.8987293243408203, 2.5658459663391113, 2.8460941314697266, 1.6934564113616943, 0.3579047918319702, 0.06609094142913818, 0.4582507610321045, 1.3092159032821655, 0.222739577293396, 0.7958154678344727, 1.174136996269226, 1.8176347017288208, 1.3560140132904053, 0.41295337677001953, 0.00599980354309082, 0.17564523220062256, 1.9291865825653076, 0.8536127805709839, 0.095054030418396, 0.3214319944381714, 1.9308656454086304, 0.28444719314575195, 0.969083309173584], "mean_td_error": 0.9355970621109009, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 110.0, "diff_num_grad_updates_vs_sampler_policy": 109.0}}, "num_env_steps_sampled": 99456, "num_env_steps_trained": 28380, "num_agent_steps_sampled": 298368, "num_agent_steps_trained": 28380, "last_target_update_ts": 99456, "num_target_updates": 110}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 298368, "num_agent_steps_trained": 28380, "num_env_steps_sampled": 99456, "num_env_steps_trained": 28380, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 862.8140986360861, "num_env_steps_trained_throughput_per_sec": 248.4442382233373, "timesteps_total": 99456, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 298368, "timers": {"training_iteration_time_ms": 1136.049, "sample_time_ms": 840.498, "load_time_ms": 0.322, "load_throughput": 800037.285, "learn_time_ms": 18.595, "learn_throughput": 13874.445, "synch_weights_time_ms": 11.479}, "counters": {"num_env_steps_sampled": 99456, "num_env_steps_trained": 28380, "num_agent_steps_sampled": 298368, "num_agent_steps_trained": 28380, "last_target_update_ts": 99456, "num_target_updates": 110}, "done": false, "episodes_total": 0, "training_iteration": 67, "trial_id": "7066a_00000", "date": "2023-11-18_21-08-46", "timestamp": 1700370526, "time_this_iter_s": 2.0878210067749023, "time_total_s": 109.32533621788025, "pid": 7187, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x312468e00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 109.32533621788025, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 77.4, "ram_util_percent": 66.03333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.996850967407227, "actor_loss": -8.583778381347656, "critic_loss": 0.1272207647562027, "alpha_loss": -0.33264100551605225, "alpha_value": 0.967272937297821, "log_alpha_value": -0.0332745797932148, "target_entropy": -6.0, "policy_t": -0.09174822270870209, "mean_q": 4.592223644256592, "max_q": 4.8184380531311035, "min_q": 2.9910271167755127}, "td_error": [1.3945469856262207, 0.2820017337799072, 1.6380679607391357, 0.28522682189941406, 2.6823301315307617, 1.3772385120391846, 0.5180952548980713, 0.6288895606994629, 0.9397127628326416, 0.825408935546875, 0.08757710456848145, 0.1630091667175293, 2.5218729972839355, 0.43786096572875977, 0.2711679935455322, 0.21401476860046387, 0.7953760623931885, 0.7302680015563965, 1.406285285949707, 1.8151028156280518, 3.7111623287200928, 0.9823746681213379, 0.5654871463775635, 3.1437110900878906, 1.6966536045074463, 0.9982151985168457, 2.111250162124634, 1.4368896484375, 1.9994359016418457, 1.975687026977539, 0.38010501861572266, 0.0387120246887207, 0.517906904220581, 1.707761526107788, 1.5415525436401367, 0.6479361057281494, 0.9939553737640381, 2.1001057624816895, 2.56917142868042, 0.36791229248046875, 1.1320645809173584, 0.2680368423461914, 0.039052724838256836, 1.1070730686187744, 0.23353362083435059, 1.2049870491027832, 0.15563678741455078, 0.1010138988494873, 1.5338451862335205, 1.096735954284668, 2.076591730117798, 0.9296603202819824, 2.169898748397827, 0.2302379608154297, 0.7285809516906738, 0.2938380241394043, 0.43799591064453125, 0.9876368045806885, 0.14293289184570312, 0.431973934173584, 0.44339871406555176, 0.19094395637512207, 2.5519230365753174, 0.826909065246582, 0.03348970413208008, 0.6760520935058594, 1.4164750576019287, 0.14168834686279297, 0.22786378860473633, 0.4520387649536133, 1.1080060005187988, 0.02565622329711914, 0.2550637722015381, 0.1570262908935547, 1.002821445465088, 1.7110698223114014, 0.29718494415283203, 0.012171268463134766, 0.35767269134521484, 0.5637688636779785, 1.474524736404419, 2.544757843017578, 0.03466677665710449, 1.7001709938049316, 0.7789552211761475, 1.577368974685669], "mean_td_error": 0.9809655547142029, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 112.0, "diff_num_grad_updates_vs_sampler_policy": 111.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.058892250061035, "actor_loss": -6.511002063751221, "critic_loss": 0.1231168657541275, "alpha_loss": -0.33480167388916016, "alpha_value": 0.9672636985778809, "log_alpha_value": -0.03328414633870125, "target_entropy": -6.0, "policy_t": -0.019431469962000847, "mean_q": 2.618964195251465, "max_q": 2.687523365020752, "min_q": 2.1326022148132324}, "td_error": [0.5831942558288574, 1.2704753875732422, 1.0419577360153198, 1.4299702644348145, 1.7130829095840454, 1.5667707920074463, 0.8168902397155762, 1.2057712078094482, 0.5832901000976562, 0.15172040462493896, 0.9810657501220703, 0.8179115056991577, 1.5905425548553467, 0.032183170318603516, 1.9701933860778809, 0.6861575841903687, 0.396273136138916, 0.7557176351547241, 1.253114938735962, 0.10993313789367676, 0.872901201248169, 1.2547403573989868, 0.42565345764160156, 0.8906097412109375, 1.0089880228042603, 0.8299319744110107, 1.1417237520217896, 1.2132506370544434, 0.17075884342193604, 0.9700095653533936, 0.32451295852661133, 0.9383972883224487, 0.48003554344177246, 1.3003182411193848, 0.24079859256744385, 0.6149482727050781, 0.7661086320877075, 2.3042969703674316, 0.05666792392730713, 0.14789247512817383, 0.2519599199295044, 0.1305161714553833, 1.5593535900115967, 0.6636790037155151, 0.3942636251449585, 0.04546236991882324, 0.8358156681060791, 0.5018506050109863, 1.1183555126190186, 1.3194876909255981, 0.584928035736084, 3.6432838439941406, 0.06856918334960938, 0.9944980144500732, 1.7478482723236084, 1.3883070945739746, 0.11449658870697021, 0.03519868850708008, 0.6002089977264404, 0.31064510345458984, 0.2554128170013428, 0.6224241256713867, 0.4212998151779175, 2.2389705181121826, 0.6792140007019043, 0.025142669677734375, 0.40941154956817627, 1.0654067993164062, 0.36052751541137695, 0.38896310329437256, 0.3790031671524048, 0.6339231729507446, 1.5999712944030762, 0.9682214260101318, 1.3661071062088013, 2.481332778930664, 0.03356170654296875, 0.022191524505615234, 0.6637420654296875, 0.8711514472961426, 0.3071390390396118, 1.2888129949569702, 0.757835865020752, 1.9814355373382568, 1.1332406997680664, 2.333635091781616], "mean_td_error": 0.8663437366485596, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 112.0, "diff_num_grad_updates_vs_sampler_policy": 111.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.116065979003906, "actor_loss": -6.672519207000732, "critic_loss": 0.107606902718544, "alpha_loss": -0.3368614912033081, "alpha_value": 0.9672486782073975, "log_alpha_value": -0.033299654722213745, "target_entropy": -6.0, "policy_t": 0.005552775226533413, "mean_q": 2.6769657135009766, "max_q": 3.0571722984313965, "min_q": 2.323624610900879}, "td_error": [1.0486762523651123, 1.1553226709365845, 1.484368085861206, 0.7469507455825806, 1.095527172088623, 1.8601661920547485, 1.2207595109939575, 1.0841028690338135, 1.1687999963760376, 2.0350775718688965, 0.19575762748718262, 0.41321682929992676, 0.3753091096878052, 1.5724122524261475, 0.17517638206481934, 1.8726551532745361, 2.01149582862854, 1.522221326828003, 0.13572490215301514, 1.9485009908676147, 0.7202301025390625, 0.7020223140716553, 1.5505669116973877, 0.7626687288284302, 1.1190400123596191, 0.19387483596801758, 2.4343371391296387, 0.3926292657852173, 0.22843658924102783, 0.40596437454223633, 1.504036784172058, 0.08931624889373779, 0.13445055484771729, 0.7799636125564575, 0.18401670455932617, 0.2018498182296753, 0.8278264999389648, 0.04930603504180908, 0.5565035343170166, 0.028603434562683105, 0.3376753330230713, 0.9830093383789062, 0.9942564964294434, 2.043341636657715, 0.1713334321975708, 0.21364879608154297, 0.9092682600021362, 0.9925844669342041, 0.5928196907043457, 0.17253351211547852, 0.9826115369796753, 0.890308141708374, 1.334709644317627, 0.3427079916000366, 1.9753265380859375, 0.5739667415618896, 0.04925799369812012, 1.0982649326324463, 0.45553910732269287, 1.2706117630004883, 0.48897993564605713, 0.30453622341156006, 0.32321715354919434, 0.28284382820129395, 0.6837271451950073, 1.0585936307907104, 1.2750587463378906, 0.5392509698867798, 1.2465996742248535, 0.17560899257659912, 3.077754497528076, 1.3017165660858154, 0.5718884468078613, 1.0643187761306763, 0.0732874870300293, 0.23398125171661377, 1.7477551698684692, 0.3175389766693115, 0.4164402484893799, 0.23412680625915527, 0.061606645584106445, 0.13487398624420166, 0.18918931484222412, 0.47932982444763184, 0.9423094987869263, 0.6254497766494751], "mean_td_error": 0.8165304660797119, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 112.0, "diff_num_grad_updates_vs_sampler_policy": 111.0}}, "num_env_steps_sampled": 101248, "num_env_steps_trained": 28896, "num_agent_steps_sampled": 303744, "num_agent_steps_trained": 28896, "last_target_update_ts": 101248, "num_target_updates": 112}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 303744, "num_agent_steps_trained": 28896, "num_env_steps_sampled": 101248, "num_env_steps_trained": 28896, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 916.7573441162178, "num_env_steps_trained_throughput_per_sec": 263.9770031048931, "timesteps_total": 101248, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 303744, "timers": {"training_iteration_time_ms": 1053.111, "sample_time_ms": 765.263, "load_time_ms": 0.325, "load_throughput": 793001.929, "learn_time_ms": 18.564, "learn_throughput": 13898.002, "synch_weights_time_ms": 11.11}, "counters": {"num_env_steps_sampled": 101248, "num_env_steps_trained": 28896, "num_agent_steps_sampled": 303744, "num_agent_steps_trained": 28896, "last_target_update_ts": 101248, "num_target_updates": 112}, "done": true, "episodes_total": 0, "training_iteration": 68, "trial_id": "7066a_00000", "date": "2023-11-18_21-08-48", "timestamp": 1700370528, "time_this_iter_s": 1.965831995010376, "time_total_s": 111.29116821289062, "pid": 7187, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x31039e980>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 111.29116821289062, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 72.06666666666668, "ram_util_percent": 66.03333333333333}}
