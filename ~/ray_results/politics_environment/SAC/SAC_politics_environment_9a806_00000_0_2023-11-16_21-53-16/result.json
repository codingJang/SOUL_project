{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 896, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2688, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2688, "num_agent_steps_trained": 0, "num_env_steps_sampled": 896, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 372.8075311935576, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 896, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2688, "timers": {"training_iteration_time_ms": 2403.35, "sample_time_ms": 912.892}, "counters": {"num_env_steps_sampled": 896, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2688, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 1, "trial_id": "9a806_00000", "date": "2023-11-16_21-53-39", "timestamp": 1700200419, "time_this_iter_s": 2.4070069789886475, "time_total_s": 2.4070069789886475, "pid": 45784, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fade2d21b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 2.4070069789886475, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 38.800000000000004, "ram_util_percent": 89.55}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.062065124511719, "actor_loss": -4.060166358947754, "critic_loss": 5.18018102645874, "alpha_loss": 0.0, "alpha_value": 1.0, "log_alpha_value": 0.0, "target_entropy": -6.0, "policy_t": 0.031712450087070465, "mean_q": -0.0007673892541788518, "max_q": 0.0024535474367439747, "min_q": -0.002715097973123193}, "td_error": [5.525381088256836, 4.112906455993652, 3.9960851669311523, 4.662419319152832, 4.683223247528076, 6.159516334533691, 6.615477085113525, 3.956295967102051, 4.7574357986450195, 5.859831809997559, 5.768141746520996, 7.665403366088867, 4.331954002380371, 7.03102970123291, 6.600688457489014, 6.8923797607421875, 5.5854268074035645, 4.363595962524414, 5.270094871520996, 4.355578422546387, 6.73934268951416, 6.259610652923584, 4.587087631225586, 3.7725706100463867, 5.967347621917725, 5.044103622436523, 5.715425968170166, 7.40880012512207, 5.177542686462402, 5.8452253341674805, 6.494260787963867, 5.780027866363525, 5.337888717651367, 4.276552677154541, 6.572017669677734, 5.498540878295898, 6.032168865203857, 6.028685569763184, 7.929481506347656, 5.090298175811768, 6.784557342529297, 5.608511447906494, 4.018117904663086, 5.684096813201904, 5.744864463806152, 5.734857559204102, 4.417057037353516, 4.911680221557617, 6.7888946533203125, 5.483358860015869, 6.512679576873779, 4.552938461303711, 6.849908828735352, 5.8920135498046875, 6.230459690093994, 5.158892631530762, 7.570192813873291, 4.161259174346924, 5.992636203765869, 5.871420860290527, 6.823012351989746, 5.516467094421387, 5.389561653137207, 4.5606560707092285, 5.940633773803711, 6.924695014953613, 6.817540168762207, 5.014971733093262, 5.4198760986328125, 6.618916034698486, 5.787359237670898, 5.5388383865356445, 6.858677387237549, 5.065072536468506, 5.444850921630859, 5.489409446716309, 4.9247894287109375, 6.666010856628418, 6.910149097442627, 5.053707122802734, 6.415858268737793, 6.814322471618652, 3.4642653465270996, 6.751138687133789, 5.539802551269531, 5.026759147644043], "mean_td_error": 5.680181503295898, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1.0, "diff_num_grad_updates_vs_sampler_policy": 0.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.01520824432373, "actor_loss": -4.0150465965271, "critic_loss": 3.1171669960021973, "alpha_loss": 0.0, "alpha_value": 1.0, "log_alpha_value": 0.0, "target_entropy": -6.0, "policy_t": 0.004401550628244877, "mean_q": 0.00040611784788779914, "max_q": 0.005654290784150362, "min_q": -0.0050707110203802586}, "td_error": [4.138942718505859, 5.540036201477051, 2.6961286067962646, 3.8676862716674805, 6.571857452392578, 3.454416036605835, 4.816620826721191, 4.350316047668457, 5.232665061950684, 3.6071794033050537, 3.3848888874053955, 3.8616764545440674, 2.8835484981536865, 4.561899662017822, 2.2624082565307617, 4.477755546569824, 3.61161470413208, 0.08890099823474884, 2.9068453311920166, 5.048412322998047, 4.576473236083984, 2.5119404792785645, 3.7008543014526367, 4.559946537017822, 2.6474480628967285, 2.0962233543395996, 2.198474168777466, 2.398181915283203, 4.222634315490723, 2.5436434745788574, 4.078071594238281, 3.2813329696655273, 3.248763084411621, 5.407027244567871, 1.9568809270858765, 2.494863510131836, 3.3633828163146973, 4.937008857727051, 3.797273635864258, 3.3237767219543457, 4.103477478027344, 5.257139205932617, 2.925375461578369, 1.2132792472839355, 3.967376708984375, 4.030119895935059, 4.049276351928711, 4.579719543457031, 5.256081581115723, 4.473784446716309, 4.182285785675049, 5.8648176193237305, 4.00302791595459, 3.9887893199920654, 3.5889430046081543, 3.5964794158935547, 3.604280948638916, 4.090062141418457, 1.9104864597320557, 3.906221866607666, 5.445998191833496, 1.9927663803100586, 1.9721167087554932, 4.1179046630859375, 4.086213111877441, 4.183984756469727, 2.7420454025268555, 3.4837539196014404, 4.002780914306641, 3.996025800704956, 3.288792133331299, 2.718682289123535, 2.264517307281494, 1.493680715560913, 0.9550483822822571, 4.774444580078125, 4.18862247467041, 5.560546398162842, 4.010381698608398, 3.9856977462768555, 2.423048496246338, 1.7199430465698242, 2.061887741088867, 3.625375747680664, 4.544634819030762, 3.7223892211914062], "mean_td_error": 3.6123292446136475, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1.0, "diff_num_grad_updates_vs_sampler_policy": 0.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.062446594238281, "actor_loss": -4.056562423706055, "critic_loss": 3.330659866333008, "alpha_loss": 0.0, "alpha_value": 1.0, "log_alpha_value": 0.0, "target_entropy": -6.0, "policy_t": -0.011604096740484238, "mean_q": -0.00639726035296917, "max_q": -0.002398963551968336, "min_q": -0.009869113564491272}, "td_error": [3.384068012237549, 4.007676124572754, 2.948739767074585, 4.093623161315918, 3.4137701988220215, 4.296931266784668, 4.5542707443237305, 3.0028600692749023, 6.0905351638793945, 4.208963394165039, 3.9673757553100586, 3.5784878730773926, 3.7453832626342773, 3.0608129501342773, 3.742344379425049, 4.211764335632324, 4.423734664916992, 2.184298515319824, 4.292018890380859, 3.101571559906006, 2.473517417907715, 5.089308738708496, 3.805716037750244, 3.383390426635742, 4.619141578674316, 3.0137743949890137, 3.522695779800415, 6.263595104217529, 4.356748580932617, 3.0307719707489014, 3.951465129852295, 4.540436744689941, 3.6434452533721924, 1.9088709354400635, 4.868090629577637, 4.574090480804443, 3.5798232555389404, 4.085654258728027, 4.073714256286621, 4.506997585296631, 2.3355112075805664, 5.206146240234375, 2.2694382667541504, 4.547534942626953, 2.568385362625122, 4.043607711791992, 5.0255937576293945, 2.986940860748291, 5.61827278137207, 1.688867211341858, 3.4510254859924316, 3.120659351348877, 4.197197914123535, 3.871644973754883, 2.2295939922332764, 3.3103866577148438, 3.10593318939209, 2.112372398376465, 5.219760417938232, 3.8646132946014404, 3.1079015731811523, 4.558590412139893, 3.8820245265960693, 2.6624655723571777, 6.304071426391602, 3.939507246017456, 2.956124782562256, 4.583637237548828, 3.7361245155334473, 3.9413468837738037, 3.6621527671813965, 3.460299491882324, 2.4458229541778564, 3.5065958499908447, 3.445514678955078, 3.522217273712158, 2.669753313064575, 3.185048818588257, 4.293513774871826, 4.5012969970703125, 4.390973091125488, 4.587861061096191, 3.934291362762451, 5.576816082000732, 3.9581189155578613, 6.250710487365723], "mean_td_error": 3.8306596279144287, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1.0, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 1792, "num_env_steps_trained": 258, "num_agent_steps_sampled": 5376, "num_agent_steps_trained": 258, "last_target_update_ts": 1792, "num_target_updates": 1}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5376, "num_agent_steps_trained": 258, "num_env_steps_sampled": 1792, "num_env_steps_trained": 258, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 398.23851098645963, "num_env_steps_trained_throughput_per_sec": 114.67135695815466, "timesteps_total": 1792, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 5376, "timers": {"training_iteration_time_ms": 2326.614, "sample_time_ms": 1190.927, "load_time_ms": 0.651, "load_throughput": 396239.631, "learn_time_ms": 101.12, "learn_throughput": 2551.424, "synch_weights_time_ms": 19.31}, "counters": {"num_env_steps_sampled": 1792, "num_env_steps_trained": 258, "num_agent_steps_sampled": 5376, "num_agent_steps_trained": 258, "last_target_update_ts": 1792, "num_target_updates": 1}, "done": false, "episodes_total": 0, "training_iteration": 2, "trial_id": "9a806_00000", "date": "2023-11-16_21-53-42", "timestamp": 1700200422, "time_this_iter_s": 2.2704901695251465, "time_total_s": 4.677497148513794, "pid": 45784, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fadc09cd0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 4.677497148513794, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 60.166666666666664, "ram_util_percent": 89.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.981722831726074, "actor_loss": -3.9933149814605713, "critic_loss": 5.196250915527344, "alpha_loss": -0.0029945161659270525, "alpha_value": 0.9997000694274902, "log_alpha_value": -0.0002999999560415745, "target_entropy": -6.0, "policy_t": -0.001835729693993926, "mean_q": 0.01510303933173418, "max_q": 0.01901203580200672, "min_q": 0.011074639856815338}, "td_error": [4.171762466430664, 8.842819213867188, 6.1729583740234375, 5.04199743270874, 4.961451530456543, 6.21389627456665, 5.5072736740112305, 6.131011962890625, 3.5053224563598633, 5.432389259338379, 3.948714256286621, 6.899665832519531, 6.801810264587402, 3.9597396850585938, 5.838500022888184, 7.980478763580322, 5.908002853393555, 4.3064165115356445, 3.9419541358947754, 4.62103271484375, 7.055164813995361, 6.759978294372559, 6.968588352203369, 6.431722164154053, 6.550088882446289, 5.0999860763549805, 5.987775802612305, 6.019702911376953, 6.385644435882568, 5.643126487731934, 5.511918067932129, 5.619668006896973, 6.793007850646973, 5.210352897644043, 4.955296516418457, 5.852791786193848, 5.779169082641602, 5.442348480224609, 5.844911575317383, 5.943281173706055, 4.594927787780762, 5.612763404846191, 5.54136323928833, 4.87373161315918, 7.397036075592041, 7.169829368591309, 7.235247611999512, 5.534894943237305, 5.798408508300781, 4.585190773010254, 5.276275634765625, 4.948541641235352, 3.844332695007324, 6.497199058532715, 6.469687461853027, 6.20246696472168, 4.570139408111572, 7.283503532409668, 8.441522598266602, 5.89353084564209, 6.353768348693848, 6.117025852203369, 8.463994979858398, 6.208258628845215, 4.706551551818848, 5.478857040405273, 5.134995937347412, 5.443930625915527, 4.176640510559082, 5.594420433044434, 4.84399938583374, 4.6274237632751465, 6.285926342010498, 6.421584129333496, 6.363511085510254, 6.768141746520996, 6.369687080383301, 6.094601631164551, 5.086347579956055, 6.431629180908203, 4.960144996643066, 7.95079231262207, 5.783651828765869, 5.374761581420898, 6.23270320892334, 4.892943382263184], "mean_td_error": 5.813704967498779, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 2.0, "diff_num_grad_updates_vs_sampler_policy": 1.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.959821701049805, "actor_loss": -3.971921443939209, "critic_loss": 2.8851284980773926, "alpha_loss": -0.002987946616485715, "alpha_value": 0.9997000694274902, "log_alpha_value": -0.0003000000142492354, "target_entropy": -6.0, "policy_t": -0.01054446306079626, "mean_q": 0.01355985552072525, "max_q": 0.020304495468735695, "min_q": 0.009380429983139038}, "td_error": [3.507694721221924, 1.972898244857788, 2.1884169578552246, 2.572889804840088, 4.854567527770996, 1.0455024242401123, 3.95947265625, 4.14400577545166, 2.9802348613739014, 5.5105438232421875, 4.2335357666015625, 4.537031173706055, 3.1286168098449707, 3.3580684661865234, 3.2765469551086426, 4.515917778015137, 3.3069825172424316, 3.3782472610473633, 2.751136064529419, 5.367508888244629, 5.2205071449279785, 4.03439474105835, 3.333892345428467, 4.540349960327148, 3.0560436248779297, 2.1519076824188232, 1.8520513772964478, 3.5880260467529297, 3.332601547241211, 3.399138927459717, 2.7858083248138428, 3.3472506999969482, 4.239828109741211, 2.124797821044922, 2.8674585819244385, 3.7206296920776367, 2.2246806621551514, 1.0939128398895264, 4.937485694885254, 3.30944561958313, 2.625596523284912, 2.96209979057312, 3.774379253387451, 3.0842981338500977, 4.303327560424805, 5.048432350158691, 1.5919060707092285, 2.7670531272888184, 3.0531818866729736, 3.3491504192352295, 4.228304862976074, 2.57196307182312, 3.6357064247131348, 2.744230031967163, 1.4475152492523193, 2.7869863510131836, 1.9295904636383057, 3.1481194496154785, 2.354372978210449, 2.96297287940979, 2.318868637084961, 3.5571985244750977, 2.717651128768921, 3.1267313957214355, 4.283939838409424, 4.737776279449463, 3.625220537185669, 2.586483955383301, 5.450875759124756, 4.33293342590332, 3.9193625450134277, 3.4672446250915527, 3.81011962890625, 4.779140949249268, 2.863687753677368, 2.7927517890930176, 3.641204595565796, 4.3257856369018555, 6.065471649169922, 3.4385955333709717, 3.188908576965332, 4.380699157714844, 4.4576568603515625, 4.786412715911865, 2.4278764724731445, 5.487931251525879], "mean_td_error": 3.449880599975586, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 2.0, "diff_num_grad_updates_vs_sampler_policy": 1.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0606689453125, "actor_loss": -4.068972110748291, "critic_loss": 2.913358211517334, "alpha_loss": -0.003018201095983386, "alpha_value": 0.9997000694274902, "log_alpha_value": -0.0003000000142492354, "target_entropy": -6.0, "policy_t": 0.004120614379644394, "mean_q": 0.009912814944982529, "max_q": 0.015225619077682495, "min_q": 0.005886669736355543}, "td_error": [2.691075325012207, 2.7621004581451416, 3.899970054626465, 4.640469551086426, 1.3871538639068604, 4.529689788818359, 2.22493839263916, 3.7171061038970947, 2.9849624633789062, 4.149520397186279, 1.9321203231811523, 5.253106117248535, 4.302817344665527, 3.3940069675445557, 3.615661144256592, 3.6945996284484863, 2.719442367553711, 1.1686582565307617, 1.5101888179779053, 3.778780460357666, 4.272237777709961, 2.323920726776123, 3.814650535583496, 3.6495437622070312, 2.3059096336364746, 4.617951393127441, 3.8733839988708496, 3.5928215980529785, 3.3107972145080566, 3.0082225799560547, 4.473902702331543, 5.399930000305176, 2.910391330718994, 2.162637233734131, 4.371407508850098, 0.952297031879425, 1.8721425533294678, 3.64107608795166, 5.891406059265137, 1.8376047611236572, 4.757939338684082, 2.9952197074890137, 3.100186824798584, 4.37845516204834, 4.160034656524658, 3.10598087310791, 4.823274612426758, 3.4775261878967285, 5.029907703399658, 5.811844825744629, 4.363188743591309, 2.847398281097412, 2.0504252910614014, 2.423025369644165, 3.366563320159912, 3.46048903465271, 3.1323726177215576, 3.4143428802490234, 3.1365814208984375, 3.9863033294677734, 3.8265724182128906, 3.6772844791412354, 3.627835512161255, 4.37507438659668, 1.2649297714233398, 3.811429977416992, 1.6499180793762207, 5.885632514953613, 4.267402648925781, 3.680007219314575, 2.2372539043426514, 4.381730556488037, 2.5734291076660156, 0.9668333530426025, 2.710916042327881, 5.760209083557129, 3.3350510597229004, 3.67160701751709, 4.0985517501831055, 2.700035810470581, 4.795708656311035, 4.273664474487305, 3.6171393394470215, 3.8238332271575928, 2.5948266983032227, 3.692911148071289], "mean_td_error": 3.4623188972473145, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 2.0, "diff_num_grad_updates_vs_sampler_policy": 1.0}}, "num_env_steps_sampled": 2688, "num_env_steps_trained": 516, "num_agent_steps_sampled": 8064, "num_agent_steps_trained": 516, "last_target_update_ts": 2688, "num_target_updates": 2}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8064, "num_agent_steps_trained": 516, "num_env_steps_sampled": 2688, "num_env_steps_trained": 516, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 353.82310597690565, "num_env_steps_trained_throughput_per_sec": 101.88209971210007, "timesteps_total": 2688, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 8064, "timers": {"training_iteration_time_ms": 2395.173, "sample_time_ms": 1445.22, "load_time_ms": 0.597, "load_throughput": 432074.439, "learn_time_ms": 84.571, "learn_throughput": 3050.708, "synch_weights_time_ms": 17.991}, "counters": {"num_env_steps_sampled": 2688, "num_env_steps_trained": 516, "num_agent_steps_sampled": 8064, "num_agent_steps_trained": 516, "last_target_update_ts": 2688, "num_target_updates": 2}, "done": false, "episodes_total": 0, "training_iteration": 3, "trial_id": "9a806_00000", "date": "2023-11-16_21-53-44", "timestamp": 1700200424, "time_this_iter_s": 2.547801971435547, "time_total_s": 7.225299119949341, "pid": 45784, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fadc09cd310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 7.225299119949341, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 67.275, "ram_util_percent": 89.92500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.049592971801758, "actor_loss": -4.074450969696045, "critic_loss": 4.921416282653809, "alpha_loss": -0.006029101088643074, "alpha_value": 0.99940025806427, "log_alpha_value": -0.0005999348359182477, "target_entropy": -6.0, "policy_t": 0.012154117226600647, "mean_q": 0.031328920274972916, "max_q": 0.040138524025678635, "min_q": 0.026194145902991295}, "td_error": [5.973424911499023, 5.412468910217285, 6.527021408081055, 5.441733360290527, 5.623500823974609, 4.669523239135742, 5.260910987854004, 4.397953987121582, 5.162860870361328, 4.364508628845215, 5.26814603805542, 7.147127151489258, 2.423860549926758, 5.000185489654541, 5.14285135269165, 4.145132064819336, 6.429320335388184, 7.103998184204102, 5.57181453704834, 4.686625957489014, 4.210048198699951, 4.247964859008789, 7.831915378570557, 5.239130973815918, 4.808310508728027, 4.953006744384766, 7.041142463684082, 6.229134559631348, 6.701377868652344, 7.205883502960205, 7.301734924316406, 4.109073638916016, 4.142463684082031, 6.14101505279541, 7.976205825805664, 2.9250900745391846, 5.29353666305542, 5.24342155456543, 5.036029815673828, 7.76595401763916, 5.764850616455078, 5.7937774658203125, 4.362912178039551, 5.7501325607299805, 6.844019889831543, 4.870184898376465, 5.834842681884766, 7.111384391784668, 7.001068115234375, 6.179387092590332, 5.037075996398926, 5.8719258308410645, 7.215597629547119, 5.0438151359558105, 7.991555213928223, 7.952065944671631, 6.966349124908447, 5.89262056350708, 7.231000900268555, 5.873151779174805, 5.409215450286865, 6.861584663391113, 5.417742729187012, 5.588122367858887, 6.20054817199707, 5.717724323272705, 4.484673500061035, 5.604622840881348, 4.8237433433532715, 4.224725723266602, 5.44721794128418, 5.763023376464844, 5.206510066986084, 3.497046947479248, 4.146101951599121, 5.594943046569824, 6.804787635803223, 5.202010154724121, 5.374135971069336, 6.011203765869141, 5.58501672744751, 6.883581638336182, 4.331428527832031, 5.904460906982422, 6.358060359954834, 6.128270149230957], "mean_td_error": 5.666438102722168, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 3.0, "diff_num_grad_updates_vs_sampler_policy": 2.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.066272735595703, "actor_loss": -4.090333938598633, "critic_loss": 2.929668426513672, "alpha_loss": -0.006039315368980169, "alpha_value": 0.9994001984596252, "log_alpha_value": -0.000599955499637872, "target_entropy": -6.0, "policy_t": -0.034726399928331375, "mean_q": 0.027877120301127434, "max_q": 0.03700517117977142, "min_q": 0.02200338989496231}, "td_error": [6.140219211578369, 3.0183887481689453, 2.756183624267578, 3.644279956817627, 4.097567558288574, 3.4602575302124023, 3.143397808074951, 2.263274908065796, 3.8713464736938477, 5.524282455444336, 4.316356658935547, 4.815333366394043, 2.9881134033203125, 2.929368734359741, 3.3227810859680176, 5.245455265045166, 1.8089423179626465, 2.667163372039795, 2.133572816848755, 3.5319080352783203, 3.110830783843994, 3.1002278327941895, 3.8990135192871094, 1.8248100280761719, 2.0493788719177246, 4.198029518127441, 3.811972141265869, 4.019379615783691, 2.949023723602295, 2.659350633621216, 3.955484390258789, 3.5689451694488525, 3.608602285385132, 3.4253969192504883, 1.4642832279205322, 1.906013011932373, 3.498358964920044, 3.916823625564575, 4.913819789886475, 3.8314342498779297, 5.170078277587891, 4.365394592285156, 4.074267864227295, 5.028438568115234, 2.8778436183929443, 5.360764026641846, 4.681160926818848, 2.7883923053741455, 3.900163173675537, 2.998349189758301, 2.414501190185547, 2.8809666633605957, 3.162914276123047, 3.410508155822754, 2.438786268234253, 4.617643356323242, 4.238374710083008, 4.135467529296875, 4.101509094238281, 3.392542839050293, 2.902130365371704, 4.756548881530762, 2.678220748901367, 2.982786178588867, 2.783694267272949, 3.2275471687316895, 4.366052627563477, 4.46946907043457, 2.354473114013672, 3.1470766067504883, 3.266512393951416, 3.893616199493408, 1.9848662614822388, 4.2511491775512695, 4.524381637573242, 3.7972259521484375, 2.6391308307647705, 2.4034180641174316, 2.4435930252075195, 3.461930274963379, 4.022407054901123, 3.053809642791748, 4.86334753036499, 4.899185657501221, 3.583125114440918, 2.6653594970703125], "mean_td_error": 3.5214943885803223, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 3.0, "diff_num_grad_updates_vs_sampler_policy": 2.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.06529712677002, "actor_loss": -4.088712215423584, "critic_loss": 3.0752882957458496, "alpha_loss": -0.006039164029061794, "alpha_value": 0.9994001984596252, "log_alpha_value": -0.0005999986315146089, "target_entropy": -6.0, "policy_t": 0.01567360945045948, "mean_q": 0.026032254099845886, "max_q": 0.03309929743409157, "min_q": 0.02061648480594158}, "td_error": [5.5972161293029785, 5.570353984832764, 4.310146331787109, 2.8058111667633057, 3.517092227935791, 5.236991882324219, 3.1491217613220215, 3.526761770248413, 2.9651083946228027, 0.8077290058135986, 5.156927108764648, 3.7010655403137207, 3.2852413654327393, 4.457305908203125, 3.8192262649536133, 2.9532012939453125, 5.248695373535156, 4.580347061157227, 5.864959716796875, 3.216386556625366, 3.5414934158325195, 4.968113422393799, 4.999756813049316, 4.079690933227539, 3.919459819793701, 2.9975390434265137, 4.722692489624023, 5.619293212890625, 4.182483673095703, 3.582909345626831, 2.630899667739868, 2.2184057235717773, 2.8973031044006348, 3.142005443572998, 0.6744769811630249, 3.4123952388763428, 3.4619879722595215, 2.7827110290527344, 3.449169635772705, 3.9065213203430176, 3.3935818672180176, 2.5766491889953613, 2.757585287094116, 5.649533271789551, 2.625617027282715, 1.879992961883545, 3.7050437927246094, 5.25847053527832, 1.9604581594467163, 4.330436706542969, 3.7418012619018555, 4.46583366394043, 4.3777079582214355, 4.667048931121826, 4.494475841522217, 3.4547300338745117, 4.222992420196533, 2.5038161277770996, 1.9233871698379517, 2.2174129486083984, 7.03818416595459, 4.020096778869629, 4.213192462921143, 4.599758148193359, 3.561882972717285, 4.2481489181518555, 1.8861618041992188, 4.306320667266846, 4.950230598449707, 3.860948085784912, 3.1819934844970703, 2.424801826477051, 3.746212959289551, 3.621605157852173, 4.017590522766113, 4.980311870574951, 3.4818389415740967, 3.4656405448913574, 3.8530116081237793, 4.583893775939941, 3.5592379570007324, 1.8343249559402466, 2.1285972595214844, 3.1505136489868164, 3.4320569038391113, 4.382880687713623], "mean_td_error": 3.71738338470459, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 3.0, "diff_num_grad_updates_vs_sampler_policy": 2.0}}, "num_env_steps_sampled": 3584, "num_env_steps_trained": 774, "num_agent_steps_sampled": 10752, "num_agent_steps_trained": 774, "last_target_update_ts": 3584, "num_target_updates": 3}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10752, "num_agent_steps_trained": 774, "num_env_steps_sampled": 3584, "num_env_steps_trained": 774, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 438.26851106348875, "num_env_steps_trained_throughput_per_sec": 126.19785251604922, "timesteps_total": 3584, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 10752, "timers": {"training_iteration_time_ms": 2307.471, "sample_time_ms": 1451.254, "load_time_ms": 0.574, "load_throughput": 449389.714, "learn_time_ms": 79.4, "learn_throughput": 3249.358, "synch_weights_time_ms": 18.017}, "counters": {"num_env_steps_sampled": 3584, "num_env_steps_trained": 774, "num_agent_steps_sampled": 10752, "num_agent_steps_trained": 774, "last_target_update_ts": 3584, "num_target_updates": 3}, "done": false, "episodes_total": 0, "training_iteration": 4, "trial_id": "9a806_00000", "date": "2023-11-16_21-53-46", "timestamp": 1700200426, "time_this_iter_s": 2.058302879333496, "time_total_s": 9.283601999282837, "pid": 45784, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fade2d21b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 9.283601999282837, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 66.56666666666668, "ram_util_percent": 90.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.128808975219727, "actor_loss": -4.166468620300293, "critic_loss": 5.060263156890869, "alpha_loss": -0.009115145541727543, "alpha_value": 0.9991005063056946, "log_alpha_value": -0.0008999227429740131, "target_entropy": -6.0, "policy_t": 0.010292169637978077, "mean_q": 0.04648818448185921, "max_q": 0.05975157022476196, "min_q": 0.03674870729446411}, "td_error": [6.03211784362793, 6.5113630294799805, 5.432384490966797, 4.476141929626465, 5.636102199554443, 5.4543986320495605, 6.067867279052734, 5.372823238372803, 5.3086018562316895, 5.087701797485352, 6.469013214111328, 6.276108741760254, 4.420696258544922, 3.532155990600586, 3.5576603412628174, 4.488969802856445, 4.392485618591309, 4.3870134353637695, 6.088417053222656, 7.387138843536377, 6.117760181427002, 5.179680824279785, 6.60631799697876, 5.263757705688477, 7.437849044799805, 6.064395427703857, 4.680608749389648, 6.887119293212891, 4.875334739685059, 4.617486476898193, 6.106697082519531, 5.0707106590271, 3.975367307662964, 5.173598289489746, 3.6018550395965576, 5.442401885986328, 5.938197135925293, 5.007108688354492, 4.280168056488037, 7.340571403503418, 5.396775245666504, 6.099981307983398, 6.286956310272217, 5.117396354675293, 7.050019264221191, 5.891304969787598, 7.727185249328613, 7.504610061645508, 5.462798595428467, 6.912432670593262, 6.292189598083496, 6.647153854370117, 5.010898590087891, 5.260575294494629, 5.729576110839844, 6.4682297706604, 6.983028411865234, 5.944581031799316, 6.345969200134277, 7.191765785217285, 7.738115310668945, 5.088932991027832, 4.028069972991943, 7.367988586425781, 5.374266624450684, 7.060620307922363, 5.464208602905273, 4.200222492218018, 6.743522644042969, 5.517890930175781, 5.931685447692871, 4.922584533691406, 6.297358512878418, 5.935883522033691, 7.611507415771484, 4.22770881652832, 4.91856575012207, 8.404125213623047, 5.384119033813477, 7.455926895141602, 4.73988151550293, 5.8157854080200195, 4.707929611206055, 4.65609073638916, 5.299649238586426, 5.6448163986206055], "mean_td_error": 5.719849109649658, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 4.0, "diff_num_grad_updates_vs_sampler_policy": 3.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.004706382751465, "actor_loss": -4.041454792022705, "critic_loss": 2.9181432723999023, "alpha_loss": -0.009004323743283749, "alpha_value": 0.999100387096405, "log_alpha_value": -0.0009000087738968432, "target_entropy": -6.0, "policy_t": 0.0018834236543625593, "mean_q": 0.041774772107601166, "max_q": 0.05729345977306366, "min_q": 0.03378339484333992}, "td_error": [4.359393119812012, 2.373002529144287, 3.882890224456787, 2.4608519077301025, 3.047276496887207, 3.5629429817199707, 2.309919834136963, 5.470244884490967, 1.5083107948303223, 1.300410270690918, 3.688876152038574, 3.259352207183838, 2.561006546020508, 5.404690742492676, 1.8106034994125366, 3.1974499225616455, 3.2523632049560547, 5.188368320465088, 4.078708171844482, 3.070089817047119, 4.378052711486816, 2.7666540145874023, 2.149049997329712, 2.0697989463806152, 3.896378517150879, 4.195411682128906, 3.375068426132202, 4.029514312744141, 2.673898220062256, 1.9389654397964478, 4.043111324310303, 3.7286925315856934, 3.089362382888794, 4.708245277404785, 3.5682737827301025, 1.4153729677200317, 4.420218467712402, 3.451200485229492, 3.182765483856201, 3.0382256507873535, 3.6843507289886475, 1.9234956502914429, 4.28110408782959, 3.951277256011963, 4.5912370681762695, 2.5600838661193848, 5.185328960418701, 3.9139761924743652, 4.574155807495117, 3.4283499717712402, 5.077415466308594, 3.5397956371307373, 3.9879543781280518, 4.32309627532959, 3.7137770652770996, 3.816565990447998, 5.091390609741211, 4.109463214874268, 1.5008431673049927, 3.263655185699463, 6.146113872528076, 4.480996131896973, 4.0691962242126465, 2.5119214057922363, 4.0193634033203125, 4.063880920410156, 4.118146896362305, 5.817514419555664, 3.706267833709717, 3.0982251167297363, 1.987243890762329, 3.6570584774017334, 4.721535682678223, 3.6529572010040283, 4.383745193481445, 4.519772529602051, 3.628753900527954, 3.2185516357421875, 2.4047179222106934, 1.9341189861297607, 3.7287652492523193, 4.2663774490356445, 3.473055124282837, 4.487191677093506, 4.205625534057617, 4.266240119934082], "mean_td_error": 3.592902898788452, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 4.0, "diff_num_grad_updates_vs_sampler_policy": 3.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.134844779968262, "actor_loss": -4.171510219573975, "critic_loss": 2.7323408126831055, "alpha_loss": -0.00912137795239687, "alpha_value": 0.999100387096405, "log_alpha_value": -0.0009000017307698727, "target_entropy": -6.0, "policy_t": -0.020958270877599716, "mean_q": 0.04184563085436821, "max_q": 0.05540548637509346, "min_q": 0.03383824601769447}, "td_error": [3.118086338043213, 2.915586471557617, 4.512706279754639, 2.3367741107940674, 3.638185977935791, 4.3655829429626465, 1.4526474475860596, 4.566771507263184, 4.287929058074951, 2.989637851715088, 3.4496898651123047, 3.7372725009918213, 4.6254563331604, 3.1195085048675537, 2.9845471382141113, 4.499972343444824, 3.064734935760498, 2.064605236053467, 5.779458999633789, 3.03720760345459, 2.9285998344421387, 3.103437900543213, 2.698989152908325, 4.11909294128418, 0.9834833741188049, 2.6417293548583984, 2.829850435256958, 4.836301803588867, 4.500761985778809, 4.391928672790527, 5.1788458824157715, 3.489527702331543, 4.645551681518555, 3.381021499633789, 4.638157367706299, 2.9889726638793945, 4.688858985900879, 1.9709949493408203, 3.9690160751342773, 3.36346435546875, 3.6879096031188965, 4.64505672454834, 3.93668794631958, 2.385420322418213, 3.8239002227783203, 4.1736226081848145, 4.490139961242676, 3.379774332046509, 1.4903271198272705, 4.430367469787598, 3.937880039215088, 5.361177921295166, 3.4682388305664062, 2.844369411468506, 3.8005518913269043, 3.432234764099121, 4.1576433181762695, 4.499398231506348, 4.206779479980469, 1.0162873268127441, 3.3914847373962402, 3.184455394744873, 3.569087505340576, 5.181051254272461, 3.4973630905151367, 4.7682342529296875, 4.084535598754883, 5.034539222717285, 3.5301928520202637, 3.224997043609619, 5.647290229797363, 4.013972282409668, 3.687901496887207, 3.5732040405273438, 3.0531396865844727, 4.707033634185791, 3.231553077697754, 2.8417184352874756, 4.443847179412842, 2.9534733295440674, 4.917014122009277, 2.6428918838500977, 2.87536883354187, 4.093519687652588, 2.6096386909484863, 3.3545374870300293], "mean_td_error": 3.641566753387451, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 4.0, "diff_num_grad_updates_vs_sampler_policy": 3.0}}, "num_env_steps_sampled": 4480, "num_env_steps_trained": 1032, "num_agent_steps_sampled": 13440, "num_agent_steps_trained": 1032, "last_target_update_ts": 4480, "num_target_updates": 4}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13440, "num_agent_steps_trained": 1032, "num_env_steps_sampled": 4480, "num_env_steps_trained": 1032, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 506.6128788259716, "num_env_steps_trained_throughput_per_sec": 145.87736912622844, "timesteps_total": 4480, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 13440, "timers": {"training_iteration_time_ms": 2199.691, "sample_time_ms": 1399.764, "load_time_ms": 0.56, "load_throughput": 460824.202, "learn_time_ms": 75.706, "learn_throughput": 3407.912, "synch_weights_time_ms": 17.834}, "counters": {"num_env_steps_sampled": 4480, "num_env_steps_trained": 1032, "num_agent_steps_sampled": 13440, "num_agent_steps_trained": 1032, "last_target_update_ts": 4480, "num_target_updates": 4}, "done": false, "episodes_total": 0, "training_iteration": 5, "trial_id": "9a806_00000", "date": "2023-11-16_21-53-48", "timestamp": 1700200428, "time_this_iter_s": 1.784271001815796, "time_total_s": 11.067873001098633, "pid": 45784, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fadd04f7f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 11.067873001098633, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 77.55, "ram_util_percent": 90.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.087886810302734, "actor_loss": -4.140717029571533, "critic_loss": 5.029111862182617, "alpha_loss": -0.012105759233236313, "alpha_value": 0.9988006949424744, "log_alpha_value": -0.0012000291608273983, "target_entropy": -6.0, "policy_t": 0.006695282645523548, "mean_q": 0.06474436819553375, "max_q": 0.07993676513433456, "min_q": 0.05200220271945}, "td_error": [6.053654670715332, 4.679862976074219, 5.702777862548828, 6.336939811706543, 5.876932621002197, 5.934252738952637, 7.134363174438477, 5.5989885330200195, 6.242957592010498, 4.263399600982666, 6.3164777755737305, 7.55113410949707, 6.063789367675781, 6.002927780151367, 7.872372627258301, 5.916593551635742, 6.612285614013672, 5.375516891479492, 4.643775463104248, 5.281339645385742, 4.431798934936523, 6.957991123199463, 6.272974967956543, 7.029250144958496, 6.376399993896484, 4.703277111053467, 4.420403480529785, 5.0788116455078125, 5.332754611968994, 5.951066970825195, 5.996564865112305, 6.565563201904297, 5.452293395996094, 5.954953193664551, 6.159546852111816, 5.463388442993164, 4.6944379806518555, 7.518336296081543, 5.798151969909668, 4.849113464355469, 6.832592010498047, 4.288518905639648, 5.763521194458008, 5.200613021850586, 3.3644211292266846, 6.07492733001709, 6.31499719619751, 5.499829292297363, 5.820525646209717, 5.159329414367676, 7.027637481689453, 5.625738143920898, 5.4268388748168945, 5.912939071655273, 3.6074180603027344, 5.977504730224609, 4.77521276473999, 5.197732925415039, 5.576176643371582, 5.980611801147461, 6.638592720031738, 6.16970157623291, 4.183082580566406, 6.1225481033325195, 5.797146797180176, 4.921622276306152, 6.73922061920166, 5.478717803955078, 6.12343692779541, 7.209847450256348, 6.26955509185791, 7.0183024406433105, 5.032797813415527, 5.486509323120117, 4.820346832275391, 5.713388442993164, 5.943638801574707, 4.299685478210449, 6.013566017150879, 5.19580078125, 4.515305519104004, 5.289402008056641, 5.554757595062256, 6.682158470153809, 7.417222023010254, 6.607781410217285], "mean_td_error": 5.757425785064697, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 5.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.10096263885498, "actor_loss": -4.15134859085083, "critic_loss": 3.0759639739990234, "alpha_loss": -0.012121512554585934, "alpha_value": 0.9988006949424744, "log_alpha_value": -0.001200035447254777, "target_entropy": -6.0, "policy_t": 0.04319809004664421, "mean_q": 0.05748628079891205, "max_q": 0.0748893991112709, "min_q": 0.04722397401928902}, "td_error": [3.1862635612487793, 2.4584665298461914, 3.858548641204834, 2.1624772548675537, 3.265127182006836, 4.633248329162598, 5.100004196166992, 3.6881051063537598, 4.0010666847229, 4.255208969116211, 5.07450532913208, 3.038792610168457, 2.6133766174316406, 2.8068976402282715, 4.754755973815918, 3.276815891265869, 2.9983232021331787, 4.874998092651367, 3.059183120727539, 4.500011444091797, 5.417065143585205, 3.8547563552856445, 2.52841854095459, 3.987440824508667, 6.635812759399414, 3.9069790840148926, 2.587751626968384, 5.315199375152588, 4.150834083557129, 3.650146007537842, 3.476947784423828, 4.157779693603516, 4.961151599884033, 4.089111328125, 5.039801597595215, 4.016162872314453, 2.716446876525879, 2.542362928390503, 2.326415777206421, 2.5305848121643066, 5.351494789123535, 4.763223648071289, 4.397487640380859, 3.107396125793457, 4.218545913696289, 2.7787184715270996, 3.191521167755127, 2.941990375518799, 3.980691909790039, 5.424877166748047, 1.8869574069976807, 4.128237724304199, 4.437877655029297, 2.8432488441467285, 2.7480392456054688, 2.2615561485290527, 5.0146942138671875, 4.568746566772461, 3.566713333129883, 2.479368209838867, 2.150846242904663, 2.6672310829162598, 4.075469970703125, 3.1000568866729736, 3.722362995147705, 7.058189392089844, 4.333323955535889, 3.6319022178649902, 3.622898578643799, 0.44675031304359436, 3.9165587425231934, 3.137075424194336, 1.8635804653167725, 5.47750186920166, 4.382045745849609, 2.7484545707702637, 3.024108409881592, 5.8724141120910645, 3.2654151916503906, 3.714515209197998, 3.2116427421569824, 4.38148307800293, 3.634164810180664, 4.611003875732422, 4.856650352478027, 3.245208740234375], "mean_td_error": 3.7411580085754395, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 5.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.025792121887207, "actor_loss": -4.078319549560547, "critic_loss": 2.573802947998047, "alpha_loss": -0.012031842023134232, "alpha_value": 0.9988006353378296, "log_alpha_value": -0.0012000889983028173, "target_entropy": -6.0, "policy_t": -0.062477000057697296, "mean_q": 0.05777546018362045, "max_q": 0.0735073983669281, "min_q": 0.048431336879730225}, "td_error": [4.772735118865967, 2.0959019660949707, 2.148435115814209, 3.797189235687256, 4.002852916717529, 3.5834720134735107, 3.9869022369384766, 2.860175132751465, 2.650899887084961, 4.30776309967041, 4.751438140869141, 1.6116923093795776, 3.850492000579834, 2.940734624862671, 3.530015468597412, 3.426258087158203, 3.3815042972564697, 2.9834132194519043, 3.3097434043884277, 4.3512067794799805, 3.5367274284362793, 3.408698081970215, 2.3878841400146484, 3.958498954772949, 2.3531928062438965, 4.62053108215332, 3.586395263671875, 1.9606409072875977, 4.270363807678223, 1.7760722637176514, 2.3862648010253906, 4.100039482116699, 2.1661293506622314, 4.4899468421936035, 4.769203186035156, 5.374611854553223, 2.179813861846924, 3.360619068145752, 2.838502883911133, 1.4448866844177246, 3.6372127532958984, 3.2172389030456543, 2.737271547317505, 3.527646541595459, 4.544632911682129, 4.53678560256958, 3.997666597366333, 3.3788652420043945, 3.915884494781494, 4.422790050506592, 2.1447525024414062, 4.789734840393066, 2.5057730674743652, 5.662543296813965, 4.6726274490356445, 3.1998291015625, 3.3982419967651367, 1.1214828491210938, 2.95217227935791, 2.959005832672119, 3.430299758911133, 4.1600775718688965, 4.030923843383789, 2.4560184478759766, 5.872645378112793, 2.7640392780303955, 2.251298427581787, 4.248455047607422, 2.8631138801574707, 3.635406970977783, 4.001626968383789, 2.4672183990478516, 2.673455238342285, 4.4725141525268555, 3.037771224975586, 5.105177879333496, 3.9435670375823975, 1.8351073265075684, 3.4571938514709473, 3.7416129112243652, 4.40328311920166, 4.670968055725098, 4.832422256469727, 2.1192712783813477, 3.217866897583008, 3.2298285961151123], "mean_td_error": 3.459944009780884, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 5.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 5376, "num_env_steps_trained": 1290, "num_agent_steps_sampled": 16128, "num_agent_steps_trained": 1290, "last_target_update_ts": 5376, "num_target_updates": 5}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16128, "num_agent_steps_trained": 1290, "num_env_steps_sampled": 5376, "num_env_steps_trained": 1290, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 478.65650297025616, "num_env_steps_trained_throughput_per_sec": 137.82743054277466, "timesteps_total": 5376, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 16128, "timers": {"training_iteration_time_ms": 2145.049, "sample_time_ms": 1349.232, "load_time_ms": 0.551, "load_throughput": 467847.139, "learn_time_ms": 73.441, "learn_throughput": 3513.007, "synch_weights_time_ms": 17.142}, "counters": {"num_env_steps_sampled": 5376, "num_env_steps_trained": 1290, "num_agent_steps_sampled": 16128, "num_agent_steps_trained": 1290, "last_target_update_ts": 5376, "num_target_updates": 5}, "done": false, "episodes_total": 0, "training_iteration": 6, "trial_id": "9a806_00000", "date": "2023-11-16_21-53-50", "timestamp": 1700200430, "time_this_iter_s": 1.8880138397216797, "time_total_s": 12.955886840820312, "pid": 45784, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fadc09cd4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 12.955886840820312, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 53.06666666666666, "ram_util_percent": 89.96666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.136990547180176, "actor_loss": -4.203274250030518, "critic_loss": 4.46658992767334, "alpha_loss": -0.015207021497189999, "alpha_value": 0.9985010027885437, "log_alpha_value": -0.001500151352956891, "target_entropy": -6.0, "policy_t": 0.0006332208286039531, "mean_q": 0.08435480296611786, "max_q": 0.10343501716852188, "min_q": 0.06793675571680069}, "td_error": [7.423640251159668, 5.245059013366699, 4.050208568572998, 5.053885459899902, 4.562711238861084, 5.423103332519531, 4.581025123596191, 4.542746543884277, 5.3843994140625, 4.961694717407227, 5.625635147094727, 5.763599395751953, 3.1084537506103516, 6.127101898193359, 5.998785018920898, 3.841541290283203, 5.532932281494141, 5.293877124786377, 4.188746452331543, 3.7319045066833496, 4.9333648681640625, 4.352608680725098, 8.262735366821289, 4.594280242919922, 4.987939834594727, 4.830962181091309, 3.3307137489318848, 7.026721477508545, 5.646101951599121, 4.552731990814209, 7.484114646911621, 5.12507438659668, 6.277945518493652, 5.930576324462891, 4.38883638381958, 6.380673408508301, 3.4184131622314453, 7.2676286697387695, 4.0965423583984375, 5.317104339599609, 4.971898078918457, 6.4930620193481445, 5.960659980773926, 5.647371292114258, 5.777481555938721, 6.580708980560303, 5.917903900146484, 4.270097732543945, 6.02985954284668, 4.456904411315918, 5.7734527587890625, 5.770829200744629, 5.023242950439453, 6.219489574432373, 2.78420352935791, 7.19560432434082, 5.446427822113037, 6.344710350036621, 7.142675399780273, 3.5685653686523438, 4.660233974456787, 5.376537322998047, 6.496394157409668, 6.184826850891113, 5.08056640625, 4.173211097717285, 6.472036361694336, 6.475435256958008, 5.344734191894531, 4.7514238357543945, 6.463370323181152, 6.152326583862305, 4.703630447387695, 5.006113052368164, 6.508087158203125, 5.462486743927002, 2.482253313064575, 7.4786272048950195, 6.18028450012207, 6.238358020782471, 4.369619369506836, 4.084064483642578, 6.274499893188477, 5.461679935455322, 6.080239295959473, 3.5651490688323975], "mean_td_error": 5.366830348968506, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 6.0, "diff_num_grad_updates_vs_sampler_policy": 5.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.117067337036133, "actor_loss": -4.181115627288818, "critic_loss": 2.6434974670410156, "alpha_loss": -0.015177327208220959, "alpha_value": 0.9985009431838989, "log_alpha_value": -0.0015001706779003143, "target_entropy": -6.0, "policy_t": -0.006332735996693373, "mean_q": 0.07456108182668686, "max_q": 0.09342356026172638, "min_q": 0.06224006414413452}, "td_error": [2.3048014640808105, 5.887523651123047, 4.153645992279053, 1.9748027324676514, 3.524465560913086, 4.9186177253723145, 4.607231140136719, 3.4589176177978516, 4.700557708740234, 3.7216532230377197, 4.810670852661133, 3.7744345664978027, 3.8619349002838135, 2.844088077545166, 3.840785026550293, 3.321995496749878, 4.197787761688232, 4.234201431274414, 4.101149559020996, 5.299424648284912, 4.491901397705078, 4.6172380447387695, 4.517084121704102, 1.9016683101654053, 4.0847578048706055, 2.8575403690338135, 4.938848495483398, 3.803982734680176, 3.1520676612854004, 2.522470235824585, 4.292225360870361, 2.304384708404541, 4.04487419128418, 6.404333591461182, 3.1821324825286865, 3.6157922744750977, 3.1783571243286133, 3.478548049926758, 4.552888870239258, 3.0476746559143066, 2.8901519775390625, 2.595118522644043, 3.180844783782959, 4.144068717956543, 3.573145627975464, 3.9253249168395996, 3.6204371452331543, 4.368826389312744, 2.4965639114379883, 2.4706265926361084, 3.26971173286438, 2.3431034088134766, 4.355905532836914, 4.712126731872559, 3.34633731842041, 2.0266432762145996, 4.2104811668396, 3.704244613647461, 4.721233367919922, 5.319147109985352, 3.530851364135742, 5.132749557495117, 2.960813522338867, 4.159330368041992, 3.997313976287842, 4.228096008300781, 4.273399353027344, 3.483954429626465, 4.21343469619751, 3.56903076171875, 3.5034399032592773, 3.317534923553467, 3.865943431854248, 4.716771602630615, 3.3715200424194336, 2.9739034175872803, 3.9564733505249023, 2.515191078186035, 4.919053077697754, 3.961214542388916, 2.911745071411133, 3.906494617462158, 5.551486015319824, 3.667738914489746, 6.3072662353515625, 2.6688101291656494], "mean_td_error": 3.8077335357666016, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 6.0, "diff_num_grad_updates_vs_sampler_policy": 5.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.10284423828125, "actor_loss": -4.170024871826172, "critic_loss": 2.8309202194213867, "alpha_loss": -0.015155099332332611, "alpha_value": 0.9985010623931885, "log_alpha_value": -0.0015000824350863695, "target_entropy": -6.0, "policy_t": -0.022478953003883362, "mean_q": 0.07765921205282211, "max_q": 0.09241564571857452, "min_q": 0.06407604366540909}, "td_error": [2.5777382850646973, 3.877159357070923, 4.075474739074707, 2.409104824066162, 4.799172401428223, 4.076444625854492, 3.2747395038604736, 3.9073028564453125, 6.092467308044434, 5.123228073120117, 3.4124369621276855, 4.212882995605469, 2.3804612159729004, 2.496149778366089, 4.720305919647217, 3.29353404045105, 5.334529876708984, 2.437870502471924, 2.5657992362976074, 3.8677003383636475, 6.804518699645996, 3.1501872539520264, 4.5374908447265625, 4.108393669128418, 2.4445714950561523, 4.3182597160339355, 3.358745574951172, 3.509805202484131, 2.4681293964385986, 2.85713267326355, 3.7204365730285645, 2.3744096755981445, 2.671213150024414, 2.403400182723999, 3.5581955909729004, 3.5228824615478516, 1.6365898847579956, 4.288783073425293, 1.3168432712554932, 3.702944278717041, 2.8879499435424805, 5.142301559448242, 5.508491516113281, 2.5417513847351074, 5.798347473144531, 3.023160457611084, 2.2499594688415527, 1.9682916402816772, 3.831721305847168, 3.5197763442993164, 3.855081081390381, 3.608273506164551, 5.023907661437988, 4.018683910369873, 4.703612327575684, 2.1561949253082275, 4.802107810974121, 3.3209362030029297, 4.135502815246582, 4.146329879760742, 3.9153237342834473, 4.812091827392578, 4.783651351928711, 4.104125022888184, 4.815810203552246, 3.9500021934509277, 4.125644207000732, 3.8566410541534424, 2.861830711364746, 5.113758087158203, 3.840709686279297, 3.2392821311950684, 1.8730863332748413, 4.050849914550781, 2.9192757606506348, 4.429716110229492, 3.548330307006836, 4.442593574523926, 5.6972503662109375, 3.452423095703125, 4.865052223205566, 1.7732148170471191, 5.072556495666504, 1.5330851078033447, 4.671648979187012, 6.110342502593994], "mean_td_error": 3.741722583770752, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 6.0, "diff_num_grad_updates_vs_sampler_policy": 5.0}}, "num_env_steps_sampled": 6272, "num_env_steps_trained": 1548, "num_agent_steps_sampled": 18816, "num_agent_steps_trained": 1548, "last_target_update_ts": 6272, "num_target_updates": 6}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18816, "num_agent_steps_trained": 1548, "num_env_steps_sampled": 6272, "num_env_steps_trained": 1548, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 572.4226954446649, "num_env_steps_trained_throughput_per_sec": 164.82707078652183, "timesteps_total": 6272, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 18816, "timers": {"training_iteration_time_ms": 2062.219, "sample_time_ms": 1297.408, "load_time_ms": 0.548, "load_throughput": 470491.492, "learn_time_ms": 71.883, "learn_throughput": 3589.174, "synch_weights_time_ms": 16.924}, "counters": {"num_env_steps_sampled": 6272, "num_env_steps_trained": 1548, "num_agent_steps_sampled": 18816, "num_agent_steps_trained": 1548, "last_target_update_ts": 6272, "num_target_updates": 6}, "done": false, "episodes_total": 0, "training_iteration": 7, "trial_id": "9a806_00000", "date": "2023-11-16_21-53-52", "timestamp": 1700200432, "time_this_iter_s": 1.5799388885498047, "time_total_s": 14.535825729370117, "pid": 45784, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fade2d21b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 14.535825729370117, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 65.8, "ram_util_percent": 89.95}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.081847190856934, "actor_loss": -4.165853977203369, "critic_loss": 4.824995994567871, "alpha_loss": -0.018150847405195236, "alpha_value": 0.9982012510299683, "log_alpha_value": -0.001800349447876215, "target_entropy": -6.0, "policy_t": -0.010216551832854748, "mean_q": 0.10505658388137817, "max_q": 0.13182829320430756, "min_q": 0.08312194049358368}, "td_error": [6.3708600997924805, 5.58966064453125, 9.362624168395996, 4.55177116394043, 5.002710342407227, 4.394519805908203, 5.345308303833008, 5.183446884155273, 5.1295366287231445, 4.648076057434082, 5.859465599060059, 3.6206672191619873, 4.204606056213379, 5.862993240356445, 6.1795654296875, 4.687689781188965, 5.188594818115234, 5.132181644439697, 6.490623474121094, 6.499300003051758, 6.083674907684326, 6.681093215942383, 5.043961524963379, 5.304612159729004, 3.9757769107818604, 5.638775825500488, 6.176623344421387, 5.355001449584961, 6.927745819091797, 5.784530162811279, 5.283816337585449, 6.340096473693848, 5.423014163970947, 5.7564802169799805, 6.029053211212158, 5.714328765869141, 5.623517036437988, 5.322070121765137, 6.215556621551514, 6.762468338012695, 7.340670585632324, 6.513646125793457, 5.867412567138672, 3.8782286643981934, 5.943840026855469, 6.091377258300781, 4.712009906768799, 5.655292510986328, 6.514423370361328, 5.173335075378418, 6.400890827178955, 6.003410816192627, 5.978264808654785, 3.7625179290771484, 4.722508430480957, 6.357394218444824, 5.096002101898193, 5.108757019042969, 6.330751419067383, 5.34078311920166, 5.6990742683410645, 5.423485279083252, 7.402955055236816, 5.447721481323242, 5.7321600914001465, 5.640683174133301, 4.545892715454102, 6.37858772277832, 6.96566104888916, 5.238255500793457, 7.262803077697754, 5.483436584472656, 6.103144645690918, 6.341265678405762, 5.690471649169922, 6.6408891677856445, 5.864609718322754, 4.025936603546143, 5.712991714477539, 6.215919494628906, 5.736483573913574, 4.869327545166016, 6.098462104797363, 6.340261459350586, 6.79417610168457, 5.672022819519043], "mean_td_error": 5.707727909088135, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 7.0, "diff_num_grad_updates_vs_sampler_policy": 6.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.059904098510742, "actor_loss": -4.140780925750732, "critic_loss": 2.575277328491211, "alpha_loss": -0.0181118156760931, "alpha_value": 0.9982012510299683, "log_alpha_value": -0.001800396479666233, "target_entropy": -6.0, "policy_t": 0.042278241366147995, "mean_q": 0.09142112731933594, "max_q": 0.11533024162054062, "min_q": 0.07629120349884033}, "td_error": [3.2528703212738037, 3.736194610595703, 2.923271417617798, 3.155541181564331, 2.8486132621765137, 4.256148338317871, 3.5106844902038574, 4.138370990753174, 2.0114810466766357, 3.103487253189087, 4.368624687194824, 3.581566333770752, 4.734967231750488, 3.0945544242858887, 6.222591876983643, 3.0246009826660156, 3.157970905303955, 4.3725385665893555, 4.923367500305176, 4.051328659057617, 5.668604850769043, 3.602874755859375, 2.667736053466797, 4.519721031188965, 2.351864814758301, 3.458735704421997, 2.1980326175689697, 3.771489381790161, 4.6293230056762695, 4.957083702087402, 2.319979190826416, 3.875471591949463, 3.598538398742676, 3.080007553100586, 3.6034607887268066, 3.4957962036132812, 2.9432506561279297, 5.294390678405762, 3.11240816116333, 4.902626991271973, 4.041474342346191, 0.4311666190624237, 3.9887781143188477, 1.99818754196167, 4.390464782714844, 2.6998300552368164, 5.843949317932129, 3.1163082122802734, 3.115446090698242, 2.69467830657959, 2.184988498687744, 4.731218338012695, 3.5036911964416504, 2.8609189987182617, 3.537978172302246, 5.091489791870117, 3.289015293121338, 4.883894920349121, 2.3071539402008057, 3.2582552433013916, 4.78481388092041, 6.080750465393066, 2.1149485111236572, 3.5756173133850098, 4.389374732971191, 4.040450096130371, 2.539578437805176, 4.177900314331055, 2.65608549118042, 6.935755729675293, 4.1048431396484375, 4.604211330413818, 3.5667805671691895, 3.081355571746826, 4.016299724578857, 5.701885223388672, 4.679644584655762, 2.4704742431640625, 5.3607587814331055, 3.09958815574646, 5.427608013153076, 4.148380279541016, 2.2447800636291504, 4.506415367126465, 4.678065299987793, 5.237244606018066], "mean_td_error": 3.775728464126587, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 7.0, "diff_num_grad_updates_vs_sampler_policy": 6.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.081451416015625, "actor_loss": -4.166555881500244, "critic_loss": 2.690145492553711, "alpha_loss": -0.018147848546504974, "alpha_value": 0.9982014894485474, "log_alpha_value": -0.0018001225544139743, "target_entropy": -6.0, "policy_t": -0.05039944872260094, "mean_q": 0.09667926281690598, "max_q": 0.12593115866184235, "min_q": 0.07963897287845612}, "td_error": [2.673126697540283, 4.225437164306641, 3.5140020847320557, 3.0805320739746094, 2.2671191692352295, 5.005521774291992, 2.3491811752319336, 3.153409719467163, 5.242818832397461, 2.8742504119873047, 3.9303572177886963, 2.332200050354004, 1.853407382965088, 3.058281898498535, 3.501699924468994, 3.5101888179779053, 4.369193077087402, 4.321751594543457, 5.495022296905518, 4.067679405212402, 1.4597580432891846, 3.3058221340179443, 2.6714746952056885, 1.7893463373184204, 2.6259241104125977, 1.8640515804290771, 2.5989341735839844, 3.966284990310669, 2.8452391624450684, 3.821925163269043, 4.487398624420166, 4.120495796203613, 2.982016086578369, 3.734947681427002, 6.07149600982666, 4.553288459777832, 1.2466377019882202, 4.50738525390625, 3.281987190246582, 2.7199180126190186, 5.232610702514648, 2.7660932540893555, 3.9472808837890625, 3.9037046432495117, 4.049682140350342, 4.776333332061768, 3.4169435501098633, 1.3878939151763916, 5.689978122711182, 3.0339670181274414, 1.9447076320648193, 3.2573413848876953, 3.458822727203369, 4.376462936401367, 3.3118081092834473, 3.9695491790771484, 3.877135992050171, 2.255453109741211, 4.23960542678833, 4.25347375869751, 4.095423698425293, 3.3890380859375, 3.5473432540893555, 2.799652338027954, 3.461333751678467, 5.601017951965332, 3.3624520301818848, 3.670407295227051, 3.9468016624450684, 3.3045153617858887, 2.7673697471618652, 4.119280815124512, 4.595444679260254, 3.0413379669189453, 4.156432628631592, 3.6138710975646973, 3.026853084564209, 4.213293552398682, 4.372404098510742, 4.454494476318359, 4.095640182495117, 4.546017169952393, 2.937932014465332, 5.844112396240234, 3.9298813343048096, 2.794325113296509], "mean_td_error": 3.5850589275360107, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 7.0, "diff_num_grad_updates_vs_sampler_policy": 6.0}}, "num_env_steps_sampled": 7168, "num_env_steps_trained": 1806, "num_agent_steps_sampled": 21504, "num_agent_steps_trained": 1806, "last_target_update_ts": 7168, "num_target_updates": 7}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 21504, "num_agent_steps_trained": 1806, "num_env_steps_sampled": 7168, "num_env_steps_trained": 1806, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 561.9674973393959, "num_env_steps_trained_throughput_per_sec": 161.81653383210283, "timesteps_total": 7168, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 21504, "timers": {"training_iteration_time_ms": 2003.735, "sample_time_ms": 1262.359, "load_time_ms": 0.547, "load_throughput": 471399.155, "learn_time_ms": 70.539, "learn_throughput": 3657.535, "synch_weights_time_ms": 16.548}, "counters": {"num_env_steps_sampled": 7168, "num_env_steps_trained": 1806, "num_agent_steps_sampled": 21504, "num_agent_steps_trained": 1806, "last_target_update_ts": 7168, "num_target_updates": 7}, "done": false, "episodes_total": 0, "training_iteration": 8, "trial_id": "9a806_00000", "date": "2023-11-16_21-53-53", "timestamp": 1700200433, "time_this_iter_s": 1.609635829925537, "time_total_s": 16.145461559295654, "pid": 45784, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fadd04f7f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 16.145461559295654, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 51.866666666666674, "ram_util_percent": 89.90000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.129337310791016, "actor_loss": -4.233293056488037, "critic_loss": 4.604927062988281, "alpha_loss": -0.021276872605085373, "alpha_value": 0.9979016780853271, "log_alpha_value": -0.002100519835948944, "target_entropy": -6.0, "policy_t": -0.006565699819475412, "mean_q": 0.12719058990478516, "max_q": 0.15800897777080536, "min_q": 0.10388302803039551}, "td_error": [5.267970085144043, 5.418705940246582, 4.661304473876953, 5.193012237548828, 5.622490882873535, 6.455491065979004, 4.784183979034424, 6.704084873199463, 5.758719444274902, 3.289743423461914, 4.6207966804504395, 5.232846736907959, 5.401255130767822, 4.760934829711914, 5.924300193786621, 5.961313247680664, 6.093955993652344, 3.7905173301696777, 6.542690277099609, 4.178560733795166, 5.392961502075195, 5.438786506652832, 5.30702018737793, 6.290022850036621, 4.458621025085449, 5.227922439575195, 6.321044921875, 5.936911582946777, 5.540070533752441, 3.4609999656677246, 5.046180248260498, 5.6192626953125, 4.42043399810791, 5.700909614562988, 3.4892234802246094, 4.025844573974609, 5.929396152496338, 6.040701866149902, 6.462184906005859, 5.451632499694824, 5.501291751861572, 3.3464176654815674, 6.9042510986328125, 6.85151481628418, 4.747749328613281, 4.7385101318359375, 6.475398063659668, 4.917533874511719, 6.124977111816406, 8.552810668945312, 4.403285503387451, 5.835553169250488, 5.102090835571289, 5.083313941955566, 3.7574362754821777, 6.147004127502441, 6.152624130249023, 4.051721572875977, 5.629512786865234, 6.3611674308776855, 4.4674577713012695, 6.58445930480957, 5.202261924743652, 4.185710906982422, 3.930807590484619, 5.101700782775879, 5.507256507873535, 5.701716423034668, 6.21856689453125, 5.193704128265381, 5.700809001922607, 6.769681453704834, 7.497142791748047, 6.4959259033203125, 4.321338176727295, 5.022831916809082, 4.810157299041748, 5.231952667236328, 4.641110420227051, 6.170073509216309, 5.991997718811035, 7.134063720703125, 4.825922012329102, 5.139679908752441, 6.141692161560059, 5.482823848724365], "mean_td_error": 5.411372184753418, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 8.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.114957809448242, "actor_loss": -4.213676452636719, "critic_loss": 2.5252106189727783, "alpha_loss": -0.021247494965791702, "alpha_value": 0.9979016184806824, "log_alpha_value": -0.0021006015595048666, "target_entropy": -6.0, "policy_t": 0.008989071473479271, "mean_q": 0.11180305480957031, "max_q": 0.13218793272972107, "min_q": 0.0913681611418724}, "td_error": [4.8023152351379395, 2.5643861293792725, 3.450883150100708, 5.487421035766602, 5.084648132324219, 2.6810312271118164, 4.258731842041016, 2.9430315494537354, 4.198457717895508, 3.462174892425537, 4.370112895965576, 4.525371551513672, 4.166798114776611, 3.424210548400879, 3.8048105239868164, 1.8457434177398682, 4.194323539733887, 2.981914520263672, 1.8592373132705688, 1.8513665199279785, 6.096283435821533, 2.376985549926758, 4.100519180297852, 4.397706031799316, 1.676822304725647, 5.533892631530762, 2.684229850769043, 4.110042572021484, 1.292649269104004, 1.559436559677124, 3.3288187980651855, 4.583832263946533, 4.079349994659424, 3.1398980617523193, 1.6317312717437744, 3.590143918991089, 3.371781826019287, 3.7667617797851562, 4.230710506439209, 2.9524853229522705, 3.138434886932373, 3.1592307090759277, 3.5659091472625732, 3.571782112121582, 2.6184821128845215, 4.076615333557129, 1.9683246612548828, 3.3445234298706055, 2.5249111652374268, 3.393678903579712, 3.9245944023132324, 2.953193426132202, 4.716896057128906, 3.665902853012085, 5.348300457000732, 2.8321309089660645, 3.5328521728515625, 4.512061595916748, 4.01516580581665, 3.95973801612854, 3.8815231323242188, 4.688755035400391, 2.2279906272888184, 2.3772759437561035, 2.718156337738037, 4.537932395935059, 1.7194037437438965, 4.997180461883545, 3.8478105068206787, 2.0399746894836426, 4.560177326202393, 2.7500877380371094, 4.498758316040039, 5.2650346755981445, 4.4419145584106445, 3.9800148010253906, 5.277379989624023, 3.9204180240631104, 3.696382522583008, 6.562222480773926, 4.261741638183594, 5.548211097717285, 4.661319255828857, 4.14626932144165, 4.133110523223877, 3.2625575065612793], "mean_td_error": 3.6661088466644287, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 8.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.093866348266602, "actor_loss": -4.194376468658447, "critic_loss": 2.748638153076172, "alpha_loss": -0.02119877003133297, "alpha_value": 0.9979020357131958, "log_alpha_value": -0.0021001636050641537, "target_entropy": -6.0, "policy_t": -0.04248728230595589, "mean_q": 0.11719362437725067, "max_q": 0.13744840025901794, "min_q": 0.09828220307826996}, "td_error": [4.317869186401367, 3.012887954711914, 3.832512378692627, 2.1220004558563232, 5.299399375915527, 4.8822784423828125, 1.1022677421569824, 4.291492462158203, 4.154328346252441, 2.576274871826172, 3.6718199253082275, 4.338207721710205, 3.1895899772644043, 3.0150279998779297, 4.596935749053955, 4.0576066970825195, 1.7319917678833008, 5.299899101257324, 4.1771039962768555, 3.936880111694336, 2.573634147644043, 4.104328155517578, 3.4949429035186768, 3.0744547843933105, 3.7964935302734375, 3.2438554763793945, 3.1958234310150146, 3.111908435821533, 4.767050743103027, 4.44345760345459, 4.472562789916992, 3.022923707962036, 4.893514633178711, 4.820758819580078, 2.733184337615967, 2.568206787109375, 3.9808335304260254, 3.460214853286743, 3.498899459838867, 4.246224403381348, 3.994035243988037, 3.1111485958099365, 3.56390380859375, 3.9763684272766113, 3.2581324577331543, 3.405651092529297, 2.7943215370178223, 3.912574052810669, 3.038026809692383, 4.434577941894531, 4.806863784790039, 3.9132399559020996, 2.907811403274536, 3.552870273590088, 2.633772373199463, 2.739210844039917, 4.774572372436523, 4.924209117889404, 3.5899393558502197, 5.678037643432617, 3.129807233810425, 5.569606781005859, 2.073314666748047, 3.663560390472412, 2.7468252182006836, 4.040606498718262, 3.347785472869873, 4.153388500213623, 4.281294822692871, 3.7946152687072754, 3.182584762573242, 3.908600330352783, 3.060295820236206, 2.2543225288391113, 3.0677762031555176, 4.86845064163208, 3.705829620361328, 1.9036906957626343, 5.021924018859863, 3.154603958129883, 2.0935797691345215, 1.698930025100708, 2.8077125549316406, 3.579853057861328, 2.003751516342163, 2.9846370220184326], "mean_td_error": 3.5839102268218994, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 8.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 8064, "num_env_steps_trained": 2064, "num_agent_steps_sampled": 24192, "num_agent_steps_trained": 2064, "last_target_update_ts": 8064, "num_target_updates": 8}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24192, "num_agent_steps_trained": 2064, "num_env_steps_sampled": 8064, "num_env_steps_trained": 2064, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 554.3305831886083, "num_env_steps_trained_throughput_per_sec": 159.61751167707695, "timesteps_total": 8064, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 24192, "timers": {"training_iteration_time_ms": 1960.692, "sample_time_ms": 1237.33, "load_time_ms": 0.544, "load_throughput": 473917.089, "learn_time_ms": 69.518, "learn_throughput": 3711.267, "synch_weights_time_ms": 16.314}, "counters": {"num_env_steps_sampled": 8064, "num_env_steps_trained": 2064, "num_agent_steps_sampled": 24192, "num_agent_steps_trained": 2064, "last_target_update_ts": 8064, "num_target_updates": 8}, "done": false, "episodes_total": 0, "training_iteration": 9, "trial_id": "9a806_00000", "date": "2023-11-16_21-53-55", "timestamp": 1700200435, "time_this_iter_s": 1.6337761878967285, "time_total_s": 17.779237747192383, "pid": 45784, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fadc09cd820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 17.779237747192383, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 70.5, "ram_util_percent": 89.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.063543319702148, "actor_loss": -4.185940265655518, "critic_loss": 4.875234603881836, "alpha_loss": -0.024159949272871017, "alpha_value": 0.9976021647453308, "log_alpha_value": -0.002400739584118128, "target_entropy": -6.0, "policy_t": -0.03538040816783905, "mean_q": 0.14888957142829895, "max_q": 0.17002429068088531, "min_q": 0.12112940102815628}, "td_error": [6.568487167358398, 4.049802780151367, 4.432315826416016, 5.817240238189697, 6.4659576416015625, 4.694840431213379, 7.520011901855469, 6.62795877456665, 5.895845890045166, 6.58305025100708, 7.332996368408203, 6.3073883056640625, 5.753716468811035, 5.957328796386719, 5.105655670166016, 4.715757369995117, 6.842503547668457, 4.791017532348633, 5.223704814910889, 5.52817440032959, 6.791775703430176, 6.695339202880859, 5.183688163757324, 7.4485626220703125, 6.209292411804199, 5.827157020568848, 6.571637153625488, 5.243240833282471, 6.976605415344238, 6.1502766609191895, 6.281081676483154, 6.618818759918213, 5.284594535827637, 6.310652732849121, 7.915947914123535, 5.551505088806152, 4.644484519958496, 3.8695716857910156, 6.949413776397705, 4.814099311828613, 5.513194561004639, 5.841862201690674, 6.959918022155762, 3.7128303050994873, 2.5671463012695312, 6.300772666931152, 6.369663715362549, 6.299928665161133, 7.373600959777832, 4.190420150756836, 5.844953536987305, 7.683185577392578, 4.703631401062012, 6.828119277954102, 6.551222324371338, 4.14462947845459, 7.504059314727783, 6.295665740966797, 4.668916702270508, 5.647896766662598, 6.460590362548828, 5.3762311935424805, 3.9045310020446777, 6.954522132873535, 6.812137126922607, 4.571710109710693, 4.528724193572998, 4.279210567474365, 5.7614641189575195, 7.0806989669799805, 5.401851654052734, 4.002710342407227, 4.669376373291016, 4.163766860961914, 6.166707992553711, 5.4828290939331055, 3.518538236618042, 3.7480578422546387, 3.9237923622131348, 5.109208583831787, 6.387804985046387, 7.1284990310668945, 4.496548652648926, 6.579338073730469, 4.986264228820801, 6.10047721862793], "mean_td_error": 5.699403762817383, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 9.0, "diff_num_grad_updates_vs_sampler_policy": 8.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.102389335632324, "actor_loss": -4.218223571777344, "critic_loss": 2.4921364784240723, "alpha_loss": -0.02425454743206501, "alpha_value": 0.9976019859313965, "log_alpha_value": -0.002400872064754367, "target_entropy": -6.0, "policy_t": -0.006316318176686764, "mean_q": 0.13424038887023926, "max_q": 0.1756400167942047, "min_q": 0.11518950760364532}, "td_error": [1.775545597076416, 4.200750350952148, 3.930497646331787, 4.746840476989746, 4.697751998901367, 2.6121764183044434, 3.070126533508301, 4.746856689453125, 2.215575695037842, 3.6860780715942383, 4.315910816192627, 5.166945457458496, 4.717524528503418, 3.772467613220215, 2.1312880516052246, 5.442743301391602, 4.608546257019043, 3.3588719367980957, 4.332613945007324, 4.282290458679199, 3.9507908821105957, 3.105198860168457, 4.021169185638428, 3.230856418609619, 3.204875946044922, 3.163419246673584, 4.076312065124512, 5.994555473327637, 1.1014294624328613, 2.546672821044922, 4.781268119812012, 2.6758322715759277, 3.5829315185546875, 4.895334243774414, 2.2092392444610596, 3.0398294925689697, 5.368339538574219, 2.404116153717041, 3.699968099594116, 4.786860942840576, 4.977855682373047, 3.6555492877960205, 4.525252342224121, 2.3181095123291016, 1.8492238521575928, 4.575872421264648, 3.685340642929077, 2.583441734313965, 2.290708541870117, 2.76347017288208, 3.7962965965270996, 3.1923599243164062, 3.7196927070617676, 3.6351304054260254, 3.5595288276672363, 2.582034111022949, 2.8239095211029053, 4.783767223358154, 3.081916093826294, 1.1657938957214355, 4.175169467926025, 2.621462821960449, 4.309539794921875, 5.004916191101074, 3.0916457176208496, 4.374258518218994, 3.5975961685180664, 3.9171926975250244, 2.516172170639038, 3.9705328941345215, 4.786096572875977, 3.3310763835906982, 3.7093048095703125, 3.072646379470825, 2.496450424194336, 4.159292221069336, 4.479557514190674, 2.1216206550598145, 2.079359531402588, 3.8142294883728027, 3.240962505340576, 4.00411319732666, 4.707042217254639, 5.31528377532959, 4.761277198791504, 4.921723365783691], "mean_td_error": 3.6487693786621094, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 9.0, "diff_num_grad_updates_vs_sampler_policy": 8.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.087745666503906, "actor_loss": -4.210989475250244, "critic_loss": 2.6923041343688965, "alpha_loss": -0.024212848395109177, "alpha_value": 0.997602641582489, "log_alpha_value": -0.002400223631411791, "target_entropy": -6.0, "policy_t": 0.016317030414938927, "mean_q": 0.13652603328227997, "max_q": 0.1687619537115097, "min_q": 0.11719859391450882}, "td_error": [4.121008396148682, 4.567376136779785, 3.728449821472168, 3.782538890838623, 3.420755386352539, 4.959530830383301, 2.544955253601074, 4.925049781799316, 2.8720455169677734, 4.252627372741699, 2.609278917312622, 4.150433540344238, 1.9150035381317139, 2.3887815475463867, 4.160030841827393, 5.032179832458496, 3.472982168197632, 3.9592537879943848, 3.6938862800598145, 3.255140781402588, 2.9263691902160645, 3.983175277709961, 3.3561644554138184, 4.824307441711426, 4.027671813964844, 3.4523725509643555, 4.329493999481201, 4.249576568603516, 3.0522913932800293, 2.2132341861724854, 3.7011337280273438, 3.2319092750549316, 2.6177728176116943, 3.6020498275756836, 2.367833137512207, 3.3167519569396973, 4.74177360534668, 5.3573198318481445, 4.154659271240234, 2.8837790489196777, 3.9525065422058105, 4.05799674987793, 3.615619659423828, 3.338982343673706, 4.534165382385254, 4.587828636169434, 3.868013381958008, 3.720302104949951, 3.1411070823669434, 2.823348045349121, 1.6817443370819092, 6.252869606018066, 3.56813383102417, 4.300422668457031, 4.195334434509277, 4.308227062225342, 2.385629653930664, 3.324981212615967, 3.142840623855591, 2.4835586547851562, 3.037506580352783, 2.489487409591675, 5.165610313415527, 4.583672046661377, 3.9612903594970703, 3.872526168823242, 3.6199607849121094, 3.348684072494507, 2.888019323348999, 3.9994113445281982, 2.848435401916504, 1.6475894451141357, 4.168688774108887, 5.001769065856934, 3.0366904735565186, 5.096567153930664, 2.493983268737793, 4.231278419494629, 3.37967586517334, 2.1435656547546387, 4.238652229309082, 3.2881016731262207, 2.8180603981018066, 3.171818256378174, 3.2197749614715576, 0.19718754291534424], "mean_td_error": 3.5747971534729004, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 9.0, "diff_num_grad_updates_vs_sampler_policy": 8.0}}, "num_env_steps_sampled": 8960, "num_env_steps_trained": 2322, "num_agent_steps_sampled": 26880, "num_agent_steps_trained": 2322, "last_target_update_ts": 8960, "num_target_updates": 9}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 26880, "num_agent_steps_trained": 2322, "num_env_steps_sampled": 8960, "num_env_steps_trained": 2322, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 531.0948008170002, "num_env_steps_trained_throughput_per_sec": 152.9268511281094, "timesteps_total": 8960, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 26880, "timers": {"training_iteration_time_ms": 1933.326, "sample_time_ms": 1225.412, "load_time_ms": 0.542, "load_throughput": 476196.65, "learn_time_ms": 68.857, "learn_throughput": 3746.882, "synch_weights_time_ms": 16.436}, "counters": {"num_env_steps_sampled": 8960, "num_env_steps_trained": 2322, "num_agent_steps_sampled": 26880, "num_agent_steps_trained": 2322, "last_target_update_ts": 8960, "num_target_updates": 9}, "done": false, "episodes_total": 0, "training_iteration": 10, "trial_id": "9a806_00000", "date": "2023-11-16_21-53-57", "timestamp": 1700200437, "time_this_iter_s": 1.7013051509857178, "time_total_s": 19.4805428981781, "pid": 45784, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fadc09cd790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 19.4805428981781, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 75.0, "ram_util_percent": 89.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.109169006347656, "actor_loss": -4.2549147605896, "critic_loss": 4.708148002624512, "alpha_loss": -0.027303798124194145, "alpha_value": 0.997302770614624, "log_alpha_value": -0.002700894372537732, "target_entropy": -6.0, "policy_t": -0.01861291378736496, "mean_q": 0.17617209255695343, "max_q": 0.21191872656345367, "min_q": 0.14356990158557892}, "td_error": [4.582559585571289, 6.573752403259277, 6.730751037597656, 6.651217460632324, 4.102369785308838, 5.695805549621582, 5.945662498474121, 5.691073417663574, 3.9156494140625, 6.168680191040039, 6.389305591583252, 7.11558723449707, 5.897275447845459, 6.688101291656494, 4.40290641784668, 5.222853183746338, 5.540952682495117, 4.3040313720703125, 7.354733467102051, 4.540904998779297, 6.740436553955078, 6.101484775543213, 6.107850074768066, 5.013773441314697, 7.629826068878174, 6.743879318237305, 5.159420013427734, 3.330934524536133, 4.343631267547607, 6.518497943878174, 5.305646896362305, 5.7336835861206055, 5.214595794677734, 4.562811374664307, 5.677569389343262, 5.790462970733643, 4.881250381469727, 5.037133693695068, 4.628458023071289, 6.606586456298828, 8.18124008178711, 3.7564921379089355, 5.992053508758545, 5.070875644683838, 6.930130958557129, 4.4411821365356445, 4.542527198791504, 4.687555313110352, 5.2677412033081055, 6.489614486694336, 3.3382863998413086, 5.4136881828308105, 6.474179267883301, 6.00124454498291, 5.55526065826416, 5.739300727844238, 3.7611756324768066, 5.947387218475342, 4.374536514282227, 4.54759407043457, 5.50844669342041, 5.125321388244629, 6.335788726806641, 4.383852005004883, 3.9222371578216553, 5.032790660858154, 6.102078914642334, 5.285723686218262, 5.831009864807129, 5.9126176834106445, 6.169116497039795, 5.261100769042969, 5.538979530334473, 5.297272682189941, 5.571134567260742, 3.530757427215576, 4.997919082641602, 5.4519243240356445, 6.7600226402282715, 5.777963638305664, 6.5249834060668945, 4.178318023681641, 5.215035915374756, 6.593603610992432, 4.984358787536621, 6.318492889404297], "mean_td_error": 5.497267723083496, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 10.0, "diff_num_grad_updates_vs_sampler_policy": 9.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.092816352844238, "actor_loss": -4.229682445526123, "critic_loss": 2.465033531188965, "alpha_loss": -0.027262426912784576, "alpha_value": 0.9973024725914001, "log_alpha_value": -0.002701170975342393, "target_entropy": -6.0, "policy_t": 0.009416921064257622, "mean_q": 0.15616297721862793, "max_q": 0.19650015234947205, "min_q": 0.12988504767417908}, "td_error": [5.256363391876221, 2.004271984100342, 5.285416603088379, 0.040307313203811646, 2.5847291946411133, 5.756019592285156, 3.9375250339508057, 4.1560468673706055, 3.9256906509399414, 4.216677665710449, 3.1606523990631104, 3.2502031326293945, 3.6159000396728516, 3.658132553100586, 2.9021191596984863, 4.081068992614746, 4.4773478507995605, 4.482873439788818, 4.5609354972839355, 2.5240049362182617, 2.6825809478759766, 4.553179740905762, 5.87886905670166, 4.118766784667969, 2.6042237281799316, 3.297781229019165, 3.050865650177002, 3.4592294692993164, 2.3904528617858887, 1.7732861042022705, 2.4673659801483154, 3.071493148803711, 4.496655464172363, 0.30985480546951294, 4.343802452087402, 2.3126559257507324, 3.237555980682373, 4.473496913909912, 4.417069435119629, 3.446538209915161, 5.263125419616699, 5.596049785614014, 3.3566596508026123, 3.1073412895202637, 4.270159721374512, 3.1244215965270996, 2.7580738067626953, 3.17148756980896, 3.959596633911133, 2.5261905193328857, 2.3172225952148438, 5.643254280090332, 4.775053977966309, 3.7344565391540527, 1.814004898071289, 4.313324928283691, 3.1197409629821777, 2.5273213386535645, 2.027005195617676, 2.857492685317993, 5.180108070373535, 5.321835517883301, 1.7720086574554443, 5.464446544647217, 4.84544563293457, 4.943841457366943, 4.512889862060547, 2.7226386070251465, 3.302089214324951, 4.167220592498779, 2.0172905921936035, 3.506470203399658, 4.580000877380371, 2.4751462936401367, 2.7298011779785156, 3.0102124214172363, 4.11971378326416, 5.971799850463867, 4.354820728302002, 5.41857385635376, 6.264895439147949, 3.9830164909362793, 2.9930801391601562, 2.909006118774414, 4.790128707885742, 4.046262741088867], "mean_td_error": 3.673567056655884, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 10.0, "diff_num_grad_updates_vs_sampler_policy": 9.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.071998596191406, "actor_loss": -4.218285083770752, "critic_loss": 2.083336353302002, "alpha_loss": -0.027197299525141716, "alpha_value": 0.9973033666610718, "log_alpha_value": -0.002700288314372301, "target_entropy": -6.0, "policy_t": 0.05363389477133751, "mean_q": 0.16464342176914215, "max_q": 0.2033422291278839, "min_q": 0.14064764976501465}, "td_error": [2.9929919242858887, 2.0666306018829346, 2.2277016639709473, 1.9545133113861084, 4.025672435760498, 3.222801685333252, 2.8996667861938477, 0.9846638441085815, 4.326446533203125, 2.726853132247925, 3.481509208679199, 4.804897308349609, 1.687705397605896, 4.733281135559082, 4.399153709411621, 4.352433204650879, 2.5028252601623535, 2.34015154838562, 4.172630310058594, 4.1978302001953125, 3.2709360122680664, 5.253647804260254, 3.241257667541504, 5.210197448730469, 3.3270158767700195, 3.172372817993164, 3.3310232162475586, 4.270208358764648, 1.8561663627624512, 2.661224365234375, 4.658408164978027, 3.9793148040771484, 4.526310920715332, 4.385313987731934, 3.7057271003723145, 3.1781487464904785, 3.4383115768432617, 4.203366279602051, 5.114370822906494, 5.338824272155762, 4.054738998413086, 4.8061418533325195, 2.296417236328125, 5.395956039428711, 4.677746772766113, 4.6049394607543945, 3.070810317993164, 3.6279799938201904, 3.6276302337646484, 3.1953790187835693, 4.393847465515137, 3.782608985900879, 3.4807398319244385, 3.3450214862823486, 3.509878158569336, 3.582231044769287, 5.067226409912109, 3.5778186321258545, 3.776047468185425, 4.559118270874023, 3.0978012084960938, 4.040287017822266, 2.8372631072998047, 3.1513209342956543, 4.167424201965332, 3.2002954483032227, 2.1461987495422363, 4.0221357345581055, 2.355559825897217, 2.828659772872925, 2.198486328125, 2.56466007232666, 1.8386269807815552, 5.5984954833984375, 1.4563052654266357, 3.2942636013031006, 4.73915433883667, 5.840950012207031, 3.164599895477295, 3.324317455291748, 3.3970489501953125, 2.759096145629883, 4.106005668640137, 4.948811054229736, 3.644404888153076, 6.807530403137207], "mean_td_error": 3.630052089691162, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 10.0, "diff_num_grad_updates_vs_sampler_policy": 9.0}}, "num_env_steps_sampled": 9856, "num_env_steps_trained": 2580, "num_agent_steps_sampled": 29568, "num_agent_steps_trained": 2580, "last_target_update_ts": 9856, "num_target_updates": 10}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 29568, "num_agent_steps_trained": 2580, "num_env_steps_sampled": 9856, "num_env_steps_trained": 2580, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 545.6968570525808, "num_env_steps_trained_throughput_per_sec": 157.131461070944, "timesteps_total": 9856, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 29568, "timers": {"training_iteration_time_ms": 1857.18, "sample_time_ms": 1241.727, "load_time_ms": 0.543, "load_throughput": 475306.554, "learn_time_ms": 68.234, "learn_throughput": 3781.125, "synch_weights_time_ms": 16.154}, "counters": {"num_env_steps_sampled": 9856, "num_env_steps_trained": 2580, "num_agent_steps_sampled": 29568, "num_agent_steps_trained": 2580, "last_target_update_ts": 9856, "num_target_updates": 10}, "done": false, "episodes_total": 0, "training_iteration": 11, "trial_id": "9a806_00000", "date": "2023-11-16_21-53-58", "timestamp": 1700200438, "time_this_iter_s": 1.6595008373260498, "time_total_s": 21.14004373550415, "pid": 45784, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fadd04f4b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 21.14004373550415, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 54.199999999999996, "ram_util_percent": 89.96666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.077847480773926, "actor_loss": -4.246373176574707, "critic_loss": 4.633262634277344, "alpha_loss": -0.030244331806898117, "alpha_value": 0.997003436088562, "log_alpha_value": -0.0030010708142071962, "target_entropy": -6.0, "policy_t": -0.030210139229893684, "mean_q": 0.206656351685524, "max_q": 0.2558358311653137, "min_q": 0.1735115945339203}, "td_error": [3.517333984375, 6.029206275939941, 6.272855758666992, 4.8057541847229, 6.024172306060791, 6.266804218292236, 7.188144683837891, 5.584625244140625, 6.032663345336914, 5.884946823120117, 5.617171287536621, 6.198854446411133, 6.603268146514893, 7.480598449707031, 5.537920951843262, 4.854999542236328, 5.050111770629883, 4.984703540802002, 6.061551094055176, 5.673652648925781, 4.897672653198242, 6.3766374588012695, 6.635044097900391, 5.366349697113037, 4.645357131958008, 4.253920555114746, 5.357486724853516, 5.311363220214844, 6.229348659515381, 5.668806076049805, 4.974481582641602, 5.861039161682129, 6.637025833129883, 4.300592422485352, 3.707437515258789, 4.897099018096924, 6.592913627624512, 3.6917123794555664, 5.5665082931518555, 4.846488952636719, 6.173037528991699, 5.227619171142578, 5.813127517700195, 5.611597537994385, 4.649125576019287, 4.173688888549805, 4.442010879516602, 6.122477054595947, 6.960712432861328, 5.6744184494018555, 5.431931018829346, 4.900907516479492, 6.141883850097656, 3.9242258071899414, 5.713624954223633, 5.385993957519531, 5.954240322113037, 6.007302761077881, 5.7465386390686035, 5.30126953125, 5.468893051147461, 6.463216304779053, 5.9564900398254395, 5.556696891784668, 4.377829074859619, 4.055311679840088, 5.986172676086426, 5.591594219207764, 4.816164970397949, 3.9578471183776855, 4.984047889709473, 3.250495672225952, 6.3765549659729, 5.585352897644043, 5.379885673522949, 5.863772392272949, 4.657354354858398, 5.4985127449035645, 5.584287643432617, 5.84710693359375, 4.907978534698486, 5.128678321838379, 6.104971885681152, 5.29188871383667, 2.8252859115600586, 5.22998571395874], "mean_td_error": 5.413821697235107, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 11.0, "diff_num_grad_updates_vs_sampler_policy": 10.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.194618225097656, "actor_loss": -4.3554253578186035, "critic_loss": 1.341845154762268, "alpha_loss": -0.030598891898989677, "alpha_value": 0.9970030188560486, "log_alpha_value": -0.0030014750082045794, "target_entropy": -6.0, "policy_t": 0.03254344314336777, "mean_q": 0.18384608626365662, "max_q": 0.22620753943920135, "min_q": 0.15730564296245575}, "td_error": [1.8699527978897095, 2.197181224822998, 3.319821834564209, 3.777164936065674, 4.335601329803467, 3.55295467376709, 3.0482845306396484, 3.9870846271514893, 3.0800986289978027, 3.257748603820801, 3.042851448059082, 3.788759708404541, 3.0724825859069824, 3.345508098602295, 2.6637802124023438, 3.8155453205108643, 4.66063117980957, 1.5985915660858154, 4.337784767150879, 4.704784393310547, 3.1271114349365234, 1.6916898488998413, 4.954639434814453, 0.8597575426101685, 2.966148853302002, 2.3503432273864746, 3.0121381282806396, 4.509245872497559, 2.6576828956604004, 2.8357152938842773, 2.6711525917053223, 5.232419013977051, 4.305914878845215, 5.070017337799072, 3.76143741607666, 3.949826240539551, 3.63798189163208, 3.8133559226989746, 4.345734596252441, 2.0694031715393066, 2.836334228515625, 3.89007568359375, 4.215266227722168, 2.3110623359680176, 4.600040435791016, 6.0545973777771, 4.198773384094238, 1.7684376239776611, 4.599824905395508, 3.879826784133911, 4.8455352783203125, 4.617669582366943, 4.278249740600586, 2.9205172061920166, 4.588736534118652, 2.958704948425293, 2.240891695022583, 2.411375045776367, 4.908824920654297, 3.8462507724761963, 3.539762020111084, 1.9317800998687744, 4.987853050231934, 3.123431921005249, 4.3899078369140625, 3.362919330596924, 2.2806637287139893, 4.243653774261475, 3.086299419403076, 2.737429618835449, 4.460964679718018, 1.7442009449005127, 5.4454193115234375, 4.639518737792969, 3.1499762535095215, 2.652183771133423, 2.5487561225891113, 3.5446958541870117, 3.789405345916748, 2.963332176208496, 4.837532997131348, 3.4365792274475098, 2.311357021331787, 3.379382610321045, 6.113005638122559, 3.7782673835754395], "mean_td_error": 3.5317163467407227, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 11.0, "diff_num_grad_updates_vs_sampler_policy": 10.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.08548641204834, "actor_loss": -4.250927448272705, "critic_loss": 1.9472813606262207, "alpha_loss": -0.03025980107486248, "alpha_value": 0.9970041513442993, "log_alpha_value": -0.003000331111252308, "target_entropy": -6.0, "policy_t": 0.02876308374106884, "mean_q": 0.18882043659687042, "max_q": 0.23433570563793182, "min_q": 0.1612182855606079}, "td_error": [4.23819637298584, 1.6910622119903564, 4.925480842590332, 2.1669368743896484, 2.5900230407714844, 2.2969954013824463, 3.1179819107055664, 3.5903878211975098, 2.450876235961914, 4.124664306640625, 2.373220920562744, 3.96403431892395, 4.687573432922363, 2.8452253341674805, 3.01253604888916, 2.5222983360290527, 4.28868293762207, 3.4971694946289062, 2.581984758377075, 5.034160614013672, 3.437896728515625, 3.253769636154175, 2.509901523590088, 2.8711464405059814, 4.514533042907715, 3.7173569202423096, 5.505575180053711, 3.4746174812316895, 2.5227420330047607, 3.2723731994628906, 4.564268589019775, 3.7423095703125, 1.9798535108566284, 1.9744582176208496, 3.817340850830078, 4.8487935066223145, 3.728928804397583, 2.9125123023986816, 3.158134937286377, 3.2113776206970215, 3.493162155151367, 2.3287196159362793, 4.575013637542725, 2.4808497428894043, 3.7060129642486572, 3.7708725929260254, 3.820732593536377, 4.742424488067627, 3.1273488998413086, 1.0150363445281982, 0.8163430690765381, 3.554055690765381, 4.405025482177734, 2.8774728775024414, 5.4327545166015625, 3.4089152812957764, 3.8174352645874023, 3.179492950439453, 4.202851295471191, 3.720770835876465, 3.7908358573913574, 4.063784599304199, 4.976960182189941, 3.499824047088623, 3.628023624420166, 3.1820499897003174, 2.708247184753418, 4.086409568786621, 3.5397515296936035, 2.52708101272583, 4.4962663650512695, 3.8281612396240234, 3.9614906311035156, 3.6844425201416016, 3.287814140319824, 2.9235122203826904, 2.5566813945770264, 4.818660259246826, 3.5827152729034424, 3.616955280303955, 4.795469760894775, 5.82006311416626, 2.5414392948150635, 3.8502538204193115, 3.7226333618164062, 4.109862327575684], "mean_td_error": 3.501070261001587, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 11.0, "diff_num_grad_updates_vs_sampler_policy": 10.0}}, "num_env_steps_sampled": 10752, "num_env_steps_trained": 2838, "num_agent_steps_sampled": 32256, "num_agent_steps_trained": 2838, "last_target_update_ts": 10752, "num_target_updates": 11}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32256, "num_agent_steps_trained": 2838, "num_env_steps_sampled": 10752, "num_env_steps_trained": 2838, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 475.8900243573972, "num_env_steps_trained_throughput_per_sec": 137.03083290648266, "timesteps_total": 10752, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 32256, "timers": {"training_iteration_time_ms": 1820.467, "sample_time_ms": 1204.606, "load_time_ms": 0.53, "load_throughput": 486591.318, "learn_time_ms": 64.51, "learn_throughput": 3999.376, "synch_weights_time_ms": 15.837}, "counters": {"num_env_steps_sampled": 10752, "num_env_steps_trained": 2838, "num_agent_steps_sampled": 32256, "num_agent_steps_trained": 2838, "last_target_update_ts": 10752, "num_target_updates": 11}, "done": false, "episodes_total": 0, "training_iteration": 12, "trial_id": "9a806_00000", "date": "2023-11-16_21-54-00", "timestamp": 1700200440, "time_this_iter_s": 1.8971128463745117, "time_total_s": 23.037156581878662, "pid": 45784, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fadc09cd310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 23.037156581878662, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 55.6, "ram_util_percent": 89.96666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.08913803100586, "actor_loss": -4.280035972595215, "critic_loss": 4.60806941986084, "alpha_loss": -0.033306390047073364, "alpha_value": 0.9967042207717896, "log_alpha_value": -0.0033012127969413996, "target_entropy": -6.0, "policy_t": -0.013707224279642105, "mean_q": 0.23672309517860413, "max_q": 0.27557551860809326, "min_q": 0.19956186413764954}, "td_error": [4.903049945831299, 6.254280090332031, 5.053224563598633, 6.14624547958374, 8.110002517700195, 6.495908737182617, 6.438518524169922, 5.7744140625, 6.616997718811035, 4.673831462860107, 4.766915798187256, 4.416203022003174, 4.595704078674316, 4.929853439331055, 4.564828872680664, 5.7308573722839355, 6.188620090484619, 4.878108024597168, 4.711706161499023, 7.6448211669921875, 5.950499534606934, 5.708982467651367, 5.544735908508301, 5.7968831062316895, 4.652803421020508, 5.766152381896973, 6.964476585388184, 5.218111991882324, 4.299112796783447, 4.479531288146973, 6.464897155761719, 5.462932586669922, 4.876016139984131, 5.919254302978516, 4.599887847900391, 4.894904136657715, 4.464550018310547, 4.161380767822266, 7.18756103515625, 5.709908485412598, 3.807650327682495, 6.463197708129883, 5.8014116287231445, 3.8532943725585938, 5.876769542694092, 3.1953024864196777, 5.655431747436523, 3.9474854469299316, 6.685719013214111, 5.6576690673828125, 5.94733190536499, 4.700921058654785, 6.113877296447754, 5.738620758056641, 5.999472618103027, 5.434688568115234, 6.668123245239258, 4.237648963928223, 5.045836448669434, 4.979308128356934, 6.729885101318359, 5.941269874572754, 4.693354606628418, 6.507111549377441, 4.3491621017456055, 6.1463823318481445, 6.6996636390686035, 6.084744453430176, 4.634488105773926, 6.024661540985107, 5.2775421142578125, 5.073121070861816, 5.323337078094482, 6.0028228759765625, 5.16544771194458, 5.699394226074219, 6.985811233520508, 6.139901638031006, 6.940700054168701, 5.300848960876465, 4.543486595153809, 5.949307918548584, 3.9942758083343506, 4.509917259216309, 4.901939392089844, 7.047394275665283], "mean_td_error": 5.505725383758545, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 12.0, "diff_num_grad_updates_vs_sampler_policy": 11.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.119951248168945, "actor_loss": -4.3066816329956055, "critic_loss": 1.3617842197418213, "alpha_loss": -0.03341551870107651, "alpha_value": 0.9967035055160522, "log_alpha_value": -0.00330194435082376, "target_entropy": -6.0, "policy_t": -0.06420952826738358, "mean_q": 0.20916643738746643, "max_q": 0.25988420844078064, "min_q": 0.17818142473697662}, "td_error": [3.3323893547058105, 2.419579029083252, 1.3821245431900024, 3.7646422386169434, 4.429827690124512, 3.6884942054748535, 2.946035146713257, 3.6108691692352295, 4.858915328979492, 1.976083755493164, 2.6482186317443848, 3.2360434532165527, 5.34419059753418, 2.7281765937805176, 2.475236415863037, 4.515358924865723, 3.4043073654174805, 3.9265353679656982, 3.2719075679779053, 2.660231590270996, 1.7994904518127441, 5.607431888580322, 4.691845893859863, 3.0735669136047363, 3.4566259384155273, 3.3474044799804688, 3.8688855171203613, 4.897121906280518, 2.7867555618286133, 3.44840669631958, 5.140776634216309, 3.2040340900421143, 4.340730667114258, 3.959503650665283, 1.795555591583252, 3.8539328575134277, 2.7344608306884766, 3.734423875808716, 4.986992359161377, 1.7073556184768677, 3.8155784606933594, 5.95522928237915, 5.205953598022461, 3.7248756885528564, 2.5435614585876465, 2.5812063217163086, 4.436070442199707, 4.009825706481934, 3.844778060913086, 4.378804683685303, 2.925006628036499, 4.3391828536987305, 4.818374156951904, 3.80302095413208, 4.495579719543457, 4.609050750732422, 2.8287034034729004, 4.391114711761475, 3.551421642303467, 3.351513385772705, 3.023836374282837, 2.259979248046875, 3.275710105895996, 3.5403249263763428, 2.7634222507476807, 2.256744146347046, 4.448995113372803, 3.647132396697998, 6.20493221282959, 3.107325553894043, 3.2191624641418457, 1.5422083139419556, 4.5211896896362305, 3.7479233741760254, 4.021679878234863, 1.677830457687378, 3.527355194091797, 5.071983814239502, 2.835383176803589, 4.581728935241699, 4.661482334136963, 4.156133651733398, 2.400714635848999, 3.1098904609680176, 3.916349172592163, 2.536384344100952], "mean_td_error": 3.5897574424743652, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 12.0, "diff_num_grad_updates_vs_sampler_policy": 11.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.136712074279785, "actor_loss": -4.324946880340576, "critic_loss": 1.9622595310211182, "alpha_loss": -0.03345498815178871, "alpha_value": 0.9967050552368164, "log_alpha_value": -0.0033003785647451878, "target_entropy": -6.0, "policy_t": 0.017212694510817528, "mean_q": 0.22011208534240723, "max_q": 0.2652231454849243, "min_q": 0.18925690650939941}, "td_error": [4.1250457763671875, 4.617607593536377, 4.9063849449157715, 3.384134531021118, 3.6592910289764404, 3.5591115951538086, 5.548177719116211, 5.962386131286621, 2.250589609146118, 3.929260730743408, 3.6869237422943115, 4.223365306854248, 2.9817657470703125, 3.6902666091918945, 3.1403908729553223, 2.81514573097229, 5.706157684326172, 3.3742246627807617, 2.9263806343078613, 4.9552130699157715, 2.198793888092041, 2.680058002471924, 3.8881664276123047, 3.533125877380371, 3.235318660736084, 2.9083704948425293, 4.135190486907959, 3.806522846221924, 3.820204734802246, 1.661142110824585, 2.637132406234741, 4.649850845336914, 3.701022148132324, 3.503342866897583, 2.9522740840911865, 2.4266390800476074, 4.349637031555176, 5.221904277801514, 3.5074262619018555, 4.187488079071045, 2.448265552520752, 2.180624485015869, 3.622965097427368, 1.7364275455474854, 3.8755247592926025, 3.4887495040893555, 5.179909706115723, 2.162654399871826, 4.635747909545898, 2.5260047912597656, 4.208063125610352, 2.4514315128326416, 5.4626665115356445, 2.4087443351745605, 2.0902512073516846, 2.2872939109802246, 4.03720760345459, 2.714521884918213, 4.03146505355835, 3.1421918869018555, 3.872124671936035, 1.9016690254211426, 4.259348392486572, 4.070855617523193, 3.5190019607543945, 2.985970973968506, 1.4841346740722656, 2.5966241359710693, 4.661037445068359, 1.5672967433929443, 3.9851579666137695, 2.7354369163513184, 3.887399673461914, 2.8270859718322754, 3.8985042572021484, 4.838594436645508, 1.291597843170166, 3.1175079345703125, 4.506618499755859, 3.343914747238159, 2.6936769485473633, 3.784238815307617, 3.7451658248901367, 3.7620511054992676, 4.490664482116699, 3.959489345550537], "mean_td_error": 3.4990851879119873, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 12.0, "diff_num_grad_updates_vs_sampler_policy": 11.0}}, "num_env_steps_sampled": 11648, "num_env_steps_trained": 3096, "num_agent_steps_sampled": 34944, "num_agent_steps_trained": 3096, "last_target_update_ts": 11648, "num_target_updates": 12}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 34944, "num_agent_steps_trained": 3096, "num_env_steps_sampled": 11648, "num_env_steps_trained": 3096, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 550.1252365016738, "num_env_steps_trained_throughput_per_sec": 158.40659711766946, "timesteps_total": 11648, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 34944, "timers": {"training_iteration_time_ms": 1730.107, "sample_time_ms": 1114.677, "load_time_ms": 0.527, "load_throughput": 489851.266, "learn_time_ms": 64.104, "learn_throughput": 4024.696, "synch_weights_time_ms": 16.285}, "counters": {"num_env_steps_sampled": 11648, "num_env_steps_trained": 3096, "num_agent_steps_sampled": 34944, "num_agent_steps_trained": 3096, "last_target_update_ts": 11648, "num_target_updates": 12}, "done": false, "episodes_total": 0, "training_iteration": 13, "trial_id": "9a806_00000", "date": "2023-11-16_21-54-02", "timestamp": 1700200442, "time_this_iter_s": 1.642845869064331, "time_total_s": 24.680002450942993, "pid": 45784, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fadc09cd790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 24.680002450942993, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 69.85, "ram_util_percent": 90.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.069050788879395, "actor_loss": -4.292862415313721, "critic_loss": 4.755017280578613, "alpha_loss": -0.03626213222742081, "alpha_value": 0.9964051246643066, "log_alpha_value": -0.0036013454664498568, "target_entropy": -6.0, "policy_t": -0.05456821620464325, "mean_q": 0.27117428183555603, "max_q": 0.32968777418136597, "min_q": 0.223176047205925}, "td_error": [3.432736396789551, 6.094729423522949, 5.741086006164551, 7.285721778869629, 4.792749404907227, 4.2341108322143555, 4.118826866149902, 5.182135581970215, 5.965737342834473, 5.5651140213012695, 4.608834266662598, 7.4593119621276855, 5.823819160461426, 4.922853469848633, 4.82755184173584, 7.5834760665893555, 4.228675842285156, 6.040797710418701, 4.88237190246582, 6.171091079711914, 5.628730773925781, 5.880753517150879, 5.719111442565918, 5.6194939613342285, 8.43710708618164, 4.362296104431152, 6.747311592102051, 5.560063362121582, 6.614388465881348, 5.603089332580566, 6.560966491699219, 6.528158187866211, 4.280918598175049, 5.781672477722168, 7.120555877685547, 5.536957740783691, 5.479709148406982, 7.480862617492676, 5.146946907043457, 4.710305690765381, 5.524757385253906, 4.493458271026611, 4.952142238616943, 3.7118685245513916, 5.539241790771484, 6.166538238525391, 6.493477821350098, 3.9262657165527344, 4.187658309936523, 6.246596336364746, 6.447884559631348, 5.751845359802246, 5.647521018981934, 5.193327903747559, 3.603543758392334, 6.075879096984863, 4.84520149230957, 6.827077865600586, 3.864288330078125, 5.1488189697265625, 5.311417102813721, 5.947090148925781, 4.166457653045654, 5.550386905670166, 6.19170618057251, 4.59000301361084, 4.329899787902832, 3.996485710144043, 5.864767074584961, 5.344230651855469, 6.12374210357666, 4.3193039894104, 5.635034561157227, 5.390996932983398, 6.729158878326416, 4.979987144470215, 6.229885101318359, 7.207113265991211, 6.065601348876953, 3.972334146499634, 5.637884140014648, 5.761880874633789, 5.536463737487793, 5.436680793762207, 6.412195682525635, 5.68015193939209], "mean_td_error": 5.521155834197998, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 13.0, "diff_num_grad_updates_vs_sampler_policy": 12.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.126641273498535, "actor_loss": -4.335616111755371, "critic_loss": 1.2931134700775146, "alpha_loss": -0.03648042678833008, "alpha_value": 0.9964040517807007, "log_alpha_value": -0.0036024211440235376, "target_entropy": -6.0, "policy_t": 0.008949115872383118, "mean_q": 0.2341228723526001, "max_q": 0.2957472503185272, "min_q": 0.19374604523181915}, "td_error": [2.4271421432495117, 4.385669708251953, 3.545727491378784, 3.2162833213806152, 2.895542621612549, 4.865535736083984, 2.1869468688964844, 3.103048324584961, 3.2642650604248047, 2.823631763458252, 4.463688850402832, 3.1428637504577637, 1.507821798324585, 2.6839399337768555, 2.300696611404419, 4.353871822357178, 2.5858287811279297, 2.9160306453704834, 0.9799152612686157, 3.130483865737915, 3.098849058151245, 4.034562587738037, 3.6972134113311768, 2.9906246662139893, 4.518362998962402, 4.199426651000977, 3.4787349700927734, 3.987732410430908, 4.537014961242676, 3.2211999893188477, 2.951812744140625, 3.4012184143066406, 5.410980701446533, 3.274920701980591, 1.8548991680145264, 3.1304376125335693, 5.080409049987793, 2.4298095703125, 2.8630127906799316, 2.8785598278045654, 3.4010496139526367, 3.6065657138824463, 3.723512649536133, 5.193506240844727, 2.430720090866089, 2.5705652236938477, 2.7266969680786133, 3.606229066848755, 5.340047836303711, 3.6688766479492188, 5.5506439208984375, 5.2230024337768555, 1.6625540256500244, 2.741422176361084, 2.227132558822632, 3.9817588329315186, 2.2717771530151367, 3.088503122329712, 4.1040940284729, 2.4080100059509277, 3.0458312034606934, 4.842456817626953, 4.28020715713501, 2.1636641025543213, 0.7723318934440613, 3.7172300815582275, 3.560622215270996, 1.8408310413360596, 2.5248804092407227, 2.3122572898864746, 5.547647476196289, 2.293854236602783, 3.867748737335205, 2.5442514419555664, 3.8534200191497803, 3.9731898307800293, 3.0989387035369873, 3.5500965118408203, 6.221465110778809, 2.6641578674316406, 4.517425537109375, 2.0766732692718506, 5.161576271057129, 2.731935977935791, 2.8469486236572266, 3.6343750953674316], "mean_td_error": 3.3603415489196777, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 13.0, "diff_num_grad_updates_vs_sampler_policy": 12.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.060480117797852, "actor_loss": -4.277939796447754, "critic_loss": 2.0038678646087646, "alpha_loss": -0.036222897469997406, "alpha_value": 0.9964059591293335, "log_alpha_value": -0.003600513795390725, "target_entropy": -6.0, "policy_t": 0.025964219123125076, "mean_q": 0.24971331655979156, "max_q": 0.2916414737701416, "min_q": 0.21388545632362366}, "td_error": [5.810551643371582, 1.6451807022094727, 2.606929063796997, 4.151871681213379, 1.4930936098098755, 4.245223522186279, 2.2163195610046387, 1.8420125246047974, 2.859628915786743, 3.4793806076049805, 2.7268190383911133, 3.241549253463745, 2.8792214393615723, 3.8483023643493652, 5.669785499572754, 4.046226978302002, 4.339329719543457, 4.18869161605835, 5.738344192504883, 4.765154838562012, 3.6352944374084473, 2.9109058380126953, 4.2913055419921875, 5.298847675323486, 4.087712287902832, 2.089400291442871, 3.561678409576416, 3.4910969734191895, 3.327718734741211, 2.1213736534118652, 3.2932095527648926, 4.6931610107421875, 2.641414165496826, 5.113924026489258, 2.769930362701416, 3.5626282691955566, 4.513841152191162, 2.6936964988708496, 4.254594802856445, 2.740520477294922, 5.409915924072266, 1.6267445087432861, 3.8890910148620605, 2.97174072265625, 2.5925655364990234, 4.513909339904785, 2.5182740688323975, 3.464101791381836, 4.0961456298828125, 4.331661224365234, 2.7815792560577393, 3.2906110286712646, 5.189807891845703, 1.752457857131958, 3.618535280227661, 3.7571563720703125, 5.224433422088623, 3.0298171043395996, 3.4948339462280273, 3.3141794204711914, 3.311584949493408, 2.6664280891418457, 2.6364052295684814, 5.058070182800293, 2.7716259956359863, 3.767444610595703, 4.986062049865723, 2.815743923187256, 3.119983673095703, 2.3989968299865723, 4.498835563659668, 4.905217170715332, 3.0752246379852295, 2.9051461219787598, 2.834047317504883, 3.4977402687072754, 3.5097599029541016, 3.812267303466797, 3.6094634532928467, 5.430619239807129, 2.510512351989746, 3.357027053833008, 1.1392028331756592, 3.814363956451416, 3.3625974655151367, 5.228944301605225], "mean_td_error": 3.5439155101776123, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 13.0, "diff_num_grad_updates_vs_sampler_policy": 12.0}}, "num_env_steps_sampled": 12544, "num_env_steps_trained": 3354, "num_agent_steps_sampled": 37632, "num_agent_steps_trained": 3354, "last_target_update_ts": 12544, "num_target_updates": 13}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37632, "num_agent_steps_trained": 3354, "num_env_steps_sampled": 12544, "num_env_steps_trained": 3354, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 563.1568197171162, "num_env_steps_trained_throughput_per_sec": 162.15899496318744, "timesteps_total": 12544, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 37632, "timers": {"training_iteration_time_ms": 1684.769, "sample_time_ms": 1069.535, "load_time_ms": 0.527, "load_throughput": 489740.42, "learn_time_ms": 63.483, "learn_throughput": 4064.095, "synch_weights_time_ms": 15.903}, "counters": {"num_env_steps_sampled": 12544, "num_env_steps_trained": 3354, "num_agent_steps_sampled": 37632, "num_agent_steps_trained": 3354, "last_target_update_ts": 12544, "num_target_updates": 13}, "done": false, "episodes_total": 0, "training_iteration": 14, "trial_id": "9a806_00000", "date": "2023-11-16_21-54-04", "timestamp": 1700200444, "time_this_iter_s": 1.6065609455108643, "time_total_s": 26.286563396453857, "pid": 45784, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fadd04f4b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 26.286563396453857, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 68.45, "ram_util_percent": 90.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.130905151367188, "actor_loss": -4.385749340057373, "critic_loss": 4.288402080535889, "alpha_loss": -0.03952508047223091, "alpha_value": 0.9961061477661133, "log_alpha_value": -0.0039014362264424562, "target_entropy": -6.0, "policy_t": -0.011409729719161987, "mean_q": 0.30983906984329224, "max_q": 0.3790707588195801, "min_q": 0.2617737650871277}, "td_error": [6.387063503265381, 4.27537727355957, 5.526830196380615, 5.948822021484375, 4.562356948852539, 4.068753719329834, 4.918075084686279, 4.922483921051025, 4.239733695983887, 5.771705627441406, 5.051637649536133, 4.805590629577637, 5.470756530761719, 5.350266456604004, 4.116551399230957, 4.302872657775879, 3.128612518310547, 3.989529609680176, 3.737673044204712, 6.294722557067871, 4.698822021484375, 5.561554908752441, 5.608423709869385, 4.947805881500244, 4.661308765411377, 5.993854999542236, 4.019098281860352, 7.407087802886963, 6.32003927230835, 4.363282680511475, 4.54315185546875, 4.217757225036621, 5.782863616943359, 5.109084129333496, 5.2402143478393555, 5.173413276672363, 4.944270133972168, 5.004039287567139, 5.20035457611084, 3.7772064208984375, 4.724167823791504, 4.163891792297363, 3.6812210083007812, 7.104516506195068, 5.717655181884766, 5.775584697723389, 5.675004005432129, 5.067077159881592, 5.984210014343262, 5.837187767028809, 5.258822441101074, 5.370193958282471, 4.975250244140625, 6.8133649826049805, 3.9720964431762695, 4.369817733764648, 5.781542778015137, 4.469747543334961, 6.309077262878418, 5.839387893676758, 5.985355377197266, 6.244888782501221, 6.598909378051758, 6.598676681518555, 4.7596893310546875, 5.966816425323486, 3.604518413543701, 6.985464096069336, 4.374917507171631, 3.979560375213623, 4.301219940185547, 6.363692283630371, 5.227531433105469, 3.5204153060913086, 6.563051223754883, 5.255200386047363, 5.7624969482421875, 7.392766952514648, 5.1313018798828125, 5.450920581817627, 6.676636695861816, 5.73153829574585, 5.0663628578186035, 5.8235015869140625, 4.820247650146484, 6.263266563415527], "mean_td_error": 5.241649150848389, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 14.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.057435035705566, "actor_loss": -4.296153545379639, "critic_loss": 1.343674898147583, "alpha_loss": -0.039253294467926025, "alpha_value": 0.9961047172546387, "log_alpha_value": -0.0039029133040457964, "target_entropy": -6.0, "policy_t": -0.022260189056396484, "mean_q": 0.26953259110450745, "max_q": 0.332455575466156, "min_q": 0.22058641910552979}, "td_error": [2.5083327293395996, 2.3792495727539062, 2.748328447341919, 4.1948957443237305, 4.6997222900390625, 1.783220887184143, 3.3453283309936523, 4.007570266723633, 3.700958490371704, 3.8537826538085938, 2.3216683864593506, 3.1018242835998535, 2.5015456676483154, 4.607871055603027, 5.153099536895752, 3.329385757446289, 2.947356939315796, 3.751617431640625, 2.7521347999572754, 5.241701602935791, 5.407863140106201, 2.7052454948425293, 3.4223997592926025, 3.2371890544891357, 3.0675134658813477, 2.0533013343811035, 3.603827476501465, 3.87660813331604, 2.1199746131896973, 4.535467147827148, 3.510927438735962, 3.666255474090576, 2.6718411445617676, 3.1176273822784424, 3.7144904136657715, 4.136341571807861, 3.423191547393799, 4.660632610321045, 3.218954563140869, 5.109104156494141, 4.105630874633789, 4.242890357971191, 3.3910295963287354, 5.163658142089844, 2.791031837463379, 3.21205997467041, 2.429999351501465, 4.604450225830078, 4.075956344604492, 3.582984447479248, 2.4144814014434814, 3.1152267456054688, 5.30566930770874, 4.532055854797363, 4.323699951171875, 4.408485412597656, 4.249528884887695, 1.158589482307434, 2.1421988010406494, 3.487877368927002, 4.216754913330078, 5.325258255004883, 3.816215991973877, 2.9869697093963623, 2.6315011978149414, 3.191749095916748, 4.27979850769043, 3.2758309841156006, 5.540931701660156, 3.8349709510803223, 2.799703598022461, 3.3384032249450684, 2.4350569248199463, 4.647785186767578, 4.297000885009766, 4.784313201904297, 2.878474712371826, 2.067999839782715, 4.294919967651367, 2.523483991622925, 3.8114871978759766, 4.191598892211914, 3.4632840156555176, 2.1904635429382324, 2.932647943496704, 2.6157259941101074], "mean_td_error": 3.5499792098999023, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 14.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.173782348632812, "actor_loss": -4.412046432495117, "critic_loss": 1.928361415863037, "alpha_loss": -0.039683759212493896, "alpha_value": 0.9961069822311401, "log_alpha_value": -0.003900590818375349, "target_entropy": -6.0, "policy_t": 0.021319448947906494, "mean_q": 0.28276389837265015, "max_q": 0.3259139657020569, "min_q": 0.24004602432250977}, "td_error": [3.749228000640869, 4.29118537902832, 4.800609111785889, 3.0962376594543457, 4.481677055358887, 4.218672275543213, 2.9769582748413086, 3.1837995052337646, 4.343746185302734, 3.7153983116149902, 3.2835662364959717, 3.395498275756836, 3.031172275543213, 3.0015172958374023, 4.501072883605957, 4.15997314453125, 3.0069808959960938, 4.691732406616211, 3.0542502403259277, 2.7783565521240234, 4.134428024291992, 4.502671718597412, 3.585541248321533, 2.031177043914795, 2.154812812805176, 3.5353288650512695, 4.489044189453125, 5.322456359863281, 3.9748950004577637, 3.3196868896484375, 4.390724182128906, 3.1045877933502197, 3.4250407218933105, 2.8600244522094727, 2.9956724643707275, 3.304353713989258, 3.360968589782715, 3.747375011444092, 2.2169759273529053, 2.364677906036377, 4.069602012634277, 3.644296646118164, 2.218928813934326, 4.615381240844727, 4.328726291656494, 4.222002983093262, 3.3116345405578613, 2.5336461067199707, 1.5687081813812256, 2.3461244106292725, 3.5573301315307617, 2.5750722885131836, 3.989999532699585, 2.5266976356506348, 3.9497838020324707, 2.2824347019195557, 4.920206069946289, 3.6806607246398926, 5.139115333557129, 2.8677966594696045, 4.083684921264648, 4.126129150390625, 1.8276338577270508, 3.3841609954833984, 2.958706855773926, 3.798588275909424, 5.23822021484375, 3.266672134399414, 2.9719321727752686, 3.200883150100708, 4.020576000213623, 2.884596347808838, 2.6324238777160645, 3.556168794631958, 1.165212631225586, 2.101321220397949, 4.980417251586914, 5.734895706176758, 1.3634788990020752, 2.909902572631836, 3.687453269958496, 3.853548049926758, 3.564236640930176, 3.208409547805786, 4.831551551818848, 3.624509334564209], "mean_td_error": 3.487273931503296, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 14.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 13440, "num_env_steps_trained": 3612, "num_agent_steps_sampled": 40320, "num_agent_steps_trained": 3612, "last_target_update_ts": 13440, "num_target_updates": 14}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40320, "num_agent_steps_trained": 3612, "num_env_steps_sampled": 13440, "num_env_steps_trained": 3612, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 554.4170227330229, "num_env_steps_trained_throughput_per_sec": 159.64240163517846, "timesteps_total": 13440, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 40320, "timers": {"training_iteration_time_ms": 1669.519, "sample_time_ms": 1054.06, "load_time_ms": 0.526, "load_throughput": 490406.25, "learn_time_ms": 63.324, "learn_throughput": 4074.288, "synch_weights_time_ms": 15.653}, "counters": {"num_env_steps_sampled": 13440, "num_env_steps_trained": 3612, "num_agent_steps_sampled": 40320, "num_agent_steps_trained": 3612, "last_target_update_ts": 13440, "num_target_updates": 14}, "done": false, "episodes_total": 0, "training_iteration": 15, "trial_id": "9a806_00000", "date": "2023-11-16_21-54-05", "timestamp": 1700200445, "time_this_iter_s": 1.6328468322753906, "time_total_s": 27.919410228729248, "pid": 45784, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fadc09cd310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 27.919410228729248, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 52.53333333333333, "ram_util_percent": 89.96666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.08834171295166, "actor_loss": -4.373715400695801, "critic_loss": 4.587903022766113, "alpha_loss": -0.04238716512918472, "alpha_value": 0.9958072304725647, "log_alpha_value": -0.0042015984654426575, "target_entropy": -6.0, "policy_t": 0.011199021711945534, "mean_q": 0.3434208333492279, "max_q": 0.42283895611763, "min_q": 0.2830889821052551}, "td_error": [6.006433963775635, 5.185091972351074, 5.820146560668945, 2.8656678199768066, 5.133979797363281, 5.634702205657959, 6.0039191246032715, 5.8206400871276855, 5.628355026245117, 5.751517295837402, 5.5227837562561035, 5.69570779800415, 5.448802947998047, 4.272951126098633, 4.709538459777832, 3.9316749572753906, 5.033924579620361, 6.216636657714844, 4.890998840332031, 6.358963489532471, 4.1171369552612305, 4.285635471343994, 4.147608280181885, 5.218732833862305, 5.672057151794434, 4.662850379943848, 4.743897438049316, 5.8272385597229, 4.841684341430664, 4.589969635009766, 5.537741661071777, 6.765142917633057, 5.718316078186035, 6.12163782119751, 5.963048934936523, 4.119512557983398, 5.5065765380859375, 5.157126426696777, 5.620977878570557, 2.7289538383483887, 5.238000869750977, 6.798737049102783, 5.529200553894043, 6.170618057250977, 4.2148542404174805, 6.087656497955322, 5.075423717498779, 5.087312698364258, 4.739651679992676, 3.111607551574707, 5.392589569091797, 5.202359199523926, 5.11599588394165, 5.939733982086182, 7.182013511657715, 5.154427528381348, 5.921175003051758, 4.631983280181885, 6.845191955566406, 6.950895309448242, 5.242349147796631, 5.371082305908203, 6.492891311645508, 5.155155181884766, 6.4496870040893555, 6.010283470153809, 5.854610443115234, 5.790514945983887, 6.722116470336914, 5.9075927734375, 6.573522567749023, 5.074026107788086, 5.6852569580078125, 4.711282730102539, 5.520003318786621, 2.8561792373657227, 6.834392547607422, 4.969263076782227, 4.6068267822265625, 5.308122634887695, 4.248592376708984, 5.845179557800293, 5.119701385498047, 4.222193241119385, 4.161389350891113, 4.8343729972839355], "mean_td_error": 5.316678047180176, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 15.0, "diff_num_grad_updates_vs_sampler_policy": 14.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.156362533569336, "actor_loss": -4.422408103942871, "critic_loss": 1.3570619821548462, "alpha_loss": -0.0426902174949646, "alpha_value": 0.9958055019378662, "log_alpha_value": -0.004203297663480043, "target_entropy": -6.0, "policy_t": -0.008971842005848885, "mean_q": 0.30320101976394653, "max_q": 0.3454800248146057, "min_q": 0.2492327094078064}, "td_error": [3.1495776176452637, 3.0161826610565186, 2.523911952972412, 4.324333190917969, 3.410585880279541, 3.18280291557312, 4.320545196533203, 3.6686296463012695, 3.159489631652832, 3.548248767852783, 3.9403178691864014, 1.740263819694519, 3.659684181213379, 4.789017200469971, 4.285764694213867, 4.647548675537109, 2.8537325859069824, 4.283657073974609, 4.5225090980529785, 2.043313980102539, 3.5693163871765137, 3.7338192462921143, 3.531108856201172, 2.392216682434082, 2.147728204727173, 4.572502613067627, 3.0613045692443848, 3.026256561279297, 4.448806285858154, 3.332949161529541, 1.8191055059432983, 3.6004157066345215, 3.641817569732666, 3.5499024391174316, 4.467653751373291, 2.5529468059539795, 3.9751670360565186, 3.1707029342651367, 3.5499813556671143, 5.391435623168945, 5.083089828491211, 4.0942769050598145, 3.545945644378662, 4.992305755615234, 0.10620129108428955, 4.4379377365112305, 2.701958656311035, 3.3829121589660645, 4.318282127380371, 3.0746450424194336, 3.31978702545166, 3.559250831604004, 2.6566946506500244, 2.6317028999328613, 4.364907741546631, 4.854275226593018, 2.8332631587982178, 4.73280143737793, 3.7054824829101562, 4.659785270690918, 2.4267654418945312, 4.484336853027344, 4.00523042678833, 3.162566900253296, 6.09608268737793, 4.341852188110352, 3.0841197967529297, 2.876176595687866, 5.890200614929199, 2.981156826019287, 3.640428066253662, 3.6128735542297363, 3.232496976852417, 2.754441738128662, 4.659178733825684, 3.2602081298828125, 3.8778812885284424, 2.9961724281311035, 4.643861293792725, 5.213751316070557, 3.1998558044433594, 3.779940605163574, 5.29913854598999, 3.6885595321655273, 4.432953357696533, 2.275373935699463], "mean_td_error": 3.6462366580963135, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 15.0, "diff_num_grad_updates_vs_sampler_policy": 14.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.096835136413574, "actor_loss": -4.377671718597412, "critic_loss": 1.980189323425293, "alpha_loss": -0.04241492971777916, "alpha_value": 0.9958080053329468, "log_alpha_value": -0.004200814291834831, "target_entropy": -6.0, "policy_t": 0.04687716066837311, "mean_q": 0.3137296736240387, "max_q": 0.37554487586021423, "min_q": 0.25453874468803406}, "td_error": [3.3343446254730225, 4.24143648147583, 3.8000354766845703, 2.80424165725708, 2.383983612060547, 3.6240077018737793, 2.960470676422119, 5.383580207824707, 3.2845869064331055, 4.163299083709717, 3.7554519176483154, 4.08647346496582, 2.506509780883789, 3.2319495677948, 1.0228650569915771, 3.389293670654297, 2.8032736778259277, 3.8138771057128906, 4.511528015136719, 3.862990140914917, 3.943932056427002, 3.700495719909668, 3.3563945293426514, 4.0179290771484375, 4.298157691955566, 2.791531562805176, 3.9828696250915527, 3.0019800662994385, 3.9550087451934814, 3.214203357696533, 2.602041721343994, 3.6231162548065186, 3.3046059608459473, 3.1393775939941406, 4.355037689208984, 5.774172306060791, 2.1922714710235596, 5.845442771911621, 2.323692798614502, 3.080920934677124, 2.4232611656188965, 1.8034839630126953, 2.2284629344940186, 4.889431953430176, 2.531426191329956, 3.9438180923461914, 3.557659864425659, 2.7284951210021973, 4.008607864379883, 4.0039520263671875, 2.180136203765869, 5.876379013061523, 2.8095712661743164, 3.2104294300079346, 3.1589789390563965, 3.549362897872925, 2.5922160148620605, 4.893962860107422, 2.8482139110565186, 5.209083557128906, 2.4214422702789307, 4.675812721252441, 1.2493815422058105, 3.916637420654297, 3.813875675201416, 4.642884254455566, 2.126443862915039, 2.9043428897857666, 3.5635268688201904, 3.8931751251220703, 3.5352730751037598, 3.3131823539733887, 2.089486598968506, 3.1245741844177246, 3.348172426223755, 3.2061421871185303, 4.209385395050049, 2.665052652359009, 4.721066474914551, 2.002180576324463, 3.682706356048584, 4.191044807434082, 4.501770973205566, 4.170936584472656, 4.751638412475586, 5.476968288421631], "mean_td_error": 3.5129234790802, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 15.0, "diff_num_grad_updates_vs_sampler_policy": 14.0}}, "num_env_steps_sampled": 14336, "num_env_steps_trained": 3870, "num_agent_steps_sampled": 43008, "num_agent_steps_trained": 3870, "last_target_update_ts": 14336, "num_target_updates": 15}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 43008, "num_agent_steps_trained": 3870, "num_env_steps_sampled": 14336, "num_env_steps_trained": 3870, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 554.4238932571067, "num_env_steps_trained_throughput_per_sec": 159.6443799780508, "timesteps_total": 14336, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 43008, "timers": {"training_iteration_time_ms": 1643.939, "sample_time_ms": 1048.512, "load_time_ms": 0.527, "load_throughput": 489275.413, "learn_time_ms": 63.195, "learn_throughput": 4082.591, "synch_weights_time_ms": 15.828}, "counters": {"num_env_steps_sampled": 14336, "num_env_steps_trained": 3870, "num_agent_steps_sampled": 43008, "num_agent_steps_trained": 3870, "last_target_update_ts": 14336, "num_target_updates": 15}, "done": false, "episodes_total": 0, "training_iteration": 16, "trial_id": "9a806_00000", "date": "2023-11-16_21-54-07", "timestamp": 1700200447, "time_this_iter_s": 1.629765272140503, "time_total_s": 29.54917550086975, "pid": 45784, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fadd0526430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 29.54917550086975, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 68.5, "ram_util_percent": 90.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.018664360046387, "actor_loss": -4.3439717292785645, "critic_loss": 4.439882278442383, "alpha_loss": -0.04510146751999855, "alpha_value": 0.9955083727836609, "log_alpha_value": -0.004501745104789734, "target_entropy": -6.0, "policy_t": 0.02288586087524891, "mean_q": 0.3820405602455139, "max_q": 0.4536626636981964, "min_q": 0.3189854323863983}, "td_error": [5.4666337966918945, 4.618948459625244, 4.781980037689209, 3.9218385219573975, 6.641702651977539, 3.334458112716675, 5.933375358581543, 8.307004928588867, 6.262296676635742, 5.358242988586426, 6.171313762664795, 4.373102188110352, 7.560019016265869, 3.1048123836517334, 4.918760299682617, 4.646925926208496, 4.199642181396484, 4.725031852722168, 5.34871768951416, 5.3274030685424805, 6.150476455688477, 5.292611122131348, 3.993271827697754, 5.336828231811523, 3.534278154373169, 5.056092262268066, 3.8369174003601074, 4.98895263671875, 5.940488815307617, 5.570389270782471, 5.853008270263672, 5.961052894592285, 3.657383918762207, 4.030879020690918, 6.08640193939209, 5.984977722167969, 6.441084861755371, 5.033644199371338, 4.795458793640137, 5.7243242263793945, 4.628677845001221, 5.444068908691406, 5.525056838989258, 4.09037446975708, 5.869293212890625, 4.958954811096191, 4.084403038024902, 5.551889896392822, 5.798485279083252, 5.597037315368652, 5.914429664611816, 5.843344211578369, 4.522398948669434, 5.323579788208008, 3.91123628616333, 5.234576225280762, 5.269229412078857, 5.864006996154785, 5.277780532836914, 4.575932025909424, 4.069571495056152, 5.280270576477051, 3.9067203998565674, 3.7516684532165527, 3.9359548091888428, 4.083225250244141, 4.2841572761535645, 5.7989182472229, 4.7960734367370605, 5.67421817779541, 4.88151741027832, 2.416435956954956, 5.729172706604004, 3.7480363845825195, 4.72981595993042, 6.468943119049072, 4.236403942108154, 5.050430774688721, 3.339205265045166, 7.0433502197265625, 5.31496524810791, 6.897497653961182, 5.118416786193848, 6.286123752593994, 4.794966697692871, 6.54505729675293], "mean_td_error": 5.113215923309326, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 16.0, "diff_num_grad_updates_vs_sampler_policy": 15.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.079157829284668, "actor_loss": -4.378805637359619, "critic_loss": 1.2543476819992065, "alpha_loss": -0.04539414495229721, "alpha_value": 0.9955063462257385, "log_alpha_value": -0.0045037642121315, "target_entropy": -6.0, "policy_t": 0.026384489610791206, "mean_q": 0.3350425064563751, "max_q": 0.39806121587753296, "min_q": 0.2904885411262512}, "td_error": [5.524218559265137, 3.2291650772094727, 3.225581645965576, 3.0706992149353027, 0.6711338758468628, 5.023879051208496, 3.533320903778076, 4.595996856689453, 2.947523593902588, 2.3371310234069824, 2.520392417907715, 5.91896390914917, 2.975277900695801, 2.6645491123199463, 3.9679975509643555, 3.6651711463928223, 3.5711679458618164, 3.9030237197875977, 3.411746025085449, 2.1294617652893066, 5.569450378417969, 2.4571075439453125, 3.095592498779297, 2.9866461753845215, 3.2537479400634766, 3.3917272090911865, 1.8859639167785645, 1.909836769104004, 3.253427028656006, 2.1103854179382324, 3.3646414279937744, 4.34526252746582, 4.552177429199219, 3.8539071083068848, 4.955730438232422, 2.2044529914855957, 1.0637898445129395, 1.9370990991592407, 2.7690353393554688, 3.4152307510375977, 3.505688190460205, 2.6170616149902344, 5.093141078948975, 3.2712974548339844, 2.5469448566436768, 3.439495086669922, 2.984117031097412, 4.298133373260498, 1.1230812072753906, 2.4780917167663574, 2.925492763519287, 3.477116584777832, 3.895142078399658, 2.4757533073425293, 4.279428482055664, 3.0436649322509766, 4.2113494873046875, 2.6683549880981445, 3.885280132293701, 2.7404403686523438, 3.6725425720214844, 2.8906099796295166, 4.161314010620117, 4.56329870223999, 4.174763202667236, 3.584522247314453, 4.468775749206543, 1.572210431098938, 4.375642776489258, 4.613553047180176, 2.9906680583953857, 3.3390231132507324, 4.043889999389648, 2.983218193054199, 2.5799851417541504, 3.088514566421509, 5.010383605957031, 2.9344418048858643, 2.71718168258667, 4.962119102478027, 1.6036350727081299, 3.3304800987243652, 5.169567584991455, 2.8562283515930176, 2.7870585918426514, 3.488729953765869], "mean_td_error": 3.350965738296509, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 16.0, "diff_num_grad_updates_vs_sampler_policy": 15.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.086690902709961, "actor_loss": -4.392070293426514, "critic_loss": 1.9279234409332275, "alpha_loss": -0.045400429517030716, "alpha_value": 0.9955090880393982, "log_alpha_value": -0.004501023329794407, "target_entropy": -6.0, "policy_t": 0.0029093758203089237, "mean_q": 0.34918877482414246, "max_q": 0.4160905182361603, "min_q": 0.295960009098053}, "td_error": [2.7462940216064453, 5.361870765686035, 3.5204293727874756, 2.5508804321289062, 3.447716236114502, 3.183311939239502, 3.177659749984741, 3.4958620071411133, 3.1521592140197754, 2.8536720275878906, 5.432920455932617, 2.9140734672546387, 3.514010429382324, 4.733889102935791, 2.926712989807129, 5.292642593383789, 2.8070549964904785, 1.5998573303222656, 5.3789286613464355, 2.3595407009124756, 4.4196624755859375, 3.149791717529297, 2.472048759460449, 4.140526294708252, 2.956038475036621, 4.00284481048584, 3.197437047958374, 2.5529823303222656, 4.196915149688721, 2.300583839416504, 2.3381507396698, 2.0773959159851074, 2.9784374237060547, 2.0840187072753906, 4.140061855316162, 4.233025550842285, 5.19477653503418, 3.7992143630981445, 4.7637128829956055, 3.9011611938476562, 3.762887954711914, 4.23334264755249, 2.361488103866577, 3.967515230178833, 2.3295865058898926, 1.7574708461761475, 2.4174933433532715, 4.668478965759277, 1.850815773010254, 2.9308810234069824, 3.8641197681427, 5.835821151733398, 3.4476819038391113, 4.458298683166504, 3.697476863861084, 3.4135384559631348, 2.7571115493774414, 3.949779510498047, 2.622652053833008, 2.208958625793457, 4.440525531768799, 3.5362777709960938, 4.546088695526123, 5.655263900756836, 3.8610382080078125, 4.010805606842041, 4.806779861450195, 3.672149658203125, 4.475797653198242, 2.7542412281036377, 3.8485522270202637, 2.121346950531006, 2.791144847869873, 2.5453672409057617, 3.3391060829162598, 3.4398603439331055, 3.0230867862701416, 5.244942665100098, 2.1367342472076416, 4.299446105957031, 2.6384527683258057, 4.244071960449219, 2.3824875354766846, 3.255781412124634, 3.0793185234069824, 1.7932021617889404], "mean_td_error": 3.463088035583496, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 16.0, "diff_num_grad_updates_vs_sampler_policy": 15.0}}, "num_env_steps_sampled": 15232, "num_env_steps_trained": 4128, "num_agent_steps_sampled": 45696, "num_agent_steps_trained": 4128, "last_target_update_ts": 15232, "num_target_updates": 16}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 45696, "num_agent_steps_trained": 4128, "num_env_steps_sampled": 15232, "num_env_steps_trained": 4128, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 561.2090240932891, "num_env_steps_trained_throughput_per_sec": 161.5981341697194, "timesteps_total": 15232, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 45696, "timers": {"training_iteration_time_ms": 1647.066, "sample_time_ms": 1052.838, "load_time_ms": 0.528, "load_throughput": 488237.878, "learn_time_ms": 63.068, "learn_throughput": 4090.834, "synch_weights_time_ms": 15.519}, "counters": {"num_env_steps_sampled": 15232, "num_env_steps_trained": 4128, "num_agent_steps_sampled": 45696, "num_agent_steps_trained": 4128, "last_target_update_ts": 15232, "num_target_updates": 16}, "done": false, "episodes_total": 0, "training_iteration": 17, "trial_id": "9a806_00000", "date": "2023-11-16_21-54-09", "timestamp": 1700200449, "time_this_iter_s": 1.6136140823364258, "time_total_s": 31.162789583206177, "pid": 45784, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fadd04c90d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 31.162789583206177, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 69.95, "ram_util_percent": 90.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.129487991333008, "actor_loss": -4.48435115814209, "critic_loss": 4.715183734893799, "alpha_loss": -0.048639312386512756, "alpha_value": 0.9952097535133362, "log_alpha_value": -0.004801753908395767, "target_entropy": -6.0, "policy_t": -0.024644242599606514, "mean_q": 0.4363464117050171, "max_q": 0.5490198135375977, "min_q": 0.37466877698898315}, "td_error": [3.2144594192504883, 5.422173500061035, 4.724794864654541, 4.814945220947266, 4.298951625823975, 3.4334521293640137, 3.759477138519287, 6.992501735687256, 5.747002601623535, 5.771511554718018, 3.841562271118164, 6.209792137145996, 5.675754547119141, 6.033370018005371, 5.657725811004639, 6.385894775390625, 5.280425071716309, 6.063667297363281, 4.7247514724731445, 5.834530830383301, 4.860441207885742, 4.474644660949707, 5.069894790649414, 5.773256301879883, 5.997962474822998, 6.5645952224731445, 4.762608528137207, 6.4698381423950195, 5.609739303588867, 5.534436225891113, 6.21281623840332, 5.036949634552002, 5.479879379272461, 5.313832759857178, 5.5236735343933105, 5.753396034240723, 5.769998073577881, 4.834351539611816, 5.819642066955566, 5.694502830505371, 6.5917744636535645, 6.337347984313965, 7.73100471496582, 5.050657272338867, 7.659833908081055, 3.5198073387145996, 5.942828178405762, 3.304868459701538, 7.445064544677734, 4.391858100891113, 3.4381155967712402, 6.348634719848633, 6.095705032348633, 3.7983288764953613, 4.315274238586426, 6.23972225189209, 5.514892101287842, 6.630549430847168, 3.9988551139831543, 5.673688888549805, 5.103255271911621, 4.2813720703125, 6.323744773864746, 5.5326361656188965, 5.867278099060059, 5.3857622146606445, 5.507287502288818, 5.192532539367676, 6.176060676574707, 4.694526672363281, 3.157649517059326, 5.407629013061523, 5.8718390464782715, 5.793703079223633, 5.940834045410156, 5.220827102661133, 5.8417253494262695, 5.013241767883301, 3.494863510131836, 3.2629199028015137, 6.709152698516846, 5.440268516540527, 5.525237083435059, 7.623247146606445, 5.090344429016113, 5.452516555786133], "mean_td_error": 5.388167858123779, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 17.0, "diff_num_grad_updates_vs_sampler_policy": 16.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.09123420715332, "actor_loss": -4.43137788772583, "critic_loss": 1.253598690032959, "alpha_loss": -0.048479918390512466, "alpha_value": 0.9952073693275452, "log_alpha_value": -0.004804160911589861, "target_entropy": -6.0, "policy_t": -0.04579797014594078, "mean_q": 0.3670024573802948, "max_q": 0.4432971775531769, "min_q": 0.3014236092567444}, "td_error": [3.2191834449768066, 5.357743263244629, 3.1781225204467773, 1.884394884109497, 3.739619731903076, 5.266778945922852, 4.061200141906738, 3.500563859939575, 3.1682279109954834, 4.641307830810547, 2.247437000274658, 2.985300064086914, 4.418492317199707, 3.9449005126953125, 2.5255141258239746, 4.187142848968506, 4.004074573516846, 4.414732456207275, 3.6749510765075684, 1.6340386867523193, 3.1811165809631348, 2.8311057090759277, 3.251431465148926, 4.093952178955078, 5.628125190734863, 2.5697836875915527, 2.196077346801758, 4.453155994415283, 2.4118378162384033, 3.601606845855713, 2.0906081199645996, 1.892165184020996, 2.3141961097717285, 1.6460638046264648, 2.4597835540771484, 2.7443947792053223, 3.7054996490478516, 3.992382526397705, 2.4869675636291504, 3.5059099197387695, 2.6463375091552734, 1.740344524383545, 2.9488954544067383, 3.9538869857788086, 5.552314281463623, 2.900763988494873, 3.202911376953125, 2.2655062675476074, 3.7673892974853516, 5.410595893859863, 2.9029128551483154, 2.8547353744506836, 3.393319606781006, 4.2279791831970215, 4.139340877532959, 3.12666392326355, 3.5359678268432617, 2.1593422889709473, 2.0741171836853027, 1.1858563423156738, 3.1013965606689453, 2.095852851867676, 3.482107639312744, 2.944180965423584, 3.7280144691467285, 1.6976039409637451, 2.0743865966796875, 3.2395808696746826, 5.0159406661987305, 3.899446964263916, 5.335705280303955, 4.569819450378418, 4.28721809387207, 2.4076485633850098, 3.813741683959961, 2.804471254348755, 4.194961071014404, 4.333400726318359, 3.8830251693725586, 3.628220558166504, 3.692253351211548, 2.9160189628601074, 3.268277406692505, 2.84460186958313, 1.5523499250411987, 4.865695953369141], "mean_td_error": 3.334592580795288, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 17.0, "diff_num_grad_updates_vs_sampler_policy": 16.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.101804733276367, "actor_loss": -4.449950695037842, "critic_loss": 1.8431932926177979, "alpha_loss": -0.048500802367925644, "alpha_value": 0.9952102899551392, "log_alpha_value": -0.00480120163410902, "target_entropy": -6.0, "policy_t": 0.046019554138183594, "mean_q": 0.397373229265213, "max_q": 0.4903971552848816, "min_q": 0.33925092220306396}, "td_error": [3.0743069648742676, 4.486055374145508, 3.419088125228882, 1.9105181694030762, 2.3190927505493164, 3.4285526275634766, 5.174720764160156, 2.2656679153442383, 5.955164909362793, 4.807562828063965, 3.517972946166992, 2.864288806915283, 3.5391993522644043, 5.057990074157715, 1.6980215311050415, 3.741177558898926, 2.215373992919922, 3.0964272022247314, 3.184221029281616, 2.2001965045928955, 3.286752939224243, 5.306025505065918, 4.0700154304504395, 3.641251802444458, 4.4925994873046875, 3.6348671913146973, 3.78610897064209, 4.23557186126709, 3.877039909362793, 1.610112190246582, 3.022933006286621, 3.5623598098754883, 3.852830171585083, 2.005187511444092, 2.614683151245117, 3.66689395904541, 3.885117530822754, 3.98159122467041, 3.310957431793213, 3.304530143737793, 3.0024242401123047, 3.7753496170043945, 2.9251537322998047, 2.3306186199188232, 2.526548147201538, 4.156786918640137, 3.2263858318328857, 2.7050623893737793, 2.77866530418396, 3.982387065887451, 3.4272031784057617, 3.0983071327209473, 2.5439562797546387, 3.7093780040740967, 4.130318641662598, 1.694891095161438, 2.09274959564209, 2.0533499717712402, 5.328160285949707, 2.498030662536621, 1.6865344047546387, 3.3308825492858887, 3.295955181121826, 4.925983905792236, 2.7769243717193604, 3.7751121520996094, 2.498197555541992, 3.375183343887329, 3.5276219844818115, 4.866523742675781, 2.545952796936035, 5.42307186126709, 3.1980631351470947, 1.4178245067596436, 5.125596046447754, 3.009049415588379, 2.70327091217041, 3.7366886138916016, 3.7636287212371826, 3.164341926574707, 5.9432501792907715, 2.0450596809387207, 1.023963212966919, 2.476374864578247, 2.6360630989074707, 5.019587993621826], "mean_td_error": 3.3532497882843018, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 17.0, "diff_num_grad_updates_vs_sampler_policy": 16.0}}, "num_env_steps_sampled": 16128, "num_env_steps_trained": 4386, "num_agent_steps_sampled": 48384, "num_agent_steps_trained": 4386, "last_target_update_ts": 16128, "num_target_updates": 17}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48384, "num_agent_steps_trained": 4386, "num_env_steps_sampled": 16128, "num_env_steps_trained": 4386, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 552.0967140510593, "num_env_steps_trained_throughput_per_sec": 158.97427703702377, "timesteps_total": 16128, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 48384, "timers": {"training_iteration_time_ms": 1649.918, "sample_time_ms": 1055.053, "load_time_ms": 0.528, "load_throughput": 488590.587, "learn_time_ms": 63.141, "learn_throughput": 4086.1, "synch_weights_time_ms": 15.543}, "counters": {"num_env_steps_sampled": 16128, "num_env_steps_trained": 4386, "num_agent_steps_sampled": 48384, "num_agent_steps_trained": 4386, "last_target_update_ts": 16128, "num_target_updates": 17}, "done": false, "episodes_total": 0, "training_iteration": 18, "trial_id": "9a806_00000", "date": "2023-11-16_21-54-10", "timestamp": 1700200450, "time_this_iter_s": 1.639402151107788, "time_total_s": 32.802191734313965, "pid": 45784, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fadd04c9af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 32.802191734313965, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 52.833333333333336, "ram_util_percent": 90.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.118589401245117, "actor_loss": -4.503970146179199, "critic_loss": 4.215780735015869, "alpha_loss": -0.05162350460886955, "alpha_value": 0.9949111342430115, "log_alpha_value": -0.005101847928017378, "target_entropy": -6.0, "policy_t": 0.013287082314491272, "mean_q": 0.48007676005363464, "max_q": 0.5739806890487671, "min_q": 0.39581629633903503}, "td_error": [3.8772048950195312, 4.111503601074219, 4.877610206604004, 3.8565359115600586, 5.155855655670166, 5.372384071350098, 5.291097640991211, 5.020452976226807, 4.25348424911499, 4.188026428222656, 4.794634819030762, 4.769118309020996, 4.87643575668335, 4.0001630783081055, 5.189740180969238, 4.765524387359619, 4.346917152404785, 4.232612609863281, 4.602738380432129, 3.6451478004455566, 5.94611930847168, 4.679408550262451, 5.020091533660889, 5.327834606170654, 6.131706237792969, 6.925726890563965, 3.859039783477783, 4.714295387268066, 5.626669883728027, 5.901259899139404, 4.677613258361816, 7.12020206451416, 4.904476165771484, 4.801819801330566, 4.753500938415527, 6.099460601806641, 5.227861404418945, 5.41286563873291, 4.047786712646484, 5.966099739074707, 5.445886135101318, 4.468995571136475, 5.243238925933838, 4.059694290161133, 5.484543800354004, 3.880141258239746, 4.3697357177734375, 5.363204479217529, 5.960981369018555, 4.2744879722595215, 4.956600189208984, 7.576835632324219, 4.415498733520508, 4.78950309753418, 5.6142377853393555, 5.771596908569336, 5.727812767028809, 5.078699111938477, 7.101934432983398, 4.819554805755615, 3.609668254852295, 6.650362491607666, 5.083310604095459, 4.598710060119629, 4.426280975341797, 4.075462341308594, 6.259587287902832, 6.3464460372924805, 4.603130340576172, 4.970636367797852, 4.556533336639404, 3.03975772857666, 5.3510589599609375, 6.987748146057129, 5.755228519439697, 4.935423374176025, 4.581267356872559, 3.922591209411621, 6.624889373779297, 5.867588996887207, 4.973835468292236, 4.7685041427612305, 5.703741073608398, 4.172307968139648, 5.082306861877441, 5.09433650970459], "mean_td_error": 5.055987358093262, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 18.0, "diff_num_grad_updates_vs_sampler_policy": 17.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.117018699645996, "actor_loss": -4.487895965576172, "critic_loss": 1.296291708946228, "alpha_loss": -0.0516425184905529, "alpha_value": 0.9949085116386414, "log_alpha_value": -0.00510451989248395, "target_entropy": -6.0, "policy_t": 0.015375037677586079, "mean_q": 0.41486456990242004, "max_q": 0.489357054233551, "min_q": 0.3423007130622864}, "td_error": [2.8227858543395996, 2.9959607124328613, 1.678800344467163, 4.025280952453613, 4.057635307312012, 3.081939697265625, 1.918257236480713, 4.2578840255737305, 3.3624494075775146, 3.434990644454956, 4.445034027099609, 3.165560722351074, 2.8513522148132324, 4.8302836418151855, 3.5303542613983154, 3.3488903045654297, 3.5533225536346436, 3.230297565460205, 4.64703369140625, 3.000251531600952, 2.6499381065368652, 3.164968490600586, 2.7406320571899414, 1.5613131523132324, 3.365020751953125, 5.5350213050842285, 4.059760093688965, 3.9309513568878174, 4.171937942504883, 7.053764343261719, 2.897097587585449, 3.5648751258850098, 4.606985092163086, 4.1505231857299805, 3.978689670562744, 3.7205042839050293, 2.9852991104125977, 2.861858367919922, 5.137581825256348, 2.3313345909118652, 4.6883745193481445, 3.30399751663208, 2.366792917251587, 3.7451274394989014, 3.40969181060791, 3.1858744621276855, 4.087463855743408, 2.3797154426574707, 3.021599054336548, 2.5408291816711426, 2.99242901802063, 5.1528825759887695, 4.81809139251709, 4.165578842163086, 3.526723861694336, 3.723662853240967, 1.6869843006134033, 3.292065382003784, 1.4847609996795654, 2.976433753967285, 1.064911127090454, 1.7857251167297363, 3.812959671020508, 2.2646374702453613, 4.244000434875488, 4.609914779663086, 4.730428695678711, 2.856687545776367, 3.946115016937256, 1.767770767211914, 4.561567306518555, 3.7561960220336914, 2.932257652282715, 3.0140738487243652, 3.00181245803833, 3.4567055702209473, 2.704583168029785, 5.318531036376953, 4.188976287841797, 5.6366682052612305, 2.995483160018921, 2.20609450340271, 3.0146117210388184, 2.596945285797119, 2.2084639072418213, 4.592147350311279], "mean_td_error": 3.447951316833496, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 18.0, "diff_num_grad_updates_vs_sampler_policy": 17.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.132148742675781, "actor_loss": -4.5187296867370605, "critic_loss": 1.8681377172470093, "alpha_loss": -0.051687952131032944, "alpha_value": 0.9949116110801697, "log_alpha_value": -0.005101380869746208, "target_entropy": -6.0, "policy_t": -0.015803137794137, "mean_q": 0.4364115297794342, "max_q": 0.5187394022941589, "min_q": 0.37135711312294006}, "td_error": [2.0076186656951904, 2.1515893936157227, 3.821660041809082, 3.822477340698242, 3.2249131202697754, 4.863621711730957, 3.289450168609619, 4.823635101318359, 3.7077102661132812, 2.5872199535369873, 5.200225353240967, 2.8966565132141113, 4.82112979888916, 5.077862739562988, 2.961432456970215, 4.477396011352539, 5.659493923187256, 4.272947311401367, 4.3838911056518555, 3.664339065551758, 4.303922653198242, 3.2107410430908203, 5.039040565490723, 3.481118679046631, 2.7074408531188965, 2.503425359725952, 4.037693977355957, 3.9832427501678467, 4.363800048828125, 3.138401508331299, 4.401299476623535, 3.2269949913024902, 3.300420045852661, 2.00042462348938, 3.0461418628692627, 1.8102316856384277, 2.871553659439087, 3.521359920501709, 3.375955104827881, 3.87312650680542, 4.526726722717285, 3.6807775497436523, 4.157942771911621, 2.5918469429016113, 5.4440155029296875, 3.9165408611297607, 1.2240557670593262, 4.8146820068359375, 4.90360164642334, 3.729508876800537, 4.833395004272461, 2.8133962154388428, 1.9755184650421143, 2.7526040077209473, 3.001175880432129, 2.980085849761963, 3.5078325271606445, 2.3194594383239746, 1.7388585805892944, 3.488347053527832, 1.4015895128250122, 1.707679271697998, 3.5452044010162354, 5.371427536010742, 2.6344146728515625, 1.8331865072250366, 2.372171401977539, 2.4161620140075684, 2.59116792678833, 3.7446391582489014, 3.396726608276367, 4.078312873840332, 2.7184038162231445, 3.9362268447875977, 2.774868965148926, 2.5119712352752686, 4.298120021820068, 2.8477489948272705, 2.3601672649383545, 3.0605173110961914, 2.482029438018799, 3.6369709968566895, 1.5752055644989014, 3.1666393280029297, 3.4758987426757812, 3.0268239974975586], "mean_td_error": 3.3869330883026123, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 18.0, "diff_num_grad_updates_vs_sampler_policy": 17.0}}, "num_env_steps_sampled": 17024, "num_env_steps_trained": 4644, "num_agent_steps_sampled": 51072, "num_agent_steps_trained": 4644, "last_target_update_ts": 17024, "num_target_updates": 18}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51072, "num_agent_steps_trained": 4644, "num_env_steps_sampled": 17024, "num_env_steps_trained": 4644, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 482.56671448551594, "num_env_steps_trained_throughput_per_sec": 138.95336198355258, "timesteps_total": 17024, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 51072, "timers": {"training_iteration_time_ms": 1673.954, "sample_time_ms": 1056.278, "load_time_ms": 0.528, "load_throughput": 488303.972, "learn_time_ms": 63.25, "learn_throughput": 4079.078, "synch_weights_time_ms": 15.484}, "counters": {"num_env_steps_sampled": 17024, "num_env_steps_trained": 4644, "num_agent_steps_sampled": 51072, "num_agent_steps_trained": 4644, "last_target_update_ts": 17024, "num_target_updates": 18}, "done": false, "episodes_total": 0, "training_iteration": 19, "trial_id": "9a806_00000", "date": "2023-11-16_21-54-12", "timestamp": 1700200452, "time_this_iter_s": 1.874476671218872, "time_total_s": 34.67666840553284, "pid": 45784, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fadd04c98b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 34.67666840553284, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 65.1, "ram_util_percent": 90.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.088493347167969, "actor_loss": -4.528494358062744, "critic_loss": 4.454787254333496, "alpha_loss": -0.05449796840548515, "alpha_value": 0.9946125745773315, "log_alpha_value": -0.005401993170380592, "target_entropy": -6.0, "policy_t": 0.015320162288844585, "mean_q": 0.5369910597801208, "max_q": 0.6358063220977783, "min_q": 0.44776442646980286}, "td_error": [6.0235419273376465, 4.911579132080078, 6.260351181030273, 6.325798988342285, 5.338664531707764, 4.762637138366699, 5.537224769592285, 4.697100639343262, 4.302569389343262, 3.6348137855529785, 3.5745344161987305, 5.498629570007324, 4.97292947769165, 7.308371543884277, 5.840940952301025, 4.19018030166626, 3.6994426250457764, 4.438026428222656, 5.512060642242432, 4.831935882568359, 6.085358619689941, 4.71023416519165, 4.758238792419434, 6.606785774230957, 5.6253862380981445, 3.7739665508270264, 3.2547059059143066, 6.633970737457275, 5.129459381103516, 7.224784851074219, 4.711578369140625, 3.806313991546631, 3.2515101432800293, 5.606769561767578, 5.118149757385254, 6.431906700134277, 3.9289448261260986, 4.14753532409668, 6.086920738220215, 4.2244672775268555, 5.830174446105957, 4.2689619064331055, 7.790709495544434, 3.937509059906006, 6.935976982116699, 7.4143524169921875, 5.885387420654297, 6.1885552406311035, 5.10502290725708, 6.067804336547852, 3.5927839279174805, 4.8990044593811035, 5.754604339599609, 5.68855619430542, 6.042830467224121, 4.339014053344727, 6.1527862548828125, 4.778286933898926, 6.842144966125488, 5.592650413513184, 5.80127477645874, 5.3314433097839355, 6.185910224914551, 2.441875696182251, 4.80178689956665, 6.349544525146484, 6.194349765777588, 4.834831714630127, 6.813321113586426, 6.8551249504089355, 5.666195869445801, 5.394847869873047, 5.527901649475098, 5.071143627166748, 5.365382194519043, 5.5623674392700195, 6.886446475982666, 5.630706787109375, 5.514706611633301, 5.404158592224121, 5.987419128417969, 5.487787246704102, 6.590970993041992, 4.65109920501709, 6.455451488494873, 4.849392890930176], "mean_td_error": 5.366754055023193, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 19.0, "diff_num_grad_updates_vs_sampler_policy": 18.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.073863983154297, "actor_loss": -4.487494945526123, "critic_loss": 1.2550965547561646, "alpha_loss": -0.05444815382361412, "alpha_value": 0.9946097135543823, "log_alpha_value": -0.005404892843216658, "target_entropy": -6.0, "policy_t": 0.024301638826727867, "mean_q": 0.4618930518627167, "max_q": 0.5373131632804871, "min_q": 0.38601356744766235}, "td_error": [3.8002662658691406, 4.122644424438477, 2.880542039871216, 4.633617401123047, 4.518533706665039, 3.0862009525299072, 2.9579696655273438, 3.0178301334381104, 3.2257866859436035, 3.5636239051818848, 4.385850429534912, 3.6822314262390137, 1.9910472631454468, 4.665629863739014, 3.952915906906128, 3.7262682914733887, 3.9698870182037354, 4.1715216636657715, 4.65103816986084, 0.9527063369750977, 3.6156716346740723, 1.733070731163025, 2.5387496948242188, 4.195400238037109, 3.2744412422180176, 3.1982007026672363, 1.3719184398651123, 1.754294753074646, 3.3336029052734375, 4.287907600402832, 3.7229156494140625, 3.331233501434326, 3.926219940185547, 1.5839426517486572, 2.6730504035949707, 2.855963706970215, 2.050230026245117, 2.1583433151245117, 2.6173348426818848, 2.3064584732055664, 2.456740617752075, 4.503878593444824, 2.3846638202667236, 3.655937671661377, 4.317953109741211, 4.057564735412598, 2.386758327484131, 2.725069999694824, 5.101022720336914, 3.401996612548828, 4.226238250732422, 3.266601085662842, 1.6858389377593994, 3.782390594482422, 3.7773447036743164, 3.3938393592834473, 1.0792070627212524, 3.4170327186584473, 3.5347795486450195, 3.6375601291656494, 3.1205358505249023, 2.1533150672912598, 2.416778564453125, 4.101762294769287, 3.941742420196533, 5.61221981048584, 3.272371292114258, 3.8373665809631348, 4.1312255859375, 3.647646903991699, 5.6929192543029785, 3.163649320602417, 1.0631576776504517, 3.755596160888672, 4.144716262817383, 3.491802930831909, 2.7068018913269043, 4.890059947967529, 1.7199277877807617, 4.293018341064453, 3.1656911373138428, 4.709498405456543, 2.852543830871582, 3.617098569869995, 4.525962829589844, 2.838253974914551], "mean_td_error": 3.350501775741577, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 19.0, "diff_num_grad_updates_vs_sampler_policy": 18.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.09804630279541, "actor_loss": -4.526375770568848, "critic_loss": 1.806941032409668, "alpha_loss": -0.05454576760530472, "alpha_value": 0.9946129322052002, "log_alpha_value": -0.005401615984737873, "target_entropy": -6.0, "policy_t": -0.012535437010228634, "mean_q": 0.4873407483100891, "max_q": 0.5823062062263489, "min_q": 0.42027872800827026}, "td_error": [2.5125226974487305, 3.131448268890381, 2.259169101715088, 3.8329949378967285, 4.5445427894592285, 4.409700393676758, 3.8725979328155518, 4.484208106994629, 3.263556957244873, 3.0263075828552246, 3.0914411544799805, 2.3892433643341064, 3.809596538543701, 2.277121067047119, 3.8767921924591064, 4.457561492919922, 3.946524143218994, 2.304452896118164, 4.089236736297607, 4.242408752441406, 2.8377556800842285, 3.470608711242676, 2.3827266693115234, 3.231999397277832, 2.661768913269043, 2.5885748863220215, 1.88095223903656, 2.879587173461914, 3.0513405799865723, 4.332221984863281, 3.063354969024658, 4.236617088317871, 1.937012791633606, 2.884573459625244, 2.9254207611083984, 1.5211713314056396, 2.572096109390259, 4.1787309646606445, 2.5804123878479004, 3.2856814861297607, 3.104538917541504, 3.453615188598633, 4.422530651092529, 1.611356496810913, 2.8560051918029785, 3.7782557010650635, 3.2967162132263184, 3.424705982208252, 2.425229549407959, 3.133479118347168, 2.9375369548797607, 3.1455516815185547, 3.5383448600769043, 0.49367034435272217, 2.329010486602783, 2.245166301727295, 3.246067762374878, 4.327003479003906, 5.231817245483398, 2.1811962127685547, 2.485039710998535, 2.5768685340881348, 2.9208638668060303, 4.567425727844238, 4.350181579589844, 2.166501522064209, 3.638373851776123, 3.7669754028320312, 3.9975175857543945, 4.575719833374023, 3.271846294403076, 2.7748336791992188, 1.5344679355621338, 3.187643527984619, 3.0336053371429443, 5.761268615722656, 4.948591232299805, 3.014317035675049, 3.1454079151153564, 4.274345874786377, 2.5984785556793213, 2.811927318572998, 2.9273204803466797, 3.8962697982788086, 2.9990978240966797, 3.0704522132873535], "mean_td_error": 3.23024582862854, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 19.0, "diff_num_grad_updates_vs_sampler_policy": 18.0}}, "num_env_steps_sampled": 17920, "num_env_steps_trained": 4902, "num_agent_steps_sampled": 53760, "num_agent_steps_trained": 4902, "last_target_update_ts": 17920, "num_target_updates": 19}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 53760, "num_agent_steps_trained": 4902, "num_env_steps_sampled": 17920, "num_env_steps_trained": 4902, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 568.9012727287866, "num_env_steps_trained_throughput_per_sec": 163.81308969199435, "timesteps_total": 17920, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 53760, "timers": {"training_iteration_time_ms": 1662.743, "sample_time_ms": 1044.915, "load_time_ms": 0.531, "load_throughput": 485935.8, "learn_time_ms": 63.267, "learn_throughput": 4077.97, "synch_weights_time_ms": 15.68}, "counters": {"num_env_steps_sampled": 17920, "num_env_steps_trained": 4902, "num_agent_steps_sampled": 53760, "num_agent_steps_trained": 4902, "last_target_update_ts": 17920, "num_target_updates": 19}, "done": false, "episodes_total": 0, "training_iteration": 20, "trial_id": "9a806_00000", "date": "2023-11-16_21-54-14", "timestamp": 1700200454, "time_this_iter_s": 1.589076042175293, "time_total_s": 36.26574444770813, "pid": 45784, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fadd04c99d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 36.26574444770813, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 65.25, "ram_util_percent": 90.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.110201835632324, "actor_loss": -4.599455833435059, "critic_loss": 4.538860321044922, "alpha_loss": -0.0576496347784996, "alpha_value": 0.9943140745162964, "log_alpha_value": -0.005702125374227762, "target_entropy": -6.0, "policy_t": 0.01286547165364027, "mean_q": 0.6044538617134094, "max_q": 0.7424173951148987, "min_q": 0.49900752305984497}, "td_error": [6.113743782043457, 4.584826469421387, 4.286257743835449, 4.865856647491455, 5.161905288696289, 6.967043876647949, 5.621133804321289, 5.929936408996582, 4.041910648345947, 5.262764930725098, 4.297576904296875, 4.43637752532959, 4.095778465270996, 4.750739097595215, 3.4834766387939453, 2.6110193729400635, 4.1734185218811035, 5.033865451812744, 4.877199649810791, 5.519180774688721, 3.4269022941589355, 5.411590576171875, 7.124172210693359, 6.282880783081055, 5.453829765319824, 4.92088508605957, 5.215616226196289, 4.802083492279053, 5.74992561340332, 5.217313766479492, 6.615319728851318, 4.385540008544922, 4.372089385986328, 6.402642250061035, 4.067230701446533, 5.68099308013916, 5.05937385559082, 4.72890043258667, 5.467883110046387, 6.290521621704102, 6.008678913116455, 5.716433048248291, 6.251736640930176, 5.660181522369385, 5.705419063568115, 4.615557670593262, 6.08442497253418, 5.652607440948486, 3.1522765159606934, 6.787240028381348, 6.909106254577637, 3.089937210083008, 5.451347827911377, 5.756525993347168, 3.8096230030059814, 6.199243545532227, 4.67257022857666, 6.631991386413574, 5.3698296546936035, 5.316811561584473, 4.868251323699951, 5.244068145751953, 4.94254207611084, 5.53938627243042, 7.666255950927734, 5.848576068878174, 4.478967666625977, 4.891210556030273, 5.809518337249756, 6.760622024536133, 4.333377361297607, 5.227469444274902, 5.951436996459961, 3.656804084777832, 4.980624198913574, 5.793929100036621, 4.874627113342285, 4.859355449676514, 5.834458351135254, 6.747763156890869, 4.929059982299805, 6.076491355895996, 4.919055461883545, 5.4135637283325195, 4.4143829345703125, 6.014458656311035], "mean_td_error": 5.252412796020508, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 20.0, "diff_num_grad_updates_vs_sampler_policy": 19.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.06535530090332, "actor_loss": -4.5319061279296875, "critic_loss": 1.2457554340362549, "alpha_loss": -0.057424820959568024, "alpha_value": 0.9943110346794128, "log_alpha_value": -0.005705196410417557, "target_entropy": -6.0, "policy_t": -0.001645921729505062, "mean_q": 0.5104440450668335, "max_q": 0.6057224273681641, "min_q": 0.41088446974754333}, "td_error": [3.885924816131592, 5.341304779052734, 3.4396557807922363, 2.9369025230407715, 2.0036020278930664, 5.1653947830200195, 1.1778881549835205, 3.240868091583252, 3.844297170639038, 3.43196439743042, 2.9201574325561523, 2.0147976875305176, 2.517918825149536, 3.266688346862793, 4.0990777015686035, 2.323397159576416, 1.5351814031600952, 5.437234878540039, 3.5174951553344727, 2.2457215785980225, 1.2679388523101807, 2.373873233795166, 3.5632195472717285, 1.8287752866744995, 4.9513068199157715, 5.166503429412842, 3.7581729888916016, 2.5864596366882324, 3.6301512718200684, 3.9039242267608643, 3.4458765983581543, 4.38818883895874, 4.206720352172852, 3.970330238342285, 2.0201547145843506, 2.640418291091919, 4.501193046569824, 4.282116889953613, 2.6919896602630615, 2.9242124557495117, 5.244462013244629, 2.1804847717285156, 1.9712554216384888, 3.4714555740356445, 3.851574420928955, 2.268434762954712, 3.115408182144165, 2.7949039936065674, 4.7654523849487305, 3.5593090057373047, 5.059985160827637, 3.0307650566101074, 2.28334641456604, 2.363945960998535, 4.381487846374512, 5.466909408569336, 4.383498668670654, 3.8128414154052734, 4.854789733886719, 3.793933868408203, 3.2892251014709473, 0.8845820426940918, 4.5830607414245605, 2.1034786701202393, 3.361311912536621, 2.9987716674804688, 3.0825376510620117, 2.433497428894043, 2.7992937564849854, 3.2982516288757324, 2.835763931274414, 3.025867462158203, 2.883615016937256, 2.9538331031799316, 3.091240406036377, 2.6553592681884766, 4.40494441986084, 3.821812391281128, 4.002376079559326, 3.8393654823303223, 4.70185661315918, 4.715642929077148, 3.8363757133483887, 4.616065979003906, 3.4684720039367676, 4.608060836791992], "mean_td_error": 3.4115803241729736, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 20.0, "diff_num_grad_updates_vs_sampler_policy": 19.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.112372398376465, "actor_loss": -4.583263397216797, "critic_loss": 1.779158115386963, "alpha_loss": -0.057659078389406204, "alpha_value": 0.9943143725395203, "log_alpha_value": -0.005701834335923195, "target_entropy": -6.0, "policy_t": 0.024518081918358803, "mean_q": 0.5321686267852783, "max_q": 0.6609477996826172, "min_q": 0.43691858649253845}, "td_error": [3.077517509460449, 3.5034377574920654, 2.577831268310547, 2.939152240753174, 2.8104538917541504, 3.2541146278381348, 2.6910159587860107, 2.0767126083374023, 4.386991024017334, 6.970033645629883, 3.0860812664031982, 3.8841443061828613, 4.500329494476318, 2.950439453125, 2.6685829162597656, 2.950676918029785, 4.778993129730225, 2.3880414962768555, 4.150201797485352, 4.90695858001709, 3.2719359397888184, 1.5242667198181152, 3.6645336151123047, 2.9267969131469727, 3.0257039070129395, 3.742068290710449, 2.7753448486328125, 2.5162951946258545, 3.9871225357055664, 3.456425189971924, 1.6034985780715942, 3.3649513721466064, 3.523737668991089, 3.276069402694702, 3.4840807914733887, 5.020979881286621, 4.014645576477051, 2.262908935546875, 3.748041868209839, 3.91627836227417, 2.7966814041137695, 2.4792284965515137, 3.4208450317382812, 3.0046238899230957, 3.748507022857666, 3.5876054763793945, 4.671725273132324, 2.8067352771759033, 2.819627285003662, 1.581360101699829, 3.6883544921875, 3.3636603355407715, 2.6907095909118652, 2.934882640838623, 3.4512572288513184, 2.7044901847839355, 4.9556660652160645, 1.9004524946212769, 5.5073652267456055, 2.5376343727111816, 3.212736129760742, 3.040173292160034, 2.4676496982574463, 2.696707248687744, 3.903679370880127, 0.9885779619216919, 1.8731029033660889, 5.313579559326172, 2.368875503540039, 2.382845878601074, 1.7927100658416748, 5.09234619140625, 2.841541290283203, 3.7514190673828125, 2.723754405975342, 2.235323429107666, 2.4447221755981445, 1.612950325012207, 3.6752543449401855, 3.9370362758636475, 3.539055347442627, 4.699422836303711, 2.2722156047821045, 2.024472713470459, 3.2900962829589844, 2.001978635787964], "mean_td_error": 3.2150118350982666, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 20.0, "diff_num_grad_updates_vs_sampler_policy": 19.0}}, "num_env_steps_sampled": 18816, "num_env_steps_trained": 5160, "num_agent_steps_sampled": 56448, "num_agent_steps_trained": 5160, "last_target_update_ts": 18816, "num_target_updates": 20}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56448, "num_agent_steps_trained": 5160, "num_env_steps_sampled": 18816, "num_env_steps_trained": 5160, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 523.6123005329339, "num_env_steps_trained_throughput_per_sec": 150.77229189452785, "timesteps_total": 18816, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 56448, "timers": {"training_iteration_time_ms": 1669.668, "sample_time_ms": 1050.734, "load_time_ms": 0.53, "load_throughput": 486744.527, "learn_time_ms": 63.248, "learn_throughput": 4079.196, "synch_weights_time_ms": 15.882}, "counters": {"num_env_steps_sampled": 18816, "num_env_steps_trained": 5160, "num_agent_steps_sampled": 56448, "num_agent_steps_trained": 5160, "last_target_update_ts": 18816, "num_target_updates": 20}, "done": false, "episodes_total": 0, "training_iteration": 21, "trial_id": "9a806_00000", "date": "2023-11-16_21-54-16", "timestamp": 1700200456, "time_this_iter_s": 1.7253460884094238, "time_total_s": 37.991090536117554, "pid": 45784, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fadd04f4c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 37.991090536117554, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 57.96666666666667, "ram_util_percent": 90.03333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.084299087524414, "actor_loss": -4.62742805480957, "critic_loss": 4.193402290344238, "alpha_loss": -0.06052885577082634, "alpha_value": 0.9940156936645508, "log_alpha_value": -0.0060022869147360325, "target_entropy": -6.0, "policy_t": 0.07358820736408234, "mean_q": 0.659886360168457, "max_q": 0.7784643769264221, "min_q": 0.567320704460144}, "td_error": [3.310997247695923, 5.600101470947266, 4.079770088195801, 6.726701736450195, 4.96729850769043, 5.343146800994873, 4.412312030792236, 4.637477874755859, 4.621945381164551, 4.655181884765625, 5.737311840057373, 4.739611625671387, 3.5572290420532227, 4.66253662109375, 5.573757171630859, 5.350854873657227, 5.213676452636719, 6.50002384185791, 6.89024019241333, 3.856391429901123, 7.135806083679199, 6.345707893371582, 5.494798183441162, 4.391908168792725, 6.2343597412109375, 6.295133590698242, 6.188576698303223, 3.9498002529144287, 5.5604400634765625, 4.110048294067383, 5.058584213256836, 4.901180744171143, 4.877798557281494, 3.555814266204834, 6.187732696533203, 6.70382833480835, 3.633345127105713, 5.309844017028809, 3.4489545822143555, 1.8883378505706787, 5.147594928741455, 6.087878704071045, 4.546655654907227, 6.055063247680664, 5.199094772338867, 4.243603229522705, 6.294367790222168, 3.86527156829834, 5.357554912567139, 4.478224754333496, 5.242909908294678, 4.6126909255981445, 6.4554595947265625, 5.764883041381836, 5.219552040100098, 6.247195243835449, 6.508246421813965, 3.5422747135162354, 4.73455810546875, 4.813716888427734, 5.146989822387695, 4.2719807624816895, 7.226251125335693, 3.665130615234375, 6.975229263305664, 6.660905361175537, 3.481374740600586, 6.623783588409424, 4.379124641418457, 5.325107097625732, 5.769291877746582, 2.954955577850342, 5.821066856384277, 5.532749176025391, 4.003561019897461, 3.889500141143799, 3.605543613433838, 4.399959564208984, 7.537972450256348, 4.448572635650635, 4.463603496551514, 5.769559860229492, 5.200667381286621, 5.3631815910339355, 6.457681179046631, 3.4996626377105713], "mean_td_error": 5.099985599517822, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 21.0, "diff_num_grad_updates_vs_sampler_policy": 20.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.090030670166016, "actor_loss": -4.599547863006592, "critic_loss": 1.1724152565002441, "alpha_loss": -0.060594912618398666, "alpha_value": 0.9940125942230225, "log_alpha_value": -0.006005424540489912, "target_entropy": -6.0, "policy_t": 0.011301360093057156, "mean_q": 0.5574886202812195, "max_q": 0.7113484740257263, "min_q": 0.4554114043712616}, "td_error": [3.1476247310638428, 2.6170713901519775, 5.42903470993042, 3.5742850303649902, 2.272569179534912, 3.5118350982666016, 1.8288477659225464, 5.396562099456787, 4.620096206665039, 4.434138298034668, 1.987244725227356, 3.196772575378418, 0.9770494699478149, 3.0799055099487305, 2.3725011348724365, 3.0568742752075195, 2.646440029144287, 3.460454225540161, 2.855285167694092, 3.341945171356201, 1.9451764822006226, 2.7675819396972656, 2.5719516277313232, 3.5096657276153564, 3.4450793266296387, 1.9509963989257812, 3.8000669479370117, 4.59614372253418, 1.8258968591690063, 5.34219217300415, 2.0011355876922607, 2.845233917236328, 2.4883346557617188, 3.1988649368286133, 3.4152474403381348, 3.462202548980713, 1.8345826864242554, 3.7218546867370605, 2.348776340484619, 3.5742290019989014, 3.8408241271972656, 1.9496138095855713, 1.9603517055511475, 3.5937187671661377, 3.1854519844055176, 4.689931869506836, 5.16969108581543, 3.5914053916931152, 2.990497589111328, 3.1864938735961914, 0.46235722303390503, 6.0539021492004395, 3.4758243560791016, 3.5334599018096924, 3.7477922439575195, 4.473759651184082, 2.8900351524353027, 4.244014263153076, 2.838085174560547, 2.6825273036956787, 1.0954444408416748, 3.4704227447509766, 1.4333096742630005, 2.9995126724243164, 3.727288246154785, 3.8629150390625, 1.8155330419540405, 1.093087911605835, 3.8461718559265137, 4.315756797790527, 3.304778814315796, 4.032732963562012, 1.952559232711792, 4.7108917236328125, 2.6457877159118652, 2.2701826095581055, 2.104353189468384, 1.9883649349212646, 1.8718247413635254, 0.7869462966918945, 2.883814811706543, 4.064487457275391, 1.6104470491409302, 6.263384819030762, 4.46803617477417, 2.497699737548828], "mean_td_error": 3.11775803565979, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 21.0, "diff_num_grad_updates_vs_sampler_policy": 20.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.07468032836914, "actor_loss": -4.609891891479492, "critic_loss": 1.7151103019714355, "alpha_loss": -0.0604688785970211, "alpha_value": 0.9940159320831299, "log_alpha_value": -0.006002064794301987, "target_entropy": -6.0, "policy_t": 0.027190644294023514, "mean_q": 0.5839288234710693, "max_q": 0.7204594612121582, "min_q": 0.5020755529403687}, "td_error": [2.524104118347168, 3.0370306968688965, 3.2100419998168945, 4.6331095695495605, 3.62807559967041, 4.003949165344238, 2.592294216156006, 2.9759082794189453, 3.0977559089660645, 1.6024994850158691, 4.474462509155273, 2.609398365020752, 3.1976070404052734, 3.1080522537231445, 3.9132673740386963, 3.3247921466827393, 5.192313194274902, 1.5085575580596924, 3.824862480163574, 2.901756525039673, 4.458783149719238, 2.688206672668457, 2.8239550590515137, 2.9740753173828125, 2.5454750061035156, 1.2489286661148071, 4.410806179046631, 1.020164132118225, 2.6175858974456787, 4.847863674163818, 2.591055393218994, 1.3364461660385132, 2.4279613494873047, 2.7378902435302734, 1.1984477043151855, 3.794705867767334, 3.7146825790405273, 3.0045995712280273, 3.7054545879364014, 4.066687107086182, 3.1975250244140625, 3.525505781173706, 1.3366702795028687, 4.68438720703125, 4.464301109313965, 4.704538345336914, 1.862750768661499, 2.768052577972412, 2.165555477142334, 4.323509216308594, 3.859739303588867, 5.160150527954102, 3.964993476867676, 3.4900100231170654, 2.938652515411377, 5.404961585998535, 2.3083672523498535, 2.2160568237304688, 3.8647260665893555, 3.5111758708953857, 3.791670322418213, 2.3157236576080322, 4.522998809814453, 2.598332405090332, 3.405510902404785, 1.28959321975708, 2.679788112640381, 4.007150173187256, 2.8127236366271973, 3.291114330291748, 2.8005080223083496, 1.549155831336975, 3.326190948486328, 2.22770357131958, 2.1088719367980957, 4.370436668395996, 2.0116305351257324, 1.566981554031372, 1.5120567083358765, 4.1157636642456055, 2.8816933631896973, 2.68576979637146, 4.088042259216309, 2.057326078414917, 3.545725107192993, 3.142066478729248], "mean_td_error": 3.1166250705718994, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 21.0, "diff_num_grad_updates_vs_sampler_policy": 20.0}}, "num_env_steps_sampled": 19712, "num_env_steps_trained": 5418, "num_agent_steps_sampled": 59136, "num_agent_steps_trained": 5418, "last_target_update_ts": 19712, "num_target_updates": 21}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 59136, "num_agent_steps_trained": 5418, "num_env_steps_sampled": 19712, "num_env_steps_trained": 5418, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 559.9671573827943, "num_env_steps_trained_throughput_per_sec": 161.24054308567068, "timesteps_total": 19712, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 59136, "timers": {"training_iteration_time_ms": 1641.399, "sample_time_ms": 1043.708, "load_time_ms": 0.531, "load_throughput": 485586.911, "learn_time_ms": 63.079, "learn_throughput": 4090.132, "synch_weights_time_ms": 15.714}, "counters": {"num_env_steps_sampled": 19712, "num_env_steps_trained": 5418, "num_agent_steps_sampled": 59136, "num_agent_steps_trained": 5418, "last_target_update_ts": 19712, "num_target_updates": 21}, "done": false, "episodes_total": 0, "training_iteration": 22, "trial_id": "9a806_00000", "date": "2023-11-16_21-54-17", "timestamp": 1700200457, "time_this_iter_s": 1.6171379089355469, "time_total_s": 39.6082284450531, "pid": 45784, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fadd0526430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 39.6082284450531, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 69.6, "ram_util_percent": 90.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.061367988586426, "actor_loss": -4.681631565093994, "critic_loss": 4.077073097229004, "alpha_loss": -0.06341100484132767, "alpha_value": 0.99371737241745, "log_alpha_value": -0.0063024237751960754, "target_entropy": -6.0, "policy_t": -0.04799145460128784, "mean_q": 0.7240146994590759, "max_q": 0.8578830361366272, "min_q": 0.6173564195632935}, "td_error": [5.141197204589844, 5.921758651733398, 5.182655334472656, 4.984832763671875, 6.334883213043213, 4.758201599121094, 5.400074005126953, 5.105396270751953, 4.6285200119018555, 5.03830623626709, 4.427985191345215, 5.268349647521973, 2.7589709758758545, 4.852955341339111, 5.86810827255249, 6.992412567138672, 4.134820938110352, 3.5853159427642822, 5.503974914550781, 6.752981185913086, 4.618613243103027, 5.512989044189453, 3.9270946979522705, 2.7193994522094727, 5.411956787109375, 5.745315074920654, 5.665325164794922, 4.6883344650268555, 4.581151008605957, 6.834530830383301, 3.6838228702545166, 7.082403182983398, 3.3052902221679688, 5.2300124168396, 3.0350213050842285, 5.514232635498047, 5.291378974914551, 4.639786720275879, 5.218766689300537, 5.814671516418457, 3.5802273750305176, 4.965771675109863, 5.440629959106445, 4.396512508392334, 6.883633613586426, 5.993224143981934, 5.818421840667725, 5.36468505859375, 4.2333550453186035, 4.284453392028809, 2.6857190132141113, 4.7974162101745605, 5.52335786819458, 3.4142632484436035, 4.067630290985107, 3.937523365020752, 4.457027435302734, 3.680654525756836, 6.941828727722168, 4.889266014099121, 4.693693161010742, 3.91574764251709, 5.163287162780762, 7.164216995239258, 5.154560565948486, 7.2537031173706055, 5.952267646789551, 6.09641695022583, 4.907037734985352, 4.116060733795166, 4.389044761657715, 5.438534736633301, 4.215561866760254, 3.7575716972351074, 4.759800910949707, 5.338808059692383, 4.585417747497559, 3.839231491088867, 4.962954998016357, 3.3492836952209473, 6.0101704597473145, 6.21319055557251, 4.823076248168945, 4.9346160888671875, 3.8186116218566895, 4.487595081329346], "mean_td_error": 4.951835632324219, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 22.0, "diff_num_grad_updates_vs_sampler_policy": 21.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.07496452331543, "actor_loss": -4.639604091644287, "critic_loss": 1.130350112915039, "alpha_loss": -0.06352904438972473, "alpha_value": 0.9937142133712769, "log_alpha_value": -0.006305634509772062, "target_entropy": -6.0, "policy_t": 0.03173833340406418, "mean_q": 0.6069961190223694, "max_q": 0.7643381953239441, "min_q": 0.49659842252731323}, "td_error": [4.01328706741333, 2.999617576599121, 1.822640061378479, 1.6719081401824951, 2.4582138061523438, 2.6607251167297363, 5.120030403137207, 2.055840492248535, 3.207157611846924, 2.8515753746032715, 3.1730194091796875, 1.6320555210113525, 3.054945945739746, 4.840970039367676, 2.36398983001709, 3.130349636077881, 5.123512268066406, 3.875370979309082, 1.790581226348877, 0.8257241249084473, 3.407668352127075, 2.133629083633423, 2.6209607124328613, 2.730496644973755, 2.4418811798095703, 3.0166168212890625, 1.2080827951431274, 2.195617198944092, 4.614797592163086, 2.138500690460205, 1.8216748237609863, 3.343949794769287, 3.4055750370025635, 3.814931869506836, 4.049718856811523, 3.067725658416748, 3.7852540016174316, 3.5141000747680664, 4.238189697265625, 3.544785976409912, 2.505335569381714, 4.659257411956787, 3.3564014434814453, 4.822756767272949, 3.901850461959839, 1.9938241243362427, 2.4585976600646973, 4.07234001159668, 2.2504613399505615, 2.4926230907440186, 2.338474988937378, 2.3785505294799805, 3.075833797454834, 1.8452694416046143, 2.25767183303833, 4.951460838317871, 3.1793644428253174, 5.240241527557373, 3.1105897426605225, 3.2523837089538574, 5.0590081214904785, 2.205674648284912, 4.318975448608398, 2.6531996726989746, 3.797579765319824, 3.2029683589935303, 5.258216857910156, 1.9842108488082886, 2.096578598022461, 3.457693099975586, 1.4193143844604492, 4.570762634277344, 3.1975672245025635, 3.212419033050537, 3.271998405456543, 5.698556900024414, 3.724520206451416, 4.5677995681762695, 3.392064094543457, 4.940608501434326, 4.346763610839844, 1.9317294359207153, 5.022322654724121, 3.54567551612854, 1.6037731170654297, 1.3252261877059937], "mean_td_error": 3.182723045349121, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 22.0, "diff_num_grad_updates_vs_sampler_policy": 21.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.069242477416992, "actor_loss": -4.658260345458984, "critic_loss": 1.5660138130187988, "alpha_loss": -0.06345871090888977, "alpha_value": 0.993717610836029, "log_alpha_value": -0.006302233319729567, "target_entropy": -6.0, "policy_t": 0.006661844905465841, "mean_q": 0.6420214176177979, "max_q": 0.7667985558509827, "min_q": 0.549354612827301}, "td_error": [3.710291862487793, 3.8791022300720215, 4.292093276977539, 2.609325408935547, 3.2757463455200195, 2.3758983612060547, 3.6478500366210938, 1.143784523010254, 3.5675644874572754, 3.1218371391296387, 2.983625888824463, 3.599540948867798, 3.8137173652648926, 2.7180416584014893, 4.025697708129883, 4.305064678192139, 2.3804426193237305, 2.255903959274292, 1.106654167175293, 3.153721809387207, 1.6360886096954346, 3.781360626220703, 2.100107192993164, 1.3575997352600098, 4.5765485763549805, 3.9180173873901367, 2.7369298934936523, 2.2027368545532227, 3.452387809753418, 2.402897357940674, 0.844444751739502, 3.9985268115997314, 1.5276761054992676, 3.270937919616699, 3.848806381225586, 4.431528091430664, 3.2970011234283447, 4.421631813049316, 3.462724208831787, 3.2702620029449463, 3.237442970275879, 2.4134886264801025, 1.2401647567749023, 2.779919147491455, 3.039890766143799, 1.990882396697998, 3.052265167236328, 3.723661422729492, 2.336817979812622, 5.771855354309082, 2.239292621612549, 3.9320859909057617, 2.790574073791504, 1.4346468448638916, 2.530611038208008, 0.9801890850067139, 2.442683219909668, 3.2861475944519043, 4.7032575607299805, 2.022226333618164, 4.627957820892334, 1.1777828931808472, 3.3415493965148926, 4.676853179931641, 2.3433525562286377, 1.1561181545257568, 1.1809792518615723, 4.1888532638549805, 2.9179539680480957, 2.7678399085998535, 2.4238295555114746, 0.5531980991363525, 4.297118186950684, 1.4708240032196045, 3.44077205657959, 2.352128505706787, 3.782235622406006, 2.50205397605896, 2.973348617553711, 2.0836291313171387, 1.6041548252105713, 1.6347962617874146, 1.7372100353240967, 3.233139991760254, 3.7579360008239746, 3.435530424118042], "mean_td_error": 2.8850393295288086, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 22.0, "diff_num_grad_updates_vs_sampler_policy": 21.0}}, "num_env_steps_sampled": 20608, "num_env_steps_trained": 5676, "num_agent_steps_sampled": 61824, "num_agent_steps_trained": 5676, "last_target_update_ts": 20608, "num_target_updates": 22}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 61824, "num_agent_steps_trained": 5676, "num_env_steps_sampled": 20608, "num_env_steps_trained": 5676, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 545.1047187771285, "num_env_steps_trained_throughput_per_sec": 156.9609569693071, "timesteps_total": 20608, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 61824, "timers": {"training_iteration_time_ms": 1642.899, "sample_time_ms": 1045.972, "load_time_ms": 0.533, "load_throughput": 484456.477, "learn_time_ms": 62.966, "learn_throughput": 4097.452, "synch_weights_time_ms": 15.076}, "counters": {"num_env_steps_sampled": 20608, "num_env_steps_trained": 5676, "num_agent_steps_sampled": 61824, "num_agent_steps_trained": 5676, "last_target_update_ts": 20608, "num_target_updates": 22}, "done": false, "episodes_total": 0, "training_iteration": 23, "trial_id": "9a806_00000", "date": "2023-11-16_21-54-19", "timestamp": 1700200459, "time_this_iter_s": 1.6600959300994873, "time_total_s": 41.26832437515259, "pid": 45784, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fadd04f4ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 41.26832437515259, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 52.6, "ram_util_percent": 90.09999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.020624160766602, "actor_loss": -4.696746349334717, "critic_loss": 4.279352188110352, "alpha_loss": -0.0661611258983612, "alpha_value": 0.9934192299842834, "log_alpha_value": -0.006602494977414608, "target_entropy": -6.0, "policy_t": 0.013976792804896832, "mean_q": 0.7945556044578552, "max_q": 0.9157586693763733, "min_q": 0.6903857588768005}, "td_error": [4.9789605140686035, 5.583683013916016, 4.412032127380371, 4.1643805503845215, 5.394950866699219, 4.740131378173828, 4.601160526275635, 3.1648409366607666, 5.07182502746582, 4.79299259185791, 5.351186752319336, 6.404553413391113, 3.053347110748291, 4.406215667724609, 6.248204708099365, 4.8280348777771, 5.167157173156738, 3.3211662769317627, 5.899335861206055, 3.575225830078125, 3.5926499366760254, 4.977448463439941, 5.259472846984863, 3.7968053817749023, 4.196254730224609, 5.126096725463867, 5.298131942749023, 5.260735511779785, 4.694996356964111, 6.292044639587402, 6.543710708618164, 3.280975103378296, 4.787171363830566, 3.8825552463531494, 6.175070762634277, 4.71369743347168, 6.042426586151123, 7.145160675048828, 4.5012359619140625, 3.8618690967559814, 6.930204391479492, 6.629297256469727, 4.98158073425293, 5.129339218139648, 6.110067844390869, 4.312788486480713, 4.259502410888672, 3.746246337890625, 5.542183876037598, 4.733259201049805, 5.2936906814575195, 4.455024719238281, 3.477200984954834, 6.017190933227539, 5.0419921875, 3.6768798828125, 5.514370918273926, 4.310365676879883, 6.274045944213867, 5.881496429443359, 4.315875053405762, 5.237949371337891, 5.62800407409668, 4.9989166259765625, 4.262895584106445, 4.302363872528076, 4.506918907165527, 5.537591457366943, 6.384824275970459, 4.72136116027832, 3.9918603897094727, 5.24962043762207, 5.594183921813965, 4.892895221710205, 5.170520782470703, 5.864768981933594, 3.2338056564331055, 5.352660179138184, 6.839515209197998, 5.382260799407959, 5.230851173400879, 4.337606906890869, 4.573214530944824, 5.65858268737793, 5.063750267028809, 5.240756988525391], "mean_td_error": 4.982304096221924, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 23.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.054191589355469, "actor_loss": -4.675230026245117, "critic_loss": 1.2050306797027588, "alpha_loss": -0.06641597300767899, "alpha_value": 0.9934159517288208, "log_alpha_value": -0.006605799309909344, "target_entropy": -6.0, "policy_t": -0.01221743505448103, "mean_q": 0.6828166842460632, "max_q": 0.9015744924545288, "min_q": 0.5597741603851318}, "td_error": [3.002471923828125, 4.199277877807617, 1.9863208532333374, 3.212341785430908, 2.5138111114501953, 2.103290319442749, 3.9064321517944336, 3.9114012718200684, 3.6658530235290527, 3.353464126586914, 2.2915453910827637, 2.370011329650879, 1.9825154542922974, 5.080163955688477, 3.139948844909668, 4.894268989562988, 3.035858392715454, 1.9253911972045898, 1.3706145286560059, 2.695772647857666, 3.89361834526062, 4.381677150726318, 2.772686004638672, 2.2755584716796875, 2.2732152938842773, 2.688249111175537, 4.282413482666016, 5.150691986083984, 1.135133147239685, 3.0513172149658203, 1.641390323638916, 2.5901362895965576, 1.7507009506225586, 2.30349063873291, 1.3857225179672241, 3.6151657104492188, 1.3142033815383911, 3.2356996536254883, 3.5103578567504883, 3.6388707160949707, 2.8569865226745605, 4.376070022583008, 2.505007266998291, 2.580282688140869, 5.253544807434082, 3.6016287803649902, 1.956708312034607, 4.071615695953369, 5.141434192657471, 4.570145130157471, 4.652253150939941, 3.803877830505371, 2.4204673767089844, 2.8169870376586914, 2.5469186305999756, 2.8909385204315186, 3.5729713439941406, 3.5201261043548584, 3.0259532928466797, 5.267643928527832, 2.8936429023742676, 2.1114611625671387, 3.3687775135040283, 3.5246243476867676, 3.9285573959350586, 2.250636100769043, 5.084539890289307, 4.799867630004883, 3.3133440017700195, 4.175783157348633, 2.5608229637145996, 2.4150662422180176, 2.9444754123687744, 2.327481269836426, 5.015242576599121, 5.1937432289123535, 3.233799457550049, 6.176257133483887, 3.9017443656921387, 3.2406654357910156, 3.2299609184265137, 3.3466761112213135, 4.048557281494141, 2.8091466426849365, 2.6612424850463867, 3.6643333435058594], "mean_td_error": 3.2695705890655518, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 23.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.084493637084961, "actor_loss": -4.720322608947754, "critic_loss": 1.7613744735717773, "alpha_loss": -0.06658124178647995, "alpha_value": 0.9934194087982178, "log_alpha_value": -0.006602337583899498, "target_entropy": -6.0, "policy_t": 0.02958202362060547, "mean_q": 0.6974443197250366, "max_q": 0.852595329284668, "min_q": 0.60313880443573}, "td_error": [3.8770060539245605, 5.2305827140808105, 3.475203514099121, 0.9036829471588135, 2.5770044326782227, 2.946990966796875, 3.11828351020813, 3.628286123275757, 3.5389480590820312, 5.03680944442749, 3.3976643085479736, 2.807587146759033, 3.799099922180176, 3.3135628700256348, 2.9282400608062744, 3.940506935119629, 3.6042470932006836, 2.9908485412597656, 3.9126505851745605, 4.008477687835693, 4.399469375610352, 3.5525810718536377, 1.9912264347076416, 2.8771891593933105, 2.1411008834838867, 3.6542673110961914, 3.6672964096069336, 3.10441255569458, 1.061729907989502, 3.576943874359131, 2.5830178260803223, 2.6348743438720703, 1.9476089477539062, 3.034621238708496, 1.534804105758667, 3.9311747550964355, 3.504547595977783, 3.369202136993408, 2.7171030044555664, 2.9439024925231934, 4.614972114562988, 2.343550682067871, 5.3050432205200195, 2.857750177383423, 4.121764183044434, 2.0699634552001953, 0.8476836681365967, 5.149110317230225, 3.9171042442321777, 3.2756495475769043, 3.2024378776550293, 2.878396511077881, 3.400869369506836, 2.1562180519104004, 2.2877211570739746, 0.9864434599876404, 3.5912957191467285, 4.330328941345215, 5.5919647216796875, 2.795307159423828, 2.8867082595825195, 3.0799384117126465, 3.463848114013672, 2.539135456085205, 3.2225959300994873, 2.9533355236053467, 3.8204169273376465, 3.5725178718566895, 2.312298536300659, 2.2877535820007324, 3.9916176795959473, 3.7878825664520264, 3.1060023307800293, 3.9889822006225586, 3.4943246841430664, 4.6991376876831055, 4.138910293579102, 2.390251636505127, 3.8309531211853027, 2.855360746383667, 4.70831823348999, 2.6215555667877197, 1.9123045206069946, 3.0481908321380615, 2.8060691356658936, 3.3436267375946045], "mean_td_error": 3.230794906616211, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 23.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 21504, "num_env_steps_trained": 5934, "num_agent_steps_sampled": 64512, "num_agent_steps_trained": 5934, "last_target_update_ts": 21504, "num_target_updates": 23}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64512, "num_agent_steps_trained": 5934, "num_env_steps_sampled": 21504, "num_env_steps_trained": 5934, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 559.3423303080308, "num_env_steps_trained_throughput_per_sec": 161.0606263610178, "timesteps_total": 21504, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 64512, "timers": {"training_iteration_time_ms": 1643.984, "sample_time_ms": 1047.532, "load_time_ms": 0.531, "load_throughput": 486044.93, "learn_time_ms": 63.049, "learn_throughput": 4092.08, "synch_weights_time_ms": 14.941}, "counters": {"num_env_steps_sampled": 21504, "num_env_steps_trained": 5934, "num_agent_steps_sampled": 64512, "num_agent_steps_trained": 5934, "last_target_update_ts": 21504, "num_target_updates": 23}, "done": false, "episodes_total": 0, "training_iteration": 24, "trial_id": "9a806_00000", "date": "2023-11-16_21-54-21", "timestamp": 1700200461, "time_this_iter_s": 1.6185550689697266, "time_total_s": 42.886879444122314, "pid": 45784, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fadd04f4c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 42.886879444122314, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 70.55000000000001, "ram_util_percent": 90.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.076494216918945, "actor_loss": -4.807430744171143, "critic_loss": 3.82545804977417, "alpha_loss": -0.06955229490995407, "alpha_value": 0.993121325969696, "log_alpha_value": -0.006902429275214672, "target_entropy": -6.0, "policy_t": 0.016124319285154343, "mean_q": 0.8681110143661499, "max_q": 1.0598686933517456, "min_q": 0.736430287361145}, "td_error": [4.6632184982299805, 5.312399864196777, 3.916125535964966, 3.2501745223999023, 5.21478271484375, 5.450481414794922, 5.752483367919922, 4.8172197341918945, 6.351178169250488, 4.477214813232422, 4.681663513183594, 4.545854568481445, 6.374371528625488, 6.999050617218018, 4.42464542388916, 6.453790187835693, 4.876888275146484, 3.9358291625976562, 3.7314109802246094, 3.1113357543945312, 5.226716995239258, 5.011839389801025, 3.144524335861206, 3.3100204467773438, 3.0065951347351074, 4.357301712036133, 4.791082382202148, 5.433253288269043, 5.290794849395752, 3.851353168487549, 4.767379283905029, 3.1898999214172363, 3.2750048637390137, 3.6703927516937256, 4.922481060028076, 3.5786843299865723, 1.9755007028579712, 5.1045026779174805, 5.922771453857422, 5.476036071777344, 4.883267402648926, 5.578234672546387, 5.8967695236206055, 4.043826580047607, 4.960219383239746, 3.898604393005371, 6.386028289794922, 5.825516700744629, 4.769577980041504, 5.366725921630859, 4.853936672210693, 5.900179862976074, 5.400198936462402, 4.815644264221191, 1.8160182237625122, 5.009113311767578, 5.634783744812012, 5.329446792602539, 4.703218460083008, 5.904889106750488, 3.8717620372772217, 6.466634273529053, 4.297869682312012, 4.827083587646484, 5.256821632385254, 4.844870567321777, 4.413262367248535, 4.716558933258057, 5.141235828399658, 3.947938919067383, 7.032177925109863, 4.31091833114624, 4.360429763793945, 3.5043833255767822, 4.626958847045898, 3.138803482055664, 4.587275981903076, 4.217723846435547, 5.2889556884765625, 3.9248452186584473, 4.22801399230957, 3.0985655784606934, 4.025404930114746, 4.921892166137695, 6.77217960357666, 4.824395179748535], "mean_td_error": 4.712434768676758, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 24.0, "diff_num_grad_updates_vs_sampler_policy": 23.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.061623573303223, "actor_loss": -4.729414939880371, "critic_loss": 1.2083284854888916, "alpha_loss": -0.0694844126701355, "alpha_value": 0.9931179285049438, "log_alpha_value": -0.0069058844819664955, "target_entropy": -6.0, "policy_t": -0.022461246699094772, "mean_q": 0.7153075337409973, "max_q": 0.8397443890571594, "min_q": 0.6180495023727417}, "td_error": [3.049976348876953, 2.8315606117248535, 4.5926513671875, 2.9974629878997803, 3.014914035797119, 2.5344340801239014, 4.399737358093262, 3.0402021408081055, 3.791351556777954, 2.4186055660247803, 3.4612979888916016, 4.4645280838012695, 4.854559898376465, 1.8545335531234741, 1.9394978284835815, 3.384035110473633, 3.4569764137268066, 3.1639294624328613, 4.3612565994262695, 3.2045845985412598, 2.96677303314209, 4.068138122558594, 3.857022285461426, 2.6943178176879883, 1.8602609634399414, 1.9307117462158203, 3.933865547180176, 3.0012314319610596, 2.439059019088745, 2.59476900100708, 3.6283321380615234, 3.7339890003204346, 2.426299571990967, 1.5534565448760986, 3.8136634826660156, 3.0024378299713135, 3.44161319732666, 3.952636241912842, 2.5570385456085205, 2.064434051513672, 5.800664901733398, 2.1829209327697754, 2.330718994140625, 2.5830490589141846, 3.941220283508301, 3.0193631649017334, 2.943289041519165, 2.4366161823272705, 3.578007459640503, 2.9371650218963623, 4.668849468231201, 4.532214164733887, 3.0855138301849365, 2.5674028396606445, 2.626708507537842, 4.608099937438965, 3.860764503479004, 3.1753926277160645, 4.6838059425354, 3.3599071502685547, 2.6309032440185547, 3.4344422817230225, 3.5450544357299805, 3.756862163543701, 1.4292290210723877, 3.8764138221740723, 3.5345287322998047, 1.7346419095993042, 2.2420668601989746, 2.2918505668640137, 2.0064191818237305, 3.0034890174865723, 2.8956458568573, 3.3184638023376465, 2.3990461826324463, 2.841121196746826, 3.776578426361084, 3.8023698329925537, 2.744147777557373, 4.412226676940918, 3.9605050086975098, 3.306649684906006, 4.503405570983887, 3.3500757217407227, 2.886425018310547, 6.268113136291504], "mean_td_error": 3.246610403060913, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 24.0, "diff_num_grad_updates_vs_sampler_policy": 23.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.093223571777344, "actor_loss": -4.797512531280518, "critic_loss": 1.4954872131347656, "alpha_loss": -0.06966763734817505, "alpha_value": 0.993121325969696, "log_alpha_value": -0.0069024162366986275, "target_entropy": -6.0, "policy_t": -0.014642965979874134, "mean_q": 0.7639257907867432, "max_q": 0.970345675945282, "min_q": 0.6323573589324951}, "td_error": [3.4547948837280273, 3.1888837814331055, 1.6292979717254639, 2.7441020011901855, 3.276275157928467, 1.5347647666931152, 2.9909939765930176, 2.2828869819641113, 1.863465666770935, 3.6334290504455566, 1.7319958209991455, 3.236922264099121, 0.7697896957397461, 3.7362961769104004, 3.4203033447265625, 2.939434051513672, 3.8322925567626953, 1.5493171215057373, 4.929455280303955, 3.8154563903808594, 1.3933486938476562, 3.866264820098877, 2.5785021781921387, 2.115675449371338, 4.454710960388184, 2.0616211891174316, 3.228978157043457, 2.3424296379089355, 3.256237745285034, 3.8777782917022705, 2.4149317741394043, 4.7281084060668945, 3.902409076690674, 1.5103418827056885, 2.4339497089385986, 2.3659253120422363, 2.413863182067871, 1.7924699783325195, 2.5600059032440186, 1.8977912664413452, 1.3217527866363525, 2.75663685798645, 4.464215278625488, 3.565089225769043, 3.1989564895629883, 2.1581037044525146, 3.3635923862457275, 4.870296001434326, 2.4799437522888184, 2.39139986038208, 1.2053172588348389, 2.251433849334717, 2.744414806365967, 3.0133111476898193, 4.512007236480713, 2.416867733001709, 3.8539175987243652, 1.9934436082839966, 3.896519422531128, 2.626784324645996, 2.209929943084717, 3.4418535232543945, 1.3158397674560547, 0.6211397051811218, 2.6803226470947266, 3.5750463008880615, 1.4674186706542969, 2.1089396476745605, 2.7289814949035645, 2.917012929916382, 4.245745658874512, 2.6173768043518066, 2.023555040359497, 3.7627859115600586, 3.493129253387451, 3.5496439933776855, 2.121419668197632, 2.7871203422546387, 4.149682998657227, 3.548819065093994, 3.2073910236358643, 4.833014965057373, 0.9539022445678711, 3.2740609645843506, 2.74355411529541, 2.728494882583618], "mean_td_error": 2.8365776538848877, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 24.0, "diff_num_grad_updates_vs_sampler_policy": 23.0}}, "num_env_steps_sampled": 22400, "num_env_steps_trained": 6192, "num_agent_steps_sampled": 67200, "num_agent_steps_trained": 6192, "last_target_update_ts": 22400, "num_target_updates": 24}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 67200, "num_agent_steps_trained": 6192, "num_env_steps_sampled": 22400, "num_env_steps_trained": 6192, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 465.5469279212351, "num_env_steps_trained_throughput_per_sec": 134.05257522731995, "timesteps_total": 22400, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 67200, "timers": {"training_iteration_time_ms": 1674.834, "sample_time_ms": 1079.55, "load_time_ms": 0.532, "load_throughput": 485042.775, "learn_time_ms": 63.01, "learn_throughput": 4094.597, "synch_weights_time_ms": 14.932}, "counters": {"num_env_steps_sampled": 22400, "num_env_steps_trained": 6192, "num_agent_steps_sampled": 67200, "num_agent_steps_trained": 6192, "last_target_update_ts": 22400, "num_target_updates": 24}, "done": false, "episodes_total": 0, "training_iteration": 25, "trial_id": "9a806_00000", "date": "2023-11-16_21-54-23", "timestamp": 1700200463, "time_this_iter_s": 1.9392011165618896, "time_total_s": 44.826080560684204, "pid": 45784, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fadd0526430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 44.826080560684204, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 61.699999999999996, "ram_util_percent": 90.13333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.114675521850586, "actor_loss": -4.924203395843506, "critic_loss": 3.8788764476776123, "alpha_loss": -0.07284951210021973, "alpha_value": 0.9928235411643982, "log_alpha_value": -0.007202357053756714, "target_entropy": -6.0, "policy_t": 0.02180095948278904, "mean_q": 0.9561972618103027, "max_q": 1.1092236042022705, "min_q": 0.7895180583000183}, "td_error": [4.990408420562744, 5.1669745445251465, 5.373220443725586, 4.078325271606445, 5.351611614227295, 4.822339057922363, 4.625557899475098, 5.376059055328369, 5.48848819732666, 4.808602333068848, 3.973275661468506, 5.418115615844727, 5.999817848205566, 5.22635555267334, 5.342789649963379, 5.946149826049805, 5.704779148101807, 4.662315368652344, 6.497768402099609, 1.7207412719726562, 4.982352256774902, 5.022049427032471, 3.9088847637176514, 6.679113388061523, 5.439923286437988, 3.227571964263916, 6.513970375061035, 4.803579330444336, 6.102568626403809, 5.947012901306152, 3.495028018951416, 5.263913154602051, 4.365485191345215, 3.3614912033081055, 4.149613380432129, 5.643751621246338, 3.4609107971191406, 5.853155612945557, 2.906926155090332, 3.5190601348876953, 4.690018177032471, 4.065433502197266, 4.2221903800964355, 5.500187873840332, 3.797497510910034, 5.126497268676758, 6.51295280456543, 4.4542999267578125, 5.00416374206543, 5.113448619842529, 3.6857187747955322, 3.429114818572998, 5.669328689575195, 5.381068706512451, 4.083504676818848, 4.827442169189453, 4.808625221252441, 5.269376754760742, 4.9161272048950195, 4.582611083984375, 4.924984931945801, 4.659623146057129, 5.182212829589844, 4.885039806365967, 5.500124454498291, 6.395150661468506, 3.2010703086853027, 5.527653694152832, 5.136871337890625, 4.185429573059082, 3.733808994293213, 5.132777214050293, 3.3429765701293945, 3.2921435832977295, 3.709585189819336, 5.377294540405273, 2.739286184310913, 4.818447113037109, 4.936413764953613, 2.700237274169922, 2.666466474533081, 4.831158638000488, 4.732385635375977, 4.193697929382324, 4.088334083557129, 4.709869384765625], "mean_td_error": 4.708868503570557, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 25.0, "diff_num_grad_updates_vs_sampler_policy": 24.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.114961624145508, "actor_loss": -4.84687614440918, "critic_loss": 1.1182148456573486, "alpha_loss": -0.07288755476474762, "alpha_value": 0.9928199648857117, "log_alpha_value": -0.007205915171653032, "target_entropy": -6.0, "policy_t": 0.01370249968022108, "mean_q": 0.7909300327301025, "max_q": 0.9447552561759949, "min_q": 0.6426483392715454}, "td_error": [3.992541790008545, 3.3523330688476562, 3.2939834594726562, 2.4392619132995605, 4.354556560516357, 1.549636960029602, 3.62839412689209, 2.347501754760742, 1.9635429382324219, 1.8826632499694824, 2.767305850982666, 1.6896231174468994, 3.088902711868286, 3.841776132583618, 2.9881930351257324, 3.25213623046875, 2.279043197631836, 2.521754503250122, 2.17364501953125, 4.4758405685424805, 4.116301536560059, 4.138540267944336, 3.9365129470825195, 2.8178765773773193, 1.943613886833191, 2.8632822036743164, 2.1658737659454346, 4.7939887046813965, 4.168159484863281, 4.23095178604126, 4.049294471740723, 4.526584625244141, 0.999273419380188, 4.631198883056641, 1.869308590888977, 1.9359792470932007, 3.6889829635620117, 2.8685708045959473, 4.275124549865723, 2.643570899963379, 1.8819358348846436, 4.071389675140381, 2.6299962997436523, 5.006338596343994, 2.4881503582000732, 3.7884292602539062, 3.950319290161133, 1.370138168334961, 2.144613265991211, 2.8414618968963623, 4.223467826843262, 2.9228405952453613, 3.9647321701049805, 3.196711778640747, 4.175135612487793, 2.1625165939331055, 2.1913557052612305, 3.9745287895202637, 2.3487346172332764, 0.041640281677246094, 4.127571105957031, 1.4644663333892822, 2.2054390907287598, 4.67987585067749, 3.1684794425964355, 3.9826767444610596, 3.200155735015869, 3.116882085800171, 2.2277092933654785, 1.7680017948150635, 2.973067283630371, 2.2354705333709717, 2.922813892364502, 1.9609777927398682, 2.222003698348999, 2.857008934020996, 2.250576972961426, 3.4789843559265137, 3.1085853576660156, 3.5287833213806152, 2.8189706802368164, 1.6798030138015747, 3.8153042793273926, 2.93326997756958, 2.9504246711730957, 2.0899221897125244], "mean_td_error": 2.996364116668701, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 25.0, "diff_num_grad_updates_vs_sampler_policy": 24.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.156131744384766, "actor_loss": -4.913589954376221, "critic_loss": 1.593993067741394, "alpha_loss": -0.0731494352221489, "alpha_value": 0.9928233623504639, "log_alpha_value": -0.007202489767223597, "target_entropy": -6.0, "policy_t": 0.03003794327378273, "mean_q": 0.847867488861084, "max_q": 1.00594961643219, "min_q": 0.7019917368888855}, "td_error": [3.5708396434783936, 2.1962647438049316, 2.6306185722351074, 3.238882541656494, 1.4796879291534424, 2.087599039077759, 3.321828842163086, 1.1175670623779297, 4.1676483154296875, 3.679732084274292, 2.2890357971191406, 5.6013078689575195, 3.2547261714935303, 4.544094562530518, 4.694756507873535, 3.800703525543213, 4.965944290161133, 4.201213359832764, 3.034881114959717, 4.231256008148193, 2.490125894546509, 4.29017972946167, 1.8308436870574951, 1.9389533996582031, 2.1257829666137695, 2.7137556076049805, 1.8243069648742676, 2.825883388519287, 2.302948474884033, 2.6847901344299316, 2.3339664936065674, 2.024639129638672, 3.959885597229004, 2.9305057525634766, 5.983160018920898, 0.6455719470977783, 1.5442615747451782, 3.8194596767425537, 4.006426811218262, 4.194912433624268, 3.5681557655334473, 5.2007622718811035, 1.5739226341247559, 2.39713191986084, 2.210127830505371, 1.904240369796753, 2.8056793212890625, 4.681142330169678, 3.4981608390808105, 3.8304734230041504, 4.39881706237793, 2.849808692932129, 3.385298728942871, 3.9982762336730957, 3.5770936012268066, 3.6655399799346924, 3.1870198249816895, 1.7330788373947144, 0.5282807350158691, 4.40185546875, 3.513097047805786, 2.599485397338867, 2.1255407333374023, 2.5581936836242676, 3.0628528594970703, 1.9350756406784058, 1.8879525661468506, 2.036212682723999, 2.3667776584625244, 2.0752477645874023, 3.084301471710205, 2.7535037994384766, 2.573136806488037, 1.3477245569229126, 1.4726171493530273, 3.506865978240967, 3.7752525806427, 3.594470500946045, 5.741152763366699, 3.1028857231140137, 3.3060402870178223, 3.1982102394104004, 1.4591820240020752, 2.8044373989105225, 3.67118501663208, 1.0224661827087402], "mean_td_error": 3.0063681602478027, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 25.0, "diff_num_grad_updates_vs_sampler_policy": 24.0}}, "num_env_steps_sampled": 23296, "num_env_steps_trained": 6450, "num_agent_steps_sampled": 69888, "num_agent_steps_trained": 6450, "last_target_update_ts": 23296, "num_target_updates": 25}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 69888, "num_agent_steps_trained": 6450, "num_env_steps_sampled": 23296, "num_env_steps_trained": 6450, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 563.7411507434877, "num_env_steps_trained_throughput_per_sec": 162.32725099533462, "timesteps_total": 23296, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 69888, "timers": {"training_iteration_time_ms": 1672.164, "sample_time_ms": 1077.032, "load_time_ms": 0.531, "load_throughput": 485695.885, "learn_time_ms": 62.949, "learn_throughput": 4098.552, "synch_weights_time_ms": 14.729}, "counters": {"num_env_steps_sampled": 23296, "num_env_steps_trained": 6450, "num_agent_steps_sampled": 69888, "num_agent_steps_trained": 6450, "last_target_update_ts": 23296, "num_target_updates": 25}, "done": false, "episodes_total": 0, "training_iteration": 26, "trial_id": "9a806_00000", "date": "2023-11-16_21-54-24", "timestamp": 1700200464, "time_this_iter_s": 1.605849027633667, "time_total_s": 46.43192958831787, "pid": 45784, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fadc09cd790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 46.43192958831787, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 69.6, "ram_util_percent": 90.15}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.062024116516113, "actor_loss": -4.922084808349609, "critic_loss": 4.322795867919922, "alpha_loss": -0.07548888027667999, "alpha_value": 0.9925256967544556, "log_alpha_value": -0.007502355612814426, "target_entropy": -6.0, "policy_t": 0.043628185987472534, "mean_q": 1.0317493677139282, "max_q": 1.3073036670684814, "min_q": 0.8654175400733948}, "td_error": [5.88973331451416, 4.907987594604492, 3.7934632301330566, 4.994060516357422, 4.852293014526367, 5.96175479888916, 3.590021848678589, 5.237441539764404, 5.1093573570251465, 5.586078643798828, 2.731066942214966, 5.957538604736328, 5.854126453399658, 6.492300033569336, 2.9950380325317383, 3.6918373107910156, 5.024872303009033, 6.018378734588623, 3.979703187942505, 5.628750324249268, 5.210085868835449, 4.491461753845215, 7.539802551269531, 5.964851379394531, 6.372641563415527, 4.571544647216797, 5.402496337890625, 4.332526206970215, 4.1971940994262695, 4.099613189697266, 5.205222129821777, 4.358064651489258, 4.713640213012695, 5.163249969482422, 4.824912071228027, 5.149045467376709, 5.786771774291992, 4.877053260803223, 5.315302848815918, 6.150609970092773, 7.165682315826416, 4.099757671356201, 5.8947553634643555, 3.848971366882324, 4.515951633453369, 5.6174445152282715, 6.208408355712891, 5.790538787841797, 4.270356178283691, 5.6861443519592285, 5.574706554412842, 5.225029945373535, 5.766111373901367, 7.254495143890381, 4.809920310974121, 6.627026557922363, 5.17188835144043, 3.920168399810791, 4.849918365478516, 4.78518533706665, 3.415070056915283, 4.011654853820801, 5.359005928039551, 5.758817672729492, 5.200162887573242, 4.108547210693359, 5.5731072425842285, 4.523689270019531, 4.6938629150390625, 4.027529716491699, 4.32832145690918, 6.798099994659424, 7.191013336181641, 4.780344486236572, 5.160769462585449, 5.803528308868408, 5.721749782562256, 4.724205017089844, 6.373170852661133, 5.36807918548584, 5.543770790100098, 4.202628135681152, 4.571074485778809, 3.656341075897217, 5.5572123527526855, 5.514358043670654], "mean_td_error": 5.128726482391357, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 26.0, "diff_num_grad_updates_vs_sampler_policy": 25.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.092062950134277, "actor_loss": -4.896481037139893, "critic_loss": 1.094404697418213, "alpha_loss": -0.07575108855962753, "alpha_value": 0.992522120475769, "log_alpha_value": -0.007506005931645632, "target_entropy": -6.0, "policy_t": -0.01221216656267643, "mean_q": 0.875431478023529, "max_q": 1.025272250175476, "min_q": 0.6971525549888611}, "td_error": [0.8112339973449707, 3.520940065383911, 3.54746675491333, 2.714111566543579, 3.3166592121124268, 2.863579273223877, 1.5485141277313232, 4.144893169403076, 4.2138848304748535, 2.363124370574951, 2.298043966293335, 2.7262420654296875, 1.1927567720413208, 2.941019296646118, 2.2754411697387695, 3.475308418273926, 1.2835615873336792, 5.119211196899414, 2.5802807807922363, 2.38148832321167, 2.795980930328369, 3.4562301635742188, 2.4340758323669434, 4.18767786026001, 2.1845126152038574, 2.9022324085235596, 2.5268213748931885, 1.6250685453414917, 1.5820038318634033, 4.426431655883789, 4.845471382141113, 3.7154085636138916, 3.6186323165893555, 3.4872817993164062, 3.548133134841919, 4.407569885253906, 2.452867031097412, 2.377509117126465, 3.825216770172119, 2.324192762374878, 2.4705750942230225, 3.514314651489258, 5.210063934326172, 4.362654685974121, 4.006340026855469, 2.014350175857544, 3.2269906997680664, 3.5215258598327637, 1.9922600984573364, 2.977678060531616, 2.1055049896240234, 2.2495439052581787, 4.550724029541016, 1.1099828481674194, 4.58139705657959, 3.3811445236206055, 3.6270928382873535, 1.8775323629379272, 4.142972946166992, 2.999697685241699, 2.386826515197754, 3.3158912658691406, 2.678739070892334, 2.989750862121582, 3.0411336421966553, 1.6562273502349854, 3.8131957054138184, 2.3456485271453857, 3.1059727668762207, 4.216706275939941, 4.383843898773193, 1.37373948097229, 2.260338306427002, 2.74276065826416, 2.35750675201416, 2.2377684116363525, 2.9858450889587402, 1.1151785850524902, 3.021972179412842, 4.34638786315918, 3.9968786239624023, 2.3644375801086426, 4.145707607269287, 0.9810181260108948, 3.392704963684082, 4.009894371032715], "mean_td_error": 2.9910407066345215, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 26.0, "diff_num_grad_updates_vs_sampler_policy": 25.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.065333366394043, "actor_loss": -4.912025451660156, "critic_loss": 1.5351896286010742, "alpha_loss": -0.07551702111959457, "alpha_value": 0.9925253987312317, "log_alpha_value": -0.007502684369683266, "target_entropy": -6.0, "policy_t": 0.0015382200945168734, "mean_q": 0.9109763503074646, "max_q": 1.076215386390686, "min_q": 0.7788746356964111}, "td_error": [3.3874387741088867, 2.3322596549987793, 5.03452730178833, 1.2560477256774902, 1.7057385444641113, 2.749337673187256, 3.304879665374756, 3.244356393814087, 2.8273534774780273, 1.6127382516860962, 5.056804656982422, 4.443543434143066, 3.3639750480651855, 1.4880635738372803, 2.10162353515625, 3.214454174041748, 4.271502494812012, 2.89105224609375, 1.8399972915649414, 1.4651013612747192, 2.008045196533203, 3.558631658554077, 3.2365283966064453, 4.290588855743408, 2.956526279449463, 1.656103491783142, 2.393383026123047, 2.6729180812835693, 2.9533584117889404, 4.171416282653809, 3.564793109893799, 3.3545379638671875, 3.8130316734313965, 3.7720084190368652, 3.012678623199463, 2.084843158721924, 2.2070515155792236, 2.0179851055145264, 1.39711332321167, 3.7923953533172607, 1.43182373046875, 2.916832685470581, 2.9979748725891113, 5.240370750427246, 4.420111656188965, 3.4392757415771484, 2.626591205596924, 1.7517149448394775, 2.203734874725342, 3.577486991882324, 1.344164252281189, 2.976749897003174, 0.9909016489982605, 2.4329028129577637, 2.7838668823242188, 3.112124443054199, 1.3512704372406006, 4.355248928070068, 2.8395023345947266, 3.906308889389038, 2.9144039154052734, 5.13652229309082, 1.2648869752883911, 1.9634813070297241, 4.507752895355225, 1.7237486839294434, 3.4241859912872314, 2.8005056381225586, 3.5084803104400635, 1.1870691776275635, 1.1099114418029785, 2.7261033058166504, 2.4101274013519287, 2.8508543968200684, 3.564333438873291, 3.0573067665100098, 2.9705076217651367, 3.1290574073791504, 2.1614043712615967, 2.7454097270965576, 2.9359452724456787, 4.169498920440674, 1.8657574653625488, 2.958524227142334, 3.798032283782959, 2.238422393798828], "mean_td_error": 2.864254951477051, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 26.0, "diff_num_grad_updates_vs_sampler_policy": 25.0}}, "num_env_steps_sampled": 24192, "num_env_steps_trained": 6708, "num_agent_steps_sampled": 72576, "num_agent_steps_trained": 6708, "last_target_update_ts": 24192, "num_target_updates": 26}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72576, "num_agent_steps_trained": 6708, "num_env_steps_sampled": 24192, "num_env_steps_trained": 6708, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 553.7378458912542, "num_env_steps_trained_throughput_per_sec": 159.44683508922273, "timesteps_total": 24192, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 72576, "timers": {"training_iteration_time_ms": 1674.318, "sample_time_ms": 1077.927, "load_time_ms": 0.529, "load_throughput": 487929.674, "learn_time_ms": 62.905, "learn_throughput": 4101.418, "synch_weights_time_ms": 15.184}, "counters": {"num_env_steps_sampled": 24192, "num_env_steps_trained": 6708, "num_agent_steps_sampled": 72576, "num_agent_steps_trained": 6708, "last_target_update_ts": 24192, "num_target_updates": 26}, "done": false, "episodes_total": 0, "training_iteration": 27, "trial_id": "9a806_00000", "date": "2023-11-16_21-54-26", "timestamp": 1700200466, "time_this_iter_s": 1.63120698928833, "time_total_s": 48.0631365776062, "pid": 45784, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fadc09cd4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 48.0631365776062, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 67.55, "ram_util_percent": 90.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.14018726348877, "actor_loss": -5.091508388519287, "critic_loss": 3.8219242095947266, "alpha_loss": -0.07911686599254608, "alpha_value": 0.9922280311584473, "log_alpha_value": -0.00780230900272727, "target_entropy": -6.0, "policy_t": 0.00468784524127841, "mean_q": 1.124700665473938, "max_q": 1.3784430027008057, "min_q": 0.9226163625717163}, "td_error": [3.724270820617676, 4.98062801361084, 4.659553527832031, 4.456213474273682, 4.798848628997803, 4.403059959411621, 5.923332691192627, 2.7560436725616455, 4.704524040222168, 2.214488983154297, 4.594675064086914, 4.712287425994873, 3.33646297454834, 4.569883346557617, 3.7927002906799316, 3.7371785640716553, 5.657034873962402, 6.024937629699707, 2.803675889968872, 5.515617370605469, 5.356410980224609, 5.0677642822265625, 5.700622081756592, 3.141860246658325, 5.1901702880859375, 4.211160659790039, 5.28245735168457, 4.443217754364014, 5.214838027954102, 3.557760000228882, 5.668605804443359, 6.809144020080566, 3.586695671081543, 3.9973926544189453, 6.015100002288818, 6.118520736694336, 4.042086124420166, 3.965182065963745, 5.045797348022461, 4.482072830200195, 3.2940454483032227, 4.105291366577148, 2.524315357208252, 4.881568908691406, 6.318857192993164, 3.5619661808013916, 5.151791572570801, 4.852560997009277, 4.466981887817383, 5.699051856994629, 4.1409101486206055, 4.9873247146606445, 4.9397478103637695, 5.652968406677246, 3.5147008895874023, 3.9887750148773193, 4.185563564300537, 4.525785446166992, 5.9548516273498535, 3.755779266357422, 5.538256645202637, 4.566901206970215, 4.706697463989258, 4.358820915222168, 6.394952297210693, 1.7001252174377441, 2.7355611324310303, 3.809269905090332, 4.491941452026367, 5.674187660217285, 3.5265049934387207, 6.010128974914551, 5.008620262145996, 6.406759262084961, 3.893218755722046, 6.520503044128418, 4.204277038574219, 4.584524631500244, 6.390935897827148, 5.031982898712158, 5.128839015960693, 4.699195861816406, 3.310356616973877, 3.9292643070220947, 5.450836181640625, 6.152843475341797], "mean_td_error": 4.639425754547119, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 27.0, "diff_num_grad_updates_vs_sampler_policy": 26.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.10947036743164, "actor_loss": -4.9896440505981445, "critic_loss": 1.0215989351272583, "alpha_loss": -0.0789155438542366, "alpha_value": 0.9922242760658264, "log_alpha_value": -0.007806101813912392, "target_entropy": -6.0, "policy_t": -0.0027990988455712795, "mean_q": 0.9576902389526367, "max_q": 1.1227537393569946, "min_q": 0.781589150428772}, "td_error": [3.4798569679260254, 4.015411376953125, 3.129415512084961, 4.456793785095215, 1.6722383499145508, 1.8188672065734863, 1.704979658126831, 3.70770263671875, 1.544485330581665, 1.9426748752593994, 0.8311669826507568, 2.3556454181671143, 4.802124500274658, 2.2006826400756836, 4.4785614013671875, 2.2347097396850586, 3.878861904144287, 4.289870262145996, 1.4098761081695557, 2.9569568634033203, 2.032271146774292, 2.7099905014038086, 2.818943977355957, 2.896517276763916, 2.139280319213867, 3.158008575439453, 3.3112282752990723, 5.1760053634643555, 4.689504146575928, 3.321132183074951, 1.3693528175354004, 3.958258867263794, 2.368086814880371, 3.1479578018188477, 2.803065538406372, 1.6835581064224243, 0.41911473870277405, 2.390223741531372, 1.978484869003296, 3.3226442337036133, 3.6678709983825684, 3.4026148319244385, 1.2461732625961304, 2.772249460220337, 3.2657418251037598, 2.9932334423065186, 2.9319329261779785, 4.473719596862793, 3.0619144439697266, 3.4375338554382324, 3.896636486053467, 2.6596529483795166, 1.5853989124298096, 3.5897088050842285, 4.120138168334961, 1.329087734222412, 3.173065423965454, 2.375840663909912, 0.20571613311767578, 3.0260844230651855, 4.971092224121094, 3.1163036823272705, 1.413163423538208, 3.118474006652832, 3.0473008155822754, 3.717510223388672, 0.6536418795585632, 2.0967020988464355, 1.5776005983352661, 3.7656991481781006, 3.3193366527557373, 1.7583262920379639, 3.4361886978149414, 0.4529196321964264, 2.1517069339752197, 3.9104785919189453, 1.729482889175415, 4.2465410232543945, 3.1734933853149414, 3.155526638031006, 0.9677194356918335, 2.448917865753174, 0.7710267901420593, 4.131470680236816, 2.677133560180664, 4.091699600219727], "mean_td_error": 2.7874221801757812, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 27.0, "diff_num_grad_updates_vs_sampler_policy": 26.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.113179206848145, "actor_loss": -5.036591053009033, "critic_loss": 1.5201683044433594, "alpha_loss": -0.07891111820936203, "alpha_value": 0.9922275543212891, "log_alpha_value": -0.00780280027538538, "target_entropy": -6.0, "policy_t": -0.0037451516836881638, "mean_q": 0.9920582175254822, "max_q": 1.2017419338226318, "min_q": 0.8625240921974182}, "td_error": [3.1792819499969482, 4.558928489685059, 0.14073294401168823, 2.0831854343414307, 3.027491569519043, 1.5115851163864136, 4.723866939544678, 0.8468377590179443, 2.7812654972076416, 4.117362976074219, 3.648721218109131, 2.8646931648254395, 3.0351176261901855, 2.9203717708587646, 3.65484619140625, 2.070847511291504, 1.448857307434082, 2.6646242141723633, 1.97883939743042, 2.1248059272766113, 1.788994312286377, 4.424983978271484, 4.176923751831055, 2.3595376014709473, 2.8122739791870117, 1.2499275207519531, 5.0048675537109375, 2.8002614974975586, 3.2421295642852783, 3.6816797256469727, 2.1617069244384766, 2.5454416275024414, 2.123934030532837, 3.089718818664551, 4.3406572341918945, 2.7594223022460938, 2.769315004348755, 3.8380935192108154, 2.3467659950256348, 1.054788589477539, 2.264120101928711, 4.074925422668457, 1.76753568649292, 1.9595062732696533, 3.80745267868042, 2.762723922729492, 3.13775634765625, 2.7116684913635254, 4.441323757171631, 3.9142541885375977, 2.785723924636841, 1.7050296068191528, 3.6645941734313965, 2.252037286758423, 0.41114839911460876, 2.2656443119049072, 3.033694267272949, 2.637763500213623, 1.6897220611572266, 2.605637550354004, 4.305624961853027, 3.9493446350097656, 4.460723876953125, 1.1340293884277344, 3.1503748893737793, 2.711167812347412, 2.3513495922088623, 2.6634082794189453, 3.767591714859009, 2.7015628814697266, 2.7782325744628906, 2.7693753242492676, 4.855005264282227, 2.6166090965270996, 1.8662328720092773, 2.5821304321289062, 3.2319164276123047, 1.572788119316101, 3.3763625621795654, 1.6628798246383667, 1.4034831523895264, 4.081873893737793, 2.74652099609375, 3.080503463745117, 2.0804929733276367, 3.2311503887176514], "mean_td_error": 2.8020546436309814, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 27.0, "diff_num_grad_updates_vs_sampler_policy": 26.0}}, "num_env_steps_sampled": 25088, "num_env_steps_trained": 6966, "num_agent_steps_sampled": 75264, "num_agent_steps_trained": 6966, "last_target_update_ts": 25088, "num_target_updates": 27}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 75264, "num_agent_steps_trained": 6966, "num_env_steps_sampled": 25088, "num_env_steps_trained": 6966, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 402.1498934083994, "num_env_steps_trained_throughput_per_sec": 115.79762555732928, "timesteps_total": 25088, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 75264, "timers": {"training_iteration_time_ms": 1734.831, "sample_time_ms": 1140.291, "load_time_ms": 0.527, "load_throughput": 489142.717, "learn_time_ms": 62.864, "learn_throughput": 4104.065, "synch_weights_time_ms": 15.377}, "counters": {"num_env_steps_sampled": 25088, "num_env_steps_trained": 6966, "num_agent_steps_sampled": 75264, "num_agent_steps_trained": 6966, "last_target_update_ts": 25088, "num_target_updates": 27}, "done": false, "episodes_total": 0, "training_iteration": 28, "trial_id": "9a806_00000", "date": "2023-11-16_21-54-28", "timestamp": 1700200468, "time_this_iter_s": 2.2419557571411133, "time_total_s": 50.305092334747314, "pid": 45784, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fadd04c9310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 50.305092334747314, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 58.333333333333336, "ram_util_percent": 90.16666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.106196403503418, "actor_loss": -5.139887809753418, "critic_loss": 3.7261672019958496, "alpha_loss": -0.08188427239656448, "alpha_value": 0.991930365562439, "log_alpha_value": -0.00810238253325224, "target_entropy": -6.0, "policy_t": -0.015414903871715069, "mean_q": 1.2387529611587524, "max_q": 1.521716833114624, "min_q": 1.048255205154419}, "td_error": [4.786260604858398, 4.670493125915527, 3.623887300491333, 3.2889347076416016, 5.159364700317383, 4.516408920288086, 4.773075103759766, 4.761377334594727, 3.983586311340332, 6.632315635681152, 4.5388665199279785, 6.674263954162598, 3.939821720123291, 4.878953456878662, 3.556436538696289, 2.778590202331543, 5.12486457824707, 4.4614996910095215, 3.752384901046753, 3.8479065895080566, 6.306230068206787, 3.567051887512207, 7.190093994140625, 3.195582628250122, 5.370303153991699, 4.557760238647461, 3.471391439437866, 4.489352226257324, 5.578661918640137, 4.904826641082764, 3.635593891143799, 5.225273132324219, 6.007932186126709, 2.0068113803863525, 2.8903818130493164, 5.017819404602051, 4.386663436889648, 3.1740965843200684, 6.1813578605651855, 5.063835620880127, 4.026247024536133, 3.183102607727051, 4.292655944824219, 6.279977798461914, 2.7845449447631836, 4.845974445343018, 3.7898333072662354, 5.104108810424805, 2.6002821922302246, 5.099589824676514, 3.3355824947357178, 3.402822971343994, 3.9294233322143555, 3.3197927474975586, 2.953274726867676, 4.206121444702148, 4.077774524688721, 3.5819361209869385, 5.015437602996826, 5.316941261291504, 4.60744571685791, 4.070950508117676, 4.872572898864746, 4.706777572631836, 4.2760009765625, 4.383110523223877, 4.105476379394531, 5.164770603179932, 4.858787536621094, 4.888105392456055, 4.051179885864258, 4.524082183837891, 4.238417625427246, 4.435074806213379, 3.407595634460449, 3.6912097930908203, 4.757412433624268, 5.155506610870361, 4.785639762878418, 5.24161434173584, 5.323427677154541, 4.132665634155273, 4.123083114624023, 2.807065963745117, 3.5839273929595947, 3.1205105781555176], "mean_td_error": 4.377071857452393, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 28.0, "diff_num_grad_updates_vs_sampler_policy": 27.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.127195358276367, "actor_loss": -5.070728778839111, "critic_loss": 0.9826350212097168, "alpha_loss": -0.08209344744682312, "alpha_value": 0.9919265508651733, "log_alpha_value": -0.008106237277388573, "target_entropy": -6.0, "policy_t": -0.023194273933768272, "mean_q": 1.0272610187530518, "max_q": 1.2293778657913208, "min_q": 0.830710232257843}, "td_error": [2.311596155166626, 3.2845306396484375, 0.8846019506454468, 2.5687649250030518, 4.1949143409729, 2.493718147277832, 4.021459102630615, 0.7987424731254578, 2.6720192432403564, 1.8602714538574219, 2.0958642959594727, 3.4166946411132812, 4.437387466430664, 1.982395887374878, 4.111322402954102, 1.9241461753845215, 3.463475465774536, 2.90871000289917, 2.9209342002868652, 4.461603164672852, 3.419839859008789, 2.492234230041504, 4.115546703338623, 3.2791385650634766, 3.833035945892334, 3.6218671798706055, 1.7899150848388672, 2.2098989486694336, 4.6056013107299805, 2.039039134979248, 2.1547365188598633, 3.9469029903411865, 2.789032459259033, 3.8549554347991943, 2.926187038421631, 2.0833826065063477, 1.6791579723358154, 2.102003574371338, 2.624338150024414, 2.769320487976074, 3.1563620567321777, 3.079880714416504, 2.2585606575012207, 1.3156659603118896, 2.670966863632202, 3.0443809032440186, 1.760542392730713, 3.3528308868408203, 2.1318094730377197, 2.6789653301239014, 2.9067881107330322, 2.9297797679901123, 1.8796812295913696, 2.393150806427002, 4.423732757568359, 0.07944715023040771, 2.963566780090332, 3.48842453956604, 2.325291156768799, 0.8841171860694885, 3.238934278488159, 2.565378427505493, 1.4753179550170898, 0.9451356530189514, 3.3512344360351562, 2.4407758712768555, 2.6597232818603516, 2.265402317047119, 2.48751163482666, 3.83604097366333, 3.052225112915039, 3.267838478088379, 1.7966969013214111, 3.3837602138519287, 1.7899386882781982, 1.3321768045425415, 2.5835838317871094, 1.4364120960235596, 2.958235502243042, 1.3878570795059204, 4.5043134689331055, 4.150753021240234, 1.689342737197876, 2.9615583419799805, 3.248727798461914, 3.5913920402526855], "mean_td_error": 2.712482452392578, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 28.0, "diff_num_grad_updates_vs_sampler_policy": 27.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.106698989868164, "actor_loss": -5.12213134765625, "critic_loss": 1.2684129476547241, "alpha_loss": -0.08189402520656586, "alpha_value": 0.9919297695159912, "log_alpha_value": -0.008102945052087307, "target_entropy": -6.0, "policy_t": 0.006569514982402325, "mean_q": 1.0726795196533203, "max_q": 1.3242546319961548, "min_q": 0.8972338438034058}, "td_error": [2.806048631668091, 2.507007598876953, 2.036571502685547, 1.5041875839233398, 3.4279661178588867, 3.0919830799102783, 3.1786556243896484, 4.067806243896484, 2.314332962036133, 2.68804931640625, 1.6556408405303955, 1.8566601276397705, 2.987201452255249, 2.8276147842407227, 2.8612475395202637, 4.134274482727051, 3.4223361015319824, 2.5228216648101807, 4.62050724029541, 0.4608410596847534, 3.838956117630005, 1.9828224182128906, 2.1990506649017334, 3.779026985168457, 0.5308880805969238, 2.556267023086548, 2.1079955101013184, 1.8688985109329224, 0.42512047290802, 2.518242359161377, 0.6020013689994812, 1.732187032699585, 1.7453696727752686, 3.186919927597046, 1.3559761047363281, 2.2313034534454346, 3.4522323608398438, 2.5806593894958496, 2.6699419021606445, 3.42960524559021, 3.074761390686035, 1.845836877822876, 3.1366095542907715, 2.142202138900757, 4.665051460266113, 1.8269977569580078, 2.956947088241577, 5.218900203704834, 3.0647828578948975, 3.0959835052490234, 1.402925968170166, 4.798685073852539, 1.8757781982421875, 2.7238237857818604, 0.36243927478790283, 2.635140895843506, 3.4844231605529785, 1.4058539867401123, 2.9079153537750244, 3.0248329639434814, 3.195831060409546, 3.393218517303467, 3.6116018295288086, 1.646986961364746, 2.878295421600342, 1.903768539428711, 1.6961133480072021, 2.6658637523651123, 3.9019479751586914, 2.6156654357910156, 1.119105339050293, 5.02113676071167, 3.1953928470611572, 4.385985374450684, 2.7265284061431885, 2.7327027320861816, 3.45717716217041, 3.0129709243774414, 3.641819715499878, 1.842565655708313, 0.3839982748031616, 1.3818135261535645, 1.810086727142334, 1.4948346614837646, 3.239205837249756, 3.8466708660125732], "mean_td_error": 2.6304233074188232, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 28.0, "diff_num_grad_updates_vs_sampler_policy": 27.0}}, "num_env_steps_sampled": 25984, "num_env_steps_trained": 7224, "num_agent_steps_sampled": 77952, "num_agent_steps_trained": 7224, "last_target_update_ts": 25984, "num_target_updates": 28}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 77952, "num_agent_steps_trained": 7224, "num_env_steps_sampled": 25984, "num_env_steps_trained": 7224, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 534.8784134985161, "num_env_steps_trained_throughput_per_sec": 154.0163288868495, "timesteps_total": 25984, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 77952, "timers": {"training_iteration_time_ms": 1716.667, "sample_time_ms": 1145.522, "load_time_ms": 0.526, "load_throughput": 490539.634, "learn_time_ms": 62.84, "learn_throughput": 4105.686, "synch_weights_time_ms": 15.461}, "counters": {"num_env_steps_sampled": 25984, "num_env_steps_trained": 7224, "num_agent_steps_sampled": 77952, "num_agent_steps_trained": 7224, "last_target_update_ts": 25984, "num_target_updates": 28}, "done": false, "episodes_total": 0, "training_iteration": 29, "trial_id": "9a806_00000", "date": "2023-11-16_21-54-30", "timestamp": 1700200470, "time_this_iter_s": 1.6897871494293213, "time_total_s": 51.994879484176636, "pid": 45784, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fadd04f4f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 51.994879484176636, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 57.73333333333333, "ram_util_percent": 90.23333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.108972549438477, "actor_loss": -5.219512939453125, "critic_loss": 3.4922537803649902, "alpha_loss": -0.08494055271148682, "alpha_value": 0.9916326999664307, "log_alpha_value": -0.008402490988373756, "target_entropy": -6.0, "policy_t": 0.07023929059505463, "mean_q": 1.336935043334961, "max_q": 1.6178228855133057, "min_q": 1.1122127771377563}, "td_error": [3.74800968170166, 4.004033088684082, 2.4385416507720947, 3.7623825073242188, 3.8909683227539062, 3.9023351669311523, 5.1046552658081055, 3.992831230163574, 4.461061477661133, 4.112458229064941, 3.0305542945861816, 4.929790019989014, 4.7825822830200195, 1.7374876737594604, 4.855768203735352, 6.438658714294434, 4.1515913009643555, 4.2060112953186035, 6.184093475341797, 4.9870758056640625, 5.488287448883057, 4.850638389587402, 3.3790276050567627, 3.6499290466308594, 1.0297651290893555, 4.811195373535156, 5.89195442199707, 2.494675397872925, 4.496126174926758, 4.293361663818359, 4.944454669952393, 4.861374855041504, 5.414770126342773, 4.204361438751221, 4.882789611816406, 4.262969017028809, 5.700404167175293, 3.83469820022583, 3.950984477996826, 5.258896827697754, 5.090476989746094, 4.001623153686523, 5.331052780151367, 3.759084939956665, 5.473708152770996, 3.407137155532837, 4.239473342895508, 6.2453813552856445, 4.1501007080078125, 4.009598731994629, 4.693663597106934, 6.043435096740723, 4.911542892456055, 4.317272186279297, 4.768653869628906, 4.136233329772949, 3.0322585105895996, 3.4344964027404785, 1.9988287687301636, 3.7158620357513428, 4.791996955871582, 5.527201175689697, 5.149563789367676, 2.9319934844970703, 4.979959964752197, 4.539604663848877, 5.182772159576416, 4.3714752197265625, 1.4750502109527588, 2.6523032188415527, 4.320117950439453, 3.4009928703308105, 4.220075607299805, 3.335991382598877, 2.6568872928619385, 4.368751525878906, 4.628157615661621, 4.695901870727539, 2.82291316986084, 5.291868686676025, 2.218632221221924, 4.366180896759033, 3.151052236557007, 5.164316654205322, 5.764596462249756, 4.668937683105469], "mean_td_error": 4.254170894622803, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 29.0, "diff_num_grad_updates_vs_sampler_policy": 28.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.079086303710938, "actor_loss": -5.116706848144531, "critic_loss": 0.9492037296295166, "alpha_loss": -0.08472926914691925, "alpha_value": 0.9916287660598755, "log_alpha_value": -0.008406443521380424, "target_entropy": -6.0, "policy_t": -0.009226510301232338, "mean_q": 1.1190340518951416, "max_q": 1.34833824634552, "min_q": 0.9739856719970703}, "td_error": [1.2532544136047363, 3.3335886001586914, 3.608755111694336, 2.5928397178649902, 3.27767276763916, 3.0772252082824707, 3.0063021183013916, 4.0000410079956055, 0.30894047021865845, 2.428414821624756, 1.735388994216919, 3.1726293563842773, 2.7250747680664062, 2.2702183723449707, 3.321707010269165, 2.463593006134033, 4.35524845123291, 2.5479326248168945, 5.034605979919434, 2.558056354522705, 1.1909414529800415, 3.7889623641967773, 4.660984039306641, 2.2793474197387695, 2.9927802085876465, 3.056870937347412, 2.9346084594726562, 2.5811543464660645, 1.6041245460510254, 1.9384980201721191, 2.257258415222168, 0.3254612386226654, 2.5284810066223145, 3.0165746212005615, 4.271885395050049, 3.421955108642578, 3.1469671726226807, 2.7325801849365234, 2.8034849166870117, 2.772618532180786, 2.4064438343048096, 2.201429605484009, 1.8368370532989502, 1.2749826908111572, 3.565791606903076, 1.8934085369110107, 1.3471708297729492, 1.2618231773376465, 2.580298900604248, 5.085821151733398, 4.463188171386719, 1.801795482635498, 4.3061418533325195, 2.3418354988098145, 2.676877737045288, 1.8719511032104492, 4.527497291564941, 1.746556282043457, 1.5336949825286865, 1.7322072982788086, 3.2002055644989014, 2.52955961227417, 1.052398920059204, 2.8819189071655273, 1.871903419494629, 3.5662691593170166, 3.341517925262451, 1.9656774997711182, 3.2760987281799316, 3.886284828186035, 3.530191421508789, 1.0585300922393799, 2.1038739681243896, 2.227496862411499, 1.9172563552856445, 2.4046683311462402, 2.628932476043701, 2.5586800575256348, 0.516393780708313, 2.835982084274292, 0.8503288626670837, 1.002119779586792, 4.04397439956665, 3.5886878967285156, 2.437628984451294, 3.386590003967285], "mean_td_error": 2.633673906326294, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 29.0, "diff_num_grad_updates_vs_sampler_policy": 28.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.159902572631836, "actor_loss": -5.256490230560303, "critic_loss": 1.3061403036117554, "alpha_loss": -0.08537469059228897, "alpha_value": 0.9916321039199829, "log_alpha_value": -0.00840310100466013, "target_entropy": -6.0, "policy_t": -0.0382155179977417, "mean_q": 1.1672359704971313, "max_q": 1.3658409118652344, "min_q": 1.0187126398086548}, "td_error": [3.553889274597168, 3.4439451694488525, 3.218170642852783, 0.9143909811973572, 2.7857024669647217, 3.598906993865967, 0.2849169373512268, 1.2880496978759766, 2.6082117557525635, 1.9481449127197266, 3.0051703453063965, 4.09989070892334, 1.3208531141281128, 3.1624293327331543, 2.4571328163146973, 2.413235902786255, 3.564155340194702, 3.5916695594787598, 3.4261629581451416, 2.032956600189209, 2.954622745513916, 3.371161937713623, 1.2329384088516235, 2.3615646362304688, 4.1125874519348145, 1.6588518619537354, 3.126600742340088, 3.036978006362915, 2.984919548034668, 2.7900218963623047, 2.8792691230773926, 3.043128490447998, 1.6607508659362793, 5.017263412475586, 2.5632195472717285, 2.017897605895996, 1.0673701763153076, 2.89644193649292, 1.8522861003875732, 2.0707244873046875, 1.7935092449188232, 3.0097594261169434, 3.5502936840057373, 3.1340887546539307, 2.5673880577087402, 1.7252538204193115, 3.089308977127075, 4.146923065185547, 1.9425066709518433, 1.4545373916625977, 2.909012794494629, 1.274998426437378, 2.9805774688720703, 3.9727070331573486, 1.7408089637756348, 1.4073126316070557, 2.5691795349121094, 1.1428470611572266, 3.0262646675109863, 2.5604519844055176, 2.62039852142334, 1.7510133981704712, 2.904036045074463, 2.5895748138427734, 3.789855480194092, 3.591059923171997, 2.998518466949463, 4.640337944030762, 4.096247673034668, 2.4063262939453125, 1.2660765647888184, 2.825733184814453, 2.2979965209960938, 2.346494436264038, 3.2009992599487305, 1.8438334465026855, 1.663358211517334, 3.1897330284118652, 2.90529727935791, 2.4356443881988525, 2.108726978302002, 2.356173038482666, 2.5686678886413574, 2.1850929260253906, 2.0838820934295654, 4.905644416809082], "mean_td_error": 2.6393609046936035, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 29.0, "diff_num_grad_updates_vs_sampler_policy": 28.0}}, "num_env_steps_sampled": 26880, "num_env_steps_trained": 7482, "num_agent_steps_sampled": 80640, "num_agent_steps_trained": 7482, "last_target_update_ts": 26880, "num_target_updates": 29}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80640, "num_agent_steps_trained": 7482, "num_env_steps_sampled": 26880, "num_env_steps_trained": 7482, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 451.2174073722327, "num_env_steps_trained_throughput_per_sec": 129.92644096209378, "timesteps_total": 26880, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 80640, "timers": {"training_iteration_time_ms": 1757.743, "sample_time_ms": 1184.296, "load_time_ms": 0.524, "load_throughput": 491922.189, "learn_time_ms": 62.731, "learn_throughput": 4112.786, "synch_weights_time_ms": 16.221}, "counters": {"num_env_steps_sampled": 26880, "num_env_steps_trained": 7482, "num_agent_steps_sampled": 80640, "num_agent_steps_trained": 7482, "last_target_update_ts": 26880, "num_target_updates": 29}, "done": false, "episodes_total": 0, "training_iteration": 30, "trial_id": "9a806_00000", "date": "2023-11-16_21-54-32", "timestamp": 1700200472, "time_this_iter_s": 2.002082586288452, "time_total_s": 53.99696207046509, "pid": 45784, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fadc09cd4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 53.99696207046509, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 67.63333333333334, "ram_util_percent": 90.26666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.075554847717285, "actor_loss": -5.292140960693359, "critic_loss": 3.56672739982605, "alpha_loss": -0.08768387883901596, "alpha_value": 0.9913350939750671, "log_alpha_value": -0.008702634833753109, "target_entropy": -6.0, "policy_t": -0.017793940380215645, "mean_q": 1.4582182168960571, "max_q": 1.753026008605957, "min_q": 1.2065865993499756}, "td_error": [3.481722116470337, 3.247967004776001, 5.3564043045043945, 5.4843010902404785, 4.076469898223877, 3.423290252685547, 4.013322353363037, 4.07964563369751, 5.702968597412109, 4.864849090576172, 2.779714584350586, 4.790649890899658, 2.651688575744629, 2.705745220184326, 4.099834442138672, 3.2558813095092773, 4.950887203216553, 3.8166756629943848, 2.4367103576660156, 4.684530735015869, 4.454954147338867, 5.2263994216918945, 2.1128222942352295, 4.016334533691406, 4.3831682205200195, 5.245868682861328, 5.534916877746582, 1.6586050987243652, 5.8781046867370605, 5.2547197341918945, 4.505870342254639, 5.992383003234863, 4.440669059753418, 3.7804808616638184, 3.440182685852051, 3.5188169479370117, 2.436124324798584, 4.091954231262207, 3.201735019683838, 3.531633138656616, 4.2252092361450195, 3.0546932220458984, 4.635363578796387, 3.0893707275390625, 6.930332183837891, 3.3671436309814453, 2.4287869930267334, 4.658653259277344, 3.9073917865753174, 3.5068976879119873, 6.121920585632324, 3.624244213104248, 5.677918434143066, 5.440786838531494, 3.016385078430176, 4.593736171722412, 5.937326431274414, 3.757716417312622, 3.3374814987182617, 4.7343549728393555, 5.338974952697754, 3.5399985313415527, 3.8018975257873535, 2.9488413333892822, 4.925999641418457, 3.8211145401000977, 1.8165090084075928, 5.149390697479248, 5.215651035308838, 4.562918663024902, 4.521603107452393, 4.7189459800720215, 5.305562973022461, 4.802377223968506, 4.617634296417236, 5.236291885375977, 4.197282791137695, 6.295254707336426, 5.227025985717773, 3.311119318008423, 2.8772552013397217, 3.8849105834960938, 2.8672289848327637, 3.7595901489257812, 4.789115905761719, 4.334214210510254], "mean_td_error": 4.192110061645508, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 30.0, "diff_num_grad_updates_vs_sampler_policy": 29.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.128780364990234, "actor_loss": -5.2575554847717285, "critic_loss": 0.8619161248207092, "alpha_loss": -0.08818735182285309, "alpha_value": 0.991331160068512, "log_alpha_value": -0.008706611581146717, "target_entropy": -6.0, "policy_t": 0.0579848475754261, "mean_q": 1.210959553718567, "max_q": 1.436669945716858, "min_q": 1.0373140573501587}, "td_error": [2.57149076461792, 2.477203369140625, 1.9667847156524658, 1.5199074745178223, 0.2316427230834961, 3.01139497756958, 2.384643077850342, 2.3114004135131836, 2.393993377685547, 1.5540766716003418, 3.458277702331543, 1.4259912967681885, 2.101388931274414, 4.127720832824707, 1.6495656967163086, 2.700772523880005, 1.888296127319336, 2.73793888092041, 2.155241012573242, 2.1116247177124023, 0.8300682902336121, 1.6396931409835815, 2.483743190765381, 2.823213577270508, 2.5366735458374023, 2.058347463607788, 2.56058931350708, 0.8678315877914429, 2.562872886657715, 3.7650718688964844, 2.2352492809295654, 1.4445898532867432, 0.4754197597503662, 0.5684118866920471, 4.695374965667725, 1.4979748725891113, 2.2023696899414062, 3.207392692565918, 3.618218183517456, 3.301596164703369, 1.7513070106506348, 3.341561794281006, 1.4486420154571533, 2.74947190284729, 0.7692111134529114, 2.2841126918792725, 4.270893096923828, 2.7528202533721924, 1.1967837810516357, 3.090416431427002, 2.7675890922546387, 2.6771697998046875, 2.4716272354125977, 2.049011707305908, 3.3277759552001953, 3.1713593006134033, 3.1655869483947754, 2.3380117416381836, 4.26995849609375, 1.5403153896331787, 3.2133588790893555, 0.9408606290817261, 2.2151718139648438, 3.8156957626342773, 3.45377779006958, 2.6125130653381348, 3.6904258728027344, 1.8750158548355103, 1.592897653579712, 3.985990047454834, 2.4193711280822754, 2.443685531616211, 2.910008192062378, 1.1530715227127075, 2.856172561645508, 2.57865571975708, 3.5294668674468994, 2.7525861263275146, 3.033158779144287, 0.41337883472442627, 2.9852828979492188, 2.613137722015381, 3.461832284927368, 1.574400782585144, 1.1921939849853516, 2.243626832962036], "mean_td_error": 2.408644437789917, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 30.0, "diff_num_grad_updates_vs_sampler_policy": 29.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.072150230407715, "actor_loss": -5.264887809753418, "critic_loss": 1.181253433227539, "alpha_loss": -0.0876617282629013, "alpha_value": 0.9913343787193298, "log_alpha_value": -0.008703377097845078, "target_entropy": -6.0, "policy_t": 0.029949836432933807, "mean_q": 1.268216609954834, "max_q": 1.498070478439331, "min_q": 1.0641729831695557}, "td_error": [1.761426329612732, 2.8000988960266113, 1.2198574542999268, 3.3076331615448, 2.511009693145752, 3.547957420349121, 3.6790661811828613, 1.3738481998443604, 3.4517016410827637, 2.9245505332946777, 2.0473861694335938, 2.9059605598449707, 2.491029739379883, 3.303065299987793, 1.6433000564575195, 3.083420991897583, 2.6540026664733887, 2.3457210063934326, 2.875551700592041, 0.8741475343704224, 0.8711258769035339, 1.8779470920562744, 0.9860971570014954, 2.3791565895080566, 3.2373037338256836, 2.661898612976074, 2.02126407623291, 0.5874586701393127, 2.6204004287719727, 2.10422945022583, 3.352250576019287, 2.116239547729492, 3.399277687072754, 2.185312032699585, 1.2837719917297363, 3.203660249710083, 2.8338303565979004, 2.306107997894287, 3.5592103004455566, 3.011474609375, 3.6338772773742676, 1.156762957572937, 2.5456666946411133, 2.2338061332702637, 3.0136218070983887, 2.475144863128662, 1.6548535823822021, 0.08119714260101318, 3.2479920387268066, 2.018247365951538, 4.133534908294678, 2.61822509765625, 2.147324562072754, 2.4322099685668945, 1.3817007541656494, 1.960439920425415, 3.0291507244110107, 3.560206890106201, 2.7127625942230225, 3.201608180999756, 3.7803127765655518, 3.9149341583251953, 1.6499779224395752, 2.762533664703369, 2.879027843475342, 1.9974756240844727, 2.5913586616516113, 1.9723401069641113, 2.0820655822753906, 2.924053430557251, 2.2162210941314697, 2.1294636726379395, 1.5813038349151611, 2.110858201980591, 1.2152400016784668, 0.005525410175323486, 2.182319164276123, 3.8406810760498047, 2.2697830200195312, 4.068636894226074, 2.409365177154541, 1.4705603122711182, 2.704902172088623, 3.401063919067383, 3.4943556785583496, 1.0776087045669556], "mean_td_error": 2.434523820877075, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 30.0, "diff_num_grad_updates_vs_sampler_policy": 29.0}}, "num_env_steps_sampled": 27776, "num_env_steps_trained": 7740, "num_agent_steps_sampled": 83328, "num_agent_steps_trained": 7740, "last_target_update_ts": 27776, "num_target_updates": 30}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 83328, "num_agent_steps_trained": 7740, "num_env_steps_sampled": 27776, "num_env_steps_trained": 7740, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 502.3060823456103, "num_env_steps_trained_throughput_per_sec": 144.6372424611244, "timesteps_total": 27776, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 83328, "timers": {"training_iteration_time_ms": 1765.003, "sample_time_ms": 1192.97, "load_time_ms": 0.523, "load_throughput": 493717.69, "learn_time_ms": 62.772, "learn_throughput": 4110.12, "synch_weights_time_ms": 16.485}, "counters": {"num_env_steps_sampled": 27776, "num_env_steps_trained": 7740, "num_agent_steps_sampled": 83328, "num_agent_steps_trained": 7740, "last_target_update_ts": 27776, "num_target_updates": 30}, "done": false, "episodes_total": 0, "training_iteration": 31, "trial_id": "9a806_00000", "date": "2023-11-16_21-54-34", "timestamp": 1700200474, "time_this_iter_s": 1.7978050708770752, "time_total_s": 55.79476714134216, "pid": 45784, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fadd04f4f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 55.79476714134216, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 79.85, "ram_util_percent": 90.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.052824974060059, "actor_loss": -5.386744499206543, "critic_loss": 3.441621780395508, "alpha_loss": -0.09050296247005463, "alpha_value": 0.9910376667976379, "log_alpha_value": -0.009002738632261753, "target_entropy": -6.0, "policy_t": 0.003453363198786974, "mean_q": 1.5805062055587769, "max_q": 1.8142648935317993, "min_q": 1.328473687171936}, "td_error": [4.394090175628662, 5.808628082275391, 4.6659955978393555, 4.785027503967285, 6.358013153076172, 2.4767067432403564, 6.192631721496582, 3.9854512214660645, 5.067546844482422, 4.704507350921631, 4.550737380981445, 4.504211902618408, 4.340029716491699, 4.318635940551758, 5.0199384689331055, 4.8826775550842285, 5.523099899291992, 5.365530967712402, 3.597750186920166, 2.6801366806030273, 3.9785447120666504, 3.8361103534698486, 4.256936073303223, 5.365739822387695, 3.451298236846924, 3.7087607383728027, 5.175663948059082, 3.962053060531616, 3.89254093170166, 4.827613830566406, 5.22489070892334, 3.2359237670898438, 5.4259843826293945, 5.252072811126709, 6.433562278747559, 3.0461366176605225, 3.59043550491333, 3.3485288619995117, 5.332196235656738, 2.1579580307006836, 3.070756435394287, 3.287036180496216, 1.810614824295044, 3.011423110961914, 5.325213432312012, 3.7918829917907715, 3.701784133911133, 5.109136581420898, 4.951963424682617, 5.633519649505615, 2.4527535438537598, 5.415366172790527, 5.448116302490234, 5.646302223205566, 4.055523872375488, 4.323153018951416, 5.004267692565918, 4.311760902404785, 3.768764019012451, 5.396673679351807, 5.218541145324707, 4.148379802703857, 4.819921970367432, 4.855542182922363, 5.134973526000977, 1.3221732378005981, 3.802133798599243, 4.685081481933594, 3.9396259784698486, 3.0097670555114746, 3.781581163406372, 3.827906847000122, 4.14314079284668, 5.190865516662598, 6.646097183227539, 6.007212162017822, 4.770780563354492, 3.3604865074157715, 3.810650110244751, 2.4499053955078125, 2.5761218070983887, 4.81933069229126, 4.65888786315918, 3.2342801094055176, 3.340794086456299, 3.7153115272521973], "mean_td_error": 4.319881439208984, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 31.0, "diff_num_grad_updates_vs_sampler_policy": 30.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.108150482177734, "actor_loss": -5.34765625, "critic_loss": 0.8949697017669678, "alpha_loss": -0.09104258567094803, "alpha_value": 0.9910336136817932, "log_alpha_value": -0.009006849490106106, "target_entropy": -6.0, "policy_t": -0.018036363646388054, "mean_q": 1.3136756420135498, "max_q": 1.6080971956253052, "min_q": 1.068577766418457}, "td_error": [2.257059097290039, 2.974698066711426, 3.4010825157165527, 3.4729177951812744, 2.7589564323425293, 1.9677720069885254, 1.748740315437317, 0.06708544492721558, 2.6909563541412354, 2.881417989730835, 1.286576271057129, 1.4318757057189941, 4.762825965881348, 2.9631757736206055, 2.975100040435791, 0.778720498085022, 3.122603416442871, 2.2842631340026855, 3.389155864715576, 2.2637200355529785, 1.6451531648635864, 2.26776123046875, 0.2619684338569641, 3.08404803276062, 2.8724255561828613, 2.9610419273376465, 2.5493009090423584, 1.1525787115097046, 2.711120128631592, 2.573697328567505, 2.281712055206299, 2.1435327529907227, 4.151636123657227, 2.448317050933838, 1.9983365535736084, 1.9763951301574707, 3.752871513366699, 4.48734712600708, 1.6594794988632202, 2.2407217025756836, 0.4816981554031372, 3.574836492538452, 2.3957409858703613, 2.7074291706085205, 1.5169720649719238, 2.755499839782715, 2.6620140075683594, 3.649840831756592, 4.459188461303711, 2.1091957092285156, 2.8615541458129883, 1.3552148342132568, 2.4599452018737793, 1.7612500190734863, 0.758444607257843, 3.1445155143737793, 0.6323577761650085, 1.4280166625976562, 3.280148983001709, 3.244311809539795, 2.0230019092559814, 2.4920268058776855, 5.186280250549316, 2.693848133087158, 1.018688440322876, 3.3767354488372803, 1.9321153163909912, 2.5697007179260254, 2.2084150314331055, 2.7428908348083496, 2.9900920391082764, 2.7456178665161133, 3.3603014945983887, 2.143524646759033, 2.2990429401397705, 2.298631191253662, 3.1141204833984375, 1.8696134090423584, 3.2948098182678223, 2.8623340129852295, 3.53371262550354, 2.845139741897583, 1.8442769050598145, 2.201963424682617, 3.8168301582336426, 3.0508995056152344], "mean_td_error": 2.516871452331543, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 31.0, "diff_num_grad_updates_vs_sampler_policy": 30.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.131486892700195, "actor_loss": -5.412799835205078, "critic_loss": 0.5370944142341614, "alpha_loss": -0.09121958166360855, "alpha_value": 0.9910368323326111, "log_alpha_value": -0.009003573097288609, "target_entropy": -6.0, "policy_t": -0.0446140319108963, "mean_q": 1.348626732826233, "max_q": 1.6375863552093506, "min_q": 1.174298644065857}, "td_error": [3.893362522125244, 1.4783129692077637, 1.9096589088439941, 2.611968517303467, 1.5398428440093994, 3.152629852294922, 3.7638533115386963, 0.12431073188781738, 1.5520133972167969, 2.1848278045654297, 3.3585822582244873, 3.443851947784424, 3.1691105365753174, 1.7693867683410645, 1.6860203742980957, 2.0485575199127197, 2.1639697551727295, 3.152766704559326, 2.3750269412994385, 2.5442774295806885, 2.715385675430298, 2.1925063133239746, 1.9473097324371338, 2.7588095664978027, 1.5918095111846924, 4.29195499420166, 1.2575609683990479, 1.7449382543563843, 1.509151816368103, 1.2302417755126953, 3.550079822540283, 2.1866064071655273, 1.1903152465820312, 4.482028007507324, 4.11014461517334, 2.6776576042175293, 1.641841173171997, 2.0225472450256348, 3.366034984588623, 1.4738073348999023, 1.8990273475646973, 1.9478816986083984, 1.9432200193405151, 2.525712490081787, 2.456038236618042, 2.807119369506836, 2.9098267555236816, 1.1288645267486572, 1.1921253204345703, 3.267101764678955, 2.6139354705810547, 1.5015276670455933, 1.8540582656860352, 1.3206753730773926, 2.4388763904571533, 3.297067642211914, 1.6703898906707764, 2.2167863845825195, 2.5395255088806152, 1.3627517223358154, 2.8509035110473633, 1.5903489589691162, 1.8943333625793457, 3.427591323852539, 0.4052208662033081, 5.182978630065918, 2.9931373596191406, 0.8684870600700378, 3.559051036834717, 2.229255199432373, 1.813918113708496, 3.3500518798828125, 3.2495954036712646, 2.4662108421325684, 4.110584259033203, 1.3058512210845947, 1.6712534427642822, 2.436232328414917, 2.7015912532806396, 2.5171172618865967, 3.1197543144226074, 3.522430419921875, 2.931880474090576, 4.64769983291626, 1.668424129486084, 1.9159499406814575], "mean_td_error": 2.409132957458496, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 31.0, "diff_num_grad_updates_vs_sampler_policy": 30.0}}, "num_env_steps_sampled": 28672, "num_env_steps_trained": 7998, "num_agent_steps_sampled": 86016, "num_agent_steps_trained": 7998, "last_target_update_ts": 28672, "num_target_updates": 31}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 86016, "num_agent_steps_trained": 7998, "num_env_steps_sampled": 28672, "num_env_steps_trained": 7998, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 537.0047796200624, "num_env_steps_trained_throughput_per_sec": 154.62860841738404, "timesteps_total": 28672, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 86016, "timers": {"training_iteration_time_ms": 1771.845, "sample_time_ms": 1198.637, "load_time_ms": 0.532, "load_throughput": 484977.561, "learn_time_ms": 63.173, "learn_throughput": 4084.03, "synch_weights_time_ms": 17.681}, "counters": {"num_env_steps_sampled": 28672, "num_env_steps_trained": 7998, "num_agent_steps_sampled": 86016, "num_agent_steps_trained": 7998, "last_target_update_ts": 28672, "num_target_updates": 31}, "done": false, "episodes_total": 0, "training_iteration": 32, "trial_id": "9a806_00000", "date": "2023-11-16_21-54-35", "timestamp": 1700200475, "time_this_iter_s": 1.6957919597625732, "time_total_s": 57.490559101104736, "pid": 45784, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fadd0526b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 57.490559101104736, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 62.79999999999999, "ram_util_percent": 90.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.086493492126465, "actor_loss": -5.526508331298828, "critic_loss": 3.4170970916748047, "alpha_loss": -0.09383222460746765, "alpha_value": 0.9907403588294983, "log_alpha_value": -0.009302759543061256, "target_entropy": -6.0, "policy_t": -0.0503617562353611, "mean_q": 1.6794898509979248, "max_q": 2.009310722351074, "min_q": 1.4261137247085571}, "td_error": [3.329094409942627, 1.0369887351989746, 4.148077487945557, 5.039511680603027, 3.848294734954834, 3.201829195022583, 4.829106330871582, 3.542693614959717, 5.143751621246338, 4.379448413848877, 4.348371982574463, 4.627389907836914, 3.2931244373321533, 3.245450973510742, 4.572425842285156, 7.093555450439453, 4.327733993530273, 6.339056015014648, 6.487514495849609, 4.5923027992248535, 4.632786750793457, 2.98399019241333, 4.086241722106934, 3.4698586463928223, 3.4643959999084473, 3.9456233978271484, 3.526120185852051, 5.824300765991211, 4.826593399047852, 1.2604488134384155, 5.24212646484375, 3.9400854110717773, 3.592003345489502, 5.070962429046631, 2.788219451904297, 4.91217565536499, 4.540163040161133, 2.459887981414795, 4.805825710296631, 4.9951653480529785, 1.7745691537857056, 4.72334098815918, 3.8829500675201416, 1.9202723503112793, 3.5681819915771484, 3.5733747482299805, 4.314934730529785, 2.8778114318847656, 3.0892348289489746, 3.5896129608154297, 3.4558520317077637, 2.455467700958252, 3.899691581726074, 2.9661521911621094, 3.939530372619629, 5.486956596374512, 4.684420585632324, 4.456303596496582, 6.674360275268555, 5.148608207702637, 6.885949611663818, 3.7876434326171875, 3.123624324798584, 5.510004997253418, 4.567773818969727, 2.681497573852539, 3.8956613540649414, 4.588048934936523, 2.4051945209503174, 4.804319858551025, 5.631311893463135, 5.057041168212891, 3.794257879257202, 5.722831726074219, 4.517230033874512, 2.35943603515625, 0.7732553482055664, 3.4967615604400635, 3.038133144378662, 4.850412845611572, 5.550713539123535, 6.084323883056641, 4.34791898727417, 3.129281997680664, 4.804461479187012, 5.940210342407227], "mean_td_error": 4.135135173797607, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 32.0, "diff_num_grad_updates_vs_sampler_policy": 31.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.132965087890625, "actor_loss": -5.4455156326293945, "critic_loss": 0.7761663198471069, "alpha_loss": -0.09430857747793198, "alpha_value": 0.9907360672950745, "log_alpha_value": -0.009307104162871838, "target_entropy": -6.0, "policy_t": -0.014685721136629581, "mean_q": 1.4235317707061768, "max_q": 1.754486322402954, "min_q": 1.1701523065567017}, "td_error": [2.7249937057495117, 2.6488137245178223, 1.7033050060272217, 4.128569602966309, 2.8480494022369385, 2.1869349479675293, 1.5866178274154663, 0.8560370206832886, 1.5323829650878906, 0.3123062252998352, 1.187558889389038, 1.8982155323028564, 2.88417911529541, 3.063870906829834, 1.4948304891586304, 1.874786138534546, 1.9166014194488525, 3.641639471054077, 3.033869981765747, 1.826582431793213, 2.912126302719116, 1.6549649238586426, 2.2328081130981445, 2.9073314666748047, 2.8298752307891846, 1.2557148933410645, 2.0095643997192383, 1.3520619869232178, 1.9100468158721924, 1.2994849681854248, 1.4940741062164307, 1.7309309244155884, 2.5796046257019043, 3.0097155570983887, 2.1744272708892822, 1.2266507148742676, 1.902575969696045, 2.3405838012695312, 2.5596680641174316, 3.9705700874328613, 2.773409605026245, 1.7237937450408936, 1.270826816558838, 3.1456971168518066, 2.0298407077789307, 3.0452287197113037, 1.0589892864227295, 2.7039871215820312, 2.2303853034973145, 2.0080947875976562, 2.41814923286438, 0.7674902677536011, 2.932940721511841, 2.432586669921875, 1.768786907196045, 2.4107422828674316, 2.317739725112915, 2.0005745887756348, 1.7357499599456787, 3.9525296688079834, 1.563814640045166, 3.658747911453247, 0.3883857727050781, 1.7314412593841553, 2.276015281677246, 2.433840036392212, 2.7598466873168945, 0.2565893530845642, 2.711202383041382, 1.490140676498413, 4.960033416748047, 2.3439130783081055, 1.5312988758087158, 2.962529420852661, 2.827681541442871, 3.2621660232543945, 1.5571138858795166, 3.918792486190796, 3.2388453483581543, 3.1309447288513184, 2.594480037689209, 2.3197927474975586, 3.045579195022583, 2.0064828395843506, 1.548487663269043, 3.970211982727051], "mean_td_error": 2.2781260013580322, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 32.0, "diff_num_grad_updates_vs_sampler_policy": 31.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.144989013671875, "actor_loss": -5.511131763458252, "critic_loss": 0.5170611143112183, "alpha_loss": -0.09438718855381012, "alpha_value": 0.9907393455505371, "log_alpha_value": -0.009303824044764042, "target_entropy": -6.0, "policy_t": -0.017510073259472847, "mean_q": 1.4769703149795532, "max_q": 1.8014700412750244, "min_q": 1.2489782571792603}, "td_error": [3.260948657989502, 2.8928074836730957, 1.4665260314941406, 1.7004148960113525, 1.433060884475708, 3.591822624206543, 1.2721624374389648, 2.9483394622802734, 2.932219982147217, 2.2665209770202637, 2.0433201789855957, 1.8023035526275635, 2.4231300354003906, 2.286224842071533, 3.7464330196380615, 2.6951608657836914, 1.4091261625289917, 3.0356221199035645, 2.733396530151367, 1.6574841737747192, 2.7110414505004883, 4.195191383361816, 2.8189995288848877, 2.8056223392486572, 2.1647133827209473, 4.31163215637207, 0.7476876378059387, 0.5096966624259949, 2.0033562183380127, 2.003843069076538, 3.198557138442993, 3.0848186016082764, 4.9209136962890625, 2.2277495861053467, 4.498894214630127, 3.2088608741760254, 0.2741279602050781, 1.0250601768493652, 2.7629551887512207, 0.5098500847816467, 2.0976390838623047, 1.1397812366485596, 2.098612070083618, 2.737661838531494, 3.643190383911133, 3.5400097370147705, 2.225552558898926, 1.2252014875411987, 1.7671575546264648, 2.490325927734375, 0.212832510471344, 3.199685573577881, 1.3093271255493164, 2.132375717163086, 0.641679584980011, 2.4999260902404785, 3.362719774246216, 3.1058759689331055, 2.3138790130615234, 3.7715704441070557, 2.075201988220215, 2.220911741256714, 3.3196020126342773, 1.1650869846343994, 2.568467140197754, 1.685430645942688, 1.1844708919525146, 2.6721534729003906, 4.727866172790527, 3.2969493865966797, 1.9751429557800293, 1.46649169921875, 3.607051372528076, 2.5183053016662598, 0.047642290592193604, 3.0019092559814453, 2.0609006881713867, 1.7724597454071045, 3.356388568878174, 3.548417568206787, 2.7475643157958984, 1.734128475189209, 1.3531014919281006, 2.364292621612549, 0.9323831796646118, 2.5678577423095703], "mean_td_error": 2.36122989654541, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 32.0, "diff_num_grad_updates_vs_sampler_policy": 31.0}}, "num_env_steps_sampled": 29568, "num_env_steps_trained": 8256, "num_agent_steps_sampled": 88704, "num_agent_steps_trained": 8256, "last_target_update_ts": 29568, "num_target_updates": 32}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88704, "num_agent_steps_trained": 8256, "num_env_steps_sampled": 29568, "num_env_steps_trained": 8256, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 420.929208646502, "num_env_steps_trained_throughput_per_sec": 121.20506231115795, "timesteps_total": 29568, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 88704, "timers": {"training_iteration_time_ms": 1820.335, "sample_time_ms": 1245.768, "load_time_ms": 0.532, "load_throughput": 485173.257, "learn_time_ms": 63.193, "learn_throughput": 4082.75, "synch_weights_time_ms": 17.919}, "counters": {"num_env_steps_sampled": 29568, "num_env_steps_trained": 8256, "num_agent_steps_sampled": 88704, "num_agent_steps_trained": 8256, "last_target_update_ts": 29568, "num_target_updates": 32}, "done": false, "episodes_total": 0, "training_iteration": 33, "trial_id": "9a806_00000", "date": "2023-11-16_21-54-38", "timestamp": 1700200478, "time_this_iter_s": 2.1436657905578613, "time_total_s": 59.6342248916626, "pid": 45784, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fadd052b820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 59.6342248916626, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 77.26666666666667, "ram_util_percent": 90.46666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.139206886291504, "actor_loss": -5.652563095092773, "critic_loss": 3.0209848880767822, "alpha_loss": -0.09736456722021103, "alpha_value": 0.9904431700706482, "log_alpha_value": -0.009602779522538185, "target_entropy": -6.0, "policy_t": -0.03280367702245712, "mean_q": 1.8180243968963623, "max_q": 2.1587469577789307, "min_q": 1.5047203302383423}, "td_error": [4.787790775299072, 2.4315104484558105, 2.932363510131836, 4.012885093688965, 4.828795433044434, 4.384730339050293, 3.29221510887146, 3.059840202331543, 4.842133522033691, 3.4091086387634277, 1.8540996313095093, 4.1053466796875, 4.405850410461426, 3.6516528129577637, 4.062090873718262, 4.417553901672363, 3.046696424484253, 5.686350345611572, 3.569530725479126, 3.7218217849731445, 3.587484121322632, 3.5168185234069824, 4.492298126220703, 5.32918119430542, 2.168829917907715, 4.484618663787842, 2.612203598022461, 3.3623313903808594, 4.486730575561523, 3.243596076965332, 3.281301975250244, 3.473982334136963, 3.3542304039001465, 4.729025840759277, 5.1485137939453125, 3.989262104034424, 4.082350254058838, 4.406191825866699, 3.0904858112335205, 4.04603385925293, 4.776349067687988, 4.72156286239624, 2.751081943511963, 3.1280531883239746, 3.528844118118286, 4.45037841796875, 4.45960807800293, 3.2915422916412354, 5.507797718048096, 6.083491325378418, 3.4741873741149902, 5.262795448303223, 4.09334659576416, 3.0959906578063965, 3.6397652626037598, 3.373230218887329, 5.250202178955078, 4.209464073181152, 3.0475354194641113, 5.3680548667907715, 4.665275573730469, 4.743528842926025, 1.403146505355835, 2.0899672508239746, 2.3269972801208496, 5.660220146179199, 2.9590158462524414, 2.9489951133728027, 3.2305731773376465, 4.071669101715088, 4.920346260070801, 3.424133777618408, 4.945533752441406, 4.374086380004883, 1.8888490200042725, 3.812875986099243, 4.888311386108398, 3.799684524536133, 4.260324954986572, 4.860967636108398, 4.569469451904297, 2.226691722869873, 4.200771331787109, 3.498845100402832, 4.100262641906738, 4.789651393890381], "mean_td_error": 3.9018757343292236, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 33.0, "diff_num_grad_updates_vs_sampler_policy": 32.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.118305206298828, "actor_loss": -5.550125598907471, "critic_loss": 0.8397760391235352, "alpha_loss": -0.09721087664365768, "alpha_value": 0.9904385805130005, "log_alpha_value": -0.009607425890862942, "target_entropy": -6.0, "policy_t": 0.04084315150976181, "mean_q": 1.5464048385620117, "max_q": 1.949934959411621, "min_q": 1.242238998413086}, "td_error": [2.9299087524414062, 2.462048053741455, 3.7339062690734863, 2.7041540145874023, 2.2220816612243652, 1.3801674842834473, 3.167095184326172, 2.6934256553649902, 2.024648427963257, 2.729475975036621, 4.71413516998291, 4.156432151794434, 3.194856643676758, 1.630155324935913, 1.9886661767959595, 1.9515433311462402, 2.8071515560150146, 2.0544357299804688, 1.7963435649871826, 1.2801390886306763, 0.2318907380104065, 3.288994312286377, 2.2307167053222656, 2.006460189819336, 2.8311116695404053, 2.4293766021728516, 2.3070878982543945, 1.7148410081863403, 1.6417560577392578, 1.7081406116485596, 2.5660407543182373, 2.3016276359558105, 0.5484495162963867, 1.9378958940505981, 2.132711172103882, 1.9292364120483398, 2.6190621852874756, 0.869935154914856, 1.8010834455490112, 2.829033851623535, 1.1675300598144531, 4.029504299163818, 3.9186031818389893, 1.9863135814666748, 0.19050675630569458, 2.0535879135131836, 2.3701586723327637, 3.311037540435791, 3.14408278465271, 2.0130672454833984, 1.666245937347412, 2.1194841861724854, 0.024374961853027344, 4.262577056884766, 2.3395841121673584, 2.027553081512451, 3.40604829788208, 1.947760820388794, 3.3773767948150635, 2.5085806846618652, 2.4168105125427246, 0.6868410110473633, 3.759382724761963, 1.4124867916107178, 3.094386100769043, 3.724665641784668, 3.940255641937256, 2.614793539047241, 1.3742194175720215, 3.7271924018859863, 2.589867353439331, 1.6068751811981201, 3.322678565979004, 1.4829663038253784, 4.034112930297852, 0.4977647662162781, 4.100910186767578, 2.0302515029907227, 3.0354976654052734, 2.8808181285858154, 1.722894310951233, 1.2141928672790527, 1.6425974369049072, 1.890337347984314, 3.08921217918396, 3.152038335800171], "mean_td_error": 2.3773751258850098, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 33.0, "diff_num_grad_updates_vs_sampler_policy": 32.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.059456825256348, "actor_loss": -5.541959762573242, "critic_loss": 0.42056310176849365, "alpha_loss": -0.09661255031824112, "alpha_value": 0.9904417991638184, "log_alpha_value": -0.009604152292013168, "target_entropy": -6.0, "policy_t": 0.013594469986855984, "mean_q": 1.568792700767517, "max_q": 1.8971912860870361, "min_q": 1.331714391708374}, "td_error": [2.6092729568481445, 2.9215521812438965, 0.9852402806282043, 2.742061138153076, 1.562550663948059, 1.25455904006958, 1.9288585186004639, 1.279332160949707, 1.80720853805542, 1.4261398315429688, 2.695281505584717, 2.0849030017852783, 2.751608371734619, 1.0997635126113892, 2.4378433227539062, 3.298989772796631, 2.094726800918579, 0.9820390343666077, 3.0041847229003906, 1.5180273056030273, 3.025008201599121, 2.8897485733032227, 0.34154975414276123, 2.787602424621582, 0.23678678274154663, 3.1182327270507812, 1.438974380493164, 3.646913528442383, 1.5053768157958984, 2.1582374572753906, 0.1568886637687683, 1.1293363571166992, 2.5674901008605957, 0.3378602862358093, 1.5000066757202148, 0.5345495343208313, 2.247041702270508, 2.7415499687194824, 4.0349345207214355, 2.9542317390441895, 2.8473596572875977, 2.097358226776123, 1.9987199306488037, 0.5954874753952026, 1.9072935581207275, 1.7039227485656738, 1.4831337928771973, 2.8933892250061035, 2.6603305339813232, 1.084897756576538, 1.298447847366333, 2.9298784732818604, 1.1253552436828613, 2.652707576751709, 1.3788678646087646, 0.607977032661438, 1.3794078826904297, 1.5088248252868652, 2.033730983734131, 1.1055974960327148, 2.3722972869873047, 2.0587122440338135, 1.989583969116211, 1.1132537126541138, 3.6123275756835938, 1.7064896821975708, 1.9939892292022705, 1.8695638179779053, 2.0188260078430176, 3.8106255531311035, 2.6495394706726074, 3.822150707244873, 2.965390682220459, 2.3331077098846436, 1.0125623941421509, 3.446094274520874, 1.5111494064331055, 0.7865227460861206, 1.194173812866211, 1.9362614154815674, 1.7025096416473389, 0.2203323245048523, 3.789875030517578, 2.1244940757751465, 3.155092239379883, 0.08446258306503296], "mean_td_error": 1.981494426727295, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 33.0, "diff_num_grad_updates_vs_sampler_policy": 32.0}}, "num_env_steps_sampled": 30464, "num_env_steps_trained": 8514, "num_agent_steps_sampled": 91392, "num_agent_steps_trained": 8514, "last_target_update_ts": 30464, "num_target_updates": 33}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 91392, "num_agent_steps_trained": 8514, "num_env_steps_sampled": 30464, "num_env_steps_trained": 8514, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 535.2375962438051, "num_env_steps_trained_throughput_per_sec": 154.11975427555996, "timesteps_total": 30464, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 91392, "timers": {"training_iteration_time_ms": 1827.549, "sample_time_ms": 1253.374, "load_time_ms": 0.534, "load_throughput": 483504.058, "learn_time_ms": 63.056, "learn_throughput": 4091.612, "synch_weights_time_ms": 18.33}, "counters": {"num_env_steps_sampled": 30464, "num_env_steps_trained": 8514, "num_agent_steps_sampled": 91392, "num_agent_steps_trained": 8514, "last_target_update_ts": 30464, "num_target_updates": 33}, "done": false, "episodes_total": 0, "training_iteration": 34, "trial_id": "9a806_00000", "date": "2023-11-16_21-54-39", "timestamp": 1700200479, "time_this_iter_s": 1.6887590885162354, "time_total_s": 61.32298398017883, "pid": 45784, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fadd05268b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 61.32298398017883, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 72.75, "ram_util_percent": 90.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.110072135925293, "actor_loss": -5.742485046386719, "critic_loss": 2.9678478240966797, "alpha_loss": -0.10011916607618332, "alpha_value": 0.9901459813117981, "log_alpha_value": -0.009902913123369217, "target_entropy": -6.0, "policy_t": -0.02482939139008522, "mean_q": 1.941293716430664, "max_q": 2.181757926940918, "min_q": 1.6259071826934814}, "td_error": [4.804213523864746, 2.599876880645752, 2.9161272048950195, 3.8717195987701416, 4.226863861083984, 2.7020936012268066, 1.7493524551391602, 3.2617249488830566, 4.222511291503906, 3.0463643074035645, 3.275010347366333, 2.897468328475952, 3.1041951179504395, 5.169922828674316, 3.8184566497802734, 4.473189830780029, 4.447088241577148, 3.971308708190918, 4.406362533569336, 3.3375329971313477, 4.335915565490723, 2.461897611618042, 4.013140678405762, 2.1461892127990723, 3.842430591583252, 4.010385513305664, 3.8968100547790527, 5.65359354019165, 4.248705863952637, 4.687539577484131, 3.765477180480957, 3.3557324409484863, 1.4460827112197876, 2.3262076377868652, 2.8326454162597656, 3.7427563667297363, 4.995758533477783, 3.203411102294922, 4.188647270202637, 3.2382113933563232, 4.637822151184082, 2.8918094635009766, 2.298602342605591, 3.462296724319458, 3.861640691757202, 3.77186918258667, 5.411031723022461, 4.740617752075195, 3.843810558319092, 2.0257105827331543, 4.872761249542236, 3.8140249252319336, 2.2347183227539062, 4.0204620361328125, 4.565523147583008, 3.241018533706665, 4.306695938110352, 4.727373123168945, 5.037135601043701, 2.88853120803833, 3.643277645111084, 4.330251693725586, 4.512860298156738, 4.539162635803223, 4.425004005432129, 2.74038028717041, 4.024809837341309, 2.511903762817383, 4.808640480041504, 2.3387298583984375, 4.501743793487549, 4.350475311279297, 6.240114212036133, 3.6778039932250977, 3.3826229572296143, 3.2218544483184814, 6.034296989440918, 2.4526891708374023, 5.503098487854004, 0.6109024286270142, 4.620957851409912, 5.723104476928711, 4.917537212371826, 6.407018184661865, 2.7833170890808105, 3.146637201309204], "mean_td_error": 3.79994797706604, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 34.0, "diff_num_grad_updates_vs_sampler_policy": 33.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.093085289001465, "actor_loss": -5.629653453826904, "critic_loss": 0.6730363368988037, "alpha_loss": -0.09999999403953552, "alpha_value": 0.9901411533355713, "log_alpha_value": -0.009907773695886135, "target_entropy": -6.0, "policy_t": 0.040240902453660965, "mean_q": 1.642648696899414, "max_q": 1.9225850105285645, "min_q": 1.3817263841629028}, "td_error": [0.631178081035614, 0.2722485065460205, 2.9508519172668457, 2.950953245162964, 2.668771266937256, 1.9125330448150635, 2.1148433685302734, 1.7052521705627441, 0.6347191333770752, 3.549131155014038, 4.444009780883789, 1.480680227279663, 1.9444208145141602, 1.3070353269577026, 2.2897958755493164, 3.258463144302368, 2.65220308303833, 0.6559069752693176, 3.1132166385650635, 1.298992395401001, 2.8970158100128174, 2.096194267272949, 3.3150339126586914, 2.5761971473693848, 2.2409586906433105, 1.740199089050293, 1.5163342952728271, 1.9676920175552368, 2.147383689880371, 3.319873094558716, 2.2184839248657227, 0.9693583250045776, 0.900231659412384, 1.582756519317627, 3.1346654891967773, 3.295135736465454, 1.1433618068695068, 4.451451778411865, 3.3421013355255127, 2.641517162322998, 2.3514084815979004, 2.96024751663208, 1.408356785774231, 2.768301486968994, 1.368730902671814, 1.7791099548339844, 2.366704225540161, 2.1056504249572754, 3.2090580463409424, 1.644565463066101, 2.5064518451690674, 2.1538023948669434, 3.19473934173584, 2.2311859130859375, 2.2680625915527344, 1.40804123878479, 4.132637977600098, 2.9668774604797363, 3.8964414596557617, 2.1573824882507324, 1.5376603603363037, 2.892531394958496, 1.9946417808532715, 2.561594009399414, 2.5166306495666504, 1.6051421165466309, 2.778856039047241, 1.795151710510254, 2.615722417831421, 2.07529616355896, 0.7022709250450134, 2.5591049194335938, 2.86252498626709, 2.0379488468170166, 3.2237656116485596, 3.0888376235961914, 1.9494316577911377, 0.47440826892852783, 1.7721037864685059, 1.33951735496521, 1.9963867664337158, 1.5187609195709229, 1.3905138969421387, 2.302229881286621, 0.4059068560600281, 0.35460054874420166], "mean_td_error": 2.192563056945801, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 34.0, "diff_num_grad_updates_vs_sampler_policy": 33.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.102591514587402, "actor_loss": -5.689984321594238, "critic_loss": 0.44200408458709717, "alpha_loss": -0.10005974024534225, "alpha_value": 0.9901445508003235, "log_alpha_value": -0.009904362261295319, "target_entropy": -6.0, "policy_t": 0.01044822670519352, "mean_q": 1.6794712543487549, "max_q": 1.9100714921951294, "min_q": 1.4329229593276978}, "td_error": [3.069517135620117, 3.1770405769348145, 0.8289281725883484, 4.062150001525879, 0.34401237964630127, 2.340395450592041, 0.14189714193344116, 2.6226706504821777, 3.026634693145752, 2.255328416824341, 3.220193386077881, 1.262050747871399, 2.6021294593811035, 4.651494026184082, 2.7585558891296387, 1.6826305389404297, 2.3892157077789307, 3.604586362838745, 3.9157752990722656, 2.2868049144744873, 2.1236042976379395, 2.341043472290039, 0.1393735408782959, 2.8977105617523193, 3.6889760494232178, 2.6716952323913574, 2.223336696624756, 2.1136553287506104, 2.189117193222046, 1.2008366584777832, 2.685281276702881, 2.1965126991271973, 2.433475971221924, 0.8062742352485657, 2.5241987705230713, 4.506303787231445, 0.14061975479125977, 0.6429837942123413, 4.269386291503906, 3.5098705291748047, 2.406691312789917, 0.4865882396697998, 3.021749258041382, 1.2575222253799438, 1.6890637874603271, 1.8969433307647705, 0.022001445293426514, 0.055908918380737305, 0.2890150547027588, 1.9740146398544312, 1.9984357357025146, 0.3896477222442627, 0.1679639220237732, 2.923894166946411, 0.3941105604171753, 2.4636311531066895, 2.6810479164123535, 3.007697582244873, 1.5822134017944336, 3.080352306365967, 2.66556715965271, 3.2397704124450684, 1.6167418956756592, 3.256967782974243, 1.263669490814209, 1.4639866352081299, 1.4135491847991943, 2.009528398513794, 1.020485520362854, 0.8872671723365784, 1.9214956760406494, 0.536319375038147, 2.477828025817871, 1.2055038213729858, 1.3186112642288208, 1.6327837705612183, 1.8134602308273315, 2.2621421813964844, 1.7483656406402588, 2.3721375465393066, 2.154599905014038, 1.682600975036621, 3.089711904525757, 1.3901152610778809, 2.0671119689941406, 3.127309560775757], "mean_td_error": 2.0578184127807617, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 34.0, "diff_num_grad_updates_vs_sampler_policy": 33.0}}, "num_env_steps_sampled": 31360, "num_env_steps_trained": 8772, "num_agent_steps_sampled": 94080, "num_agent_steps_trained": 8772, "last_target_update_ts": 31360, "num_target_updates": 34}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 94080, "num_agent_steps_trained": 8772, "num_env_steps_sampled": 31360, "num_env_steps_trained": 8772, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 414.9167906711256, "num_env_steps_trained_throughput_per_sec": 119.47380802806966, "timesteps_total": 31360, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 94080, "timers": {"training_iteration_time_ms": 1851.036, "sample_time_ms": 1273.342, "load_time_ms": 0.532, "load_throughput": 484695.168, "learn_time_ms": 62.949, "learn_throughput": 4098.554, "synch_weights_time_ms": 18.46}, "counters": {"num_env_steps_sampled": 31360, "num_env_steps_trained": 8772, "num_agent_steps_sampled": 94080, "num_agent_steps_trained": 8772, "last_target_update_ts": 31360, "num_target_updates": 34}, "done": false, "episodes_total": 0, "training_iteration": 35, "trial_id": "9a806_00000", "date": "2023-11-16_21-54-42", "timestamp": 1700200482, "time_this_iter_s": 2.176034927368164, "time_total_s": 63.499018907547, "pid": 45784, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fadd0526b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 63.499018907547, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 72.66666666666667, "ram_util_percent": 90.36666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.14377212524414, "actor_loss": -5.916103839874268, "critic_loss": 2.658207416534424, "alpha_loss": -0.10349773615598679, "alpha_value": 0.989848792552948, "log_alpha_value": -0.010203082114458084, "target_entropy": -6.0, "policy_t": -0.04798489063978195, "mean_q": 2.0799789428710938, "max_q": 2.535039186477661, "min_q": 1.7456905841827393}, "td_error": [1.5307199954986572, 1.8841136693954468, 5.027013778686523, 3.0406413078308105, 3.761124610900879, 3.727877616882324, 4.542693138122559, 4.535475254058838, 3.63950777053833, 4.27383279800415, 3.999197244644165, 3.8460025787353516, 3.761981725692749, 3.8869783878326416, 3.688570499420166, 4.557415962219238, 4.4240875244140625, 1.4231841564178467, 2.956523895263672, 2.8482515811920166, 3.8704981803894043, 4.346540927886963, 1.7698850631713867, 5.397345066070557, 2.4368362426757812, 3.514087200164795, 3.9898908138275146, 2.7601523399353027, 3.6252708435058594, 4.7929463386535645, 5.299948215484619, 3.820216178894043, 5.68605375289917, 3.7887637615203857, 4.0893964767456055, 3.1916027069091797, 4.3903727531433105, 3.670952796936035, 1.7174018621444702, 4.1610107421875, 3.5178303718566895, 3.8265700340270996, 3.8783111572265625, 3.000509262084961, 4.537026405334473, 3.7684526443481445, 3.0860016345977783, 5.139723300933838, 4.958575248718262, 3.98142147064209, 3.3006274700164795, 4.908324718475342, 2.237779378890991, 3.5119147300720215, 4.316464424133301, 3.8956573009490967, 2.4472033977508545, 4.489418983459473, 3.426802635192871, 2.7535459995269775, 2.8782968521118164, 2.5662450790405273, 3.309959650039673, 3.8075571060180664, 3.626237630844116, 2.681169033050537, 1.5581214427947998, 4.991120338439941, 4.882426738739014, 3.1912317276000977, 4.45047664642334, 3.6780333518981934, 3.9073400497436523, 4.82199239730835, 4.125621795654297, 3.0745577812194824, 2.6681511402130127, 2.4746038913726807, 5.022152900695801, 2.348580837249756, 3.9745492935180664, 2.969203233718872, 2.0790371894836426, 4.776410102844238, 4.17868709564209, 3.237215757369995], "mean_td_error": 3.6504130363464355, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 35.0, "diff_num_grad_updates_vs_sampler_policy": 34.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.049592018127441, "actor_loss": -5.729190349578857, "critic_loss": 0.6232709884643555, "alpha_loss": -0.10258714854717255, "alpha_value": 0.9898438453674316, "log_alpha_value": -0.010208089835941792, "target_entropy": -6.0, "policy_t": 0.01874300092458725, "mean_q": 1.798249363899231, "max_q": 2.256641387939453, "min_q": 1.4022947549819946}, "td_error": [2.278125047683716, 1.2923336029052734, 0.6838158369064331, 2.1781468391418457, 3.085231065750122, 0.6854353547096252, 2.228691577911377, 1.9856187105178833, 1.5651464462280273, 2.090881824493408, 2.694648265838623, 2.7968547344207764, 3.0878384113311768, 3.9266719818115234, 2.247602939605713, 4.154587745666504, 1.6805708408355713, 3.4012460708618164, 1.72500479221344, 1.53419828414917, 1.6611402034759521, 3.7949116230010986, 1.2018886804580688, 1.5253701210021973, 2.446413516998291, 1.0214952230453491, 2.025136709213257, 2.870570182800293, 4.017422676086426, 1.4042472839355469, 2.289529800415039, 1.4136314392089844, 1.4277942180633545, 3.625211000442505, 1.31850266456604, 3.839738368988037, 1.7386248111724854, 1.5243685245513916, 2.125581741333008, 2.225314140319824, 2.991363286972046, 2.1533501148223877, 2.4354918003082275, 3.0326242446899414, 3.047910213470459, 3.58008074760437, 1.340651035308838, 0.6680492758750916, 2.474799156188965, 2.021979808807373, 1.8157944679260254, 3.011280059814453, 2.6296181678771973, 3.124901533126831, 1.2756277322769165, 2.308539867401123, 2.206026792526245, 1.7074041366577148, 3.1253468990325928, 1.6222190856933594, 0.9816798567771912, 1.5126934051513672, 0.3548147678375244, 1.9134104251861572, 0.85050368309021, 1.708634853363037, 2.1814486980438232, 0.9077094793319702, 2.3099119663238525, 2.8037872314453125, 1.289853811264038, 4.076969146728516, 0.34413909912109375, 1.3228085041046143, 3.434360980987549, 2.490522861480713, 3.148466110229492, 2.7186262607574463, 0.720712423324585, 2.2436370849609375, 0.5390792489051819, 0.23974686861038208, 0.8356930613517761, 1.415074348449707, 2.3703396320343018, 0.7862337827682495], "mean_td_error": 2.0801563262939453, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 35.0, "diff_num_grad_updates_vs_sampler_policy": 34.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.04985237121582, "actor_loss": -5.741737365722656, "critic_loss": 0.4030349552631378, "alpha_loss": -0.10255435109138489, "alpha_value": 0.9898473024368286, "log_alpha_value": -0.010204562917351723, "target_entropy": -6.0, "policy_t": -0.003536010393872857, "mean_q": 1.782025933265686, "max_q": 2.1349916458129883, "min_q": 1.468704104423523}, "td_error": [1.5603187084197998, 2.788093090057373, 2.4876861572265625, 2.2081189155578613, 4.1050615310668945, 1.571164608001709, 3.3911070823669434, 2.613248825073242, 1.1199121475219727, 1.7523119449615479, 1.5586050748825073, 2.8112940788269043, 0.30219900608062744, 1.7076536417007446, 3.238799571990967, 0.21376335620880127, 0.4855912923812866, 1.6671971082687378, 2.7163450717926025, 1.4372743368148804, 0.271625280380249, 1.5105440616607666, 0.322701096534729, 2.8082921504974365, 2.215590238571167, 0.3844602108001709, 1.5040401220321655, 2.106907844543457, 2.762730836868286, 2.182924270629883, 1.2955420017242432, 1.428929328918457, 0.440474271774292, 2.9486632347106934, 0.5537903904914856, 2.8594608306884766, 2.7643866539001465, 1.2542128562927246, 0.3935784101486206, 4.066160202026367, 1.3652840852737427, 3.92171049118042, 2.0427122116088867, 0.7779077291488647, 2.6421468257904053, 2.3264517784118652, 0.20206111669540405, 1.433250904083252, 2.630282402038574, 3.151991367340088, 1.6264173984527588, 2.795339345932007, 2.0674357414245605, 2.01576566696167, 3.576026439666748, 0.6924452781677246, 3.654256582260132, 2.9276695251464844, 3.8491110801696777, 2.476733684539795, 0.5669640302658081, 0.7929596900939941, 1.2741409540176392, 2.8699283599853516, 1.0829236507415771, 2.974453926086426, 0.9467099905014038, 0.26564908027648926, 0.6891939640045166, 3.4985272884368896, 1.4479775428771973, 0.6664632558822632, 2.0828709602355957, 3.522347927093506, 3.039860725402832, 1.863379955291748, 1.194071650505066, 1.2955701351165771, 0.12127900123596191, 1.5027862787246704, 2.6570937633514404, 0.9732611179351807, 2.622295379638672, 1.539630651473999, 3.183887004852295, 2.7749545574188232], "mean_td_error": 1.9236621856689453, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 35.0, "diff_num_grad_updates_vs_sampler_policy": 34.0}}, "num_env_steps_sampled": 32256, "num_env_steps_trained": 9030, "num_agent_steps_sampled": 96768, "num_agent_steps_trained": 9030, "last_target_update_ts": 32256, "num_target_updates": 35}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96768, "num_agent_steps_trained": 9030, "num_env_steps_sampled": 32256, "num_env_steps_trained": 9030, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 512.5553589916311, "num_env_steps_trained_throughput_per_sec": 147.58848506678666, "timesteps_total": 32256, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 96768, "timers": {"training_iteration_time_ms": 1866.91, "sample_time_ms": 1291.353, "load_time_ms": 0.534, "load_throughput": 483396.065, "learn_time_ms": 62.821, "learn_throughput": 4106.888, "synch_weights_time_ms": 18.537}, "counters": {"num_env_steps_sampled": 32256, "num_env_steps_trained": 9030, "num_agent_steps_sampled": 96768, "num_agent_steps_trained": 9030, "last_target_update_ts": 32256, "num_target_updates": 35}, "done": false, "episodes_total": 0, "training_iteration": 36, "trial_id": "9a806_00000", "date": "2023-11-16_21-54-43", "timestamp": 1700200483, "time_this_iter_s": 1.763709306716919, "time_total_s": 65.26272821426392, "pid": 45784, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fadd0526670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 65.26272821426392, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 75.4, "ram_util_percent": 90.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.081689834594727, "actor_loss": -5.971773147583008, "critic_loss": 2.445500612258911, "alpha_loss": -0.10589157044887543, "alpha_value": 0.9895516037940979, "log_alpha_value": -0.010503355413675308, "target_entropy": -6.0, "policy_t": -0.016600457951426506, "mean_q": 2.2456114292144775, "max_q": 2.624021291732788, "min_q": 1.852282166481018}, "td_error": [3.006800651550293, 3.8273425102233887, 3.5821871757507324, 4.237342834472656, 4.910785675048828, 2.3154683113098145, 2.563737154006958, 4.970063209533691, 2.2001054286956787, 5.828886985778809, 4.051267147064209, 2.396397590637207, 4.343719959259033, 2.4383935928344727, 4.201009750366211, 2.728773593902588, 4.795304298400879, 2.084941864013672, 2.7989630699157715, 0.7783534526824951, 2.672825336456299, 2.5795178413391113, 3.7498655319213867, 1.4126079082489014, 4.415130138397217, 4.562341213226318, 4.227160453796387, 3.675891876220703, 3.777218818664551, 1.9518479108810425, 4.022488594055176, 3.372610569000244, 4.61675500869751, 3.1644506454467773, 1.5259299278259277, 1.7430353164672852, 4.718533039093018, 3.162574529647827, 6.009071350097656, 3.1926920413970947, 4.181731224060059, 3.8848166465759277, 2.7865190505981445, 3.5451762676239014, 3.338705539703369, 5.286664009094238, 3.225442886352539, 5.741053104400635, 0.9204567074775696, 2.112410545349121, 2.4220666885375977, 3.39150333404541, 5.165383815765381, 3.8168864250183105, 2.0318496227264404, 4.570412635803223, 1.719809651374817, 3.967532157897949, 3.1955132484436035, 5.569869041442871, 3.6733665466308594, 4.867932319641113, 5.372866630554199, 3.956726551055908, 1.7191698551177979, 3.4561514854431152, 4.453406810760498, 3.87160587310791, 2.4456868171691895, 3.8260438442230225, 3.9375009536743164, 4.463370323181152, 3.661500930786133, 4.274966239929199, 2.250998020172119, 5.79188871383667, 2.8986892700195312, 2.621948719024658, 3.241847515106201, 3.2680869102478027, 4.7107439041137695, 2.5749123096466064, 3.9925570487976074, 3.579127788543701, 4.634773254394531, 3.9892220497131348], "mean_td_error": 3.5467593669891357, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 36.0, "diff_num_grad_updates_vs_sampler_policy": 35.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.066461563110352, "actor_loss": -5.874366760253906, "critic_loss": 0.5875845551490784, "alpha_loss": -0.10578121989965439, "alpha_value": 0.9895467162132263, "log_alpha_value": -0.010508282110095024, "target_entropy": -6.0, "policy_t": -0.007461331784725189, "mean_q": 1.9011619091033936, "max_q": 2.2374985218048096, "min_q": 1.5799072980880737}, "td_error": [1.1831375360488892, 1.9107109308242798, 1.7028379440307617, 1.4798645973205566, 0.851595401763916, 3.136577606201172, 2.8741636276245117, 2.957326889038086, 0.08593505620956421, 2.7074453830718994, 1.933018684387207, 2.385519027709961, 0.47104817628860474, 1.7377965450286865, 3.7314224243164062, 2.138791561126709, 2.6173486709594727, 1.3194284439086914, 2.3220701217651367, 1.5235034227371216, 3.2144622802734375, 2.946349620819092, 1.477555751800537, 3.327078104019165, 2.0261178016662598, 0.6869075894355774, 3.630784511566162, 2.4500062465667725, 0.6959951519966125, 1.770182490348816, 1.4974385499954224, 0.104469895362854, 2.3774871826171875, 2.868391513824463, 0.556450366973877, 2.506751537322998, 2.505418300628662, 3.337618827819824, 0.6628488302230835, 3.662036895751953, 2.5303549766540527, 2.2203500270843506, 2.9130990505218506, 3.867321252822876, 0.135414719581604, 2.184666633605957, 2.946864604949951, 0.6161420345306396, 0.9599717855453491, 3.091120719909668, 3.6836578845977783, 0.3945735692977905, 1.8342704772949219, 2.3536765575408936, 0.9112282395362854, 2.5358495712280273, 0.33883851766586304, 1.8995320796966553, 0.34576690196990967, 2.8812222480773926, 2.0474910736083984, 1.2542020082473755, 3.6899099349975586, 2.794445276260376, 1.4607927799224854, 1.5597243309020996, 1.5254080295562744, 2.406953811645508, 0.8564123511314392, 1.8481175899505615, 0.9931376576423645, 1.3966690301895142, 2.228914976119995, 2.1308865547180176, 2.4394779205322266, 1.4785563945770264, 1.475480079650879, 2.4015793800354004, 3.173534870147705, 2.036698818206787, 1.5359495878219604, 0.7329259514808655, 0.5389466285705566, 0.22016030550003052, 1.9914731979370117, 2.499594211578369], "mean_td_error": 1.9387818574905396, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 36.0, "diff_num_grad_updates_vs_sampler_policy": 35.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.082608222961426, "actor_loss": -5.8718061447143555, "critic_loss": 0.3734692633152008, "alpha_loss": -0.1059141680598259, "alpha_value": 0.9895503520965576, "log_alpha_value": -0.010504638776183128, "target_entropy": -6.0, "policy_t": -0.06179990619421005, "mean_q": 1.8774062395095825, "max_q": 2.2520785331726074, "min_q": 1.5702623128890991}, "td_error": [1.882711410522461, 1.8920224905014038, 2.477722644805908, 0.028227806091308594, 1.6998374462127686, 2.4275989532470703, 2.6912434101104736, 0.9548085927963257, 2.88140606880188, 2.404033660888672, 2.83671236038208, 0.8811817169189453, 0.2898674011230469, 0.3589264154434204, 3.6753933429718018, 1.436612606048584, 2.0580978393554688, 0.6958591341972351, 1.4574846029281616, 2.5704503059387207, 2.3274545669555664, 1.7190721035003662, 2.8901286125183105, 1.1834745407104492, 2.223226308822632, 3.8292653560638428, 1.0110200643539429, 0.24301987886428833, 2.2766337394714355, 2.0448575019836426, 1.2790007591247559, 3.0804214477539062, 2.287777900695801, 2.0232720375061035, 2.6698720455169678, 1.8763031959533691, 2.1836814880371094, 2.738908290863037, 2.2199316024780273, 2.6349306106567383, 1.0152499675750732, 2.209494113922119, 2.8134615421295166, 2.021796226501465, 0.8821762204170227, 1.5939953327178955, 0.5995696783065796, 1.6780495643615723, 2.5047430992126465, 2.2601680755615234, 0.6456633806228638, 0.7628607749938965, 2.218902587890625, 0.8118711113929749, 2.144913673400879, 2.5649523735046387, 2.8428120613098145, 1.6993119716644287, 1.2283577919006348, 0.47441089153289795, 2.893301010131836, 3.028266429901123, 1.4840059280395508, 1.5693211555480957, 0.7924197316169739, 2.084839344024658, 0.8124450445175171, 3.5418753623962402, 0.17325878143310547, 0.0643690824508667, 2.505610942840576, 2.474134922027588, 3.6723127365112305, 1.67010498046875, 1.7995760440826416, 0.09737569093704224, 1.7110999822616577, 0.6998357772827148, 2.492482900619507, 0.9478360414505005, 1.429409146308899, 2.0916662216186523, 3.3178892135620117, 1.5732148885726929, 0.9680841565132141, 1.4334895610809326], "mean_td_error": 1.8214352130889893, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 36.0, "diff_num_grad_updates_vs_sampler_policy": 35.0}}, "num_env_steps_sampled": 33152, "num_env_steps_trained": 9288, "num_agent_steps_sampled": 99456, "num_agent_steps_trained": 9288, "last_target_update_ts": 33152, "num_target_updates": 36}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 99456, "num_agent_steps_trained": 9288, "num_env_steps_sampled": 33152, "num_env_steps_trained": 9288, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 510.82566285337884, "num_env_steps_trained_throughput_per_sec": 147.09042524126312, "timesteps_total": 33152, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 99456, "timers": {"training_iteration_time_ms": 1880.504, "sample_time_ms": 1306.308, "load_time_ms": 0.534, "load_throughput": 483180.225, "learn_time_ms": 62.666, "learn_throughput": 4117.077, "synch_weights_time_ms": 18.36}, "counters": {"num_env_steps_sampled": 33152, "num_env_steps_trained": 9288, "num_agent_steps_sampled": 99456, "num_agent_steps_trained": 9288, "last_target_update_ts": 33152, "num_target_updates": 36}, "done": false, "episodes_total": 0, "training_iteration": 37, "trial_id": "9a806_00000", "date": "2023-11-16_21-54-45", "timestamp": 1700200485, "time_this_iter_s": 1.7704119682312012, "time_total_s": 67.03314018249512, "pid": 45784, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fadd05268b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 67.03314018249512, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 85.25, "ram_util_percent": 90.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.11093807220459, "actor_loss": -6.167002201080322, "critic_loss": 2.554840087890625, "alpha_loss": -0.10923435539007187, "alpha_value": 0.9892545938491821, "log_alpha_value": -0.010803583078086376, "target_entropy": -6.0, "policy_t": 0.005387315060943365, "mean_q": 2.4360599517822266, "max_q": 2.8604867458343506, "min_q": 2.0993926525115967}, "td_error": [2.315495491027832, 2.8329710960388184, 3.717278480529785, 3.880331039428711, 3.1382641792297363, 2.525712490081787, 3.703850507736206, 5.118650913238525, 1.8511509895324707, 5.717014789581299, 1.8187121152877808, 4.221501350402832, 4.406464576721191, 3.90718150138855, 3.739536762237549, 2.9937968254089355, 3.352890729904175, 3.530527114868164, 3.9284706115722656, 3.344390392303467, 5.36316442489624, 3.4352235794067383, 4.038360118865967, 4.454552173614502, 3.9245033264160156, 3.8617138862609863, 4.1038055419921875, 2.7784552574157715, 4.289846420288086, 2.980905055999756, 4.401219367980957, 3.9430251121520996, 4.188648700714111, 2.216290235519409, 2.6578052043914795, 3.2108449935913086, 4.385770797729492, 3.0938608646392822, 1.1975016593933105, 4.401552200317383, 3.8626227378845215, 2.3036890029907227, 1.3308296203613281, 3.190786838531494, 3.515962600708008, 2.6380326747894287, 4.18191385269165, 2.7746055126190186, 3.7794482707977295, 5.007798671722412, 4.373308181762695, 4.6709442138671875, 3.8140668869018555, 2.671518325805664, 3.564675807952881, 3.7751970291137695, 3.533015489578247, 4.577615737915039, 4.697188854217529, 4.206358909606934, 2.467256546020508, 3.5339226722717285, 4.838559150695801, 3.2763280868530273, 4.061676979064941, 2.4412384033203125, 4.451542377471924, 3.782733201980591, 4.030104160308838, 3.413097381591797, 2.776345729827881, 3.2501351833343506, 3.3299131393432617, 5.053279876708984, 2.1284329891204834, 3.506951093673706, 3.257225751876831, 3.1381616592407227, 2.5784902572631836, 4.164610862731934, 0.29900944232940674, 4.350988388061523, 3.4721994400024414, 3.263638973236084, 5.963557243347168, 3.068983554840088], "mean_td_error": 3.5504558086395264, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 37.0, "diff_num_grad_updates_vs_sampler_policy": 36.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.045289993286133, "actor_loss": -5.993252754211426, "critic_loss": 0.5461969375610352, "alpha_loss": -0.10857352614402771, "alpha_value": 0.9892498254776001, "log_alpha_value": -0.010808401741087437, "target_entropy": -6.0, "policy_t": 0.05484957993030548, "mean_q": 2.0484206676483154, "max_q": 2.5222604274749756, "min_q": 1.6607128381729126}, "td_error": [1.5171048641204834, 1.3722779750823975, 0.7094802856445312, 2.3963334560394287, 1.545479655265808, 4.803936004638672, 1.0726975202560425, 1.469571590423584, 0.8106850981712341, 1.0774903297424316, 1.946197271347046, 2.8104467391967773, 3.3444347381591797, 0.9448542594909668, 1.1193766593933105, 2.6052770614624023, 3.4682812690734863, 1.933322548866272, 2.8505187034606934, 1.7984539270401, 1.6040483713150024, 1.6994311809539795, 1.4901484251022339, 3.8452229499816895, 2.572793483734131, 1.7363524436950684, 3.334258556365967, 1.9805477857589722, 3.525212287902832, 0.8579965233802795, 0.8931484222412109, 1.2244597673416138, 2.7458200454711914, 2.777477741241455, 2.5455353260040283, 4.2265706062316895, 2.171706199645996, 1.8276162147521973, 3.7595458030700684, 1.6022958755493164, 0.8903039693832397, 1.5882426500320435, 2.6648035049438477, 3.2348945140838623, 2.1700000762939453, 2.3431618213653564, 2.3297953605651855, 1.2652086019515991, 1.075354814529419, 0.17717576026916504, 2.7317514419555664, 2.3493998050689697, 0.884559690952301, 1.3265821933746338, 3.123687744140625, 1.3453108072280884, 1.7097235918045044, 0.21440911293029785, 2.2916653156280518, 2.543142318725586, 0.37312597036361694, 0.34163808822631836, 1.581361174583435, 2.0563182830810547, 2.580965280532837, 1.8208810091018677, 2.5699644088745117, 0.35549843311309814, 0.6429018378257751, 0.5976762175559998, 3.9485020637512207, 1.792702317237854, 2.0417532920837402, 1.3493238687515259, 1.6163053512573242, 2.1692123413085938, 2.8834567070007324, 1.6927951574325562, 1.3962953090667725, 2.39725661277771, 0.8621317744255066, 1.7145414352416992, 0.7703136801719666, 3.437236785888672, 0.5004057884216309, 0.05378669500350952], "mean_td_error": 1.904906153678894, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 37.0, "diff_num_grad_updates_vs_sampler_policy": 36.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.033346176147461, "actor_loss": -5.976191997528076, "critic_loss": 0.3441509008407593, "alpha_loss": -0.10840707272291183, "alpha_value": 0.9892534613609314, "log_alpha_value": -0.01080467738211155, "target_entropy": -6.0, "policy_t": -0.026150763034820557, "mean_q": 2.021578550338745, "max_q": 2.378702402114868, "min_q": 1.6850945949554443}, "td_error": [1.3823460340499878, 2.648894786834717, 3.056884288787842, 0.4255092144012451, 1.5472830533981323, 3.5836119651794434, 2.255561351776123, 1.9692695140838623, 1.2826688289642334, 2.8049139976501465, 2.301140785217285, 1.683488130569458, 1.781839370727539, 1.5810329914093018, 1.159792423248291, 0.8562999367713928, 2.371732711791992, 1.7875921726226807, 0.09867745637893677, 2.556020498275757, 1.2260088920593262, 2.278927803039551, 0.5262792706489563, 2.491960287094116, 1.1103453636169434, 0.15900671482086182, 2.294323205947876, 2.036961317062378, 0.5831250548362732, 3.0511703491210938, 3.7638516426086426, 1.1194226741790771, 2.0969390869140625, 1.7389979362487793, 0.9878419637680054, 2.6578660011291504, 0.4313884973526001, 0.3680659532546997, 2.453901767730713, 1.487521767616272, 4.034946918487549, 1.7776604890823364, 1.3991355895996094, 2.553466320037842, 1.0291216373443604, 1.6153149604797363, 1.8429536819458008, 0.7407177686691284, 2.2050700187683105, 0.5486267805099487, 0.08084440231323242, 1.7222107648849487, 1.148914098739624, 1.8203667402267456, 1.2698622941970825, 2.0110368728637695, 1.371777057647705, 3.1550540924072266, 0.7479201555252075, 2.1655097007751465, 0.37937718629837036, 1.7870025634765625, 0.28676748275756836, 1.1290669441223145, 1.6844072341918945, 1.1252094507217407, 1.5187708139419556, 4.045200347900391, 1.518074870109558, 2.898148536682129, 2.667123794555664, 2.320491313934326, 0.10993623733520508, 2.5464417934417725, 2.7140700817108154, 2.766301155090332, 1.8604867458343506, 1.7106075286865234, 2.2445521354675293, 0.3951985836029053, 2.0901432037353516, 0.6001536846160889, 1.8757686614990234, 0.8097386360168457, 0.5489400029182434, 2.431579113006592], "mean_td_error": 1.7128201723098755, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 37.0, "diff_num_grad_updates_vs_sampler_policy": 36.0}}, "num_env_steps_sampled": 34048, "num_env_steps_trained": 9546, "num_agent_steps_sampled": 102144, "num_agent_steps_trained": 9546, "last_target_update_ts": 34048, "num_target_updates": 37}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 102144, "num_agent_steps_trained": 9546, "num_env_steps_sampled": 34048, "num_env_steps_trained": 9546, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 417.5420010592718, "num_env_steps_trained_throughput_per_sec": 120.22972798358495, "timesteps_total": 34048, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 102144, "timers": {"training_iteration_time_ms": 1872.291, "sample_time_ms": 1270.648, "load_time_ms": 0.533, "load_throughput": 483979.799, "learn_time_ms": 62.593, "learn_throughput": 4121.84, "synch_weights_time_ms": 18.219}, "counters": {"num_env_steps_sampled": 34048, "num_env_steps_trained": 9546, "num_agent_steps_sampled": 102144, "num_agent_steps_trained": 9546, "last_target_update_ts": 34048, "num_target_updates": 37}, "done": false, "episodes_total": 0, "training_iteration": 38, "trial_id": "9a806_00000", "date": "2023-11-16_21-54-47", "timestamp": 1700200487, "time_this_iter_s": 2.1618051528930664, "time_total_s": 69.19494533538818, "pid": 45784, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fadc09cd4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 69.19494533538818, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 67.625, "ram_util_percent": 90.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.968329429626465, "actor_loss": -6.173009872436523, "critic_loss": 1.979282259941101, "alpha_loss": -0.11068668216466904, "alpha_value": 0.9889575839042664, "log_alpha_value": -0.011103834956884384, "target_entropy": -6.0, "policy_t": -0.03653866425156593, "mean_q": 2.5906686782836914, "max_q": 3.0138466358184814, "min_q": 2.117048740386963}, "td_error": [2.24631929397583, 3.6396689414978027, 3.7383174896240234, 3.299849510192871, 5.117026329040527, 1.0162453651428223, 3.3882808685302734, 3.3985671997070312, 5.172542095184326, 1.6505651473999023, 3.9212379455566406, 4.997984886169434, 4.226019859313965, 2.0952491760253906, 3.8906936645507812, 4.772885322570801, 4.377610206604004, 3.788508415222168, 3.53456974029541, 4.865230083465576, 4.481320381164551, 2.341541290283203, 3.741509437561035, 3.5123226642608643, 4.129024505615234, 3.410524368286133, 2.380016565322876, 5.016876220703125, 3.0814714431762695, 4.4339189529418945, 2.883544921875, 1.3846369981765747, 2.661590099334717, 3.2511324882507324, 4.1539154052734375, 2.857985734939575, 5.208318710327148, 2.995504379272461, 4.108313083648682, 1.7885469198226929, 4.133989334106445, 1.9042437076568604, 2.4283008575439453, 3.072350263595581, 2.4260141849517822, 2.7014060020446777, 2.736870765686035, 4.219124794006348, 0.4815584421157837, 1.1105523109436035, 4.129874229431152, 3.2587785720825195, 0.4049891233444214, 3.8224806785583496, 3.7226359844207764, 4.437178611755371, 4.530313491821289, 5.1951751708984375, 2.5900659561157227, 2.5233304500579834, 2.358106851577759, 4.0195136070251465, 3.1115455627441406, 3.1172666549682617, 4.136849403381348, 2.460659980773926, 3.150801420211792, 1.372739553451538, 3.3551058769226074, 2.898098945617676, 4.533438682556152, 1.827574610710144, 4.141658782958984, 4.023794651031494, 3.898273468017578, 5.9225921630859375, 1.9086517095565796, 5.3330559730529785, 2.3764772415161133, 1.9020670652389526, 2.3746895790100098, 4.150143146514893, 3.461188316345215, 1.8651292324066162, 2.5534205436706543, 2.8768484592437744], "mean_td_error": 3.3013756275177, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 38.0, "diff_num_grad_updates_vs_sampler_policy": 37.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.073810577392578, "actor_loss": -6.136806011199951, "critic_loss": 0.36282816529273987, "alpha_loss": -0.11190403252840042, "alpha_value": 0.9889530539512634, "log_alpha_value": -0.011108411476016045, "target_entropy": -6.0, "policy_t": -0.004806290380656719, "mean_q": 2.175435781478882, "max_q": 2.7012522220611572, "min_q": 1.7802526950836182}, "td_error": [1.0327157974243164, 0.39151430130004883, 0.39770078659057617, 2.932130813598633, 1.4926092624664307, 1.1053550243377686, 0.759878396987915, 0.44970571994781494, 2.0206456184387207, 1.5382858514785767, 0.15385103225708008, 0.7542057633399963, 2.2230513095855713, 3.0489625930786133, 0.17341327667236328, 2.3995726108551025, 4.074897766113281, 1.3567149639129639, 1.2323951721191406, 0.7325010299682617, 1.5307269096374512, 1.691953182220459, 0.7135031223297119, 0.9268596172332764, 0.22568202018737793, 1.3300259113311768, 1.1247351169586182, 2.5323877334594727, 1.066825032234192, 0.026857197284698486, 2.0136489868164062, 0.956673264503479, 0.4287705421447754, 0.17640292644500732, 2.751445770263672, 3.826948404312134, 0.8585126996040344, 3.4493637084960938, 0.1559431552886963, 2.5815165042877197, 0.802849531173706, 2.6274402141571045, 1.5809316635131836, 0.6271601915359497, 0.9216772317886353, 0.6645251512527466, 0.7895046472549438, 0.24211037158966064, 2.644547700881958, 2.8544158935546875, 1.725651741027832, 1.3210612535476685, 1.767029047012329, 0.2273777723312378, 2.151516914367676, 0.20439326763153076, 3.080129623413086, 0.8250789642333984, 0.5675084590911865, 1.995664358139038, 1.1497876644134521, 1.5628808736801147, 1.6554397344589233, 1.3206424713134766, 2.8656258583068848, 1.1619508266448975, 2.072751045227051, 0.8539167046546936, 0.23686808347702026, 1.2557921409606934, 0.19908487796783447, 0.7082254886627197, 1.8642159700393677, 1.4081447124481201, 0.08478522300720215, 1.290640115737915, 1.4867550134658813, 0.11245191097259521, 4.348837375640869, 2.4032886028289795, 0.709530234336853, 0.7027032375335693, 1.3051037788391113, 0.3291866183280945, 1.6267805099487305, 0.695923924446106], "mean_td_error": 1.3682647943496704, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 38.0, "diff_num_grad_updates_vs_sampler_policy": 37.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.080774307250977, "actor_loss": -6.092138290405273, "critic_loss": 0.3622227907180786, "alpha_loss": -0.11194271594285965, "alpha_value": 0.988956868648529, "log_alpha_value": -0.011104574427008629, "target_entropy": -6.0, "policy_t": 0.012227704748511314, "mean_q": 2.113426446914673, "max_q": 2.6137208938598633, "min_q": 1.8618429899215698}, "td_error": [1.6957156658172607, 2.206249475479126, 1.0306456089019775, 0.881597638130188, 1.762235403060913, 4.441105842590332, 2.901470184326172, 1.2021369934082031, 2.3460209369659424, 4.592767715454102, 2.4501726627349854, 1.9174479246139526, 2.446197509765625, 3.216418743133545, 1.1646614074707031, 0.0545731782913208, 1.3094696998596191, 2.4536051750183105, 4.18587589263916, 1.3500841856002808, 3.6663386821746826, 2.0635578632354736, 0.9341995716094971, 1.689191222190857, 1.9322152137756348, 0.24856138229370117, 3.1639747619628906, 2.4765853881835938, 0.09797346591949463, 2.6515583992004395, 1.2845466136932373, 0.5789370536804199, 2.6298608779907227, 0.29457664489746094, 1.0582420825958252, 0.27242982387542725, 3.4314913749694824, 1.527799367904663, 1.1985849142074585, 0.26078927516937256, 0.06136631965637207, 1.8765347003936768, 2.4633755683898926, 3.728208065032959, 1.6333340406417847, 2.8735368251800537, 0.07258093357086182, 0.6546518802642822, 1.9740303754806519, 0.5853831768035889, 2.3868284225463867, 2.571493625640869, 1.2711693048477173, 2.098027229309082, 1.2295340299606323, 2.655599594116211, 2.8944664001464844, 0.4316610097885132, 1.0785921812057495, 1.2650220394134521, 3.0507566928863525, 1.6793153285980225, 2.2708029747009277, 0.7899119853973389, 2.708000659942627, 2.245035409927368, 0.228920578956604, 0.8280414342880249, 1.2202930450439453, 1.2653368711471558, 3.1917266845703125, 1.7867565155029297, 2.0837719440460205, 1.5929967164993286, 1.5455368757247925, 1.2306677103042603, 0.3355725407600403, 0.7295594811439514, 2.1850805282592773, 3.300475597381592, 0.40900111198425293, 4.202010154724121, 0.8988364338874817, 1.1406322717666626, 1.5059947967529297, 2.3948609828948975], "mean_td_error": 1.787152886390686, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 38.0, "diff_num_grad_updates_vs_sampler_policy": 37.0}}, "num_env_steps_sampled": 34944, "num_env_steps_trained": 9804, "num_agent_steps_sampled": 104832, "num_agent_steps_trained": 9804, "last_target_update_ts": 34944, "num_target_updates": 38}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104832, "num_agent_steps_trained": 9804, "num_env_steps_sampled": 34944, "num_env_steps_trained": 9804, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 490.35403671193563, "num_env_steps_trained_throughput_per_sec": 141.19569360678503, "timesteps_total": 34944, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 104832, "timers": {"training_iteration_time_ms": 1887.507, "sample_time_ms": 1287.077, "load_time_ms": 0.534, "load_throughput": 483525.662, "learn_time_ms": 62.303, "learn_throughput": 4141.056, "synch_weights_time_ms": 18.344}, "counters": {"num_env_steps_sampled": 34944, "num_env_steps_trained": 9804, "num_agent_steps_sampled": 104832, "num_agent_steps_trained": 9804, "last_target_update_ts": 34944, "num_target_updates": 38}, "done": false, "episodes_total": 0, "training_iteration": 39, "trial_id": "9a806_00000", "date": "2023-11-16_21-54-49", "timestamp": 1700200489, "time_this_iter_s": 1.8417527675628662, "time_total_s": 71.03669810295105, "pid": 45784, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fadd04c93a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 71.03669810295105, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 90.95, "ram_util_percent": 90.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.051008224487305, "actor_loss": -6.381223678588867, "critic_loss": 1.9806797504425049, "alpha_loss": -0.11461959034204483, "alpha_value": 0.988660991191864, "log_alpha_value": -0.011403788812458515, "target_entropy": -6.0, "policy_t": 0.001424039015546441, "mean_q": 2.7579805850982666, "max_q": 3.2701988220214844, "min_q": 2.356869697570801}, "td_error": [2.0478720664978027, 3.5083298683166504, 4.08453369140625, 1.3093422651290894, 1.7677278518676758, 4.673407077789307, 1.078787088394165, 1.977316975593567, 3.2179160118103027, 3.387751579284668, 5.659564018249512, 2.9055962562561035, 2.780620574951172, 3.242353916168213, 3.886460781097412, 3.113098621368408, 1.9427043199539185, 4.08690071105957, 2.557732105255127, 3.5229692459106445, 2.1532154083251953, 1.6250149011611938, 2.701357364654541, 3.577174186706543, 3.1422770023345947, 2.454392194747925, 2.8516860008239746, 4.242457389831543, 1.941023349761963, 3.9802703857421875, 4.375887870788574, 3.4313337802886963, 2.876887798309326, 5.217624664306641, 4.041079044342041, 3.0709917545318604, 3.5927906036376953, 4.31413459777832, 0.4207550287246704, 4.725757598876953, 3.459686279296875, 2.396414279937744, 2.688730239868164, 4.717463493347168, 3.829671859741211, 4.053676605224609, 5.3895182609558105, 2.73984432220459, 5.528697967529297, 4.13801383972168, 3.5193352699279785, 1.9030227661132812, 2.58364200592041, 3.455249309539795, 4.396949768066406, 2.0053586959838867, 4.405759334564209, 1.8766252994537354, 3.5813145637512207, 4.313072681427002, 1.5098625421524048, 4.44327449798584, 3.532463550567627, 3.827706813812256, 5.553957939147949, 4.74640417098999, 0.9368867874145508, 1.9568264484405518, 4.398954391479492, 3.5758395195007324, 2.951261520385742, 3.5189948081970215, 3.5613200664520264, 3.635834217071533, 4.704677104949951, 1.3929539918899536, 2.665194511413574, 3.098729133605957, 4.145172595977783, 3.100757122039795, 2.3411035537719727, 3.1196494102478027, 5.046905040740967, 3.921107292175293, 3.3922746181488037, 0.5966933965682983], "mean_td_error": 3.2807435989379883, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 39.0, "diff_num_grad_updates_vs_sampler_policy": 38.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.116201400756836, "actor_loss": -6.332597732543945, "critic_loss": 0.4212672710418701, "alpha_loss": -0.11540953814983368, "alpha_value": 0.9886564612388611, "log_alpha_value": -0.011408387683331966, "target_entropy": -6.0, "policy_t": -0.05127967521548271, "mean_q": 2.34499192237854, "max_q": 2.9736428260803223, "min_q": 1.9829847812652588}, "td_error": [2.7345705032348633, 2.40274715423584, 2.135099172592163, 1.6241883039474487, 0.9693917036056519, 1.3671461343765259, 1.277226448059082, 1.050985336303711, 1.4327799081802368, 0.838911771774292, 0.9107304811477661, 2.576871395111084, 1.4114511013031006, 1.1611253023147583, 2.1156768798828125, 3.3313512802124023, 0.6349799633026123, 0.48839426040649414, 2.442962646484375, 0.18428272008895874, 0.7861208915710449, 0.7535768747329712, 1.6364506483078003, 0.9151893854141235, 2.4405622482299805, 2.9153146743774414, 0.3520636558532715, 0.36261796951293945, 0.9389908313751221, 2.404210090637207, 1.186623454093933, 0.41808879375457764, 1.3421971797943115, 3.3042941093444824, 0.5394163131713867, 2.1593263149261475, 2.6936442852020264, 2.716827869415283, 3.6351006031036377, 2.25517201423645, 1.5793534517288208, 2.3482847213745117, 1.6589441299438477, 2.075841188430786, 2.8546142578125, 0.4777493476867676, 1.3689632415771484, 1.850071668624878, 2.698606014251709, 1.3965809345245361, 0.5368601083755493, 0.9106037616729736, 1.09828782081604, 1.3032581806182861, 1.0613130331039429, 1.3522757291793823, 1.4423454999923706, 2.80702543258667, 1.319042682647705, 1.7985494136810303, 0.29167640209198, 1.570438027381897, 3.5809125900268555, 0.1241464614868164, 0.15795326232910156, 3.553356409072876, 0.49981260299682617, 1.5089925527572632, 0.6025207042694092, 1.5467876195907593, 0.2550560235977173, 0.7871595621109009, 1.2565363645553589, 1.399005651473999, 1.9485976696014404, 2.7449915409088135, 2.0285565853118896, 2.4670486450195312, 1.3884137868881226, 1.0818443298339844, 0.9306466579437256, 0.7086436748504639, 0.28530001640319824, 1.7930374145507812, 1.6572273969650269, 1.9219284057617188], "mean_td_error": 1.5450676679611206, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 39.0, "diff_num_grad_updates_vs_sampler_policy": 38.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.078325271606445, "actor_loss": -6.218511581420898, "critic_loss": 0.3591017723083496, "alpha_loss": -0.11493778973817825, "alpha_value": 0.9886603355407715, "log_alpha_value": -0.011404451914131641, "target_entropy": -6.0, "policy_t": -0.01139901764690876, "mean_q": 2.2187206745147705, "max_q": 2.6155238151550293, "min_q": 1.9188659191131592}, "td_error": [1.9733638763427734, 2.0957448482513428, 1.6605935096740723, 1.7003005743026733, 1.3286548852920532, 0.586946964263916, 1.0065034627914429, 0.7136870622634888, 0.7919857501983643, 0.5011141300201416, 0.47207438945770264, 1.8484143018722534, 2.3672704696655273, 2.566498279571533, 0.9045629501342773, 2.906703472137451, 1.6763743162155151, 2.723083972930908, 2.743163585662842, 3.362332820892334, 2.7296066284179688, 1.007477879524231, 2.2253293991088867, 1.716541051864624, 2.164614200592041, 1.5289217233657837, 1.8321720361709595, 2.445173740386963, 1.4374680519104004, 0.3638346195220947, 1.6207789182662964, 1.2171342372894287, 1.5473493337631226, 1.0588022470474243, 0.3522372245788574, 0.37464165687561035, 2.1608030796051025, 3.122343063354492, 0.5592077970504761, 1.288477897644043, 1.7551474571228027, 1.4975950717926025, 3.369173049926758, 0.3709057569503784, 1.0838673114776611, 2.7061209678649902, 1.5635391473770142, 0.056882619857788086, 2.5935001373291016, 0.6104937791824341, 1.440255880355835, 3.6492438316345215, 1.8980993032455444, 0.5425831079483032, 1.6186113357543945, 1.219384789466858, 0.7579166889190674, 2.014033794403076, 2.049833297729492, 3.2925853729248047, 3.142514705657959, 1.9545882940292358, 0.8823055028915405, 1.9707788228988647, 1.0273840427398682, 4.3191046714782715, 2.265568256378174, 2.013622283935547, 2.2596864700317383, 1.6294645071029663, 0.2086181640625, 2.685868263244629, 0.07246100902557373, 1.6220258474349976, 2.656820297241211, 1.4382250308990479, 2.2173714637756348, 1.7143265008926392, 3.131521701812744, 2.5753746032714844, 0.8108253479003906, 1.4547621011734009, 3.231700897216797, 3.386122226715088, 1.9265305995941162, 2.249422073364258], "mean_td_error": 1.763012170791626, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 39.0, "diff_num_grad_updates_vs_sampler_policy": 38.0}}, "num_env_steps_sampled": 35840, "num_env_steps_trained": 10062, "num_agent_steps_sampled": 107520, "num_agent_steps_trained": 10062, "last_target_update_ts": 35840, "num_target_updates": 39}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 107520, "num_agent_steps_trained": 10062, "num_env_steps_sampled": 35840, "num_env_steps_trained": 10062, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 538.0031010974667, "num_env_steps_trained_throughput_per_sec": 154.91607152136876, "timesteps_total": 35840, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 107520, "timers": {"training_iteration_time_ms": 1855.476, "sample_time_ms": 1259.045, "load_time_ms": 0.532, "load_throughput": 484716.879, "learn_time_ms": 62.084, "learn_throughput": 4155.664, "synch_weights_time_ms": 17.13}, "counters": {"num_env_steps_sampled": 35840, "num_env_steps_trained": 10062, "num_agent_steps_sampled": 107520, "num_agent_steps_trained": 10062, "last_target_update_ts": 35840, "num_target_updates": 39}, "done": false, "episodes_total": 0, "training_iteration": 40, "trial_id": "9a806_00000", "date": "2023-11-16_21-54-51", "timestamp": 1700200491, "time_this_iter_s": 1.6813209056854248, "time_total_s": 72.71801900863647, "pid": 45784, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fadd05268b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 72.71801900863647, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 65.5, "ram_util_percent": 90.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.156519889831543, "actor_loss": -6.6123366355896, "critic_loss": 1.6364655494689941, "alpha_loss": -0.11886851489543915, "alpha_value": 0.988364577293396, "log_alpha_value": -0.011703666299581528, "target_entropy": -6.0, "policy_t": 0.018952155485749245, "mean_q": 2.963200330734253, "max_q": 3.4189071655273438, "min_q": 2.4559004306793213}, "td_error": [3.0592966079711914, 3.1571617126464844, 4.891347885131836, 4.295439720153809, 1.7089635133743286, 2.7334885597229004, 2.627155303955078, 1.4846150875091553, 2.6880366802215576, 4.772895812988281, 3.090115785598755, 2.902031660079956, 4.027397155761719, 1.7515180110931396, 1.091628909111023, 5.260768890380859, 3.4646501541137695, 1.8203779458999634, 4.02159309387207, 2.4967081546783447, 3.1550793647766113, 2.036670207977295, 2.4567718505859375, 0.11333668231964111, 3.474104404449463, 3.3422789573669434, 1.7003191709518433, 3.1810269355773926, 2.5940299034118652, 3.4907288551330566, 2.8941168785095215, 2.0047521591186523, 3.7122926712036133, 2.771679162979126, 1.73247492313385, 3.1124091148376465, 3.6704492568969727, 1.1688166856765747, 1.200179934501648, 1.759539246559143, 1.1926400661468506, 2.622990608215332, 3.489032745361328, 2.514493465423584, 1.2301431894302368, 1.4017608165740967, 4.636277675628662, 3.5529842376708984, 2.5161800384521484, 2.650960922241211, 4.5211687088012695, 4.0391974449157715, 2.690216302871704, 4.983883857727051, 1.669602632522583, 1.9263370037078857, 2.634310007095337, 2.971957206726074, 2.8844411373138428, 2.5302538871765137, 1.6193281412124634, 3.07576322555542, 3.7919721603393555, 0.21074426174163818, 3.634099006652832, 2.8038687705993652, 3.4995245933532715, 0.16557669639587402, 3.6704354286193848, 3.003065586090088, 0.24241101741790771, 3.877565860748291, 1.6615943908691406, 1.8804895877838135, 2.302460193634033, 2.6711153984069824, 4.032392978668213, 2.3000030517578125, 4.127228260040283, 3.703158140182495, 2.5225117206573486, 3.0809707641601562, 1.470571517944336, 2.7076478004455566, 4.511807918548584, 3.5071887969970703], "mean_td_error": 2.763355255126953, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 40.0, "diff_num_grad_updates_vs_sampler_policy": 39.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.092116355895996, "actor_loss": -6.476325511932373, "critic_loss": 0.3852679133415222, "alpha_loss": -0.11816283315420151, "alpha_value": 0.9883598685264587, "log_alpha_value": -0.011708430014550686, "target_entropy": -6.0, "policy_t": -0.01832597143948078, "mean_q": 2.5286781787872314, "max_q": 3.0726635456085205, "min_q": 2.125704288482666}, "td_error": [1.2273186445236206, 0.1974102258682251, 1.3842681646347046, 1.5293132066726685, 2.579352855682373, 1.9758070707321167, 0.4477962255477905, 2.637840986251831, 0.33732080459594727, 2.6165969371795654, 0.8308558464050293, 2.1627016067504883, 2.060778856277466, 1.6808032989501953, 0.4703291654586792, 1.3152141571044922, 1.8896836042404175, 1.597344160079956, 0.16142642498016357, 3.1540448665618896, 0.8547245264053345, 0.6943991184234619, 0.4025309085845947, 1.7962777614593506, 0.1389991044998169, 0.7400989532470703, 1.8921737670898438, 2.224031448364258, 0.1978590488433838, 0.31174910068511963, 0.2828773260116577, 2.1416895389556885, 0.24512720108032227, 2.103227138519287, 2.6734352111816406, 1.8762812614440918, 0.9714484214782715, 1.9613845348358154, 2.4974424839019775, 1.4494264125823975, 2.4867825508117676, 1.223137378692627, 1.6452264785766602, 1.2479745149612427, 0.7516144514083862, 0.39238405227661133, 0.693278431892395, 1.1803276538848877, 2.5283865928649902, 1.4110602140426636, 0.5361678600311279, 0.7362619638442993, 0.9803844690322876, 1.5181818008422852, 2.1084933280944824, 0.08499884605407715, 0.9301645755767822, 0.27270567417144775, 1.1965057849884033, 2.6694564819335938, 0.10583329200744629, 0.8512146472930908, 3.7526350021362305, 1.9607515335083008, 2.023470640182495, 0.2838587760925293, 3.767857074737549, 0.9458256959915161, 2.1733484268188477, 1.0577919483184814, 2.251157522201538, 1.7658495903015137, 1.1619781255722046, 0.3578653335571289, 2.4015870094299316, 0.5086789131164551, 1.6594486236572266, 3.0475497245788574, 2.7571253776550293, 0.2805602550506592, 0.44827520847320557, 1.426422357559204, 3.0231146812438965, 1.0316847562789917, 0.8414293527603149, 1.1197911500930786], "mean_td_error": 1.4105812311172485, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 40.0, "diff_num_grad_updates_vs_sampler_policy": 39.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.109485626220703, "actor_loss": -6.349766731262207, "critic_loss": 0.32279157638549805, "alpha_loss": -0.11832453310489655, "alpha_value": 0.9883639216423035, "log_alpha_value": -0.011704307980835438, "target_entropy": -6.0, "policy_t": -0.05243545398116112, "mean_q": 2.3535099029541016, "max_q": 2.7432775497436523, "min_q": 2.002133846282959}, "td_error": [1.3146380186080933, 0.6955291032791138, 1.8266384601593018, 1.360543966293335, 0.9848359823226929, 3.4883742332458496, 2.56351900100708, 2.9209485054016113, 2.5742268562316895, 1.904163122177124, 1.4530854225158691, 0.560429573059082, 0.6939442157745361, 1.8965080976486206, 1.3482664823532104, 0.8772213459014893, 3.141016960144043, 3.4234182834625244, 0.5287265777587891, 1.8649628162384033, 2.489262104034424, 2.0039620399475098, 0.44986629486083984, 2.082509994506836, 2.7510547637939453, 3.808621406555176, 2.7208118438720703, 1.8207836151123047, 2.8092050552368164, 1.780991554260254, 0.9845390319824219, 0.6934890747070312, 1.5495116710662842, 1.362630009651184, 0.12913990020751953, 0.9812263250350952, 1.3883212804794312, 1.1753957271575928, 2.0354504585266113, 1.5582482814788818, 0.49825823307037354, 2.1074938774108887, 0.22697734832763672, 2.1027634143829346, 0.6315469741821289, 0.03011643886566162, 3.6115126609802246, 1.6425325870513916, 2.5743508338928223, 1.3329299688339233, 3.058657646179199, 0.38256847858428955, 2.6279869079589844, 2.1908721923828125, 2.494840621948242, 0.782328724861145, 2.500009298324585, 1.6014134883880615, 0.20039594173431396, 0.2580927610397339, 0.08134174346923828, 2.4411447048187256, 2.1162309646606445, 0.7590430974960327, 2.0485620498657227, 0.46718859672546387, 0.9236568212509155, 1.4169152975082397, 1.5720789432525635, 1.981275200843811, 0.28762781620025635, 1.8036679029464722, 1.3778668642044067, 2.0084853172302246, 1.5612246990203857, 0.8182847499847412, 0.8776967525482178, 1.9810045957565308, 1.4971129894256592, 1.272700309753418, 0.526556134223938, 0.9983550310134888, 2.7560648918151855, 0.9311413764953613, 3.4160566329956055, 1.4637917280197144], "mean_td_error": 1.6074039936065674, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 40.0, "diff_num_grad_updates_vs_sampler_policy": 39.0}}, "num_env_steps_sampled": 36736, "num_env_steps_trained": 10320, "num_agent_steps_sampled": 110208, "num_agent_steps_trained": 10320, "last_target_update_ts": 36736, "num_target_updates": 40}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 110208, "num_agent_steps_trained": 10320, "num_env_steps_sampled": 36736, "num_env_steps_trained": 10320, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 536.7230064743587, "num_env_steps_trained_throughput_per_sec": 154.54747284641132, "timesteps_total": 36736, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 110208, "timers": {"training_iteration_time_ms": 1844.036, "sample_time_ms": 1247.01, "load_time_ms": 0.533, "load_throughput": 483806.694, "learn_time_ms": 61.952, "learn_throughput": 4164.507, "synch_weights_time_ms": 16.913}, "counters": {"num_env_steps_sampled": 36736, "num_env_steps_trained": 10320, "num_agent_steps_sampled": 110208, "num_agent_steps_trained": 10320, "last_target_update_ts": 36736, "num_target_updates": 40}, "done": false, "episodes_total": 0, "training_iteration": 41, "trial_id": "9a806_00000", "date": "2023-11-16_21-54-53", "timestamp": 1700200493, "time_this_iter_s": 1.6843562126159668, "time_total_s": 74.40237522125244, "pid": 45784, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fadd04c93a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 74.40237522125244, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 85.35, "ram_util_percent": 90.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.051791191101074, "actor_loss": -6.756965637207031, "critic_loss": 1.306496024131775, "alpha_loss": -0.12065884470939636, "alpha_value": 0.9880680441856384, "log_alpha_value": -0.012003716081380844, "target_entropy": -6.0, "policy_t": -0.05668910592794418, "mean_q": 3.127758741378784, "max_q": 3.724911689758301, "min_q": 2.570944309234619}, "td_error": [3.6537766456604004, 0.7293756008148193, 1.3540486097335815, 2.8030307292938232, 4.064138412475586, 2.499850273132324, 4.376387119293213, 0.611400842666626, 3.9190709590911865, 3.1846261024475098, 3.7197089195251465, 2.57742977142334, 2.0575056076049805, 2.6972455978393555, 4.601955413818359, 2.576343536376953, 2.110502004623413, 3.3089752197265625, 1.2690200805664062, 1.333971381187439, 2.710087299346924, 1.896404504776001, 1.8093039989471436, 3.0510916709899902, 2.622072458267212, 4.919680595397949, 4.303370952606201, 2.69881534576416, 3.504913806915283, 2.5365469455718994, 2.782961368560791, 2.98367977142334, 2.6360175609588623, 2.3533995151519775, 2.2870264053344727, 3.3249688148498535, 2.5237178802490234, 3.0485177040100098, 2.968289613723755, 2.878873348236084, 3.175197124481201, 1.5997225046157837, 3.1918280124664307, 2.2828989028930664, 3.6834535598754883, 1.1696090698242188, 2.4991469383239746, 3.967343330383301, 2.5910496711730957, 1.9228113889694214, 4.859247207641602, 2.472987651824951, 4.285404205322266, 4.546513080596924, 1.8510627746582031, 2.097423553466797, 3.752333164215088, 3.891566753387451, 2.624173164367676, 2.435079574584961, 2.039461612701416, 2.0591533184051514, 1.9999719858169556, 4.172904968261719, 4.594509601593018, 3.2432732582092285, 2.481961250305176, 3.561708927154541, 3.8516063690185547, 3.3951287269592285, 2.269990921020508, 2.3017771244049072, 1.9246141910552979, 2.88393497467041, 1.6350481510162354, 3.429713249206543, 2.991938591003418, 2.059392213821411, 2.7034201622009277, 1.014415979385376, 2.5632762908935547, 3.7254085540771484, 3.0537590980529785, 1.8821463584899902, 3.5906522274017334, 0.8182070255279541], "mean_td_error": 2.795748233795166, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 41.0, "diff_num_grad_updates_vs_sampler_policy": 40.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.047653198242188, "actor_loss": -6.587678909301758, "critic_loss": 0.34961938858032227, "alpha_loss": -0.12065698951482773, "alpha_value": 0.9880633354187012, "log_alpha_value": -0.01200847513973713, "target_entropy": -6.0, "policy_t": -0.012132576666772366, "mean_q": 2.6421937942504883, "max_q": 3.16876482963562, "min_q": 2.208333969116211}, "td_error": [2.0650463104248047, 0.4695819616317749, 1.602529764175415, 2.806461811065674, 0.475317120552063, 1.9866580963134766, 0.9006615877151489, 0.4339139461517334, 1.5764774084091187, 1.8253238201141357, 0.45352137088775635, 1.2404104471206665, 1.811180591583252, 0.247450590133667, 0.21322286128997803, 0.09695565700531006, 1.6177984476089478, 0.6092109680175781, 0.6798532009124756, 1.8738347291946411, 0.5957469940185547, 1.7873015403747559, 1.7258124351501465, 1.817915439605713, 1.8044520616531372, 1.3520441055297852, 2.662205696105957, 1.6189775466918945, 1.6320440769195557, 1.3112369775772095, 1.6610832214355469, 0.392303466796875, 1.365990161895752, 0.7189180850982666, 1.3098111152648926, 1.5750396251678467, 1.4380707740783691, 2.9994125366210938, 0.23055505752563477, 2.11936092376709, 0.16514992713928223, 0.551834225654602, 2.3466856479644775, 1.8361859321594238, 0.24743247032165527, 1.3769248723983765, 0.2567709684371948, 0.07845067977905273, 0.9895225763320923, 0.9186795949935913, 1.4925904273986816, 3.5948128700256348, 2.0888805389404297, 0.7533215284347534, 0.07586562633514404, 2.6111512184143066, 1.8915550708770752, 1.706207036972046, 0.7256884574890137, 0.3161346912384033, 1.6217278242111206, 2.5606865882873535, 0.7931605577468872, 0.49315547943115234, 0.5552499294281006, 2.021859645843506, 0.8630751371383667, 1.7103849649429321, 3.276998996734619, 2.453594207763672, 0.8846246004104614, 0.5722602605819702, 1.6117032766342163, 1.1847560405731201, 0.6715887784957886, 0.7069628238677979, 1.9619197845458984, 0.5649392604827881, 1.5875539779663086, 0.43863534927368164, 0.8936010599136353, 2.108750581741333, 0.8933615684509277, 1.3914440870285034, 1.5508639812469482, 1.2942348718643188], "mean_td_error": 1.2999374866485596, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 41.0, "diff_num_grad_updates_vs_sampler_policy": 40.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.098888397216797, "actor_loss": -6.465874195098877, "critic_loss": 0.2861362099647522, "alpha_loss": -0.12122922390699387, "alpha_value": 0.9880675673484802, "log_alpha_value": -0.012004215270280838, "target_entropy": -6.0, "policy_t": -0.02159810997545719, "mean_q": 2.4660050868988037, "max_q": 2.8833250999450684, "min_q": 2.0534822940826416}, "td_error": [2.534118175506592, 2.467743396759033, 0.3468019962310791, 1.138651728630066, 1.3243424892425537, 1.9475570917129517, 1.451224684715271, 1.7271199226379395, 2.0013375282287598, 2.235623836517334, 2.2146084308624268, 1.6247502565383911, 0.19990408420562744, 1.252814531326294, 0.3289499282836914, 0.7439080476760864, 0.9450799226760864, 1.7862273454666138, 0.6237225532531738, 1.3190535306930542, 0.7314585447311401, 1.9522310495376587, 4.138245582580566, 2.228877544403076, 2.3383703231811523, 0.2909892797470093, 1.2110624313354492, 1.3750423192977905, 3.6675915718078613, 1.9477323293685913, 1.8217378854751587, 1.789605975151062, 1.495266318321228, 1.393844485282898, 2.58787202835083, 2.2424235343933105, 0.3269827365875244, 1.3019448518753052, 2.570376396179199, 2.0038259029388428, 0.3375213146209717, 2.0134005546569824, 1.0923738479614258, 0.7854377031326294, 0.07666647434234619, 2.7297558784484863, 0.7326923608779907, 1.1377352476119995, 3.457324504852295, 0.07801449298858643, 1.7452466487884521, 1.8251643180847168, 1.5015301704406738, 1.1102577447891235, 2.8307156562805176, 0.32426750659942627, 1.1582266092300415, 1.1450546979904175, 0.05621981620788574, 1.3624598979949951, 1.9189358949661255, 0.1560347080230713, 1.6787748336791992, 1.1939142942428589, 1.8462899923324585, 1.0598735809326172, 1.394124984741211, 1.2003930807113647, 0.9851185083389282, 2.928098440170288, 0.6329771280288696, 1.8135415315628052, 1.2085325717926025, 2.2969655990600586, 0.05958378314971924, 0.6861680746078491, 0.6187789440155029, 2.882701873779297, 0.5575506687164307, 0.7792626619338989, 2.0081028938293457, 1.58180832862854, 1.24567449092865, 1.7171937227249146, 3.1087725162506104, 0.3088223934173584], "mean_td_error": 1.4767102003097534, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 41.0, "diff_num_grad_updates_vs_sampler_policy": 40.0}}, "num_env_steps_sampled": 37632, "num_env_steps_trained": 10578, "num_agent_steps_sampled": 112896, "num_agent_steps_trained": 10578, "last_target_update_ts": 37632, "num_target_updates": 41}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112896, "num_agent_steps_trained": 10578, "num_env_steps_sampled": 37632, "num_env_steps_trained": 10578, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 513.7379525183245, "num_env_steps_trained_throughput_per_sec": 147.92900864924968, "timesteps_total": 37632, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 112896, "timers": {"training_iteration_time_ms": 1851.589, "sample_time_ms": 1257.039, "load_time_ms": 0.523, "load_throughput": 493357.542, "learn_time_ms": 61.378, "learn_throughput": 4203.472, "synch_weights_time_ms": 15.873}, "counters": {"num_env_steps_sampled": 37632, "num_env_steps_trained": 10578, "num_agent_steps_sampled": 112896, "num_agent_steps_trained": 10578, "last_target_update_ts": 37632, "num_target_updates": 41}, "done": false, "episodes_total": 0, "training_iteration": 42, "trial_id": "9a806_00000", "date": "2023-11-16_21-54-54", "timestamp": 1700200494, "time_this_iter_s": 1.7578668594360352, "time_total_s": 76.16024208068848, "pid": 45784, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fadd052b5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 76.16024208068848, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 71.83333333333333, "ram_util_percent": 90.23333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.092973709106445, "actor_loss": -6.874245643615723, "critic_loss": 1.239628553390503, "alpha_loss": -0.12418071925640106, "alpha_value": 0.9877716898918152, "log_alpha_value": -0.012303679250180721, "target_entropy": -6.0, "policy_t": 0.01596819795668125, "mean_q": 3.347686529159546, "max_q": 3.9436142444610596, "min_q": 2.828725576400757}, "td_error": [2.611985921859741, 2.134441375732422, 4.051488876342773, 1.2771632671356201, 2.2044825553894043, 4.291996002197266, 3.803654193878174, 3.2997841835021973, 3.376673698425293, 4.1294379234313965, 3.029893398284912, 2.4348838329315186, 4.054713249206543, 1.470859169960022, 3.35306715965271, 2.2808027267456055, 1.5202924013137817, 2.8132731914520264, 3.6258363723754883, 3.263613700866699, 2.600109577178955, 4.029520511627197, 2.141209363937378, 3.198934555053711, 2.3116466999053955, 1.8480215072631836, 1.7504867315292358, 3.474905490875244, 1.2849761247634888, 2.656036376953125, 1.742336630821228, 0.7298359870910645, 3.517019033432007, 2.1500630378723145, 3.3021163940429688, 2.337754249572754, 3.2483816146850586, 1.6558709144592285, 2.3989815711975098, 3.928647518157959, 2.461862087249756, 2.9150595664978027, 4.094038486480713, 1.543958306312561, 1.1915202140808105, 2.825070858001709, 2.735922336578369, 3.0736327171325684, 2.0082719326019287, 3.668083667755127, 1.0155534744262695, 3.86834454536438, 3.049373149871826, 3.0652694702148438, 2.9724602699279785, 3.26483416557312, 2.2658753395080566, 3.075918674468994, 2.5633552074432373, 1.2864198684692383, 2.2669386863708496, 3.3279576301574707, 4.9651079177856445, 1.4895875453948975, 2.2569360733032227, 2.6441617012023926, 2.7482047080993652, 1.974071979522705, 1.7848434448242188, 3.0285074710845947, 3.147109031677246, 2.0375611782073975, 2.9510300159454346, 1.8984346389770508, 3.676926374435425, 3.0522217750549316, 2.1573739051818848, 3.8484485149383545, 1.430599570274353, 4.231266498565674, 2.4204163551330566, 3.7352848052978516, 3.619919776916504, 3.4282848834991455, 3.3743128776550293, 1.8879915475845337], "mean_td_error": 2.7402734756469727, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 42.0, "diff_num_grad_updates_vs_sampler_policy": 41.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.087276458740234, "actor_loss": -6.798642158508301, "critic_loss": 0.375956267118454, "alpha_loss": -0.12415845692157745, "alpha_value": 0.9877670407295227, "log_alpha_value": -0.012308422476053238, "target_entropy": -6.0, "policy_t": -0.008729557506740093, "mean_q": 2.804388999938965, "max_q": 3.357758045196533, "min_q": 2.433326244354248}, "td_error": [1.946049690246582, 0.6243236064910889, 2.147955894470215, 1.726224422454834, 2.36983060836792, 1.1849321126937866, 1.0095058679580688, 0.5258457660675049, 1.3282394409179688, 1.6548880338668823, 0.3052109479904175, 0.052909135818481445, 2.735950231552124, 1.3969920873641968, 0.26772749423980713, 0.4020109176635742, 1.4103264808654785, 0.134820818901062, 0.4014256000518799, 1.8826266527175903, 0.7813273668289185, 1.1935954093933105, 1.1217269897460938, 0.21743083000183105, 3.8846187591552734, 2.2958998680114746, 1.8536150455474854, 1.5290617942810059, 1.4660687446594238, 1.5398579835891724, 1.939802646636963, 1.910265326499939, 0.7630177736282349, 0.5597038269042969, 0.965233564376831, 1.243673324584961, 1.729451060295105, 2.4081602096557617, 2.5051674842834473, 1.3129045963287354, 3.32503342628479, 1.4951019287109375, 0.4427764415740967, 1.2318905591964722, 0.485398530960083, 0.33806943893432617, 0.7089608907699585, 0.9709525108337402, 0.5656640529632568, 0.21048736572265625, 1.7426393032073975, 0.728091835975647, 2.717813491821289, 1.186452031135559, 3.135406017303467, 1.537506341934204, 0.48815810680389404, 0.3881021738052368, 0.37535905838012695, 2.2867181301116943, 2.771115779876709, 0.10815119743347168, 1.6928701400756836, 2.323317527770996, 2.136815071105957, 1.8571677207946777, 1.5474852323532104, 1.1589540243148804, 0.4653559923171997, 1.6049370765686035, 0.12566184997558594, 0.7926000356674194, 1.3769049644470215, 2.887965202331543, 1.2107106447219849, 0.9325023889541626, 1.5606207847595215, 3.035168170928955, 1.1672556400299072, 0.6118202209472656, 3.0397391319274902, 0.613434910774231, 2.1300487518310547, 1.9055908918380737, 0.9556421041488647, 2.333538293838501], "mean_td_error": 1.3887711763381958, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 42.0, "diff_num_grad_updates_vs_sampler_policy": 41.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.121678352355957, "actor_loss": -6.581526756286621, "critic_loss": 0.25525030493736267, "alpha_loss": -0.1245386004447937, "alpha_value": 0.987771213054657, "log_alpha_value": -0.012304143980145454, "target_entropy": -6.0, "policy_t": -0.024945348501205444, "mean_q": 2.610941171646118, "max_q": 3.0505530834198, "min_q": 2.1667022705078125}, "td_error": [0.8199738264083862, 1.0795140266418457, 1.2633203268051147, 1.4876480102539062, 0.11518526077270508, 2.1935229301452637, 2.5184147357940674, 2.1598730087280273, 2.9631521701812744, 0.5492794513702393, 2.962186813354492, 0.2638448476791382, 1.2653716802597046, 3.4710516929626465, 0.6315182447433472, 1.8538200855255127, 1.32901930809021, 2.593775510787964, 1.094672441482544, 1.4009699821472168, 1.341344952583313, 1.2255951166152954, 2.6160614490509033, 0.2794189453125, 0.14417386054992676, 1.5970337390899658, 1.6409088373184204, 1.4527182579040527, 0.72745680809021, 1.1924244165420532, 1.6573394536972046, 4.0645294189453125, 0.20923840999603271, 0.3283116817474365, 0.14959096908569336, 0.19528496265411377, 0.9359438419342041, 0.21268796920776367, 1.395527720451355, 0.4551246166229248, 1.281293272972107, 0.21576213836669922, 2.671030044555664, 1.6345469951629639, 1.2739639282226562, 2.400663375854492, 0.72757887840271, 1.4137868881225586, 0.4478708505630493, 1.872117042541504, 0.9705687761306763, 2.1553897857666016, 0.5534545183181763, 0.11327159404754639, 1.4257948398590088, 1.3208885192871094, 2.107956886291504, 0.3799506425857544, 1.7251818180084229, 0.5164177417755127, 1.7575359344482422, 0.4926743507385254, 1.1355230808258057, 2.202730417251587, 2.332732915878296, 1.251444697380066, 0.8646038770675659, 1.2751975059509277, 0.5176831483840942, 1.9070682525634766, 1.4104593992233276, 2.0934133529663086, 1.8445913791656494, 0.9140231609344482, 2.818922519683838, 1.5026789903640747, 2.1749684810638428, 0.9045438766479492, 2.0464446544647217, 0.8615672588348389, 1.6954072713851929, 3.0148611068725586, 0.953945517539978, 0.2270069122314453, 0.21085798740386963, 0.4915362596511841], "mean_td_error": 1.3482179641723633, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 42.0, "diff_num_grad_updates_vs_sampler_policy": 41.0}}, "num_env_steps_sampled": 38528, "num_env_steps_trained": 10836, "num_agent_steps_sampled": 115584, "num_agent_steps_trained": 10836, "last_target_update_ts": 38528, "num_target_updates": 42}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 115584, "num_agent_steps_trained": 10836, "num_env_steps_sampled": 38528, "num_env_steps_trained": 10836, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 520.2496780016722, "num_env_steps_trained_throughput_per_sec": 149.80403674601723, "timesteps_total": 38528, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 115584, "timers": {"training_iteration_time_ms": 1810.95, "sample_time_ms": 1219.87, "load_time_ms": 0.523, "load_throughput": 493740.216, "learn_time_ms": 61.234, "learn_throughput": 4213.331, "synch_weights_time_ms": 15.604}, "counters": {"num_env_steps_sampled": 38528, "num_env_steps_trained": 10836, "num_agent_steps_sampled": 115584, "num_agent_steps_trained": 10836, "last_target_update_ts": 38528, "num_target_updates": 42}, "done": false, "episodes_total": 0, "training_iteration": 43, "trial_id": "9a806_00000", "date": "2023-11-16_21-54-56", "timestamp": 1700200496, "time_this_iter_s": 1.738581895828247, "time_total_s": 77.89882397651672, "pid": 45784, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fadd05268b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 77.89882397651672, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 85.15, "ram_util_percent": 90.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.056857109069824, "actor_loss": -7.062306880950928, "critic_loss": 1.091800332069397, "alpha_loss": -0.12675321102142334, "alpha_value": 0.9874754548072815, "log_alpha_value": -0.012603660114109516, "target_entropy": -6.0, "policy_t": 0.019674358889460564, "mean_q": 3.475334405899048, "max_q": 3.9876060485839844, "min_q": 2.8508119583129883}, "td_error": [2.218191623687744, 2.2379918098449707, 2.8567724227905273, 2.355259895324707, 2.9151151180267334, 2.3142852783203125, 2.789794445037842, 1.5693066120147705, 0.25569939613342285, 2.529695987701416, 2.6913466453552246, 3.255077838897705, 2.762091636657715, 0.2901867628097534, 3.5449724197387695, 1.8819189071655273, 0.7191472053527832, 2.1624107360839844, 3.468484878540039, 0.9532508850097656, 3.2662625312805176, 2.52291202545166, 1.5425969362258911, 0.3370743989944458, 1.896541953086853, 2.9770421981811523, 1.6635072231292725, 4.134771347045898, 1.8185876607894897, 1.4432978630065918, 3.572474479675293, 3.5982131958007812, 2.858086109161377, 1.7420523166656494, 0.4370774030685425, 3.3718461990356445, 1.8085920810699463, 2.780280113220215, 1.8600505590438843, 2.250993251800537, 1.862154245376587, 2.1011595726013184, 2.992290496826172, 2.507122278213501, 3.3554117679595947, 1.1285250186920166, 1.3949881792068481, 0.820986270904541, 0.3158177137374878, 2.777683734893799, 1.7038336992263794, 4.35107421875, 2.9678585529327393, 2.9040331840515137, 2.0811009407043457, 3.1042532920837402, 1.297221302986145, 4.1881327629089355, 2.7352442741394043, 3.0210514068603516, 4.191611289978027, 3.64736008644104, 3.4227657318115234, 2.6018905639648438, 1.7652015686035156, 2.0265345573425293, 4.04451847076416, 2.386058807373047, 1.5584123134613037, 2.7817015647888184, 1.182834267616272, 2.7078938484191895, 2.1067874431610107, 1.858506679534912, 2.341381072998047, 2.4265332221984863, 2.760146141052246, 1.4402985572814941, 3.0795443058013916, 3.6968908309936523, 0.8574552536010742, 2.389993190765381, 2.7431159019470215, 3.1657567024230957, 4.499423027038574, 2.511758327484131], "mean_td_error": 2.3890416622161865, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 43.0, "diff_num_grad_updates_vs_sampler_policy": 42.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.064781188964844, "actor_loss": -6.920900344848633, "critic_loss": 0.2720496654510498, "alpha_loss": -0.12690052390098572, "alpha_value": 0.987470805644989, "log_alpha_value": -0.01260837446898222, "target_entropy": -6.0, "policy_t": -0.01940583623945713, "mean_q": 3.0169003009796143, "max_q": 3.6890194416046143, "min_q": 2.5734810829162598}, "td_error": [0.2232908010482788, 0.4449833631515503, 1.099545955657959, 0.9905625581741333, 0.3554356098175049, 0.6226791143417358, 0.33012938499450684, 0.3159918785095215, 0.36415839195251465, 1.2824136018753052, 1.6475512981414795, 2.901298999786377, 1.1884970664978027, 0.8487718105316162, 0.4526759386062622, 0.294586181640625, 1.783240556716919, 0.9646801948547363, 1.2054849863052368, 0.9716432094573975, 0.3159297704696655, 1.5619621276855469, 1.1167622804641724, 0.24617385864257812, 0.8238939046859741, 2.2788639068603516, 1.8634973764419556, 1.548276662826538, 3.535339593887329, 0.32068121433258057, 0.6859968900680542, 0.12707805633544922, 2.315075159072876, 1.2504184246063232, 1.6762642860412598, 0.3830519914627075, 1.7696330547332764, 1.0721160173416138, 2.252678394317627, 0.783784031867981, 1.1732933521270752, 0.3255044221878052, 1.3207565546035767, 0.7569583654403687, 3.5159859657287598, 0.4507380723953247, 2.631350040435791, 0.43639039993286133, 0.6095211505889893, 0.33939099311828613, 0.6899322271347046, 0.5545965433120728, 0.6212825775146484, 0.7974299192428589, 2.073322296142578, 0.775570273399353, 0.22358858585357666, 0.11945843696594238, 1.9286295175552368, 1.3976722955703735, 0.835411548614502, 0.13324451446533203, 0.38577961921691895, 0.11576652526855469, 0.6500812768936157, 1.1342706680297852, 0.09728133678436279, 0.0156935453414917, 2.4886887073516846, 0.9523555040359497, 0.42504847049713135, 1.2169232368469238, 1.7349812984466553, 0.5950061082839966, 0.20032334327697754, 2.0062618255615234, 0.14480054378509521, 1.634777307510376, 0.3941354751586914, 1.1547842025756836, 0.4608815908432007, 3.357243537902832, 2.8129642009735107, 2.0266294479370117, 1.3994070291519165, 0.3850889205932617], "mean_td_error": 1.0664453506469727, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 43.0, "diff_num_grad_updates_vs_sampler_policy": 42.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.099346160888672, "actor_loss": -6.719147205352783, "critic_loss": 0.1801030933856964, "alpha_loss": -0.12729360163211823, "alpha_value": 0.9874749779701233, "log_alpha_value": -0.012604144401848316, "target_entropy": -6.0, "policy_t": 0.008599666878581047, "mean_q": 2.7510881423950195, "max_q": 3.249699592590332, "min_q": 2.2917656898498535}, "td_error": [1.1909434795379639, 1.128556251525879, 0.21381235122680664, 1.2288848161697388, 0.36731839179992676, 0.5016230344772339, 0.7577111721038818, 1.6695836782455444, 0.6985117197036743, 0.3076237440109253, 0.47306036949157715, 0.26642537117004395, 0.5603888034820557, 1.4080729484558105, 0.9109315872192383, 0.4739176034927368, 0.13437044620513916, 1.8573064804077148, 0.8346627950668335, 2.458183765411377, 1.5003780126571655, 0.24462831020355225, 0.8758480548858643, 1.2969485521316528, 1.1856558322906494, 1.3220701217651367, 0.4451686143875122, 0.5223841667175293, 1.5517537593841553, 1.6862871646881104, 0.579470157623291, 1.3054964542388916, 0.7421470880508423, 1.4808475971221924, 0.05576598644256592, 0.8399691581726074, 0.7430555820465088, 2.0196890830993652, 2.0974254608154297, 1.7028357982635498, 1.347720742225647, 1.1674100160598755, 1.9219800233840942, 2.788146495819092, 0.4175046682357788, 0.09157514572143555, 2.0437047481536865, 1.6139013767242432, 0.5386724472045898, 1.5805467367172241, 1.6488146781921387, 1.0353742837905884, 1.0478122234344482, 0.3401528596878052, 1.7698743343353271, 0.4375976324081421, 1.5396111011505127, 0.5020134449005127, 1.2822637557983398, 1.4908380508422852, 2.286512851715088, 1.6628235578536987, 1.1583969593048096, 0.9003400802612305, 0.5593998432159424, 0.6044623851776123, 0.4797501564025879, 0.774836540222168, 1.7515679597854614, 0.6981804370880127, 1.1196916103363037, 0.6791675090789795, 0.7253818511962891, 0.2758578062057495, 0.7521311044692993, 1.1820580959320068, 1.6036200523376465, 0.05880939960479736, 1.7641557455062866, 1.1547389030456543, 1.4426653385162354, 0.59954833984375, 1.3812886476516724, 2.798322916030884, 2.3881592750549316, 0.586394190788269], "mean_td_error": 1.088761568069458, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 43.0, "diff_num_grad_updates_vs_sampler_policy": 42.0}}, "num_env_steps_sampled": 39424, "num_env_steps_trained": 11094, "num_agent_steps_sampled": 118272, "num_agent_steps_trained": 11094, "last_target_update_ts": 39424, "num_target_updates": 43}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 118272, "num_agent_steps_trained": 11094, "num_env_steps_sampled": 39424, "num_env_steps_trained": 11094, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 473.437580657434, "num_env_steps_trained_throughput_per_sec": 136.32466050180577, "timesteps_total": 39424, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 118272, "timers": {"training_iteration_time_ms": 1832.8, "sample_time_ms": 1242.359, "load_time_ms": 0.521, "load_throughput": 495662.528, "learn_time_ms": 61.158, "learn_throughput": 4218.554, "synch_weights_time_ms": 15.47}, "counters": {"num_env_steps_sampled": 39424, "num_env_steps_trained": 11094, "num_agent_steps_sampled": 118272, "num_agent_steps_trained": 11094, "last_target_update_ts": 39424, "num_target_updates": 43}, "done": false, "episodes_total": 0, "training_iteration": 44, "trial_id": "9a806_00000", "date": "2023-11-16_21-54-58", "timestamp": 1700200498, "time_this_iter_s": 1.909843921661377, "time_total_s": 79.8086678981781, "pid": 45784, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fadd052bca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 79.8086678981781, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 75.63333333333334, "ram_util_percent": 90.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.066963195800781, "actor_loss": -7.20046854019165, "critic_loss": 0.9753708839416504, "alpha_loss": -0.12989981472492218, "alpha_value": 0.9871793389320374, "log_alpha_value": -0.012903573922812939, "target_entropy": -6.0, "policy_t": -0.01322136539965868, "mean_q": 3.742515802383423, "max_q": 4.452603340148926, "min_q": 3.1301889419555664}, "td_error": [2.5756711959838867, 1.320896029472351, 1.3231390714645386, 4.250787734985352, 2.0666093826293945, 3.376448392868042, 2.4980926513671875, 3.749136447906494, 1.1758769750595093, 2.9991111755371094, 4.499309539794922, 2.6881141662597656, 0.3322104215621948, 0.7079219818115234, 1.1063015460968018, 4.051111698150635, 3.730959177017212, 0.8588616847991943, 2.186969518661499, 2.529764175415039, 4.207568168640137, 3.0873172283172607, 1.3971713781356812, 1.9487680196762085, 1.2986454963684082, 2.715355396270752, 4.51239538192749, 2.0886645317077637, 1.7048611640930176, 0.5281381607055664, 2.186008930206299, 2.990358829498291, 3.714343547821045, 1.3469781875610352, 2.08221435546875, 0.1501072645187378, 2.2659430503845215, 1.3499127626419067, 2.915163516998291, 1.7111854553222656, 2.330181121826172, 3.425835609436035, 1.4503562450408936, 4.371455192565918, 0.4354482889175415, 1.5357846021652222, 0.932786226272583, 0.17588448524475098, 2.1791470050811768, 1.1596589088439941, 2.1240997314453125, 2.894969940185547, 0.6405855417251587, 1.5055887699127197, 3.1548752784729004, 2.674149513244629, 3.1613354682922363, 1.6775373220443726, 2.6754698753356934, 0.31102681159973145, 3.5666818618774414, 2.9699270725250244, 2.490422248840332, 1.8282114267349243, 3.2414674758911133, 1.637035846710205, 1.9271429777145386, 2.5564866065979004, 0.8025174140930176, 2.6304633617401123, 3.370262622833252, 2.992427110671997, 3.088747024536133, 2.6682887077331543, 3.315376043319702, 3.093383312225342, 2.780148983001709, 0.3014793395996094, 2.585636615753174, 1.5393648147583008, 0.4600483179092407, 2.1092963218688965, 1.472076654434204, 1.765701174736023, 3.5142197608947754, 0.8928118944168091], "mean_td_error": 2.2167930603027344, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 44.0, "diff_num_grad_updates_vs_sampler_policy": 43.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.02334213256836, "actor_loss": -7.077503204345703, "critic_loss": 0.20462413132190704, "alpha_loss": -0.1293841004371643, "alpha_value": 0.9871746897697449, "log_alpha_value": -0.012908278033137321, "target_entropy": -6.0, "policy_t": -0.04263598844408989, "mean_q": 3.165792465209961, "max_q": 3.894336223602295, "min_q": 2.620293617248535}, "td_error": [0.33681440353393555, 1.852311372756958, 1.6871193647384644, 0.5034115314483643, 1.6667406558990479, 0.21966540813446045, 0.20144248008728027, 0.16002929210662842, 0.24079835414886475, 0.4166504144668579, 0.4865880012512207, 0.27313709259033203, 0.7741614580154419, 0.14033401012420654, 1.262101650238037, 0.43555760383605957, 0.6025158166885376, 0.7617940902709961, 0.7002424001693726, 0.46391236782073975, 0.3446168899536133, 0.2391674518585205, 1.590925931930542, 0.05203664302825928, 1.6789847612380981, 0.6451220512390137, 1.0733864307403564, 0.7215487957000732, 0.3636288642883301, 0.5761744976043701, 0.18035948276519775, 1.385383129119873, 1.8090126514434814, 1.1653207540512085, 2.6586127281188965, 0.05164682865142822, 2.031905174255371, 2.0153098106384277, 0.720649003982544, 1.3775835037231445, 0.46250152587890625, 1.60443913936615, 1.2941704988479614, 0.7081388235092163, 1.1553305387496948, 0.9109631776809692, 0.7092612981796265, 0.8883856534957886, 1.61258065700531, 0.4499446153640747, 1.21700918674469, 0.07950806617736816, 1.4830818176269531, 0.2696787118911743, 1.7838051319122314, 0.6294203996658325, 0.3252229690551758, 0.7200484275817871, 0.6416836977005005, 1.9427891969680786, 1.1057995557785034, 2.7026753425598145, 2.4743971824645996, 0.14717316627502441, 0.9496607780456543, 0.9969022274017334, 1.6876659393310547, 0.3104746341705322, 0.5906041860580444, 2.3522236347198486, 0.7953312397003174, 0.40348291397094727, 0.3684558868408203, 1.5498484373092651, 0.7518024444580078, 1.022339105606079, 1.8589200973510742, 0.395591139793396, 1.8216273784637451, 0.8803099393844604, 1.2217907905578613, 1.9441192150115967, 1.8601412773132324, 2.4423441886901855, 0.041042327880859375, 0.46237683296203613], "mean_td_error": 0.9754856824874878, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 44.0, "diff_num_grad_updates_vs_sampler_policy": 43.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.140270233154297, "actor_loss": -6.917379856109619, "critic_loss": 0.20674145221710205, "alpha_loss": -0.1308516263961792, "alpha_value": 0.9871787428855896, "log_alpha_value": -0.012904155999422073, "target_entropy": -6.0, "policy_t": -0.018393032252788544, "mean_q": 2.8676023483276367, "max_q": 3.409968614578247, "min_q": 2.3672382831573486}, "td_error": [2.8557703495025635, 1.475234031677246, 0.2443680763244629, 1.1895197629928589, 2.9724392890930176, 1.6996346712112427, 1.093152403831482, 0.6705338954925537, 2.0633649826049805, 0.4564250707626343, 0.5558280944824219, 1.3019249439239502, 1.162274956703186, 1.0804107189178467, 0.20557630062103271, 0.5922214984893799, 2.450259208679199, 1.8575150966644287, 0.4011356830596924, 1.4820727109909058, 0.61485755443573, 0.01721799373626709, 0.49157607555389404, 1.048819899559021, 2.404750347137451, 0.7132338285446167, 1.0164906978607178, 0.18349730968475342, 1.3779886960983276, 1.4596617221832275, 0.9380530118942261, 1.3326678276062012, 0.20354104042053223, 0.09196150302886963, 2.233083963394165, 1.1116400957107544, 1.1796938180923462, 2.177435874938965, 1.889351487159729, 0.6899152994155884, 0.7550781965255737, 0.5815612077713013, 0.3848397731781006, 1.537793755531311, 0.10955214500427246, 2.6846084594726562, 0.6587249040603638, 2.086622714996338, 0.8874304294586182, 1.4688138961791992, 0.24102985858917236, 2.9146766662597656, 1.179686427116394, 1.0727633237838745, 0.09824669361114502, 2.0938172340393066, 1.776851773262024, 0.34760892391204834, 0.8359185457229614, 0.8090924024581909, 2.249070644378662, 2.1667861938476562, 2.5061991214752197, 2.505997657775879, 0.23358666896820068, 1.028122901916504, 0.658582329750061, 1.743080973625183, 0.13957762718200684, 1.3392761945724487, 0.7610558271408081, 2.1008429527282715, 0.9665868282318115, 1.0347747802734375, 1.4409340620040894, 1.0344198942184448, 1.1120316982269287, 0.5779479742050171, 1.9556517601013184, 1.452048897743225, 1.2909969091415405, 0.6163835525512695, 0.6739538908004761, 0.5961835384368896, 1.9324697256088257, 0.26685988903045654], "mean_td_error": 1.184805154800415, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 44.0, "diff_num_grad_updates_vs_sampler_policy": 43.0}}, "num_env_steps_sampled": 40320, "num_env_steps_trained": 11352, "num_agent_steps_sampled": 120960, "num_agent_steps_trained": 11352, "last_target_update_ts": 40320, "num_target_updates": 44}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120960, "num_agent_steps_trained": 11352, "num_env_steps_sampled": 40320, "num_env_steps_trained": 11352, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 491.05306542924814, "num_env_steps_trained_throughput_per_sec": 141.39697642940405, "timesteps_total": 40320, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 120960, "timers": {"training_iteration_time_ms": 1799.318, "sample_time_ms": 1212.896, "load_time_ms": 0.521, "load_throughput": 495344.883, "learn_time_ms": 61.111, "learn_throughput": 4221.805, "synch_weights_time_ms": 15.521}, "counters": {"num_env_steps_sampled": 40320, "num_env_steps_trained": 11352, "num_agent_steps_sampled": 120960, "num_agent_steps_trained": 11352, "last_target_update_ts": 40320, "num_target_updates": 44}, "done": false, "episodes_total": 0, "training_iteration": 45, "trial_id": "9a806_00000", "date": "2023-11-16_21-55-00", "timestamp": 1700200500, "time_this_iter_s": 1.840210199356079, "time_total_s": 81.64887809753418, "pid": 45784, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fadd052b5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 81.64887809753418, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 78.7, "ram_util_percent": 90.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.041444778442383, "actor_loss": -7.372886657714844, "critic_loss": 0.912875771522522, "alpha_loss": -0.13258174061775208, "alpha_value": 0.9868833422660828, "log_alpha_value": -0.013203451409935951, "target_entropy": -6.0, "policy_t": 0.009563403204083443, "mean_q": 3.9632015228271484, "max_q": 4.655019760131836, "min_q": 3.373746633529663}, "td_error": [4.166140079498291, 2.5852394104003906, 2.394561529159546, 2.4443135261535645, 2.680962085723877, 0.27738237380981445, 2.335639476776123, 2.4036805629730225, 0.45516204833984375, 3.0710368156433105, 1.303411602973938, 1.3230839967727661, 2.4221363067626953, 0.432942271232605, 1.2849785089492798, 0.2910897731781006, 2.4008960723876953, 0.3891301155090332, 2.0405073165893555, 3.303793430328369, 0.8699245452880859, 2.1459624767303467, 1.4224419593811035, 0.8053481578826904, 0.7124357223510742, 2.636308431625366, 2.676332950592041, 2.122584581375122, 2.3956501483917236, 1.9701805114746094, 3.5371415615081787, 1.9241682291030884, 1.4975309371948242, 2.9014012813568115, 3.2559897899627686, 3.365133047103882, 4.002446174621582, 2.0007410049438477, 3.5708131790161133, 2.0251216888427734, 0.4086683988571167, 1.4064127206802368, 0.21015453338623047, 4.510468006134033, 0.3398761749267578, 3.663330554962158, 1.473621129989624, 4.393885612487793, 3.5216856002807617, 2.193655490875244, 1.919386625289917, 1.8756539821624756, 1.9013755321502686, 1.7071791887283325, 3.629060983657837, 2.280971050262451, 3.4682741165161133, 0.3788301944732666, 1.8450567722320557, 0.3443336486816406, 2.08435320854187, 3.273679733276367, 1.4709651470184326, 3.5128676891326904, 4.406431674957275, 1.5865064859390259, 0.5273905992507935, 2.838343620300293, 2.4591774940490723, 0.22819995880126953, 3.106602668762207, 2.4915947914123535, 0.38289332389831543, 1.5800824165344238, 1.314407229423523, 2.2369446754455566, 3.048837661743164, 2.3882720470428467, 1.042146921157837, 2.9682822227478027, 1.0820528268814087, 2.4071085453033447, 2.7517168521881104, 3.5791988372802734, 2.4494428634643555, 2.7120659351348877], "mean_td_error": 2.130758285522461, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 45.0, "diff_num_grad_updates_vs_sampler_policy": 44.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.063215255737305, "actor_loss": -7.250366687774658, "critic_loss": 0.1754780262708664, "alpha_loss": -0.13291537761688232, "alpha_value": 0.9868788123130798, "log_alpha_value": -0.01320804376155138, "target_entropy": -6.0, "policy_t": 0.05172991752624512, "mean_q": 3.304748296737671, "max_q": 4.0113654136657715, "min_q": 2.7838456630706787}, "td_error": [0.28220677375793457, 0.26191675662994385, 1.180185317993164, 1.7862310409545898, 2.6091575622558594, 0.9501355886459351, 0.35912978649139404, 1.3872870206832886, 2.009796142578125, 0.34826087951660156, 0.2946333885192871, 0.23632264137268066, 0.7652840614318848, 0.9099829196929932, 2.1890432834625244, 1.5155576467514038, 0.6606264114379883, 0.21497750282287598, 0.9074873924255371, 1.8790615797042847, 0.2521483898162842, 0.41267359256744385, 1.9524275064468384, 0.6344659328460693, 1.1772048473358154, 0.6846479177474976, 0.4733940362930298, 0.7658755779266357, 0.7041362524032593, 0.5769222974777222, 0.11022496223449707, 0.36073148250579834, 2.1050877571105957, 0.7435257434844971, 1.712402105331421, 1.3247779607772827, 1.029931902885437, 0.40210068225860596, 1.1157469749450684, 0.11543512344360352, 0.23409438133239746, 1.0028125047683716, 0.3211038112640381, 2.4514665603637695, 0.21166300773620605, 0.4534505605697632, 0.7542119026184082, 1.6312367916107178, 2.641817569732666, 0.27137696743011475, 0.9915828704833984, 1.4962304830551147, 0.2817639112472534, 0.8501800298690796, 1.8595279455184937, 1.0128296613693237, 0.424596905708313, 0.4694664478302002, 1.4478026628494263, 0.816375732421875, 0.6207910776138306, 0.8723896741867065, 1.525760531425476, 1.2063148021697998, 0.4814213514328003, 1.9728186130523682, 1.343422770500183, 1.2034584283828735, 0.881443977355957, 0.7429091930389404, 1.0741534233093262, 0.09013152122497559, 1.0962073802947998, 1.0203723907470703, 0.14095568656921387, 0.43862199783325195, 0.05002701282501221, 0.29374265670776367, 0.5263419151306152, 0.856609582901001, 0.5996367931365967, 0.7812790870666504, 0.3649557828903198, 0.6393585205078125, 0.6065016984939575, 0.5579209327697754], "mean_td_error": 0.8954916596412659, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 45.0, "diff_num_grad_updates_vs_sampler_policy": 44.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.044346809387207, "actor_loss": -6.984181880950928, "critic_loss": 0.20012463629245758, "alpha_loss": -0.13262829184532166, "alpha_value": 0.9868825078010559, "log_alpha_value": -0.013204271905124187, "target_entropy": -6.0, "policy_t": -0.05448991805315018, "mean_q": 3.0227742195129395, "max_q": 3.402276039123535, "min_q": 2.4922842979431152}, "td_error": [1.5583542585372925, 0.39125382900238037, 1.111345887184143, 0.9923903942108154, 1.4298382997512817, 0.1021343469619751, 2.150603771209717, 0.45154619216918945, 2.6885409355163574, 0.5265712738037109, 1.297885775566101, 1.1722569465637207, 1.1373333930969238, 1.5242899656295776, 0.8812929391860962, 0.203180193901062, 2.094240665435791, 0.11780416965484619, 0.5309998989105225, 0.9098576307296753, 0.6166542768478394, 3.284853935241699, 0.9522141218185425, 0.7150930166244507, 0.737421989440918, 1.8580323457717896, 2.8582382202148438, 0.9687429666519165, 0.8626233339309692, 1.433647632598877, 1.6963119506835938, 1.0300604104995728, 0.6840380430221558, 0.8054690361022949, 0.10378098487854004, 0.7848290205001831, 0.23404145240783691, 1.8094218969345093, 2.1038079261779785, 1.963637113571167, 0.8241691589355469, 1.3454890251159668, 1.332187294960022, 3.1484618186950684, 0.6996999979019165, 1.9367533922195435, 0.5041706562042236, 1.8671644926071167, 0.6317698955535889, 0.07292437553405762, 0.16324889659881592, 1.1994647979736328, 1.7436249256134033, 0.18741953372955322, 0.4977020025253296, 2.96789288520813, 0.840523362159729, 0.6277223825454712, 0.6642022132873535, 0.5435826778411865, 1.914088487625122, 1.2653018236160278, 1.3502519130706787, 1.542822241783142, 1.6367155313491821, 1.4716216325759888, 2.420267343521118, 0.8905670642852783, 2.3054678440093994, 0.9819203615188599, 0.39226067066192627, 0.102164626121521, 1.3663513660430908, 0.17503273487091064, 1.7696223258972168, 0.22874760627746582, 0.758197546005249, 1.9469655752182007, 0.32629942893981934, 0.7383458614349365, 1.5087555646896362, 0.8481009006500244, 1.1993836164474487, 0.3155033588409424, 1.0970152616500854, 2.0206565856933594], "mean_td_error": 1.1528517007827759, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 45.0, "diff_num_grad_updates_vs_sampler_policy": 44.0}}, "num_env_steps_sampled": 41216, "num_env_steps_trained": 11610, "num_agent_steps_sampled": 123648, "num_agent_steps_trained": 11610, "last_target_update_ts": 41216, "num_target_updates": 45}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 123648, "num_agent_steps_trained": 11610, "num_env_steps_sampled": 41216, "num_env_steps_trained": 11610, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 486.69703640447085, "num_env_steps_trained_throughput_per_sec": 140.14267342896594, "timesteps_total": 41216, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 123648, "timers": {"training_iteration_time_ms": 1808.605, "sample_time_ms": 1221.134, "load_time_ms": 0.518, "load_throughput": 497851.689, "learn_time_ms": 61.151, "learn_throughput": 4219.097, "synch_weights_time_ms": 16.142}, "counters": {"num_env_steps_sampled": 41216, "num_env_steps_trained": 11610, "num_agent_steps_sampled": 123648, "num_agent_steps_trained": 11610, "last_target_update_ts": 41216, "num_target_updates": 45}, "done": false, "episodes_total": 0, "training_iteration": 46, "trial_id": "9a806_00000", "date": "2023-11-16_21-55-02", "timestamp": 1700200502, "time_this_iter_s": 1.8560917377471924, "time_total_s": 83.50496983528137, "pid": 45784, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fadd04f4d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 83.50496983528137, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 93.1, "ram_util_percent": 90.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.111553192138672, "actor_loss": -7.607436656951904, "critic_loss": 0.7706146240234375, "alpha_loss": -0.13653869926929474, "alpha_value": 0.9865875244140625, "log_alpha_value": -0.013503237627446651, "target_entropy": -6.0, "policy_t": -0.021826818585395813, "mean_q": 4.118417263031006, "max_q": 4.765442371368408, "min_q": 3.6088664531707764}, "td_error": [0.8700590133666992, 1.9914016723632812, 0.746277928352356, 2.1434459686279297, 2.0429396629333496, 1.2691924571990967, 0.4723871946334839, 1.8031638860702515, 1.721519947052002, 0.674095869064331, 2.0757298469543457, 0.9511055946350098, 3.02618408203125, 3.5030720233917236, 2.038461208343506, 2.313591957092285, 0.6492682695388794, 1.385636329650879, 1.8224964141845703, 1.9813191890716553, 4.3127899169921875, 0.7581076622009277, 2.617180824279785, 2.137087345123291, 1.73716139793396, 1.587834119796753, 0.6894111633300781, 1.9517135620117188, 2.953139305114746, 2.3314766883850098, 0.19766879081726074, 0.8024685382843018, 2.2851333618164062, 0.825908899307251, 1.7227652072906494, 2.9500372409820557, 2.009401321411133, 0.14492511749267578, 1.3842647075653076, 1.788710594177246, 2.648568630218506, 3.4996755123138428, 0.40322768688201904, 3.5991973876953125, 2.1841201782226562, 0.7364826202392578, 2.9292802810668945, 2.1417579650878906, 1.6714556217193604, 2.5678048133850098, 3.0425214767456055, 4.043365478515625, 1.5754914283752441, 1.6526936292648315, 2.2148146629333496, 0.9652969837188721, 1.659296989440918, 0.4711740016937256, 0.5338681936264038, 1.3715393543243408, 3.3503808975219727, 0.41351985931396484, 1.7265530824661255, 1.9891612529754639, 2.461606979370117, 2.4602441787719727, 2.180001735687256, 2.6791913509368896, 1.1964540481567383, 2.9520797729492188, 2.378830909729004, 1.646933913230896, 0.446091890335083, 0.27989983558654785, 3.1361966133117676, 0.7394434213638306, 1.0363845825195312, 1.3212344646453857, 2.1168293952941895, 1.147910475730896, 0.19789838790893555, 1.2441425323486328, 2.2646420001983643, 2.659313440322876, 2.2886240482330322, 1.1587777137756348], "mean_td_error": 1.7913084030151367, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 46.0, "diff_num_grad_updates_vs_sampler_policy": 45.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.044407844543457, "actor_loss": -7.444125652313232, "critic_loss": 0.17725564539432526, "alpha_loss": -0.13567765057086945, "alpha_value": 0.9865830540657043, "log_alpha_value": -0.013507780618965626, "target_entropy": -6.0, "policy_t": -0.0016285255551338196, "mean_q": 3.501539468765259, "max_q": 4.183344841003418, "min_q": 3.1460635662078857}, "td_error": [1.1145490407943726, 2.6091220378875732, 0.22263765335083008, 0.7557046413421631, 0.4314107894897461, 2.500901222229004, 0.9340161085128784, 0.716070294380188, 0.2949143648147583, 1.2784080505371094, 0.8141651153564453, 0.5007643699645996, 1.0061811208724976, 0.3788628578186035, 1.5049350261688232, 1.228186011314392, 0.9880428314208984, 1.2088525295257568, 0.19481468200683594, 0.34130561351776123, 0.5626959800720215, 0.20085012912750244, 0.24156081676483154, 0.8040837049484253, 0.23302984237670898, 0.9987775087356567, 0.3295598030090332, 1.5456135272979736, 1.0940440893173218, 0.8860642910003662, 0.7097522020339966, 0.3375058174133301, 1.2155086994171143, 1.9726001024246216, 0.3756399154663086, 0.25445663928985596, 0.5278686285018921, 1.301238775253296, 1.014904260635376, 0.25205373764038086, 2.5432255268096924, 2.3358922004699707, 0.6840330362319946, 0.2325524091720581, 1.6456633806228638, 2.5267930030822754, 0.46997344493865967, 1.0787526369094849, 0.664536714553833, 1.093659520149231, 0.8227934837341309, 0.6940890550613403, 0.354425311088562, 0.7096632719039917, 0.3307837247848511, 0.2786823511123657, 1.0070375204086304, 0.4099299907684326, 0.8953143358230591, 0.05909156799316406, 1.4027090072631836, 0.9019867181777954, 0.6205792427062988, 1.3928672075271606, 0.22191846370697021, 0.2423548698425293, 0.39200711250305176, 1.859128475189209, 1.3596547842025757, 0.6679168939590454, 1.5114279985427856, 0.7754143476486206, 1.038517951965332, 0.3052051067352295, 0.31802594661712646, 0.5087565183639526, 1.5187146663665771, 1.054427981376648, 1.1137291193008423, 1.007011890411377, 0.35968947410583496, 0.5230432748794556, 1.8356876373291016, 0.6328345537185669, 2.6271233558654785, 0.2160738706588745], "mean_td_error": 0.8968064188957214, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 46.0, "diff_num_grad_updates_vs_sampler_policy": 45.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.105091094970703, "actor_loss": -7.14480447769165, "critic_loss": 0.18868790566921234, "alpha_loss": -0.1364617496728897, "alpha_value": 0.9865865111351013, "log_alpha_value": -0.013504257425665855, "target_entropy": -6.0, "policy_t": -0.03050926700234413, "mean_q": 3.163043975830078, "max_q": 3.745108127593994, "min_q": 2.565464735031128}, "td_error": [0.13824033737182617, 1.3366190195083618, 0.10897159576416016, 0.2007845640182495, 1.8519628047943115, 1.2114713191986084, 1.5604565143585205, 0.4945969581604004, 0.24831223487854004, 0.8023836612701416, 1.085145354270935, 1.382127285003662, 0.9287914037704468, 1.0564385652542114, 0.6380405426025391, 0.09558701515197754, 0.9872487783432007, 1.2409908771514893, 2.4314723014831543, 0.022252440452575684, 1.4642469882965088, 0.968734860420227, 0.14619410037994385, 0.2782871723175049, 1.4497696161270142, 0.5750086307525635, 0.6247701644897461, 2.4584391117095947, 2.823806047439575, 1.5915186405181885, 1.7505189180374146, 0.11205136775970459, 3.0359859466552734, 0.806826114654541, 1.0734639167785645, 0.062185049057006836, 1.4039300680160522, 1.75810968875885, 2.2292943000793457, 3.456707239151001, 1.4134302139282227, 1.3781272172927856, 2.0493640899658203, 0.8213704824447632, 1.2882953882217407, 0.9776748418807983, 1.8241674900054932, 0.7382616996765137, 1.0164220333099365, 0.20073115825653076, 2.6994001865386963, 1.7554056644439697, 1.104335904121399, 0.13037371635437012, 0.9582209587097168, 1.3420019149780273, 0.3544262647628784, 2.050265312194824, 1.6845192909240723, 0.7776789665222168, 0.0257112979888916, 1.5437438488006592, 0.6472620964050293, 0.4488077163696289, 0.7922019958496094, 0.3181654214859009, 0.17866063117980957, 0.623088002204895, 0.3516087532043457, 0.850197434425354, 1.1095244884490967, 1.4232230186462402, 0.4072258472442627, 1.7112594842910767, 0.06858694553375244, 1.4922938346862793, 1.6244984865188599, 0.7480279207229614, 0.19919180870056152, 2.834336519241333, 0.07208585739135742, 0.26499783992767334, 1.1313538551330566, 1.0670661926269531, 2.2902956008911133, 0.6926803588867188], "mean_td_error": 1.0857245922088623, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 46.0, "diff_num_grad_updates_vs_sampler_policy": 45.0}}, "num_env_steps_sampled": 42112, "num_env_steps_trained": 11868, "num_agent_steps_sampled": 126336, "num_agent_steps_trained": 11868, "last_target_update_ts": 42112, "num_target_updates": 46}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 126336, "num_agent_steps_trained": 11868, "num_env_steps_sampled": 42112, "num_env_steps_trained": 11868, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 502.5249807212132, "num_env_steps_trained_throughput_per_sec": 144.70027346659933, "timesteps_total": 42112, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 126336, "timers": {"training_iteration_time_ms": 1811.502, "sample_time_ms": 1226.124, "load_time_ms": 0.517, "load_throughput": 499229.762, "learn_time_ms": 61.161, "learn_throughput": 4218.381, "synch_weights_time_ms": 16.24}, "counters": {"num_env_steps_sampled": 42112, "num_env_steps_trained": 11868, "num_agent_steps_sampled": 126336, "num_agent_steps_trained": 11868, "last_target_update_ts": 42112, "num_target_updates": 46}, "done": false, "episodes_total": 0, "training_iteration": 47, "trial_id": "9a806_00000", "date": "2023-11-16_21-55-04", "timestamp": 1700200504, "time_this_iter_s": 1.7960100173950195, "time_total_s": 85.30097985267639, "pid": 45784, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fadd04c9940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 85.30097985267639, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 71.3, "ram_util_percent": 90.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.139372825622559, "actor_loss": -7.791605472564697, "critic_loss": 0.8088970184326172, "alpha_loss": -0.13995487987995148, "alpha_value": 0.9862917065620422, "log_alpha_value": -0.013803108595311642, "target_entropy": -6.0, "policy_t": 0.01906605064868927, "mean_q": 4.305234909057617, "max_q": 5.171140193939209, "min_q": 3.7633275985717773}, "td_error": [0.41345441341400146, 1.6020570993423462, 1.3254047632217407, 4.55146598815918, 2.9998135566711426, 3.3234663009643555, 0.7116814851760864, 1.1945860385894775, 1.422902226448059, 2.7121200561523438, 1.5284485816955566, 2.205629348754883, 1.6910717487335205, 1.141113519668579, 1.6313073635101318, 2.5060133934020996, 2.2640132904052734, 1.8280085325241089, 2.779824733734131, 1.8604307174682617, 0.4984182119369507, 3.0431222915649414, 2.25270938873291, 3.0836169719696045, 2.636845111846924, 2.013178586959839, 2.3745574951171875, 1.9549363851547241, 1.0130589008331299, 1.441437840461731, 1.6606793403625488, 2.8793601989746094, 0.9876543283462524, 2.3902952671051025, 2.284806489944458, 1.5346417427062988, 0.23682785034179688, 0.40085577964782715, 0.7819278240203857, 2.1105194091796875, 1.3412754535675049, 2.6349966526031494, 1.1303613185882568, 3.1681647300720215, 0.4226529598236084, 0.8402127027511597, 3.2183117866516113, 2.2882683277130127, 2.0806710720062256, 1.0098563432693481, 3.286271095275879, 1.1896507740020752, 1.8301752805709839, 1.7886033058166504, 1.5186983346939087, 2.294705867767334, 1.9274227619171143, 2.3206329345703125, 0.5320417881011963, 1.256762981414795, 1.7016206979751587, 1.263514757156372, 2.2274255752563477, 3.9132184982299805, 1.1061453819274902, 0.8607733249664307, 0.8019635677337646, 0.3634136915206909, 2.502819538116455, 1.952172040939331, 3.5560028553009033, 2.8038809299468994, 2.3246047496795654, 2.2953858375549316, 2.327369213104248, 0.3907235860824585, 3.4320521354675293, 1.3214534521102905, 2.23500919342041, 4.5544114112854, 0.46766889095306396, 2.073739528656006, 1.1422582864761353, 2.460102081298828, 1.5510164499282837, 0.9872996807098389], "mean_td_error": 1.8833494186401367, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 47.0, "diff_num_grad_updates_vs_sampler_policy": 46.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.069416046142578, "actor_loss": -7.570253372192383, "critic_loss": 0.15604090690612793, "alpha_loss": -0.13903294503688812, "alpha_value": 0.9862874150276184, "log_alpha_value": -0.01380744855850935, "target_entropy": -6.0, "policy_t": -0.014977138489484787, "mean_q": 3.6688318252563477, "max_q": 4.182834625244141, "min_q": 3.181560754776001}, "td_error": [0.8719608783721924, 0.5992392301559448, 2.1270077228546143, 1.1346347332000732, 0.5289289951324463, 2.816371440887451, 0.4967910051345825, 0.6543452739715576, 0.921502947807312, 0.3683450222015381, 0.7818777561187744, 0.9169069528579712, 0.8009078502655029, 0.9998902082443237, 1.475924015045166, 1.777300238609314, 1.187720775604248, 1.3818397521972656, 0.1948777437210083, 0.508512020111084, 0.7320268154144287, 0.7091609239578247, 0.40026235580444336, 0.6439012289047241, 0.40494656562805176, 0.1934272050857544, 0.3271341323852539, 0.17148065567016602, 1.7292729616165161, 0.0373530387878418, 0.9041227102279663, 0.0809776782989502, 0.721110463142395, 0.5012208223342896, 2.24027156829834, 1.5100034475326538, 0.35787880420684814, 0.7704274654388428, 0.8701095581054688, 0.20874929428100586, 0.4210350513458252, 0.08472299575805664, 0.4588613510131836, 0.6468709707260132, 0.8660489320755005, 1.8066670894622803, 0.47754645347595215, 0.08909523487091064, 0.2610365152359009, 0.5307719707489014, 0.1510087251663208, 0.12554550170898438, 0.13835382461547852, 0.7805905342102051, 0.27820754051208496, 0.10068607330322266, 0.8097095489501953, 0.8594690561294556, 0.18487071990966797, 0.4768422842025757, 1.3496646881103516, 0.43166303634643555, 0.916987419128418, 2.2474608421325684, 0.7181293964385986, 0.873304009437561, 1.162091612815857, 0.7280958890914917, 0.3586592674255371, 1.0799816846847534, 1.9924129247665405, 1.4950826168060303, 2.9645919799804688, 1.1008412837982178, 1.7398946285247803, 1.058293104171753, 0.45740842819213867, 1.4238207340240479, 0.9719059467315674, 0.38822484016418457, 1.0793492794036865, 0.17183828353881836, 0.34158968925476074, 0.3893793821334839, 0.3124808073043823, 0.10112369060516357], "mean_td_error": 0.8076853156089783, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 47.0, "diff_num_grad_updates_vs_sampler_policy": 46.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.105695724487305, "actor_loss": -7.25344705581665, "critic_loss": 0.16104240715503693, "alpha_loss": -0.13950173556804657, "alpha_value": 0.9862905740737915, "log_alpha_value": -0.013804269023239613, "target_entropy": -6.0, "policy_t": -0.005840686149895191, "mean_q": 3.239438056945801, "max_q": 3.9578917026519775, "min_q": 2.8264195919036865}, "td_error": [2.431105852127075, 1.3949722051620483, 1.7679423093795776, 0.055979132652282715, 0.3976973295211792, 0.16762709617614746, 1.2094731330871582, 1.827687382698059, 2.276919364929199, 2.841432809829712, 0.04977834224700928, 1.8461536169052124, 3.710446834564209, 0.34033453464508057, 0.6670588254928589, 0.1464787721633911, 1.1672042608261108, 0.2116020917892456, 0.10682070255279541, 1.3088778257369995, 0.2812260389328003, 0.1831270456314087, 0.7225685119628906, 1.3887436389923096, 1.0541599988937378, 2.0144805908203125, 0.5059419870376587, 0.12443625926971436, 2.4572625160217285, 0.11446607112884521, 0.7630411386489868, 0.3363906145095825, 1.4389777183532715, 3.636287212371826, 2.14182710647583, 0.2745859622955322, 0.289706826210022, 0.5211650133132935, 1.4690800905227661, 0.8151510953903198, 1.056984305381775, 0.36212456226348877, 0.9763160943984985, 0.3010472059249878, 0.13656878471374512, 1.1005074977874756, 0.10070526599884033, 1.4712083339691162, 0.3521130084991455, 0.5763940811157227, 0.4822201728820801, 2.39231538772583, 0.4202200174331665, 0.23359310626983643, 0.34114229679107666, 1.379457950592041, 0.7435829639434814, 1.9794988632202148, 1.1588623523712158, 1.4611464738845825, 2.16617751121521, 0.13473892211914062, 0.09595990180969238, 2.6848480701446533, 0.5577472448348999, 1.2017239332199097, 1.1918998956680298, 0.7089810371398926, 3.134934902191162, 0.8861740827560425, 0.6178655624389648, 1.1417282819747925, 0.09887003898620605, 0.45396459102630615, 0.9017786979675293, 0.10893762111663818, 0.7773171663284302, 0.217443585395813, 0.2645167112350464, 0.48308229446411133, 0.6253831386566162, 0.5278476476669312, 0.7885066270828247, 0.5905669927597046, 0.053841233253479004, 0.7344170808792114], "mean_td_error": 0.9608542919158936, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 47.0, "diff_num_grad_updates_vs_sampler_policy": 46.0}}, "num_env_steps_sampled": 43008, "num_env_steps_trained": 12126, "num_agent_steps_sampled": 129024, "num_agent_steps_trained": 12126, "last_target_update_ts": 43008, "num_target_updates": 47}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 129024, "num_agent_steps_trained": 12126, "num_env_steps_sampled": 43008, "num_env_steps_trained": 12126, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 533.3813029242824, "num_env_steps_trained_throughput_per_sec": 153.5852412438224, "timesteps_total": 43008, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 129024, "timers": {"training_iteration_time_ms": 1764.896, "sample_time_ms": 1206.639, "load_time_ms": 0.516, "load_throughput": 499829.299, "learn_time_ms": 61.062, "learn_throughput": 4225.214, "synch_weights_time_ms": 16.151}, "counters": {"num_env_steps_sampled": 43008, "num_env_steps_trained": 12126, "num_agent_steps_sampled": 129024, "num_agent_steps_trained": 12126, "last_target_update_ts": 43008, "num_target_updates": 47}, "done": false, "episodes_total": 0, "training_iteration": 48, "trial_id": "9a806_00000", "date": "2023-11-16_21-55-05", "timestamp": 1700200505, "time_this_iter_s": 1.6969268321990967, "time_total_s": 86.99790668487549, "pid": 45784, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fadd052baf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 86.99790668487549, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 84.4, "ram_util_percent": 90.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.081445693969727, "actor_loss": -7.960907459259033, "critic_loss": 0.6105592250823975, "alpha_loss": -0.14217981696128845, "alpha_value": 0.985995888710022, "log_alpha_value": -0.014103119261562824, "target_entropy": -6.0, "policy_t": -0.0021249803248792887, "mean_q": 4.557584285736084, "max_q": 5.102991104125977, "min_q": 3.7511205673217773}, "td_error": [3.5135498046875, 0.7808687686920166, 1.5947887897491455, 0.7344696521759033, 1.2722980976104736, 1.3840599060058594, 0.1774272918701172, 0.6153395175933838, 1.4364914894104004, 2.4553046226501465, 0.522121787071228, 1.117516040802002, 0.6506800651550293, 0.44446706771850586, 0.8794660568237305, 2.995192050933838, 0.4509561061859131, 2.968907356262207, 1.2933439016342163, 0.9650871753692627, 1.6596225500106812, 2.0836784839630127, 0.3170206546783447, 1.640023946762085, 3.064629316329956, 0.5949127674102783, 2.1330275535583496, 0.45686328411102295, 0.31508028507232666, 1.1351442337036133, 1.5362398624420166, 0.8871361017227173, 1.8059616088867188, 0.8080148696899414, 0.3615140914916992, 1.62821626663208, 1.7127498388290405, 0.23361921310424805, 2.740863800048828, 1.308919906616211, 1.6354873180389404, 0.5021457672119141, 2.582500696182251, 1.3912887573242188, 1.329894781112671, 1.0705037117004395, 3.358790874481201, 1.8320724964141846, 1.6879109144210815, 0.6400330066680908, 3.419187307357788, 2.653933048248291, 1.5853592157363892, 1.3356945514678955, 2.2415952682495117, 4.005796432495117, 1.754953384399414, 1.4697425365447998, 0.12727689743041992, 1.1629576683044434, 0.24238848686218262, 1.2091455459594727, 0.8153071403503418, 3.5098652839660645, 1.8952751159667969, 0.5309834480285645, 1.8255959749221802, 2.204979658126831, 2.167839527130127, 0.5086766481399536, 2.1411101818084717, 2.5991463661193848, 1.218693733215332, 1.036465048789978, 0.21032118797302246, 0.5423407554626465, 1.7102012634277344, 1.2245604991912842, 1.0863968133926392, 0.6005918979644775, 2.2028865814208984, 3.1907410621643066, 1.7564184665679932, 0.9089789390563965, 3.5699822902679443, 0.8692895174026489], "mean_td_error": 1.4911729097366333, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 48.0, "diff_num_grad_updates_vs_sampler_policy": 47.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.04287338256836, "actor_loss": -7.706955432891846, "critic_loss": 0.16597741842269897, "alpha_loss": -0.1416759490966797, "alpha_value": 0.985991895198822, "log_alpha_value": -0.014107114635407925, "target_entropy": -6.0, "policy_t": -0.018435349687933922, "mean_q": 3.807831048965454, "max_q": 4.673617839813232, "min_q": 3.0672719478607178}, "td_error": [0.30450963973999023, 1.0383168458938599, 0.6782764196395874, 0.26214003562927246, 1.7930008172988892, 1.2550060749053955, 1.1321182250976562, 1.120766520500183, 2.7625269889831543, 1.3963050842285156, 1.7278697490692139, 1.1960039138793945, 0.8820815086364746, 0.6617803573608398, 0.9662939310073853, 0.15339279174804688, 1.0558452606201172, 0.5227813720703125, 0.21837401390075684, 2.168398380279541, 0.6098169088363647, 0.2955765724182129, 0.560330867767334, 0.7308032512664795, 0.19393670558929443, 1.4134479761123657, 2.4024932384490967, 0.6298503875732422, 0.9434814453125, 1.0547510385513306, 0.08902978897094727, 0.7326483726501465, 1.1657518148422241, 0.4020949602127075, 0.42788541316986084, 0.07834315299987793, 0.17873120307922363, 2.3784103393554688, 0.3559682369232178, 0.4454692602157593, 0.5129058361053467, 0.1710294485092163, 1.8784165382385254, 1.6994216442108154, 1.4905986785888672, 1.060035228729248, 0.16648781299591064, 0.27653563022613525, 0.7303867340087891, 1.1722354888916016, 0.22018277645111084, 0.4985671043395996, 1.2957655191421509, 0.2627915143966675, 0.29805922508239746, 1.6414368152618408, 0.4931905269622803, 0.18976950645446777, 0.2263178825378418, 0.3875594139099121, 0.3900184631347656, 0.5701074600219727, 0.9321017265319824, 0.02610635757446289, 1.2530683279037476, 0.6467025279998779, 0.25122392177581787, 1.6144858598709106, 0.5959112644195557, 0.9554305076599121, 0.3273428678512573, 1.470521092414856, 0.7158209085464478, 0.22797751426696777, 0.5460731983184814, 1.8139029741287231, 0.23997867107391357, 0.0948106050491333, 2.2649569511413574, 0.36627423763275146, 0.5550477504730225, 0.49914705753326416, 0.8548243045806885, 0.25954627990722656, 0.354404091835022, 1.6806504726409912], "mean_td_error": 0.8204969167709351, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 48.0, "diff_num_grad_updates_vs_sampler_policy": 47.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.078948020935059, "actor_loss": -7.349557399749756, "critic_loss": 0.17887043952941895, "alpha_loss": -0.14215654134750366, "alpha_value": 0.9859946966171265, "log_alpha_value": -0.014104305766522884, "target_entropy": -6.0, "policy_t": -0.03449712321162224, "mean_q": 3.397150754928589, "max_q": 4.09807825088501, "min_q": 2.8498880863189697}, "td_error": [1.7301084995269775, 0.07153069972991943, 0.7413842678070068, 0.13630354404449463, 1.6199588775634766, 0.07628309726715088, 0.016151070594787598, 1.095199465751648, 2.005551815032959, 0.4035522937774658, 0.2595309019088745, 1.003781795501709, 0.05195581912994385, 0.5203698873519897, 1.9287517070770264, 2.704655170440674, 0.674854040145874, 0.07705426216125488, 0.9692071676254272, 0.262498140335083, 1.7834151983261108, 0.2791917324066162, 0.9057245254516602, 1.183724045753479, 0.6798676252365112, 0.5385123491287231, 1.7075438499450684, 0.650830864906311, 1.4791169166564941, 2.0247058868408203, 2.2134475708007812, 2.062589645385742, 0.45575082302093506, 1.3877456188201904, 1.063345193862915, 1.8339787721633911, 0.9279552698135376, 0.4815593957901001, 0.8785642385482788, 0.0859522819519043, 1.1265703439712524, 0.268368124961853, 0.6449705362319946, 0.054303765296936035, 1.471336007118225, 0.14168477058410645, 1.7309333086013794, 1.1060802936553955, 1.2575892210006714, 0.916764497756958, 0.3648555278778076, 0.420526385307312, 1.209045171737671, 1.444536566734314, 2.217527389526367, 2.555694103240967, 0.8977051973342896, 0.31628406047821045, 1.5870254039764404, 0.19164061546325684, 1.0149904489517212, 2.1020126342773438, 1.4950997829437256, 0.4271959066390991, 2.278883934020996, 0.22638654708862305, 0.7651848793029785, 0.07312345504760742, 1.0909135341644287, 0.41989922523498535, 2.656055450439453, 0.5824254751205444, 2.0056209564208984, 2.2430126667022705, 1.3923418521881104, 1.1765313148498535, 1.8677524328231812, 1.1747500896453857, 0.9189300537109375, 0.23297715187072754, 1.5003958940505981, 0.1097332239151001, 0.17143988609313965, 0.5874145030975342, 3.1803395748138428, 0.6472185850143433], "mean_td_error": 1.0376311540603638, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 48.0, "diff_num_grad_updates_vs_sampler_policy": 47.0}}, "num_env_steps_sampled": 43904, "num_env_steps_trained": 12384, "num_agent_steps_sampled": 131712, "num_agent_steps_trained": 12384, "last_target_update_ts": 43904, "num_target_updates": 48}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 131712, "num_agent_steps_trained": 12384, "num_env_steps_sampled": 43904, "num_env_steps_trained": 12384, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 541.226860408816, "num_env_steps_trained_throughput_per_sec": 155.8443415016457, "timesteps_total": 43904, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 131712, "timers": {"training_iteration_time_ms": 1747.721, "sample_time_ms": 1190.096, "load_time_ms": 0.515, "load_throughput": 500824.007, "learn_time_ms": 61.089, "learn_throughput": 4223.34, "synch_weights_time_ms": 15.907}, "counters": {"num_env_steps_sampled": 43904, "num_env_steps_trained": 12384, "num_agent_steps_sampled": 131712, "num_agent_steps_trained": 12384, "last_target_update_ts": 43904, "num_target_updates": 48}, "done": false, "episodes_total": 0, "training_iteration": 49, "trial_id": "9a806_00000", "date": "2023-11-16_21-55-07", "timestamp": 1700200507, "time_this_iter_s": 1.676628828048706, "time_total_s": 88.6745355129242, "pid": 45784, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fadd04c93a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 88.6745355129242, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 67.63333333333333, "ram_util_percent": 90.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.002036094665527, "actor_loss": -8.24351692199707, "critic_loss": 0.5493921041488647, "alpha_loss": -0.14406046271324158, "alpha_value": 0.9857001304626465, "log_alpha_value": -0.014403116889297962, "target_entropy": -6.0, "policy_t": -0.01176970824599266, "mean_q": 4.799654960632324, "max_q": 5.710931301116943, "min_q": 3.985992431640625}, "td_error": [0.4754568338394165, 0.1764371395111084, 1.9311497211456299, 1.9408100843429565, 0.9696812629699707, 0.38124191761016846, 2.011960029602051, 3.0048575401306152, 0.7927238941192627, 1.3332487344741821, 0.2687859535217285, 1.6584023237228394, 2.168896198272705, 1.8463776111602783, 0.4818305969238281, 1.495283842086792, 2.360470771789551, 0.8808088302612305, 2.8818836212158203, 1.4284930229187012, 3.438666820526123, 0.9218525886535645, 0.46286165714263916, 0.40548276901245117, 1.1356358528137207, 1.4568722248077393, 1.560258150100708, 2.8011624813079834, 0.20238780975341797, 0.6322629451751709, 1.0574147701263428, 1.0363540649414062, 1.4201347827911377, 0.44031381607055664, 2.054626703262329, 0.6353561878204346, 0.1325387954711914, 2.200960874557495, 1.230356216430664, 2.2738888263702393, 1.412020206451416, 2.410470485687256, 0.5586416721343994, 2.1881961822509766, 1.9461963176727295, 2.746367931365967, 0.4119749069213867, 0.5072863101959229, 0.7280473709106445, 4.328166484832764, 1.8173375129699707, 3.423035144805908, 1.1624627113342285, 0.7799023389816284, 0.37745535373687744, 0.7328720092773438, 0.6811401844024658, 1.1853687763214111, 0.30854201316833496, 0.7830742597579956, 2.12149715423584, 0.42674827575683594, 2.0999441146850586, 0.430344820022583, 2.6712002754211426, 1.7496452331542969, 0.65850830078125, 0.7357757091522217, 1.403073787689209, 0.29569292068481445, 0.4186253547668457, 3.0071024894714355, 1.8662269115447998, 1.9040005207061768, 0.7283775806427002, 2.162327289581299, 0.9851083755493164, 0.9921736717224121, 1.505216121673584, 2.665982484817505, 1.0743756294250488, 2.189098834991455, 0.3736884593963623, 1.2886466979980469, 0.49068450927734375, 3.3059492111206055], "mean_td_error": 1.3956600427627563, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 49.0, "diff_num_grad_updates_vs_sampler_policy": 48.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.128837585449219, "actor_loss": -7.894208908081055, "critic_loss": 0.2289380431175232, "alpha_loss": -0.14592333137989044, "alpha_value": 0.98569655418396, "log_alpha_value": -0.014406717382371426, "target_entropy": -6.0, "policy_t": -0.00257108430378139, "mean_q": 3.9854774475097656, "max_q": 4.79911994934082, "min_q": 3.2966721057891846}, "td_error": [0.14372384548187256, 1.1040949821472168, 0.4321669340133667, 0.22145652770996094, 0.9485129117965698, 1.1015558242797852, 2.0128495693206787, 0.6686829328536987, 2.0700554847717285, 2.5418457984924316, 0.8377091884613037, 0.7985684871673584, 0.6736224889755249, 0.6379961967468262, 0.13843965530395508, 2.06058406829834, 1.1666522026062012, 0.2577512264251709, 1.585074782371521, 1.3910164833068848, 0.7903931140899658, 0.5543875694274902, 1.5811744928359985, 0.526877760887146, 1.1397044658660889, 0.029909610748291016, 1.1091265678405762, 0.8663949966430664, 0.581528902053833, 0.6549985408782959, 2.1977477073669434, 0.3250950574874878, 1.6462763547897339, 1.7379722595214844, 2.315856456756592, 1.394852876663208, 2.145350456237793, 0.5976537466049194, 2.375988006591797, 2.1238110065460205, 0.4806569814682007, 1.0031039714813232, 1.0393126010894775, 1.1068133115768433, 0.8938930034637451, 0.39502501487731934, 1.1922202110290527, 0.8658068180084229, 0.868708610534668, 1.5908762216567993, 0.3092077970504761, 1.7192535400390625, 1.2309337854385376, 0.7970203161239624, 0.30839061737060547, 0.27956271171569824, 0.8859175443649292, 2.3036129474639893, 0.2320704460144043, 0.21190178394317627, 0.5217982530593872, 1.3404182195663452, 0.5449913740158081, 0.18541157245635986, 1.6403007507324219, 1.6859900951385498, 1.1684012413024902, 3.469996452331543, 0.4170118570327759, 2.6243174076080322, 1.0243372917175293, 0.8922426700592041, 0.517988920211792, 0.8624287843704224, 2.386698007583618, 1.2393463850021362, 0.1174393892288208, 0.5095992088317871, 1.5310964584350586, 0.23956811428070068, 0.42227184772491455, 1.2386316061019897, 1.3456978797912598, 0.8098692893981934, 0.8285648822784424, 0.37047135829925537], "mean_td_error": 1.0597282648086548, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 49.0, "diff_num_grad_updates_vs_sampler_policy": 48.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.093751907348633, "actor_loss": -7.503050327301025, "critic_loss": 0.1252717673778534, "alpha_loss": -0.14539343118667603, "alpha_value": 0.985698938369751, "log_alpha_value": -0.014404300600290298, "target_entropy": -6.0, "policy_t": 0.04023836925625801, "mean_q": 3.5020244121551514, "max_q": 4.02935266494751, "min_q": 2.903393507003784}, "td_error": [1.4453163146972656, 1.0783096551895142, 1.0690934658050537, 0.9966608285903931, 1.3286198377609253, 0.5499194860458374, 1.8039934635162354, 0.20074570178985596, 0.891730785369873, 0.12054622173309326, 0.46819210052490234, 1.7019670009613037, 0.3212308883666992, 1.255396842956543, 0.9977519512176514, 0.609038233757019, 0.38280797004699707, 1.3542454242706299, 0.8644084930419922, 0.5610530376434326, 0.8756906986236572, 0.7177824974060059, 0.06263256072998047, 0.4781895875930786, 0.014219999313354492, 0.5220669507980347, 0.4015158414840698, 1.2203038930892944, 1.4535119533538818, 0.04365372657775879, 1.3756284713745117, 0.8768059015274048, 1.5047426223754883, 0.16846561431884766, 0.2777988910675049, 0.22183120250701904, 0.5956195592880249, 0.7827297449111938, 2.3882522583007812, 0.2922400236129761, 0.46602821350097656, 0.15878069400787354, 0.280737042427063, 0.17328524589538574, 0.24127566814422607, 2.169346809387207, 0.32749342918395996, 0.877068281173706, 0.42630183696746826, 0.3908271789550781, 1.4768322706222534, 0.5767112970352173, 0.762641191482544, 0.023549675941467285, 1.0909976959228516, 0.10496890544891357, 0.6843527555465698, 1.4167789220809937, 1.8626450300216675, 0.40490174293518066, 1.8696842193603516, 0.13635897636413574, 0.8462616205215454, 2.390549659729004, 0.9940640926361084, 1.197371482849121, 2.44143009185791, 1.5706233978271484, 0.20654749870300293, 0.6765345335006714, 0.4308292865753174, 0.46048545837402344, 1.311914086341858, 0.1394038200378418, 1.4336963891983032, 0.3664363622665405, 1.6154347658157349, 1.387842059135437, 0.3112982511520386, 0.736309289932251, 0.34614288806915283, 0.39599668979644775, 1.1840368509292603, 0.1263352632522583, 0.04987025260925293, 2.093235969543457], "mean_td_error": 0.8245224356651306, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 49.0, "diff_num_grad_updates_vs_sampler_policy": 48.0}}, "num_env_steps_sampled": 44800, "num_env_steps_trained": 12642, "num_agent_steps_sampled": 134400, "num_agent_steps_trained": 12642, "last_target_update_ts": 44800, "num_target_updates": 49}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 134400, "num_agent_steps_trained": 12642, "num_env_steps_sampled": 44800, "num_env_steps_trained": 12642, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 504.52691665302905, "num_env_steps_trained_throughput_per_sec": 145.27672376839453, "timesteps_total": 44800, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 134400, "timers": {"training_iteration_time_ms": 1758.77, "sample_time_ms": 1200.397, "load_time_ms": 0.516, "load_throughput": 499713.891, "learn_time_ms": 61.26, "learn_throughput": 4211.537, "synch_weights_time_ms": 15.899}, "counters": {"num_env_steps_sampled": 44800, "num_env_steps_trained": 12642, "num_agent_steps_sampled": 134400, "num_agent_steps_trained": 12642, "last_target_update_ts": 44800, "num_target_updates": 49}, "done": false, "episodes_total": 0, "training_iteration": 50, "trial_id": "9a806_00000", "date": "2023-11-16_21-55-09", "timestamp": 1700200509, "time_this_iter_s": 1.7931747436523438, "time_total_s": 90.46771025657654, "pid": 45784, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fadd05339d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 90.46771025657654, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 88.05, "ram_util_percent": 90.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.094202995300293, "actor_loss": -8.37756061553955, "critic_loss": 0.42748916149139404, "alpha_loss": -0.14841419458389282, "alpha_value": 0.9854046702384949, "log_alpha_value": -0.014702914282679558, "target_entropy": -6.0, "policy_t": -0.007231361232697964, "mean_q": 5.0267438888549805, "max_q": 5.889014720916748, "min_q": 4.145518779754639}, "td_error": [1.0479884147644043, 0.39047837257385254, 0.5361464023590088, 0.9551987648010254, 1.6745012998580933, 0.7029335498809814, 2.378694772720337, 0.6980271339416504, 1.8940138816833496, 1.2119290828704834, 0.3328988552093506, 0.7674827575683594, 1.2820285558700562, 0.9009990692138672, 1.1523659229278564, 2.0742952823638916, 1.374951720237732, 1.520425796508789, 2.89827823638916, 0.5916240215301514, 0.5918557643890381, 0.3817276954650879, 2.044665575027466, 0.9313454627990723, 1.8191454410552979, 0.38172316551208496, 0.4875175952911377, 1.525673270225525, 0.8063085079193115, 0.6751465797424316, 2.004700183868408, 1.3626503944396973, 1.0289075374603271, 0.21805071830749512, 1.4960554838180542, 0.38112568855285645, 0.8880324363708496, 0.3491840362548828, 1.2447781562805176, 2.1774210929870605, 1.3268091678619385, 0.2930178642272949, 1.388850212097168, 0.33218955993652344, 1.3992609977722168, 2.8500492572784424, 1.6729466915130615, 2.8980934619903564, 2.918165683746338, 0.505272388458252, 1.6705172061920166, 1.0726099014282227, 2.1101386547088623, 0.907660722732544, 0.324202299118042, 1.5111958980560303, 2.2523834705352783, 0.714270830154419, 1.563983678817749, 1.085209846496582, 1.0680131912231445, 1.2026302814483643, 1.6966676712036133, 0.8174276351928711, 0.7763698101043701, 1.0612237453460693, 1.8310348987579346, 1.0818581581115723, 0.5641043186187744, 2.1036314964294434, 1.568648099899292, 0.9237329959869385, 1.7337814569473267, 0.32389163970947266, 0.2499070167541504, 0.8038773536682129, 1.5259981155395508, 0.9593713283538818, 0.2604551315307617, 0.8243825435638428, 0.45537328720092773, 0.2703392505645752, 2.398407459259033, 0.3812556266784668, 2.1689019203186035, 0.39650654792785645], "mean_td_error": 1.1793708801269531, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 50.0, "diff_num_grad_updates_vs_sampler_policy": 49.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.098190307617188, "actor_loss": -8.00430679321289, "critic_loss": 0.1968151032924652, "alpha_loss": -0.1485087126493454, "alpha_value": 0.9854011535644531, "log_alpha_value": -0.01470646820962429, "target_entropy": -6.0, "policy_t": -0.003992980811744928, "mean_q": 4.077988147735596, "max_q": 4.6589860916137695, "min_q": 3.419203996658325}, "td_error": [0.17636501789093018, 0.45417094230651855, 0.7318663597106934, 0.8125985860824585, 1.0325541496276855, 0.4509122371673584, 1.5471081733703613, 2.2045443058013916, 2.3073832988739014, 0.20577716827392578, 0.061516761779785156, 1.5332450866699219, 0.16705715656280518, 0.45605337619781494, 0.4674556255340576, 0.719226598739624, 1.3179829120635986, 0.16805529594421387, 1.9543910026550293, 0.12363576889038086, 0.4756052494049072, 0.10680198669433594, 1.6828713417053223, 1.3173716068267822, 1.2051587104797363, 2.346224308013916, 0.552668571472168, 1.3001378774642944, 0.6611160039901733, 0.6460132598876953, 0.6630954742431641, 1.0670340061187744, 0.48647427558898926, 0.3840305805206299, 0.549001932144165, 1.818206548690796, 1.0587464570999146, 0.41749143600463867, 1.5081274509429932, 0.9497838020324707, 0.45705151557922363, 0.8112480640411377, 0.16192781925201416, 0.8127651214599609, 0.10708367824554443, 0.5934028625488281, 0.3133087158203125, 1.647946834564209, 2.0052645206451416, 1.4033474922180176, 0.6688746213912964, 0.35016822814941406, 1.5379078388214111, 1.298488736152649, 0.15146732330322266, 0.34402894973754883, 0.8322539329528809, 2.153383493423462, 1.1788289546966553, 0.5958830118179321, 0.349331259727478, 0.9392176866531372, 1.5729236602783203, 0.42388832569122314, 1.2780952453613281, 0.6520600318908691, 1.7836456298828125, 1.448419451713562, 0.15490436553955078, 1.4793959856033325, 1.0519087314605713, 0.5307726860046387, 0.5592329502105713, 1.2873963117599487, 0.09575104713439941, 0.29518604278564453, 0.36449623107910156, 1.238395094871521, 3.031592845916748, 0.22762131690979004, 1.4652758836746216, 1.0319260358810425, 2.0709476470947266, 1.0297988653182983, 1.5576282739639282, 0.7619366645812988], "mean_td_error": 0.9324912428855896, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 50.0, "diff_num_grad_updates_vs_sampler_policy": 49.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.00368595123291, "actor_loss": -7.655037879943848, "critic_loss": 0.12897397577762604, "alpha_loss": -0.1470971405506134, "alpha_value": 0.985403299331665, "log_alpha_value": -0.014704294502735138, "target_entropy": -6.0, "policy_t": 0.00762892235070467, "mean_q": 3.6798276901245117, "max_q": 4.469688892364502, "min_q": 3.077183485031128}, "td_error": [0.8763713836669922, 0.537033200263977, 1.9287326335906982, 0.8153326511383057, 0.2416834831237793, 1.5714274644851685, 0.19127845764160156, 0.3840062618255615, 0.23256981372833252, 1.9925333261489868, 0.10870420932769775, 0.36831581592559814, 0.0289609432220459, 0.40824341773986816, 2.094674825668335, 0.3038187026977539, 1.211883783340454, 0.2876548767089844, 0.10868024826049805, 1.3692110776901245, 0.3248167037963867, 0.13364696502685547, 0.13977015018463135, 0.9377491474151611, 0.022373318672180176, 0.8167308568954468, 1.1932307481765747, 0.4306511878967285, 2.1251254081726074, 0.2895040512084961, 0.3608283996582031, 0.18023324012756348, 1.645124912261963, 1.7387714385986328, 0.6248366832733154, 0.6616103649139404, 0.29213953018188477, 0.9126870632171631, 0.8209102153778076, 0.7720432281494141, 2.1682510375976562, 1.3719803094863892, 0.8770935535430908, 0.7778942584991455, 1.2824244499206543, 0.48190152645111084, 1.0277986526489258, 1.8433434963226318, 0.05956995487213135, 0.6590564250946045, 0.5908762216567993, 0.7841726541519165, 0.06205296516418457, 0.4031391143798828, 1.4581542015075684, 0.683134913444519, 0.9754945039749146, 0.6070231199264526, 0.07635712623596191, 0.68711256980896, 0.6774002313613892, 3.360766887664795, 1.1317633390426636, 1.0608044862747192, 0.2707533836364746, 1.5390969514846802, 1.782782793045044, 0.25058066844940186, 0.01642739772796631, 1.5785648822784424, 0.3411557674407959, 0.6787455081939697, 0.8696064949035645, 0.23172986507415771, 1.1413806676864624, 1.0092997550964355, 0.1697378158569336, 1.4060583114624023, 1.870114803314209, 0.22228074073791504, 0.3242638111114502, 0.8207869529724121, 1.0652754306793213, 0.04360544681549072, 1.548407793045044, 1.366675853729248], "mean_td_error": 0.8271953463554382, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 50.0, "diff_num_grad_updates_vs_sampler_policy": 49.0}}, "num_env_steps_sampled": 45696, "num_env_steps_trained": 12900, "num_agent_steps_sampled": 137088, "num_agent_steps_trained": 12900, "last_target_update_ts": 45696, "num_target_updates": 50}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 137088, "num_agent_steps_trained": 12900, "num_env_steps_sampled": 45696, "num_env_steps_trained": 12900, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 453.6750154973487, "num_env_steps_trained_throughput_per_sec": 130.63410044454906, "timesteps_total": 45696, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 137088, "timers": {"training_iteration_time_ms": 1789.33, "sample_time_ms": 1198.708, "load_time_ms": 0.515, "load_throughput": 500893.553, "learn_time_ms": 61.121, "learn_throughput": 4221.128, "synch_weights_time_ms": 15.747}, "counters": {"num_env_steps_sampled": 45696, "num_env_steps_trained": 12900, "num_agent_steps_sampled": 137088, "num_agent_steps_trained": 12900, "last_target_update_ts": 45696, "num_target_updates": 50}, "done": false, "episodes_total": 0, "training_iteration": 51, "trial_id": "9a806_00000", "date": "2023-11-16_21-55-11", "timestamp": 1700200511, "time_this_iter_s": 1.9903059005737305, "time_total_s": 92.45801615715027, "pid": 45784, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fadd04c93a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 92.45801615715027, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 58.800000000000004, "ram_util_percent": 90.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.030266761779785, "actor_loss": -8.641942977905273, "critic_loss": 0.43385210633277893, "alpha_loss": -0.15048164129257202, "alpha_value": 0.9851092100143433, "log_alpha_value": -0.015002754516899586, "target_entropy": -6.0, "policy_t": -0.02300836890935898, "mean_q": 5.282313346862793, "max_q": 6.303233623504639, "min_q": 4.481863498687744}, "td_error": [1.1066250801086426, 1.949950098991394, 0.35662198066711426, 1.1695291996002197, 2.482135057449341, 2.328293561935425, 0.9944381713867188, 2.7474026679992676, 1.989091157913208, 0.8104138374328613, 0.493396520614624, 1.915285348892212, 1.5320744514465332, 0.6397852897644043, 2.5896525382995605, 0.4931051731109619, 1.109818696975708, 0.5678834915161133, 0.5272214412689209, 0.3827037811279297, 1.7167248725891113, 0.33950090408325195, 0.6318907737731934, 0.9965512752532959, 1.1757981777191162, 0.6985890865325928, 1.533461570739746, 1.0389680862426758, 0.178574800491333, 3.482893705368042, 2.164884567260742, 1.3390116691589355, 0.10315465927124023, 0.8013203144073486, 1.7138102054595947, 0.6439229249954224, 0.5568075180053711, 0.799506425857544, 3.722564458847046, 0.6272351741790771, 2.157155752182007, 0.5957820415496826, 0.323591947555542, 0.27509427070617676, 1.9179630279541016, 1.0246682167053223, 2.7382261753082275, 1.7871310710906982, 0.5491437911987305, 1.165952444076538, 0.5293922424316406, 2.1838576793670654, 0.21892833709716797, 1.4178982973098755, 0.17058634757995605, 1.4328693151474, 0.6396031379699707, 1.5477044582366943, 1.346475601196289, 0.3503105640411377, 0.7074415683746338, 0.7943114042282104, 0.6470952033996582, 0.43233537673950195, 0.21056056022644043, 0.505481481552124, 2.436450958251953, 0.3922915458679199, 0.34226560592651367, 0.4636657238006592, 1.7454605102539062, 0.2852208614349365, 1.0242520570755005, 0.25743722915649414, 3.16701078414917, 0.7512719631195068, 0.8483061790466309, 0.5262644290924072, 1.9071242809295654, 1.9335474967956543, 0.25282812118530273, 0.6211240291595459, 1.9246399402618408, 2.045280694961548, 0.703685998916626, 1.7576851844787598], "mean_td_error": 1.1570461988449097, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 51.0, "diff_num_grad_updates_vs_sampler_policy": 50.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.102964401245117, "actor_loss": -8.120062828063965, "critic_loss": 0.17991304397583008, "alpha_loss": -0.1516079157590866, "alpha_value": 0.9851057529449463, "log_alpha_value": -0.015006277710199356, "target_entropy": -6.0, "policy_t": -0.04538169130682945, "mean_q": 4.212014198303223, "max_q": 5.140311241149902, "min_q": 3.515477180480957}, "td_error": [2.0302796363830566, 1.1147418022155762, 0.1409679651260376, 0.37599754333496094, 3.4295756816864014, 1.437619924545288, 1.5645854473114014, 1.1065587997436523, 0.30364537239074707, 0.2187197208404541, 0.9636167287826538, 0.17718780040740967, 0.07629764080047607, 0.20814728736877441, 2.0608749389648438, 0.8126566410064697, 0.5745456218719482, 0.8736331462860107, 0.5905071496963501, 0.8765811920166016, 0.11577272415161133, 1.2538162469863892, 1.445180892944336, 0.9900280237197876, 0.5958991050720215, 0.7399724721908569, 0.11280560493469238, 0.3431520462036133, 0.838320255279541, 1.6074888706207275, 0.9120743274688721, 0.4401792287826538, 0.1973886489868164, 1.0454320907592773, 1.5065226554870605, 0.47582364082336426, 2.575624465942383, 0.12905335426330566, 0.9280767440795898, 1.0376791954040527, 0.2788875102996826, 0.43781185150146484, 0.1923539638519287, 0.8617080450057983, 0.14130663871765137, 0.38318753242492676, 1.954548954963684, 0.25176548957824707, 0.871070146560669, 0.8409819602966309, 0.17223882675170898, 0.6613801717758179, 0.1801776885986328, 1.097557783126831, 1.2857451438903809, 1.2821714878082275, 2.038238525390625, 0.5193473100662231, 1.3688602447509766, 0.2741280794143677, 0.33558201789855957, 1.5893148183822632, 1.5582364797592163, 0.27143776416778564, 1.1446938514709473, 0.15522527694702148, 1.4488632678985596, 0.2793457508087158, 0.20501422882080078, 0.37499213218688965, 0.7477364540100098, 1.224644422531128, 0.5587136745452881, 0.5814597606658936, 0.25164949893951416, 1.1352951526641846, 1.5096909999847412, 0.9127229452133179, 1.872495174407959, 1.554999828338623, 0.7006442546844482, 0.9807395935058594, 2.6224915981292725, 0.99924635887146, 0.8315107822418213, 0.5384464263916016], "mean_td_error": 0.8802986741065979, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 51.0, "diff_num_grad_updates_vs_sampler_policy": 50.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.093321800231934, "actor_loss": -7.78141450881958, "critic_loss": 0.11517208814620972, "alpha_loss": -0.15144093334674835, "alpha_value": 0.9851078987121582, "log_alpha_value": -0.015004072338342667, "target_entropy": -6.0, "policy_t": -0.004829613957554102, "mean_q": 3.798611640930176, "max_q": 4.528107166290283, "min_q": 3.265984058380127}, "td_error": [1.4467121362686157, 0.7564501762390137, 1.1682162284851074, 0.04734814167022705, 0.5087122917175293, 0.6013317108154297, 0.9613420963287354, 1.7698153257369995, 0.9527232646942139, 0.06367993354797363, 1.7313796281814575, 0.07188844680786133, 1.2817949056625366, 1.116697072982788, 0.11971187591552734, 0.5113728046417236, 0.7717992067337036, 0.6872543096542358, 0.6990848779678345, 0.4804823398590088, 1.172213077545166, 0.7104356288909912, 0.3981362581253052, 0.9387212991714478, 0.6371326446533203, 0.8272174596786499, 0.5664310455322266, 1.0527753829956055, 0.07071030139923096, 2.2706432342529297, 1.437201738357544, 0.9640926122665405, 0.8374456167221069, 0.33479464054107666, 0.08742356300354004, 0.06680774688720703, 0.22800052165985107, 0.922809362411499, 0.9287827014923096, 1.2681207656860352, 0.306374192237854, 0.7714443206787109, 1.0066497325897217, 0.4273616075515747, 0.3422532081604004, 0.2309267520904541, 0.08472955226898193, 0.6813211441040039, 0.8051828145980835, 1.7629081010818481, 1.9482102394104004, 0.41529643535614014, 0.4902878999710083, 0.9022214412689209, 1.4445695877075195, 1.2600431442260742, 2.0919418334960938, 0.30907440185546875, 0.30019664764404297, 0.06883740425109863, 0.3951699733734131, 0.04664134979248047, 1.1534510850906372, 0.39798200130462646, 1.3709208965301514, 1.8957734107971191, 0.8274872303009033, 0.779273509979248, 0.12207674980163574, 0.6791050434112549, 0.42886555194854736, 1.3030554056167603, 0.7748245000839233, 0.9157119989395142, 0.4546281099319458, 1.7829701900482178, 0.8741194009780884, 0.6296696662902832, 0.9777204990386963, 2.9046196937561035, 0.2863495349884033, 0.4410583972930908, 0.4031463861465454, 0.14102458953857422, 0.6422951221466064, 0.19642221927642822], "mean_td_error": 0.7900218367576599, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 51.0, "diff_num_grad_updates_vs_sampler_policy": 50.0}}, "num_env_steps_sampled": 46592, "num_env_steps_trained": 13158, "num_agent_steps_sampled": 139776, "num_agent_steps_trained": 13158, "last_target_update_ts": 46592, "num_target_updates": 51}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 139776, "num_agent_steps_trained": 13158, "num_env_steps_sampled": 46592, "num_env_steps_trained": 13158, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 575.5779538161846, "num_env_steps_trained_throughput_per_sec": 165.735616165821, "timesteps_total": 46592, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 139776, "timers": {"training_iteration_time_ms": 1770.595, "sample_time_ms": 1179.471, "load_time_ms": 0.517, "load_throughput": 498654.639, "learn_time_ms": 61.228, "learn_throughput": 4213.772, "synch_weights_time_ms": 15.518}, "counters": {"num_env_steps_sampled": 46592, "num_env_steps_trained": 13158, "num_agent_steps_sampled": 139776, "num_agent_steps_trained": 13158, "last_target_update_ts": 46592, "num_target_updates": 51}, "done": false, "episodes_total": 0, "training_iteration": 52, "trial_id": "9a806_00000", "date": "2023-11-16_21-55-13", "timestamp": 1700200513, "time_this_iter_s": 1.5727660655975342, "time_total_s": 94.0307822227478, "pid": 45784, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fadd05268b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 94.0307822227478, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 68.35, "ram_util_percent": 90.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.091242790222168, "actor_loss": -8.82033920288086, "critic_loss": 0.3700740337371826, "alpha_loss": -0.15442103147506714, "alpha_value": 0.9848139882087708, "log_alpha_value": -0.015302480198442936, "target_entropy": -6.0, "policy_t": -0.012060176581144333, "mean_q": 5.47629976272583, "max_q": 6.4564690589904785, "min_q": 4.625888824462891}, "td_error": [0.9943063259124756, 0.6995561122894287, 0.25711631774902344, 1.1335153579711914, 0.6629984378814697, 0.7397372722625732, 0.5727875232696533, 0.37149882316589355, 1.888465404510498, 1.282993197441101, 0.4327585697174072, 0.2470874786376953, 0.585115909576416, 0.5789656639099121, 2.6286685466766357, 1.275040626525879, 0.4758577346801758, 1.3806161880493164, 0.560399055480957, 0.5659687519073486, 1.1400349140167236, 0.23513102531433105, 1.0254333019256592, 0.42644476890563965, 1.577444314956665, 0.5765058994293213, 0.6323583126068115, 0.8394074440002441, 1.8967163562774658, 1.6245152950286865, 2.8429007530212402, 1.621532678604126, 0.6696293354034424, 1.8066954612731934, 1.1607537269592285, 2.3346848487854004, 0.3411390781402588, 1.7041263580322266, 0.7435424327850342, 2.398921012878418, 1.4593710899353027, 0.532080888748169, 1.0544052124023438, 0.6544733047485352, 1.2560300827026367, 1.0149638652801514, 1.920757532119751, 2.8531830310821533, 0.25792622566223145, 1.4769222736358643, 1.3593640327453613, 0.6152710914611816, 0.7275004386901855, 0.2708156108856201, 0.7812433242797852, 0.7552213668823242, 1.226374626159668, 0.523144006729126, 0.42136454582214355, 1.803684949874878, 0.4838063716888428, 0.5130164623260498, 1.9357585906982422, 0.545823335647583, 0.5473246574401855, 2.0469043254852295, 0.7462043762207031, 1.5166041851043701, 0.5706731081008911, 0.5228855609893799, 0.6131786108016968, 0.5187242031097412, 0.5092074871063232, 1.4629602432250977, 1.5770211219787598, 3.7426183223724365, 1.6783134937286377, 0.99163818359375, 0.4546542167663574, 1.4837183952331543, 0.9212901592254639, 0.8138542175292969, 0.5105953216552734, 1.807807207107544, 0.7322819232940674, 1.8619153499603271], "mean_td_error": 1.0814446210861206, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 52.0, "diff_num_grad_updates_vs_sampler_policy": 51.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.060105323791504, "actor_loss": -8.179805755615234, "critic_loss": 0.2520279884338379, "alpha_loss": -0.15398149192333221, "alpha_value": 0.9848104119300842, "log_alpha_value": -0.01530615147203207, "target_entropy": -6.0, "policy_t": 0.003963821101933718, "mean_q": 4.293129920959473, "max_q": 4.962312698364258, "min_q": 3.5866525173187256}, "td_error": [1.0773448944091797, 0.35410428047180176, 0.5510350465774536, 0.16559553146362305, 1.6660900115966797, 0.8339638710021973, 3.1699466705322266, 0.4674069881439209, 0.45522820949554443, 0.2778449058532715, 2.3819127082824707, 3.134068489074707, 0.3865278959274292, 0.6357293128967285, 0.1839672327041626, 0.7830064296722412, 1.7953906059265137, 1.5078266859054565, 1.5879168510437012, 0.21281158924102783, 0.2660738229751587, 0.047757625579833984, 1.9048960208892822, 0.9369015693664551, 2.990955114364624, 0.7876572608947754, 0.19258761405944824, 1.213343620300293, 1.5014162063598633, 0.6676989793777466, 0.27423763275146484, 0.8950204849243164, 0.7098712921142578, 0.17292475700378418, 0.7674417495727539, 0.47341465950012207, 2.1595544815063477, 0.18050718307495117, 1.1215662956237793, 0.17183589935302734, 1.122390866279602, 0.4045494794845581, 0.5973553657531738, 3.0978899002075195, 0.9564833641052246, 1.6126527786254883, 1.3201313018798828, 1.3825452327728271, 1.3363369703292847, 0.32032227516174316, 1.6113488674163818, 0.6923487186431885, 0.2427823543548584, 0.5068507194519043, 0.5802184343338013, 1.483144998550415, 1.6356492042541504, 0.4508399963378906, 1.1104518175125122, 1.0594680309295654, 1.9616775512695312, 0.8264751434326172, 2.5090534687042236, 1.0958225727081299, 0.2882113456726074, 0.4636843204498291, 0.989377498626709, 3.072781801223755, 1.4729869365692139, 0.9362833499908447, 0.25182604789733887, 0.28939127922058105, 1.030911922454834, 2.0025713443756104, 0.6828213930130005, 0.702610969543457, 2.0266342163085938, 0.22952497005462646, 1.5565690994262695, 1.2567061185836792, 1.571983814239502, 0.5088422298431396, 4.300506591796875, 2.042757272720337, 0.5906612873077393, 0.8548984527587891], "mean_td_error": 1.0942176580429077, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 52.0, "diff_num_grad_updates_vs_sampler_policy": 51.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.043305397033691, "actor_loss": -7.8629865646362305, "critic_loss": 0.14887338876724243, "alpha_loss": -0.15370148420333862, "alpha_value": 0.9848126173019409, "log_alpha_value": -0.015303874388337135, "target_entropy": -6.0, "policy_t": -0.021913932636380196, "mean_q": 3.9169647693634033, "max_q": 4.554449081420898, "min_q": 3.4183454513549805}, "td_error": [0.9999186992645264, 0.6355767250061035, 0.4460793733596802, 1.992095708847046, 0.296750545501709, 1.4802534580230713, 0.17663753032684326, 0.09021532535552979, 0.19632720947265625, 0.3161931037902832, 0.30355381965637207, 1.6883914470672607, 0.8656983375549316, 0.13437926769256592, 1.5105764865875244, 1.6424180269241333, 0.9468264579772949, 0.44143712520599365, 0.35281503200531006, 2.593418836593628, 0.060584187507629395, 0.31040453910827637, 0.2619037628173828, 0.34630656242370605, 0.4023319482803345, 0.21078896522521973, 0.4035111665725708, 2.9383792877197266, 1.7660892009735107, 2.4675827026367188, 0.8727588653564453, 1.3466757535934448, 0.9929994344711304, 0.6097687482833862, 0.8836953639984131, 0.7128846645355225, 0.9857840538024902, 1.7462003231048584, 0.31629860401153564, 2.786222219467163, 0.5621421337127686, 0.8505842685699463, 1.2099946737289429, 0.2815544605255127, 0.2331535816192627, 0.5801835060119629, 0.8890503644943237, 0.2178354263305664, 0.13501524925231934, 1.5964702367782593, 2.130350112915039, 1.865809679031372, 0.07015609741210938, 0.2742340564727783, 1.7347151041030884, 0.4350459575653076, 0.18578791618347168, 0.42950594425201416, 0.9073996543884277, 0.5189566612243652, 1.0757317543029785, 1.6419997215270996, 0.5765249729156494, 0.9460617303848267, 0.28638291358947754, 0.37820637226104736, 1.1693732738494873, 0.44095611572265625, 1.8448200225830078, 2.360954761505127, 0.18091845512390137, 1.4460314512252808, 1.109256625175476, 0.04358673095703125, 0.4691274166107178, 1.793705940246582, 1.6547560691833496, 0.469588041305542, 0.360654354095459, 1.5317931175231934, 1.7088298797607422, 0.6003713607788086, 1.005246639251709, 0.24003958702087402, 0.20842409133911133, 0.32513904571533203], "mean_td_error": 0.8896180987358093, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 52.0, "diff_num_grad_updates_vs_sampler_policy": 51.0}}, "num_env_steps_sampled": 47488, "num_env_steps_trained": 13416, "num_agent_steps_sampled": 142464, "num_agent_steps_trained": 13416, "last_target_update_ts": 47488, "num_target_updates": 52}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 142464, "num_agent_steps_trained": 13416, "num_env_steps_sampled": 47488, "num_env_steps_trained": 13416, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 552.3080806566625, "num_env_steps_trained_throughput_per_sec": 159.03513929622648, "timesteps_total": 47488, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 142464, "timers": {"training_iteration_time_ms": 1760.6, "sample_time_ms": 1166.781, "load_time_ms": 0.519, "load_throughput": 496823.117, "learn_time_ms": 61.129, "learn_throughput": 4220.616, "synch_weights_time_ms": 15.541}, "counters": {"num_env_steps_sampled": 47488, "num_env_steps_trained": 13416, "num_agent_steps_sampled": 142464, "num_agent_steps_trained": 13416, "last_target_update_ts": 47488, "num_target_updates": 52}, "done": false, "episodes_total": 0, "training_iteration": 53, "trial_id": "9a806_00000", "date": "2023-11-16_21-55-14", "timestamp": 1700200514, "time_this_iter_s": 1.6379649639129639, "time_total_s": 95.66874718666077, "pid": 45784, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fadd0526d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 95.66874718666077, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 54.06666666666667, "ram_util_percent": 90.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.050338745117188, "actor_loss": -9.052755355834961, "critic_loss": 0.3549460470676422, "alpha_loss": -0.15680791437625885, "alpha_value": 0.984518826007843, "log_alpha_value": -0.015602251514792442, "target_entropy": -6.0, "policy_t": 0.0236047375947237, "mean_q": 5.7260637283325195, "max_q": 6.801233291625977, "min_q": 4.994543075561523}, "td_error": [0.48298048973083496, 0.18175292015075684, 1.1864972114562988, 0.10380411148071289, 0.7412316799163818, 1.1895251274108887, 1.0953466892242432, 0.37624335289001465, 1.7348246574401855, 0.3888661861419678, 1.2179489135742188, 0.8558187484741211, 1.4907076358795166, 1.7177627086639404, 0.9703822135925293, 0.710472822189331, 1.6998012065887451, 0.3848536014556885, 0.559267520904541, 0.2137928009033203, 2.9352669715881348, 0.32814764976501465, 2.3703255653381348, 0.7222204208374023, 0.9321181774139404, 1.3833858966827393, 1.3763248920440674, 1.1963331699371338, 0.940432071685791, 0.963557243347168, 0.819108247756958, 0.3932833671569824, 1.0548522472381592, 0.6633310317993164, 0.6194517612457275, 1.4976027011871338, 2.29947566986084, 1.7483739852905273, 2.565702438354492, 0.2254009246826172, 1.2048923969268799, 1.2103328704833984, 3.055974006652832, 2.8265233039855957, 0.6006283760070801, 1.6150774955749512, 1.345548152923584, 0.3358945846557617, 0.7798779010772705, 1.0483148097991943, 0.9840202331542969, 0.677473783493042, 0.7362055778503418, 0.4160623550415039, 0.561774730682373, 0.4742097854614258, 1.2155895233154297, 0.49411940574645996, 1.6642298698425293, 1.3271476030349731, 0.684185266494751, 0.636202335357666, 0.3897242546081543, 1.2112743854522705, 0.8138236999511719, 0.18617582321166992, 2.0157108306884766, 0.39925384521484375, 0.8263669013977051, 1.3210091590881348, 2.1292426586151123, 1.6129777431488037, 0.3061680793762207, 0.7709712982177734, 1.1810088157653809, 1.9867777824401855, 1.1183452606201172, 1.1858253479003906, 1.0014758110046387, 0.18546748161315918, 1.5710601806640625, 1.7169651985168457, 1.8283801078796387, 1.7005000114440918, 0.7550086975097656, 0.5907068252563477], "mean_td_error": 1.0818032026290894, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 53.0, "diff_num_grad_updates_vs_sampler_policy": 52.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.051661491394043, "actor_loss": -8.224709510803223, "critic_loss": 0.23726579546928406, "alpha_loss": -0.15686599910259247, "alpha_value": 0.9845151901245117, "log_alpha_value": -0.015605978667736053, "target_entropy": -6.0, "policy_t": -0.019097601994872093, "mean_q": 4.319788455963135, "max_q": 5.030642509460449, "min_q": 3.684141159057617}, "td_error": [1.664834976196289, 1.6956331729888916, 0.7242141962051392, 0.6329772472381592, 0.40635907649993896, 2.6697566509246826, 0.5787291526794434, 1.0732368230819702, 0.37712621688842773, 0.3146381378173828, 0.2826591730117798, 0.5003211498260498, 2.814274787902832, 0.9592494964599609, 0.43277716636657715, 0.17926156520843506, 2.1020078659057617, 0.17983555793762207, 3.0389626026153564, 1.4871799945831299, 0.16547560691833496, 1.0729539394378662, 0.43062734603881836, 0.44820237159729004, 1.957240104675293, 3.0012879371643066, 0.20142173767089844, 0.7412874698638916, 1.2485544681549072, 0.22052311897277832, 0.9280798435211182, 0.8438024520874023, 1.2385368347167969, 0.17699098587036133, 1.2671575546264648, 1.0227043628692627, 1.3160213232040405, 1.6965728998184204, 3.2410483360290527, 1.9876949787139893, 1.4244885444641113, 0.42475295066833496, 0.8836343288421631, 0.1051783561706543, 1.278998613357544, 2.7986481189727783, 0.7188143730163574, 1.131170630455017, 1.9026317596435547, 0.3435475826263428, 0.6533269882202148, 0.2807188034057617, 0.12876486778259277, 0.8898048400878906, 1.0544376373291016, 0.8172974586486816, 0.3876990079879761, 0.7237778902053833, 0.3015592098236084, 2.654700994491577, 0.9187743663787842, 0.6966478824615479, 0.6135356426239014, 1.6883463859558105, 3.3640809059143066, 0.9130427837371826, 3.3282454013824463, 1.811326503753662, 0.23224186897277832, 0.8966988325119019, 0.35487091541290283, 0.8821496963500977, 0.07340288162231445, 0.353987455368042, 0.49918603897094727, 0.8560769557952881, 0.26265430450439453, 0.5209701061248779, 0.8238683938980103, 0.12956547737121582, 0.3797694444656372, 0.7671505212783813, 1.5305843353271484, 2.073619842529297, 1.3980684280395508, 0.7332029342651367], "mean_td_error": 1.0503050088882446, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 53.0, "diff_num_grad_updates_vs_sampler_policy": 52.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.052132606506348, "actor_loss": -7.961523532867432, "critic_loss": 0.17691609263420105, "alpha_loss": -0.15684925019741058, "alpha_value": 0.984517514705658, "log_alpha_value": -0.015603577718138695, "target_entropy": -6.0, "policy_t": -0.032137539237737656, "mean_q": 3.9793055057525635, "max_q": 4.822809219360352, "min_q": 3.3365468978881836}, "td_error": [0.0317080020904541, 1.4109125137329102, 2.350020408630371, 0.5679051876068115, 0.20072269439697266, 1.0461876392364502, 0.9376673698425293, 1.1282942295074463, 0.07786035537719727, 0.5098702907562256, 1.4097532033920288, 0.51552414894104, 0.1489008665084839, 2.6471261978149414, 1.683666467666626, 0.521395206451416, 0.44597649574279785, 0.1243124008178711, 1.3596724271774292, 1.1254624128341675, 1.3021488189697266, 1.3841326236724854, 0.055729031562805176, 1.4568047523498535, 0.07451498508453369, 0.31410467624664307, 2.4554131031036377, 2.2648520469665527, 3.092313766479492, 1.9698803424835205, 1.0512113571166992, 1.656998872756958, 1.74384343624115, 0.8656237125396729, 0.5931789875030518, 0.18164849281311035, 0.033771514892578125, 2.242866039276123, 1.1489499807357788, 1.9654914140701294, 2.1956565380096436, 1.6529951095581055, 1.276473879814148, 0.15389180183410645, 1.3362500667572021, 0.9121748208999634, 1.1574630737304688, 0.2517421245574951, 0.328685998916626, 0.15644240379333496, 0.1376802921295166, 0.9086779356002808, 0.5821527242660522, 0.21988999843597412, 0.7151925563812256, 0.7176570892333984, 0.47888731956481934, 1.4419925212860107, 1.359501838684082, 0.24833226203918457, 0.8505069017410278, 0.8828544616699219, 0.06268072128295898, 1.4510343074798584, 2.6946401596069336, 1.3138442039489746, 1.0350220203399658, 0.3190842866897583, 1.717341661453247, 1.4938818216323853, 1.2669310569763184, 2.3315811157226562, 1.6930328607559204, 1.463531255722046, 0.11516594886779785, 0.8298728466033936, 0.76137375831604, 0.6840012073516846, 0.2806367874145508, 0.30934906005859375, 0.34214234352111816, 0.8620887994766235, 0.2619197368621826, 0.15508079528808594, 1.049340009689331, 2.7445290088653564], "mean_td_error": 1.0151119232177734, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 53.0, "diff_num_grad_updates_vs_sampler_policy": 52.0}}, "num_env_steps_sampled": 48384, "num_env_steps_trained": 13674, "num_agent_steps_sampled": 145152, "num_agent_steps_trained": 13674, "last_target_update_ts": 48384, "num_target_updates": 53}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 145152, "num_agent_steps_trained": 13674, "num_env_steps_sampled": 48384, "num_env_steps_trained": 13674, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 519.639301588399, "num_env_steps_trained_throughput_per_sec": 149.62828103773097, "timesteps_total": 48384, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 145152, "timers": {"training_iteration_time_ms": 1743.775, "sample_time_ms": 1148.325, "load_time_ms": 0.525, "load_throughput": 491609.319, "learn_time_ms": 61.122, "learn_throughput": 4221.07, "synch_weights_time_ms": 15.745}, "counters": {"num_env_steps_sampled": 48384, "num_env_steps_trained": 13674, "num_agent_steps_sampled": 145152, "num_agent_steps_trained": 13674, "last_target_update_ts": 48384, "num_target_updates": 53}, "done": false, "episodes_total": 0, "training_iteration": 54, "trial_id": "9a806_00000", "date": "2023-11-16_21-55-16", "timestamp": 1700200516, "time_this_iter_s": 1.7383201122283936, "time_total_s": 97.40706729888916, "pid": 45784, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fadd04f4af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 97.40706729888916, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 80.05000000000001, "ram_util_percent": 90.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.1542387008667, "actor_loss": -9.27255916595459, "critic_loss": 0.36550140380859375, "alpha_loss": -0.1614723652601242, "alpha_value": 0.9842237830162048, "log_alpha_value": -0.015901964157819748, "target_entropy": -6.0, "policy_t": -0.04845710098743439, "mean_q": 5.896097183227539, "max_q": 7.218153476715088, "min_q": 4.989940166473389}, "td_error": [1.9192986488342285, 1.2982382774353027, 0.8549642562866211, 0.6838037967681885, 0.54445481300354, 0.6567790508270264, 0.6464424133300781, 0.3812236785888672, 0.3535194396972656, 0.7770874500274658, 0.4413778781890869, 0.9467124938964844, 1.0750412940979004, 0.7431817054748535, 1.2678053379058838, 1.8955397605895996, 0.6309795379638672, 1.3631808757781982, 1.1424989700317383, 0.5272302627563477, 1.2390072345733643, 2.8541669845581055, 1.5378828048706055, 0.2891509532928467, 0.6214156150817871, 0.35025525093078613, 0.647655725479126, 1.024190902709961, 0.7678215503692627, 0.6572160720825195, 0.276090145111084, 1.738248586654663, 0.29691123962402344, 1.3872146606445312, 2.289649724960327, 2.1400668621063232, 1.2314198017120361, 1.4379346370697021, 0.21609878540039062, 2.1248373985290527, 0.25264859199523926, 0.49133849143981934, 0.9092435836791992, 3.5669608116149902, 0.6262726783752441, 2.9751296043395996, 3.467642068862915, 0.41687726974487305, 0.7240283489227295, 0.5260963439941406, 1.8943171501159668, 1.6067137718200684, 1.7849812507629395, 0.5578343868255615, 0.4174017906188965, 0.3828425407409668, 1.3207621574401855, 0.3688664436340332, 0.44866204261779785, 0.7089169025421143, 1.5980439186096191, 1.341078519821167, 1.4624183177947998, 1.025977373123169, 0.7395434379577637, 1.5036048889160156, 0.9940781593322754, 1.0341660976409912, 1.7963011264801025, 0.534998893737793, 1.1083717346191406, 0.6599223613739014, 0.09771847724914551, 0.2686800956726074, 1.652644395828247, 0.7316775321960449, 0.6290075778961182, 2.490227699279785, 0.8919854164123535, 1.5560567378997803, 0.723196268081665, 0.6176183223724365, 0.14835548400878906, 0.5044846534729004, 0.33522915840148926, 1.5134527683258057], "mean_td_error": 1.0544531345367432, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 54.0, "diff_num_grad_updates_vs_sampler_policy": 53.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.034542083740234, "actor_loss": -8.285894393920898, "critic_loss": 0.2127806395292282, "alpha_loss": -0.15960687398910522, "alpha_value": 0.9842200875282288, "log_alpha_value": -0.015905745327472687, "target_entropy": -6.0, "policy_t": -0.03086147829890251, "mean_q": 4.357163906097412, "max_q": 5.3137617111206055, "min_q": 3.7334864139556885}, "td_error": [2.1722910404205322, 0.6275122165679932, 0.5047917366027832, 0.42560720443725586, 1.3932504653930664, 2.7690305709838867, 1.373457670211792, 0.2867450714111328, 0.8327755928039551, 0.6064302921295166, 0.7631118297576904, 0.5893445014953613, 0.563194990158081, 0.2783677577972412, 1.3642935752868652, 0.2930337190628052, 2.0591461658477783, 2.16353440284729, 0.1541459560394287, 0.6420192718505859, 0.29221153259277344, 1.9119884967803955, 0.2059859037399292, 3.120943546295166, 0.8831324577331543, 0.648958683013916, 0.8700129985809326, 1.2646563053131104, 2.433953285217285, 1.7480618953704834, 2.186849594116211, 1.2891288995742798, 1.665403127670288, 0.38255834579467773, 0.56095290184021, 1.0696032047271729, 1.2297029495239258, 0.3745574951171875, 0.7073178291320801, 0.0901867151260376, 0.20632386207580566, 1.343374252319336, 0.3140594959259033, 2.109712839126587, 0.5012893676757812, 0.8852565288543701, 1.696751594543457, 0.4513542652130127, 1.6726841926574707, 1.7374882698059082, 0.4249989986419678, 1.0417087078094482, 0.3766801357269287, 1.287876844406128, 1.2371113300323486, 2.4096484184265137, 0.2419896125793457, 0.17280340194702148, 0.7916586399078369, 0.7934930324554443, 1.8153088092803955, 0.9547262191772461, 0.4536917209625244, 0.0809473991394043, 1.0806231498718262, 0.5862488746643066, 1.0639679431915283, 2.251162528991699, 1.5396788120269775, 1.310448169708252, 0.40256786346435547, 0.02174210548400879, 0.7638731002807617, 0.28912997245788574, 0.2555515766143799, 0.9783728122711182, 2.266982078552246, 0.7010939121246338, 0.2948122024536133, 0.7227718830108643, 0.30035173892974854, 1.1962218284606934, 0.8748817443847656, 0.0330507755279541, 0.25965404510498047, 1.222473382949829], "mean_td_error": 0.9792423844337463, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 54.0, "diff_num_grad_updates_vs_sampler_policy": 53.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.081603050231934, "actor_loss": -8.070568084716797, "critic_loss": 0.1571456789970398, "alpha_loss": -0.1603299081325531, "alpha_value": 0.9842225909233093, "log_alpha_value": -0.01590321585536003, "target_entropy": -6.0, "policy_t": -0.043915875256061554, "mean_q": 4.107955455780029, "max_q": 4.9914231300354, "min_q": 3.4882125854492188}, "td_error": [0.9944140911102295, 0.794100284576416, 0.6178009510040283, 1.9877424240112305, 4.227034091949463, 0.16892492771148682, 1.1618082523345947, 0.21917510032653809, 0.1873617172241211, 1.6432836055755615, 0.8326654434204102, 1.5632712841033936, 1.4958748817443848, 1.1895376443862915, 0.9512054920196533, 0.2030426263809204, 0.04973328113555908, 1.4423881769180298, 0.5960693359375, 0.18172597885131836, 2.5933127403259277, 0.09881782531738281, 0.12888360023498535, 0.6753934621810913, 1.9323378801345825, 2.707061290740967, 0.28016114234924316, 0.16416645050048828, 0.040574073791503906, 0.6130001544952393, 1.0091769695281982, 1.2239397764205933, 1.0148656368255615, 0.7353341579437256, 2.074843406677246, 0.8456428050994873, 0.8059866428375244, 0.9463090896606445, 1.8075237274169922, 0.44754910469055176, 1.055689811706543, 2.924919843673706, 0.7269454002380371, 0.09585833549499512, 0.7182626724243164, 0.8048794269561768, 0.5740071535110474, 0.6526360511779785, 0.9905623197555542, 0.6042928695678711, 1.587453007698059, 0.13596737384796143, 2.2691550254821777, 0.8862961530685425, 0.18106043338775635, 1.3098727464675903, 0.8332405090332031, 1.0855368375778198, 1.249422550201416, 0.020316004753112793, 0.46370816230773926, 2.7178571224212646, 0.9147763252258301, 0.45585036277770996, 1.0912225246429443, 0.060422658920288086, 0.06395411491394043, 0.0970923900604248, 1.6850066184997559, 0.22147679328918457, 0.7437031269073486, 0.7967352867126465, 0.6934788227081299, 0.07977914810180664, 1.2385571002960205, 0.18297255039215088, 0.8845279216766357, 0.594633936882019, 0.013013243675231934, 0.16468358039855957, 1.7779463529586792, 2.1165010929107666, 0.1295994520187378, 0.8274025917053223, 1.3084925413131714, 1.1011565923690796], "mean_td_error": 0.9277089238166809, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 54.0, "diff_num_grad_updates_vs_sampler_policy": 53.0}}, "num_env_steps_sampled": 49280, "num_env_steps_trained": 13932, "num_agent_steps_sampled": 147840, "num_agent_steps_trained": 13932, "last_target_update_ts": 49280, "num_target_updates": 54}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 147840, "num_agent_steps_trained": 13932, "num_env_steps_sampled": 49280, "num_env_steps_trained": 13932, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 519.20539351872, "num_env_steps_trained_throughput_per_sec": 149.50333875873858, "timesteps_total": 49280, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 147840, "timers": {"training_iteration_time_ms": 1733.882, "sample_time_ms": 1137.419, "load_time_ms": 0.528, "load_throughput": 489098.5, "learn_time_ms": 61.091, "learn_throughput": 4223.194, "synch_weights_time_ms": 15.776}, "counters": {"num_env_steps_sampled": 49280, "num_env_steps_trained": 13932, "num_agent_steps_sampled": 147840, "num_agent_steps_trained": 13932, "last_target_update_ts": 49280, "num_target_updates": 54}, "done": false, "episodes_total": 0, "training_iteration": 55, "trial_id": "9a806_00000", "date": "2023-11-16_21-55-18", "timestamp": 1700200518, "time_this_iter_s": 1.7424278259277344, "time_total_s": 99.1494951248169, "pid": 45784, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fadd0533c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 99.1494951248169, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 61.20000000000001, "ram_util_percent": 90.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.093358039855957, "actor_loss": -9.427360534667969, "critic_loss": 0.29850083589553833, "alpha_loss": -0.1635313630104065, "alpha_value": 0.9839286804199219, "log_alpha_value": -0.01620187796652317, "target_entropy": -6.0, "policy_t": -0.04410195350646973, "mean_q": 5.9887871742248535, "max_q": 6.943743705749512, "min_q": 4.886694431304932}, "td_error": [0.9296579360961914, 0.7173078060150146, 1.1614811420440674, 0.7386105060577393, 0.8933360576629639, 0.421039342880249, 0.6429777145385742, 0.66007399559021, 0.38210225105285645, 2.6677210330963135, 0.6789348125457764, 1.451889991760254, 1.825571060180664, 1.7480885982513428, 0.39671826362609863, 1.168342113494873, 2.1584599018096924, 2.2344772815704346, 0.4371635913848877, 0.6180322170257568, 0.2611417770385742, 0.23172497749328613, 0.9137327671051025, 0.2863311767578125, 0.5637037754058838, 0.9594757556915283, 0.27930617332458496, 1.8911573886871338, 0.6730437278747559, 0.7258138656616211, 0.926642656326294, 0.6125471591949463, 1.270754098892212, 0.21658611297607422, 0.5528163909912109, 1.0296289920806885, 2.113626480102539, 1.5128121376037598, 1.5917811393737793, 0.42935752868652344, 1.2046496868133545, 0.3988659381866455, 0.43323254585266113, 0.6300230026245117, 0.5098624229431152, 0.8188984394073486, 0.5966970920562744, 0.5981192588806152, 1.5631766319274902, 0.4796457290649414, 0.5067634582519531, 0.9373514652252197, 1.7374272346496582, 1.963254451751709, 1.2106623649597168, 1.1809353828430176, 0.796210527420044, 0.5463590621948242, 1.1561555862426758, 1.9245271682739258, 0.6847836971282959, 0.5437405109405518, 1.338172435760498, 0.6796088218688965, 0.28109264373779297, 0.38631558418273926, 2.000810384750366, 0.8641200065612793, 1.6885192394256592, 0.23529911041259766, 2.180617332458496, 0.17194676399230957, 0.7893896102905273, 1.1090333461761475, 0.40378642082214355, 0.23550128936767578, 0.6399874687194824, 0.965893030166626, 0.8672091960906982, 0.5561449527740479, 0.3845031261444092, 1.7069036960601807, 1.2504534721374512, 0.7942116260528564, 0.5414013862609863, 0.4116075038909912], "mean_td_error": 0.9288120865821838, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 55.0, "diff_num_grad_updates_vs_sampler_policy": 54.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.034771919250488, "actor_loss": -8.260469436645508, "critic_loss": 0.22806169092655182, "alpha_loss": -0.16261766850948334, "alpha_value": 0.9839251637458801, "log_alpha_value": -0.01620541512966156, "target_entropy": -6.0, "policy_t": -0.001822483609430492, "mean_q": 4.422996997833252, "max_q": 5.152634620666504, "min_q": 3.7866506576538086}, "td_error": [0.41272425651550293, 2.2088210582733154, 1.6513290405273438, 0.7906962633132935, 1.339707612991333, 0.17426705360412598, 0.49260997772216797, 1.437037467956543, 1.3825654983520508, 0.21988344192504883, 1.4433767795562744, 0.491213321685791, 1.0423648357391357, 1.2031586170196533, 2.5950191020965576, 0.6219537258148193, 0.2671849727630615, 2.0366950035095215, 1.3787806034088135, 0.788722038269043, 0.14709687232971191, 0.43880534172058105, 0.28972578048706055, 0.8456323146820068, 1.3764464855194092, 0.8057153224945068, 1.413987398147583, 0.9745602607727051, 1.9661448001861572, 0.6441807746887207, 0.4313027858734131, 0.957172155380249, 1.5077619552612305, 1.4329078197479248, 2.334596633911133, 0.29906344413757324, 0.5117957592010498, 2.9986112117767334, 0.8056094646453857, 0.5169572830200195, 0.19884848594665527, 0.6118409633636475, 0.9698324203491211, 1.1069996356964111, 0.4449373483657837, 1.236053705215454, 1.2492914199829102, 0.7249987125396729, 2.611311912536621, 1.2162439823150635, 1.3306901454925537, 1.5779292583465576, 0.34707021713256836, 1.1013693809509277, 0.2716052532196045, 1.9004864692687988, 0.3345448970794678, 1.3298015594482422, 1.0275930166244507, 0.47986483573913574, 0.15160226821899414, 0.412813663482666, 1.0510159730911255, 1.5060352087020874, 1.763854742050171, 0.3837552070617676, 1.0610289573669434, 0.12009549140930176, 0.23674845695495605, 2.9811291694641113, 0.7992966175079346, 0.9533668756484985, 0.0870368480682373, 0.6064262390136719, 0.6922256946563721, 0.6140627861022949, 0.43825316429138184, 1.5161938667297363, 0.7278480529785156, 1.692215919494629, 2.0586414337158203, 2.4090049266815186, 1.2458162307739258, 1.0049102306365967, 1.22462797164917, 0.8029880523681641], "mean_td_error": 1.038238286972046, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 55.0, "diff_num_grad_updates_vs_sampler_policy": 54.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.038966178894043, "actor_loss": -8.110869407653809, "critic_loss": 0.19024282693862915, "alpha_loss": -0.16266004741191864, "alpha_value": 0.9839276671409607, "log_alpha_value": -0.016202867031097412, "target_entropy": -6.0, "policy_t": 0.013325517997145653, "mean_q": 4.138350486755371, "max_q": 4.681856632232666, "min_q": 3.397979736328125}, "td_error": [1.5863069295883179, 0.10701203346252441, 0.4139021635055542, 1.3714063167572021, 3.766425371170044, 2.1708219051361084, 1.525672435760498, 0.8351020812988281, 1.1215524673461914, 0.3778707981109619, 1.1554038524627686, 0.8440437316894531, 0.1792011260986328, 0.5082781314849854, 4.0976972579956055, 1.6525249481201172, 1.3279948234558105, 1.9402008056640625, 1.4847910404205322, 1.421464443206787, 1.3650383949279785, 1.592059850692749, 0.23787760734558105, 1.2541046142578125, 0.3086742162704468, 1.59810471534729, 1.6311769485473633, 0.2898160219192505, 1.1158573627471924, 1.8921830654144287, 0.4995511770248413, 0.822472095489502, 0.16097187995910645, 1.6352927684783936, 0.21904730796813965, 0.1702423095703125, 0.18507862091064453, 2.051996946334839, 0.951279878616333, 1.6806837320327759, 0.27566492557525635, 1.444131851196289, 1.520686388015747, 1.1592795848846436, 0.5817892551422119, 0.17097270488739014, 2.0035958290100098, 1.154754400253296, 0.3337748050689697, 1.458075761795044, 2.4598546028137207, 0.4103667736053467, 1.8711941242218018, 0.7491141557693481, 0.6377620697021484, 0.5253996849060059, 2.8218228816986084, 2.0229592323303223, 0.03724396228790283, 0.39301323890686035, 1.1664273738861084, 0.5204355716705322, 0.7764652967453003, 0.7271432876586914, 1.1956160068511963, 0.8030757904052734, 0.31733202934265137, 0.23098301887512207, 1.5572173595428467, 1.2342897653579712, 0.5288817882537842, 1.4086267948150635, 1.2369945049285889, 0.5568662881851196, 0.03018021583557129, 2.0942654609680176, 1.4116950035095215, 1.5115448236465454, 0.4288252592086792, 0.5848298072814941, 1.491164207458496, 0.1748640537261963, 0.4819490909576416, 0.2971038818359375, 0.40955424308776855, 2.3210465908050537], "mean_td_error": 1.0823025703430176, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 55.0, "diff_num_grad_updates_vs_sampler_policy": 54.0}}, "num_env_steps_sampled": 50176, "num_env_steps_trained": 14190, "num_agent_steps_sampled": 150528, "num_agent_steps_trained": 14190, "last_target_update_ts": 50176, "num_target_updates": 55}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 150528, "num_agent_steps_trained": 14190, "num_env_steps_sampled": 50176, "num_env_steps_trained": 14190, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 528.3582306273735, "num_env_steps_trained_throughput_per_sec": 152.13886551547137, "timesteps_total": 50176, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 150528, "timers": {"training_iteration_time_ms": 1719.364, "sample_time_ms": 1122.639, "load_time_ms": 0.536, "load_throughput": 481717.607, "learn_time_ms": 61.202, "learn_throughput": 4215.52, "synch_weights_time_ms": 15.113}, "counters": {"num_env_steps_sampled": 50176, "num_env_steps_trained": 14190, "num_agent_steps_sampled": 150528, "num_agent_steps_trained": 14190, "last_target_update_ts": 50176, "num_target_updates": 55}, "done": false, "episodes_total": 0, "training_iteration": 56, "trial_id": "9a806_00000", "date": "2023-11-16_21-55-20", "timestamp": 1700200520, "time_this_iter_s": 1.7141170501708984, "time_total_s": 100.8636121749878, "pid": 45784, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fadd04c93a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 100.8636121749878, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 75.4, "ram_util_percent": 90.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.92721939086914, "actor_loss": -9.633927345275879, "critic_loss": 0.3020917773246765, "alpha_loss": -0.16381719708442688, "alpha_value": 0.9836335778236389, "log_alpha_value": -0.01650182157754898, "target_entropy": -6.0, "policy_t": -0.03267574682831764, "mean_q": 6.147552967071533, "max_q": 7.356788158416748, "min_q": 4.9882659912109375}, "td_error": [0.7020978927612305, 1.483832836151123, 0.6097400188446045, 0.47649431228637695, 0.8724188804626465, 0.8176209926605225, 0.47533130645751953, 1.0185928344726562, 1.404618501663208, 1.9959032535552979, 0.5099618434906006, 0.8467447757720947, 0.3126866817474365, 0.4693729877471924, 1.8657796382904053, 0.7932703495025635, 0.5294060707092285, 0.34455084800720215, 0.5312068462371826, 0.5033435821533203, 0.521111011505127, 1.7645976543426514, 0.5379238128662109, 1.1243062019348145, 1.1798121929168701, 0.314786434173584, 0.8028769493103027, 0.5981078147888184, 1.3189880847930908, 0.869544506072998, 0.5609471797943115, 0.5281212329864502, 0.5227835178375244, 1.749260663986206, 3.0749354362487793, 0.4496321678161621, 1.7219603061676025, 1.2227144241333008, 1.6267445087432861, 2.424286365509033, 0.20360589027404785, 0.2866480350494385, 1.2486557960510254, 0.36882996559143066, 2.2964987754821777, 0.5862994194030762, 0.22183990478515625, 0.2558622360229492, 0.21606659889221191, 0.7725834846496582, 1.4533240795135498, 1.8518753051757812, 3.4343223571777344, 1.8561265468597412, 0.2550337314605713, 1.9535987377166748, 0.8907039165496826, 0.7729499340057373, 0.9081358909606934, 1.425487995147705, 0.5180633068084717, 0.457960844039917, 1.0356340408325195, 0.599268913269043, 1.309373378753662, 0.6243081092834473, 0.33942103385925293, 0.3212249279022217, 1.0352206230163574, 1.8038897514343262, 0.6165242195129395, 0.47327446937561035, 0.5694446563720703, 0.3222529888153076, 0.9144740104675293, 0.3540005683898926, 0.3517496585845947, 0.8378360271453857, 1.5211291313171387, 1.0452473163604736, 1.2901403903961182, 0.9192547798156738, 0.8785552978515625, 1.566528558731079, 0.32578277587890625, 0.8193819522857666], "mean_td_error": 0.9486604928970337, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 56.0, "diff_num_grad_updates_vs_sampler_policy": 55.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.158221244812012, "actor_loss": -8.336130142211914, "critic_loss": 0.20063501596450806, "alpha_loss": -0.16766147315502167, "alpha_value": 0.9836304783821106, "log_alpha_value": -0.016505002975463867, "target_entropy": -6.0, "policy_t": -0.026288332417607307, "mean_q": 4.3459978103637695, "max_q": 5.227306365966797, "min_q": 3.6349549293518066}, "td_error": [0.28572559356689453, 0.9240865707397461, 0.13946318626403809, 0.4016348123550415, 0.6867353916168213, 0.05655944347381592, 0.20646119117736816, 1.221428394317627, 2.2405202388763428, 0.5952596664428711, 1.4486687183380127, 0.7998664379119873, 0.2524886131286621, 1.494767665863037, 0.6306164264678955, 1.2594223022460938, 1.0120601654052734, 0.04880356788635254, 1.7888566255569458, 0.17681503295898438, 2.9784421920776367, 0.8747048377990723, 0.9472408294677734, 1.2057099342346191, 0.820777177810669, 0.37201976776123047, 1.104151964187622, 0.06703662872314453, 1.4996137619018555, 0.6636536121368408, 1.1487946510314941, 1.2714054584503174, 0.06095409393310547, 0.9193291664123535, 0.08746170997619629, 0.31423234939575195, 1.0325963497161865, 1.8925679922103882, 0.4625980854034424, 2.821767807006836, 0.5672323703765869, 1.78432035446167, 0.17412328720092773, 0.7095050811767578, 0.3931155204772949, 0.6895568370819092, 0.3732292652130127, 0.8210270404815674, 0.381117582321167, 0.3100888729095459, 0.740307092666626, 1.2093446254730225, 2.392608642578125, 0.31937646865844727, 0.38971996307373047, 2.4042177200317383, 0.2169508934020996, 1.9958081245422363, 0.1427246332168579, 0.25417494773864746, 0.6894516944885254, 0.21950817108154297, 0.14034199714660645, 1.727327585220337, 0.6087944507598877, 2.70737361907959, 0.6394379138946533, 2.051464796066284, 0.5892574787139893, 0.7798454761505127, 0.24360418319702148, 1.2826216220855713, 0.5823876857757568, 1.8825092315673828, 1.7630131244659424, 2.3262641429901123, 0.7424840927124023, 1.402085781097412, 2.7641398906707764, 0.9118950366973877, 0.44642019271850586, 0.07540726661682129, 0.5743839740753174, 1.121926188468933, 0.3452000617980957, 1.3925330638885498], "mean_td_error": 0.9359712600708008, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 56.0, "diff_num_grad_updates_vs_sampler_policy": 55.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.024545669555664, "actor_loss": -8.218388557434082, "critic_loss": 0.15485510230064392, "alpha_loss": -0.16542932391166687, "alpha_value": 0.9836329817771912, "log_alpha_value": -0.01650242693722248, "target_entropy": -6.0, "policy_t": -0.03983418643474579, "mean_q": 4.226446628570557, "max_q": 4.9930596351623535, "min_q": 3.574009895324707}, "td_error": [2.0448150634765625, 1.649613857269287, 1.2260568141937256, 1.3407965898513794, 1.000848650932312, 1.4654405117034912, 0.11757397651672363, 1.490478277206421, 0.07032608985900879, 1.5518519878387451, 0.592949390411377, 0.7252671718597412, 2.0596094131469727, 1.0007405281066895, 0.4464607238769531, 0.33214640617370605, 0.3226132392883301, 0.4893531799316406, 0.9643146991729736, 1.7941226959228516, 2.9050989151000977, 0.2098853588104248, 1.0600733757019043, 1.6068625450134277, 2.518146514892578, 0.9762285947799683, 2.561119794845581, 0.6338412761688232, 0.7058387994766235, 0.3339052200317383, 0.14065301418304443, 1.0321531295776367, 2.1044039726257324, 1.1771817207336426, 1.2354096174240112, 1.018869400024414, 0.24175786972045898, 0.05967295169830322, 0.8380820751190186, 0.8996431827545166, 0.029459714889526367, 2.0023112297058105, 1.5145199298858643, 0.8743594884872437, 0.41332530975341797, 1.054152488708496, 0.3985922336578369, 0.687476634979248, 0.1298145055770874, 0.6032810211181641, 1.5606634616851807, 1.5391180515289307, 0.887610673904419, 0.6643996238708496, 0.08081412315368652, 0.7625534534454346, 0.6037406921386719, 0.6976158618927002, 2.2542624473571777, 0.023491263389587402, 0.7401773929595947, 1.919590950012207, 0.9690995216369629, 0.6933988332748413, 0.22368061542510986, 0.12227630615234375, 1.598031759262085, 0.28204345703125, 0.2553219795227051, 0.5362186431884766, 0.2415144443511963, 1.9521598815917969, 0.4990617036819458, 0.3306492567062378, 0.23447227478027344, 0.22279298305511475, 1.1683812141418457, 0.3496699333190918, 2.0396740436553955, 0.9607441425323486, 1.125154733657837, 1.5812790393829346, 0.8051512241363525, 0.4363558292388916, 1.186790943145752, 0.49445319175720215], "mean_td_error": 0.9383013248443604, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 56.0, "diff_num_grad_updates_vs_sampler_policy": 55.0}}, "num_env_steps_sampled": 51072, "num_env_steps_trained": 14448, "num_agent_steps_sampled": 153216, "num_agent_steps_trained": 14448, "last_target_update_ts": 51072, "num_target_updates": 56}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 153216, "num_agent_steps_trained": 14448, "num_env_steps_sampled": 51072, "num_env_steps_trained": 14448, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 491.66993858208275, "num_env_steps_trained_throughput_per_sec": 141.57460285064437, "timesteps_total": 51072, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 153216, "timers": {"training_iteration_time_ms": 1723.3, "sample_time_ms": 1121.451, "load_time_ms": 0.537, "load_throughput": 480434.395, "learn_time_ms": 61.358, "learn_throughput": 4204.824, "synch_weights_time_ms": 14.925}, "counters": {"num_env_steps_sampled": 51072, "num_env_steps_trained": 14448, "num_agent_steps_sampled": 153216, "num_agent_steps_trained": 14448, "last_target_update_ts": 51072, "num_target_updates": 56}, "done": false, "episodes_total": 0, "training_iteration": 57, "trial_id": "9a806_00000", "date": "2023-11-16_21-55-22", "timestamp": 1700200522, "time_this_iter_s": 1.8389439582824707, "time_total_s": 102.70255613327026, "pid": 45784, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fadd04f4af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 102.70255613327026, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 69.56666666666666, "ram_util_percent": 90.39999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.019201278686523, "actor_loss": -9.829124450683594, "critic_loss": 0.3339816629886627, "alpha_loss": -0.1683364361524582, "alpha_value": 0.9833389520645142, "log_alpha_value": -0.016801385208964348, "target_entropy": -6.0, "policy_t": -0.03970989212393761, "mean_q": 6.252433776855469, "max_q": 7.805484771728516, "min_q": 5.238616943359375}, "td_error": [1.276620626449585, 0.5921967029571533, 0.7309706211090088, 0.42127084732055664, 0.1946256160736084, 0.4120028018951416, 0.3917405605316162, 0.7594702243804932, 0.47810983657836914, 0.2622547149658203, 1.6708106994628906, 1.067168951034546, 0.4876682758331299, 1.3354418277740479, 0.32065391540527344, 0.575303316116333, 0.36221766471862793, 0.27875304222106934, 1.0214712619781494, 0.28490781784057617, 0.20857453346252441, 2.0283432006835938, 1.5660502910614014, 1.5630793571472168, 0.6453297138214111, 0.3224327564239502, 0.3828442096710205, 2.945772409439087, 1.0065772533416748, 3.0983617305755615, 0.7650423049926758, 0.09272599220275879, 0.37013721466064453, 1.5296716690063477, 0.45313191413879395, 0.8529839515686035, 0.7009613513946533, 0.516120195388794, 0.7239959239959717, 0.7043631076812744, 1.6492383480072021, 1.5471975803375244, 1.3293447494506836, 1.4700746536254883, 0.10781574249267578, 1.0240211486816406, 2.1882944107055664, 2.282726764678955, 1.6898531913757324, 1.3696131706237793, 0.534674882888794, 1.114018440246582, 1.640803337097168, 2.589200496673584, 1.2576122283935547, 1.999877691268921, 0.9981269836425781, 1.8621537685394287, 0.8884546756744385, 0.9314000606536865, 0.5745742321014404, 1.4206161499023438, 1.435441493988037, 0.3591606616973877, 0.3259580135345459, 0.6861412525177002, 0.12019157409667969, 0.5022211074829102, 0.9609122276306152, 0.8446028232574463, 0.9574744701385498, 0.2516486644744873, 0.2992122173309326, 0.33708953857421875, 0.3493661880493164, 1.9091756343841553, 0.8487145900726318, 0.8081936836242676, 0.6839234828948975, 0.31467604637145996, 1.4936809539794922, 0.22098827362060547, 0.4995245933532715, 1.0310931205749512, 3.4523980617523193, 2.962801456451416], "mean_td_error": 0.9944701790809631, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 57.0, "diff_num_grad_updates_vs_sampler_policy": 56.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.041587829589844, "actor_loss": -8.247734069824219, "critic_loss": 0.19087032973766327, "alpha_loss": -0.16874705255031586, "alpha_value": 0.9833356142044067, "log_alpha_value": -0.01680481806397438, "target_entropy": -6.0, "policy_t": -0.00268355174921453, "mean_q": 4.43250846862793, "max_q": 5.283766746520996, "min_q": 3.6168549060821533}, "td_error": [0.6079916954040527, 1.5160958766937256, 2.1530792713165283, 1.7299752235412598, 0.1448986530303955, 0.3579970598220825, 0.2583639621734619, 0.7721676826477051, 0.16956830024719238, 0.2824575901031494, 0.75455641746521, 1.153256893157959, 0.6037490367889404, 0.22156023979187012, 0.686133623123169, 0.9079810380935669, 0.9277677536010742, 1.5313940048217773, 0.19649529457092285, 2.4793756008148193, 0.7550003528594971, 1.0203008651733398, 1.6757203340530396, 0.6141765117645264, 0.5172929763793945, 1.3614680767059326, 0.4242229461669922, 0.032045602798461914, 2.7853360176086426, 0.7116053104400635, 1.2848045825958252, 0.5496113300323486, 0.4264957904815674, 2.513906717300415, 1.8288114070892334, 0.5585670471191406, 1.196373462677002, 0.3872842788696289, 1.7975616455078125, 0.08747482299804688, 0.33492088317871094, 0.6263735294342041, 0.5854401588439941, 1.1664913892745972, 2.235198974609375, 1.4389557838439941, 0.46469974517822266, 0.39367008209228516, 1.277198314666748, 0.8112144470214844, 0.4417538642883301, 1.0055298805236816, 0.9457550048828125, 2.086530923843384, 0.260483980178833, 1.200857162475586, 0.14865374565124512, 1.100374460220337, 0.21428430080413818, 0.9638817310333252, 0.28743481636047363, 0.720666766166687, 1.8398551940917969, 1.323282241821289, 0.8903675079345703, 1.1194825172424316, 2.113827705383301, 1.8321261405944824, 2.0747997760772705, 0.7965338230133057, 0.3962361812591553, 0.640038013458252, 0.6769297122955322, 0.7919588088989258, 0.6582183837890625, 0.4811830520629883, 0.17247843742370605, 0.9032917022705078, 0.5585873126983643, 1.248384952545166, 1.393316626548767, 0.628631591796875, 0.41585826873779297, 0.11303293704986572, 0.6659548282623291, 1.0234477519989014], "mean_td_error": 0.9238502383232117, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 57.0, "diff_num_grad_updates_vs_sampler_policy": 56.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.104743957519531, "actor_loss": -8.238749504089355, "critic_loss": 0.12772245705127716, "alpha_loss": -0.16977863013744354, "alpha_value": 0.983338475227356, "log_alpha_value": -0.016801873221993446, "target_entropy": -6.0, "policy_t": -0.032597023993730545, "mean_q": 4.222187042236328, "max_q": 4.998454570770264, "min_q": 3.5110323429107666}, "td_error": [1.1161770820617676, 0.7885510921478271, 1.0442581176757812, 1.2509918212890625, 0.5022215843200684, 1.7047672271728516, 0.14907574653625488, 0.4516134262084961, 0.3871709108352661, 0.3112208843231201, 0.5679804086685181, 0.041776180267333984, 0.3786156177520752, 0.986823320388794, 0.8474154472351074, 1.8710708618164062, 0.9819834232330322, 0.9635055065155029, 1.0669529438018799, 0.9429552555084229, 0.3652840852737427, 1.4173493385314941, 0.5631861686706543, 1.1531243324279785, 1.022409439086914, 0.4160315990447998, 0.705888032913208, 0.5828403234481812, 0.39565443992614746, 0.4945390224456787, 1.1746981143951416, 0.5428284406661987, 0.02434253692626953, 0.41097283363342285, 0.8038439750671387, 0.3144218921661377, 0.525294303894043, 1.0461235046386719, 0.39257311820983887, 0.03718161582946777, 0.11394023895263672, 0.31322193145751953, 0.6277557611465454, 0.07849788665771484, 1.3636078834533691, 0.2050321102142334, 1.2754602432250977, 0.46091389656066895, 1.3037054538726807, 0.31065893173217773, 0.48881983757019043, 2.7044148445129395, 1.6889984607696533, 1.5162327289581299, 0.5787721872329712, 0.25513172149658203, 1.8392503261566162, 2.033897876739502, 0.2786073684692383, 0.7887790203094482, 0.5927395820617676, 0.637036919593811, 0.22760558128356934, 1.3227508068084717, 2.482553243637085, 0.061429500579833984, 0.1718587875366211, 0.20968222618103027, 1.0452156066894531, 3.447103977203369, 0.6955342292785645, 1.5345301628112793, 0.7289402484893799, 0.5225018262863159, 0.6952548027038574, 0.30782151222229004, 0.5310807228088379, 0.566748857498169, 1.3594872951507568, 1.4703989028930664, 0.024988174438476562, 1.6121788024902344, 1.4267692565917969, 0.4035060405731201, 1.5507595539093018, 1.2863898277282715], "mean_td_error": 0.8358637094497681, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 57.0, "diff_num_grad_updates_vs_sampler_policy": 56.0}}, "num_env_steps_sampled": 51968, "num_env_steps_trained": 14706, "num_agent_steps_sampled": 155904, "num_agent_steps_trained": 14706, "last_target_update_ts": 51968, "num_target_updates": 57}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 155904, "num_agent_steps_trained": 14706, "num_env_steps_sampled": 51968, "num_env_steps_trained": 14706, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 446.3996656958495, "num_env_steps_trained_throughput_per_sec": 128.53918945259952, "timesteps_total": 51968, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 155904, "timers": {"training_iteration_time_ms": 1756.032, "sample_time_ms": 1154.346, "load_time_ms": 0.538, "load_throughput": 479179.22, "learn_time_ms": 61.635, "learn_throughput": 4185.9, "synch_weights_time_ms": 15.144}, "counters": {"num_env_steps_sampled": 51968, "num_env_steps_trained": 14706, "num_agent_steps_sampled": 155904, "num_agent_steps_trained": 14706, "last_target_update_ts": 51968, "num_target_updates": 57}, "done": false, "episodes_total": 0, "training_iteration": 58, "trial_id": "9a806_00000", "date": "2023-11-16_21-55-24", "timestamp": 1700200524, "time_this_iter_s": 2.0215938091278076, "time_total_s": 104.72414994239807, "pid": 45784, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fadd0533820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 104.72414994239807, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 70.76666666666667, "ram_util_percent": 90.56666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.07044792175293, "actor_loss": -9.976175308227539, "critic_loss": 0.3204203248023987, "alpha_loss": -0.1722131073474884, "alpha_value": 0.9830445647239685, "log_alpha_value": -0.01710083894431591, "target_entropy": -6.0, "policy_t": 0.03009650856256485, "mean_q": 6.397211074829102, "max_q": 7.536823749542236, "min_q": 5.50438117980957}, "td_error": [0.5665907859802246, 2.0340468883514404, 0.9850926399230957, 1.704824447631836, 1.2366421222686768, 0.12423825263977051, 0.8317084312438965, 1.394078016281128, 0.19233298301696777, 1.4250702857971191, 0.05242586135864258, 0.5972065925598145, 0.29558444023132324, 1.2843692302703857, 0.8256309032440186, 2.4920241832733154, 0.2955286502838135, 0.7698211669921875, 0.7166383266448975, 2.8410680294036865, 0.42207956314086914, 1.1652052402496338, 0.15768074989318848, 1.1108601093292236, 0.8545725345611572, 0.17804861068725586, 0.32251477241516113, 0.3089730739593506, 0.6597983837127686, 0.6626310348510742, 1.4006648063659668, 1.7921967506408691, 2.09450364112854, 1.4558205604553223, 0.5723512172698975, 0.2149813175201416, 1.482792615890503, 0.8625783920288086, 0.30330586433410645, 1.8221004009246826, 0.4617133140563965, 2.5148863792419434, 0.8105618953704834, 0.22606563568115234, 0.6678643226623535, 0.3491058349609375, 0.8321361541748047, 0.4299163818359375, 0.5710296630859375, 0.2054424285888672, 1.6324787139892578, 2.654846668243408, 1.0904765129089355, 0.5125868320465088, 0.4407665729522705, 0.8742916584014893, 2.4768006801605225, 3.61427640914917, 0.9349853992462158, 0.7020125389099121, 0.3749582767486572, 0.4764976501464844, 0.33162593841552734, 0.1183784008026123, 0.2386486530303955, 1.203073263168335, 2.128586530685425, 1.5761146545410156, 1.1228125095367432, 2.4973902702331543, 0.30672311782836914, 1.2089030742645264, 0.10074591636657715, 0.3660924434661865, 1.1854043006896973, 1.0360705852508545, 0.8862767219543457, 0.20097041130065918, 2.248385429382324, 1.4910204410552979, 0.1613450050354004, 1.1276485919952393, 0.4351074695587158, 0.4930002689361572, 1.0802001953125, 0.31638383865356445], "mean_td_error": 0.9677115082740784, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 58.0, "diff_num_grad_updates_vs_sampler_policy": 57.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.147759437561035, "actor_loss": -8.240373611450195, "critic_loss": 0.19294050335884094, "alpha_loss": -0.1735728234052658, "alpha_value": 0.9830409288406372, "log_alpha_value": -0.01710454933345318, "target_entropy": -6.0, "policy_t": 0.005140330642461777, "mean_q": 4.340872764587402, "max_q": 5.207311153411865, "min_q": 3.5982882976531982}, "td_error": [1.0101984739303589, 0.3970170021057129, 0.7762086391448975, 0.19606471061706543, 1.1470636129379272, 1.5721397399902344, 2.177457094192505, 1.524857997894287, 1.1734333038330078, 0.46215295791625977, 0.4448695182800293, 0.9353315830230713, 0.8326830863952637, 0.5559093952178955, 0.568382740020752, 0.5852648019790649, 0.8085482120513916, 2.02071475982666, 0.18064212799072266, 1.2196184396743774, 1.234133005142212, 1.2627372741699219, 1.306403398513794, 0.4288785457611084, 2.424394130706787, 1.115567922592163, 1.273620367050171, 2.1009411811828613, 1.3693276643753052, 0.17135119438171387, 0.9074592590332031, 0.5866715908050537, 0.42729902267456055, 1.1631238460540771, 0.1911909580230713, 0.46979308128356934, 0.32826030254364014, 1.0997118949890137, 0.305713415145874, 0.8986101150512695, 0.04143691062927246, 0.1812676191329956, 0.8791828155517578, 0.3696244955062866, 0.5224249362945557, 0.9834156036376953, 0.19241642951965332, 1.1968600749969482, 1.0942058563232422, 0.3972141742706299, 1.5970163345336914, 0.805525541305542, 0.2413930892944336, 1.8872416019439697, 0.5969393253326416, 1.9643738269805908, 1.7698686122894287, 0.6140494346618652, 0.25519227981567383, 0.36481285095214844, 1.0726513862609863, 2.2036385536193848, 0.07754850387573242, 0.9756454229354858, 0.886603832244873, 1.5320923328399658, 0.9560182094573975, 0.45928311347961426, 0.730858564376831, 0.3548160791397095, 2.950538396835327, 0.3189966678619385, 1.0732743740081787, 2.9094109535217285, 0.7696008682250977, 1.6280317306518555, 0.8543424606323242, 0.21663165092468262, 0.6330313682556152, 0.971172571182251, 0.41202640533447266, 0.26482462882995605, 0.28322839736938477, 2.3834097385406494, 1.0274133682250977, 0.6813936233520508], "mean_td_error": 0.9329614639282227, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 58.0, "diff_num_grad_updates_vs_sampler_policy": 57.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.032669067382812, "actor_loss": -8.208853721618652, "critic_loss": 0.17226898670196533, "alpha_loss": -0.17157283425331116, "alpha_value": 0.9830439686775208, "log_alpha_value": -0.017101414501667023, "target_entropy": -6.0, "policy_t": -0.008730505593121052, "mean_q": 4.32326078414917, "max_q": 5.176959991455078, "min_q": 3.735933780670166}, "td_error": [1.4314601421356201, 0.3267822265625, 0.5172624588012695, 1.7868685722351074, 0.6047862768173218, 2.3050084114074707, 1.163865327835083, 1.0645203590393066, 0.4658348560333252, 1.9783337116241455, 0.757713794708252, 2.859466075897217, 0.5026044845581055, 0.6380685567855835, 0.4756789207458496, 0.45698070526123047, 0.3351478576660156, 0.8131577968597412, 2.2000033855438232, 0.21756649017333984, 1.2489078044891357, 2.6457109451293945, 1.7288823127746582, 0.24431085586547852, 0.6385791301727295, 1.0547535419464111, 0.26633691787719727, 0.8737099170684814, 0.17634892463684082, 2.017514228820801, 0.10866427421569824, 0.17389774322509766, 1.2898800373077393, 0.3810439109802246, 1.0909173488616943, 0.3171745538711548, 1.468242883682251, 1.2403006553649902, 1.5250623226165771, 1.304165005683899, 0.7612481117248535, 1.7595648765563965, 0.20317363739013672, 0.8569445610046387, 0.6420435905456543, 1.5928926467895508, 2.4541242122650146, 1.0812296867370605, 0.40683889389038086, 1.3851211071014404, 1.4321479797363281, 0.06261372566223145, 1.0737488269805908, 0.7573813199996948, 1.161501169204712, 0.6952834129333496, 0.7598868608474731, 1.286895513534546, 0.7861409187316895, 1.0688567161560059, 0.09238219261169434, 1.0704104900360107, 0.8678388595581055, 1.6674680709838867, 0.4350314140319824, 1.4831435680389404, 1.234814167022705, 0.09612107276916504, 2.3832201957702637, 1.436189889907837, 2.087998867034912, 1.291093111038208, 1.5390431880950928, 1.1334424018859863, 0.9614076614379883, 0.26251840591430664, 0.557142972946167, 0.8004271984100342, 0.4241788387298584, 1.4062354564666748, 2.2526960372924805, 0.7258541584014893, 1.2776861190795898, 0.7634110450744629, 1.346174955368042, 0.27414917945861816], "mean_td_error": 1.0324795246124268, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 58.0, "diff_num_grad_updates_vs_sampler_policy": 57.0}}, "num_env_steps_sampled": 52864, "num_env_steps_trained": 14964, "num_agent_steps_sampled": 158592, "num_agent_steps_trained": 14964, "last_target_update_ts": 52864, "num_target_updates": 58}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 158592, "num_agent_steps_trained": 14964, "num_env_steps_sampled": 52864, "num_env_steps_trained": 14964, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 480.1828563017464, "num_env_steps_trained_throughput_per_sec": 138.26693853331537, "timesteps_total": 52864, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 158592, "timers": {"training_iteration_time_ms": 1777.076, "sample_time_ms": 1170.952, "load_time_ms": 0.55, "load_throughput": 468718.513, "learn_time_ms": 62.123, "learn_throughput": 4153.06, "synch_weights_time_ms": 15.575}, "counters": {"num_env_steps_sampled": 52864, "num_env_steps_trained": 14964, "num_agent_steps_sampled": 158592, "num_agent_steps_trained": 14964, "last_target_update_ts": 52864, "num_target_updates": 58}, "done": false, "episodes_total": 0, "training_iteration": 59, "trial_id": "9a806_00000", "date": "2023-11-16_21-55-25", "timestamp": 1700200525, "time_this_iter_s": 1.8863506317138672, "time_total_s": 106.61050057411194, "pid": 45784, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fadd04c93a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 106.61050057411194, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 82.55, "ram_util_percent": 90.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.096940994262695, "actor_loss": -10.122880935668945, "critic_loss": 0.3773564100265503, "alpha_loss": -0.17569002509117126, "alpha_value": 0.9827501773834229, "log_alpha_value": -0.01740032248198986, "target_entropy": -6.0, "policy_t": -0.020841054618358612, "mean_q": 6.423540115356445, "max_q": 7.519962310791016, "min_q": 5.601386070251465}, "td_error": [2.6421260833740234, 0.05873370170593262, 0.9799168109893799, 0.27748751640319824, 0.8974308967590332, 1.32012939453125, 1.2406535148620605, 0.41210150718688965, 1.4154653549194336, 0.43749475479125977, 1.7296342849731445, 1.6803972721099854, 1.047581434249878, 0.9323327541351318, 3.1282851696014404, 1.1514551639556885, 1.4571444988250732, 0.8182692527770996, 1.6061666011810303, 2.5426530838012695, 0.26532483100891113, 2.0232276916503906, 1.8309454917907715, 1.3615405559539795, 0.6167972087860107, 0.3949112892150879, 0.252399206161499, 1.0979020595550537, 2.163332462310791, 2.605217695236206, 1.0258331298828125, 1.239074468612671, 0.6488075256347656, 0.33385729789733887, 0.865328311920166, 1.6279056072235107, 1.6396353244781494, 0.4368908405303955, 1.2468678951263428, 0.7760567665100098, 0.8419759273529053, 0.22884702682495117, 1.8381807804107666, 2.976414442062378, 1.3281381130218506, 0.42361950874328613, 1.8928227424621582, 0.08176040649414062, 1.5264534950256348, 0.24435973167419434, 0.09462308883666992, 1.1978912353515625, 0.6561717987060547, 0.45963358879089355, 0.35153746604919434, 1.083503246307373, 2.7241904735565186, 1.1671185493469238, 0.2642672061920166, 0.6285998821258545, 2.0574357509613037, 1.482102632522583, 2.9650938510894775, 0.6527855396270752, 2.498878240585327, 1.814018726348877, 1.9639790058135986, 0.15033388137817383, 1.0287628173828125, 2.596984624862671, 1.9164683818817139, 1.6058595180511475, 0.1017911434173584, 0.7040419578552246, 1.0441997051239014, 1.2844479084014893, 1.4886386394500732, 0.5243353843688965, 0.5834817886352539, 0.36766552925109863, 0.7404813766479492, 1.797541618347168, 0.43506503105163574, 2.9083216190338135, 0.5279340744018555, 0.96923828125], "mean_td_error": 1.191247820854187, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 59.0, "diff_num_grad_updates_vs_sampler_policy": 58.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.028678894042969, "actor_loss": -8.176621437072754, "critic_loss": 0.20307967066764832, "alpha_loss": -0.1745438277721405, "alpha_value": 0.9827461242675781, "log_alpha_value": -0.01740446873009205, "target_entropy": -6.0, "policy_t": 0.0017020064406096935, "mean_q": 4.287284851074219, "max_q": 4.954725742340088, "min_q": 3.5516486167907715}, "td_error": [2.0788462162017822, 0.39287424087524414, 1.9715068340301514, 1.9096059799194336, 0.1832730770111084, 0.7691638469696045, 0.34799861907958984, 0.2080777883529663, 1.0083093643188477, 1.624115228652954, 0.39679670333862305, 0.36687755584716797, 0.9247188568115234, 2.250852346420288, 1.0838919878005981, 0.16011929512023926, 1.1888067722320557, 0.5179624557495117, 2.0430710315704346, 0.5502758026123047, 0.2088167667388916, 0.8910279273986816, 0.06421351432800293, 1.0249745845794678, 1.577911138534546, 0.7391574382781982, 0.7063283920288086, 0.582646369934082, 0.9088819026947021, 1.8321280479431152, 1.4432809352874756, 1.2868809700012207, 2.1135427951812744, 2.0929980278015137, 1.0331313610076904, 0.3783724308013916, 0.0671546459197998, 0.8778054714202881, 0.20421981811523438, 0.1185445785522461, 0.2738356590270996, 0.3360583782196045, 0.5394604206085205, 1.250793695449829, 0.9951705932617188, 0.6352376937866211, 1.5319278240203857, 0.8683345317840576, 0.5919129848480225, 1.677884578704834, 0.9819226264953613, 0.24869251251220703, 0.3420743942260742, 0.5181236267089844, 1.2612078189849854, 1.592583417892456, 0.988602876663208, 0.631096363067627, 0.5597362518310547, 0.16132259368896484, 2.5647799968719482, 2.347243309020996, 0.8468427658081055, 1.6187796592712402, 1.7752046585083008, 0.8886377811431885, 0.6942455768585205, 1.0460078716278076, 0.02948784828186035, 2.3300981521606445, 0.6772570610046387, 0.6186797618865967, 0.1054239273071289, 0.8016469478607178, 0.6785852909088135, 0.3865225315093994, 2.0515143871307373, 0.1655426025390625, 0.8169834613800049, 0.4998362064361572, 1.6604584455490112, 1.8788509368896484, 0.1806117296218872, 1.9508509635925293, 0.10088324546813965, 1.3746020793914795], "mean_td_error": 0.9558688402175903, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 59.0, "diff_num_grad_updates_vs_sampler_policy": 58.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.104645729064941, "actor_loss": -8.253661155700684, "critic_loss": 0.1431078165769577, "alpha_loss": -0.17582954466342926, "alpha_value": 0.9827496409416199, "log_alpha_value": -0.017400862649083138, "target_entropy": -6.0, "policy_t": 0.0023901332169771194, "mean_q": 4.300888538360596, "max_q": 5.0527777671813965, "min_q": 3.6749706268310547}, "td_error": [0.22019684314727783, 0.9764358997344971, 0.5543453693389893, 0.17963385581970215, 0.1099388599395752, 0.8452041149139404, 0.9421360492706299, 0.799879789352417, 0.5307848453521729, 2.148103713989258, 1.0871610641479492, 0.21604156494140625, 2.5524144172668457, 0.10580158233642578, 0.6076894998550415, 0.7620038986206055, 1.357405662536621, 0.6681559085845947, 1.2776098251342773, 0.18825697898864746, 0.05893981456756592, 0.39702367782592773, 0.906804084777832, 2.0469281673431396, 1.6363914012908936, 1.8841756582260132, 0.8112978935241699, 0.8608279228210449, 0.13300633430480957, 0.39968395233154297, 0.7501410245895386, 0.690258264541626, 0.33400392532348633, 0.6127071380615234, 1.5048754215240479, 2.153003692626953, 0.8033642768859863, 0.6602902412414551, 0.26283836364746094, 0.39719367027282715, 0.21539759635925293, 0.05601608753204346, 1.361339807510376, 0.956857442855835, 0.14264976978302002, 0.29737579822540283, 0.41764354705810547, 2.242809295654297, 0.3424336910247803, 0.33801770210266113, 0.688563346862793, 0.5956830978393555, 0.7347259521484375, 0.19065093994140625, 0.15751266479492188, 0.6890163421630859, 0.9121171236038208, 0.8008122444152832, 0.44379591941833496, 2.082927942276001, 0.36250829696655273, 0.24476194381713867, 2.5044443607330322, 1.2298142910003662, 0.9242808818817139, 0.17090129852294922, 0.547661304473877, 0.9236283302307129, 2.2686681747436523, 1.4451831579208374, 0.21794819831848145, 0.18250179290771484, 0.9145328998565674, 2.8840255737304688, 0.19424986839294434, 1.420654535293579, 1.395247220993042, 1.6207001209259033, 0.27280473709106445, 0.9897637367248535, 0.2733726501464844, 2.687100648880005, 0.5952352285385132, 2.5837411880493164, 1.526787519454956, 1.276231288909912], "mean_td_error": 0.8925121426582336, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 59.0, "diff_num_grad_updates_vs_sampler_policy": 58.0}}, "num_env_steps_sampled": 53760, "num_env_steps_trained": 15222, "num_agent_steps_sampled": 161280, "num_agent_steps_trained": 15222, "last_target_update_ts": 53760, "num_target_updates": 59}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 161280, "num_agent_steps_trained": 15222, "num_env_steps_sampled": 53760, "num_env_steps_trained": 15222, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 411.9354279825887, "num_env_steps_trained_throughput_per_sec": 118.61533528962933, "timesteps_total": 53760, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 161280, "timers": {"training_iteration_time_ms": 1816.995, "sample_time_ms": 1209.881, "load_time_ms": 0.551, "load_throughput": 467887.596, "learn_time_ms": 62.122, "learn_throughput": 4153.141, "synch_weights_time_ms": 15.62}, "counters": {"num_env_steps_sampled": 53760, "num_env_steps_trained": 15222, "num_agent_steps_sampled": 161280, "num_agent_steps_trained": 15222, "last_target_update_ts": 53760, "num_target_updates": 59}, "done": false, "episodes_total": 0, "training_iteration": 60, "trial_id": "9a806_00000", "date": "2023-11-16_21-55-28", "timestamp": 1700200528, "time_this_iter_s": 2.1918790340423584, "time_total_s": 108.8023796081543, "pid": 45784, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fadd0517ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 108.8023796081543, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 63.175, "ram_util_percent": 90.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.058971405029297, "actor_loss": -10.212573051452637, "critic_loss": 0.36914387345314026, "alpha_loss": -0.17804276943206787, "alpha_value": 0.982455849647522, "log_alpha_value": -0.017699897289276123, "target_entropy": -6.0, "policy_t": -0.0007756738341413438, "mean_q": 6.4873552322387695, "max_q": 7.273825645446777, "min_q": 5.443933010101318}, "td_error": [0.41196274757385254, 3.1691806316375732, 0.8749613761901855, 0.7197339534759521, 0.7848718166351318, 0.20052146911621094, 2.5346477031707764, 2.335374355316162, 1.5140655040740967, 0.29909706115722656, 0.35880303382873535, 1.5996530055999756, 1.6732752323150635, 0.2742011547088623, 1.8193230628967285, 0.9452488422393799, 0.9037008285522461, 3.5394444465637207, 0.9594953060150146, 1.635244369506836, 0.7982804775238037, 1.5413625240325928, 2.784743070602417, 0.6494839191436768, 0.9124011993408203, 2.142000436782837, 1.8791186809539795, 0.202803373336792, 0.258697509765625, 0.667414665222168, 1.4562320709228516, 0.5651061534881592, 0.8504002094268799, 0.33601903915405273, 1.380316972732544, 0.5947816371917725, 1.7071325778961182, 2.3175134658813477, 0.5862157344818115, 0.22096872329711914, 0.4941599369049072, 0.2723395824432373, 1.8625752925872803, 0.8690366744995117, 0.38582730293273926, 1.8982481956481934, 0.618582010269165, 1.3082740306854248, 2.2937023639678955, 0.7272531986236572, 1.4251511096954346, 1.8568408489227295, 0.11746835708618164, 0.12556910514831543, 0.29708409309387207, 0.04419970512390137, 2.798304796218872, 0.6809742450714111, 1.5122010707855225, 0.14363646507263184, 0.8141660690307617, 0.6209397315979004, 0.5273904800415039, 0.3634641170501709, 0.5907394886016846, 0.9163434505462646, 1.3695213794708252, 1.6645100116729736, 0.49631667137145996, 0.380230188369751, 1.7233288288116455, 0.6653575897216797, 2.486762046813965, 2.5080080032348633, 0.4055922031402588, 2.451697826385498, 2.4409303665161133, 1.602867841720581, 0.8855600357055664, 3.019099712371826, 0.3335733413696289, 0.14819693565368652, 1.2185380458831787, 2.4377429485321045, 0.9857094287872314, 2.76776123046875], "mean_td_error": 1.1855764389038086, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 60.0, "diff_num_grad_updates_vs_sampler_policy": 59.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.128434181213379, "actor_loss": -8.155182838439941, "critic_loss": 0.1576502025127411, "alpha_loss": -0.1793164312839508, "alpha_value": 0.9824515581130981, "log_alpha_value": -0.017704259604215622, "target_entropy": -6.0, "policy_t": -0.003961223177611828, "mean_q": 4.2565765380859375, "max_q": 5.120509147644043, "min_q": 3.5712904930114746}, "td_error": [1.4102370738983154, 0.8118381500244141, 0.4182460308074951, 0.414825439453125, 1.7721576690673828, 2.2252683639526367, 0.5170667171478271, 0.4501415491104126, 0.10892534255981445, 0.33229708671569824, 0.4600801467895508, 0.473114013671875, 0.6080214977264404, 0.21653437614440918, 0.24345552921295166, 0.34986042976379395, 1.4360361099243164, 0.27109456062316895, 2.2693822383880615, 0.23238205909729004, 2.7606475353240967, 1.9044010639190674, 0.5855987071990967, 0.17639470100402832, 0.341127872467041, 2.0691123008728027, 0.44668102264404297, 0.6067752838134766, 0.17213964462280273, 1.2975239753723145, 0.602135419845581, 0.22228491306304932, 0.872488260269165, 0.986480712890625, 0.9838602542877197, 1.5090664625167847, 1.1506261825561523, 0.16217029094696045, 0.5219395160675049, 1.0748310089111328, 1.0986206531524658, 1.5541679859161377, 0.6068532466888428, 0.29310178756713867, 1.0692229270935059, 1.16072678565979, 0.6170198917388916, 1.7237942218780518, 0.8402326107025146, 0.8702242374420166, 0.22677814960479736, 1.1073048114776611, 0.9214131832122803, 0.7487998008728027, 0.31308841705322266, 0.5004554986953735, 1.1297903060913086, 2.7746710777282715, 0.5904713869094849, 0.8405768871307373, 0.03548169136047363, 0.7223081588745117, 0.5878241062164307, 0.5722246170043945, 0.3244469165802002, 0.5476169586181641, 0.1966686248779297, 0.08588588237762451, 0.6566013097763062, 0.18465375900268555, 1.2576267719268799, 0.31479835510253906, 0.5207645893096924, 1.4087913036346436, 0.38167762756347656, 0.38640308380126953, 1.4782967567443848, 2.0328292846679688, 0.28302931785583496, 0.31371212005615234, 0.44330501556396484, 1.2613937854766846, 0.6959025859832764, 0.6740214824676514, 1.0090465545654297, 1.1659703254699707], "mean_td_error": 0.8139051198959351, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 60.0, "diff_num_grad_updates_vs_sampler_policy": 59.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.134392738342285, "actor_loss": -8.3058443069458, "critic_loss": 0.17559324204921722, "alpha_loss": -0.17938287556171417, "alpha_value": 0.982455313205719, "log_alpha_value": -0.017700407654047012, "target_entropy": -6.0, "policy_t": -0.03365952521562576, "mean_q": 4.340921401977539, "max_q": 5.20462703704834, "min_q": 3.7785866260528564}, "td_error": [1.4902896881103516, 0.45931053161621094, 0.11349833011627197, 0.757666826248169, 1.9596641063690186, 1.2871971130371094, 2.1826999187469482, 0.806992769241333, 0.6136946678161621, 0.539198637008667, 0.9085341691970825, 0.22356784343719482, 1.3773343563079834, 0.47037649154663086, 1.4074301719665527, 1.5444309711456299, 0.7648932933807373, 0.4491119384765625, 0.26883065700531006, 0.35708189010620117, 1.534649133682251, 1.7127010822296143, 0.4855992794036865, 0.9027934074401855, 0.49338340759277344, 0.3261704444885254, 0.5229215621948242, 1.0844411849975586, 0.03546714782714844, 0.7281185388565063, 1.645996332168579, 1.346199870109558, 1.6643047332763672, 0.977280855178833, 0.8757388591766357, 0.7604674100875854, 1.9351310729980469, 1.8046348094940186, 1.048124074935913, 0.3533291816711426, 1.7706823348999023, 1.35597562789917, 1.0496139526367188, 0.5169296264648438, 1.7118704319000244, 0.12538599967956543, 2.0517327785491943, 1.5313055515289307, 0.535362720489502, 2.358058214187622, 3.7717063426971436, 1.4347865581512451, 2.0393431186676025, 0.5109157562255859, 1.3789699077606201, 0.9850001335144043, 0.48728370666503906, 0.29618000984191895, 1.4484443664550781, 0.16390323638916016, 0.1674802303314209, 1.9183955192565918, 1.519014596939087, 2.9293487071990967, 0.48551201820373535, 0.4298880100250244, 1.7188143730163574, 1.813359022140503, 1.2268004417419434, 0.8690407276153564, 0.8782470226287842, 3.16326904296875, 0.6623616218566895, 0.04867517948150635, 0.5329318046569824, 0.09360766410827637, 1.0367751121520996, 1.8854832649230957, 0.24124765396118164, 0.06579995155334473, 0.44961845874786377, 0.5786793231964111, 0.575995683670044, 0.0827476978302002, 0.4951901435852051, 0.6739648580551147], "mean_td_error": 1.0265692472457886, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 60.0, "diff_num_grad_updates_vs_sampler_policy": 59.0}}, "num_env_steps_sampled": 54656, "num_env_steps_trained": 15480, "num_agent_steps_sampled": 163968, "num_agent_steps_trained": 15480, "last_target_update_ts": 54656, "num_target_updates": 60}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 163968, "num_agent_steps_trained": 15480, "num_env_steps_sampled": 54656, "num_env_steps_trained": 15480, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 454.68244778393966, "num_env_steps_trained_throughput_per_sec": 130.9241869735005, "timesteps_total": 54656, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 163968, "timers": {"training_iteration_time_ms": 1816.558, "sample_time_ms": 1241.62, "load_time_ms": 0.551, "load_throughput": 468556.152, "learn_time_ms": 62.296, "learn_throughput": 4141.514, "synch_weights_time_ms": 15.655}, "counters": {"num_env_steps_sampled": 54656, "num_env_steps_trained": 15480, "num_agent_steps_sampled": 163968, "num_agent_steps_trained": 15480, "last_target_update_ts": 54656, "num_target_updates": 60}, "done": false, "episodes_total": 0, "training_iteration": 61, "trial_id": "9a806_00000", "date": "2023-11-16_21-55-30", "timestamp": 1700200530, "time_this_iter_s": 1.9885637760162354, "time_total_s": 110.79094338417053, "pid": 45784, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fadd0517af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 110.79094338417053, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 63.133333333333326, "ram_util_percent": 90.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.041433334350586, "actor_loss": -10.301140785217285, "critic_loss": 0.25623878836631775, "alpha_loss": -0.1807403713464737, "alpha_value": 0.9821615815162659, "log_alpha_value": -0.01799946092069149, "target_entropy": -6.0, "policy_t": -0.013336562551558018, "mean_q": 6.399526119232178, "max_q": 7.517435550689697, "min_q": 5.692625999450684}, "td_error": [1.9632518291473389, 0.2657129764556885, 1.5269665718078613, 1.520298957824707, 1.2585384845733643, 0.8611981868743896, 1.2729949951171875, 1.326242446899414, 1.8009989261627197, 0.3192737102508545, 0.7977554798126221, 1.5432956218719482, 0.2220911979675293, 0.07806539535522461, 0.7943286895751953, 0.7573564052581787, 0.5435900688171387, 0.831017255783081, 0.6991884708404541, 2.636867046356201, 1.8365540504455566, 1.046346664428711, 0.7279953956604004, 1.2084858417510986, 1.1985118389129639, 0.5810306072235107, 0.5749781131744385, 0.45054030418395996, 1.1122028827667236, 0.07429027557373047, 0.25516390800476074, 0.32177019119262695, 0.13577580451965332, 0.4758493900299072, 0.4376814365386963, 0.4352731704711914, 1.5887928009033203, 0.08013486862182617, 0.19858860969543457, 0.7820913791656494, 0.3414440155029297, 0.3656027317047119, 0.44591832160949707, 0.8684699535369873, 0.37222743034362793, 3.0618464946746826, 0.4164140224456787, 1.704094409942627, 1.0138611793518066, 1.0708234310150146, 0.8350119590759277, 1.1096253395080566, 0.43991994857788086, 1.3362758159637451, 0.19941258430480957, 2.7430293560028076, 0.2610595226287842, 0.909700870513916, 0.29746127128601074, 1.231621503829956, 0.7324404716491699, 1.3540871143341064, 1.1899244785308838, 3.108842134475708, 2.7089664936065674, 1.0585792064666748, 0.6722850799560547, 0.528458833694458, 2.376513957977295, 0.5445351600646973, 0.8572432994842529, 1.8532180786132812, 0.7984766960144043, 0.19192957878112793, 0.23142409324645996, 0.4426460266113281, 0.563502311706543, 1.2616267204284668, 2.51926851272583, 0.45859837532043457, 1.340667963027954, 0.11226320266723633, 1.4847815036773682, 0.9389255046844482, 0.24979925155639648, 1.2141668796539307], "mean_td_error": 0.9576520919799805, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 61.0, "diff_num_grad_updates_vs_sampler_policy": 60.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.087464332580566, "actor_loss": -8.068873405456543, "critic_loss": 0.2195727825164795, "alpha_loss": -0.18161654472351074, "alpha_value": 0.9821569323539734, "log_alpha_value": -0.01800418458878994, "target_entropy": -6.0, "policy_t": 0.00370467035099864, "mean_q": 4.233813285827637, "max_q": 4.821843147277832, "min_q": 3.5792109966278076}, "td_error": [0.533151388168335, 0.12452864646911621, 2.9141814708709717, 1.7889678478240967, 0.32986176013946533, 1.117966651916504, 2.2195842266082764, 2.6074631214141846, 0.07473254203796387, 1.0663118362426758, 2.1667933464050293, 0.1939408779144287, 0.6678715944290161, 2.9994454383850098, 0.750287652015686, 0.865248441696167, 1.5983376502990723, 0.12841200828552246, 0.9944393634796143, 0.7279539108276367, 0.6941323280334473, 2.481189250946045, 0.8058116436004639, 0.4081918001174927, 0.664031982421875, 2.6330225467681885, 0.7880120277404785, 0.16653740406036377, 0.9550745487213135, 1.0134587287902832, 0.6777081489562988, 2.9708995819091797, 0.9308629035949707, 0.6301548480987549, 0.7489181756973267, 1.7688822746276855, 0.6282849311828613, 0.06733465194702148, 0.03370702266693115, 1.4682376384735107, 1.233054757118225, 0.5371596813201904, 0.43628811836242676, 0.3597162961959839, 0.1458141803741455, 1.1466116905212402, 0.12011170387268066, 0.9378771781921387, 2.0950984954833984, 1.7246079444885254, 0.6547110080718994, 1.0398281812667847, 0.9087163209915161, 1.235865592956543, 0.2305920124053955, 1.343688726425171, 1.623504638671875, 2.169142961502075, 0.2752763032913208, 1.3788580894470215, 0.19615697860717773, 1.336531162261963, 1.1203339099884033, 0.06924557685852051, 1.3082067966461182, 1.0469735860824585, 1.5158970355987549, 0.4648139476776123, 0.4276425838470459, 0.10771059989929199, 0.4448220729827881, 0.2706310749053955, 0.5301961898803711, 1.149861454963684, 2.3207669258117676, 0.429995059967041, 1.5395535230636597, 1.091993808746338, 1.5443637371063232, 1.0401363372802734, 0.24949240684509277, 0.6945111751556396, 1.607334852218628, 0.7877063751220703, 1.0243096351623535, 0.6361939907073975], "mean_td_error": 1.0111143589019775, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 61.0, "diff_num_grad_updates_vs_sampler_policy": 60.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.116276741027832, "actor_loss": -8.286372184753418, "critic_loss": 0.16232670843601227, "alpha_loss": -0.18209412693977356, "alpha_value": 0.9821609258651733, "log_alpha_value": -0.01800011284649372, "target_entropy": -6.0, "policy_t": 0.02034842222929001, "mean_q": 4.262434005737305, "max_q": 5.201176166534424, "min_q": 3.5573527812957764}, "td_error": [1.3048583269119263, 0.584994912147522, 1.2307496070861816, 1.327073335647583, 2.0712246894836426, 0.8937714099884033, 1.3825757503509521, 0.19452953338623047, 1.923002004623413, 0.9510376453399658, 0.5350136756896973, 1.1927545070648193, 0.6194154024124146, 0.050513505935668945, 1.7230470180511475, 0.12788176536560059, 0.09481406211853027, 0.17224431037902832, 0.11894822120666504, 1.4965872764587402, 0.3492467403411865, 1.5812971591949463, 0.9025139808654785, 1.388352632522583, 0.7211861610412598, 0.524240255355835, 1.1675283908843994, 0.3686351776123047, 2.017639636993408, 0.2042701244354248, 1.882556438446045, 0.39487433433532715, 0.04382729530334473, 0.8872777223587036, 0.17391014099121094, 2.5678539276123047, 1.9018423557281494, 0.2020411491394043, 0.27332091331481934, 1.754910945892334, 0.6156980991363525, 1.6807620525360107, 0.82506263256073, 1.626615285873413, 1.1074483394622803, 0.23854660987854004, 2.2154641151428223, 0.6965179443359375, 0.9651213884353638, 1.612036943435669, 1.678107500076294, 0.5592916011810303, 1.169217586517334, 0.18883419036865234, 1.7627432346343994, 0.8509418964385986, 0.45572710037231445, 0.7664244174957275, 1.1787173748016357, 0.21300101280212402, 2.0977401733398438, 0.7536182403564453, 0.8552772998809814, 0.7037080526351929, 1.0759763717651367, 0.22211790084838867, 1.7917718887329102, 2.635073661804199, 1.1380398273468018, 0.264035701751709, 0.8915407657623291, 0.582034707069397, 0.5660252571105957, 0.9955830574035645, 1.7443466186523438, 0.7109336853027344, 0.9897541999816895, 0.6925580501556396, 1.37486732006073, 0.5639150142669678, 0.4338250160217285, 0.2066643238067627, 1.384570837020874, 0.4733726978302002, 1.1884312629699707, 2.6582202911376953], "mean_td_error": 0.9849144816398621, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 61.0, "diff_num_grad_updates_vs_sampler_policy": 60.0}}, "num_env_steps_sampled": 55552, "num_env_steps_trained": 15738, "num_agent_steps_sampled": 166656, "num_agent_steps_trained": 15738, "last_target_update_ts": 55552, "num_target_updates": 61}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 166656, "num_agent_steps_trained": 15738, "num_env_steps_sampled": 55552, "num_env_steps_trained": 15738, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 488.8662696258578, "num_env_steps_trained_throughput_per_sec": 140.7672963878028, "timesteps_total": 55552, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 166656, "timers": {"training_iteration_time_ms": 1844.171, "sample_time_ms": 1261.934, "load_time_ms": 0.549, "load_throughput": 469552.387, "learn_time_ms": 62.45, "learn_throughput": 4131.294, "synch_weights_time_ms": 16.352}, "counters": {"num_env_steps_sampled": 55552, "num_env_steps_trained": 15738, "num_agent_steps_sampled": 166656, "num_agent_steps_trained": 15738, "last_target_update_ts": 55552, "num_target_updates": 61}, "done": false, "episodes_total": 0, "training_iteration": 62, "trial_id": "9a806_00000", "date": "2023-11-16_21-55-32", "timestamp": 1700200532, "time_this_iter_s": 1.8465189933776855, "time_total_s": 112.63746237754822, "pid": 45784, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fadd0517040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 112.63746237754822, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 88.4, "ram_util_percent": 90.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.094403266906738, "actor_loss": -10.31557846069336, "critic_loss": 0.30295103788375854, "alpha_loss": -0.18471719324588776, "alpha_value": 0.9818674325942993, "log_alpha_value": -0.01829897053539753, "target_entropy": -6.0, "policy_t": 0.022207584232091904, "mean_q": 6.377065181732178, "max_q": 7.800234317779541, "min_q": 5.487376689910889}, "td_error": [1.7283601760864258, 2.960358142852783, 0.44491052627563477, 2.093485116958618, 2.048779249191284, 0.8059735298156738, 1.2808003425598145, 0.9662683010101318, 0.7075281143188477, 1.055387020111084, 1.915858268737793, 2.020148992538452, 0.9811863899230957, 0.9099023342132568, 1.3310449123382568, 0.9452803134918213, 0.3512303829193115, 2.6786553859710693, 0.7216770648956299, 0.4878232479095459, 0.9297995567321777, 0.3968789577484131, 1.165497064590454, 1.4826080799102783, 3.026442289352417, 0.5959267616271973, 1.1311566829681396, 1.0571167469024658, 1.3688077926635742, 0.0412900447845459, 0.9872221946716309, 1.6699817180633545, 0.7423093318939209, 0.12294530868530273, 1.2752339839935303, 1.1077497005462646, 1.1266729831695557, 0.7349569797515869, 0.5374100208282471, 0.9223268032073975, 1.2273902893066406, 0.8625190258026123, 0.7720046043395996, 1.5698750019073486, 0.44400930404663086, 0.18079519271850586, 0.17557096481323242, 1.735051155090332, 0.9133429527282715, 2.4220926761627197, 0.31856703758239746, 2.2116925716400146, 0.7499892711639404, 1.2718284130096436, 2.462735414505005, 0.2638676166534424, 0.8427600860595703, 0.4962775707244873, 1.1027958393096924, 0.7560586929321289, 0.4277796745300293, 0.14574909210205078, 0.7544279098510742, 0.15475893020629883, 0.2954895496368408, 1.3754208087921143, 0.5229182243347168, 2.2743239402770996, 0.4077754020690918, 0.24934077262878418, 1.1692371368408203, 1.1708948612213135, 0.46695947647094727, 0.45903778076171875, 1.6487104892730713, 0.12893319129943848, 0.6800639629364014, 2.1120550632476807, 0.30716633796691895, 1.6879229545593262, 1.3647034168243408, 2.746525287628174, 0.22166991233825684, 3.1217732429504395, 0.7002997398376465, 0.5130348205566406], "mean_td_error": 1.078409194946289, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 62.0, "diff_num_grad_updates_vs_sampler_policy": 61.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.060518264770508, "actor_loss": -7.992315769195557, "critic_loss": 0.18867695331573486, "alpha_loss": -0.18414899706840515, "alpha_value": 0.9818623661994934, "log_alpha_value": -0.0183041263371706, "target_entropy": -6.0, "policy_t": -0.013721410185098648, "mean_q": 4.124243259429932, "max_q": 4.900012969970703, "min_q": 3.329444408416748}, "td_error": [1.0187547206878662, 0.11749553680419922, 0.5853515863418579, 0.5668398141860962, 0.6084692478179932, 0.7240931987762451, 1.3075031042099, 0.824028491973877, 0.05047929286956787, 1.0936620235443115, 0.9915590286254883, 0.8059902191162109, 0.7401397228240967, 1.826467752456665, 0.5515100955963135, 1.5299675464630127, 0.23690485954284668, 0.8296895027160645, 2.6883833408355713, 0.26469695568084717, 0.6242549419403076, 0.33456993103027344, 0.047312378883361816, 1.7653824090957642, 0.39362621307373047, 0.2728090286254883, 1.6737029552459717, 0.5015056133270264, 0.667405366897583, 0.8209630250930786, 2.5985279083251953, 1.4526729583740234, 0.6283590793609619, 0.468585729598999, 0.18611764907836914, 0.0799715518951416, 0.4759618043899536, 0.2083418369293213, 0.9166018962860107, 1.94510817527771, 1.5978405475616455, 0.35298943519592285, 0.6104257106781006, 1.5701700448989868, 1.6630717515945435, 1.174659013748169, 2.5814473628997803, 0.980644941329956, 0.7582130432128906, 1.2039356231689453, 1.0038244724273682, 0.7037585973739624, 1.2973322868347168, 1.073396921157837, 0.9444239139556885, 0.07921195030212402, 1.746993064880371, 0.2086632251739502, 0.3510277271270752, 1.28092360496521, 1.1519873142242432, 0.37241625785827637, 2.7150285243988037, 0.418790340423584, 0.6096493005752563, 1.5614027976989746, 0.32720351219177246, 0.5794715881347656, 1.7316017150878906, 1.6983895301818848, 0.6949115991592407, 1.6049180030822754, 0.46753764152526855, 0.07898902893066406, 1.0708637237548828, 0.7931573390960693, 2.4579150676727295, 0.8160920143127441, 0.15441465377807617, 1.2646658420562744, 0.39545631408691406, 0.6590774059295654, 1.3637088537216187, 0.37745463848114014, 0.5467923879623413, 0.11929845809936523], "mean_td_error": 0.9143943190574646, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 62.0, "diff_num_grad_updates_vs_sampler_policy": 61.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.97518253326416, "actor_loss": -8.183111190795898, "critic_loss": 0.17282235622406006, "alpha_loss": -0.1825449913740158, "alpha_value": 0.9818665385246277, "log_alpha_value": -0.01829991489648819, "target_entropy": -6.0, "policy_t": -0.015776829794049263, "mean_q": 4.290102005004883, "max_q": 5.288564682006836, "min_q": 3.7410318851470947}, "td_error": [0.42878472805023193, 0.5584487915039062, 0.0811011791229248, 1.0603162050247192, 1.9847207069396973, 0.32167625427246094, 1.0924649238586426, 0.2783069610595703, 0.7214491367340088, 0.7046165466308594, 0.8482763767242432, 2.2406327724456787, 0.4919312000274658, 1.3706624507904053, 1.4466395378112793, 2.4674313068389893, 1.3808867931365967, 0.17102956771850586, 1.5253714323043823, 0.24545073509216309, 0.15186822414398193, 0.890038013458252, 1.6099172830581665, 0.3362957239151001, 0.1852273941040039, 0.8587328195571899, 2.229405403137207, 1.0264599323272705, 0.49009132385253906, 1.0943336486816406, 1.3722851276397705, 0.5109012126922607, 1.2778983116149902, 0.9889857769012451, 0.10642099380493164, 0.19286227226257324, 1.2693490982055664, 0.0828089714050293, 1.2785217761993408, 1.5006394386291504, 2.8748507499694824, 1.1344830989837646, 0.38419437408447266, 1.269237995147705, 0.05543947219848633, 0.6552457809448242, 0.8251216411590576, 0.05423164367675781, 1.3173524141311646, 0.33719396591186523, 0.2348480224609375, 0.08315324783325195, 1.0506553649902344, 0.09252595901489258, 1.8920981884002686, 1.761446237564087, 1.8822646141052246, 0.6886239051818848, 2.812204360961914, 0.5142912864685059, 1.996230125427246, 0.1804879903793335, 0.8751876354217529, 0.8558180332183838, 0.7394990921020508, 0.6641662120819092, 1.2160325050354004, 0.8607044219970703, 1.9816651344299316, 0.2513231039047241, 1.4252476692199707, 3.328803539276123, 0.9262332916259766, 0.7016870975494385, 1.69120192527771, 0.5628082752227783, 0.517298698425293, 0.9311013221740723, 0.28733205795288086, 1.5886108875274658, 0.8741865158081055, 0.8609695434570312, 2.1827385425567627, 2.4783854484558105, 1.1020351648330688, 0.5844122171401978], "mean_td_error": 1.0053125619888306, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 62.0, "diff_num_grad_updates_vs_sampler_policy": 61.0}}, "num_env_steps_sampled": 56448, "num_env_steps_trained": 15996, "num_agent_steps_sampled": 169344, "num_agent_steps_trained": 15996, "last_target_update_ts": 56448, "num_target_updates": 62}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 169344, "num_agent_steps_trained": 15996, "num_env_steps_sampled": 56448, "num_env_steps_trained": 15996, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 472.093778182164, "num_env_steps_trained_throughput_per_sec": 135.93771737834632, "timesteps_total": 56448, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 169344, "timers": {"training_iteration_time_ms": 1871.734, "sample_time_ms": 1289.646, "load_time_ms": 0.552, "load_throughput": 467281.472, "learn_time_ms": 62.668, "learn_throughput": 4116.961, "synch_weights_time_ms": 16.44}, "counters": {"num_env_steps_sampled": 56448, "num_env_steps_trained": 15996, "num_agent_steps_sampled": 169344, "num_agent_steps_trained": 15996, "last_target_update_ts": 56448, "num_target_updates": 62}, "done": false, "episodes_total": 0, "training_iteration": 63, "trial_id": "9a806_00000", "date": "2023-11-16_21-55-34", "timestamp": 1700200534, "time_this_iter_s": 1.9127600193023682, "time_total_s": 114.55022239685059, "pid": 45784, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fadd0517d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 114.55022239685059, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 65.73333333333333, "ram_util_percent": 90.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.915733337402344, "actor_loss": -10.335983276367188, "critic_loss": 0.3568863868713379, "alpha_loss": -0.18441841006278992, "alpha_value": 0.9815733432769775, "log_alpha_value": -0.018598565831780434, "target_entropy": -6.0, "policy_t": 0.029744219034910202, "mean_q": 6.578866004943848, "max_q": 7.619337558746338, "min_q": 5.632401466369629}, "td_error": [0.262284517288208, 1.1591830253601074, 1.009171485900879, 1.643324613571167, 1.3071045875549316, 1.190290927886963, 1.5640761852264404, 1.350163221359253, 1.3798463344573975, 2.9406700134277344, 1.5503895282745361, 0.16837787628173828, 2.9177396297454834, 0.2534339427947998, 2.210404634475708, 0.23962068557739258, 2.0853633880615234, 0.7844269275665283, 0.08906149864196777, 2.3743958473205566, 1.2668907642364502, 1.7914891242980957, 1.1550190448760986, 0.13217687606811523, 0.9702572822570801, 0.47761964797973633, 0.622793436050415, 1.7286581993103027, 1.385150671005249, 1.6326038837432861, 0.7986509799957275, 1.2003698348999023, 0.4560544490814209, 0.268871545791626, 2.3318417072296143, 0.6220333576202393, 0.9850461483001709, 2.0156538486480713, 0.33098340034484863, 1.1047937870025635, 2.7945919036865234, 1.5282845497131348, 2.0812549591064453, 1.0702426433563232, 0.9285712242126465, 1.0651912689208984, 0.9281759262084961, 0.3843376636505127, 1.2578251361846924, 2.3946516513824463, 2.038196086883545, 1.989640474319458, 1.8013279438018799, 0.577507734298706, 0.472475528717041, 1.2122797966003418, 0.4386000633239746, 1.2643136978149414, 0.397968053817749, 0.39013218879699707, 2.0821471214294434, 1.6094086170196533, 2.0824978351593018, 1.7658648490905762, 1.5138466358184814, 0.60921311378479, 0.7821352481842041, 0.13152480125427246, 0.018718481063842773, 1.815197229385376, 1.1786062717437744, 0.4359853267669678, 1.431389331817627, 0.031380653381347656, 1.1662793159484863, 3.068969964981079, 0.8089053630828857, 0.9888882637023926, 1.1292572021484375, 2.86307692527771, 1.2848267555236816, 1.017329454421997, 0.9604947566986084, 2.0436580181121826, 0.38637208938598633, 1.6855647563934326], "mean_td_error": 1.2286441326141357, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 63.0, "diff_num_grad_updates_vs_sampler_policy": 62.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.058853149414062, "actor_loss": -7.924747943878174, "critic_loss": 0.210271418094635, "alpha_loss": -0.18713510036468506, "alpha_value": 0.9815679788589478, "log_alpha_value": -0.018604017794132233, "target_entropy": -6.0, "policy_t": -0.01695258356630802, "mean_q": 4.029351711273193, "max_q": 4.545639991760254, "min_q": 3.3285610675811768}, "td_error": [0.07474148273468018, 1.1732227802276611, 0.3606119155883789, 0.08283829689025879, 0.6151766777038574, 0.5314449071884155, 0.339877724647522, 1.5224231481552124, 0.33354640007019043, 0.77759850025177, 0.6623927354812622, 1.123091220855713, 2.0223631858825684, 0.5395066738128662, 2.4009604454040527, 0.38405346870422363, 0.6398485898971558, 0.2892425060272217, 0.7629145383834839, 0.7500261068344116, 0.12855887413024902, 0.5878193378448486, 0.32787013053894043, 1.8250293731689453, 1.0105273723602295, 0.602799654006958, 1.8651556968688965, 1.4717364311218262, 0.44040417671203613, 1.011625051498413, 1.775396704673767, 1.7128756046295166, 0.09952652454376221, 0.5029751062393188, 0.9395749568939209, 1.0597872734069824, 0.6237446069717407, 0.2857224941253662, 0.6057373285293579, 0.18952727317810059, 2.1771466732025146, 2.4103081226348877, 0.7847371101379395, 0.5993607044219971, 1.4018731117248535, 0.41645753383636475, 0.34998440742492676, 0.99003005027771, 1.1988604068756104, 0.7025874853134155, 1.0716525316238403, 1.2291449308395386, 0.8318606615066528, 1.070025086402893, 1.7279918193817139, 0.743908166885376, 1.277141809463501, 2.6532506942749023, 0.5603930950164795, 2.6487088203430176, 0.19634103775024414, 0.14202189445495605, 0.770933985710144, 0.1968066692352295, 1.7022411823272705, 2.820375919342041, 1.1478899717330933, 0.692363977432251, 0.5796775817871094, 1.735668420791626, 0.2584528923034668, 0.9490019083023071, 2.4448928833007812, 0.3344334363937378, 0.48191583156585693, 0.3915759325027466, 0.8120381832122803, 1.1604779958724976, 1.155306100845337, 0.24237608909606934, 0.36582231521606445, 1.1898303031921387, 0.7493305206298828, 2.892284393310547, 0.8173145055770874, 2.9274725914001465], "mean_td_error": 0.9820295572280884, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 63.0, "diff_num_grad_updates_vs_sampler_policy": 62.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.043964385986328, "actor_loss": -8.225053787231445, "critic_loss": 0.1608181595802307, "alpha_loss": -0.18681222200393677, "alpha_value": 0.9815724492073059, "log_alpha_value": -0.018599452450871468, "target_entropy": -6.0, "policy_t": -0.05663818120956421, "mean_q": 4.2791266441345215, "max_q": 5.015527725219727, "min_q": 3.4844374656677246}, "td_error": [0.27077150344848633, 0.831493616104126, 0.19532513618469238, 0.685551643371582, 0.7891733646392822, 0.9522343873977661, 1.4576122760772705, 0.7321317195892334, 1.706863284111023, 0.23649418354034424, 0.5243088006973267, 1.2691543102264404, 0.0738288164138794, 1.0366218090057373, 1.2182605266571045, 0.33352065086364746, 1.163888692855835, 0.1481785774230957, 2.231804132461548, 0.8380309343338013, 0.5584638118743896, 1.0017108917236328, 0.8449451923370361, 1.1166460514068604, 0.4919116497039795, 1.6433444023132324, 0.8867859840393066, 1.3905584812164307, 2.609407663345337, 0.9166309833526611, 1.0251479148864746, 1.6373927593231201, 0.5453586578369141, 1.7454766035079956, 0.6888928413391113, 2.3904614448547363, 1.0009393692016602, 1.1029760837554932, 1.3779432773590088, 0.6242207288742065, 0.6719017028808594, 1.0833830833435059, 0.4582216739654541, 0.8414306640625, 0.09988069534301758, 0.08924722671508789, 0.1282186508178711, 1.919182300567627, 1.0228900909423828, 1.352128028869629, 0.8260787725448608, 0.27249932289123535, 1.4375860691070557, 0.43138933181762695, 1.011099100112915, 0.7689723968505859, 0.387697696685791, 0.500859260559082, 1.1151667833328247, 0.8809158802032471, 2.7689666748046875, 1.5748438835144043, 1.1041429042816162, 0.3415210247039795, 0.48004746437072754, 1.713302493095398, 2.506540298461914, 1.1499443054199219, 0.455707311630249, 1.6264092922210693, 0.477469801902771, 1.3423283100128174, 1.0279855728149414, 0.36213016510009766, 1.4060328006744385, 1.0277535915374756, 1.1122522354125977, 1.1037027835845947, 0.7675304412841797, 2.26124906539917, 1.9803853034973145, 0.05963277816772461, 0.392319917678833, 0.15708327293395996, 0.12382817268371582, 1.9021437168121338], "mean_td_error": 0.986261248588562, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 63.0, "diff_num_grad_updates_vs_sampler_policy": 62.0}}, "num_env_steps_sampled": 57344, "num_env_steps_trained": 16254, "num_agent_steps_sampled": 172032, "num_agent_steps_trained": 16254, "last_target_update_ts": 57344, "num_target_updates": 63}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 172032, "num_agent_steps_trained": 16254, "num_env_steps_sampled": 57344, "num_env_steps_trained": 16254, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 508.3846666026355, "num_env_steps_trained_throughput_per_sec": 146.3875490887053, "timesteps_total": 57344, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 172032, "timers": {"training_iteration_time_ms": 1875.551, "sample_time_ms": 1292.631, "load_time_ms": 0.55, "load_throughput": 469063.906, "learn_time_ms": 62.998, "learn_throughput": 4095.375, "synch_weights_time_ms": 16.427}, "counters": {"num_env_steps_sampled": 57344, "num_env_steps_trained": 16254, "num_agent_steps_sampled": 172032, "num_agent_steps_trained": 16254, "last_target_update_ts": 57344, "num_target_updates": 63}, "done": false, "episodes_total": 0, "training_iteration": 64, "trial_id": "9a806_00000", "date": "2023-11-16_21-55-35", "timestamp": 1700200535, "time_this_iter_s": 1.7814068794250488, "time_total_s": 116.33162927627563, "pid": 45784, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fadd0517af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 116.33162927627563, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 61.9, "ram_util_percent": 90.40000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.075218200683594, "actor_loss": -10.387765884399414, "critic_loss": 0.2599470615386963, "alpha_loss": -0.19039934873580933, "alpha_value": 0.9812796711921692, "log_alpha_value": -0.01889779046177864, "target_entropy": -6.0, "policy_t": -0.0253900233656168, "mean_q": 6.471970081329346, "max_q": 7.392444133758545, "min_q": 5.633177280426025}, "td_error": [0.7725448608398438, 0.2228987216949463, 0.6359310150146484, 2.0734167098999023, 0.16452836990356445, 1.318680763244629, 1.765117883682251, 0.46335625648498535, 0.07401394844055176, 1.1034765243530273, 0.6550288200378418, 0.6159842014312744, 1.360032081604004, 1.4771232604980469, 0.09128260612487793, 1.2759273052215576, 0.43816137313842773, 0.586338996887207, 0.5512402057647705, 1.4985053539276123, 3.129554271697998, 1.1367576122283936, 0.47043514251708984, 1.6725914478302002, 1.7814748287200928, 0.37202000617980957, 0.2528202533721924, 1.0188860893249512, 1.0825865268707275, 2.1274118423461914, 0.8017318248748779, 2.976911783218384, 0.7621839046478271, 1.0395548343658447, 0.15857219696044922, 2.6847379207611084, 0.5221900939941406, 1.1718811988830566, 0.5902516841888428, 1.3785531520843506, 0.25000715255737305, 0.32285046577453613, 1.2924294471740723, 0.9157369136810303, 0.5614590644836426, 0.5700442790985107, 3.03214955329895, 0.14734578132629395, 0.5035791397094727, 0.9099395275115967, 0.40827226638793945, 1.1382098197937012, 1.2878623008728027, 0.7813639640808105, 1.3822169303894043, 0.25000596046447754, 1.3767821788787842, 1.2348792552947998, 1.3022899627685547, 0.4910116195678711, 1.591745376586914, 1.8718419075012207, 1.5817184448242188, 0.9338934421539307, 1.452343225479126, 2.528130531311035, 0.9592499732971191, 0.06519055366516113, 4.071549415588379, 1.2500405311584473, 1.2438106536865234, 1.170079231262207, 1.265428066253662, 3.0918517112731934, 0.11779594421386719, 0.410963773727417, 0.20636868476867676, 0.44548630714416504, 0.4280679225921631, 2.352184295654297, 1.1038107872009277, 1.4570355415344238, 0.8945698738098145, 2.811706781387329, 0.9727611541748047, 0.6048264503479004], "mean_td_error": 1.108320713043213, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 64.0, "diff_num_grad_updates_vs_sampler_policy": 63.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.093201637268066, "actor_loss": -7.870110988616943, "critic_loss": 0.1885659098625183, "alpha_loss": -0.1908004730939865, "alpha_value": 0.9812737107276917, "log_alpha_value": -0.018903858959674835, "target_entropy": -6.0, "policy_t": 0.027932213619351387, "mean_q": 3.9601686000823975, "max_q": 4.795827388763428, "min_q": 3.4363224506378174}, "td_error": [0.2758685350418091, 0.2527024745941162, 1.564680576324463, 0.7255561351776123, 0.8708763122558594, 2.115417242050171, 1.810140609741211, 1.8222345113754272, 1.4032806158065796, 0.33909714221954346, 0.1335279941558838, 0.980966329574585, 0.8365817070007324, 1.1347981691360474, 0.21378111839294434, 1.4124594926834106, 0.7236469984054565, 0.8161489963531494, 0.30172085762023926, 1.5690728425979614, 2.4621753692626953, 0.8350694179534912, 0.4688969850540161, 1.814274787902832, 1.3590149879455566, 0.11121702194213867, 1.8985614776611328, 0.903611421585083, 1.4135829210281372, 0.38744187355041504, 1.1442420482635498, 0.1602003574371338, 1.1335718631744385, 0.18036997318267822, 0.3563413619995117, 0.42795467376708984, 0.3731868267059326, 0.5690629482269287, 0.3565535545349121, 2.6403656005859375, 2.757582187652588, 1.2603530883789062, 0.4638887643814087, 0.06576991081237793, 0.2316880226135254, 0.5663982629776001, 1.7348076105117798, 1.570558786392212, 0.4535408020019531, 0.5757404565811157, 1.159668207168579, 1.5469393730163574, 0.21164178848266602, 0.591076135635376, 0.4890446662902832, 0.2614990472793579, 0.28127002716064453, 0.15101706981658936, 0.5343328714370728, 0.255845308303833, 0.5393035411834717, 0.9212806224822998, 0.9326635599136353, 0.038518548011779785, 0.8269134759902954, 2.339406967163086, 0.5121519565582275, 0.4395488500595093, 0.61134934425354, 0.3920705318450928, 2.717639923095703, 2.27243709564209, 0.4747598171234131, 0.5066958665847778, 0.8229485750198364, 0.1465367078781128, 1.6611919403076172, 0.4525313377380371, 0.5443341732025146, 0.6248477697372437, 0.6736401319503784, 2.1684298515319824, 1.4431393146514893, 1.8173456192016602, 0.3288300037384033, 0.27904295921325684], "mean_td_error": 0.9063775539398193, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 64.0, "diff_num_grad_updates_vs_sampler_policy": 63.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.074453353881836, "actor_loss": -8.155535697937012, "critic_loss": 0.14012600481510162, "alpha_loss": -0.19039632380008698, "alpha_value": 0.9812785387039185, "log_alpha_value": -0.01889892667531967, "target_entropy": -6.0, "policy_t": 0.03464233875274658, "mean_q": 4.240482807159424, "max_q": 4.970421314239502, "min_q": 3.4040749073028564}, "td_error": [0.5310955047607422, 1.0381362438201904, 1.5117385387420654, 1.1835007667541504, 0.11896383762359619, 0.6312083005905151, 0.8208067417144775, 0.2605891227722168, 0.58591628074646, 1.0589759349822998, 1.193143606185913, 0.8127017021179199, 1.1679997444152832, 0.7647093534469604, 0.3459813594818115, 1.0032436847686768, 1.4793757200241089, 1.0674200057983398, 0.2149968147277832, 0.0720592737197876, 1.3632092475891113, 1.5077002048492432, 0.5570447444915771, 1.3488969802856445, 0.4548414945602417, 0.532278299331665, 1.5196752548217773, 0.7721588611602783, 0.7047382593154907, 0.5769867897033691, 1.312483549118042, 1.2125210762023926, 0.7676398754119873, 1.4124914407730103, 1.0317516326904297, 1.0006096363067627, 0.3364373445510864, 0.11908078193664551, 2.7816576957702637, 1.4136602878570557, 2.0099868774414062, 0.08497881889343262, 0.587191104888916, 1.5078821182250977, 0.3926098346710205, 0.5374001264572144, 2.172420024871826, 1.3890266418457031, 0.2650182247161865, 0.770967960357666, 1.2265063524246216, 0.5467603206634521, 2.831212043762207, 0.44335126876831055, 0.3539609909057617, 0.7802503108978271, 0.1451730728149414, 1.4047815799713135, 0.7545430660247803, 0.46443772315979004, 1.1748456954956055, 0.8255469799041748, 1.4110546112060547, 0.520653247833252, 2.026211977005005, 0.0625162124633789, 0.9019453525543213, 0.5479257106781006, 0.05917549133300781, 0.8821380138397217, 0.601923942565918, 1.3831133842468262, 0.11328339576721191, 0.771277666091919, 0.6429164409637451, 1.0111277103424072, 2.158804416656494, 0.39679527282714844, 0.420857310295105, 1.0451092720031738, 2.315387487411499, 0.8165194988250732, 0.594098687171936, 0.8098635673522949, 0.33448028564453125, 1.0514814853668213], "mean_td_error": 0.9085573554039001, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 64.0, "diff_num_grad_updates_vs_sampler_policy": 63.0}}, "num_env_steps_sampled": 58240, "num_env_steps_trained": 16512, "num_agent_steps_sampled": 174720, "num_agent_steps_trained": 16512, "last_target_update_ts": 58240, "num_target_updates": 64}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 174720, "num_agent_steps_trained": 16512, "num_env_steps_sampled": 58240, "num_env_steps_trained": 16512, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 504.46251072525837, "num_env_steps_trained_throughput_per_sec": 145.25817831151411, "timesteps_total": 58240, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 174720, "timers": {"training_iteration_time_ms": 1880.593, "sample_time_ms": 1297.473, "load_time_ms": 0.548, "load_throughput": 470859.991, "learn_time_ms": 63.134, "learn_throughput": 4086.547, "synch_weights_time_ms": 16.245}, "counters": {"num_env_steps_sampled": 58240, "num_env_steps_trained": 16512, "num_agent_steps_sampled": 174720, "num_agent_steps_trained": 16512, "last_target_update_ts": 58240, "num_target_updates": 64}, "done": false, "episodes_total": 0, "training_iteration": 65, "trial_id": "9a806_00000", "date": "2023-11-16_21-55-37", "timestamp": 1700200537, "time_this_iter_s": 1.7904911041259766, "time_total_s": 118.12212038040161, "pid": 45784, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fadd05330d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 118.12212038040161, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 80.55, "ram_util_percent": 90.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.079082489013672, "actor_loss": -10.318015098571777, "critic_loss": 0.34480851888656616, "alpha_loss": -0.19348901510238647, "alpha_value": 0.9809859991073608, "log_alpha_value": -0.019197087734937668, "target_entropy": -6.0, "policy_t": -0.022783637046813965, "mean_q": 6.452005863189697, "max_q": 7.376312732696533, "min_q": 5.5576863288879395}, "td_error": [0.9443073272705078, 0.8798010349273682, 0.196516752243042, 1.9763267040252686, 1.5515639781951904, 1.5550785064697266, 2.865739107131958, 0.604924201965332, 1.7253286838531494, 1.45595383644104, 0.10326886177062988, 1.9550609588623047, 1.3022425174713135, 0.553433895111084, 1.1631314754486084, 2.0759124755859375, 1.1497602462768555, 2.640589714050293, 0.8095223903656006, 1.0354154109954834, 2.760624408721924, 2.033782958984375, 0.2912156581878662, 1.196669340133667, 0.9356114864349365, 0.6541755199432373, 1.253237247467041, 1.6563780307769775, 0.14789891242980957, 0.47001147270202637, 0.376953125, 2.8663454055786133, 1.7220418453216553, 0.20552659034729004, 1.6107263565063477, 2.9495701789855957, 1.74739408493042, 0.16347599029541016, 2.6601240634918213, 1.0806384086608887, 1.2545993328094482, 1.7046754360198975, 0.25925421714782715, 3.1475942134857178, 0.6594948768615723, 2.915989637374878, 3.1666746139526367, 0.2039041519165039, 0.6730251312255859, 1.7579057216644287, 1.0202245712280273, 0.1227259635925293, 0.9858763217926025, 1.0469350814819336, 0.9001634120941162, 3.1203529834747314, 2.0241453647613525, 1.0063705444335938, 3.0552031993865967, 0.30597615242004395, 1.6361088752746582, 2.2585668563842773, 0.3568241596221924, 0.7706825733184814, 1.3213164806365967, 2.2091524600982666, 0.12895941734313965, 1.9508640766143799, 1.1698870658874512, 1.5280168056488037, 0.13519287109375, 1.3076655864715576, 0.45216846466064453, 0.34598278999328613, 0.6320662498474121, 0.7333674430847168, 1.2906677722930908, 3.660043239593506, 2.3547770977020264, 1.584543228149414, 0.8484189510345459, 1.3847839832305908, 0.6758496761322021, 2.2968461513519287, 0.421173095703125, 2.689419746398926], "mean_td_error": 1.3581478595733643, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 65.0, "diff_num_grad_updates_vs_sampler_policy": 64.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.146981239318848, "actor_loss": -7.8475823402404785, "critic_loss": 0.168522447347641, "alpha_loss": -0.19486001133918762, "alpha_value": 0.9809795022010803, "log_alpha_value": -0.01920374296605587, "target_entropy": -6.0, "policy_t": 0.0010715048993006349, "mean_q": 3.915635585784912, "max_q": 4.683884143829346, "min_q": 3.245729684829712}, "td_error": [1.303545594215393, 0.17174696922302246, 1.3801602125167847, 0.1339942216873169, 0.8184655904769897, 0.5943542718887329, 1.0285252332687378, 0.25565266609191895, 0.8246701955795288, 0.2453080415725708, 0.8287450075149536, 0.15079045295715332, 1.1123480796813965, 1.7634084224700928, 1.9121732711791992, 0.33429908752441406, 0.37751734256744385, 0.09280705451965332, 1.4686803817749023, 0.3951514959335327, 0.2636805772781372, 0.3475496768951416, 0.19737863540649414, 0.03962588310241699, 0.8236563205718994, 0.014757990837097168, 0.9870750904083252, 1.0966488122940063, 0.8055820465087891, 1.4685595035552979, 1.4396389722824097, 0.09031546115875244, 0.34185874462127686, 0.7217793464660645, 1.1403218507766724, 0.25305604934692383, 0.35883116722106934, 1.5407766103744507, 3.0193076133728027, 1.675656795501709, 0.04163956642150879, 2.1787757873535156, 1.3067501783370972, 0.9160795211791992, 0.17581307888031006, 0.07934796810150146, 0.8849601745605469, 0.7789000272750854, 1.2206623554229736, 0.44625067710876465, 0.1831568479537964, 2.02337646484375, 0.9310681819915771, 0.8218028545379639, 0.3785666227340698, 0.3600292205810547, 0.8772053718566895, 0.39148998260498047, 0.19660019874572754, 0.09821724891662598, 2.0272765159606934, 1.0709158182144165, 0.7630642652511597, 0.11605548858642578, 2.0439648628234863, 0.20074844360351562, 0.6049708127975464, 0.3157839775085449, 0.8547883033752441, 1.579149842262268, 1.6095508337020874, 0.6998041868209839, 0.1473081111907959, 0.6028165817260742, 0.3503127098083496, 0.8474260568618774, 0.710921049118042, 1.4036645889282227, 0.5869017839431763, 1.1208372116088867, 0.09776794910430908, 1.4314364194869995, 1.6985670328140259, 0.8565900325775146, 2.4318466186523438, 1.124159812927246], "mean_td_error": 0.8302991390228271, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 65.0, "diff_num_grad_updates_vs_sampler_policy": 64.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.139793395996094, "actor_loss": -8.175939559936523, "critic_loss": 0.12454451620578766, "alpha_loss": -0.19466803967952728, "alpha_value": 0.9809846878051758, "log_alpha_value": -0.019198423251509666, "target_entropy": -6.0, "policy_t": 0.02735895663499832, "mean_q": 4.139179706573486, "max_q": 4.858124256134033, "min_q": 3.4723405838012695}, "td_error": [0.20684313774108887, 0.6342628002166748, 0.0466306209564209, 0.7928770780563354, 1.002240538597107, 0.4142789840698242, 0.11278891563415527, 0.40061330795288086, 1.1014282703399658, 1.8768129348754883, 0.9164670705795288, 0.3557145595550537, 0.04028153419494629, 0.4934823513031006, 0.9080410003662109, 0.7567741870880127, 0.4025259017944336, 0.15830814838409424, 2.381450653076172, 1.3573191165924072, 1.1416239738464355, 0.43177735805511475, 0.38359665870666504, 0.33698487281799316, 0.3115253448486328, 0.1312352418899536, 1.375387191772461, 1.458160638809204, 1.6415529251098633, 1.8184399604797363, 1.230100154876709, 0.712580680847168, 0.5653796195983887, 1.2566566467285156, 0.6678639650344849, 1.7845778465270996, 1.9097826480865479, 0.19034528732299805, 0.5967922210693359, 0.6905221939086914, 0.08499622344970703, 0.7600996494293213, 0.08700180053710938, 0.3369176387786865, 0.2627577781677246, 1.8576555252075195, 1.0385282039642334, 1.605309009552002, 0.41339850425720215, 0.8981704711914062, 0.30500733852386475, 0.12034153938293457, 0.9165854454040527, 0.704566240310669, 2.0245916843414307, 0.19698619842529297, 0.8452877998352051, 0.21387171745300293, 0.07611489295959473, 0.6149682998657227, 0.2168722152709961, 1.1013832092285156, 1.4622037410736084, 1.0699214935302734, 0.3237287998199463, 1.0028396844863892, 0.13534259796142578, 1.0573735237121582, 0.2945833206176758, 0.9124634265899658, 1.0036362409591675, 2.631904363632202, 0.7987070083618164, 0.1077582836151123, 1.5180613994598389, 0.7144738435745239, 0.2905726432800293, 1.3829022645950317, 1.3956103324890137, 1.4211409091949463, 2.0866148471832275, 0.5523147583007812, 0.4884147644042969, 0.9462958574295044, 0.5603206157684326, 1.0897607803344727], "mean_td_error": 0.824678897857666, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 65.0, "diff_num_grad_updates_vs_sampler_policy": 64.0}}, "num_env_steps_sampled": 59136, "num_env_steps_trained": 16770, "num_agent_steps_sampled": 177408, "num_agent_steps_trained": 16770, "last_target_update_ts": 59136, "num_target_updates": 65}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 177408, "num_agent_steps_trained": 16770, "num_env_steps_sampled": 59136, "num_env_steps_trained": 16770, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 501.54682576245705, "num_env_steps_trained_throughput_per_sec": 144.41861723963606, "timesteps_total": 59136, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 177408, "timers": {"training_iteration_time_ms": 1889.66, "sample_time_ms": 1304.624, "load_time_ms": 0.542, "load_throughput": 476143.104, "learn_time_ms": 63.175, "learn_throughput": 4083.895, "synch_weights_time_ms": 16.249}, "counters": {"num_env_steps_sampled": 59136, "num_env_steps_trained": 16770, "num_agent_steps_sampled": 177408, "num_agent_steps_trained": 16770, "last_target_update_ts": 59136, "num_target_updates": 65}, "done": false, "episodes_total": 0, "training_iteration": 66, "trial_id": "9a806_00000", "date": "2023-11-16_21-55-39", "timestamp": 1700200539, "time_this_iter_s": 1.8029232025146484, "time_total_s": 119.92504358291626, "pid": 45784, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fadd04c9160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 119.92504358291626, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 64.60000000000001, "ram_util_percent": 90.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.045222282409668, "actor_loss": -10.258535385131836, "critic_loss": 0.3330405354499817, "alpha_loss": -0.19584627449512482, "alpha_value": 0.9806923866271973, "log_alpha_value": -0.019496459513902664, "target_entropy": -6.0, "policy_t": -0.02686048485338688, "mean_q": 6.309567451477051, "max_q": 7.491369247436523, "min_q": 5.372425079345703}, "td_error": [0.4877922534942627, 1.3872523307800293, 0.8407835960388184, 2.029186964035034, 0.14828157424926758, 0.11466670036315918, 0.39933323860168457, 0.34650397300720215, 0.4961857795715332, 0.529658317565918, 0.8281981945037842, 1.4037795066833496, 0.3860471248626709, 0.408083438873291, 0.5683083534240723, 0.1278223991394043, 0.7502462863922119, 1.1469428539276123, 2.523435115814209, 2.242063283920288, 0.5884227752685547, 0.5166950225830078, 1.4211995601654053, 3.6149137020111084, 1.869701623916626, 1.6208772659301758, 2.12113618850708, 1.3385000228881836, 0.6311581134796143, 2.4063122272491455, 0.27047133445739746, 2.012932777404785, 0.17935800552368164, 1.18434739112854, 0.315446138381958, 0.2295219898223877, 1.117387294769287, 1.6816740036010742, 2.5917084217071533, 2.881080150604248, 1.5529742240905762, 1.3965227603912354, 2.076871395111084, 0.5972192287445068, 1.3773577213287354, 1.916520118713379, 2.710935115814209, 0.25058555603027344, 2.389868974685669, 0.7524986267089844, 0.5985279083251953, 2.925525665283203, 2.869716167449951, 1.6227586269378662, 1.0603482723236084, 0.9023685455322266, 0.3314642906188965, 1.9572036266326904, 1.7309503555297852, 0.9308643341064453, 2.475454092025757, 2.9173734188079834, 0.04314589500427246, 1.0036835670471191, 1.0702316761016846, 1.2224669456481934, 1.2020213603973389, 0.7173566818237305, 0.8840508460998535, 0.4336209297180176, 2.0937113761901855, 1.3928751945495605, 1.8065056800842285, 1.275869607925415, 2.393496513366699, 3.1067938804626465, 1.1427180767059326, 0.11986684799194336, 2.924722671508789, 1.7599542140960693, 1.370316982269287, 0.4202702045440674, 0.051061391830444336, 0.6121654510498047, 0.2286679744720459, 3.2633144855499268], "mean_td_error": 1.2981419563293457, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 66.0, "diff_num_grad_updates_vs_sampler_policy": 65.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.118661880493164, "actor_loss": -7.783323287963867, "critic_loss": 0.19310365617275238, "alpha_loss": -0.1973523497581482, "alpha_value": 0.9806851744651794, "log_alpha_value": -0.019503798335790634, "target_entropy": -6.0, "policy_t": 0.04310593754053116, "mean_q": 3.841820240020752, "max_q": 4.473184108734131, "min_q": 3.3331656455993652}, "td_error": [1.2712010145187378, 0.33037102222442627, 0.820824384689331, 1.4999037981033325, 0.246191143989563, 0.17519819736480713, 3.3443846702575684, 0.7427563667297363, 0.31536364555358887, 1.2992870807647705, 1.5703885555267334, 0.42797625064849854, 1.8667271137237549, 1.4057453870773315, 0.1853621006011963, 0.15283441543579102, 0.6001507043838501, 0.21819937229156494, 2.007169246673584, 1.6283888816833496, 0.6437559127807617, 1.1103456020355225, 0.09484708309173584, 1.3490716218948364, 1.9382240772247314, 1.8348233699798584, 0.1378030776977539, 0.8399103879928589, 1.0023399591445923, 1.4426923990249634, 0.6715068817138672, 2.196962356567383, 0.9081474542617798, 0.5325394868850708, 0.5840896368026733, 1.2207685708999634, 0.5457382202148438, 1.022891879081726, 0.9250497817993164, 0.3679600954055786, 0.5471054315567017, 0.5774083137512207, 1.0461729764938354, 1.433008074760437, 0.1463559865951538, 0.6204022169113159, 1.2668206691741943, 0.40630674362182617, 1.0889424085617065, 0.29583680629730225, 2.041076183319092, 1.512678861618042, 0.07551300525665283, 0.6146732568740845, 1.598542332649231, 0.5620650053024292, 2.570800304412842, 0.7239537239074707, 0.16020750999450684, 0.07118690013885498, 2.134805202484131, 0.03444838523864746, 0.5923788547515869, 0.8398579359054565, 0.36860930919647217, 1.0144093036651611, 0.6196082830429077, 1.9207954406738281, 0.7180477380752563, 1.7100021839141846, 0.7427196502685547, 0.4414520263671875, 0.7715718746185303, 1.533524513244629, 2.667236089706421, 0.10506117343902588, 0.4289036989212036, 0.21807444095611572, 0.5802657604217529, 0.32347798347473145, 0.09866845607757568, 1.3207043409347534, 1.0267035961151123, 0.8981906175613403, 0.2600669860839844, 1.3492251634597778], "mean_td_error": 0.9250668287277222, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 66.0, "diff_num_grad_updates_vs_sampler_policy": 65.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.165385246276855, "actor_loss": -8.115790367126465, "critic_loss": 0.15585120022296906, "alpha_loss": -0.19820572435855865, "alpha_value": 0.9806907773017883, "log_alpha_value": -0.019498102366924286, "target_entropy": -6.0, "policy_t": 0.036594241857528687, "mean_q": 4.124885559082031, "max_q": 4.756772994995117, "min_q": 3.3926799297332764}, "td_error": [2.0157711505889893, 0.32269763946533203, 1.411386251449585, 0.7920067310333252, 0.8629000186920166, 0.10549235343933105, 1.8995988368988037, 0.2080444097518921, 0.5996308326721191, 0.25523650646209717, 0.8723645210266113, 0.442547082901001, 0.09699773788452148, 2.3532824516296387, 0.5789116621017456, 1.4601209163665771, 0.32584691047668457, 0.8142551183700562, 2.123042106628418, 0.07986783981323242, 0.7151360511779785, 0.5226826667785645, 1.4390041828155518, 1.6283340454101562, 1.2364704608917236, 0.45291757583618164, 0.8156313896179199, 1.5810046195983887, 0.29795098304748535, 2.8028523921966553, 0.6578415632247925, 1.1345057487487793, 1.2940030097961426, 0.03643631935119629, 0.4267270565032959, 0.06727027893066406, 1.5472010374069214, 0.02582728862762451, 0.2858450412750244, 0.603835940361023, 1.9635528326034546, 0.3385484218597412, 2.102419137954712, 1.2492735385894775, 0.973689079284668, 0.7437649965286255, 0.5402137041091919, 1.6169261932373047, 0.47121715545654297, 1.701399326324463, 1.6868934631347656, 3.4788804054260254, 0.6607855558395386, 0.2452561855316162, 1.9415931701660156, 0.7773549556732178, 0.6043031215667725, 0.05000042915344238, 0.6223365068435669, 1.0073175430297852, 1.4365167617797852, 1.434289813041687, 0.7448886632919312, 0.318963885307312, 2.0179266929626465, 0.15982961654663086, 0.16797184944152832, 0.6293904781341553, 1.4909257888793945, 1.299067497253418, 2.2413597106933594, 0.34503889083862305, 0.9221307039260864, 0.39704108238220215, 0.045435428619384766, 0.49367380142211914, 2.2529404163360596, 0.3476862907409668, 1.297094702720642, 0.6706994771957397, 0.35680055618286133, 0.04735088348388672, 0.13329839706420898, 2.2212934494018555, 0.32967233657836914, 1.2836151123046875], "mean_td_error": 0.9424663782119751, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 66.0, "diff_num_grad_updates_vs_sampler_policy": 65.0}}, "num_env_steps_sampled": 60032, "num_env_steps_trained": 17028, "num_agent_steps_sampled": 180096, "num_agent_steps_trained": 17028, "last_target_update_ts": 60032, "num_target_updates": 66}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180096, "num_agent_steps_trained": 17028, "num_env_steps_sampled": 60032, "num_env_steps_trained": 17028, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 410.15499204649325, "num_env_steps_trained_throughput_per_sec": 118.10266512053042, "timesteps_total": 60032, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 180096, "timers": {"training_iteration_time_ms": 1925.877, "sample_time_ms": 1298.918, "load_time_ms": 0.545, "load_throughput": 473103.848, "learn_time_ms": 63.757, "learn_throughput": 4046.627, "synch_weights_time_ms": 16.71}, "counters": {"num_env_steps_sampled": 60032, "num_env_steps_trained": 17028, "num_agent_steps_sampled": 180096, "num_agent_steps_trained": 17028, "last_target_update_ts": 60032, "num_target_updates": 66}, "done": false, "episodes_total": 0, "training_iteration": 67, "trial_id": "9a806_00000", "date": "2023-11-16_21-55-41", "timestamp": 1700200541, "time_this_iter_s": 2.2052690982818604, "time_total_s": 122.13031268119812, "pid": 45784, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fadd0517af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 122.13031268119812, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 63.400000000000006, "ram_util_percent": 90.39999999999999}}
