{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 896, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2688, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2688, "num_agent_steps_trained": 0, "num_env_steps_sampled": 896, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 696.7449024257706, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 896, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2688, "timers": {"training_iteration_time_ms": 1285.958, "sample_time_ms": 688.695}, "counters": {"num_env_steps_sampled": 896, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2688, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 1, "trial_id": "7c290_00000", "date": "2023-11-18_19-55-41", "timestamp": 1700366141, "time_this_iter_s": 1.2883720397949219, "time_total_s": 1.2883720397949219, "pid": 1618, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x312a465c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 1.2883720397949219, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 44.9, "ram_util_percent": 64.45}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.074235916137695, "actor_loss": -4.083391189575195, "critic_loss": 3.931077480316162, "alpha_loss": -0.003022270742803812, "alpha_value": 0.9997000694274902, "log_alpha_value": -0.00029999998514540493, "target_entropy": -6.0, "policy_t": -0.04291478171944618, "mean_q": 0.018625816330313683, "max_q": 0.14864006638526917, "min_q": 0.010405804961919785}, "td_error": [3.2061545848846436, 5.389815330505371, 3.072683811187744, 5.179623603820801, 2.8118691444396973, 4.661750793457031, 3.4968390464782715, 5.542383670806885, 4.655961036682129, 5.096627235412598, 6.519228458404541, 5.299705505371094, 5.4392242431640625, 3.939746379852295, 6.5085601806640625, 3.4177494049072266, 5.017460823059082, 5.685588836669922, 4.110264778137207, 3.9569034576416016, 4.700054168701172, 4.933614253997803, 4.65355110168457, 5.089996337890625, 5.395868301391602, 3.700093984603882, 3.061980724334717, 2.9686484336853027, 3.514853000640869, 4.8679914474487305, 5.39885139465332, 3.222348690032959, 7.079728126525879, 3.8950297832489014, 3.349597215652466, 2.521585464477539, 3.862053394317627, 4.767910957336426, 4.291547775268555, 3.926727294921875, 4.0244340896606445, 5.549668312072754, 4.555594444274902, 3.949176788330078, 5.452068328857422, 6.961843967437744, 3.611326217651367, 3.074563980102539, 6.236575126647949, 5.3893938064575195, 4.794693470001221, 4.334400177001953, 5.068995475769043, 3.245698928833008, 6.676772117614746, 5.940372467041016, 4.74207878112793, 5.702779769897461, 5.483206748962402, 4.962212085723877, 3.847426414489746, 4.399297714233398, 5.176362037658691, 4.781156063079834, 2.9891042709350586, 2.280035972595215, 3.944878101348877, 3.1477324962615967, 5.148118019104004, 4.881472110748291, 3.5551259517669678, 5.30388069152832, 3.672999858856201, 4.659365653991699, 4.24973201751709, 4.958235740661621, 6.462896347045898, 2.7595977783203125, 4.339288711547852, 3.6885123252868652, 5.545923233032227, 4.602436065673828, 5.283226013183594, 4.80949592590332, 5.929027557373047, 4.558938980102539], "mean_td_error": 4.56907320022583, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 2.0, "diff_num_grad_updates_vs_sampler_policy": 1.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.117977142333984, "actor_loss": -4.128559112548828, "critic_loss": 1.0602912902832031, "alpha_loss": -0.0030353933107107878, "alpha_value": 0.9997000694274902, "log_alpha_value": -0.00029999998514540493, "target_entropy": -6.0, "policy_t": 0.03248587250709534, "mean_q": 0.018548203632235527, "max_q": 0.10370020568370819, "min_q": 0.01015731506049633}, "td_error": [2.5595831871032715, 3.279928684234619, 2.3313255310058594, 3.448807954788208, 3.0437405109405518, 2.2382724285125732, 0.06599545478820801, 2.697246551513672, 2.289919853210449, 3.6571884155273438, 1.3153181076049805, 2.689890146255493, 2.9520373344421387, 3.9229495525360107, 3.3043293952941895, 2.003279209136963, 1.5298269987106323, 3.452115058898926, 3.7538440227508545, 1.730690836906433, 2.8774032592773438, 0.48003333806991577, 3.2646689414978027, 2.5349245071411133, 2.8691585063934326, 2.7272844314575195, 1.0471000671386719, 1.8775384426116943, 1.5428082942962646, 2.498483419418335, 0.12629055976867676, 2.5335235595703125, 4.225163459777832, 2.630199670791626, 1.8579890727996826, 1.8553121089935303, 3.8610451221466064, 4.617853164672852, 2.1111583709716797, 5.205098628997803, 4.018692493438721, 4.333240032196045, 1.315711259841919, 3.9278645515441895, 3.1315255165100098, 4.707527160644531, 2.090708017349243, 2.9353346824645996, 1.8245680332183838, 2.0652523040771484, 0.9475533962249756, 0.5674020648002625, 1.4484055042266846, 1.5695064067840576, 2.872037887573242, 2.0301129817962646, 1.7567870616912842, 4.111528396606445, 1.8537099361419678, 1.140761137008667, 3.738138198852539, 2.926457405090332, 3.1383988857269287, 2.4113354682922363, 4.490726470947266, 1.7438881397247314, 0.8114328384399414, 2.7584471702575684, 3.106443405151367, 2.3853354454040527, 3.8091139793395996, 1.2533398866653442, 3.8309245109558105, 3.664642810821533, 1.6253104209899902, 4.221012592315674, 1.8674755096435547, 3.5847606658935547, 0.8920859098434448, 1.5743625164031982, 3.188225030899048, 1.6921006441116333, 1.4279274940490723, 0.7501095533370972, 2.0535831451416016, 3.509155750274658], "mean_td_error": 2.536189317703247, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 2.0, "diff_num_grad_updates_vs_sampler_policy": 1.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.882558822631836, "actor_loss": -3.8909547328948975, "critic_loss": 1.1993309259414673, "alpha_loss": -0.0029647676274180412, "alpha_value": 0.9997000694274902, "log_alpha_value": -0.00029999998514540493, "target_entropy": -6.0, "policy_t": 0.027405759319663048, "mean_q": 0.015400738455355167, "max_q": 0.13957276940345764, "min_q": 0.009671751409769058}, "td_error": [2.071883201599121, 1.9672389030456543, 3.80301570892334, 1.368614673614502, 2.3400754928588867, 2.4116268157958984, 0.663034200668335, 2.6917896270751953, 2.5845654010772705, 2.6140284538269043, 2.252182960510254, 1.8065308332443237, 2.3919644355773926, 1.35172438621521, 2.945737361907959, 2.3846592903137207, 4.101874351501465, 0.4126091003417969, 2.3900928497314453, 3.9341416358947754, 4.602283477783203, 3.390655994415283, 1.669950008392334, 1.3738940954208374, 1.6784045696258545, 3.358427047729492, 0.106645867228508, 1.7336968183517456, 2.6026318073272705, 6.43702507019043, 2.5118846893310547, 4.217405319213867, 3.9549143314361572, 1.8366951942443848, 2.1224007606506348, 0.08706996589899063, 2.4583680629730225, 2.667259454727173, 0.4409888982772827, 2.895110607147217, 1.6206893920898438, 1.9627115726470947, 1.370928406715393, 3.086988925933838, 3.508608102798462, 1.7844620943069458, 2.888052463531494, 3.4448533058166504, 1.806813359260559, 1.4475597143173218, 1.972808599472046, 1.3311964273452759, 2.880875587463379, 0.10827235877513885, 4.017065048217773, 4.692049026489258, 4.146076202392578, 4.441661834716797, 2.988985776901245, 3.9902000427246094, 3.9567692279815674, 2.3841612339019775, 2.87970232963562, 3.1912155151367188, 1.712838053703308, 1.729975700378418, 1.7700539827346802, 2.305405378341675, 2.22581148147583, 1.8684046268463135, 2.3935232162475586, 4.187130451202393, 4.263586044311523, 2.0822324752807617, 1.9783451557159424, 1.7954258918762207, 3.53897762298584, 4.307392120361328, 3.511441707611084, 1.8052338361740112, 0.7270195484161377, 2.254324436187744, 1.8763420581817627, 1.525343894958496, 1.9212499856948853, 2.5874881744384766], "mean_td_error": 2.4988763332366943, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 2.0, "diff_num_grad_updates_vs_sampler_policy": 1.0}}, "num_env_steps_sampled": 2688, "num_env_steps_trained": 516, "num_agent_steps_sampled": 8064, "num_agent_steps_trained": 516, "last_target_update_ts": 2688, "num_target_updates": 2}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8064, "num_agent_steps_trained": 516, "num_env_steps_sampled": 2688, "num_env_steps_trained": 516, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 955.1306927366436, "num_env_steps_trained_throughput_per_sec": 275.02647179247106, "timesteps_total": 2688, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 8064, "timers": {"training_iteration_time_ms": 1054.022, "sample_time_ms": 666.749, "load_time_ms": 0.311, "load_throughput": 830810.312, "learn_time_ms": 29.062, "learn_throughput": 8877.708, "synch_weights_time_ms": 9.653}, "counters": {"num_env_steps_sampled": 2688, "num_env_steps_trained": 516, "num_agent_steps_sampled": 8064, "num_agent_steps_trained": 516, "last_target_update_ts": 2688, "num_target_updates": 2}, "done": false, "episodes_total": 0, "training_iteration": 2, "trial_id": "7c290_00000", "date": "2023-11-18_19-55-43", "timestamp": 1700366143, "time_this_iter_s": 1.8851561546325684, "time_total_s": 3.1735281944274902, "pid": 1618, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x312a479c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 3.1735281944274902, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 61.23333333333333, "ram_util_percent": 64.43333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.098011016845703, "actor_loss": -4.1202473640441895, "critic_loss": 3.834744453430176, "alpha_loss": -0.006059007719159126, "alpha_value": 0.9994001388549805, "log_alpha_value": -0.0006000199355185032, "target_entropy": -6.0, "policy_t": 0.021747244521975517, "mean_q": 0.029923871159553528, "max_q": 0.2414878010749817, "min_q": 0.021261433139443398}, "td_error": [6.110295295715332, 3.1036720275878906, 4.61331844329834, 4.496220588684082, 3.3018136024475098, 6.804548263549805, 3.9878549575805664, 3.6845664978027344, 2.9129905700683594, 2.9761276245117188, 6.4827470779418945, 5.051930904388428, 4.7842912673950195, 3.869858741760254, 2.6640548706054688, 4.578341484069824, 3.969362497329712, 3.2201600074768066, 3.3204269409179688, 3.957066059112549, 4.023824691772461, 3.9221034049987793, 1.6718757152557373, 4.645261764526367, 6.34999418258667, 6.8990583419799805, 5.872414588928223, 4.366386413574219, 4.892177581787109, 5.240420341491699, 5.597461700439453, 2.3203227519989014, 5.835731506347656, 5.277936935424805, 4.876962661743164, 5.587623596191406, 6.2202372550964355, 4.572068691253662, 3.6844358444213867, 4.954859733581543, 3.9251084327697754, 4.473431587219238, 5.758794784545898, 5.02855110168457, 3.7615137100219727, 4.5861430168151855, 4.294528007507324, 2.1079111099243164, 2.719417095184326, 4.708148956298828, 4.740784645080566, 3.230818271636963, 4.287126064300537, 5.345554351806641, 2.863222122192383, 5.96695613861084, 5.99867057800293, 4.232954978942871, 5.465293884277344, 4.078619956970215, 3.9012045860290527, 4.123943328857422, 5.080336570739746, 5.72399377822876, 3.830313205718994, 7.683992862701416, 3.8571105003356934, 3.6859230995178223, 4.418670654296875, 4.120545387268066, 2.9422855377197266, 4.831813812255859, 5.888198375701904, 4.298200607299805, 4.603094100952148, 4.805492401123047, 5.13356876373291, 4.309472560882568, 5.318878173828125, 5.05827522277832, 3.307461738586426, 4.589090347290039, 4.582379341125488, 3.708397388458252, 4.477100372314453, 2.124457359313965], "mean_td_error": 4.473006725311279, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 3.0, "diff_num_grad_updates_vs_sampler_policy": 2.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.090616226196289, "actor_loss": -4.113644599914551, "critic_loss": 1.2136740684509277, "alpha_loss": -0.006055067293345928, "alpha_value": 0.9994001388549805, "log_alpha_value": -0.000600069179199636, "target_entropy": -6.0, "policy_t": -0.029746539890766144, "mean_q": 0.030178500339388847, "max_q": 0.2574998140335083, "min_q": 0.020984677597880363}, "td_error": [2.396216630935669, 1.9713356494903564, 3.077610492706299, 0.8170027732849121, 2.5741751194000244, 3.755713701248169, 3.45005464553833, 2.2891182899475098, 2.398702621459961, 2.0983338356018066, 2.9270591735839844, 4.266872882843018, 1.777510166168213, 1.3131740093231201, 1.221555471420288, 3.5192348957061768, 4.741775989532471, 2.157186508178711, 2.5641939640045166, 3.1905627250671387, 3.400266170501709, 5.251786231994629, 2.7092056274414062, 1.2763118743896484, 2.745659112930298, 0.764151930809021, 2.0544240474700928, 3.5155091285705566, 3.502175807952881, 1.4503438472747803, 3.140230178833008, 3.7021374702453613, 2.1287360191345215, 2.603973388671875, 2.5155582427978516, 3.570688486099243, 2.5310306549072266, 2.2801315784454346, 2.6352975368499756, 2.576335906982422, 2.588043689727783, 3.885161876678467, 4.601978778839111, 0.9245569705963135, 1.3592679500579834, 3.2902584075927734, 2.240063428878784, 4.102468967437744, 0.3466360569000244, 1.4914888143539429, 3.0633790493011475, 2.17734956741333, 3.2709264755249023, 1.9602771997451782, 2.3710618019104004, 3.3122684955596924, 2.685636520385742, 4.758477687835693, 2.6651358604431152, 2.7920992374420166, 2.6836631298065186, 3.335508346557617, 2.5921027660369873, 4.128118515014648, 3.623037815093994, 2.7139620780944824, 3.2445120811462402, 3.336153507232666, 1.6209568977355957, 3.2004971504211426, 3.851337432861328, 4.610185623168945, 3.7586169242858887, 3.6777212619781494, 3.6468963623046875, 3.1501989364624023, 2.6890645027160645, 3.135087490081787, 4.861384391784668, 1.9760609865188599, 4.08504581451416, 3.7877607345581055, 2.9222772121429443, 3.821962356567383, 1.9373054504394531, 3.0495996475219727], "mean_td_error": 2.862638473510742, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 3.0, "diff_num_grad_updates_vs_sampler_policy": 2.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.997686386108398, "actor_loss": -4.0164995193481445, "critic_loss": 1.232647180557251, "alpha_loss": -0.005997677333652973, "alpha_value": 0.99940025806427, "log_alpha_value": -0.0005999064887873828, "target_entropy": -6.0, "policy_t": 0.010031566955149174, "mean_q": 0.035140905529260635, "max_q": 0.3313869535923004, "min_q": 0.019425801932811737}, "td_error": [3.578861713409424, 2.2804317474365234, 4.843094825744629, 3.1319761276245117, 2.5123047828674316, 2.419170379638672, 3.7205777168273926, 2.160937786102295, 2.1690473556518555, 3.3628692626953125, 2.5523130893707275, 3.6769843101501465, 2.564258575439453, 2.140742063522339, 2.7604784965515137, 1.3674769401550293, 3.8129162788391113, 1.7986737489700317, 2.547919750213623, 2.312183380126953, 0.383380651473999, 2.987558364868164, 0.7932651042938232, 1.2487683296203613, 4.758209228515625, 2.2941436767578125, 2.6951425075531006, 2.280076265335083, 3.1465930938720703, 2.977027654647827, 0.22062546014785767, 2.3487234115600586, 4.112170696258545, 3.952022075653076, 2.764671802520752, 3.837925910949707, 2.5650713443756104, 3.7980785369873047, 2.8495230674743652, 2.3729257583618164, 4.104117393493652, 3.7193284034729004, 2.3349974155426025, 2.804870128631592, 2.624622344970703, 2.669797420501709, 4.450349807739258, 2.792868137359619, 2.247724771499634, 2.9519920349121094, 1.7998580932617188, 2.27695369720459, 2.6186609268188477, 2.7760472297668457, 2.4908270835876465, 3.0936779975891113, 3.6631429195404053, 2.072864294052124, 0.6042749881744385, 4.176173210144043, 2.181485891342163, 2.9388527870178223, 0.278090238571167, 2.523566246032715, 0.8626103401184082, 1.3890447616577148, 2.750541925430298, 2.462289810180664, 1.4647374153137207, 2.4424400329589844, 4.489680290222168, 3.3679137229919434, 2.5932788848876953, 2.835684299468994, 4.344413757324219, 3.578031063079834, 2.917862892150879, 3.175595283508301, 2.2029857635498047, 2.51815128326416, 3.0147485733032227, 2.9676380157470703, 3.126607894897461, 4.209831237792969, 2.4791722297668457, 3.639568328857422], "mean_td_error": 2.7340362071990967, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 3.0, "diff_num_grad_updates_vs_sampler_policy": 2.0}}, "num_env_steps_sampled": 3584, "num_env_steps_trained": 774, "num_agent_steps_sampled": 10752, "num_agent_steps_trained": 774, "last_target_update_ts": 3584, "num_target_updates": 3}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10752, "num_agent_steps_trained": 774, "num_env_steps_sampled": 3584, "num_env_steps_trained": 774, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 809.7738323923204, "num_env_steps_trained_throughput_per_sec": 233.17148298796727, "timesteps_total": 3584, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 10752, "timers": {"training_iteration_time_ms": 1067.13, "sample_time_ms": 675.843, "load_time_ms": 0.318, "load_throughput": 812206.979, "learn_time_ms": 25.465, "learn_throughput": 10131.39, "synch_weights_time_ms": 9.471}, "counters": {"num_env_steps_sampled": 3584, "num_env_steps_trained": 774, "num_agent_steps_sampled": 10752, "num_agent_steps_trained": 774, "last_target_update_ts": 3584, "num_target_updates": 3}, "done": false, "episodes_total": 0, "training_iteration": 3, "trial_id": "7c290_00000", "date": "2023-11-18_19-55-44", "timestamp": 1700366144, "time_this_iter_s": 1.1155040264129639, "time_total_s": 4.289032220840454, "pid": 1618, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x312a47a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 4.289032220840454, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 61.300000000000004, "ram_util_percent": 64.55}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.062638282775879, "actor_loss": -4.112086772918701, "critic_loss": 3.771942138671875, "alpha_loss": -0.01207698229700327, "alpha_value": 0.99880051612854, "log_alpha_value": -0.0012001806171610951, "target_entropy": -6.0, "policy_t": -0.023400716483592987, "mean_q": 0.06695754826068878, "max_q": 0.6448481678962708, "min_q": 0.04409973695874214}, "td_error": [3.457308292388916, 4.785455226898193, 3.127554178237915, 3.561011791229248, 5.744950294494629, 3.6591436862945557, 6.776347637176514, 5.0703511238098145, 5.061318397521973, 5.008038520812988, 6.055480003356934, 6.466103553771973, 5.2781982421875, 5.10300874710083, 5.722347259521484, 4.021454811096191, 5.678781032562256, 4.145313262939453, 5.03659725189209, 6.903196811676025, 5.141092300415039, 3.464451789855957, 4.753056526184082, 5.583090305328369, 4.122934818267822, 3.8694400787353516, 2.5549631118774414, 2.9619879722595215, 5.264489650726318, 5.975374221801758, 4.709074020385742, 5.5986504554748535, 3.872347831726074, 3.779512643814087, 4.108879089355469, 4.265700340270996, 3.439152479171753, 5.033400535583496, 3.146430015563965, 6.161375045776367, 5.163214683532715, 2.854342460632324, 4.507889747619629, 3.427304267883301, 4.4217329025268555, 5.045207977294922, 3.2854857444763184, 2.7211360931396484, 3.3230559825897217, 3.733569622039795, 6.755880355834961, 4.765008926391602, 5.11488676071167, 3.603182077407837, 4.575611114501953, 5.439170837402344, 5.928329944610596, 4.543549537658691, 4.358680725097656, 3.0868277549743652, 5.356260776519775, 4.563108444213867, 4.908451080322266, 2.4614996910095215, 5.11473274230957, 4.3201904296875, 4.427990913391113, 4.1337738037109375, 6.589068412780762, 4.8897199630737305, 3.709913969039917, 5.517999649047852, 4.884540557861328, 4.061684608459473, 4.805403232574463, 3.0903286933898926, 3.70755934715271, 5.344590187072754, 2.9222607612609863, 3.0161561965942383, 4.230897903442383, 4.964704513549805, 3.250070095062256, 5.33036470413208, 6.686515808105469, 4.096466541290283], "mean_td_error": 4.552391529083252, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 5.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.076627731323242, "actor_loss": -4.124015808105469, "critic_loss": 1.1133983135223389, "alpha_loss": -0.012094100937247276, "alpha_value": 0.99880051612854, "log_alpha_value": -0.0012002130970358849, "target_entropy": -6.0, "policy_t": -0.031459469348192215, "mean_q": 0.07073483616113663, "max_q": 0.5074281692504883, "min_q": 0.0433570072054863}, "td_error": [3.544694423675537, 3.3688721656799316, 4.357388496398926, 0.8930044174194336, 2.9792208671569824, 1.0199964046478271, 1.2208080291748047, 2.1859073638916016, 3.10976505279541, 2.5922179222106934, 3.0662593841552734, 3.2588765621185303, 2.0053648948669434, 2.181502103805542, 3.5218844413757324, 0.35440370440483093, 2.663597583770752, 6.299907207489014, 2.5443873405456543, 3.4743380546569824, 3.601428508758545, 2.19260311126709, 2.157243013381958, 0.4716285467147827, 4.012848854064941, 1.7163267135620117, 2.1497089862823486, 1.294952392578125, 2.3403944969177246, 3.2274069786071777, 2.3584556579589844, 3.8636133670806885, 0.9297038912773132, 4.2598419189453125, 2.4992876052856445, 1.1016504764556885, 2.8627171516418457, 5.311792850494385, 3.0621111392974854, 2.7836050987243652, 0.6761441230773926, 1.8443610668182373, 2.268050193786621, 3.478269577026367, 3.253861904144287, 4.022060394287109, 2.758957862854004, 2.580951690673828, 0.6419109106063843, 2.2314999103546143, 1.1056361198425293, 4.044975280761719, 4.832093715667725, 4.878321647644043, 1.77488374710083, 2.3890323638916016, 0.6583197116851807, 3.43849778175354, 0.8360793590545654, 3.5617566108703613, 2.7003092765808105, 1.1449456214904785, 3.0139663219451904, 3.7261743545532227, 2.955291271209717, 3.0645203590393066, 2.5182530879974365, 2.9153099060058594, 3.137362480163574, 1.8700587749481201, 2.00191068649292, 2.600839138031006, 2.5200750827789307, 2.7167129516601562, 4.155426025390625, 4.016052722930908, 1.7861239910125732, 3.579677104949951, 3.5941667556762695, 0.1043282151222229, 2.377774715423584, 2.365443229675293, 1.2884445190429688, 5.450447082519531, 3.4694862365722656, 2.4376864433288574], "mean_td_error": 2.670071601867676, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 5.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.099863052368164, "actor_loss": -4.138540744781494, "critic_loss": 1.1368361711502075, "alpha_loss": -0.012119591236114502, "alpha_value": 0.9988007545471191, "log_alpha_value": -0.0011999757261946797, "target_entropy": -6.0, "policy_t": -0.006612383294850588, "mean_q": 0.07868984341621399, "max_q": 0.6171585321426392, "min_q": 0.040352482348680496}, "td_error": [2.425300121307373, 1.3935192823410034, 2.646759033203125, 3.9311399459838867, 2.4837143421173096, 2.63431453704834, 1.4228001832962036, 3.065673351287842, 2.063162326812744, 3.0381317138671875, 2.6459569931030273, 3.5026540756225586, 3.0971696376800537, 3.141059398651123, 3.860903263092041, 2.5653398036956787, 2.8679518699645996, 2.9783101081848145, 2.499941349029541, 2.7870092391967773, 1.8543840646743774, 3.843438148498535, 3.786266326904297, 2.9614031314849854, 1.7979013919830322, 1.5689482688903809, 2.337940216064453, 2.5168588161468506, 2.1339964866638184, 2.1979780197143555, 3.136094808578491, 2.751960277557373, 2.6584229469299316, 3.9501566886901855, 2.544353485107422, 3.7408761978149414, 2.121009349822998, 3.921177625656128, 2.325584650039673, 1.4848017692565918, 4.58634614944458, 1.8846142292022705, 2.300424098968506, 1.3828986883163452, 3.4887654781341553, 4.208929538726807, 2.0427660942077637, 2.896650791168213, 2.704949378967285, 2.431713819503784, 1.8851604461669922, 2.3322999477386475, 0.786742091178894, 1.5202189683914185, 2.0845885276794434, 2.490604877471924, 1.8898658752441406, 3.1366586685180664, 2.5681004524230957, 2.1989307403564453, 3.654829502105713, 2.23244571685791, 3.328705310821533, 3.362664222717285, 3.0584559440612793, 2.473605155944824, 1.6008272171020508, 3.3478989601135254, 4.527609825134277, 3.0311155319213867, 3.142373561859131, 2.625763416290283, 0.7028731107711792, 3.1117095947265625, 4.152002334594727, 2.360952138900757, 3.133819341659546, 4.285086631774902, 4.201399803161621, 2.387263774871826, 2.631666898727417, 2.421232223510742, 2.998610496520996, 3.5736498832702637, 3.435182571411133, 1.300706386566162], "mean_td_error": 2.7277679443359375, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 5.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 5376, "num_env_steps_trained": 1290, "num_agent_steps_sampled": 16128, "num_agent_steps_trained": 1290, "last_target_update_ts": 5376, "num_target_updates": 5}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16128, "num_agent_steps_trained": 1290, "num_env_steps_sampled": 5376, "num_env_steps_trained": 1290, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 984.4834879266335, "num_env_steps_trained_throughput_per_sec": 283.47850433601724, "timesteps_total": 5376, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 16128, "timers": {"training_iteration_time_ms": 1014.783, "sample_time_ms": 660.548, "load_time_ms": 0.328, "load_throughput": 786660.68, "learn_time_ms": 23.06, "learn_throughput": 11188.187, "synch_weights_time_ms": 9.299}, "counters": {"num_env_steps_sampled": 5376, "num_env_steps_trained": 1290, "num_agent_steps_sampled": 16128, "num_agent_steps_trained": 1290, "last_target_update_ts": 5376, "num_target_updates": 5}, "done": false, "episodes_total": 0, "training_iteration": 4, "trial_id": "7c290_00000", "date": "2023-11-18_19-55-46", "timestamp": 1700366146, "time_this_iter_s": 1.828819990158081, "time_total_s": 6.117852210998535, "pid": 1618, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x312a46700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 6.117852210998535, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 71.95, "ram_util_percent": 64.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.052953720092773, "actor_loss": -4.130865573883057, "critic_loss": 3.559568166732788, "alpha_loss": -0.018097728490829468, "alpha_value": 0.9982013702392578, "log_alpha_value": -0.0018002400174736977, "target_entropy": -6.0, "policy_t": -0.00842093676328659, "mean_q": 0.16694605350494385, "max_q": 1.139052391052246, "min_q": 0.0699472576379776}, "td_error": [6.850963592529297, 4.064920425415039, 5.193072319030762, 3.910116195678711, 3.8389172554016113, 3.709360122680664, 4.746751308441162, 1.694898247718811, 4.7361602783203125, 4.380619049072266, 3.7615787982940674, 6.233136177062988, 4.354463577270508, 0.27096235752105713, 4.6063947677612305, 3.553532123565674, 5.732227802276611, 4.962762832641602, 4.363897323608398, 3.3131790161132812, 3.7522048950195312, 3.604161500930786, 3.726621389389038, 4.121581554412842, 4.807870864868164, 4.754024982452393, 4.566080570220947, 3.560175895690918, 5.1961894035339355, 3.4579477310180664, 2.581197738647461, 3.520974636077881, 3.1112775802612305, 2.7131667137145996, 2.6104178428649902, 2.867124557495117, 4.901400566101074, 4.322466850280762, 3.364398241043091, 5.343067169189453, 4.725385665893555, 4.184765338897705, 4.411826133728027, 3.087305784225464, 2.0770151615142822, 4.736418724060059, 5.170342922210693, 4.786063194274902, 4.181296348571777, 3.8992271423339844, 3.2304463386535645, 2.8070755004882812, 3.785200834274292, 4.634142875671387, 5.989375114440918, 5.421935081481934, 4.413939476013184, 5.571976661682129, 4.811810493469238, 4.968052864074707, 6.465493202209473, 3.9369325637817383, 4.287558078765869, 4.729048728942871, 4.973958969116211, 3.810741424560547, 6.066893100738525, 4.991429328918457, 5.90757942199707, 6.265584945678711, 5.063526153564453, 6.320062160491943, 3.4623451232910156, 6.668745040893555, 4.933974266052246, 4.395052909851074, 5.495378494262695, 3.3489818572998047, 4.700484275817871, 2.9314746856689453, 3.354041576385498, 4.1853790283203125, 3.4344921112060547, 4.280887603759766, 3.5619924068450928, 6.017358779907227], "mean_td_error": 4.3214335441589355, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 7.0, "diff_num_grad_updates_vs_sampler_policy": 6.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.067249298095703, "actor_loss": -4.1423821449279785, "critic_loss": 1.028714895248413, "alpha_loss": -0.018123121932148933, "alpha_value": 0.9982014298439026, "log_alpha_value": -0.0018002059077844024, "target_entropy": -6.0, "policy_t": -0.03766686096787453, "mean_q": 0.11468195170164108, "max_q": 0.8722183704376221, "min_q": 0.06829363852739334}, "td_error": [5.006278991699219, 1.1297130584716797, 4.1856489181518555, 4.698073387145996, 3.102153778076172, 2.7604291439056396, 3.40077543258667, 2.24434232711792, 2.1320438385009766, 2.2138843536376953, 1.565199851989746, 3.6153926849365234, 0.9718818664550781, 3.340240478515625, 0.7790558338165283, 2.113053321838379, 2.824301242828369, 2.6411893367767334, 3.2039055824279785, 2.907942771911621, 3.984600067138672, 3.793550491333008, 2.680868148803711, 1.4959540367126465, 1.845916986465454, 3.0021214485168457, 3.229278564453125, 1.921475887298584, 3.8541665077209473, 2.493435859680176, 0.2745482325553894, 2.281982898712158, 4.153002738952637, 1.037785291671753, 2.5833842754364014, 2.121410846710205, 3.4589548110961914, 3.381263256072998, 2.149052143096924, 1.4288954734802246, 1.388466238975525, 1.9135937690734863, 2.1914052963256836, 2.361989974975586, 2.5108494758605957, 2.483412742614746, 1.8672088384628296, 2.217658042907715, 3.402350425720215, 0.7111846208572388, 0.9262651205062866, 1.4570956230163574, 3.5623950958251953, 4.594332695007324, 2.8358590602874756, 0.9976378679275513, 4.911269187927246, 2.1853103637695312, 3.329070568084717, 3.4533629417419434, 1.2976247072219849, 3.0296974182128906, 3.8819518089294434, 4.3196001052856445, 2.392962694168091, 0.577358603477478, 2.804476261138916, 2.8715016841888428, 2.050536632537842, 0.37785640358924866, 3.2698535919189453, 3.446139335632324, 2.263547420501709, 1.1066224575042725, 5.549034118652344, 0.5463354587554932, 2.3562586307525635, 3.0692801475524902, 1.5909513235092163, 1.327932357788086, 3.0550365447998047, 2.826753616333008, 3.2982285022735596, 0.40255939960479736, 2.8718667030334473, 3.1943562030792236], "mean_td_error": 2.547513723373413, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 7.0, "diff_num_grad_updates_vs_sampler_policy": 6.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.173730850219727, "actor_loss": -4.233371257781982, "critic_loss": 1.0583142042160034, "alpha_loss": -0.01831762306392193, "alpha_value": 0.9982011318206787, "log_alpha_value": -0.0018004825105890632, "target_entropy": -6.0, "policy_t": -0.02481847070157528, "mean_q": 0.11849258095026016, "max_q": 1.067955493927002, "min_q": 0.06419223546981812}, "td_error": [2.8437366485595703, 1.7751706838607788, 3.585721015930176, 4.271219730377197, 2.5590267181396484, 1.3799302577972412, 0.2233428657054901, 1.5945074558258057, 3.9634616374969482, 2.6724190711975098, 2.984703540802002, 3.305295467376709, 1.6975488662719727, 1.763465404510498, 3.858477830886841, 2.426971912384033, 2.079827308654785, 2.486758232116699, 1.933624267578125, 3.6193978786468506, 1.6270372867584229, 1.4756664037704468, 1.329288363456726, 1.627768874168396, 2.7602593898773193, 4.239367485046387, 1.6929072141647339, 2.4267611503601074, 2.153002977371216, 2.084691047668457, 2.1402857303619385, 1.8695926666259766, 3.100653648376465, 2.7373738288879395, 1.5966272354125977, 2.0863327980041504, 3.0713796615600586, 2.4986939430236816, 3.9399287700653076, 1.2288151979446411, 3.466278076171875, 3.1213345527648926, 4.809700965881348, 0.6377403736114502, 2.851604700088501, 2.776254653930664, 1.1339149475097656, 4.4945831298828125, 2.055424213409424, 2.722109794616699, 0.585692822933197, 2.3667893409729004, 1.280411958694458, 3.058638095855713, 3.711582660675049, 3.5083837509155273, 0.23154613375663757, 2.823859930038452, 4.424348831176758, 2.7510554790496826, 2.1503472328186035, 3.5192246437072754, 4.634355545043945, 3.5427584648132324, 0.27244555950164795, 3.170300006866455, 3.034855365753174, 2.9863908290863037, 4.886157989501953, 2.3732104301452637, 4.693381309509277, 1.3453235626220703, 2.386791229248047, 2.4634194374084473, 0.8698968887329102, 1.9255454540252686, 1.8669270277023315, 1.1738994121551514, 1.3426682949066162, 3.2983574867248535, 1.6679277420043945, 3.053762674331665, 3.039396286010742, 3.3669686317443848, 3.4685792922973633, 2.56172251701355], "mean_td_error": 2.5420572757720947, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 7.0, "diff_num_grad_updates_vs_sampler_policy": 6.0}}, "num_env_steps_sampled": 7168, "num_env_steps_trained": 1806, "num_agent_steps_sampled": 21504, "num_agent_steps_trained": 1806, "last_target_update_ts": 7168, "num_target_updates": 7}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 21504, "num_agent_steps_trained": 1806, "num_env_steps_sampled": 7168, "num_env_steps_trained": 1806, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 938.7984048330641, "num_env_steps_trained_throughput_per_sec": 270.32364782023495, "timesteps_total": 7168, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 21504, "timers": {"training_iteration_time_ms": 999.684, "sample_time_ms": 665.428, "load_time_ms": 0.326, "load_throughput": 791444.261, "learn_time_ms": 21.642, "learn_throughput": 11920.999, "synch_weights_time_ms": 9.38}, "counters": {"num_env_steps_sampled": 7168, "num_env_steps_trained": 1806, "num_agent_steps_sampled": 21504, "num_agent_steps_trained": 1806, "last_target_update_ts": 7168, "num_target_updates": 7}, "done": false, "episodes_total": 0, "training_iteration": 5, "trial_id": "7c290_00000", "date": "2023-11-18_19-55-48", "timestamp": 1700366148, "time_this_iter_s": 1.9186389446258545, "time_total_s": 8.03649115562439, "pid": 1618, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x312a45c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 8.03649115562439, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 71.60000000000001, "ram_util_percent": 64.53333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.051901817321777, "actor_loss": -4.163967609405518, "critic_loss": 2.6687755584716797, "alpha_loss": -0.024126296862959862, "alpha_value": 0.9976027011871338, "log_alpha_value": -0.002400172408670187, "target_entropy": -6.0, "policy_t": -0.021250033751130104, "mean_q": 0.17136111855506897, "max_q": 1.4790503978729248, "min_q": 0.10032407194375992}, "td_error": [5.093412399291992, 5.7379984855651855, 3.6078763008117676, 3.5170040130615234, 5.323026657104492, 3.477560520172119, 2.928891658782959, 4.609752655029297, 4.693600654602051, 5.568284034729004, 2.5370543003082275, 4.650998115539551, 6.6195526123046875, 3.141878604888916, 3.9942052364349365, 2.334855318069458, 3.879002332687378, 3.5793979167938232, 4.182272911071777, 5.805241584777832, 5.268923759460449, 4.5588884353637695, 5.453808784484863, 2.8265762329101562, 3.608707904815674, 5.594476699829102, 4.779304504394531, 1.7633388042449951, 6.9857940673828125, 4.278120517730713, 4.101667404174805, 4.090756416320801, 7.535273551940918, 5.0827436447143555, 6.336472988128662, 7.421480178833008, 3.702770471572876, 2.9936089515686035, 2.729565143585205, 4.710611343383789, 3.808497190475464, 5.597170829772949, 5.490001678466797, 4.391284942626953, 4.513702869415283, 5.941494941711426, 6.551143169403076, 2.2127628326416016, 6.059234619140625, 4.389439582824707, 4.98221492767334, 1.4024332761764526, 4.476784706115723, 6.31517219543457, 4.227339744567871, 4.909472942352295, 5.454532623291016, 5.466952323913574, 3.098385810852051, 2.6670401096343994, 4.2363505363464355, 5.408574104309082, 5.097782135009766, 4.942966461181641, 2.593461275100708, 4.278487205505371, 5.327601909637451, 1.4802536964416504, 4.159257411956787, 4.169084548950195, 2.5052876472473145, 4.561009407043457, 4.54350471496582, 4.773015022277832, 2.087998867034912, 4.100368499755859, 6.37827730178833, 2.1788010597229004, 5.282904624938965, 3.054266929626465, 2.0328402519226074, 3.1003739833831787, 6.287507057189941, 4.093995571136475, 4.382876396179199, 4.26260232925415], "mean_td_error": 4.376502990722656, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 9.0, "diff_num_grad_updates_vs_sampler_policy": 8.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.041634559631348, "actor_loss": -4.146752834320068, "critic_loss": 1.0798134803771973, "alpha_loss": -0.024100463837385178, "alpha_value": 0.9976028203964233, "log_alpha_value": -0.002400053897872567, "target_entropy": -6.0, "policy_t": 0.010761740617454052, "mean_q": 0.1785912811756134, "max_q": 1.225600242614746, "min_q": 0.09706714749336243}, "td_error": [3.435319423675537, 4.0838518142700195, 1.0376662015914917, 6.092421531677246, 3.5416100025177, 1.9736807346343994, 3.0304393768310547, 3.633302688598633, 5.117448806762695, 2.2898430824279785, 3.996340036392212, 4.108960151672363, 3.936192750930786, 5.573624610900879, 1.6318175792694092, 1.4987637996673584, 4.282289028167725, 3.305844306945801, 4.1841206550598145, 3.027496337890625, 2.0192625522613525, 3.0658600330352783, 3.3755979537963867, 2.889021396636963, 1.968261480331421, 3.8256096839904785, 1.778325080871582, 4.340457916259766, 1.90557861328125, 1.6921495199203491, 1.724448800086975, 1.6679420471191406, 3.273611307144165, 1.9727470874786377, 1.4782017469406128, 2.8822999000549316, 2.8615610599517822, 3.125170946121216, 1.6966447830200195, 2.398317337036133, 3.2629318237304688, 1.6685619354248047, 1.7478798627853394, 3.013888359069824, 3.0098164081573486, 2.741537570953369, 1.7564448118209839, 3.2001571655273438, 2.454700469970703, 2.954594373703003, 2.5321314334869385, 1.2113920450210571, 2.5798890590667725, 3.4844536781311035, 4.443880081176758, 0.5322690010070801, 3.127565860748291, 2.0610861778259277, 2.961113691329956, 3.489720344543457, 0.2401750087738037, 0.1346105933189392, 1.6247395277023315, 2.333649158477783, 2.4287734031677246, 1.560807704925537, 2.297031879425049, 2.4311184883117676, 2.190845012664795, 2.6220524311065674, 0.7862994074821472, 2.8376283645629883, 0.7106338143348694, 1.4813604354858398, 4.309430122375488, 4.2388691902160645, 1.2521491050720215, 4.620681285858154, 1.4017877578735352, 2.297852039337158, 0.7153286933898926, 1.5264604091644287, 2.313556432723999, 4.605613708496094, 1.8764711618423462, 3.645819664001465], "mean_td_error": 2.656277656555176, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 9.0, "diff_num_grad_updates_vs_sampler_policy": 8.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.143983840942383, "actor_loss": -4.2308807373046875, "critic_loss": 1.0258123874664307, "alpha_loss": -0.024360572919249535, "alpha_value": 0.9976013898849487, "log_alpha_value": -0.002401479985564947, "target_entropy": -6.0, "policy_t": -0.030836500227451324, "mean_q": 0.19442273676395416, "max_q": 1.5053627490997314, "min_q": 0.09167911112308502}, "td_error": [2.2970685958862305, 3.9158782958984375, 3.977107524871826, 0.8773651719093323, 2.818690776824951, 1.2720822095870972, 1.6989383697509766, 3.217564582824707, 1.4092659950256348, 1.535233974456787, 1.1291453838348389, 2.464435577392578, 3.3343660831451416, 1.2436721324920654, 1.5900709629058838, 3.0914931297302246, 3.7824606895446777, 4.2819671630859375, 0.04861348867416382, 3.5253043174743652, 2.3471553325653076, 3.1150875091552734, 2.266150712966919, 1.8471639156341553, 4.28853702545166, 3.333164691925049, 4.115020751953125, 0.6561803817749023, 3.1259098052978516, 1.8581233024597168, 2.041487216949463, 2.509495735168457, 4.2572174072265625, 2.97171950340271, 3.811830759048462, 2.173888921737671, 3.3205370903015137, 2.670006036758423, 2.468534469604492, 2.7354817390441895, 2.6946847438812256, 2.7521653175354004, 1.4579970836639404, 3.070263385772705, 3.6018364429473877, 1.9228109121322632, 3.5606701374053955, 1.408273696899414, 2.744370222091675, 3.4395456314086914, 4.5052714347839355, 0.7371866703033447, 2.4114317893981934, 3.8687994480133057, 2.232156753540039, 3.8293561935424805, 1.518306016921997, 1.5484294891357422, 3.25350284576416, 3.482485294342041, 0.5867787003517151, 1.0773959159851074, 3.135770797729492, 1.2468538284301758, 0.36363881826400757, 1.0747194290161133, 3.7943406105041504, 2.6804580688476562, 4.238770484924316, 2.479362964630127, 2.435410976409912, 2.3555808067321777, 2.0312676429748535, 3.0103464126586914, 2.4787168502807617, 2.431037425994873, 2.8752858638763428, 1.2435121536254883, 1.456423282623291, 2.859546661376953, 1.082202672958374, 2.170247793197632, 3.050825595855713, 3.4071903228759766, 2.5921597480773926, 0.9603825807571411], "mean_td_error": 2.4951300621032715, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 9.0, "diff_num_grad_updates_vs_sampler_policy": 8.0}}, "num_env_steps_sampled": 8960, "num_env_steps_trained": 2322, "num_agent_steps_sampled": 26880, "num_agent_steps_trained": 2322, "last_target_update_ts": 8960, "num_target_updates": 9}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 26880, "num_agent_steps_trained": 2322, "num_env_steps_sampled": 8960, "num_env_steps_trained": 2322, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 883.5777218104085, "num_env_steps_trained_throughput_per_sec": 254.4230493605864, "timesteps_total": 8960, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 26880, "timers": {"training_iteration_time_ms": 1002.554, "sample_time_ms": 665.515, "load_time_ms": 0.322, "load_throughput": 800458.115, "learn_time_ms": 20.941, "learn_throughput": 12320.364, "synch_weights_time_ms": 9.287}, "counters": {"num_env_steps_sampled": 8960, "num_env_steps_trained": 2322, "num_agent_steps_sampled": 26880, "num_agent_steps_trained": 2322, "last_target_update_ts": 8960, "num_target_updates": 9}, "done": false, "episodes_total": 0, "training_iteration": 6, "trial_id": "7c290_00000", "date": "2023-11-18_19-55-50", "timestamp": 1700366150, "time_this_iter_s": 2.036479949951172, "time_total_s": 10.072971105575562, "pid": 1618, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x312a47a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 10.072971105575562, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 63.4, "ram_util_percent": 64.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.072164535522461, "actor_loss": -4.222479343414307, "critic_loss": 2.6486196517944336, "alpha_loss": -0.030217625200748444, "alpha_value": 0.9970043897628784, "log_alpha_value": -0.003000112483277917, "target_entropy": -6.0, "policy_t": 0.001197189325466752, "mean_q": 0.21710637211799622, "max_q": 2.1753716468811035, "min_q": 0.13550786674022675}, "td_error": [5.690239429473877, 6.0576019287109375, 5.122793197631836, 5.445256233215332, 7.565977096557617, 3.8771567344665527, 5.163881301879883, 3.808979034423828, 3.897221565246582, 3.4619574546813965, 4.047087669372559, 2.227416515350342, 2.6170668601989746, 4.6955389976501465, 4.03536319732666, 3.3953139781951904, 3.66758394241333, 2.85221529006958, 4.3997111320495605, 4.231289863586426, 3.6062726974487305, 4.909845352172852, 5.260138511657715, 4.270660877227783, 4.786125183105469, 3.368227005004883, 3.0493273735046387, 2.4196877479553223, 5.451794147491455, 3.7999091148376465, 3.636353015899658, 3.0222368240356445, 5.4030680656433105, 4.4405975341796875, 5.586118698120117, 4.442880630493164, 3.834744930267334, 3.754239559173584, 5.565296173095703, 2.4333317279815674, 3.0864901542663574, 3.363987922668457, 4.352688789367676, 4.976347923278809, 3.13519024848938, 3.7179114818573, 5.369781017303467, 4.485124588012695, 7.018827438354492, 5.8036088943481445, 3.050584316253662, 4.633064270019531, 5.866450786590576, 4.388123512268066, 2.734487533569336, 2.2974889278411865, 5.43385648727417, 3.632086753845215, 4.080049514770508, 3.602585792541504, 4.93476676940918, 4.074942588806152, 3.717090606689453, 3.3620893955230713, 3.8843555450439453, 5.643176078796387, 4.2350568771362305, 4.364228248596191, 2.7760839462280273, 4.619513511657715, 3.665428638458252, 3.869189739227295, 4.564295768737793, 4.598663806915283, 5.538055419921875, 3.5938119888305664, 4.386846542358398, 5.444304466247559, 2.9596304893493652, 4.662713050842285, 4.214358329772949, 3.8053500652313232, 4.403703689575195, 6.6183576583862305, 2.019883155822754, 5.192840576171875], "mean_td_error": 4.249743938446045, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 11.0, "diff_num_grad_updates_vs_sampler_policy": 10.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.162134170532227, "actor_loss": -4.301491737365723, "critic_loss": 0.9946334362030029, "alpha_loss": -0.03048509731888771, "alpha_value": 0.9970046281814575, "log_alpha_value": -0.002999871736392379, "target_entropy": -6.0, "policy_t": 0.002975193550810218, "mean_q": 0.23003342747688293, "max_q": 1.5108530521392822, "min_q": 0.13095851242542267}, "td_error": [4.671607494354248, 2.7383198738098145, 1.0969030857086182, 1.990748405456543, 2.2574214935302734, 3.224785566329956, 2.8710145950317383, 1.6114575862884521, 0.6871867179870605, 2.9937400817871094, 1.6834356784820557, 0.5805573463439941, 3.129887104034424, 3.165832042694092, 1.1361393928527832, 2.2565550804138184, 5.13372278213501, 0.9073007702827454, 1.75864577293396, 2.072540044784546, 2.4295361042022705, 4.488568305969238, 2.899076461791992, 1.656571388244629, 3.1572442054748535, 2.7015538215637207, 3.2797200679779053, 3.0472512245178223, 2.2296042442321777, 4.130830764770508, 3.832258462905884, 2.183406114578247, 4.077310562133789, 3.2007737159729004, 0.771415114402771, 3.207963466644287, 2.996046543121338, 2.7680935859680176, 1.8082679510116577, 1.9923574924468994, 2.0199825763702393, 2.529432773590088, 0.7624378204345703, 4.103165626525879, 2.550931692123413, 2.5478973388671875, 2.0843210220336914, 2.763889789581299, 2.4060373306274414, 4.896574020385742, 2.9225897789001465, 2.6033194065093994, 2.4162497520446777, 4.043179512023926, 0.7116131782531738, 5.95623779296875, 1.0042566061019897, 3.811596155166626, 2.9495162963867188, 1.9247331619262695, 3.5948948860168457, 2.6350831985473633, 2.4835171699523926, 1.8425768613815308, 2.3185577392578125, 3.4592108726501465, 4.857068061828613, 3.0414328575134277, 0.4247627258300781, 2.9263834953308105, 1.2135627269744873, 2.539832830429077, 3.225513219833374, 3.0478224754333496, 3.5691723823547363, 3.9207916259765625, 2.60616397857666, 0.7562529444694519, 3.119338035583496, 3.450108051300049, 2.1011276245117188, 1.559903621673584, 3.186978578567505, 1.7610890865325928, 3.7595438957214355, 3.7047441005706787], "mean_td_error": 2.662081718444824, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 11.0, "diff_num_grad_updates_vs_sampler_policy": 10.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.098052978515625, "actor_loss": -4.2167887687683105, "critic_loss": 0.9484992027282715, "alpha_loss": -0.030320776626467705, "alpha_value": 0.9970018863677979, "log_alpha_value": -0.003002636134624481, "target_entropy": -6.0, "policy_t": -0.04455713927745819, "mean_q": 0.2086326628923416, "max_q": 1.6641862392425537, "min_q": 0.12377804517745972}, "td_error": [2.239133358001709, 1.7571831941604614, 2.6899631023406982, 2.045337677001953, 3.133636474609375, 5.0113019943237305, 2.9940924644470215, 2.162048816680908, 1.5550541877746582, 3.198941946029663, 0.7416551113128662, 2.027900218963623, 1.4118233919143677, 1.9654035568237305, 2.8981728553771973, 3.706087112426758, 2.609100341796875, 2.8562960624694824, 2.5913803577423096, 3.505685806274414, 2.153508186340332, 1.6291457414627075, 2.710744857788086, 3.4052324295043945, 2.244272232055664, 1.8022663593292236, 1.1383109092712402, 4.045780181884766, 1.336111307144165, 0.38060981035232544, 1.2744426727294922, 2.6744368076324463, 0.6463077664375305, 1.9690876007080078, 4.187416076660156, 2.2643117904663086, 1.7239346504211426, 0.7341091632843018, 3.0438756942749023, 1.5867679119110107, 3.3003461360931396, 2.545783519744873, 1.7591538429260254, 3.433218002319336, 2.618055820465088, 1.87281334400177, 1.7326850891113281, 1.6482374668121338, 1.7802479267120361, 3.4787259101867676, 3.2554564476013184, 2.224285364151001, 2.1273105144500732, 3.248119831085205, 2.8275997638702393, 1.8028643131256104, 1.9375860691070557, 4.0092902183532715, 1.060270071029663, 3.022728443145752, 3.9487955570220947, 4.127416610717773, 4.12990665435791, 2.366607666015625, 3.059596538543701, 2.9937667846679688, 3.377371311187744, 3.7665185928344727, 2.5592164993286133, 1.3820343017578125, 3.992250442504883, 1.9136854410171509, 4.253783226013184, 1.772320032119751, 3.2006263732910156, 2.270359754562378, 1.7511992454528809, 2.5817770957946777, 3.1779747009277344, 4.684602737426758, 2.936398506164551, 1.8916264772415161, 2.321249485015869, 2.5553739070892334, 1.215549111366272, 3.1380720138549805], "mean_td_error": 2.5244622230529785, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 11.0, "diff_num_grad_updates_vs_sampler_policy": 10.0}}, "num_env_steps_sampled": 10752, "num_env_steps_trained": 2838, "num_agent_steps_sampled": 32256, "num_agent_steps_trained": 2838, "last_target_update_ts": 10752, "num_target_updates": 11}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32256, "num_agent_steps_trained": 2838, "num_env_steps_sampled": 10752, "num_env_steps_trained": 2838, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 962.2364854432818, "num_env_steps_trained_throughput_per_sec": 277.07255942451644, "timesteps_total": 10752, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 32256, "timers": {"training_iteration_time_ms": 970.188, "sample_time_ms": 667.062, "load_time_ms": 0.323, "load_throughput": 798266.769, "learn_time_ms": 18.529, "learn_throughput": 13924.327, "synch_weights_time_ms": 9.387}, "counters": {"num_env_steps_sampled": 10752, "num_env_steps_trained": 2838, "num_agent_steps_sampled": 32256, "num_agent_steps_trained": 2838, "last_target_update_ts": 10752, "num_target_updates": 11}, "done": false, "episodes_total": 0, "training_iteration": 7, "trial_id": "7c290_00000", "date": "2023-11-18_19-55-52", "timestamp": 1700366152, "time_this_iter_s": 1.8722097873687744, "time_total_s": 11.945180892944336, "pid": 1618, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x312a463e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 11.945180892944336, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 67.1, "ram_util_percent": 64.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.098886489868164, "actor_loss": -4.2972564697265625, "critic_loss": 2.537306070327759, "alpha_loss": -0.03635874018073082, "alpha_value": 0.9964061975479126, "log_alpha_value": -0.0036002725828438997, "target_entropy": -6.0, "policy_t": -0.033698756247758865, "mean_q": 0.26140162348747253, "max_q": 2.5653023719787598, "min_q": 0.1762191355228424}, "td_error": [3.9318337440490723, 5.197933673858643, 5.958271026611328, 3.097879648208618, 4.7292680740356445, 3.1983938217163086, 3.704102039337158, 3.502871036529541, 3.5756521224975586, 6.701143741607666, 5.683381080627441, 5.047921180725098, 4.120543479919434, 3.9473938941955566, 4.912033557891846, 5.221199989318848, 3.5330076217651367, 3.4806811809539795, 3.0987906455993652, 3.3534395694732666, 3.3167977333068848, 5.01932430267334, 4.191178321838379, 3.210296869277954, 3.76189923286438, 5.318605422973633, 3.2619495391845703, 5.408310413360596, 3.1336629390716553, 4.865643501281738, 3.3962392807006836, 2.9807276725769043, 3.7973098754882812, 5.295232772827148, 2.110030174255371, 3.5769925117492676, 2.8837437629699707, 2.0827479362487793, 5.233257293701172, 3.17303466796875, 4.721779823303223, 3.462238073348999, 4.2925872802734375, 5.031818389892578, 5.318127632141113, 4.099330425262451, 2.193924903869629, 4.871482849121094, 4.986649990081787, 3.6391634941101074, 3.8706045150756836, 4.114311218261719, 4.802752494812012, 2.096102237701416, 5.818787574768066, 4.534505367279053, 3.818056106567383, 4.47953987121582, 3.8269529342651367, 6.5131683349609375, 4.366379737854004, 2.508538246154785, 3.2695765495300293, 4.399579048156738, 5.5590620040893555, 5.247411251068115, 3.7192606925964355, 3.961430072784424, 3.5435776710510254, 5.202647686004639, 4.405970573425293, 4.193471908569336, 3.5954909324645996, 3.9017467498779297, 4.647590637207031, 4.53997278213501, 4.363710403442383, 5.1991682052612305, 1.3339424133300781, 4.893629550933838, 2.649172067642212, 3.251596450805664, 4.244991779327393, 4.386323928833008, 5.250683784484863, 4.767074108123779], "mean_td_error": 4.138449192047119, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 13.0, "diff_num_grad_updates_vs_sampler_policy": 12.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.075048446655273, "actor_loss": -4.25985050201416, "critic_loss": 1.036492109298706, "alpha_loss": -0.036271099001169205, "alpha_value": 0.9964063763618469, "log_alpha_value": -0.0036000916734337807, "target_entropy": -6.0, "policy_t": -0.03055393695831299, "mean_q": 0.23529188334941864, "max_q": 1.9768949747085571, "min_q": 0.17072978615760803}, "td_error": [2.6511893272399902, 4.189245223999023, 2.9505467414855957, 1.9785984754562378, 4.3838396072387695, 2.7124528884887695, 2.060206890106201, 3.653080940246582, 3.657808542251587, 3.0650978088378906, 2.5884881019592285, 0.3206464648246765, 0.13204818964004517, 3.6361117362976074, 3.1444737911224365, 2.714144706726074, 2.2137935161590576, 2.98077130317688, 1.5181353092193604, 3.150183916091919, 1.3599302768707275, 3.192840576171875, 1.8706343173980713, 1.8013249635696411, 3.360382080078125, 0.7436895966529846, 2.674570083618164, 2.3608474731445312, 1.212510108947754, 0.3971412777900696, 3.4564943313598633, 3.474750518798828, 2.930609703063965, 4.795492172241211, 1.4905339479446411, 3.347860336303711, 2.3378283977508545, 2.869223117828369, 3.763876438140869, 2.6214802265167236, 1.417656421661377, 3.927825450897217, 3.6874215602874756, 2.163998603820801, 2.267676830291748, 2.0683088302612305, 0.9627354145050049, 2.9958786964416504, 5.541155815124512, 1.9847240447998047, 4.0870819091796875, 2.969191312789917, 3.0384347438812256, 0.6190481781959534, 4.114446640014648, 1.3442180156707764, 1.908630132675171, 2.9128875732421875, 2.477058172225952, 1.555889368057251, 2.949885129928589, 2.863661766052246, 2.1718716621398926, 5.2333831787109375, 3.8416731357574463, 4.581325054168701, 2.925536632537842, 3.0980076789855957, 3.57243013381958, 3.1787145137786865, 2.6105527877807617, 3.0447964668273926, 2.529892921447754, 4.097540855407715, 3.3670248985290527, 1.705376148223877, 2.119499921798706, 1.9873700141906738, 2.1802978515625, 2.335435390472412, 0.002444230020046234, 2.5667061805725098, 2.5053603649139404, 2.0970821380615234, 3.146756649017334, 4.996086120605469], "mean_td_error": 2.692044734954834, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 13.0, "diff_num_grad_updates_vs_sampler_policy": 12.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.076807022094727, "actor_loss": -4.235409736633301, "critic_loss": 0.972710132598877, "alpha_loss": -0.036313511431217194, "alpha_value": 0.9964028000831604, "log_alpha_value": -0.003603672608733177, "target_entropy": -6.0, "policy_t": -0.011416018940508366, "mean_q": 0.2300952672958374, "max_q": 2.1502814292907715, "min_q": 0.16112065315246582}, "td_error": [4.183228492736816, 2.613585948944092, 2.9897451400756836, 3.0675606727600098, 0.4351281523704529, 3.075057029724121, 3.2141451835632324, 2.2710347175598145, 0.42806148529052734, 3.731893539428711, 2.5661730766296387, 0.6291684508323669, 2.038957118988037, 2.468113660812378, 3.4375438690185547, 2.9190821647644043, 3.505713939666748, 3.2812600135803223, 3.1363019943237305, 2.8357937335968018, 2.087695598602295, 0.3595125675201416, 3.1870455741882324, 0.8956153392791748, 2.8836584091186523, 3.392709255218506, 2.085757255554199, 1.0592031478881836, 4.227303981781006, 2.1379599571228027, 3.1878843307495117, 2.050753593444824, 2.892012596130371, 3.31158447265625, 2.0551881790161133, 1.9468114376068115, 1.963857650756836, 4.061666488647461, 3.8955628871917725, 1.8393261432647705, 3.4102487564086914, 1.9344158172607422, 1.3842105865478516, 2.4959444999694824, 2.3551788330078125, 1.7912402153015137, 2.530393600463867, 2.341729164123535, 3.351102352142334, 2.593291759490967, 3.006800651550293, 3.8566641807556152, 0.0706864595413208, 1.4341591596603394, 2.2524795532226562, 1.839671015739441, 3.0789847373962402, 2.448301315307617, 4.605362892150879, 3.5913143157958984, 3.3209073543548584, 3.2267870903015137, 3.4967029094696045, 1.4520337581634521, 0.39554810523986816, 2.3992812633514404, 3.9397854804992676, 3.587239980697632, 3.249671220779419, 2.2038729190826416, 1.5966830253601074, 0.4064512848854065, 4.573382377624512, 1.9095007181167603, 4.877377510070801, 3.5633296966552734, 1.4000189304351807, 2.0333712100982666, 2.781041383743286, 1.3155142068862915, 2.5776257514953613, 3.927112102508545, 2.070739269256592, 2.4343724250793457, 3.679441452026367, 2.7360174655914307], "mean_td_error": 2.579937696456909, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 13.0, "diff_num_grad_updates_vs_sampler_policy": 12.0}}, "num_env_steps_sampled": 12544, "num_env_steps_trained": 3354, "num_agent_steps_sampled": 37632, "num_agent_steps_trained": 3354, "last_target_update_ts": 12544, "num_target_updates": 13}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37632, "num_agent_steps_trained": 3354, "num_env_steps_sampled": 12544, "num_env_steps_trained": 3354, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 966.0887593777037, "num_env_steps_trained_throughput_per_sec": 278.181807945812, "timesteps_total": 12544, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 37632, "timers": {"training_iteration_time_ms": 947.414, "sample_time_ms": 656.99, "load_time_ms": 0.326, "load_throughput": 791957.283, "learn_time_ms": 18.485, "learn_throughput": 13957.102, "synch_weights_time_ms": 9.537}, "counters": {"num_env_steps_sampled": 12544, "num_env_steps_trained": 3354, "num_agent_steps_sampled": 37632, "num_agent_steps_trained": 3354, "last_target_update_ts": 12544, "num_target_updates": 13}, "done": false, "episodes_total": 0, "training_iteration": 8, "trial_id": "7c290_00000", "date": "2023-11-18_19-55-54", "timestamp": 1700366154, "time_this_iter_s": 1.8646807670593262, "time_total_s": 13.809861660003662, "pid": 1618, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x312a46b60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 13.809861660003662, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 72.13333333333334, "ram_util_percent": 64.53333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.088763236999512, "actor_loss": -4.336759567260742, "critic_loss": 2.2084813117980957, "alpha_loss": -0.042378686368465424, "alpha_value": 0.9958082437515259, "log_alpha_value": -0.004200582858175039, "target_entropy": -6.0, "policy_t": 0.05103331431746483, "mean_q": 0.35474517941474915, "max_q": 3.2426509857177734, "min_q": 0.22308474779129028}, "td_error": [4.366813659667969, 3.233781337738037, 3.140451431274414, 2.674309253692627, 5.900386333465576, 0.834115743637085, 3.933875560760498, 4.600518226623535, 5.321756839752197, 3.7580032348632812, 3.832152843475342, 4.447140216827393, 4.43543004989624, 3.7170424461364746, 4.192477703094482, 4.841968059539795, 4.721194744110107, 4.481090545654297, 4.710872650146484, 2.1373562812805176, 1.2692952156066895, 4.327225685119629, 3.575443744659424, 3.788862943649292, 3.8954358100891113, 2.7502994537353516, 1.0320892333984375, 4.727724075317383, 4.625061988830566, 3.829986095428467, 3.73848295211792, 5.236354827880859, 3.0119245052337646, 4.858562469482422, 0.5841583013534546, 3.6545796394348145, 6.680630207061768, 5.141119003295898, 2.7391531467437744, 4.782288551330566, 3.380730152130127, 4.807124137878418, 2.449573516845703, 2.8622446060180664, 5.94016170501709, 3.082085132598877, 4.683290481567383, 3.8814096450805664, 5.201746463775635, 5.369187355041504, 3.508165121078491, 3.9811863899230957, 4.758982181549072, 4.505655288696289, 4.038774490356445, 4.298423767089844, 4.974881172180176, 1.3210370540618896, 4.224434852600098, 5.449802398681641, 5.13632869720459, 5.971846580505371, 3.573580265045166, 3.1147189140319824, 2.0933892726898193, 4.1286468505859375, 5.436807632446289, 3.6335747241973877, 3.7295894622802734, 5.222832679748535, 1.4702165126800537, 4.473119735717773, 4.0158843994140625, 4.0405120849609375, 3.7563741207122803, 4.013907432556152, 1.9478390216827393, 4.703238010406494, 2.624037742614746, 5.217646598815918, 5.624288558959961, 3.847966194152832, 3.26851487159729, 3.4217023849487305, 4.150585174560547, 4.669864654541016], "mean_td_error": 3.948085308074951, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 15.0, "diff_num_grad_updates_vs_sampler_policy": 14.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.119474411010742, "actor_loss": -4.354838848114014, "critic_loss": 0.4275605380535126, "alpha_loss": -0.042504992336034775, "alpha_value": 0.995808482170105, "log_alpha_value": -0.004200316499918699, "target_entropy": -6.0, "policy_t": 0.03330827131867409, "mean_q": 0.3241499960422516, "max_q": 2.7219605445861816, "min_q": 0.215023010969162}, "td_error": [3.423147678375244, 2.557549476623535, 3.677295684814453, 2.3411967754364014, 1.455148696899414, 1.4777612686157227, 1.2405927181243896, 4.531835079193115, 1.2286661863327026, 2.460707664489746, 3.190901041030884, 3.141446590423584, 1.6904075145721436, 3.5013065338134766, 3.315816879272461, 3.099513053894043, 0.9782446622848511, 2.398041248321533, 0.7675385475158691, 5.719001770019531, 1.9758129119873047, 3.6017630100250244, 3.299866199493408, 3.9477028846740723, 2.010451555252075, 1.7607070207595825, 1.2799162864685059, 3.9040937423706055, 2.69258189201355, 0.7583233118057251, 0.8768354654312134, 1.598407506942749, 0.06801436096429825, 3.0568830966949463, 3.648228645324707, 1.5555988550186157, 0.9127668738365173, 3.3043529987335205, 2.3510403633117676, 1.239689826965332, 1.6163917779922485, 2.886711359024048, 0.9142391681671143, 0.7041147351264954, 3.704465866088867, 1.8262276649475098, 1.3673875331878662, 2.501845121383667, 3.288391590118408, 4.831624507904053, 2.8111743927001953, 2.860996723175049, 3.948246955871582, 2.8885107040405273, 3.2504220008850098, 0.5095987319946289, 1.911534070968628, 1.6539777517318726, 2.912336826324463, 3.9197964668273926, 2.9548404216766357, 1.5152933597564697, 1.053861141204834, 1.2263991832733154, 2.5135092735290527, 0.8920360803604126, 5.648055076599121, 2.097562789916992, 1.9130465984344482, 2.14005446434021, 4.00894832611084, 3.3261842727661133, 0.19466134905815125, 2.2643728256225586, 2.332371711730957, 0.9372109174728394, 4.623172760009766, 0.9142462015151978, 1.8448996543884277, 2.302090883255005, 3.809988260269165, 2.6340408325195312, 3.581458806991577, 2.1594016551971436, 1.2573184967041016, 2.6839988231658936], "mean_td_error": 2.4090254306793213, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 15.0, "diff_num_grad_updates_vs_sampler_policy": 14.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.136552810668945, "actor_loss": -4.342273235321045, "critic_loss": 0.8625930547714233, "alpha_loss": -0.0426192507147789, "alpha_value": 0.9958043098449707, "log_alpha_value": -0.004204511176794767, "target_entropy": -6.0, "policy_t": 0.023544732481241226, "mean_q": 0.3496297001838684, "max_q": 2.3933489322662354, "min_q": 0.20398257672786713}, "td_error": [1.5941890478134155, 1.473693609237671, 1.9591755867004395, 2.583280086517334, 3.1001691818237305, 1.4322667121887207, 2.4340100288391113, 2.496382236480713, 0.04306703805923462, 2.183885097503662, 1.502220869064331, 5.505005836486816, 4.170571327209473, 1.3780509233474731, 1.724839687347412, 2.699467182159424, 2.5405073165893555, 1.8751208782196045, 3.0549116134643555, 2.7192578315734863, 3.763652801513672, 2.913239002227783, 2.497265338897705, 2.8023080825805664, 0.08765780925750732, 2.0086848735809326, 1.231006383895874, 3.803372621536255, 0.44254064559936523, 3.8000566959381104, 2.8872222900390625, 1.2032873630523682, 3.5170392990112305, 3.1985092163085938, 1.4183189868927002, 1.875554084777832, 1.116075038909912, 3.8182389736175537, 2.5475172996520996, 3.4795169830322266, 2.527550220489502, 2.50944185256958, 4.2432355880737305, 0.8893635272979736, 3.666470527648926, 1.4297749996185303, 3.1336209774017334, 1.9174535274505615, 2.115753173828125, 2.284322738647461, 3.7403078079223633, 1.865309715270996, 2.6464903354644775, 1.7646095752716064, 3.996194839477539, 1.466503620147705, 2.7509493827819824, 2.931222677230835, 2.1258668899536133, 0.6425879597663879, 2.868252754211426, 0.5778250694274902, 1.5360256433486938, 1.9144420623779297, 2.547901153564453, 2.315746784210205, 3.708889961242676, 2.7401037216186523, 3.2473318576812744, 1.1390398740768433, 1.3353254795074463, 0.06558167934417725, 1.1478424072265625, 1.7904706001281738, 4.048650741577148, 1.5423039197921753, 3.1205673217773438, 2.0068166255950928, 0.782751202583313, 1.7871100902557373, 2.2785820960998535, 2.5323405265808105, 3.9895501136779785, 1.0928741693496704, 3.1733927726745605, 1.9873913526535034], "mean_td_error": 2.3116891384124756, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 15.0, "diff_num_grad_updates_vs_sampler_policy": 14.0}}, "num_env_steps_sampled": 14336, "num_env_steps_trained": 3870, "num_agent_steps_sampled": 43008, "num_agent_steps_trained": 3870, "last_target_update_ts": 14336, "num_target_updates": 15}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 43008, "num_agent_steps_trained": 3870, "num_env_steps_sampled": 14336, "num_env_steps_trained": 3870, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 933.8746214773727, "num_env_steps_trained_throughput_per_sec": 268.9058619879042, "timesteps_total": 14336, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 43008, "timers": {"training_iteration_time_ms": 957.282, "sample_time_ms": 667.957, "load_time_ms": 0.323, "load_throughput": 797972.445, "learn_time_ms": 18.201, "learn_throughput": 14174.958, "synch_weights_time_ms": 10.169}, "counters": {"num_env_steps_sampled": 14336, "num_env_steps_trained": 3870, "num_agent_steps_sampled": 43008, "num_agent_steps_trained": 3870, "last_target_update_ts": 14336, "num_target_updates": 15}, "done": false, "episodes_total": 0, "training_iteration": 9, "trial_id": "7c290_00000", "date": "2023-11-18_19-55-56", "timestamp": 1700366156, "time_this_iter_s": 1.9282701015472412, "time_total_s": 15.738131761550903, "pid": 1618, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x312a479c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 15.738131761550903, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 71.56666666666666, "ram_util_percent": 64.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.056903839111328, "actor_loss": -4.334434509277344, "critic_loss": 2.149789810180664, "alpha_loss": -0.04526325687766075, "alpha_value": 0.9955093860626221, "log_alpha_value": -0.0045007155276834965, "target_entropy": -6.0, "policy_t": 0.005051782354712486, "mean_q": 0.39955392479896545, "max_q": 3.6008052825927734, "min_q": 0.2488088458776474}, "td_error": [2.9574732780456543, 4.334921836853027, 4.959880828857422, 4.369272232055664, 3.9240920543670654, 4.024828910827637, 2.4586544036865234, 3.4970316886901855, 3.938633441925049, 4.9358978271484375, 3.7027840614318848, 3.2753381729125977, 3.3811094760894775, 5.293043613433838, 3.387005090713501, 5.522651672363281, 1.9333744049072266, 4.021744728088379, 4.524530410766602, 2.589597225189209, 3.4143333435058594, 3.750694990158081, 2.349064826965332, 3.9996683597564697, 3.294086456298828, 5.871572017669678, 3.0733249187469482, 2.724195957183838, 4.014952659606934, 3.850630760192871, 3.5265958309173584, 2.3444457054138184, 4.303635597229004, 3.780958890914917, 4.1085615158081055, 5.335609436035156, 3.898263931274414, 2.4427924156188965, 4.944494247436523, 5.162282943725586, 4.682581901550293, 4.180648326873779, 3.5093531608581543, 2.6196067333221436, 3.6706769466400146, 3.9341464042663574, 4.349239349365234, 3.875077962875366, 4.036563873291016, 4.945956707000732, 4.2969465255737305, 3.4699225425720215, 2.1594619750976562, 5.58795166015625, 5.0819807052612305, 3.664036273956299, 3.701185941696167, 4.734713554382324, 5.186453819274902, 2.4417176246643066, 4.379232406616211, 4.548919677734375, 2.142214775085449, 0.8930844068527222, 3.2172746658325195, 4.86962366104126, 1.4990562200546265, 2.562915325164795, 4.543393611907959, 1.158369541168213, 3.9199061393737793, 0.1624506711959839, 1.4495816230773926, 3.4780468940734863, 6.623137474060059, 3.6956605911254883, 3.709899425506592, 2.774174928665161, 2.4688546657562256, 3.617814779281616, 2.59521746635437, 3.1165969371795654, 2.833467721939087, 3.6573472023010254, 5.701766014099121, 4.4523162841796875], "mean_td_error": 3.690937042236328, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 16.0, "diff_num_grad_updates_vs_sampler_policy": 15.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.133008003234863, "actor_loss": -4.391952991485596, "critic_loss": 0.430631160736084, "alpha_loss": -0.04560358077287674, "alpha_value": 0.9955096244812012, "log_alpha_value": -0.004500498063862324, "target_entropy": -6.0, "policy_t": -0.012003928422927856, "mean_q": 0.36224690079689026, "max_q": 3.012260913848877, "min_q": 0.2381218522787094}, "td_error": [2.7306699752807617, 2.231822967529297, 3.1578280925750732, 3.472668409347534, 2.520606517791748, 1.5765173435211182, 0.9643076062202454, 2.3914475440979004, 0.5589535236358643, 1.027282953262329, 2.3473806381225586, 2.751678943634033, 2.144369602203369, 1.5810253620147705, 3.3875961303710938, 2.8392350673675537, 2.4233360290527344, 3.410555124282837, 3.853883981704712, 2.235555648803711, 1.871760368347168, 0.8255637884140015, 2.8103957176208496, 0.8572603464126587, 2.409475803375244, 1.787840485572815, 3.35603666305542, 0.25030672550201416, 3.962533950805664, 2.253371238708496, 2.403743267059326, 3.6043856143951416, 2.7314600944519043, 2.301327705383301, 3.386552333831787, 2.494874954223633, 2.060153007507324, 1.8832945823669434, 3.958049774169922, 0.2065919041633606, 2.906156539916992, 2.2374520301818848, 1.1170012950897217, 1.091758131980896, 3.002692699432373, 3.317110061645508, 2.5806071758270264, 1.4628005027770996, 2.662137746810913, 2.918510675430298, 3.218895435333252, 3.2892656326293945, 4.466691017150879, 1.7329312562942505, 1.4256292581558228, 2.97784423828125, 3.3601012229919434, 2.9206671714782715, 1.6430491209030151, 1.1005120277404785, 2.4462175369262695, 0.304349422454834, 0.6386920213699341, 0.325157105922699, 1.901814341545105, 3.2169649600982666, 2.3851232528686523, 3.4725639820098877, 2.073612689971924, 2.6692395210266113, 1.516571283340454, 2.4749717712402344, 0.10903659462928772, 3.7414586544036865, 2.6193552017211914, 2.5374855995178223, 2.4951868057250977, 2.2048659324645996, 2.723407745361328, 3.1394577026367188, 3.8015918731689453, 2.635925769805908, 3.410374641418457, 3.1117446422576904, 2.560098171234131, 0.4844766855239868], "mean_td_error": 2.342479705810547, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 16.0, "diff_num_grad_updates_vs_sampler_policy": 15.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.108244895935059, "actor_loss": -4.33742094039917, "critic_loss": 0.9248681664466858, "alpha_loss": -0.045537348836660385, "alpha_value": 0.995505154132843, "log_alpha_value": -0.004504971206188202, "target_entropy": -6.0, "policy_t": -0.02163558080792427, "mean_q": 0.3042319715023041, "max_q": 2.6543967723846436, "min_q": 0.22694328427314758}, "td_error": [2.94044828414917, 4.248298645019531, 2.629521608352661, 1.3759369850158691, 3.0616040229797363, 0.18100659549236298, 3.538221597671509, 1.872394323348999, 2.353175163269043, 3.975405216217041, 0.5190183520317078, 4.805595397949219, 2.1295223236083984, 2.2930126190185547, 2.7927541732788086, 0.0493520051240921, 0.2714614272117615, 3.8708367347717285, 1.6454055309295654, 2.0271973609924316, 3.7578847408294678, 0.8354072570800781, 2.380255699157715, 4.425565242767334, 2.3014705181121826, 3.7063846588134766, 3.2049636840820312, 2.106689453125, 4.001099586486816, 2.879143238067627, 3.381370782852173, 1.489263653755188, 1.9619919061660767, 0.9776514172554016, 1.3464386463165283, 4.433545112609863, 1.5277714729309082, 2.6561031341552734, 3.0508499145507812, 3.14467191696167, 1.699244737625122, 2.1671204566955566, 1.9010334014892578, 2.6400644779205322, 0.5322540998458862, 1.8989152908325195, 1.6124929189682007, 0.07831132411956787, 2.5988900661468506, 3.290785789489746, 2.2307915687561035, 4.141787528991699, 3.2427961826324463, 1.662554383277893, 2.1849067211151123, 1.2707422971725464, 2.7433061599731445, 4.291927337646484, 1.8267803192138672, 3.271724224090576, 3.2174158096313477, 1.1779029369354248, 0.9072926044464111, 2.890535831451416, 2.852726936340332, 1.71901273727417, 0.6799429655075073, 3.8482472896575928, 3.2948145866394043, 5.31313419342041, 3.950023889541626, 2.283482789993286, 2.4387059211730957, 2.2837417125701904, 1.396575689315796, 2.2315938472747803, 2.919029712677002, 4.071345329284668, 1.61367666721344, 2.4606690406799316, 2.5858066082000732, 4.28995418548584, 3.591870069503784, 2.9409241676330566, 0.8665459156036377, 1.4808955192565918], "mean_td_error": 2.4737322330474854, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 16.0, "diff_num_grad_updates_vs_sampler_policy": 15.0}}, "num_env_steps_sampled": 15232, "num_env_steps_trained": 4128, "num_agent_steps_sampled": 45696, "num_agent_steps_trained": 4128, "last_target_update_ts": 15232, "num_target_updates": 16}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 45696, "num_agent_steps_trained": 4128, "num_env_steps_sampled": 15232, "num_env_steps_trained": 4128, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 788.2682316962539, "num_env_steps_trained_throughput_per_sec": 226.97902207325168, "timesteps_total": 15232, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 45696, "timers": {"training_iteration_time_ms": 977.373, "sample_time_ms": 671.211, "load_time_ms": 0.322, "load_throughput": 800688.444, "learn_time_ms": 18.267, "learn_throughput": 14123.581, "synch_weights_time_ms": 10.154}, "counters": {"num_env_steps_sampled": 15232, "num_env_steps_trained": 4128, "num_agent_steps_sampled": 45696, "num_agent_steps_trained": 4128, "last_target_update_ts": 15232, "num_target_updates": 16}, "done": false, "episodes_total": 0, "training_iteration": 10, "trial_id": "7c290_00000", "date": "2023-11-18_19-55-57", "timestamp": 1700366157, "time_this_iter_s": 1.1460390090942383, "time_total_s": 16.88417077064514, "pid": 1618, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x312a47560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 16.88417077064514, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 51.849999999999994, "ram_util_percent": 64.65}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.049044609069824, "actor_loss": -4.394654750823975, "critic_loss": 1.7450478076934814, "alpha_loss": -0.051258452236652374, "alpha_value": 0.9949121475219727, "log_alpha_value": -0.005100828595459461, "target_entropy": -6.0, "policy_t": 0.060460835695266724, "mean_q": 0.6847015023231506, "max_q": 4.8141326904296875, "min_q": 0.30552271008491516}, "td_error": [3.93166446685791, 4.160389423370361, 3.7638418674468994, 3.863278865814209, 2.9473462104797363, 3.822140693664551, 4.30595588684082, 3.3427863121032715, 2.4987387657165527, 1.7875503301620483, 3.4509143829345703, 0.3196146488189697, 3.033644199371338, 4.266411781311035, 5.3588972091674805, 2.3377318382263184, 2.7071433067321777, 3.2827467918395996, 3.765233039855957, 4.652275085449219, 5.240142822265625, 2.3408660888671875, 2.620983839035034, 4.045584678649902, 4.363898277282715, 3.4880003929138184, 4.573426246643066, 2.993144989013672, 2.026482105255127, 3.090341567993164, 2.229731321334839, 5.406035900115967, 2.6165661811828613, 5.646315574645996, 3.7268269062042236, 0.5501596927642822, 3.1527254581451416, 3.091019630432129, 4.223238468170166, 3.8070056438446045, 1.567112684249878, 3.9403162002563477, 3.116520881652832, 3.9394688606262207, 3.870757818222046, 6.348357200622559, 1.7621617317199707, 0.9835450649261475, 2.5687153339385986, 2.5658392906188965, 4.178597927093506, 0.6190162897109985, 2.6464056968688965, 3.850149154663086, 1.5253958702087402, 0.5626091957092285, 4.277344703674316, 3.5285592079162598, 3.281588554382324, 0.2961486577987671, 4.521966934204102, 2.980086088180542, 5.39454460144043, 6.526498794555664, 4.317738056182861, 3.7677292823791504, 4.49600887298584, 2.3220338821411133, 1.9445720911026, 3.6335153579711914, 2.33596134185791, 1.8432010412216187, 1.1588656902313232, 4.469447612762451, 2.9083118438720703, 6.507112503051758, 2.963634967803955, 3.779937744140625, 4.948309898376465, 3.5694241523742676, 3.3067474365234375, 5.621878623962402, 5.431862831115723, 3.4992077350616455, 4.8662109375, 3.1782145500183105], "mean_td_error": 3.4017724990844727, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 18.0, "diff_num_grad_updates_vs_sampler_policy": 17.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.073333740234375, "actor_loss": -4.387653350830078, "critic_loss": 0.4402656555175781, "alpha_loss": -0.051382891833782196, "alpha_value": 0.9949120879173279, "log_alpha_value": -0.005100882612168789, "target_entropy": -6.0, "policy_t": 0.024883756414055824, "mean_q": 0.41051504015922546, "max_q": 3.581667423248291, "min_q": 0.2874438166618347}, "td_error": [1.0890350341796875, 0.3325381278991699, 5.130927085876465, 1.2228705883026123, 2.7862839698791504, 3.4666123390197754, 0.4879082441329956, 4.537243843078613, 3.215822219848633, 1.7746467590332031, 4.489612579345703, 1.3170673847198486, 3.2094507217407227, 3.0587501525878906, 2.6951987743377686, 0.9328864812850952, 1.7744951248168945, 2.4587948322296143, 3.312392473220825, 3.344421863555908, 2.9517860412597656, 2.2066659927368164, 4.165186882019043, 1.3695765733718872, 0.407898873090744, 1.4778144359588623, 1.2583544254302979, 2.611781597137451, 3.410587787628174, 1.6282161474227905, 2.6887714862823486, 1.0037678480148315, 3.7359397411346436, 2.849364757537842, 3.3604907989501953, 1.753807783126831, 4.703361511230469, 2.1512441635131836, 2.0864157676696777, 3.5398330688476562, 2.6479218006134033, 3.60557222366333, 3.5455689430236816, 3.7683651447296143, 1.6481590270996094, 0.7833326458930969, 1.827873945236206, 3.317106246948242, 2.6748924255371094, 2.367480993270874, 2.2413601875305176, 1.5814294815063477, 2.5404255390167236, 2.390071392059326, 1.4403715133666992, 2.3449034690856934, 0.9622615575790405, 1.1287469863891602, 1.8064104318618774, 0.5690324306488037, 1.956761121749878, 1.7480149269104004, 2.5111398696899414, 3.128546714782715, 1.9899718761444092, 1.6338611841201782, 4.087053298950195, 1.9023447036743164, 1.809999704360962, 1.7569026947021484, 3.2585020065307617, 3.606828212738037, 1.7641615867614746, 2.487283229827881, 2.2021687030792236, 2.556757688522339, 0.41332483291625977, 2.6923909187316895, 3.0150115489959717, 1.4568006992340088, 1.6494252681732178, 2.0641486644744873, 4.007336616516113, 4.869105339050293, 2.4276511669158936, 3.4621694087982178], "mean_td_error": 2.4144973754882812, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 18.0, "diff_num_grad_updates_vs_sampler_policy": 17.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.137903213500977, "actor_loss": -4.424619197845459, "critic_loss": 0.8239196538925171, "alpha_loss": -0.05176277086138725, "alpha_value": 0.9949071407318115, "log_alpha_value": -0.005105865653604269, "target_entropy": -6.0, "policy_t": -0.010233200155198574, "mean_q": 0.5656577348709106, "max_q": 3.9624388217926025, "min_q": 0.27834099531173706}, "td_error": [0.9749511480331421, 1.0095981359481812, 1.7228047847747803, 3.9890668392181396, 0.6710747480392456, 2.4802327156066895, 1.8538894653320312, 3.9055562019348145, 2.5959300994873047, 3.0387253761291504, 2.721022129058838, 2.5134902000427246, 1.5002425909042358, 2.8455543518066406, 1.8506596088409424, 3.7518224716186523, 1.3935059309005737, 1.349353551864624, 3.359834671020508, 2.048595428466797, 4.0675835609436035, 2.3702034950256348, 2.397733688354492, 1.9758713245391846, 1.5884671211242676, 3.429408311843872, 0.47741585969924927, 3.9723472595214844, 3.8494784832000732, 2.64365816116333, 1.573836326599121, 0.4107016324996948, 1.9172861576080322, 3.500204563140869, 2.707134246826172, 3.671863317489624, 2.687619686126709, 2.7485432624816895, 2.906251907348633, 2.4484007358551025, 3.584782123565674, 1.7497003078460693, 2.6712470054626465, 2.9560914039611816, 1.4984177350997925, 3.329183340072632, 0.6525430679321289, 2.925511360168457, 1.4984281063079834, 3.596017837524414, 2.975843906402588, 1.8380789756774902, 4.271425247192383, 2.2816953659057617, 1.9666635990142822, 2.754664421081543, 0.9478278160095215, 3.459395408630371, 1.1502766609191895, 2.774625778198242, 2.66245698928833, 0.4074394106864929, 2.2076327800750732, 1.6146281957626343, 2.188006639480591, 2.1093013286590576, 3.1708998680114746, 0.20678220689296722, 3.7372379302978516, 4.196725845336914, 2.3253660202026367, 1.9032840728759766, 3.1602635383605957, 1.756091594696045, 2.9824018478393555, 1.225412130355835, 1.4572981595993042, 0.9872786998748779, 0.043996378779411316, 0.905250072479248, 1.2824231386184692, 0.8371894955635071, 2.6381239891052246, 3.7594666481018066, 1.396138310432434, 0.7141726016998291], "mean_td_error": 2.2753210067749023, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 18.0, "diff_num_grad_updates_vs_sampler_policy": 17.0}}, "num_env_steps_sampled": 17024, "num_env_steps_trained": 4644, "num_agent_steps_sampled": 51072, "num_agent_steps_trained": 4644, "last_target_update_ts": 17024, "num_target_updates": 18}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51072, "num_agent_steps_trained": 4644, "num_env_steps_sampled": 17024, "num_env_steps_trained": 4644, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 976.1502287322633, "num_env_steps_trained_throughput_per_sec": 281.0789721126383, "timesteps_total": 17024, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 51072, "timers": {"training_iteration_time_ms": 970.629, "sample_time_ms": 663.156, "load_time_ms": 0.321, "load_throughput": 803184.467, "learn_time_ms": 18.229, "learn_throughput": 14153.211, "synch_weights_time_ms": 10.28}, "counters": {"num_env_steps_sampled": 17024, "num_env_steps_trained": 4644, "num_agent_steps_sampled": 51072, "num_agent_steps_trained": 4644, "last_target_update_ts": 17024, "num_target_updates": 18}, "done": false, "episodes_total": 0, "training_iteration": 11, "trial_id": "7c290_00000", "date": "2023-11-18_19-55-59", "timestamp": 1700366159, "time_this_iter_s": 1.8435611724853516, "time_total_s": 18.727731943130493, "pid": 1618, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x312ac0c20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 18.727731943130493, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 74.35, "ram_util_percent": 64.75}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.041664123535156, "actor_loss": -4.4578962326049805, "critic_loss": 1.9163784980773926, "alpha_loss": -0.057246092706918716, "alpha_value": 0.9943153858184814, "log_alpha_value": -0.005700857378542423, "target_entropy": -6.0, "policy_t": 0.01732587441802025, "mean_q": 0.5637733936309814, "max_q": 5.207151412963867, "min_q": 0.36898088455200195}, "td_error": [5.649598121643066, 5.244453430175781, 1.7148146629333496, 3.687462329864502, 4.2861247062683105, 5.023250579833984, 4.224350929260254, 3.578185558319092, 5.301006317138672, 2.99472713470459, 2.9021286964416504, 6.240755081176758, 5.153049468994141, 1.7075598239898682, 4.429963111877441, 5.347124099731445, 1.8648992776870728, 2.902897357940674, 4.359367370605469, 3.9901671409606934, 4.313292980194092, 2.1237246990203857, 2.8176636695861816, 5.506971836090088, 2.462679386138916, 4.486963272094727, 2.3333089351654053, 2.880600929260254, 4.039632320404053, 3.8566691875457764, 4.820511341094971, 3.857717990875244, 2.4349112510681152, 4.948911666870117, 3.1343791484832764, 2.768944501876831, 3.9257452487945557, 3.7332558631896973, 1.1277868747711182, 3.844650983810425, 2.3231167793273926, 4.474326133728027, 5.125182628631592, 3.868748188018799, 3.397139549255371, 2.2142155170440674, 5.216233253479004, 3.998521089553833, 4.56099271774292, 3.619452953338623, 3.8510875701904297, 2.168963670730591, 3.574712038040161, 4.615030765533447, 3.345104217529297, 3.0645346641540527, 4.374685764312744, 3.6468734741210938, 4.372314929962158, 4.874802589416504, 3.3249335289001465, 2.8637895584106445, 4.805960655212402, 5.835816860198975, 3.849170684814453, 3.5816304683685303, 3.5871729850769043, 1.1896588802337646, 3.987520217895508, 3.230807304382324, 5.7485432624816895, 5.466867923736572, 0.9461057186126709, 2.479152202606201, 2.282695770263672, 5.128502368927002, 0.8976051807403564, 0.5643677711486816, 3.3995776176452637, 2.830631971359253, 3.2406067848205566, 3.2079429626464844, 5.466034889221191, 4.140031814575195, 4.603360176086426, 3.980461597442627], "mean_td_error": 3.690060615539551, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 20.0, "diff_num_grad_updates_vs_sampler_policy": 19.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.109087944030762, "actor_loss": -4.488977432250977, "critic_loss": 0.3929711580276489, "alpha_loss": -0.05763297155499458, "alpha_value": 0.9943150877952576, "log_alpha_value": -0.005701105110347271, "target_entropy": -6.0, "policy_t": -0.003370868042111397, "mean_q": 0.5028139352798462, "max_q": 3.7676775455474854, "min_q": 0.34262973070144653}, "td_error": [0.814910352230072, 2.233370304107666, 0.04876863956451416, 0.3627724051475525, 2.3403217792510986, 1.7054256200790405, 2.8734452724456787, 1.618574619293213, 2.557452440261841, 3.343270778656006, 1.5985089540481567, 1.833707571029663, 1.6405776739120483, 3.9937262535095215, 2.8372039794921875, 1.7459537982940674, 1.8155517578125, 2.763307571411133, 3.6050286293029785, 2.277165412902832, 2.6695427894592285, 2.888134479522705, 0.16317105293273926, 0.980608344078064, 4.352016448974609, 1.4102474451065063, 1.7349547147750854, 2.674236297607422, 2.2242932319641113, 2.2964510917663574, 2.5738816261291504, 2.0182108879089355, 2.7867932319641113, 3.1699228286743164, 1.668527603149414, 0.9839532375335693, 2.8083510398864746, 0.9138761758804321, 0.8467642068862915, 0.826921284198761, 2.1864571571350098, 3.6789042949676514, 1.9582107067108154, 0.2952117323875427, 1.8152797222137451, 2.869720458984375, 2.446938991546631, 1.43984854221344, 1.4221560955047607, 3.1262807846069336, 2.717684268951416, 2.4006004333496094, 2.5305309295654297, 3.3040263652801514, 3.6476635932922363, 0.5384156107902527, 4.08631706237793, 3.145695686340332, 1.9619855880737305, 0.5043537616729736, 1.928661823272705, 2.3840558528900146, 0.6712394952774048, 1.6500964164733887, 0.5711513161659241, 2.463008165359497, 3.668057441711426, 3.4550976753234863, 2.1529312133789062, 1.484264612197876, 2.0311930179595947, 0.9951624274253845, 1.7613656520843506, 2.7637009620666504, 4.257466793060303, 3.932931900024414, 2.0104117393493652, 2.1779375076293945, 1.117004632949829, 3.600165605545044, 3.3571062088012695, 1.4723701477050781, 2.0734126567840576, 3.72041654586792, 1.383621096611023, 4.727599620819092], "mean_td_error": 2.20798397064209, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 20.0, "diff_num_grad_updates_vs_sampler_policy": 19.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0563325881958, "actor_loss": -4.418201446533203, "critic_loss": 0.75710129737854, "alpha_loss": -0.05738948658108711, "alpha_value": 0.9943094253540039, "log_alpha_value": -0.005706801079213619, "target_entropy": -6.0, "policy_t": 0.013588028959929943, "mean_q": 0.4303775727748871, "max_q": 3.6665501594543457, "min_q": 0.33520156145095825}, "td_error": [4.360837459564209, 1.253295660018921, 1.195002555847168, 2.4202661514282227, 1.8065909147262573, 1.5377588272094727, 2.7641706466674805, 1.3574742078781128, 3.504833936691284, 0.5672019124031067, 1.8572521209716797, 2.5237679481506348, 2.106938362121582, 1.3951573371887207, 2.4103240966796875, 2.968313694000244, 2.046372413635254, 3.0208725929260254, 1.3606243133544922, 2.1517629623413086, 2.8172717094421387, 3.5195999145507812, 2.551438808441162, 3.5021121501922607, 1.8521665334701538, 2.528613567352295, 0.6266944408416748, 2.6716842651367188, 2.752340793609619, 2.3841140270233154, 0.8467137813568115, 1.2544820308685303, 1.7331818342208862, 2.209235668182373, 0.6260007619857788, 3.812230110168457, 3.1087260246276855, 1.9460537433624268, 2.8010354042053223, 0.712817907333374, 2.0332064628601074, 2.6145753860473633, 3.464158535003662, 2.504948139190674, 1.4461851119995117, 1.3364918231964111, 1.6983935832977295, 2.593940019607544, 2.7336320877075195, 2.495171308517456, 4.0735063552856445, 2.1545653343200684, 2.4854917526245117, 3.8413846492767334, 0.38620883226394653, 2.736629009246826, 0.8645577430725098, 1.3480393886566162, 2.4391021728515625, 0.6334688663482666, 0.8012374639511108, 1.7071284055709839, 3.126676082611084, 0.2947227954864502, 1.6278581619262695, 3.999948501586914, 1.3238866329193115, 1.9193692207336426, 1.5399430990219116, 2.0338118076324463, 3.2157750129699707, 1.4865528345108032, 3.503140449523926, 1.9651987552642822, 2.462862014770508, 2.1648738384246826, 1.9017083644866943, 1.602997064590454, 2.5482168197631836, 1.8125051259994507, 1.8084441423416138, 1.7421908378601074, 3.135437488555908, 1.323054552078247, 2.9670348167419434, 0.021235719323158264], "mean_td_error": 2.1254048347473145, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 20.0, "diff_num_grad_updates_vs_sampler_policy": 19.0}}, "num_env_steps_sampled": 18816, "num_env_steps_trained": 5160, "num_agent_steps_sampled": 56448, "num_agent_steps_trained": 5160, "last_target_update_ts": 18816, "num_target_updates": 20}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56448, "num_agent_steps_trained": 5160, "num_env_steps_sampled": 18816, "num_env_steps_trained": 5160, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 951.650743511886, "num_env_steps_trained_throughput_per_sec": 274.0244328415922, "timesteps_total": 18816, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 56448, "timers": {"training_iteration_time_ms": 958.384, "sample_time_ms": 664.682, "load_time_ms": 0.325, "load_throughput": 794982.686, "learn_time_ms": 18.186, "learn_throughput": 14187.056, "synch_weights_time_ms": 10.21}, "counters": {"num_env_steps_sampled": 18816, "num_env_steps_trained": 5160, "num_agent_steps_sampled": 56448, "num_agent_steps_trained": 5160, "last_target_update_ts": 18816, "num_target_updates": 20}, "done": false, "episodes_total": 0, "training_iteration": 12, "trial_id": "7c290_00000", "date": "2023-11-18_19-56-01", "timestamp": 1700366161, "time_this_iter_s": 1.891381025314331, "time_total_s": 20.619112968444824, "pid": 1618, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x312ac0180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 20.619112968444824, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 70.0, "ram_util_percent": 64.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.041949272155762, "actor_loss": -4.548435211181641, "critic_loss": 1.923218011856079, "alpha_loss": -0.06327258050441742, "alpha_value": 0.9937189817428589, "log_alpha_value": -0.006300827022641897, "target_entropy": -6.0, "policy_t": 0.022673852741718292, "mean_q": 0.807890772819519, "max_q": 6.631292343139648, "min_q": 0.43809449672698975}, "td_error": [0.33512082695961, 2.077831983566284, 1.6941208839416504, 1.007071852684021, 1.8419432640075684, 5.461673736572266, 4.306377410888672, 3.724331855773926, 4.228504180908203, 2.263967990875244, 1.634071707725525, 3.3001163005828857, 5.4422478675842285, 3.9012885093688965, 3.3644723892211914, 6.639706611633301, 5.732826232910156, 5.574455261230469, 2.6511573791503906, 1.3786370754241943, 5.917447090148926, 4.400210857391357, 4.5129547119140625, 2.572585105895996, 3.981996536254883, 4.245720863342285, 1.9033002853393555, 3.696183681488037, 4.369417190551758, 3.293546199798584, 3.2374722957611084, 4.7008233070373535, 3.3984146118164062, 4.595415115356445, 4.95944881439209, 3.274855136871338, 2.708589553833008, 1.7373638153076172, 4.126866340637207, 4.463743686676025, 1.6463186740875244, 3.8602962493896484, 3.446859836578369, 3.606447219848633, 3.1052982807159424, 5.140194892883301, 4.5826568603515625, 4.154179096221924, 6.037146091461182, 2.615647315979004, 5.545055866241455, 4.98404598236084, 2.3329219818115234, 2.4832911491394043, 3.692021131515503, 2.9662604331970215, 3.58740234375, 3.500809669494629, 2.189262628555298, 4.687100410461426, 3.6640753746032715, 3.504077434539795, 3.259280204772949, 2.9637234210968018, 2.613677501678467, 3.4881491661071777, 2.5524983406066895, 1.218961477279663, 3.3070383071899414, 1.7457308769226074, 3.7328145503997803, 6.186812400817871, 1.125141978263855, 3.864774703979492, 4.099790096282959, 3.4536867141723633, 4.164980888366699, 3.75344181060791, 3.5882391929626465, 6.721002101898193, 4.64796257019043, 2.5694117546081543, 4.106643199920654, 3.567464828491211, 3.914066791534424, 5.164599418640137], "mean_td_error": 3.602297067642212, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 22.0, "diff_num_grad_updates_vs_sampler_policy": 21.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.047382354736328, "actor_loss": -4.494174003601074, "critic_loss": 0.4141108989715576, "alpha_loss": -0.06331386417150497, "alpha_value": 0.9937182664871216, "log_alpha_value": -0.00630152877420187, "target_entropy": -6.0, "policy_t": 0.004404277540743351, "mean_q": 0.5964152216911316, "max_q": 4.699780464172363, "min_q": 0.3980419337749481}, "td_error": [3.361412525177002, 2.2842392921447754, 1.7366753816604614, 3.494335889816284, 1.696523904800415, 2.9985175132751465, 1.674105167388916, 2.107499361038208, 0.9921809434890747, 3.2651004791259766, 3.38936710357666, 1.7507078647613525, 4.376564979553223, 1.5561771392822266, 3.973355770111084, 0.3408237099647522, 0.267482191324234, 3.9903321266174316, 3.0771684646606445, 1.9799671173095703, 2.8918185234069824, 1.6928284168243408, 3.11569881439209, 4.473217010498047, 2.2492551803588867, 2.8703737258911133, 2.50474214553833, 1.8314330577850342, 2.8362693786621094, 0.910675585269928, 2.5249905586242676, 2.407435417175293, 0.99298095703125, 1.0636489391326904, 2.377584457397461, 2.32560396194458, 3.451395034790039, 2.595184326171875, 2.4378890991210938, 0.7917993068695068, 4.071810722351074, 0.7150417566299438, 2.808488368988037, 3.4944515228271484, 3.330265760421753, 2.0285613536834717, 3.4760921001434326, 1.3371758460998535, 1.5771408081054688, 2.587280035018921, 1.79742431640625, 1.5579301118850708, 3.3116767406463623, 3.6006171703338623, 2.8711910247802734, 2.1121420860290527, 2.9686741828918457, 1.5253369808197021, 3.6489994525909424, 1.3402493000030518, 5.224978923797607, 0.5114951133728027, 3.226374864578247, 1.243269920349121, 1.2987432479858398, 3.3951833248138428, 3.0693490505218506, 0.7283545136451721, 1.7336807250976562, 2.546961545944214, 3.270005226135254, 3.0613276958465576, 0.4904139041900635, 3.4257137775421143, 0.89616459608078, 1.2173434495925903, 3.3488609790802, 2.115849494934082, 4.9890241622924805, 2.1688547134399414, 2.8886587619781494, 0.3610038161277771, 0.451383501291275, 1.1531519889831543, 2.322685718536377, 1.3655344247817993], "mean_td_error": 2.340956687927246, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 22.0, "diff_num_grad_updates_vs_sampler_policy": 21.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.058874130249023, "actor_loss": -4.491710662841797, "critic_loss": 0.6861430406570435, "alpha_loss": -0.06344589591026306, "alpha_value": 0.9937123656272888, "log_alpha_value": -0.0063074552454054356, "target_entropy": -6.0, "policy_t": 0.04613032564520836, "mean_q": 0.5403875112533569, "max_q": 4.052933216094971, "min_q": 0.3943414092063904}, "td_error": [2.853729248046875, 2.8890295028686523, 0.10622403025627136, 2.8790416717529297, 0.5584401488304138, 2.0612807273864746, 2.366671562194824, 1.6581861972808838, 2.0775387287139893, 0.9898592829704285, 1.3883626461029053, 3.4720263481140137, 0.45163261890411377, 2.1152591705322266, 2.4042394161224365, 3.955068826675415, 3.9344310760498047, 1.8984360694885254, 4.57722282409668, 1.403664469718933, 1.4953558444976807, 2.540438652038574, 1.5735116004943848, 2.240525722503662, 1.0470353364944458, 1.998939871788025, 1.8377275466918945, 3.205519676208496, 3.356419324874878, 0.7116053104400635, 3.3529014587402344, 1.5440056324005127, 4.7302703857421875, 3.7103006839752197, 2.444000244140625, 0.4062870740890503, 2.513136148452759, 2.0861592292785645, 2.108142137527466, 0.34691953659057617, 2.108341693878174, 0.2557852268218994, 1.4605140686035156, 2.890228509902954, 1.0202925205230713, 0.7380071878433228, 3.4322333335876465, 2.4222605228424072, 2.1446337699890137, 0.05876176059246063, 2.541505813598633, 1.8579604625701904, 3.025071859359741, 2.8467750549316406, 4.523098945617676, 2.466019630432129, 1.2184598445892334, 1.4483134746551514, 2.03582763671875, 1.5789371728897095, 4.492672443389893, 4.992853164672852, 3.0297937393188477, 3.2039589881896973, 2.66251540184021, 1.4415593147277832, 3.224234104156494, 0.7959580421447754, 1.90199875831604, 3.155210018157959, 2.832521677017212, 3.457296371459961, 2.727694034576416, 2.5244648456573486, 2.229020118713379, 2.4782304763793945, 0.3103654384613037, 3.989881992340088, 1.2060623168945312, 0.6262348890304565, 3.089780807495117, 2.171431064605713, 3.9447743892669678, 1.7173553705215454, 0.9847877621650696, 2.012751579284668], "mean_td_error": 2.2391393184661865, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 22.0, "diff_num_grad_updates_vs_sampler_policy": 21.0}}, "num_env_steps_sampled": 20608, "num_env_steps_trained": 5676, "num_agent_steps_sampled": 61824, "num_agent_steps_trained": 5676, "last_target_update_ts": 20608, "num_target_updates": 22}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 61824, "num_agent_steps_trained": 5676, "num_env_steps_sampled": 20608, "num_env_steps_trained": 5676, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 964.648114992963, "num_env_steps_trained_throughput_per_sec": 277.76697954038445, "timesteps_total": 20608, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 61824, "timers": {"training_iteration_time_ms": 955.851, "sample_time_ms": 661.674, "load_time_ms": 0.319, "load_throughput": 807921.78, "learn_time_ms": 18.027, "learn_throughput": 14311.566, "synch_weights_time_ms": 10.151}, "counters": {"num_env_steps_sampled": 20608, "num_env_steps_trained": 5676, "num_agent_steps_sampled": 61824, "num_agent_steps_trained": 5676, "last_target_update_ts": 20608, "num_target_updates": 22}, "done": false, "episodes_total": 0, "training_iteration": 13, "trial_id": "7c290_00000", "date": "2023-11-18_19-56-03", "timestamp": 1700366163, "time_this_iter_s": 1.866955041885376, "time_total_s": 22.4860680103302, "pid": 1618, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x312a46660>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 22.4860680103302, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 62.76666666666667, "ram_util_percent": 64.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.102418899536133, "actor_loss": -4.701510906219482, "critic_loss": 1.7392892837524414, "alpha_loss": -0.0697135403752327, "alpha_value": 0.9931230545043945, "log_alpha_value": -0.006900677923113108, "target_entropy": -6.0, "policy_t": 0.0653606429696083, "mean_q": 1.0828553438186646, "max_q": 7.37730598449707, "min_q": 0.5126279592514038}, "td_error": [3.299391508102417, 3.952657699584961, 2.117767810821533, 4.80348539352417, 1.8269379138946533, 3.1838841438293457, 4.833853244781494, 0.5937933921813965, 5.03785514831543, 4.655621528625488, 1.5545583963394165, 3.442488193511963, 4.293923377990723, 5.523415565490723, 3.3556487560272217, 4.385499954223633, 0.2557147741317749, 1.4142769575119019, 3.872093439102173, 3.8834807872772217, 2.885096549987793, 4.925467491149902, 2.2877297401428223, 1.9489102363586426, 5.0085954666137695, 4.741842746734619, 0.5561347007751465, 4.775749206542969, 5.327183246612549, 3.671881675720215, 3.028348445892334, 3.584930181503296, 2.7326865196228027, 3.658782482147217, 5.329298973083496, 3.0752530097961426, 4.722052574157715, 3.9150447845458984, 4.669842720031738, 3.529639482498169, 0.96040940284729, 3.533778190612793, 4.589388370513916, 0.044884294271469116, 5.128706455230713, 3.180842638015747, 4.336504936218262, 4.454725742340088, 1.0827703475952148, 4.649604797363281, 3.648540496826172, 3.359884023666382, 2.2757866382598877, 4.404179573059082, 4.912668704986572, 3.1805505752563477, 1.2092279195785522, 6.603826522827148, 5.057027339935303, 2.5119543075561523, 3.6078531742095947, 4.927430152893066, 4.270783424377441, 2.578230381011963, 4.496457099914551, 2.9021966457366943, 4.6429338455200195, 1.261321783065796, 4.013348579406738, 2.552002191543579, 3.2443506717681885, 3.7110583782196045, 1.2626636028289795, 0.220503568649292, 2.990662097930908, 3.3914971351623535, 4.0778045654296875, 2.5781493186950684, 2.796844482421875, 3.3850436210632324, 4.819866180419922, 4.177947044372559, 4.375757217407227, 5.527492523193359, 1.4604289531707764, 4.577749729156494], "mean_td_error": 3.4608888626098633, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 24.0, "diff_num_grad_updates_vs_sampler_policy": 23.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.135350227355957, "actor_loss": -4.66249418258667, "critic_loss": 0.36670321226119995, "alpha_loss": -0.06995278596878052, "alpha_value": 0.9931219220161438, "log_alpha_value": -0.006901862099766731, "target_entropy": -6.0, "policy_t": -0.004925057757645845, "mean_q": 0.8054341077804565, "max_q": 4.757280349731445, "min_q": 0.4606543183326721}, "td_error": [2.571232557296753, 2.610624074935913, 3.04752254486084, 2.6813409328460693, 1.6984083652496338, 3.949422836303711, 1.2466986179351807, 2.2789134979248047, 3.556347608566284, 3.5961391925811768, 2.0881190299987793, 0.41646161675453186, 1.9430441856384277, 0.776624858379364, 4.194663047790527, 0.8618762493133545, 2.2195284366607666, 4.5355072021484375, 0.30775830149650574, 1.5918086767196655, 1.7258012294769287, 2.1042709350585938, 2.453444004058838, 1.3080344200134277, 2.265570878982544, 1.2292420864105225, 2.024977207183838, 2.716855525970459, 1.3993297815322876, 1.051743507385254, 2.671732187271118, 0.6589865684509277, 2.2874114513397217, 3.9609251022338867, 2.9897027015686035, 4.861419677734375, 1.3711425065994263, 1.0278867483139038, 2.9129137992858887, 3.076585292816162, 3.1517717838287354, 0.04645627737045288, 1.6229225397109985, 4.37194299697876, 1.7802873849868774, 3.413607120513916, 0.7765644192695618, 3.8887574672698975, 3.4547433853149414, 0.11307203769683838, 2.54555344581604, 3.063044309616089, 0.7144392132759094, 0.13670194149017334, 0.7143311500549316, 3.074359655380249, 2.9766268730163574, 1.0618314743041992, 2.8600339889526367, 1.3344745635986328, 2.145242929458618, 0.8477003574371338, 1.0046043395996094, 1.6974918842315674, 2.367121696472168, 1.3568787574768066, 1.7017351388931274, 0.1621667444705963, 2.8421356678009033, 0.1377873718738556, 2.999779462814331, 1.602186679840088, 2.859074592590332, 3.847238063812256, 0.5772110819816589, 2.4388647079467773, 2.717754602432251, 2.4114718437194824, 1.9196829795837402, 2.340214729309082, 1.5968571901321411, 0.32651105523109436, 0.7155176997184753, 2.8013737201690674, 1.3462237119674683, 1.5778167247772217], "mean_td_error": 2.066420555114746, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 24.0, "diff_num_grad_updates_vs_sampler_policy": 23.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.123274803161621, "actor_loss": -4.6276092529296875, "critic_loss": 0.7013546228408813, "alpha_loss": -0.06992984563112259, "alpha_value": 0.9931159615516663, "log_alpha_value": -0.006907828152179718, "target_entropy": -6.0, "policy_t": -0.012206492014229298, "mean_q": 0.7631856203079224, "max_q": 6.070622444152832, "min_q": 0.4605850875377655}, "td_error": [0.6985124349594116, 1.5687034130096436, 2.1586880683898926, 3.740386486053467, 1.4240683317184448, 1.8574869632720947, 2.6678106784820557, 2.588174819946289, 1.3977959156036377, 3.704272747039795, 1.3314008712768555, 3.781552791595459, 3.8129544258117676, 3.129528760910034, 2.9384777545928955, 1.9645016193389893, 2.5239782333374023, 4.145727157592773, 2.9323906898498535, 1.9148895740509033, 1.457888126373291, 1.1570738554000854, 1.884324312210083, 1.5295355319976807, 3.3547558784484863, 3.260763168334961, 4.325564384460449, 2.999857187271118, 2.1074352264404297, 1.6024378538131714, 1.2879252433776855, 2.8488659858703613, 1.194261908531189, 5.789349555969238, 2.1717324256896973, 0.731250524520874, 1.8688764572143555, 2.6521823406219482, 2.0983529090881348, 2.7490532398223877, 2.618084192276001, 3.7413063049316406, 1.5020978450775146, 1.846818208694458, 3.244201421737671, 3.2317440509796143, 3.274533748626709, 3.32204008102417, 0.3723618984222412, 2.364269495010376, 3.1224827766418457, 3.783872127532959, 3.139101266860962, 1.8178141117095947, 1.0114619731903076, 1.79043710231781, 0.753379225730896, 1.8337069749832153, 1.5655616521835327, 2.637660264968872, 0.6941745281219482, 3.5763585567474365, 1.0971181392669678, 2.338972330093384, 2.358487129211426, 1.1887669563293457, 2.2606868743896484, 2.676112174987793, 2.727236270904541, 3.1908726692199707, 2.1496338844299316, 2.3599252700805664, 2.3050169944763184, 1.1327462196350098, 4.596554756164551, 1.3702366352081299, 1.9985605478286743, 1.9274605512619019, 1.602636456489563, 1.575400948524475, 2.3708620071411133, 2.5688819885253906, 3.2788705825805664, 1.214490294456482, 1.0946775674819946, 1.7946979999542236], "mean_td_error": 2.322967052459717, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 24.0, "diff_num_grad_updates_vs_sampler_policy": 23.0}}, "num_env_steps_sampled": 22400, "num_env_steps_trained": 6192, "num_agent_steps_sampled": 67200, "num_agent_steps_trained": 6192, "last_target_update_ts": 22400, "num_target_updates": 24}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 67200, "num_agent_steps_trained": 6192, "num_env_steps_sampled": 22400, "num_env_steps_trained": 6192, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 927.9439356480718, "num_env_steps_trained_throughput_per_sec": 267.19814218437784, "timesteps_total": 22400, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 67200, "timers": {"training_iteration_time_ms": 960.226, "sample_time_ms": 665.992, "load_time_ms": 0.318, "load_throughput": 812044.448, "learn_time_ms": 18.043, "learn_throughput": 14299.444, "synch_weights_time_ms": 9.93}, "counters": {"num_env_steps_sampled": 22400, "num_env_steps_trained": 6192, "num_agent_steps_sampled": 67200, "num_agent_steps_trained": 6192, "last_target_update_ts": 22400, "num_target_updates": 24}, "done": false, "episodes_total": 0, "training_iteration": 14, "trial_id": "7c290_00000", "date": "2023-11-18_19-56-05", "timestamp": 1700366165, "time_this_iter_s": 1.9392666816711426, "time_total_s": 24.425334692001343, "pid": 1618, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x1043e58a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 24.425334692001343, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 76.8, "ram_util_percent": 64.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.072158813476562, "actor_loss": -4.7125444412231445, "critic_loss": 1.2372937202453613, "alpha_loss": -0.07252613455057144, "alpha_value": 0.9928252100944519, "log_alpha_value": -0.0072006541304290295, "target_entropy": -6.0, "policy_t": -0.0032489148434251547, "mean_q": 1.168831706047058, "max_q": 7.686559200286865, "min_q": 0.5510751008987427}, "td_error": [0.31800270080566406, 3.4733853340148926, 4.6690521240234375, 4.850464820861816, 1.1129939556121826, 1.477236270904541, 1.0288965702056885, 2.6398067474365234, 3.373420238494873, 4.146083831787109, 5.381136894226074, 4.224726676940918, 3.938754081726074, 1.667250156402588, 1.635338544845581, 3.948293447494507, 3.105766773223877, 3.208028793334961, 3.7000718116760254, 2.6617860794067383, 4.13603401184082, 5.725527763366699, 2.476271152496338, 3.0384602546691895, 2.5877685546875, 4.550896644592285, 2.939037322998047, 3.315695285797119, 3.1127185821533203, 2.7715744972229004, 3.919262409210205, 3.171290397644043, 2.256016254425049, 3.2876136302948, 3.1972556114196777, 0.9398478865623474, 3.0532350540161133, 4.583560943603516, 5.8131256103515625, 0.9421584606170654, 3.6823294162750244, 5.421289443969727, 2.098254442214966, 3.81827449798584, 5.013072967529297, 3.2663066387176514, 0.7556062340736389, 4.603186130523682, 2.65346097946167, 2.5752010345458984, 2.957524538040161, 4.435949325561523, 4.647890090942383, 5.440479278564453, 4.723183631896973, 1.6429704427719116, 4.189883232116699, 3.3100242614746094, 1.8960610628128052, 4.124012470245361, 4.111154556274414, 3.477555274963379, 5.2761054039001465, 3.681349754333496, 3.5888988971710205, 3.855470657348633, 0.675222635269165, 3.7331490516662598, 3.414463996887207, 1.9583302736282349, 1.2127851247787476, 1.567603588104248, 1.5559444427490234, 2.9938602447509766, 1.1400854587554932, 5.641414642333984, 2.7549710273742676, 2.7120559215545654, 4.001462459564209, 4.659966945648193, 2.8186252117156982, 2.9142935276031494, 4.794195175170898, 4.557558536529541, 2.5462265014648438, 2.5128140449523926], "mean_td_error": 3.2533533573150635, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 25.0, "diff_num_grad_updates_vs_sampler_policy": 24.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.145325660705566, "actor_loss": -4.708745956420898, "critic_loss": 0.34747314453125, "alpha_loss": -0.0730677917599678, "alpha_value": 0.9928237795829773, "log_alpha_value": -0.007202114909887314, "target_entropy": -6.0, "policy_t": 0.016483895480632782, "mean_q": 0.7243728637695312, "max_q": 5.42848014831543, "min_q": 0.49323776364326477}, "td_error": [1.6739964485168457, 1.7063958644866943, 2.871675729751587, 3.8588671684265137, 1.2029836177825928, 0.8121627569198608, 2.6588709354400635, 3.5517044067382812, 1.7731845378875732, 2.5794761180877686, 2.507563352584839, 1.7888729572296143, 2.66464900970459, 2.4435088634490967, 2.2964038848876953, 4.619527816772461, 1.2972877025604248, 2.3875975608825684, 0.8762751817703247, 0.8256325125694275, 2.2661428451538086, 0.6409294605255127, 2.9375627040863037, 2.821850299835205, 2.3356528282165527, 3.277407169342041, 1.7595815658569336, 3.149441719055176, 1.9924973249435425, 2.377495765686035, 1.9029937982559204, 0.5758779644966125, 1.5672483444213867, 2.7441062927246094, 0.9023399353027344, 3.270799160003662, 1.7800402641296387, 3.124946117401123, 1.9462614059448242, 0.8995094299316406, 2.6062893867492676, 0.8977037668228149, 2.257049560546875, 2.7441649436950684, 0.021160542964935303, 1.2869657278060913, 1.133838176727295, 4.079488754272461, 0.9370476007461548, 0.7635853290557861, 1.9031293392181396, 2.4500925540924072, 0.28214067220687866, 3.1836516857147217, 1.0499348640441895, 1.9518611431121826, 2.3568761348724365, 0.30816203355789185, 0.3567303717136383, 1.2738617658615112, 2.1657984256744385, 3.053703784942627, 0.40979111194610596, 1.5045592784881592, 2.666059732437134, 3.630237102508545, 1.342466115951538, 3.1699142456054688, 1.8634798526763916, 2.0053958892822266, 1.896430253982544, 3.6357181072235107, 1.9766137599945068, 1.459700107574463, 0.8124593496322632, 1.6806899309158325, 1.5256092548370361, 1.9667754173278809, 1.9033461809158325, 1.5142329931259155, 2.8072545528411865, 2.089306592941284, 3.622570753097534, 1.0315498113632202, 1.1454823017120361, 1.6671561002731323], "mean_td_error": 1.9890623092651367, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 25.0, "diff_num_grad_updates_vs_sampler_policy": 24.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.093851089477539, "actor_loss": -4.647185802459717, "critic_loss": 0.6410447359085083, "alpha_loss": -0.07275692373514175, "alpha_value": 0.9928178787231445, "log_alpha_value": -0.007208044640719891, "target_entropy": -6.0, "policy_t": 0.015488949604332447, "mean_q": 0.8314272165298462, "max_q": 6.26211404800415, "min_q": 0.4950200617313385}, "td_error": [2.2411949634552, 2.9406192302703857, 3.7425851821899414, 2.248292922973633, 1.5891753435134888, 0.6245948076248169, 3.1435351371765137, 3.3028643131256104, 2.3258044719696045, 2.7849044799804688, 1.8156533241271973, 2.955979347229004, 2.5336251258850098, 0.1664767861366272, 2.6668286323547363, 4.251137733459473, 2.129991054534912, 4.682126998901367, 1.9207484722137451, 0.9069315791130066, 0.23099800944328308, 2.3108267784118652, 4.138622760772705, 1.1066548824310303, 1.4544837474822998, 0.7885411977767944, 0.3998483419418335, 2.8927955627441406, 1.43514883518219, 4.620262622833252, 1.4537813663482666, 3.5046520233154297, 3.449934482574463, 2.9185431003570557, 2.556743621826172, 1.4858510494232178, 0.7742307782173157, 2.129810333251953, 1.3376402854919434, 2.4680981636047363, 2.0692594051361084, 1.9893512725830078, 3.274916172027588, 1.1633673906326294, 3.724827527999878, 1.375542402267456, 2.093790054321289, 1.7119570970535278, 5.166266441345215, 1.9648374319076538, 1.4534270763397217, 2.4276061058044434, 1.5663905143737793, 3.3798675537109375, 0.8223986625671387, 2.119269847869873, 1.1403025388717651, 2.970818519592285, 3.9409356117248535, 2.1649441719055176, 3.2709031105041504, 0.06245684623718262, 2.559751033782959, 2.1335697174072266, 1.702060580253601, 2.186124801635742, 0.8048263192176819, 1.5202531814575195, 1.1995770931243896, 2.3398184776306152, 0.048988550901412964, 0.42256444692611694, 1.4557421207427979, 1.530640959739685, 4.94004487991333, 2.8353211879730225, 1.1676057577133179, 1.9599030017852783, 2.2807788848876953, 3.227036952972412, 1.2860769033432007, 1.8018391132354736, 2.621516704559326, 2.3907887935638428, 1.8720176219940186, 0.9037530422210693], "mean_td_error": 2.1566810607910156, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 25.0, "diff_num_grad_updates_vs_sampler_policy": 24.0}}, "num_env_steps_sampled": 23296, "num_env_steps_trained": 6450, "num_agent_steps_sampled": 69888, "num_agent_steps_trained": 6450, "last_target_update_ts": 23296, "num_target_updates": 25}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 69888, "num_agent_steps_trained": 6450, "num_env_steps_sampled": 23296, "num_env_steps_trained": 6450, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 778.1694858539539, "num_env_steps_trained_throughput_per_sec": 224.07112427491083, "timesteps_total": 23296, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 69888, "timers": {"training_iteration_time_ms": 979.557, "sample_time_ms": 665.586, "load_time_ms": 0.314, "load_throughput": 822662.636, "learn_time_ms": 17.977, "learn_throughput": 14351.691, "synch_weights_time_ms": 9.83}, "counters": {"num_env_steps_sampled": 23296, "num_env_steps_trained": 6450, "num_agent_steps_sampled": 69888, "num_agent_steps_trained": 6450, "last_target_update_ts": 23296, "num_target_updates": 25}, "done": false, "episodes_total": 0, "training_iteration": 15, "trial_id": "7c290_00000", "date": "2023-11-18_19-56-06", "timestamp": 1700366166, "time_this_iter_s": 1.1603341102600098, "time_total_s": 25.585668802261353, "pid": 1618, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x312a47b00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 25.585668802261353, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 70.95, "ram_util_percent": 64.75}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.056191444396973, "actor_loss": -4.801141262054443, "critic_loss": 1.2104058265686035, "alpha_loss": -0.07844443619251251, "alpha_value": 0.9922297596931458, "log_alpha_value": -0.007800611667335033, "target_entropy": -6.0, "policy_t": -0.015203375369310379, "mean_q": 0.9688742756843567, "max_q": 8.039329528808594, "min_q": 0.629239559173584}, "td_error": [5.132607460021973, 4.614102363586426, 5.832273006439209, 2.492298126220703, 3.4426088333129883, 3.527658700942993, 4.127516269683838, 0.61399245262146, 3.089245319366455, 5.474990367889404, 1.0348186492919922, 1.086723804473877, 4.163779258728027, 4.237507343292236, 2.7213964462280273, 2.3907642364501953, 2.242548942565918, 1.2914057970046997, 3.470777988433838, 3.0809531211853027, 2.330744504928589, 1.7741589546203613, 0.12629592418670654, 0.7447198033332825, 3.078150749206543, 4.777812957763672, 2.2554893493652344, 4.211336135864258, 1.5983216762542725, 1.3869554996490479, 4.215115547180176, 2.454371929168701, 3.814558982849121, 3.657771110534668, 1.4840364456176758, 3.7961480617523193, 2.8090925216674805, 4.442051887512207, 3.7130484580993652, 3.2959985733032227, 2.0645923614501953, 3.1686060428619385, 3.7889819145202637, 3.3688321113586426, 3.956666946411133, 1.9365811347961426, 5.3545637130737305, 0.16286462545394897, 2.511913299560547, 3.0310263633728027, 4.462122917175293, 4.54737663269043, 4.828329086303711, 3.891918420791626, 2.5501582622528076, 3.541867256164551, 2.3717408180236816, 3.6932153701782227, 3.5511724948883057, 4.216855525970459, 2.9675114154815674, 3.7170095443725586, 1.9772838354110718, 4.5570244789123535, 3.500441789627075, 4.313453674316406, 1.919905424118042, 4.3599724769592285, 4.58219051361084, 3.0808913707733154, 2.4065561294555664, 3.922894239425659, 2.0463640689849854, 1.7038164138793945, 3.9150171279907227, 3.2070813179016113, 2.4807701110839844, 3.8043558597564697, 4.5050506591796875, 3.7954022884368896, 1.8998088836669922, 3.7920632362365723, 3.310763120651245, 4.178635597229004, 4.257033348083496, 3.2022783756256104], "mean_td_error": 3.191129207611084, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 27.0, "diff_num_grad_updates_vs_sampler_policy": 26.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.097742080688477, "actor_loss": -4.741966247558594, "critic_loss": 0.36218029260635376, "alpha_loss": -0.07878928631544113, "alpha_value": 0.9922276735305786, "log_alpha_value": -0.007802662905305624, "target_entropy": -6.0, "policy_t": -0.02290799468755722, "mean_q": 0.932686984539032, "max_q": 5.680831432342529, "min_q": 0.56144779920578}, "td_error": [0.7910058498382568, 1.8955724239349365, 0.7591062784194946, 1.5032538175582886, 3.1957571506500244, 0.17673692107200623, 3.0048866271972656, 1.2186083793640137, 0.8989363312721252, 1.5153136253356934, 3.3163647651672363, 1.9767568111419678, 2.317692995071411, 3.7577571868896484, 1.1300058364868164, 3.011833429336548, 0.971721887588501, 4.902518272399902, 2.8498687744140625, 2.1205978393554688, 2.202183961868286, 1.7068002223968506, 2.8522326946258545, 1.116701602935791, 2.5025625228881836, 2.055586576461792, 1.273710012435913, 2.7747771739959717, 1.7934980392456055, 1.4737873077392578, 0.9726168513298035, 3.2076292037963867, 1.8603483438491821, 4.471923828125, 0.21258032321929932, 3.4621124267578125, 1.5878607034683228, 0.3428865075111389, 1.9591126441955566, 1.85561203956604, 2.909862756729126, 0.6625566482543945, 3.765418767929077, 2.9752063751220703, 1.793086051940918, 2.5183794498443604, 0.7187552452087402, 2.7342967987060547, 0.8694431781768799, 2.009319543838501, 1.121456503868103, 2.9278974533081055, 2.4940292835235596, 3.676370859146118, 2.1225225925445557, 1.4610390663146973, 3.2421417236328125, 2.1008012294769287, 3.258965015411377, 1.235724925994873, 1.5442612171173096, 0.2896157503128052, 2.3236846923828125, 0.385276734828949, 3.16973876953125, 0.4898216724395752, 2.166461944580078, 3.360435962677002, 4.329660415649414, 0.4181605577468872, 0.45081743597984314, 2.6565210819244385, 2.4828853607177734, 2.688628673553467, 1.5183804035186768, 3.647890329360962, 2.0587315559387207, 2.3643875122070312, 3.1624295711517334, 2.4402081966400146, 2.1993484497070312, 0.5123417377471924, 2.9859514236450195, 3.440993309020996, 2.5591111183166504, 0.9587044715881348], "mean_td_error": 2.0953550338745117, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 27.0, "diff_num_grad_updates_vs_sampler_policy": 26.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.091819763183594, "actor_loss": -4.715227127075195, "critic_loss": 0.6395518183708191, "alpha_loss": -0.0788022056221962, "alpha_value": 0.9922218918800354, "log_alpha_value": -0.007808522786945105, "target_entropy": -6.0, "policy_t": -0.005722492001950741, "mean_q": 0.8445869088172913, "max_q": 6.606607437133789, "min_q": 0.5693447589874268}, "td_error": [1.0777640342712402, 3.0409982204437256, 2.3765997886657715, 2.5914924144744873, 3.034792184829712, 2.482232093811035, 2.016847848892212, 2.330883026123047, 0.8538345098495483, 3.5635077953338623, 2.6538643836975098, 2.5435914993286133, 0.9259852766990662, 2.3775649070739746, 0.7737102508544922, 2.1522622108459473, 0.6435461044311523, 1.9933104515075684, 0.920946478843689, 2.2918145656585693, 1.6648659706115723, 2.8398327827453613, 1.2210674285888672, 2.415174722671509, 3.8307223320007324, 4.151586532592773, 2.4258272647857666, 1.6613373756408691, 0.6617374420166016, 1.9684964418411255, 1.626439094543457, 3.6787891387939453, 1.099461317062378, 2.1044421195983887, 2.1061525344848633, 1.0897927284240723, 4.728879451751709, 0.06068086624145508, 1.811689853668213, 2.0936756134033203, 2.133146286010742, 3.336643695831299, 0.32547643780708313, 0.20283064246177673, 4.87274694442749, 2.106513023376465, 2.0504817962646484, 1.5238556861877441, 4.401494979858398, 3.365449905395508, 1.5143303871154785, 2.5349860191345215, 2.508439064025879, 2.1959328651428223, 1.775219202041626, 2.685703754425049, 1.9694582223892212, 1.9664549827575684, 1.9116400480270386, 2.2033658027648926, 1.1090822219848633, 2.9643588066101074, 4.27717399597168, 4.411986827850342, 1.5037131309509277, 1.4149208068847656, 1.63181734085083, 1.9283915758132935, 0.7450201511383057, 2.384324550628662, 0.338423490524292, 1.111485481262207, 2.531792640686035, 0.0513683557510376, 1.9179588556289673, 1.6704516410827637, 1.7613252401351929, 2.486626386642456, 1.3207093477249146, 1.2871991395950317, 3.7888336181640625, 4.742959499359131, 3.3325204849243164, 2.9028525352478027, 1.7143303155899048, 0.30448153614997864], "mean_td_error": 2.129122018814087, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 27.0, "diff_num_grad_updates_vs_sampler_policy": 26.0}}, "num_env_steps_sampled": 25088, "num_env_steps_trained": 6966, "num_agent_steps_sampled": 75264, "num_agent_steps_trained": 6966, "last_target_update_ts": 25088, "num_target_updates": 27}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 75264, "num_agent_steps_trained": 6966, "num_env_steps_sampled": 25088, "num_env_steps_trained": 6966, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 968.2962941587053, "num_env_steps_trained_throughput_per_sec": 278.8174597019486, "timesteps_total": 25088, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 75264, "timers": {"training_iteration_time_ms": 965.195, "sample_time_ms": 666.557, "load_time_ms": 0.313, "load_throughput": 823789.915, "learn_time_ms": 17.976, "learn_throughput": 14352.3, "synch_weights_time_ms": 9.617}, "counters": {"num_env_steps_sampled": 25088, "num_env_steps_trained": 6966, "num_agent_steps_sampled": 75264, "num_agent_steps_trained": 6966, "last_target_update_ts": 25088, "num_target_updates": 27}, "done": false, "episodes_total": 0, "training_iteration": 16, "trial_id": "7c290_00000", "date": "2023-11-18_19-56-08", "timestamp": 1700366168, "time_this_iter_s": 1.8611819744110107, "time_total_s": 27.446850776672363, "pid": 1618, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x312a46a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 27.446850776672363, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 62.56666666666666, "ram_util_percent": 64.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.06663990020752, "actor_loss": -4.9011359214782715, "critic_loss": 1.346551537513733, "alpha_loss": -0.08456391841173172, "alpha_value": 0.9916347861289978, "log_alpha_value": -0.008400410413742065, "target_entropy": -6.0, "policy_t": -0.015715720131993294, "mean_q": 1.108038067817688, "max_q": 8.435379028320312, "min_q": 0.7124005556106567}, "td_error": [0.8439586162567139, 4.831976890563965, 2.9617462158203125, 4.511398792266846, 4.159907817840576, 1.384045958518982, 1.6233770847320557, 3.800680637359619, 4.860408782958984, 5.386262893676758, 4.460753917694092, 4.474870681762695, 4.486456871032715, 4.079240798950195, 2.7640342712402344, 2.0647706985473633, 3.834022045135498, 3.1119089126586914, 2.1771576404571533, 1.8251533508300781, 4.182038307189941, 5.115978240966797, 1.6058619022369385, 4.467467308044434, 3.761791467666626, 6.561221122741699, 3.7415056228637695, 3.5229978561401367, 4.926943778991699, 2.760735511779785, 5.601816177368164, 4.793503761291504, 3.8228976726531982, 2.12076473236084, 0.9075589179992676, 3.1332151889801025, 5.157126426696777, 3.925286293029785, 3.114461660385132, 3.664750576019287, 4.142675876617432, 4.591442584991455, 5.724614143371582, 3.4540293216705322, 1.5078740119934082, 4.808983325958252, 1.4471956491470337, 5.000838756561279, 3.7883694171905518, 2.7414422035217285, 3.572183609008789, 4.5934038162231445, 0.14554834365844727, 1.9900777339935303, 4.6109113693237305, 5.96232795715332, 3.5838632583618164, 3.8682546615600586, 2.7970268726348877, 4.85945987701416, 3.636113166809082, 1.4804277420043945, 3.8909788131713867, 4.314337730407715, 2.1802501678466797, 3.222640037536621, 3.6022889614105225, 2.869330406188965, 3.850062370300293, 3.0231029987335205, 1.4117240905761719, 2.746978282928467, 3.34238862991333, 3.711545944213867, 3.3036046028137207, 3.6960501670837402, 4.447264194488525, 3.6427950859069824, 3.0366530418395996, 2.9220690727233887, 2.837498903274536, 3.610804319381714, 3.9051389694213867, 6.017787933349609, 0.5176272392272949, 5.1010026931762695], "mean_td_error": 3.5353610515594482, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 29.0, "diff_num_grad_updates_vs_sampler_policy": 28.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.113340377807617, "actor_loss": -4.842978000640869, "critic_loss": 0.36770302057266235, "alpha_loss": -0.08498289436101913, "alpha_value": 0.9916321635246277, "log_alpha_value": -0.008403048850595951, "target_entropy": -6.0, "policy_t": 0.03276323527097702, "mean_q": 0.9461566805839539, "max_q": 4.462416648864746, "min_q": 0.6326982975006104}, "td_error": [4.802366733551025, 1.024917721748352, 1.0441570281982422, 3.397587299346924, 3.869743585586548, 0.31545817852020264, 1.7444000244140625, 2.0187549591064453, 0.8308923244476318, 1.201621413230896, 2.59059476852417, 1.5521461963653564, 2.7117135524749756, 3.303800106048584, 1.2486367225646973, 2.4120891094207764, 0.29468297958374023, 0.25577351450920105, 2.0465173721313477, 1.666227102279663, 0.9253017902374268, 1.8111019134521484, 0.07943058013916016, 2.3976073265075684, 3.6485610008239746, 1.7445197105407715, 1.3013160228729248, 2.4255075454711914, 2.9356284141540527, 2.0626273155212402, 0.9290709495544434, 0.6013877987861633, 2.552504062652588, 4.274718284606934, 0.6415977478027344, 3.1039419174194336, 1.5360112190246582, 1.0246251821517944, 0.34643399715423584, 1.8408339023590088, 2.895904541015625, 4.098644256591797, 0.7020485401153564, 0.531880259513855, 0.09166538715362549, 2.2537922859191895, 1.9941658973693848, 2.7215261459350586, 2.8234992027282715, 0.12991148233413696, 0.041422516107559204, 3.8148207664489746, 2.8584134578704834, 3.3233933448791504, 2.8615269660949707, 1.3928828239440918, 2.3436965942382812, 2.0842247009277344, 2.346501588821411, 3.257269859313965, 3.2105913162231445, 3.193099021911621, 1.1317155361175537, 1.34782874584198, 1.9323146343231201, 3.5479156970977783, 1.1621387004852295, 2.3855767250061035, 2.281066656112671, 3.0470969676971436, 4.064512252807617, 0.8374459743499756, 1.0806119441986084, 0.46759724617004395, 2.4832277297973633, 2.705308198928833, 2.025637626647949, 3.2015295028686523, 2.7003331184387207, 2.6135029792785645, 0.5995469689369202, 3.7195661067962646, 2.7405431270599365, 5.491966247558594, 1.605394959449768, 1.4039925336837769], "mean_td_error": 2.070488929748535, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 29.0, "diff_num_grad_updates_vs_sampler_policy": 28.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.029837608337402, "actor_loss": -4.777255535125732, "critic_loss": 0.6275591850280762, "alpha_loss": -0.08434118330478668, "alpha_value": 0.9916262030601501, "log_alpha_value": -0.008409027010202408, "target_entropy": -6.0, "policy_t": 0.018885834142565727, "mean_q": 0.9373452067375183, "max_q": 5.708700656890869, "min_q": 0.6441457867622375}, "td_error": [2.374979019165039, 3.3947806358337402, 1.7419352531433105, 1.2754697799682617, 3.4972596168518066, 2.11470890045166, 3.2389519214630127, 2.5102577209472656, 3.276543617248535, 2.558184862136841, 2.6250457763671875, 1.6721314191818237, 1.6724090576171875, 2.1408612728118896, 1.064789056777954, 3.6585936546325684, 2.661142349243164, 2.2088475227355957, 0.10876920819282532, 3.720005512237549, 0.9882141351699829, 0.7937114238739014, 2.5706472396850586, 0.7293961048126221, 1.6882436275482178, 1.1229028701782227, 2.632495403289795, 3.1418957710266113, 2.6682162284851074, 2.3989481925964355, 1.1827306747436523, 2.485203266143799, 2.9091176986694336, 2.424730062484741, 1.495222806930542, 1.6181449890136719, 0.2334454357624054, 1.0490596294403076, 0.8228638172149658, 3.6610214710235596, 0.7516630291938782, 0.19753792881965637, 3.0121994018554688, 1.4802329540252686, 0.15045666694641113, 2.5461952686309814, 1.6559648513793945, 0.4169984459877014, 3.3104331493377686, 0.5327417850494385, 2.6360349655151367, 2.02695894241333, 1.3459068536758423, 0.3045865297317505, 1.8938031196594238, 2.6221070289611816, 1.1114282608032227, 0.33910346031188965, 3.911579132080078, 0.20783302187919617, 2.3061137199401855, 3.675567150115967, 0.4892300069332123, 1.7713302373886108, 2.1190805435180664, 1.8587112426757812, 1.697516679763794, 4.186713218688965, 2.0506234169006348, 2.331998348236084, 3.3619842529296875, 2.3294639587402344, 1.446372628211975, 2.7761001586914062, 2.6539692878723145, 2.59991717338562, 3.935987949371338, 4.067026615142822, 1.1265543699264526, 5.376803398132324, 0.39158764481544495, 1.638413429260254, 3.890132427215576, 1.4511690139770508, 1.9022953510284424, 1.1925511360168457], "mean_td_error": 2.060614585876465, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 29.0, "diff_num_grad_updates_vs_sampler_policy": 28.0}}, "num_env_steps_sampled": 26880, "num_env_steps_trained": 7482, "num_agent_steps_sampled": 80640, "num_agent_steps_trained": 7482, "last_target_update_ts": 26880, "num_target_updates": 29}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80640, "num_agent_steps_trained": 7482, "num_env_steps_sampled": 26880, "num_env_steps_trained": 7482, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 940.0857972638652, "num_env_steps_trained_throughput_per_sec": 270.69434787285405, "timesteps_total": 26880, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 80640, "timers": {"training_iteration_time_ms": 964.786, "sample_time_ms": 665.351, "load_time_ms": 0.313, "load_throughput": 824668.825, "learn_time_ms": 18.096, "learn_throughput": 14257.262, "synch_weights_time_ms": 9.636}, "counters": {"num_env_steps_sampled": 26880, "num_env_steps_trained": 7482, "num_agent_steps_sampled": 80640, "num_agent_steps_trained": 7482, "last_target_update_ts": 26880, "num_target_updates": 29}, "done": false, "episodes_total": 0, "training_iteration": 17, "trial_id": "7c290_00000", "date": "2023-11-18_19-56-10", "timestamp": 1700366170, "time_this_iter_s": 1.9155340194702148, "time_total_s": 29.362384796142578, "pid": 1618, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x312a46fc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 29.362384796142578, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 70.8, "ram_util_percent": 64.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.162495613098145, "actor_loss": -5.108006477355957, "critic_loss": 1.1421236991882324, "alpha_loss": -0.09146405011415482, "alpha_value": 0.9910402297973633, "log_alpha_value": -0.009000157006084919, "target_entropy": -6.0, "policy_t": -0.05461183935403824, "mean_q": 1.2110568284988403, "max_q": 7.98898983001709, "min_q": 0.8024560213088989}, "td_error": [2.4597902297973633, 0.3294791579246521, 2.812352180480957, 5.227978706359863, 4.067555904388428, 2.7288758754730225, 2.39054536819458, 0.5569894909858704, 1.3362243175506592, 1.7771849632263184, 2.2881455421447754, 3.3738927841186523, 2.178741455078125, 3.5190863609313965, 4.922021865844727, 3.225141763687134, 3.563053607940674, 2.7665250301361084, 2.981529474258423, 2.385629653930664, 4.0574445724487305, 3.2929747104644775, 1.5945963859558105, 3.7734901905059814, 4.4385175704956055, 1.4948240518569946, 3.373167037963867, 3.502178907394409, 4.350719928741455, 5.368411064147949, 2.4337873458862305, 2.8276758193969727, 3.218350410461426, 3.0333211421966553, 4.343313694000244, 4.619133949279785, 3.6531901359558105, 3.84895658493042, 1.9344322681427002, 2.5255932807922363, 3.246504545211792, 3.6556150913238525, 5.230919361114502, 4.773493766784668, 2.795938491821289, 4.9470624923706055, 1.9161993265151978, 4.598697662353516, 2.3226852416992188, 3.2657699584960938, 3.409139394760132, 3.2165660858154297, 3.1212217807769775, 3.047114610671997, 1.39004385471344, 2.87064790725708, 2.2234694957733154, 0.6103758811950684, 4.743274688720703, 3.9928293228149414, 1.3827277421951294, 2.387421131134033, 3.4283652305603027, 0.8218743801116943, 1.7235335111618042, 2.653919219970703, 4.677641868591309, 4.118465423583984, 3.024918556213379, 2.0163064002990723, 1.8388352394104004, 4.422779083251953, 2.176203489303589, 1.7564496994018555, 2.1207218170166016, 3.2245802879333496, 4.30731725692749, 2.582827091217041, 2.0809407234191895, 2.6344985961914062, 5.824891090393066, 4.473054885864258, 4.748593330383301, 3.6647963523864746, 1.1066200733184814, 0.7797396183013916], "mean_td_error": 3.0457024574279785, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 31.0, "diff_num_grad_updates_vs_sampler_policy": 30.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.06606388092041, "actor_loss": -4.895627021789551, "critic_loss": 0.3544121980667114, "alpha_loss": -0.09062973409891129, "alpha_value": 0.9910368919372559, "log_alpha_value": -0.009003491140902042, "target_entropy": -6.0, "policy_t": 0.01656412146985531, "mean_q": 1.130927324295044, "max_q": 5.784942150115967, "min_q": 0.7161370515823364}, "td_error": [0.4834664463996887, 1.9290759563446045, 1.0528817176818848, 1.840686321258545, 2.342055320739746, 3.113511085510254, 2.008147716522217, 0.06237763166427612, 0.6577905416488647, 1.3305144309997559, 1.5154249668121338, 0.17724570631980896, 0.811866283416748, 3.960646867752075, 1.7161672115325928, 1.0708197355270386, 2.093914031982422, 4.814703941345215, 2.1062164306640625, 2.3337721824645996, 2.0810179710388184, 1.6875481605529785, 1.3662669658660889, 0.4940064549446106, 1.2213311195373535, 2.035158634185791, 0.42882442474365234, 2.9405462741851807, 2.1673922538757324, 2.622748374938965, 0.7015789747238159, 1.6198482513427734, 1.150457501411438, 2.7044010162353516, 2.175884246826172, 2.991981029510498, 1.2966668605804443, 2.2409567832946777, 2.806859016418457, 1.6482853889465332, 1.9483768939971924, 1.5621064901351929, 2.2395846843719482, 3.062619924545288, 2.4209885597229004, 1.6543116569519043, 2.0153157711029053, 0.9860325455665588, 2.088193893432617, 0.1767362356185913, 2.0658974647521973, 3.7895913124084473, 3.4657301902770996, 0.956366777420044, 4.499317646026611, 3.156151056289673, 0.17424285411834717, 4.154536247253418, 1.4941484928131104, 2.5679712295532227, 0.6163384914398193, 2.357086658477783, 2.0223851203918457, 1.3760972023010254, 3.849605083465576, 3.165532112121582, 0.5787805318832397, 1.8696208000183105, 1.886048674583435, 2.481722831726074, 2.647718667984009, 2.114182949066162, 3.037562370300293, 1.7048578262329102, 1.6769335269927979, 4.583637237548828, 0.050787389278411865, 1.7397806644439697, 2.4946343898773193, 3.620004653930664, 4.7532196044921875, 1.5049984455108643, 1.605846643447876, 1.218422293663025, 1.6596490144729614, 1.8995003700256348], "mean_td_error": 2.009258508682251, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 31.0, "diff_num_grad_updates_vs_sampler_policy": 30.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.144120216369629, "actor_loss": -4.954484939575195, "critic_loss": 0.6232868432998657, "alpha_loss": -0.09139151871204376, "alpha_value": 0.9910311698913574, "log_alpha_value": -0.009009309113025665, "target_entropy": -6.0, "policy_t": 0.004064857494086027, "mean_q": 1.1021174192428589, "max_q": 7.113595008850098, "min_q": 0.7241645455360413}, "td_error": [3.0588459968566895, 1.92564058303833, 0.5102415084838867, 2.6339027881622314, 1.8138006925582886, 3.5097784996032715, 2.0553507804870605, 2.362483024597168, 4.472375869750977, 2.604748249053955, 0.6690768003463745, 3.7832205295562744, 3.758418083190918, 2.9841809272766113, 2.6623880863189697, 0.9871120452880859, 1.3102779388427734, 2.8066773414611816, 0.7284870743751526, 2.3948302268981934, 2.3685812950134277, 2.690162181854248, 2.6056876182556152, 3.4141862392425537, 3.212179183959961, 1.9962544441223145, 2.9558069705963135, 3.2674474716186523, 1.9195914268493652, 3.559786081314087, 2.6763787269592285, 3.499715805053711, 1.5082168579101562, 1.1656874418258667, 3.9287657737731934, 1.8706536293029785, 2.4716787338256836, 0.5974822640419006, 3.7968156337738037, 3.5744388103485107, 2.81693696975708, 1.999538540840149, 1.618798017501831, 0.859245777130127, 3.093729257583618, 0.9917738437652588, 1.7340633869171143, 2.0949573516845703, 1.0822670459747314, 1.7884495258331299, 0.7157898545265198, 3.1920204162597656, 0.4679720103740692, 2.0485851764678955, 3.210568904876709, 1.7660932540893555, 2.3512277603149414, 2.7010741233825684, 0.45491474866867065, 2.2175259590148926, 1.3978488445281982, 2.4223361015319824, 1.2027275562286377, 1.370218276977539, 1.4596630334854126, 0.08178955316543579, 2.6406102180480957, 1.867989182472229, 1.7189123630523682, 2.5108683109283447, 2.9635958671569824, 0.9553025364875793, 1.313099980354309, 2.554727077484131, 4.187877655029297, 0.1828339695930481, 0.8108373284339905, 1.032546877861023, 0.642872154712677, 2.245344638824463, 0.7361758947372437, 2.2398180961608887, 3.225687026977539, 0.7161425352096558, 0.47658178210258484, 2.4653000831604004], "mean_td_error": 2.101611375808716, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 31.0, "diff_num_grad_updates_vs_sampler_policy": 30.0}}, "num_env_steps_sampled": 28672, "num_env_steps_trained": 7998, "num_agent_steps_sampled": 86016, "num_agent_steps_trained": 7998, "last_target_update_ts": 28672, "num_target_updates": 31}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 86016, "num_agent_steps_trained": 7998, "num_env_steps_sampled": 28672, "num_env_steps_trained": 7998, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 960.6585848670757, "num_env_steps_trained_throughput_per_sec": 276.61820858895703, "timesteps_total": 28672, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 86016, "timers": {"training_iteration_time_ms": 961.465, "sample_time_ms": 661.791, "load_time_ms": 0.313, "load_throughput": 824857.407, "learn_time_ms": 18.222, "learn_throughput": 14158.822, "synch_weights_time_ms": 9.69}, "counters": {"num_env_steps_sampled": 28672, "num_env_steps_trained": 7998, "num_agent_steps_sampled": 86016, "num_agent_steps_trained": 7998, "last_target_update_ts": 28672, "num_target_updates": 31}, "done": false, "episodes_total": 0, "training_iteration": 18, "trial_id": "7c290_00000", "date": "2023-11-18_19-56-12", "timestamp": 1700366172, "time_this_iter_s": 1.8764638900756836, "time_total_s": 31.23884868621826, "pid": 1618, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x312ac0cc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 31.23884868621826, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 70.2, "ram_util_percent": 64.83333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.163636207580566, "actor_loss": -5.2340216636657715, "critic_loss": 1.1079039573669434, "alpha_loss": -0.09757402539253235, "alpha_value": 0.990445613861084, "log_alpha_value": -0.009600306861102581, "target_entropy": -6.0, "policy_t": -2.393426711932989e-06, "mean_q": 1.1903961896896362, "max_q": 7.379517078399658, "min_q": 0.8964836597442627}, "td_error": [2.0529685020446777, 3.9072413444519043, 2.1041297912597656, 3.6901328563690186, 2.7453320026397705, 4.143942832946777, 4.554986000061035, 4.203285217285156, 2.689115524291992, 1.5740184783935547, 2.4584505558013916, 1.2742929458618164, 3.256237745285034, 2.297909736633301, 3.6769604682922363, 3.7737255096435547, 1.6590335369110107, 5.281847953796387, 4.076482772827148, 3.465423583984375, 5.628270149230957, 0.7055418491363525, 2.2617058753967285, 4.431078910827637, 2.1058833599090576, 2.7880873680114746, 3.16915225982666, 3.657886028289795, 3.7980010509490967, 3.733630657196045, 5.925034523010254, 3.796799421310425, 2.418609619140625, 0.9335170388221741, 1.8520207405090332, 0.5595455169677734, 1.8774558305740356, 3.889653205871582, 2.823953628540039, 0.08452951908111572, 3.50339937210083, 2.8286333084106445, 1.7493104934692383, 3.076748847961426, 2.2554428577423096, 3.4654526710510254, 0.12788861989974976, 3.1803503036499023, 3.352181911468506, 1.077694296836853, 1.0462092161178589, 2.4615232944488525, 2.7492213249206543, 3.2689554691314697, 4.041903495788574, 0.762283444404602, 4.08207893371582, 4.317793846130371, 1.3598637580871582, 3.796052932739258, 2.939462184906006, 3.339949131011963, 3.265909433364868, 3.454071521759033, 3.503347873687744, 1.220689296722412, 4.162842273712158, 3.7183775901794434, 3.0962142944335938, 0.612433671951294, 2.3118062019348145, 4.340696334838867, 2.3387792110443115, 1.1842399835586548, 1.19779634475708, 4.316009044647217, 2.7187821865081787, 3.121450424194336, 1.7626124620437622, 2.381378173828125, 2.6353440284729004, 1.0796918869018555, 5.900729179382324, 4.060976028442383, 4.115547180175781, 3.130234718322754], "mean_td_error": 2.8806772232055664, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 33.0, "diff_num_grad_updates_vs_sampler_policy": 32.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.040996551513672, "actor_loss": -5.003272533416748, "critic_loss": 0.3053840100765228, "alpha_loss": -0.09643230587244034, "alpha_value": 0.9904420971870422, "log_alpha_value": -0.00960385799407959, "target_entropy": -6.0, "policy_t": 0.06227479130029678, "mean_q": 1.1741834878921509, "max_q": 4.8837456703186035, "min_q": 0.8092846870422363}, "td_error": [2.204707145690918, 3.224027156829834, 3.1916182041168213, 0.09319055080413818, 0.16433840990066528, 3.329339027404785, 1.6577088832855225, 2.4785327911376953, 3.8670644760131836, 0.8044116497039795, 2.875992774963379, 2.9675521850585938, 1.126173496246338, 2.2148804664611816, 0.9624378085136414, 1.635528326034546, 0.354977011680603, 1.4211513996124268, 1.2886333465576172, 3.358283519744873, 0.8666073679924011, 1.9249186515808105, 1.6518723964691162, 1.800417184829712, 2.850923538208008, 2.199039936065674, 1.9674068689346313, 1.463184118270874, 4.370701789855957, 2.366909980773926, 2.458418369293213, 0.2646303176879883, 2.291675090789795, 3.0733065605163574, 1.541841745376587, 0.8665891885757446, 1.1057133674621582, 1.1204071044921875, 1.6426031589508057, 2.8645379543304443, 1.6731479167938232, 1.9965180158615112, 1.8936376571655273, 2.122728109359741, 2.066042423248291, 3.6549768447875977, 1.9715096950531006, 1.9668773412704468, 1.5729364156723022, 2.809027671813965, 2.581817626953125, 0.3221313953399658, 0.9261378049850464, 1.2029492855072021, 0.9858524799346924, 0.3826925754547119, 1.5238559246063232, 2.0669002532958984, 0.8481037616729736, 0.9503588676452637, 0.9958890676498413, 1.7894275188446045, 1.879840612411499, 1.9420747756958008, 1.8440651893615723, 3.2178335189819336, 0.5527486801147461, 1.237514853477478, 1.7450296878814697, 1.304531455039978, 1.7089946269989014, 2.1264429092407227, 2.154670238494873, 1.3213531970977783, 3.247621536254883, 2.7128615379333496, 1.275512933731079, 0.14747118949890137, 3.214766502380371, 2.0942459106445312, 0.5447030067443848, 1.066225528717041, 0.2156776487827301, 2.1177122592926025, 0.10746109485626221, 1.9599887132644653], "mean_td_error": 1.7901756763458252, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 33.0, "diff_num_grad_updates_vs_sampler_policy": 32.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.10261058807373, "actor_loss": -5.037648677825928, "critic_loss": 0.5076397061347961, "alpha_loss": -0.09708482027053833, "alpha_value": 0.9904361367225647, "log_alpha_value": -0.009609874337911606, "target_entropy": -6.0, "policy_t": -0.052603237330913544, "mean_q": 1.0041950941085815, "max_q": 1.2380508184432983, "min_q": 0.8082077503204346}, "td_error": [0.9893409609794617, 1.2927510738372803, 2.3456320762634277, 0.7118679881095886, 1.8775889873504639, 1.5222333669662476, 2.532154083251953, 2.8313546180725098, 2.4034640789031982, 3.998973846435547, 0.40353071689605713, 2.7989768981933594, 2.014585494995117, 2.2666878700256348, 0.23263001441955566, 1.1449717283248901, 0.8023209571838379, 0.3994193971157074, 1.1290737390518188, 3.8327789306640625, 2.187649726867676, 0.21743696928024292, 0.14040333032608032, 0.8049248456954956, 2.8111486434936523, 1.2689142227172852, 2.139726400375366, 3.2608530521392822, 3.51650333404541, 2.9665956497192383, 2.0831637382507324, 1.493971824645996, 3.798579216003418, 1.5163912773132324, 2.044797897338867, 2.0534987449645996, 2.876951217651367, 2.2579264640808105, 2.2605843544006348, 0.2322063148021698, 3.04367733001709, 0.4787774980068207, 0.37063607573509216, 1.575809121131897, 1.7718753814697266, 2.825155019760132, 1.2123208045959473, 1.5672974586486816, 3.0522923469543457, 2.0062808990478516, 1.3911595344543457, 0.12011000514030457, 1.5471242666244507, 0.8388397097587585, 0.9814882278442383, 0.7442460656166077, 2.617791175842285, 0.44200587272644043, 0.3696088492870331, 1.367307186126709, 0.08088713884353638, 3.36952543258667, 2.1511454582214355, 2.8596410751342773, 1.8777360916137695, 1.4159046411514282, 1.5541200637817383, 2.1152148246765137, 3.3233141899108887, 0.1555907130241394, 2.2844300270080566, 0.3135943114757538, 1.1363134384155273, 4.331097602844238, 2.4965686798095703, 1.9076440334320068, 0.07679006457328796, 1.4500863552093506, 0.11485052108764648, 2.5535902976989746, 1.042755365371704, 1.8161818981170654, 2.270242929458618, 3.4228038787841797, 3.254509449005127, 0.5470064878463745], "mean_td_error": 1.7640455961227417, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 33.0, "diff_num_grad_updates_vs_sampler_policy": 32.0}}, "num_env_steps_sampled": 30464, "num_env_steps_trained": 8514, "num_agent_steps_sampled": 91392, "num_agent_steps_trained": 8514, "last_target_update_ts": 30464, "num_target_updates": 33}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 91392, "num_agent_steps_trained": 8514, "num_env_steps_sampled": 30464, "num_env_steps_trained": 8514, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 933.7660277896352, "num_env_steps_trained_throughput_per_sec": 268.87459282335476, "timesteps_total": 30464, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 91392, "timers": {"training_iteration_time_ms": 966.677, "sample_time_ms": 665.383, "load_time_ms": 0.316, "load_throughput": 816825.507, "learn_time_ms": 18.218, "learn_throughput": 14161.675, "synch_weights_time_ms": 9.7}, "counters": {"num_env_steps_sampled": 30464, "num_env_steps_trained": 8514, "num_agent_steps_sampled": 91392, "num_agent_steps_trained": 8514, "last_target_update_ts": 30464, "num_target_updates": 33}, "done": false, "episodes_total": 0, "training_iteration": 19, "trial_id": "7c290_00000", "date": "2023-11-18_19-56-14", "timestamp": 1700366174, "time_this_iter_s": 1.9279539585113525, "time_total_s": 33.166802644729614, "pid": 1618, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x312ac11c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 33.166802644729614, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 68.8, "ram_util_percent": 64.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.081016540527344, "actor_loss": -5.317947864532471, "critic_loss": 0.9531037211418152, "alpha_loss": -0.10283465683460236, "alpha_value": 0.9898510575294495, "log_alpha_value": -0.010200822725892067, "target_entropy": -6.0, "policy_t": -0.038967493921518326, "mean_q": 1.4303358793258667, "max_q": 8.429290771484375, "min_q": 0.9968896508216858}, "td_error": [3.4496724605560303, 2.8677477836608887, 1.3569773435592651, 1.3481919765472412, 2.341446876525879, 4.063694000244141, 3.0391836166381836, 2.18782377243042, 3.515533208847046, 2.818871021270752, 3.5018725395202637, 3.7643253803253174, 0.7864866256713867, 3.2995734214782715, 3.6699719429016113, 2.4497780799865723, 0.39976125955581665, 3.631009817123413, 4.362154960632324, 3.6654281616210938, 3.7382075786590576, 1.1235069036483765, 3.667750835418701, 3.4482059478759766, 3.476536750793457, 4.060801982879639, 2.4558730125427246, 3.6735682487487793, 1.7302069664001465, 1.3883578777313232, 3.917036771774292, 1.1765358448028564, 1.3778421878814697, 3.5776455402374268, 0.10877203941345215, 3.4197821617126465, 2.277283191680908, 2.6410350799560547, 2.3070452213287354, 2.6724233627319336, 1.8587119579315186, 2.0387215614318848, 1.0183682441711426, 3.0697412490844727, 1.098751425743103, 3.019740104675293, 4.660163879394531, 3.8713321685791016, 2.910694122314453, 3.2427866458892822, 1.6882994174957275, 3.6141414642333984, 3.3040764331817627, 3.4687938690185547, 3.449162483215332, 2.541987895965576, 2.466437816619873, 0.6643159985542297, 1.7294456958770752, 4.087438106536865, 5.002461910247803, 1.6407020092010498, 1.3855658769607544, 1.6641870737075806, 3.4531493186950684, 2.1338016986846924, 2.5349552631378174, 2.7890007495880127, 1.3979490995407104, 1.1260126829147339, 3.0833897590637207, 2.9686899185180664, 5.816697120666504, 5.061703681945801, 1.4036993980407715, 2.0445454120635986, 0.4215507507324219, 2.2737631797790527, 1.1534645557403564, 3.0758004188537598, 4.615987777709961, 1.6662113666534424, 3.589153528213501, 3.6050963401794434, 3.4281415939331055, 1.3415560722351074], "mean_td_error": 2.688817024230957, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 35.0, "diff_num_grad_updates_vs_sampler_policy": 34.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.120923042297363, "actor_loss": -5.203303813934326, "critic_loss": 0.27919238805770874, "alpha_loss": -0.10327361524105072, "alpha_value": 0.9898478984832764, "log_alpha_value": -0.010203971527516842, "target_entropy": -6.0, "policy_t": -0.043159037828445435, "mean_q": 1.3022774457931519, "max_q": 6.674155235290527, "min_q": 0.8955583572387695}, "td_error": [0.14484107494354248, 3.656494140625, 1.4358134269714355, 1.2581782341003418, 2.4016456604003906, 1.3121490478515625, 2.1594667434692383, 1.1163194179534912, 3.1554384231567383, 1.0637636184692383, 2.164520740509033, 3.2391271591186523, 1.6980860233306885, 1.094273567199707, 1.2657790184020996, 0.8726694583892822, 1.9969338178634644, 0.4401364326477051, 1.9174695014953613, 1.1224987506866455, 2.1366379261016846, 2.553769111633301, 0.37888991832733154, 2.107058048248291, 2.772614002227783, 0.9531985521316528, 0.9012852311134338, 3.5333895683288574, 1.2754473686218262, 0.6435422897338867, 2.114767074584961, 3.501344680786133, 2.497046709060669, 2.183717727661133, 0.07362067699432373, 1.7665362358093262, 1.1517404317855835, 0.8963494300842285, 3.268795967102051, 2.4626874923706055, 0.31736665964126587, 1.0212950706481934, 4.474366664886475, 1.3276455402374268, 1.2910066843032837, 1.0992780923843384, 0.8136451244354248, 2.224653720855713, 1.3849692344665527, 0.7196776270866394, 1.3044764995574951, 2.0092415809631348, 0.5774731636047363, 1.4697117805480957, 1.4056217670440674, 2.1777429580688477, 3.9441328048706055, 4.091272354125977, 1.5344882011413574, 2.0140693187713623, 1.084320068359375, 1.4759483337402344, 0.5438098311424255, 2.4985084533691406, 1.9331358671188354, 1.5732474327087402, 1.8735878467559814, 1.2598586082458496, 0.9258562922477722, 0.459710955619812, 2.2120003700256348, 0.991275429725647, 2.336026191711426, 2.0656943321228027, 0.3977912962436676, 0.06644487380981445, 1.8891730308532715, 0.13423961400985718, 0.8348793983459473, 0.3893178701400757, 1.9407551288604736, 2.7355456352233887, 2.916322708129883, 2.7178168296813965, 1.0168018341064453, 0.7444144487380981], "mean_td_error": 1.6617053747177124, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 35.0, "diff_num_grad_updates_vs_sampler_policy": 34.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.131524085998535, "actor_loss": -5.189323425292969, "critic_loss": 0.47580674290657043, "alpha_loss": -0.10344833880662918, "alpha_value": 0.9898414015769958, "log_alpha_value": -0.01021054107695818, "target_entropy": -6.0, "policy_t": -0.031230870634317398, "mean_q": 1.3752020597457886, "max_q": 6.9049177169799805, "min_q": 0.9092050194740295}, "td_error": [2.338474750518799, 1.3555715084075928, 0.556389331817627, 3.523874282836914, 3.496368646621704, 1.304786205291748, 0.053220123052597046, 0.12057340145111084, 0.5145143270492554, 2.9358253479003906, 2.867608070373535, 2.9260048866271973, 3.335005521774292, 2.611926317214966, 1.2332226037979126, 3.1348681449890137, 0.09939402341842651, 1.303208351135254, 3.5772862434387207, 0.11641347408294678, 1.315970540046692, 2.972574234008789, 1.321461796760559, 1.829262375831604, 3.7916040420532227, 0.9469858407974243, 1.9905109405517578, 2.216897487640381, 2.5777764320373535, 2.347358226776123, 3.3996946811676025, 0.29397836327552795, 1.7979462146759033, 0.9524796009063721, 1.2753676176071167, 1.3702558279037476, 1.715391993522644, 1.1394023895263672, 0.11432397365570068, 1.9100282192230225, 0.26263803243637085, 3.4731690883636475, 2.7462310791015625, 0.7056122422218323, 1.0970330238342285, 0.890325129032135, 1.5019422769546509, 2.8008956909179688, 0.2651854157447815, 1.4307596683502197, 4.304830074310303, 0.56327223777771, 0.9576061964035034, 1.7853851318359375, 2.536048412322998, 0.6076154112815857, 0.24188262224197388, 0.9346234798431396, 1.2700120210647583, 0.7779102921485901, 0.9284476041793823, 1.1269316673278809, 2.0947837829589844, 4.224509239196777, 1.588392972946167, 1.3747797012329102, 2.796353816986084, 0.6611608266830444, 1.3431737422943115, 3.1080007553100586, 0.9493517875671387, 0.865469217300415, 3.192974090576172, 0.12408530712127686, 0.6035128235816956, 1.35965895652771, 0.43600308895111084, 2.832700490951538, 2.574989080429077, 0.562181830406189, 1.9490406513214111, 1.6049294471740723, 0.15946006774902344, 2.1159067153930664, 2.069622278213501, 2.0091285705566406], "mean_td_error": 1.6801433563232422, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 35.0, "diff_num_grad_updates_vs_sampler_policy": 34.0}}, "num_env_steps_sampled": 32256, "num_env_steps_trained": 9030, "num_agent_steps_sampled": 96768, "num_agent_steps_trained": 9030, "last_target_update_ts": 32256, "num_target_updates": 35}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96768, "num_agent_steps_trained": 9030, "num_env_steps_sampled": 32256, "num_env_steps_trained": 9030, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 869.8252186832184, "num_env_steps_trained_throughput_per_sec": 250.46306520119458, "timesteps_total": 32256, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 96768, "timers": {"training_iteration_time_ms": 960.139, "sample_time_ms": 679.198, "load_time_ms": 0.316, "load_throughput": 816578.956, "learn_time_ms": 18.352, "learn_throughput": 14058.663, "synch_weights_time_ms": 9.527}, "counters": {"num_env_steps_sampled": 32256, "num_env_steps_trained": 9030, "num_agent_steps_sampled": 96768, "num_agent_steps_trained": 9030, "last_target_update_ts": 32256, "num_target_updates": 35}, "done": false, "episodes_total": 0, "training_iteration": 20, "trial_id": "7c290_00000", "date": "2023-11-18_19-56-16", "timestamp": 1700366176, "time_this_iter_s": 2.0684220790863037, "time_total_s": 35.23522472381592, "pid": 1618, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x312a45c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 35.23522472381592, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 69.39999999999999, "ram_util_percent": 64.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.103702545166016, "actor_loss": -5.477357864379883, "critic_loss": 1.0081626176834106, "alpha_loss": -0.10913446545600891, "alpha_value": 0.9892566800117493, "log_alpha_value": -0.010801433585584164, "target_entropy": -6.0, "policy_t": 0.01435453537851572, "mean_q": 1.4658629894256592, "max_q": 9.237143516540527, "min_q": 1.104577660560608}, "td_error": [4.369565963745117, 4.144204139709473, 5.3171586990356445, 4.462513446807861, 2.7190589904785156, 4.240118980407715, 4.485130310058594, 3.148714065551758, 3.4459099769592285, 0.6371310353279114, 0.8627402782440186, 3.3832693099975586, 3.318091869354248, 3.5079705715179443, 2.142970561981201, 4.070075035095215, 0.6562613844871521, 3.153393268585205, 1.2160038948059082, 1.763054370880127, 1.9696218967437744, 2.1368675231933594, 1.9215915203094482, 5.088476181030273, 2.0307483673095703, 0.4571242332458496, 5.514443397521973, 3.285276412963867, 1.615330696105957, 0.5155659317970276, 4.620063781738281, 3.471048355102539, 2.0632810592651367, 2.8943920135498047, 1.9887864589691162, 0.5000191330909729, 2.379167079925537, 3.3637754917144775, 3.6522152423858643, 1.5298564434051514, 2.910242795944214, 2.692960500717163, 3.5177106857299805, 2.681575059890747, 2.268008232116699, 5.32945442199707, 1.8925234079360962, 0.32824230194091797, 1.0138976573944092, 3.281315803527832, 2.73239803314209, 2.418539524078369, 3.41736102104187, 0.7820607423782349, 4.123298168182373, 0.29994988441467285, 2.283799409866333, 1.037048578262329, 3.4186110496520996, 3.229149341583252, 2.5602922439575195, 4.073965072631836, 1.3381305932998657, 3.6013388633728027, 5.036958694458008, 1.0749447345733643, 2.611288547515869, 2.023597240447998, 2.7277276515960693, 5.09739875793457, 0.44470125436782837, 3.2387125492095947, 2.8414053916931152, 3.57614803314209, 4.171570301055908, 2.225402355194092, 1.0141921043395996, 0.14792370796203613, 1.5584014654159546, 2.032100200653076, 3.3080217838287354, 3.088897943496704, 4.613247871398926, 1.4614815711975098, 3.6461315155029297, 2.3389382362365723], "mean_td_error": 2.6924657821655273, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 37.0, "diff_num_grad_updates_vs_sampler_policy": 36.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.112530708312988, "actor_loss": -5.306417942047119, "critic_loss": 0.2923422157764435, "alpha_loss": -0.1092570349574089, "alpha_value": 0.9892540574073792, "log_alpha_value": -0.010804123245179653, "target_entropy": -6.0, "policy_t": 0.011769747361540794, "mean_q": 1.4677562713623047, "max_q": 5.941941738128662, "min_q": 0.9992772340774536}, "td_error": [3.1682870388031006, 1.859788417816162, 2.119549512863159, 0.42543649673461914, 1.6499170064926147, 1.7635329961776733, 0.07355701923370361, 1.559023141860962, 1.7583754062652588, 0.3228229880332947, 1.8127169609069824, 1.9935047626495361, 1.911728858947754, 2.932361602783203, 1.1614381074905396, 3.5242395401000977, 2.8469152450561523, 0.5240982174873352, 1.4499951601028442, 1.0452545881271362, 1.698915958404541, 0.5090141296386719, 2.0575754642486572, 3.4477763175964355, 1.818843126296997, 0.3926742672920227, 3.50358247756958, 1.996861219406128, 1.9355977773666382, 0.08391106128692627, 0.9360342025756836, 0.4201098084449768, 0.39471501111984253, 1.175048589706421, 1.4020700454711914, 3.1993870735168457, 1.5987277030944824, 2.290032386779785, 4.05302619934082, 0.8907607793807983, 0.6232948899269104, 3.1956849098205566, 0.6434142589569092, 1.7190277576446533, 1.3966727256774902, 1.4125802516937256, 2.0304808616638184, 2.721282958984375, 3.282334327697754, 3.530618667602539, 0.512017011642456, 0.35149085521698, 3.4651870727539062, 1.2953822612762451, 4.155899524688721, 2.3382060527801514, 1.9243106842041016, 1.6393433809280396, 1.6288615465164185, 1.8518544435501099, 0.5970788598060608, 1.6750712394714355, 1.8987958431243896, 1.176640510559082, 2.6390645503997803, 1.4210994243621826, 0.6120707392692566, 1.1562373638153076, 3.522732973098755, 0.42186492681503296, 0.7794967889785767, 1.4106076955795288, 2.1966512203216553, 1.0100057125091553, 0.21334552764892578, 2.4758858680725098, 0.064211905002594, 1.831468105316162, 2.619047164916992, 2.424471616744995, 1.770479679107666, 2.1083221435546875, 1.9874775409698486, 2.1753427982330322, 1.7673449516296387, 1.151739478111267], "mean_td_error": 1.727112889289856, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 37.0, "diff_num_grad_updates_vs_sampler_policy": 36.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.13710880279541, "actor_loss": -5.364635944366455, "critic_loss": 0.45279666781425476, "alpha_loss": -0.10959646105766296, "alpha_value": 0.9892468452453613, "log_alpha_value": -0.010811412706971169, "target_entropy": -6.0, "policy_t": 0.0005427991854958236, "mean_q": 1.4876493215560913, "max_q": 6.92459774017334, "min_q": 1.0021823644638062}, "td_error": [3.3324832916259766, 0.5579630136489868, 3.491652011871338, 2.1371593475341797, 3.8040764331817627, 2.7477164268493652, 0.300808310508728, 4.176969528198242, 1.0086009502410889, 3.567586898803711, 4.2177228927612305, 0.7585713863372803, 1.0043659210205078, 2.2447831630706787, 2.2308826446533203, 1.5212956666946411, 1.2871298789978027, 0.9534863829612732, 0.9724056124687195, 2.301323413848877, 0.9297112226486206, 0.9712636470794678, 1.2680662870407104, 0.08776915073394775, 1.2505950927734375, 0.339269757270813, 2.013301372528076, 1.3035742044448853, 3.871154308319092, 1.9866386651992798, 0.748937726020813, 1.0461881160736084, 4.508763313293457, 1.9208784103393555, 0.3460323214530945, 1.4747707843780518, 0.24272435903549194, 3.240835666656494, 1.5920016765594482, 2.582648754119873, 1.3071651458740234, 1.4909958839416504, 1.9727381467819214, 0.772576093673706, 2.9887044429779053, 2.725367546081543, 0.094093918800354, 1.069719910621643, 0.5461288690567017, 2.615058422088623, 0.5926976799964905, 0.8173348307609558, 0.8054888248443604, 0.3026118278503418, 1.053274154663086, 0.7686705589294434, 1.218183159828186, 0.6779493093490601, 3.020930290222168, 2.185147285461426, 2.2109909057617188, 2.7773501873016357, 1.9382874965667725, 0.3085695505142212, 1.8288568258285522, 2.1696155071258545, 0.2539285719394684, 2.78765869140625, 2.8725295066833496, 1.6261177062988281, 1.87886643409729, 1.4060217142105103, 3.004155158996582, 1.1092442274093628, 1.6422851085662842, 0.5736092329025269, 0.15051448345184326, 1.5499622821807861, 1.0926424264907837, 0.6408397555351257, 0.7364503741264343, 0.20969927310943604, 0.5592606663703918, 1.9392609596252441, 1.8240315914154053, 0.19409501552581787], "mean_td_error": 1.6122301816940308, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 37.0, "diff_num_grad_updates_vs_sampler_policy": 36.0}}, "num_env_steps_sampled": 34048, "num_env_steps_trained": 9546, "num_agent_steps_sampled": 102144, "num_agent_steps_trained": 9546, "last_target_update_ts": 34048, "num_target_updates": 37}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 102144, "num_agent_steps_trained": 9546, "num_env_steps_sampled": 34048, "num_env_steps_trained": 9546, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 843.7234153398139, "num_env_steps_trained_throughput_per_sec": 242.9471441491875, "timesteps_total": 34048, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 102144, "timers": {"training_iteration_time_ms": 987.463, "sample_time_ms": 686.447, "load_time_ms": 0.317, "load_throughput": 813265.017, "learn_time_ms": 18.282, "learn_throughput": 14112.217, "synch_weights_time_ms": 9.707}, "counters": {"num_env_steps_sampled": 34048, "num_env_steps_trained": 9546, "num_agent_steps_sampled": 102144, "num_agent_steps_trained": 9546, "last_target_update_ts": 34048, "num_target_updates": 37}, "done": false, "episodes_total": 0, "training_iteration": 21, "trial_id": "7c290_00000", "date": "2023-11-18_19-56-18", "timestamp": 1700366178, "time_this_iter_s": 2.1333351135253906, "time_total_s": 37.36855983734131, "pid": 1618, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x312ac1e40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 37.36855983734131, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 62.1, "ram_util_percent": 64.89999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.10720443725586, "actor_loss": -5.67607307434082, "critic_loss": 0.820625901222229, "alpha_loss": -0.11524336785078049, "alpha_value": 0.9886626601219177, "log_alpha_value": -0.011402100324630737, "target_entropy": -6.0, "policy_t": 0.048048775643110275, "mean_q": 1.9846231937408447, "max_q": 9.435525894165039, "min_q": 1.2200171947479248}, "td_error": [4.411001205444336, 0.1215294599533081, 0.22678864002227783, 3.1055908203125, 2.4143614768981934, 6.9727301597595215, 3.445887327194214, 5.206795692443848, 0.9994162321090698, 0.8967330455780029, 2.1942849159240723, 4.233603477478027, 0.7395482659339905, 1.4058752059936523, 1.8712421655654907, 1.406318187713623, 2.9939637184143066, 0.32780349254608154, 1.2908070087432861, 1.2663755416870117, 0.2701519727706909, 1.7357639074325562, 4.705095291137695, 0.265344500541687, 4.34707498550415, 3.7770917415618896, 1.8562195301055908, 3.8089661598205566, 3.085690498352051, 0.5978446006774902, 0.71222984790802, 0.13123726844787598, 3.969609022140503, 3.578735828399658, 4.234461784362793, 2.498087167739868, 1.4117169380187988, 1.1551029682159424, 1.9008073806762695, 1.2255691289901733, 1.8606159687042236, 3.0827646255493164, 2.840251922607422, 0.906603217124939, 3.699192762374878, 2.202080249786377, 2.306511878967285, 2.2594642639160156, 2.027045726776123, 3.381720542907715, 5.172184944152832, 1.7642018795013428, 5.361187934875488, 0.7284173965454102, 0.6877801418304443, 0.3115805983543396, 0.7675198912620544, 0.6548442840576172, 3.5131142139434814, 2.818254232406616, 2.4741835594177246, 0.7795987129211426, 1.7397217750549316, 0.1686556339263916, 2.8698854446411133, 6.2944416999816895, 2.4274587631225586, 4.4929986000061035, 2.7734060287475586, 2.0245699882507324, 4.508124351501465, 0.14119040966033936, 0.7670764923095703, 1.0943162441253662, 0.8696115612983704, 2.4640614986419678, 0.3092857003211975, 6.584772109985352, 3.176753044128418, 3.999342918395996, 0.9095673561096191, 1.8094464540481567, 0.7391818165779114, 3.02827525138855, 3.0109996795654297, 1.563584804534912], "mean_td_error": 2.3042244911193848, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 39.0, "diff_num_grad_updates_vs_sampler_policy": 38.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.07214641571045, "actor_loss": -5.435935974121094, "critic_loss": 0.2645134925842285, "alpha_loss": -0.1148659884929657, "alpha_value": 0.988660454750061, "log_alpha_value": -0.011404319666326046, "target_entropy": -6.0, "policy_t": -0.023130835965275764, "mean_q": 1.6287750005722046, "max_q": 6.658101558685303, "min_q": 1.1098060607910156}, "td_error": [1.1680305004119873, 0.9889102578163147, 4.789323329925537, 2.392488956451416, 0.26663482189178467, 2.624786853790283, 1.6539254188537598, 3.3622689247131348, 2.6251649856567383, 0.566238284111023, 0.7161797285079956, 1.8982601165771484, 3.01010799407959, 2.2791895866394043, 0.9547648429870605, 0.995191752910614, 1.9349861145019531, 0.6997149586677551, 0.9720315337181091, 1.2131493091583252, 2.8491389751434326, 0.23252761363983154, 0.4741038680076599, 2.2587509155273438, 0.4021320939064026, 0.6273748278617859, 3.2268784046173096, 4.167777061462402, 0.9798360466957092, 1.1042901277542114, 1.4279764890670776, 1.2056725025177002, 0.7660977840423584, 1.638329029083252, 0.3414778709411621, 0.5720165967941284, 2.1481270790100098, 1.4381210803985596, 1.242142915725708, 1.0454988479614258, 2.8794760704040527, 1.1097898483276367, 1.0220098495483398, 0.6354134678840637, 0.8406320810317993, 1.5638084411621094, 0.21746528148651123, 0.8506723046302795, 5.557064533233643, 0.846318781375885, 0.08445191383361816, 3.194917917251587, 1.4994068145751953, 0.8635193109512329, 2.784567356109619, 0.5669201612472534, 5.12623929977417, 1.5367518663406372, 1.5766704082489014, 2.2399096488952637, 0.7722051739692688, 2.097865104675293, 1.189773678779602, 2.645193576812744, 0.6142399311065674, 1.0947856903076172, 0.7963241338729858, 2.0205438137054443, 3.7104969024658203, 2.0002200603485107, 0.0690232515335083, 1.7753828763961792, 0.4478827714920044, 3.262718677520752, 0.27018100023269653, 3.3329172134399414, 1.5287312269210815, 1.586340069770813, 1.8418912887573242, 2.026407480239868, 2.2043559551239014, 0.28309863805770874, 2.1637773513793945, 0.5150943398475647, 0.7237412333488464, 0.8213756084442139], "mean_td_error": 1.6052347421646118, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 39.0, "diff_num_grad_updates_vs_sampler_policy": 38.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.150237083435059, "actor_loss": -5.498437404632568, "critic_loss": 0.41929158568382263, "alpha_loss": -0.11583791673183441, "alpha_value": 0.9886525273323059, "log_alpha_value": -0.011412336491048336, "target_entropy": -6.0, "policy_t": 0.008181575685739517, "mean_q": 1.7158000469207764, "max_q": 7.647409915924072, "min_q": 1.1099765300750732}, "td_error": [1.5677717924118042, 2.1501762866973877, 0.18656879663467407, 0.0835844874382019, 3.469407558441162, 1.0739846229553223, 2.048693895339966, 1.1579227447509766, 2.2780675888061523, 1.9183096885681152, 1.3742049932479858, 1.6698439121246338, 0.5409337282180786, 4.595645427703857, 3.3426547050476074, 2.2717132568359375, 1.052475929260254, 0.5857710838317871, 1.6726455688476562, 1.069859504699707, 2.324688196182251, 0.4523301124572754, 3.3599538803100586, 0.4648493528366089, 2.019355058670044, 1.9415595531463623, 2.0940146446228027, 2.574037551879883, 2.983527183532715, 2.966769218444824, 0.10029220581054688, 1.878595232963562, 0.7928906679153442, 1.7387248277664185, 1.3664145469665527, 0.8910744190216064, 1.3301942348480225, 1.0065722465515137, 1.6677676439285278, 3.3869166374206543, 2.1055736541748047, 0.7273355722427368, 0.3330070376396179, 0.2131587266921997, 0.19121265411376953, 2.290804862976074, 0.4708600640296936, 2.4668080806732178, 1.7507466077804565, 0.7628388404846191, 0.3776450753211975, 2.0509915351867676, 1.539052963256836, 0.8108857870101929, 1.9307951927185059, 4.793447494506836, 0.7311569452285767, 1.0664986371994019, 0.7448990345001221, 0.8313374519348145, 1.8989744186401367, 0.5911608934402466, 1.6166987419128418, 2.2570247650146484, 1.8302680253982544, 0.4666725993156433, 2.9918265342712402, 0.7061678171157837, 2.1143155097961426, 0.8064279556274414, 0.1276533603668213, 2.892822027206421, 0.7008806467056274, 0.9470144510269165, 4.706231117248535, 0.5883427262306213, 1.7178008556365967, 3.8585100173950195, 0.3352113366127014, 0.4716166853904724, 1.5126118659973145, 0.49361592531204224, 0.763229489326477, 1.1119441986083984, 0.9610879421234131, 2.1985232830047607], "mean_td_error": 1.5617029666900635, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 39.0, "diff_num_grad_updates_vs_sampler_policy": 38.0}}, "num_env_steps_sampled": 35840, "num_env_steps_trained": 10062, "num_agent_steps_sampled": 107520, "num_agent_steps_trained": 10062, "last_target_update_ts": 35840, "num_target_updates": 39}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 107520, "num_agent_steps_trained": 10062, "num_env_steps_sampled": 35840, "num_env_steps_trained": 10062, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 975.3473863151215, "num_env_steps_trained_throughput_per_sec": 280.8477965059167, "timesteps_total": 35840, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 107520, "timers": {"training_iteration_time_ms": 980.573, "sample_time_ms": 680.295, "load_time_ms": 0.318, "load_throughput": 812349.247, "learn_time_ms": 18.133, "learn_throughput": 14228.58, "synch_weights_time_ms": 9.866}, "counters": {"num_env_steps_sampled": 35840, "num_env_steps_trained": 10062, "num_agent_steps_sampled": 107520, "num_agent_steps_trained": 10062, "last_target_update_ts": 35840, "num_target_updates": 39}, "done": false, "episodes_total": 0, "training_iteration": 22, "trial_id": "7c290_00000", "date": "2023-11-18_19-56-20", "timestamp": 1700366180, "time_this_iter_s": 1.8453748226165771, "time_total_s": 39.213934659957886, "pid": 1618, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x312ac1120>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 39.213934659957886, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 66.15, "ram_util_percent": 64.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.048650741577148, "actor_loss": -5.732669830322266, "critic_loss": 0.866694450378418, "alpha_loss": -0.12061107158660889, "alpha_value": 0.9880690574645996, "log_alpha_value": -0.012002714909613132, "target_entropy": -6.0, "policy_t": 0.014082260429859161, "mean_q": 1.8782051801681519, "max_q": 9.603694915771484, "min_q": 1.3486188650131226}, "td_error": [2.3013482093811035, 3.064603567123413, 0.9948741793632507, 2.347334861755371, 3.259636878967285, 3.1414694786071777, 0.43335288763046265, 0.27794408798217773, 3.1114211082458496, 5.467987537384033, 3.4388599395751953, 3.869357109069824, 1.7064769268035889, 5.588317394256592, 1.8037526607513428, 2.322744369506836, 2.330761194229126, 0.40018486976623535, 1.4363826513290405, 1.0746468305587769, 2.4147891998291016, 2.0344576835632324, 2.878645420074463, 1.4787635803222656, 1.3068346977233887, 3.5419158935546875, 1.4583102464675903, 3.087050437927246, 0.9447751045227051, 3.772878646850586, 2.484661102294922, 3.1410646438598633, 2.385066032409668, 3.860121250152588, 3.5226621627807617, 2.9932010173797607, 3.79372501373291, 1.3258565664291382, 1.324251651763916, 2.605045795440674, 4.892483711242676, 1.112048625946045, 3.1350464820861816, 2.5498313903808594, 0.9372358322143555, 2.3519082069396973, 3.8887453079223633, 4.5743408203125, 0.7319936752319336, 3.6984853744506836, 3.820446252822876, 2.4485697746276855, 2.2367615699768066, 1.4754043817520142, 2.5235767364501953, 3.2657737731933594, 3.2769007682800293, 2.652726411819458, 3.526826858520508, 0.5034551620483398, 1.2386354207992554, 0.9199138283729553, 4.195803642272949, 2.6933178901672363, 1.6839112043380737, 0.8691030740737915, 0.9699252843856812, 0.21710991859436035, 0.3187881112098694, 3.3095409870147705, 3.9745078086853027, 7.197259426116943, 1.8752073049545288, 1.8333770036697388, 2.8561792373657227, 2.298844337463379, 3.668492317199707, 2.048624277114868, 2.112916946411133, 2.431265354156494, 2.668386936187744, 0.6674971580505371, 2.7907142639160156, 1.2191805839538574, 1.6003952026367188, 3.402318239212036], "mean_td_error": 2.458015203475952, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 41.0, "diff_num_grad_updates_vs_sampler_policy": 40.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.092632293701172, "actor_loss": -5.652805805206299, "critic_loss": 0.2734549045562744, "alpha_loss": -0.12115481495857239, "alpha_value": 0.9880675077438354, "log_alpha_value": -0.01200428418815136, "target_entropy": -6.0, "policy_t": 0.016169512644410133, "mean_q": 1.8738142251968384, "max_q": 7.3817548751831055, "min_q": 1.218357801437378}, "td_error": [2.780501365661621, 0.9351381063461304, 1.1002451181411743, 0.17459142208099365, 1.2666382789611816, 2.079533100128174, 2.255046844482422, 1.7134392261505127, 0.900576114654541, 1.3954964876174927, 0.8262763023376465, 2.048828125, 1.2086503505706787, 1.953250765800476, 1.8318302631378174, 1.1451830863952637, 1.547938346862793, 2.597135305404663, 0.07307577133178711, 1.1728249788284302, 0.4261767864227295, 1.2212803363800049, 2.327704668045044, 1.60740327835083, 3.0343611240386963, 0.4567601680755615, 1.2836649417877197, 1.7887861728668213, 3.7685813903808594, 1.463468074798584, 3.2830443382263184, 1.786245584487915, 0.9514337182044983, 0.435172438621521, 5.140955924987793, 1.8791944980621338, 0.1990436315536499, 2.025397777557373, 0.88993239402771, 0.8516778349876404, 1.3338849544525146, 2.567671775817871, 3.4023025035858154, 1.1893647909164429, 0.29835212230682373, 0.5435841083526611, 3.0470170974731445, 1.6314361095428467, 0.5460236668586731, 1.339163899421692, 1.845932960510254, 1.604055643081665, 1.9683129787445068, 1.116986632347107, 0.5605337619781494, 0.7765158414840698, 0.4506792426109314, 1.8667094707489014, 1.6038416624069214, 0.08026540279388428, 0.2674599289894104, 2.6019434928894043, 2.5402121543884277, 0.22678661346435547, 0.7969567179679871, 0.5708878040313721, 3.476058006286621, 1.1682636737823486, 0.6008744835853577, 0.650819718837738, 1.4404348134994507, 2.557954788208008, 0.646376371383667, 3.2581565380096436, 2.241772174835205, 1.0996863842010498, 3.0949504375457764, 1.0408926010131836, 4.0093512535095215, 3.2133560180664062, 5.55252742767334, 2.4030630588531494, 1.5840444564819336, 4.4822492599487305, 0.8306449055671692, 2.2975411415100098], "mean_td_error": 1.6773532629013062, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 41.0, "diff_num_grad_updates_vs_sampler_policy": 40.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.10894775390625, "actor_loss": -5.655694961547852, "critic_loss": 0.45698899030685425, "alpha_loss": -0.12144183367490768, "alpha_value": 0.9880585670471191, "log_alpha_value": -0.012013302184641361, "target_entropy": -6.0, "policy_t": -0.005726603791117668, "mean_q": 1.8606659173965454, "max_q": 7.609989166259766, "min_q": 1.205652117729187}, "td_error": [0.3505305051803589, 1.0341668128967285, 1.1889231204986572, 0.4561859965324402, 1.7152183055877686, 1.72634756565094, 1.2050106525421143, 0.30960142612457275, 2.859506368637085, 2.618079662322998, 1.2960731983184814, 0.7549711465835571, 0.30352044105529785, 0.21213316917419434, 2.194093704223633, 1.8594961166381836, 0.8565050363540649, 2.1197524070739746, 2.63713002204895, 0.3079880475997925, 1.5645438432693481, 0.49117511510849, 0.197609543800354, 2.27911114692688, 2.205146312713623, 0.08079755306243896, 1.4625446796417236, 1.8618909120559692, 1.9468588829040527, 4.356080055236816, 0.668472945690155, 0.08497637510299683, 1.6698654890060425, 2.452465057373047, 0.1013798713684082, 0.40841591358184814, 0.09261345863342285, 3.2123498916625977, 2.3405072689056396, 1.4817473888397217, 2.1229753494262695, 3.625729560852051, 4.162900447845459, 0.43810707330703735, 2.039163112640381, 2.0983121395111084, 5.241459846496582, 3.098438262939453, 1.0205662250518799, 1.7746431827545166, 0.9470775723457336, 1.7569332122802734, 1.0860401391983032, 2.396908760070801, 0.5128304362297058, 2.397676467895508, 4.518415451049805, 1.6334099769592285, 0.27250945568084717, 0.22741097211837769, 1.0416337251663208, 1.5355565547943115, 0.16096121072769165, 6.766493320465088, 0.5424566268920898, 0.16531062126159668, 2.9401698112487793, 1.660247802734375, 1.7952699661254883, 1.6036478281021118, 2.296147346496582, 2.7548811435699463, 0.9486719965934753, 1.2099360227584839, 0.8537074327468872, 0.08025658130645752, 3.912470817565918, 1.385886788368225, 0.5743884444236755, 1.841444969177246, 0.6922475099563599, 0.5846015214920044, 0.4615551233291626, 1.9817018508911133, 2.3609328269958496, 2.313396692276001], "mean_td_error": 1.6139450073242188, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 41.0, "diff_num_grad_updates_vs_sampler_policy": 40.0}}, "num_env_steps_sampled": 37632, "num_env_steps_trained": 10578, "num_agent_steps_sampled": 112896, "num_agent_steps_trained": 10578, "last_target_update_ts": 37632, "num_target_updates": 41}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112896, "num_agent_steps_trained": 10578, "num_env_steps_sampled": 37632, "num_env_steps_trained": 10578, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 941.3866294463596, "num_env_steps_trained_throughput_per_sec": 271.0689178539741, "timesteps_total": 37632, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 112896, "timers": {"training_iteration_time_ms": 984.391, "sample_time_ms": 683.941, "load_time_ms": 0.315, "load_throughput": 818617.469, "learn_time_ms": 17.979, "learn_throughput": 14350.378, "synch_weights_time_ms": 9.655}, "counters": {"num_env_steps_sampled": 37632, "num_env_steps_trained": 10578, "num_agent_steps_sampled": 112896, "num_agent_steps_trained": 10578, "last_target_update_ts": 37632, "num_target_updates": 41}, "done": false, "episodes_total": 0, "training_iteration": 23, "trial_id": "7c290_00000", "date": "2023-11-18_19-56-22", "timestamp": 1700366182, "time_this_iter_s": 1.9132449626922607, "time_total_s": 41.12717962265015, "pid": 1618, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x312ac1d00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 41.12717962265015, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 71.1, "ram_util_percent": 65.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.157147407531738, "actor_loss": -6.069962024688721, "critic_loss": 0.7945468425750732, "alpha_loss": -0.12801037728786469, "alpha_value": 0.987476110458374, "log_alpha_value": -0.012602983973920345, "target_entropy": -6.0, "policy_t": 0.008962743915617466, "mean_q": 2.2614314556121826, "max_q": 8.959474563598633, "min_q": 1.4750927686691284}, "td_error": [1.9444111585617065, 1.4414052963256836, 2.8547801971435547, 3.5298850536346436, 3.1634037494659424, 3.2464230060577393, 5.006182670593262, 0.6843345165252686, 1.670238971710205, 1.0936349630355835, 0.7400751113891602, 5.057552337646484, 1.613720178604126, 2.4549431800842285, 1.376662254333496, 3.535355806350708, 3.1887097358703613, 1.160660982131958, 2.815319061279297, 0.15633034706115723, 1.8195650577545166, 4.000472068786621, 0.43971186876296997, 1.3608949184417725, 1.731029987335205, 0.6498850584030151, 1.2465126514434814, 3.675264358520508, 2.355743169784546, 2.0253334045410156, 1.9501954317092896, 3.235599994659424, 1.4805055856704712, 2.423894166946411, 0.2771592140197754, 3.124668836593628, 3.583540916442871, 2.7710957527160645, 0.8317292928695679, 4.2361040115356445, 2.9360857009887695, 2.9360756874084473, 7.6717119216918945, 3.645332098007202, 2.539463996887207, 2.0922188758850098, 2.3097317218780518, 1.8372278213500977, 3.2454404830932617, 0.9861423969268799, 1.7979540824890137, 2.7378430366516113, 1.8744276762008667, 1.3205265998840332, 1.1494884490966797, 0.13515698909759521, 0.3404735326766968, 2.4311561584472656, 4.481912612915039, 1.147649884223938, 0.45697736740112305, 5.100539207458496, 0.7116081714630127, 2.6619534492492676, 2.534696340560913, 4.774763107299805, 1.0725585222244263, 3.284514904022217, 3.4317989349365234, 3.247178316116333, 3.713104009628296, 1.6230659484863281, 1.1130191087722778, 3.53592586517334, 1.1115305423736572, 1.4455865621566772, 1.0631221532821655, 1.7994396686553955, 3.722926378250122, 2.110931634902954, 0.4697216749191284, 1.2968878746032715, 0.3263813257217407, 2.0295145511627197, 3.408553123474121, 1.8397085666656494], "mean_td_error": 2.2727320194244385, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 43.0, "diff_num_grad_updates_vs_sampler_policy": 42.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.079922676086426, "actor_loss": -5.809906959533691, "critic_loss": 0.24466350674629211, "alpha_loss": -0.12704938650131226, "alpha_value": 0.9874749183654785, "log_alpha_value": -0.012604201212525368, "target_entropy": -6.0, "policy_t": 0.01871476322412491, "mean_q": 2.120669364929199, "max_q": 7.2550048828125, "min_q": 1.337364912033081}, "td_error": [1.7662379741668701, 1.6513960361480713, 1.3415064811706543, 1.9253562688827515, 1.0165716409683228, 0.8079419732093811, 0.20603758096694946, 0.9753509163856506, 0.35403966903686523, 1.797190546989441, 1.7172131538391113, 1.3242355585098267, 0.4056985378265381, 0.33021366596221924, 2.360858678817749, 0.1883983016014099, 1.1041030883789062, 6.869267463684082, 0.7921095490455627, 0.6398439407348633, 0.4367706775665283, 1.9266526699066162, 3.787567377090454, 2.1351819038391113, 2.2789549827575684, 3.783174991607666, 2.1182055473327637, 1.8132586479187012, 1.452893614768982, 1.59065580368042, 0.1029282808303833, 0.10678362846374512, 0.870417594909668, 2.0529866218566895, 2.1088695526123047, 2.261667251586914, 2.269519329071045, 1.6672085523605347, 0.9819895029067993, 0.834946870803833, 0.41084229946136475, 0.47483372688293457, 1.533604383468628, 0.10890549421310425, 0.6369574069976807, 3.079975128173828, 0.3964870572090149, 0.35623466968536377, 2.6083738803863525, 0.47755497694015503, 2.328500270843506, 3.0946550369262695, 1.7097880840301514, 1.9028209447860718, 1.638688564300537, 2.4308810234069824, 1.9487967491149902, 1.9523977041244507, 1.8443583250045776, 0.1508583426475525, 0.22798043489456177, 2.445944309234619, 2.0064921379089355, 3.289806365966797, 1.9758235216140747, 1.224128246307373, 0.11962544918060303, 2.394461154937744, 2.1509997844696045, 0.6570620536804199, 0.16197443008422852, 1.4693212509155273, 0.9819010496139526, 1.6266207695007324, 2.187613010406494, 1.288453221321106, 1.1119221448898315, 3.350736618041992, 0.23165041208267212, 2.176746368408203, 0.8922703266143799, 2.0250940322875977, 0.3517751693725586, 0.5532625913619995, 0.2632797956466675, 1.3561125993728638], "mean_td_error": 1.4855904579162598, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 43.0, "diff_num_grad_updates_vs_sampler_policy": 42.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.098560333251953, "actor_loss": -5.813839912414551, "critic_loss": 0.3675580620765686, "alpha_loss": -0.127384215593338, "alpha_value": 0.9874651432037354, "log_alpha_value": -0.012614096514880657, "target_entropy": -6.0, "policy_t": 0.05021701008081436, "mean_q": 2.034370183944702, "max_q": 7.463092803955078, "min_q": 1.3088314533233643}, "td_error": [0.20923066139221191, 3.1840639114379883, 1.0063161849975586, 2.8186614513397217, 1.7103458642959595, 0.10972821712493896, 2.089911460876465, 2.5984482765197754, 2.89534854888916, 1.0284876823425293, 1.0154237747192383, 0.764939546585083, 0.0778207778930664, 1.0056438446044922, 0.7527480125427246, 2.080354690551758, 0.09404909610748291, 2.537187099456787, 1.9638075828552246, 1.8504823446273804, 2.740478992462158, 1.4205067157745361, 0.15163367986679077, 1.6504507064819336, 0.628083348274231, 2.103884220123291, 0.38493144512176514, 0.525659441947937, 0.18109983205795288, 3.5951337814331055, 0.10796010494232178, 2.1926422119140625, 0.08308565616607666, 0.9056570529937744, 1.7788676023483276, 0.7632684707641602, 0.7500197887420654, 0.5287303924560547, 0.14917171001434326, 1.7384729385375977, 0.059071362018585205, 0.8276679515838623, 2.379683494567871, 0.36964863538742065, 1.433685064315796, 0.9152633547782898, 0.12601739168167114, 1.808928370475769, 3.2512154579162598, 0.5703945755958557, 1.3699311017990112, 2.5794012546539307, 0.1698818802833557, 0.7942244410514832, 1.2250139713287354, 0.764826774597168, 5.626088619232178, 0.3767772316932678, 0.6318566799163818, 1.7581582069396973, 0.1911633014678955, 0.9902181625366211, 1.2397724390029907, 1.267315149307251, 1.845725178718567, 3.180638313293457, 3.3197903633117676, 1.464836835861206, 0.16542267799377441, 0.3300601840019226, 1.0676426887512207, 1.5458940267562866, 1.7400116920471191, 2.521608591079712, 5.321188449859619, 0.8981602191925049, 0.33485472202301025, 0.3481621742248535, 0.19750618934631348, 2.0311357975006104, 1.8109221458435059, 1.528892159461975, 0.6799160838127136, 0.5803375244140625, 1.307616114616394, 1.9996057748794556], "mean_td_error": 1.3618472814559937, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 43.0, "diff_num_grad_updates_vs_sampler_policy": 42.0}}, "num_env_steps_sampled": 39424, "num_env_steps_trained": 11094, "num_agent_steps_sampled": 118272, "num_agent_steps_trained": 11094, "last_target_update_ts": 39424, "num_target_updates": 43}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 118272, "num_agent_steps_trained": 11094, "num_env_steps_sampled": 39424, "num_env_steps_trained": 11094, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 938.1437347622642, "num_env_steps_trained_throughput_per_sec": 270.13513791145556, "timesteps_total": 39424, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 118272, "timers": {"training_iteration_time_ms": 983.491, "sample_time_ms": 684.495, "load_time_ms": 0.314, "load_throughput": 821787.995, "learn_time_ms": 18.01, "learn_throughput": 14325.264, "synch_weights_time_ms": 9.514}, "counters": {"num_env_steps_sampled": 39424, "num_env_steps_trained": 11094, "num_agent_steps_sampled": 118272, "num_agent_steps_trained": 11094, "last_target_update_ts": 39424, "num_target_updates": 43}, "done": false, "episodes_total": 0, "training_iteration": 24, "trial_id": "7c290_00000", "date": "2023-11-18_19-56-24", "timestamp": 1700366184, "time_this_iter_s": 1.9202260971069336, "time_total_s": 43.04740571975708, "pid": 1618, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x312a46ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 43.04740571975708, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 69.2, "ram_util_percent": 65.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.102121353149414, "actor_loss": -6.368642330169678, "critic_loss": 0.6662839651107788, "alpha_loss": -0.1333833485841751, "alpha_value": 0.986883282661438, "log_alpha_value": -0.013203498907387257, "target_entropy": -6.0, "policy_t": -0.02135964296758175, "mean_q": 2.425243377685547, "max_q": 10.067859649658203, "min_q": 1.6204640865325928}, "td_error": [0.5539292097091675, 3.3214476108551025, 3.778182029724121, 1.7982490062713623, 7.632804870605469, 2.57334303855896, 2.7878775596618652, 0.569843053817749, 1.7220184803009033, 1.1814684867858887, 3.3454222679138184, 1.1634658575057983, 2.7468819618225098, 2.22902774810791, 1.5862388610839844, 1.3743290901184082, 1.836851716041565, 0.9319199323654175, 1.363480806350708, 1.7943334579467773, 3.270122528076172, 3.1862478256225586, 0.47613000869750977, 0.9809383153915405, 0.3556290864944458, 0.6327775716781616, 2.4978370666503906, 1.988539695739746, 1.8385051488876343, 1.298189401626587, 2.3812055587768555, 2.304230213165283, 2.910984516143799, 1.055525541305542, 3.2154898643493652, 1.8719780445098877, 2.9788031578063965, 2.6172542572021484, 1.7467105388641357, 3.1584091186523438, 3.2538537979125977, 0.13923180103302002, 0.5432329177856445, 2.220116138458252, 2.553210735321045, 4.916970729827881, 0.26914072036743164, 1.960011601448059, 0.9521063566207886, 0.8841314315795898, 2.3303496837615967, 0.22640252113342285, 0.4415280818939209, 2.1521503925323486, 1.5313973426818848, 1.2360665798187256, 1.5008265972137451, 0.675983190536499, 0.28619611263275146, 1.8475137948989868, 0.7425708770751953, 0.2536810636520386, 0.23174524307250977, 1.8135091066360474, 1.688915729522705, 4.101430416107178, 3.0116336345672607, 0.4286402463912964, 3.9538145065307617, 2.7146759033203125, 0.8928983211517334, 2.9357969760894775, 1.2648314237594604, 1.8731880187988281, 3.3546957969665527, 0.5787317752838135, 3.4676504135131836, 1.6174554824829102, 0.29712557792663574, 2.5667123794555664, 1.7582437992095947, 0.30861687660217285, 2.2593841552734375, 2.1688618659973145, 3.4664430618286133, 1.460128903388977], "mean_td_error": 1.9091676473617554, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 45.0, "diff_num_grad_updates_vs_sampler_policy": 44.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.086227416992188, "actor_loss": -6.009122848510742, "critic_loss": 0.21615199744701385, "alpha_loss": -0.13317890465259552, "alpha_value": 0.986882746219635, "log_alpha_value": -0.01320403441786766, "target_entropy": -6.0, "policy_t": 0.007330398075282574, "mean_q": 2.2178218364715576, "max_q": 6.852723121643066, "min_q": 1.4628007411956787}, "td_error": [1.3686773777008057, 1.3381445407867432, 1.5491259098052979, 1.2210347652435303, 2.1917471885681152, 1.1139826774597168, 2.9523959159851074, 1.4321199655532837, 4.327783584594727, 0.9410585761070251, 2.8446168899536133, 0.5125027894973755, 0.22464126348495483, 0.9063550233840942, 1.4742037057876587, 1.0724061727523804, 0.39510297775268555, 0.4454251527786255, 0.10680222511291504, 3.715129852294922, 2.3587279319763184, 1.0342936515808105, 0.6864727735519409, 2.7299938201904297, 0.1153150200843811, 1.120771884918213, 1.3209086656570435, 0.7214357852935791, 1.7970035076141357, 1.2539749145507812, 1.0562845468521118, 1.2195945978164673, 3.446294069290161, 0.7289203405380249, 1.1899529695510864, 0.4281078577041626, 0.2189953327178955, 0.11575108766555786, 1.1855616569519043, 1.8817533254623413, 2.3074259757995605, 1.359166145324707, 1.208074927330017, 1.0195863246917725, 2.180546283721924, 1.9999244213104248, 1.0908448696136475, 0.660018801689148, 1.2556096315383911, 1.5091934204101562, 1.779569149017334, 0.5469277501106262, 0.8461030721664429, 2.963792324066162, 2.619494915008545, 2.219639301300049, 3.4795520305633545, 1.086181879043579, 0.9887569546699524, 0.6667090654373169, 0.39035212993621826, 1.6491018533706665, 2.402461051940918, 1.8045560121536255, 1.2242305278778076, 1.8118278980255127, 1.3957526683807373, 1.5400285720825195, 0.12140780687332153, 0.4085015058517456, 0.12399154901504517, 1.3212709426879883, 1.4072259664535522, 1.7666648626327515, 0.5792584419250488, 1.6832975149154663, 1.2480753660202026, 1.849545955657959, 1.8071658611297607, 0.3826095461845398, 0.12209796905517578, 1.2732199430465698, 0.5080085396766663, 1.2805981636047363, 2.165757179260254, 1.8933489322662354], "mean_td_error": 1.3801261186599731, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 45.0, "diff_num_grad_updates_vs_sampler_policy": 44.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.097057342529297, "actor_loss": -6.002307891845703, "critic_loss": 0.3868100941181183, "alpha_loss": -0.13343007862567902, "alpha_value": 0.9868721961975098, "log_alpha_value": -0.013214749284088612, "target_entropy": -6.0, "policy_t": -0.05704094097018242, "mean_q": 2.1300957202911377, "max_q": 6.117891788482666, "min_q": 1.4113390445709229}, "td_error": [0.49653536081314087, 1.4436826705932617, 0.23040121793746948, 1.8922070264816284, 3.872124671936035, 0.37297189235687256, 0.3364713191986084, 0.2801787853240967, 2.6445298194885254, 0.3954240083694458, 0.6145416498184204, 0.26562178134918213, 0.27642083168029785, 0.5994582176208496, 1.6477899551391602, 0.07913541793823242, 0.12691068649291992, 1.5182647705078125, 1.9845153093338013, 0.6457122564315796, 0.07735145092010498, 1.1285624504089355, 1.9688173532485962, 2.9634063243865967, 0.05572855472564697, 2.506761074066162, 2.20936918258667, 0.6674630641937256, 4.101117134094238, 1.0231021642684937, 0.29630792140960693, 2.802372455596924, 1.5510838031768799, 0.5892400741577148, 0.8731212615966797, 0.5563225746154785, 2.2136499881744385, 4.16182279586792, 2.302703380584717, 0.5613312125205994, 0.8395446538925171, 0.4572298526763916, 0.33104759454727173, 1.2890546321868896, 2.676724910736084, 0.9789937734603882, 2.0272088050842285, 1.1435353755950928, 0.6514085531234741, 0.8050981760025024, 2.7097599506378174, 1.6309618949890137, 2.320236921310425, 2.620394229888916, 0.8682897090911865, 4.648169040679932, 1.7433568239212036, 2.636126756668091, 1.3244740962982178, 0.4886213541030884, 0.17128825187683105, 2.2395734786987305, 1.7390416860580444, 1.7778645753860474, 0.5198962688446045, 1.6765668392181396, 0.7263944149017334, 3.4759416580200195, 1.9788970947265625, 0.8486695289611816, 0.13441932201385498, 0.2574835419654846, 1.1027066707611084, 1.1588432788848877, 0.7468488216400146, 2.411677837371826, 1.6511623859405518, 4.524016380310059, 1.8560991287231445, 1.4612724781036377, 1.9254043102264404, 2.465869903564453, 0.23605549335479736, 1.4677207469940186, 0.3515692949295044, 0.22855842113494873], "mean_td_error": 1.4146116971969604, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 45.0, "diff_num_grad_updates_vs_sampler_policy": 44.0}}, "num_env_steps_sampled": 41216, "num_env_steps_trained": 11610, "num_agent_steps_sampled": 123648, "num_agent_steps_trained": 11610, "last_target_update_ts": 41216, "num_target_updates": 45}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 123648, "num_agent_steps_trained": 11610, "num_env_steps_sampled": 41216, "num_env_steps_trained": 11610, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 926.086123307743, "num_env_steps_trained_throughput_per_sec": 266.6631917560242, "timesteps_total": 41216, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 123648, "timers": {"training_iteration_time_ms": 970.976, "sample_time_ms": 670.722, "load_time_ms": 0.313, "load_throughput": 825423.67, "learn_time_ms": 17.949, "learn_throughput": 14374.435, "synch_weights_time_ms": 10.075}, "counters": {"num_env_steps_sampled": 41216, "num_env_steps_trained": 11610, "num_agent_steps_sampled": 123648, "num_agent_steps_trained": 11610, "last_target_update_ts": 41216, "num_target_updates": 45}, "done": false, "episodes_total": 0, "training_iteration": 25, "trial_id": "7c290_00000", "date": "2023-11-18_19-56-25", "timestamp": 1700366185, "time_this_iter_s": 1.9434359073638916, "time_total_s": 44.99084162712097, "pid": 1618, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x312a45c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 44.99084162712097, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 66.93333333333334, "ram_util_percent": 65.03333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.09417724609375, "actor_loss": -6.427923679351807, "critic_loss": 0.6215001940727234, "alpha_loss": -0.13934239745140076, "alpha_value": 0.9862906336784363, "log_alpha_value": -0.013804233632981777, "target_entropy": -6.0, "policy_t": 0.03302565589547157, "mean_q": 2.5052804946899414, "max_q": 9.071023941040039, "min_q": 1.7697631120681763}, "td_error": [0.4125422239303589, 2.6955246925354004, 1.7503635883331299, 1.5922377109527588, 4.522433757781982, 0.14771711826324463, 2.7402501106262207, 0.4294062852859497, 3.0589585304260254, 0.9184422492980957, 1.0607330799102783, 1.8463884592056274, 1.7783994674682617, 1.669416904449463, 3.409820079803467, 2.282989025115967, 2.8440544605255127, 0.1591048240661621, 1.1074934005737305, 0.700200080871582, 3.32116961479187, 1.9264817237854004, 1.7412378787994385, 3.467559814453125, 0.16710412502288818, 1.0902142524719238, 3.5629043579101562, 2.676053524017334, 1.9486713409423828, 0.3210468292236328, 7.836675643920898, 2.802983522415161, 3.416306257247925, 3.8580360412597656, 0.2375175952911377, 0.9098300933837891, 1.3643065690994263, 0.18562006950378418, 2.8274896144866943, 2.0106546878814697, 0.2357025146484375, 3.0148301124572754, 4.047576427459717, 1.2205530405044556, 0.4540036916732788, 3.2532362937927246, 0.40597379207611084, 1.3912391662597656, 0.8550847768783569, 0.8985064029693604, 0.6937210559844971, 0.401300311088562, 2.5380187034606934, 0.3362421989440918, 2.2670090198516846, 1.2044185400009155, 0.8879125118255615, 0.25743722915649414, 3.6937060356140137, 1.1467251777648926, 1.6514875888824463, 0.45106542110443115, 1.7398667335510254, 0.8874471187591553, 2.980494976043701, 0.6735016107559204, 2.5591177940368652, 2.2306203842163086, 3.6059045791625977, 0.7792208194732666, 5.241762161254883, 0.14549827575683594, 1.7582001686096191, 0.37182676792144775, 1.3270124197006226, 1.4056589603424072, 3.3381457328796387, 0.8625060319900513, 0.5303013324737549, 0.7996019124984741, 3.190458059310913, 0.7097063064575195, 2.5364365577697754, 3.6197609901428223, 6.3090643882751465, 0.593603253364563], "mean_td_error": 1.8639514446258545, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 47.0, "diff_num_grad_updates_vs_sampler_policy": 46.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.059420585632324, "actor_loss": -6.126171588897705, "critic_loss": 0.2135787308216095, "alpha_loss": -0.13885712623596191, "alpha_value": 0.9862911701202393, "log_alpha_value": -0.013803689740598202, "target_entropy": -6.0, "policy_t": -0.03891300410032272, "mean_q": 2.413663625717163, "max_q": 7.1283111572265625, "min_q": 1.594883680343628}, "td_error": [1.6443389654159546, 3.3273210525512695, 2.2321701049804688, 1.1117146015167236, 0.5448428392410278, 0.08690452575683594, 1.7519054412841797, 1.1250056028366089, 0.27673375606536865, 0.31137800216674805, 1.5651273727416992, 0.5958232879638672, 1.517783284187317, 2.0067176818847656, 1.0695579051971436, 1.449319839477539, 1.9007474184036255, 1.2241795063018799, 0.09927088022232056, 1.274682879447937, 3.02052640914917, 1.5898441076278687, 1.0497503280639648, 1.0946578979492188, 1.8384181261062622, 1.997318983078003, 0.5616054534912109, 2.8774144649505615, 0.2842038869857788, 0.4622657299041748, 1.5327649116516113, 0.26455938816070557, 0.5017959475517273, 2.6286072731018066, 0.3515387773513794, 0.35909587144851685, 0.8503100872039795, 0.12022817134857178, 0.41653043031692505, 1.7071330547332764, 5.062384605407715, 3.0656251907348633, 1.4189814329147339, 0.424468994140625, 2.6352925300598145, 0.16453754901885986, 2.289813995361328, 0.8040465116500854, 0.7892171144485474, 1.774906873703003, 1.2065280675888062, 1.9502103328704834, 0.45949798822402954, 2.8272078037261963, 0.5884427428245544, 0.11967909336090088, 1.7239158153533936, 1.1228195428848267, 1.5077974796295166, 0.4170212745666504, 1.5562689304351807, 3.323338270187378, 2.988234043121338, 1.5033811330795288, 0.718523383140564, 0.9108623266220093, 3.2864990234375, 0.8117525577545166, 0.3536485433578491, 0.48991453647613525, 0.32465624809265137, 1.9082973003387451, 1.4210312366485596, 5.866017818450928, 2.004805088043213, 1.0109076499938965, 1.1783230304718018, 0.7512389421463013, 0.7688150405883789, 1.6737384796142578, 1.0455007553100586, 1.1730153560638428, 2.9195356369018555, 0.8132400512695312, 0.4045588970184326, 0.7437408566474915], "mean_td_error": 1.3828643560409546, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 47.0, "diff_num_grad_updates_vs_sampler_policy": 46.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.165648460388184, "actor_loss": -6.3124098777771, "critic_loss": 0.3212184011936188, "alpha_loss": -0.1404409408569336, "alpha_value": 0.9862797260284424, "log_alpha_value": -0.01381524745374918, "target_entropy": -6.0, "policy_t": -0.0008706843364052474, "mean_q": 2.4419138431549072, "max_q": 6.837259769439697, "min_q": 1.5236759185791016}, "td_error": [1.7215843200683594, 0.27423250675201416, 0.7279135584831238, 2.2118337154388428, 0.07664608955383301, 2.1238536834716797, 2.2266697883605957, 1.2726750373840332, 0.46755456924438477, 0.854738712310791, 1.6689808368682861, 0.48948097229003906, 2.3278465270996094, 0.09089910984039307, 1.5027012825012207, 1.0131785869598389, 1.540060043334961, 0.0658721923828125, 0.6485514640808105, 1.5300227403640747, 0.6096901893615723, 3.230224609375, 0.6906418800354004, 1.4819109439849854, 1.7492167949676514, 1.2742210626602173, 3.8514838218688965, 0.6337910890579224, 1.7083029747009277, 1.226778268814087, 3.155257225036621, 1.6862090826034546, 1.7402970790863037, 0.815433144569397, 0.6685445308685303, 2.2257490158081055, 0.26401448249816895, 0.20947623252868652, 0.9517009258270264, 0.17628079652786255, 0.7081737518310547, 2.9552230834960938, 0.208268404006958, 1.3202884197235107, 0.06725120544433594, 1.0561943054199219, 1.6845979690551758, 0.9243080615997314, 1.480916976928711, 1.6915080547332764, 2.715186357498169, 1.1865566968917847, 0.09645438194274902, 3.7168238162994385, 1.7619924545288086, 1.9628098011016846, 1.5941883325576782, 1.5600194931030273, 1.6917006969451904, 1.1884315013885498, 2.309007406234741, 0.9121395349502563, 0.6367357969284058, 1.2185518741607666, 2.970431327819824, 0.8363733291625977, 0.28472644090652466, 2.3104231357574463, 1.2635618448257446, 1.233386754989624, 1.6378644704818726, 0.5224769115447998, 0.6660614013671875, 0.5310029983520508, 1.6313279867172241, 0.8631701469421387, 1.1966853141784668, 1.1262816190719604, 0.6935181617736816, 0.061515212059020996, 1.7757976055145264, 1.111323595046997, 1.1306312084197998, 0.6266272068023682, 0.26703453063964844, 1.4221575260162354], "mean_td_error": 1.2790026664733887, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 47.0, "diff_num_grad_updates_vs_sampler_policy": 46.0}}, "num_env_steps_sampled": 43008, "num_env_steps_trained": 12126, "num_agent_steps_sampled": 129024, "num_agent_steps_trained": 12126, "last_target_update_ts": 43008, "num_target_updates": 47}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 129024, "num_agent_steps_trained": 12126, "num_env_steps_sampled": 43008, "num_env_steps_trained": 12126, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 952.3591594366222, "num_env_steps_trained_throughput_per_sec": 274.22841867706313, "timesteps_total": 43008, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 129024, "timers": {"training_iteration_time_ms": 946.747, "sample_time_ms": 668.287, "load_time_ms": 0.313, "load_throughput": 823915.359, "learn_time_ms": 18.06, "learn_throughput": 14285.909, "synch_weights_time_ms": 10.248}, "counters": {"num_env_steps_sampled": 43008, "num_env_steps_trained": 12126, "num_agent_steps_sampled": 129024, "num_agent_steps_trained": 12126, "last_target_update_ts": 43008, "num_target_updates": 47}, "done": false, "episodes_total": 0, "training_iteration": 26, "trial_id": "7c290_00000", "date": "2023-11-18_19-56-27", "timestamp": 1700366187, "time_this_iter_s": 1.889646053314209, "time_total_s": 46.88048768043518, "pid": 1618, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x312a479c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 46.88048768043518, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 70.3, "ram_util_percent": 65.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.130253791809082, "actor_loss": -6.7606377601623535, "critic_loss": 0.5613231658935547, "alpha_loss": -0.14592689275741577, "alpha_value": 0.9856982231140137, "log_alpha_value": -0.01440505962818861, "target_entropy": -6.0, "policy_t": -0.026501396670937538, "mean_q": 2.6394906044006348, "max_q": 6.391120433807373, "min_q": 1.8985137939453125}, "td_error": [2.3757076263427734, 1.2271337509155273, 3.4842021465301514, 1.4582386016845703, 2.241576671600342, 3.768383264541626, 1.8904727697372437, 1.9257948398590088, 2.0599911212921143, 2.4376158714294434, 3.216843843460083, 1.2973421812057495, 0.7080821990966797, 2.0662989616394043, 0.5956821441650391, 2.2495737075805664, 2.892927646636963, 0.6002485752105713, 0.7580521106719971, 1.8778035640716553, 2.8474340438842773, 4.937738418579102, 0.8149648904800415, 0.16095077991485596, 1.0615367889404297, 0.14922606945037842, 1.0683461427688599, 3.2755327224731445, 0.6713452339172363, 1.526138424873352, 0.15170609951019287, 0.16392970085144043, 0.3377920389175415, 1.1595512628555298, 1.6218571662902832, 1.0049781799316406, 2.263468027114868, 1.313172459602356, 0.3831707239151001, 0.5147697925567627, 1.875378131866455, 3.7502713203430176, 1.7489616870880127, 0.44788026809692383, 1.391129970550537, 2.5593090057373047, 0.2423182725906372, 2.742417097091675, 0.6033972501754761, 0.9630568027496338, 3.0945425033569336, 0.7828031778335571, 0.32482004165649414, 3.3006675243377686, 1.5402098894119263, 0.3985762596130371, 4.239058494567871, 0.575573205947876, 2.618696689605713, 0.7618147134780884, 2.0230603218078613, 2.4805195331573486, 1.9298855066299438, 1.4175028800964355, 0.7212170362472534, 3.4822635650634766, 2.378030300140381, 0.4480961561203003, 2.6312170028686523, 0.719565749168396, 4.266356945037842, 1.6629297733306885, 0.2632805109024048, 1.0410511493682861, 4.889681816101074, 1.8724734783172607, 1.2361938953399658, 2.280613899230957, 2.1469292640686035, 1.110062837600708, 1.1935638189315796, 1.5417182445526123, 1.2440756559371948, 2.713709831237793, 1.1764878034591675, 0.146323561668396], "mean_td_error": 1.6922941207885742, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 49.0, "diff_num_grad_updates_vs_sampler_policy": 48.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.117355346679688, "actor_loss": -6.409704685211182, "critic_loss": 0.16857171058654785, "alpha_loss": -0.14572285115718842, "alpha_value": 0.9856999516487122, "log_alpha_value": -0.014403256587684155, "target_entropy": -6.0, "policy_t": -0.02175726927816868, "mean_q": 2.5524742603302, "max_q": 6.408246040344238, "min_q": 1.7034785747528076}, "td_error": [0.10174745321273804, 0.6742554903030396, 1.853654146194458, 2.198274850845337, 1.1186504364013672, 2.7675092220306396, 0.15338432788848877, 0.788497805595398, 0.17294412851333618, 0.5415430068969727, 1.7156400680541992, 0.6535231471061707, 1.9179140329360962, 2.4797654151916504, 0.4305894374847412, 0.5272492170333862, 1.2925570011138916, 2.2361507415771484, 0.38542604446411133, 0.42746710777282715, 1.3155646324157715, 3.033093214035034, 0.9477046728134155, 2.6060304641723633, 0.6818112134933472, 2.167318105697632, 2.1899592876434326, 4.859621524810791, 0.9328362941741943, 2.5411124229431152, 0.2480798363685608, 0.7280634045600891, 1.2296106815338135, 2.3547072410583496, 0.17716312408447266, 0.1278822422027588, 0.4892587661743164, 2.0291452407836914, 1.4970078468322754, 0.1457536816596985, 0.29060816764831543, 1.2532241344451904, 0.8338150978088379, 2.054245948791504, 0.6288182735443115, 1.1712582111358643, 1.5344111919403076, 0.8097876310348511, 1.4810725450515747, 0.13968467712402344, 1.592220664024353, 0.12962651252746582, 0.10632634162902832, 1.351061224937439, 0.12520349025726318, 0.5709289312362671, 2.2562155723571777, 0.9490882158279419, 0.6716575622558594, 2.256221294403076, 0.4117828607559204, 0.8350512981414795, 0.1429293155670166, 1.936943531036377, 1.2537912130355835, 0.6466608047485352, 0.08974659442901611, 2.901402711868286, 1.1080751419067383, 2.7062933444976807, 0.8290277719497681, 0.12576639652252197, 1.7142789363861084, 0.12758970260620117, 1.8164459466934204, 0.9495028257369995, 1.260420560836792, 0.13528108596801758, 0.1270366907119751, 0.5788518190383911, 0.8060771226882935, 0.4675446152687073, 0.7102073431015015, 0.6148272156715393, 1.8208463191986084, 0.6221333146095276], "mean_td_error": 1.1358425617218018, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 49.0, "diff_num_grad_updates_vs_sampler_policy": 48.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.10119342803955, "actor_loss": -6.386627674102783, "critic_loss": 0.34820592403411865, "alpha_loss": -0.1456192135810852, "alpha_value": 0.9856873750686646, "log_alpha_value": -0.014416040852665901, "target_entropy": -6.0, "policy_t": 0.011302657425403595, "mean_q": 2.4751861095428467, "max_q": 6.323991298675537, "min_q": 1.596998929977417}, "td_error": [0.18179607391357422, 1.3260774612426758, 2.0995969772338867, 0.9343074560165405, 0.162988543510437, 0.041998863220214844, 1.991188883781433, 1.932830572128296, 1.221652865409851, 0.3861691951751709, 0.5776641368865967, 1.900679111480713, 0.9368605017662048, 0.19195151329040527, 1.6329066753387451, 2.4430413246154785, 1.4761807918548584, 0.11593163013458252, 0.4566851854324341, 0.046648263931274414, 2.9094483852386475, 4.154505252838135, 0.918752133846283, 0.2205028533935547, 2.2547435760498047, 0.2511359453201294, 0.27894556522369385, 3.1227309703826904, 2.7146520614624023, 0.08216345310211182, 1.3678427934646606, 1.5223206281661987, 1.9029021263122559, 1.1205904483795166, 0.09537327289581299, 1.1176035404205322, 0.2906728982925415, 0.2614341974258423, 1.2979527711868286, 2.658057928085327, 1.3467739820480347, 0.7283384799957275, 3.9934957027435303, 1.7534053325653076, 1.4586479663848877, 0.6023197174072266, 1.969772219657898, 1.2303271293640137, 1.1295623779296875, 2.308349132537842, 0.9562804698944092, 1.9406306743621826, 1.4874497652053833, 1.7345681190490723, 2.552262783050537, 0.18614435195922852, 1.3184406757354736, 0.3483147621154785, 0.8957617282867432, 3.2164101600646973, 2.0424609184265137, 3.079190969467163, 1.142563819885254, 0.4496750831604004, 1.6010565757751465, 1.3256523609161377, 0.6809647083282471, 0.5450804233551025, 0.7452831268310547, 0.13995057344436646, 2.8460052013397217, 1.6579093933105469, 0.28082096576690674, 0.35314035415649414, 0.14578509330749512, 0.3487149477005005, 5.001658916473389, 1.7587440013885498, 1.0788824558258057, 1.1332873106002808, 0.936768114566803, 0.811435341835022, 0.4521702527999878, 0.3791741132736206, 0.7657550573348999, 2.419196367263794], "mean_td_error": 1.3009077310562134, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 49.0, "diff_num_grad_updates_vs_sampler_policy": 48.0}}, "num_env_steps_sampled": 44800, "num_env_steps_trained": 12642, "num_agent_steps_sampled": 134400, "num_agent_steps_trained": 12642, "last_target_update_ts": 44800, "num_target_updates": 49}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 134400, "num_agent_steps_trained": 12642, "num_env_steps_sampled": 44800, "num_env_steps_trained": 12642, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 950.5233141606384, "num_env_steps_trained_throughput_per_sec": 273.6997935864338, "timesteps_total": 44800, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 134400, "timers": {"training_iteration_time_ms": 951.545, "sample_time_ms": 673.559, "load_time_ms": 0.311, "load_throughput": 829663.752, "learn_time_ms": 18.157, "learn_throughput": 14209.373, "synch_weights_time_ms": 9.903}, "counters": {"num_env_steps_sampled": 44800, "num_env_steps_trained": 12642, "num_agent_steps_sampled": 134400, "num_agent_steps_trained": 12642, "last_target_update_ts": 44800, "num_target_updates": 49}, "done": false, "episodes_total": 0, "training_iteration": 27, "trial_id": "7c290_00000", "date": "2023-11-18_19-56-29", "timestamp": 1700366189, "time_this_iter_s": 1.8956270217895508, "time_total_s": 48.77611470222473, "pid": 1618, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x312a46c00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 48.77611470222473, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 71.36666666666667, "ram_util_percent": 65.03333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.10348129272461, "actor_loss": -6.953523635864258, "critic_loss": 0.599518358707428, "alpha_loss": -0.15161152184009552, "alpha_value": 0.9851061701774597, "log_alpha_value": -0.015005869790911674, "target_entropy": -6.0, "policy_t": -0.03949088603258133, "mean_q": 2.778209686279297, "max_q": 3.802035331726074, "min_q": 2.040908098220825}, "td_error": [2.5142147541046143, 1.163994550704956, 0.8527002334594727, 2.3506579399108887, 2.5357372760772705, 3.654860019683838, 1.1603814363479614, 2.312366247177124, 2.2309727668762207, 0.4305607080459595, 1.3421932458877563, 1.0122979879379272, 2.601588249206543, 3.944603443145752, 2.004279613494873, 1.2018433809280396, 2.2457637786865234, 4.371149063110352, 0.14227795600891113, 1.4928779602050781, 0.14253437519073486, 1.0935262441635132, 2.803645133972168, 0.13848018646240234, 0.3547886610031128, 0.4656038284301758, 2.6521706581115723, 2.907661199569702, 1.719346046447754, 0.14262807369232178, 1.8319770097732544, 0.5360616445541382, 0.5885323286056519, 0.8968726396560669, 1.7769025564193726, 1.3972865343093872, 2.1055877208709717, 0.5594601631164551, 0.15157437324523926, 1.7313512563705444, 2.350477695465088, 1.9153941869735718, 2.4154751300811768, 1.7946696281433105, 0.847007155418396, 1.7157267332077026, 2.176468849182129, 1.2420096397399902, 1.1005922555923462, 1.9578255414962769, 0.9549250602722168, 1.2364065647125244, 3.7752904891967773, 2.891913890838623, 0.29883646965026855, 3.6117355823516846, 0.4949932098388672, 0.23979878425598145, 2.7658779621124268, 2.8889222145080566, 2.6731340885162354, 1.9287465810775757, 1.5711193084716797, 1.5178073644638062, 2.422788143157959, 2.629946708679199, 1.6575671434402466, 2.9499549865722656, 3.173417091369629, 3.848478078842163, 3.482804536819458, 2.420731544494629, 1.3976296186447144, 0.3597242832183838, 1.4274489879608154, 1.014119267463684, 2.920597553253174, 1.1590993404388428, 1.966558814048767, 1.089892029762268, 3.0214245319366455, 0.2818957567214966, 0.2059769630432129, 1.4254391193389893, 0.3499397039413452, 3.696908950805664], "mean_td_error": 1.753823161125183, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 51.0, "diff_num_grad_updates_vs_sampler_policy": 50.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.071346282958984, "actor_loss": -6.5862627029418945, "critic_loss": 0.16332301497459412, "alpha_loss": -0.15110264718532562, "alpha_value": 0.9851087927818298, "log_alpha_value": -0.015003221109509468, "target_entropy": -6.0, "policy_t": 0.04168049246072769, "mean_q": 2.7801871299743652, "max_q": 6.588944911956787, "min_q": 1.7972787618637085}, "td_error": [0.5556458234786987, 1.9197531938552856, 0.7657827138900757, 0.91899573802948, 0.6155199408531189, 1.522571086883545, 1.765207290649414, 1.8195099830627441, 0.9035259485244751, 0.14493077993392944, 0.5717201232910156, 2.0704078674316406, 0.6768989562988281, 0.8505698442459106, 0.6930220127105713, 0.310630202293396, 1.2224445343017578, 0.5213876962661743, 1.9140369892120361, 1.5404839515686035, 1.3179341554641724, 0.175919771194458, 1.9413357973098755, 6.307645320892334, 1.5146608352661133, 0.41321349143981934, 2.351916551589966, 1.1486623287200928, 1.4987952709197998, 1.088756799697876, 0.6506901979446411, 3.2284255027770996, 0.8578052520751953, 1.1731834411621094, 0.6675987243652344, 0.5812344551086426, 1.2832493782043457, 1.041265606880188, 1.4844722747802734, 0.8751225471496582, 0.12936639785766602, 1.6218323707580566, 1.357645034790039, 0.11889976263046265, 0.505506157875061, 1.1474040746688843, 2.8218395709991455, 0.8342525959014893, 0.8671194314956665, 0.5981732606887817, 1.041438341140747, 1.002690315246582, 0.28784382343292236, 1.2734880447387695, 0.9299386739730835, 1.2157179117202759, 0.2630453109741211, 1.717124104499817, 1.183265209197998, 1.1898232698440552, 1.642627239227295, 0.20518732070922852, 1.6552958488464355, 1.8029993772506714, 2.1442182064056396, 0.12054204940795898, 0.9956475496292114, 1.174713373184204, 0.38497817516326904, 0.11773407459259033, 0.7051560878753662, 0.7333067655563354, 2.0298032760620117, 1.9528388977050781, 0.11747503280639648, 0.11949265003204346, 1.202468752861023, 1.3466901779174805, 0.23408615589141846, 0.7067539691925049, 0.7871993780136108, 0.9073690176010132, 0.5470935106277466, 2.1596853733062744, 1.4117865562438965, 0.9891865253448486], "mean_td_error": 1.1302986145019531, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 51.0, "diff_num_grad_updates_vs_sampler_policy": 50.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.108564376831055, "actor_loss": -6.651797771453857, "critic_loss": 0.27737003564834595, "alpha_loss": -0.15179821848869324, "alpha_value": 0.9850953817367554, "log_alpha_value": -0.015016795136034489, "target_entropy": -6.0, "policy_t": -0.04280252009630203, "mean_q": 2.7458887100219727, "max_q": 6.31879997253418, "min_q": 1.6791096925735474}, "td_error": [2.308720588684082, 1.7905898094177246, 0.2711756229400635, 0.15081238746643066, 2.3611531257629395, 0.9783042669296265, 1.7512686252593994, 1.8742926120758057, 1.22597336769104, 1.3787599802017212, 0.9761581420898438, 0.5990593433380127, 0.15783751010894775, 0.23307931423187256, 0.6292988061904907, 1.6060923337936401, 1.00368070602417, 0.43095147609710693, 0.46701502799987793, 1.502596139907837, 1.7370421886444092, 1.4436004161834717, 1.9175996780395508, 2.1943552494049072, 1.2535908222198486, 3.377929925918579, 1.2614436149597168, 0.4294928312301636, 0.08537673950195312, 0.5947363376617432, 1.0125274658203125, 0.3840818405151367, 0.7523312568664551, 3.412045478820801, 0.161149263381958, 0.4523019790649414, 0.24903690814971924, 1.0038820505142212, 0.9070372581481934, 1.3203752040863037, 1.3073112964630127, 0.7184793949127197, 4.706003189086914, 0.02786731719970703, 0.9079622030258179, 0.5605525970458984, 0.9681570529937744, 1.359207034111023, 1.2620166540145874, 2.6549463272094727, 0.799497127532959, 0.1761237382888794, 2.9945244789123535, 0.45447683334350586, 0.8618947267532349, 0.8118573427200317, 0.39428114891052246, 0.17688679695129395, 1.813793659210205, 0.6498652696609497, 0.09483909606933594, 2.030196189880371, 3.147878408432007, 1.266315221786499, 0.22871863842010498, 0.4641237258911133, 0.320198655128479, 0.7242910861968994, 1.7109616994857788, 1.1445136070251465, 0.10845625400543213, 2.5172057151794434, 0.8542925119400024, 1.5162585973739624, 0.1930086612701416, 0.13369333744049072, 0.6343311071395874, 0.7506222724914551, 0.1634015440940857, 2.5375051498413086, 0.3860330581665039, 1.9233427047729492, 0.6169946193695068, 1.2477545738220215, 1.4777569770812988, 0.02247929573059082], "mean_td_error": 1.1100887060165405, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 51.0, "diff_num_grad_updates_vs_sampler_policy": 50.0}}, "num_env_steps_sampled": 46592, "num_env_steps_trained": 13158, "num_agent_steps_sampled": 139776, "num_agent_steps_trained": 13158, "last_target_update_ts": 46592, "num_target_updates": 51}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 139776, "num_agent_steps_trained": 13158, "num_env_steps_sampled": 46592, "num_env_steps_trained": 13158, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 819.2816152732152, "num_env_steps_trained_throughput_per_sec": 235.90921511215348, "timesteps_total": 46592, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 139776, "timers": {"training_iteration_time_ms": 979.913, "sample_time_ms": 674.648, "load_time_ms": 0.314, "load_throughput": 822162.614, "learn_time_ms": 18.254, "learn_throughput": 14133.542, "synch_weights_time_ms": 9.988}, "counters": {"num_env_steps_sampled": 46592, "num_env_steps_trained": 13158, "num_agent_steps_sampled": 139776, "num_agent_steps_trained": 13158, "last_target_update_ts": 46592, "num_target_updates": 51}, "done": false, "episodes_total": 0, "training_iteration": 28, "trial_id": "7c290_00000", "date": "2023-11-18_19-56-31", "timestamp": 1700366191, "time_this_iter_s": 2.196674108505249, "time_total_s": 50.97278881072998, "pid": 1618, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x312a47e20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 50.97278881072998, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 67.96666666666667, "ram_util_percent": 65.13333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.09388542175293, "actor_loss": -7.186039924621582, "critic_loss": 0.5941212177276611, "alpha_loss": -0.1575310081243515, "alpha_value": 0.984514594078064, "log_alpha_value": -0.015606576576828957, "target_entropy": -6.0, "policy_t": -0.06191873550415039, "mean_q": 3.159672260284424, "max_q": 9.354114532470703, "min_q": 2.184070587158203}, "td_error": [2.1776955127716064, 0.9443936347961426, 3.0166196823120117, 3.56795597076416, 1.410428524017334, 0.44309544563293457, 0.8429776430130005, 1.587604284286499, 4.00248908996582, 2.025538444519043, 1.6692804098129272, 0.7642226219177246, 0.8224058151245117, 2.187586545944214, 2.980821371078491, 0.6533908843994141, 4.826392650604248, 3.3335933685302734, 2.0341691970825195, 0.134332537651062, 4.02204704284668, 1.3683748245239258, 0.1321629285812378, 0.47204113006591797, 1.0046967267990112, 0.5252840518951416, 2.054842710494995, 1.2659838199615479, 2.0969767570495605, 1.6267321109771729, 1.2552540302276611, 2.170027732849121, 2.3593835830688477, 1.9712222814559937, 3.9845619201660156, 1.037269115447998, 4.295384407043457, 3.420696258544922, 2.0228545665740967, 1.4591659307479858, 1.780585765838623, 1.4773881435394287, 3.0179824829101562, 0.13025999069213867, 2.0395655632019043, 2.973893642425537, 1.7713019847869873, 1.5382483005523682, 1.4298056364059448, 2.1211438179016113, 1.0060912370681763, 1.6055717468261719, 0.135406494140625, 2.473931312561035, 0.9891906976699829, 0.1408989429473877, 0.48497307300567627, 1.050745964050293, 1.634818434715271, 6.330407619476318, 0.737378716468811, 1.4255518913269043, 0.40852463245391846, 1.2709383964538574, 0.1378847360610962, 0.19122838973999023, 2.787377119064331, 0.32254254817962646, 1.6239099502563477, 0.12996459007263184, 0.16617894172668457, 1.0518162250518799, 2.455988883972168, 1.614992618560791, 1.5242868661880493, 1.7499111890792847, 2.671637773513794, 1.970322608947754, 1.3080254793167114, 2.046314239501953, 2.7296299934387207, 2.148101568222046, 2.681774854660034, 0.17276537418365479, 1.9988335371017456, 0.6582908630371094], "mean_td_error": 1.7219340801239014, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 53.0, "diff_num_grad_updates_vs_sampler_policy": 52.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.081385612487793, "actor_loss": -6.659117221832275, "critic_loss": 0.17938043177127838, "alpha_loss": -0.15730136632919312, "alpha_value": 0.9845179319381714, "log_alpha_value": -0.015603149309754372, "target_entropy": -6.0, "policy_t": -0.04793578013777733, "mean_q": 2.9019594192504883, "max_q": 5.589879035949707, "min_q": 1.8556870222091675}, "td_error": [0.39359819889068604, 0.1092071533203125, 2.4217464923858643, 1.9375905990600586, 0.6970112323760986, 3.954704761505127, 1.9110312461853027, 0.6445105075836182, 0.18422019481658936, 2.9540276527404785, 1.2590067386627197, 1.6077646017074585, 1.5575700998306274, 1.1163296699523926, 0.6188987493515015, 1.9022284746170044, 3.0457255840301514, 1.6213579177856445, 1.1926310062408447, 0.297080397605896, 1.2973772287368774, 2.1411218643188477, 1.3289297819137573, 1.6629043817520142, 1.5223274230957031, 1.92816162109375, 0.5767168402671814, 3.3076939582824707, 0.4949014186859131, 0.6071159839630127, 1.1585087776184082, 1.2118198871612549, 0.5682715177536011, 1.4632782936096191, 0.4982944130897522, 0.11031293869018555, 0.8947423696517944, 0.3945596218109131, 1.9464530944824219, 1.0300054550170898, 0.5157498121261597, 0.5541924238204956, 1.1096597909927368, 1.3672116994857788, 0.12451440095901489, 1.0477982759475708, 1.1899306774139404, 1.7327569723129272, 0.9331037998199463, 2.0398902893066406, 0.5665229558944702, 0.2120664119720459, 0.6355264186859131, 0.2435286045074463, 0.7185313701629639, 0.28611695766448975, 1.2484464645385742, 1.8480740785598755, 0.5849528312683105, 1.9232592582702637, 1.1034948825836182, 2.002868175506592, 0.8320720195770264, 1.7901263236999512, 2.019200325012207, 0.7148687839508057, 0.5959786772727966, 0.8592925071716309, 0.3739434480667114, 0.09778296947479248, 0.9557400941848755, 1.262298822402954, 0.11720693111419678, 1.4946463108062744, 0.7986800074577332, 1.880570650100708, 0.3656942844390869, 1.914452075958252, 2.6147310733795166, 1.2448025941848755, 1.2811126708984375, 1.0874191522598267, 0.8640370965003967, 1.6718881130218506, 0.6665626764297485, 3.2531230449676514], "mean_td_error": 1.2129554748535156, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 53.0, "diff_num_grad_updates_vs_sampler_policy": 52.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.08218002319336, "actor_loss": -6.77973747253418, "critic_loss": 0.23104198276996613, "alpha_loss": -0.15745989978313446, "alpha_value": 0.9845036864280701, "log_alpha_value": -0.015617645345628262, "target_entropy": -6.0, "policy_t": -0.03274714574217796, "mean_q": 2.7131059169769287, "max_q": 4.7364277839660645, "min_q": 1.747733473777771}, "td_error": [0.9023683071136475, 0.8644751310348511, 0.7826237678527832, 0.9363845586776733, 0.4817897081375122, 1.939469575881958, 0.7729500532150269, 1.1286344528198242, 0.15664458274841309, 1.536756992340088, 1.4739079475402832, 1.4935519695281982, 0.7832057476043701, 4.073972702026367, 0.5636501312255859, 0.6405836343765259, 0.193833589553833, 0.19841885566711426, 1.9192469120025635, 2.699828863143921, 1.3884879350662231, 0.7369824647903442, 0.7394552230834961, 0.4324237108230591, 0.6383397579193115, 0.019048333168029785, 1.2168200016021729, 1.3470876216888428, 1.0214002132415771, 0.7641472816467285, 1.8829431533813477, 2.609039306640625, 0.8591444492340088, 1.3124531507492065, 1.6771342754364014, 0.12245690822601318, 1.444885015487671, 1.8494975566864014, 1.0844279527664185, 1.4906553030014038, 1.9389147758483887, 0.2655442953109741, 0.30488693714141846, 1.784386157989502, 0.8274582624435425, 0.24702918529510498, 0.40520036220550537, 0.31241679191589355, 1.4371960163116455, 2.10966157913208, 0.37861645221710205, 0.4484940767288208, 1.0097324848175049, 2.560978889465332, 0.733771026134491, 0.22484028339385986, 0.31587672233581543, 0.1217414140701294, 1.4031035900115967, 0.3963814973831177, 1.7706024646759033, 1.618046522140503, 1.2236876487731934, 1.2336416244506836, 1.3341152667999268, 0.6708469390869141, 0.025615453720092773, 2.413630962371826, 0.08996820449829102, 1.0460015535354614, 1.2955511808395386, 0.5744747519493103, 1.8097925186157227, 1.677760362625122, 0.05323684215545654, 0.10179638862609863, 0.19455456733703613, 0.240708589553833, 0.9121980667114258, 3.295750379562378, 2.34075927734375, 0.6957377195358276, 0.34856343269348145, 3.7132139205932617, 1.416289210319519, 0.38802969455718994], "mean_td_error": 1.0917433500289917, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 53.0, "diff_num_grad_updates_vs_sampler_policy": 52.0}}, "num_env_steps_sampled": 48384, "num_env_steps_trained": 13674, "num_agent_steps_sampled": 145152, "num_agent_steps_trained": 13674, "last_target_update_ts": 48384, "num_target_updates": 53}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 145152, "num_agent_steps_trained": 13674, "num_env_steps_sampled": 48384, "num_env_steps_trained": 13674, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 984.5499012921034, "num_env_steps_trained_throughput_per_sec": 283.49762782741374, "timesteps_total": 48384, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 145152, "timers": {"training_iteration_time_ms": 970.913, "sample_time_ms": 663.586, "load_time_ms": 0.316, "load_throughput": 817442.538, "learn_time_ms": 18.246, "learn_throughput": 14139.766, "synch_weights_time_ms": 10.007}, "counters": {"num_env_steps_sampled": 48384, "num_env_steps_trained": 13674, "num_agent_steps_sampled": 145152, "num_agent_steps_trained": 13674, "last_target_update_ts": 48384, "num_target_updates": 53}, "done": false, "episodes_total": 0, "training_iteration": 29, "trial_id": "7c290_00000", "date": "2023-11-18_19-56-33", "timestamp": 1700366193, "time_this_iter_s": 1.8282959461212158, "time_total_s": 52.801084756851196, "pid": 1618, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x312ac1940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 52.801084756851196, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 62.36666666666667, "ram_util_percent": 65.06666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.078347206115723, "actor_loss": -7.313804626464844, "critic_loss": 0.6021738648414612, "alpha_loss": -0.16334229707717896, "alpha_value": 0.9839233756065369, "log_alpha_value": -0.016207249835133553, "target_entropy": -6.0, "policy_t": 0.022085873410105705, "mean_q": 3.3596272468566895, "max_q": 8.711408615112305, "min_q": 2.3342983722686768}, "td_error": [1.777761459350586, 1.752525806427002, 1.7469382286071777, 1.4513680934906006, 2.3278112411499023, 3.2788281440734863, 0.9357155561447144, 2.1838579177856445, 2.93454647064209, 2.292928457260132, 0.7668396234512329, 4.177311897277832, 1.98441481590271, 1.8844748735427856, 2.4512338638305664, 2.2920589447021484, 1.9994757175445557, 0.2813206911087036, 0.4840027093887329, 1.9376975297927856, 2.0780649185180664, 0.5559350252151489, 0.5634868144989014, 3.636045217514038, 2.5079240798950195, 2.9895424842834473, 2.4991273880004883, 2.5881588459014893, 0.11797630786895752, 4.991122722625732, 0.5916420221328735, 2.0646982192993164, 0.35723328590393066, 1.6469191312789917, 1.3569810390472412, 2.1033432483673096, 2.119027614593506, 0.8559515476226807, 4.554736137390137, 0.25726234912872314, 1.1316510438919067, 2.9993433952331543, 0.18380498886108398, 1.444533348083496, 3.135003089904785, 0.17906343936920166, 1.9241255521774292, 1.6738550662994385, 0.4080049991607666, 1.4437625408172607, 0.9200736284255981, 1.6107537746429443, 0.40934157371520996, 0.5208244323730469, 2.2532780170440674, 3.6251931190490723, 1.8341773748397827, 2.007990598678589, 0.08761286735534668, 1.6173107624053955, 3.0416452884674072, 1.468165636062622, 0.9585573673248291, 0.37265467643737793, 0.9673652648925781, 1.4249424934387207, 1.638789415359497, 1.1779987812042236, 1.0764338970184326, 2.8915514945983887, 0.5701009035110474, 4.135484218597412, 1.5458192825317383, 1.6993670463562012, 0.613890528678894, 0.11397743225097656, 0.7468907833099365, 2.1830928325653076, 2.0124735832214355, 2.676487445831299, 2.447744607925415, 1.4376823902130127, 0.6773955821990967, 0.39062511920928955, 6.579329967498779, 1.0002448558807373], "mean_td_error": 1.7515662908554077, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 55.0, "diff_num_grad_updates_vs_sampler_policy": 54.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.100423812866211, "actor_loss": -6.874162673950195, "critic_loss": 0.18560588359832764, "alpha_loss": -0.16365684568881989, "alpha_value": 0.9839276075363159, "log_alpha_value": -0.01620296761393547, "target_entropy": -6.0, "policy_t": 0.022369366139173508, "mean_q": 2.9963090419769287, "max_q": 5.522927284240723, "min_q": 1.9176788330078125}, "td_error": [2.584125518798828, 1.236646056175232, 0.46681177616119385, 3.8676488399505615, 1.7748618125915527, 0.4456000328063965, 1.0540854930877686, 2.6793854236602783, 2.3478331565856934, 0.4565408229827881, 1.5226359367370605, 0.534551739692688, 1.718957781791687, 2.698826789855957, 1.238539457321167, 0.21277379989624023, 0.07062935829162598, 0.7016950845718384, 0.29512977600097656, 0.08491778373718262, 0.211448073387146, 0.9807157516479492, 2.00420880317688, 0.4932197332382202, 0.3332836627960205, 0.1543560028076172, 1.3505516052246094, 0.7409467697143555, 2.150080919265747, 0.8292163610458374, 0.807599663734436, 0.07972890138626099, 0.9841015338897705, 0.23566818237304688, 1.20774245262146, 1.4371578693389893, 3.0814552307128906, 0.08779406547546387, 0.08930253982543945, 1.5794857740402222, 0.8228327035903931, 2.3184666633605957, 0.7725162506103516, 1.4535188674926758, 0.6414989233016968, 1.2905555963516235, 3.0766661167144775, 0.5059770345687866, 0.5003645420074463, 3.135704517364502, 1.025118112564087, 1.162880778312683, 0.12267172336578369, 0.5032891035079956, 1.357791543006897, 0.8076057434082031, 0.6705917119979858, 1.199580192565918, 1.1848939657211304, 0.6269893646240234, 0.55452561378479, 2.086613178253174, 0.14001953601837158, 1.0184838771820068, 2.5355489253997803, 3.391350746154785, 1.7483842372894287, 0.23694181442260742, 1.781470775604248, 0.4085890054702759, 1.9753855466842651, 1.8763630390167236, 6.228334426879883, 1.898407220840454, 0.37185049057006836, 0.6469244956970215, 0.9427227973937988, 1.5433907508850098, 2.0054445266723633, 0.2963293790817261, 0.27758288383483887, 1.193648338317871, 0.43467962741851807, 0.485448956489563, 2.2318131923675537, 0.4188272953033447], "mean_td_error": 1.2178937196731567, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 55.0, "diff_num_grad_updates_vs_sampler_policy": 54.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.044553756713867, "actor_loss": -6.825538158416748, "critic_loss": 0.21121911704540253, "alpha_loss": -0.16290749609470367, "alpha_value": 0.9839123487472534, "log_alpha_value": -0.01621849089860916, "target_entropy": -6.0, "policy_t": -0.04069733992218971, "mean_q": 2.817873954772949, "max_q": 4.633885383605957, "min_q": 1.7848944664001465}, "td_error": [0.2663666009902954, 0.20949244499206543, 0.0299757719039917, 0.43269777297973633, 0.8878846168518066, 0.43751442432403564, 0.45233941078186035, 1.0633844137191772, 0.9566774964332581, 1.1017346382141113, 2.9362025260925293, 1.882500171661377, 0.5546504259109497, 1.0294148921966553, 0.784494161605835, 0.4622633457183838, 2.1348989009857178, 0.3969123363494873, 1.048112392425537, 3.224792003631592, 1.7189457416534424, 1.256591796875, 1.8882147073745728, 0.2299860119819641, 0.2945091724395752, 0.4446066617965698, 0.9986016750335693, 1.0250141620635986, 0.35423898696899414, 0.8083406686782837, 0.25879156589508057, 0.24315869808197021, 0.27660536766052246, 0.7534501552581787, 1.5638272762298584, 0.1099172830581665, 0.9624427556991577, 1.8379417657852173, 1.6313849687576294, 2.226980209350586, 1.1161885261535645, 0.38397061824798584, 0.18327784538269043, 0.1577293872833252, 1.1322665214538574, 2.255981922149658, 1.7067368030548096, 3.5562429428100586, 0.9120726585388184, 0.7077353000640869, 0.5391243696212769, 0.31035399436950684, 1.4995052814483643, 1.3622760772705078, 1.3896374702453613, 2.6018807888031006, 0.08097589015960693, 1.8671461343765259, 0.40850067138671875, 0.5723800659179688, 1.9225249290466309, 3.186997890472412, 0.3456176519393921, 0.37032628059387207, 0.2645798921585083, 1.91389000415802, 1.914540410041809, 1.2448244094848633, 0.43303442001342773, 0.24543917179107666, 0.5099958181381226, 0.44547152519226074, 1.0296611785888672, 1.3332836627960205, 0.48975205421447754, 0.7764285802841187, 1.4007830619812012, 1.7608377933502197, 0.2700011730194092, 0.19858264923095703, 0.7397441864013672, 0.913141131401062, 1.6701771020889282, 0.22428107261657715, 1.5718748569488525, 1.3086744546890259], "mean_td_error": 1.0279570817947388, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 55.0, "diff_num_grad_updates_vs_sampler_policy": 54.0}}, "num_env_steps_sampled": 50176, "num_env_steps_trained": 14190, "num_agent_steps_sampled": 150528, "num_agent_steps_trained": 14190, "last_target_update_ts": 50176, "num_target_updates": 55}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 150528, "num_agent_steps_trained": 14190, "num_env_steps_sampled": 50176, "num_env_steps_trained": 14190, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 935.4556823056922, "num_env_steps_trained_throughput_per_sec": 269.361122806773, "timesteps_total": 50176, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 150528, "timers": {"training_iteration_time_ms": 968.975, "sample_time_ms": 661.056, "load_time_ms": 0.32, "load_throughput": 806416.597, "learn_time_ms": 18.373, "learn_throughput": 14042.335, "synch_weights_time_ms": 9.547}, "counters": {"num_env_steps_sampled": 50176, "num_env_steps_trained": 14190, "num_agent_steps_sampled": 150528, "num_agent_steps_trained": 14190, "last_target_update_ts": 50176, "num_target_updates": 55}, "done": false, "episodes_total": 0, "training_iteration": 30, "trial_id": "7c290_00000", "date": "2023-11-18_19-56-35", "timestamp": 1700366195, "time_this_iter_s": 1.9243791103363037, "time_total_s": 54.7254638671875, "pid": 1618, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x312ac20c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 54.7254638671875, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 66.0, "ram_util_percent": 65.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.148012161254883, "actor_loss": -7.551558494567871, "critic_loss": 0.6440537571907043, "alpha_loss": -0.17056569457054138, "alpha_value": 0.9833326935768127, "log_alpha_value": -0.01680779457092285, "target_entropy": -6.0, "policy_t": 0.02390587329864502, "mean_q": 3.648178815841675, "max_q": 8.408267974853516, "min_q": 2.4350287914276123}, "td_error": [0.676750898361206, 1.6447473764419556, 2.643996000289917, 1.6856887340545654, 2.792335271835327, 2.2884018421173096, 0.2441622018814087, 3.9775075912475586, 0.9988018274307251, 5.629339694976807, 0.44957566261291504, 1.268222689628601, 0.5235450267791748, 2.573890209197998, 0.4676644802093506, 3.0613694190979004, 2.067452907562256, 0.41472840309143066, 2.087982177734375, 1.9266799688339233, 2.5168190002441406, 1.2576038837432861, 0.08058786392211914, 1.095008134841919, 0.5103741884231567, 3.909792423248291, 0.9286434650421143, 0.1135016679763794, 1.9103697538375854, 2.275153875350952, 4.5334625244140625, 0.8536379337310791, 2.4634454250335693, 3.6912879943847656, 0.5839166641235352, 3.5375704765319824, 0.6282671689987183, 1.6169188022613525, 2.019172430038452, 1.4022419452667236, 0.17676424980163574, 5.026105880737305, 1.0558656454086304, 1.6380071640014648, 3.1812424659729004, 1.5409295558929443, 6.124150276184082, 0.10233378410339355, 2.7218527793884277, 2.510942220687866, 1.3363523483276367, 2.3430304527282715, 0.6506813764572144, 0.9091223478317261, 1.3549847602844238, 2.1807761192321777, 0.09497570991516113, 0.5924956798553467, 0.8587459325790405, 0.4708070755004883, 1.2017467021942139, 0.3350940942764282, 5.611788749694824, 1.0017216205596924, 2.152653217315674, 2.0627598762512207, 1.0513030290603638, 1.9205515384674072, 5.4708251953125, 0.36237382888793945, 0.37662553787231445, 2.6042518615722656, 1.1231094598770142, 2.3270108699798584, 1.5811601877212524, 1.0990104675292969, 1.3785583972930908, 2.257234811782837, 1.267470359802246, 2.9611053466796875, 0.6551192998886108, 3.1873042583465576, 0.6663676500320435, 4.730727672576904, 1.730196475982666, 2.1783034801483154], "mean_td_error": 1.8548275232315063, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 57.0, "diff_num_grad_updates_vs_sampler_policy": 56.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.080917358398438, "actor_loss": -6.916375637054443, "critic_loss": 0.21178849041461945, "alpha_loss": -0.16938894987106323, "alpha_value": 0.9833374619483948, "log_alpha_value": -0.01680292934179306, "target_entropy": -6.0, "policy_t": -0.011786915361881256, "mean_q": 2.9150032997131348, "max_q": 4.147164821624756, "min_q": 1.9245595932006836}, "td_error": [0.9078541994094849, 1.5399693250656128, 1.1573638916015625, 1.393143653869629, 0.5798982381820679, 0.20388257503509521, 1.2285696268081665, 0.26066720485687256, 2.2149415016174316, 1.8051170110702515, 2.171272039413452, 0.84788978099823, 1.6995561122894287, 0.6103217601776123, 0.23750793933868408, 0.4768407344818115, 0.9441572427749634, 2.3885035514831543, 2.5895578861236572, 1.2621502876281738, 4.826687812805176, 0.07294714450836182, 1.2416772842407227, 1.4943710565567017, 0.19891119003295898, 0.37916839122772217, 0.8445690870285034, 1.031406044960022, 1.2616838216781616, 0.7820894718170166, 0.08192253112792969, 2.516103506088257, 0.935721755027771, 0.8983116149902344, 2.119727611541748, 0.16858839988708496, 0.32656240463256836, 1.4716815948486328, 1.548297643661499, 2.2983975410461426, 0.9381989240646362, 1.8687928915023804, 0.7712805271148682, 1.1013888120651245, 1.3378477096557617, 1.490350365638733, 0.06928884983062744, 2.0103349685668945, 0.9049170017242432, 3.183744430541992, 0.29761356115341187, 3.0034332275390625, 3.023672103881836, 0.42459559440612793, 1.1704752445220947, 0.6553623676300049, 1.6949470043182373, 1.64370858669281, 1.2563035488128662, 0.8564049005508423, 2.511648178100586, 4.509311199188232, 2.785397529602051, 0.670262336730957, 2.7001891136169434, 2.327387809753418, 0.42897140979766846, 1.7454352378845215, 3.5475428104400635, 0.6223502159118652, 1.0631088018417358, 0.9813841581344604, 1.7439881563186646, 0.2685302495956421, 0.8896039724349976, 1.1288468837738037, 0.7254278659820557, 1.0942199230194092, 0.24378442764282227, 0.07885229587554932, 4.127115249633789, 1.4418556690216064, 0.6023770570755005, 0.7036561965942383, 0.5127265453338623, 1.644953727722168], "mean_td_error": 1.3467391729354858, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 57.0, "diff_num_grad_updates_vs_sampler_policy": 56.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.10472583770752, "actor_loss": -6.849578857421875, "critic_loss": 0.23274177312850952, "alpha_loss": -0.16995064914226532, "alpha_value": 0.9833217263221741, "log_alpha_value": -0.016818925738334656, "target_entropy": -6.0, "policy_t": -0.003185601206496358, "mean_q": 2.7762088775634766, "max_q": 4.03297758102417, "min_q": 1.8830238580703735}, "td_error": [1.1532434225082397, 1.4337221384048462, 3.0876083374023438, 0.5416655540466309, 0.9660969972610474, 1.5123484134674072, 0.28660809993743896, 1.0635837316513062, 1.6552317142486572, 0.9639378190040588, 0.33628010749816895, 0.6759064197540283, 0.5543830394744873, 0.7167787551879883, 1.0208436250686646, 1.4364194869995117, 1.2208387851715088, 0.2912633419036865, 1.5649772882461548, 0.6959022283554077, 0.46596455574035645, 1.3255031108856201, 0.9247153401374817, 0.6299231052398682, 0.11782670021057129, 0.34932470321655273, 3.6333060264587402, 3.001704216003418, 0.08526372909545898, 0.9682563543319702, 0.8012663125991821, 0.8326157331466675, 1.1511707305908203, 1.1596523523330688, 0.2671029567718506, 1.621284008026123, 3.3713972568511963, 0.19688868522644043, 1.4704289436340332, 0.2009744644165039, 0.369189977645874, 1.2375376224517822, 1.438389539718628, 0.2884485721588135, 1.0131659507751465, 0.6022655963897705, 1.5250316858291626, 0.5459035634994507, 0.09963619709014893, 1.245982050895691, 0.34707677364349365, 0.9955875873565674, 0.5538729429244995, 0.7507450580596924, 1.6300305128097534, 1.499817132949829, 0.570534348487854, 2.4651854038238525, 2.0100393295288086, 2.2006990909576416, 1.7985092401504517, 1.378940224647522, 1.6075339317321777, 0.17414379119873047, 0.5089268684387207, 1.4634658098220825, 1.437354564666748, 0.35725438594818115, 1.9717962741851807, 1.2155916690826416, 1.0337071418762207, 1.4348816871643066, 0.15248942375183105, 1.3779001235961914, 0.6854919195175171, 0.77900230884552, 1.461086630821228, 0.3313405513763428, 1.3409215211868286, 0.9961471557617188, 0.09112548828125, 0.10708701610565186, 1.8424068689346313, 2.0943589210510254, 0.9146595001220703, 3.435166835784912], "mean_td_error": 1.1061934232711792, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 57.0, "diff_num_grad_updates_vs_sampler_policy": 56.0}}, "num_env_steps_sampled": 51968, "num_env_steps_trained": 14706, "num_agent_steps_sampled": 155904, "num_agent_steps_trained": 14706, "last_target_update_ts": 51968, "num_target_updates": 57}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 155904, "num_agent_steps_trained": 14706, "num_env_steps_sampled": 51968, "num_env_steps_trained": 14706, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 947.6561705132166, "num_env_steps_trained_throughput_per_sec": 272.8742098129574, "timesteps_total": 51968, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 155904, "timers": {"training_iteration_time_ms": 969.909, "sample_time_ms": 662.589, "load_time_ms": 0.32, "load_throughput": 806897.645, "learn_time_ms": 18.243, "learn_throughput": 14142.261, "synch_weights_time_ms": 9.464}, "counters": {"num_env_steps_sampled": 51968, "num_env_steps_trained": 14706, "num_agent_steps_sampled": 155904, "num_agent_steps_trained": 14706, "last_target_update_ts": 51968, "num_target_updates": 57}, "done": false, "episodes_total": 0, "training_iteration": 31, "trial_id": "7c290_00000", "date": "2023-11-18_19-56-37", "timestamp": 1700366197, "time_this_iter_s": 1.9006948471069336, "time_total_s": 56.626158714294434, "pid": 1618, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x312ac1620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 56.626158714294434, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 74.85, "ram_util_percent": 65.05}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.081995010375977, "actor_loss": -7.660780906677246, "critic_loss": 0.633929967880249, "alpha_loss": -0.1755126565694809, "alpha_value": 0.9827421307563782, "log_alpha_value": -0.017408523708581924, "target_entropy": -6.0, "policy_t": -0.037660300731658936, "mean_q": 3.5922091007232666, "max_q": 7.440818786621094, "min_q": 2.526946544647217}, "td_error": [0.1183171272277832, 0.33348822593688965, 3.3467912673950195, 1.3262802362442017, 2.8525171279907227, 0.4078786373138428, 0.07149136066436768, 0.3719184398651123, 3.059901237487793, 1.3916479349136353, 3.8769705295562744, 2.0302135944366455, 2.2766623497009277, 1.4554418325424194, 0.29714369773864746, 1.970144510269165, 0.7156169414520264, 1.428466558456421, 3.6306986808776855, 0.07496190071105957, 2.405323028564453, 0.20746445655822754, 5.94577693939209, 2.270740509033203, 0.4854520559310913, 3.7542612552642822, 1.1760904788970947, 1.7854617834091187, 1.7592617273330688, 2.6566948890686035, 1.3261747360229492, 1.7657570838928223, 0.677531361579895, 0.2114582061767578, 2.241391181945801, 1.940716028213501, 0.9412854909896851, 4.27719259262085, 0.11033070087432861, 3.5664021968841553, 5.076786041259766, 0.5919910669326782, 0.8427187204360962, 0.4496246576309204, 0.18808674812316895, 0.400005578994751, 4.548480033874512, 3.180586099624634, 1.6428385972976685, 1.3222894668579102, 0.6263048648834229, 0.10302150249481201, 4.443689823150635, 1.0294041633605957, 3.418423652648926, 1.526781439781189, 0.3153568506240845, 3.677762508392334, 0.8810340166091919, 0.0757591724395752, 1.9592969417572021, 0.07965898513793945, 1.9052964448928833, 0.19787323474884033, 0.7361444234848022, 1.199044942855835, 0.07755410671234131, 0.8307232856750488, 1.3582539558410645, 1.5160913467407227, 1.1979427337646484, 0.7327090501785278, 1.7965787649154663, 2.9217798709869385, 0.9021438360214233, 0.8836667537689209, 5.132589817047119, 5.879111289978027, 2.9690606594085693, 1.9873756170272827, 1.404810905456543, 3.7777395248413086, 1.800902247428894, 0.6885738372802734, 4.418185234069824, 2.298786163330078], "mean_td_error": 1.7852808237075806, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 59.0, "diff_num_grad_updates_vs_sampler_policy": 58.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.09908390045166, "actor_loss": -6.881889343261719, "critic_loss": 0.1967725306749344, "alpha_loss": -0.1757546067237854, "alpha_value": 0.9827475547790527, "log_alpha_value": -0.017403025180101395, "target_entropy": -6.0, "policy_t": -0.044581733644008636, "mean_q": 2.8472468852996826, "max_q": 4.247623443603516, "min_q": 1.8729002475738525}, "td_error": [0.4735085964202881, 0.17396795749664307, 2.1744604110717773, 0.9736043214797974, 1.8736492395401, 1.5624665021896362, 1.4663896560668945, 0.5535581111907959, 2.8896801471710205, 1.3248742818832397, 3.084127426147461, 0.7810858488082886, 3.081674575805664, 1.0350373983383179, 0.3098546266555786, 0.9543749094009399, 0.7161605358123779, 2.4494411945343018, 0.9630796909332275, 0.579643726348877, 0.3616328239440918, 0.3088066577911377, 2.258263349533081, 0.11175531148910522, 1.8402684926986694, 2.3098978996276855, 1.366598129272461, 0.6442236304283142, 0.9087008237838745, 2.3127999305725098, 1.49691641330719, 2.668602466583252, 3.0763871669769287, 2.7585673332214355, 0.9976093769073486, 2.7433652877807617, 1.4290432929992676, 1.4221822023391724, 1.887025237083435, 0.9150550365447998, 0.805692195892334, 0.3741886615753174, 2.0229527950286865, 0.7278212308883667, 0.07539653778076172, 0.0652536153793335, 1.5688302516937256, 2.130556106567383, 1.0164576768875122, 0.057367563247680664, 0.3912562131881714, 0.6338123083114624, 0.9500448703765869, 0.227819561958313, 1.3365895748138428, 2.102869987487793, 2.010787010192871, 0.6451601982116699, 0.6263468265533447, 2.084263801574707, 4.611225128173828, 0.8930414915084839, 0.5519002676010132, 0.170576810836792, 0.9786015748977661, 0.20327651500701904, 1.369832158088684, 2.136533737182617, 1.6455373764038086, 2.3518354892730713, 0.7220643758773804, 0.725982666015625, 1.2295700311660767, 0.18218201398849487, 1.6189565658569336, 0.5734100341796875, 1.0368930101394653, 1.4875588417053223, 1.6631861925125122, 0.4311795234680176, 1.4088715314865112, 2.231381416320801, 0.8108788728713989, 0.4193095564842224, 0.4092305898666382, 0.9592303037643433], "mean_td_error": 1.2780704498291016, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 59.0, "diff_num_grad_updates_vs_sampler_policy": 58.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.018013000488281, "actor_loss": -6.998936653137207, "critic_loss": 0.3194267153739929, "alpha_loss": -0.17450548708438873, "alpha_value": 0.9827316403388977, "log_alpha_value": -0.01741916872560978, "target_entropy": -6.0, "policy_t": -0.04459195211529732, "mean_q": 2.9600841999053955, "max_q": 4.1594133377075195, "min_q": 1.8473625183105469}, "td_error": [0.43729639053344727, 1.0846867561340332, 1.9728634357452393, 2.0467700958251953, 2.238086223602295, 1.1467787027359009, 0.6520800590515137, 0.937023401260376, 2.6053555011749268, 0.7666366100311279, 0.7238438129425049, 2.704453229904175, 1.2013366222381592, 1.676429033279419, 1.3008670806884766, 1.456888198852539, 0.7840656042098999, 2.03084659576416, 0.738470196723938, 0.692522406578064, 5.139730453491211, 0.8343890905380249, 1.1764012575149536, 2.074869155883789, 1.8863168954849243, 1.2066222429275513, 1.7819312810897827, 0.2581186294555664, 0.10673189163208008, 0.09033703804016113, 0.4680962562561035, 0.9733432531356812, 0.25832200050354004, 0.7280280590057373, 0.9624559879302979, 3.5199103355407715, 0.12014341354370117, 0.03178417682647705, 0.881813645362854, 0.6218860149383545, 0.372411847114563, 1.8666404485702515, 2.8142335414886475, 2.512758731842041, 2.5987048149108887, 0.45902562141418457, 0.34521782398223877, 5.226020812988281, 0.5714361667633057, 0.036968350410461426, 1.5986824035644531, 1.9730195999145508, 0.7902326583862305, 0.31369876861572266, 1.6484336853027344, 1.7048773765563965, 2.7100064754486084, 0.5755653381347656, 1.1685876846313477, 0.6894569396972656, 1.4713349342346191, 2.007050037384033, 1.3035967350006104, 1.3391680717468262, 0.6692910194396973, 0.14099657535552979, 1.7965290546417236, 2.952493906021118, 0.19962918758392334, 0.009098529815673828, 1.0467005968093872, 0.6943414211273193, 0.9818992614746094, 5.549145221710205, 3.333726406097412, 2.5875344276428223, 1.9072390794754028, 0.8189630508422852, 0.14414703845977783, 1.1159889698028564, 1.2409216165542603, 0.5794075727462769, 0.49636411666870117, 3.0473451614379883, 1.134168028831482, 1.4035078287124634], "mean_td_error": 1.3751755952835083, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 59.0, "diff_num_grad_updates_vs_sampler_policy": 58.0}}, "num_env_steps_sampled": 53760, "num_env_steps_trained": 15222, "num_agent_steps_sampled": 161280, "num_agent_steps_trained": 15222, "last_target_update_ts": 53760, "num_target_updates": 59}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 161280, "num_agent_steps_trained": 15222, "num_env_steps_sampled": 53760, "num_env_steps_trained": 15222, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 909.368306254227, "num_env_steps_trained_throughput_per_sec": 261.84935604195374, "timesteps_total": 53760, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 161280, "timers": {"training_iteration_time_ms": 978.441, "sample_time_ms": 672.839, "load_time_ms": 0.321, "load_throughput": 804199.191, "learn_time_ms": 18.174, "learn_throughput": 14195.728, "synch_weights_time_ms": 9.51}, "counters": {"num_env_steps_sampled": 53760, "num_env_steps_trained": 15222, "num_agent_steps_sampled": 161280, "num_agent_steps_trained": 15222, "last_target_update_ts": 53760, "num_target_updates": 59}, "done": false, "episodes_total": 0, "training_iteration": 32, "trial_id": "7c290_00000", "date": "2023-11-18_19-56-39", "timestamp": 1700366199, "time_this_iter_s": 1.980417013168335, "time_total_s": 58.60657572746277, "pid": 1618, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x312ac00e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 58.60657572746277, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 71.93333333333334, "ram_util_percent": 65.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.078044891357422, "actor_loss": -7.720834255218506, "critic_loss": 0.5524783730506897, "alpha_loss": -0.18149815499782562, "alpha_value": 0.9821519255638123, "log_alpha_value": -0.018009260296821594, "target_entropy": -6.0, "policy_t": -0.02714323066174984, "mean_q": 3.7068190574645996, "max_q": 7.40189266204834, "min_q": 2.5926332473754883}, "td_error": [1.676825761795044, 1.7971311807632446, 1.1587756872177124, 0.8722480535507202, 0.21303367614746094, 1.7627049684524536, 0.17553603649139404, 1.4294618368148804, 4.620517730712891, 0.7635372877120972, 1.6960021257400513, 0.6313837766647339, 1.1762053966522217, 3.0155413150787354, 0.2019805908203125, 6.400244235992432, 4.838077545166016, 0.05285358428955078, 3.0511274337768555, 2.171539306640625, 1.375197172164917, 1.3311903476715088, 1.814652919769287, 0.17528045177459717, 0.18839013576507568, 0.5334367752075195, 2.260556221008301, 1.2835010290145874, 1.6259169578552246, 2.484117031097412, 4.008091926574707, 1.113755464553833, 1.0393171310424805, 2.603236198425293, 0.42337143421173096, 0.43763649463653564, 1.2539408206939697, 3.502387046813965, 0.2961900234222412, 1.6472301483154297, 0.7429085969924927, 1.006699562072754, 1.1946686506271362, 0.28748226165771484, 2.00270676612854, 1.930894374847412, 1.8295681476593018, 1.672969102859497, 2.1578426361083984, 0.8356279134750366, 2.4102091789245605, 2.073306083679199, 0.40847814083099365, 0.7867686748504639, 0.7329001426696777, 3.5784292221069336, 0.9254629611968994, 1.9668734073638916, 0.661821722984314, 1.221627950668335, 0.6073791980743408, 0.3453845977783203, 1.0898511409759521, 1.8971598148345947, 1.5293676853179932, 1.82680344581604, 1.5937013626098633, 1.1732714176177979, 3.361693859100342, 3.529083490371704, 1.3118332624435425, 0.40434789657592773, 3.2039549350738525, 1.1957979202270508, 4.113514423370361, 0.05610013008117676, 1.0188560485839844, 0.08618617057800293, 2.0701358318328857, 0.2854747772216797, 7.197729587554932, 1.926193356513977, 0.8865045309066772, 5.019819259643555, 2.0968360900878906, 0.8246849775314331], "mean_td_error": 1.6765235662460327, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 61.0, "diff_num_grad_updates_vs_sampler_policy": 60.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.074063301086426, "actor_loss": -7.133976459503174, "critic_loss": 0.2140086442232132, "alpha_loss": -0.18136638402938843, "alpha_value": 0.9821577668190002, "log_alpha_value": -0.018003299832344055, "target_entropy": -6.0, "policy_t": 0.029278777539730072, "mean_q": 3.1098568439483643, "max_q": 4.2224836349487305, "min_q": 1.9178825616836548}, "td_error": [0.034978389739990234, 0.06303930282592773, 0.4015505313873291, 0.9558830261230469, 0.6845608949661255, 2.129179000854492, 1.0691298246383667, 1.119110107421875, 0.2340329885482788, 0.43213123083114624, 0.3411937952041626, 0.4160577058792114, 1.9892539978027344, 1.417569637298584, 0.3370211124420166, 0.9576354026794434, 1.489557147026062, 1.4473063945770264, 1.6835546493530273, 1.9301483631134033, 0.9373998641967773, 1.6536247730255127, 0.5377085208892822, 1.1041901111602783, 0.09962606430053711, 1.0849888324737549, 3.277238607406616, 0.28134751319885254, 1.2250468730926514, 0.7935152649879456, 0.14857947826385498, 1.032828450202942, 2.9467310905456543, 2.2281813621520996, 1.6578251123428345, 0.6515058279037476, 0.9442650079727173, 2.863851308822632, 0.8901267051696777, 1.1143594980239868, 0.41589248180389404, 4.635951519012451, 0.8259553909301758, 0.9489790201187134, 1.5532420873641968, 2.5904042720794678, 0.2215571403503418, 2.2478504180908203, 0.609796404838562, 0.9495536088943481, 3.2427797317504883, 4.19586181640625, 0.4904392957687378, 3.789637565612793, 1.3361762762069702, 0.9928979277610779, 1.4729690551757812, 0.6150878667831421, 0.6141834259033203, 1.790114164352417, 1.9498100280761719, 2.1992287635803223, 4.213828086853027, 1.0222675800323486, 0.18063569068908691, 0.4366316795349121, 1.0414621829986572, 2.603614330291748, 0.05360007286071777, 0.21893048286437988, 0.6076023578643799, 2.190199375152588, 0.8717290163040161, 1.135995626449585, 2.4342665672302246, 3.0042672157287598, 1.8776856660842896, 1.174007773399353, 2.3283944129943848, 0.022122621536254883, 1.5799601078033447, 2.2974846363067627, 2.1928184032440186, 0.07141804695129395, 0.5358682870864868, 1.3155102729797363], "mean_td_error": 1.3454012870788574, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 61.0, "diff_num_grad_updates_vs_sampler_policy": 60.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.121526718139648, "actor_loss": -7.123168468475342, "critic_loss": 0.2596593499183655, "alpha_loss": -0.18237872421741486, "alpha_value": 0.982142448425293, "log_alpha_value": -0.018018893897533417, "target_entropy": -6.0, "policy_t": -0.040157075971364975, "mean_q": 2.9249954223632812, "max_q": 4.285824298858643, "min_q": 1.729321002960205}, "td_error": [1.445845365524292, 0.5346877574920654, 0.9910162687301636, 0.3978384733200073, 0.9623329639434814, 1.1490132808685303, 0.6140658855438232, 0.5024247169494629, 0.8850668668746948, 0.6580789089202881, 1.6351147890090942, 0.731259822845459, 0.920685887336731, 1.8547320365905762, 0.2666926383972168, 3.3205254077911377, 2.643836498260498, 0.11474168300628662, 0.5401220321655273, 1.110774278640747, 2.4072818756103516, 1.0956549644470215, 2.0176901817321777, 1.2522568702697754, 0.6305475234985352, 1.961196780204773, 1.0874642133712769, 0.6838865280151367, 0.6837226152420044, 2.242628574371338, 2.722574234008789, 0.08211445808410645, 0.18788683414459229, 0.5399837493896484, 1.3319684267044067, 1.4880900382995605, 0.2566426992416382, 1.0454790592193604, 2.6004209518432617, 0.07483518123626709, 1.3388807773590088, 0.48724305629730225, 2.7316832542419434, 1.3401328325271606, 1.664119005203247, 0.6027512550354004, 2.2184996604919434, 3.7062525749206543, 0.19866669178009033, 0.5491446256637573, 0.38505804538726807, 0.3411283493041992, 1.2734627723693848, 1.1265299320220947, 0.5384145975112915, 2.3331639766693115, 0.5970823764801025, 1.8714455366134644, 0.20126378536224365, 0.7800347805023193, 1.7595667839050293, 2.062439441680908, 5.210684776306152, 0.25573956966400146, 2.18205189704895, 1.2249455451965332, 1.7650339603424072, 1.7792490720748901, 0.5141915082931519, 0.9425231218338013, 0.942169189453125, 0.04217255115509033, 0.42476677894592285, 1.7089810371398926, 0.10402488708496094, 0.539306640625, 0.44565296173095703, 0.42976462841033936, 4.155948162078857, 0.3000829219818115, 0.15789508819580078, 0.1517852544784546, 2.884418487548828, 1.595665454864502, 3.3898544311523438, 0.33362412452697754], "mean_td_error": 1.2239381074905396, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 61.0, "diff_num_grad_updates_vs_sampler_policy": 60.0}}, "num_env_steps_sampled": 55552, "num_env_steps_trained": 15738, "num_agent_steps_sampled": 166656, "num_agent_steps_trained": 15738, "last_target_update_ts": 55552, "num_target_updates": 61}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 166656, "num_agent_steps_trained": 15738, "num_env_steps_sampled": 55552, "num_env_steps_trained": 15738, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 936.8944674534749, "num_env_steps_trained_throughput_per_sec": 269.77541585155865, "timesteps_total": 55552, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 166656, "timers": {"training_iteration_time_ms": 950.985, "sample_time_ms": 673.378, "load_time_ms": 0.319, "load_throughput": 809311.519, "learn_time_ms": 18.271, "learn_throughput": 14120.854, "synch_weights_time_ms": 9.636}, "counters": {"num_env_steps_sampled": 55552, "num_env_steps_trained": 15738, "num_agent_steps_sampled": 166656, "num_agent_steps_trained": 15738, "last_target_update_ts": 55552, "num_target_updates": 61}, "done": false, "episodes_total": 0, "training_iteration": 33, "trial_id": "7c290_00000", "date": "2023-11-18_19-56-41", "timestamp": 1700366201, "time_this_iter_s": 1.9222767353057861, "time_total_s": 60.528852462768555, "pid": 1618, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x312ac1bc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 60.528852462768555, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 70.23333333333333, "ram_util_percent": 65.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.092794418334961, "actor_loss": -7.6880903244018555, "critic_loss": 0.5730246305465698, "alpha_loss": -0.1878242939710617, "alpha_value": 0.9815623760223389, "log_alpha_value": -0.01860974356532097, "target_entropy": -6.0, "policy_t": -0.06639133393764496, "mean_q": 3.6173641681671143, "max_q": 6.858091354370117, "min_q": 2.626570701599121}, "td_error": [4.403794765472412, 0.34173810482025146, 1.0700805187225342, 3.298859119415283, 2.401142120361328, 0.8303444385528564, 3.0096371173858643, 1.0580506324768066, 2.2048892974853516, 0.14533519744873047, 0.9724429845809937, 0.1826915740966797, 0.4985774755477905, 0.4616689682006836, 3.7900290489196777, 2.7022480964660645, 3.158674478530884, 1.6186254024505615, 0.0509335994720459, 2.224137306213379, 0.12640869617462158, 2.829653263092041, 0.6473803520202637, 2.213519811630249, 2.473848342895508, 5.087960243225098, 2.3495399951934814, 1.5214641094207764, 1.2882847785949707, 0.3409430980682373, 2.6460068225860596, 0.47440850734710693, 0.25527095794677734, 5.337421417236328, 3.095388889312744, 1.8664538860321045, 2.5786869525909424, 1.8476152420043945, 1.8634617328643799, 0.6284410953521729, 1.5543618202209473, 0.2485194206237793, 1.5155771970748901, 3.0503711700439453, 2.458245277404785, 0.5833263397216797, 6.368071556091309, 0.44800877571105957, 1.2051013708114624, 0.02809739112854004, 0.9186844825744629, 0.586184024810791, 1.7207837104797363, 0.01627516746520996, 2.2167530059814453, 2.7409467697143555, 0.5084216594696045, 2.1030843257904053, 0.7395925521850586, 0.2080371379852295, 2.6028800010681152, 1.2171969413757324, 4.060991287231445, 0.4203094244003296, 1.8736287355422974, 1.5526517629623413, 4.073345184326172, 1.2780876159667969, 2.009862184524536, 1.4136475324630737, 1.1614209413528442, 3.9390594959259033, 1.0858677625656128, 0.4967331886291504, 2.432248830795288, 0.1925421953201294, 0.27810490131378174, 0.8676860332489014, 2.0958352088928223, 0.29108095169067383, 0.7533730268478394, 1.2265033721923828, 2.6542959213256836, 1.9428164958953857, 0.4511291980743408, 3.8186609745025635], "mean_td_error": 1.7128427028656006, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 63.0, "diff_num_grad_updates_vs_sampler_policy": 62.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.048460960388184, "actor_loss": -7.078193187713623, "critic_loss": 0.287272572517395, "alpha_loss": -0.18693648278713226, "alpha_value": 0.981568455696106, "log_alpha_value": -0.0186034943908453, "target_entropy": -6.0, "policy_t": -0.05493080988526344, "mean_q": 3.007564067840576, "max_q": 4.161554336547852, "min_q": 1.5076520442962646}, "td_error": [2.6562373638153076, 1.6892445087432861, 1.8043606281280518, 1.054451823234558, 3.977224826812744, 0.11555814743041992, 0.3527038097381592, 1.1385542154312134, 0.7277438640594482, 5.500342845916748, 1.5793025493621826, 0.7425628900527954, 1.6769479513168335, 2.23105788230896, 1.3881330490112305, 0.6579350233078003, 1.0183981657028198, 3.690056800842285, 2.396998405456543, 1.3339929580688477, 1.3536180257797241, 1.5988109111785889, 0.1296612024307251, 0.3118882179260254, 1.486528992652893, 3.503946304321289, 0.2732585072517395, 1.4279299974441528, 2.077373504638672, 0.8126499652862549, 1.7332763671875, 0.5025091171264648, 0.35258352756500244, 1.6272425651550293, 2.234555244445801, 1.179054856300354, 1.061619758605957, 2.0942187309265137, 2.4057767391204834, 1.3972673416137695, 1.6316049098968506, 0.4689217805862427, 5.235849857330322, 0.6276417970657349, 3.0675294399261475, 0.0387578010559082, 0.6470363140106201, 1.1950087547302246, 0.9524924755096436, 1.0701478719711304, 0.3381541967391968, 1.7310305833816528, 1.5941269397735596, 0.7945846319198608, 3.6761488914489746, 1.2173494100570679, 1.9131262302398682, 2.6403167247772217, 0.3493220806121826, 0.6654473543167114, 0.9861724376678467, 2.432494640350342, 1.858222484588623, 3.2523882389068604, 0.8539227247238159, 2.3313302993774414, 1.3915232419967651, 3.918053150177002, 0.03657543659210205, 3.3882734775543213, 1.2258182764053345, 3.644789695739746, 1.401052474975586, 2.4096226692199707, 2.490804672241211, 0.39664411544799805, 1.1316132545471191, 2.778477907180786, 1.0895570516586304, 0.40185022354125977, 1.8741368055343628, 1.18048095703125, 3.062974452972412, 4.314220428466797, 3.0964407920837402, 1.1808106899261475], "mean_td_error": 1.689284086227417, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 63.0, "diff_num_grad_updates_vs_sampler_policy": 62.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.03625202178955, "actor_loss": -7.074699401855469, "critic_loss": 0.257468581199646, "alpha_loss": -0.1868620365858078, "alpha_value": 0.9815535545349121, "log_alpha_value": -0.018618708476424217, "target_entropy": -6.0, "policy_t": -0.021621203050017357, "mean_q": 2.9657394886016846, "max_q": 4.252859115600586, "min_q": 1.9624438285827637}, "td_error": [1.1072766780853271, 1.95052969455719, 2.6001687049865723, 0.8688814640045166, 0.053282856941223145, 2.8193047046661377, 0.47932565212249756, 0.7172822952270508, 0.7335991859436035, 0.5582479238510132, 1.5879889726638794, 0.4565432071685791, 0.5532399415969849, 1.3498166799545288, 1.5168571472167969, 0.8946026563644409, 3.691040277481079, 0.8737653493881226, 2.4107253551483154, 0.16870570182800293, 0.9460761547088623, 0.3288874626159668, 0.5795764923095703, 0.8988637924194336, 1.079887866973877, 0.3013606071472168, 1.9961317777633667, 1.283573865890503, 3.321749210357666, 2.5951614379882812, 2.642164468765259, 0.5164207220077515, 1.3990638256072998, 1.0414528846740723, 1.656112790107727, 1.140993595123291, 2.6372926235198975, 2.080312967300415, 0.7545783519744873, 0.1476517915725708, 3.4646687507629395, 0.8135440349578857, 2.336381435394287, 0.7854011058807373, 0.2805297374725342, 0.345322847366333, 2.696000099182129, 2.1657891273498535, 0.6448578834533691, 0.8141968250274658, 0.1842402219772339, 0.17191147804260254, 0.04092204570770264, 1.4329334497451782, 1.6367498636245728, 1.457848072052002, 0.8498520851135254, 0.5622328519821167, 0.5830516815185547, 0.4882913827896118, 0.09130477905273438, 0.5136587619781494, 0.06255435943603516, 3.9566028118133545, 1.3810091018676758, 0.8147642612457275, 1.8418338298797607, 0.7216389179229736, 0.9427156448364258, 3.9223427772521973, 0.09668004512786865, 0.32867980003356934, 0.9208709001541138, 0.9844636917114258, 0.5912988185882568, 0.25712060928344727, 1.8170757293701172, 1.4643397331237793, 1.0616834163665771, 1.026077151298523, 0.681005597114563, 4.511554718017578, 0.2086195945739746, 1.9096519947052002, 1.0177586078643799, 0.1902024745941162], "mean_td_error": 1.2303340435028076, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 63.0, "diff_num_grad_updates_vs_sampler_policy": 62.0}}, "num_env_steps_sampled": 57344, "num_env_steps_trained": 16254, "num_agent_steps_sampled": 172032, "num_agent_steps_trained": 16254, "last_target_update_ts": 57344, "num_target_updates": 63}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 172032, "num_agent_steps_trained": 16254, "num_env_steps_sampled": 57344, "num_env_steps_trained": 16254, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 931.7488844961011, "num_env_steps_trained_throughput_per_sec": 268.29376361606484, "timesteps_total": 57344, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 172032, "timers": {"training_iteration_time_ms": 961.301, "sample_time_ms": 685.719, "load_time_ms": 0.325, "load_throughput": 793176.304, "learn_time_ms": 18.302, "learn_throughput": 14096.866, "synch_weights_time_ms": 9.898}, "counters": {"num_env_steps_sampled": 57344, "num_env_steps_trained": 16254, "num_agent_steps_sampled": 172032, "num_agent_steps_trained": 16254, "last_target_update_ts": 57344, "num_target_updates": 63}, "done": false, "episodes_total": 0, "training_iteration": 34, "trial_id": "7c290_00000", "date": "2023-11-18_19-56-43", "timestamp": 1700366203, "time_this_iter_s": 1.9321961402893066, "time_total_s": 62.46104860305786, "pid": 1618, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x312a47380>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 62.46104860305786, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 68.10000000000001, "ram_util_percent": 65.13333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.086979866027832, "actor_loss": -7.595639228820801, "critic_loss": 0.3932826817035675, "alpha_loss": -0.19376890361309052, "alpha_value": 0.9809735417366028, "log_alpha_value": -0.01920980215072632, "target_entropy": -6.0, "policy_t": -0.04206152632832527, "mean_q": 3.5533206462860107, "max_q": 5.4209442138671875, "min_q": 2.384073257446289}, "td_error": [0.11548459529876709, 1.3445384502410889, 0.46801042556762695, 1.1538398265838623, 1.4371569156646729, 2.0423474311828613, 5.878607749938965, 2.397855281829834, 2.892150402069092, 1.2255010604858398, 1.8996586799621582, 3.2237024307250977, 0.7131130695343018, 2.269869804382324, 1.307242512702942, 3.8376893997192383, 0.359460711479187, 1.9532606601715088, 0.4527773857116699, 0.7313740253448486, 0.11479306221008301, 1.0515294075012207, 1.4200241565704346, 0.14726972579956055, 1.7255810499191284, 0.21255910396575928, 1.6461150646209717, 0.9394416809082031, 2.7885141372680664, 0.02159738540649414, 0.09617817401885986, 1.2128528356552124, 0.7962915897369385, 1.8271137475967407, 0.5230038166046143, 1.0045723915100098, 1.1782629489898682, 1.8291549682617188, 1.3235565423965454, 3.134744167327881, 0.20733165740966797, 1.644423484802246, 0.14135146141052246, 1.736494541168213, 0.6550853252410889, 1.1105605363845825, 1.4742686748504639, 1.1747393608093262, 0.5621167421340942, 0.05322253704071045, 0.5994482040405273, 0.33799946308135986, 1.1018162965774536, 0.25699007511138916, 0.05365562438964844, 0.3723105192184448, 0.11257278919219971, 4.416597366333008, 1.653951644897461, 0.2757601737976074, 1.2118964195251465, 0.6825777292251587, 2.3409206867218018, 2.588212013244629, 2.803314685821533, 0.4062032699584961, 1.172715425491333, 2.3635599613189697, 2.3038885593414307, 0.48937153816223145, 0.5900766849517822, 1.0258152484893799, 0.3046973943710327, 0.44905543327331543, 0.7706524133682251, 4.178957939147949, 3.25164794921875, 2.272029399871826, 4.539480209350586, 3.442911386489868, 3.1678965091705322, 0.2762737274169922, 1.377529501914978, 5.833032608032227, 0.5051614046096802, 4.710137367248535], "mean_td_error": 1.5080872774124146, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 65.0, "diff_num_grad_updates_vs_sampler_policy": 64.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.081522941589355, "actor_loss": -7.016181468963623, "critic_loss": 0.22372406721115112, "alpha_loss": -0.19359971582889557, "alpha_value": 0.9809798002243042, "log_alpha_value": -0.019203418865799904, "target_entropy": -6.0, "policy_t": -0.01529254112392664, "mean_q": 2.9605088233947754, "max_q": 4.019041061401367, "min_q": 1.3009755611419678}, "td_error": [1.0899128913879395, 1.863038420677185, 0.8396739959716797, 2.5740714073181152, 3.024937152862549, 3.924928903579712, 0.7172812223434448, 1.1637516021728516, 1.231933832168579, 0.15120452642440796, 0.5531949996948242, 1.1245793104171753, 1.2946982383728027, 1.1433075666427612, 0.4206383228302002, 0.9067282676696777, 0.45124757289886475, 1.8835718631744385, 0.5993955135345459, 0.5389444828033447, 0.9409081935882568, 1.2547335624694824, 0.42575812339782715, 2.599975109100342, 0.6309618949890137, 2.66740083694458, 0.7044887542724609, 0.9524906873703003, 2.839698314666748, 1.461146354675293, 0.8026508092880249, 2.8483598232269287, 1.618908166885376, 1.442021131515503, 1.1797258853912354, 1.3986961841583252, 0.5993523597717285, 1.3928024768829346, 2.284356117248535, 0.20203816890716553, 0.38372689485549927, 0.2697896957397461, 0.6043442487716675, 0.42692071199417114, 0.17841315269470215, 3.698305606842041, 3.5459377765655518, 3.479769706726074, 0.8800634145736694, 0.23784124851226807, 1.343050241470337, 0.33282899856567383, 4.1574201583862305, 4.153810977935791, 1.5473487377166748, 3.702995538711548, 0.7127760648727417, 1.6089860200881958, 0.05216622352600098, 4.064194679260254, 0.9175336360931396, 0.01833808422088623, 0.6967419385910034, 1.2663702964782715, 0.04618680477142334, 0.15845274925231934, 1.4663283824920654, 0.5826655626296997, 0.9735809564590454, 2.0393149852752686, 0.6565231084823608, 1.2794189453125, 1.4824352264404297, 3.0931596755981445, 0.3031315803527832, 3.391165018081665, 1.3544552326202393, 0.8128823041915894, 0.743317723274231, 0.367476224899292, 1.9550261497497559, 3.4035253524780273, 1.3325188159942627, 0.06104636192321777, 0.5430203676223755, 1.4711357355117798], "mean_td_error": 1.389999508857727, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 65.0, "diff_num_grad_updates_vs_sampler_policy": 64.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.105908393859863, "actor_loss": -7.213342189788818, "critic_loss": 0.29943883419036865, "alpha_loss": -0.19421754777431488, "alpha_value": 0.980965256690979, "log_alpha_value": -0.019218217581510544, "target_entropy": -6.0, "policy_t": -0.011698510497808456, "mean_q": 3.1156439781188965, "max_q": 4.340829849243164, "min_q": 1.9938026666641235}, "td_error": [1.9822320938110352, 4.421830177307129, 2.419674873352051, 3.0269806385040283, 3.3195173740386963, 0.11310839653015137, 2.322176933288574, 1.1543281078338623, 0.5506353378295898, 1.9684913158416748, 0.20449388027191162, 1.3897852897644043, 1.4328516721725464, 0.9111068248748779, 1.2052613496780396, 1.3970746994018555, 1.107102632522583, 1.551773190498352, 2.152568817138672, 0.04653215408325195, 1.001996636390686, 1.3616650104522705, 1.5802019834518433, 0.4810783863067627, 2.7638463973999023, 0.01593494415283203, 0.0876467227935791, 1.613016128540039, 2.9848597049713135, 0.48407578468322754, 0.04420804977416992, 0.8293806314468384, 1.901277780532837, 1.1948999166488647, 2.2407407760620117, 0.5491576194763184, 2.8536887168884277, 1.315043330192566, 0.8252365589141846, 3.5858945846557617, 0.7183072566986084, 1.2918591499328613, 1.5567631721496582, 1.6858090162277222, 0.3318749666213989, 1.6302258968353271, 2.3643975257873535, 0.06989800930023193, 0.8615871667861938, 1.3278504610061646, 1.8576143980026245, 4.073436737060547, 4.123178482055664, 0.7360081672668457, 4.095379829406738, 1.442365288734436, 0.038484930992126465, 1.0022637844085693, 0.3154789209365845, 4.284702301025391, 0.13335001468658447, 0.12040054798126221, 0.6749439239501953, 1.1485649347305298, 1.4165863990783691, 0.3446841239929199, 0.6257452964782715, 0.11225223541259766, 0.6821843385696411, 0.08042407035827637, 0.9786988496780396, 0.38822662830352783, 0.8568100929260254, 0.5755014419555664, 1.054847240447998, 0.3411262035369873, 0.6349678039550781, 0.2184605598449707, 1.5141010284423828, 0.19781506061553955, 1.3121168613433838, 0.8097977638244629, 3.5310113430023193, 0.8483827114105225, 0.6998672485351562, 2.0567069053649902], "mean_td_error": 1.343679428100586, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 65.0, "diff_num_grad_updates_vs_sampler_policy": 64.0}}, "num_env_steps_sampled": 59136, "num_env_steps_trained": 16770, "num_agent_steps_sampled": 177408, "num_agent_steps_trained": 16770, "last_target_update_ts": 59136, "num_target_updates": 65}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 177408, "num_agent_steps_trained": 16770, "num_env_steps_sampled": 59136, "num_env_steps_trained": 16770, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 957.4029986223992, "num_env_steps_trained_throughput_per_sec": 275.6807741568962, "timesteps_total": 59136, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 177408, "timers": {"training_iteration_time_ms": 956.91, "sample_time_ms": 681.837, "load_time_ms": 0.324, "load_throughput": 796445.449, "learn_time_ms": 18.174, "learn_throughput": 14196.045, "synch_weights_time_ms": 9.781}, "counters": {"num_env_steps_sampled": 59136, "num_env_steps_trained": 16770, "num_agent_steps_sampled": 177408, "num_agent_steps_trained": 16770, "last_target_update_ts": 59136, "num_target_updates": 65}, "done": false, "episodes_total": 0, "training_iteration": 35, "trial_id": "7c290_00000", "date": "2023-11-18_19-56-45", "timestamp": 1700366205, "time_this_iter_s": 1.8800749778747559, "time_total_s": 64.34112358093262, "pid": 1618, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x312ac3380>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 64.34112358093262, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 69.7, "ram_util_percent": 65.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.095510482788086, "actor_loss": -7.587316513061523, "critic_loss": 0.4833067059516907, "alpha_loss": -0.19998812675476074, "alpha_value": 0.9803853034973145, "log_alpha_value": -0.019809609279036522, "target_entropy": -6.0, "policy_t": -0.008030056953430176, "mean_q": 3.6023495197296143, "max_q": 5.4110612869262695, "min_q": 2.6522891521453857}, "td_error": [2.173095226287842, 1.4766589403152466, 4.259930610656738, 1.835501790046692, 0.7984075546264648, 2.1511733531951904, 0.9494123458862305, 4.12125301361084, 5.559211254119873, 0.0049207210540771484, 0.17570114135742188, 1.1681848764419556, 0.6036157608032227, 0.22661042213439941, 0.542412281036377, 5.76975154876709, 0.15929222106933594, 0.8512868881225586, 3.7393722534179688, 2.8597140312194824, 1.2202039957046509, 1.428842544555664, 0.3333975076675415, 1.7664315700531006, 2.395606279373169, 2.2704050540924072, 0.6108505725860596, 1.6576542854309082, 5.886006832122803, 3.6945977210998535, 2.568007469177246, 0.24981069564819336, 2.2605581283569336, 2.371005058288574, 0.1740884780883789, 0.9882433414459229, 0.8913887739181519, 0.9956793785095215, 1.6489137411117554, 2.1285817623138428, 1.9642966985702515, 4.061076641082764, 3.819152593612671, 1.3158788681030273, 1.1853563785552979, 2.761397361755371, 0.619441032409668, 0.06880569458007812, 1.6152102947235107, 1.1399638652801514, 0.5161468982696533, 0.3129580020904541, 1.0822895765304565, 1.340423822402954, 0.07223773002624512, 1.3880738019943237, 2.7070505619049072, 0.4002859592437744, 2.0120997428894043, 2.554375410079956, 1.6450424194335938, 1.688319206237793, 3.8658528327941895, 2.4552409648895264, 1.1042934656143188, 2.1096463203430176, 1.9484727382659912, 1.3524731397628784, 1.6636083126068115, 3.0306801795959473, 0.8795349597930908, 0.17672085762023926, 2.0340828895568848, 2.153064489364624, 0.3091576099395752, 1.9745597839355469, 2.0269222259521484, 0.1651473045349121, 1.229702353477478, 0.5813186168670654, 1.4380207061767578, 5.264538288116455, 1.786764144897461, 0.1305469274520874, 2.2340526580810547, 1.339888334274292], "mean_td_error": 1.7498832941055298, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 67.0, "diff_num_grad_updates_vs_sampler_policy": 66.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.156004905700684, "actor_loss": -6.922970771789551, "critic_loss": 0.19915299117565155, "alpha_loss": -0.20112283527851105, "alpha_value": 0.9803914427757263, "log_alpha_value": -0.01980334147810936, "target_entropy": -6.0, "policy_t": 0.013961365446448326, "mean_q": 2.813876152038574, "max_q": 3.8959317207336426, "min_q": 1.3543390035629272}, "td_error": [0.7853981852531433, 0.4921973943710327, 1.9240107536315918, 0.1177748441696167, 2.335444450378418, 0.8916008472442627, 0.9855427742004395, 0.2700164318084717, 0.07877731323242188, 0.14742815494537354, 1.1593352556228638, 2.1032495498657227, 0.5412956476211548, 0.8955074548721313, 1.08986234664917, 1.8192274570465088, 1.8472853899002075, 0.9308831691741943, 3.4705047607421875, 0.9376956820487976, 1.2009252309799194, 2.2415757179260254, 1.4050756692886353, 1.7052295207977295, 1.3572814464569092, 0.20275473594665527, 0.7775788307189941, 0.6844505071640015, 1.4124523401260376, 2.947383403778076, 2.4121763706207275, 0.8080456256866455, 3.6741576194763184, 0.6045509576797485, 1.2791118621826172, 3.2339415550231934, 0.05635213851928711, 0.10852229595184326, 1.5137243270874023, 0.9843353033065796, 2.1072497367858887, 2.5852677822113037, 0.4027860164642334, 1.7549961805343628, 0.058107972145080566, 1.8069578409194946, 0.6275612115859985, 1.2739932537078857, 0.1688624620437622, 2.881643772125244, 0.25501549243927, 0.8436712026596069, 0.9641847610473633, 2.2677664756774902, 1.4969427585601807, 1.5094316005706787, 0.6628878116607666, 0.6342149972915649, 0.963735818862915, 0.4441875219345093, 2.6602373123168945, 1.243059515953064, 0.1372370719909668, 2.1167349815368652, 1.1233633756637573, 1.9205617904663086, 1.109532117843628, 0.04704594612121582, 0.3869185447692871, 0.45356452465057373, 0.687825083732605, 0.6198564767837524, 0.9878696203231812, 0.5863775014877319, 0.9121867418289185, 0.9391804933547974, 2.5474328994750977, 2.1690735816955566, 0.07482254505157471, 6.343088150024414, 2.7299954891204834, 0.36102306842803955, 0.43196308612823486, 1.7791730165481567, 0.9837214946746826, 0.2576717138290405], "mean_td_error": 1.2645539045333862, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 67.0, "diff_num_grad_updates_vs_sampler_policy": 66.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.022385597229004, "actor_loss": -7.166635036468506, "critic_loss": 0.30236193537712097, "alpha_loss": -0.198621466755867, "alpha_value": 0.9803773164749146, "log_alpha_value": -0.019817786291241646, "target_entropy": -6.0, "policy_t": -0.06317517906427383, "mean_q": 3.107003927230835, "max_q": 4.344062328338623, "min_q": 1.6444674730300903}, "td_error": [0.287015438079834, 2.520690441131592, 0.9132518768310547, 0.7066464424133301, 2.0411415100097656, 1.22597336769104, 1.7412049770355225, 1.814112901687622, 1.803800106048584, 0.24091696739196777, 3.41703200340271, 2.1149420738220215, 0.08561873435974121, 1.3457391262054443, 0.8857203722000122, 3.448049545288086, 4.696347713470459, 1.0434705018997192, 1.4047693014144897, 1.939112663269043, 1.3311506509780884, 1.3633350133895874, 0.38619792461395264, 0.44586896896362305, 2.9544055461883545, 0.020990729331970215, 0.008972883224487305, 0.7464444637298584, 0.9343934059143066, 0.8981723785400391, 1.0554544925689697, 2.161190986633301, 0.12352108955383301, 6.8412885665893555, 0.3608686923980713, 3.18316912651062, 4.390604019165039, 1.753317952156067, 0.4889514446258545, 1.6384390592575073, 0.6262190937995911, 0.1398923397064209, 1.6272294521331787, 2.508488655090332, 1.7970938682556152, 0.07505154609680176, 0.5284359455108643, 0.29794347286224365, 0.17691290378570557, 1.5457627773284912, 1.1040277481079102, 1.5127227306365967, 0.1477963924407959, 1.3178596496582031, 0.10096681118011475, 0.6969823837280273, 2.635097026824951, 0.5914762020111084, 0.12006127834320068, 1.4529492855072021, 0.671306848526001, 1.0654832124710083, 2.175696849822998, 0.721328854560852, 0.3919243812561035, 1.2730249166488647, 1.1392412185668945, 0.7631853818893433, 1.0979478359222412, 2.488490581512451, 0.04178762435913086, 1.3422974348068237, 1.6480484008789062, 2.6873626708984375, 0.49621665477752686, 0.9706473350524902, 0.6226609945297241, 0.4321460723876953, 1.317946195602417, 0.6309235095977783, 1.5281455516815186, 3.877119541168213, 0.5412884950637817, 0.9516998529434204, 3.314649820327759, 0.8028078079223633], "mean_td_error": 1.3576586246490479, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 67.0, "diff_num_grad_updates_vs_sampler_policy": 66.0}}, "num_env_steps_sampled": 60928, "num_env_steps_trained": 17286, "num_agent_steps_sampled": 182784, "num_agent_steps_trained": 17286, "last_target_update_ts": 60928, "num_target_updates": 67}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 182784, "num_agent_steps_trained": 17286, "num_env_steps_sampled": 60928, "num_env_steps_trained": 17286, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 933.9112891521953, "num_env_steps_trained_throughput_per_sec": 268.91642031391336, "timesteps_total": 60928, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 182784, "timers": {"training_iteration_time_ms": 959.693, "sample_time_ms": 684.093, "load_time_ms": 0.323, "load_throughput": 797854.775, "learn_time_ms": 18.304, "learn_throughput": 14095.03, "synch_weights_time_ms": 9.968}, "counters": {"num_env_steps_sampled": 60928, "num_env_steps_trained": 17286, "num_agent_steps_sampled": 182784, "num_agent_steps_trained": 17286, "last_target_update_ts": 60928, "num_target_updates": 67}, "done": false, "episodes_total": 0, "training_iteration": 36, "trial_id": "7c290_00000", "date": "2023-11-18_19-56-47", "timestamp": 1700366207, "time_this_iter_s": 1.9288949966430664, "time_total_s": 66.27001857757568, "pid": 1618, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x312ac2e80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 66.27001857757568, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 70.66666666666667, "ram_util_percent": 65.13333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.088521003723145, "actor_loss": -7.374227046966553, "critic_loss": 0.3711155951023102, "alpha_loss": -0.20590056478977203, "alpha_value": 0.9797974824905396, "log_alpha_value": -0.020409390330314636, "target_entropy": -6.0, "policy_t": -0.00786642637103796, "mean_q": 3.3819756507873535, "max_q": 4.571021556854248, "min_q": 2.123746395111084}, "td_error": [0.8638415336608887, 3.2164652347564697, 2.0871903896331787, 0.5831210613250732, 4.511841773986816, 0.9898037910461426, 0.07269167900085449, 2.3719770908355713, 0.09021782875061035, 2.760619640350342, 4.260435104370117, 3.0297133922576904, 0.23391616344451904, 1.361301302909851, 2.38822603225708, 1.5454167127609253, 0.5017669200897217, 2.625509262084961, 1.6425074338912964, 1.8129806518554688, 1.0424084663391113, 0.5514154434204102, 1.1563262939453125, 0.30034875869750977, 1.3938045501708984, 1.6312028169631958, 1.0002508163452148, 0.4322608709335327, 0.23644471168518066, 1.9858198165893555, 2.96923828125, 1.0720298290252686, 0.8443624973297119, 1.5633831024169922, 1.135677456855774, 1.8059148788452148, 1.3006024360656738, 1.623478889465332, 3.1932685375213623, 5.0538716316223145, 2.0364034175872803, 1.5710854530334473, 1.0545094013214111, 1.2664234638214111, 0.9443391561508179, 0.3995211124420166, 0.25813543796539307, 1.325811743736267, 0.7406009435653687, 0.6451725959777832, 2.880553722381592, 0.6922138929367065, 2.6955246925354004, 2.4536187648773193, 3.1059975624084473, 7.003976345062256, 1.9822115898132324, 0.15328145027160645, 0.9907286167144775, 3.836587429046631, 1.426509976387024, 4.24222469329834, 2.711000442504883, 1.187565565109253, 3.7707512378692627, 0.03813815116882324, 3.586191177368164, 1.3379051685333252, 3.478879928588867, 1.392042636871338, 3.090158224105835, 3.7588281631469727, 3.171494960784912, 2.359862804412842, 2.3233461380004883, 1.840216040611267, 0.07460331916809082, 0.2631254196166992, 0.10169088840484619, 4.484381675720215, 1.0710550546646118, 0.9274011850357056, 2.1130621433258057, 0.8676376342773438, 0.018283963203430176, 2.166365385055542], "mean_td_error": 1.8032680749893188, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 69.0, "diff_num_grad_updates_vs_sampler_policy": 68.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.042956352233887, "actor_loss": -6.7282395362854, "critic_loss": 0.21390709280967712, "alpha_loss": -0.20491281151771545, "alpha_value": 0.9798030853271484, "log_alpha_value": -0.020403634756803513, "target_entropy": -6.0, "policy_t": -0.0553964339196682, "mean_q": 2.6244184970855713, "max_q": 3.7749838829040527, "min_q": 1.3067190647125244}, "td_error": [1.9162074327468872, 3.892275333404541, 0.06310629844665527, 1.3578050136566162, 0.2642781734466553, 0.5213097333908081, 1.0916528701782227, 0.07385885715484619, 2.694807529449463, 0.09568452835083008, 3.1054160594940186, 0.23236370086669922, 1.1624921560287476, 1.7197145223617554, 1.0373775959014893, 0.8522415161132812, 0.3685115575790405, 1.2319985628128052, 1.387349009513855, 0.39334332942962646, 2.1261205673217773, 0.3156038522720337, 3.0254287719726562, 0.9679241180419922, 2.3579773902893066, 0.8008139729499817, 1.937586784362793, 1.3743207454681396, 0.38816535472869873, 0.6654560565948486, 1.9326735734939575, 4.299787521362305, 1.0865987539291382, 1.7539118528366089, 1.0880542993545532, 0.15226924419403076, 0.014963269233703613, 0.9603797197341919, 0.21530115604400635, 0.29071497917175293, 1.3923697471618652, 0.8653333187103271, 0.735336422920227, 1.5990118980407715, 0.8548109531402588, 2.536343812942505, 0.04275250434875488, 0.5325300693511963, 1.0110828876495361, 0.4552576541900635, 1.6955931186676025, 4.100564002990723, 3.196268081665039, 1.0843111276626587, 1.4208426475524902, 0.2739013433456421, 1.0002341270446777, 0.13290661573410034, 0.8646534085273743, 1.1079189777374268, 1.1408289670944214, 2.235945224761963, 0.4988090991973877, 0.15615713596343994, 1.8244692087173462, 1.7492938041687012, 2.3132057189941406, 0.13302916288375854, 2.455230712890625, 2.807194709777832, 2.4067556858062744, 1.2061731815338135, 2.6952264308929443, 2.119312286376953, 0.20982098579406738, 0.7751468420028687, 2.9026920795440674, 2.329713821411133, 2.1966147422790527, 2.008965015411377, 1.2220964431762695, 0.9895397424697876, 1.010899305343628, 1.5144577026367188, 0.7304633855819702, 0.2623247504234314], "mean_td_error": 1.325723648071289, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 69.0, "diff_num_grad_updates_vs_sampler_policy": 68.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.01181411743164, "actor_loss": -7.013410568237305, "critic_loss": 0.3314809203147888, "alpha_loss": -0.20441068708896637, "alpha_value": 0.9797900915145874, "log_alpha_value": -0.020416948944330215, "target_entropy": -6.0, "policy_t": -0.049179308116436005, "mean_q": 2.9769554138183594, "max_q": 4.237131595611572, "min_q": 1.5673917531967163}, "td_error": [3.7990307807922363, 1.5854862928390503, 4.071234703063965, 0.10636258125305176, 0.019698619842529297, 0.8813623189926147, 1.0294921398162842, 0.558775782585144, 3.2003707885742188, 3.818511962890625, 3.3529233932495117, 0.7900371551513672, 1.570845365524292, 1.5690605640411377, 2.783381938934326, 3.078253746032715, 0.2835509777069092, 2.1204357147216797, 0.6696947813034058, 0.9860963821411133, 3.6788387298583984, 1.3486056327819824, 2.132410764694214, 0.32947349548339844, 1.4211008548736572, 1.9191168546676636, 0.7433820962905884, 1.9390636682510376, 2.2159595489501953, 0.37505316734313965, 0.9932293891906738, 1.1289479732513428, 1.4678356647491455, 3.602410078048706, 0.5165489912033081, 0.2836751937866211, 1.4654760360717773, 0.20079874992370605, 0.020955443382263184, 1.18967604637146, 0.7331175804138184, 0.12007796764373779, 0.2878185510635376, 2.1843175888061523, 4.4511284828186035, 0.05235922336578369, 3.0024523735046387, 1.3054395914077759, 0.5607900619506836, 1.2230722904205322, 0.2269730567932129, 0.7582870721817017, 1.5034058094024658, 0.8541808128356934, 0.8856154680252075, 0.6218781471252441, 1.5915119647979736, 0.10919928550720215, 2.8658504486083984, 0.15580856800079346, 3.3996081352233887, 0.5106899738311768, 1.4427289962768555, 0.25100135803222656, 4.806543350219727, 2.050347089767456, 0.13811862468719482, 0.5434850454330444, 1.5124560594558716, 1.1239677667617798, 0.44408178329467773, 0.39515066146850586, 0.20547699928283691, 3.29957914352417, 1.3962215185165405, 2.257155656814575, 0.5667117834091187, 0.8410743474960327, 2.5563673973083496, 1.7740387916564941, 1.4523389339447021, 4.062289237976074, 0.5750924348831177, 0.510980486869812, 0.17171335220336914, 0.22055065631866455], "mean_td_error": 1.4331189393997192, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 69.0, "diff_num_grad_updates_vs_sampler_policy": 68.0}}, "num_env_steps_sampled": 62720, "num_env_steps_trained": 17802, "num_agent_steps_sampled": 188160, "num_agent_steps_trained": 17802, "last_target_update_ts": 62720, "num_target_updates": 69}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 188160, "num_agent_steps_trained": 17802, "num_env_steps_sampled": 62720, "num_env_steps_trained": 17802, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 811.7526991219019, "num_env_steps_trained_throughput_per_sec": 233.74129059536904, "timesteps_total": 62720, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 188160, "timers": {"training_iteration_time_ms": 983.389, "sample_time_ms": 707.926, "load_time_ms": 0.325, "load_throughput": 794690.778, "learn_time_ms": 18.451, "learn_throughput": 13982.802, "synch_weights_time_ms": 10.113}, "counters": {"num_env_steps_sampled": 62720, "num_env_steps_trained": 17802, "num_agent_steps_sampled": 188160, "num_agent_steps_trained": 17802, "last_target_update_ts": 62720, "num_target_updates": 69}, "done": false, "episodes_total": 0, "training_iteration": 37, "trial_id": "7c290_00000", "date": "2023-11-18_19-56-49", "timestamp": 1700366209, "time_this_iter_s": 2.215928792953491, "time_total_s": 68.48594737052917, "pid": 1618, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x312a47b00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 68.48594737052917, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 60.166666666666664, "ram_util_percent": 65.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.093817710876465, "actor_loss": -7.318568229675293, "critic_loss": 0.37894341349601746, "alpha_loss": -0.21206305921077728, "alpha_value": 0.9792099595069885, "log_alpha_value": -0.021009203046560287, "target_entropy": -6.0, "policy_t": 0.02259497530758381, "mean_q": 3.313462257385254, "max_q": 4.350890636444092, "min_q": 1.8665783405303955}, "td_error": [3.933488607406616, 6.003424644470215, 1.5649579763412476, 0.8402751684188843, 0.7728145122528076, 0.3954235315322876, 1.5773894786834717, 0.744783878326416, 0.8457438945770264, 1.3696069717407227, 0.8417439460754395, 0.4642016887664795, 1.0721633434295654, 0.1260390281677246, 1.3379913568496704, 2.8672094345092773, 0.15581262111663818, 2.2049293518066406, 3.1704981327056885, 2.248992919921875, 1.8570773601531982, 0.08923029899597168, 2.399862766265869, 2.8306679725646973, 5.140945911407471, 0.26400327682495117, 0.6000114679336548, 3.301290988922119, 0.4998471736907959, 3.2299866676330566, 2.4306631088256836, 0.31442952156066895, 2.4115219116210938, 1.9318492412567139, 0.8141576051712036, 1.0699489116668701, 0.8585585355758667, 1.6247855424880981, 0.20331323146820068, 1.3359047174453735, 1.349892497062683, 2.2722020149230957, 2.783700466156006, 0.7540417909622192, 2.568150281906128, 2.2575747966766357, 1.5425856113433838, 4.760871887207031, 1.8448526859283447, 4.44136905670166, 2.6548752784729004, 1.2917307615280151, 0.8934264183044434, 2.326127052307129, 2.8298349380493164, 0.1914273500442505, 2.667867660522461, 0.22779154777526855, 0.05895280838012695, 0.4534735679626465, 0.78098464012146, 1.1982152462005615, 1.83461332321167, 1.6964812278747559, 2.3781208992004395, 0.14338397979736328, 9.689157485961914, 1.8180724382400513, 2.4744656085968018, 0.8644721508026123, 0.7273226976394653, 1.6624479293823242, 1.2407398223876953, 6.795766830444336, 1.7937434911727905, 1.1221388578414917, 0.06988286972045898, 3.9268624782562256, 0.02529287338256836, 3.571591854095459, 0.7786334753036499, 1.515566349029541, 4.276611328125, 0.17379438877105713, 0.42708539962768555, 3.719265937805176], "mean_td_error": 1.8444302082061768, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 71.0, "diff_num_grad_updates_vs_sampler_policy": 70.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.114265441894531, "actor_loss": -6.6768479347229, "critic_loss": 0.2622448801994324, "alpha_loss": -0.21243514120578766, "alpha_value": 0.9792155027389526, "log_alpha_value": -0.021003520116209984, "target_entropy": -6.0, "policy_t": -0.010255580767989159, "mean_q": 2.627222776412964, "max_q": 3.631791591644287, "min_q": 1.237141489982605}, "td_error": [1.8015278577804565, 1.433654546737671, 0.3713793158531189, 5.740756511688232, 5.089848041534424, 1.3579803705215454, 0.02293384075164795, 0.29037249088287354, 1.8025437593460083, 0.31803441047668457, 1.0168354511260986, 1.0381410121917725, 1.1562875509262085, 2.769193410873413, 0.7898929119110107, 2.082340955734253, 0.35425662994384766, 0.12743127346038818, 1.7773792743682861, 3.5640742778778076, 4.3857526779174805, 0.362689733505249, 3.9151134490966797, 0.2817983627319336, 0.8722555637359619, 1.1442878246307373, 1.4140561819076538, 2.921016216278076, 0.4388306140899658, 1.0805103778839111, 0.808551549911499, 1.5047036409378052, 0.4185689687728882, 0.36428672075271606, 1.9639699459075928, 0.7217726707458496, 0.044153690338134766, 0.8286277055740356, 0.9941301345825195, 2.766343593597412, 4.666449069976807, 0.9504239559173584, 1.9948277473449707, 2.7407336235046387, 1.8769232034683228, 2.1619350910186768, 2.362636089324951, 2.344695568084717, 1.1658293008804321, 0.8040512800216675, 1.0284221172332764, 0.35433995723724365, 0.5099260807037354, 0.9221859574317932, 0.6965600252151489, 0.327076256275177, 2.1106982231140137, 1.7200491428375244, 2.4039816856384277, 0.48676538467407227, 2.52866268157959, 6.535724639892578, 0.5080695152282715, 1.9903957843780518, 0.8568772077560425, 0.4912036061286926, 0.35097432136535645, 0.18287134170532227, 1.3127741813659668, 0.6806761622428894, 3.413064479827881, 0.07651245594024658, 0.9058140516281128, 2.6401944160461426, 0.8828555345535278, 2.2013421058654785, 2.5310802459716797, 0.1377708911895752, 3.947388172149658, 1.9748218059539795, 0.28282296657562256, 1.0165338516235352, 1.4874905347824097, 1.6828068494796753, 1.5620301961898804, 1.0704894065856934], "mean_td_error": 1.5466983318328857, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 71.0, "diff_num_grad_updates_vs_sampler_policy": 70.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.165619850158691, "actor_loss": -7.009158134460449, "critic_loss": 0.2771601676940918, "alpha_loss": -0.21363858878612518, "alpha_value": 0.9792035222053528, "log_alpha_value": -0.021015798673033714, "target_entropy": -6.0, "policy_t": -0.06763971596956253, "mean_q": 2.820202350616455, "max_q": 4.095173358917236, "min_q": 1.4659552574157715}, "td_error": [0.32819437980651855, 2.8553426265716553, 1.3697168827056885, 0.5785115957260132, 0.1003427505493164, 0.25587666034698486, 0.45751821994781494, 1.9492772817611694, 0.4756026268005371, 0.6614087820053101, 0.8224695920944214, 1.0120408535003662, 2.44708514213562, 0.6076500415802002, 0.03458750247955322, 2.1311023235321045, 0.23641109466552734, 0.05400681495666504, 0.2685279846191406, 3.951817750930786, 1.7403732538223267, 0.738074779510498, 0.6958727836608887, 3.440197467803955, 0.09991157054901123, 1.837935447692871, 0.8398115634918213, 1.7035993337631226, 1.072606086730957, 3.8445041179656982, 0.7927825450897217, 0.43596673011779785, 1.0074422359466553, 2.440028190612793, 2.6466116905212402, 0.0698401927947998, 1.6762404441833496, 1.6326991319656372, 2.894296646118164, 2.1223719120025635, 1.0310721397399902, 0.6024558544158936, 1.0201904773712158, 0.2454463243484497, 2.7127153873443604, 0.9982733726501465, 1.5724639892578125, 1.7243443727493286, 1.3336747884750366, 1.5154590606689453, 1.9621148109436035, 0.006139516830444336, 2.3055837154388428, 0.011258244514465332, 1.1743284463882446, 3.1607518196105957, 0.8215687274932861, 3.213487386703491, 0.9041352272033691, 0.014133691787719727, 1.7564411163330078, 1.4400840997695923, 0.3667670488357544, 0.37843501567840576, 3.171154022216797, 1.8239929676055908, 0.1429440975189209, 1.0303479433059692, 0.39413130283355713, 0.6676067113876343, 2.7962331771850586, 0.28269827365875244, 1.9470713138580322, 1.8367825746536255, 0.7498068809509277, 3.144127368927002, 2.4764575958251953, 0.7303516864776611, 1.1715434789657593, 0.8340301513671875, 0.4645036458969116, 0.3445810079574585, 0.7520096302032471, 0.13136279582977295, 1.7098233699798584, 0.5377253293991089], "mean_td_error": 1.2760379314422607, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 71.0, "diff_num_grad_updates_vs_sampler_policy": 70.0}}, "num_env_steps_sampled": 64512, "num_env_steps_trained": 18318, "num_agent_steps_sampled": 193536, "num_agent_steps_trained": 18318, "last_target_update_ts": 64512, "num_target_updates": 71}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 193536, "num_agent_steps_trained": 18318, "num_env_steps_sampled": 64512, "num_env_steps_trained": 18318, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 1011.7086208528043, "num_env_steps_trained_throughput_per_sec": 291.31788412949055, "timesteps_total": 64512, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 193536, "timers": {"training_iteration_time_ms": 969.243, "sample_time_ms": 691.766, "load_time_ms": 0.326, "load_throughput": 791493.879, "learn_time_ms": 18.383, "learn_throughput": 14034.668, "synch_weights_time_ms": 9.899}, "counters": {"num_env_steps_sampled": 64512, "num_env_steps_trained": 18318, "num_agent_steps_sampled": 193536, "num_agent_steps_trained": 18318, "last_target_update_ts": 64512, "num_target_updates": 71}, "done": false, "episodes_total": 0, "training_iteration": 38, "trial_id": "7c290_00000", "date": "2023-11-18_19-56-51", "timestamp": 1700366211, "time_this_iter_s": 1.7798218727111816, "time_total_s": 70.26576924324036, "pid": 1618, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x312a46c00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 70.26576924324036, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 61.75, "ram_util_percent": 65.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.045536994934082, "actor_loss": -7.1253228187561035, "critic_loss": 0.3080318570137024, "alpha_loss": -0.21707290410995483, "alpha_value": 0.9786229133605957, "log_alpha_value": -0.02160889282822609, "target_entropy": -6.0, "policy_t": -0.07222997397184372, "mean_q": 3.1089189052581787, "max_q": 4.1422834396362305, "min_q": 1.956780195236206}, "td_error": [0.1945972442626953, 0.5704354047775269, 1.1715680360794067, 2.1705069541931152, 1.7202262878417969, 4.052019119262695, 1.294413685798645, 0.40282392501831055, 2.6626856327056885, 0.043898582458496094, 3.772571563720703, 1.549975872039795, 3.551675796508789, 1.684035062789917, 2.8654673099517822, 1.8559101819992065, 0.7877566814422607, 0.9433270692825317, 1.5178980827331543, 1.1585144996643066, 1.6856648921966553, 2.08305287361145, 0.4226166009902954, 3.2368083000183105, 0.7497113943099976, 3.3954808712005615, 1.933998942375183, 5.802117347717285, 1.4909182786941528, 0.17509043216705322, 1.6170562505722046, 2.3756308555603027, 1.4092521667480469, 0.736488938331604, 1.8205914497375488, 0.25053083896636963, 1.8152320384979248, 0.8464903831481934, 1.9811955690383911, 1.5068790912628174, 1.6751339435577393, 1.7901962995529175, 5.365018844604492, 3.1527099609375, 0.07436513900756836, 1.03275465965271, 1.0988670587539673, 0.9735500812530518, 0.7198841571807861, 2.7777175903320312, 3.2093422412872314, 0.7603280544281006, 2.9113388061523438, 3.2584447860717773, 0.8402467966079712, 0.9715278148651123, 7.83744478225708, 3.2076570987701416, 1.841711401939392, 2.933934211730957, 0.6821671724319458, 0.4032090902328491, 1.4653569459915161, 1.552551031112671, 1.3579859733581543, 1.2634227275848389, 0.8824245929718018, 2.682953357696533, 1.416668176651001, 2.7556228637695312, 1.3037128448486328, 2.940509796142578, 4.901872634887695, 1.5337668657302856, 2.03505539894104, 0.5458039045333862, 2.1364688873291016, 0.2037346363067627, 3.0198230743408203, 0.8144627809524536, 1.7165766954421997, 0.47675609588623047, 0.901321530342102, 0.4798872470855713, 1.7397000789642334, 2.7417097091674805], "mean_td_error": 1.8336142301559448, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 73.0, "diff_num_grad_updates_vs_sampler_policy": 72.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.084437370300293, "actor_loss": -6.5774359703063965, "critic_loss": 0.23808366060256958, "alpha_loss": -0.21785758435726166, "alpha_value": 0.9786283373832703, "log_alpha_value": -0.02160334587097168, "target_entropy": -6.0, "policy_t": -0.06411237269639969, "mean_q": 2.463632583618164, "max_q": 3.493501663208008, "min_q": 1.0214526653289795}, "td_error": [1.4471772909164429, 1.4979093074798584, 2.4991166591644287, 3.3462283611297607, 1.3182169198989868, 0.6069530844688416, 0.9913433790206909, 3.1489930152893066, 0.5546518564224243, 0.15080714225769043, 1.6322083473205566, 0.38745296001434326, 0.4872184991836548, 0.23863792419433594, 1.1179563999176025, 0.06202709674835205, 1.1241042613983154, 2.127941131591797, 1.1680893898010254, 4.646191120147705, 2.0942862033843994, 3.5288877487182617, 0.15532130002975464, 0.7976475954055786, 2.926985740661621, 1.7560774087905884, 1.4593912363052368, 0.6225897073745728, 0.3126952648162842, 0.32527637481689453, 0.022823333740234375, 0.44429898262023926, 0.6046512126922607, 0.7298921346664429, 3.206317663192749, 0.8850513696670532, 0.819792628288269, 3.078223466873169, 0.3662482500076294, 0.2439367175102234, 2.299499750137329, 2.868272542953491, 2.870994806289673, 0.28697144985198975, 0.26433098316192627, 1.041993260383606, 2.174858570098877, 1.1045780181884766, 2.705195903778076, 1.4265942573547363, 0.5222294330596924, 0.7132627964019775, 1.6199527978897095, 2.81245493888855, 1.1863380670547485, 1.147657871246338, 1.1455479860305786, 0.5011724233627319, 2.067927837371826, 1.053061604499817, 1.8945282697677612, 3.0399632453918457, 0.6212158203125, 1.2630751132965088, 2.0925886631011963, 1.697178840637207, 0.09666550159454346, 1.17816162109375, 2.453094482421875, 1.1507408618927002, 2.1891558170318604, 2.6770317554473877, 3.262425661087036, 1.9090275764465332, 0.44551682472229004, 2.3677611351013184, 2.2822117805480957, 0.007736325263977051, 1.3290915489196777, 0.10934102535247803, 0.7287886142730713, 3.617830276489258, 1.9204057455062866, 1.6162110567092896, 0.5566914677619934, 0.9159986972808838], "mean_td_error": 1.4438248872756958, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 73.0, "diff_num_grad_updates_vs_sampler_policy": 72.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.109246253967285, "actor_loss": -6.958715915679932, "critic_loss": 0.3365284204483032, "alpha_loss": -0.2185128927230835, "alpha_value": 0.9786167740821838, "log_alpha_value": -0.021615153178572655, "target_entropy": -6.0, "policy_t": -0.07510116696357727, "mean_q": 2.8647871017456055, "max_q": 4.009181022644043, "min_q": 1.4997624158859253}, "td_error": [2.4242796897888184, 0.5357407331466675, 2.6668145656585693, 2.3264594078063965, 0.41626274585723877, 1.0200347900390625, 0.5808455944061279, 1.3780988454818726, 0.8357992172241211, 0.5437023639678955, 0.7811498641967773, 0.028832435607910156, 1.1472773551940918, 3.3366925716400146, 0.13971078395843506, 1.1929848194122314, 2.303147315979004, 1.4949703216552734, 0.5222095251083374, 1.910245656967163, 0.41750311851501465, 0.1409931182861328, 0.7039585113525391, 1.2802691459655762, 2.0542702674865723, 1.9086272716522217, 0.6862266063690186, 0.8969711065292358, 0.9966986179351807, 1.0917727947235107, 1.3004049062728882, 2.553385019302368, 1.017292857170105, 0.45269572734832764, 2.1615991592407227, 2.4399423599243164, 2.043972969055176, 1.5042988061904907, 2.600512981414795, 2.027289390563965, 1.8908380270004272, 1.1039732694625854, 4.204327583312988, 1.020524024963379, 2.389873504638672, 1.2147239446640015, 0.3642655611038208, 1.0074481964111328, 2.905519485473633, 4.004831790924072, 1.2902555465698242, 1.533304214477539, 2.8863587379455566, 2.2866883277893066, 2.7568111419677734, 2.338853359222412, 0.7256791591644287, 1.2667959928512573, 2.910386800765991, 1.8626599311828613, 0.3620772361755371, 3.1876752376556396, 1.04233717918396, 1.1957895755767822, 3.9248013496398926, 1.0884402990341187, 0.900306224822998, 2.605349540710449, 1.8679895401000977, 0.8109971284866333, 3.4529101848602295, 2.124316692352295, 1.1435863971710205, 2.025275707244873, 1.5070631504058838, 2.627596378326416, 3.357010841369629, 0.6807188987731934, 0.22604990005493164, 2.055421829223633, 1.8524888753890991, 0.33929431438446045, 3.0499467849731445, 1.7077993154525757, 0.35734689235687256, 1.5871233940124512], "mean_td_error": 1.6152067184448242, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 73.0, "diff_num_grad_updates_vs_sampler_policy": 72.0}}, "num_env_steps_sampled": 66304, "num_env_steps_trained": 18834, "num_agent_steps_sampled": 198912, "num_agent_steps_trained": 18834, "last_target_update_ts": 66304, "num_target_updates": 73}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 198912, "num_agent_steps_trained": 18834, "num_env_steps_sampled": 66304, "num_env_steps_trained": 18834, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 939.5701349366119, "num_env_steps_trained_throughput_per_sec": 270.5458647473726, "timesteps_total": 66304, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 198912, "timers": {"training_iteration_time_ms": 967.641, "sample_time_ms": 691.553, "load_time_ms": 0.321, "load_throughput": 802529.244, "learn_time_ms": 18.363, "learn_throughput": 14050.175, "synch_weights_time_ms": 9.744}, "counters": {"num_env_steps_sampled": 66304, "num_env_steps_trained": 18834, "num_agent_steps_sampled": 198912, "num_agent_steps_trained": 18834, "last_target_update_ts": 66304, "num_target_updates": 73}, "done": false, "episodes_total": 0, "training_iteration": 39, "trial_id": "7c290_00000", "date": "2023-11-18_19-56-53", "timestamp": 1700366213, "time_this_iter_s": 1.9164810180664062, "time_total_s": 72.18225026130676, "pid": 1618, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x312ac2980>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 72.18225026130676, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 69.3, "ram_util_percent": 65.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.04361629486084, "actor_loss": -7.077080249786377, "critic_loss": 0.2892853617668152, "alpha_loss": -0.22305180132389069, "alpha_value": 0.9780364632606506, "log_alpha_value": -0.022208314388990402, "target_entropy": -6.0, "policy_t": -0.09646390378475189, "mean_q": 3.081751585006714, "max_q": 3.968076229095459, "min_q": 1.897424578666687}, "td_error": [2.865408420562744, 4.485164642333984, 2.1558494567871094, 2.85329270362854, 2.22723650932312, 0.20065581798553467, 2.18979549407959, 1.0571315288543701, 0.7955411672592163, 2.183478355407715, 1.4237966537475586, 2.4590933322906494, 0.13453519344329834, 4.023764610290527, 4.326684474945068, 0.16650676727294922, 1.678114652633667, 1.5915958881378174, 1.2040432691574097, 1.2973120212554932, 1.278193712234497, 1.7741246223449707, 1.6617337465286255, 1.0669653415679932, 1.201259732246399, 1.7750195264816284, 1.3902565240859985, 0.6006782054901123, 1.3824305534362793, 1.5045965909957886, 2.9142353534698486, 2.9853549003601074, 1.8910224437713623, 2.9440417289733887, 0.7035408020019531, 0.5703169107437134, 0.014764189720153809, 0.4710272550582886, 2.018239736557007, 1.9787898063659668, 5.717796325683594, 0.6972208023071289, 0.18550503253936768, 3.154054880142212, 1.0703445672988892, 1.3145170211791992, 1.557765007019043, 0.19865310192108154, 0.7549244165420532, 1.457174301147461, 1.4237735271453857, 2.2570607662200928, 1.77224600315094, 1.016688346862793, 0.43838608264923096, 0.2591257095336914, 1.3724966049194336, 1.4632601737976074, 3.392085313796997, 0.9297244548797607, 1.1351500749588013, 0.5227506160736084, 2.8826098442077637, 2.5055174827575684, 3.463747024536133, 1.4930833578109741, 2.586378574371338, 1.0236226320266724, 1.1241461038589478, 1.6316750049591064, 1.2526495456695557, 2.2258591651916504, 1.378656268119812, 0.8670270442962646, 0.31402695178985596, 2.534219264984131, 0.415321946144104, 1.4647586345672607, 4.525006294250488, 0.7092554569244385, 0.8643673658370972, 0.9772359132766724, 1.1969566345214844, 2.3487696647644043, 2.9716498851776123, 4.4390058517456055], "mean_td_error": 1.7061840295791626, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 75.0, "diff_num_grad_updates_vs_sampler_policy": 74.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.053462028503418, "actor_loss": -6.37338399887085, "critic_loss": 0.23632952570915222, "alpha_loss": -0.22321778535842896, "alpha_value": 0.9780415892601013, "log_alpha_value": -0.022203076630830765, "target_entropy": -6.0, "policy_t": -0.037131309509277344, "mean_q": 2.308378219604492, "max_q": 3.370030403137207, "min_q": 1.186409831047058}, "td_error": [0.21056079864501953, 1.2193914651870728, 1.0929816961288452, 0.053447067737579346, 1.75640070438385, 1.9146575927734375, 0.8618731498718262, 0.20239216089248657, 1.8708992004394531, 0.7818132638931274, 0.6645256280899048, 1.292733907699585, 3.172617197036743, 3.6592307090759277, 0.8164001703262329, 0.3183377981185913, 0.9205327033996582, 3.1306190490722656, 2.0711920261383057, 1.1731200218200684, 3.764878749847412, 1.141681432723999, 1.430416226387024, 1.2068560123443604, 2.000580310821533, 1.8476457595825195, 0.1803058385848999, 1.7795860767364502, 1.959911823272705, 0.7014458179473877, 4.737911701202393, 0.029262840747833252, 0.4501582384109497, 0.6332149505615234, 2.961214065551758, 1.1452064514160156, 3.2166056632995605, 0.5417027473449707, 0.05622124671936035, 0.8010684251785278, 2.3642609119415283, 2.8008310794830322, 2.197946071624756, 2.415897846221924, 2.2971701622009277, 0.40146976709365845, 1.1236133575439453, 0.32410669326782227, 4.393245697021484, 2.1912591457366943, 0.5611727237701416, 0.36539721488952637, 0.7568434476852417, 1.8346161842346191, 3.6990537643432617, 1.482980728149414, 0.7107712030410767, 0.4316275119781494, 4.864808082580566, 0.05915725231170654, 1.8338545560836792, 1.00490403175354, 1.511002779006958, 2.7473649978637695, 0.12086963653564453, 0.43232250213623047, 1.6227643489837646, 0.27998268604278564, 0.8276557326316833, 1.8204126358032227, 1.2935850620269775, 0.288341760635376, 0.2121269702911377, 1.4942947626113892, 1.6782516241073608, 0.6503254175186157, 0.07302570343017578, 1.6081979274749756, 1.1676626205444336, 1.480189561843872, 0.13788729906082153, 1.117940068244934, 2.866142749786377, 2.5440568923950195, 0.15485155582427979, 0.7556195259094238], "mean_td_error": 1.4275517463684082, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 75.0, "diff_num_grad_updates_vs_sampler_policy": 74.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.089801788330078, "actor_loss": -6.847079753875732, "critic_loss": 0.25779932737350464, "alpha_loss": -0.22414135932922363, "alpha_value": 0.978030264377594, "log_alpha_value": -0.02221464365720749, "target_entropy": -6.0, "policy_t": -0.07812779396772385, "mean_q": 2.788891077041626, "max_q": 3.806973457336426, "min_q": 1.557896375656128}, "td_error": [3.9286718368530273, 0.8873095512390137, 0.3407142162322998, 2.3918137550354004, 1.8189207315444946, 0.6403347253799438, 0.8669371604919434, 1.468947410583496, 3.413078784942627, 2.118870735168457, 2.428537368774414, 1.5748780965805054, 2.408412456512451, 0.3539332151412964, 0.9683914184570312, 0.03415060043334961, 0.11837112903594971, 0.558265209197998, 2.1220169067382812, 1.552407145500183, 0.8407039642333984, 0.4012531042098999, 0.8743672370910645, 0.4998704195022583, 2.002687931060791, 1.3662939071655273, 1.4074926376342773, 1.9048247337341309, 0.3535501956939697, 0.34383416175842285, 0.2932175397872925, 1.2488170862197876, 1.6841989755630493, 1.5728812217712402, 0.8637455701828003, 0.17420649528503418, 0.7566571235656738, 3.0934839248657227, 0.37538182735443115, 4.689980506896973, 2.32302188873291, 0.7534948587417603, 1.3205841779708862, 1.9694452285766602, 0.3156696557998657, 0.32083284854888916, 0.06710326671600342, 0.8639811277389526, 1.8458374738693237, 2.767423152923584, 2.106797218322754, 0.3993328809738159, 2.2136285305023193, 1.2199749946594238, 1.5552029609680176, 0.07011163234710693, 2.246227741241455, 1.9627526998519897, 1.8831498622894287, 0.04633533954620361, 0.39119088649749756, 0.5496670007705688, 0.6299123764038086, 0.15545547008514404, 0.12883484363555908, 2.8192126750946045, 0.9509803056716919, 2.5557312965393066, 0.5487184524536133, 2.1347908973693848, 0.4083094596862793, 1.1111358404159546, 1.1030391454696655, 0.4662511348724365, 1.9813493490219116, 0.12802863121032715, 0.11093389987945557, 3.122084379196167, 1.1527811288833618, 0.5817725658416748, 3.3720459938049316, 1.1314963102340698, 0.9718973636627197, 0.016684651374816895, 1.8400287628173828, 1.4957081079483032], "mean_td_error": 1.2889692783355713, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 75.0, "diff_num_grad_updates_vs_sampler_policy": 74.0}}, "num_env_steps_sampled": 68096, "num_env_steps_trained": 19350, "num_agent_steps_sampled": 204288, "num_agent_steps_trained": 19350, "last_target_update_ts": 68096, "num_target_updates": 75}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 204288, "num_agent_steps_trained": 19350, "num_env_steps_sampled": 68096, "num_env_steps_trained": 19350, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 929.2259494156016, "num_env_steps_trained_throughput_per_sec": 267.5672934701174, "timesteps_total": 68096, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 204288, "timers": {"training_iteration_time_ms": 973.316, "sample_time_ms": 698.864, "load_time_ms": 0.322, "load_throughput": 802231.768, "learn_time_ms": 18.323, "learn_throughput": 14080.853, "synch_weights_time_ms": 9.711}, "counters": {"num_env_steps_sampled": 68096, "num_env_steps_trained": 19350, "num_agent_steps_sampled": 204288, "num_agent_steps_trained": 19350, "last_target_update_ts": 68096, "num_target_updates": 75}, "done": false, "episodes_total": 0, "training_iteration": 40, "trial_id": "7c290_00000", "date": "2023-11-18_19-56-55", "timestamp": 1700366215, "time_this_iter_s": 1.9370019435882568, "time_total_s": 74.11925220489502, "pid": 1618, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x312ac13a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 74.11925220489502, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 69.16666666666667, "ram_util_percent": 65.23333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.057781219482422, "actor_loss": -7.06552267074585, "critic_loss": 0.27267590165138245, "alpha_loss": -0.22939591109752655, "alpha_value": 0.9774503111839294, "log_alpha_value": -0.022807806730270386, "target_entropy": -6.0, "policy_t": -0.06948617100715637, "mean_q": 3.0307137966156006, "max_q": 3.7932376861572266, "min_q": 1.4376051425933838}, "td_error": [1.9983186721801758, 1.0068702697753906, 2.241676092147827, 0.5753993988037109, 1.972195029258728, 1.0904438495635986, 0.718645453453064, 2.9089481830596924, 3.158186674118042, 0.7272927761077881, 2.7096779346466064, 0.22587478160858154, 2.614159107208252, 0.489888072013855, 1.5246599912643433, 0.8600403070449829, 1.1760456562042236, 0.8952463865280151, 0.8393228054046631, 3.8538317680358887, 0.917926549911499, 0.9173610210418701, 0.7807798385620117, 0.9948806762695312, 0.3303433656692505, 2.9299583435058594, 3.949052333831787, 2.648906707763672, 1.0561636686325073, 4.798923492431641, 1.715062141418457, 3.517421007156372, 0.6073908805847168, 1.6033134460449219, 0.6333762407302856, 0.6889611482620239, 1.9053261280059814, 1.8340307474136353, 1.8246108293533325, 0.9574404954910278, 3.739973545074463, 0.9155604839324951, 3.509331226348877, 1.367864966392517, 0.43349528312683105, 3.2576141357421875, 3.017071008682251, 1.075525164604187, 2.1626853942871094, 0.7382102012634277, 2.1725618839263916, 1.7526180744171143, 4.390882968902588, 0.9649319648742676, 1.5446662902832031, 2.594029188156128, 2.1530795097351074, 0.07490861415863037, 1.7287838459014893, 3.1587085723876953, 1.4725817441940308, 0.32555091381073, 1.063108205795288, 2.2864902019500732, 2.6297693252563477, 2.0558793544769287, 2.021785259246826, 2.606269359588623, 0.2209157943725586, 2.1796159744262695, 1.650876522064209, 0.39731788635253906, 0.6378799676895142, 3.5449018478393555, 2.5450711250305176, 2.3960752487182617, 3.454751491546631, 0.04546082019805908, 0.3020578622817993, 0.62153160572052, 0.8021688461303711, 0.5465549230575562, 0.1040642261505127, 1.7604010105133057, 0.29845309257507324, 0.1692948341369629], "mean_td_error": 1.66382896900177, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 77.0, "diff_num_grad_updates_vs_sampler_policy": 76.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.043848037719727, "actor_loss": -6.483485221862793, "critic_loss": 0.2538127899169922, "alpha_loss": -0.2290261685848236, "alpha_value": 0.9774553775787354, "log_alpha_value": -0.022802630439400673, "target_entropy": -6.0, "policy_t": -0.08616841584444046, "mean_q": 2.402615785598755, "max_q": 3.366689682006836, "min_q": 1.0563480854034424}, "td_error": [0.936109185218811, 0.4299342632293701, 0.20015311241149902, 0.498388409614563, 2.021867036819458, 1.9848099946975708, 3.141711711883545, 0.22327280044555664, 0.37132489681243896, 3.158871650695801, 3.9375052452087402, 3.2606101036071777, 1.481397271156311, 0.5081737041473389, 0.3757174611091614, 0.7811821699142456, 1.2817888259887695, 1.4104945659637451, 1.6364831924438477, 0.4380686283111572, 1.2963043451309204, 0.7921287417411804, 8.479935646057129, 1.1806930303573608, 0.7866314649581909, 3.1708755493164062, 0.8799763917922974, 3.370140314102173, 0.7174740433692932, 2.1795458793640137, 2.775172233581543, 0.06959545612335205, 0.15473246574401855, 0.3337695598602295, 0.4570930004119873, 0.2865426540374756, 2.539665937423706, 1.5420732498168945, 2.842161178588867, 1.1685521602630615, 1.498594045639038, 1.1220505237579346, 1.448446273803711, 0.7202994227409363, 3.0205087661743164, 1.2352511882781982, 0.12031573057174683, 0.5220702886581421, 3.3279972076416016, 1.9712443351745605, 1.2632567882537842, 3.3450818061828613, 1.5966647863388062, 1.572495698928833, 2.7346904277801514, 0.31471800804138184, 2.0409202575683594, 1.1739490032196045, 1.1392524242401123, 0.09239614009857178, 0.06375229358673096, 0.03431892395019531, 1.0188487768173218, 0.17965960502624512, 5.050307273864746, 0.7713451385498047, 2.937121868133545, 2.926726818084717, 2.7396650314331055, 1.3609429597854614, 0.10589492321014404, 1.3576703071594238, 2.427204132080078, 1.5821051597595215, 0.5982041358947754, 1.013823390007019, 0.358123779296875, 0.853298544883728, 1.336660385131836, 3.4868791103363037, 3.7855002880096436, 1.3712273836135864, 0.7691617608070374, 0.18563508987426758, 0.9319750070571899, 0.34395933151245117], "mean_td_error": 1.5226876735687256, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 77.0, "diff_num_grad_updates_vs_sampler_policy": 76.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.106023788452148, "actor_loss": -6.583274841308594, "critic_loss": 0.30005329847335815, "alpha_loss": -0.23056136071681976, "alpha_value": 0.977444052696228, "log_alpha_value": -0.022814253345131874, "target_entropy": -6.0, "policy_t": -0.01457867119461298, "mean_q": 2.558586597442627, "max_q": 3.6877214908599854, "min_q": 1.134160041809082}, "td_error": [0.03471827507019043, 0.46534013748168945, 2.22684907913208, 1.8815503120422363, 4.130958557128906, 2.7906455993652344, 0.8550195693969727, 2.777953624725342, 0.561122715473175, 1.7218455076217651, 0.33985084295272827, 0.8213437795639038, 3.154771327972412, 1.2393949031829834, 0.9881490468978882, 0.2102283239364624, 1.9841564893722534, 1.3721734285354614, 2.5168886184692383, 0.9936010837554932, 1.1380722522735596, 1.4506034851074219, 1.2640141248703003, 0.5070908069610596, 0.5582696199417114, 0.17682874202728271, 1.5153313875198364, 0.4250119924545288, 1.9963531494140625, 0.9585268497467041, 1.4160765409469604, 0.8592145442962646, 2.803335189819336, 1.9207789897918701, 5.13126277923584, 2.085625648498535, 2.109506607055664, 1.1813457012176514, 0.030977725982666016, 0.8887364864349365, 3.3339407444000244, 1.839167833328247, 0.4665365219116211, 1.4185936450958252, 0.3467954397201538, 1.9637271165847778, 1.665164589881897, 1.6385793685913086, 1.6382430791854858, 0.12150073051452637, 1.3003501892089844, 4.480367660522461, 2.5188121795654297, 0.6031556129455566, 2.0667238235473633, 3.7279343605041504, 0.7627929449081421, 0.7357926368713379, 2.8085615634918213, 1.559122920036316, 0.47162675857543945, 0.19816231727600098, 4.50178337097168, 2.8258633613586426, 2.079378128051758, 0.18275737762451172, 1.294820785522461, 0.9533783197402954, 1.6108059883117676, 0.15740573406219482, 0.9317854642868042, 1.805663824081421, 1.459913730621338, 0.03371322154998779, 0.47397327423095703, 1.0068776607513428, 0.543489933013916, 0.41831326484680176, 1.291006088256836, 1.636492133140564, 0.7764891386032104, 2.7108492851257324, 0.8963596820831299, 1.782569408416748, 0.042697012424468994, 2.1330738067626953], "mean_td_error": 1.4732400178909302, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 77.0, "diff_num_grad_updates_vs_sampler_policy": 76.0}}, "num_env_steps_sampled": 69888, "num_env_steps_trained": 19866, "num_agent_steps_sampled": 209664, "num_agent_steps_trained": 19866, "last_target_update_ts": 69888, "num_target_updates": 77}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 209664, "num_agent_steps_trained": 19866, "num_env_steps_sampled": 69888, "num_env_steps_trained": 19866, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 932.0435147506116, "num_env_steps_trained_throughput_per_sec": 268.3786013456002, "timesteps_total": 69888, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 209664, "timers": {"training_iteration_time_ms": 973.701, "sample_time_ms": 698.834, "load_time_ms": 0.325, "load_throughput": 794574.074, "learn_time_ms": 18.325, "learn_throughput": 14078.966, "synch_weights_time_ms": 9.454}, "counters": {"num_env_steps_sampled": 69888, "num_env_steps_trained": 19866, "num_agent_steps_sampled": 209664, "num_agent_steps_trained": 19866, "last_target_update_ts": 69888, "num_target_updates": 77}, "done": false, "episodes_total": 0, "training_iteration": 41, "trial_id": "7c290_00000", "date": "2023-11-18_19-56-57", "timestamp": 1700366217, "time_this_iter_s": 1.930253028869629, "time_total_s": 76.04950523376465, "pid": 1618, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x312ac1440>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 76.04950523376465, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 65.10000000000001, "ram_util_percent": 65.26666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.082303047180176, "actor_loss": -6.905908584594727, "critic_loss": 0.24894732236862183, "alpha_loss": -0.2359994351863861, "alpha_value": 0.9768645167350769, "log_alpha_value": -0.02340729534626007, "target_entropy": -6.0, "policy_t": -0.03851030766963959, "mean_q": 2.941509246826172, "max_q": 3.6582534313201904, "min_q": 1.3922693729400635}, "td_error": [3.980198860168457, 0.9498398303985596, 2.0990679264068604, 1.4018621444702148, 2.8222954273223877, 0.3416590690612793, 1.200964331626892, 3.9568376541137695, 1.0792291164398193, 0.8659849166870117, 0.07585668563842773, 0.30038130283355713, 1.1546039581298828, 0.5317829847335815, 0.2366124391555786, 1.6384481191635132, 2.6733336448669434, 1.493164300918579, 0.9181478023529053, 1.972604513168335, 1.9836230278015137, 1.9115384817123413, 1.661750078201294, 1.3727672100067139, 2.7580759525299072, 0.576667308807373, 2.297297239303589, 1.6849554777145386, 2.382411479949951, 4.489592552185059, 1.9709863662719727, 1.5473954677581787, 1.4897959232330322, 3.0119571685791016, 0.6240005493164062, 0.2700493335723877, 1.6633392572402954, 1.175825595855713, 1.6309168338775635, 1.6034166812896729, 2.17764949798584, 1.092145323753357, 0.8152531385421753, 1.1217565536499023, 0.26428544521331787, 2.4346938133239746, 2.050403356552124, 0.1941356658935547, 3.5966148376464844, 1.4853827953338623, 1.9053161144256592, 0.5076825618743896, 0.4230976104736328, 0.03401672840118408, 2.0804243087768555, 2.077563524246216, 0.047245144844055176, 0.9535080194473267, 0.9661275148391724, 2.7255539894104004, 2.0567679405212402, 0.9615253210067749, 1.2963826656341553, 0.6850113868713379, 1.218091368675232, 1.2675323486328125, 4.0808258056640625, 2.4825100898742676, 0.26641082763671875, 1.0351260900497437, 0.11890590190887451, 1.4705979824066162, 1.108010172843933, 1.6933194398880005, 1.002875804901123, 0.20478355884552002, 1.98539137840271, 0.6595772504806519, 2.539475440979004, 1.4058194160461426, 0.07851088047027588, 0.3130676746368408, 2.5486950874328613, 0.8308416604995728, 6.200748443603516, 0.20853900909423828], "mean_td_error": 1.517109751701355, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 79.0, "diff_num_grad_updates_vs_sampler_policy": 78.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.144522666931152, "actor_loss": -6.530115127563477, "critic_loss": 0.25174611806869507, "alpha_loss": -0.23740100860595703, "alpha_value": 0.9768698215484619, "log_alpha_value": -0.023401889950037003, "target_entropy": -6.0, "policy_t": 0.0025018772576004267, "mean_q": 2.4702985286712646, "max_q": 3.3589844703674316, "min_q": 1.2889056205749512}, "td_error": [1.6166625022888184, 0.5016953945159912, 0.798608660697937, 3.206676483154297, 0.16770410537719727, 1.0672481060028076, 5.779398441314697, 1.5720689296722412, 0.3668471574783325, 0.9436647891998291, 0.21104848384857178, 1.2075375318527222, 1.24800705909729, 5.848020553588867, 2.5185441970825195, 2.4092116355895996, 1.7659082412719727, 0.8478097319602966, 0.18855607509613037, 1.4277633428573608, 0.416556715965271, 2.8124876022338867, 1.249243974685669, 2.0310988426208496, 1.4831607341766357, 0.5137729048728943, 1.2117338180541992, 1.244434118270874, 2.0661869049072266, 1.5868945121765137, 0.29876482486724854, 2.2141366004943848, 2.3054566383361816, 1.639471411705017, 0.5425257682800293, 0.8017040491104126, 1.5732977390289307, 1.0936241149902344, 0.3978291153907776, 0.5596656799316406, 1.353408932685852, 0.4399435520172119, 1.6957252025604248, 2.7684006690979004, 0.5558578968048096, 0.877448558807373, 0.19253110885620117, 0.6369935274124146, 2.799151659011841, 3.906856060028076, 3.7428855895996094, 2.3150758743286133, 4.4769816398620605, 1.7530813217163086, 1.42616868019104, 1.1525723934173584, 0.6334987878799438, 0.25801944732666016, 0.5077145099639893, 0.7486156225204468, 1.0250320434570312, 1.2803093194961548, 0.708987832069397, 0.9146218299865723, 3.57189679145813, 2.4886417388916016, 1.3226935863494873, 3.0554451942443848, 0.25130414962768555, 3.2495312690734863, 0.54111647605896, 1.2876547574996948, 1.291453242301941, 0.11583036184310913, 3.685035228729248, 1.782184362411499, 1.1029328107833862, 2.9852280616760254, 1.6034204959869385, 0.31043803691864014, 0.6740021705627441, 2.9331612586975098, 0.7700556516647339, 1.5283123254776, 0.008034706115722656, 0.8240727186203003], "mean_td_error": 1.5265971422195435, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 79.0, "diff_num_grad_updates_vs_sampler_policy": 78.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.08184814453125, "actor_loss": -6.598541736602783, "critic_loss": 0.340631365776062, "alpha_loss": -0.23605677485466003, "alpha_value": 0.9768579602241516, "log_alpha_value": -0.02341403439640999, "target_entropy": -6.0, "policy_t": 0.003801326034590602, "mean_q": 2.593320846557617, "max_q": 3.575748920440674, "min_q": 1.2704672813415527}, "td_error": [2.2063045501708984, 2.3012077808380127, 3.9345626831054688, 0.43024611473083496, 1.348288893699646, 0.4350980520248413, 0.21456754207611084, 0.06599700450897217, 3.684145450592041, 0.8565905094146729, 0.8733887672424316, 1.8002065420150757, 1.1138612031936646, 4.127537250518799, 1.5128803253173828, 0.6074044108390808, 0.992806077003479, 2.049360752105713, 1.838132619857788, 2.57078218460083, 0.39259862899780273, 0.5039480924606323, 1.8757184743881226, 2.3464314937591553, 0.09690976142883301, 1.2017961740493774, 3.2360546588897705, 0.15244603157043457, 0.21504265069961548, 1.3361468315124512, 1.952096939086914, 0.11830079555511475, 3.3073668479919434, 0.25579285621643066, 0.3792346715927124, 6.4246745109558105, 1.7394834756851196, 1.7320353984832764, 0.5883802175521851, 1.626888394355774, 1.201690673828125, 0.7890912294387817, 0.03650844097137451, 0.5992132425308228, 1.7106691598892212, 1.085036277770996, 0.8708442449569702, 0.9091740846633911, 1.127873182296753, 0.09697914123535156, 3.1037869453430176, 1.397544264793396, 0.842055082321167, 2.0555419921875, 2.311244010925293, 1.1541111469268799, 4.326146125793457, 0.5491219758987427, 4.078843116760254, 2.2061643600463867, 2.5934948921203613, 1.4582014083862305, 0.9076825380325317, 2.478699207305908, 0.4496934413909912, 2.5835952758789062, 1.7671966552734375, 0.46905630826950073, 1.5030789375305176, 3.7584190368652344, 0.306276798248291, 1.340507984161377, 0.8485054969787598, 5.43906831741333, 0.6925337314605713, 0.6157764196395874, 2.5441317558288574, 1.7146872282028198, 0.5606381297111511, 0.8308811783790588, 4.00950813293457, 2.2364320755004883, 3.547797203063965, 0.8597763180732727, 2.109086036682129, 0.7655482292175293], "mean_td_error": 1.6196118593215942, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 79.0, "diff_num_grad_updates_vs_sampler_policy": 78.0}}, "num_env_steps_sampled": 71680, "num_env_steps_trained": 20382, "num_agent_steps_sampled": 215040, "num_agent_steps_trained": 20382, "last_target_update_ts": 71680, "num_target_updates": 79}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 215040, "num_agent_steps_trained": 20382, "num_env_steps_sampled": 71680, "num_env_steps_trained": 20382, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 926.0340943308355, "num_env_steps_trained_throughput_per_sec": 266.64821019794147, "timesteps_total": 71680, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 215040, "timers": {"training_iteration_time_ms": 946.458, "sample_time_ms": 669.764, "load_time_ms": 0.326, "load_throughput": 792305.193, "learn_time_ms": 18.298, "learn_throughput": 14100.007, "synch_weights_time_ms": 9.441}, "counters": {"num_env_steps_sampled": 71680, "num_env_steps_trained": 20382, "num_agent_steps_sampled": 215040, "num_agent_steps_trained": 20382, "last_target_update_ts": 71680, "num_target_updates": 79}, "done": false, "episodes_total": 0, "training_iteration": 42, "trial_id": "7c290_00000", "date": "2023-11-18_19-56-59", "timestamp": 1700366219, "time_this_iter_s": 1.9436399936676025, "time_total_s": 77.99314522743225, "pid": 1618, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x312ac3420>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 77.99314522743225, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 64.33333333333333, "ram_util_percent": 65.26666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.007037162780762, "actor_loss": -6.80905294418335, "critic_loss": 0.33523648977279663, "alpha_loss": -0.24023652076721191, "alpha_value": 0.9762791395187378, "log_alpha_value": -0.024006759747862816, "target_entropy": -6.0, "policy_t": -0.08887038379907608, "mean_q": 2.8073689937591553, "max_q": 3.460510730743408, "min_q": 1.5669159889221191}, "td_error": [2.3273024559020996, 1.2121577262878418, 0.07632648944854736, 2.3900954723358154, 1.084617257118225, 4.038329124450684, 3.6874585151672363, 0.4171946048736572, 1.1495945453643799, 1.1476632356643677, 1.6308954954147339, 2.7966957092285156, 0.4391911029815674, 0.23630988597869873, 1.2468217611312866, 1.6248432397842407, 0.8535333871841431, 1.6587638854980469, 1.88510262966156, 2.8556084632873535, 2.7105488777160645, 0.09616672992706299, 1.2455884218215942, 1.8529036045074463, 0.622174859046936, 4.380714416503906, 0.7744522094726562, 0.47332727909088135, 2.901505470275879, 1.1346403360366821, 2.698484182357788, 2.4172801971435547, 2.2557523250579834, 1.5140619277954102, 8.59546184539795, 3.366170644760132, 3.500767946243286, 1.3359323740005493, 3.5719058513641357, 1.447394847869873, 2.9239919185638428, 2.1808934211730957, 1.590295433998108, 0.2333439588546753, 4.661844253540039, 0.8292434215545654, 0.9875109195709229, 0.8621461391448975, 0.6633250713348389, 1.3743891716003418, 0.770557165145874, 2.62504506111145, 4.755582809448242, 1.550724983215332, 3.3521132469177246, 2.3963875770568848, 4.912498474121094, 1.4667351245880127, 0.1026449203491211, 0.49538207054138184, 0.9763611555099487, 1.8117526769638062, 2.582218647003174, 2.29171085357666, 0.536274790763855, 0.15635323524475098, 0.5206116437911987, 1.0625948905944824, 2.96639347076416, 0.6864676475524902, 3.6148548126220703, 2.366910219192505, 0.07013189792633057, 2.2634620666503906, 2.083364486694336, 2.363076686859131, 0.8441500663757324, 2.4600515365600586, 2.0925042629241943, 1.182713508605957, 1.738610863685608, 2.0696520805358887, 2.1327297687530518, 0.5712249279022217, 2.3329315185546875, 1.349887490272522], "mean_td_error": 1.878085970878601, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 81.0, "diff_num_grad_updates_vs_sampler_policy": 80.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.043708801269531, "actor_loss": -6.555424690246582, "critic_loss": 0.2478921115398407, "alpha_loss": -0.24106422066688538, "alpha_value": 0.9762842059135437, "log_alpha_value": -0.02400151640176773, "target_entropy": -6.0, "policy_t": -0.03908999264240265, "mean_q": 2.574957847595215, "max_q": 3.40520977973938, "min_q": 1.08253812789917}, "td_error": [1.260144829750061, 0.7897799015045166, 1.647125005722046, 0.9918501377105713, 3.093245506286621, 4.7008843421936035, 2.5976104736328125, 0.5941367149353027, 2.7946176528930664, 1.1570746898651123, 2.2420127391815186, 2.223672389984131, 0.28966224193573, 0.253088116645813, 0.47379302978515625, 1.0077680349349976, 0.0484309196472168, 0.8044828772544861, 1.2626607418060303, 1.701442003250122, 0.19746994972229004, 0.24645602703094482, 0.4800504446029663, 0.8041054010391235, 0.9601082801818848, 1.022074580192566, 0.3558463454246521, 0.5033929347991943, 1.0279620885849, 1.1559475660324097, 1.199925184249878, 2.653747320175171, 0.14221429824829102, 0.027723371982574463, 1.6655077934265137, 0.6593339443206787, 0.1071314811706543, 1.5603991746902466, 1.3435698747634888, 3.3651201725006104, 2.677342414855957, 3.2561967372894287, 1.3866783380508423, 1.7009196281433105, 6.103702068328857, 1.995271921157837, 0.27099061012268066, 1.8100050687789917, 3.3848648071289062, 1.9703315496444702, 1.7366045713424683, 0.7545404434204102, 1.621909499168396, 0.25791847705841064, 0.16393613815307617, 0.49546027183532715, 0.11420106887817383, 2.447845935821533, 0.8274966478347778, 3.624302387237549, 2.1812474727630615, 0.0325508713722229, 1.7034952640533447, 0.060048580169677734, 1.7711985111236572, 0.39168453216552734, 1.9829097986221313, 1.8987393379211426, 1.8877770900726318, 4.655776023864746, 2.5293941497802734, 1.611149787902832, 2.3406293392181396, 0.5339544415473938, 0.03736424446105957, 4.865372657775879, 0.982001781463623, 0.9653328657150269, 2.4587242603302, 0.46152424812316895, 0.16543471813201904, 1.9246411323547363, 1.4233165979385376, 0.9644068479537964, 1.079567551612854, 2.2323222160339355], "mean_td_error": 1.478519320487976, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 81.0, "diff_num_grad_updates_vs_sampler_policy": 80.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.015807151794434, "actor_loss": -6.458019256591797, "critic_loss": 0.2807307839393616, "alpha_loss": -0.24051719903945923, "alpha_value": 0.9762722849845886, "log_alpha_value": -0.024013763293623924, "target_entropy": -6.0, "policy_t": -0.024533390998840332, "mean_q": 2.5312273502349854, "max_q": 3.5115203857421875, "min_q": 1.3006973266601562}, "td_error": [0.40569114685058594, 0.268782377243042, 1.587525725364685, 1.0676915645599365, 2.0566978454589844, 2.838437080383301, 0.9341115951538086, 0.8967081308364868, 0.2266383171081543, 4.560366153717041, 0.5127906799316406, 2.418208599090576, 0.4304018020629883, 2.6462841033935547, 2.0900650024414062, 0.11680138111114502, 3.2466444969177246, 0.5802714824676514, 1.63016676902771, 1.0742042064666748, 2.0040667057037354, 1.1127407550811768, 0.6531115770339966, 1.3964617252349854, 5.392297744750977, 1.4404164552688599, 1.4168107509613037, 0.28119707107543945, 0.34839677810668945, 2.7170257568359375, 0.34475111961364746, 2.4796249866485596, 0.44889819622039795, 2.1804752349853516, 0.14715957641601562, 0.37635135650634766, 0.888916552066803, 0.4819166660308838, 2.8535590171813965, 0.10124564170837402, 1.982605218887329, 0.5375726222991943, 1.2264041900634766, 0.10328763723373413, 0.5463250875473022, 3.4185962677001953, 1.6508959531784058, 0.5594840049743652, 2.1685194969177246, 0.9952378273010254, 1.7716069221496582, 0.1905156373977661, 0.6845048666000366, 2.202465772628784, 0.4806060791015625, 1.4385850429534912, 3.5329842567443848, 0.6328307390213013, 0.5276526212692261, 2.001410722732544, 0.3214695453643799, 0.00659942626953125, 3.8560609817504883, 0.9389561414718628, 0.7054038047790527, 1.285518765449524, 3.2217278480529785, 3.7731175422668457, 2.1778388023376465, 0.10207974910736084, 2.020308494567871, 0.4583873748779297, 1.870577096939087, 5.568874359130859, 2.0480194091796875, 0.7012065052986145, 0.3398052453994751, 2.52370548248291, 0.15004956722259521, 3.3089661598205566, 1.064584732055664, 2.306258201599121, 1.0304723978042603, 0.23143291473388672, 3.4394121170043945, 4.631481170654297], "mean_td_error": 1.5277711153030396, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 81.0, "diff_num_grad_updates_vs_sampler_policy": 80.0}}, "num_env_steps_sampled": 73472, "num_env_steps_trained": 20898, "num_agent_steps_sampled": 220416, "num_agent_steps_trained": 20898, "last_target_update_ts": 73472, "num_target_updates": 81}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 220416, "num_agent_steps_trained": 20898, "num_env_steps_sampled": 73472, "num_env_steps_trained": 20898, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 960.310619554392, "num_env_steps_trained_throughput_per_sec": 276.5180132199031, "timesteps_total": 73472, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 220416, "timers": {"training_iteration_time_ms": 955.941, "sample_time_ms": 679.835, "load_time_ms": 0.326, "load_throughput": 791609.68, "learn_time_ms": 18.336, "learn_throughput": 14070.783, "synch_weights_time_ms": 9.433}, "counters": {"num_env_steps_sampled": 73472, "num_env_steps_trained": 20898, "num_agent_steps_sampled": 220416, "num_agent_steps_trained": 20898, "last_target_update_ts": 73472, "num_target_updates": 81}, "done": false, "episodes_total": 0, "training_iteration": 43, "trial_id": "7c290_00000", "date": "2023-11-18_19-57-01", "timestamp": 1700366221, "time_this_iter_s": 1.8753180503845215, "time_total_s": 79.86846327781677, "pid": 1618, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x312ac39c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 79.86846327781677, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 75.75, "ram_util_percent": 65.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.994564056396484, "actor_loss": -6.788156986236572, "critic_loss": 0.3635842204093933, "alpha_loss": -0.24592626094818115, "alpha_value": 0.9756942391395569, "log_alpha_value": -0.024606002494692802, "target_entropy": -6.0, "policy_t": -0.05567019805312157, "mean_q": 2.83740234375, "max_q": 3.3549413681030273, "min_q": 1.7650659084320068}, "td_error": [0.46017003059387207, 4.685443878173828, 2.2225401401519775, 0.9461243152618408, 3.1383748054504395, 1.512384057044983, 2.4797706604003906, 2.27907395362854, 1.343339204788208, 0.5153313875198364, 1.8906611204147339, 2.464292287826538, 1.798617959022522, 1.356290578842163, 1.1904948949813843, 3.1657373905181885, 3.545139789581299, 0.288720965385437, 2.080624580383301, 4.142487049102783, 1.7276949882507324, 2.8441591262817383, 2.4398794174194336, 0.9773983955383301, 5.412267208099365, 4.46162223815918, 1.4737539291381836, 2.5706210136413574, 1.5234018564224243, 1.767545461654663, 3.2122414112091064, 0.3718428611755371, 1.7275370359420776, 1.227592945098877, 2.0658907890319824, 2.452862024307251, 1.9317686557769775, 4.266048908233643, 0.22397267818450928, 2.1813650131225586, 3.960348606109619, 0.42076539993286133, 1.0136016607284546, 2.1742236614227295, 8.414112091064453, 0.7203295230865479, 1.5631763935089111, 0.9829026460647583, 1.329983115196228, 2.023820400238037, 4.54628849029541, 1.5011011362075806, 1.3015539646148682, 0.25694823265075684, 0.5434672832489014, 0.24429309368133545, 1.4662410020828247, 2.0841736793518066, 0.719497799873352, 1.547762393951416, 2.8202438354492188, 1.094955325126648, 0.22058260440826416, 3.631171703338623, 2.927703380584717, 2.0732717514038086, 0.8307883739471436, 1.978097915649414, 3.56040096282959, 1.8121250867843628, 0.5901950597763062, 0.8196820020675659, 2.8660192489624023, 2.3534929752349854, 0.8132762908935547, 4.736754417419434, 2.308361053466797, 0.7323440313339233, 0.21111667156219482, 1.3194249868392944, 0.7858498096466064, 1.7490439414978027, 4.905120372772217, 1.5334656238555908, 0.22588539123535156, 3.3685302734375], "mean_td_error": 2.016832113265991, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 83.0, "diff_num_grad_updates_vs_sampler_policy": 82.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.027501106262207, "actor_loss": -6.545687675476074, "critic_loss": 0.29322224855422974, "alpha_loss": -0.24668699502944946, "alpha_value": 0.9756990671157837, "log_alpha_value": -0.0246010459959507, "target_entropy": -6.0, "policy_t": -0.08997536450624466, "mean_q": 2.5721209049224854, "max_q": 3.4265542030334473, "min_q": 1.221961259841919}, "td_error": [1.5572106838226318, 1.6332926750183105, 2.465571403503418, 0.23346424102783203, 2.6015827655792236, 4.652331352233887, 0.1313648223876953, 0.7203184366226196, 1.6580653190612793, 1.7777700424194336, 0.0716862678527832, 1.1157207489013672, 0.6950904130935669, 4.980096340179443, 0.5043822526931763, 4.163116455078125, 0.45575666427612305, 2.3767919540405273, 1.9515807628631592, 1.0750833749771118, 1.376490831375122, 2.7690863609313965, 0.38362395763397217, 1.5249220132827759, 2.0584423542022705, 0.6196833848953247, 1.151759386062622, 2.6354904174804688, 5.675306797027588, 0.8907299041748047, 1.1791108846664429, 0.6938903331756592, 4.512382507324219, 0.8284858465194702, 0.44765806198120117, 1.2280980348587036, 3.1189393997192383, 2.4178385734558105, 6.796703338623047, 2.284215211868286, 1.0290950536727905, 1.4549384117126465, 0.4579312205314636, 5.738772392272949, 0.778350830078125, 6.188517093658447, 8.463841438293457, 3.26213002204895, 0.40302330255508423, 3.048459768295288, 0.8349535465240479, 1.849381923675537, 1.4591898918151855, 1.807121753692627, 0.9518049955368042, 0.5351510047912598, 1.3929094076156616, 0.6324933767318726, 1.7063993215560913, 0.800591230392456, 0.655732274055481, 2.634883403778076, 1.4708635807037354, 0.2406941056251526, 0.9745807647705078, 0.5609874725341797, 0.034302592277526855, 0.13363754749298096, 0.10352122783660889, 0.47254478931427, 2.7389397621154785, 0.7672768831253052, 1.4475018978118896, 0.5012710094451904, 0.7693145275115967, 3.1783640384674072, 0.11071527004241943, 1.9588912725448608, 0.2600715160369873, 1.4319305419921875, 1.4442505836486816, 0.693608283996582, 1.171366572380066, 0.2810330390930176, 1.6657824516296387, 0.41200578212738037], "mean_td_error": 1.7014214992523193, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 83.0, "diff_num_grad_updates_vs_sampler_policy": 82.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.058470726013184, "actor_loss": -6.4793219566345215, "critic_loss": 0.23531599342823029, "alpha_loss": -0.24756990373134613, "alpha_value": 0.9756873846054077, "log_alpha_value": -0.024613074958324432, "target_entropy": -6.0, "policy_t": -0.02197262831032276, "mean_q": 2.4994165897369385, "max_q": 3.4279534816741943, "min_q": 1.4462976455688477}, "td_error": [1.4595472812652588, 2.6658084392547607, 0.9786908626556396, 3.00480318069458, 0.2194685935974121, 2.405266523361206, 0.21250426769256592, 1.1984015703201294, 1.1889538764953613, 1.2233198881149292, 1.8022838830947876, 1.6334012746810913, 1.194756031036377, 0.6753184795379639, 0.6726365089416504, 1.5780006647109985, 0.8920484781265259, 1.179952621459961, 0.7010345458984375, 0.2219775915145874, 0.9878339767456055, 0.6682581901550293, 0.2887263298034668, 1.7163742780685425, 0.10628759860992432, 1.735388994216919, 1.1154571771621704, 3.4116506576538086, 0.7987191677093506, 0.367476224899292, 0.6774643659591675, 1.1671509742736816, 1.3919894695281982, 0.3245490789413452, 0.38498711585998535, 0.8274267911911011, 1.128882646560669, 0.9340507984161377, 2.06583309173584, 0.6402431726455688, 2.1372952461242676, 3.099949836730957, 0.7575602531433105, 2.1565895080566406, 1.0114182233810425, 0.9593806266784668, 1.1556594371795654, 2.4512481689453125, 0.062660813331604, 0.615281343460083, 1.1903735399246216, 0.8793670535087585, 2.6998066902160645, 1.2518410682678223, 2.6358304023742676, 2.3316760063171387, 0.9466161727905273, 0.3334519863128662, 0.05847036838531494, 0.7963817119598389, 1.9595738649368286, 3.020676374435425, 0.4496803283691406, 0.2003006935119629, 0.4282357692718506, 1.8805561065673828, 1.423473834991455, 1.9283640384674072, 0.15237641334533691, 1.2577604055404663, 1.9158532619476318, 7.318234443664551, 1.4400572776794434, 0.1007910966873169, 2.995720863342285, 2.062753200531006, 0.5885566473007202, 1.2671258449554443, 3.473613739013672, 0.041799068450927734, 2.2192792892456055, 1.4469126462936401, 1.0509148836135864, 2.095524787902832, 0.5151411294937134, 1.6367372274398804], "mean_td_error": 1.3517186641693115, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 83.0, "diff_num_grad_updates_vs_sampler_policy": 82.0}}, "num_env_steps_sampled": 75264, "num_env_steps_trained": 21414, "num_agent_steps_sampled": 225792, "num_agent_steps_trained": 21414, "last_target_update_ts": 75264, "num_target_updates": 83}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 225792, "num_agent_steps_trained": 21414, "num_env_steps_sampled": 75264, "num_env_steps_trained": 21414, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 924.0838106291502, "num_env_steps_trained_throughput_per_sec": 266.0866329713401, "timesteps_total": 75264, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 225792, "timers": {"training_iteration_time_ms": 959.138, "sample_time_ms": 682.297, "load_time_ms": 0.323, "load_throughput": 798974.034, "learn_time_ms": 18.334, "learn_throughput": 14071.917, "synch_weights_time_ms": 9.435}, "counters": {"num_env_steps_sampled": 75264, "num_env_steps_trained": 21414, "num_agent_steps_sampled": 225792, "num_agent_steps_trained": 21414, "last_target_update_ts": 75264, "num_target_updates": 83}, "done": false, "episodes_total": 0, "training_iteration": 44, "trial_id": "7c290_00000", "date": "2023-11-18_19-57-03", "timestamp": 1700366223, "time_this_iter_s": 1.9482979774475098, "time_total_s": 81.81676125526428, "pid": 1618, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x312ac3ce0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 81.81676125526428, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 68.46666666666667, "ram_util_percent": 65.33333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.099746704101562, "actor_loss": -6.755129814147949, "critic_loss": 0.30765169858932495, "alpha_loss": -0.2545642554759979, "alpha_value": 0.9751099944114685, "log_alpha_value": -0.025205012410879135, "target_entropy": -6.0, "policy_t": -0.05276701599359512, "mean_q": 2.703505516052246, "max_q": 3.1934268474578857, "min_q": 1.4103174209594727}, "td_error": [0.9947099685668945, 3.6589441299438477, 1.8162288665771484, 2.3463289737701416, 1.1713268756866455, 0.6708799600601196, 1.4455687999725342, 1.497084140777588, 0.31722569465637207, 6.0395188331604, 0.12568974494934082, 3.5277087688446045, 2.4380276203155518, 1.2393441200256348, 2.6742851734161377, 4.866800785064697, 0.4465928077697754, 1.1401680707931519, 2.294456958770752, 1.9367212057113647, 0.6474053859710693, 0.023300886154174805, 2.0075671672821045, 2.6440775394439697, 2.908411979675293, 3.1254286766052246, 0.48044025897979736, 3.610950469970703, 2.7772159576416016, 2.147592067718506, 2.1806387901306152, 0.2303168773651123, 2.4885880947113037, 1.1811014413833618, 0.16639137268066406, 1.390963077545166, 2.257540702819824, 1.86512291431427, 0.42427539825439453, 5.144927024841309, 1.8120126724243164, 5.626226902008057, 0.8355897665023804, 0.29360783100128174, 2.6250853538513184, 2.6527175903320312, 2.3477511405944824, 0.8231443166732788, 1.6018810272216797, 1.024134635925293, 2.2329766750335693, 2.3678178787231445, 1.5280256271362305, 0.12800443172454834, 2.2432773113250732, 0.5319309234619141, 1.506585717201233, 0.3216135501861572, 2.673104763031006, 1.878568410873413, 1.4425855875015259, 1.3731530904769897, 1.6126238107681274, 0.990830659866333, 1.3081300258636475, 1.4083296060562134, 0.4926936626434326, 1.1746050119400024, 1.1578253507614136, 0.22639620304107666, 2.1532974243164062, 1.0835689306259155, 1.4739234447479248, 1.0316627025604248, 3.291688919067383, 1.5815110206604004, 0.8944214582443237, 1.0591899156570435, 2.7853474617004395, 1.9336562156677246, 0.05112957954406738, 1.3193843364715576, 2.401712417602539, 4.779413223266602, 1.904409646987915, 0.5934759378433228], "mean_td_error": 1.7782429456710815, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 85.0, "diff_num_grad_updates_vs_sampler_policy": 84.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.089679718017578, "actor_loss": -6.534576416015625, "critic_loss": 0.2220267951488495, "alpha_loss": -0.2542644441127777, "alpha_value": 0.9751144051551819, "log_alpha_value": -0.02520044706761837, "target_entropy": -6.0, "policy_t": -0.039082497358322144, "mean_q": 2.5272672176361084, "max_q": 3.433539867401123, "min_q": 1.4266018867492676}, "td_error": [1.6807429790496826, 3.3183159828186035, 3.3524436950683594, 0.5728433132171631, 2.3033430576324463, 0.7965301275253296, 0.0955963134765625, 1.6197755336761475, 2.0130419731140137, 1.2838771343231201, 2.705991268157959, 2.9821321964263916, 1.302074670791626, 1.1380503177642822, 2.76204252243042, 2.7229957580566406, 0.8879830837249756, 0.9487504363059998, 0.17291855812072754, 0.8496153354644775, 2.054542303085327, 4.42677116394043, 0.25739121437072754, 3.6299445629119873, 0.4480224847793579, 0.387218713760376, 1.0012940168380737, 2.9482128620147705, 0.5645952224731445, 0.7826104164123535, 0.9607924222946167, 0.3350234031677246, 0.8294205665588379, 2.726306676864624, 0.9042233228683472, 1.599020004272461, 0.561133623123169, 0.5650632381439209, 1.8913381099700928, 0.18472492694854736, 0.04774785041809082, 1.2854094505310059, 1.691192626953125, 0.47349798679351807, 0.37544286251068115, 1.9973747730255127, 1.2903203964233398, 2.880805492401123, 0.7476109266281128, 1.8551805019378662, 0.5134066343307495, 1.3294360637664795, 0.39220988750457764, 0.4033762216567993, 1.861417293548584, 2.326666831970215, 1.4542596340179443, 0.41529059410095215, 1.0761306285858154, 1.601515293121338, 1.0400371551513672, 1.0845656394958496, 0.5371968746185303, 0.17929482460021973, 0.15872728824615479, 3.215735912322998, 1.335897445678711, 1.5796271562576294, 2.5060482025146484, 0.16263329982757568, 1.2488895654678345, 4.808308124542236, 0.9908192157745361, 0.09588491916656494, 1.2999943494796753, 0.9744030237197876, 3.787806987762451, 0.02774953842163086, 3.772677183151245, 0.9586119055747986, 0.3135819435119629, 1.8909192085266113, 1.2739256620407104, 0.4582258462905884, 0.41019296646118164, 0.4986445903778076], "mean_td_error": 1.3859931230545044, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 85.0, "diff_num_grad_updates_vs_sampler_policy": 84.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.05753231048584, "actor_loss": -6.4545416831970215, "critic_loss": 0.24482446908950806, "alpha_loss": -0.2535727322101593, "alpha_value": 0.975102961063385, "log_alpha_value": -0.02521222084760666, "target_entropy": -6.0, "policy_t": -0.038906849920749664, "mean_q": 2.475506544113159, "max_q": 3.3852243423461914, "min_q": 1.2070329189300537}, "td_error": [0.4880664348602295, 1.792658805847168, 0.5418863296508789, 2.1340579986572266, 1.4899420738220215, 1.3571445941925049, 1.905943512916565, 0.040804266929626465, 0.48028266429901123, 0.9546918869018555, 0.3283652663230896, 0.818212628364563, 0.0983198881149292, 0.7465153932571411, 0.352705717086792, 0.6705572605133057, 1.2807196378707886, 2.0318169593811035, 1.186807632446289, 2.3560266494750977, 0.28671538829803467, 1.7762908935546875, 0.11220550537109375, 0.1973971128463745, 0.8799711465835571, 5.204176425933838, 0.015749454498291016, 1.2347588539123535, 3.1039087772369385, 0.6729190349578857, 0.5081609487533569, 1.2181915044784546, 3.526745080947876, 0.40073108673095703, 0.4466261863708496, 1.2504466772079468, 2.8605234622955322, 1.3791368007659912, 1.5369932651519775, 0.8031620979309082, 1.0683696269989014, 0.8633946180343628, 0.2490253448486328, 0.10361242294311523, 0.5384782552719116, 1.7299340963363647, 0.48046159744262695, 1.8726117610931396, 1.252105474472046, 0.3770875930786133, 1.7518339157104492, 1.7083194255828857, 1.0260815620422363, 4.585832595825195, 0.11263406276702881, 1.2723901271820068, 0.20389008522033691, 0.5733437538146973, 2.018768310546875, 0.791635274887085, 3.0557732582092285, 3.442091941833496, 1.8912365436553955, 4.209658145904541, 1.0265871286392212, 2.0467746257781982, 0.2954123020172119, 0.2041589617729187, 1.6555111408233643, 1.719343662261963, 1.0359121561050415, 2.8635430335998535, 0.10135328769683838, 0.2710655927658081, 0.475313663482666, 3.5877859592437744, 1.7899621725082397, 0.0870370864868164, 1.9582267999649048, 0.7705340385437012, 1.324990153312683, 2.180591583251953, 0.7491677403450012, 2.4878244400024414, 1.0752034187316895, 5.95020055770874], "mean_td_error": 1.3640162944793701, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 85.0, "diff_num_grad_updates_vs_sampler_policy": 84.0}}, "num_env_steps_sampled": 77056, "num_env_steps_trained": 21930, "num_agent_steps_sampled": 231168, "num_agent_steps_trained": 21930, "last_target_update_ts": 77056, "num_target_updates": 85}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 231168, "num_agent_steps_trained": 21930, "num_env_steps_sampled": 77056, "num_env_steps_trained": 21930, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 945.7712699019285, "num_env_steps_trained_throughput_per_sec": 272.33145941372493, "timesteps_total": 77056, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 231168, "timers": {"training_iteration_time_ms": 955.762, "sample_time_ms": 676.405, "load_time_ms": 0.321, "load_throughput": 803422.995, "learn_time_ms": 18.402, "learn_throughput": 14020.394, "synch_weights_time_ms": 9.481}, "counters": {"num_env_steps_sampled": 77056, "num_env_steps_trained": 21930, "num_agent_steps_sampled": 231168, "num_agent_steps_trained": 21930, "last_target_update_ts": 77056, "num_target_updates": 85}, "done": false, "episodes_total": 0, "training_iteration": 45, "trial_id": "7c290_00000", "date": "2023-11-18_19-57-05", "timestamp": 1700366225, "time_this_iter_s": 1.903012990951538, "time_total_s": 83.71977424621582, "pid": 1618, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x312ac1bc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 83.71977424621582, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 66.60000000000001, "ram_util_percent": 65.4}}
