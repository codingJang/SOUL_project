{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 896, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2688, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2688, "num_agent_steps_trained": 0, "num_env_steps_sampled": 896, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 731.6872384012635, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 896, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2688, "timers": {"training_iteration_time_ms": 1224.545, "sample_time_ms": 617.313}, "counters": {"num_env_steps_sampled": 896, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2688, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 1, "trial_id": "cfa97_00000", "date": "2023-11-18_21-02-27", "timestamp": 1700370147, "time_this_iter_s": 1.2272989749908447, "time_total_s": 1.2272989749908447, "pid": 6770, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17f28ec00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 1.2272989749908447, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 0.0, "ram_util_percent": 64.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.94491195678711, "actor_loss": -3.956916332244873, "critic_loss": 4.124924659729004, "alpha_loss": -0.0029834737069904804, "alpha_value": 0.9997000694274902, "log_alpha_value": -0.0003000000142492354, "target_entropy": -6.0, "policy_t": -0.007462590932846069, "mean_q": 0.015435094013810158, "max_q": 0.11100646108388901, "min_q": 0.010207483544945717}, "td_error": [5.590012550354004, 3.580059051513672, 3.347740888595581, 3.4126224517822266, 4.966666221618652, 4.980406284332275, 4.51259708404541, 3.996145725250244, 4.6943039894104, 5.298247337341309, 5.9898176193237305, 5.869624137878418, 5.7373151779174805, 4.310634136199951, 3.2291455268859863, 3.240403175354004, 3.545703887939453, 5.765202522277832, 4.076306343078613, 4.292599678039551, 3.4668984413146973, 6.1632537841796875, 4.124554634094238, 5.6497602462768555, 4.2869110107421875, 5.577808380126953, 5.710298538208008, 4.070586204528809, 5.433236122131348, 4.595147132873535, 3.124616861343384, 5.687262058258057, 4.933392524719238, 5.797224044799805, 5.039805889129639, 3.9492907524108887, 2.977553367614746, 4.85183048248291, 4.281520366668701, 5.783771514892578, 4.356668949127197, 5.239166259765625, 6.251092910766602, 4.155434608459473, 5.152925491333008, 5.521893501281738, 5.470839023590088, 3.635895252227783, 6.020317077636719, 4.408811092376709, 4.4777398109436035, 5.09958553314209, 5.168807029724121, 2.0221896171569824, 5.331811904907227, 5.3210859298706055, 3.90279221534729, 5.900789737701416, 5.691889762878418, 5.221951484680176, 5.942907333374023, 2.9246745109558105, 4.704992294311523, 4.5516839027404785, 5.984633922576904, 5.2565178871154785, 6.152468204498291, 5.581823348999023, 2.906461238861084, 4.226004600524902, 3.662637233734131, 6.591856002807617, 3.7286624908447266, 5.566762924194336, 3.706882953643799, 7.594676971435547, 4.758190155029297, 1.720905065536499, 4.588408470153809, 6.153153419494629, 4.7506103515625, 3.959580898284912, 3.2187328338623047, 6.096814155578613, 5.162998676300049, 5.226102828979492], "mean_td_error": 4.755943298339844, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 2.0, "diff_num_grad_updates_vs_sampler_policy": 1.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.025179862976074, "actor_loss": -4.035348892211914, "critic_loss": 1.1503962278366089, "alpha_loss": -0.0030075537506490946, "alpha_value": 0.9997000694274902, "log_alpha_value": -0.00029999998514540493, "target_entropy": -6.0, "policy_t": -0.015145303681492805, "mean_q": 0.020074792206287384, "max_q": 0.17367702722549438, "min_q": 0.01294025406241417}, "td_error": [3.435089111328125, 2.904876947402954, 3.4014835357666016, 3.4509823322296143, 2.5636367797851562, 2.103598117828369, 2.690202236175537, 1.6059832572937012, 1.2543740272521973, 6.902655124664307, 1.6830708980560303, 2.9825010299682617, 2.198974132537842, 3.42478084564209, 2.0791447162628174, 1.4399385452270508, 3.1246399879455566, 3.6591098308563232, 1.7035772800445557, 2.4549074172973633, 1.9766473770141602, 1.786293864250183, 2.7724173069000244, 1.1657061576843262, 2.0524959564208984, 2.210353374481201, 2.33204984664917, 4.122298240661621, 2.273364543914795, 2.3424649238586426, 1.522835373878479, 2.87430477142334, 2.145462989807129, 3.554075241088867, 3.015817642211914, 2.509911298751831, 2.766338348388672, 0.6669461131095886, 3.5845465660095215, 2.6170945167541504, 3.9152278900146484, 1.30263090133667, 2.8565011024475098, 3.7454166412353516, 3.4043750762939453, 2.316664934158325, 2.6871562004089355, 2.216292381286621, 2.2625367641448975, 2.099635601043701, 2.4509987831115723, 1.6641255617141724, 0.5830179452896118, 0.7359308004379272, 2.8356308937072754, 5.521509647369385, 0.9529994130134583, 4.269969940185547, 1.633036494255066, 3.373300075531006, 4.303605556488037, 2.1281986236572266, 3.51945161819458, 2.8736484050750732, 0.9402000904083252, 4.292275428771973, 2.6971187591552734, 1.050661563873291, 3.7402358055114746, 3.3819799423217773, 3.9621076583862305, 2.373985528945923, 1.523247241973877, 3.646909236907959, 2.699122428894043, 2.9344213008880615, 1.0870949029922485, 2.4177093505859375, 2.7202835083007812, 2.2600808143615723, 3.613661050796509, 1.6710034608840942, 2.9139976501464844, 3.519674301147461, 2.454371452331543, 2.527761936187744], "mean_td_error": 2.6213340759277344, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 2.0, "diff_num_grad_updates_vs_sampler_policy": 1.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.044090270996094, "actor_loss": -4.049611568450928, "critic_loss": 0.5482189655303955, "alpha_loss": -0.0030132269021123648, "alpha_value": 0.9997000694274902, "log_alpha_value": -0.00029999998514540493, "target_entropy": -6.0, "policy_t": 0.01128453016281128, "mean_q": 0.008106839843094349, "max_q": 0.09476648271083832, "min_q": 0.005267047788947821}, "td_error": [1.3851059675216675, 3.7685811519622803, 2.6922340393066406, 1.9364659786224365, 2.7741808891296387, 1.6807899475097656, 3.546588182449341, 3.297311782836914, 2.3166160583496094, 0.9347200393676758, 1.991424560546875, 4.18943977355957, 2.0454139709472656, 3.002926826477051, 2.935177803039551, 4.153240203857422, 1.4648230075836182, 2.7081961631774902, 2.413937568664551, 4.473399639129639, 4.711215972900391, 3.390566110610962, 2.1696739196777344, 3.104095935821533, 1.4350669384002686, 1.6819028854370117, 3.0138912200927734, 3.393906593322754, 1.852924108505249, 3.1742095947265625, 1.4068963527679443, 3.828874111175537, 3.9718854427337646, 1.6289910078048706, 1.0326827764511108, 3.78530216217041, 3.600203037261963, 3.669961929321289, 0.3415706753730774, 3.509836196899414, 1.2221570014953613, 3.0846588611602783, 3.5425682067871094, 2.421243667602539, 3.756258964538574, 0.15238919854164124, 1.447303056716919, 2.8846230506896973, 2.5727078914642334, 0.5785864591598511, 4.017215728759766, 3.2783381938934326, 3.660637855529785, 0.6537723541259766, 3.980135679244995, 3.2602944374084473, 2.6149282455444336, 0.9569225907325745, 3.8941431045532227, 0.35638633370399475, 4.260072708129883, 3.6620852947235107, 2.64876651763916, 3.426539897918701, 3.7957727909088135, 2.4638900756835938, 0.5397891402244568, 3.187221050262451, 2.578584671020508, 2.4166922569274902, 1.0239365100860596, 2.9787588119506836, 2.4375240802764893, 2.7705931663513184, 3.660994529724121, 3.755878448486328, 0.6081876754760742, 2.525730609893799, 1.2950785160064697, 5.081967830657959, 2.7344460487365723, 2.275207757949829, 1.4489812850952148, 3.4355010986328125, 5.50886344909668, 2.3143868446350098], "mean_td_error": 2.6695926189422607, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 2.0, "diff_num_grad_updates_vs_sampler_policy": 1.0}}, "num_env_steps_sampled": 2688, "num_env_steps_trained": 516, "num_agent_steps_sampled": 8064, "num_agent_steps_trained": 516, "last_target_update_ts": 2688, "num_target_updates": 2}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8064, "num_agent_steps_trained": 516, "num_env_steps_sampled": 2688, "num_env_steps_trained": 516, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 954.4890526113674, "num_env_steps_trained_throughput_per_sec": 274.84171380996963, "timesteps_total": 2688, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 8064, "timers": {"training_iteration_time_ms": 1033.978, "sample_time_ms": 643.913, "load_time_ms": 0.316, "load_throughput": 815471.313, "learn_time_ms": 29.039, "learn_throughput": 8884.632, "synch_weights_time_ms": 9.458}, "counters": {"num_env_steps_sampled": 2688, "num_env_steps_trained": 516, "num_agent_steps_sampled": 8064, "num_agent_steps_trained": 516, "last_target_update_ts": 2688, "num_target_updates": 2}, "done": false, "episodes_total": 0, "training_iteration": 2, "trial_id": "cfa97_00000", "date": "2023-11-18_21-02-29", "timestamp": 1700370149, "time_this_iter_s": 1.8862669467926025, "time_total_s": 3.1135659217834473, "pid": 6770, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17f28dee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 3.1135659217834473, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 68.3, "ram_util_percent": 64.53333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.011320114135742, "actor_loss": -4.035586833953857, "critic_loss": 3.7909440994262695, "alpha_loss": -0.0060058580711483955, "alpha_value": 0.99940025806427, "log_alpha_value": -0.0005999066634103656, "target_entropy": -6.0, "policy_t": 0.013181550428271294, "mean_q": 0.02739723026752472, "max_q": 0.19588018953800201, "min_q": 0.021393055096268654}, "td_error": [6.415282726287842, 3.3531975746154785, 3.6416664123535156, 2.4455642700195312, 4.287004470825195, 4.555047035217285, 3.4717202186584473, 4.40496826171875, 3.53584623336792, 7.051470756530762, 4.41091251373291, 3.573071241378784, 2.804197311401367, 1.728665828704834, 3.5871176719665527, 4.45598030090332, 4.132987022399902, 3.5444135665893555, 4.383863925933838, 4.67624568939209, 4.292605400085449, 5.380867958068848, 5.401816368103027, 4.258288383483887, 3.4710302352905273, 6.2835893630981445, 3.307265281677246, 5.183625221252441, 7.552053928375244, 2.9460952281951904, 5.761758804321289, 4.710727214813232, 3.986548662185669, 3.5683512687683105, 4.409256458282471, 4.171677112579346, 3.053084373474121, 4.5573248863220215, 3.5593390464782715, 5.3916425704956055, 4.568631172180176, 2.6054186820983887, 5.2410149574279785, 2.8241117000579834, 4.197370529174805, 3.0168004035949707, 5.846977233886719, 5.5058393478393555, 5.587414741516113, 5.681723594665527, 5.738033294677734, 3.227461576461792, 5.559817314147949, 3.688262462615967, 3.819741725921631, 3.1846141815185547, 2.442037343978882, 4.009212493896484, 3.3657126426696777, 3.7250747680664062, 4.662919521331787, 5.4813079833984375, 5.376234531402588, 3.737936019897461, 3.3616819381713867, 4.550820350646973, 4.9925031661987305, 2.967480182647705, 6.218496322631836, 4.5974555015563965, 3.02321195602417, 5.385624885559082, 5.94746208190918, 4.847833633422852, 3.076228141784668, 4.74436092376709, 4.45941162109375, 4.131600379943848, 4.953849792480469, 1.6651442050933838, 5.397614479064941, 5.175363540649414, 4.190299987792969, 5.429146766662598, 7.026952743530273, 4.236442565917969], "mean_td_error": 4.362544059753418, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 3.0, "diff_num_grad_updates_vs_sampler_policy": 2.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.010218620300293, "actor_loss": -4.03288459777832, "critic_loss": 1.2807819843292236, "alpha_loss": -0.006006859242916107, "alpha_value": 0.9994000792503357, "log_alpha_value": -0.0006000727298669517, "target_entropy": -6.0, "policy_t": 0.026591496542096138, "mean_q": 0.028717972338199615, "max_q": 0.3306422531604767, "min_q": 0.022367659956216812}, "td_error": [2.6201400756835938, 3.224728584289551, 3.8929061889648438, 2.442366123199463, 3.766718864440918, 3.283926486968994, 2.1671345233917236, 2.1212263107299805, 2.112799882888794, 2.636275291442871, 4.225203514099121, 4.339866638183594, 2.548161029815674, 1.6780469417572021, 1.5965328216552734, 2.8038084506988525, 2.6997249126434326, 3.1274876594543457, 0.8672937750816345, 0.20642900466918945, 4.349133491516113, 2.5175375938415527, 3.2716994285583496, 4.011922836303711, 3.4134883880615234, 2.388049602508545, 4.7918500900268555, 2.7425105571746826, 0.5068501234054565, 3.801119804382324, 2.013716697692871, 4.2366437911987305, 3.83907413482666, 1.936133623123169, 1.6426570415496826, 4.130070686340332, 3.7219271659851074, 3.8895671367645264, 2.859346866607666, 3.507983684539795, 3.474599838256836, 2.182295799255371, 3.2360143661499023, 3.7357444763183594, 1.990642786026001, 3.2179112434387207, 2.767883777618408, 1.9491004943847656, 3.5163991451263428, 1.7011511325836182, 0.6338539123535156, 0.9114999771118164, 3.7559335231781006, 2.9977822303771973, 2.7394752502441406, 2.770927906036377, 3.3461029529571533, 2.9467763900756836, 2.4286980628967285, 1.3582923412322998, 3.8012304306030273, 0.9639414548873901, 3.1228597164154053, 2.2443532943725586, 2.8757596015930176, 4.375523567199707, 4.281654357910156, 2.0237669944763184, 3.2784883975982666, 2.6495208740234375, 3.725961208343506, 1.186985731124878, 3.9400925636291504, 0.020114978775382042, 3.442634105682373, 3.8531112670898438, 1.799285888671875, 3.022205352783203, 3.8722176551818848, 0.8183990120887756, 3.592862129211426, 3.2064218521118164, 2.9900400638580322, 3.55727481842041, 2.5133256912231445, 2.851651191711426], "mean_td_error": 2.8093349933624268, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 3.0, "diff_num_grad_updates_vs_sampler_policy": 2.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.048002243041992, "actor_loss": -4.063427448272705, "critic_loss": 0.543158769607544, "alpha_loss": -0.006028641946613789, "alpha_value": 0.9994001984596252, "log_alpha_value": -0.0005999840795993805, "target_entropy": -6.0, "policy_t": -0.039298802614212036, "mean_q": 0.02834206633269787, "max_q": 0.24359945952892303, "min_q": 0.01423923671245575}, "td_error": [4.011102199554443, 2.8224806785583496, 3.4849605560302734, 2.4547667503356934, 3.7237353324890137, 1.9873543977737427, 1.70849609375, 2.682504653930664, 1.9833407402038574, 2.8137755393981934, 3.051687002182007, 1.5385851860046387, 2.6168618202209473, 3.2302446365356445, 1.8430554866790771, 4.325733184814453, 3.3920979499816895, 2.2057886123657227, 2.335785388946533, 4.1006364822387695, 2.559457778930664, 2.940429210662842, 3.4061903953552246, 2.037256956100464, 0.18069884181022644, 1.9443928003311157, 2.0251874923706055, 2.4466283321380615, 2.0243568420410156, 2.350299835205078, 2.9966025352478027, 1.0234365463256836, 4.645961284637451, 3.18782377243042, 2.269102096557617, 1.3697352409362793, 1.1156158447265625, 3.0588974952697754, 1.5657498836517334, 1.4386358261108398, 1.6891050338745117, 1.6206657886505127, 2.177213668823242, 0.38599756360054016, 1.9510934352874756, 2.022091865539551, 1.7738908529281616, 3.6143250465393066, 3.5281944274902344, 3.1983823776245117, 3.64180588722229, 2.0709481239318848, 2.173480987548828, 2.949143648147583, 2.4731647968292236, 3.886242151260376, 3.4227852821350098, 3.751352310180664, 2.430724620819092, 3.54366397857666, 3.2239279747009277, 3.1880929470062256, 4.923500061035156, 3.696026563644409, 3.634737014770508, 1.1079736948013306, 5.325233459472656, 3.6635522842407227, 1.2501585483551025, 1.868337631225586, 5.790616035461426, 1.9052424430847168, 3.194753646850586, 1.3812992572784424, 1.5113413333892822, 2.5646462440490723, 1.5231201648712158, 2.2081027030944824, 1.8668479919433594, 2.25415301322937, 4.7479963302612305, 0.3646743595600128, 1.618666172027588, 2.45446515083313, 3.605441093444824, 3.2546324729919434], "mean_td_error": 2.620131015777588, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 3.0, "diff_num_grad_updates_vs_sampler_policy": 2.0}}, "num_env_steps_sampled": 3584, "num_env_steps_trained": 774, "num_agent_steps_sampled": 10752, "num_agent_steps_trained": 774, "last_target_update_ts": 3584, "num_target_updates": 3}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10752, "num_agent_steps_trained": 774, "num_env_steps_sampled": 3584, "num_env_steps_trained": 774, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 844.2443654087044, "num_env_steps_trained_throughput_per_sec": 243.09714986098857, "timesteps_total": 3584, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 10752, "timers": {"training_iteration_time_ms": 1040.803, "sample_time_ms": 647.519, "load_time_ms": 0.317, "load_throughput": 813224.273, "learn_time_ms": 25.546, "learn_throughput": 10099.588, "synch_weights_time_ms": 9.587}, "counters": {"num_env_steps_sampled": 3584, "num_env_steps_trained": 774, "num_agent_steps_sampled": 10752, "num_agent_steps_trained": 774, "last_target_update_ts": 3584, "num_target_updates": 3}, "done": false, "episodes_total": 0, "training_iteration": 3, "trial_id": "cfa97_00000", "date": "2023-11-18_21-02-30", "timestamp": 1700370150, "time_this_iter_s": 1.0724270343780518, "time_total_s": 4.185992956161499, "pid": 6770, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17f28f880>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 4.185992956161499, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 51.6, "ram_util_percent": 64.55}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.101606369018555, "actor_loss": -4.150753498077393, "critic_loss": 3.972729444503784, "alpha_loss": -0.012121140025556087, "alpha_value": 0.9988008141517639, "log_alpha_value": -0.0011999220587313175, "target_entropy": -6.0, "policy_t": 0.01423319336026907, "mean_q": 0.05703674256801605, "max_q": 0.4017737805843353, "min_q": 0.04513772577047348}, "td_error": [3.582879066467285, 5.149655342102051, 4.715753078460693, 3.613370895385742, 4.072509765625, 6.332839012145996, 6.268249988555908, 5.2021589279174805, 5.981977462768555, 6.109035968780518, 2.3261890411376953, 4.799777984619141, 2.7291948795318604, 4.961524486541748, 2.9185681343078613, 4.242730140686035, 5.578399658203125, 5.8360514640808105, 2.4615111351013184, 4.189867973327637, 5.411471366882324, 5.1608757972717285, 5.8867878913879395, 3.793200969696045, 3.7102293968200684, 5.380406379699707, 5.993403911590576, 6.718291282653809, 4.388688087463379, 5.481055736541748, 3.76405668258667, 4.49234676361084, 5.591775894165039, 4.214322090148926, 3.9937539100646973, 4.954521179199219, 5.3990020751953125, 2.9481678009033203, 3.809004306793213, 5.536118507385254, 3.171962022781372, 5.1815104484558105, 5.4805192947387695, 4.694903373718262, 4.5532121658325195, 6.8765435218811035, 3.648070812225342, 6.9372639656066895, 3.441009044647217, 4.880350589752197, 4.2589921951293945, 5.02726936340332, 5.2304606437683105, 3.1706767082214355, 5.405997276306152, 5.013439178466797, 4.243627548217773, 3.3268144130706787, 5.05465030670166, 4.3346405029296875, 4.340062618255615, 4.484218597412109, 3.9546144008636475, 4.304320335388184, 4.2768754959106445, 4.732395172119141, 7.039138317108154, 4.670450210571289, 3.3430848121643066, 4.924617290496826, 2.951326847076416, 6.1486053466796875, 5.953851699829102, 3.843984842300415, 6.773690223693848, 4.654590606689453, 4.072704792022705, 5.160665988922119, 3.874784469604492, 5.538476943969727, 5.919435024261475, 3.3746230602264404, 5.097794055938721, 3.8335466384887695, 5.3011064529418945, 2.832113027572632], "mean_td_error": 4.686427593231201, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 5.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.05368423461914, "actor_loss": -4.1003899574279785, "critic_loss": 0.771108865737915, "alpha_loss": -0.012067378498613834, "alpha_value": 0.9988003969192505, "log_alpha_value": -0.0012002942385151982, "target_entropy": -6.0, "policy_t": 0.00954988319426775, "mean_q": 0.06462855637073517, "max_q": 0.7058784365653992, "min_q": 0.042323630303144455}, "td_error": [2.1477954387664795, 2.7991280555725098, 3.4545111656188965, 2.2948548793792725, 3.4814229011535645, 1.5682039260864258, 1.549813151359558, 2.694148302078247, 2.7716102600097656, 2.0554442405700684, 1.1248576641082764, 1.1499934196472168, 0.696479320526123, 3.4591360092163086, 2.6107020378112793, 0.47637665271759033, 3.651576519012451, 1.2517120838165283, 3.2685601711273193, 2.7594871520996094, 3.0259814262390137, 0.5100799202919006, 2.7939863204956055, 1.1670022010803223, 2.384049415588379, 1.4845309257507324, 2.273699998855591, 3.642671823501587, 2.6417455673217773, 2.743016242980957, 2.5197696685791016, 3.2688441276550293, 2.542019844055176, 3.414984703063965, 2.0004525184631348, 3.2975025177001953, 1.4910187721252441, 1.019118309020996, 2.77854061126709, 2.4592039585113525, 2.546335220336914, 3.398454189300537, 3.2085819244384766, 2.6666531562805176, 2.3802008628845215, 4.467336654663086, 3.394413948059082, 2.150291919708252, 2.6638283729553223, 2.765502452850342, 1.2183921337127686, 3.5493335723876953, 2.251617431640625, 0.5972248911857605, 3.457937717437744, 2.017467975616455, 3.2694251537323, 1.0424511432647705, 1.8639681339263916, 4.853219985961914, 2.651505947113037, 2.877528667449951, 3.592465877532959, 1.8118188381195068, 3.8929524421691895, 3.5775880813598633, 3.2392468452453613, 2.303201913833618, 2.8408665657043457, 1.1137584447860718, 1.8740371465682983, 1.5851298570632935, 1.2998186349868774, 2.671006202697754, 2.1914596557617188, 2.3128466606140137, 2.2441811561584473, 5.681876182556152, 2.2512426376342773, 3.4958410263061523, 1.4625506401062012, 3.333925247192383, 1.0165386199951172, 4.506410598754883, 3.477963924407959, 1.6331427097320557], "mean_td_error": 2.504948616027832, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 5.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.094533920288086, "actor_loss": -4.128400802612305, "critic_loss": 0.5252714157104492, "alpha_loss": -0.012113073840737343, "alpha_value": 0.9988007545471191, "log_alpha_value": -0.0011999636190012097, "target_entropy": -6.0, "policy_t": 0.005523218773305416, "mean_q": 0.06357092410326004, "max_q": 0.49084895849227905, "min_q": 0.031550321727991104}, "td_error": [1.556989312171936, 2.409545421600342, 2.811746835708618, 2.0640554428100586, 2.289318084716797, 2.0895025730133057, 2.3490586280822754, 1.6352522373199463, 2.0898077487945557, 3.4294075965881348, 2.3239927291870117, 3.2195956707000732, 2.1690049171447754, 1.8543469905853271, 2.495331287384033, 1.8741934299468994, 1.0840872526168823, 2.071054458618164, 2.4761648178100586, 0.36823710799217224, 3.2194080352783203, 2.2062437534332275, 3.2519116401672363, 3.615344524383545, 1.8102014064788818, 3.249849319458008, 2.6804866790771484, 1.4590821266174316, 0.9937844276428223, 2.6068544387817383, 2.817033290863037, 4.757823467254639, 2.246913433074951, 2.538379669189453, 2.6335291862487793, 0.5474919080734253, 4.931091785430908, 2.2297067642211914, 2.679722309112549, 3.867027521133423, 0.34752461314201355, 2.338916778564453, 2.262378215789795, 2.6818530559539795, 1.5762970447540283, 3.2550182342529297, 1.7075703144073486, 3.214982509613037, 2.9289350509643555, 1.802502989768982, 2.2054762840270996, 2.9311349391937256, 3.265280246734619, 2.072751998901367, 3.2391631603240967, 2.493238687515259, 1.9355638027191162, 1.3706517219543457, 1.45941162109375, 2.698690891265869, 3.733757972717285, 1.8072149753570557, 0.7571438550949097, 3.20375919342041, 1.4651316404342651, 3.224663734436035, 0.7133696675300598, 3.6750082969665527, 4.066575050354004, 3.414608955383301, 3.5895087718963623, 3.262755870819092, 2.3420705795288086, 3.923426628112793, 4.73731803894043, 2.5823557376861572, 2.5321731567382812, 2.719728469848633, 2.183074712753296, 4.8766255378723145, 1.8948299884796143, 4.949887275695801, 4.32795524597168, 0.06586578488349915, 2.6878604888916016, 3.0687255859375], "mean_td_error": 2.5418059825897217, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 5.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 5376, "num_env_steps_trained": 1290, "num_agent_steps_sampled": 16128, "num_agent_steps_trained": 1290, "last_target_update_ts": 5376, "num_target_updates": 5}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16128, "num_agent_steps_trained": 1290, "num_env_steps_sampled": 5376, "num_env_steps_trained": 1290, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 965.987691041465, "num_env_steps_trained_throughput_per_sec": 278.15270567935045, "timesteps_total": 5376, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 16128, "timers": {"training_iteration_time_ms": 1003.044, "sample_time_ms": 649.481, "load_time_ms": 0.314, "load_throughput": 821289.035, "learn_time_ms": 22.528, "learn_throughput": 11452.473, "synch_weights_time_ms": 9.344}, "counters": {"num_env_steps_sampled": 5376, "num_env_steps_trained": 1290, "num_agent_steps_sampled": 16128, "num_agent_steps_trained": 1290, "last_target_update_ts": 5376, "num_target_updates": 5}, "done": false, "episodes_total": 0, "training_iteration": 4, "trial_id": "cfa97_00000", "date": "2023-11-18_21-02-32", "timestamp": 1700370152, "time_this_iter_s": 1.8647432327270508, "time_total_s": 6.05073618888855, "pid": 6770, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17f06bba0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 6.05073618888855, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 77.95, "ram_util_percent": 64.45}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.086472511291504, "actor_loss": -4.164565086364746, "critic_loss": 3.913792133331299, "alpha_loss": -0.018157657235860825, "alpha_value": 0.9982014298439026, "log_alpha_value": -0.0018001990392804146, "target_entropy": -6.0, "policy_t": 0.04931218549609184, "mean_q": 0.12510354816913605, "max_q": 0.7792955636978149, "min_q": 0.07252470403909683}, "td_error": [3.6384637355804443, 6.225089073181152, 3.535175323486328, 4.273071765899658, 6.234706878662109, 4.41522216796875, 2.7390334606170654, 5.144325256347656, 6.340768814086914, 4.382232666015625, 4.965061187744141, 2.8856544494628906, 4.927053451538086, 4.660333156585693, 6.384546279907227, 6.655697822570801, 3.5537543296813965, 6.2479095458984375, 3.876464366912842, 5.578110694885254, 3.4921412467956543, 4.35822057723999, 4.981755256652832, 4.000702857971191, 5.575366973876953, 5.859258651733398, 6.012627601623535, 5.712177276611328, 4.0949554443359375, 4.851057052612305, 4.398477554321289, 5.5338239669799805, 4.263152599334717, 5.169285297393799, 5.056178569793701, 5.490893363952637, 6.2714433670043945, 6.526015758514404, 4.2818498611450195, 6.11467170715332, 3.9090962409973145, 4.744840621948242, 3.779339075088501, 4.126500129699707, 3.913898468017578, 4.031441688537598, 5.651340484619141, 3.5670266151428223, 5.891238689422607, 4.415569305419922, 4.427422523498535, 3.1202330589294434, 4.562839984893799, 6.728720664978027, 4.283737659454346, 4.945849895477295, 2.958101272583008, 5.431681156158447, 1.8858181238174438, 4.178404808044434, 4.560466766357422, 4.726937294006348, 4.744664192199707, 2.9218263626098633, 3.588308334350586, 4.023728370666504, 3.9575581550598145, 3.909566879272461, 5.712480545043945, 2.9669392108917236, 4.013245582580566, 5.757743835449219, 3.925586700439453, 2.283813714981079, 5.580223083496094, 5.150864601135254, 4.24052095413208, 3.497814655303955, 4.998146057128906, 2.744802236557007, 4.526715278625488, 4.673752784729004, 4.6990156173706055, 4.838096618652344, 3.5543570518493652, 1.4229696989059448], "mean_td_error": 4.561395168304443, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 7.0, "diff_num_grad_updates_vs_sampler_policy": 6.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.106709480285645, "actor_loss": -4.178871154785156, "critic_loss": 0.7966971397399902, "alpha_loss": -0.018199319019913673, "alpha_value": 0.9982008934020996, "log_alpha_value": -0.0018007163889706135, "target_entropy": -6.0, "policy_t": 0.024213314056396484, "mean_q": 0.08234692364931107, "max_q": 0.988908052444458, "min_q": 0.06499442458152771}, "td_error": [2.05950665473938, 2.5333709716796875, 1.6884679794311523, 2.2888197898864746, 2.6194188594818115, 2.8302721977233887, 1.4646148681640625, 2.0501880645751953, 1.4248008728027344, 2.9085769653320312, 2.9657278060913086, 3.1911683082580566, 3.13859486579895, 2.459083318710327, 4.217011451721191, 2.2407619953155518, 2.093226909637451, 3.9322872161865234, 2.3282628059387207, 0.7883691787719727, 1.7857131958007812, 1.1605433225631714, 1.9271152019500732, 2.7582552433013916, 2.179194450378418, 1.2719690799713135, 2.457481861114502, 2.603644847869873, 1.5110950469970703, 3.167912006378174, 4.164854049682617, 1.7205650806427002, 3.61103892326355, 2.747035264968872, 1.2574844360351562, 1.3472545146942139, 5.0004682540893555, 3.0009682178497314, 2.642354726791382, 1.705836534500122, 4.871344089508057, 2.487365961074829, 4.7473649978637695, 3.4919581413269043, 1.764521598815918, 3.002298355102539, 3.2864599227905273, 3.640526533126831, 2.337374687194824, 3.2647058963775635, 2.956021308898926, 1.6797914505004883, 3.476128101348877, 3.264965772628784, 1.8931756019592285, 3.8706188201904297, 2.7291529178619385, 2.000277042388916, 0.7287898659706116, 2.8519976139068604, 3.341519832611084, 2.5829477310180664, 2.0685362815856934, 2.780627489089966, 4.352456092834473, 1.2542883157730103, 3.4905316829681396, 2.2630817890167236, 2.2208142280578613, 2.617068290710449, 3.6534876823425293, 0.8108349442481995, 3.1495962142944336, 2.728743076324463, 2.5754032135009766, 4.700559616088867, 3.2536540031433105, 0.925139307975769, 3.8033013343811035, 2.076977252960205, 1.848438024520874, 3.1417829990386963, 4.0708112716674805, 2.5117123126983643, 1.9323723316192627, 2.4116060733795166], "mean_td_error": 2.6297028064727783, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 7.0, "diff_num_grad_updates_vs_sampler_policy": 6.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.997316360473633, "actor_loss": -4.052098274230957, "critic_loss": 0.555991530418396, "alpha_loss": -0.01799675077199936, "alpha_value": 0.9982014894485474, "log_alpha_value": -0.0018001580610871315, "target_entropy": -6.0, "policy_t": -0.042048607021570206, "mean_q": 0.0871811956167221, "max_q": 0.6903952360153198, "min_q": 0.05026914179325104}, "td_error": [2.918426990509033, 3.344365119934082, 3.185891628265381, 4.076854228973389, 4.939753532409668, 2.632960796356201, 2.3908371925354004, 2.843062400817871, 3.378655433654785, 5.406287670135498, 1.5702183246612549, 2.4660820960998535, 3.501760244369507, 2.9299540519714355, 2.7906856536865234, 2.2385005950927734, 2.0342321395874023, 3.641993999481201, 2.8712892532348633, 1.0868852138519287, 1.952406406402588, 1.4066928625106812, 2.900839328765869, 4.505132675170898, 2.2612369060516357, 3.908769130706787, 2.6316442489624023, 2.376944065093994, 2.146925210952759, 3.024014711380005, 2.623128890991211, 3.3378899097442627, 4.231454372406006, 2.065131187438965, 1.3551414012908936, 0.6610467433929443, 1.1294279098510742, 2.7829418182373047, 0.7697269916534424, 2.447704792022705, 0.9496231079101562, 3.3843934535980225, 4.120115756988525, 2.7297110557556152, 2.9274158477783203, 1.7695213556289673, 2.560168743133545, 1.6973745822906494, 2.328930377960205, 2.7956273555755615, 2.9201111793518066, 3.001861333847046, 0.9351151585578918, 2.6203389167785645, 2.979794502258301, 2.5962347984313965, 3.408271074295044, 2.6856532096862793, 2.9633288383483887, 2.4685540199279785, 0.8158624172210693, 4.025045394897461, 2.7404489517211914, 3.2100987434387207, 3.448582172393799, 2.034695625305176, 3.0417375564575195, 2.0688819885253906, 3.1565985679626465, 3.172758102416992, 3.2414379119873047, 3.516928195953369, 3.2418875694274902, 1.9438636302947998, 3.8261570930480957, 3.3218066692352295, 2.8438844680786133, 1.0578680038452148, 1.3471095561981201, 2.4035143852233887, 3.319580078125, 2.055234432220459, 3.3045358657836914, 3.6487679481506348, 4.245498180389404, 2.2003402709960938], "mean_td_error": 2.71909499168396, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 7.0, "diff_num_grad_updates_vs_sampler_policy": 6.0}}, "num_env_steps_sampled": 7168, "num_env_steps_trained": 1806, "num_agent_steps_sampled": 21504, "num_agent_steps_trained": 1806, "last_target_update_ts": 7168, "num_target_updates": 7}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 21504, "num_agent_steps_trained": 1806, "num_env_steps_sampled": 7168, "num_env_steps_trained": 1806, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 971.5431212025834, "num_env_steps_trained_throughput_per_sec": 279.7523719534224, "timesteps_total": 7168, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 21504, "timers": {"training_iteration_time_ms": 982.838, "sample_time_ms": 650.205, "load_time_ms": 0.312, "load_throughput": 826504.422, "learn_time_ms": 21.255, "learn_throughput": 12138.467, "synch_weights_time_ms": 9.213}, "counters": {"num_env_steps_sampled": 7168, "num_env_steps_trained": 1806, "num_agent_steps_sampled": 21504, "num_agent_steps_trained": 1806, "last_target_update_ts": 7168, "num_target_updates": 7}, "done": false, "episodes_total": 0, "training_iteration": 5, "trial_id": "cfa97_00000", "date": "2023-11-18_21-02-34", "timestamp": 1700370154, "time_this_iter_s": 1.8536231517791748, "time_total_s": 7.904359340667725, "pid": 6770, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17f28dee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 7.904359340667725, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 67.1, "ram_util_percent": 64.46666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.139997482299805, "actor_loss": -4.250892639160156, "critic_loss": 3.7624354362487793, "alpha_loss": -0.02434113435447216, "alpha_value": 0.9976023435592651, "log_alpha_value": -0.0024005069863051176, "target_entropy": -6.0, "policy_t": -0.06154317781329155, "mean_q": 0.16532224416732788, "max_q": 1.022964358329773, "min_q": 0.1047343760728836}, "td_error": [5.758648872375488, 3.394744873046875, 3.3902716636657715, 4.459969997406006, 5.3988118171691895, 5.171658515930176, 3.9301934242248535, 4.813594818115234, 5.4933671951293945, 4.584699630737305, 3.7269272804260254, 5.785536289215088, 5.87833309173584, 3.4926910400390625, 4.906613349914551, 4.802637100219727, 3.4465372562408447, 2.755593776702881, 3.4222252368927, 4.818262100219727, 5.638154029846191, 3.2704477310180664, 2.965656280517578, 3.9593758583068848, 4.818639755249023, 4.287552833557129, 3.0729072093963623, 3.6209893226623535, 4.811039924621582, 5.608509063720703, 4.4736199378967285, 3.5103518962860107, 4.428126335144043, 4.448045253753662, 5.809689044952393, 3.312129020690918, 3.577437400817871, 5.2939324378967285, 3.368204116821289, 3.727299213409424, 3.6842293739318848, 3.6860406398773193, 2.9408538341522217, 5.880408763885498, 7.179280757904053, 5.283127784729004, 3.6803059577941895, 4.999913215637207, 6.572991371154785, 4.535311698913574, 3.166260242462158, 5.699889183044434, 3.5349044799804688, 3.5561156272888184, 6.470763683319092, 4.50677490234375, 1.1563012599945068, 5.64420747756958, 5.822755813598633, 6.420239448547363, 5.96656608581543, 4.8175201416015625, 4.000497817993164, 3.298147678375244, 5.4313645362854, 4.3432111740112305, 5.324406623840332, 4.662446975708008, 3.168156147003174, 4.337808609008789, 4.087392807006836, 5.067287445068359, 3.551333427429199, 4.3702592849731445, 3.409984588623047, 4.167976379394531, 3.7904932498931885, 5.897040843963623, 3.0602550506591797, 5.433117866516113, 4.78936243057251, 3.2523109912872314, 2.8173019886016846, 4.123283863067627, 5.506487846374512, 5.4383745193481445], "mean_td_error": 4.441471099853516, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 9.0, "diff_num_grad_updates_vs_sampler_policy": 8.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.125652313232422, "actor_loss": -4.226808547973633, "critic_loss": 0.8550547361373901, "alpha_loss": -0.02431599237024784, "alpha_value": 0.9976014494895935, "log_alpha_value": -0.0024014245718717575, "target_entropy": -6.0, "policy_t": -0.004701236262917519, "mean_q": 0.11629581451416016, "max_q": 1.3779628276824951, "min_q": 0.09148010611534119}, "td_error": [4.040112495422363, 2.779417037963867, 2.8390777111053467, 3.2802796363830566, 3.481292247772217, 3.1604790687561035, 1.0305675268173218, 2.928931951522827, 2.5736398696899414, 2.586193561553955, 5.036106109619141, 4.8313984870910645, 3.147897958755493, 3.378873586654663, 2.415813684463501, 4.130730628967285, 4.015608787536621, 4.247533321380615, 2.2140820026397705, 2.353701591491699, 3.227041006088257, 3.2449846267700195, 0.7223264575004578, 3.341616630554199, 2.716228485107422, 0.8406282663345337, 1.9076600074768066, 4.882017135620117, 2.1810801029205322, 2.1176209449768066, 2.7788753509521484, 3.027618885040283, 3.4410605430603027, 3.5399179458618164, 2.729429006576538, 0.6930171251296997, 2.963794231414795, 3.3676161766052246, 2.6877307891845703, 3.0158133506774902, 2.5928547382354736, 2.9875478744506836, 1.9101725816726685, 2.0951027870178223, 3.088700294494629, 2.540457248687744, 3.211444854736328, 2.2112064361572266, 3.5662288665771484, 4.805480003356934, 4.416521072387695, 2.488527536392212, 1.0770573616027832, 1.905764102935791, 1.9176414012908936, 0.2910293936729431, 4.35757303237915, 2.7080087661743164, 1.8680081367492676, 3.1968283653259277, 2.3480911254882812, 3.2466018199920654, 3.346860408782959, 4.273430824279785, 3.01906156539917, 1.3344690799713135, 3.147854804992676, 2.1577770709991455, 1.4055500030517578, 4.2293314933776855, 3.5758233070373535, 2.969414710998535, 2.9569971561431885, 3.0253567695617676, 2.7109689712524414, 3.18820858001709, 1.8483645915985107, 2.2407214641571045, 1.7987792491912842, 1.667947769165039, 1.2806768417358398, 3.8059427738189697, 1.7155873775482178, 1.2691092491149902, 3.006901741027832, 1.4644556045532227], "mean_td_error": 2.7693979740142822, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 9.0, "diff_num_grad_updates_vs_sampler_policy": 8.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.017744064331055, "actor_loss": -4.096309661865234, "critic_loss": 0.5899249315261841, "alpha_loss": -0.024044355377554893, "alpha_value": 0.9976027011871338, "log_alpha_value": -0.0024001765996217728, "target_entropy": -6.0, "policy_t": 0.05193239450454712, "mean_q": 0.11443700641393661, "max_q": 1.0612125396728516, "min_q": 0.07174885272979736}, "td_error": [2.660031318664551, 2.7269535064697266, 3.497466564178467, 3.15614652633667, 4.7014617919921875, 2.9203014373779297, 2.1519899368286133, 3.739903450012207, 3.120791435241699, 2.643871307373047, 2.3955860137939453, 2.609618663787842, 2.580686330795288, 1.7906804084777832, 3.2454476356506348, 3.3490796089172363, 3.6292290687561035, 3.9675259590148926, 1.784696102142334, 1.3571488857269287, 4.2338643074035645, 3.526181221008301, 4.676042556762695, 4.097273826599121, 2.9002890586853027, 3.5370781421661377, 2.64449143409729, 3.0916223526000977, 3.369731903076172, 1.8889812231063843, 3.146517038345337, 0.13588809967041016, 0.923626184463501, 4.665520668029785, 5.498652458190918, 3.2480621337890625, 4.010699272155762, 3.8085851669311523, 1.5655796527862549, 1.9418636560440063, 1.99638032913208, 3.0039424896240234, 3.9410905838012695, 1.911598801612854, 2.0209972858428955, 2.173631429672241, 3.001671075820923, 2.6415786743164062, 3.0514869689941406, 4.425592422485352, 2.706711530685425, 3.8011956214904785, 3.352139711380005, 1.5439634323120117, 3.241971969604492, 2.7593154907226562, 4.105367660522461, 1.4614884853363037, 3.566596508026123, 2.151801586151123, 2.6241984367370605, 2.1468191146850586, 2.2540855407714844, 1.9978607892990112, 3.399183750152588, 3.2366106510162354, 2.825064182281494, 1.4972622394561768, 2.8094840049743652, 2.492321729660034, 4.139739036560059, 2.4400644302368164, 2.0592098236083984, 2.464383602142334, 2.6972758769989014, 3.2388644218444824, 2.4015250205993652, 2.4279119968414307, 0.8424588441848755, 2.885349750518799, 3.0265369415283203, 2.5880565643310547, 3.2720680236816406, 2.3800673484802246, 3.466275691986084, 2.606862783432007], "mean_td_error": 2.8606653213500977, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 9.0, "diff_num_grad_updates_vs_sampler_policy": 8.0}}, "num_env_steps_sampled": 8960, "num_env_steps_trained": 2322, "num_agent_steps_sampled": 26880, "num_agent_steps_trained": 2322, "last_target_update_ts": 8960, "num_target_updates": 9}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 26880, "num_agent_steps_trained": 2322, "num_env_steps_sampled": 8960, "num_env_steps_trained": 2322, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 871.3732329958182, "num_env_steps_trained_throughput_per_sec": 250.90881039388515, "timesteps_total": 8960, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 26880, "timers": {"training_iteration_time_ms": 991.919, "sample_time_ms": 658.649, "load_time_ms": 0.313, "load_throughput": 825143.937, "learn_time_ms": 20.493, "learn_throughput": 12589.679, "synch_weights_time_ms": 9.317}, "counters": {"num_env_steps_sampled": 8960, "num_env_steps_trained": 2322, "num_agent_steps_sampled": 26880, "num_agent_steps_trained": 2322, "last_target_update_ts": 8960, "num_target_updates": 9}, "done": false, "episodes_total": 0, "training_iteration": 6, "trial_id": "cfa97_00000", "date": "2023-11-18_21-02-36", "timestamp": 1700370156, "time_this_iter_s": 2.0652730464935303, "time_total_s": 9.969632387161255, "pid": 6770, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17f28f4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 9.969632387161255, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 66.56666666666666, "ram_util_percent": 64.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.077972412109375, "actor_loss": -4.22938871383667, "critic_loss": 3.924581289291382, "alpha_loss": -0.030244100838899612, "alpha_value": 0.9970034956932068, "log_alpha_value": -0.0030010102782398462, "target_entropy": -6.0, "policy_t": 0.011794699355959892, "mean_q": 0.20214994251728058, "max_q": 1.2560925483703613, "min_q": 0.14243127405643463}, "td_error": [3.8020381927490234, 2.0289244651794434, 5.405470848083496, 3.414094924926758, 4.8700642585754395, 4.479853630065918, 5.811873435974121, 4.485735893249512, 5.61115837097168, 7.453499794006348, 6.103802680969238, 4.494575500488281, 4.820630073547363, 5.182929039001465, 5.703277587890625, 2.546809196472168, 3.9295644760131836, 4.694477081298828, 4.129062175750732, 4.551122665405273, 4.841819763183594, 3.1197938919067383, 2.9261980056762695, 6.170995712280273, 4.1433563232421875, 4.682958602905273, 4.797743320465088, 5.074308395385742, 3.8112752437591553, 4.468911170959473, 4.385758876800537, 4.569211959838867, 6.1681718826293945, 4.777859687805176, 5.4611968994140625, 2.9693150520324707, 4.054576396942139, 5.162318706512451, 3.6419193744659424, 4.127666473388672, 4.229068756103516, 3.7855658531188965, 4.081099033355713, 2.6879029273986816, 3.113100051879883, 5.25662899017334, 4.250443935394287, 4.877255439758301, 4.0012922286987305, 5.886502742767334, 5.899621963500977, 6.8198041915893555, 4.556394577026367, 4.559225082397461, 6.295648574829102, 2.9586167335510254, 3.0086777210235596, 4.131662368774414, 3.57185697555542, 3.8855714797973633, 4.876938343048096, 5.260634422302246, 3.255643844604492, 3.9610440731048584, 5.416811943054199, 4.495750904083252, 4.442033767700195, 5.285253524780273, 3.3827357292175293, 4.881068229675293, 5.315255165100098, 5.184795379638672, 3.364001512527466, 3.0570363998413086, 3.317746162414551, 6.7411394119262695, 6.7299418449401855, 6.619855880737305, 4.7425947189331055, 5.075188636779785, 4.361594200134277, 3.417391061782837, 4.053265571594238, 4.564910888671875, 6.396195888519287, 5.370825290679932], "mean_td_error": 4.584882736206055, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 11.0, "diff_num_grad_updates_vs_sampler_policy": 10.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.04912281036377, "actor_loss": -4.185832500457764, "critic_loss": 0.7503751516342163, "alpha_loss": -0.030170349404215813, "alpha_value": 0.9970022439956665, "log_alpha_value": -0.0030022868886590004, "target_entropy": -6.0, "policy_t": 0.006168657448142767, "mean_q": 0.1751834750175476, "max_q": 2.004990816116333, "min_q": 0.12267591804265976}, "td_error": [3.408923625946045, 3.748868703842163, 3.0172934532165527, 1.1468185186386108, 2.9595155715942383, 3.5984506607055664, 2.148362159729004, 2.849864959716797, 0.47518986463546753, 1.5434021949768066, 2.430126190185547, 0.8463284969329834, 5.418432235717773, 2.4988696575164795, 1.010176658630371, 2.446485996246338, 1.9699987173080444, 1.2487664222717285, 2.473565101623535, 0.2624785900115967, 2.132805109024048, 3.1416850090026855, 2.2693943977355957, 2.42213773727417, 1.3838613033294678, 0.7996419072151184, 2.5202808380126953, 2.1064774990081787, 3.9471240043640137, 3.7704217433929443, 1.9099469184875488, 4.889398574829102, 2.477268695831299, 2.984240770339966, 2.584975004196167, 2.5229997634887695, 3.096942663192749, 1.7318129539489746, 3.5213260650634766, 2.902632474899292, 2.695526599884033, 2.3303256034851074, 2.6096272468566895, 3.3849799633026123, 1.4117536544799805, 0.6587374806404114, 2.386946678161621, 1.5993309020996094, 0.0528167188167572, 3.1085729598999023, 0.9591168761253357, 3.2907660007476807, 3.6598076820373535, 2.2467241287231445, 2.506180763244629, 2.2563796043395996, 3.490511894226074, 3.2302346229553223, 0.8044750690460205, 1.358281135559082, 1.7066763639450073, 3.7062783241271973, 2.951242685317993, 3.496389150619507, 2.1272544860839844, 2.3502988815307617, 3.7680394649505615, 4.6570563316345215, 1.2211511135101318, 3.1634976863861084, 1.9752057790756226, 3.6970598697662354, 3.028930187225342, 3.9072883129119873, 4.807124137878418, 1.7561850547790527, 0.7101226449012756, 1.2139887809753418, 2.951169729232788, 0.5016738772392273, 1.9785994291305542, 3.2096941471099854, 5.844053745269775, 1.1939258575439453, 1.8418993949890137, 1.4616416692733765], "mean_td_error": 2.4637773036956787, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 11.0, "diff_num_grad_updates_vs_sampler_policy": 10.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.122307777404785, "actor_loss": -4.224308967590332, "critic_loss": 0.4976258873939514, "alpha_loss": -0.030367884784936905, "alpha_value": 0.9970043897628784, "log_alpha_value": -0.003000095020979643, "target_entropy": -6.0, "policy_t": -0.005318169016391039, "mean_q": 0.14167289435863495, "max_q": 1.2895934581756592, "min_q": 0.09695487469434738}, "td_error": [3.112342119216919, 4.88939094543457, 1.6870720386505127, 2.1098413467407227, 2.7176384925842285, 1.935117483139038, 2.3793106079101562, 2.033721923828125, 3.3771309852600098, 3.451803207397461, 0.6480731964111328, 3.867774486541748, 2.689242124557495, 2.4329490661621094, 2.2219271659851074, 3.8933451175689697, 3.561868906021118, 3.8649730682373047, 4.1623005867004395, 3.640684127807617, 1.3792022466659546, 2.064180612564087, 2.314115047454834, 2.3707127571105957, 2.744678020477295, 2.307270050048828, 1.7356138229370117, 0.4041483402252197, 2.6531612873077393, 1.4846702814102173, 2.5055482387542725, 1.8618910312652588, 4.002780437469482, 1.7397184371948242, 3.195093870162964, 2.9759225845336914, 3.719498634338379, 2.9809327125549316, 2.4915754795074463, 1.7994407415390015, 1.5957345962524414, 2.6368191242218018, 1.1973466873168945, 2.8443524837493896, 3.055111885070801, 3.874083995819092, 2.211700439453125, 2.51912260055542, 0.7360448241233826, 3.910928726196289, 2.9629759788513184, 0.7891795635223389, 1.973966121673584, 1.871862530708313, 2.981139659881592, 3.1223793029785156, 2.7613673210144043, 2.0489583015441895, 1.4173033237457275, 1.3555470705032349, 2.517456531524658, 2.403736114501953, 1.348466157913208, 0.8002937436103821, 0.9287914037704468, 2.045159339904785, 1.079596996307373, 2.7692041397094727, 1.52104651927948, 2.724108934402466, 2.3717434406280518, 2.718719482421875, 2.399000644683838, 3.531625986099243, 2.4817070960998535, 1.5499261617660522, 1.782370924949646, 1.9658701419830322, 2.0743255615234375, 4.401993751525879, 3.752042770385742, 2.208970069885254, 4.000383377075195, 4.921026229858398, 2.9552178382873535, 3.0399060249328613], "mean_td_error": 2.506572961807251, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 11.0, "diff_num_grad_updates_vs_sampler_policy": 10.0}}, "num_env_steps_sampled": 10752, "num_env_steps_trained": 2838, "num_agent_steps_sampled": 32256, "num_agent_steps_trained": 2838, "last_target_update_ts": 10752, "num_target_updates": 11}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32256, "num_agent_steps_trained": 2838, "num_env_steps_sampled": 10752, "num_env_steps_trained": 2838, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 956.2319787781994, "num_env_steps_trained_throughput_per_sec": 275.3435831749726, "timesteps_total": 10752, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 32256, "timers": {"training_iteration_time_ms": 966.071, "sample_time_ms": 667.644, "load_time_ms": 0.312, "load_throughput": 827253.598, "learn_time_ms": 18.115, "learn_throughput": 14242.344, "synch_weights_time_ms": 9.301}, "counters": {"num_env_steps_sampled": 10752, "num_env_steps_trained": 2838, "num_agent_steps_sampled": 32256, "num_agent_steps_trained": 2838, "last_target_update_ts": 10752, "num_target_updates": 11}, "done": false, "episodes_total": 0, "training_iteration": 7, "trial_id": "cfa97_00000", "date": "2023-11-18_21-02-38", "timestamp": 1700370158, "time_this_iter_s": 1.8825480937957764, "time_total_s": 11.852180480957031, "pid": 6770, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17f28fec0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 11.852180480957031, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 68.8, "ram_util_percent": 64.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.123126983642578, "actor_loss": -4.320007801055908, "critic_loss": 3.519043445587158, "alpha_loss": -0.036459051072597504, "alpha_value": 0.9964049458503723, "log_alpha_value": -0.0036015603691339493, "target_entropy": -6.0, "policy_t": 0.01177116297185421, "mean_q": 0.31886520981788635, "max_q": 1.9978612661361694, "min_q": 0.18647578358650208}, "td_error": [6.252862930297852, 2.980107307434082, 4.6075005531311035, 5.16342306137085, 3.403073787689209, 3.222414493560791, 2.0365264415740967, 4.947823524475098, 3.3830809593200684, 4.640175819396973, 4.197686195373535, 5.041828155517578, 3.315816879272461, 4.655429840087891, 4.040307998657227, 3.4297900199890137, 3.975759506225586, 4.978305339813232, 4.192139625549316, 2.9314820766448975, 3.7972168922424316, 4.202513694763184, 5.356688499450684, 4.783534526824951, 4.335964679718018, 4.455349445343018, 4.988008499145508, 4.624906063079834, 3.834435224533081, 4.227255821228027, 6.239311218261719, 4.4345598220825195, 5.730494976043701, 4.536168098449707, 5.063192844390869, 3.4455299377441406, 3.0371599197387695, 5.235540390014648, 5.44349479675293, 3.500131130218506, 3.1731414794921875, 4.276736259460449, 3.941598892211914, 2.7940433025360107, 4.681092739105225, 4.6593217849731445, 4.901898384094238, 5.879261016845703, 3.435148239135742, 2.3695149421691895, 3.390470266342163, 3.933502197265625, 3.7555460929870605, 1.8402156829833984, 5.265902996063232, 5.046543121337891, 5.944908142089844, 5.634703636169434, 1.0833930969238281, 3.0550718307495117, 2.9556169509887695, 3.32662296295166, 4.760197639465332, 3.9305002689361572, 4.570426940917969, 4.023889541625977, 5.678369522094727, 2.818107843399048, 4.598573684692383, 5.7191057205200195, 3.92191743850708, 4.970773696899414, 3.2897250652313232, 6.091090202331543, 1.9810433387756348, 4.479887008666992, 4.486019611358643, 4.711535930633545, 3.125173330307007, 4.921934127807617, 4.7881760597229, 4.765008449554443, 3.782926559448242, 6.0514235496521, 4.179555892944336, 5.2866597175598145], "mean_td_error": 4.243526458740234, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 13.0, "diff_num_grad_updates_vs_sampler_policy": 12.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.12191104888916, "actor_loss": -4.301229953765869, "critic_loss": 0.7428367733955383, "alpha_loss": -0.03646884113550186, "alpha_value": 0.9964035153388977, "log_alpha_value": -0.0036029606126248837, "target_entropy": -6.0, "policy_t": 0.010418696328997612, "mean_q": 0.3323008120059967, "max_q": 2.5643935203552246, "min_q": 0.15891973674297333}, "td_error": [3.3088271617889404, 0.25837716460227966, 3.062708854675293, 1.9414548873901367, 2.6722512245178223, 4.0750532150268555, 3.9099392890930176, 2.277310848236084, 3.6792778968811035, 1.4064642190933228, 1.9481172561645508, 1.1925238370895386, 3.0964741706848145, 3.3417654037475586, 1.6721992492675781, 0.6299154758453369, 1.2505772113800049, 0.5524604916572571, 3.309990882873535, 2.234135150909424, 2.6006994247436523, 2.128695011138916, 2.6062815189361572, 1.887913465499878, 2.339034080505371, 1.8329472541809082, 0.3596668839454651, 0.4841940999031067, 3.4876935482025146, 2.6881520748138428, 2.1154651641845703, 1.4896987676620483, 0.10965394973754883, 2.267055034637451, 0.08713239431381226, 4.415682792663574, 2.8010752201080322, 3.073338270187378, 3.534377336502075, 1.3454891443252563, 2.9018354415893555, 4.345441818237305, 2.5815072059631348, 1.2545592784881592, 2.8769900798797607, 1.3465782403945923, 1.1327944993972778, 2.5106048583984375, 1.9515135288238525, 3.210768938064575, 2.9107584953308105, 3.7307796478271484, 1.076256513595581, 3.153043270111084, 0.2382199764251709, 2.3738200664520264, 4.445699691772461, 2.5186352729797363, 2.2220165729522705, 3.5448551177978516, 1.7416155338287354, 4.1371917724609375, 2.4958138465881348, 4.192958354949951, 3.5041589736938477, 1.6545350551605225, 2.1850574016571045, 2.7650814056396484, 3.012622833251953, 1.4715683460235596, 3.0863771438598633, 2.622000217437744, 2.1968188285827637, 3.624746322631836, 4.108592987060547, 0.8319124579429626, 3.1804189682006836, 0.6929250955581665, 2.966627836227417, 4.5572309494018555, 3.1690216064453125, 0.2248622179031372, 3.7332534790039062, 4.272238731384277, 2.8984861373901367, 1.8214932680130005], "mean_td_error": 2.4296319484710693, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 13.0, "diff_num_grad_updates_vs_sampler_policy": 12.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.083471298217773, "actor_loss": -4.2170820236206055, "critic_loss": 0.4544873833656311, "alpha_loss": -0.0363038070499897, "alpha_value": 0.9964061379432678, "log_alpha_value": -0.003600328229367733, "target_entropy": -6.0, "policy_t": 0.0078047532588243484, "mean_q": 0.18548688292503357, "max_q": 1.4928374290466309, "min_q": 0.12638640403747559}, "td_error": [4.195267200469971, 3.570685386657715, 2.0060386657714844, 3.0439510345458984, 3.1141793727874756, 1.5807335376739502, 3.932741641998291, 2.360809326171875, 1.5492925643920898, 1.95856511592865, 2.9450645446777344, 3.240297794342041, 1.5956231355667114, 2.722120761871338, 2.5849509239196777, 3.550715684890747, 1.658779263496399, 0.8820852637290955, 2.387540578842163, 2.7347915172576904, 2.865513801574707, 1.1206258535385132, 1.153559684753418, 0.32174861431121826, 2.756580352783203, 4.532880783081055, 2.1932084560394287, 2.930696964263916, 0.4829525947570801, 1.9196057319641113, 2.9393482208251953, 2.9029159545898438, 0.1534796953201294, 1.1816022396087646, 3.0890870094299316, 1.628298044204712, 1.9393501281738281, 2.1547672748565674, 1.7717280387878418, 3.4628021717071533, 3.11438250541687, 3.3388171195983887, 3.123469829559326, 1.3850343227386475, 3.4490981101989746, 4.249899864196777, 1.7126604318618774, 1.4153891801834106, 1.873105525970459, 3.17486572265625, 0.028747014701366425, 2.5581960678100586, 1.8713823556900024, 2.01936936378479, 2.0414586067199707, 2.0021958351135254, 2.4632716178894043, 1.1235687732696533, 3.304062843322754, 1.6672616004943848, 0.5704779028892517, 2.5116090774536133, 1.4569090604782104, 3.165801525115967, 2.631610870361328, 1.921565055847168, 3.345122814178467, 2.3281147480010986, 3.1221609115600586, 2.574732780456543, 1.597388505935669, 2.998828887939453, 2.432865858078003, 2.541919708251953, 2.8042259216308594, 1.9141156673431396, 2.0456490516662598, 2.303014039993286, 0.9127326011657715, 3.201320171356201, 2.3630013465881348, 1.9470493793487549, 1.122277021408081, 0.47464555501937866, 2.201251983642578, 1.9875723123550415], "mean_td_error": 2.27333927154541, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 13.0, "diff_num_grad_updates_vs_sampler_policy": 12.0}}, "num_env_steps_sampled": 12544, "num_env_steps_trained": 3354, "num_agent_steps_sampled": 37632, "num_agent_steps_trained": 3354, "last_target_update_ts": 12544, "num_target_updates": 13}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37632, "num_agent_steps_trained": 3354, "num_env_steps_sampled": 12544, "num_env_steps_trained": 3354, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 952.5784694905154, "num_env_steps_trained_throughput_per_sec": 274.29156822383146, "timesteps_total": 12544, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 37632, "timers": {"training_iteration_time_ms": 951.113, "sample_time_ms": 665.53, "load_time_ms": 0.31, "load_throughput": 831001.714, "learn_time_ms": 17.949, "learn_throughput": 14374.053, "synch_weights_time_ms": 9.239}, "counters": {"num_env_steps_sampled": 12544, "num_env_steps_trained": 3354, "num_agent_steps_sampled": 37632, "num_agent_steps_trained": 3354, "last_target_update_ts": 12544, "num_target_updates": 13}, "done": false, "episodes_total": 0, "training_iteration": 8, "trial_id": "cfa97_00000", "date": "2023-11-18_21-02-40", "timestamp": 1700370160, "time_this_iter_s": 1.8901770114898682, "time_total_s": 13.7423574924469, "pid": 6770, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17f28dee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 13.7423574924469, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 70.63333333333333, "ram_util_percent": 64.13333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.107928276062012, "actor_loss": -4.353879451751709, "critic_loss": 3.6832337379455566, "alpha_loss": -0.04247628152370453, "alpha_value": 0.9958065152168274, "log_alpha_value": -0.004202273208647966, "target_entropy": -6.0, "policy_t": 0.002196165034547448, "mean_q": 0.3232184052467346, "max_q": 2.103604555130005, "min_q": 0.23771005868911743}, "td_error": [4.658566474914551, 5.1650800704956055, 2.6479063034057617, 5.56692361831665, 5.550701141357422, 2.6618123054504395, 1.7412304878234863, 4.1853790283203125, 6.434019088745117, 5.008416175842285, 2.0332634449005127, 5.421758651733398, 4.746209144592285, 4.34950065612793, 5.128868103027344, 4.789508819580078, 5.527792930603027, 3.501438617706299, 3.778679609298706, 3.8576629161834717, 3.703080654144287, 3.6644554138183594, 3.271193265914917, 2.3317437171936035, 4.309101104736328, 3.533557653427124, 2.29656982421875, 1.8235259056091309, 5.900689125061035, 6.5124406814575195, 2.2905945777893066, 4.098461627960205, 4.969134330749512, 3.8923158645629883, 5.4769134521484375, 4.940752029418945, 2.69059157371521, 4.347461700439453, 4.919548988342285, 5.389919757843018, 4.053686141967773, 5.408967018127441, 4.7217912673950195, 6.208918571472168, 3.8125176429748535, 6.6380767822265625, 4.925764560699463, 4.2379913330078125, 5.22474479675293, 4.6245269775390625, 4.307979583740234, 4.541323661804199, 6.4669036865234375, 5.230407238006592, 2.049968957901001, 2.6387534141540527, 2.9555611610412598, 7.67615270614624, 6.411088943481445, 1.7017128467559814, 3.4714016914367676, 4.871093273162842, 3.6378979682922363, 4.855013847351074, 4.997251033782959, 4.976462364196777, 6.175295829772949, 2.5098605155944824, 3.6995699405670166, 4.19187068939209, 3.3157880306243896, 4.25910758972168, 4.775547981262207, 4.907285690307617, 5.213491916656494, 4.043880462646484, 3.763608455657959, 4.918957710266113, 4.437530994415283, 4.479190826416016, 2.9967775344848633, 6.268415451049805, 4.363640308380127, 4.6386871337890625, 3.1514153480529785, 4.044308662414551], "mean_td_error": 4.347871780395508, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 15.0, "diff_num_grad_updates_vs_sampler_policy": 14.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.140042304992676, "actor_loss": -4.3610453605651855, "critic_loss": 0.7829432487487793, "alpha_loss": -0.04262668639421463, "alpha_value": 0.995805025100708, "log_alpha_value": -0.004203796852380037, "target_entropy": -6.0, "policy_t": 0.0029574669897556305, "mean_q": 0.38599175214767456, "max_q": 3.16086745262146, "min_q": 0.20008589327335358}, "td_error": [1.8302901983261108, 3.080143928527832, 3.069422483444214, 3.9277305603027344, 2.2233872413635254, 4.24640417098999, 3.8204164505004883, 1.2214829921722412, 0.5139460563659668, 2.195582866668701, 3.6805896759033203, 2.665530204772949, 4.388110160827637, 3.2380096912384033, 4.320914268493652, 2.4294705390930176, 0.5025038719177246, 0.800945520401001, 3.1496567726135254, 0.7920641899108887, 2.0931339263916016, 3.3934497833251953, 2.7342007160186768, 2.366711139678955, 2.6111440658569336, 3.359469413757324, 2.7662453651428223, 1.0605440139770508, 0.5702435970306396, 0.09021008014678955, 2.764889717102051, 1.907212495803833, 3.8966665267944336, 2.832998275756836, 3.1484835147857666, 1.2482020854949951, 2.3600049018859863, 2.4527268409729004, 1.8943021297454834, 3.861616373062134, 1.943291425704956, 1.4462984800338745, 2.9738247394561768, 3.355968952178955, 3.4606223106384277, 2.5355377197265625, 3.0956945419311523, 2.749908447265625, 3.2104434967041016, 4.424510955810547, 2.534543037414551, 1.583125114440918, 2.0517706871032715, 1.8744450807571411, 0.12400519847869873, 4.859687805175781, 3.562124729156494, 4.27884578704834, 1.6800510883331299, 2.3073935508728027, 2.238719940185547, 0.7621089220046997, 3.813861846923828, 3.8655009269714355, 2.0934338569641113, 4.467489719390869, 2.995511054992676, 0.5313315391540527, 3.950435161590576, 2.3319778442382812, 4.167288780212402, 1.8614861965179443, 3.468190908432007, 2.2264068126678467, 2.637211799621582, 0.46917763352394104, 3.2910118103027344, 1.2664920091629028, 1.3484089374542236, 3.835207462310791, 1.5332400798797607, 1.941833257675171, 2.225470542907715, 1.9025901556015015, 3.293177843093872, 2.616771697998047], "mean_td_error": 2.542970895767212, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 15.0, "diff_num_grad_updates_vs_sampler_policy": 14.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.099908828735352, "actor_loss": -4.269158363342285, "critic_loss": 0.5000674724578857, "alpha_loss": -0.042426805943250656, "alpha_value": 0.9958081245422363, "log_alpha_value": -0.0042007118463516235, "target_entropy": -6.0, "policy_t": -0.011141808703541756, "mean_q": 0.22017893195152283, "max_q": 1.859046220779419, "min_q": 0.16041553020477295}, "td_error": [3.629488468170166, 2.907196044921875, 3.0269551277160645, 2.6306586265563965, 2.3861541748046875, 3.6353416442871094, 0.5189117193222046, 2.678830623626709, 1.1142263412475586, 2.9156665802001953, 2.2782275676727295, 3.0504531860351562, 2.9840846061706543, 2.895475387573242, 2.6952567100524902, 2.7853505611419678, 3.0831847190856934, 1.3131167888641357, 1.1270253658294678, 3.5668344497680664, 1.6598379611968994, 3.5863823890686035, 3.485156536102295, 3.2681517601013184, 2.1229963302612305, 0.5942617654800415, 3.048654317855835, 2.168848752975464, 0.8863826394081116, 3.0125112533569336, 2.5914478302001953, 0.8770358562469482, 2.7597694396972656, 2.3249356746673584, 2.9804673194885254, 3.6419882774353027, 3.4666237831115723, 3.344348907470703, 3.2416563034057617, 3.799149990081787, 3.730330228805542, 1.915560007095337, 2.785510540008545, 4.73538875579834, 2.3744492530822754, 1.946136474609375, 2.6175646781921387, 2.2793898582458496, 1.9728542566299438, 1.5885716676712036, 2.453153610229492, 2.614140510559082, 2.4785261154174805, 0.5173822045326233, 4.9719061851501465, 1.8080675601959229, 2.9994375705718994, 2.078982353210449, 3.125925064086914, 3.159395694732666, 1.9634819030761719, 3.098483085632324, 0.2902604341506958, 2.532104730606079, 0.7873554825782776, 3.6860411167144775, 1.557058334350586, 2.2300169467926025, 1.642802357673645, 2.275272846221924, 1.2271029949188232, 1.6865253448486328, 2.6797406673431396, 2.7106528282165527, 2.7706642150878906, 3.7678160667419434, 1.2372084856033325, 1.033639907836914, 3.3839218616485596, 2.580967426300049, 4.226764678955078, 1.5549750328063965, 4.160919666290283, 2.903027057647705, 0.3047198951244354, 1.105907917022705], "mean_td_error": 2.4841063022613525, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 15.0, "diff_num_grad_updates_vs_sampler_policy": 14.0}}, "num_env_steps_sampled": 14336, "num_env_steps_trained": 3870, "num_agent_steps_sampled": 43008, "num_agent_steps_trained": 3870, "last_target_update_ts": 14336, "num_target_updates": 15}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 43008, "num_agent_steps_trained": 3870, "num_env_steps_sampled": 14336, "num_env_steps_trained": 3870, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 911.4842208495334, "num_env_steps_trained_throughput_per_sec": 262.4586260928344, "timesteps_total": 14336, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 43008, "timers": {"training_iteration_time_ms": 962.205, "sample_time_ms": 676.913, "load_time_ms": 0.311, "load_throughput": 829409.391, "learn_time_ms": 18.014, "learn_throughput": 14321.851, "synch_weights_time_ms": 9.432}, "counters": {"num_env_steps_sampled": 14336, "num_env_steps_trained": 3870, "num_agent_steps_sampled": 43008, "num_agent_steps_trained": 3870, "last_target_update_ts": 14336, "num_target_updates": 15}, "done": false, "episodes_total": 0, "training_iteration": 9, "trial_id": "cfa97_00000", "date": "2023-11-18_21-02-42", "timestamp": 1700370162, "time_this_iter_s": 1.9774038791656494, "time_total_s": 15.719761371612549, "pid": 6770, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17f308400>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 15.719761371612549, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 70.86666666666666, "ram_util_percent": 64.26666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.049799919128418, "actor_loss": -4.332563877105713, "critic_loss": 3.747617244720459, "alpha_loss": -0.045250628143548965, "alpha_value": 0.9955074787139893, "log_alpha_value": -0.004502639174461365, "target_entropy": -6.0, "policy_t": -0.012561165727674961, "mean_q": 0.5253264904022217, "max_q": 2.8573737144470215, "min_q": 0.26604658365249634}, "td_error": [4.41558313369751, 4.692474842071533, 3.918027400970459, 6.408010482788086, 3.0245919227600098, 4.884244918823242, 3.3759613037109375, 4.508681774139404, 3.64664363861084, 4.705789566040039, 5.164910316467285, 7.280691623687744, 2.2597434520721436, 3.5616707801818848, 3.3273487091064453, 4.960225582122803, 5.255437850952148, 4.771610260009766, 4.465813636779785, 1.7020357847213745, 3.309530735015869, 2.272568941116333, 4.827952861785889, 1.6529033184051514, 5.0235114097595215, 4.619545936584473, 4.954272747039795, 5.994338035583496, 3.6238627433776855, 3.772399425506592, 5.545584678649902, 4.762258529663086, 3.366969585418701, 2.834127902984619, 4.584471225738525, 3.5900092124938965, 4.900354385375977, 4.3572540283203125, 5.24760103225708, 4.337151050567627, 5.566246509552002, 6.047644138336182, 3.8450498580932617, 5.332566261291504, 6.285694122314453, 6.0330657958984375, 6.701772689819336, 4.024977207183838, 4.968283653259277, 4.9719624519348145, 5.244950294494629, 4.580991268157959, 6.2393999099731445, 4.118033409118652, 3.2570114135742188, 5.881167888641357, 2.3125762939453125, 4.410219192504883, 4.204489707946777, 4.12219762802124, 4.857564449310303, 4.4400315284729, 1.3323230743408203, 4.02675199508667, 4.276546478271484, 4.579000473022461, 0.9696137309074402, 4.489686965942383, 4.582822799682617, 5.172356605529785, 2.730458974838257, 4.790219306945801, 5.383889198303223, 5.341014862060547, 3.3787195682525635, 4.533234596252441, 7.006826400756836, 6.021230697631836, 3.841628313064575, 4.447744846343994, 6.424503326416016, 5.140678405761719, 3.974541187286377, 3.3462724685668945, 2.5735137462615967, 3.6926255226135254], "mean_td_error": 4.41172456741333, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 16.0, "diff_num_grad_updates_vs_sampler_policy": 15.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.171377182006836, "actor_loss": -4.419825553894043, "critic_loss": 0.7100051641464233, "alpha_loss": -0.04581497609615326, "alpha_value": 0.9955058097839355, "log_alpha_value": -0.004504303447902203, "target_entropy": -6.0, "policy_t": 0.008299380540847778, "mean_q": 0.28977257013320923, "max_q": 3.4573841094970703, "min_q": 0.22230856120586395}, "td_error": [2.4495179653167725, 2.9019763469696045, 2.599897861480713, 1.6660182476043701, 2.0925512313842773, 2.0367746353149414, 2.6841487884521484, 2.760075092315674, 1.8418726921081543, 4.272701263427734, 1.9425902366638184, 4.179645538330078, 2.5980029106140137, 2.2620227336883545, 0.4175705313682556, 2.8627824783325195, 2.8897879123687744, 3.885622978210449, 1.1405564546585083, 1.367417812347412, 2.109807014465332, 3.787350654602051, 1.4291163682937622, 2.9820468425750732, 3.2002670764923096, 2.182471752166748, 2.97926664352417, 1.7990882396697998, 1.5859801769256592, 1.9724280834197998, 2.8298521041870117, 1.0371876955032349, 3.75608229637146, 1.7307127714157104, 3.966015338897705, 1.9793212413787842, 3.6556005477905273, 2.3211095333099365, 1.2541470527648926, 1.9093470573425293, 2.665207862854004, 1.1458888053894043, 3.07126784324646, 2.8132786750793457, 1.6731191873550415, 2.859328269958496, 0.3242990970611572, 0.9942237138748169, 1.3353819847106934, 1.8577144145965576, 3.0912554264068604, 2.796478748321533, 3.300513744354248, 1.8242439031600952, 1.8611741065979004, 2.691882848739624, 2.754423141479492, 1.3267090320587158, 2.92768931388855, 2.7784135341644287, 0.1616310179233551, 2.4194440841674805, 1.8496167659759521, 2.9107446670532227, 0.8264556527137756, 4.105109691619873, 1.1449263095855713, 3.8610000610351562, 1.8164362907409668, 3.53701114654541, 1.5404167175292969, 2.1786580085754395, 2.433750629425049, 2.0207619667053223, 1.6974492073059082, 2.95599365234375, 2.0401558876037598, 3.1134071350097656, 3.2063822746276855, 2.2009050846099854, 1.4839444160461426, 0.8754714131355286, 3.166861057281494, 2.36875319480896, 1.4974594116210938, 4.101077556610107], "mean_td_error": 2.3363378047943115, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 16.0, "diff_num_grad_updates_vs_sampler_policy": 15.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.08232307434082, "actor_loss": -4.271780490875244, "critic_loss": 0.4770798683166504, "alpha_loss": -0.04538007453083992, "alpha_value": 0.995509147644043, "log_alpha_value": -0.004500954411923885, "target_entropy": -6.0, "policy_t": 0.01063590869307518, "mean_q": 0.279421329498291, "max_q": 2.493410110473633, "min_q": 0.17923206090927124}, "td_error": [3.591607093811035, 2.9480886459350586, 1.9731817245483398, 0.7162957191467285, 2.1115894317626953, 1.9148473739624023, 3.5408072471618652, 2.916503429412842, 2.2381603717803955, 1.6478581428527832, 1.1533253192901611, 2.0909571647644043, 3.5684189796447754, 1.8940956592559814, 2.81618070602417, 3.571575164794922, 4.553336143493652, 2.4852781295776367, 2.179145336151123, 2.085024833679199, 1.9509639739990234, 1.5863747596740723, 1.0036280155181885, 3.9489240646362305, 0.8482775688171387, 3.870121479034424, 3.048264980316162, 2.421403169631958, 3.9616966247558594, 2.094782829284668, 1.8551301956176758, 3.6238341331481934, 2.45634126663208, 2.8134522438049316, 3.808030605316162, 1.2790558338165283, 0.7134737372398376, 1.016819953918457, 2.502316951751709, 3.4178266525268555, 1.642938494682312, 2.215386152267456, 2.0566225051879883, 2.18638277053833, 1.6432616710662842, 2.5529117584228516, 1.0318310260772705, 1.9499237537384033, 1.4230353832244873, 0.5899707078933716, 2.2080116271972656, 2.9931464195251465, 1.3809839487075806, 3.6425905227661133, 3.453118324279785, 3.125830888748169, 2.9531044960021973, 0.22755956649780273, 2.1745705604553223, 0.9838591814041138, 1.1178520917892456, 1.6626806259155273, 2.8655056953430176, 3.119478702545166, 1.4008264541625977, 3.022211790084839, 4.539268493652344, 4.016899108886719, 2.3956527709960938, 3.101212978363037, 0.5300941467285156, 3.983017921447754, 1.5749775171279907, 2.8864870071411133, 3.6508073806762695, 2.2755565643310547, 1.8211629390716553, 3.9390854835510254, 4.364128112792969, 0.1604233980178833, 3.2103729248046875, 3.57899808883667, 1.8960294723510742, 1.9797571897506714, 2.164646625518799, 2.2834434509277344], "mean_td_error": 2.3975882530212402, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 16.0, "diff_num_grad_updates_vs_sampler_policy": 15.0}}, "num_env_steps_sampled": 15232, "num_env_steps_trained": 4128, "num_agent_steps_sampled": 45696, "num_agent_steps_trained": 4128, "last_target_update_ts": 15232, "num_target_updates": 16}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 45696, "num_agent_steps_trained": 4128, "num_env_steps_sampled": 15232, "num_env_steps_trained": 4128, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 718.11737765088, "num_env_steps_trained_throughput_per_sec": 206.77933418965074, "timesteps_total": 15232, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 45696, "timers": {"training_iteration_time_ms": 994.473, "sample_time_ms": 693.279, "load_time_ms": 0.311, "load_throughput": 828393.502, "learn_time_ms": 18.02, "learn_throughput": 14317.379, "synch_weights_time_ms": 9.454}, "counters": {"num_env_steps_sampled": 15232, "num_env_steps_trained": 4128, "num_agent_steps_sampled": 45696, "num_agent_steps_trained": 4128, "last_target_update_ts": 15232, "num_target_updates": 16}, "done": false, "episodes_total": 0, "training_iteration": 10, "trial_id": "cfa97_00000", "date": "2023-11-18_21-02-43", "timestamp": 1700370163, "time_this_iter_s": 1.2567720413208008, "time_total_s": 16.97653341293335, "pid": 6770, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17f308860>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 16.97653341293335, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 56.2, "ram_util_percent": 64.25}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.07929801940918, "actor_loss": -4.4234442710876465, "critic_loss": 3.6286373138427734, "alpha_loss": -0.05143693462014198, "alpha_value": 0.9949097633361816, "log_alpha_value": -0.005103225354105234, "target_entropy": -6.0, "policy_t": 0.049161121249198914, "mean_q": 0.4384080767631531, "max_q": 2.914242744445801, "min_q": 0.3287620544433594}, "td_error": [3.85953426361084, 3.7827162742614746, 3.851609468460083, 0.8649754524230957, 4.594114303588867, 5.0709004402160645, 4.254144668579102, 4.954946041107178, 5.143597602844238, 4.289966583251953, 2.8647923469543457, 3.5233945846557617, 5.266780853271484, 4.586742877960205, 1.9290680885314941, 5.620710372924805, 3.0045547485351562, 3.4055049419403076, 4.783153533935547, 4.3829193115234375, 3.8075807094573975, 5.286025524139404, 4.3105926513671875, 3.118532180786133, 6.4994659423828125, 4.6437883377075195, 2.9079253673553467, 2.8265509605407715, 4.593503952026367, 3.5448272228240967, 2.615867853164673, 5.808439254760742, 5.43472146987915, 5.247895240783691, 2.667786121368408, 4.970200538635254, 5.01194953918457, 5.439993381500244, 2.8595006465911865, 5.842293739318848, 4.363548755645752, 4.635515213012695, 2.016780376434326, 3.790299415588379, 4.606846809387207, 4.52482795715332, 3.3029353618621826, 4.897268295288086, 4.45078182220459, 1.9678010940551758, 4.840892791748047, 2.7808003425598145, 3.6228485107421875, 4.370761871337891, 4.3991193771362305, 4.342689037322998, 5.715802192687988, 3.3610692024230957, 4.852174282073975, 4.206066131591797, 2.950538158416748, 4.739038944244385, 4.036537170410156, 3.9781384468078613, 3.7410316467285156, 4.816651344299316, 4.043542861938477, 6.858050346374512, 4.412189483642578, 2.3617095947265625, 4.438299655914307, 5.2473859786987305, 3.5413448810577393, 4.739764213562012, 3.126660108566284, 5.035080909729004, 4.075156211853027, 4.728766441345215, 4.152704238891602, 7.493642807006836, 4.994189739227295, 4.365880012512207, 4.663990020751953, 6.335892677307129, 4.152660369873047, 2.982865810394287], "mean_td_error": 4.23874568939209, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 18.0, "diff_num_grad_updates_vs_sampler_policy": 17.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.139959335327148, "actor_loss": -4.43880033493042, "critic_loss": 0.7169724106788635, "alpha_loss": -0.051769230514764786, "alpha_value": 0.994907557964325, "log_alpha_value": -0.005105467513203621, "target_entropy": -6.0, "policy_t": -0.023482367396354675, "mean_q": 0.5010914206504822, "max_q": 4.064888954162598, "min_q": 0.27089518308639526}, "td_error": [2.267043352127075, 1.0815989971160889, 3.467167377471924, 4.344356536865234, 0.4184640645980835, 2.915276527404785, 3.1732425689697266, 1.4970262050628662, 2.271388530731201, 0.06505952775478363, 1.6470885276794434, 0.3061416745185852, 0.14076495170593262, 0.8526246547698975, 2.128650188446045, 2.924645185470581, 4.8175048828125, 1.8369951248168945, 1.3605436086654663, 2.0027709007263184, 3.766489028930664, 2.601445198059082, 3.3070201873779297, 2.253448963165283, 1.559470534324646, 2.8890023231506348, 1.4419119358062744, 2.9713518619537354, 2.3920793533325195, 2.405172824859619, 0.08892704546451569, 3.01132869720459, 2.1581201553344727, 2.960352897644043, 3.995262622833252, 0.9397144317626953, 2.8817873001098633, 2.9180185794830322, 0.3080604076385498, 3.6154935359954834, 2.751319169998169, 2.5063295364379883, 1.7992842197418213, 2.3276476860046387, 2.6844725608825684, 4.021841049194336, 3.678467273712158, 0.801911473274231, 1.268357515335083, 1.436326265335083, 1.6595065593719482, 2.8152081966400146, 2.4901981353759766, 0.6587380170822144, 2.3874459266662598, 2.352741003036499, 1.6757805347442627, 2.293602228164673, 2.0309884548187256, 1.6857469081878662, 1.6631728410720825, 2.1406679153442383, 2.262270450592041, 3.7202882766723633, 4.422525405883789, 4.880830764770508, 2.57745361328125, 2.4771971702575684, 3.800424814224243, 3.265023708343506, 3.1594130992889404, 1.895031452178955, 4.502519130706787, 2.622669219970703, 1.8748650550842285, 4.707617282867432, 4.828725814819336, 0.25539344549179077, 3.1536850929260254, 1.0367820262908936, 1.7397587299346924, 3.4040255546569824, 3.3763322830200195, 1.0994904041290283, 2.2749264240264893, 2.10866117477417], "mean_td_error": 2.378586769104004, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 18.0, "diff_num_grad_updates_vs_sampler_policy": 17.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.052181243896484, "actor_loss": -4.283577919006348, "critic_loss": 0.4300801753997803, "alpha_loss": -0.05127991735935211, "alpha_value": 0.9949116110801697, "log_alpha_value": -0.005101372022181749, "target_entropy": -6.0, "policy_t": 0.004253346007317305, "mean_q": 0.3956257104873657, "max_q": 2.9631972312927246, "min_q": 0.22054022550582886}, "td_error": [2.1331753730773926, 2.343385934829712, 3.8492109775543213, 1.4985764026641846, 0.041272394359111786, 1.9509227275848389, 1.843900203704834, 0.8659783601760864, 2.9860424995422363, 2.3922879695892334, 2.754568099975586, 2.3383612632751465, 3.6502809524536133, 0.09788566082715988, 4.277444839477539, 3.408026695251465, 1.1250945329666138, 3.7796878814697266, 2.826364040374756, 1.6041576862335205, 3.483903408050537, 2.1794326305389404, 2.236656665802002, 0.7949272394180298, 3.4650330543518066, 2.5834970474243164, 1.4492853879928589, 1.4908287525177002, 3.8033292293548584, 1.4548695087432861, 1.5034899711608887, 0.6799049377441406, 3.457338571548462, 2.791917562484741, 2.3342223167419434, 2.3584725856781006, 1.852913737297058, 2.230494976043701, 2.852609634399414, 2.318455219268799, 2.1226918697357178, 0.19873665273189545, 0.9623793959617615, 2.162290096282959, 1.96811842918396, 2.5257010459899902, 3.7117981910705566, 1.3628883361816406, 2.6316657066345215, 1.5833172798156738, 2.8143539428710938, 2.3921823501586914, 1.8216571807861328, 4.135415077209473, 1.6617181301116943, 1.7986644506454468, 2.817798614501953, 1.946568489074707, 4.434270858764648, 3.058806896209717, 2.788374900817871, 2.5848824977874756, 1.0535361766815186, 0.8015017509460449, 0.44027969241142273, 4.105965614318848, 1.7913339138031006, 2.2329792976379395, 1.6851136684417725, 1.055675745010376, 3.367778778076172, 0.5344225764274597, 4.114607810974121, 1.3734471797943115, 2.583691120147705, 3.856187343597412, 3.1090493202209473, 2.456916093826294, 0.4803868532180786, 2.589768648147583, 1.9692038297653198, 3.0580105781555176, 1.1269944906234741, 1.0261082649230957, 1.271174430847168, 2.5054516792297363], "mean_td_error": 2.2228147983551025, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 18.0, "diff_num_grad_updates_vs_sampler_policy": 17.0}}, "num_env_steps_sampled": 17024, "num_env_steps_trained": 4644, "num_agent_steps_sampled": 51072, "num_agent_steps_trained": 4644, "last_target_update_ts": 17024, "num_target_updates": 18}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51072, "num_agent_steps_trained": 4644, "num_env_steps_sampled": 17024, "num_env_steps_trained": 4644, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 977.7479291033854, "num_env_steps_trained_throughput_per_sec": 281.5390242284302, "timesteps_total": 17024, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 51072, "timers": {"training_iteration_time_ms": 990.75, "sample_time_ms": 686.545, "load_time_ms": 0.311, "load_throughput": 830874.103, "learn_time_ms": 18.016, "learn_throughput": 14320.638, "synch_weights_time_ms": 9.445}, "counters": {"num_env_steps_sampled": 17024, "num_env_steps_trained": 4644, "num_agent_steps_sampled": 51072, "num_agent_steps_trained": 4644, "last_target_update_ts": 17024, "num_target_updates": 18}, "done": false, "episodes_total": 0, "training_iteration": 11, "trial_id": "cfa97_00000", "date": "2023-11-18_21-02-45", "timestamp": 1700370165, "time_this_iter_s": 1.8419818878173828, "time_total_s": 18.818515300750732, "pid": 6770, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17f3093a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 18.818515300750732, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 69.15, "ram_util_percent": 64.35}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.12833023071289, "actor_loss": -4.551132678985596, "critic_loss": 3.135838031768799, "alpha_loss": -0.057769015431404114, "alpha_value": 0.9943125247955322, "log_alpha_value": -0.005703705828636885, "target_entropy": -6.0, "policy_t": 0.005626472644507885, "mean_q": 0.49315279722213745, "max_q": 3.926037311553955, "min_q": 0.399579256772995}, "td_error": [1.997093915939331, 3.998566150665283, 5.362452507019043, 4.344088077545166, 5.584469318389893, 4.806487083435059, 5.667542457580566, 3.7172811031341553, 4.325821876525879, 3.371551752090454, 3.7228872776031494, 6.79067325592041, 5.63847541809082, 5.461431503295898, 6.279049396514893, 4.26019287109375, 2.8884637355804443, 5.838123321533203, 4.188360214233398, 3.721867561340332, 3.0139193534851074, 4.256272315979004, 2.1143600940704346, 4.09512186050415, 3.3949151039123535, 3.827615976333618, 3.915665864944458, 3.8360164165496826, 3.812129497528076, 3.5553321838378906, 4.5805158615112305, 4.076712608337402, 2.7386605739593506, 4.433958053588867, 3.955961227416992, 4.433262825012207, 3.973114490509033, 4.7051615715026855, 5.184170246124268, 6.159276962280273, 0.998894453048706, 3.4528768062591553, 3.7362771034240723, 6.716111183166504, 3.791748046875, 7.582813262939453, 3.7817881107330322, 5.3158278465271, 4.173617839813232, 3.6679906845092773, 4.028929710388184, 5.349416732788086, 4.8618083000183105, 5.621224880218506, 5.866731643676758, 4.060100555419922, 3.4131247997283936, 4.435420036315918, 3.5138418674468994, 5.662504196166992, 4.022339820861816, 6.102552890777588, 3.387106418609619, 2.846191883087158, 2.9620914459228516, 4.757048606872559, 5.680588722229004, 3.2975997924804688, 4.900783538818359, 3.0368614196777344, 3.5297138690948486, 5.55486536026001, 4.197412014007568, 4.215644836425781, 4.34475040435791, 2.1899290084838867, 6.105208396911621, 2.280550003051758, 2.996035575866699, 4.989513397216797, 4.530716896057129, 4.792778015136719, 3.3920106887817383, 4.197181701660156, 4.144258499145508, 5.959296226501465], "mean_td_error": 4.307803153991699, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 20.0, "diff_num_grad_updates_vs_sampler_policy": 19.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.043354034423828, "actor_loss": -4.402143478393555, "critic_loss": 0.6266638040542603, "alpha_loss": -0.05731312185525894, "alpha_value": 0.994309663772583, "log_alpha_value": -0.005706571973860264, "target_entropy": -6.0, "policy_t": -0.006098434794694185, "mean_q": 0.5531341433525085, "max_q": 4.527194023132324, "min_q": 0.3237835168838501}, "td_error": [2.1513257026672363, 3.3201847076416016, 2.0921692848205566, 2.4390883445739746, 1.744552731513977, 0.7478048801422119, 2.054171085357666, 2.85341739654541, 1.591784119606018, 0.6473939418792725, 2.701568126678467, 2.338548421859741, 1.095928430557251, 3.3474807739257812, 3.6971664428710938, 1.7389272451400757, 2.4418201446533203, 3.054076910018921, 2.1648645401000977, 1.9272505044937134, 1.3196814060211182, 1.5481960773468018, 1.9881341457366943, 0.46718552708625793, 0.5061389207839966, 2.1478681564331055, 2.4888522624969482, 1.0924335718154907, 4.005542278289795, 1.8066550493240356, 3.6190624237060547, 1.5640015602111816, 2.3384947776794434, 1.9186620712280273, 2.187112808227539, 3.5858068466186523, 1.224939227104187, 0.6521193981170654, 1.2629077434539795, 3.6481566429138184, 1.2875361442565918, 1.9752557277679443, 2.187417507171631, 1.8325486183166504, 3.01084566116333, 0.7417721748352051, 2.614698648452759, 4.053173542022705, 2.4135799407958984, 0.22230172157287598, 3.5367729663848877, 1.7145018577575684, 1.7194933891296387, 1.0353105068206787, 3.095019578933716, 1.6555452346801758, 3.1005897521972656, 2.5679144859313965, 1.3040616512298584, 2.5501582622528076, 2.2109732627868652, 2.2011818885803223, 0.9284039735794067, 2.0498814582824707, 1.4231839179992676, 5.277657508850098, 2.9676380157470703, 1.653011679649353, 2.023099422454834, 0.44762298464775085, 2.144099712371826, 1.9379881620407104, 1.842204213142395, 3.106635808944702, 1.82259202003479, 2.4312946796417236, 2.218451976776123, 3.350955009460449, 2.5499815940856934, 1.6022210121154785, 0.501109778881073, 1.4639484882354736, 3.3016481399536133, 3.858126163482666, 1.564853549003601, 2.2427968978881836], "mean_td_error": 2.130948066711426, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 20.0, "diff_num_grad_updates_vs_sampler_policy": 19.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.043386459350586, "actor_loss": -4.329222202301025, "critic_loss": 0.4532366096973419, "alpha_loss": -0.057263292372226715, "alpha_value": 0.9943146109580994, "log_alpha_value": -0.005701592657715082, "target_entropy": -6.0, "policy_t": 0.03810936585068703, "mean_q": 0.4051000475883484, "max_q": 3.222442388534546, "min_q": 0.2682446837425232}, "td_error": [1.8771097660064697, 0.06696653366088867, 2.3299052715301514, 2.9556570053100586, 0.38507765531539917, 2.411045789718628, 0.8450883626937866, 3.9519548416137695, 2.48620343208313, 1.9559568166732788, 1.892404556274414, 2.1773810386657715, 1.9759674072265625, 2.7581443786621094, 4.800795078277588, 3.7897086143493652, 1.8834422826766968, 4.207725524902344, 2.5233588218688965, 1.7276928424835205, 0.9305077195167542, 3.089648962020874, 3.361556053161621, 1.6278578042984009, 2.6917977333068848, 2.2857859134674072, 3.507744312286377, 2.2707266807556152, 2.318970203399658, 1.9186737537384033, 2.907672882080078, 2.2921385765075684, 0.4715557098388672, 3.541266441345215, 3.199709892272949, 1.9205949306488037, 0.10608972609043121, 2.191760778427124, 2.557305097579956, 1.8810346126556396, 2.2324156761169434, 4.0076775550842285, 3.994631290435791, 0.20866453647613525, 0.827925443649292, 1.8390512466430664, 2.1941652297973633, 2.4995217323303223, 2.6873841285705566, 2.016660213470459, 1.7134960889816284, 2.8941166400909424, 2.4997401237487793, 2.8170204162597656, 2.81463623046875, 1.921170711517334, 0.4048667252063751, 3.0865392684936523, 2.203695058822632, 2.3222923278808594, 2.2588748931884766, 2.544616222381592, 3.570946216583252, 2.500260353088379, 2.525505542755127, 3.072702646255493, 1.197817325592041, 3.3699002265930176, 2.062446355819702, 2.505002498626709, 2.511481761932373, 2.686713933944702, 2.611469030380249, 2.5183534622192383, 1.641961932182312, 0.6654000878334045, 3.0172200202941895, 2.109893321990967, 1.9607511758804321, 1.4655249118804932, 2.0952885150909424, 2.327676773071289, 2.276460647583008, 0.812294602394104, 2.676182746887207, 3.2577598094940186], "mean_td_error": 2.296536922454834, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 20.0, "diff_num_grad_updates_vs_sampler_policy": 19.0}}, "num_env_steps_sampled": 18816, "num_env_steps_trained": 5160, "num_agent_steps_sampled": 56448, "num_agent_steps_trained": 5160, "last_target_update_ts": 18816, "num_target_updates": 20}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56448, "num_agent_steps_trained": 5160, "num_env_steps_sampled": 18816, "num_env_steps_trained": 5160, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 931.3256364225721, "num_env_steps_trained_throughput_per_sec": 268.1718908448924, "timesteps_total": 18816, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 56448, "timers": {"training_iteration_time_ms": 982.825, "sample_time_ms": 694.818, "load_time_ms": 0.311, "load_throughput": 828266.691, "learn_time_ms": 18.111, "learn_throughput": 14245.569, "synch_weights_time_ms": 9.471}, "counters": {"num_env_steps_sampled": 18816, "num_env_steps_trained": 5160, "num_agent_steps_sampled": 56448, "num_agent_steps_trained": 5160, "last_target_update_ts": 18816, "num_target_updates": 20}, "done": false, "episodes_total": 0, "training_iteration": 12, "trial_id": "cfa97_00000", "date": "2023-11-18_21-02-47", "timestamp": 1700370167, "time_this_iter_s": 1.93296480178833, "time_total_s": 20.751480102539062, "pid": 6770, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17f28f420>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 20.751480102539062, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 69.23333333333333, "ram_util_percent": 64.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.106571197509766, "actor_loss": -4.608214855194092, "critic_loss": 3.1289734840393066, "alpha_loss": -0.06371529400348663, "alpha_value": 0.9937154650688171, "log_alpha_value": -0.006304343231022358, "target_entropy": -6.0, "policy_t": -0.04983915761113167, "mean_q": 0.6880910396575928, "max_q": 3.80320405960083, "min_q": 0.4785686731338501}, "td_error": [4.371782302856445, 4.968107223510742, 4.750692367553711, 5.740995407104492, 4.441679954528809, 3.430708885192871, 4.978703022003174, 3.571197032928467, 5.016014099121094, 5.162291526794434, 4.094334125518799, 4.711208343505859, 3.9106521606445312, 4.826528072357178, 7.913236618041992, 5.220847129821777, 4.276466369628906, 1.52312171459198, 5.200510025024414, 2.387423038482666, 6.329763412475586, 2.5813701152801514, 6.075328826904297, 4.70632266998291, 2.7405800819396973, 3.1732921600341797, 5.197778701782227, 5.038398742675781, 3.665525436401367, 4.53055477142334, 2.4012296199798584, 4.182206630706787, 2.097738742828369, 3.245347261428833, 3.921510934829712, 5.172257423400879, 2.224353790283203, 3.672511577606201, 6.508374214172363, 4.886540412902832, 3.6824936866760254, 4.963500022888184, 3.8102493286132812, 2.8973405361175537, 2.9792871475219727, 5.553445816040039, 5.289184093475342, 0.5312446355819702, 3.2678418159484863, 5.159186363220215, 4.714439392089844, 4.6405229568481445, 4.550750255584717, 4.193133354187012, 6.7147626876831055, 7.118621349334717, 3.8073482513427734, 4.384887218475342, 5.65541410446167, 5.286721706390381, 5.4993205070495605, 2.1977078914642334, 3.8918075561523438, 4.387363910675049, 0.7076919078826904, 2.4492969512939453, 2.1487436294555664, 4.5935516357421875, 3.1521010398864746, 3.1896252632141113, 5.529139518737793, 2.9403791427612305, 5.1073384284973145, 4.527303695678711, 4.023172378540039, 3.9860072135925293, 4.790465831756592, 4.9236345291137695, 3.2141647338867188, 3.242032527923584, 5.01528263092041, 4.999194145202637, 3.097353935241699, 5.102958679199219, 5.536005020141602, 0.6434475183486938], "mean_td_error": 4.1970109939575195, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 22.0, "diff_num_grad_updates_vs_sampler_policy": 21.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.083246231079102, "actor_loss": -4.521326065063477, "critic_loss": 0.5482243299484253, "alpha_loss": -0.0635986477136612, "alpha_value": 0.9937124848365784, "log_alpha_value": -0.0063073583878576756, "target_entropy": -6.0, "policy_t": 0.03214014694094658, "mean_q": 0.5060824751853943, "max_q": 4.513833999633789, "min_q": 0.3829815983772278}, "td_error": [3.303061008453369, 2.2905566692352295, 2.3143680095672607, 2.6767220497131348, 1.6346962451934814, 2.7200324535369873, 1.9612793922424316, 1.218473196029663, 3.8668735027313232, 0.07489129900932312, 0.6048663854598999, 3.0855281352996826, 2.251919984817505, 0.261847585439682, 2.378586769104004, 2.760680675506592, 2.3620765209198, 1.6930229663848877, 2.370758533477783, 2.811309814453125, 2.5708322525024414, 3.3929524421691895, 2.1987485885620117, 2.2777304649353027, 3.14430570602417, 0.6957485675811768, 1.795729637145996, 2.384896755218506, 1.447638988494873, 0.8781441450119019, 1.3968513011932373, 2.8895106315612793, 2.2837281227111816, 1.0973291397094727, 3.6602444648742676, 2.9831302165985107, 0.22910603880882263, 1.1447503566741943, 1.1072375774383545, 1.2261717319488525, 1.6298933029174805, 1.9707058668136597, 1.2661020755767822, 2.385429620742798, 1.5082467794418335, 0.5570051670074463, 2.0296339988708496, 1.3961985111236572, 0.5148192644119263, 2.40725040435791, 2.4252848625183105, 0.3241105377674103, 3.043944835662842, 2.3810434341430664, 3.6380767822265625, 1.1329970359802246, 2.781043529510498, 2.339068651199341, 2.291133403778076, 0.9414739608764648, 0.6390799283981323, 0.9712910056114197, 2.3176770210266113, 0.6818479895591736, 2.438671588897705, 2.027221202850342, 2.7301571369171143, 1.6809799671173096, 1.676325798034668, 2.4922351837158203, 2.9392762184143066, 1.7953144311904907, 2.6951730251312256, 0.8323806524276733, 1.6957687139511108, 1.5833579301834106, 3.0019373893737793, 3.677365779876709, 1.987811803817749, 3.6727681159973145, 1.6436206102371216, 0.854850172996521, 0.9603108167648315, 1.2738544940948486, 1.4990648031234741, 0.8600020408630371], "mean_td_error": 1.942304015159607, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 22.0, "diff_num_grad_updates_vs_sampler_policy": 21.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.048212051391602, "actor_loss": -4.392666339874268, "critic_loss": 0.41754472255706787, "alpha_loss": -0.06331921368837357, "alpha_value": 0.9937182664871216, "log_alpha_value": -0.00630154088139534, "target_entropy": -6.0, "policy_t": 0.04348159581422806, "mean_q": 0.5884717702865601, "max_q": 4.181343078613281, "min_q": 0.3225041627883911}, "td_error": [2.1250383853912354, 1.867361307144165, 1.1001083850860596, 4.338010311126709, 4.222567081451416, 1.1270267963409424, 2.8698296546936035, 3.2786192893981934, 4.43206787109375, 3.5956807136535645, 0.12645798921585083, 1.5313175916671753, 2.8089470863342285, 2.8217806816101074, 2.5612058639526367, 3.5972676277160645, 2.9934730529785156, 0.4044491648674011, 0.8865357637405396, 1.2879549264907837, 2.4163737297058105, 2.7003726959228516, 1.8590013980865479, 3.45967173576355, 2.058122158050537, 2.979423999786377, 3.9603071212768555, 3.2253670692443848, 4.313468933105469, 1.5393950939178467, 1.207108736038208, 1.647829294204712, 1.304239273071289, 2.8710176944732666, 1.2310283184051514, 1.234022855758667, 0.9129397869110107, 4.08461856842041, 0.7091923952102661, 2.7389450073242188, 2.5576982498168945, 2.7182862758636475, 0.27215665578842163, 1.886427640914917, 2.5740976333618164, 1.294049620628357, 2.953904151916504, 0.6320216655731201, 3.8356521129608154, 2.0892438888549805, 2.841582775115967, 1.6674453020095825, 1.8508366346359253, 1.1153881549835205, 1.3096386194229126, 0.555934727191925, 1.6650476455688477, 0.8090564012527466, 0.1630256175994873, 3.816833972930908, 2.6388421058654785, 0.711327075958252, 1.2155168056488037, 2.297605514526367, 1.7618534564971924, 2.365757465362549, 2.9538354873657227, 0.6266514658927917, 1.0009394884109497, 3.974588632583618, 0.5472267866134644, 2.1825032234191895, 1.6552159786224365, 4.119884490966797, 3.682898998260498, 2.358874559402466, 2.967803478240967, 0.9953649640083313, 1.8752754926681519, 2.8442153930664062, 1.9802522659301758, 1.5875285863876343, 1.9209208488464355, 1.773597002029419, 2.2915000915527344, 0.9844285249710083], "mean_td_error": 2.1436147689819336, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 22.0, "diff_num_grad_updates_vs_sampler_policy": 21.0}}, "num_env_steps_sampled": 20608, "num_env_steps_trained": 5676, "num_agent_steps_sampled": 61824, "num_agent_steps_trained": 5676, "last_target_update_ts": 20608, "num_target_updates": 22}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 61824, "num_agent_steps_trained": 5676, "num_env_steps_sampled": 20608, "num_env_steps_trained": 5676, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 941.3559747268184, "num_env_steps_trained_throughput_per_sec": 271.0600909369633, "timesteps_total": 20608, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 61824, "timers": {"training_iteration_time_ms": 980.161, "sample_time_ms": 691.931, "load_time_ms": 0.312, "load_throughput": 826874.327, "learn_time_ms": 18.123, "learn_throughput": 14236.442, "synch_weights_time_ms": 9.404}, "counters": {"num_env_steps_sampled": 20608, "num_env_steps_trained": 5676, "num_agent_steps_sampled": 61824, "num_agent_steps_trained": 5676, "last_target_update_ts": 20608, "num_target_updates": 22}, "done": false, "episodes_total": 0, "training_iteration": 13, "trial_id": "cfa97_00000", "date": "2023-11-18_21-02-49", "timestamp": 1700370169, "time_this_iter_s": 1.9116089344024658, "time_total_s": 22.66308903694153, "pid": 6770, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17f308f40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 22.66308903694153, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 68.39999999999999, "ram_util_percent": 64.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.101572036743164, "actor_loss": -4.69472074508667, "critic_loss": 3.031886339187622, "alpha_loss": -0.06975233554840088, "alpha_value": 0.9931187033653259, "log_alpha_value": -0.0069050975143909454, "target_entropy": -6.0, "policy_t": 0.02334849163889885, "mean_q": 0.6886255145072937, "max_q": 6.079370498657227, "min_q": 0.5658602714538574}, "td_error": [4.510419845581055, 4.9444580078125, 4.222602367401123, 5.117781162261963, 4.908867835998535, 5.572928428649902, 4.985851287841797, 0.5719478130340576, 3.3460097312927246, 5.360456466674805, 5.148236274719238, 5.524819374084473, 3.7039437294006348, 3.1040420532226562, 6.2515764236450195, 4.381094932556152, 2.5025296211242676, 4.055102348327637, 3.7943670749664307, 2.759037971496582, 4.227285861968994, 1.8462247848510742, 4.756325721740723, 4.8682050704956055, 1.9271728992462158, 5.9542236328125, 6.923768043518066, 4.9264302253723145, 3.2460622787475586, 6.1636762619018555, 5.29066276550293, 3.7365684509277344, 2.8903284072875977, 3.391484022140503, 4.712496757507324, 5.810227394104004, 4.483081817626953, 4.986545562744141, 5.3945465087890625, 4.501750946044922, 4.713180065155029, 3.9010109901428223, 4.099830627441406, 4.509425163269043, 4.94388484954834, 3.987887144088745, 4.368107795715332, 3.224623441696167, 2.6921825408935547, 3.925419330596924, 3.229395627975464, 5.267030715942383, 3.4402995109558105, 3.775090456008911, 4.473633766174316, 4.794797420501709, 4.520345687866211, 3.8994250297546387, 4.25754976272583, 5.549883842468262, 6.145851135253906, 3.828239679336548, 4.903048992156982, 4.542890548706055, 5.132485389709473, 5.165226936340332, 3.805905818939209, 6.123714447021484, 2.6894683837890625, 5.162324905395508, 5.826997756958008, 3.8041815757751465, 3.782383680343628, 5.015484809875488, 6.297185897827148, 1.6373093128204346, 2.372091293334961, 2.5933451652526855, 5.770704746246338, 3.1970815658569336, 1.8919591903686523, 4.365964889526367, 5.04068660736084, 3.5874717235565186, 3.436194658279419, 4.336648941040039], "mean_td_error": 4.288732528686523, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 24.0, "diff_num_grad_updates_vs_sampler_policy": 23.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.019149780273438, "actor_loss": -4.508665084838867, "critic_loss": 0.6278499960899353, "alpha_loss": -0.06921301037073135, "alpha_value": 0.9931157231330872, "log_alpha_value": -0.006908072624355555, "target_entropy": -6.0, "policy_t": -0.012130504474043846, "mean_q": 0.5355996489524841, "max_q": 3.9390618801116943, "min_q": 0.4491044878959656}, "td_error": [1.7569761276245117, 2.281627655029297, 2.2051730155944824, 3.3436474800109863, 2.038323163986206, 2.9963197708129883, 2.09067440032959, 0.11457562446594238, 1.379050374031067, 1.8568756580352783, 3.044935703277588, 1.7676491737365723, 2.8624391555786133, 2.4081547260284424, 2.8464910984039307, 1.9731111526489258, 1.3744592666625977, 1.1933201551437378, 1.0267455577850342, 0.31105244159698486, 1.7375479936599731, 2.049393653869629, 4.374345779418945, 1.9040592908859253, 0.7802124619483948, 2.504361629486084, 2.776237964630127, 1.2765817642211914, 1.0052826404571533, 1.5478408336639404, 0.3823029100894928, 1.1139819622039795, 1.88258695602417, 2.162821054458618, 2.70862078666687, 3.76016902923584, 2.5596115589141846, 3.008668899536133, 3.3736071586608887, 1.86838698387146, 3.383882522583008, 1.7534468173980713, 1.0466387271881104, 2.351263999938965, 1.3622686862945557, 3.1246562004089355, 1.9183075428009033, 0.6034382581710815, 2.884129047393799, 1.145796775817871, 1.918330192565918, 2.219522714614868, 3.5234556198120117, 0.5517460107803345, 0.9567335844039917, 2.0871903896331787, 1.4781229496002197, 3.495797634124756, 1.0954338312149048, 1.2441983222961426, 0.41170236468315125, 2.112743377685547, 1.2221307754516602, 1.5880558490753174, 3.3055953979492188, 1.2391949892044067, 3.3139097690582275, 2.077554225921631, 0.43463560938835144, 3.562865972518921, 4.268944263458252, 1.6764042377471924, 4.517824172973633, 2.4515628814697266, 3.4017233848571777, 1.7734155654907227, 3.421273946762085, 1.6950674057006836, 1.8861392736434937, 3.1085686683654785, 1.2182105779647827, 2.285853385925293, 2.5152409076690674, 3.4848670959472656, 2.866703748703003, 2.251142978668213], "mean_td_error": 2.11492919921875, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 24.0, "diff_num_grad_updates_vs_sampler_policy": 23.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.071534156799316, "actor_loss": -4.473146915435791, "critic_loss": 0.39311718940734863, "alpha_loss": -0.0695071741938591, "alpha_value": 0.993122398853302, "log_alpha_value": -0.006901349872350693, "target_entropy": -6.0, "policy_t": -0.008804092183709145, "mean_q": 0.7118217945098877, "max_q": 4.389127731323242, "min_q": 0.3825414776802063}, "td_error": [2.3547768592834473, 2.8851945400238037, 2.5605568885803223, 0.10387298464775085, 2.6411609649658203, 0.2414436638355255, 1.3739700317382812, 1.8452318906784058, 1.7639023065567017, 1.3563568592071533, 1.3569546937942505, 2.7553255558013916, 1.486570954322815, 2.5802836418151855, 1.7173166275024414, 2.904794931411743, 4.649236679077148, 2.6724796295166016, 2.552384853363037, 3.147799015045166, 2.8719043731689453, 3.9336254596710205, 0.9506266713142395, 2.9438931941986084, 1.6945263147354126, 2.4442875385284424, 0.5567764043807983, 2.1926889419555664, 3.7778170108795166, 1.1135832071304321, 2.251253843307495, 0.9530539512634277, 2.002000570297241, 3.4597229957580566, 0.28765565156936646, 1.697957158088684, 0.9836854934692383, 2.804098606109619, 2.87347412109375, 2.186659574508667, 2.8117828369140625, 2.417903423309326, 3.017821788787842, 3.707300901412964, 2.448150396347046, 1.5301952362060547, 0.9960674047470093, 0.023160099983215332, 1.218917965888977, 1.9063670635223389, 1.6084792613983154, 2.80198073387146, 2.980894088745117, 3.189390182495117, 1.127002239227295, 0.3727080821990967, 3.276308298110962, 0.41620177030563354, 1.6317098140716553, 3.1930532455444336, 0.6049432754516602, 4.585127830505371, 3.9179208278656006, 1.8639222383499146, 2.805020332336426, 2.0353198051452637, 1.9803969860076904, 1.9882748126983643, 0.6795202493667603, 1.2685966491699219, 1.0194854736328125, 2.606553077697754, 2.11295747756958, 2.2816386222839355, 4.971967697143555, 2.814148187637329, 0.2783195972442627, 2.105238199234009, 3.031022071838379, 1.1429014205932617, 1.7053673267364502, 1.4353866577148438, 1.201658010482788, 0.7265970706939697, 0.9844461679458618, 0.2844167947769165], "mean_td_error": 2.046923875808716, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 24.0, "diff_num_grad_updates_vs_sampler_policy": 23.0}}, "num_env_steps_sampled": 22400, "num_env_steps_trained": 6192, "num_agent_steps_sampled": 67200, "num_agent_steps_trained": 6192, "last_target_update_ts": 22400, "num_target_updates": 24}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 67200, "num_agent_steps_trained": 6192, "num_env_steps_sampled": 22400, "num_env_steps_trained": 6192, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 888.3918166035652, "num_env_steps_trained_throughput_per_sec": 255.80925076308017, "timesteps_total": 22400, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 67200, "timers": {"training_iteration_time_ms": 992.18, "sample_time_ms": 701.999, "load_time_ms": 0.313, "load_throughput": 824480.329, "learn_time_ms": 18.27, "learn_throughput": 14121.48, "synch_weights_time_ms": 9.594}, "counters": {"num_env_steps_sampled": 22400, "num_env_steps_trained": 6192, "num_agent_steps_sampled": 67200, "num_agent_steps_trained": 6192, "last_target_update_ts": 22400, "num_target_updates": 24}, "done": false, "episodes_total": 0, "training_iteration": 14, "trial_id": "cfa97_00000", "date": "2023-11-18_21-02-51", "timestamp": 1700370171, "time_this_iter_s": 2.02559494972229, "time_total_s": 24.68868398666382, "pid": 6770, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17f28fec0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 24.68868398666382, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 69.1, "ram_util_percent": 64.73333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.142027854919434, "actor_loss": -4.790891170501709, "critic_loss": 2.771841287612915, "alpha_loss": -0.07307812571525574, "alpha_value": 0.9928204417228699, "log_alpha_value": -0.007205475587397814, "target_entropy": -6.0, "policy_t": -0.0041867997497320175, "mean_q": 0.7705591917037964, "max_q": 4.8241190910339355, "min_q": 0.6123660802841187}, "td_error": [4.133172988891602, 4.9650750160217285, 4.941104888916016, 4.4867401123046875, 4.264200210571289, 3.160219669342041, 5.592438697814941, 2.148353099822998, 3.849457263946533, 5.488271713256836, 4.422691345214844, 1.97019362449646, 3.812915325164795, 5.618547439575195, 2.156888246536255, 4.607501029968262, 2.7749950885772705, 4.878334045410156, 4.475639343261719, 2.7493221759796143, 6.253513813018799, 3.2221832275390625, 1.7474678754806519, 3.4455056190490723, 1.7468628883361816, 4.787091255187988, 4.0507073402404785, 3.621138095855713, 4.230114936828613, 4.930909156799316, 4.291141033172607, 4.650608062744141, 3.864086151123047, 3.419119119644165, 5.669214248657227, 3.7308993339538574, 4.704026699066162, 4.433963775634766, 2.8494865894317627, 3.32143497467041, 3.9300248622894287, 5.733210563659668, 4.409287452697754, 3.5091350078582764, 3.722270965576172, 3.6708076000213623, 3.2743494510650635, 4.78554105758667, 4.905697345733643, 4.355635643005371, 4.676639556884766, 0.6430292129516602, 3.234038829803467, 3.7694945335388184, 3.4633584022521973, 4.641635894775391, 3.3567028045654297, 3.168025255203247, 3.561704635620117, 4.270000457763672, 4.014642715454102, 4.092988014221191, 1.1040794849395752, 6.438873291015625, 5.5223517417907715, 4.263233661651611, 4.618799209594727, 3.0392472743988037, 2.611753463745117, 2.8526101112365723, 1.0140323638916016, 2.14833927154541, 4.631589889526367, 4.451084136962891, 3.7470993995666504, 3.319988250732422, 2.664163112640381, 3.0582852363586426, 4.550278663635254, 2.4975051879882812, 5.233439922332764, 4.984840393066406, 7.090139389038086, 4.521378517150879, 4.5149126052856445, 4.966052055358887], "mean_td_error": 3.936021327972412, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 25.0, "diff_num_grad_updates_vs_sampler_policy": 24.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.116477966308594, "actor_loss": -4.653453350067139, "critic_loss": 0.6533626914024353, "alpha_loss": -0.07292211800813675, "alpha_value": 0.9928176403045654, "log_alpha_value": -0.007208251394331455, "target_entropy": -6.0, "policy_t": -0.004073352552950382, "mean_q": 0.5463526844978333, "max_q": 3.6203207969665527, "min_q": 0.4853883981704712}, "td_error": [0.47436827421188354, 3.470914602279663, 1.7853147983551025, 2.306777000427246, 2.674283981323242, 1.3093163967132568, 0.7514127492904663, 1.5200769901275635, 4.041364669799805, 0.6272697448730469, 3.3689403533935547, 1.9073573350906372, 1.207951307296753, 1.4539895057678223, 2.057063102722168, 2.1644253730773926, 2.0148229598999023, 2.0816571712493896, 3.9721736907958984, 0.6663650274276733, 2.500077724456787, 1.4117443561553955, 0.3874853849411011, 4.172892093658447, 1.4675195217132568, 1.7289637327194214, 3.189540386199951, 1.5592015981674194, 1.4534869194030762, 3.8622329235076904, 2.031381368637085, 1.955960988998413, 2.3798038959503174, 1.933790922164917, 0.5286537408828735, 1.871157169342041, 1.8231756687164307, 3.075009822845459, 3.641049385070801, 1.9897061586380005, 2.5862584114074707, 2.9489073753356934, 1.0254602432250977, 2.7866315841674805, 1.4106040000915527, 2.8428993225097656, 1.403684139251709, 3.3687829971313477, 1.7950345277786255, 1.4659223556518555, 2.0542702674865723, 0.6156776547431946, 2.1194543838500977, 1.2855169773101807, 2.7004010677337646, 2.821587085723877, 1.1423933506011963, 2.0646562576293945, 1.0580741167068481, 2.141631841659546, 0.26999837160110474, 3.9245567321777344, 0.4697452187538147, 1.4884809255599976, 2.6223154067993164, 0.19010786712169647, 3.357935905456543, 3.0786056518554688, 2.345606565475464, 4.570204257965088, 2.40985369682312, 3.6010732650756836, 4.060762405395508, 1.9063572883605957, 3.548407793045044, 2.540536403656006, 4.49167537689209, 2.0989484786987305, 2.467391014099121, 2.9317617416381836, 1.1317954063415527, 2.8357603549957275, 0.587943434715271, 2.9164109230041504, 2.3997690677642822, 3.953096866607666], "mean_td_error": 2.1936702728271484, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 25.0, "diff_num_grad_updates_vs_sampler_policy": 24.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.076831817626953, "actor_loss": -4.521271228790283, "critic_loss": 0.4524998664855957, "alpha_loss": -0.07256607711315155, "alpha_value": 0.9928246140480042, "log_alpha_value": -0.0072012790478765965, "target_entropy": -6.0, "policy_t": 0.045511793345212936, "mean_q": 0.6055344343185425, "max_q": 3.7345190048217773, "min_q": 0.41408222913742065}, "td_error": [1.0485094785690308, 1.961519479751587, 3.1601216793060303, 1.9403653144836426, 1.2682554721832275, 2.253058910369873, 2.380836009979248, 3.7794365882873535, 3.2409510612487793, 1.8779939413070679, 2.7010841369628906, 3.9909067153930664, 2.1790575981140137, 2.6359641551971436, 1.502271294593811, 1.3649441003799438, 2.7653019428253174, 2.5695645809173584, 2.4552135467529297, 3.154181957244873, 2.267302989959717, 2.5794758796691895, 1.2009978294372559, 2.310962438583374, 2.554129123687744, 2.052919387817383, 3.027358055114746, 2.4749345779418945, 0.50533127784729, 2.5120277404785156, 3.3363261222839355, 1.7431532144546509, 4.010570526123047, 1.4919302463531494, 2.8917946815490723, 1.4451611042022705, 2.4065678119659424, 1.7578045129776, 0.2885226011276245, 2.0385184288024902, 3.3762295246124268, 0.9748786687850952, 2.080465316772461, 2.5445399284362793, 2.7954370975494385, 2.2501020431518555, 1.609407901763916, 3.2110323905944824, 2.8098387718200684, 1.3401315212249756, 0.28170883655548096, 3.139251708984375, 1.9503107070922852, 0.9936046600341797, 3.8289496898651123, 2.1748390197753906, 0.08132565021514893, 2.482722759246826, 1.3200314044952393, 3.3623721599578857, 3.0487046241760254, 1.0166174173355103, 2.1457672119140625, 0.5973865985870361, 2.033047914505005, 1.1647216081619263, 2.902421236038208, 2.5439951419830322, 1.5350956916809082, 3.5063319206237793, 1.0012072324752808, 3.0577445030212402, 1.6928043365478516, 1.9085664749145508, 3.032744884490967, 2.857760429382324, 2.275351047515869, 3.0595765113830566, 4.332824230194092, 3.465142011642456, 3.8222427368164062, 2.3720922470092773, 4.013772010803223, 2.0111212730407715, 3.0286269187927246, 2.0105044841766357], "mean_td_error": 2.3042869567871094, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 25.0, "diff_num_grad_updates_vs_sampler_policy": 24.0}}, "num_env_steps_sampled": 23296, "num_env_steps_trained": 6450, "num_agent_steps_sampled": 69888, "num_agent_steps_trained": 6450, "last_target_update_ts": 23296, "num_target_updates": 25}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 69888, "num_agent_steps_trained": 6450, "num_env_steps_sampled": 23296, "num_env_steps_trained": 6450, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 794.0221226046046, "num_env_steps_trained_throughput_per_sec": 228.6358344107009, "timesteps_total": 23296, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 69888, "timers": {"training_iteration_time_ms": 1005.364, "sample_time_ms": 695.898, "load_time_ms": 0.313, "load_throughput": 825486.637, "learn_time_ms": 18.24, "learn_throughput": 14144.386, "synch_weights_time_ms": 9.473}, "counters": {"num_env_steps_sampled": 23296, "num_env_steps_trained": 6450, "num_agent_steps_sampled": 69888, "num_agent_steps_trained": 6450, "last_target_update_ts": 23296, "num_target_updates": 25}, "done": false, "episodes_total": 0, "training_iteration": 15, "trial_id": "cfa97_00000", "date": "2023-11-18_21-02-52", "timestamp": 1700370172, "time_this_iter_s": 1.1377787590026855, "time_total_s": 25.826462745666504, "pid": 6770, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17f309260>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 25.826462745666504, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 75.5, "ram_util_percent": 64.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.092301368713379, "actor_loss": -4.843636989593506, "critic_loss": 2.386809825897217, "alpha_loss": -0.07878351956605911, "alpha_value": 0.9922240972518921, "log_alpha_value": -0.00780629925429821, "target_entropy": -6.0, "policy_t": 0.009118780493736267, "mean_q": 1.4130133390426636, "max_q": 7.450133323669434, "min_q": 0.7118675708770752}, "td_error": [2.5000486373901367, 2.0220119953155518, 4.410279273986816, 4.186083793640137, 3.5737812519073486, 4.594823837280273, 2.2461037635803223, 2.667036294937134, 4.137212753295898, 4.915059566497803, 3.267025947570801, 3.8044896125793457, 3.174283742904663, 3.1552469730377197, 5.328258514404297, 5.9657511711120605, 3.3366527557373047, 5.043846607208252, 2.931187152862549, 1.193178653717041, 2.7738022804260254, 3.833548069000244, 4.388881683349609, 3.0291848182678223, 4.129848957061768, 0.8695988655090332, 3.9580750465393066, 4.3132643699646, 3.0233609676361084, 4.009964466094971, 3.615367889404297, 5.381243705749512, 5.662492752075195, 4.6542158126831055, 4.054917812347412, 4.326624393463135, 2.50242018699646, 4.8300251960754395, 3.440929889678955, 1.611523151397705, 3.6787099838256836, 0.5145814418792725, 3.466489553451538, 1.6408780813217163, 4.290441513061523, 4.9145073890686035, 4.439477920532227, 2.732762336730957, 2.986470937728882, 3.1452624797821045, 2.868650436401367, 4.127111434936523, 3.349788188934326, 5.546095848083496, 4.290485858917236, 0.6380740404129028, 5.550999641418457, 4.414559364318848, 2.2943003177642822, 5.29234504699707, 2.745936393737793, 0.8359298706054688, 3.4776625633239746, 5.099702835083008, 3.277209758758545, 4.640288352966309, 4.365642547607422, 4.429220676422119, 2.5745935440063477, 2.770256757736206, 1.8132567405700684, 0.5145068168640137, 4.623110294342041, 4.9858784675598145, 3.784595012664795, 4.138062477111816, 2.156867504119873, 0.5146546363830566, 4.2709269523620605, 4.1691131591796875, 3.5534167289733887, 4.800570964813232, 2.9402570724487305, 2.160945415496826, 3.191934585571289, 5.041657447814941], "mean_td_error": 3.533951759338379, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 27.0, "diff_num_grad_updates_vs_sampler_policy": 26.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.074191093444824, "actor_loss": -4.704544544219971, "critic_loss": 0.5413002967834473, "alpha_loss": -0.07866673916578293, "alpha_value": 0.9922216534614563, "log_alpha_value": -0.007808739319443703, "target_entropy": -6.0, "policy_t": -0.03561440482735634, "mean_q": 0.709576427936554, "max_q": 6.068608283996582, "min_q": 0.5645761489868164}, "td_error": [0.24067100882530212, 2.810030937194824, 2.8644919395446777, 1.7352429628372192, 1.8622820377349854, 2.1603455543518066, 1.2774224281311035, 2.666262149810791, 2.3313050270080566, 2.4117157459259033, 3.079136610031128, 1.8666954040527344, 0.7148180603981018, 0.627194881439209, 0.7430275678634644, 0.9935711026191711, 1.7029858827590942, 2.82733154296875, 1.1250860691070557, 1.9281339645385742, 2.503077507019043, 1.2406338453292847, 0.4247255325317383, 4.385742664337158, 1.9992555379867554, 1.6972529888153076, 1.0326948165893555, 2.083865165710449, 3.255307674407959, 1.1328232288360596, 1.2143620252609253, 3.583341121673584, 2.2379660606384277, 0.6649218201637268, 0.40677809715270996, 0.7139236927032471, 3.3918933868408203, 1.1730849742889404, 2.3703770637512207, 1.0144975185394287, 2.2849555015563965, 3.695263147354126, 0.5314142107963562, 2.0706498622894287, 2.1106600761413574, 1.495579481124878, 2.6691648960113525, 1.8776460886001587, 1.7336369752883911, 1.7324368953704834, 0.8454939126968384, 2.5476694107055664, 2.479485511779785, 3.5902273654937744, 1.3239275217056274, 3.1202001571655273, 1.586496114730835, 0.4143516421318054, 1.9770039319992065, 2.8569729328155518, 1.135481595993042, 1.187559962272644, 2.180628538131714, 4.246923446655273, 3.3209142684936523, 1.4442851543426514, 1.7217469215393066, 2.6178534030914307, 0.6526858806610107, 0.62442547082901, 1.1968806982040405, 0.7749140858650208, 1.98539137840271, 2.939279556274414, 2.893704414367676, 2.924403667449951, 1.436848759651184, 2.2571663856506348, 4.205563545227051, 0.5002530813217163, 2.0328445434570312, 0.37372344732284546, 1.7029378414154053, 0.4933057129383087, 3.142850399017334, 1.7504334449768066], "mean_td_error": 1.8974478244781494, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 27.0, "diff_num_grad_updates_vs_sampler_policy": 26.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.1476411819458, "actor_loss": -4.652856826782227, "critic_loss": 0.4248671233654022, "alpha_loss": -0.07916410267353058, "alpha_value": 0.9922291040420532, "log_alpha_value": -0.00780123146250844, "target_entropy": -6.0, "policy_t": -0.0015689181163907051, "mean_q": 0.877315104007721, "max_q": 5.089571952819824, "min_q": 0.48231589794158936}, "td_error": [1.2690346240997314, 4.547013282775879, 0.8946753740310669, 1.7706407308578491, 2.1621248722076416, 2.2835755348205566, 1.0194580554962158, 1.433286428451538, 2.825164794921875, 3.2879531383514404, 1.376104474067688, 2.059269428253174, 3.036242961883545, 2.3553953170776367, 3.107334613800049, 2.5137150287628174, 3.0542991161346436, 1.0618312358856201, 3.4065589904785156, 1.7973604202270508, 2.31911039352417, 3.2793617248535156, 1.4841804504394531, 0.8391335010528564, 2.832566022872925, 3.2248620986938477, 3.2116410732269287, 2.3577308654785156, 1.5426479578018188, 0.8602315783500671, 4.277935028076172, 3.5487406253814697, 0.04218187928199768, 0.8889175653457642, 2.3632938861846924, 3.7674806118011475, 3.694519519805908, 2.342320442199707, 1.8304705619812012, 3.7787230014801025, 0.519739031791687, 1.1671080589294434, 5.111904144287109, 2.7510433197021484, 2.6682276725769043, 2.8950774669647217, 0.8562742471694946, 1.2519140243530273, 3.614950180053711, 1.3572134971618652, 3.7400670051574707, 1.8576104640960693, 0.919430136680603, 2.160550117492676, 2.491769790649414, 2.2597734928131104, 2.4556221961975098, 2.1580467224121094, 1.556084156036377, 2.0696001052856445, 1.8683586120605469, 0.05221560597419739, 1.9282550811767578, 0.54478919506073, 2.161860466003418, 0.031242787837982178, 1.8288836479187012, 1.8941601514816284, 0.27689337730407715, 1.5393750667572021, 2.6679129600524902, 3.742387294769287, 1.593597412109375, 1.6874637603759766, 3.0692481994628906, 1.8381150960922241, 2.3500070571899414, 1.7995893955230713, 1.764683485031128, 0.9342952370643616, 4.143463134765625, 4.120152473449707, 2.1364974975585938, 1.2318840026855469, 2.9579787254333496, 2.16025972366333], "mean_td_error": 2.1852633953094482, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 27.0, "diff_num_grad_updates_vs_sampler_policy": 26.0}}, "num_env_steps_sampled": 25088, "num_env_steps_trained": 6966, "num_agent_steps_sampled": 75264, "num_agent_steps_trained": 6966, "last_target_update_ts": 25088, "num_target_updates": 27}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 75264, "num_agent_steps_trained": 6966, "num_env_steps_sampled": 25088, "num_env_steps_trained": 6966, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 912.5048280416856, "num_env_steps_trained_throughput_per_sec": 262.75250628878894, "timesteps_total": 25088, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 75264, "timers": {"training_iteration_time_ms": 991.313, "sample_time_ms": 698.008, "load_time_ms": 0.313, "load_throughput": 824480.329, "learn_time_ms": 18.156, "learn_throughput": 14209.97, "synch_weights_time_ms": 9.855}, "counters": {"num_env_steps_sampled": 25088, "num_env_steps_trained": 6966, "num_agent_steps_sampled": 75264, "num_agent_steps_trained": 6966, "last_target_update_ts": 25088, "num_target_updates": 27}, "done": false, "episodes_total": 0, "training_iteration": 16, "trial_id": "cfa97_00000", "date": "2023-11-18_21-02-54", "timestamp": 1700370174, "time_this_iter_s": 1.9714250564575195, "time_total_s": 27.797887802124023, "pid": 6770, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17f308fe0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 27.797887802124023, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 65.73333333333333, "ram_util_percent": 64.63333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.092677116394043, "actor_loss": -4.937429904937744, "critic_loss": 2.5504040718078613, "alpha_loss": -0.08484861999750137, "alpha_value": 0.9916282892227173, "log_alpha_value": -0.00840694922953844, "target_entropy": -6.0, "policy_t": -0.036005232483148575, "mean_q": 1.2727174758911133, "max_q": 8.187104225158691, "min_q": 0.8163765668869019}, "td_error": [3.234140396118164, 4.878025531768799, 4.204247951507568, 3.2687034606933594, 2.765735149383545, 4.822811126708984, 1.246690034866333, 4.506302356719971, 4.559756278991699, 4.294609069824219, 5.121835231781006, 5.0076446533203125, 3.7438151836395264, 4.217091083526611, 3.7345540523529053, 2.294196605682373, 3.5775299072265625, 3.8900156021118164, 3.7975683212280273, 4.1679887771606445, 4.822966575622559, 4.645607948303223, 2.9390711784362793, 2.6946284770965576, 4.043900489807129, 2.4713964462280273, 4.129158020019531, 2.812479019165039, 3.972095012664795, 4.812835693359375, 1.2082338333129883, 2.404684066772461, 2.1554932594299316, 3.843397617340088, 0.29259002208709717, 3.5498673915863037, 4.0424957275390625, 6.2009382247924805, 5.129640579223633, 6.138995170593262, 4.34373664855957, 3.95139217376709, 2.604146718978882, 5.335533142089844, 3.295560359954834, 4.3762617111206055, 2.800708770751953, 3.6546473503112793, 2.892076015472412, 3.241112232208252, 3.6352181434631348, 3.3898067474365234, 2.3323655128479004, 3.9033236503601074, 3.876312255859375, 3.74619722366333, 3.4665439128875732, 7.0421648025512695, 4.324162483215332, 3.2952051162719727, 4.986873626708984, 5.312389850616455, 5.601526260375977, 2.7364559173583984, 4.524293899536133, 4.561549186706543, 4.10413932800293, 3.047624349594116, 3.872042179107666, 4.887758731842041, 3.7666308879852295, 4.104992866516113, 2.230187177658081, 2.190703868865967, 4.4995927810668945, 1.829308271408081, 1.7685303688049316, 5.242521286010742, 5.46535587310791, 4.047338485717773, 5.421263217926025, 5.280203819274902, 3.182152032852173, 5.217216491699219, 4.234116554260254, 5.766392230987549], "mean_td_error": 3.87245774269104, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 29.0, "diff_num_grad_updates_vs_sampler_policy": 28.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.087967872619629, "actor_loss": -4.808936595916748, "critic_loss": 0.5391353368759155, "alpha_loss": -0.08483120799064636, "alpha_value": 0.9916260838508606, "log_alpha_value": -0.008409147150814533, "target_entropy": -6.0, "policy_t": -0.008791578002274036, "mean_q": 0.8211420774459839, "max_q": 5.878633975982666, "min_q": 0.6495839953422546}, "td_error": [1.0168490409851074, 2.336779832839966, 0.4001641273498535, 0.1943683624267578, 1.0130428075790405, 3.6006813049316406, 2.5386850833892822, 0.16439089179039001, 1.655156135559082, 2.450875759124756, 2.085700273513794, 3.645421266555786, 0.19330894947052002, 0.6804057359695435, 0.6784374713897705, 1.1668462753295898, 3.7563812732696533, 1.025470495223999, 0.8968275189399719, 2.7901899814605713, 0.9467507004737854, 1.9633290767669678, 1.3248454332351685, 0.6960331201553345, 2.621572971343994, 1.14205002784729, 3.8056178092956543, 1.5668890476226807, 2.128674030303955, 2.9963173866271973, 0.4932619333267212, 3.212131977081299, 3.231372594833374, 2.453131675720215, 3.082972526550293, 0.45713627338409424, 3.0858492851257324, 0.9303581714630127, 0.3699215054512024, 1.854827880859375, 3.68674373626709, 2.6845738887786865, 1.1190223693847656, 4.322805404663086, 1.5437965393066406, 1.860221266746521, 2.257814407348633, 0.3364924192428589, 0.8870243430137634, 1.6912466287612915, 2.0699570178985596, 2.185873031616211, 3.5053951740264893, 3.7852225303649902, 2.3319320678710938, 1.590217113494873, 2.0209224224090576, 1.8464148044586182, 0.7095736265182495, 0.3533569574356079, 1.6865615844726562, 2.7390003204345703, 2.4022340774536133, 0.37775740027427673, 0.4879142642021179, 2.738694190979004, 0.9183748960494995, 2.196185827255249, 0.5898697376251221, 1.0989456176757812, 3.3209991455078125, 1.9070290327072144, 2.1981868743896484, 1.8218131065368652, 0.4355693459510803, 2.3914480209350586, 0.8435466289520264, 3.4773824214935303, 1.7218314409255981, 2.9423937797546387, 0.684829592704773, 3.6157608032226562, 2.44291353225708, 2.328967332839966, 0.9212031364440918, 2.363572835922241], "mean_td_error": 1.861565351486206, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 29.0, "diff_num_grad_updates_vs_sampler_policy": 28.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.061260223388672, "actor_loss": -4.640963554382324, "critic_loss": 0.4046272933483124, "alpha_loss": -0.0845302939414978, "alpha_value": 0.9916336536407471, "log_alpha_value": -0.008401560597121716, "target_entropy": -6.0, "policy_t": 0.02438940480351448, "mean_q": 0.8506333827972412, "max_q": 5.879188060760498, "min_q": 0.5525673627853394}, "td_error": [1.1379296779632568, 2.6154916286468506, 1.0679086446762085, 3.2141242027282715, 1.518570899963379, 1.9014592170715332, 5.764469146728516, 4.275094985961914, 2.4296984672546387, 1.4532290697097778, 1.0244140625, 0.9828681945800781, 3.491443157196045, 4.449991703033447, 1.866743564605713, 1.1305882930755615, 2.2290921211242676, 1.6727924346923828, 2.8268253803253174, 0.5244975686073303, 1.2649129629135132, 1.5550611019134521, 1.591980218887329, 0.6053305864334106, 0.1295757293701172, 3.015219211578369, 3.9195539951324463, 1.1266934871673584, 3.2067368030548096, 2.70876407623291, 1.8323603868484497, 1.698775053024292, 3.1682522296905518, 2.3459134101867676, 0.04984784126281738, 3.0057125091552734, 0.34782928228378296, 2.5689215660095215, 2.566565752029419, 0.31085115671157837, 2.2495710849761963, 2.124229907989502, 1.2809057235717773, 1.4006469249725342, 2.0084896087646484, 1.4092986583709717, 4.7647905349731445, 2.4164888858795166, 0.6888532042503357, 1.9789767265319824, 0.419613242149353, 2.78019118309021, 0.5975122451782227, 5.072214126586914, 1.6621453762054443, 1.7339346408843994, 2.1950314044952393, 1.1183192729949951, 2.4319567680358887, 2.404191493988037, 2.7086830139160156, 1.9501879215240479, 4.000372409820557, 1.6707838773727417, 0.09216314554214478, 2.5091874599456787, 2.038347005844116, 2.1180357933044434, 1.4004287719726562, 1.1913689374923706, 1.679564356803894, 3.559596061706543, 1.3638725280761719, 0.8171495795249939, 0.9596631526947021, 2.793764352798462, 2.7055251598358154, 1.477158546447754, 3.064056873321533, 2.1711435317993164, 2.1382198333740234, 3.168647050857544, 2.9101929664611816, 2.5368120670318604, 2.8497815132141113, 2.188420057296753], "mean_td_error": 2.0860066413879395, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 29.0, "diff_num_grad_updates_vs_sampler_policy": 28.0}}, "num_env_steps_sampled": 26880, "num_env_steps_trained": 7482, "num_agent_steps_sampled": 80640, "num_agent_steps_trained": 7482, "last_target_update_ts": 26880, "num_target_updates": 29}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80640, "num_agent_steps_trained": 7482, "num_env_steps_sampled": 26880, "num_env_steps_trained": 7482, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 890.5994599664718, "num_env_steps_trained_throughput_per_sec": 256.44493378498856, "timesteps_total": 26880, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 80640, "timers": {"training_iteration_time_ms": 998.792, "sample_time_ms": 705.448, "load_time_ms": 0.316, "load_throughput": 817627.829, "learn_time_ms": 18.143, "learn_throughput": 14220.39, "synch_weights_time_ms": 9.946}, "counters": {"num_env_steps_sampled": 26880, "num_env_steps_trained": 7482, "num_agent_steps_sampled": 80640, "num_agent_steps_trained": 7482, "last_target_update_ts": 26880, "num_target_updates": 29}, "done": false, "episodes_total": 0, "training_iteration": 17, "trial_id": "cfa97_00000", "date": "2023-11-18_21-02-56", "timestamp": 1700370176, "time_this_iter_s": 2.0209968090057373, "time_total_s": 29.81888461112976, "pid": 6770, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17f28ec00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 29.81888461112976, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 73.86666666666666, "ram_util_percent": 64.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.056009292602539, "actor_loss": -4.995373249053955, "critic_loss": 2.0914409160614014, "alpha_loss": -0.09058007597923279, "alpha_value": 0.9910328984260559, "log_alpha_value": -0.009007555432617664, "target_entropy": -6.0, "policy_t": -0.06111391261219978, "mean_q": 1.3680133819580078, "max_q": 8.033279418945312, "min_q": 0.9258845448493958}, "td_error": [4.365994930267334, 4.262909889221191, 4.394522666931152, 3.9500606060028076, 2.508694887161255, 4.0036301612854, 3.7369775772094727, 1.3840748071670532, 2.980429172515869, 4.55177116394043, 3.446897506713867, 3.7545433044433594, 2.9071359634399414, 3.6965532302856445, 4.2385735511779785, 4.699520587921143, 4.53229284286499, 4.04194450378418, 3.236023426055908, 4.401325702667236, 3.6729321479797363, 3.2424488067626953, 5.1916093826293945, 2.2230491638183594, 3.3180103302001953, 2.216742753982544, 1.6926496028900146, 3.847940683364868, 3.1124048233032227, 0.7090353965759277, 2.9341211318969727, 4.409704685211182, 2.7491843700408936, 3.154144763946533, 2.4974517822265625, 4.861247539520264, 4.373636245727539, 2.150228500366211, 3.591525077819824, 3.429365396499634, 1.6964645385742188, 5.031167507171631, 4.886472702026367, 2.0083775520324707, 3.1860949993133545, 4.726539134979248, 1.7379117012023926, 3.4356539249420166, 2.254563808441162, 3.264141798019409, 2.7920570373535156, 4.032832145690918, 4.052477836608887, 5.325909614562988, 3.7790286540985107, 1.581385612487793, 4.282445907592773, 3.4093680381774902, 3.807803153991699, 2.6343770027160645, 2.044672727584839, 3.553635597229004, 3.365269660949707, 0.28180646896362305, 5.36378288269043, 1.0294065475463867, 3.606372594833374, 4.746796607971191, 4.874305248260498, 4.426900863647461, 3.564537763595581, 3.3126747608184814, 3.4973084926605225, 4.348916053771973, 3.5798916816711426, 1.250999927520752, 4.228457927703857, 3.8080105781555176, 3.2737483978271484, 2.156430244445801, 5.520124435424805, 2.732637643814087, 3.6961569786071777, 2.7558674812316895, 2.2618651390075684, 3.3804824352264404], "mean_td_error": 3.407644510269165, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 31.0, "diff_num_grad_updates_vs_sampler_policy": 30.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.052916526794434, "actor_loss": -4.867184638977051, "critic_loss": 0.5493386387825012, "alpha_loss": -0.09057106822729111, "alpha_value": 0.9910310506820679, "log_alpha_value": -0.009009432047605515, "target_entropy": -6.0, "policy_t": -0.014048049226403236, "mean_q": 1.045403003692627, "max_q": 6.718344688415527, "min_q": 0.7406694889068604}, "td_error": [2.8555190563201904, 3.1311299800872803, 1.916884183883667, 0.14947247505187988, 0.313737690448761, 1.2296602725982666, 0.049643516540527344, 1.159094214439392, 1.377687931060791, 1.2984035015106201, 1.6354069709777832, 3.9262475967407227, 2.3474016189575195, 2.5300002098083496, 1.1532500982284546, 0.5052109956741333, 0.5105000138282776, 2.6698179244995117, 1.7599220275878906, 0.998121976852417, 2.754100799560547, 3.5591816902160645, 4.696165561676025, 0.8391836285591125, 3.5241942405700684, 0.8435214757919312, 4.8082990646362305, 1.2527729272842407, 2.7805323600769043, 1.6930911540985107, 3.720229148864746, 1.8024511337280273, 2.647977113723755, 2.2426674365997314, 1.7720727920532227, 1.61858332157135, 1.2457904815673828, 2.1430020332336426, 2.020805835723877, 1.9284350872039795, 1.410374402999878, 1.9024475812911987, 5.680917739868164, 0.18595623970031738, 3.142580032348633, 0.5755295753479004, 4.2959818840026855, 3.5491690635681152, 1.622672438621521, 3.0093114376068115, 0.5217711925506592, 1.5348740816116333, 2.1432385444641113, 1.898656964302063, 1.2463117837905884, 1.3828041553497314, 2.445712089538574, 0.4077419638633728, 3.0071942806243896, 1.6861193180084229, 0.4865225553512573, 1.401700496673584, 1.9156055450439453, 0.731597900390625, 2.5168912410736084, 2.7101705074310303, 3.052042245864868, 2.107999801635742, 1.0931035280227661, 2.993093967437744, 1.8229012489318848, 1.9971258640289307, 1.6490894556045532, 1.2160849571228027, 2.531039237976074, 0.27580633759498596, 0.7322262525558472, 0.842245876789093, 0.13619771599769592, 1.0904253721237183, 2.6871252059936523, 1.2937145233154297, 2.477029323577881, 3.5432043075561523, 1.4183807373046875, 1.1392635107040405], "mean_td_error": 1.9176759719848633, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 31.0, "diff_num_grad_updates_vs_sampler_policy": 30.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.15692138671875, "actor_loss": -4.808371543884277, "critic_loss": 0.4031630754470825, "alpha_loss": -0.09143123775720596, "alpha_value": 0.9910385012626648, "log_alpha_value": -0.009001865983009338, "target_entropy": -6.0, "policy_t": 0.01546536386013031, "mean_q": 0.7796744704246521, "max_q": 5.523996353149414, "min_q": 0.6264063119888306}, "td_error": [1.8241045475006104, 2.4950966835021973, 1.5774952173233032, 1.1519627571105957, 0.46138715744018555, 0.615066647529602, 3.5293920040130615, 2.035151720046997, 4.015631198883057, 4.233222961425781, 2.422001361846924, 2.983006715774536, 0.6598231196403503, 2.759141445159912, 2.0457749366760254, 2.915297508239746, 2.9654247760772705, 2.3338840007781982, 1.9817888736724854, 2.7621657848358154, 2.245605707168579, 1.8696616888046265, 0.9926393628120422, 1.606818675994873, 3.5426712036132812, 1.3931474685668945, 2.308457374572754, 1.7785320281982422, 1.387551188468933, 1.629540205001831, 1.2850219011306763, 0.9081002473831177, 0.13684672117233276, 0.040088653564453125, 1.1004788875579834, 2.080596923828125, 1.607479453086853, 2.5914053916931152, 0.929451048374176, 2.311389684677124, 2.192141532897949, 4.137699127197266, 0.4146730303764343, 2.0336689949035645, 2.408607006072998, 2.7624220848083496, 2.217202663421631, 2.47799015045166, 4.355633735656738, 0.1887439787387848, 0.35227420926094055, 2.684633493423462, 0.605674147605896, 2.173429012298584, 0.47073912620544434, 3.212919235229492, 0.6357161402702332, 1.0385686159133911, 2.8768579959869385, 2.0040416717529297, 3.3453969955444336, 2.678100109100342, 3.159879446029663, 1.6002833843231201, 3.04656720161438, 3.142273426055908, 0.8519561290740967, 1.639738917350769, 2.2926249504089355, 1.9776607751846313, 3.7909674644470215, 2.380274772644043, 3.1370058059692383, 1.776496171951294, 1.8709949254989624, 1.8185486793518066, 3.203125, 1.8256065845489502, 3.6451969146728516, 3.843993663787842, 2.688791275024414, 1.9694958925247192, 0.5553719997406006, 1.708740472793579, 1.257114291191101, 3.623546600341797], "mean_td_error": 2.0882058143615723, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 31.0, "diff_num_grad_updates_vs_sampler_policy": 30.0}}, "num_env_steps_sampled": 28672, "num_env_steps_trained": 7998, "num_agent_steps_sampled": 86016, "num_agent_steps_trained": 7998, "last_target_update_ts": 28672, "num_target_updates": 31}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 86016, "num_agent_steps_trained": 7998, "num_env_steps_sampled": 28672, "num_env_steps_trained": 7998, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 967.938661358165, "num_env_steps_trained_throughput_per_sec": 278.71448061429305, "timesteps_total": 28672, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 86016, "timers": {"training_iteration_time_ms": 993.801, "sample_time_ms": 699.385, "load_time_ms": 0.317, "load_throughput": 814918.617, "learn_time_ms": 18.216, "learn_throughput": 14163.028, "synch_weights_time_ms": 10.076}, "counters": {"num_env_steps_sampled": 28672, "num_env_steps_trained": 7998, "num_agent_steps_sampled": 86016, "num_agent_steps_trained": 7998, "last_target_update_ts": 28672, "num_target_updates": 31}, "done": false, "episodes_total": 0, "training_iteration": 18, "trial_id": "cfa97_00000", "date": "2023-11-18_21-02-58", "timestamp": 1700370178, "time_this_iter_s": 1.859356164932251, "time_total_s": 31.67824077606201, "pid": 6770, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17f309da0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 31.67824077606201, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 65.06666666666666, "ram_util_percent": 64.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.102842330932617, "actor_loss": -5.140581130981445, "critic_loss": 2.07454252243042, "alpha_loss": -0.09706610441207886, "alpha_value": 0.9904382228851318, "log_alpha_value": -0.009607802145183086, "target_entropy": -6.0, "policy_t": 0.0031848447397351265, "mean_q": 1.241713285446167, "max_q": 8.531272888183594, "min_q": 1.04146146774292}, "td_error": [3.2512340545654297, 5.382380962371826, 3.556147813796997, 2.9530792236328125, 2.9337244033813477, 2.8732199668884277, 1.9435878992080688, 1.8551616668701172, 3.0973339080810547, 1.9663267135620117, 3.999753475189209, 4.141680717468262, 3.2438440322875977, 2.2846691608428955, 2.392928123474121, 3.681272268295288, 3.241701126098633, 4.557210922241211, 3.2467293739318848, 2.5883727073669434, 3.301607847213745, 2.403841257095337, 4.488153457641602, 5.222752571105957, 4.0078229904174805, 2.921006202697754, 2.9699530601501465, 4.694997787475586, 2.6968741416931152, 7.224214553833008, 0.6533771753311157, 4.999760627746582, 2.8141603469848633, 3.312053680419922, 1.8764383792877197, 5.3404693603515625, 5.23797607421875, 3.2959556579589844, 3.893702983856201, 4.824587821960449, 1.2380808591842651, 3.911227226257324, 2.5896477699279785, 3.3083248138427734, 2.984666347503662, 4.250075340270996, 4.688495635986328, 3.677356719970703, 4.519863128662109, 4.842489242553711, 3.2131025791168213, 2.865445613861084, 2.134296417236328, 3.4980151653289795, 0.23954272270202637, 3.448416233062744, 4.129547119140625, 4.614561557769775, 1.6638545989990234, 2.7365808486938477, 4.3574981689453125, 4.306369781494141, 4.591011047363281, 5.4835286140441895, 4.6043500900268555, 3.3005993366241455, 0.9417667388916016, 4.609373092651367, 3.299086570739746, 4.789506912231445, 2.398752450942993, 4.336597442626953, 2.8045949935913086, 6.438399314880371, 3.3823885917663574, 2.8154585361480713, 3.2260489463806152, 2.4669089317321777, 3.436652183532715, 3.6024093627929688, 2.578080177307129, 1.9182147979736328, 3.546783447265625, 3.858727216720581, 3.076139450073242, 2.495607376098633], "mean_td_error": 3.4487035274505615, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 33.0, "diff_num_grad_updates_vs_sampler_policy": 32.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0758638381958, "actor_loss": -5.004500865936279, "critic_loss": 0.5445911884307861, "alpha_loss": -0.09682422131299973, "alpha_value": 0.9904364943504333, "log_alpha_value": -0.009609519504010677, "target_entropy": -6.0, "policy_t": 0.015671981498599052, "mean_q": 1.187433123588562, "max_q": 6.954118251800537, "min_q": 0.8391602635383606}, "td_error": [1.7159547805786133, 2.9353322982788086, 1.166126012802124, 1.7873269319534302, 3.20880389213562, 0.4446123540401459, 4.029911994934082, 2.1613640785217285, 1.9111238718032837, 1.7366361618041992, 0.5978200435638428, 4.1385979652404785, 1.6760680675506592, 1.8674125671386719, 2.2939400672912598, 3.2730326652526855, 0.12868332862854004, 0.612217903137207, 1.8080543279647827, 1.8063251972198486, 2.136058807373047, 1.5910820960998535, 1.3737459182739258, 3.4349992275238037, 2.41304349899292, 1.9044439792633057, 2.626758098602295, 1.7155120372772217, 2.8866958618164062, 1.195447564125061, 2.7277894020080566, 1.0294768810272217, 1.9708433151245117, 2.751692295074463, 2.5745744705200195, 1.6488417387008667, 3.1246886253356934, 1.8876676559448242, 1.204134225845337, 2.901576519012451, 2.81888484954834, 2.285853385925293, 2.063260078430176, 3.243516206741333, 0.15240150690078735, 1.7921278476715088, 0.9737785458564758, 3.5003466606140137, 1.4164941310882568, 1.405009150505066, 0.897933840751648, 1.6506714820861816, 2.286214828491211, 0.8654285073280334, 0.08763352036476135, 3.743546485900879, 1.8402221202850342, 1.4821157455444336, 0.32793140411376953, 2.3670756816864014, 0.7996069192886353, 0.30637073516845703, 1.2780476808547974, 0.7980608940124512, 2.291271209716797, 2.3153719902038574, 2.5041322708129883, 0.5690196752548218, 1.6552398204803467, 2.2364068031311035, 2.334237575531006, 1.409231185913086, 2.7121551036834717, 3.4036221504211426, 2.5120949745178223, 2.8500266075134277, 2.0931003093719482, 0.5792136192321777, 0.3712868094444275, 1.7556356191635132, 1.0423481464385986, 2.9191689491271973, 1.0643779039382935, 2.69269061088562, 1.1079928874969482, 2.3388612270355225], "mean_td_error": 1.9016098976135254, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 33.0, "diff_num_grad_updates_vs_sampler_policy": 32.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.105016708374023, "actor_loss": -4.837103366851807, "critic_loss": 0.3967553973197937, "alpha_loss": -0.0970352292060852, "alpha_value": 0.9904432892799377, "log_alpha_value": -0.009602680802345276, "target_entropy": -6.0, "policy_t": 0.05970204621553421, "mean_q": 0.9561862349510193, "max_q": 6.219550132751465, "min_q": 0.7079492807388306}, "td_error": [1.356168270111084, 2.1406571865081787, 2.0355160236358643, 3.818068027496338, 3.2123641967773438, 1.520349383354187, 1.8664531707763672, 1.9118787050247192, 2.453540325164795, 2.2506022453308105, 3.824347496032715, 2.213425636291504, 3.9497671127319336, 2.2176036834716797, 3.3855671882629395, 2.301931381225586, 1.10054349899292, 4.115164756774902, 3.0402960777282715, 1.7950420379638672, 1.4226306676864624, 1.4195398092269897, 1.0724639892578125, 3.744534969329834, 1.0523626804351807, 2.273829221725464, 0.3668004274368286, 2.8895092010498047, 1.737760066986084, 0.39004209637641907, 3.199502468109131, 3.251455783843994, 1.4030344486236572, 2.9362168312072754, 3.6843152046203613, 1.2981593608856201, 2.9977169036865234, 0.6773646473884583, 0.934618353843689, 2.1024956703186035, 2.3001937866210938, 1.9421772956848145, 0.6998500227928162, 1.94693922996521, 2.6612963676452637, 2.5338540077209473, 1.2009025812149048, 1.862237811088562, 2.519139528274536, 2.4926252365112305, 1.973853588104248, 1.2388067245483398, 0.5825700759887695, 0.8797551393508911, 1.1868655681610107, 2.2694928646087646, 2.246396064758301, 0.5652240514755249, 2.0094876289367676, 2.7727532386779785, 1.8532578945159912, 2.883549213409424, 1.0429725646972656, 2.353910446166992, 3.447713613510132, 1.6153180599212646, 0.824194610118866, 1.5217021703720093, 1.21321702003479, 2.1150994300842285, 1.376894235610962, 1.5531079769134521, 1.2765276432037354, 2.7507572174072266, 2.155961751937866, 2.267683744430542, 3.5975394248962402, 2.31197452545166, 3.285919189453125, 4.185089111328125, 2.4579434394836426, 2.620452880859375, 0.676459789276123, 0.495267391204834, 1.3928358554840088, 3.2687511444091797], "mean_td_error": 2.090606451034546, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 33.0, "diff_num_grad_updates_vs_sampler_policy": 32.0}}, "num_env_steps_sampled": 30464, "num_env_steps_trained": 8514, "num_agent_steps_sampled": 91392, "num_agent_steps_trained": 8514, "last_target_update_ts": 30464, "num_target_updates": 33}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 91392, "num_agent_steps_trained": 8514, "num_env_steps_sampled": 30464, "num_env_steps_trained": 8514, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 947.7439981640769, "num_env_steps_trained_throughput_per_sec": 272.8994994713525, "timesteps_total": 30464, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 91392, "timers": {"training_iteration_time_ms": 990.154, "sample_time_ms": 697.598, "load_time_ms": 0.317, "load_throughput": 814244.117, "learn_time_ms": 18.022, "learn_throughput": 14316.205, "synch_weights_time_ms": 9.881}, "counters": {"num_env_steps_sampled": 30464, "num_env_steps_trained": 8514, "num_agent_steps_sampled": 91392, "num_agent_steps_trained": 8514, "last_target_update_ts": 30464, "num_target_updates": 33}, "done": false, "episodes_total": 0, "training_iteration": 19, "trial_id": "cfa97_00000", "date": "2023-11-18_21-03-00", "timestamp": 1700370180, "time_this_iter_s": 1.9002208709716797, "time_total_s": 33.57846164703369, "pid": 6770, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17f3099e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 33.57846164703369, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 68.5, "ram_util_percent": 64.65}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.099780082702637, "actor_loss": -5.191987037658691, "critic_loss": 1.9443707466125488, "alpha_loss": -0.10006727278232574, "alpha_value": 0.9901410341262817, "log_alpha_value": -0.009907866828143597, "target_entropy": -6.0, "policy_t": 0.019957266747951508, "mean_q": 1.513702392578125, "max_q": 7.949518203735352, "min_q": 1.1022621393203735}, "td_error": [4.239173412322998, 2.626556396484375, 3.861924171447754, 4.02646541595459, 2.271132469177246, 2.6550445556640625, 3.541665554046631, 4.250213623046875, 2.2510569095611572, 2.205711603164673, 3.8357644081115723, 4.836304664611816, 3.81976318359375, 4.77729606628418, 0.08312690258026123, 1.8781628608703613, 2.3342745304107666, 3.7482728958129883, 0.9071407318115234, 4.3369903564453125, 2.1101248264312744, 5.652111053466797, 2.5012683868408203, 3.519195556640625, 4.0130109786987305, 1.9338784217834473, 1.5576335191726685, 3.176727294921875, 2.7094852924346924, 4.31909704208374, 4.653666019439697, 1.9286502599716187, 4.554371356964111, 4.381174087524414, 3.738987922668457, 1.9428797960281372, 3.5422210693359375, 4.260830879211426, 3.6507339477539062, 4.714781284332275, 3.7720088958740234, 2.774378776550293, 2.9978814125061035, 2.6917576789855957, 5.064933776855469, 1.9107866287231445, 2.8890204429626465, 3.3524813652038574, 4.772387504577637, 3.111733913421631, 4.491240501403809, 3.133673667907715, 4.955859661102295, 3.370495319366455, 2.87585711479187, 2.162238597869873, 3.1462574005126953, 4.5224409103393555, 3.2229788303375244, 3.884337902069092, 4.887622833251953, 3.3711702823638916, 3.246981382369995, 3.2013182640075684, 3.846508741378784, 5.366886138916016, 4.578737258911133, 4.6558074951171875, 4.580906867980957, 4.222087860107422, 4.823212623596191, 5.410760879516602, 3.5554592609405518, 5.333821773529053, 1.9603267908096313, 2.2211899757385254, 4.377205848693848, 3.3120181560516357, 3.3712611198425293, 2.2094979286193848, 0.5351569652557373, 2.222614288330078, 3.9301469326019287, 2.811995506286621, 4.296720504760742, 3.140810489654541], "mean_td_error": 3.4409282207489014, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 34.0, "diff_num_grad_updates_vs_sampler_policy": 33.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.130794525146484, "actor_loss": -5.099493980407715, "critic_loss": 0.5042586326599121, "alpha_loss": -0.10039165616035461, "alpha_value": 0.990139365196228, "log_alpha_value": -0.009909553453326225, "target_entropy": -6.0, "policy_t": -0.03501275181770325, "mean_q": 1.062923550605774, "max_q": 7.0205793380737305, "min_q": 0.8903684020042419}, "td_error": [0.174353688955307, 3.9812746047973633, 3.3999671936035156, 1.7829129695892334, 0.38712120056152344, 0.9786608815193176, 3.4828004837036133, 3.4785354137420654, 1.5823917388916016, 1.96513032913208, 2.2588984966278076, 2.5833535194396973, 2.459500789642334, 1.611116647720337, 0.5352358222007751, 1.4945118427276611, 2.2963685989379883, 0.3667048215866089, 1.4439013004302979, 2.0840327739715576, 1.626603364944458, 2.4344637393951416, 0.744821310043335, 1.7800325155258179, 0.228826105594635, 1.0167906284332275, 1.0656719207763672, 3.4039459228515625, 4.795527935028076, 1.717453122138977, 2.1279501914978027, 1.2044041156768799, 1.6673110723495483, 2.6494414806365967, 0.8584140539169312, 3.381007432937622, 1.392202377319336, 2.0936272144317627, 1.1836822032928467, 1.5091341733932495, 1.3513410091400146, 0.7450008988380432, 2.407383441925049, 2.2083306312561035, 4.21573543548584, 2.690667152404785, 2.1236202716827393, 2.36039400100708, 2.647110939025879, 2.2828285694122314, 2.6757802963256836, 2.064523458480835, 1.648824691772461, 1.7027373313903809, 0.5790634155273438, 2.1642372608184814, 1.580436110496521, 0.9669719338417053, 0.5345302820205688, 2.2367300987243652, 0.8008995652198792, 2.1072263717651367, 2.5159082412719727, 1.5452784299850464, 1.0930413007736206, 1.0457732677459717, 1.9134613275527954, 2.207890510559082, 2.950716495513916, 2.504303455352783, 0.6189188957214355, 0.8997862935066223, 1.0660908222198486, 2.813189744949341, 0.7962979078292847, 0.667127251625061, 1.0376856327056885, 0.41390079259872437, 0.8131012320518494, 1.719130039215088, 1.9792165756225586, 2.5499401092529297, 0.5141186118125916, 2.751065492630005, 2.590785026550293, 0.9816129803657532], "mean_td_error": 1.8059394359588623, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 34.0, "diff_num_grad_updates_vs_sampler_policy": 33.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.08346176147461, "actor_loss": -4.863008499145508, "critic_loss": 0.3305736184120178, "alpha_loss": -0.09985814988613129, "alpha_value": 0.990145742893219, "log_alpha_value": -0.009903160855174065, "target_entropy": -6.0, "policy_t": 0.01328018493950367, "mean_q": 0.8809638023376465, "max_q": 5.232996940612793, "min_q": 0.7522643804550171}, "td_error": [2.081742286682129, 0.8878356218338013, 1.6466635465621948, 1.4417269229888916, 2.472505569458008, 1.3616137504577637, 0.2898167669773102, 3.756117820739746, 3.8190956115722656, 2.366118907928467, 0.937514066696167, 3.251154899597168, 1.8152191638946533, 1.1466293334960938, 2.019509792327881, 3.5557479858398438, 1.2298078536987305, 2.122553586959839, 0.843603253364563, 3.85778546333313, 1.309354543685913, 2.9800455570220947, 3.358276128768921, 1.1753278970718384, 3.068873405456543, 1.8351609706878662, 2.9807186126708984, 0.26189401745796204, 0.8697118759155273, 0.23003816604614258, 2.3859496116638184, 1.7473454475402832, 0.899535059928894, 1.1994245052337646, 0.02451077103614807, 1.9051334857940674, 2.071896553039551, 0.03864067792892456, 4.180863380432129, 1.996472716331482, 0.8617220520973206, 1.6567668914794922, 0.3281559646129608, 1.015813946723938, 0.6676197052001953, 1.1553146839141846, 0.9300277829170227, 1.2744390964508057, 0.7115442752838135, 2.4349632263183594, 0.0841681957244873, 1.5897563695907593, 2.2732949256896973, 2.0129294395446777, 0.7473188638687134, 1.6600102186203003, 1.589080810546875, 1.9996676445007324, 1.0378470420837402, 0.899928092956543, 2.65677547454834, 1.569469690322876, 1.5599994659423828, 1.2644944190979004, 1.6258180141448975, 3.566718578338623, 1.8285659551620483, 1.6622378826141357, 2.2072606086730957, 0.7488998770713806, 2.33516263961792, 2.544804573059082, 1.9207179546356201, 2.3761839866638184, 2.9587044715881348, 3.936164617538452, 2.3647730350494385, 2.568608522415161, 2.456887722015381, 2.1727004051208496, 1.5932165384292603, 1.7709808349609375, 3.029096841812134, 2.1242191791534424, 1.5801063776016235, 0.8251855373382568], "mean_td_error": 1.8093029260635376, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 34.0, "diff_num_grad_updates_vs_sampler_policy": 33.0}}, "num_env_steps_sampled": 31360, "num_env_steps_trained": 8772, "num_agent_steps_sampled": 94080, "num_agent_steps_trained": 8772, "last_target_update_ts": 31360, "num_target_updates": 34}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 94080, "num_agent_steps_trained": 8772, "num_env_steps_sampled": 31360, "num_env_steps_trained": 8772, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 889.5399563147196, "num_env_steps_trained_throughput_per_sec": 256.1398534924081, "timesteps_total": 31360, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 94080, "timers": {"training_iteration_time_ms": 985.362, "sample_time_ms": 692.63, "load_time_ms": 0.317, "load_throughput": 814121.601, "learn_time_ms": 18.126, "learn_throughput": 14234.082, "synch_weights_time_ms": 10.015}, "counters": {"num_env_steps_sampled": 31360, "num_env_steps_trained": 8772, "num_agent_steps_sampled": 94080, "num_agent_steps_trained": 8772, "last_target_update_ts": 31360, "num_target_updates": 34}, "done": false, "episodes_total": 0, "training_iteration": 20, "trial_id": "cfa97_00000", "date": "2023-11-18_21-03-01", "timestamp": 1700370181, "time_this_iter_s": 1.0165791511535645, "time_total_s": 34.595040798187256, "pid": 6770, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17f3082c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 34.595040798187256, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 72.65, "ram_util_percent": 64.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.113953590393066, "actor_loss": -5.262080192565918, "critic_loss": 1.5431084632873535, "alpha_loss": -0.10324279963970184, "alpha_value": 0.9898439645767212, "log_alpha_value": -0.010207956656813622, "target_entropy": -6.0, "policy_t": 0.02817874774336815, "mean_q": 1.4412457942962646, "max_q": 9.83932876586914, "min_q": 1.1646640300750732}, "td_error": [3.271947145462036, 3.805428981781006, 4.419747352600098, 2.5991382598876953, 3.6096105575561523, 3.897343397140503, 1.3874685764312744, 4.681384563446045, 2.600092887878418, 3.366004705429077, 3.70833683013916, 3.8108973503112793, 3.165241241455078, 3.2239291667938232, 3.8981523513793945, 5.527763843536377, 4.659575462341309, 0.1275498867034912, 3.6396169662475586, 4.352433204650879, 2.1619467735290527, 2.599393367767334, 4.468555927276611, 3.8740487098693848, 6.731085300445557, 3.103644609451294, 2.5752594470977783, 1.8606348037719727, 3.9927852153778076, 2.5851287841796875, 3.5054738521575928, 0.501492977142334, 1.0393106937408447, 5.327948570251465, 5.789824485778809, 3.6949498653411865, 4.676503658294678, 2.3314099311828613, 4.244617462158203, 4.061408996582031, 3.5337274074554443, 2.9922423362731934, 4.161293029785156, 2.7674784660339355, 4.67396879196167, 3.3879241943359375, 3.533867120742798, 3.892076015472412, 2.5713701248168945, 5.146753311157227, 4.828006744384766, 1.509130597114563, 3.3447299003601074, 5.000720977783203, 2.2496023178100586, 1.7400691509246826, 1.8538451194763184, 1.8959981203079224, 3.0878264904022217, 2.694423198699951, 4.111123085021973, 5.164931297302246, 2.247086524963379, 4.139211177825928, 2.9285547733306885, 2.900759220123291, 4.795316696166992, 3.6131787300109863, 1.6897022724151611, 4.973808765411377, 4.3557820320129395, 3.8416645526885986, 3.3029065132141113, 2.639434814453125, 2.736142158508301, 4.066158771514893, 4.520416259765625, 4.076119422912598, 4.7782673835754395, 3.673471450805664, 4.023301601409912, 3.189213514328003, 2.2219326496124268, 2.1171815395355225, 3.757662773132324, 3.4674816131591797], "mean_td_error": 3.454336404800415, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 35.0, "diff_num_grad_updates_vs_sampler_policy": 34.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.113617897033691, "actor_loss": -5.138189792633057, "critic_loss": 0.5075422525405884, "alpha_loss": -0.10325682163238525, "alpha_value": 0.9898422360420227, "log_alpha_value": -0.01020968146622181, "target_entropy": -6.0, "policy_t": -0.046879809349775314, "mean_q": 1.3764832019805908, "max_q": 6.4745283126831055, "min_q": 0.9437210559844971}, "td_error": [0.5857206583023071, 2.7969515323638916, 1.186060905456543, 0.7287967205047607, 1.5593347549438477, 0.8619743585586548, 2.524397373199463, 3.710014820098877, 1.1681246757507324, 3.5730977058410645, 0.3095604181289673, 1.5233842134475708, 0.35267502069473267, 0.8003501296043396, 0.4582076072692871, 0.10644611716270447, 2.671736001968384, 2.4908978939056396, 1.0995887517929077, 1.598846435546875, 2.826826572418213, 2.6414384841918945, 3.1793365478515625, 2.8336760997772217, 2.0425472259521484, 2.216885566711426, 3.0452194213867188, 3.2804532051086426, 2.0233852863311768, 2.717677593231201, 0.9358700513839722, 2.9346749782562256, 0.4661998450756073, 1.6519343852996826, 0.591171383857727, 0.6341775059700012, 0.9875290393829346, 1.8183300495147705, 0.26008546352386475, 0.2824888229370117, 0.5825866460800171, 2.283994674682617, 0.5244539976119995, 2.7580671310424805, 3.094999313354492, 2.345590829849243, 1.8430129289627075, 0.38446158170700073, 1.9725780487060547, 3.0350937843322754, 2.401087760925293, 0.7253028154373169, 2.0532033443450928, 0.1017584502696991, 1.1569786071777344, 2.5253779888153076, 2.204808235168457, 3.6137499809265137, 0.9374656677246094, 2.586862087249756, 0.4093206822872162, 0.24902266263961792, 2.4472808837890625, 1.5596938133239746, 2.519408941268921, 2.61513614654541, 1.8439511060714722, 0.9321337938308716, 2.521613121032715, 4.048863410949707, 1.7046053409576416, 1.7072975635528564, 1.0624377727508545, 1.029038667678833, 1.3610918521881104, 3.1870250701904297, 3.9662399291992188, 1.5349147319793701, 2.883077383041382, 2.0498671531677246, 1.3784128427505493, 1.7353529930114746, 3.111473560333252, 1.4799442291259766, 1.3706090450286865, 0.5617079734802246], "mean_td_error": 1.789267659187317, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 35.0, "diff_num_grad_updates_vs_sampler_policy": 34.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.129555702209473, "actor_loss": -4.954082012176514, "critic_loss": 0.37931668758392334, "alpha_loss": -0.10335785895586014, "alpha_value": 0.9898483157157898, "log_alpha_value": -0.010203592479228973, "target_entropy": -6.0, "policy_t": 0.016295064240694046, "mean_q": 1.126119613647461, "max_q": 5.874753952026367, "min_q": 0.7989140748977661}, "td_error": [0.3199346661567688, 3.8353655338287354, 2.197092056274414, 1.5680118799209595, 0.46604859828948975, 2.104630470275879, 2.238234043121338, 0.3604569137096405, 2.6305127143859863, 3.0151116847991943, 1.1958240270614624, 2.9343786239624023, 1.7028381824493408, 1.0207955837249756, 1.1811386346817017, 1.2748675346374512, 3.2221832275390625, 1.4028838872909546, 3.09570574760437, 2.9870424270629883, 1.1530351638793945, 0.8659443259239197, 5.114272117614746, 1.0634891986846924, 3.978358745574951, 1.847707748413086, 1.6752028465270996, 3.3180813789367676, 2.6858561038970947, 2.4135565757751465, 0.5428836345672607, 3.2121920585632324, 0.8289645910263062, 1.2148287296295166, 1.1067051887512207, 1.9017243385314941, 1.489068865776062, 0.9450986385345459, 2.331331729888916, 1.4001691341400146, 3.285381317138672, 1.9500133991241455, 1.3168811798095703, 2.0220274925231934, 3.26035213470459, 0.7579465508460999, 1.2519254684448242, 1.9443016052246094, 0.5205199718475342, 1.6484951972961426, 1.8010640144348145, 2.069333791732788, 3.0154366493225098, 1.8217509984970093, 2.2608642578125, 3.3731331825256348, 1.0234557390213013, 0.7652995586395264, 4.73382568359375, 0.561826765537262, 0.5003399848937988, 0.12103235721588135, 3.340132474899292, 1.0266742706298828, 3.9765255451202393, 1.8999929428100586, 1.0340518951416016, 3.874976634979248, 0.2313956320285797, 3.3084139823913574, 3.1578049659729004, 0.3428367078304291, 0.46411001682281494, 3.7393805980682373, 3.1225054264068604, 3.940560817718506, 1.0309174060821533, 3.556654214859009, 1.5739376544952393, 1.063910961151123, 2.2025914192199707, 1.9123878479003906, 2.411776065826416, 0.6721118688583374, 2.5009803771972656, 1.5446548461914062], "mean_td_error": 1.97413969039917, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 35.0, "diff_num_grad_updates_vs_sampler_policy": 34.0}}, "num_env_steps_sampled": 32256, "num_env_steps_trained": 9030, "num_agent_steps_sampled": 96768, "num_agent_steps_trained": 9030, "last_target_update_ts": 32256, "num_target_updates": 35}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96768, "num_agent_steps_trained": 9030, "num_env_steps_sampled": 32256, "num_env_steps_trained": 9030, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 795.9060355153899, "num_env_steps_trained_throughput_per_sec": 229.1783004051011, "timesteps_total": 32256, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 96768, "timers": {"training_iteration_time_ms": 985.095, "sample_time_ms": 710.465, "load_time_ms": 0.32, "load_throughput": 807439.511, "learn_time_ms": 18.196, "learn_throughput": 14178.839, "synch_weights_time_ms": 10.197}, "counters": {"num_env_steps_sampled": 32256, "num_env_steps_trained": 9030, "num_agent_steps_sampled": 96768, "num_agent_steps_trained": 9030, "last_target_update_ts": 32256, "num_target_updates": 35}, "done": false, "episodes_total": 0, "training_iteration": 21, "trial_id": "cfa97_00000", "date": "2023-11-18_21-03-02", "timestamp": 1700370182, "time_this_iter_s": 1.1347990036010742, "time_total_s": 35.72983980178833, "pid": 6770, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17f30a840>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 35.72983980178833, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 65.15, "ram_util_percent": 64.85}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.131235122680664, "actor_loss": -5.392423629760742, "critic_loss": 1.568162202835083, "alpha_loss": -0.10950150340795517, "alpha_value": 0.9892498850822449, "log_alpha_value": -0.010808308608829975, "target_entropy": -6.0, "policy_t": 0.03408222645521164, "mean_q": 1.5955225229263306, "max_q": 10.344907760620117, "min_q": 1.2946630716323853}, "td_error": [3.90847110748291, 4.099842071533203, 2.56479811668396, 2.870131015777588, 4.068427085876465, 3.2177109718322754, 4.014209747314453, 3.1986312866210938, 3.6027631759643555, 4.083349227905273, 3.698150634765625, 2.8671305179595947, 1.0411763191223145, 3.186445713043213, 2.313448905944824, 3.422708749771118, 2.816108226776123, 2.758545398712158, 4.241241455078125, 3.127106189727783, 3.674095869064331, 3.4634828567504883, 4.539674758911133, 5.040713787078857, 3.4144439697265625, 4.935585021972656, 4.527507781982422, 2.6567959785461426, 4.182617664337158, 3.1272640228271484, 2.6413822174072266, 4.501638889312744, 4.272690296173096, 4.029277324676514, 6.733913421630859, 1.9996075630187988, 4.608515739440918, 3.037403106689453, 5.407708644866943, 3.000403881072998, 3.1249265670776367, 3.7532706260681152, 4.4681243896484375, 4.962307453155518, 1.977055549621582, 1.2449134588241577, 3.2905454635620117, 3.8317415714263916, 2.9772536754608154, 4.706843376159668, 1.6635373830795288, 4.311307907104492, 3.505917549133301, 2.8524169921875, 3.4922034740448, 3.8807005882263184, 3.2262730598449707, 2.14652681350708, 3.988043785095215, 4.985500335693359, 3.3705899715423584, 1.4421253204345703, 4.816205978393555, 3.506798267364502, 3.545609951019287, 4.1955060958862305, 0.5806838274002075, 2.5306179523468018, 3.781899929046631, 5.036853313446045, 3.9409823417663574, 3.5591225624084473, 4.615839958190918, 3.948436737060547, 1.2066068649291992, 2.9416353702545166, 2.751506805419922, 4.0161285400390625, 3.718181610107422, 2.98358154296875, 2.5132529735565186, 2.718546152114868, 3.3880395889282227, 5.7726287841796875, 4.046799659729004, 4.210513591766357], "mean_td_error": 3.5165491104125977, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 37.0, "diff_num_grad_updates_vs_sampler_policy": 36.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.123567581176758, "actor_loss": -5.230835437774658, "critic_loss": 0.4882493019104004, "alpha_loss": -0.10943526774644852, "alpha_value": 0.9892482757568359, "log_alpha_value": -0.010809951461851597, "target_entropy": -6.0, "policy_t": -0.01355202030390501, "mean_q": 1.3345141410827637, "max_q": 6.980503082275391, "min_q": 1.0473098754882812}, "td_error": [4.329039096832275, 3.6677098274230957, 0.8838118314743042, 1.0267002582550049, 2.5793867111206055, 1.4591749906539917, 0.34003162384033203, 0.5128065943717957, 2.3813657760620117, 1.8948627710342407, 5.448108673095703, 2.862694501876831, 0.1405339241027832, 1.3611750602722168, 1.0912703275680542, 0.48913073539733887, 0.30308783054351807, 1.5477638244628906, 2.406677484512329, 2.1993789672851562, 2.5987915992736816, 0.13932830095291138, 1.0939686298370361, 1.1151869297027588, 2.4814724922180176, 2.1359198093414307, 1.144517183303833, 1.163787841796875, 1.0305910110473633, 0.07126545906066895, 1.5465097427368164, 1.2933391332626343, 1.9078136682510376, 2.0346240997314453, 0.24293667078018188, 0.8667404651641846, 0.399364173412323, 2.666476011276245, 2.222301483154297, 3.416116237640381, 0.14682656526565552, 1.029552936553955, 3.345214366912842, 2.5490822792053223, 2.8546180725097656, 1.6795223951339722, 1.4432487487792969, 1.758328914642334, 2.632838249206543, 1.0025498867034912, 2.647054672241211, 4.781038284301758, 0.5301310420036316, 1.4134248495101929, 1.0100970268249512, 3.1657750606536865, 1.624086618423462, 1.4821069240570068, 1.686974287033081, 2.482758045196533, 3.55329966545105, 1.8460404872894287, 2.254302740097046, 0.830036997795105, 1.5788897275924683, 1.8419439792633057, 2.8848819732666016, 1.7054219245910645, 0.2685362696647644, 0.29934626817703247, 1.5566530227661133, 0.4922032952308655, 1.9067821502685547, 1.7866463661193848, 4.3597002029418945, 0.5729622840881348, 2.793208599090576, 0.4951944351196289, 0.46376097202301025, 2.4956464767456055, 0.5099549293518066, 0.6849493980407715, 2.7442097663879395, 2.2308499813079834, 2.9881978034973145, 0.312502920627594], "mean_td_error": 1.735082745552063, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 37.0, "diff_num_grad_updates_vs_sampler_policy": 36.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.105619430541992, "actor_loss": -5.020040988922119, "critic_loss": 0.3631051480770111, "alpha_loss": -0.10918842256069183, "alpha_value": 0.9892534613609314, "log_alpha_value": -0.010804724879562855, "target_entropy": -6.0, "policy_t": 0.036500830203294754, "mean_q": 1.0520578622817993, "max_q": 6.538227081298828, "min_q": 0.8945281505584717}, "td_error": [2.562619209289551, 2.2348971366882324, 2.14158296585083, 1.626255989074707, 2.5829172134399414, 1.4721673727035522, 2.030259847640991, 2.4400086402893066, 0.2457616627216339, 2.9884872436523438, 2.6475939750671387, 1.5365052223205566, 2.125166416168213, 1.0747071504592896, 2.712972640991211, 1.8637173175811768, 1.681447982788086, 2.065427303314209, 1.6549805402755737, 0.7857475280761719, 1.9342637062072754, 3.2495946884155273, 0.47231394052505493, 1.9705350399017334, 1.7173726558685303, 1.2456883192062378, 3.125556468963623, 3.9298763275146484, 2.746887445449829, 1.3039162158966064, 4.907528400421143, 1.9201401472091675, 1.2535240650177002, 1.0206458568572998, 1.2765012979507446, 3.045595169067383, 2.614539623260498, 2.914316177368164, 1.8865752220153809, 0.7160231471061707, 2.5322375297546387, 0.8493459224700928, 1.9719209671020508, 3.281311273574829, 2.8963615894317627, 4.439826011657715, 1.9276834726333618, 2.8171138763427734, 1.2133827209472656, 1.9380356073379517, 0.6006892919540405, 2.9586544036865234, 1.1382567882537842, 1.0249900817871094, 2.8607211112976074, 0.8413379192352295, 1.1387234926223755, 2.2750706672668457, 2.8470778465270996, 3.406534194946289, 2.023764133453369, 1.2033820152282715, 2.2964210510253906, 2.784193515777588, 1.5374548435211182, 1.146796464920044, 0.19209346175193787, 2.5262739658355713, 1.6843143701553345, 1.2538020610809326, 2.5538864135742188, 2.763784170150757, 0.23504921793937683, 1.278096318244934, 1.003412127494812, 0.7613503932952881, 1.342315673828125, 4.047301769256592, 2.836651563644409, 0.6623727083206177, 2.467594861984253, 2.498473644256592, 0.9670889377593994, 0.6913985013961792, 0.06732448935508728, 1.3449413776397705], "mean_td_error": 1.940156102180481, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 37.0, "diff_num_grad_updates_vs_sampler_policy": 36.0}}, "num_env_steps_sampled": 34048, "num_env_steps_trained": 9546, "num_agent_steps_sampled": 102144, "num_agent_steps_trained": 9546, "last_target_update_ts": 34048, "num_target_updates": 37}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 102144, "num_agent_steps_trained": 9546, "num_env_steps_sampled": 34048, "num_env_steps_trained": 9546, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 843.0771265671287, "num_env_steps_trained_throughput_per_sec": 242.76104760526695, "timesteps_total": 34048, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 102144, "timers": {"training_iteration_time_ms": 1001.268, "sample_time_ms": 704.781, "load_time_ms": 0.322, "load_throughput": 801875.089, "learn_time_ms": 18.221, "learn_throughput": 14159.711, "synch_weights_time_ms": 10.217}, "counters": {"num_env_steps_sampled": 34048, "num_env_steps_trained": 9546, "num_agent_steps_sampled": 102144, "num_agent_steps_trained": 9546, "last_target_update_ts": 34048, "num_target_updates": 37}, "done": false, "episodes_total": 0, "training_iteration": 22, "trial_id": "cfa97_00000", "date": "2023-11-18_21-03-04", "timestamp": 1700370184, "time_this_iter_s": 2.1346890926361084, "time_total_s": 37.86452889442444, "pid": 6770, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17f28ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 37.86452889442444, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 64.0, "ram_util_percent": 64.63333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.125177383422852, "actor_loss": -5.511895656585693, "critic_loss": 1.54697585105896, "alpha_loss": -0.11551670730113983, "alpha_value": 0.9886559844017029, "log_alpha_value": -0.011408858001232147, "target_entropy": -6.0, "policy_t": -0.0004763612523674965, "mean_q": 1.7046246528625488, "max_q": 10.77231216430664, "min_q": 1.4289844036102295}, "td_error": [3.8466637134552, 3.973479747772217, 3.073202610015869, 3.4015262126922607, 3.7845354080200195, 2.716193914413452, 3.1384329795837402, 1.8953778743743896, 4.375147819519043, 3.566413640975952, 2.3296031951904297, 3.483187437057495, 3.378499984741211, 1.6604514122009277, 3.8668789863586426, 4.791731834411621, 3.4438705444335938, 3.2688608169555664, 2.3321335315704346, 4.018856048583984, 3.2706961631774902, 2.44675350189209, 3.2287142276763916, 2.4248595237731934, 1.7257463932037354, 3.040935516357422, 2.540921211242676, 1.6226568222045898, 2.651876926422119, 2.605652093887329, 4.9328508377075195, 3.0591511726379395, 2.7570438385009766, 4.160362720489502, 4.491062641143799, 2.6606202125549316, 5.205395698547363, 6.100451469421387, 2.034766674041748, 4.405059814453125, 3.667207956314087, 1.9198325872421265, 5.639162063598633, 3.319027900695801, 3.2382547855377197, 3.172430992126465, 4.786318778991699, 3.029049873352051, 3.617159843444824, 4.476620197296143, 1.3308966159820557, 3.54872989654541, 3.261791706085205, 2.9681310653686523, 3.0682709217071533, 2.38869571685791, 2.743947982788086, 4.175100326538086, 3.6561765670776367, 3.823997974395752, 3.808398962020874, 2.876570224761963, 1.7470836639404297, 3.361621856689453, 3.9001173973083496, 2.600611686706543, 2.8957862854003906, 3.43967866897583, 3.7848713397979736, 4.2374138832092285, 4.171796798706055, 2.3230020999908447, 2.8481955528259277, 3.435570240020752, 4.423449516296387, 2.203770160675049, 4.2084760665893555, 2.953193187713623, 3.613417387008667, 4.059186935424805, 6.488941669464111, 1.8900717496871948, 4.893403053283691, 3.7932586669921875, 4.019357681274414, 4.571628570556641], "mean_td_error": 3.3963987827301025, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 39.0, "diff_num_grad_updates_vs_sampler_policy": 38.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.070096015930176, "actor_loss": -5.325690746307373, "critic_loss": 0.41445958614349365, "alpha_loss": -0.11490368098020554, "alpha_value": 0.9886544942855835, "log_alpha_value": -0.01141038816422224, "target_entropy": -6.0, "policy_t": 0.009032182395458221, "mean_q": 1.2950729131698608, "max_q": 4.5531463623046875, "min_q": 1.1565169095993042}, "td_error": [0.21265995502471924, 0.6306278109550476, 1.0042269229888916, 0.6358195543289185, 0.6578115820884705, 3.27980637550354, 2.917752504348755, 0.07638049125671387, 0.5030180215835571, 0.6652379631996155, 0.9507511258125305, 2.166606903076172, 1.1953237056732178, 0.9677494764328003, 0.746949315071106, 0.6521481871604919, 0.236172616481781, 2.3864965438842773, 2.2517220973968506, 1.5207476615905762, 0.887632429599762, 2.467418670654297, 0.9568756222724915, 1.3606269359588623, 3.5562973022460938, 1.720644474029541, 1.2940895557403564, 0.9761757850646973, 1.8164048194885254, 0.5832552909851074, 1.502817988395691, 2.6682839393615723, 1.0214109420776367, 1.8859634399414062, 0.7591654062271118, 0.567040205001831, 0.6374117136001587, 2.048292636871338, 2.386340618133545, 1.5007139444351196, 1.6823253631591797, 0.38350456953048706, 0.08420246839523315, 2.401484489440918, 0.3938995599746704, 2.398639678955078, 1.8129208087921143, 2.0525667667388916, 1.149209976196289, 2.6832919120788574, 1.7380362749099731, 1.8707048892974854, 1.6465632915496826, 2.0349879264831543, 2.3024380207061768, 2.365811347961426, 3.7022643089294434, 1.6269035339355469, 0.3447761535644531, 1.0192785263061523, 1.9296342134475708, 0.9468673467636108, 3.684133529663086, 0.5297248363494873, 1.0813171863555908, 0.12560641765594482, 1.5119662284851074, 3.9900155067443848, 0.8298997282981873, 3.0019478797912598, 0.9173280000686646, 3.5011837482452393, 2.4236631393432617, 1.8234786987304688, 4.20596981048584, 2.026594638824463, 0.33953678607940674, 2.487093925476074, 0.8635019063949585, 0.7166904211044312, 1.308590054512024, 0.7339717745780945, 1.671431541442871, 1.9597342014312744, 1.0726299285888672, 1.6856608390808105], "mean_td_error": 1.5501959323883057, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 39.0, "diff_num_grad_updates_vs_sampler_policy": 38.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.115806579589844, "actor_loss": -5.126883506774902, "critic_loss": 0.3191549479961395, "alpha_loss": -0.11538075655698776, "alpha_value": 0.9886587858200073, "log_alpha_value": -0.011405985802412033, "target_entropy": -6.0, "policy_t": 0.027627866715192795, "mean_q": 1.183013677597046, "max_q": 6.62030029296875, "min_q": 0.9981433153152466}, "td_error": [3.3610029220581055, 1.2385578155517578, 0.35144472122192383, 0.49708351492881775, 2.1755881309509277, 3.705475330352783, 2.8995327949523926, 1.8210700750350952, 1.137561321258545, 0.14577782154083252, 4.378683090209961, 0.1480940580368042, 2.354719400405884, 2.7991273403167725, 1.1778063774108887, 2.6445188522338867, 0.6149399280548096, 1.3099451065063477, 2.5548291206359863, 0.07511812448501587, 0.7533566355705261, 0.8189128637313843, 1.8910913467407227, 0.1703556478023529, 0.6981701850891113, 3.50089693069458, 2.147526741027832, 0.6300917863845825, 0.7699503302574158, 0.5238560438156128, 2.1793212890625, 2.986959457397461, 2.611140251159668, 1.3246194124221802, 0.16734838485717773, 0.43890082836151123, 1.8878592252731323, 1.3655110597610474, 1.7084040641784668, 3.371943950653076, 1.0358844995498657, 2.7992477416992188, 1.161285400390625, 0.7690457701683044, 3.266834020614624, 1.3117667436599731, 1.6479105949401855, 3.08475399017334, 0.3269527554512024, 1.8208372592926025, 0.03818029165267944, 1.735620379447937, 3.5528368949890137, 1.6509989500045776, 0.22756242752075195, 1.6181254386901855, 0.9039855003356934, 2.6257057189941406, 3.0079822540283203, 1.8706064224243164, 1.6420763731002808, 0.9391922950744629, 1.5819711685180664, 1.032348871231079, 1.9836952686309814, 3.419943332672119, 1.049882173538208, 1.9478381872177124, 1.9271661043167114, 4.85549259185791, 1.3446418046951294, 1.1672736406326294, 1.8826537132263184, 2.896249294281006, 1.299025297164917, 1.4171284437179565, 1.9385912418365479, 1.5660370588302612, 3.081414222717285, 1.3680065870285034, 0.0716063380241394, 0.8278518319129944, 3.0172455310821533, 1.2593483924865723, 3.891150712966919, 0.9566766619682312], "mean_td_error": 1.7227641344070435, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 39.0, "diff_num_grad_updates_vs_sampler_policy": 38.0}}, "num_env_steps_sampled": 35840, "num_env_steps_trained": 10062, "num_agent_steps_sampled": 107520, "num_agent_steps_trained": 10062, "last_target_update_ts": 35840, "num_target_updates": 39}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 107520, "num_agent_steps_trained": 10062, "num_env_steps_sampled": 35840, "num_env_steps_trained": 10062, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 940.6383997643208, "num_env_steps_trained_throughput_per_sec": 270.8534677892799, "timesteps_total": 35840, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 107520, "timers": {"training_iteration_time_ms": 990.564, "sample_time_ms": 692.654, "load_time_ms": 0.316, "load_throughput": 815286.998, "learn_time_ms": 18.287, "learn_throughput": 14108.132, "synch_weights_time_ms": 10.288}, "counters": {"num_env_steps_sampled": 35840, "num_env_steps_trained": 10062, "num_agent_steps_sampled": 107520, "num_agent_steps_trained": 10062, "last_target_update_ts": 35840, "num_target_updates": 39}, "done": false, "episodes_total": 0, "training_iteration": 23, "trial_id": "cfa97_00000", "date": "2023-11-18_21-03-06", "timestamp": 1700370186, "time_this_iter_s": 1.9141340255737305, "time_total_s": 39.77866291999817, "pid": 6770, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17f28e160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 39.77866291999817, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 70.95, "ram_util_percent": 64.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.09603500366211, "actor_loss": -5.594229698181152, "critic_loss": 1.46159029006958, "alpha_loss": -0.12124864757061005, "alpha_value": 0.98806232213974, "log_alpha_value": -0.012009529396891594, "target_entropy": -6.0, "policy_t": 0.03479139506816864, "mean_q": 1.8331749439239502, "max_q": 10.188657760620117, "min_q": 1.569162368774414}, "td_error": [3.018679618835449, 3.01481294631958, 3.487051010131836, 2.6652746200561523, 2.7772037982940674, 3.2646126747131348, 2.1109466552734375, 2.1537890434265137, 1.7189316749572754, 1.5168824195861816, 1.7614058256149292, 2.692948341369629, 4.972466468811035, 2.3214378356933594, 3.2595810890197754, 1.9715880155563354, 4.8294854164123535, 2.656550645828247, 4.252586364746094, 4.1486334800720215, 1.1412999629974365, 2.0663106441497803, 4.108593940734863, 2.7399067878723145, 5.265347480773926, 2.904956817626953, 4.511702537536621, 4.868227958679199, 1.4813650846481323, 3.592392683029175, 1.520646333694458, 3.6642160415649414, 4.167198181152344, 2.7548084259033203, 3.3364195823669434, 1.8311033248901367, 5.2863545417785645, 4.461343288421631, 4.152036666870117, 3.6489481925964355, 2.5710129737854004, 4.238358974456787, 1.8939716815948486, 1.7786188125610352, 3.48673152923584, 3.2250118255615234, 5.293992042541504, 5.051520347595215, 4.1783294677734375, 4.667394161224365, 1.8499805927276611, 3.5088448524475098, 2.7725696563720703, 3.4822640419006348, 2.238056182861328, 4.747807025909424, 3.2471234798431396, 3.605480194091797, 0.7672391533851624, 1.2853131294250488, 0.739048957824707, 5.318344593048096, 2.6495628356933594, 3.75331974029541, 2.2605624198913574, 3.4711289405822754, 0.6424245834350586, 3.077178716659546, 6.8414106369018555, 3.6967105865478516, 4.519455909729004, 3.969421863555908, 5.429647922515869, 2.9143142700195312, 4.846785545349121, 3.3141236305236816, 3.3113274574279785, 1.8866420984268188, 2.506732225418091, 2.178015947341919, 2.818289279937744, 4.616286277770996, 5.2259368896484375, 3.6216182708740234, 3.751868963241577, 3.4507102966308594], "mean_td_error": 3.265099048614502, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 41.0, "diff_num_grad_updates_vs_sampler_policy": 40.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.057401657104492, "actor_loss": -5.441719055175781, "critic_loss": 0.3818855881690979, "alpha_loss": -0.1207963228225708, "alpha_value": 0.9880611300468445, "log_alpha_value": -0.01201068889349699, "target_entropy": -6.0, "policy_t": -0.04182741791009903, "mean_q": 1.3824948072433472, "max_q": 5.684399127960205, "min_q": 1.2783915996551514}, "td_error": [1.6500251293182373, 1.4744091033935547, 1.9548547267913818, 0.14929932355880737, 1.555786371231079, 0.6320378184318542, 1.7460989952087402, 3.926069736480713, 0.901086688041687, 0.7255913615226746, 1.2396591901779175, 2.3156497478485107, 0.3220820426940918, 0.6443350911140442, 1.2979880571365356, 0.5265390276908875, 2.7980847358703613, 1.5611371994018555, 0.7085493803024292, 1.6743863821029663, 3.484161376953125, 1.8170524835586548, 0.9116067886352539, 1.9876842498779297, 1.840470790863037, 2.2434825897216797, 0.2647557258605957, 0.27563852071762085, 0.3252934217453003, 1.203853964805603, 1.6548866033554077, 2.1088085174560547, 1.3828686475753784, 0.09394121170043945, 0.9398941397666931, 3.464905261993408, 0.6058800220489502, 1.0805015563964844, 1.397263765335083, 1.5623886585235596, 1.5281885862350464, 1.0395162105560303, 1.2211546897888184, 3.7672128677368164, 1.0056169033050537, 3.128652572631836, 0.3993636965751648, 1.232075572013855, 0.9251950979232788, 0.08947360515594482, 0.4415156841278076, 3.0688042640686035, 0.9430019855499268, 1.9971004724502563, 2.0474295616149902, 0.917575478553772, 1.8222105503082275, 3.8264012336730957, 2.00114107131958, 2.67645263671875, 2.4012532234191895, 1.0423858165740967, 1.9911874532699585, 0.2604610323905945, 1.916837215423584, 2.664823532104492, 0.47758424282073975, 1.898293375968933, 0.6124022006988525, 1.2342073917388916, 1.2891030311584473, 1.77394700050354, 0.8364431262016296, 1.317948341369629, 1.9469819068908691, 0.8137342929840088, 0.6190978288650513, 1.1220052242279053, 0.5016283392906189, 1.413774013519287, 2.211601734161377, 1.1687730550765991, 1.4669709205627441, 0.3580099940299988, 1.7712550163269043, 0.676723062992096], "mean_td_error": 1.445517659187317, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 41.0, "diff_num_grad_updates_vs_sampler_policy": 40.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.159697532653809, "actor_loss": -5.272634983062744, "critic_loss": 0.2344658374786377, "alpha_loss": -0.121989905834198, "alpha_value": 0.9880645871162415, "log_alpha_value": -0.01200723834335804, "target_entropy": -6.0, "policy_t": -0.003173578530550003, "mean_q": 1.4146761894226074, "max_q": 6.697228908538818, "min_q": 1.110845923423767}, "td_error": [3.4650580883026123, 1.8577715158462524, 0.894098699092865, 2.2773935794830322, 2.077620506286621, 2.0293359756469727, 0.9284001588821411, 2.2077088356018066, 0.38362324237823486, 0.06043463945388794, 0.11535793542861938, 0.11355012655258179, 0.527853786945343, 1.8395023345947266, 0.4299490451812744, 0.1309179663658142, 0.6193809509277344, 2.246731758117676, 1.6424825191497803, 0.9386479258537292, 1.6456879377365112, 0.5080081224441528, 1.214308738708496, 0.9463326930999756, 0.4816877841949463, 2.14316987991333, 0.7650911211967468, 1.2264289855957031, 2.9941320419311523, 1.8876526355743408, 2.8918540477752686, 0.5911319851875305, 1.8497028350830078, 1.1332099437713623, 1.0345263481140137, 1.6701003313064575, 1.8241472244262695, 2.7932519912719727, 0.4206807017326355, 0.6279855966567993, 4.272417068481445, 0.4284597635269165, 1.114749789237976, 1.506176233291626, 2.084185838699341, 2.217879295349121, 3.469346523284912, 2.4364354610443115, 1.870359182357788, 0.16513198614120483, 0.6737823486328125, 1.457935094833374, 2.114887237548828, 1.7557826042175293, 2.432041645050049, 3.0625252723693848, 0.5091320276260376, 2.1314496994018555, 3.1762216091156006, 0.15675228834152222, 1.3597462177276611, 1.6639752388000488, 0.1774623990058899, 2.295837879180908, 0.1814725399017334, 0.06030309200286865, 0.38110750913619995, 1.268071174621582, 0.7045905590057373, 3.150885581970215, 0.3511834144592285, 3.0888988971710205, 3.2747223377227783, 1.0159443616867065, 1.1973369121551514, 2.233475685119629, 1.5295213460922241, 0.0075536370277404785, 0.9240710139274597, 0.038278281688690186, 1.6930997371673584, 1.1604557037353516, 1.542574167251587, 2.7793450355529785, 0.06284117698669434, 1.9011445045471191], "mean_td_error": 1.4478425979614258, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 41.0, "diff_num_grad_updates_vs_sampler_policy": 40.0}}, "num_env_steps_sampled": 37632, "num_env_steps_trained": 10578, "num_agent_steps_sampled": 112896, "num_agent_steps_trained": 10578, "last_target_update_ts": 37632, "num_target_updates": 41}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112896, "num_agent_steps_trained": 10578, "num_env_steps_sampled": 37632, "num_env_steps_trained": 10578, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 947.0072287456445, "num_env_steps_trained_throughput_per_sec": 272.68734934863426, "timesteps_total": 37632, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 112896, "timers": {"training_iteration_time_ms": 994.655, "sample_time_ms": 697.562, "load_time_ms": 0.318, "load_throughput": 812593.251, "learn_time_ms": 18.234, "learn_throughput": 14149.287, "synch_weights_time_ms": 10.124}, "counters": {"num_env_steps_sampled": 37632, "num_env_steps_trained": 10578, "num_agent_steps_sampled": 112896, "num_agent_steps_trained": 10578, "last_target_update_ts": 37632, "num_target_updates": 41}, "done": false, "episodes_total": 0, "training_iteration": 24, "trial_id": "cfa97_00000", "date": "2023-11-18_21-03-08", "timestamp": 1700370188, "time_this_iter_s": 1.9011681079864502, "time_total_s": 41.67983102798462, "pid": 6770, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17f309ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 41.67983102798462, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 70.5, "ram_util_percent": 64.46666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.08338737487793, "actor_loss": -5.714333534240723, "critic_loss": 1.330354928970337, "alpha_loss": -0.1271529495716095, "alpha_value": 0.9874690175056458, "log_alpha_value": -0.01261014211922884, "target_entropy": -6.0, "policy_t": 0.06006338447332382, "mean_q": 2.219362735748291, "max_q": 10.492401123046875, "min_q": 1.7175861597061157}, "td_error": [1.3909906148910522, 2.9083518981933594, 1.7489625215530396, 1.3305623531341553, 2.488584518432617, 2.005784034729004, 2.8152198791503906, 4.699698448181152, 2.018305778503418, 3.108400821685791, 4.958843231201172, 4.207981109619141, 2.6175270080566406, 1.747464656829834, 4.519042491912842, 2.937216281890869, 2.230808973312378, 3.3965373039245605, 3.353515625, 3.1392574310302734, 2.1055688858032227, 1.9980299472808838, 4.038922309875488, 2.2173938751220703, 2.7926583290100098, 3.234004020690918, 0.20704936981201172, 4.085305690765381, 4.663153648376465, 2.2862071990966797, 3.788618803024292, 3.0519800186157227, 4.503320693969727, 3.4835243225097656, 4.631339073181152, 3.2377207279205322, 3.783106803894043, 3.243715286254883, 4.90634822845459, 2.145368814468384, 3.061455488204956, 3.868497848510742, 0.10761862993240356, 2.3418760299682617, 3.3272271156311035, 1.4001187086105347, 4.495582580566406, 4.1189165115356445, 3.8497416973114014, 2.135951042175293, 3.429924964904785, 4.019813060760498, 5.079724311828613, 3.8235442638397217, 2.3993406295776367, 2.305530548095703, 4.898820877075195, 2.176079273223877, 4.429814338684082, 3.9611616134643555, 2.819352149963379, 1.9153151512145996, 1.8628686666488647, 3.120300531387329, 3.412226676940918, 4.994863510131836, 3.567014217376709, 1.5141443014144897, 1.816953420639038, 1.9674886465072632, 3.0070013999938965, 3.2387123107910156, 3.485766887664795, 3.658454418182373, 3.4200870990753174, 2.574807643890381, 2.986531972885132, 1.4999595880508423, 3.0408668518066406, 2.793610095977783, 1.261657953262329, 2.8228859901428223, 2.3967440128326416, 1.6305909156799316, 3.951671838760376, 3.8072352409362793], "mean_td_error": 3.021212100982666, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 43.0, "diff_num_grad_updates_vs_sampler_policy": 42.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.065929412841797, "actor_loss": -5.5775532722473145, "critic_loss": 0.34149444103240967, "alpha_loss": -0.12693816423416138, "alpha_value": 0.9874684810638428, "log_alpha_value": -0.01261067669838667, "target_entropy": -6.0, "policy_t": 0.01344905886799097, "mean_q": 1.523694634437561, "max_q": 4.584719181060791, "min_q": 1.4123427867889404}, "td_error": [2.7358782291412354, 1.618028163909912, 0.2475144863128662, 1.753987193107605, 0.6395500898361206, 0.8653412461280823, 1.616873025894165, 1.641180157661438, 2.8247733116149902, 0.19970625638961792, 1.2111445665359497, 1.791411280632019, 0.3569490909576416, 0.05936253070831299, 0.7719828486442566, 1.9424092769622803, 2.332803726196289, 0.14009755849838257, 0.6021522283554077, 1.3507752418518066, 1.6842632293701172, 1.9502065181732178, 2.098538875579834, 0.08671021461486816, 0.35936933755874634, 2.3056716918945312, 0.8448708057403564, 0.6894568204879761, 1.6636605262756348, 0.387709379196167, 1.4242910146713257, 0.08684641122817993, 1.5593613386154175, 0.7851646542549133, 0.43700921535491943, 0.15936708450317383, 0.7596074342727661, 1.10129714012146, 0.5529233813285828, 0.482283353805542, 1.4129278659820557, 1.6765491962432861, 1.767444372177124, 0.6982463598251343, 0.40542012453079224, 1.3615330457687378, 3.8104238510131836, 1.5560224056243896, 2.488943099975586, 1.439011573791504, 2.431215286254883, 1.2728662490844727, 1.8063079118728638, 3.7489371299743652, 2.0120997428894043, 0.7081590294837952, 0.5629804730415344, 0.7866923809051514, 1.7371699810028076, 1.9885406494140625, 1.902867317199707, 1.798924207687378, 0.6085445284843445, 2.1702401638031006, 1.689711570739746, 0.6814647912979126, 2.26774001121521, 0.49405908584594727, 0.08901369571685791, 2.400649070739746, 1.2570114135742188, 0.7089242935180664, 3.7587876319885254, 1.5481863021850586, 0.9013718366622925, 1.270827054977417, 1.9483835697174072, 0.587594747543335, 0.5151076912879944, 0.30540531873703003, 1.525629997253418, 1.280275583267212, 1.782121181488037, 0.7713585495948792, 2.3885579109191895, 1.819761037826538], "mean_td_error": 1.3286573886871338, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 43.0, "diff_num_grad_updates_vs_sampler_policy": 42.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.101177215576172, "actor_loss": -5.331902980804443, "critic_loss": 0.2547559440135956, "alpha_loss": -0.12736128270626068, "alpha_value": 0.9874705672264099, "log_alpha_value": -0.012608557939529419, "target_entropy": -6.0, "policy_t": -0.019460130482912064, "mean_q": 1.4289178848266602, "max_q": 6.159663200378418, "min_q": 1.228866696357727}, "td_error": [0.8493252396583557, 2.0383152961730957, 1.8645761013031006, 1.3067831993103027, 1.2791621685028076, 0.3678434491157532, 1.4992351531982422, 3.8951549530029297, 2.1860499382019043, 0.19127249717712402, 0.9220585823059082, 0.5631319284439087, 0.08369070291519165, 2.0929274559020996, 0.6378587484359741, 1.7546453475952148, 0.9582041501998901, 2.383612632751465, 0.21806466579437256, 1.396903157234192, 0.2760074734687805, 0.23745715618133545, 2.2044670581817627, 0.36862874031066895, 1.1160727739334106, 2.807996988296509, 1.6597098112106323, 0.5110516548156738, 2.160005569458008, 0.9889883995056152, 1.6033529043197632, 2.349625825881958, 0.5918315649032593, 1.31355881690979, 2.5146312713623047, 1.7874759435653687, 1.7522003650665283, 1.0293102264404297, 2.5916261672973633, 2.7030601501464844, 2.4020371437072754, 0.44064098596572876, 1.8775968551635742, 4.131748199462891, 0.4592192769050598, 1.693777084350586, 1.3105804920196533, 2.0939855575561523, 1.9241431951522827, 4.960685729980469, 0.6826455593109131, 1.8870362043380737, 1.6409704685211182, 2.8989503383636475, 2.6496477127075195, 2.61708664894104, 0.23490571975708008, 2.4099388122558594, 1.6125648021697998, 1.3784193992614746, 1.4136883020401, 1.2564165592193604, 4.955927848815918, 1.6315174102783203, 2.682474136352539, 0.2548363208770752, 0.5759469866752625, 1.8114891052246094, 0.9665791392326355, 2.3154382705688477, 0.9529274106025696, 0.23835158348083496, 0.8073525428771973, 0.5292068123817444, 1.8867570161819458, 0.06205594539642334, 1.4341702461242676, 2.974656820297241, 2.462399482727051, 0.5311579704284668, 1.2890785932540894, 0.7491557002067566, 1.18623948097229, 2.0531082153320312, 1.3783360719680786, 2.4016027450561523], "mean_td_error": 1.5716665983200073, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 43.0, "diff_num_grad_updates_vs_sampler_policy": 42.0}}, "num_env_steps_sampled": 39424, "num_env_steps_trained": 11094, "num_agent_steps_sampled": 118272, "num_agent_steps_trained": 11094, "last_target_update_ts": 39424, "num_target_updates": 43}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 118272, "num_agent_steps_trained": 11094, "num_env_steps_sampled": 39424, "num_env_steps_trained": 11094, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 953.466880561166, "num_env_steps_trained_throughput_per_sec": 274.5473830187286, "timesteps_total": 39424, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 118272, "timers": {"training_iteration_time_ms": 993.52, "sample_time_ms": 696.091, "load_time_ms": 0.318, "load_throughput": 812532.236, "learn_time_ms": 18.129, "learn_throughput": 14231.499, "synch_weights_time_ms": 10.103}, "counters": {"num_env_steps_sampled": 39424, "num_env_steps_trained": 11094, "num_agent_steps_sampled": 118272, "num_agent_steps_trained": 11094, "last_target_update_ts": 39424, "num_target_updates": 43}, "done": false, "episodes_total": 0, "training_iteration": 25, "trial_id": "cfa97_00000", "date": "2023-11-18_21-03-10", "timestamp": 1700370190, "time_this_iter_s": 1.8886311054229736, "time_total_s": 43.56846213340759, "pid": 6770, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17f30a700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 43.56846213340759, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 68.10000000000001, "ram_util_percent": 64.66666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.093381881713867, "actor_loss": -5.7900872230529785, "critic_loss": 1.4786198139190674, "alpha_loss": -0.13030940294265747, "alpha_value": 0.9871726036071777, "log_alpha_value": -0.012910382822155952, "target_entropy": -6.0, "policy_t": -0.007602736819535494, "mean_q": 2.133930206298828, "max_q": 11.554712295532227, "min_q": 1.7930841445922852}, "td_error": [0.3641430735588074, 3.5139641761779785, 2.8058009147644043, 3.9817352294921875, 5.114306449890137, 3.76664662361145, 2.6065404415130615, 2.3294618129730225, 3.385605812072754, 2.8289542198181152, 3.7101080417633057, 4.452598571777344, 3.7697362899780273, 4.8054304122924805, 4.03791618347168, 6.03924560546875, 3.0666580200195312, 5.733870029449463, 3.5417566299438477, 4.543157577514648, 4.943595886230469, 3.293299436569214, 3.39186954498291, 2.8853445053100586, 3.673600435256958, 5.193449020385742, 3.5668070316314697, 0.7244269847869873, 2.777472496032715, 3.1040987968444824, 3.2356183528900146, 3.4474663734436035, 3.2194392681121826, 3.236478328704834, 3.338059425354004, 1.8847856521606445, 0.9956949949264526, 4.182990074157715, 1.426398754119873, 3.6330299377441406, 1.6769376993179321, 3.849733352661133, 3.531479835510254, 2.0899696350097656, 1.0810959339141846, 2.732588291168213, 3.589921712875366, 2.634768009185791, 3.0229101181030273, 3.8505136966705322, 3.86806583404541, 3.221652030944824, 3.506113290786743, 1.7103756666183472, 3.389049530029297, 2.7004904747009277, 4.083470344543457, 3.0772953033447266, 2.4161155223846436, 3.325592517852783, 4.331765174865723, 2.165919303894043, 3.8667421340942383, 4.461714744567871, 3.0988965034484863, 3.0025343894958496, 4.769782066345215, 5.272824287414551, 4.107253551483154, 0.40443187952041626, 3.0152668952941895, 2.6397175788879395, 2.518908977508545, 4.515425682067871, 5.213603496551514, 2.9917545318603516, 5.360345840454102, 3.322885513305664, 4.604170799255371, 2.289212226867676, 6.397789478302002, 2.1223464012145996, 0.4775688648223877, 3.8241095542907715, 2.1321945190429688, 3.0094895362854004], "mean_td_error": 3.3235623836517334, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 44.0, "diff_num_grad_updates_vs_sampler_policy": 43.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.063217163085938, "actor_loss": -5.631935119628906, "critic_loss": 0.33822309970855713, "alpha_loss": -0.12992213666439056, "alpha_value": 0.9871723651885986, "log_alpha_value": -0.012910597957670689, "target_entropy": -6.0, "policy_t": 0.0350910909473896, "mean_q": 1.6454542875289917, "max_q": 6.866814613342285, "min_q": 1.483746886253357}, "td_error": [0.3593038320541382, 1.6854345798492432, 0.17063534259796143, 0.5046664476394653, 0.09477239847183228, 0.09100139141082764, 0.7029091119766235, 0.7169885635375977, 0.8557333946228027, 1.8471190929412842, 2.112135171890259, 1.026068925857544, 0.17566251754760742, 1.3787933588027954, 1.1123956441879272, 0.7480259537696838, 0.09738361835479736, 0.3414154052734375, 1.393799066543579, 2.4787983894348145, 2.89385986328125, 1.1853771209716797, 0.22433841228485107, 0.6175482273101807, 2.9802446365356445, 0.1091078519821167, 0.1274179220199585, 2.5075016021728516, 2.513762950897217, 2.106257677078247, 3.9892897605895996, 1.1430706977844238, 3.5958762168884277, 0.6956897974014282, 1.2250287532806396, 0.9806203842163086, 0.22928369045257568, 1.1302975416183472, 1.3239948749542236, 1.4507780075073242, 1.8456356525421143, 5.304500579833984, 1.566894769668579, 0.8685556650161743, 1.4920587539672852, 3.3198657035827637, 1.5897963047027588, 0.6880357265472412, 2.4685513973236084, 1.6967198848724365, 0.16613399982452393, 0.44128382205963135, 0.32485735416412354, 0.5722927451133728, 3.6111221313476562, 0.6526922583580017, 0.3861348628997803, 2.9241044521331787, 0.4744032621383667, 0.47259318828582764, 2.0222082138061523, 1.6059463024139404, 0.8198440670967102, 0.7621557116508484, 0.9323912262916565, 0.24180305004119873, 0.8275372982025146, 0.908624529838562, 1.0751817226409912, 1.5606224536895752, 1.1949994564056396, 0.4733901619911194, 1.4699732065200806, 0.747275710105896, 3.3962135314941406, 3.5094947814941406, 1.6262240409851074, 1.9188288450241089, 1.052641749382019, 0.29958856105804443, 1.2340267896652222, 0.21868497133255005, 1.1381235122680664, 1.3932452201843262, 1.4855010509490967, 1.9005669355392456], "mean_td_error": 1.320973515510559, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 44.0, "diff_num_grad_updates_vs_sampler_policy": 43.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.053747177124023, "actor_loss": -5.3499016761779785, "critic_loss": 0.24269193410873413, "alpha_loss": -0.12978509068489075, "alpha_value": 0.987173855304718, "log_alpha_value": -0.012909126468002796, "target_entropy": -6.0, "policy_t": 0.030762111768126488, "mean_q": 1.394677758216858, "max_q": 6.709359645843506, "min_q": 1.290311574935913}, "td_error": [1.9441949129104614, 1.2414801120758057, 2.375182867050171, 1.3882768154144287, 1.1600123643875122, 0.7352271676063538, 2.1772356033325195, 2.8064041137695312, 2.1472277641296387, 0.27519315481185913, 1.778609275817871, 2.0414347648620605, 1.6869924068450928, 2.009307861328125, 0.08257389068603516, 1.6622129678726196, 2.089944839477539, 0.9598230123519897, 3.137579917907715, 0.8729067444801331, 1.448349952697754, 1.876082420349121, 2.224710464477539, 4.552774429321289, 0.7375708222389221, 4.064919948577881, 0.9827286601066589, 2.0146758556365967, 0.09299880266189575, 0.49585676193237305, 1.1712697744369507, 2.3495097160339355, 1.4126746654510498, 1.1430200338363647, 1.0819272994995117, 1.273662805557251, 0.6147769093513489, 0.9333198666572571, 0.8231892585754395, 0.08256357908248901, 1.0878087282180786, 2.545628786087036, 0.8766353130340576, 0.8620082139968872, 2.434356927871704, 3.476705551147461, 2.468324661254883, 0.8820165395736694, 0.03350871801376343, 2.0349059104919434, 1.8089611530303955, 2.4224023818969727, 2.2735109329223633, 1.659543752670288, 0.8997805118560791, 0.8913117051124573, 1.2157113552093506, 2.4051403999328613, 1.291426181793213, 1.904284954071045, 1.2934181690216064, 2.6164865493774414, 1.040550708770752, 2.331583023071289, 0.38475972414016724, 2.0058393478393555, 0.9094321727752686, 0.6626681685447693, 0.11569851636886597, 0.7464344501495361, 1.2454538345336914, 2.89675235748291, 2.535923480987549, 1.4275074005126953, 0.9634353518486023, 0.028854191303253174, 0.6615481972694397, 0.9927794933319092, 0.3385215401649475, 2.174654245376587, 2.986422300338745, 1.2202973365783691, 0.34300506114959717, 1.088183879852295, 1.1640381813049316, 1.0237343311309814], "mean_td_error": 1.495585560798645, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 44.0, "diff_num_grad_updates_vs_sampler_policy": 43.0}}, "num_env_steps_sampled": 40320, "num_env_steps_trained": 11352, "num_agent_steps_sampled": 120960, "num_agent_steps_trained": 11352, "last_target_update_ts": 40320, "num_target_updates": 44}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120960, "num_agent_steps_trained": 11352, "num_env_steps_sampled": 40320, "num_env_steps_trained": 11352, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 862.6823876820011, "num_env_steps_trained_throughput_per_sec": 248.40631252450478, "timesteps_total": 40320, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 120960, "timers": {"training_iteration_time_ms": 996.656, "sample_time_ms": 698.514, "load_time_ms": 0.318, "load_throughput": 812593.251, "learn_time_ms": 17.977, "learn_throughput": 14351.977, "synch_weights_time_ms": 9.983}, "counters": {"num_env_steps_sampled": 40320, "num_env_steps_trained": 11352, "num_agent_steps_sampled": 120960, "num_agent_steps_trained": 11352, "last_target_update_ts": 40320, "num_target_updates": 44}, "done": false, "episodes_total": 0, "training_iteration": 26, "trial_id": "cfa97_00000", "date": "2023-11-18_21-03-11", "timestamp": 1700370191, "time_this_iter_s": 1.0481441020965576, "time_total_s": 44.61660623550415, "pid": 6770, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17f28fa60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 44.61660623550415, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 70.3, "ram_util_percent": 64.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.098037719726562, "actor_loss": -5.8493170738220215, "critic_loss": 1.2335984706878662, "alpha_loss": -0.13340121507644653, "alpha_value": 0.9868762493133545, "log_alpha_value": -0.013210606761276722, "target_entropy": -6.0, "policy_t": 0.017101798206567764, "mean_q": 2.031533718109131, "max_q": 10.686861991882324, "min_q": 1.8709959983825684}, "td_error": [5.040927886962891, 1.462200403213501, 3.0456619262695312, 3.7355456352233887, 2.4473934173583984, 2.474607229232788, 2.8887362480163574, 3.5751888751983643, 2.664647102355957, 3.8086464405059814, 3.3489034175872803, 1.7977677583694458, 3.0065817832946777, 3.0360236167907715, 1.7835888862609863, 0.482302188873291, 3.488476276397705, 1.832413673400879, 3.7011280059814453, 2.979717493057251, 1.6149327754974365, 2.929598331451416, 2.0473275184631348, 4.027948379516602, 3.781618595123291, 2.5078530311584473, 2.952664852142334, 2.33648681640625, 3.4158401489257812, 0.1643826961517334, 3.589768886566162, 5.388574600219727, 5.482291221618652, 3.2402760982513428, 3.0358705520629883, 4.248508930206299, 3.6085305213928223, 4.108666896820068, 2.58297061920166, 2.117694616317749, 2.431995391845703, 3.1963939666748047, 3.2542734146118164, 3.0629079341888428, 4.665472984313965, 1.4397222995758057, 2.8787498474121094, 3.4928505420684814, 2.7216618061065674, 4.279806137084961, 4.210567474365234, 2.651885986328125, 2.2200355529785156, 3.173516273498535, 2.0483484268188477, 3.478010654449463, 1.3467514514923096, 4.231353282928467, 3.43380069732666, 3.926771640777588, 3.0859851837158203, 2.730653762817383, 2.9226458072662354, 1.2396960258483887, 0.8179413676261902, 2.3620853424072266, 3.5777392387390137, 2.9163832664489746, 3.473489999771118, 3.5213756561279297, 2.0979363918304443, 2.166800022125244, 2.2027804851531982, 4.8351850509643555, 2.4075541496276855, 1.8887512683868408, 3.7402703762054443, 1.6503793001174927, 3.943819761276245, 2.861325740814209, 2.379608154296875, 0.9478695392608643, 2.7178261280059814, 2.061941385269165, 3.2245898246765137, 3.091600179672241], "mean_td_error": 2.9162020683288574, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 45.0, "diff_num_grad_updates_vs_sampler_policy": 44.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.056450843811035, "actor_loss": -5.742885112762451, "critic_loss": 0.27433153986930847, "alpha_loss": -0.1328504979610443, "alpha_value": 0.9868764281272888, "log_alpha_value": -0.013210473582148552, "target_entropy": -6.0, "policy_t": -0.05422438308596611, "mean_q": 1.6921277046203613, "max_q": 5.746598720550537, "min_q": 1.5578277111053467}, "td_error": [0.2291211485862732, 0.9953126311302185, 0.9357762336730957, 0.5754364132881165, 0.7491161227226257, 0.10099577903747559, 0.2683197259902954, 0.5127537250518799, 1.6951946020126343, 1.9922287464141846, 0.7275487780570984, 1.5155706405639648, 1.3268003463745117, 1.3360546827316284, 0.7277545928955078, 0.09838217496871948, 1.1818073987960815, 3.006533622741699, 1.3640631437301636, 0.22088325023651123, 0.3622465133666992, 1.8786542415618896, 2.3525333404541016, 2.581986904144287, 0.7665722370147705, 1.454500675201416, 2.1250967979431152, 1.9836397171020508, 0.7926150560379028, 0.8509805202484131, 0.48798656463623047, 0.7515405416488647, 0.09395235776901245, 1.459611177444458, 2.3834052085876465, 1.3070765733718872, 1.9215682744979858, 1.5156888961791992, 0.8319674730300903, 2.967827320098877, 3.25813627243042, 0.7163240313529968, 0.7683395743370056, 0.8107775449752808, 0.1816135048866272, 0.18680262565612793, 0.17039626836776733, 0.9226279854774475, 1.8833893537521362, 1.6644463539123535, 0.3516256809234619, 2.8769235610961914, 0.9393463730812073, 1.2302191257476807, 2.4709935188293457, 0.37065500020980835, 0.10095679759979248, 0.5173732042312622, 0.5825684070587158, 0.5722769498825073, 0.985501766204834, 1.8858684301376343, 0.3882155418395996, 0.8108816742897034, 0.17813527584075928, 0.0902867317199707, 0.41741693019866943, 0.26881903409957886, 0.12206339836120605, 2.051967144012451, 0.7934539318084717, 2.318516731262207, 1.858508825302124, 2.6543939113616943, 0.4175872802734375, 0.09069007635116577, 0.15629082918167114, 1.4664579629898071, 0.8695279359817505, 2.0787904262542725, 0.21343815326690674, 1.7487397193908691, 2.0498223304748535, 0.09396040439605713, 1.6956477165222168, 3.30450439453125], "mean_td_error": 1.1397020816802979, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 45.0, "diff_num_grad_updates_vs_sampler_policy": 44.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.048870086669922, "actor_loss": -5.404078483581543, "critic_loss": 0.25349175930023193, "alpha_loss": -0.1327410489320755, "alpha_value": 0.9868773221969604, "log_alpha_value": -0.013209550641477108, "target_entropy": -6.0, "policy_t": 0.0043845027685165405, "mean_q": 1.4393274784088135, "max_q": 5.612547874450684, "min_q": 1.355643391609192}, "td_error": [2.7907185554504395, 3.4014196395874023, 0.4295154809951782, 3.743633270263672, 1.6558729410171509, 2.5649733543395996, 1.568038821220398, 0.6465035676956177, 1.6607277393341064, 1.308443307876587, 1.3127176761627197, 1.8873926401138306, 2.0434255599975586, 2.6930532455444336, 1.1825013160705566, 2.6710124015808105, 0.6596531867980957, 0.8650350570678711, 1.7651516199111938, 2.746152400970459, 2.2704474925994873, 0.4027412533760071, 0.9141995906829834, 1.538545846939087, 0.9009488821029663, 1.553537368774414, 1.3194313049316406, 1.72714102268219, 1.9672964811325073, 3.1011204719543457, 0.5832016468048096, 1.7604596614837646, 0.8684532642364502, 0.9677051305770874, 3.1323087215423584, 0.13000667095184326, 1.2945846319198608, 1.9774624109268188, 0.39998722076416016, 2.158125162124634, 1.1896185874938965, 2.524575710296631, 0.6517334580421448, 2.191591739654541, 1.507246732711792, 3.483616352081299, 0.6234980821609497, 0.1454075574874878, 0.731654942035675, 1.6611497402191162, 0.373046875, 1.2848601341247559, 2.4607982635498047, 1.2144334316253662, 0.819702684879303, 1.5436694622039795, 2.101759433746338, 2.8496389389038086, 1.1307480335235596, 4.067755699157715, 2.4966588020324707, 1.3609405755996704, 1.1036577224731445, 0.10524141788482666, 1.2913862466812134, 2.1651644706726074, 1.2696261405944824, 0.4384065866470337, 0.9892416000366211, 1.0507726669311523, 0.5315236449241638, 2.0908992290496826, 1.0266445875167847, 0.22771185636520386, 1.2795708179473877, 1.2168573141098022, 0.7259643077850342, 0.29719048738479614, 1.4680415391921997, 1.8748347759246826, 3.0713629722595215, 1.5796852111816406, 1.2239060401916504, 2.196537494659424, 0.8170966506004333, 1.182140827178955], "mean_td_error": 1.5372233390808105, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 45.0, "diff_num_grad_updates_vs_sampler_policy": 44.0}}, "num_env_steps_sampled": 41216, "num_env_steps_trained": 11610, "num_agent_steps_sampled": 123648, "num_agent_steps_trained": 11610, "last_target_update_ts": 41216, "num_target_updates": 45}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 123648, "num_agent_steps_trained": 11610, "num_env_steps_sampled": 41216, "num_env_steps_trained": 11610, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 806.8234265629173, "num_env_steps_trained_throughput_per_sec": 232.3219241665543, "timesteps_total": 41216, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 123648, "timers": {"training_iteration_time_ms": 995.133, "sample_time_ms": 697.756, "load_time_ms": 0.314, "load_throughput": 822537.574, "learn_time_ms": 18.0, "learn_throughput": 14333.024, "synch_weights_time_ms": 10.041}, "counters": {"num_env_steps_sampled": 41216, "num_env_steps_trained": 11610, "num_agent_steps_sampled": 123648, "num_agent_steps_trained": 11610, "last_target_update_ts": 41216, "num_target_updates": 45}, "done": false, "episodes_total": 0, "training_iteration": 27, "trial_id": "cfa97_00000", "date": "2023-11-18_21-03-12", "timestamp": 1700370192, "time_this_iter_s": 1.118725299835205, "time_total_s": 45.735331535339355, "pid": 6770, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17f309f80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 45.735331535339355, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 76.8, "ram_util_percent": 64.85}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.022113800048828, "actor_loss": -5.962814807891846, "critic_loss": 1.2580424547195435, "alpha_loss": -0.138414666056633, "alpha_value": 0.9862840175628662, "log_alpha_value": -0.013810924254357815, "target_entropy": -6.0, "policy_t": -0.031689442694187164, "mean_q": 2.4496676921844482, "max_q": 11.965145111083984, "min_q": 2.0389134883880615}, "td_error": [3.658472776412964, 1.4676156044006348, 2.6808323860168457, 3.8592615127563477, 2.0035581588745117, 2.088675022125244, 5.086203098297119, 2.739881992340088, 1.823720932006836, 4.10532283782959, 3.1237432956695557, 2.3557486534118652, 0.7968852519989014, 0.47907471656799316, 2.414752960205078, 3.597729206085205, 3.412153482437134, 4.296059608459473, 1.3715758323669434, 2.8969874382019043, 2.0710787773132324, 2.294902801513672, 2.404934883117676, 0.9714946746826172, 3.577812671661377, 3.1718943119049072, 1.6069008111953735, 1.9169865846633911, 1.7859158515930176, 4.513062000274658, 4.326869964599609, 1.9673486948013306, 3.1634249687194824, 2.4112439155578613, 2.4615869522094727, 8.968958854675293, 2.8710081577301025, 3.4687461853027344, 0.48574233055114746, 2.8104135990142822, 0.6478606462478638, 2.7470345497131348, 1.064913034439087, 4.594514846801758, 3.430227518081665, 1.241601586341858, 2.6602606773376465, 2.357117176055908, 3.431006908416748, 2.166029214859009, 2.6505637168884277, 3.1206648349761963, 2.7098450660705566, 4.263396263122559, 4.740660667419434, 3.082059383392334, 1.2943358421325684, 3.597482204437256, 3.111030101776123, 3.100921392440796, 2.5764384269714355, 3.4812309741973877, 2.778179168701172, 3.8277645111083984, 2.8879733085632324, 2.540182590484619, 1.9225459098815918, 3.236542224884033, 2.9272425174713135, 2.5284032821655273, 3.32421612739563, 4.225177764892578, 1.585749864578247, 4.276289939880371, 2.3978352546691895, 3.267221450805664, 2.8616721630096436, 4.6656718254089355, 0.9106006622314453, 3.502537727355957, 2.7110891342163086, 4.842231750488281, 3.5225462913513184, 3.322690486907959, 3.7253470420837402, 1.7457332611083984], "mean_td_error": 2.8734095096588135, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 47.0, "diff_num_grad_updates_vs_sampler_policy": 46.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.165445327758789, "actor_loss": -5.951499938964844, "critic_loss": 0.3181415796279907, "alpha_loss": -0.14038684964179993, "alpha_value": 0.9862847328186035, "log_alpha_value": -0.013810199685394764, "target_entropy": -6.0, "policy_t": -0.011340806260704994, "mean_q": 1.8928959369659424, "max_q": 5.743416786193848, "min_q": 1.7085988521575928}, "td_error": [0.31648343801498413, 0.3721460700035095, 0.8352208733558655, 0.3582591414451599, 1.406270980834961, 1.8119227886199951, 0.8475296497344971, 1.9216489791870117, 1.7259327173233032, 0.7210555672645569, 2.029348373413086, 3.1792426109313965, 0.5711411237716675, 1.9003212451934814, 1.0604486465454102, 0.16430824995040894, 3.3040711879730225, 0.4765394926071167, 1.339359998703003, 1.3924529552459717, 2.1449317932128906, 0.8976873159408569, 2.463343620300293, 1.3362150192260742, 0.30683112144470215, 0.39322584867477417, 2.1525015830993652, 2.680586099624634, 1.9639843702316284, 1.860901951789856, 2.0005245208740234, 0.2971193790435791, 0.46048784255981445, 0.4252738356590271, 0.32936882972717285, 0.9898137450218201, 1.4999587535858154, 0.9414844512939453, 0.12078362703323364, 1.9198360443115234, 2.183509349822998, 1.2760523557662964, 0.4249911904335022, 1.3743650913238525, 1.2626445293426514, 0.7726850509643555, 1.3806707859039307, 1.6137053966522217, 0.577353835105896, 1.936787486076355, 0.5554245710372925, 0.6941184997558594, 0.2825765013694763, 0.2605239152908325, 1.1619703769683838, 0.7875021696090698, 0.09554862976074219, 1.3242766857147217, 1.0400378704071045, 1.4849573373794556, 0.8782750368118286, 1.7593519687652588, 1.7488348484039307, 1.249513864517212, 0.46496230363845825, 0.10393649339675903, 0.6474272012710571, 1.2045198678970337, 0.6322928667068481, 2.6562180519104004, 1.0357964038848877, 0.871178388595581, 2.113706350326538, 2.113123893737793, 1.6084003448486328, 4.633774757385254, 1.5116267204284668, 0.5807074308395386, 2.9181125164031982, 0.9620686173439026, 0.9277581572532654, 2.1920533180236816, 0.22548729181289673, 4.0583906173706055, 0.30612796545028687, 0.3096274137496948], "mean_td_error": 1.268855094909668, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 47.0, "diff_num_grad_updates_vs_sampler_policy": 46.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.087907791137695, "actor_loss": -5.576722145080566, "critic_loss": 0.20653003454208374, "alpha_loss": -0.13931487500667572, "alpha_value": 0.9862848520278931, "log_alpha_value": -0.013810084201395512, "target_entropy": -6.0, "policy_t": -0.020171014592051506, "mean_q": 1.800003170967102, "max_q": 6.775888442993164, "min_q": 1.4943550825119019}, "td_error": [1.9942901134490967, 0.1638661026954651, 0.7721747159957886, 2.132017135620117, 1.1991608142852783, 2.8430309295654297, 2.1653456687927246, 1.050520658493042, 2.0253372192382812, 0.4923830032348633, 1.720019817352295, 1.7622333765029907, 0.6601167917251587, 2.7246391773223877, 1.4897091388702393, 2.6189842224121094, 1.0000871419906616, 2.226090669631958, 0.30708539485931396, 0.39655280113220215, 0.2944466471672058, 0.10117065906524658, 1.3382771015167236, 0.4998873472213745, 2.081540584564209, 2.421144962310791, 1.8603906631469727, 1.4246842861175537, 1.9778748750686646, 0.40872156620025635, 0.48545390367507935, 0.8224602937698364, 0.13216185569763184, 1.2815382480621338, 1.6427350044250488, 2.1249642372131348, 0.14777547121047974, 0.5208637714385986, 0.5217763185501099, 3.107076644897461, 1.0722922086715698, 0.9325364232063293, 0.33115625381469727, 0.682532012462616, 2.0885448455810547, 0.6748449802398682, 0.02444690465927124, 1.9692869186401367, 3.110445022583008, 2.698474407196045, 5.1662445068359375, 1.8563491106033325, 0.9507236480712891, 2.521230697631836, 0.820293664932251, 2.809058666229248, 0.8610228300094604, 0.4039018154144287, 0.35221928358078003, 1.0761914253234863, 1.1701933145523071, 0.8699055910110474, 0.5565524101257324, 2.821033477783203, 0.6548586487770081, 1.337841272354126, 1.0223994255065918, 2.91925311088562, 3.971749782562256, 1.8587052822113037, 1.9609557390213013, 0.4172971248626709, 1.0752718448638916, 2.546442985534668, 0.31660205125808716, 1.4432458877563477, 0.3790510892868042, 0.7885732650756836, 0.3867039680480957, 0.6592872142791748, 1.119593620300293, 0.6703701019287109, 0.07129496335983276, 1.5891575813293457, 0.9448232650756836, 1.2211090326309204], "mean_td_error": 1.3501471281051636, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 47.0, "diff_num_grad_updates_vs_sampler_policy": 46.0}}, "num_env_steps_sampled": 43008, "num_env_steps_trained": 12126, "num_agent_steps_sampled": 129024, "num_agent_steps_trained": 12126, "last_target_update_ts": 43008, "num_target_updates": 47}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 129024, "num_agent_steps_trained": 12126, "num_env_steps_sampled": 43008, "num_env_steps_trained": 12126, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 901.6284277735699, "num_env_steps_trained_throughput_per_sec": 259.6206856758717, "timesteps_total": 43008, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 129024, "timers": {"training_iteration_time_ms": 981.329, "sample_time_ms": 707.063, "load_time_ms": 0.311, "load_throughput": 828964.633, "learn_time_ms": 18.05, "learn_throughput": 14294.004, "synch_weights_time_ms": 9.776}, "counters": {"num_env_steps_sampled": 43008, "num_env_steps_trained": 12126, "num_agent_steps_sampled": 129024, "num_agent_steps_trained": 12126, "last_target_update_ts": 43008, "num_target_updates": 47}, "done": false, "episodes_total": 0, "training_iteration": 28, "trial_id": "cfa97_00000", "date": "2023-11-18_21-03-14", "timestamp": 1700370194, "time_this_iter_s": 1.9978129863739014, "time_total_s": 47.73314452171326, "pid": 6770, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17f309b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 47.73314452171326, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 70.56666666666666, "ram_util_percent": 64.73333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.107510566711426, "actor_loss": -6.089597702026367, "critic_loss": 1.1693837642669678, "alpha_loss": -0.1426256150007248, "alpha_value": 0.9859882593154907, "log_alpha_value": -0.014110853895545006, "target_entropy": -6.0, "policy_t": -0.03694649785757065, "mean_q": 2.288400888442993, "max_q": 9.143424987792969, "min_q": 2.127450942993164}, "td_error": [3.2610836029052734, 1.6564068794250488, 4.348338603973389, 2.670867919921875, 2.9260244369506836, 2.1751561164855957, 1.6675549745559692, 2.5575575828552246, 4.319524765014648, 1.683716058731079, 4.688093185424805, 2.334308624267578, 2.5398035049438477, 2.75601863861084, 1.9901314973831177, 0.2529447674751282, 1.694667100906372, 3.7827985286712646, 2.289931297302246, 2.5798397064208984, 2.202019691467285, 2.370802879333496, 4.357213020324707, 3.6440415382385254, 1.9102905988693237, 2.5953104496002197, 3.24857234954834, 1.2420953512191772, 4.835475921630859, 1.9897478818893433, 2.005108594894409, 0.8543907999992371, 0.6561104655265808, 1.8137719631195068, 5.524897575378418, 2.9848828315734863, 2.8901419639587402, 0.7138433456420898, 3.502248764038086, 1.7148479223251343, 2.2541134357452393, 2.769733190536499, 2.3520896434783936, 4.379542350769043, 2.8178086280822754, 3.9822189807891846, 1.5786676406860352, 2.0116872787475586, 3.746701240539551, 4.606866836547852, 1.1358397006988525, 1.7836028337478638, 2.1930737495422363, 3.176647186279297, 2.9951229095458984, 2.350146770477295, 4.259301662445068, 2.981274127960205, 2.2601711750030518, 1.36070716381073, 2.2455997467041016, 2.7396016120910645, 3.17836856842041, 1.1940901279449463, 2.580653667449951, 5.390872001647949, 1.6254065036773682, 2.736471176147461, 4.816328048706055, 3.6947531700134277, 3.0204899311065674, 2.1933817863464355, 2.38399076461792, 3.6177730560302734, 4.944016456604004, 1.8304715156555176, 0.4666120409965515, 2.165971040725708, 3.1982836723327637, 2.562967300415039, 3.8163747787475586, 2.5029075145721436, 3.2662620544433594, 4.717226982116699, 5.848577499389648, 1.5273410081863403], "mean_td_error": 2.749891757965088, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 48.0, "diff_num_grad_updates_vs_sampler_policy": 47.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.088834762573242, "actor_loss": -6.015552043914795, "critic_loss": 0.2209547758102417, "alpha_loss": -0.1423565149307251, "alpha_value": 0.9859887957572937, "log_alpha_value": -0.014110302552580833, "target_entropy": -6.0, "policy_t": -0.02737630344927311, "mean_q": 1.9901641607284546, "max_q": 6.26375675201416, "min_q": 1.7775781154632568}, "td_error": [2.0346784591674805, 0.9122748374938965, 0.275901198387146, 1.1598955392837524, 3.3912065029144287, 0.886185348033905, 2.311225414276123, 0.15620821714401245, 1.578352689743042, 1.222069263458252, 1.1935559511184692, 0.40817856788635254, 0.5437494516372681, 0.4415067434310913, 0.23017382621765137, 0.09421181678771973, 1.0674991607666016, 0.8744609355926514, 1.588238000869751, 0.9427143335342407, 0.8482776284217834, 0.9312434792518616, 0.1396304965019226, 1.426300048828125, 0.19015634059906006, 0.9401426911354065, 0.584424614906311, 0.6158639192581177, 0.30475616455078125, 2.14363431930542, 1.5437071323394775, 1.753464698791504, 0.4361124038696289, 1.4134188890457153, 2.990767478942871, 0.4657609462738037, 1.3229485750198364, 0.49770891666412354, 2.704251289367676, 0.5635030269622803, 2.0098562240600586, 0.6329702138900757, 0.1954960823059082, 1.483339548110962, 1.7795032262802124, 1.3148794174194336, 0.9077908992767334, 1.030167579650879, 1.253840684890747, 0.5037895441055298, 1.6949355602264404, 0.7195709943771362, 0.17847681045532227, 1.5961358547210693, 0.404083251953125, 1.217317819595337, 1.875040054321289, 1.3630871772766113, 2.7547316551208496, 0.171009361743927, 0.47938811779022217, 0.5567528605461121, 0.35973477363586426, 0.9571676850318909, 1.3787012100219727, 0.2673565745353699, 0.5253008008003235, 0.4670713543891907, 1.8945226669311523, 1.2071149349212646, 0.3075636625289917, 0.1095762848854065, 0.5691447257995605, 1.4379268884658813, 1.4969482421875, 1.1279819011688232, 0.5438037514686584, 0.9771445989608765, 1.2687036991119385, 0.10920125246047974, 0.5241376161575317, 0.8159682154655457, 0.7263702750205994, 0.2682982087135315, 0.1015474796295166, 0.09246408939361572], "mean_td_error": 0.9858636260032654, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 48.0, "diff_num_grad_updates_vs_sampler_policy": 47.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.069778442382812, "actor_loss": -5.624119758605957, "critic_loss": 0.17658203840255737, "alpha_loss": -0.1420876383781433, "alpha_value": 0.9859887957572937, "log_alpha_value": -0.014110304415225983, "target_entropy": -6.0, "policy_t": -0.030669953674077988, "mean_q": 1.654191255569458, "max_q": 5.099496841430664, "min_q": 1.563223123550415}, "td_error": [0.848621129989624, 2.5775833129882812, 0.028499364852905273, 1.4939095973968506, 0.2853724956512451, 1.6702618598937988, 0.7347488403320312, 1.4722175598144531, 0.4180905818939209, 2.2255165576934814, 0.29260653257369995, 1.2279012203216553, 0.5214966535568237, 0.7026504874229431, 1.8185391426086426, 0.0498238205909729, 0.5383880138397217, 1.2079064846038818, 1.8727514743804932, 0.5242542028427124, 1.148970127105713, 1.2111515998840332, 1.4635159969329834, 0.7277657985687256, 0.3766448497772217, 1.3621938228607178, 1.6131364107131958, 3.4105916023254395, 0.6761286854743958, 0.663818895816803, 1.7851288318634033, 1.205532431602478, 0.8681206703186035, 0.7176758050918579, 1.5092545747756958, 2.1124539375305176, 1.3179433345794678, 0.24576902389526367, 1.287631630897522, 0.5763523578643799, 0.6553945541381836, 0.5685994625091553, 0.012464463710784912, 1.7443708181381226, 1.688352346420288, 1.9701902866363525, 0.5305712223052979, 0.2546529769897461, 0.31779909133911133, 1.5807950496673584, 0.8506109714508057, 1.0722870826721191, 1.6513454914093018, 1.304198980331421, 2.738264560699463, 0.3767821788787842, 0.6983733177185059, 0.6606228351593018, 1.2367818355560303, 1.4366848468780518, 1.4153575897216797, 1.793860673904419, 1.1295450925827026, 2.3687238693237305, 0.05440634489059448, 1.5349273681640625, 2.760286569595337, 1.4445478916168213, 1.1345980167388916, 1.9018709659576416, 1.9901665449142456, 1.1904587745666504, 1.5744636058807373, 0.6408340334892273, 1.2868518829345703, 2.7545437812805176, 1.622809886932373, 1.1921124458312988, 2.109203577041626, 0.05777615308761597, 1.0285006761550903, 1.4457981586456299, 0.8143951296806335, 0.9976506233215332, 1.0000975131988525, 0.9587509036064148], "mean_td_error": 1.1900303363800049, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 48.0, "diff_num_grad_updates_vs_sampler_policy": 47.0}}, "num_env_steps_sampled": 43904, "num_env_steps_trained": 12384, "num_agent_steps_sampled": 131712, "num_agent_steps_trained": 12384, "last_target_update_ts": 43904, "num_target_updates": 48}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 131712, "num_agent_steps_trained": 12384, "num_env_steps_sampled": 43904, "num_env_steps_trained": 12384, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 825.6451332894964, "num_env_steps_trained_throughput_per_sec": 237.74156739809158, "timesteps_total": 43904, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 131712, "timers": {"training_iteration_time_ms": 994.502, "sample_time_ms": 719.935, "load_time_ms": 0.312, "load_throughput": 828076.547, "learn_time_ms": 18.024, "learn_throughput": 14314.16, "synch_weights_time_ms": 9.738}, "counters": {"num_env_steps_sampled": 43904, "num_env_steps_trained": 12384, "num_agent_steps_sampled": 131712, "num_agent_steps_trained": 12384, "last_target_update_ts": 43904, "num_target_updates": 48}, "done": false, "episodes_total": 0, "training_iteration": 29, "trial_id": "cfa97_00000", "date": "2023-11-18_21-03-15", "timestamp": 1700370195, "time_this_iter_s": 1.0929579734802246, "time_total_s": 48.82610249519348, "pid": 6770, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17f28fb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 48.82610249519348, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 70.4, "ram_util_percent": 64.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.099748611450195, "actor_loss": -6.176385402679443, "critic_loss": 1.026212453842163, "alpha_loss": -0.1455458253622055, "alpha_value": 0.9856925010681152, "log_alpha_value": -0.01441083662211895, "target_entropy": -6.0, "policy_t": -0.057551369071006775, "mean_q": 2.6588943004608154, "max_q": 12.291778564453125, "min_q": 2.219604969024658}, "td_error": [4.108545303344727, 3.470254898071289, 0.9850810170173645, 2.1981775760650635, 1.236921787261963, 0.4071619510650635, 4.620718002319336, 2.4296839237213135, 0.22618627548217773, 2.7850232124328613, 1.0493243932724, 2.371947765350342, 2.3321943283081055, 2.780224561691284, 1.6345305442810059, 2.8986926078796387, 3.255960464477539, 2.0710010528564453, 4.629150390625, 2.8022713661193848, 2.0647685527801514, 1.412326455116272, 1.374812364578247, 2.1757285594940186, 3.45176100730896, 1.153807282447815, 2.0495147705078125, 1.749867558479309, 6.646500110626221, 2.5259389877319336, 2.6154820919036865, 3.293496608734131, 2.953878879547119, 2.572968006134033, 7.449588775634766, 3.711635112762451, 2.872296094894409, 2.2780585289001465, 2.4610061645507812, 1.9520342350006104, 2.1103217601776123, 1.4251021146774292, 1.9499387741088867, 1.8731335401535034, 2.380411148071289, 0.7428792715072632, 2.2423596382141113, 3.4521772861480713, 3.1861939430236816, 3.248528003692627, 0.7037813663482666, 1.6820969581604004, 4.397462368011475, 2.310309410095215, 1.5581687688827515, 0.2191758155822754, 0.7416731715202332, 1.1154547929763794, 2.919734477996826, 3.82907772064209, 1.4991505146026611, 1.7221248149871826, 3.064213275909424, 3.0086448192596436, 1.9328219890594482, 4.073326110839844, 2.10709547996521, 2.5632615089416504, 2.5403196811676025, 2.5230698585510254, 2.6110851764678955, 2.0700807571411133, 3.8543877601623535, 2.741438150405884, 2.0307910442352295, 0.2275829315185547, 2.3201770782470703, 2.9793646335601807, 2.1681368350982666, 4.577040195465088, 1.9163950681686401, 1.7530951499938965, 3.3093066215515137, 3.4524030685424805, 0.4015309810638428, 3.2493512630462646], "mean_td_error": 2.463287115097046, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 49.0, "diff_num_grad_updates_vs_sampler_policy": 48.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.02381420135498, "actor_loss": -5.992874622344971, "critic_loss": 0.2700996398925781, "alpha_loss": -0.14444714784622192, "alpha_value": 0.9856929183006287, "log_alpha_value": -0.014410397969186306, "target_entropy": -6.0, "policy_t": -0.005628413986414671, "mean_q": 2.000450611114502, "max_q": 6.197975158691406, "min_q": 1.862300157546997}, "td_error": [1.4820642471313477, 0.284991979598999, 0.9327716827392578, 1.0719316005706787, 0.9436386227607727, 1.494187831878662, 1.3591084480285645, 1.1623337268829346, 0.27637529373168945, 0.8607974648475647, 1.7646652460098267, 4.237211227416992, 0.2850542664527893, 1.6685082912445068, 0.8644863367080688, 1.037304162979126, 0.7934258580207825, 1.3108479976654053, 0.11041843891143799, 2.646130084991455, 1.3813642263412476, 0.49584197998046875, 1.8710119724273682, 0.23756146430969238, 0.9754263758659363, 1.229097604751587, 0.3004964590072632, 1.5064902305603027, 1.6924103498458862, 0.11087727546691895, 1.9518307447433472, 0.3173558712005615, 0.5190109014511108, 0.5122311115264893, 2.1542725563049316, 0.4248376488685608, 2.116976261138916, 1.3708751201629639, 1.2978038787841797, 1.6904065608978271, 0.6534852981567383, 0.28685295581817627, 0.20250248908996582, 0.5416299700737, 0.10853826999664307, 0.7879151105880737, 1.3348912000656128, 1.9455063343048096, 0.8563835620880127, 0.9799500107765198, 1.0761559009552002, 1.1994044780731201, 2.903599262237549, 2.220411777496338, 0.48153936862945557, 1.3584038019180298, 0.5602099299430847, 0.8707770109176636, 1.7922885417938232, 0.7670979499816895, 1.2491493225097656, 1.8507277965545654, 1.9663257598876953, 0.3188741207122803, 2.2254538536071777, 2.027101993560791, 0.3968013525009155, 1.4626305103302002, 2.269909143447876, 0.22216272354125977, 0.20241737365722656, 1.091929316520691, 0.6198893189430237, 0.10244709253311157, 0.3595235347747803, 1.5301252603530884, 1.6505827903747559, 1.1594356298446655, 0.3576880693435669, 0.28329843282699585, 1.967005968093872, 0.1859898567199707, 2.488882541656494, 0.967893660068512, 1.792689561843872, 0.8875417709350586], "mean_td_error": 1.1314704418182373, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 49.0, "diff_num_grad_updates_vs_sampler_policy": 48.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.061718940734863, "actor_loss": -5.6837992668151855, "critic_loss": 0.20723429322242737, "alpha_loss": -0.14499394595623016, "alpha_value": 0.9856928586959839, "log_alpha_value": -0.014410455711185932, "target_entropy": -6.0, "policy_t": 0.033563680946826935, "mean_q": 1.7999590635299683, "max_q": 6.715421199798584, "min_q": 1.6333929300308228}, "td_error": [2.5109658241271973, 0.16670441627502441, 2.274538040161133, 2.095797300338745, 0.1961994171142578, 0.8879653215408325, 1.7208716869354248, 1.0227868556976318, 1.554938793182373, 0.3952159881591797, 0.6796107888221741, 0.5584201812744141, 1.6913368701934814, 0.7208609580993652, 2.2675130367279053, 0.6327111721038818, 1.0672346353530884, 3.9193506240844727, 2.392321825027466, 2.3766984939575195, 0.5152561068534851, 0.08608353137969971, 3.071796417236328, 2.816267490386963, 0.09268879890441895, 1.8622300624847412, 0.20755058526992798, 0.14817440509796143, 0.8189877271652222, 0.7978197932243347, 1.108167052268982, 1.8602803945541382, 0.7194057106971741, 0.2655676007270813, 2.933546543121338, 1.4437484741210938, 0.9831728935241699, 0.21769845485687256, 1.5203028917312622, 1.1658236980438232, 0.6392108201980591, 0.23753976821899414, 0.8673675060272217, 2.5450682640075684, 2.88647198677063, 0.475746214389801, 0.5746565461158752, 0.5757704973220825, 2.4520106315612793, 0.18478965759277344, 2.058314323425293, 0.6427996158599854, 1.5733482837677002, 0.8955885767936707, 0.4438983201980591, 0.30809783935546875, 1.4055988788604736, 1.4219741821289062, 1.2266767024993896, 0.14865779876708984, 0.15548861026763916, 1.709681510925293, 0.30202847719192505, 2.5667881965637207, 3.947573661804199, 0.06081736087799072, 1.0609992742538452, 0.062437593936920166, 0.24461275339126587, 2.191873073577881, 1.1009330749511719, 1.7458746433258057, 2.3213162422180176, 2.0273561477661133, 1.182144045829773, 1.9770708084106445, 1.0538631677627563, 0.7069083452224731, 0.02250880002975464, 1.855759859085083, 2.124791383743286, 1.9259674549102783, 0.0456966757774353, 1.1248414516448975, 4.702591896057129, 0.14279800653457642], "mean_td_error": 1.2754989862442017, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 49.0, "diff_num_grad_updates_vs_sampler_policy": 48.0}}, "num_env_steps_sampled": 44800, "num_env_steps_trained": 12642, "num_agent_steps_sampled": 134400, "num_agent_steps_trained": 12642, "last_target_update_ts": 44800, "num_target_updates": 49}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 134400, "num_agent_steps_trained": 12642, "num_env_steps_sampled": 44800, "num_env_steps_trained": 12642, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 827.2856336222449, "num_env_steps_trained_throughput_per_sec": 238.21394360997675, "timesteps_total": 44800, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 134400, "timers": {"training_iteration_time_ms": 1007.646, "sample_time_ms": 732.938, "load_time_ms": 0.313, "load_throughput": 823539.142, "learn_time_ms": 17.971, "learn_throughput": 14356.375, "synch_weights_time_ms": 9.714}, "counters": {"num_env_steps_sampled": 44800, "num_env_steps_trained": 12642, "num_agent_steps_sampled": 134400, "num_agent_steps_trained": 12642, "last_target_update_ts": 44800, "num_target_updates": 49}, "done": false, "episodes_total": 0, "training_iteration": 30, "trial_id": "cfa97_00000", "date": "2023-11-18_21-03-16", "timestamp": 1700370196, "time_this_iter_s": 1.0924310684204102, "time_total_s": 49.91853356361389, "pid": 6770, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17f308cc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 49.91853356361389, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 78.0, "ram_util_percent": 64.80000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.162934303283691, "actor_loss": -6.394683361053467, "critic_loss": 0.9591294527053833, "alpha_loss": -0.15255622565746307, "alpha_value": 0.985101044178009, "log_alpha_value": -0.015011043287813663, "target_entropy": -6.0, "policy_t": -0.021981654688715935, "mean_q": 2.6029577255249023, "max_q": 9.529712677001953, "min_q": 2.4121713638305664}, "td_error": [3.819746494293213, 1.6174882650375366, 1.7705004215240479, 3.5606613159179688, 3.4271657466888428, 2.748218536376953, 2.0073132514953613, 1.6070857048034668, 0.8033773899078369, 1.5849751234054565, 2.8051950931549072, 2.8560984134674072, 2.845205783843994, 3.285879135131836, 2.547417640686035, 1.8726651668548584, 2.004284620285034, 2.2920408248901367, 4.006397247314453, 4.021708965301514, 3.2408287525177, 3.4795045852661133, 1.6648037433624268, 0.5431078672409058, 1.8277207612991333, 3.4607739448547363, 2.304823398590088, 2.3349437713623047, 2.9749393463134766, 2.2461776733398438, 3.229369640350342, 2.8539252281188965, 3.6629669666290283, 2.1895337104797363, 0.8916174173355103, 1.525193691253662, 2.5404677391052246, 0.9116420745849609, 3.0245161056518555, 3.5759594440460205, 3.4499189853668213, 1.8594441413879395, 1.0487451553344727, 1.416252851486206, 3.099942684173584, 0.44587433338165283, 2.6053247451782227, 2.7959465980529785, 1.544586181640625, 2.167208433151245, 3.1683778762817383, 1.3022561073303223, 2.2764506340026855, 0.42927122116088867, 1.3010587692260742, 2.1877188682556152, 1.019643783569336, 2.141385793685913, 2.3435139656066895, 3.263171672821045, 2.3839595317840576, 1.3242480754852295, 1.7843716144561768, 3.1358604431152344, 2.4889943599700928, 1.6706372499465942, 2.622838020324707, 1.710930585861206, 1.6158902645111084, 1.3594826459884644, 4.022000312805176, 2.1641407012939453, 4.143294811248779, 1.2930775880813599, 2.305154800415039, 2.1446971893310547, 5.26591682434082, 2.3512749671936035, 2.9653472900390625, 0.7702184915542603, 1.4572545289993286, 0.8373090028762817, 0.9431406259536743, 3.7746028900146484, 4.084535598754883, 2.2588934898376465], "mean_td_error": 2.3338420391082764, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 51.0, "diff_num_grad_updates_vs_sampler_policy": 50.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.06369686126709, "actor_loss": -6.194550037384033, "critic_loss": 0.23681195080280304, "alpha_loss": -0.15105877816677094, "alpha_value": 0.9851018190383911, "log_alpha_value": -0.01501026563346386, "target_entropy": -6.0, "policy_t": -0.012595788575708866, "mean_q": 2.148613214492798, "max_q": 6.601519584655762, "min_q": 2.0197553634643555}, "td_error": [0.4701395034790039, 0.9607541561126709, 1.7668836116790771, 2.2928872108459473, 0.3466916084289551, 0.14705777168273926, 1.2027151584625244, 0.9922822713851929, 0.0943518877029419, 0.4582383632659912, 1.1303223371505737, 0.9369328022003174, 0.5699805021286011, 0.7162766456604004, 1.5197638273239136, 0.47387123107910156, 2.8112196922302246, 0.6267621517181396, 0.21800994873046875, 1.2662880420684814, 0.39504361152648926, 0.3550347089767456, 0.09486281871795654, 1.4922562837600708, 0.33059990406036377, 0.11260759830474854, 2.3923416137695312, 0.11055576801300049, 0.17888784408569336, 1.180484652519226, 2.4200801849365234, 0.7057850360870361, 0.6860530376434326, 0.39086055755615234, 0.4442315101623535, 0.09567689895629883, 0.23001599311828613, 0.4447360038757324, 1.6596453189849854, 0.6354590654373169, 1.9386816024780273, 1.9117133617401123, 0.7956743240356445, 0.7468080520629883, 0.3393981456756592, 0.4938035011291504, 0.9521735906600952, 0.6929178237915039, 1.3971056938171387, 0.2944422960281372, 0.17337369918823242, 0.2688537836074829, 1.7959198951721191, 0.3741391897201538, 0.5622127056121826, 1.1327332258224487, 0.3199959993362427, 0.18378615379333496, 2.4078550338745117, 1.6767916679382324, 0.5183289051055908, 1.4017915725708008, 3.167917251586914, 0.16996729373931885, 0.54078209400177, 1.6067992448806763, 0.42257416248321533, 1.362446665763855, 0.29442667961120605, 4.044428825378418, 0.7485179901123047, 0.1016378402709961, 0.8845540285110474, 1.9567137956619263, 0.16844654083251953, 2.128061056137085, 0.6856645345687866, 0.8165439367294312, 2.6586802005767822, 0.24669992923736572, 3.1818268299102783, 1.374957799911499, 1.8832038640975952, 2.253007411956787, 0.09996294975280762, 1.3900694847106934], "mean_td_error": 0.9991051554679871, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 51.0, "diff_num_grad_updates_vs_sampler_policy": 50.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.052699089050293, "actor_loss": -5.8140668869018555, "critic_loss": 0.1678093671798706, "alpha_loss": -0.15089541673660278, "alpha_value": 0.9851016402244568, "log_alpha_value": -0.015010437928140163, "target_entropy": -6.0, "policy_t": -0.010629936121404171, "mean_q": 2.036384344100952, "max_q": 6.639118194580078, "min_q": 1.7777271270751953}, "td_error": [2.3357396125793457, 1.1473987102508545, 0.41223734617233276, 0.3019571304321289, 1.4028599262237549, 0.22588610649108887, 1.6827348470687866, 1.9770286083221436, 0.662604808807373, 4.275474548339844, 0.33666735887527466, 1.0149260759353638, 0.24532055854797363, 0.4697992205619812, 0.7092235684394836, 0.4603690505027771, 0.3291686177253723, 0.6298646926879883, 0.6974563598632812, 0.7752143740653992, 0.3031092882156372, 2.7246439456939697, 0.024483442306518555, 0.3512258529663086, 0.6452216506004333, 1.7728805541992188, 0.7949922680854797, 0.2018892765045166, 0.6306073665618896, 0.20104581117630005, 0.2450898289680481, 1.7065600156784058, 2.538393259048462, 0.2397046685218811, 0.33220958709716797, 1.8044754266738892, 0.43011045455932617, 0.2924337387084961, 1.1803005933761597, 0.06072723865509033, 0.46937769651412964, 0.7807299494743347, 1.3855929374694824, 4.363572597503662, 0.9527338743209839, 3.0381507873535156, 1.9852120876312256, 2.692751884460449, 2.7854695320129395, 2.547804117202759, 0.6333345770835876, 0.7258546948432922, 0.7963261604309082, 0.5078309178352356, 1.081803321838379, 0.3617132902145386, 2.7829174995422363, 1.6814874410629272, 1.7390003204345703, 1.2104839086532593, 0.15171444416046143, 0.5247926115989685, 0.4708266854286194, 1.0902814865112305, 2.641190767288208, 0.011848926544189453, 3.0316238403320312, 0.7924018502235413, 0.9021623134613037, 0.011870026588439941, 0.4133152961730957, 0.09889709949493408, 1.7360339164733887, 1.6836910247802734, 0.26526814699172974, 1.3703277111053467, 1.6623812913894653, 1.0998201370239258, 2.292609691619873, 1.0792057514190674, 1.5063027143478394, 1.328371524810791, 0.25036293268203735, 0.9721171259880066, 0.1924668550491333, 0.3272799253463745], "mean_td_error": 1.1046669483184814, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 51.0, "diff_num_grad_updates_vs_sampler_policy": 50.0}}, "num_env_steps_sampled": 46592, "num_env_steps_trained": 13158, "num_agent_steps_sampled": 139776, "num_agent_steps_trained": 13158, "last_target_update_ts": 46592, "num_target_updates": 51}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 139776, "num_agent_steps_trained": 13158, "num_env_steps_sampled": 46592, "num_env_steps_trained": 13158, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 808.9989860863493, "num_env_steps_trained_throughput_per_sec": 232.9483687614711, "timesteps_total": 46592, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 139776, "timers": {"training_iteration_time_ms": 1039.929, "sample_time_ms": 737.723, "load_time_ms": 0.312, "load_throughput": 825612.598, "learn_time_ms": 17.948, "learn_throughput": 14375.237, "synch_weights_time_ms": 9.801}, "counters": {"num_env_steps_sampled": 46592, "num_env_steps_trained": 13158, "num_agent_steps_sampled": 139776, "num_agent_steps_trained": 13158, "last_target_update_ts": 46592, "num_target_updates": 51}, "done": false, "episodes_total": 0, "training_iteration": 31, "trial_id": "cfa97_00000", "date": "2023-11-18_21-03-18", "timestamp": 1700370198, "time_this_iter_s": 2.2236979007720947, "time_total_s": 52.142231464385986, "pid": 6770, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17f28efc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 52.142231464385986, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 64.5, "ram_util_percent": 64.66666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.086845397949219, "actor_loss": -6.547172546386719, "critic_loss": 0.8307576179504395, "alpha_loss": -0.15747272968292236, "alpha_value": 0.9845095276832581, "log_alpha_value": -0.015611693263053894, "target_entropy": -6.0, "policy_t": -0.046088721603155136, "mean_q": 2.8137779235839844, "max_q": 8.736806869506836, "min_q": 2.6171774864196777}, "td_error": [2.0651800632476807, 2.21419620513916, 3.114792823791504, 0.753856897354126, 1.8601408004760742, 1.4184892177581787, 4.085007667541504, 2.684972047805786, 3.2167487144470215, 0.36942338943481445, 3.1495275497436523, 1.5404387712478638, 0.7907314300537109, 4.082125186920166, 2.774466037750244, 2.563835382461548, 2.2748026847839355, 0.2840538024902344, 3.062962770462036, 2.48833966255188, 2.2342774868011475, 2.314751148223877, 0.8297066688537598, 1.6064014434814453, 2.6286840438842773, 2.5183074474334717, 1.8006417751312256, 2.0031564235687256, 3.6345181465148926, 2.8266632556915283, 3.4271607398986816, 1.500691294670105, 2.105830192565918, 2.592838764190674, 1.812462329864502, 1.19899582862854, 2.340616226196289, 3.260108232498169, 0.5583645105361938, 1.629978895187378, 2.026885747909546, 4.488502025604248, 3.574061155319214, 2.951904058456421, 1.1540762186050415, 2.323913097381592, 0.5669502019882202, 3.0766172409057617, 2.0085997581481934, 1.7747156620025635, 1.131069540977478, 0.9264564514160156, 2.9139015674591064, 1.8853710889816284, 1.327331304550171, 2.096233367919922, 2.067869186401367, 2.803065299987793, 0.8464291095733643, 0.8044856786727905, 2.1398324966430664, 1.4658528566360474, 0.6174993515014648, 3.1145176887512207, 3.7395613193511963, 1.0461814403533936, 2.595595121383667, 1.5937687158584595, 2.1299333572387695, 0.66617751121521, 0.3690584897994995, 3.3875303268432617, 3.597372531890869, 1.2777624130249023, 1.6477031707763672, 2.25479793548584, 0.2570455074310303, 3.333761215209961, 0.87237548828125, 2.0398385524749756, 3.9605579376220703, 2.1234869956970215, 2.967617988586426, 2.8016295433044434, 1.5504556894302368, 2.52034068107605], "mean_td_error": 2.1213598251342773, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 53.0, "diff_num_grad_updates_vs_sampler_policy": 52.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.125751495361328, "actor_loss": -6.4177117347717285, "critic_loss": 0.2562817931175232, "alpha_loss": -0.15806518495082855, "alpha_value": 0.9845110177993774, "log_alpha_value": -0.015610217116773129, "target_entropy": -6.0, "policy_t": 0.013378269039094448, "mean_q": 2.403331756591797, "max_q": 6.460204601287842, "min_q": 2.1781527996063232}, "td_error": [3.4493517875671387, 0.7446526288986206, 0.13939058780670166, 0.8962244987487793, 1.7304339408874512, 2.3135223388671875, 0.26733994483947754, 0.4755324125289917, 0.40308070182800293, 0.7474981546401978, 0.1966235637664795, 1.930915355682373, 0.9286395311355591, 2.5029282569885254, 1.4642994403839111, 1.5526912212371826, 1.4381004571914673, 0.30622243881225586, 0.36147141456604004, 0.14461100101470947, 1.862854242324829, 1.1786023378372192, 1.0789085626602173, 0.7021317481994629, 0.38932013511657715, 2.331930637359619, 1.227723240852356, 0.9690775871276855, 1.5198168754577637, 1.2819432020187378, 0.7075700759887695, 1.5842392444610596, 0.2572009563446045, 1.5751924514770508, 0.7426544427871704, 1.3779242038726807, 0.11088109016418457, 0.9143133163452148, 0.3255964517593384, 0.7053020000457764, 0.8002707958221436, 0.40677928924560547, 1.3821220397949219, 0.09571468830108643, 0.11654281616210938, 1.6787925958633423, 1.761321783065796, 1.2482396364212036, 1.3794937133789062, 1.2520185708999634, 1.0078258514404297, 0.8431901931762695, 0.8136942386627197, 0.47752535343170166, 2.8615357875823975, 1.2253297567367554, 0.09573495388031006, 1.1249496936798096, 0.28823983669281006, 1.058427333831787, 0.9178887605667114, 2.2564120292663574, 0.37792885303497314, 0.1738288402557373, 1.5701045989990234, 3.3798277378082275, 1.5096590518951416, 0.8975939750671387, 0.3785351514816284, 1.383838176727295, 1.3473546504974365, 0.3156634569168091, 0.09063911437988281, 0.478310227394104, 1.1492865085601807, 0.8483084440231323, 0.3987337350845337, 1.8669559955596924, 0.4211430549621582, 5.404868125915527, 0.10013222694396973, 1.2508410215377808, 0.4160383939743042, 0.11299002170562744, 0.7985481023788452, 1.7952033281326294], "mean_td_error": 1.0743614435195923, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 53.0, "diff_num_grad_updates_vs_sampler_policy": 52.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.12272834777832, "actor_loss": -6.008991241455078, "critic_loss": 0.1546216905117035, "alpha_loss": -0.15801601111888885, "alpha_value": 0.9845111966133118, "log_alpha_value": -0.015610023401677608, "target_entropy": -6.0, "policy_t": 0.01815824769437313, "mean_q": 2.113182544708252, "max_q": 5.999701976776123, "min_q": 1.926085352897644}, "td_error": [1.517053484916687, 1.621445894241333, 0.8873738646507263, 0.9654621481895447, 2.338958501815796, 0.44872546195983887, 3.039853572845459, 0.29828184843063354, 0.7784047722816467, 0.5628891587257385, 0.42875736951828003, 4.612301826477051, 1.4530971050262451, 1.1491892337799072, 0.5965455174446106, 1.6980805397033691, 2.3356447219848633, 2.9176206588745117, 0.5000784397125244, 2.544360876083374, 0.4516652822494507, 0.47527748346328735, 1.320845365524292, 0.3944670557975769, 0.33006811141967773, 1.2885167598724365, 0.6380797028541565, 1.2956997156143188, 0.8372530341148376, 0.9391947984695435, 0.670097827911377, 0.9268639087677002, 0.2677501440048218, 1.7174677848815918, 0.37814992666244507, 2.819885015487671, 0.9247683882713318, 0.6724463105201721, 4.677798748016357, 0.14151525497436523, 1.467591404914856, 0.786247193813324, 0.3167238235473633, 2.0632376670837402, 0.43870997428894043, 0.2708032727241516, 0.261279821395874, 1.9190583229064941, 0.12706565856933594, 0.1107073426246643, 0.2850853204727173, 1.9475042819976807, 0.8091470003128052, 0.029912710189819336, 1.12129545211792, 1.7737374305725098, 1.1242637634277344, 0.9842473268508911, 0.0391467809677124, 0.2449226975440979, 0.7899690270423889, 0.23245632648468018, 1.3219311237335205, 0.4121361970901489, 0.6672456860542297, 2.011641502380371, 1.1541576385498047, 1.06840181350708, 0.5711731314659119, 2.751361846923828, 1.0713284015655518, 0.6964720487594604, 0.7497110366821289, 0.2143842577934265, 0.14963656663894653, 1.0854800939559937, 0.18778592348098755, 1.871263027191162, 1.2035057544708252, 0.46179455518722534, 0.30760324001312256, 0.5945646166801453, 0.683479905128479, 1.3944087028503418, 2.1527655124664307, 1.3519039154052734], "mean_td_error": 1.0830137729644775, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 53.0, "diff_num_grad_updates_vs_sampler_policy": 52.0}}, "num_env_steps_sampled": 48384, "num_env_steps_trained": 13674, "num_agent_steps_sampled": 145152, "num_agent_steps_trained": 13674, "last_target_update_ts": 48384, "num_target_updates": 53}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 145152, "num_agent_steps_trained": 13674, "num_env_steps_sampled": 48384, "num_env_steps_trained": 13674, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 927.1992993138704, "num_env_steps_trained_throughput_per_sec": 266.98372681136, "timesteps_total": 48384, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 145152, "timers": {"training_iteration_time_ms": 1045.251, "sample_time_ms": 742.481, "load_time_ms": 0.311, "load_throughput": 830045.587, "learn_time_ms": 17.998, "learn_throughput": 14334.809, "synch_weights_time_ms": 9.999}, "counters": {"num_env_steps_sampled": 48384, "num_env_steps_trained": 13674, "num_agent_steps_sampled": 145152, "num_agent_steps_trained": 13674, "last_target_update_ts": 48384, "num_target_updates": 53}, "done": false, "episodes_total": 0, "training_iteration": 32, "trial_id": "cfa97_00000", "date": "2023-11-18_21-03-20", "timestamp": 1700370200, "time_this_iter_s": 1.9416139125823975, "time_total_s": 54.083845376968384, "pid": 6770, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17f28f420>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 54.083845376968384, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 65.26666666666667, "ram_util_percent": 64.83333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.060375213623047, "actor_loss": -6.711607456207275, "critic_loss": 0.8331124782562256, "alpha_loss": -0.16310089826583862, "alpha_value": 0.9839184880256653, "log_alpha_value": -0.016212208196520805, "target_entropy": -6.0, "policy_t": -0.03807979077100754, "mean_q": 3.0050368309020996, "max_q": 11.04220962524414, "min_q": 2.8358964920043945}, "td_error": [0.33453965187072754, 2.5809125900268555, 1.0638697147369385, 1.6451727151870728, 3.6574244499206543, 2.3763351440429688, 1.890667200088501, 2.5410897731781006, 0.5400859117507935, 2.3675947189331055, 2.1805014610290527, 0.5308430194854736, 2.517822265625, 1.711066722869873, 1.2694612741470337, 2.393028736114502, 1.494512915611267, 3.668397903442383, 1.3826996088027954, 2.423126459121704, 2.97451114654541, 2.935260772705078, 2.565683364868164, 0.8021576404571533, 1.8629562854766846, 0.642790675163269, 2.5351219177246094, 0.17518115043640137, 2.065682888031006, 2.0913052558898926, 2.6707980632781982, 0.31815338134765625, 0.2974677085876465, 1.6513644456863403, 3.3621137142181396, 2.3476710319519043, 1.7115137577056885, 0.5359951257705688, 1.1919511556625366, 2.657928466796875, 1.8321001529693604, 1.8624184131622314, 3.1819000244140625, 1.925832748413086, 4.6067352294921875, 2.8456368446350098, 3.902574300765991, 0.8357371091842651, 3.2723398208618164, 4.556160926818848, 1.5928971767425537, 1.9591861963272095, 3.742810010910034, 2.919356107711792, 3.6141252517700195, 1.153588056564331, 3.1807124614715576, 2.1857402324676514, 2.157010555267334, 5.742846965789795, 1.055343508720398, 3.1932740211486816, 0.17528319358825684, 0.17492294311523438, 1.8183482885360718, 2.5655221939086914, 0.7395747900009155, 3.8941688537597656, 0.931851863861084, 1.755527138710022, 2.892523765563965, 1.7760021686553955, 2.5078022480010986, 2.6197009086608887, 3.612666606903076, 0.5366983413696289, 2.8522520065307617, 3.0384159088134766, 2.684401035308838, 0.9797943830490112, 2.315730571746826, 0.5309215784072876, 1.6361497640609741, 2.365161895751953, 4.406455039978027, 1.9259048700332642], "mean_td_error": 2.139754295349121, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 55.0, "diff_num_grad_updates_vs_sampler_policy": 54.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.004598617553711, "actor_loss": -6.5090765953063965, "critic_loss": 0.2467987835407257, "alpha_loss": -0.16218037903308868, "alpha_value": 0.9839200973510742, "log_alpha_value": -0.016210582107305527, "target_entropy": -6.0, "policy_t": -0.00015381233242806047, "mean_q": 2.438542604446411, "max_q": 6.1764020919799805, "min_q": 2.3308637142181396}, "td_error": [0.753187894821167, 1.6070656776428223, 1.1354484558105469, 0.1368032693862915, 0.4454164505004883, 1.158550500869751, 2.1304733753204346, 1.3269858360290527, 0.7373565435409546, 1.4002474546432495, 0.4213780164718628, 0.6332371234893799, 0.5790349245071411, 0.677762508392334, 1.2787915468215942, 0.4950261116027832, 0.13933038711547852, 1.2659051418304443, 0.7397047281265259, 0.7202390432357788, 2.7210025787353516, 0.8505591154098511, 0.616663932800293, 1.1934480667114258, 2.717423915863037, 1.7572484016418457, 1.1191855669021606, 0.22429633140563965, 0.5810247659683228, 1.725637435913086, 0.8604662418365479, 0.6291266679763794, 1.2239292860031128, 0.5866849422454834, 0.8162645101547241, 1.6254576444625854, 1.0142573118209839, 1.8040424585342407, 1.347520112991333, 0.37001967430114746, 0.9876817464828491, 0.6077872514724731, 0.430324912071228, 0.3494563102722168, 2.5466480255126953, 0.8837170600891113, 0.09867310523986816, 0.2611393928527832, 0.4435765743255615, 1.116395354270935, 1.3022453784942627, 2.53607177734375, 0.09138882160186768, 1.4239439964294434, 0.8343195915222168, 1.5300860404968262, 0.10536050796508789, 1.0015363693237305, 1.7444044351577759, 1.3174344301223755, 0.15136897563934326, 1.3886233568191528, 0.7261028289794922, 0.30004656314849854, 0.26986777782440186, 1.3957440853118896, 0.09036314487457275, 0.5821998119354248, 0.8050191402435303, 0.9756598472595215, 0.6549991369247437, 2.8115808963775635, 1.5053213834762573, 1.382726788520813, 1.2864651679992676, 2.5484976768493652, 0.0892190933227539, 0.5595753192901611, 0.12922298908233643, 0.7774299383163452, 0.3452528715133667, 0.8396377563476562, 2.288369655609131, 3.2931058406829834, 0.25398194789886475, 2.949024200439453], "mean_td_error": 1.041602373123169, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 55.0, "diff_num_grad_updates_vs_sampler_policy": 54.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.105813026428223, "actor_loss": -6.145498752593994, "critic_loss": 0.12023669481277466, "alpha_loss": -0.16381266713142395, "alpha_value": 0.9839209318161011, "log_alpha_value": -0.016209745779633522, "target_entropy": -6.0, "policy_t": -0.011487534269690514, "mean_q": 2.123661518096924, "max_q": 4.839791297912598, "min_q": 1.9878774881362915}, "td_error": [0.4397376775741577, 0.1821373701095581, 0.20390808582305908, 2.223860740661621, 1.1138625144958496, 0.12741196155548096, 0.5222218036651611, 0.019568800926208496, 0.17386364936828613, 0.19242382049560547, 0.2815511226654053, 0.3415541648864746, 1.1454548835754395, 0.25385189056396484, 0.6043779850006104, 2.4764814376831055, 1.1100947856903076, 1.3511059284210205, 0.6884368658065796, 0.8001077175140381, 1.7472655773162842, 0.5536700487136841, 0.8348820209503174, 1.5543642044067383, 1.7051658630371094, 1.0301568508148193, 2.6543867588043213, 2.106876850128174, 0.8535935878753662, 0.8249391317367554, 0.849036693572998, 1.4277539253234863, 1.9860795736312866, 2.066587209701538, 0.4155629873275757, 0.504382848739624, 0.3101503252983093, 0.032721757888793945, 1.3072469234466553, 1.4450221061706543, 0.8338350057601929, 0.12371265888214111, 0.39172542095184326, 1.6667189598083496, 0.2416703701019287, 0.08844578266143799, 1.591066837310791, 0.8568770885467529, 0.11803209781646729, 1.7848466634750366, 0.5159778594970703, 0.49475324153900146, 0.785183310508728, 0.1231919527053833, 1.2478253841400146, 1.0028207302093506, 2.0041098594665527, 2.4978387355804443, 0.6239906549453735, 1.1265552043914795, 0.25445473194122314, 0.15029454231262207, 0.7458081245422363, 1.1257636547088623, 0.327267050743103, 2.1564130783081055, 1.577500343322754, 1.1523915529251099, 1.3664355278015137, 0.8257322311401367, 0.4268021583557129, 0.5735433101654053, 0.7244143486022949, 0.42066144943237305, 0.7990809679031372, 0.08736312389373779, 0.45073091983795166, 0.7514573335647583, 0.8691403865814209, 0.5060521364212036, 0.688167929649353, 0.5525832176208496, 0.34041428565979004, 1.7438442707061768, 0.14599096775054932, 1.2034753561019897], "mean_td_error": 0.8900792598724365, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 55.0, "diff_num_grad_updates_vs_sampler_policy": 54.0}}, "num_env_steps_sampled": 50176, "num_env_steps_trained": 14190, "num_agent_steps_sampled": 150528, "num_agent_steps_trained": 14190, "last_target_update_ts": 50176, "num_target_updates": 55}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 150528, "num_agent_steps_trained": 14190, "num_env_steps_sampled": 50176, "num_env_steps_trained": 14190, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 910.4178109785626, "num_env_steps_trained_throughput_per_sec": 262.15155717909505, "timesteps_total": 50176, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 150528, "timers": {"training_iteration_time_ms": 1027.161, "sample_time_ms": 724.183, "load_time_ms": 0.314, "load_throughput": 822100.153, "learn_time_ms": 17.95, "learn_throughput": 14373.289, "synch_weights_time_ms": 9.593}, "counters": {"num_env_steps_sampled": 50176, "num_env_steps_trained": 14190, "num_agent_steps_sampled": 150528, "num_agent_steps_trained": 14190, "last_target_update_ts": 50176, "num_target_updates": 55}, "done": false, "episodes_total": 0, "training_iteration": 33, "trial_id": "cfa97_00000", "date": "2023-11-18_21-03-22", "timestamp": 1700370202, "time_this_iter_s": 1.9778850078582764, "time_total_s": 56.06173038482666, "pid": 6770, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17f28f240>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 56.06173038482666, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 68.93333333333334, "ram_util_percent": 64.76666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.129640579223633, "actor_loss": -6.858639240264893, "critic_loss": 0.9772452116012573, "alpha_loss": -0.16726431250572205, "alpha_value": 0.983623206615448, "log_alpha_value": -0.01651236228644848, "target_entropy": -6.0, "policy_t": -0.006192546803504229, "mean_q": 3.466583013534546, "max_q": 13.334227561950684, "min_q": 2.951111316680908}, "td_error": [0.8543241024017334, 2.2909443378448486, 1.7391014099121094, 2.384873390197754, 2.3456337451934814, 3.6141419410705566, 1.9842445850372314, 0.7803788185119629, 0.5184532403945923, 2.4247050285339355, 3.985325574874878, 2.989337921142578, 1.7228727340698242, 1.6881932020187378, 2.3267931938171387, 0.651235818862915, 2.674042224884033, 0.6023284196853638, 3.8403210639953613, 0.8012208938598633, 1.6037019491195679, 0.471643328666687, 3.2695789337158203, 0.6410677433013916, 2.2761189937591553, 3.3665974140167236, 0.3291940689086914, 1.8819612264633179, 7.743530750274658, 2.2016515731811523, 1.4050827026367188, 3.247450828552246, 2.713263988494873, 2.13449764251709, 2.4952456951141357, 6.600460529327393, 3.637356758117676, 0.949211597442627, 3.099294424057007, 1.617236852645874, 2.374377727508545, 2.9485585689544678, 1.8650476932525635, 1.7398262023925781, 2.6133921146392822, 2.3954648971557617, 3.3073620796203613, 3.8870606422424316, 1.1993709802627563, 2.100797414779663, 2.226520299911499, 1.7087715864181519, 0.2841060161590576, 0.8415007591247559, 1.7558642625808716, 2.204932689666748, 2.8244431018829346, 2.7111291885375977, 1.4192867279052734, 3.0826120376586914, 2.178891181945801, 4.277060508728027, 1.7463628053665161, 0.9205840826034546, 2.544192314147949, 1.857247233390808, 1.5528228282928467, 2.9757394790649414, 3.3924384117126465, 3.609968900680542, 2.6266493797302246, 3.010544776916504, 2.0332741737365723, 2.4562745094299316, 0.2746260166168213, 4.2214765548706055, 2.230257272720337, 3.5218353271484375, 2.8503732681274414, 8.433103561401367, 0.27711737155914307, 2.906259059906006, 2.830763339996338, 0.7306658029556274, 0.8402475118637085, 3.9440155029296875], "mean_td_error": 2.367858648300171, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 56.0, "diff_num_grad_updates_vs_sampler_policy": 55.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.107171058654785, "actor_loss": -6.582380294799805, "critic_loss": 0.15894386172294617, "alpha_loss": -0.1668751835823059, "alpha_value": 0.9836249947547913, "log_alpha_value": -0.01651057042181492, "target_entropy": -6.0, "policy_t": 0.026654232293367386, "mean_q": 2.4812166690826416, "max_q": 4.608309745788574, "min_q": 2.3716564178466797}, "td_error": [0.15486788749694824, 0.09030890464782715, 0.8610801696777344, 1.15969979763031, 0.6026768684387207, 0.3698573112487793, 1.2747607231140137, 0.09087204933166504, 1.054308295249939, 0.8050527572631836, 0.46487414836883545, 2.519976854324341, 0.1214590072631836, 1.0737955570220947, 0.27760303020477295, 1.183478593826294, 0.5905725955963135, 0.3212442398071289, 0.13923656940460205, 1.0229885578155518, 0.1765592098236084, 1.3017585277557373, 0.8966354131698608, 2.0619864463806152, 0.09576141834259033, 0.444785475730896, 1.3924956321716309, 2.084697723388672, 0.08021926879882812, 0.5570111274719238, 0.16896653175354004, 0.42936861515045166, 1.9158549308776855, 0.4986538887023926, 0.19486582279205322, 0.0884782075881958, 0.4706001281738281, 1.651406168937683, 0.1959834098815918, 0.40436065196990967, 1.2245208024978638, 1.1778274774551392, 1.981475830078125, 0.506324052810669, 2.256561517715454, 0.12961256504058838, 1.4535008668899536, 0.2477121353149414, 1.0225718021392822, 0.25271809101104736, 0.6461422443389893, 0.2844895124435425, 0.5897778272628784, 0.5740631818771362, 0.4479396343231201, 0.11166298389434814, 0.531490683555603, 0.6990189552307129, 0.3673022985458374, 0.2918267250061035, 0.08989214897155762, 1.060013771057129, 0.35993754863739014, 2.1848955154418945, 0.8184306621551514, 1.0313407182693481, 0.23845994472503662, 0.6280612945556641, 1.6034784317016602, 0.30384159088134766, 0.47916877269744873, 1.6533117294311523, 0.34416651725769043, 0.696342945098877, 0.25583505630493164, 1.0658583641052246, 0.08842349052429199, 1.632755994796753, 2.1298468112945557, 0.8824424743652344, 1.1534419059753418, 0.9163848161697388, 0.2919689416885376, 0.7245756387710571, 1.265966534614563, 0.27934300899505615], "mean_td_error": 0.7705103158950806, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 56.0, "diff_num_grad_updates_vs_sampler_policy": 55.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.146855354309082, "actor_loss": -6.245397567749023, "critic_loss": 0.15547658503055573, "alpha_loss": -0.16752120852470398, "alpha_value": 0.9836258888244629, "log_alpha_value": -0.01650966703891754, "target_entropy": -6.0, "policy_t": 0.004291090648621321, "mean_q": 2.3852949142456055, "max_q": 6.26283073425293, "min_q": 2.145925283432007}, "td_error": [0.5907131433486938, 0.5278713703155518, 0.29935503005981445, 1.6726799011230469, 0.8827782869338989, 0.2763882875442505, 1.1776622533798218, 0.5863837003707886, 0.47565793991088867, 2.661583662033081, 1.6870074272155762, 1.793173909187317, 0.3195072412490845, 0.11107063293457031, 1.388994812965393, 0.7289321422576904, 3.4119369983673096, 1.9044524431228638, 0.8109500408172607, 1.1882392168045044, 0.7831268310546875, 1.1830638647079468, 0.4956386089324951, 0.9042632579803467, 0.5719128847122192, 0.6783010959625244, 0.32562005519866943, 0.39364194869995117, 0.5736937522888184, 0.630295991897583, 2.073681354522705, 2.192006826400757, 0.08834469318389893, 0.25165843963623047, 0.36705243587493896, 1.7846176624298096, 0.8269863128662109, 1.0848761796951294, 1.1247999668121338, 2.0395760536193848, 0.8207910060882568, 0.113311767578125, 1.4710578918457031, 0.12339699268341064, 1.1519618034362793, 0.14406120777130127, 1.884580373764038, 0.7955152988433838, 0.5489401817321777, 0.429787278175354, 0.5762629508972168, 0.5087683200836182, 3.014188528060913, 0.25336790084838867, 1.281798243522644, 0.48307228088378906, 3.0076041221618652, 2.810154438018799, 0.09043192863464355, 1.087518572807312, 0.9051303863525391, 2.0636940002441406, 1.2459784746170044, 0.44835150241851807, 0.4530913829803467, 1.028538465499878, 1.8734428882598877, 2.1394336223602295, 1.0700201988220215, 1.0898985862731934, 0.7510267496109009, 0.5166276693344116, 0.6118999719619751, 2.174346923828125, 2.7310779094696045, 0.5950443744659424, 0.8487266302108765, 2.707015037536621, 2.1579854488372803, 0.2593238353729248, 0.15638744831085205, 2.1284029483795166, 0.8027266263961792, 0.5108662843704224, 1.307634949684143, 0.7884602546691895], "mean_td_error": 1.0794209241867065, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 56.0, "diff_num_grad_updates_vs_sampler_policy": 55.0}}, "num_env_steps_sampled": 51072, "num_env_steps_trained": 14448, "num_agent_steps_sampled": 153216, "num_agent_steps_trained": 14448, "last_target_update_ts": 51072, "num_target_updates": 56}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 153216, "num_agent_steps_trained": 14448, "num_env_steps_sampled": 51072, "num_env_steps_trained": 14448, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 824.655012953203, "num_env_steps_trained_throughput_per_sec": 237.45646578339998, "timesteps_total": 51072, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 153216, "timers": {"training_iteration_time_ms": 1036.828, "sample_time_ms": 733.156, "load_time_ms": 0.315, "load_throughput": 819423.317, "learn_time_ms": 17.91, "learn_throughput": 14404.993, "synch_weights_time_ms": 9.804}, "counters": {"num_env_steps_sampled": 51072, "num_env_steps_trained": 14448, "num_agent_steps_sampled": 153216, "num_agent_steps_trained": 14448, "last_target_update_ts": 51072, "num_target_updates": 56}, "done": false, "episodes_total": 0, "training_iteration": 34, "trial_id": "cfa97_00000", "date": "2023-11-18_21-03-24", "timestamp": 1700370204, "time_this_iter_s": 1.0947341918945312, "time_total_s": 57.15646457672119, "pid": 6770, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17f308680>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 57.15646457672119, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 71.1, "ram_util_percent": 65.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.090298652648926, "actor_loss": -6.897292613983154, "critic_loss": 0.7909709215164185, "alpha_loss": -0.16964410245418549, "alpha_value": 0.9833279252052307, "log_alpha_value": -0.01681259460747242, "target_entropy": -6.0, "policy_t": 0.016305778175592422, "mean_q": 3.4040119647979736, "max_q": 12.353033065795898, "min_q": 3.066898822784424}, "td_error": [1.6560629606246948, 1.0535470247268677, 2.909480571746826, 1.4065546989440918, 0.25961923599243164, 1.3782329559326172, 1.985058307647705, 0.5609701871871948, 0.8289984464645386, 4.142314910888672, 1.8198336362838745, 3.812828540802002, 2.985471248626709, 1.4766701459884644, 0.3534061908721924, 1.6743031740188599, 0.9181829690933228, 4.256645202636719, 2.3558335304260254, 2.8476948738098145, 4.185117721557617, 1.8036936521530151, 2.922118663787842, 1.4202934503555298, 1.701657772064209, 2.543646812438965, 0.9437562227249146, 1.457821249961853, 2.5235066413879395, 1.6105644702911377, 2.12929105758667, 1.6630676984786987, 1.774049997329712, 2.5386557579040527, 1.599921703338623, 0.3299607038497925, 2.8102498054504395, 1.2556527853012085, 0.29522061347961426, 2.231815814971924, 2.0186572074890137, 3.1566593647003174, 2.4932379722595215, 3.0885703563690186, 1.2753431797027588, 1.4689197540283203, 1.4155120849609375, 1.3031411170959473, 3.5798847675323486, 2.3078043460845947, 2.0483527183532715, 2.3560190200805664, 2.7409417629241943, 2.8858094215393066, 0.5814712047576904, 2.2686049938201904, 7.2415876388549805, 2.442502021789551, 2.117309093475342, 2.3612236976623535, 0.7254297733306885, 0.18134748935699463, 2.279555320739746, 3.055574893951416, 3.2909963130950928, 0.9657806158065796, 1.1641225814819336, 1.6440045833587646, 1.9631212949752808, 0.8326913118362427, 1.230924129486084, 2.8700714111328125, 1.4451408386230469, 1.1528185606002808, 1.2377574443817139, 1.366682529449463, 0.31953930854797363, 1.1327764987945557, 1.8034307956695557, 0.2641162872314453, 3.1798059940338135, 1.4576483964920044, 1.5719157457351685, 2.281323194503784, 4.232846260070801, 0.35269832611083984], "mean_td_error": 1.9485516548156738, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 57.0, "diff_num_grad_updates_vs_sampler_policy": 56.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.086917877197266, "actor_loss": -6.645446300506592, "critic_loss": 0.2139115333557129, "alpha_loss": -0.16956724226474762, "alpha_value": 0.9833298921585083, "log_alpha_value": -0.01681060902774334, "target_entropy": -6.0, "policy_t": 0.009771197102963924, "mean_q": 2.534259796142578, "max_q": 3.619703769683838, "min_q": 2.3747830390930176}, "td_error": [0.5736842155456543, 1.5279425382614136, 0.514167070388794, 1.9101446866989136, 0.7579027414321899, 0.28795862197875977, 1.7299374341964722, 0.9128347635269165, 0.9638502597808838, 0.6849758625030518, 1.458026647567749, 1.4243013858795166, 1.0620856285095215, 1.165986180305481, 0.21983325481414795, 0.2591150999069214, 0.30474209785461426, 0.8457996845245361, 1.1705598831176758, 0.23807621002197266, 0.6506994962692261, 3.412444591522217, 0.8789588212966919, 0.9385197162628174, 0.07976663112640381, 0.6210230588912964, 0.18863379955291748, 0.13367676734924316, 0.3230557441711426, 0.35273659229278564, 0.98218834400177, 0.8123947381973267, 1.6691079139709473, 1.9979290962219238, 2.094938039779663, 0.3440840244293213, 0.8438173532485962, 0.3293255567550659, 1.4489545822143555, 0.6514010429382324, 1.099384069442749, 1.593954086303711, 1.2388019561767578, 0.819161057472229, 1.4888750314712524, 1.2821840047836304, 1.5014547109603882, 1.0682777166366577, 1.613265037536621, 0.585456132888794, 1.7376694679260254, 0.934821605682373, 0.5819352865219116, 0.21274006366729736, 1.3953895568847656, 0.2910621166229248, 1.2230786085128784, 1.3383952379226685, 1.169116735458374, 1.0338544845581055, 0.3566303253173828, 0.37619197368621826, 0.16117370128631592, 2.516204595565796, 0.5310250520706177, 0.6068803071975708, 1.3371857404708862, 0.9439369440078735, 1.499559760093689, 0.8083722591400146, 1.999570608139038, 0.3992278575897217, 0.7210462093353271, 0.7624578475952148, 1.673570156097412, 1.92839777469635, 0.1463303565979004, 0.8425061702728271, 0.4044684171676636, 0.4995076656341553, 2.2231500148773193, 1.007713794708252, 0.674114465713501, 1.2406731843948364, 1.5101622343063354, 1.0569133758544922], "mean_td_error": 0.9907143115997314, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 57.0, "diff_num_grad_updates_vs_sampler_policy": 56.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.109089851379395, "actor_loss": -6.276691436767578, "critic_loss": 0.11268042027950287, "alpha_loss": -0.16993121802806854, "alpha_value": 0.9833307266235352, "log_alpha_value": -0.016809742897748947, "target_entropy": -6.0, "policy_t": 0.006930204574018717, "mean_q": 2.405418634414673, "max_q": 6.111598968505859, "min_q": 2.072178602218628}, "td_error": [0.3887150287628174, 0.14693975448608398, 0.08968901634216309, 0.021643638610839844, 1.063503623008728, 1.017781138420105, 0.45037269592285156, 0.36897361278533936, 0.20116102695465088, 0.7243646383285522, 2.1835014820098877, 1.4322336912155151, 0.7226409912109375, 0.8072216510772705, 0.6205542087554932, 0.6216897964477539, 0.36069345474243164, 0.4746965169906616, 1.3052583932876587, 1.679423451423645, 0.5567353963851929, 0.3003426790237427, 0.6440858840942383, 1.3032572269439697, 0.5133174657821655, 0.1409778594970703, 0.2889801263809204, 0.9631173610687256, 0.01871025562286377, 0.13083529472351074, 0.050551533699035645, 0.2530885934829712, 1.61777663230896, 0.17177140712738037, 0.04902541637420654, 0.9768582582473755, 1.026766061782837, 0.5722339153289795, 0.27189624309539795, 4.313324928283691, 0.19475221633911133, 1.2505935430526733, 1.3884097337722778, 0.13161087036132812, 0.4593505859375, 1.397420883178711, 2.631401538848877, 1.1180847883224487, 1.813826084136963, 0.017618417739868164, 1.0603300333023071, 0.5461282730102539, 0.1605774164199829, 1.0787254571914673, 1.0438628196716309, 0.4210602045059204, 0.6739009618759155, 0.5609608888626099, 1.154197335243225, 1.0668882131576538, 0.7611136436462402, 1.6795717477798462, 0.7643659114837646, 0.2865647077560425, 0.8284276723861694, 0.6155598163604736, 2.56567645072937, 1.899219036102295, 0.7242484092712402, 0.9579730033874512, 0.9813385009765625, 0.11336398124694824, 2.0048747062683105, 0.5233066082000732, 0.8017046451568604, 1.3066132068634033, 2.0808725357055664, 1.7079250812530518, 0.46423351764678955, 0.09572052955627441, 0.3159371614456177, 1.0789194107055664, 0.06670999526977539, 0.1682901382446289, 0.7689396142959595, 3.0184881687164307], "mean_td_error": 0.8557484745979309, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 57.0, "diff_num_grad_updates_vs_sampler_policy": 56.0}}, "num_env_steps_sampled": 51968, "num_env_steps_trained": 14706, "num_agent_steps_sampled": 155904, "num_agent_steps_trained": 14706, "last_target_update_ts": 51968, "num_target_updates": 57}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 155904, "num_agent_steps_trained": 14706, "num_env_steps_sampled": 51968, "num_env_steps_trained": 14706, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 883.7235798587677, "num_env_steps_trained_throughput_per_sec": 254.46504866468982, "timesteps_total": 51968, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 155904, "timers": {"training_iteration_time_ms": 1038.447, "sample_time_ms": 733.241, "load_time_ms": 0.313, "load_throughput": 824605.983, "learn_time_ms": 17.899, "learn_throughput": 14414.107, "synch_weights_time_ms": 10.371}, "counters": {"num_env_steps_sampled": 51968, "num_env_steps_trained": 14706, "num_agent_steps_sampled": 155904, "num_agent_steps_trained": 14706, "last_target_update_ts": 51968, "num_target_updates": 57}, "done": false, "episodes_total": 0, "training_iteration": 35, "trial_id": "cfa97_00000", "date": "2023-11-18_21-03-25", "timestamp": 1700370205, "time_this_iter_s": 1.0284748077392578, "time_total_s": 58.18493938446045, "pid": 6770, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17f30a2a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 58.18493938446045, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 74.15, "ram_util_percent": 64.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0636568069458, "actor_loss": -6.997981548309326, "critic_loss": 0.6831440925598145, "alpha_loss": -0.17221735417842865, "alpha_value": 0.983032763004303, "log_alpha_value": -0.01711280085146427, "target_entropy": -6.0, "policy_t": 0.009493921883404255, "mean_q": 3.2654855251312256, "max_q": 9.230819702148438, "min_q": 3.1854608058929443}, "td_error": [2.3287835121154785, 2.093994379043579, 0.3223074674606323, 2.9553918838500977, 3.2483363151550293, 2.7558250427246094, 1.342459797859192, 1.366442084312439, 0.6581826210021973, 1.3509019613265991, 2.111020088195801, 1.9671294689178467, 1.3253657817840576, 1.274179458618164, 2.961538314819336, 2.3302271366119385, 1.2575700283050537, 1.8786793947219849, 1.2807046175003052, 1.5438240766525269, 3.242771625518799, 2.009087085723877, 2.1023478507995605, 2.270092010498047, 3.3661298751831055, 1.2601244449615479, 0.5220015048980713, 2.3139877319335938, 0.9475216865539551, 0.37829625606536865, 2.4569032192230225, 2.5854756832122803, 0.19316565990447998, 2.5790390968322754, 4.288793563842773, 2.8200089931488037, 2.27346134185791, 2.8561935424804688, 0.8333489894866943, 1.2812464237213135, 1.3655667304992676, 1.5874820947647095, 1.5069302320480347, 1.6049443483352661, 2.1882834434509277, 1.1054779291152954, 2.2264175415039062, 2.069315195083618, 0.21249914169311523, 2.477501630783081, 1.872117519378662, 2.512603759765625, 1.8546849489212036, 1.7042882442474365, 2.6045689582824707, 4.198920249938965, 1.2532984018325806, 1.072924017906189, 1.2068333625793457, 2.0296196937561035, 1.8751280307769775, 1.6852484941482544, 0.5659534931182861, 1.6430799961090088, 1.3180886507034302, 1.6953327655792236, 1.9001331329345703, 1.6900019645690918, 2.0471205711364746, 0.7641104459762573, 2.9243204593658447, 1.0836613178253174, 2.0288610458374023, 0.8180084228515625, 2.763892412185669, 0.9843417406082153, 1.1510288715362549, 2.175415515899658, 2.8390302658081055, 2.394702911376953, 1.744056224822998, 1.892999529838562, 0.30568861961364746, 0.3799194097518921, 1.3877663612365723, 2.2795119285583496], "mean_td_error": 1.8130759000778198, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 58.0, "diff_num_grad_updates_vs_sampler_policy": 57.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.038856506347656, "actor_loss": -6.758767604827881, "critic_loss": 0.16565178334712982, "alpha_loss": -0.17177128791809082, "alpha_value": 0.9830349087715149, "log_alpha_value": -0.017110643908381462, "target_entropy": -6.0, "policy_t": -0.0569254569709301, "mean_q": 2.6883599758148193, "max_q": 5.25278902053833, "min_q": 2.5434603691101074}, "td_error": [0.2694665193557739, 0.4524514675140381, 0.09613573551177979, 0.41757798194885254, 0.4005364179611206, 0.14333081245422363, 0.8709688186645508, 0.7974166870117188, 1.038743495941162, 0.306360125541687, 0.13756072521209717, 0.6495640277862549, 0.12702763080596924, 0.8485162258148193, 0.30531954765319824, 0.6483790874481201, 0.3019874095916748, 1.8535981178283691, 0.65071702003479, 1.2226603031158447, 0.6291959285736084, 0.0891873836517334, 2.9989607334136963, 0.26965153217315674, 0.5454616546630859, 1.0624701976776123, 1.4376118183135986, 0.6094977855682373, 0.4495121240615845, 0.7394038438796997, 0.42392706871032715, 0.7088329792022705, 1.7446420192718506, 2.703110456466675, 0.4291238784790039, 0.31259357929229736, 0.26278793811798096, 0.20888066291809082, 0.08900880813598633, 0.2627899646759033, 0.44798505306243896, 1.32146418094635, 2.1105527877807617, 1.7489557266235352, 0.15906500816345215, 0.5989099740982056, 2.387424945831299, 1.4826083183288574, 1.187849760055542, 0.07279276847839355, 0.7743387222290039, 0.25671589374542236, 1.9456398487091064, 0.26179182529449463, 0.8449482917785645, 0.39810311794281006, 0.900025486946106, 0.7411537170410156, 0.3379908800125122, 1.3247621059417725, 1.073932409286499, 2.1076650619506836, 0.1499478816986084, 1.091951608657837, 0.8669075965881348, 0.46056151390075684, 0.9262557029724121, 1.5072524547576904, 1.031747579574585, 0.08381891250610352, 0.19000577926635742, 0.08996176719665527, 0.08777177333831787, 1.2413303852081299, 1.3355894088745117, 0.8682034015655518, 3.0884220600128174, 0.8485804796218872, 0.1832045316696167, 0.7981939315795898, 0.9042695760726929, 0.7393825054168701, 0.7165334224700928, 0.6156264543533325, 0.2490917444229126, 0.40519213676452637], "mean_td_error": 0.7962726354598999, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 58.0, "diff_num_grad_updates_vs_sampler_policy": 57.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.121068000793457, "actor_loss": -6.36699104309082, "critic_loss": 0.12029349058866501, "alpha_loss": -0.17317010462284088, "alpha_value": 0.983035683631897, "log_alpha_value": -0.017109863460063934, "target_entropy": -6.0, "policy_t": -0.03884768858551979, "mean_q": 2.4468958377838135, "max_q": 5.916360378265381, "min_q": 2.1021981239318848}, "td_error": [0.05317401885986328, 1.0023443698883057, 1.5903092622756958, 0.9679570198059082, 0.2502788305282593, 1.7382067441940308, 0.6308367252349854, 1.3369450569152832, 0.3457803726196289, 0.1911545991897583, 0.18434679508209229, 1.3717091083526611, 0.2723374366760254, 1.010534644126892, 1.4688408374786377, 0.5928583145141602, 0.425773024559021, 0.6153554916381836, 0.6272926330566406, 0.016696929931640625, 0.9538522958755493, 0.42932093143463135, 0.274538516998291, 1.1981816291809082, 0.5420659780502319, 0.11115694046020508, 1.5375816822052002, 1.3730487823486328, 0.2689718008041382, 0.09278225898742676, 0.5734012126922607, 2.8475770950317383, 0.6467795372009277, 0.6263561248779297, 0.5410741567611694, 0.3013792037963867, 1.454169750213623, 2.0432887077331543, 1.8723090887069702, 1.4008057117462158, 1.821918249130249, 0.4536285400390625, 0.30531835556030273, 1.0813188552856445, 2.0085294246673584, 0.3186570405960083, 0.7675876617431641, 1.1905168294906616, 1.63569176197052, 0.14965426921844482, 0.10657000541687012, 0.30227065086364746, 0.8596498966217041, 1.103853702545166, 1.44491446018219, 0.5874145030975342, 0.12592077255249023, 2.337783098220825, 0.9232594966888428, 0.6513146162033081, 0.9041787385940552, 0.6235127449035645, 0.0842125415802002, 0.1948103904724121, 0.7085628509521484, 2.0985562801361084, 0.5568200349807739, 2.1730196475982666, 0.44320690631866455, 1.5328820943832397, 1.6705667972564697, 0.5365161895751953, 0.45605766773223877, 1.8277983665466309, 0.4058692455291748, 1.6576669216156006, 1.8856136798858643, 0.3772721290588379, 0.3284287452697754, 1.0300471782684326, 1.291297197341919, 0.06382477283477783, 1.0717816352844238, 0.5917963981628418, 2.085219383239746, 0.22900235652923584], "mean_td_error": 0.8928565979003906, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 58.0, "diff_num_grad_updates_vs_sampler_policy": 57.0}}, "num_env_steps_sampled": 52864, "num_env_steps_trained": 14964, "num_agent_steps_sampled": 158592, "num_agent_steps_trained": 14964, "last_target_update_ts": 52864, "num_target_updates": 58}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 158592, "num_agent_steps_trained": 14964, "num_env_steps_sampled": 52864, "num_env_steps_trained": 14964, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 821.2829614380606, "num_env_steps_trained_throughput_per_sec": 236.48549559265584, "timesteps_total": 52864, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 158592, "timers": {"training_iteration_time_ms": 1039.024, "sample_time_ms": 734.215, "load_time_ms": 0.314, "load_throughput": 822037.703, "learn_time_ms": 17.882, "learn_throughput": 14428.117, "synch_weights_time_ms": 10.225}, "counters": {"num_env_steps_sampled": 52864, "num_env_steps_trained": 14964, "num_agent_steps_sampled": 158592, "num_agent_steps_trained": 14964, "last_target_update_ts": 52864, "num_target_updates": 58}, "done": false, "episodes_total": 0, "training_iteration": 36, "trial_id": "cfa97_00000", "date": "2023-11-18_21-03-26", "timestamp": 1700370206, "time_this_iter_s": 1.1009349822998047, "time_total_s": 59.285874366760254, "pid": 6770, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17f308ae0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 59.285874366760254, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 70.2, "ram_util_percent": 65.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.164448738098145, "actor_loss": -7.3025641441345215, "critic_loss": 0.6296597719192505, "alpha_loss": -0.18004374206066132, "alpha_value": 0.9824428558349609, "log_alpha_value": -0.017713084816932678, "target_entropy": -6.0, "policy_t": -0.011902834288775921, "mean_q": 3.6809751987457275, "max_q": 12.623619079589844, "min_q": 3.433382749557495}, "td_error": [0.20677447319030762, 0.634608268737793, 0.7257977724075317, 3.8611257076263428, 0.20141005516052246, 1.77079439163208, 0.5599491596221924, 1.1121494770050049, 2.8383407592773438, 0.9958161115646362, 0.42802369594573975, 0.2690141201019287, 1.7813977003097534, 1.3690247535705566, 1.625462532043457, 0.5210444927215576, 2.3525986671447754, 1.83335280418396, 1.852785587310791, 0.2073497772216797, 0.4191620349884033, 0.7036726474761963, 2.3756113052368164, 6.8569416999816895, 4.235317230224609, 1.3661500215530396, 1.5798286199569702, 0.6097722053527832, 1.2211406230926514, 2.835019826889038, 1.2960535287857056, 1.812193751335144, 1.1593858003616333, 1.6287219524383545, 2.189481496810913, 0.20700764656066895, 6.992897987365723, 1.6707574129104614, 0.5211770534515381, 2.3207051753997803, 1.7189664840698242, 2.8081297874450684, 0.41249144077301025, 0.2040032148361206, 3.1791205406188965, 0.27393639087677, 2.4418492317199707, 0.4371999502182007, 0.5618505477905273, 2.041368007659912, 3.072902202606201, 0.20329809188842773, 1.2979304790496826, 2.445159912109375, 2.4747843742370605, 2.4625964164733887, 0.6750096082687378, 1.8914294242858887, 1.8734016418457031, 1.2790658473968506, 3.1027944087982178, 2.453227996826172, 0.20647764205932617, 0.37995731830596924, 1.6581767797470093, 1.1019171476364136, 2.46470308303833, 0.668171763420105, 3.0769917964935303, 2.3210601806640625, 1.2140498161315918, 0.9164142608642578, 2.1149001121520996, 1.4410101175308228, 2.296731472015381, 0.2212674617767334, 0.8023785352706909, 0.1989727020263672, 1.594550609588623, 1.0198358297348022, 2.741816282272339, 0.48003995418548584, 2.093914031982422, 1.643689513206482, 1.4883512258529663, 1.6580815315246582], "mean_td_error": 1.6076953411102295, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 60.0, "diff_num_grad_updates_vs_sampler_policy": 59.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.121777534484863, "actor_loss": -6.835022449493408, "critic_loss": 0.19545304775238037, "alpha_loss": -0.1792633980512619, "alpha_value": 0.982445240020752, "log_alpha_value": -0.017710665240883827, "target_entropy": -6.0, "policy_t": 0.022728513926267624, "mean_q": 2.7517175674438477, "max_q": 4.892850399017334, "min_q": 2.236138343811035}, "td_error": [1.027266502380371, 0.9082908630371094, 1.759986162185669, 0.9594496488571167, 1.0018190145492554, 0.7065294981002808, 1.5516636371612549, 0.04215502738952637, 1.5056145191192627, 1.6808209419250488, 0.2702784538269043, 0.978622555732727, 0.49300074577331543, 0.31991708278656006, 1.5627654790878296, 1.028465747833252, 2.4740843772888184, 0.8064606189727783, 0.08323204517364502, 0.06474566459655762, 0.7609615325927734, 1.5018205642700195, 1.5046905279159546, 0.08297979831695557, 0.579558253288269, 0.13238394260406494, 1.5608224868774414, 0.9928349256515503, 0.30947697162628174, 1.6706010103225708, 1.645593285560608, 0.06237590312957764, 2.339627981185913, 1.589325189590454, 2.653912305831909, 0.19653058052062988, 0.4854850769042969, 1.0292699337005615, 0.48918163776397705, 0.2994035482406616, 1.2612003087997437, 0.4353431463241577, 0.5930604934692383, 0.5061036348342896, 0.32867205142974854, 0.44292962551116943, 0.9923503398895264, 0.4229879379272461, 0.7282264232635498, 0.2226649522781372, 0.33517909049987793, 0.06245017051696777, 1.1750648021697998, 0.17786705493927002, 0.4997289180755615, 1.252142310142517, 2.1273679733276367, 0.9782752990722656, 0.5238443613052368, 1.2801873683929443, 0.20152342319488525, 1.414277195930481, 0.6027995347976685, 1.7821547985076904, 0.2238752841949463, 1.5960211753845215, 0.24790358543395996, 1.7696337699890137, 1.6690704822540283, 1.2655709981918335, 1.3527506589889526, 0.8757666349411011, 0.45386838912963867, 1.5524616241455078, 0.05332338809967041, 1.2574827671051025, 0.14149963855743408, 0.4081367254257202, 0.46976959705352783, 0.6644289493560791, 0.4112544059753418, 1.626827597618103, 0.6589556932449341, 0.07400071620941162, 1.9386121034622192, 0.21311378479003906], "mean_td_error": 0.888171374797821, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 60.0, "diff_num_grad_updates_vs_sampler_policy": 59.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.087565422058105, "actor_loss": -6.436920166015625, "critic_loss": 0.13937260210514069, "alpha_loss": -0.1786545217037201, "alpha_value": 0.9824455380439758, "log_alpha_value": -0.01771037094295025, "target_entropy": -6.0, "policy_t": -0.02747216261923313, "mean_q": 2.5564613342285156, "max_q": 5.412617206573486, "min_q": 2.133598804473877}, "td_error": [2.7115392684936523, 1.045410394668579, 0.6556450128555298, 0.41568851470947266, 0.795907735824585, 0.9535269737243652, 0.2816615104675293, 0.35629701614379883, 2.9460248947143555, 0.051812052726745605, 0.31536591053009033, 0.7560677528381348, 1.8517186641693115, 0.9920558929443359, 0.4808328151702881, 1.1966700553894043, 0.7300844192504883, 1.179644227027893, 1.236948013305664, 0.02841496467590332, 0.7976768016815186, 1.1102521419525146, 0.5335391759872437, 0.883713960647583, 2.4053802490234375, 0.3164820671081543, 0.4338057041168213, 0.3144035339355469, 1.2260165214538574, 0.34998512268066406, 0.45499396324157715, 0.44914114475250244, 1.020037055015564, 0.8606116771697998, 2.326167106628418, 1.3981016874313354, 1.9411566257476807, 1.2482645511627197, 0.024927735328674316, 1.6228399276733398, 0.6951990127563477, 0.27060604095458984, 0.778936505317688, 0.28136301040649414, 0.726853609085083, 1.0604901313781738, 0.7149640321731567, 0.9718708992004395, 1.7533972263336182, 1.317458152770996, 2.113018035888672, 0.386488676071167, 1.974303960800171, 0.021181583404541016, 0.981479287147522, 0.4267536401748657, 0.16378045082092285, 1.1029672622680664, 0.6122149229049683, 1.1594897508621216, 1.1245334148406982, 0.18615293502807617, 0.8990238904953003, 1.704598307609558, 1.6609598398208618, 0.5867180824279785, 0.5906038284301758, 2.1044514179229736, 2.9719760417938232, 2.446263551712036, 0.10693359375, 1.811853051185608, 0.1683213710784912, 1.2474323511123657, 1.2482261657714844, 1.8150936365127563, 0.8682126998901367, 0.1304326057434082, 0.09988033771514893, 1.1480873823165894, 0.9349106550216675, 1.93376624584198, 0.24262213706970215, 0.45171093940734863, 2.1552491188049316, 0.20274877548217773], "mean_td_error": 0.988981306552887, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 60.0, "diff_num_grad_updates_vs_sampler_policy": 59.0}}, "num_env_steps_sampled": 54656, "num_env_steps_trained": 15480, "num_agent_steps_sampled": 163968, "num_agent_steps_trained": 15480, "last_target_update_ts": 54656, "num_target_updates": 60}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 163968, "num_agent_steps_trained": 15480, "num_env_steps_sampled": 54656, "num_env_steps_trained": 15480, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 932.931882700354, "num_env_steps_trained_throughput_per_sec": 268.6344037239858, "timesteps_total": 54656, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 163968, "timers": {"training_iteration_time_ms": 1024.715, "sample_time_ms": 719.312, "load_time_ms": 0.317, "load_throughput": 814244.117, "learn_time_ms": 17.93, "learn_throughput": 14388.942, "synch_weights_time_ms": 10.39}, "counters": {"num_env_steps_sampled": 54656, "num_env_steps_trained": 15480, "num_agent_steps_sampled": 163968, "num_agent_steps_trained": 15480, "last_target_update_ts": 54656, "num_target_updates": 60}, "done": false, "episodes_total": 0, "training_iteration": 37, "trial_id": "cfa97_00000", "date": "2023-11-18_21-03-28", "timestamp": 1700370208, "time_this_iter_s": 1.9290900230407715, "time_total_s": 61.214964389801025, "pid": 6770, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17f3096c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 61.214964389801025, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 70.76666666666667, "ram_util_percent": 64.89999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.036086082458496, "actor_loss": -7.488798141479492, "critic_loss": 0.506189227104187, "alpha_loss": -0.18379859626293182, "alpha_value": 0.9818528890609741, "log_alpha_value": -0.01831377111375332, "target_entropy": -6.0, "policy_t": -0.013338571414351463, "mean_q": 3.991488456726074, "max_q": 12.715201377868652, "min_q": 3.6859397888183594}, "td_error": [1.5116944313049316, 1.6871857643127441, 0.7854971885681152, 3.3279075622558594, 0.8193672895431519, 0.46740198135375977, 1.4923535585403442, 0.44782519340515137, 1.4354969263076782, 1.2882922887802124, 0.269512414932251, 0.5686982870101929, 0.7192851305007935, 0.48171114921569824, 0.6377760171890259, 0.9804215431213379, 0.9000635147094727, 1.837318778038025, 2.234283924102783, 1.0133304595947266, 0.37511587142944336, 0.28789329528808594, 1.6967443227767944, 4.702185153961182, 0.6058892011642456, 0.9808766841888428, 0.8809058666229248, 0.5618072748184204, 0.6374958753585815, 0.3458070755004883, 1.0139350891113281, 0.9045810699462891, 2.753561496734619, 2.051908016204834, 0.9765429496765137, 1.122127890586853, 0.21694958209991455, 1.1105016469955444, 0.2077559232711792, 0.31705665588378906, 1.1461782455444336, 0.8687154054641724, 0.2795567512512207, 1.6814687252044678, 1.912467360496521, 1.151390552520752, 0.6252405643463135, 2.435084819793701, 0.4283022880554199, 2.4221153259277344, 9.604053497314453, 1.273807168006897, 1.7585771083831787, 3.186465263366699, 1.127790093421936, 1.8087503910064697, 1.0337220430374146, 1.4947872161865234, 1.0217853784561157, 1.510075330734253, 3.5723676681518555, 0.6846112012863159, 3.4959716796875, 1.1718385219573975, 0.49245786666870117, 0.850051760673523, 2.590989112854004, 0.48751580715179443, 0.3679468631744385, 0.20921969413757324, 0.4996911287307739, 1.2919578552246094, 0.5099990367889404, 1.459595799446106, 0.6807345151901245, 2.195495367050171, 0.21333980560302734, 2.0862040519714355, 0.20876455307006836, 3.1779024600982666, 1.8153836727142334, 1.1598113775253296, 2.722486972808838, 0.9568819999694824, 1.6093075275421143, 2.885408401489258], "mean_td_error": 1.381643295288086, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 62.0, "diff_num_grad_updates_vs_sampler_policy": 61.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.014352798461914, "actor_loss": -6.863922595977783, "critic_loss": 0.15070977807044983, "alpha_loss": -0.18337441980838776, "alpha_value": 0.9818554520606995, "log_alpha_value": -0.018311161547899246, "target_entropy": -6.0, "policy_t": -0.05085167661309242, "mean_q": 2.8175032138824463, "max_q": 4.412407875061035, "min_q": 2.3022329807281494}, "td_error": [0.7778522968292236, 1.2515523433685303, 0.8069368600845337, 0.5203766822814941, 1.931569218635559, 1.0628067255020142, 1.0301625728607178, 0.969321608543396, 1.5120201110839844, 0.6701623201370239, 0.5239546298980713, 0.7618343830108643, 1.4769232273101807, 0.3170907497406006, 0.6144988536834717, 0.8163723945617676, 1.4188681840896606, 0.9714727401733398, 1.672347903251648, 0.8018758296966553, 0.28694355487823486, 0.03983139991760254, 0.08840107917785645, 0.7550711631774902, 0.5118722915649414, 0.45748984813690186, 0.08596765995025635, 1.8660176992416382, 0.709244966506958, 0.39332687854766846, 0.3126709461212158, 1.2493832111358643, 0.6224730014801025, 0.9390201568603516, 0.6206991672515869, 1.0418051481246948, 0.6028255224227905, 0.2737903594970703, 1.7766788005828857, 1.3046307563781738, 0.5681569576263428, 0.8865580558776855, 0.47801005840301514, 0.9798471927642822, 1.4079948663711548, 0.4783966541290283, 0.8129631280899048, 0.8873616456985474, 0.43244922161102295, 0.011605024337768555, 0.9415371417999268, 0.6265730857849121, 0.07571947574615479, 1.9248342514038086, 0.27139902114868164, 0.7417573928833008, 0.838010311126709, 0.5250074863433838, 0.3903602361679077, 0.751349925994873, 1.689021348953247, 0.6002588272094727, 1.2791619300842285, 1.3529956340789795, 0.7813128232955933, 0.39409005641937256, 0.15703928470611572, 0.6409316062927246, 2.092299699783325, 0.2147732973098755, 0.2991492748260498, 0.3080331087112427, 0.3106393814086914, 0.3934210538864136, 1.1617720127105713, 1.8956291675567627, 0.6227923631668091, 0.7300230264663696, 0.10778498649597168, 1.670522928237915, 0.3875681161880493, 1.0541901588439941, 0.291223406791687, 0.056349873542785645, 0.06026959419250488, 0.9127839803695679], "mean_td_error": 0.7830240726470947, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 62.0, "diff_num_grad_updates_vs_sampler_policy": 61.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.12954330444336, "actor_loss": -6.542729377746582, "critic_loss": 0.10818073898553848, "alpha_loss": -0.1854819357395172, "alpha_value": 0.9818556308746338, "log_alpha_value": -0.018310988321900368, "target_entropy": -6.0, "policy_t": 0.00480993278324604, "mean_q": 2.5753815174102783, "max_q": 4.791961669921875, "min_q": 2.490962505340576}, "td_error": [2.9142467975616455, 0.45916545391082764, 0.5882092714309692, 0.49474668502807617, 0.7896116971969604, 0.7630128860473633, 0.9227802753448486, 0.9536638259887695, 0.7775925397872925, 0.9885737895965576, 0.2625713348388672, 1.1742050647735596, 0.3885366916656494, 0.20440328121185303, 0.5430454015731812, 2.155290365219116, 2.138457775115967, 0.6637669801712036, 0.4452941417694092, 1.004379391670227, 0.6331238746643066, 1.749101161956787, 0.9370253086090088, 0.546984076499939, 0.883987545967102, 0.06466150283813477, 0.5715937614440918, 0.4665428400039673, 1.6813900470733643, 1.4618864059448242, 0.17992842197418213, 0.5889959335327148, 0.9864978790283203, 0.051166534423828125, 0.03260624408721924, 0.26060962677001953, 1.0170897245407104, 0.9040855169296265, 0.139001727104187, 1.7058966159820557, 0.49346137046813965, 0.8920062780380249, 0.7163147926330566, 0.6535062789916992, 0.4634990692138672, 0.5446951389312744, 0.8715919256210327, 0.634077787399292, 0.32911574840545654, 0.9812579154968262, 0.4222062826156616, 0.856034517288208, 0.3052331209182739, 0.5232503414154053, 2.2290267944335938, 0.5874843597412109, 0.4438955783843994, 0.6030411720275879, 1.3782238960266113, 0.512751579284668, 0.10351872444152832, 2.1099159717559814, 0.1144862174987793, 0.04671311378479004, 0.2341477870941162, 0.5206727981567383, 1.00492525100708, 1.0560784339904785, 0.9619748592376709, 0.31409668922424316, 0.01575160026550293, 1.3551297187805176, 1.2316359281539917, 0.981174111366272, 2.055880069732666, 0.44517505168914795, 1.6275919675827026, 1.6428804397583008, 1.827427864074707, 0.12324047088623047, 1.0688551664352417, 0.2582477331161499, 1.3903201818466187, 1.3839207887649536, 2.4632647037506104, 1.3362758159637451], "mean_td_error": 0.8559035658836365, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 62.0, "diff_num_grad_updates_vs_sampler_policy": 61.0}}, "num_env_steps_sampled": 56448, "num_env_steps_trained": 15996, "num_agent_steps_sampled": 169344, "num_agent_steps_trained": 15996, "last_target_update_ts": 56448, "num_target_updates": 62}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 169344, "num_agent_steps_trained": 15996, "num_env_steps_sampled": 56448, "num_env_steps_trained": 15996, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 949.8819651537736, "num_env_steps_trained_throughput_per_sec": 273.5151194304393, "timesteps_total": 56448, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 169344, "timers": {"training_iteration_time_ms": 993.797, "sample_time_ms": 717.074, "load_time_ms": 0.318, "load_throughput": 810706.047, "learn_time_ms": 17.899, "learn_throughput": 14414.28, "synch_weights_time_ms": 10.885}, "counters": {"num_env_steps_sampled": 56448, "num_env_steps_trained": 15996, "num_agent_steps_sampled": 169344, "num_agent_steps_trained": 15996, "last_target_update_ts": 56448, "num_target_updates": 62}, "done": false, "episodes_total": 0, "training_iteration": 38, "trial_id": "cfa97_00000", "date": "2023-11-18_21-03-30", "timestamp": 1700370210, "time_this_iter_s": 1.8939950466156006, "time_total_s": 63.108959436416626, "pid": 6770, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17f30a480>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 63.108959436416626, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 69.36666666666666, "ram_util_percent": 64.86666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.041890144348145, "actor_loss": -7.7068986892700195, "critic_loss": 0.49057453870773315, "alpha_loss": -0.18993379175662994, "alpha_value": 0.9812635779380798, "log_alpha_value": -0.018914148211479187, "target_entropy": -6.0, "policy_t": -0.019783958792686462, "mean_q": 4.119927406311035, "max_q": 9.46274185180664, "min_q": 3.9369606971740723}, "td_error": [1.6769843101501465, 2.5112853050231934, 1.7722606658935547, 1.985124111175537, 1.0828672647476196, 1.3098922967910767, 0.41520631313323975, 5.7767157554626465, 0.21776890754699707, 0.49941277503967285, 0.8256857395172119, 1.7857940196990967, 2.2330808639526367, 0.2181684970855713, 2.033555746078491, 1.3174805641174316, 0.7506269216537476, 0.5514018535614014, 1.134825587272644, 0.8809372186660767, 0.2885829210281372, 1.1404627561569214, 0.9461437463760376, 3.2796289920806885, 1.7450940608978271, 0.21756625175476074, 1.7642987966537476, 0.222092866897583, 1.2818354368209839, 1.297508716583252, 1.8216089010238647, 1.1458321809768677, 0.35117125511169434, 2.8792028427124023, 2.2074995040893555, 0.6802715063095093, 0.5809522867202759, 0.5732791423797607, 0.41246771812438965, 1.4052422046661377, 0.42357945442199707, 0.8174247741699219, 2.702821731567383, 1.0175681114196777, 0.3132075071334839, 0.21332502365112305, 2.0598580837249756, 0.6291327476501465, 0.2136530876159668, 0.4217677116394043, 0.40880870819091797, 0.7684236764907837, 1.882270336151123, 0.629908561706543, 2.4684455394744873, 1.3247454166412354, 1.1831059455871582, 0.691387414932251, 2.18133282661438, 1.833689570426941, 1.2978522777557373, 2.706115245819092, 2.8513450622558594, 0.544837474822998, 0.2215430736541748, 1.3358803987503052, 0.23835229873657227, 0.8334122896194458, 0.7259516716003418, 1.7424477338790894, 4.19307804107666, 0.8807370662689209, 2.9851794242858887, 0.8635187149047852, 5.541816234588623, 0.2640470266342163, 0.8736847639083862, 0.528693675994873, 2.4488537311553955, 2.3503525257110596, 2.5204238891601562, 2.189495325088501, 1.2250949144363403, 1.436185359954834, 0.21480917930603027, 0.5139141082763672], "mean_td_error": 1.359673261642456, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 64.0, "diff_num_grad_updates_vs_sampler_policy": 63.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.104646682739258, "actor_loss": -6.9368391036987305, "critic_loss": 0.15671810507774353, "alpha_loss": -0.191091388463974, "alpha_value": 0.981266438961029, "log_alpha_value": -0.018911238759756088, "target_entropy": -6.0, "policy_t": -0.0076067522168159485, "mean_q": 2.820758581161499, "max_q": 3.9447453022003174, "min_q": 2.2105531692504883}, "td_error": [1.6457775831222534, 1.0520176887512207, 0.6314796209335327, 1.0370166301727295, 1.099714994430542, 0.5879062414169312, 0.18764746189117432, 0.3780837059020996, 1.0502283573150635, 0.04770338535308838, 0.7590216398239136, 1.4526360034942627, 0.4301489591598511, 0.8435331583023071, 0.28351104259490967, 0.47764432430267334, 1.4097014665603638, 0.8912333250045776, 2.874053478240967, 0.30710601806640625, 0.7204511165618896, 0.03283572196960449, 0.3454982042312622, 1.3956842422485352, 0.4624978303909302, 0.02894425392150879, 0.4010838270187378, 0.2692981958389282, 0.8778537511825562, 2.335472822189331, 0.4284050464630127, 0.41611194610595703, 0.5476781129837036, 0.9872628450393677, 0.20225274562835693, 1.2658450603485107, 0.4759713411331177, 0.08987629413604736, 1.0683376789093018, 0.684323787689209, 0.2721257209777832, 0.34493815898895264, 0.1693708896636963, 1.2576189041137695, 0.2918587923049927, 1.3255112171173096, 0.31012940406799316, 0.389426589012146, 0.3981349468231201, 0.4101649522781372, 1.2310987710952759, 0.783232569694519, 0.947198748588562, 0.9021186828613281, 2.3418142795562744, 1.636679768562317, 0.3756082057952881, 0.06551694869995117, 0.5170726776123047, 0.9503195285797119, 1.935409665107727, 2.2277166843414307, 1.5781052112579346, 0.3245586156845093, 0.6954278945922852, 1.2322863340377808, 1.2857576608657837, 0.9344151020050049, 1.7995209693908691, 1.2932040691375732, 0.852988600730896, 0.0846322774887085, 0.420019268989563, 0.9554861783981323, 0.21281862258911133, 0.048880815505981445, 0.3022463321685791, 0.7832746505737305, 0.5886693000793457, 0.38304436206817627, 1.651626706123352, 0.2742013931274414, 1.0878866910934448, 2.9296751022338867, 1.5091084241867065, 1.5768691301345825], "mean_td_error": 0.8415071964263916, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 64.0, "diff_num_grad_updates_vs_sampler_policy": 63.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.091948509216309, "actor_loss": -6.597488880157471, "critic_loss": 0.11420249938964844, "alpha_loss": -0.19085624814033508, "alpha_value": 0.9812659621238708, "log_alpha_value": -0.018911734223365784, "target_entropy": -6.0, "policy_t": -0.0018838477553799748, "mean_q": 2.6104745864868164, "max_q": 3.606851577758789, "min_q": 2.1428909301757812}, "td_error": [0.3047400712966919, 0.7535821199417114, 0.13750743865966797, 1.3416292667388916, 0.49757468700408936, 1.2119358777999878, 0.4345054626464844, 1.0559030771255493, 0.8191245794296265, 0.7330187559127808, 0.6341778039932251, 1.108792781829834, 1.9942394495010376, 0.2059093713760376, 0.33970189094543457, 1.231287956237793, 0.03263390064239502, 0.5819147825241089, 0.662901759147644, 0.5703916549682617, 1.4785128831863403, 0.35215210914611816, 2.2430481910705566, 0.7575947046279907, 0.5995039939880371, 1.0765552520751953, 0.40772151947021484, 0.2604132890701294, 1.604085922241211, 0.5882090330123901, 0.903266191482544, 1.7591133117675781, 2.6104447841644287, 0.12315618991851807, 0.8464291095733643, 1.1604944467544556, 0.81111741065979, 0.3395763635635376, 0.6713409423828125, 0.33489763736724854, 0.48151636123657227, 0.23433172702789307, 1.790239930152893, 0.10761678218841553, 1.9369772672653198, 1.2486621141433716, 0.8083224296569824, 0.049713134765625, 1.6745775938034058, 0.2529560327529907, 0.7479230165481567, 2.130309820175171, 2.0021846294403076, 0.9065933227539062, 1.6958268880844116, 0.28837132453918457, 1.046895980834961, 0.07964801788330078, 1.2266181707382202, 0.3603839874267578, 0.5163407325744629, 0.7687398195266724, 1.2093034982681274, 0.17880702018737793, 1.0593024492263794, 0.08633232116699219, 0.9658116102218628, 0.408115029335022, 0.5795317888259888, 1.444126844406128, 0.5993096828460693, 1.7658863067626953, 0.03429269790649414, 2.0245895385742188, 0.0195920467376709, 0.29354310035705566, 2.552252769470215, 0.46870362758636475, 0.7438430786132812, 0.14386260509490967, 0.8025939464569092, 0.6557505130767822, 0.3818153142929077, 2.381621837615967, 0.45173072814941406, 0.7494539022445679], "mean_td_error": 0.8596979975700378, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 64.0, "diff_num_grad_updates_vs_sampler_policy": 63.0}}, "num_env_steps_sampled": 58240, "num_env_steps_trained": 16512, "num_agent_steps_sampled": 174720, "num_agent_steps_trained": 16512, "last_target_update_ts": 58240, "num_target_updates": 64}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 174720, "num_agent_steps_trained": 16512, "num_env_steps_sampled": 58240, "num_env_steps_trained": 16512, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 904.9316145210589, "num_env_steps_trained_throughput_per_sec": 260.5718265027156, "timesteps_total": 58240, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 174720, "timers": {"training_iteration_time_ms": 995.873, "sample_time_ms": 720.22, "load_time_ms": 0.316, "load_throughput": 817072.208, "learn_time_ms": 17.958, "learn_throughput": 14367.049, "synch_weights_time_ms": 10.774}, "counters": {"num_env_steps_sampled": 58240, "num_env_steps_trained": 16512, "num_agent_steps_sampled": 174720, "num_agent_steps_trained": 16512, "last_target_update_ts": 58240, "num_target_updates": 64}, "done": false, "episodes_total": 0, "training_iteration": 39, "trial_id": "cfa97_00000", "date": "2023-11-18_21-03-32", "timestamp": 1700370212, "time_this_iter_s": 1.9898831844329834, "time_total_s": 65.09884262084961, "pid": 6770, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17f309da0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 65.09884262084961, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 66.5, "ram_util_percent": 64.83333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.037637710571289, "actor_loss": -8.003990173339844, "critic_loss": 0.529600977897644, "alpha_loss": -0.1958772987127304, "alpha_value": 0.9806748628616333, "log_alpha_value": -0.019514281302690506, "target_entropy": -6.0, "policy_t": -0.05544265732169151, "mean_q": 4.602073669433594, "max_q": 11.550124168395996, "min_q": 4.185506820678711}, "td_error": [2.445181131362915, 0.9708014726638794, 1.2613284587860107, 0.22157669067382812, 1.1982696056365967, 2.559102773666382, 1.249727725982666, 1.3486930131912231, 0.836938738822937, 3.6873550415039062, 1.9097812175750732, 0.49968624114990234, 0.4288097620010376, 1.3701965808868408, 0.6362086534500122, 1.838709831237793, 5.420391082763672, 0.6158998012542725, 0.4308260679244995, 7.199776649475098, 0.4967759847640991, 0.35373663902282715, 0.3810591697692871, 0.63773512840271, 3.0030007362365723, 0.795505166053772, 0.21936297416687012, 0.8124686479568481, 0.5723927021026611, 0.33774614334106445, 0.22126007080078125, 5.308755397796631, 2.258852958679199, 1.0419615507125854, 1.763796329498291, 1.111843228340149, 1.3429653644561768, 1.0413179397583008, 0.2108771800994873, 2.013138771057129, 0.2119687795639038, 0.2215588092803955, 2.1313586235046387, 2.192962169647217, 1.0820882320404053, 1.514441728591919, 2.2156474590301514, 0.24869322776794434, 1.0900309085845947, 1.4530000686645508, 0.46499812602996826, 4.468786716461182, 0.9562240839004517, 0.9462153911590576, 2.13889741897583, 0.2421119213104248, 0.9393556118011475, 2.207441568374634, 1.0604712963104248, 1.0909678936004639, 1.5963308811187744, 2.322322130203247, 1.9647727012634277, 2.8973910808563232, 0.44563305377960205, 1.5387157201766968, 0.2124626636505127, 0.6311230659484863, 0.3969029188156128, 1.6180944442749023, 1.6824591159820557, 1.30633544921875, 1.3901948928833008, 2.9928810596466064, 0.8733983039855957, 0.23328709602355957, 0.4445570707321167, 0.8430975675582886, 1.177039623260498, 0.6691219806671143, 0.8741040229797363, 1.124416470527649, 1.7666908502578735, 4.53991174697876, 0.7820079326629639, 1.389435052871704], "mean_td_error": 1.4260897636413574, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 66.0, "diff_num_grad_updates_vs_sampler_policy": 65.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.115625381469727, "actor_loss": -6.955761432647705, "critic_loss": 0.1497483253479004, "alpha_loss": -0.19736981391906738, "alpha_value": 0.9806777238845825, "log_alpha_value": -0.019511383026838303, "target_entropy": -6.0, "policy_t": -0.01728501170873642, "mean_q": 2.8845956325531006, "max_q": 3.7723989486694336, "min_q": 2.126711845397949}, "td_error": [0.40575456619262695, 0.05941665172576904, 1.4680767059326172, 1.5828940868377686, 0.1780623197555542, 0.9226193428039551, 0.2504746913909912, 1.277479648590088, 0.6309701204299927, 0.02047550678253174, 1.9316363334655762, 1.7427915334701538, 1.7951481342315674, 1.2343100309371948, 0.013886690139770508, 0.3196450471878052, 0.418279767036438, 0.650603175163269, 0.7812807559967041, 1.2861043214797974, 0.3549555540084839, 0.8015875816345215, 1.268276333808899, 1.4409151077270508, 0.12303793430328369, 0.04312765598297119, 1.0439538955688477, 0.28383779525756836, 0.5366393327713013, 0.956754207611084, 0.15560531616210938, 1.4560694694519043, 1.1094939708709717, 0.014374136924743652, 1.4220936298370361, 0.3791550397872925, 1.4646556377410889, 0.6888138055801392, 0.8574895858764648, 0.8568196296691895, 1.3402718305587769, 2.2179877758026123, 0.8745629787445068, 2.3350770473480225, 0.25207972526550293, 2.553858518600464, 0.18864333629608154, 0.2681022882461548, 1.6606191396713257, 0.8081444501876831, 1.1015872955322266, 0.3506906032562256, 0.27415919303894043, 0.8841040134429932, 0.18267667293548584, 0.298298716545105, 0.3232142925262451, 0.9051058292388916, 1.496728777885437, 1.7474102973937988, 0.7344509363174438, 0.8763549327850342, 1.1038907766342163, 0.27778053283691406, 0.35407984256744385, 0.08937227725982666, 0.32713818550109863, 0.6421170234680176, 1.2754164934158325, 0.5212792158126831, 0.6699700355529785, 1.177626609802246, 0.1939551830291748, 0.5194449424743652, 1.5725200176239014, 0.7317004203796387, 0.8094058036804199, 0.1462996006011963, 0.4365708827972412, 2.116407632827759, 0.2736324071884155, 1.381258249282837, 0.7687069177627563, 0.40397047996520996, 0.16553330421447754, 0.5991950035095215], "mean_td_error": 0.8192903399467468, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 66.0, "diff_num_grad_updates_vs_sampler_policy": 65.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.136335372924805, "actor_loss": -6.726145267486572, "critic_loss": 0.0954044908285141, "alpha_loss": -0.19778397679328918, "alpha_value": 0.9806767702102661, "log_alpha_value": -0.019512375816702843, "target_entropy": -6.0, "policy_t": -0.05330387130379677, "mean_q": 2.6803293228149414, "max_q": 3.2997074127197266, "min_q": 2.1356983184814453}, "td_error": [0.4746652841567993, 0.6886918544769287, 0.4609798192977905, 0.946845293045044, 0.33342862129211426, 0.33048033714294434, 0.7315266132354736, 0.07419729232788086, 0.6238170862197876, 0.5535236597061157, 0.24370181560516357, 0.8764660358428955, 0.6704850196838379, 1.716966152191162, 0.8426822423934937, 0.5367915630340576, 1.6333202123641968, 0.1522524356842041, 0.42332351207733154, 0.6502478122711182, 0.3521958589553833, 0.26673245429992676, 0.07368087768554688, 0.497356653213501, 0.19919919967651367, 1.3628194332122803, 2.407407760620117, 1.020021677017212, 1.7762240171432495, 0.617782473564148, 1.3928472995758057, 1.5910868644714355, 0.8649656772613525, 0.07036364078521729, 0.6880600452423096, 0.6277389526367188, 1.2580993175506592, 0.3102085590362549, 1.113358497619629, 0.8485101461410522, 1.0000413656234741, 0.03852438926696777, 0.07762455940246582, 1.2402369976043701, 0.8416824340820312, 0.35340261459350586, 0.5814272165298462, 0.029460549354553223, 0.8693856000900269, 1.7319161891937256, 0.22698557376861572, 0.35258376598358154, 0.4714409112930298, 3.471461296081543, 2.3422927856445312, 1.3339418172836304, 1.1376818418502808, 1.15355384349823, 0.485487699508667, 0.9525961875915527, 0.4191235303878784, 0.3385624885559082, 0.016577482223510742, 1.4063825607299805, 1.3075326681137085, 0.02336287498474121, 0.10276365280151367, 2.066287040710449, 1.2353999614715576, 0.9213703870773315, 0.2657463550567627, 1.1278249025344849, 0.13864362239837646, 0.916487455368042, 0.25659120082855225, 0.891884446144104, 0.13399457931518555, 0.07443356513977051, 1.623594880104065, 0.6278116703033447, 0.22701644897460938, 0.10747420787811279, 0.17334163188934326, 1.0990512371063232, 0.4861537218093872, 1.1895440816879272], "mean_td_error": 0.7694388031959534, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 66.0, "diff_num_grad_updates_vs_sampler_policy": 65.0}}, "num_env_steps_sampled": 60032, "num_env_steps_trained": 17028, "num_agent_steps_sampled": 180096, "num_agent_steps_trained": 17028, "last_target_update_ts": 60032, "num_target_updates": 66}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180096, "num_agent_steps_trained": 17028, "num_env_steps_sampled": 60032, "num_env_steps_trained": 17028, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 923.478654380145, "num_env_steps_trained_throughput_per_sec": 265.9123803907114, "timesteps_total": 60032, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 180096, "timers": {"training_iteration_time_ms": 983.276, "sample_time_ms": 707.471, "load_time_ms": 0.316, "load_throughput": 816517.341, "learn_time_ms": 17.994, "learn_throughput": 14338.285, "synch_weights_time_ms": 10.705}, "counters": {"num_env_steps_sampled": 60032, "num_env_steps_trained": 17028, "num_agent_steps_sampled": 180096, "num_agent_steps_trained": 17028, "last_target_update_ts": 60032, "num_target_updates": 66}, "done": false, "episodes_total": 0, "training_iteration": 40, "trial_id": "cfa97_00000", "date": "2023-11-18_21-03-34", "timestamp": 1700370214, "time_this_iter_s": 1.9490137100219727, "time_total_s": 67.04785633087158, "pid": 6770, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17f309e40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 67.04785633087158, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 66.73333333333333, "ram_util_percent": 64.96666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.12398910522461, "actor_loss": -8.306461334228516, "critic_loss": 0.2875448167324066, "alpha_loss": -0.20363645255565643, "alpha_value": 0.9800866842269897, "log_alpha_value": -0.02011425420641899, "target_entropy": -6.0, "policy_t": -0.02392544411122799, "mean_q": 4.51519250869751, "max_q": 11.292863845825195, "min_q": 4.321308135986328}, "td_error": [0.20381975173950195, 0.743664026260376, 2.3154358863830566, 1.0551600456237793, 1.3521077632904053, 0.20261907577514648, 0.6184580326080322, 0.33380186557769775, 0.31519579887390137, 0.2131044864654541, 1.6264944076538086, 0.32640624046325684, 1.5332293510437012, 0.20364832878112793, 0.20676493644714355, 1.1860125064849854, 0.46364831924438477, 0.7684288024902344, 0.30570316314697266, 0.2416994571685791, 0.31740856170654297, 1.0554511547088623, 0.3314194679260254, 0.20302915573120117, 0.22447681427001953, 0.6092896461486816, 0.6248452663421631, 1.9628915786743164, 0.2023465633392334, 0.21639490127563477, 1.6369733810424805, 0.19959735870361328, 0.9399409294128418, 0.7423515319824219, 1.6961860656738281, 0.9259035587310791, 0.8498923778533936, 1.601193904876709, 1.2937300205230713, 0.7272119522094727, 1.0137605667114258, 0.31226062774658203, 0.20943737030029297, 1.4247887134552002, 1.318774700164795, 0.2937450408935547, 0.20948243141174316, 2.0302507877349854, 0.3295273780822754, 0.263530969619751, 0.8191208839416504, 0.3301563262939453, 1.9127225875854492, 0.6188874244689941, 0.21382379531860352, 0.6522090435028076, 0.5102949142456055, 1.1981315612792969, 1.8599095344543457, 1.2970409393310547, 0.34757113456726074, 0.8207509517669678, 0.7886714935302734, 0.270780086517334, 0.861107587814331, 1.480074167251587, 1.1269333362579346, 3.328098773956299, 0.6768205165863037, 1.9986300468444824, 1.0506081581115723, 0.9365725517272949, 0.9231762886047363, 0.2901804447174072, 0.20677566528320312, 0.8736972808837891, 1.3986759185791016, 1.2105562686920166, 0.7277786731719971, 0.2059485912322998, 0.8680627346038818, 0.9257493019104004, 1.5109646320343018, 0.6639065742492676, 1.331136703491211, 7.164742469787598], "mean_td_error": 0.9230437874794006, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 68.0, "diff_num_grad_updates_vs_sampler_policy": 67.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.078845977783203, "actor_loss": -6.966470241546631, "critic_loss": 0.17331817746162415, "alpha_loss": -0.2027038335800171, "alpha_value": 0.9800890684127808, "log_alpha_value": -0.0201118104159832, "target_entropy": -6.0, "policy_t": -0.07127264887094498, "mean_q": 2.8635215759277344, "max_q": 3.114809989929199, "min_q": 1.9276421070098877}, "td_error": [0.15042197704315186, 0.9597901105880737, 0.21442413330078125, 0.9081486463546753, 1.4245045185089111, 1.4553711414337158, 1.1663461923599243, 0.8811168670654297, 2.3265771865844727, 0.43373942375183105, 1.0794305801391602, 0.3343501091003418, 0.1517326831817627, 0.9082620143890381, 1.026426076889038, 0.8769912719726562, 1.078199863433838, 0.562255859375, 0.07949268817901611, 1.0814988613128662, 0.4208468198776245, 1.0400896072387695, 0.02251255512237549, 0.3699319362640381, 0.8438887596130371, 0.044314026832580566, 1.4000521898269653, 0.0191575288772583, 2.526045083999634, 0.9935054779052734, 1.093576431274414, 0.8235385417938232, 0.5102598667144775, 0.3901205062866211, 1.3787614107131958, 0.46808183193206787, 0.931818962097168, 1.5656540393829346, 0.5145806074142456, 0.7188950777053833, 0.23694026470184326, 1.1824097633361816, 0.7194888591766357, 1.0693433284759521, 0.618996262550354, 0.4627002477645874, 0.9002723693847656, 1.6054023504257202, 0.29154062271118164, 0.7287802696228027, 0.5351139307022095, 1.07962167263031, 1.9700889587402344, 2.5958242416381836, 0.5393286943435669, 0.21049165725708008, 0.11957669258117676, 1.3585255146026611, 2.2180895805358887, 0.039298295974731445, 1.5815050601959229, 1.1265225410461426, 3.1830086708068848, 1.9831132888793945, 0.727195143699646, 0.05271196365356445, 0.5890048742294312, 1.3322722911834717, 2.1267776489257812, 1.1809310913085938, 1.330152988433838, 0.2153177261352539, 0.5995426177978516, 2.2332944869995117, 0.19061005115509033, 0.4123704433441162, 0.29639506340026855, 0.7308964729309082, 0.7969565391540527, 0.8479102849960327, 0.4354604482650757, 1.3936272859573364, 0.7154921293258667, 1.971670389175415, 0.14741921424865723, 0.26674818992614746], "mean_td_error": 0.9084122180938721, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 68.0, "diff_num_grad_updates_vs_sampler_policy": 67.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.03857421875, "actor_loss": -6.6910505294799805, "critic_loss": 0.10585395246744156, "alpha_loss": -0.2019074410200119, "alpha_value": 0.9800877571105957, "log_alpha_value": -0.020113157108426094, "target_entropy": -6.0, "policy_t": 0.00024155776191037148, "mean_q": 2.737168312072754, "max_q": 2.7819201946258545, "min_q": 2.093735456466675}, "td_error": [0.0998450517654419, 1.7310631275177002, 0.4828770160675049, 0.051815032958984375, 0.17092859745025635, 0.30321621894836426, 0.09538757801055908, 0.22725927829742432, 1.5074228048324585, 0.5311336517333984, 1.3207950592041016, 0.021224617958068848, 0.43469512462615967, 0.5263773202896118, 0.4275550842285156, 0.5460710525512695, 0.8646368980407715, 1.4021401405334473, 0.2896153926849365, 0.5872498750686646, 0.5046162605285645, 2.414318084716797, 0.7275573015213013, 1.847345232963562, 0.17152225971221924, 0.4124720096588135, 0.20701861381530762, 1.8169353008270264, 1.135847806930542, 1.3026084899902344, 0.3775508403778076, 2.2117929458618164, 0.24329757690429688, 1.4435019493103027, 0.7259457111358643, 1.1295623779296875, 1.1289193630218506, 2.9849095344543457, 0.8860822916030884, 1.050262689590454, 0.1637636423110962, 0.15636897087097168, 0.5762823820114136, 0.4922499656677246, 1.089140772819519, 0.3204001188278198, 2.241485118865967, 0.4286034107208252, 1.1166452169418335, 0.19086134433746338, 0.6147332191467285, 1.6637165546417236, 0.7939963340759277, 0.45161867141723633, 1.4013574123382568, 0.39190924167633057, 1.0662944316864014, 1.4270683526992798, 0.4162951707839966, 0.12623965740203857, 0.42981183528900146, 1.0245052576065063, 0.25179123878479004, 0.5119092464447021, 0.29714250564575195, 0.49027740955352783, 0.016198158264160156, 0.5552866458892822, 0.2556413412094116, 0.3296384811401367, 0.7091885805130005, 1.696664810180664, 0.8050073385238647, 1.1955217123031616, 1.42923104763031, 0.2758404016494751, 0.40418577194213867, 0.15141916275024414, 2.3976409435272217, 2.5275063514709473, 1.0330703258514404, 1.3399585485458374, 0.609400749206543, 1.3794955015182495, 1.3276430368423462, 0.8950691223144531], "mean_td_error": 0.8350168466567993, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 68.0, "diff_num_grad_updates_vs_sampler_policy": 67.0}}, "num_env_steps_sampled": 61824, "num_env_steps_trained": 17544, "num_agent_steps_sampled": 185472, "num_agent_steps_trained": 17544, "last_target_update_ts": 61824, "num_target_updates": 68}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 185472, "num_agent_steps_trained": 17544, "num_env_steps_sampled": 61824, "num_env_steps_trained": 17544, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 920.5624654078375, "num_env_steps_trained_throughput_per_sec": 265.0726741910961, "timesteps_total": 61824, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 185472, "timers": {"training_iteration_time_ms": 967.456, "sample_time_ms": 694.201, "load_time_ms": 0.318, "load_throughput": 812410.234, "learn_time_ms": 18.038, "learn_throughput": 14303.148, "synch_weights_time_ms": 10.176}, "counters": {"num_env_steps_sampled": 61824, "num_env_steps_trained": 17544, "num_agent_steps_sampled": 185472, "num_agent_steps_trained": 17544, "last_target_update_ts": 61824, "num_target_updates": 68}, "done": false, "episodes_total": 0, "training_iteration": 41, "trial_id": "cfa97_00000", "date": "2023-11-18_21-03-36", "timestamp": 1700370216, "time_this_iter_s": 1.956028938293457, "time_total_s": 69.00388526916504, "pid": 6770, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17f308ea0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 69.00388526916504, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 75.9, "ram_util_percent": 65.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.069432258605957, "actor_loss": -8.341176986694336, "critic_loss": 0.3190653920173645, "alpha_loss": -0.2055610865354538, "alpha_value": 0.979792594909668, "log_alpha_value": -0.02041436731815338, "target_entropy": -6.0, "policy_t": 0.014177478849887848, "mean_q": 4.674046039581299, "max_q": 11.13333511352539, "min_q": 4.521510124206543}, "td_error": [0.42279767990112305, 0.8674883842468262, 0.43959689140319824, 2.2680091857910156, 0.2830028533935547, 0.41646718978881836, 1.0186436176300049, 0.8126046657562256, 1.5362029075622559, 0.5219731330871582, 1.0676443576812744, 0.45265769958496094, 0.9369120597839355, 0.19569182395935059, 1.210775375366211, 1.5564677715301514, 1.9209234714508057, 0.9100182056427002, 0.2883024215698242, 0.8950560092926025, 0.20048093795776367, 1.9696803092956543, 0.2530369758605957, 0.8949759006500244, 2.2520880699157715, 0.43619751930236816, 1.195472240447998, 0.7783656120300293, 1.5925393104553223, 1.499634027481079, 0.5306086540222168, 1.9672720432281494, 0.7253682613372803, 0.9893999099731445, 0.2342514991760254, 0.8472349643707275, 0.19707989692687988, 1.5373287200927734, 0.4685535430908203, 1.200432300567627, 1.3928000926971436, 1.4521596431732178, 0.8253695964813232, 0.45509815216064453, 0.6331536769866943, 0.7264249324798584, 0.36096954345703125, 0.9068386554718018, 0.19853878021240234, 3.6168408393859863, 0.5860939025878906, 0.3526802062988281, 0.32065916061401367, 2.298085927963257, 1.2611782550811768, 1.0403976440429688, 0.19532132148742676, 0.548323392868042, 0.1891462802886963, 0.1955723762512207, 1.8456745147705078, 0.6721436977386475, 0.28336143493652344, 0.5133240222930908, 1.1917219161987305, 0.7135426998138428, 0.6118495464324951, 6.847126483917236, 0.6548266410827637, 0.2047884464263916, 0.590296745300293, 1.0545082092285156, 1.2169814109802246, 0.2753148078918457, 2.260373830795288, 1.0396339893341064, 1.3000667095184326, 0.20443153381347656, 1.5139734745025635, 0.6091833114624023, 0.5647516250610352, 1.2169454097747803, 0.334639310836792, 2.5617120265960693, 1.4532957077026367, 0.9608581066131592], "mean_td_error": 1.0004909038543701, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 69.0, "diff_num_grad_updates_vs_sampler_policy": 68.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.062826156616211, "actor_loss": -6.881394386291504, "critic_loss": 0.14875248074531555, "alpha_loss": -0.20540250837802887, "alpha_value": 0.9797949194908142, "log_alpha_value": -0.020412011072039604, "target_entropy": -6.0, "policy_t": 0.015542593784630299, "mean_q": 2.8377416133880615, "max_q": 3.0479955673217773, "min_q": 1.847399353981018}, "td_error": [0.5744345188140869, 1.034998893737793, 0.1703193187713623, 1.1944910287857056, 0.2772209644317627, 0.8816710710525513, 0.4029557704925537, 0.8054764270782471, 1.0974763631820679, 0.42933201789855957, 0.1962982416152954, 2.561347484588623, 1.2715505361557007, 1.8586711883544922, 1.140779972076416, 0.6499689817428589, 0.4009439945220947, 0.2887080907821655, 0.24824726581573486, 1.0065144300460815, 1.3453314304351807, 0.9059658050537109, 0.15076184272766113, 0.5385164022445679, 1.9938929080963135, 0.6377942562103271, 0.5825917720794678, 0.7305257320404053, 0.2486952543258667, 0.19297456741333008, 0.7381794452667236, 0.9536905288696289, 0.8310043811798096, 0.049939632415771484, 0.9825124740600586, 0.3057136535644531, 0.4032120704650879, 0.6051558256149292, 2.552971601486206, 0.15444791316986084, 1.5227866172790527, 0.984264612197876, 0.27086973190307617, 1.6251499652862549, 0.6580492258071899, 0.7649142742156982, 0.1358433961868286, 1.0089986324310303, 0.661827802658081, 1.229335069656372, 0.804890513420105, 0.2552473545074463, 0.848825216293335, 0.298708438873291, 0.33972954750061035, 1.8143612146377563, 2.1630032062530518, 0.023430705070495605, 1.8246196508407593, 0.6740708351135254, 0.5480891466140747, 0.08903133869171143, 0.8166794180870056, 1.2603062391281128, 2.2451953887939453, 0.5485296249389648, 0.3143479824066162, 0.2782098054885864, 1.3901937007904053, 0.7427465915679932, 0.5479652881622314, 0.6844489574432373, 0.6809484958648682, 0.5790064334869385, 0.5022001266479492, 0.8490297794342041, 0.621840238571167, 0.4340345859527588, 1.4841878414154053, 0.3482891321182251, 1.115383505821228, 1.4255088567733765, 0.6586722135543823, 0.30398988723754883, 2.8166327476501465, 1.5700148344039917], "mean_td_error": 0.8390661478042603, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 69.0, "diff_num_grad_updates_vs_sampler_policy": 68.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.090038299560547, "actor_loss": -6.798294544219971, "critic_loss": 0.10871081054210663, "alpha_loss": -0.2059715837240219, "alpha_value": 0.9797936081886292, "log_alpha_value": -0.020413359627127647, "target_entropy": -6.0, "policy_t": -0.0536140576004982, "mean_q": 2.788238286972046, "max_q": 3.4176948070526123, "min_q": 2.67437744140625}, "td_error": [0.5208510160446167, 0.5743355751037598, 0.690496563911438, 0.4278891086578369, 1.6227797269821167, 0.3875741958618164, 0.8302959203720093, 0.7792997360229492, 0.8046184778213501, 0.5814024209976196, 2.0859534740448, 0.843573808670044, 1.0815192461013794, 0.30428004264831543, 1.4537956714630127, 2.8170018196105957, 0.1602097749710083, 1.6208540201187134, 1.9335331916809082, 0.26868200302124023, 0.19296479225158691, 0.057843923568725586, 0.7802382707595825, 1.8683671951293945, 0.7288994789123535, 2.149286985397339, 0.09762024879455566, 2.1173086166381836, 1.3683691024780273, 1.317917823791504, 0.17758142948150635, 0.013733267784118652, 0.3341977596282959, 0.02335536479949951, 0.4354790449142456, 0.7773439884185791, 0.9704291820526123, 0.7948522567749023, 1.0593897104263306, 0.5507094860076904, 0.27052974700927734, 2.4118175506591797, 0.5751218795776367, 0.031383514404296875, 0.588274359703064, 0.1612030267715454, 0.7859728336334229, 1.0861034393310547, 0.5079132318496704, 0.6444211006164551, 1.3489913940429688, 0.5768039226531982, 0.4509408473968506, 1.140175700187683, 0.8660614490509033, 0.6791954040527344, 1.4522541761398315, 0.26765453815460205, 1.5963366031646729, 0.20269346237182617, 1.5759902000427246, 1.6848889589309692, 0.8157655000686646, 0.16824471950531006, 0.5284924507141113, 1.435028314590454, 1.2593128681182861, 0.8247973918914795, 1.1507477760314941, 0.962552547454834, 2.3755557537078857, 0.5052210092544556, 0.7855358123779297, 0.4234417676925659, 0.546072244644165, 0.12778759002685547, 0.865281343460083, 0.33559727668762207, 1.2460263967514038, 0.4540269374847412, 0.2921769618988037, 0.019031524658203125, 0.610061526298523, 1.9431265592575073, 0.5987486839294434, 0.1787128448486328], "mean_td_error": 0.8483826518058777, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 69.0, "diff_num_grad_updates_vs_sampler_policy": 68.0}}, "num_env_steps_sampled": 62720, "num_env_steps_trained": 17802, "num_agent_steps_sampled": 188160, "num_agent_steps_trained": 17802, "last_target_update_ts": 62720, "num_target_updates": 69}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 188160, "num_agent_steps_trained": 17802, "num_env_steps_sampled": 62720, "num_env_steps_trained": 17802, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 706.3043439610178, "num_env_steps_trained_throughput_per_sec": 203.37781332806094, "timesteps_total": 62720, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 188160, "timers": {"training_iteration_time_ms": 998.569, "sample_time_ms": 726.466, "load_time_ms": 0.315, "load_throughput": 818617.469, "learn_time_ms": 18.117, "learn_throughput": 14240.938, "synch_weights_time_ms": 10.236}, "counters": {"num_env_steps_sampled": 62720, "num_env_steps_trained": 17802, "num_agent_steps_sampled": 188160, "num_agent_steps_trained": 17802, "last_target_update_ts": 62720, "num_target_updates": 69}, "done": false, "episodes_total": 0, "training_iteration": 42, "trial_id": "cfa97_00000", "date": "2023-11-18_21-03-37", "timestamp": 1700370217, "time_this_iter_s": 1.2766451835632324, "time_total_s": 70.28053045272827, "pid": 6770, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17f28e5c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 70.28053045272827, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 61.0, "ram_util_percent": 65.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.121088981628418, "actor_loss": -8.604129791259766, "critic_loss": 0.2662980854511261, "alpha_loss": -0.21268990635871887, "alpha_value": 0.9792047142982483, "log_alpha_value": -0.02101452462375164, "target_entropy": -6.0, "policy_t": -0.003695165039971471, "mean_q": 4.869169235229492, "max_q": 11.734946250915527, "min_q": 4.4642333984375}, "td_error": [1.6788678169250488, 0.8187427520751953, 1.680962324142456, 0.5230560302734375, 0.23897624015808105, 1.0265543460845947, 1.329073190689087, 0.5828752517700195, 0.4987678527832031, 0.31403303146362305, 0.7221438884735107, 0.2042386531829834, 1.4078235626220703, 0.7462692260742188, 0.6346402168273926, 2.126394510269165, 0.1705012321472168, 0.18755626678466797, 0.343883752822876, 0.5744860172271729, 0.26760244369506836, 0.9612741470336914, 0.27925586700439453, 0.40023326873779297, 0.42055368423461914, 0.6109137535095215, 1.7039704322814941, 1.482588768005371, 1.2013208866119385, 1.4228246212005615, 0.1711268424987793, 0.22319698333740234, 1.1677680015563965, 1.165015697479248, 1.7538328170776367, 1.7517406940460205, 1.1158087253570557, 0.6685266494750977, 1.4417297840118408, 1.044191837310791, 1.7119293212890625, 0.2675352096557617, 0.6546661853790283, 1.7066624164581299, 0.5125346183776855, 0.4461379051208496, 0.4380357265472412, 2.0260605812072754, 0.30164051055908203, 0.7971298694610596, 0.6180248260498047, 1.4629638195037842, 0.35289692878723145, 0.8385379314422607, 0.180084228515625, 0.184967041015625, 0.8306951522827148, 0.8804073333740234, 0.1703658103942871, 0.49471235275268555, 0.35167741775512695, 0.45705533027648926, 0.3004488945007324, 1.5593738555908203, 0.17157530784606934, 1.094940423965454, 0.9127182960510254, 0.5447206497192383, 0.3054429292678833, 0.6955051422119141, 1.334693431854248, 0.5138311386108398, 1.0456783771514893, 0.22696948051452637, 0.7248001098632812, 0.9088711738586426, 0.20634865760803223, 0.18193912506103516, 0.17257404327392578, 0.48750805854797363, 1.1611213684082031, 8.589619636535645, 1.7013888359069824, 0.30914902687072754, 0.8659145832061768, 0.4325542449951172], "mean_td_error": 0.8743690848350525, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 71.0, "diff_num_grad_updates_vs_sampler_policy": 70.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.035768508911133, "actor_loss": -6.881657600402832, "critic_loss": 0.16699287295341492, "alpha_loss": -0.21087436378002167, "alpha_value": 0.979206919670105, "log_alpha_value": -0.021012280136346817, "target_entropy": -6.0, "policy_t": -0.03617263212800026, "mean_q": 2.91064715385437, "max_q": 3.0736987590789795, "min_q": 2.1350364685058594}, "td_error": [1.672542691230774, 1.3157719373703003, 1.5399010181427002, 1.478715181350708, 1.9582886695861816, 0.8496720790863037, 0.046288251876831055, 1.4891313314437866, 0.5137237310409546, 1.2503983974456787, 0.5228197574615479, 0.3803185224533081, 0.14297795295715332, 3.0252232551574707, 1.450096845626831, 1.157543659210205, 1.263008713722229, 0.4326437711715698, 0.549567461013794, 0.014079928398132324, 0.137076735496521, 0.5582300424575806, 2.0783257484436035, 0.9419249296188354, 0.8458627462387085, 0.2545264959335327, 1.5231831073760986, 1.5880122184753418, 0.6431015729904175, 1.3806395530700684, 1.5720391273498535, 0.3678596019744873, 0.2510075569152832, 0.37430596351623535, 0.5005888938903809, 1.3901363611221313, 0.17715859413146973, 0.0962141752243042, 1.4785300493240356, 0.13242411613464355, 1.990868091583252, 2.393789768218994, 1.2841756343841553, 0.2880394458770752, 0.29095208644866943, 0.4002021551132202, 0.5123085975646973, 1.1436043977737427, 1.107965350151062, 1.3100988864898682, 1.8203158378601074, 0.6323298215866089, 1.4601856470108032, 0.4123002290725708, 0.10909795761108398, 0.4796316623687744, 0.9434293508529663, 1.1703169345855713, 0.15570592880249023, 0.11524128913879395, 0.7174966335296631, 0.7700514793395996, 0.5825345516204834, 0.7056699991226196, 1.932870864868164, 1.0773191452026367, 0.7550663948059082, 0.5830259323120117, 0.6997967958450317, 0.3255234956741333, 0.6136474609375, 0.7760906219482422, 0.847983717918396, 0.5523669719696045, 1.7041794061660767, 1.8431999683380127, 1.4778382778167725, 0.0318983793258667, 1.558089017868042, 0.40840768814086914, 0.2625631093978882, 1.3795393705368042, 0.8815356492996216, 1.761759877204895, 0.07041096687316895, 0.19661784172058105], "mean_td_error": 0.9055802822113037, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 71.0, "diff_num_grad_updates_vs_sampler_policy": 70.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.108295440673828, "actor_loss": -6.830862998962402, "critic_loss": 0.12725546956062317, "alpha_loss": -0.2124125212430954, "alpha_value": 0.9792055487632751, "log_alpha_value": -0.02101368084549904, "target_entropy": -6.0, "policy_t": -0.015737175941467285, "mean_q": 2.8130087852478027, "max_q": 3.219914674758911, "min_q": 2.09376859664917}, "td_error": [0.9590945243835449, 0.1941831111907959, 0.33281779289245605, 1.5720269680023193, 1.0286839008331299, 0.9194661378860474, 0.3042813539505005, 0.632662296295166, 0.48856329917907715, 1.1256604194641113, 1.2156368494033813, 1.6886295080184937, 0.6106700897216797, 0.4574580192565918, 0.37581682205200195, 0.05857956409454346, 1.8889667987823486, 0.11077570915222168, 0.5611221790313721, 1.4106122255325317, 1.6810786724090576, 0.4242957830429077, 1.2775003910064697, 2.1486687660217285, 1.9703787565231323, 0.6931444406509399, 1.6287306547164917, 0.8835475444793701, 0.41969776153564453, 2.178659200668335, 0.3887958526611328, 0.09538185596466064, 1.5429843664169312, 0.9570337533950806, 0.2131187915802002, 2.4568800926208496, 0.32985472679138184, 0.6283009052276611, 0.2956361770629883, 0.5244307518005371, 0.9069147109985352, 0.9728128910064697, 2.5927910804748535, 0.5226598978042603, 0.6717342138290405, 0.7500680685043335, 0.16823410987854004, 0.9594048261642456, 0.12055420875549316, 0.295973539352417, 0.8828098773956299, 0.5282975435256958, 1.1377149820327759, 0.30812251567840576, 2.010165214538574, 0.3507039546966553, 0.2031688690185547, 1.6797202825546265, 1.5848231315612793, 1.7913966178894043, 0.41609621047973633, 0.24409472942352295, 0.07472002506256104, 0.7424046993255615, 2.6346302032470703, 0.36124300956726074, 1.7686964273452759, 0.6903882026672363, 0.5964351892471313, 1.5209633111953735, 1.3688902854919434, 0.11537468433380127, 0.0212632417678833, 0.7739512920379639, 1.941448450088501, 0.7393835783004761, 0.9873086214065552, 2.076725482940674, 0.784187912940979, 0.5514628887176514, 0.3761991262435913, 1.6936664581298828, 0.3188883066177368, 3.177485466003418, 0.6118007898330688, 0.03085505962371826], "mean_td_error": 0.9270983934402466, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 71.0, "diff_num_grad_updates_vs_sampler_policy": 70.0}}, "num_env_steps_sampled": 64512, "num_env_steps_trained": 18318, "num_agent_steps_sampled": 193536, "num_agent_steps_trained": 18318, "last_target_update_ts": 64512, "num_target_updates": 71}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 193536, "num_agent_steps_trained": 18318, "num_env_steps_sampled": 64512, "num_env_steps_trained": 18318, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 959.582978690808, "num_env_steps_trained_throughput_per_sec": 276.3084916319514, "timesteps_total": 64512, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 193536, "timers": {"training_iteration_time_ms": 993.903, "sample_time_ms": 721.227, "load_time_ms": 0.314, "load_throughput": 822350.051, "learn_time_ms": 18.118, "learn_throughput": 14239.832, "synch_weights_time_ms": 10.094}, "counters": {"num_env_steps_sampled": 64512, "num_env_steps_trained": 18318, "num_agent_steps_sampled": 193536, "num_agent_steps_trained": 18318, "last_target_update_ts": 64512, "num_target_updates": 71}, "done": false, "episodes_total": 0, "training_iteration": 43, "trial_id": "cfa97_00000", "date": "2023-11-18_21-03-39", "timestamp": 1700370219, "time_this_iter_s": 1.8766469955444336, "time_total_s": 72.1571774482727, "pid": 6770, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17f30a200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 72.1571774482727, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 64.36666666666667, "ram_util_percent": 65.23333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.067618370056152, "actor_loss": -8.856554985046387, "critic_loss": 0.42713138461112976, "alpha_loss": -0.21761012077331543, "alpha_value": 0.9786170721054077, "log_alpha_value": -0.021614858880639076, "target_entropy": -6.0, "policy_t": -0.044246502220630646, "mean_q": 5.146082878112793, "max_q": 12.118227005004883, "min_q": 4.497204303741455}, "td_error": [8.571922302246094, 1.423060655593872, 0.4963347911834717, 2.946229934692383, 0.41461849212646484, 0.5429763793945312, 1.3761887550354004, 1.879260540008545, 1.6355903148651123, 1.007645606994629, 0.8639886379241943, 0.14582204818725586, 0.7111270427703857, 0.1891648769378662, 0.9856984615325928, 0.4590113162994385, 1.8739967346191406, 0.9808793067932129, 1.4678936004638672, 0.24945759773254395, 0.38483285903930664, 1.7279822826385498, 1.4135284423828125, 1.0405972003936768, 0.839627742767334, 0.5525193214416504, 0.6696851253509521, 2.582183837890625, 1.2255799770355225, 3.674830198287964, 0.14664363861083984, 0.5303056240081787, 0.13883161544799805, 1.9987154006958008, 3.5095162391662598, 0.2556784152984619, 0.5923211574554443, 6.264369964599609, 0.8023574352264404, 0.8722188472747803, 1.9493632316589355, 1.0242962837219238, 5.417397499084473, 0.12738752365112305, 2.4331908226013184, 0.7185819149017334, 0.6534836292266846, 1.0451078414916992, 0.7357215881347656, 0.6032047271728516, 0.934988260269165, 0.7321014404296875, 0.7716145515441895, 0.397951602935791, 0.45194339752197266, 1.0468387603759766, 0.8303384780883789, 1.9473402500152588, 0.921597957611084, 0.82883620262146, 1.3099775314331055, 0.9190666675567627, 0.40609169006347656, 0.15459084510803223, 0.482025146484375, 1.5801620483398438, 0.17235350608825684, 1.274768352508545, 0.7986650466918945, 1.3201067447662354, 1.097114086151123, 1.6551017761230469, 0.8879621028900146, 1.984541416168213, 0.30303955078125, 0.749373197555542, 1.1945161819458008, 1.690577745437622, 0.19477224349975586, 0.546663761138916, 0.8599944114685059, 0.3032052516937256, 0.3093435764312744, 0.13575530052185059, 1.827843427658081, 1.2278803586959839], "mean_td_error": 1.2139530181884766, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 73.0, "diff_num_grad_updates_vs_sampler_policy": 72.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.048007011413574, "actor_loss": -6.84056282043457, "critic_loss": 0.15400156378746033, "alpha_loss": -0.21715931594371796, "alpha_value": 0.9786196947097778, "log_alpha_value": -0.021612176671624184, "target_entropy": -6.0, "policy_t": -0.023484190925955772, "mean_q": 2.832984685897827, "max_q": 3.072612762451172, "min_q": 1.7083834409713745}, "td_error": [0.5606318712234497, 0.2533477544784546, 0.11497819423675537, 0.3351792097091675, 0.3250812292098999, 0.08124446868896484, 3.05493426322937, 0.4592163562774658, 0.23732781410217285, 0.2656998634338379, 0.6416466236114502, 1.5237749814987183, 0.9081013202667236, 1.0069297552108765, 0.5186113119125366, 0.31582367420196533, 1.472702980041504, 0.03093564510345459, 0.43459486961364746, 0.20245325565338135, 0.9384404420852661, 0.07860982418060303, 0.047312021255493164, 0.4952974319458008, 0.0919727087020874, 0.8857378959655762, 0.587399959564209, 1.1886069774627686, 0.715583324432373, 0.7645620107650757, 1.1387563943862915, 1.1977143287658691, 0.054087162017822266, 1.2798984050750732, 1.1125292778015137, 0.269569993019104, 0.2827565670013428, 0.6244761943817139, 1.91444730758667, 0.4175606369972229, 0.5548003911972046, 0.09209990501403809, 0.04305219650268555, 1.573793649673462, 1.7022228240966797, 0.2607436180114746, 0.8535783290863037, 2.648733615875244, 1.9674365520477295, 0.021670103073120117, 2.044109344482422, 0.6863371133804321, 1.4093258380889893, 0.31381046772003174, 0.191719651222229, 1.0512102842330933, 1.5353132486343384, 1.2415542602539062, 0.7772170305252075, 0.14273524284362793, 0.04554426670074463, 0.30519354343414307, 0.761492908000946, 2.3279871940612793, 0.9052872657775879, 0.5261476039886475, 1.658285140991211, 0.04714500904083252, 1.7347512245178223, 0.7108719348907471, 1.6697392463684082, 0.060910820960998535, 1.2112202644348145, 1.076285719871521, 0.4836459159851074, 1.474693775177002, 2.318319797515869, 0.05408883094787598, 0.0911332368850708, 1.3446595668792725, 1.9155551195144653, 0.32358479499816895, 1.724921703338623, 0.4519854784011841, 1.563674807548523, 0.7552186250686646], "mean_td_error": 0.8311900496482849, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 73.0, "diff_num_grad_updates_vs_sampler_policy": 72.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.072834968566895, "actor_loss": -6.807426452636719, "critic_loss": 0.12742437422275543, "alpha_loss": -0.21771320700645447, "alpha_value": 0.9786180257797241, "log_alpha_value": -0.021613895893096924, "target_entropy": -6.0, "policy_t": -0.0011083978461101651, "mean_q": 2.829179525375366, "max_q": 3.0951151847839355, "min_q": 1.8439104557037354}, "td_error": [2.6423094272613525, 0.6277397871017456, 0.06360387802124023, 1.135849952697754, 1.012671709060669, 0.09643232822418213, 0.37562692165374756, 2.5998902320861816, 0.7046444416046143, 0.7381246089935303, 1.6163358688354492, 1.6510144472122192, 1.8525742292404175, 0.07243788242340088, 1.1949723958969116, 0.25377917289733887, 0.7799932956695557, 0.8637360334396362, 1.1132729053497314, 0.6801140308380127, 0.09548115730285645, 0.9475939273834229, 1.1330927610397339, 0.7285418510437012, 2.8441991806030273, 1.457137107849121, 0.17795133590698242, 1.7829139232635498, 1.1800473928451538, 2.4378867149353027, 1.2288060188293457, 0.41838502883911133, 0.14839088916778564, 0.8264312744140625, 1.2065037488937378, 1.1036677360534668, 0.7457456588745117, 0.6014649868011475, 0.4710909128189087, 0.11633408069610596, 0.9617838859558105, 0.8516678810119629, 0.6707894802093506, 0.03222846984863281, 0.4330095052719116, 0.3412206172943115, 0.3406667709350586, 1.009411334991455, 0.7208607196807861, 1.5426490306854248, 1.7777222394943237, 0.09659147262573242, 0.9996351003646851, 1.8898661136627197, 0.793506383895874, 0.19032764434814453, 0.9994953870773315, 0.4483635425567627, 0.5584656000137329, 0.14085769653320312, 0.7132003307342529, 1.2290140390396118, 0.4917128086090088, 0.3703744411468506, 1.6931241750717163, 0.08869409561157227, 1.2153782844543457, 0.6128661632537842, 0.4968395233154297, 1.5733507871627808, 2.4487180709838867, 0.16552722454071045, 1.6919288635253906, 1.2148629426956177, 0.8311891555786133, 0.38252687454223633, 2.7312560081481934, 0.15102124214172363, 0.74235999584198, 0.3037116527557373, 2.086792469024658, 0.45435893535614014, 1.7944672107696533, 0.8827694654464722, 0.31420397758483887, 0.5761944055557251], "mean_td_error": 0.9277017116546631, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 73.0, "diff_num_grad_updates_vs_sampler_policy": 72.0}}, "num_env_steps_sampled": 66304, "num_env_steps_trained": 18834, "num_agent_steps_sampled": 198912, "num_agent_steps_trained": 18834, "last_target_update_ts": 66304, "num_target_updates": 73}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 198912, "num_agent_steps_trained": 18834, "num_env_steps_sampled": 66304, "num_env_steps_trained": 18834, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 944.1606328276584, "num_env_steps_trained_throughput_per_sec": 271.86768222046413, "timesteps_total": 66304, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 198912, "timers": {"training_iteration_time_ms": 993.506, "sample_time_ms": 721.033, "load_time_ms": 0.313, "load_throughput": 823225.89, "learn_time_ms": 18.106, "learn_throughput": 14249.414, "synch_weights_time_ms": 9.664}, "counters": {"num_env_steps_sampled": 66304, "num_env_steps_trained": 18834, "num_agent_steps_sampled": 198912, "num_agent_steps_trained": 18834, "last_target_update_ts": 66304, "num_target_updates": 73}, "done": false, "episodes_total": 0, "training_iteration": 44, "trial_id": "cfa97_00000", "date": "2023-11-18_21-03-41", "timestamp": 1700370221, "time_this_iter_s": 1.9053592681884766, "time_total_s": 74.06253671646118, "pid": 6770, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17f28f380>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 74.06253671646118, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 76.45, "ram_util_percent": 65.15}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.147769927978516, "actor_loss": -8.945865631103516, "critic_loss": 0.3468959927558899, "alpha_loss": -0.22543375194072723, "alpha_value": 0.9780298471450806, "log_alpha_value": -0.0222150981426239, "target_entropy": -6.0, "policy_t": 0.00654970109462738, "mean_q": 5.15901517868042, "max_q": 11.310601234436035, "min_q": 4.477538585662842}, "td_error": [0.0936131477355957, 1.3877980709075928, 0.816556453704834, 0.23613667488098145, 1.1101887226104736, 0.8310897350311279, 0.9250228404998779, 0.1346263885498047, 6.514846324920654, 0.17785120010375977, 0.2158660888671875, 0.6250994205474854, 0.3217012882232666, 0.25203752517700195, 0.28464388847351074, 1.0234575271606445, 0.4818391799926758, 3.029268264770508, 0.43247222900390625, 1.2811923027038574, 0.48796558380126953, 0.104461669921875, 0.652230978012085, 0.8429343700408936, 0.18121886253356934, 0.35695600509643555, 0.22603130340576172, 0.09471940994262695, 1.082214117050171, 1.3102514743804932, 1.3474955558776855, 0.4924345016479492, 0.3429892063140869, 6.573742866516113, 2.121055841445923, 0.36307311058044434, 0.946483850479126, 2.2685155868530273, 4.2674713134765625, 0.2544100284576416, 0.5768404006958008, 0.17957782745361328, 1.2985758781433105, 0.8934993743896484, 1.0383613109588623, 0.4944276809692383, 0.8278450965881348, 1.6780714988708496, 0.5802693367004395, 1.0571410655975342, 1.7298378944396973, 0.217909574508667, 0.7182362079620361, 1.2705442905426025, 1.6113252639770508, 1.9620885848999023, 0.0845639705657959, 1.7556054592132568, 1.0118472576141357, 1.951995611190796, 0.6734163761138916, 0.4344608783721924, 1.1653928756713867, 0.23912525177001953, 0.10752487182617188, 0.26134395599365234, 1.6724460124969482, 1.0444092750549316, 1.992164134979248, 0.10122394561767578, 0.2446603775024414, 1.2171752452850342, 1.6260628700256348, 0.8404226303100586, 0.10537338256835938, 0.38681936264038086, 0.9923744201660156, 1.197481632232666, 0.4806385040283203, 1.69919753074646, 0.5169785022735596, 1.2009403705596924, 2.004429340362549, 0.4449644088745117, 1.4505622386932373, 0.6969959735870361], "mean_td_error": 1.0258965492248535, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 75.0, "diff_num_grad_updates_vs_sampler_policy": 74.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.011388778686523, "actor_loss": -6.8607683181762695, "critic_loss": 0.17243404686450958, "alpha_loss": -0.2223711460828781, "alpha_value": 0.9780330657958984, "log_alpha_value": -0.022211819887161255, "target_entropy": -6.0, "policy_t": -0.07946383208036423, "mean_q": 2.8039708137512207, "max_q": 3.0580530166625977, "min_q": 1.6877776384353638}, "td_error": [1.2758039236068726, 2.2268385887145996, 0.11853277683258057, 1.9816005229949951, 0.653587818145752, 1.0640355348587036, 0.06533932685852051, 0.17279887199401855, 0.4296255111694336, 1.1561217308044434, 0.4006742238998413, 0.7493488788604736, 1.4884405136108398, 0.2945222854614258, 2.5824337005615234, 2.229701519012451, 0.27559149265289307, 0.35077452659606934, 0.5755833387374878, 1.4012504816055298, 1.9725126028060913, 0.6448732614517212, 0.4807378053665161, 0.2267535924911499, 0.6199779510498047, 0.7243952751159668, 1.0494455099105835, 0.9203662872314453, 0.1567554473876953, 1.693063735961914, 1.5310111045837402, 2.282848834991455, 2.3036885261535645, 0.6570947170257568, 2.272977113723755, 0.11332213878631592, 1.4112670421600342, 1.5658321380615234, 2.827038288116455, 0.8689975738525391, 1.1159629821777344, 1.0790547132492065, 1.7018377780914307, 1.2836675643920898, 0.33159637451171875, 0.828270673751831, 0.9200325012207031, 0.2786928415298462, 1.4951812028884888, 0.8680415153503418, 0.5788683891296387, 0.3564879894256592, 0.8846074342727661, 1.496422529220581, 0.08527696132659912, 0.5311410427093506, 1.362808346748352, 0.13257014751434326, 0.8272649049758911, 0.35404014587402344, 0.31407690048217773, 0.8981595039367676, 1.0548149347305298, 0.4143327474594116, 0.14184820652008057, 1.1676536798477173, 0.25446271896362305, 1.0010783672332764, 0.30205100774765015, 0.47446775436401367, 0.4408224821090698, 0.1006157398223877, 1.5918967723846436, 0.2707812786102295, 0.7474690675735474, 1.065088152885437, 0.5561114549636841, 0.9982433319091797, 1.5591768026351929, 0.7989110946655273, 1.5847734212875366, 0.2685058116912842, 2.207059860229492, 0.0855550765991211, 0.5466480255126953, 0.7054985761642456], "mean_td_error": 0.9288079738616943, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 75.0, "diff_num_grad_updates_vs_sampler_policy": 74.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.08875846862793, "actor_loss": -6.852844715118408, "critic_loss": 0.10884939134120941, "alpha_loss": -0.22411105036735535, "alpha_value": 0.9780309796333313, "log_alpha_value": -0.02221393957734108, "target_entropy": -6.0, "policy_t": -0.021497655659914017, "mean_q": 2.8145790100097656, "max_q": 2.885565996170044, "min_q": 1.8586891889572144}, "td_error": [0.06792271137237549, 0.13881134986877441, 0.5218994617462158, 1.0449368953704834, 1.4885516166687012, 1.3965227603912354, 1.061830997467041, 0.02001345157623291, 0.5903753042221069, 0.5293015241622925, 0.7439248561859131, 0.6057692766189575, 1.4661576747894287, 0.2883349657058716, 0.660189151763916, 0.668612003326416, 0.8676460981369019, 0.4583008289337158, 1.0254740715026855, 1.4072457551956177, 0.01404106616973877, 0.8694255352020264, 0.4212667942047119, 0.8788738250732422, 1.0958144664764404, 0.23034346103668213, 0.3775179386138916, 1.8606934547424316, 1.217707872390747, 2.3407058715820312, 0.6845886707305908, 0.08251476287841797, 0.240494966506958, 0.3904748558998108, 0.714808464050293, 0.32092976570129395, 0.23500573635101318, 0.6360076665878296, 0.7795100212097168, 0.8607168197631836, 0.6421699523925781, 0.27972936630249023, 0.4969198703765869, 1.5970970392227173, 0.44832277297973633, 0.029926776885986328, 0.6714258193969727, 1.0780614614486694, 0.7830080986022949, 1.5578871965408325, 0.20616579055786133, 1.7582719326019287, 0.2715243101119995, 1.372482180595398, 1.923856496810913, 0.30820560455322266, 1.3931701183319092, 1.6973061561584473, 1.2955689430236816, 0.24857378005981445, 0.2202596664428711, 0.654657244682312, 1.2366653680801392, 0.8685297966003418, 0.6717616319656372, 0.6646889448165894, 0.5625952482223511, 1.1647562980651855, 2.533081293106079, 0.2832144498825073, 2.4768381118774414, 1.1622838973999023, 2.989745855331421, 0.17414844036102295, 0.19579172134399414, 0.4194587469100952, 0.13343530893325806, 1.5616780519485474, 1.1864252090454102, 0.3268270492553711, 1.1082834005355835, 1.0551637411117554, 1.1462945938110352, 0.7493667602539062, 0.34269535541534424, 1.660893201828003], "mean_td_error": 0.8478195667266846, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 75.0, "diff_num_grad_updates_vs_sampler_policy": 74.0}}, "num_env_steps_sampled": 68096, "num_env_steps_trained": 19350, "num_agent_steps_sampled": 204288, "num_agent_steps_trained": 19350, "last_target_update_ts": 68096, "num_target_updates": 75}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 204288, "num_agent_steps_trained": 19350, "num_env_steps_sampled": 68096, "num_env_steps_trained": 19350, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 957.4915445193486, "num_env_steps_trained_throughput_per_sec": 275.70627063168746, "timesteps_total": 68096, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 204288, "timers": {"training_iteration_time_ms": 982.256, "sample_time_ms": 710.931, "load_time_ms": 0.315, "load_throughput": 818307.949, "learn_time_ms": 18.138, "learn_throughput": 14224.671, "synch_weights_time_ms": 9.769}, "counters": {"num_env_steps_sampled": 68096, "num_env_steps_trained": 19350, "num_agent_steps_sampled": 204288, "num_agent_steps_trained": 19350, "last_target_update_ts": 68096, "num_target_updates": 75}, "done": false, "episodes_total": 0, "training_iteration": 45, "trial_id": "cfa97_00000", "date": "2023-11-18_21-03-43", "timestamp": 1700370223, "time_this_iter_s": 1.8794879913330078, "time_total_s": 75.94202470779419, "pid": 6770, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17f309940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 75.94202470779419, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 70.36666666666667, "ram_util_percent": 65.16666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.008280754089355, "actor_loss": -9.168974876403809, "critic_loss": 0.33229321241378784, "alpha_loss": -0.2283448576927185, "alpha_value": 0.977442741394043, "log_alpha_value": -0.022815588861703873, "target_entropy": -6.0, "policy_t": -0.13467518985271454, "mean_q": 5.253547668457031, "max_q": 10.362161636352539, "min_q": 4.409554958343506}, "td_error": [0.5246977806091309, 0.5493855476379395, 0.7533044815063477, 0.06760454177856445, 0.6269519329071045, 0.5167860984802246, 1.2992985248565674, 1.942875623703003, 0.28220701217651367, 0.9762618541717529, 6.311816692352295, 0.5884103775024414, 1.6292948722839355, 0.9178190231323242, 0.10383224487304688, 0.7753782272338867, 1.474255084991455, 0.9242753982543945, 0.9951410293579102, 0.4950110912322998, 0.6057569980621338, 0.47713732719421387, 0.27083396911621094, 0.41165685653686523, 0.6708297729492188, 0.6994240283966064, 0.835543155670166, 0.04362297058105469, 2.7842249870300293, 0.5411388874053955, 0.16913962364196777, 1.1790611743927002, 0.971991777420044, 0.1410369873046875, 1.4253153800964355, 1.1227984428405762, 0.48155832290649414, 0.2217085361480713, 0.3863978385925293, 0.39965176582336426, 2.0931754112243652, 1.455073595046997, 1.6105098724365234, 1.069338083267212, 0.8880558013916016, 1.3800842761993408, 3.521575927734375, 0.8991172313690186, 6.3487420082092285, 1.246169090270996, 0.5212216377258301, 2.0860595703125, 2.479564666748047, 0.3494284152984619, 0.4578065872192383, 2.12711501121521, 1.4830734729766846, 0.403167724609375, 1.366736650466919, 0.3877236843109131, 0.8394742012023926, 0.06796646118164062, 1.0104990005493164, 1.6320288181304932, 0.24398016929626465, 0.42046499252319336, 0.8808934688568115, 0.45362138748168945, 0.5403971672058105, 0.7902827262878418, 0.7170169353485107, 0.2614123821258545, 5.936419486999512, 1.6159887313842773, 2.342383623123169, 1.3203353881835938, 0.7162303924560547, 1.470548391342163, 0.3436136245727539, 0.9146559238433838, 0.21027779579162598, 0.18418264389038086, 0.06166815757751465, 0.9705672264099121, 3.017631769180298, 0.5265121459960938], "mean_td_error": 1.1076306104660034, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 77.0, "diff_num_grad_updates_vs_sampler_policy": 76.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.117570877075195, "actor_loss": -6.858555793762207, "critic_loss": 0.1351824253797531, "alpha_loss": -0.23079335689544678, "alpha_value": 0.9774470925331116, "log_alpha_value": -0.02281114272773266, "target_entropy": -6.0, "policy_t": -0.01006565522402525, "mean_q": 2.7793805599212646, "max_q": 3.0198333263397217, "min_q": 1.7342212200164795}, "td_error": [0.9975167512893677, 1.3112713098526, 1.2186137437820435, 0.12342238426208496, 0.10417139530181885, 1.558974266052246, 1.3070734739303589, 1.2280240058898926, 1.7168488502502441, 0.18555974960327148, 2.5541157722473145, 0.3494302034378052, 1.0640531778335571, 1.14374840259552, 0.15973806381225586, 1.3988196849822998, 2.326504945755005, 0.7275618314743042, 0.9498965740203857, 0.5748376846313477, 0.1545172929763794, 0.8996039628982544, 0.05084109306335449, 0.5061913728713989, 0.054870009422302246, 0.3640005588531494, 0.2616884708404541, 0.8898806571960449, 1.3198344707489014, 0.6439073085784912, 1.0712480545043945, 2.0772831439971924, 0.3569803237915039, 0.4645726680755615, 1.0819250345230103, 1.3020468950271606, 0.18930506706237793, 1.552760362625122, 1.0352157354354858, 1.1470738649368286, 1.3393049240112305, 1.079918384552002, 1.9964852333068848, 0.5385273694992065, 0.4268221855163574, 1.0916389226913452, 0.7116567492485046, 0.6283097267150879, 0.5476585626602173, 1.5602039098739624, 0.8588848114013672, 0.7356147766113281, 0.3479499816894531, 0.8425816297531128, 0.05995190143585205, 0.6297026872634888, 0.5359611511230469, 0.19672751426696777, 0.2751666307449341, 0.5284138917922974, 0.3826627731323242, 0.07088613510131836, 0.026846766471862793, 0.3901658058166504, 0.7697902917861938, 0.7919591665267944, 0.5699751377105713, 0.2934952974319458, 0.7885831594467163, 0.8490563631057739, 0.6060131788253784, 1.4496170282363892, 1.2003904581069946, 0.3444145917892456, 1.6486743688583374, 0.21733450889587402, 0.1737203598022461, 0.300525426864624, 0.9189846515655518, 0.26254427433013916, 0.05003201961517334, 1.1162039041519165, 2.0139694213867188, 0.08904659748077393, 1.184521198272705, 0.5937482118606567], "mean_td_error": 0.7960299253463745, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 77.0, "diff_num_grad_updates_vs_sampler_policy": 76.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.141758918762207, "actor_loss": -6.854076862335205, "critic_loss": 0.12280367314815521, "alpha_loss": -0.23137524724006653, "alpha_value": 0.9774441719055176, "log_alpha_value": -0.02281411550939083, "target_entropy": -6.0, "policy_t": 0.017193598672747612, "mean_q": 2.797759771347046, "max_q": 2.874528408050537, "min_q": 1.7718207836151123}, "td_error": [0.8767185211181641, 0.39127135276794434, 2.1744422912597656, 0.36902689933776855, 0.29091179370880127, 1.662846326828003, 0.029693126678466797, 1.440107822418213, 0.043747544288635254, 1.3696500062942505, 0.47400128841400146, 2.0949387550354004, 0.6988531351089478, 1.3463205099105835, 0.2364102602005005, 0.5214954614639282, 0.9816344976425171, 1.7938820123672485, 1.098943829536438, 1.4036308526992798, 0.10201883316040039, 0.20479846000671387, 1.049976110458374, 0.2921476364135742, 0.2819260358810425, 1.7542052268981934, 0.4863433837890625, 2.800172805786133, 0.280910849571228, 0.12940537929534912, 1.4982324838638306, 0.1403290033340454, 0.577783465385437, 0.5335249900817871, 0.5210444927215576, 2.3371376991271973, 1.0055357217788696, 0.3169872760772705, 1.2623671293258667, 2.297578811645508, 0.851117730140686, 1.729107141494751, 1.0464049577713013, 2.3855509757995605, 0.7397410869598389, 0.4214339256286621, 0.5440127849578857, 2.5635905265808105, 0.16900646686553955, 1.3251538276672363, 0.9326492547988892, 0.6955265998840332, 2.1457090377807617, 1.0703895092010498, 0.5758477449417114, 0.38092732429504395, 1.7530872821807861, 0.37794947624206543, 1.3210664987564087, 0.3717273473739624, 0.9549535512924194, 0.39475882053375244, 1.2077586650848389, 1.9496362209320068, 0.4473857879638672, 0.5991896390914917, 1.080648422241211, 0.08796310424804688, 1.233823299407959, 0.4571092128753662, 0.17812824249267578, 0.05300462245941162, 0.05655527114868164, 0.24328255653381348, 0.5148260593414307, 1.2649784088134766, 1.0447088479995728, 1.1881742477416992, 0.8267947435379028, 1.1916954517364502, 1.0545412302017212, 1.1553868055343628, 0.1892920732498169, 0.7504889965057373, 1.352142572402954, 0.1743232011795044], "mean_td_error": 0.9095638990402222, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 77.0, "diff_num_grad_updates_vs_sampler_policy": 76.0}}, "num_env_steps_sampled": 69888, "num_env_steps_trained": 19866, "num_agent_steps_sampled": 209664, "num_agent_steps_trained": 19866, "last_target_update_ts": 69888, "num_target_updates": 77}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 209664, "num_agent_steps_trained": 19866, "num_env_steps_sampled": 69888, "num_env_steps_trained": 19866, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 952.8533229210113, "num_env_steps_trained_throughput_per_sec": 274.37071128752336, "timesteps_total": 69888, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 209664, "timers": {"training_iteration_time_ms": 979.217, "sample_time_ms": 707.41, "load_time_ms": 0.316, "load_throughput": 815655.711, "learn_time_ms": 18.0, "learn_throughput": 14333.708, "synch_weights_time_ms": 9.62}, "counters": {"num_env_steps_sampled": 69888, "num_env_steps_trained": 19866, "num_agent_steps_sampled": 209664, "num_agent_steps_trained": 19866, "last_target_update_ts": 69888, "num_target_updates": 77}, "done": false, "episodes_total": 0, "training_iteration": 46, "trial_id": "cfa97_00000", "date": "2023-11-18_21-03-44", "timestamp": 1700370224, "time_this_iter_s": 1.8914592266082764, "time_total_s": 77.83348393440247, "pid": 6770, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17f30b380>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 77.83348393440247, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 63.23333333333333, "ram_util_percent": 65.16666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.014472961425781, "actor_loss": -9.051782608032227, "critic_loss": 0.3139965534210205, "alpha_loss": -0.23449335992336273, "alpha_value": 0.9768565893173218, "log_alpha_value": -0.023415448144078255, "target_entropy": -6.0, "policy_t": -0.06510142982006073, "mean_q": 5.282642841339111, "max_q": 9.34808349609375, "min_q": 4.401858329772949}, "td_error": [2.0307364463806152, 0.8995914459228516, 2.147980213165283, 0.7216761112213135, 1.9312083721160889, 3.1810593605041504, 0.03707313537597656, 1.4914352893829346, 1.9127602577209473, 0.9633026123046875, 1.9778475761413574, 0.19318819046020508, 0.6705458164215088, 0.5377306938171387, 0.5550894737243652, 0.4287436008453369, 5.766746520996094, 0.954688549041748, 0.3509030342102051, 0.5187747478485107, 0.12373614311218262, 0.301450252532959, 1.424335241317749, 2.041982650756836, 0.07639837265014648, 0.486544132232666, 0.840489387512207, 0.06306052207946777, 0.6977193355560303, 0.1743001937866211, 0.7451579570770264, 0.03143763542175293, 1.3295297622680664, 0.9703021049499512, 4.128575801849365, 0.19983410835266113, 0.09105920791625977, 0.12956833839416504, 1.9575328826904297, 0.3548922538757324, 0.8778157234191895, 0.1035306453704834, 0.29647254943847656, 0.15306830406188965, 0.6589818000793457, 1.0993006229400635, 0.939943790435791, 0.5830550193786621, 0.5058455467224121, 1.0949130058288574, 1.3378894329071045, 1.3122491836547852, 0.08498024940490723, 0.5833485126495361, 2.0079376697540283, 0.9731097221374512, 0.24949955940246582, 0.7758262157440186, 0.3137247562408447, 0.08617210388183594, 0.3091294765472412, 2.5253801345825195, 2.4204556941986084, 1.4375669956207275, 2.1718530654907227, 0.9461970329284668, 3.0689949989318848, 3.3882040977478027, 2.2461090087890625, 1.984628677368164, 7.307638168334961, 1.262432336807251, 0.7574963569641113, 0.15637946128845215, 3.5273263454437256, 0.11616802215576172, 0.07921528816223145, 0.17861390113830566, 0.3478713035583496, 0.9711036682128906, 1.2163255214691162, 1.9289369583129883, 0.557258129119873, 2.0046472549438477, 2.251741409301758, 0.05710649490356445], "mean_td_error": 1.1708770990371704, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 79.0, "diff_num_grad_updates_vs_sampler_policy": 78.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.063796997070312, "actor_loss": -6.773401260375977, "critic_loss": 0.17882148921489716, "alpha_loss": -0.23559729754924774, "alpha_value": 0.9768615365028381, "log_alpha_value": -0.0234103761613369, "target_entropy": -6.0, "policy_t": -0.03790466487407684, "mean_q": 2.7403318881988525, "max_q": 2.9721195697784424, "min_q": 1.7500293254852295}, "td_error": [0.8158751726150513, 0.926093339920044, 0.10840743780136108, 1.1630220413208008, 0.2445383071899414, 0.46243131160736084, 0.5562008619308472, 0.7102550268173218, 0.8603841066360474, 2.0242538452148438, 1.6793025732040405, 0.8031024932861328, 2.1135826110839844, 2.3244481086730957, 1.6023184061050415, 1.4179203510284424, 1.0241456031799316, 1.7551120519638062, 0.30005061626434326, 1.2922797203063965, 1.7639747858047485, 0.9437565803527832, 1.8244788646697998, 0.5499498844146729, 2.321328639984131, 1.382592797279358, 0.4608941078186035, 0.6225206851959229, 2.1784229278564453, 0.7009652853012085, 0.15626788139343262, 1.737771987915039, 0.818218469619751, 0.6483511924743652, 1.0359442234039307, 0.7217496633529663, 0.3059622049331665, 0.6855242252349854, 0.11039471626281738, 0.6166797876358032, 1.0455405712127686, 0.21281802654266357, 0.5223040580749512, 1.732564926147461, 0.5470259189605713, 1.446964144706726, 0.39646291732788086, 1.306334137916565, 0.4714803695678711, 1.9085530042648315, 0.3120518922805786, 1.371718168258667, 0.6290984153747559, 1.1020010709762573, 0.4278221130371094, 1.3105708360671997, 0.43422675132751465, 1.4651036262512207, 0.1384192705154419, 0.23232018947601318, 0.29182732105255127, 1.2484519481658936, 0.9033000469207764, 0.6158703565597534, 0.4358401298522949, 2.676603317260742, 0.4850238561630249, 1.3215115070343018, 0.19627416133880615, 0.5257645845413208, 1.8682395219802856, 1.0097335577011108, 0.6472853422164917, 1.312396764755249, 0.47874224185943604, 1.4646004438400269, 0.6435403823852539, 1.1935865879058838, 0.15467047691345215, 2.443081855773926, 0.630629301071167, 0.6666876077651978, 0.5383831262588501, 0.648862361907959, 0.495993971824646, 1.405798316001892], "mean_td_error": 0.9661111235618591, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 79.0, "diff_num_grad_updates_vs_sampler_policy": 78.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.038228988647461, "actor_loss": -6.802855968475342, "critic_loss": 0.11364318430423737, "alpha_loss": -0.235041081905365, "alpha_value": 0.9768574237823486, "log_alpha_value": -0.023414596915245056, "target_entropy": -6.0, "policy_t": -0.0738365575671196, "mean_q": 2.8006539344787598, "max_q": 2.8573591709136963, "min_q": 1.969130039215088}, "td_error": [0.31085407733917236, 1.3354283571243286, 0.5384554862976074, 1.0422288179397583, 1.4384498596191406, 0.419187068939209, 0.4204535484313965, 0.16965878009796143, 0.2938476800918579, 1.6443142890930176, 2.7874755859375, 0.49485111236572266, 0.6279714107513428, 1.0451933145523071, 0.6238338947296143, 0.31549859046936035, 0.1233741044998169, 0.19105899333953857, 0.329024076461792, 2.1591310501098633, 1.0087746381759644, 0.9871413707733154, 0.5923842191696167, 0.19025862216949463, 1.044023036956787, 0.6825591325759888, 0.6204733848571777, 1.485941767692566, 1.1388280391693115, 0.11879503726959229, 1.0696184635162354, 2.703716278076172, 0.5751361846923828, 0.5013203620910645, 2.369523048400879, 0.14274108409881592, 2.342552661895752, 0.1309213638305664, 1.0117337703704834, 0.0821300745010376, 1.0274181365966797, 1.311608910560608, 0.783116340637207, 0.5861154794692993, 0.2542095184326172, 0.6990010738372803, 0.2741762399673462, 1.3253594636917114, 1.2898516654968262, 0.3506937026977539, 0.1480487585067749, 0.8679236173629761, 0.7138984203338623, 1.2063496112823486, 0.6278420686721802, 0.742537260055542, 0.05307793617248535, 0.03476595878601074, 0.87952721118927, 1.209536075592041, 1.24085533618927, 1.8860735893249512, 0.5463416576385498, 0.3263601064682007, 0.32369017601013184, 0.13971340656280518, 2.21608829498291, 0.24482202529907227, 1.4266748428344727, 0.663738489151001, 1.0939241647720337, 1.2566951513290405, 0.6511355638504028, 1.0821983814239502, 1.155982255935669, 0.2062433958053589, 0.16659832000732422, 1.344406008720398, 0.6565743684768677, 1.4763600826263428, 1.04625403881073, 0.8935906887054443, 0.49944913387298584, 1.0383055210113525, 1.27850341796875, 2.2443251609802246], "mean_td_error": 0.8674282431602478, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 79.0, "diff_num_grad_updates_vs_sampler_policy": 78.0}}, "num_env_steps_sampled": 71680, "num_env_steps_trained": 20382, "num_agent_steps_sampled": 215040, "num_agent_steps_trained": 20382, "last_target_update_ts": 71680, "num_target_updates": 79}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 215040, "num_agent_steps_trained": 20382, "num_env_steps_sampled": 71680, "num_env_steps_trained": 20382, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 944.1512633226363, "num_env_steps_trained_throughput_per_sec": 271.86498430495556, "timesteps_total": 71680, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 215040, "timers": {"training_iteration_time_ms": 941.547, "sample_time_ms": 667.196, "load_time_ms": 0.316, "load_throughput": 815901.705, "learn_time_ms": 17.973, "learn_throughput": 14355.232, "synch_weights_time_ms": 9.61}, "counters": {"num_env_steps_sampled": 71680, "num_env_steps_trained": 20382, "num_agent_steps_sampled": 215040, "num_agent_steps_trained": 20382, "last_target_update_ts": 71680, "num_target_updates": 79}, "done": false, "episodes_total": 0, "training_iteration": 47, "trial_id": "cfa97_00000", "date": "2023-11-18_21-03-46", "timestamp": 1700370226, "time_this_iter_s": 1.9064760208129883, "time_total_s": 79.73995995521545, "pid": 6770, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17f28eac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 79.73995995521545, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 70.5, "ram_util_percent": 65.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.048391342163086, "actor_loss": -9.10170841217041, "critic_loss": 0.13901247084140778, "alpha_loss": -0.24130819737911224, "alpha_value": 0.9762714505195618, "log_alpha_value": -0.024014605209231377, "target_entropy": -6.0, "policy_t": -0.0644383430480957, "mean_q": 5.01500129699707, "max_q": 8.289504051208496, "min_q": 3.9645724296569824}, "td_error": [1.6182944774627686, 2.6042160987854004, 0.18120431900024414, 0.49965882301330566, 0.8584170341491699, 0.07436251640319824, 1.543602705001831, 1.0122764110565186, 0.9599449634552002, 0.4292731285095215, 0.8908555507659912, 0.6863045692443848, 0.1400618553161621, 0.1692054271697998, 0.6379964351654053, 0.34749555587768555, 0.1755228042602539, 1.3893187046051025, 0.41712045669555664, 1.1502318382263184, 0.7628364562988281, 0.06871986389160156, 1.26347017288208, 1.2403738498687744, 1.3451743125915527, 0.2279520034790039, 0.08725762367248535, 1.1010406017303467, 1.4047889709472656, 0.9914557933807373, 0.18331003189086914, 0.2779672145843506, 0.2732076644897461, 0.7514140605926514, 1.6483712196350098, 0.5194869041442871, 0.6922872066497803, 1.3678643703460693, 0.07747530937194824, 0.2386462688446045, 0.030417919158935547, 0.27344608306884766, 0.6497364044189453, 1.711864948272705, 0.04040670394897461, 1.8802213668823242, 1.0376105308532715, 1.4014968872070312, 0.5960648059844971, 1.748011589050293, 2.746875762939453, 0.04221463203430176, 1.4096367359161377, 0.5192785263061523, 0.19809556007385254, 0.027642488479614258, 0.5041558742523193, 0.46385908126831055, 1.283017635345459, 1.1744697093963623, 0.8759243488311768, 3.532119035720825, 3.1405081748962402, 0.21246790885925293, 0.48010873794555664, 0.9204764366149902, 1.6154537200927734, 0.6414968967437744, 1.7632522583007812, 1.2215838432312012, 0.039040565490722656, 0.9143249988555908, 1.4225380420684814, 1.1025760173797607, 0.031244993209838867, 0.3585801124572754, 0.31867241859436035, 1.4783475399017334, 0.651679515838623, 0.7270753383636475, 0.33710789680480957, 0.8861033916473389, 0.13430356979370117, 0.7176764011383057, 0.8494820594787598, 0.021931886672973633], "mean_td_error": 0.8423378467559814, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 81.0, "diff_num_grad_updates_vs_sampler_policy": 80.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.06514835357666, "actor_loss": -6.753839015960693, "critic_loss": 0.14127987623214722, "alpha_loss": -0.24165602028369904, "alpha_value": 0.9762767553329468, "log_alpha_value": -0.024009184911847115, "target_entropy": -6.0, "policy_t": -0.06000274047255516, "mean_q": 2.7355780601501465, "max_q": 2.9723281860351562, "min_q": 2.1312694549560547}, "td_error": [0.6954741477966309, 0.33512139320373535, 0.22809481620788574, 0.1874016523361206, 0.4696810245513916, 1.5895929336547852, 0.3162879943847656, 2.0440337657928467, 1.0995444059371948, 1.7943055629730225, 0.6883155107498169, 0.25153279304504395, 0.4436572790145874, 2.7779905796051025, 0.6191349029541016, 0.5589370727539062, 0.7824560403823853, 0.3173717260360718, 0.5154707431793213, 1.2640743255615234, 1.0156763792037964, 1.1784679889678955, 1.9521796703338623, 0.21672296524047852, 1.271959662437439, 0.274151086807251, 0.15155446529388428, 0.278578519821167, 0.7363866567611694, 1.6698416471481323, 0.6531891822814941, 1.1013230085372925, 0.7291977405548096, 2.209585189819336, 0.7577512264251709, 0.10117459297180176, 0.6558727025985718, 1.0617859363555908, 0.6216830015182495, 1.415281891822815, 0.68117356300354, 0.8236613273620605, 0.46735453605651855, 1.3548532724380493, 0.2600611448287964, 0.18491363525390625, 0.9237039089202881, 1.7608212232589722, 0.640711784362793, 0.6655855178833008, 0.49393796920776367, 1.9413236379623413, 0.631359338760376, 0.09962296485900879, 0.2698315382003784, 0.9178321361541748, 0.3676900863647461, 0.10868310928344727, 0.7061623334884644, 0.23117613792419434, 0.02859950065612793, 1.8683773279190063, 1.2223989963531494, 0.025558829307556152, 0.1284942626953125, 0.9474523067474365, 2.575732707977295, 0.539543867111206, 0.21609067916870117, 1.1014857292175293, 0.5580431222915649, 1.2374293804168701, 0.8317430019378662, 0.5983008146286011, 0.44365596771240234, 0.7614318132400513, 1.9128004312515259, 1.0909932851791382, 0.7136023044586182, 0.16722381114959717, 0.8321635723114014, 0.9103726148605347, 1.3679099082946777, 0.9170444011688232, 0.057814717292785645, 0.4698272943496704], "mean_td_error": 0.8149464726448059, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 81.0, "diff_num_grad_updates_vs_sampler_policy": 80.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.042746543884277, "actor_loss": -6.782534599304199, "critic_loss": 0.11510083824396133, "alpha_loss": -0.24117238819599152, "alpha_value": 0.9762714505195618, "log_alpha_value": -0.024014584720134735, "target_entropy": -6.0, "policy_t": -0.05615769326686859, "mean_q": 2.755303144454956, "max_q": 2.8550362586975098, "min_q": 1.6824400424957275}, "td_error": [0.5772123336791992, 1.258448839187622, 1.1710938215255737, 2.3182830810546875, 1.2890771627426147, 0.13428902626037598, 1.2173668146133423, 0.009074926376342773, 1.3707071542739868, 0.6234320402145386, 2.3938770294189453, 1.5170971155166626, 0.8093286752700806, 0.4163252115249634, 0.5689125061035156, 0.285770058631897, 0.5570782423019409, 1.3943235874176025, 1.200940489768982, 0.26745176315307617, 1.517182469367981, 0.17408490180969238, 0.013336181640625, 0.7863965034484863, 0.8768297433853149, 2.2946999073028564, 0.1697748899459839, 1.095479130744934, 1.6812798976898193, 1.3593080043792725, 1.4730281829833984, 1.0818337202072144, 0.6953057050704956, 0.6540236473083496, 0.4359779357910156, 0.37381458282470703, 0.42679858207702637, 0.15470492839813232, 3.049302101135254, 0.22494232654571533, 0.3371213674545288, 0.48407018184661865, 1.0520987510681152, 0.48744750022888184, 0.14908134937286377, 0.8158928155899048, 1.9478706121444702, 0.12296700477600098, 0.2591547966003418, 1.088008165359497, 0.15363550186157227, 1.0237914323806763, 0.9369866847991943, 0.9864501953125, 1.6175624132156372, 0.15036320686340332, 1.0725104808807373, 1.0246772766113281, 0.7074413299560547, 1.2057322263717651, 0.8561125993728638, 2.9322526454925537, 0.11816549301147461, 0.7939786911010742, 1.4835351705551147, 0.5403215885162354, 0.7886041402816772, 0.24122107028961182, 1.2233895063400269, 0.3151514530181885, 0.4121503233909607, 1.0286757946014404, 0.16312694549560547, 0.23084449768066406, 0.13256502151489258, 0.6509467363357544, 1.115487813949585, 0.3066786527633667, 0.17920547723770142, 1.1529064178466797, 0.30020153522491455, 1.9636567831039429, 0.25452613830566406, 1.1083815097808838, 1.470727801322937, 0.8965208530426025], "mean_td_error": 0.862795352935791, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 81.0, "diff_num_grad_updates_vs_sampler_policy": 80.0}}, "num_env_steps_sampled": 73472, "num_env_steps_trained": 20898, "num_agent_steps_sampled": 220416, "num_agent_steps_trained": 20898, "last_target_update_ts": 73472, "num_target_updates": 81}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 220416, "num_agent_steps_trained": 20898, "num_env_steps_sampled": 73472, "num_env_steps_trained": 20898, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 941.1586532911033, "num_env_steps_trained_throughput_per_sec": 271.0032729342686, "timesteps_total": 73472, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 220416, "timers": {"training_iteration_time_ms": 945.203, "sample_time_ms": 671.517, "load_time_ms": 0.316, "load_throughput": 817195.614, "learn_time_ms": 18.032, "learn_throughput": 14307.706, "synch_weights_time_ms": 9.564}, "counters": {"num_env_steps_sampled": 73472, "num_env_steps_trained": 20898, "num_agent_steps_sampled": 220416, "num_agent_steps_trained": 20898, "last_target_update_ts": 73472, "num_target_updates": 81}, "done": false, "episodes_total": 0, "training_iteration": 48, "trial_id": "cfa97_00000", "date": "2023-11-18_21-03-48", "timestamp": 1700370228, "time_this_iter_s": 1.913069725036621, "time_total_s": 81.65302968025208, "pid": 6770, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17f30b6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 81.65302968025208, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 72.03333333333333, "ram_util_percent": 65.03333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.093629837036133, "actor_loss": -9.180621147155762, "critic_loss": 0.16716086864471436, "alpha_loss": -0.24843677878379822, "alpha_value": 0.9756872057914734, "log_alpha_value": -0.02461322396993637, "target_entropy": -6.0, "policy_t": -0.0840679183602333, "mean_q": 4.960890769958496, "max_q": 6.281857490539551, "min_q": 3.713693141937256}, "td_error": [2.291802167892456, 2.574869394302368, 0.7426033020019531, 0.8561849594116211, 0.3331727981567383, 0.36918210983276367, 0.47420215606689453, 0.4482841491699219, 1.795520305633545, 0.06184959411621094, 1.191626787185669, 0.14612793922424316, 0.4871370792388916, 1.600630521774292, 0.07720232009887695, 0.9252452850341797, 1.4329912662506104, 0.0452885627746582, 0.36358022689819336, 0.3114485740661621, 0.25444459915161133, 1.7509055137634277, 0.23203730583190918, 2.3281774520874023, 1.7144975662231445, 2.324892282485962, 1.507138729095459, 0.09100651741027832, 1.068204402923584, 0.793159008026123, 0.8846838474273682, 0.18895220756530762, 0.21709322929382324, 2.447096824645996, 1.1540017127990723, 1.9614861011505127, 0.5059051513671875, 0.3655364513397217, 0.6967287063598633, 0.7277166843414307, 0.9299750328063965, 0.9945647716522217, 0.43928468227386475, 0.38411593437194824, 0.9992547035217285, 0.5200424194335938, 0.666379451751709, 0.4056246280670166, 0.970036506652832, 0.23403501510620117, 0.8873372077941895, 0.9252922534942627, 0.10982966423034668, 0.17282795906066895, 1.3374123573303223, 2.0061511993408203, 0.05202317237854004, 1.3220441341400146, 0.9603068828582764, 1.4926481246948242, 0.27428674697875977, 0.7106914520263672, 0.2810087203979492, 2.3587820529937744, 0.8276512622833252, 0.11248779296875, 1.694779396057129, 3.28985595703125, 0.8051245212554932, 1.5262653827667236, 0.07746028900146484, 1.8946900367736816, 0.9060811996459961, 1.5372836589813232, 0.6957526206970215, 0.9132289886474609, 0.039389610290527344, 0.11257457733154297, 2.1734559535980225, 4.363307952880859, 0.19378161430358887, 0.44913387298583984, 0.5077240467071533, 1.0589370727539062, 0.9130830764770508, 0.18615365028381348], "mean_td_error": 0.9471485018730164, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 83.0, "diff_num_grad_updates_vs_sampler_policy": 82.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.088801383972168, "actor_loss": -6.705766677856445, "critic_loss": 0.13769611716270447, "alpha_loss": -0.24826262891292572, "alpha_value": 0.9756925702095032, "log_alpha_value": -0.024607742205262184, "target_entropy": -6.0, "policy_t": -0.04208266735076904, "mean_q": 2.653536081314087, "max_q": 2.8665502071380615, "min_q": 1.7019877433776855}, "td_error": [0.9108281135559082, 0.04177123308181763, 0.6628849506378174, 0.41880524158477783, 0.21815645694732666, 1.9852955341339111, 0.21735620498657227, 2.0763983726501465, 1.6154637336730957, 1.7041784524917603, 0.6686372756958008, 0.07471048831939697, 0.6225094795227051, 1.6191385984420776, 0.6297539472579956, 1.196572184562683, 0.23080623149871826, 0.5177911520004272, 0.5856988430023193, 0.6061286926269531, 0.09441506862640381, 0.286746621131897, 0.2820742130279541, 0.645304799079895, 2.4949371814727783, 0.5685182809829712, 0.09767782688140869, 0.7922370433807373, 0.25037312507629395, 0.6142743825912476, 0.7126775979995728, 0.1328568458557129, 1.681833267211914, 1.4387657642364502, 0.8814724683761597, 0.8893777132034302, 1.0239055156707764, 0.7455583810806274, 1.284629464149475, 1.315430998802185, 0.11873829364776611, 1.056269884109497, 1.527064323425293, 0.9743846654891968, 0.07406413555145264, 0.07657742500305176, 1.0459868907928467, 0.3717759847640991, 0.16312146186828613, 0.4277404546737671, 1.9833908081054688, 1.3050307035446167, 0.5291488170623779, 0.38516998291015625, 2.3939268589019775, 0.42655694484710693, 0.3332878351211548, 1.5887072086334229, 0.5445492267608643, 0.11408424377441406, 2.0457842350006104, 0.7143173217773438, 0.6501113176345825, 0.18136858940124512, 1.035494327545166, 0.14771568775177002, 1.2359962463378906, 1.5501854419708252, 0.2913093566894531, 0.13264262676239014, 0.18772518634796143, 0.9772379398345947, 0.43867743015289307, 1.41077721118927, 0.34872400760650635, 0.0389246940612793, 0.687838077545166, 0.7995470762252808, 0.04057466983795166, 0.9006402492523193, 0.5536034107208252, 0.6304163932800293, 1.6514419317245483, 2.3852293491363525, 0.6961884498596191, 0.037424325942993164], "mean_td_error": 0.7912258505821228, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 83.0, "diff_num_grad_updates_vs_sampler_policy": 82.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.127562522888184, "actor_loss": -6.843632221221924, "critic_loss": 0.08669678866863251, "alpha_loss": -0.24928075075149536, "alpha_value": 0.9756863713264465, "log_alpha_value": -0.024614090099930763, "target_entropy": -6.0, "policy_t": -0.050408996641635895, "mean_q": 2.765310049057007, "max_q": 2.8385727405548096, "min_q": 2.0826759338378906}, "td_error": [1.0810871124267578, 0.9576308727264404, 1.2441673278808594, 1.2575249671936035, 0.7373076677322388, 1.7831090688705444, 1.0885376930236816, 0.969228982925415, 0.3772547245025635, 0.0743563175201416, 0.14932239055633545, 0.8811250925064087, 0.7454198598861694, 1.1346982717514038, 0.854942798614502, 1.7966718673706055, 0.1881650686264038, 0.08621859550476074, 0.5119673013687134, 0.6406277418136597, 0.022461414337158203, 1.4309195280075073, 0.3008311986923218, 1.7898309230804443, 0.7939838171005249, 0.37491774559020996, 1.0051954984664917, 1.3421976566314697, 0.4527311325073242, 0.24872183799743652, 0.10916471481323242, 1.2088758945465088, 1.1249934434890747, 0.7330135107040405, 0.0998145341873169, 0.7410503625869751, 1.4027429819107056, 0.33974266052246094, 0.013033866882324219, 0.9355723857879639, 0.004254698753356934, 0.05691063404083252, 0.6901037693023682, 0.6327736377716064, 0.12650346755981445, 0.6678193807601929, 0.7319014072418213, 1.5735276937484741, 1.3028725385665894, 0.2675611972808838, 0.17001581192016602, 1.1047333478927612, 1.1422631740570068, 0.24075913429260254, 0.075714111328125, 0.7986482381820679, 1.047417402267456, 0.39868462085723877, 0.16356253623962402, 1.6470062732696533, 0.9330811500549316, 0.6295433044433594, 0.6523778438568115, 0.6287331581115723, 0.6697260141372681, 0.07571160793304443, 0.6212693452835083, 0.18054747581481934, 1.8378872871398926, 0.20748531818389893, 0.5160362720489502, 0.24841725826263428, 0.9611951112747192, 0.3799140453338623, 1.0586837530136108, 1.6606287956237793, 0.3106440305709839, 1.7630823850631714, 1.2342948913574219, 0.22118377685546875, 0.11755931377410889, 0.8807862997055054, 0.3336085081100464, 1.6725797653198242, 1.2143239974975586, 0.09620511531829834], "mean_td_error": 0.7322988510131836, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 83.0, "diff_num_grad_updates_vs_sampler_policy": 82.0}}, "num_env_steps_sampled": 75264, "num_env_steps_trained": 21414, "num_agent_steps_sampled": 225792, "num_agent_steps_trained": 21414, "last_target_update_ts": 75264, "num_target_updates": 83}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 225792, "num_agent_steps_trained": 21414, "num_env_steps_sampled": 75264, "num_env_steps_trained": 21414, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 934.9110113422844, "num_env_steps_trained_throughput_per_sec": 269.20428674811313, "timesteps_total": 75264, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 225792, "timers": {"training_iteration_time_ms": 947.083, "sample_time_ms": 674.278, "load_time_ms": 0.315, "load_throughput": 819299.237, "learn_time_ms": 17.923, "learn_throughput": 14395.048, "synch_weights_time_ms": 9.65}, "counters": {"num_env_steps_sampled": 75264, "num_env_steps_trained": 21414, "num_agent_steps_sampled": 225792, "num_agent_steps_trained": 21414, "last_target_update_ts": 75264, "num_target_updates": 83}, "done": false, "episodes_total": 0, "training_iteration": 49, "trial_id": "cfa97_00000", "date": "2023-11-18_21-03-50", "timestamp": 1700370230, "time_this_iter_s": 1.924530029296875, "time_total_s": 83.57755970954895, "pid": 6770, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17f30bf60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 83.57755970954895, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 70.66666666666667, "ram_util_percent": 65.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.069360733032227, "actor_loss": -9.110678672790527, "critic_loss": 0.13686436414718628, "alpha_loss": -0.2538646161556244, "alpha_value": 0.9751035571098328, "log_alpha_value": -0.025211594998836517, "target_entropy": -6.0, "policy_t": -0.08405231684446335, "mean_q": 4.883666515350342, "max_q": 5.602210998535156, "min_q": 3.796304225921631}, "td_error": [0.4309980869293213, 1.4050185680389404, 0.8370094299316406, 0.4799957275390625, 0.7811310291290283, 0.6182613372802734, 0.26197028160095215, 0.23258376121520996, 0.20014214515686035, 0.3042643070220947, 1.053236961364746, 0.31026530265808105, 2.6753220558166504, 0.6330239772796631, 0.6139249801635742, 0.08814430236816406, 2.355259418487549, 0.20445013046264648, 0.9747600555419922, 1.157545804977417, 1.9379327297210693, 1.251591682434082, 0.47329163551330566, 0.28869104385375977, 1.4467895030975342, 0.18271970748901367, 0.6501944065093994, 0.6589512825012207, 0.3555903434753418, 0.7797145843505859, 0.19927620887756348, 0.5892353057861328, 0.4025688171386719, 0.8810632228851318, 1.415099859237671, 0.9275655746459961, 3.048943281173706, 0.10300469398498535, 1.560460090637207, 0.19908499717712402, 1.7493784427642822, 0.3094310760498047, 0.6471710205078125, 0.9291529655456543, 1.5574212074279785, 0.2523989677429199, 0.36386585235595703, 1.2387421131134033, 0.06256389617919922, 1.1658484935760498, 2.184903144836426, 1.4820926189422607, 0.5618910789489746, 0.19821977615356445, 0.6655216217041016, 0.45082569122314453, 1.830928087234497, 0.9228935241699219, 0.35213637351989746, 0.2951643466949463, 0.9584901332855225, 0.39702606201171875, 1.1763205528259277, 1.6497182846069336, 0.64219069480896, 1.637176275253296, 0.264249324798584, 0.19140934944152832, 0.1672680377960205, 0.391207218170166, 2.364147663116455, 1.195816993713379, 1.116781234741211, 0.9314892292022705, 1.680743932723999, 0.3361978530883789, 0.18279671669006348, 0.8903052806854248, 0.13553762435913086, 0.767585277557373, 0.2951986789703369, 0.5586166381835938, 1.7163302898406982, 2.1528425216674805, 0.8229777812957764, 0.6267571449279785], "mean_td_error": 0.8539396524429321, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 85.0, "diff_num_grad_updates_vs_sampler_policy": 84.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.008020401000977, "actor_loss": -6.628848552703857, "critic_loss": 0.12435714900493622, "alpha_loss": -0.25226539373397827, "alpha_value": 0.9751086831092834, "log_alpha_value": -0.025206319987773895, "target_entropy": -6.0, "policy_t": -0.08688279986381531, "mean_q": 2.646404981613159, "max_q": 3.139059066772461, "min_q": 1.7609503269195557}, "td_error": [0.362506628036499, 1.009183645248413, 0.17906153202056885, 1.6986401081085205, 0.559971809387207, 0.31272733211517334, 0.25790226459503174, 1.7330156564712524, 0.8660534620285034, 1.4467569589614868, 0.34984636306762695, 0.2045438289642334, 0.44744908809661865, 0.5447109937667847, 0.317499041557312, 1.5773378610610962, 1.3699018955230713, 0.29537999629974365, 0.6518656015396118, 0.2686518430709839, 0.23026776313781738, 1.8529168367385864, 1.115236759185791, 0.974960207939148, 0.2836136817932129, 0.8441417217254639, 0.4702615737915039, 0.3448832035064697, 0.9728469848632812, 0.01397562026977539, 0.5218353271484375, 0.19362473487854004, 0.09063565731048584, 0.07637453079223633, 0.17389976978302002, 0.14935612678527832, 0.6891893148422241, 0.6844384670257568, 1.0723459720611572, 0.7277448177337646, 0.3929939270019531, 2.6838250160217285, 0.09654510021209717, 0.4283086061477661, 0.08121204376220703, 0.1624464988708496, 1.0159932374954224, 1.3049046993255615, 1.7583683729171753, 1.4486714601516724, 0.39209938049316406, 0.1808091402053833, 1.0877759456634521, 0.23510777950286865, 0.9854274988174438, 1.0996969938278198, 0.8155336380004883, 2.447868585586548, 1.2042689323425293, 1.337833285331726, 0.10724759101867676, 0.1589721441268921, 0.19130754470825195, 1.3761850595474243, 0.5968387126922607, 0.32621335983276367, 1.0878974199295044, 0.09887683391571045, 0.6162563562393188, 2.2774012088775635, 0.350358247756958, 1.635367751121521, 0.5239109992980957, 1.2605981826782227, 1.212363839149475, 0.2041165828704834, 0.2897632122039795, 0.6685953140258789, 0.28798937797546387, 0.2936539649963379, 0.23788750171661377, 0.19957685470581055, 2.2690837383270264, 0.8666045665740967, 0.24232184886932373, 0.16054034233093262], "mean_td_error": 0.7283159494400024, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 85.0, "diff_num_grad_updates_vs_sampler_policy": 84.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.123220443725586, "actor_loss": -6.78993558883667, "critic_loss": 0.12292249500751495, "alpha_loss": -0.2552422881126404, "alpha_value": 0.9751016497612, "log_alpha_value": -0.025213541463017464, "target_entropy": -6.0, "policy_t": -0.02216683328151703, "mean_q": 2.7010037899017334, "max_q": 2.813117027282715, "min_q": 1.7489194869995117}, "td_error": [0.893397331237793, 1.244933843612671, 0.5384392738342285, 0.6128438711166382, 0.371751070022583, 0.18536615371704102, 0.7501723766326904, 0.24157333374023438, 0.408428430557251, 1.256413221359253, 1.7921031713485718, 0.8065201044082642, 2.281899929046631, 0.03458523750305176, 0.45049428939819336, 0.00482177734375, 0.7152464389801025, 0.10669481754302979, 0.19646096229553223, 0.6452025175094604, 0.519342303276062, 0.20695996284484863, 0.782696008682251, 0.38106513023376465, 1.2886229753494263, 0.9951951503753662, 1.2370219230651855, 1.5330429077148438, 1.296370506286621, 0.022033214569091797, 1.5606416463851929, 2.3361101150512695, 0.5513323545455933, 0.5703347325325012, 1.184020757675171, 1.9330570697784424, 1.475722312927246, 0.6607764959335327, 1.493343472480774, 0.8814651966094971, 0.6915732622146606, 0.602374792098999, 2.1326560974121094, 0.4681158661842346, 1.8507540225982666, 2.4122300148010254, 0.8352704048156738, 0.3599499464035034, 0.3891606330871582, 0.5211951732635498, 0.9888086318969727, 1.5532641410827637, 2.6643452644348145, 1.2326735258102417, 0.45696985721588135, 1.1300592422485352, 1.0838278532028198, 0.011220693588256836, 1.5233291387557983, 0.9199807643890381, 0.6068406105041504, 0.46032536029815674, 1.174490213394165, 0.4918900728225708, 2.305492639541626, 0.4128835201263428, 1.782812476158142, 0.3009450435638428, 0.777389407157898, 0.5578804016113281, 0.2494131326675415, 2.1453728675842285, 0.16960179805755615, 0.7751002311706543, 2.180267572402954, 0.03422272205352783, 0.2327655553817749, 0.5664968490600586, 0.22844171524047852, 0.7099932432174683, 0.8448773622512817, 1.2690260410308838, 0.34572362899780273, 0.23685383796691895, 0.25040125846862793, 2.181987762451172], "mean_td_error": 0.9019273519515991, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 85.0, "diff_num_grad_updates_vs_sampler_policy": 84.0}}, "num_env_steps_sampled": 77056, "num_env_steps_trained": 21930, "num_agent_steps_sampled": 231168, "num_agent_steps_trained": 21930, "last_target_update_ts": 77056, "num_target_updates": 85}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 231168, "num_agent_steps_trained": 21930, "num_env_steps_sampled": 77056, "num_env_steps_trained": 21930, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 941.0059451120652, "num_env_steps_trained_throughput_per_sec": 270.9593011595009, "timesteps_total": 77056, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 231168, "timers": {"training_iteration_time_ms": 950.361, "sample_time_ms": 677.356, "load_time_ms": 0.314, "load_throughput": 821663.198, "learn_time_ms": 17.854, "learn_throughput": 14450.448, "synch_weights_time_ms": 9.64}, "counters": {"num_env_steps_sampled": 77056, "num_env_steps_trained": 21930, "num_agent_steps_sampled": 231168, "num_agent_steps_trained": 21930, "last_target_update_ts": 77056, "num_target_updates": 85}, "done": false, "episodes_total": 0, "training_iteration": 50, "trial_id": "cfa97_00000", "date": "2023-11-18_21-03-52", "timestamp": 1700370232, "time_this_iter_s": 1.913708209991455, "time_total_s": 85.4912679195404, "pid": 6770, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17f309580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 85.4912679195404, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 65.06666666666666, "ram_util_percent": 65.26666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.895756721496582, "actor_loss": -8.950084686279297, "critic_loss": 0.1544981300830841, "alpha_loss": -0.25540468096733093, "alpha_value": 0.9745206832885742, "log_alpha_value": -0.02580951154232025, "target_entropy": -6.0, "policy_t": -0.12449731677770615, "mean_q": 4.857132911682129, "max_q": 5.906960487365723, "min_q": 2.9967024326324463}, "td_error": [1.6475462913513184, 0.470259428024292, 0.6282014846801758, 1.4841580390930176, 0.69954514503479, 0.5921294689178467, 1.3433501720428467, 0.5191135406494141, 0.546872615814209, 1.0568482875823975, 1.1147034168243408, 0.41284751892089844, 0.5882716178894043, 1.329296588897705, 0.3503074645996094, 0.8558449745178223, 0.5574836730957031, 2.2014777660369873, 1.8557579517364502, 1.6771230697631836, 0.9119224548339844, 1.4862279891967773, 1.7351367473602295, 0.7695460319519043, 1.281123161315918, 0.17024517059326172, 0.09811520576477051, 0.4971635341644287, 0.07841682434082031, 1.5384271144866943, 0.506432056427002, 1.5009655952453613, 0.15579462051391602, 0.725865364074707, 3.1902847290039062, 0.8441793918609619, 1.2317242622375488, 0.7677369117736816, 0.13056516647338867, 0.3135647773742676, 1.2499549388885498, 1.4348804950714111, 0.08693599700927734, 0.4731595516204834, 2.0305230617523193, 1.067227840423584, 0.5010778903961182, 0.9252011775970459, 0.09467697143554688, 0.841498613357544, 1.3753738403320312, 0.9552509784698486, 2.759136915206909, 0.5370643138885498, 2.384115695953369, 1.098067283630371, 2.685189962387085, 0.5710983276367188, 0.2536306381225586, 1.4487848281860352, 0.9828100204467773, 0.5454862117767334, 1.097606897354126, 0.24932479858398438, 0.1417536735534668, 0.2733914852142334, 0.5530836582183838, 0.45804548263549805, 3.2519776821136475, 1.529367208480835, 0.4802281856536865, 0.20623230934143066, 1.3585984706878662, 0.8736326694488525, 0.07836198806762695, 1.5379762649536133, 0.23489856719970703, 0.11317062377929688, 0.7508077621459961, 0.20258879661560059, 0.25364208221435547, 0.08637714385986328, 1.0791215896606445, 0.4928267002105713, 0.0839381217956543, 0.20792412757873535], "mean_td_error": 0.9041929841041565, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 87.0, "diff_num_grad_updates_vs_sampler_policy": 86.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0261869430542, "actor_loss": -6.654577255249023, "critic_loss": 0.14443589746952057, "alpha_loss": -0.2587229013442993, "alpha_value": 0.9745253920555115, "log_alpha_value": -0.025804713368415833, "target_entropy": -6.0, "policy_t": -0.06266025453805923, "mean_q": 2.6500649452209473, "max_q": 2.818392515182495, "min_q": 1.842237114906311}, "td_error": [0.7503917217254639, 0.6903969049453735, 0.35189807415008545, 0.13142049312591553, 0.4336768388748169, 1.1520326137542725, 1.0442183017730713, 0.4938640594482422, 0.8151979446411133, 0.7339944839477539, 0.035791873931884766, 1.1637952327728271, 0.22459518909454346, 0.19778048992156982, 0.7140533924102783, 0.12774872779846191, 0.05159270763397217, 1.4628268480300903, 1.0744373798370361, 1.5468469858169556, 0.2470465898513794, 0.2015172243118286, 1.3610183000564575, 2.1942882537841797, 0.1734151840209961, 0.19639122486114502, 1.6654950380325317, 1.1159336566925049, 0.857593297958374, 0.4663848876953125, 0.23805654048919678, 0.1836695671081543, 1.2315115928649902, 0.7470365762710571, 2.1929030418395996, 0.33388280868530273, 0.7079203128814697, 3.010826349258423, 0.7185268402099609, 2.416393995285034, 1.0045021772384644, 1.441694736480713, 1.2033406496047974, 0.2786564826965332, 1.087947964668274, 1.2236275672912598, 0.19088959693908691, 1.075682282447815, 0.31102538108825684, 1.210109829902649, 0.60646653175354, 1.070877194404602, 0.8339269161224365, 1.028823971748352, 0.6424652338027954, 1.0746217966079712, 0.8167413473129272, 2.4280080795288086, 1.0524033308029175, 0.587607741355896, 0.4008404016494751, 0.12398803234100342, 1.1940451860427856, 0.7509653568267822, 0.020527243614196777, 0.3141971826553345, 1.5745556354522705, 0.4369637966156006, 0.33685433864593506, 0.0798417329788208, 0.321533203125, 0.6655036211013794, 1.2517369985580444, 0.04665958881378174, 2.7178335189819336, 0.3044166564941406, 0.8704339265823364, 0.07122254371643066, 1.205681562423706, 0.8468914031982422, 0.4241013526916504, 0.9295135736465454, 2.109841823577881, 0.5516624450683594, 0.1712946891784668, 0.20657682418823242], "mean_td_error": 0.8203892111778259, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 87.0, "diff_num_grad_updates_vs_sampler_policy": 86.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.05188274383545, "actor_loss": -6.7095770835876465, "critic_loss": 0.11635144054889679, "alpha_loss": -0.25947105884552, "alpha_value": 0.9745171070098877, "log_alpha_value": -0.025813179090619087, "target_entropy": -6.0, "policy_t": -0.0492297001183033, "mean_q": 2.70900559425354, "max_q": 2.791154384613037, "min_q": 1.9289071559906006}, "td_error": [0.2998013496398926, 0.6956633925437927, 0.31476473808288574, 0.3637493848800659, 0.29672956466674805, 0.4448208808898926, 1.0873087644577026, 1.0744853019714355, 1.336652398109436, 2.471543550491333, 0.05433166027069092, 0.5014992952346802, 0.0851898193359375, 0.49484682083129883, 1.8205792903900146, 0.07478547096252441, 0.2942366600036621, 0.630574107170105, 0.5553656816482544, 1.656469702720642, 1.4672373533248901, 0.06892549991607666, 0.44438624382019043, 1.4575456380844116, 1.4071873426437378, 0.580146074295044, 0.6219501495361328, 0.722262978553772, 1.1175905466079712, 0.5744982957839966, 0.5047801733016968, 1.3396440744400024, 1.6918504238128662, 1.2555216550827026, 0.055675625801086426, 0.3039360046386719, 0.6342624425888062, 0.7712537050247192, 1.8474230766296387, 0.7205756902694702, 0.5804800987243652, 1.4960294961929321, 0.5467596054077148, 1.1879618167877197, 1.0965017080307007, 1.314897894859314, 0.8288968801498413, 1.6035995483398438, 0.23079490661621094, 1.7688016891479492, 0.5558950901031494, 0.3729367256164551, 0.14771974086761475, 1.3799524307250977, 0.9050577878952026, 0.9998792409896851, 1.6983250379562378, 1.0487605333328247, 2.4253313541412354, 0.4148651361465454, 0.5963568687438965, 0.16360819339752197, 0.9550802707672119, 0.9156893491744995, 1.3297955989837646, 0.29732608795166016, 2.767615795135498, 0.8727405071258545, 0.553795337677002, 1.836469054222107, 0.20655012130737305, 0.5500229597091675, 0.40297579765319824, 0.9631140232086182, 1.7135810852050781, 1.804190754890442, 0.9668806791305542, 0.834823727607727, 1.1416038274765015, 0.16929280757904053, 0.6553822755813599, 0.1129305362701416, 0.759824275970459, 1.7693885564804077, 0.020508170127868652, 1.4948676824569702], "mean_td_error": 0.8906733393669128, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 87.0, "diff_num_grad_updates_vs_sampler_policy": 86.0}}, "num_env_steps_sampled": 78848, "num_env_steps_trained": 22446, "num_agent_steps_sampled": 236544, "num_agent_steps_trained": 22446, "last_target_update_ts": 78848, "num_target_updates": 87}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 236544, "num_agent_steps_trained": 22446, "num_env_steps_sampled": 78848, "num_env_steps_trained": 22446, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 954.32653560292, "num_env_steps_trained_throughput_per_sec": 274.7949176178051, "timesteps_total": 78848, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 236544, "timers": {"training_iteration_time_ms": 950.07, "sample_time_ms": 676.433, "load_time_ms": 0.311, "load_throughput": 828393.502, "learn_time_ms": 18.037, "learn_throughput": 14303.905, "synch_weights_time_ms": 9.697}, "counters": {"num_env_steps_sampled": 78848, "num_env_steps_trained": 22446, "num_agent_steps_sampled": 236544, "num_agent_steps_trained": 22446, "last_target_update_ts": 78848, "num_target_updates": 87}, "done": false, "episodes_total": 0, "training_iteration": 51, "trial_id": "cfa97_00000", "date": "2023-11-18_21-03-54", "timestamp": 1700370234, "time_this_iter_s": 1.887223243713379, "time_total_s": 87.37849116325378, "pid": 6770, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17f30bce0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 87.37849116325378, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 70.75, "ram_util_percent": 65.25}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.985623359680176, "actor_loss": -8.962218284606934, "critic_loss": 0.1130475103855133, "alpha_loss": -0.2636837661266327, "alpha_value": 0.9739392399787903, "log_alpha_value": -0.026406338438391685, "target_entropy": -6.0, "policy_t": -0.11251010745763779, "mean_q": 4.726340293884277, "max_q": 5.109975814819336, "min_q": 2.8911020755767822}, "td_error": [0.23871660232543945, 0.6064085960388184, 1.1193935871124268, 0.46628499031066895, 0.4844400882720947, 1.0070743560791016, 0.09278583526611328, 2.229292392730713, 0.264193058013916, 0.724947452545166, 0.8280680179595947, 1.8528962135314941, 0.5575270652770996, 0.6009340286254883, 0.4885237216949463, 0.16190052032470703, 1.644902229309082, 0.5141863822937012, 0.8535957336425781, 0.6979274749755859, 0.3305778503417969, 0.7815587520599365, 0.969205379486084, 0.2684149742126465, 1.6061244010925293, 2.991727828979492, 0.465334415435791, 1.0590777397155762, 0.8993325233459473, 0.5149960517883301, 1.6316537857055664, 2.065225124359131, 0.10264182090759277, 0.21323108673095703, 0.3697338104248047, 0.5330588817596436, 0.995990514755249, 0.8870618343353271, 0.9654159545898438, 0.09179258346557617, 0.28633153438568115, 1.2906618118286133, 2.0764288902282715, 1.5280983448028564, 1.5963034629821777, 0.24011874198913574, 0.1844191551208496, 0.6350493431091309, 1.0550649166107178, 0.8408105373382568, 1.3007841110229492, 0.09111404418945312, 0.16321969032287598, 0.6524796485900879, 0.6699399948120117, 0.31503796577453613, 0.49420738220214844, 1.0628113746643066, 0.45384764671325684, 0.40988969802856445, 0.8948197364807129, 0.16914129257202148, 0.5241572856903076, 1.4223978519439697, 0.8545558452606201, 0.9872877597808838, 1.0614142417907715, 0.6589508056640625, 0.3422722816467285, 1.3190834522247314, 0.09055328369140625, 0.08310699462890625, 0.12655043601989746, 0.8927969932556152, 0.6101245880126953, 0.769381046295166, 0.4477365016937256, 1.8333818912506104, 1.1734249591827393, 1.4577815532684326, 0.3142127990722656, 0.4671480655670166, 0.5289018154144287, 0.30388689041137695, 0.18001413345336914, 0.1668844223022461], "mean_td_error": 0.7697993516921997, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 89.0, "diff_num_grad_updates_vs_sampler_policy": 88.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.028536796569824, "actor_loss": -6.633971691131592, "critic_loss": 0.1783185601234436, "alpha_loss": -0.26478487253189087, "alpha_value": 0.9739423990249634, "log_alpha_value": -0.026403140276670456, "target_entropy": -6.0, "policy_t": -0.05436965450644493, "mean_q": 2.6032612323760986, "max_q": 3.224625825881958, "min_q": 1.9154913425445557}, "td_error": [0.7149055004119873, 0.36739420890808105, 1.4378949403762817, 0.38892030715942383, 1.9400798082351685, 0.5616650581359863, 0.5511980056762695, 0.5894865989685059, 1.3176214694976807, 0.9135271310806274, 1.296370506286621, 0.6682755947113037, 1.5559003353118896, 1.489890217781067, 1.0747044086456299, 1.3155419826507568, 0.7114415168762207, 1.460543155670166, 0.3086693286895752, 1.3994297981262207, 1.0095713138580322, 0.527068018913269, 2.262468099594116, 1.0751596689224243, 0.9768203496932983, 0.38945770263671875, 0.7236298322677612, 0.2611168622970581, 0.499065637588501, 0.7782613039016724, 0.4964202642440796, 1.204679250717163, 0.6631267070770264, 1.6416815519332886, 1.697990894317627, 0.7953687906265259, 1.7473022937774658, 0.3306856155395508, 0.8136427402496338, 0.6548829078674316, 0.32054758071899414, 1.7147810459136963, 0.8630714416503906, 1.2591323852539062, 1.8144599199295044, 2.359858274459839, 1.3376082181930542, 1.1758208274841309, 0.7928731441497803, 0.2637333869934082, 1.2060835361480713, 0.1410231590270996, 1.0740697383880615, 0.9584709405899048, 1.026853322982788, 0.7816734313964844, 0.7334500551223755, 1.9662243127822876, 1.0185133218765259, 0.3464517593383789, 0.344585657119751, 0.48285162448883057, 0.8884410858154297, 1.760607123374939, 0.9639371633529663, 0.4561808109283447, 1.6247225999832153, 1.4257153272628784, 0.24251461029052734, 0.4417757987976074, 0.5517932176589966, 0.032984256744384766, 1.6753206253051758, 1.0820612907409668, 0.3558485507965088, 0.49735355377197266, 4.215676307678223, 2.4006166458129883, 1.0984578132629395, 0.1872401237487793, 2.10494327545166, 0.23023128509521484, 1.3877097368240356, 0.9651893377304077, 0.5981885194778442, 0.3023974895477295], "mean_td_error": 1.0009757280349731, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 89.0, "diff_num_grad_updates_vs_sampler_policy": 88.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.056190490722656, "actor_loss": -6.699432849884033, "critic_loss": 0.10772515088319778, "alpha_loss": -0.2656114399433136, "alpha_value": 0.9739330410957336, "log_alpha_value": -0.026412729173898697, "target_entropy": -6.0, "policy_t": -0.0406709723174572, "mean_q": 2.6901986598968506, "max_q": 2.776388168334961, "min_q": 1.9187631607055664}, "td_error": [0.3667871952056885, 0.5458061695098877, 0.9623314142227173, 0.26305723190307617, 0.9340046644210815, 0.3155616521835327, 0.8803418874740601, 1.356258511543274, 0.6584237813949585, 0.2651538848876953, 1.1061633825302124, 1.9411346912384033, 0.2551678419113159, 1.3016633987426758, 0.5386313199996948, 0.0723273754119873, 1.266180396080017, 0.8931277990341187, 0.6623330116271973, 0.8791204690933228, 0.44054460525512695, 0.7588182687759399, 0.3753972053527832, 0.15456712245941162, 1.4476109743118286, 1.220387578010559, 2.402340888977051, 0.2371889352798462, 0.800703763961792, 0.8629904985427856, 0.7193188667297363, 0.0941474437713623, 0.19671964645385742, 0.7773103713989258, 0.05867123603820801, 0.5720551013946533, 1.1446963548660278, 1.2161026000976562, 0.7258762121200562, 1.912631630897522, 1.6325316429138184, 1.0630078315734863, 1.494395136833191, 1.8482791185379028, 1.5916190147399902, 1.5946377515792847, 1.544393539428711, 0.6686693429946899, 0.7718585729598999, 0.5995943546295166, 0.6777782440185547, 0.2741224765777588, 1.276428461074829, 0.43144869804382324, 0.43231499195098877, 0.5680127143859863, 2.447544574737549, 0.9605685472488403, 1.879965901374817, 0.4581416845321655, 0.3012688159942627, 0.25648069381713867, 0.038878440856933594, 1.0808100700378418, 0.6173350811004639, 0.8391522169113159, 0.8619160652160645, 1.5575742721557617, 1.4258365631103516, 1.5491080284118652, 0.8691896200180054, 0.39622044563293457, 0.4784574508666992, 0.9725834131240845, 0.4112696647644043, 0.015391230583190918, 0.9153735637664795, 2.1358642578125, 1.406376838684082, 0.09956037998199463, 0.28322112560272217, 0.15192878246307373, 0.25724923610687256, 0.6974977254867554, 0.952949047088623, 0.700014591217041], "mean_td_error": 0.8496333956718445, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 89.0, "diff_num_grad_updates_vs_sampler_policy": 88.0}}, "num_env_steps_sampled": 80640, "num_env_steps_trained": 22962, "num_agent_steps_sampled": 241920, "num_agent_steps_trained": 22962, "last_target_update_ts": 80640, "num_target_updates": 89}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 241920, "num_agent_steps_trained": 22962, "num_env_steps_sampled": 80640, "num_env_steps_trained": 22962, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 944.6469162266974, "num_env_steps_trained_throughput_per_sec": 272.00770578849097, "timesteps_total": 80640, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 241920, "timers": {"training_iteration_time_ms": 949.969, "sample_time_ms": 677.462, "load_time_ms": 0.31, "load_throughput": 831065.534, "learn_time_ms": 18.03, "learn_throughput": 14309.295, "synch_weights_time_ms": 9.647}, "counters": {"num_env_steps_sampled": 80640, "num_env_steps_trained": 22962, "num_agent_steps_sampled": 241920, "num_agent_steps_trained": 22962, "last_target_update_ts": 80640, "num_target_updates": 89}, "done": false, "episodes_total": 0, "training_iteration": 52, "trial_id": "cfa97_00000", "date": "2023-11-18_21-03-56", "timestamp": 1700370236, "time_this_iter_s": 1.9064860343933105, "time_total_s": 89.2849771976471, "pid": 6770, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17f30b9c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 89.2849771976471, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 70.76666666666667, "ram_util_percent": 65.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.000654220581055, "actor_loss": -8.8421049118042, "critic_loss": 0.16340118646621704, "alpha_loss": -0.2670639157295227, "alpha_value": 0.9736487865447998, "log_alpha_value": -0.026704642921686172, "target_entropy": -6.0, "policy_t": -0.06292902678251266, "mean_q": 4.7365922927856445, "max_q": 5.083568096160889, "min_q": 3.3821873664855957}, "td_error": [1.4061551094055176, 1.5966825485229492, 1.5889098644256592, 0.9363839626312256, 0.41004395484924316, 1.254809856414795, 0.24894046783447266, 0.17864537239074707, 2.1599268913269043, 1.1112384796142578, 1.4626121520996094, 0.09337592124938965, 0.7140192985534668, 0.21390461921691895, 0.5938246250152588, 0.3404710292816162, 1.9808919429779053, 1.8355193138122559, 0.9358632564544678, 1.2272145748138428, 0.9341235160827637, 0.1010136604309082, 2.0781381130218506, 1.3194105625152588, 1.4667637348175049, 1.7274625301361084, 0.4775667190551758, 0.4101269245147705, 0.09053564071655273, 0.8586267232894897, 0.4168260097503662, 0.16039443016052246, 1.4465618133544922, 2.5845284461975098, 1.0701854228973389, 0.8645389080047607, 0.3062474727630615, 0.9819519519805908, 0.3255727291107178, 0.9637253284454346, 0.2656519412994385, 0.6753695011138916, 0.2081758975982666, 0.6276054382324219, 0.6286561489105225, 0.09627628326416016, 0.8035039901733398, 0.8601944446563721, 2.9616291522979736, 0.42580127716064453, 1.3293910026550293, 2.205242156982422, 1.2869834899902344, 0.7177391052246094, 0.08410167694091797, 1.9070253372192383, 1.0703389644622803, 1.2425105571746826, 2.8045389652252197, 0.4991128444671631, 0.7006840705871582, 0.33887922763824463, 0.5055739879608154, 0.864436149597168, 2.767003297805786, 1.5260393619537354, 0.8148765563964844, 0.2472066879272461, 0.5046894550323486, 0.5310592651367188, 1.0157043933868408, 0.4678196907043457, 0.23260903358459473, 2.2437562942504883, 0.6109545230865479, 0.5340690612792969, 1.0275201797485352, 0.35849952697753906, 1.0624547004699707, 0.090850830078125, 0.9522192478179932, 0.08832764625549316, 1.021583080291748, 2.2388246059417725, 0.8293089866638184, 1.1264984607696533], "mean_td_error": 0.9566864967346191, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 90.0, "diff_num_grad_updates_vs_sampler_policy": 89.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.986282348632812, "actor_loss": -6.5720930099487305, "critic_loss": 0.13990026712417603, "alpha_loss": -0.26665711402893066, "alpha_value": 0.9736509919166565, "log_alpha_value": -0.026702342554926872, "target_entropy": -6.0, "policy_t": -0.07579272240400314, "mean_q": 2.646124839782715, "max_q": 3.578192710876465, "min_q": 2.041935443878174}, "td_error": [1.941953182220459, 0.20716726779937744, 0.3148062229156494, 0.07666957378387451, 0.8949015140533447, 0.7410016059875488, 1.823506474494934, 0.23379766941070557, 1.6541557312011719, 1.5224522352218628, 2.069077968597412, 1.404266119003296, 0.8705737590789795, 1.0989837646484375, 0.23199224472045898, 0.35806727409362793, 0.2901550531387329, 0.30147767066955566, 0.6253015995025635, 0.2879214286804199, 0.47016286849975586, 0.24293208122253418, 1.1385945081710815, 0.8063349723815918, 0.33321428298950195, 0.5899947881698608, 1.8198598623275757, 0.5520529747009277, 0.7178148031234741, 1.4780558347702026, 1.229728102684021, 0.11339414119720459, 0.041646718978881836, 1.3915317058563232, 0.1191256046295166, 0.5795583724975586, 0.2638806104660034, 0.25603485107421875, 1.3195754289627075, 1.3460736274719238, 1.2723898887634277, 0.4647824764251709, 0.3605576753616333, 0.014018774032592773, 0.5081324577331543, 1.0660032033920288, 0.41804349422454834, 1.750294804573059, 0.9167159795761108, 1.7460544109344482, 0.613579273223877, 0.19304049015045166, 0.41292667388916016, 0.8262841701507568, 0.9586822986602783, 0.26169729232788086, 0.6021755933761597, 0.8837786912918091, 0.35771989822387695, 0.4737100601196289, 0.585289716720581, 0.5140819549560547, 0.9000287055969238, 0.19160068035125732, 0.1563490629196167, 0.5863053798675537, 1.900098443031311, 0.7393447160720825, 1.379852294921875, 1.20693838596344, 0.475616455078125, 2.1045002937316895, 1.7601372003555298, 0.5126655101776123, 1.15892493724823, 1.9752472639083862, 0.09733116626739502, 1.0829706192016602, 1.3807131052017212, 0.5418668985366821, 1.4041087627410889, 0.6406669616699219, 0.6700594425201416, 0.051770567893981934, 1.8190321922302246, 0.9433287382125854], "mean_td_error": 0.8213629722595215, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 90.0, "diff_num_grad_updates_vs_sampler_policy": 89.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.074407577514648, "actor_loss": -6.675467491149902, "critic_loss": 0.11568739265203476, "alpha_loss": -0.2691117823123932, "alpha_value": 0.9736412167549133, "log_alpha_value": -0.02671241946518421, "target_entropy": -6.0, "policy_t": -0.019765712320804596, "mean_q": 2.719353675842285, "max_q": 2.763838291168213, "min_q": 2.6920366287231445}, "td_error": [0.5135130882263184, 2.827019214630127, 0.6161538362503052, 0.21617090702056885, 0.8234512805938721, 1.707746148109436, 0.6419861316680908, 1.5137184858322144, 2.0308070182800293, 0.3448472023010254, 0.5689681768417358, 0.26458609104156494, 0.011660218238830566, 1.3289779424667358, 1.6005821228027344, 2.107797145843506, 0.42313265800476074, 0.8429594039916992, 0.09883570671081543, 0.14579010009765625, 1.2061924934387207, 1.7008379697799683, 1.139345645904541, 0.40474188327789307, 0.16849136352539062, 0.35668206214904785, 0.07630586624145508, 0.6259151697158813, 1.2298365831375122, 0.7138556241989136, 0.47208845615386963, 2.277071952819824, 1.5174903869628906, 0.04770553112030029, 0.26963913440704346, 2.17983078956604, 1.0554149150848389, 0.26740944385528564, 0.3581808805465698, 1.3713922500610352, 0.42713677883148193, 1.2730308771133423, 0.8377841711044312, 0.4144442081451416, 0.7521591186523438, 0.344482421875, 0.06271648406982422, 0.32462239265441895, 0.4320751428604126, 0.16128408908843994, 0.6657297611236572, 0.30661654472351074, 0.3205028772354126, 0.33960092067718506, 0.08215224742889404, 1.998942494392395, 0.06591320037841797, 1.2746480703353882, 0.2720142602920532, 1.7852979898452759, 1.1857614517211914, 3.692830801010132, 1.5444263219833374, 1.138188123703003, 0.5315296649932861, 1.3670222759246826, 0.06344091892242432, 1.2069835662841797, 1.7962371110916138, 0.025768637657165527, 0.20239734649658203, 1.0773682594299316, 0.36708998680114746, 1.5696834325790405, 0.42492783069610596, 0.5435271263122559, 1.419424295425415, 0.06137359142303467, 0.7734798192977905, 0.4652369022369385, 1.7174736261367798, 0.20821237564086914, 0.38764500617980957, 1.0071500539779663, 1.7282915115356445, 0.4730873107910156], "mean_td_error": 0.8510097861289978, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 90.0, "diff_num_grad_updates_vs_sampler_policy": 89.0}}, "num_env_steps_sampled": 81536, "num_env_steps_trained": 23220, "num_agent_steps_sampled": 244608, "num_agent_steps_trained": 23220, "last_target_update_ts": 81536, "num_target_updates": 90}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 244608, "num_agent_steps_trained": 23220, "num_env_steps_sampled": 81536, "num_env_steps_trained": 23220, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 654.9418669477373, "num_env_steps_trained_throughput_per_sec": 188.5881715095047, "timesteps_total": 81536, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 244608, "timers": {"training_iteration_time_ms": 991.467, "sample_time_ms": 678.542, "load_time_ms": 0.311, "load_throughput": 828583.792, "learn_time_ms": 18.016, "learn_throughput": 14320.354, "synch_weights_time_ms": 9.67}, "counters": {"num_env_steps_sampled": 81536, "num_env_steps_trained": 23220, "num_agent_steps_sampled": 244608, "num_agent_steps_trained": 23220, "last_target_update_ts": 81536, "num_target_updates": 90}, "done": false, "episodes_total": 0, "training_iteration": 53, "trial_id": "cfa97_00000", "date": "2023-11-18_21-03-57", "timestamp": 1700370237, "time_this_iter_s": 1.3769149780273438, "time_total_s": 90.66189217567444, "pid": 6770, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17f30b060>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 90.66189217567444, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 53.2, "ram_util_percent": 65.45}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.97016429901123, "actor_loss": -8.798941612243652, "critic_loss": 0.15605303645133972, "alpha_loss": -0.27219682931900024, "alpha_value": 0.9730681777000427, "log_alpha_value": -0.027301138266921043, "target_entropy": -6.0, "policy_t": -0.08103113621473312, "mean_q": 4.701215744018555, "max_q": 5.06427001953125, "min_q": 2.5211963653564453}, "td_error": [0.8108813762664795, 0.4327528476715088, 2.7372682094573975, 0.6382780075073242, 0.5661673545837402, 1.4211182594299316, 2.3847382068634033, 0.0853719711303711, 1.098336935043335, 0.8915059566497803, 1.2387676239013672, 1.1511309146881104, 0.871274471282959, 0.21608853340148926, 0.8980958461761475, 1.3192248344421387, 0.19647645950317383, 1.0410611629486084, 1.6154403686523438, 1.610511064529419, 1.6106512546539307, 1.8684132099151611, 1.4854507446289062, 1.499178171157837, 1.997291088104248, 1.017045021057129, 0.3066537380218506, 0.7912874221801758, 0.4396181106567383, 0.1008310317993164, 0.3016362190246582, 0.08889341354370117, 1.0660743713378906, 1.4537296295166016, 0.15431761741638184, 2.396592617034912, 1.1900355815887451, 1.5649816989898682, 1.2425849437713623, 0.1423656940460205, 0.8738574981689453, 0.2401442527770996, 1.838005781173706, 0.7611637115478516, 0.3725728988647461, 0.8306803703308105, 1.170609712600708, 0.08585858345031738, 0.6454281806945801, 0.4008176326751709, 1.2300710678100586, 0.4221653938293457, 0.36171698570251465, 0.5149431228637695, 0.976555347442627, 0.8569371700286865, 1.2100670337677002, 0.4300117492675781, 0.6511657238006592, 0.8493590354919434, 0.10165166854858398, 0.2817666530609131, 0.435452938079834, 1.745149850845337, 0.18873834609985352, 2.5909295082092285, 0.11588191986083984, 0.3797001838684082, 0.25083160400390625, 0.9751448631286621, 0.08804130554199219, 2.0188395977020264, 1.2579703330993652, 0.18575501441955566, 1.6694726943969727, 0.8076190948486328, 1.7193310260772705, 0.2147676944732666, 0.33898043632507324, 0.19284462928771973, 0.28743577003479004, 1.7597663402557373, 1.6347572803497314, 2.0540170669555664, 0.08707332611083984, 0.08797931671142578], "mean_td_error": 0.9085366725921631, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 92.0, "diff_num_grad_updates_vs_sampler_policy": 91.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0376558303833, "actor_loss": -6.601737022399902, "critic_loss": 0.14669355750083923, "alpha_loss": -0.27402958273887634, "alpha_value": 0.9730691313743591, "log_alpha_value": -0.027300158515572548, "target_entropy": -6.0, "policy_t": -0.057630691677331924, "mean_q": 2.6243674755096436, "max_q": 3.75942325592041, "min_q": 2.0178449153900146}, "td_error": [2.3488752841949463, 0.7849968671798706, 1.0047158002853394, 1.878422498703003, 0.529820442199707, 0.6760586500167847, 0.5559287071228027, 0.10512828826904297, 0.4628685712814331, 0.37746262550354004, 1.9139082431793213, 0.3389933109283447, 0.20804369449615479, 0.9550724029541016, 2.319880485534668, 1.826041340827942, 0.015741467475891113, 0.44456255435943604, 1.9273995161056519, 0.05688917636871338, 1.2644230127334595, 0.7438769340515137, 1.0970484018325806, 0.08524656295776367, 0.8881875276565552, 0.36242759227752686, 0.9179626703262329, 0.30008769035339355, 0.16409015655517578, 2.2047007083892822, 1.1391562223434448, 0.3133934736251831, 0.14242243766784668, 2.0369272232055664, 0.17087602615356445, 0.6639337539672852, 0.10509717464447021, 1.3808642625808716, 0.5581948757171631, 1.805946946144104, 0.9618650674819946, 0.12184000015258789, 0.07576453685760498, 1.4073350429534912, 0.6199163198471069, 0.7263457775115967, 0.3019770383834839, 1.4810431003570557, 0.2972465753555298, 0.36138737201690674, 1.099595069885254, 1.3838883638381958, 0.5871237516403198, 0.7537920475006104, 0.24589204788208008, 0.8714781999588013, 1.2268006801605225, 1.2782578468322754, 1.061723232269287, 0.13903427124023438, 0.6946402788162231, 0.01893913745880127, 0.9778636693954468, 0.06487274169921875, 0.8120454549789429, 0.24777603149414062, 0.6899864673614502, 0.5899530649185181, 0.9709913730621338, 1.5157356262207031, 0.8140348196029663, 0.1947765350341797, 0.6924060583114624, 1.4143725633621216, 0.19598746299743652, 0.2304004430770874, 0.45313501358032227, 1.710437536239624, 0.9063100814819336, 0.765152096748352, 0.6330177783966064, 2.661971092224121, 0.4824521541595459, 1.451869010925293, 0.5248099565505981, 1.411981463432312], "mean_td_error": 0.8279523849487305, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 92.0, "diff_num_grad_updates_vs_sampler_policy": 91.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.022980690002441, "actor_loss": -6.637355327606201, "critic_loss": 0.10032907128334045, "alpha_loss": -0.27374494075775146, "alpha_value": 0.9730578660964966, "log_alpha_value": -0.02731172926723957, "target_entropy": -6.0, "policy_t": -0.0644519031047821, "mean_q": 2.676921844482422, "max_q": 2.738544464111328, "min_q": 1.8762753009796143}, "td_error": [0.33335065841674805, 0.2260373830795288, 0.20059418678283691, 1.0021213293075562, 1.040781855583191, 1.6887835264205933, 0.004532337188720703, 0.9431643486022949, 0.687049388885498, 0.18161916732788086, 0.028512239456176758, 2.3786754608154297, 0.06021106243133545, 1.4595863819122314, 0.6555627584457397, 2.570005416870117, 0.9331862926483154, 1.6545881032943726, 0.19410967826843262, 1.4031480550765991, 0.5051110982894897, 0.8365422487258911, 0.5469681024551392, 0.7311457395553589, 0.19406616687774658, 1.2034637928009033, 0.9876055717468262, 1.002384066581726, 1.0900051593780518, 0.3620380163192749, 0.7808163166046143, 0.8419610261917114, 0.4539060592651367, 0.3282879590988159, 0.6527106761932373, 1.0970025062561035, 2.999971628189087, 0.5279533863067627, 0.3671680688858032, 0.0948173999786377, 0.42717599868774414, 0.35148394107818604, 0.13420987129211426, 0.7277432680130005, 0.5967644453048706, 0.727933406829834, 0.6425442695617676, 1.0921608209609985, 0.21996188163757324, 1.0017378330230713, 1.1843639612197876, 0.878332257270813, 1.7274093627929688, 1.3115711212158203, 0.6872642040252686, 0.07300770282745361, 0.40610063076019287, 2.1578662395477295, 0.5205031633377075, 1.210277795791626, 0.3706231117248535, 0.04537796974182129, 1.375878095626831, 0.919196367263794, 0.30444931983947754, 0.5447103977203369, 1.0708426237106323, 0.10743081569671631, 0.5753805637359619, 0.15347564220428467, 0.44642817974090576, 1.4142301082611084, 0.25420165061950684, 1.5037835836410522, 0.6014493703842163, 1.082012414932251, 0.4196665287017822, 0.30868780612945557, 0.8068640232086182, 0.5223416090011597, 0.6213282346725464, 0.24337172508239746, 1.4566186666488647, 0.9668701887130737, 1.5103577375411987, 2.498692274093628], "mean_td_error": 0.8075839877128601, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 92.0, "diff_num_grad_updates_vs_sampler_policy": 91.0}}, "num_env_steps_sampled": 83328, "num_env_steps_trained": 23736, "num_agent_steps_sampled": 249984, "num_agent_steps_trained": 23736, "last_target_update_ts": 83328, "num_target_updates": 92}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 249984, "num_agent_steps_trained": 23736, "num_env_steps_sampled": 83328, "num_env_steps_trained": 23736, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 895.8521972368984, "num_env_steps_trained_throughput_per_sec": 257.9574407222319, "timesteps_total": 83328, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 249984, "timers": {"training_iteration_time_ms": 1002.574, "sample_time_ms": 683.71, "load_time_ms": 0.314, "load_throughput": 822912.876, "learn_time_ms": 18.035, "learn_throughput": 14305.512, "synch_weights_time_ms": 9.746}, "counters": {"num_env_steps_sampled": 83328, "num_env_steps_trained": 23736, "num_agent_steps_sampled": 249984, "num_agent_steps_trained": 23736, "last_target_update_ts": 83328, "num_target_updates": 92}, "done": false, "episodes_total": 0, "training_iteration": 54, "trial_id": "cfa97_00000", "date": "2023-11-18_21-03-59", "timestamp": 1700370239, "time_this_iter_s": 2.0099382400512695, "time_total_s": 92.67183041572571, "pid": 6770, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17f308fe0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 92.67183041572571, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 69.5, "ram_util_percent": 65.66666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.995906829833984, "actor_loss": -8.766531944274902, "critic_loss": 0.1573028564453125, "alpha_loss": -0.27885982394218445, "alpha_value": 0.9724881649017334, "log_alpha_value": -0.02789740078151226, "target_entropy": -6.0, "policy_t": -0.0868135467171669, "mean_q": 4.641847610473633, "max_q": 5.058082580566406, "min_q": 2.4028725624084473}, "td_error": [1.1312270164489746, 0.89939284324646, 2.4034643173217773, 0.23106932640075684, 0.9022185802459717, 1.949134349822998, 1.9208862781524658, 0.7879683971405029, 0.14923357963562012, 0.6411948204040527, 0.9020187854766846, 0.09022283554077148, 1.2157626152038574, 0.38918161392211914, 2.0136897563934326, 0.8472182750701904, 0.8366553783416748, 0.23666095733642578, 0.3569188117980957, 0.3695986270904541, 0.2598083019256592, 2.251458168029785, 0.1943960189819336, 0.5261917114257812, 0.21075701713562012, 0.4405972957611084, 1.4956867694854736, 1.0947685241699219, 0.7185807228088379, 0.08300042152404785, 0.6724858283996582, 0.23638439178466797, 2.735119581222534, 0.596804141998291, 1.0705070495605469, 0.9054946899414062, 1.910552740097046, 0.17998075485229492, 1.0159556865692139, 0.7948012351989746, 0.2792243957519531, 1.0686500072479248, 1.1531038284301758, 1.6629974842071533, 1.2488226890563965, 0.21947693824768066, 0.16773343086242676, 0.6027894020080566, 0.2902824878692627, 0.12767744064331055, 1.9814808368682861, 0.6033518314361572, 0.3486008644104004, 0.2121741771697998, 2.905980110168457, 1.6703829765319824, 0.3319873809814453, 2.011162519454956, 0.4615182876586914, 0.21039581298828125, 1.4866204261779785, 2.243145227432251, 1.8499329090118408, 1.44150710105896, 1.312493085861206, 1.974393367767334, 0.9768562316894531, 1.4640800952911377, 1.150099277496338, 0.9989645481109619, 0.08058977127075195, 0.7820091247558594, 1.830920696258545, 0.0845193862915039, 1.5029940605163574, 0.40784549713134766, 1.0371217727661133, 0.22186946868896484, 0.2599949836730957, 0.710543155670166, 1.6273798942565918, 0.8165926933288574, 0.8953762054443359, 0.9106359481811523, 0.5677216053009033, 0.2555992603302002], "mean_td_error": 0.9315656423568726, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 94.0, "diff_num_grad_updates_vs_sampler_policy": 93.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.06246566772461, "actor_loss": -6.582266330718994, "critic_loss": 0.16106368601322174, "alpha_loss": -0.28071901202201843, "alpha_value": 0.9724879264831543, "log_alpha_value": -0.027897635474801064, "target_entropy": -6.0, "policy_t": -0.0678284615278244, "mean_q": 2.636522054672241, "max_q": 3.3051416873931885, "min_q": 2.182063102722168}, "td_error": [1.1798759698867798, 0.5291235446929932, 0.7025264501571655, 0.42597150802612305, 0.8372564315795898, 2.019411325454712, 1.0640043020248413, 0.6821807622909546, 0.584187388420105, 0.02263486385345459, 0.12867772579193115, 1.0539498329162598, 0.06856405735015869, 1.3567107915878296, 1.5269570350646973, 0.3976987600326538, 0.8686262369155884, 1.8724924325942993, 0.45768237113952637, 1.1281198263168335, 1.3625911474227905, 0.6486942768096924, 1.1096956729888916, 1.3775018453598022, 0.4466075897216797, 1.2153129577636719, 3.089996337890625, 1.4187971353530884, 0.5276238918304443, 0.2180323600769043, 0.026514053344726562, 1.7620844841003418, 3.0132222175598145, 2.264071464538574, 0.4372730255126953, 0.34191393852233887, 0.8332551717758179, 2.795755386352539, 1.7661703824996948, 0.6107197999954224, 0.2307673692703247, 0.23029088973999023, 0.5471985340118408, 0.3027855157852173, 0.6494494676589966, 0.5910943746566772, 0.271503210067749, 0.5545153617858887, 0.508303165435791, 0.08888018131256104, 1.9150806665420532, 0.22975564002990723, 0.13674938678741455, 0.09524548053741455, 1.4595487117767334, 0.9001808166503906, 1.2625716924667358, 0.4003697633743286, 1.4079360961914062, 0.801652193069458, 1.9770643711090088, 0.3566218614578247, 0.4169738292694092, 1.6093473434448242, 0.01010274887084961, 0.10556697845458984, 0.8907228708267212, 0.6430680751800537, 1.0905084609985352, 1.269269347190857, 0.8740190267562866, 0.4589756727218628, 0.985315203666687, 1.8100087642669678, 1.6324501037597656, 1.1309094429016113, 1.1221359968185425, 0.8443772792816162, 0.44133293628692627, 0.9787688255310059, 0.555142879486084, 0.8396903276443481, 0.8519785404205322, 0.08521485328674316, 0.010804414749145508, 1.3252649307250977], "mean_td_error": 0.896186113357544, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 94.0, "diff_num_grad_updates_vs_sampler_policy": 93.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0521240234375, "actor_loss": -6.649127960205078, "critic_loss": 0.0975811555981636, "alpha_loss": -0.2805614173412323, "alpha_value": 0.9724752306938171, "log_alpha_value": -0.027910660952329636, "target_entropy": -6.0, "policy_t": -0.09002739191055298, "mean_q": 2.657301187515259, "max_q": 2.9159255027770996, "min_q": 2.0907511711120605}, "td_error": [1.2642223834991455, 0.6246908903121948, 0.4049447774887085, 0.536414384841919, 0.16844987869262695, 0.39429306983947754, 0.6474454402923584, 0.9813802242279053, 0.1654834747314453, 0.1592773199081421, 1.6371145248413086, 0.428818941116333, 0.44210267066955566, 1.1961348056793213, 0.6725888252258301, 0.08101439476013184, 0.5550941228866577, 1.2901837825775146, 0.47137582302093506, 1.0735925436019897, 0.5148136615753174, 0.49555814266204834, 0.033763766288757324, 0.4678823947906494, 0.16551709175109863, 0.5346511602401733, 1.5922439098358154, 0.26037299633026123, 0.8763054609298706, 1.0425418615341187, 2.1924376487731934, 2.2282886505126953, 0.6213610172271729, 1.2508268356323242, 0.5853121280670166, 1.4492026567459106, 0.956458568572998, 0.9122645854949951, 0.22518527507781982, 0.1243218183517456, 1.0593916177749634, 0.2927924394607544, 2.691795825958252, 1.5110251903533936, 1.35908842086792, 0.7360402345657349, 1.782520055770874, 2.30240535736084, 0.30288660526275635, 0.2034928798675537, 1.0067768096923828, 0.3989603519439697, 0.928673267364502, 2.141948938369751, 0.4381824731826782, 0.34311366081237793, 0.4572939872741699, 0.48868680000305176, 0.3022270202636719, 0.28570711612701416, 0.6755101680755615, 0.004434704780578613, 1.6330606937408447, 1.054661750793457, 0.13277387619018555, 0.28810298442840576, 1.4230775833129883, 0.9547246694564819, 0.25377488136291504, 1.0599249601364136, 0.7205477952957153, 0.6956098079681396, 1.406391978263855, 1.63698410987854, 0.21051251888275146, 0.6640245914459229, 0.4899296760559082, 0.055843353271484375, 0.40805017948150635, 0.31694066524505615, 1.4626044034957886, 0.47207045555114746, 0.8282220363616943, 0.7913761138916016, 1.578691005706787, 0.22140896320343018], "mean_td_error": 0.7929790616035461, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 94.0, "diff_num_grad_updates_vs_sampler_policy": 93.0}}, "num_env_steps_sampled": 85120, "num_env_steps_trained": 24252, "num_agent_steps_sampled": 255360, "num_agent_steps_trained": 24252, "last_target_update_ts": 85120, "num_target_updates": 94}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 255360, "num_agent_steps_trained": 24252, "num_env_steps_sampled": 85120, "num_env_steps_trained": 24252, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 936.8251028786067, "num_env_steps_trained_throughput_per_sec": 269.75544256995596, "timesteps_total": 85120, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 255360, "timers": {"training_iteration_time_ms": 1000.617, "sample_time_ms": 680.227, "load_time_ms": 0.315, "load_throughput": 818184.207, "learn_time_ms": 18.045, "learn_throughput": 14297.271, "synch_weights_time_ms": 9.677}, "counters": {"num_env_steps_sampled": 85120, "num_env_steps_trained": 24252, "num_agent_steps_sampled": 255360, "num_agent_steps_trained": 24252, "last_target_update_ts": 85120, "num_target_updates": 94}, "done": false, "episodes_total": 0, "training_iteration": 55, "trial_id": "cfa97_00000", "date": "2023-11-18_21-04-01", "timestamp": 1700370241, "time_this_iter_s": 1.9212689399719238, "time_total_s": 94.59309935569763, "pid": 6770, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17f3096c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 94.59309935569763, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 73.4, "ram_util_percent": 65.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.93449592590332, "actor_loss": -8.669638633728027, "critic_loss": 0.15015631914138794, "alpha_loss": -0.2830676734447479, "alpha_value": 0.971908688545227, "log_alpha_value": -0.02849341370165348, "target_entropy": -6.0, "policy_t": -0.06599795073270798, "mean_q": 4.5684027671813965, "max_q": 5.027706623077393, "min_q": 2.3194174766540527}, "td_error": [0.07340383529663086, 1.1359646320343018, 1.335166096687317, 0.4412343502044678, 0.06278467178344727, 0.15820837020874023, 0.7940685749053955, 0.8053975105285645, 0.32205820083618164, 0.689035177230835, 0.8066937923431396, 1.014099359512329, 0.9537570476531982, 0.26782655715942383, 0.16553997993469238, 0.6216866970062256, 0.11462545394897461, 1.5784449577331543, 1.7738757133483887, 0.3001585006713867, 0.8164975643157959, 1.1190423965454102, 1.1853084564208984, 1.818901777267456, 0.5770833492279053, 0.9952595233917236, 0.7043533325195312, 0.29422473907470703, 1.192579746246338, 1.3671417236328125, 0.22261762619018555, 0.5224020481109619, 1.2522001266479492, 2.8374667167663574, 0.6439294815063477, 3.8425042629241943, 0.08955693244934082, 0.8851726055145264, 2.299860715866089, 0.8062067031860352, 0.7017676830291748, 1.073824167251587, 0.4099311828613281, 1.1768410205841064, 0.5910348892211914, 0.4794330596923828, 1.2443902492523193, 0.45726680755615234, 0.6521971225738525, 1.496863603591919, 0.4393038749694824, 1.1411981582641602, 1.7089924812316895, 2.4185445308685303, 0.8281302452087402, 3.5551962852478027, 0.44426441192626953, 0.5100767612457275, 1.1564997434616089, 0.8120238780975342, 0.5351331233978271, 0.1925487518310547, 2.640714645385742, 0.11267971992492676, 1.4775938987731934, 0.38817358016967773, 0.913444995880127, 0.3066372871398926, 0.23576593399047852, 1.340080976486206, 1.1583938598632812, 0.5905842781066895, 1.1446921825408936, 0.8842861652374268, 0.5713176727294922, 1.1500563621520996, 0.830359935760498, 0.26890015602111816, 1.7813560962677002, 0.7884204387664795, 0.6716787815093994, 0.06409740447998047, 0.22098207473754883, 2.2996935844421387, 0.4059906005859375, 0.7237949371337891], "mean_td_error": 0.9288545846939087, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 96.0, "diff_num_grad_updates_vs_sampler_policy": 95.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.048628807067871, "actor_loss": -6.564142227172852, "critic_loss": 0.16468378901481628, "alpha_loss": -0.28633907437324524, "alpha_value": 0.971906840801239, "log_alpha_value": -0.028495335951447487, "target_entropy": -6.0, "policy_t": -0.04366927593946457, "mean_q": 2.631728410720825, "max_q": 3.3623225688934326, "min_q": 2.0883142948150635}, "td_error": [1.1317049264907837, 0.669176459312439, 1.1278741359710693, 0.2724958658218384, 0.07413041591644287, 0.9627547264099121, 0.7205054759979248, 0.5562218427658081, 0.19524741172790527, 2.285106658935547, 1.3152916431427002, 0.07293879985809326, 0.46507108211517334, 0.41755008697509766, 1.1740261316299438, 0.15906023979187012, 0.4061778783798218, 0.047679901123046875, 0.5211985111236572, 1.2615898847579956, 2.1383109092712402, 0.5560605525970459, 1.0007131099700928, 1.386007308959961, 1.135271430015564, 0.31445956230163574, 1.2974965572357178, 0.41044139862060547, 0.03490757942199707, 1.1228437423706055, 0.5385733842849731, 0.23424434661865234, 0.7838426828384399, 1.4371212720870972, 0.03508639335632324, 0.6050382852554321, 2.2413783073425293, 0.36324965953826904, 1.101927638053894, 1.0357677936553955, 0.792387843132019, 1.5297160148620605, 2.0222787857055664, 0.018843889236450195, 1.7842774391174316, 0.18451929092407227, 1.0760897397994995, 1.199157953262329, 1.9534324407577515, 0.4391789436340332, 1.7089062929153442, 1.0326478481292725, 1.8257991075515747, 2.2015457153320312, 0.6399980783462524, 2.8073220252990723, 0.23266220092773438, 0.17011761665344238, 0.43265533447265625, 0.6912333965301514, 1.8845510482788086, 1.2328356504440308, 1.8582311868667603, 0.6255520582199097, 1.0374767780303955, 0.01726555824279785, 0.8670477867126465, 0.13646793365478516, 0.5910749435424805, 1.4291843175888062, 1.1660497188568115, 0.9410110712051392, 0.7209922075271606, 0.016431689262390137, 0.9043190479278564, 1.7629117965698242, 0.9823590517044067, 0.2927064895629883, 0.5138187408447266, 0.927375078201294, 0.1263103485107422, 2.6270737648010254, 0.996477484703064, 0.3721017837524414, 0.4124424457550049, 0.2102886438369751], "mean_td_error": 0.8953915238380432, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 96.0, "diff_num_grad_updates_vs_sampler_policy": 95.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.036030769348145, "actor_loss": -6.612984657287598, "critic_loss": 0.1180923730134964, "alpha_loss": -0.28612229228019714, "alpha_value": 0.9718930721282959, "log_alpha_value": -0.028509505093097687, "target_entropy": -6.0, "policy_t": -0.07160156220197678, "mean_q": 2.640896797180176, "max_q": 2.7009668350219727, "min_q": 1.9633256196975708}, "td_error": [1.8715566396713257, 0.333590030670166, 1.0016086101531982, 2.472050666809082, 0.37230420112609863, 0.7218713760375977, 0.9728202819824219, 0.9933388233184814, 0.13073468208312988, 0.3246406316757202, 0.23073899745941162, 0.7558592557907104, 0.06812870502471924, 0.14535343647003174, 0.39117634296417236, 1.2570427656173706, 0.3444099426269531, 1.8144612312316895, 1.9812891483306885, 0.24375641345977783, 0.6475462913513184, 0.2998695373535156, 1.5761892795562744, 0.5845777988433838, 0.013019919395446777, 0.5639209747314453, 0.593346118927002, 0.284008264541626, 0.2653449773788452, 0.8809199333190918, 2.443077564239502, 0.6351962089538574, 1.2727656364440918, 0.39891517162323, 0.30939674377441406, 1.9930905103683472, 1.062652587890625, 1.3778018951416016, 1.253092885017395, 0.8124821186065674, 2.2090821266174316, 0.36243903636932373, 0.2918980121612549, 0.14694523811340332, 1.130274772644043, 0.10666513442993164, 2.0766520500183105, 0.016284942626953125, 0.6044855117797852, 1.4179496765136719, 0.2796287536621094, 0.30270493030548096, 0.5538017749786377, 0.7909276485443115, 0.6787599325180054, 0.3373790979385376, 0.3295949697494507, 0.3342949151992798, 1.7291926145553589, 0.6003866195678711, 0.7630817890167236, 0.806899905204773, 0.8957440853118896, 0.4130057096481323, 1.0770213603973389, 0.47082817554473877, 0.5459166765213013, 0.32550907135009766, 1.9429998397827148, 0.49557220935821533, 0.00164031982421875, 0.7186063528060913, 0.5997493267059326, 0.7285864353179932, 1.849332332611084, 2.8036723136901855, 0.49070966243743896, 1.4022769927978516, 1.2427637577056885, 0.7898117303848267, 1.2703840732574463, 0.641059398651123, 1.3427067995071411, 3.1167306900024414, 2.5665602684020996, 1.205350637435913], "mean_td_error": 0.8895326852798462, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 96.0, "diff_num_grad_updates_vs_sampler_policy": 95.0}}, "num_env_steps_sampled": 86912, "num_env_steps_trained": 24768, "num_agent_steps_sampled": 260736, "num_agent_steps_trained": 24768, "last_target_update_ts": 86912, "num_target_updates": 96}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 260736, "num_agent_steps_trained": 24768, "num_env_steps_sampled": 86912, "num_env_steps_trained": 24768, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 957.5708350463466, "num_env_steps_trained_throughput_per_sec": 275.7291020557561, "timesteps_total": 86912, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 260736, "timers": {"training_iteration_time_ms": 998.759, "sample_time_ms": 678.393, "load_time_ms": 0.316, "load_throughput": 817072.208, "learn_time_ms": 18.009, "learn_throughput": 14325.89, "synch_weights_time_ms": 9.69}, "counters": {"num_env_steps_sampled": 86912, "num_env_steps_trained": 24768, "num_agent_steps_sampled": 260736, "num_agent_steps_trained": 24768, "last_target_update_ts": 86912, "num_target_updates": 96}, "done": false, "episodes_total": 0, "training_iteration": 56, "trial_id": "cfa97_00000", "date": "2023-11-18_21-04-03", "timestamp": 1700370243, "time_this_iter_s": 1.8807899951934814, "time_total_s": 96.47388935089111, "pid": 6770, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17f3098a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 96.47388935089111, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 71.10000000000001, "ram_util_percent": 65.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.934652328491211, "actor_loss": -8.691344261169434, "critic_loss": 0.17149856686592102, "alpha_loss": -0.2889846861362457, "alpha_value": 0.971330463886261, "log_alpha_value": -0.02908855490386486, "target_entropy": -6.0, "policy_t": -0.11156559735536575, "mean_q": 4.653224945068359, "max_q": 4.994826793670654, "min_q": 4.028947830200195}, "td_error": [0.35274457931518555, 0.5204932689666748, 0.6926484107971191, 1.1098835468292236, 0.5982661247253418, 0.491330623626709, 0.1314408779144287, 0.7046511173248291, 2.730905294418335, 1.0224437713623047, 0.4650228023529053, 2.743051528930664, 0.08560705184936523, 1.8126001358032227, 2.2745628356933594, 1.0691602230072021, 0.22409534454345703, 0.24221396446228027, 0.061618804931640625, 1.0984172821044922, 0.7881200313568115, 1.9386801719665527, 0.3453826904296875, 0.6359553337097168, 0.06860518455505371, 0.18560481071472168, 1.233447790145874, 1.7297794818878174, 0.7344026565551758, 0.8096964359283447, 0.9305455684661865, 0.2810213565826416, 0.30158019065856934, 1.2464170455932617, 2.030642032623291, 0.7542409896850586, 1.2684893608093262, 0.2715160846710205, 1.6909902095794678, 1.6037781238555908, 2.1454174518585205, 1.7396581172943115, 3.0693392753601074, 1.2396430969238281, 1.0748095512390137, 0.2837667465209961, 0.640995979309082, 0.0938568115234375, 0.5142943859100342, 0.27536535263061523, 1.559286117553711, 0.07370829582214355, 0.1801300048828125, 1.2561261653900146, 1.2162039279937744, 1.2312259674072266, 1.164961576461792, 0.6660754680633545, 0.556555986404419, 0.21689820289611816, 1.7261626720428467, 1.564502239227295, 1.5793507099151611, 2.381265878677368, 1.422394037246704, 0.05137300491333008, 0.3873758316040039, 1.6150283813476562, 0.3305060863494873, 0.9085288047790527, 1.1694843769073486, 1.637580156326294, 2.2896368503570557, 0.6847655773162842, 2.2390334606170654, 0.9904119968414307, 1.6096796989440918, 0.5274534225463867, 0.19238734245300293, 1.5353553295135498, 0.7666559219360352, 0.3382582664489746, 1.289055347442627, 1.1224403381347656, 0.40602731704711914, 0.9146430492401123], "mean_td_error": 1.0018340349197388, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 98.0, "diff_num_grad_updates_vs_sampler_policy": 97.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.02358627319336, "actor_loss": -6.604491710662842, "critic_loss": 0.14567209780216217, "alpha_loss": -0.29161980748176575, "alpha_value": 0.9713257551193237, "log_alpha_value": -0.029093360528349876, "target_entropy": -6.0, "policy_t": -0.05994974076747894, "mean_q": 2.6655194759368896, "max_q": 4.00699520111084, "min_q": 2.1353492736816406}, "td_error": [0.8787257671356201, 1.9658852815628052, 0.3542909622192383, 0.910403847694397, 0.22267282009124756, 0.17371642589569092, 1.0241427421569824, 1.4448236227035522, 0.5455970764160156, 0.43666350841522217, 0.4372894763946533, 0.04103195667266846, 0.5231732130050659, 0.42941999435424805, 0.4158214330673218, 1.5805317163467407, 1.20841383934021, 1.619636058807373, 1.8270139694213867, 0.23293471336364746, 0.016066431999206543, 0.9209128618240356, 0.36672306060791016, 0.6296584606170654, 0.8821604251861572, 1.507755994796753, 0.8539513349533081, 2.1011319160461426, 0.8992077112197876, 0.9935950040817261, 1.1301720142364502, 0.7658936977386475, 0.3532412052154541, 0.27683496475219727, 1.0648488998413086, 0.47112762928009033, 2.0267550945281982, 0.7245361804962158, 0.7335789203643799, 0.1523442268371582, 0.9699828624725342, 1.6216371059417725, 0.19691967964172363, 0.8480542898178101, 0.4151937961578369, 0.016037464141845703, 1.3919438123703003, 0.5368618965148926, 2.1157188415527344, 0.5606808662414551, 1.2604535818099976, 1.1386823654174805, 1.0804545879364014, 1.1085072755813599, 1.1789519786834717, 0.39698803424835205, 0.6029863357543945, 0.3369065523147583, 1.5098423957824707, 2.283843755722046, 0.4248936176300049, 0.27994275093078613, 0.6670323610305786, 0.40411221981048584, 1.1996545791625977, 0.591987133026123, 0.8719544410705566, 1.3991057872772217, 1.7922041416168213, 0.4980287551879883, 1.4744899272918701, 0.31384992599487305, 1.5391241312026978, 0.39846765995025635, 1.2289336919784546, 1.1704351902008057, 0.6697640419006348, 0.5577411651611328, 0.2452625036239624, 0.14541089534759521, 0.9304118156433105, 1.3877301216125488, 0.14892113208770752, 0.03199303150177002, 1.085789442062378, 0.03899085521697998], "mean_td_error": 0.8396461009979248, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 98.0, "diff_num_grad_updates_vs_sampler_policy": 97.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.157797813415527, "actor_loss": -6.708886623382568, "critic_loss": 0.10782216489315033, "alpha_loss": -0.2956751585006714, "alpha_value": 0.9713113903999329, "log_alpha_value": -0.0291081964969635, "target_entropy": -6.0, "policy_t": -0.06260146200656891, "mean_q": 2.635023593902588, "max_q": 2.873195171356201, "min_q": 2.0067238807678223}, "td_error": [1.8515729904174805, 1.0962711572647095, 0.4652535915374756, 0.6603579521179199, 0.25063419342041016, 0.15091872215270996, 0.6602509021759033, 0.7899042367935181, 1.5479460954666138, 1.9595965147018433, 0.8577698469161987, 0.1934453248977661, 0.5289506912231445, 0.2732961177825928, 1.4442259073257446, 1.5385013818740845, 1.270941972732544, 2.074981212615967, 1.6445529460906982, 0.25700950622558594, 1.1431910991668701, 1.5422837734222412, 0.6518145799636841, 0.4529052972793579, 0.814382791519165, 0.1487821340560913, 2.0231423377990723, 1.3468129634857178, 1.411950707435608, 0.18065881729125977, 1.0035206079483032, 0.12840008735656738, 1.8182730674743652, 0.0759115219116211, 1.0796000957489014, 1.2690476179122925, 1.380192518234253, 1.0770657062530518, 2.8435723781585693, 1.2248961925506592, 0.3924269676208496, 0.1885838508605957, 1.8163152933120728, 1.3199399709701538, 0.7831805944442749, 2.5411152839660645, 0.549566388130188, 0.24179327487945557, 0.2782714366912842, 0.42690396308898926, 0.1344820261001587, 0.4284796714782715, 0.043352484703063965, 0.5193345546722412, 0.9215379953384399, 0.4572944641113281, 0.3095700740814209, 1.1369036436080933, 0.03825533390045166, 1.2228374481201172, 0.493973970413208, 2.606997489929199, 0.26737523078918457, 2.091855049133301, 1.3821172714233398, 0.3104919195175171, 0.3665282726287842, 0.6748144626617432, 0.5309228897094727, 0.7150552272796631, 1.0028291940689087, 1.5161669254302979, 1.6677277088165283, 0.057175517082214355, 0.2760545015335083, 0.41799604892730713, 1.2565255165100098, 0.8903641700744629, 0.9508293867111206, 0.5153850317001343, 0.43675971031188965, 1.8843231201171875, 0.7821036577224731, 0.2063370943069458, 0.5364365577697754, 1.1461519002914429], "mean_td_error": 0.905421257019043, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 98.0, "diff_num_grad_updates_vs_sampler_policy": 97.0}}, "num_env_steps_sampled": 88704, "num_env_steps_trained": 25284, "num_agent_steps_sampled": 266112, "num_agent_steps_trained": 25284, "last_target_update_ts": 88704, "num_target_updates": 98}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 266112, "num_agent_steps_trained": 25284, "num_env_steps_sampled": 88704, "num_env_steps_trained": 25284, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 934.9018245168605, "num_env_steps_trained_throughput_per_sec": 269.20164143454247, "timesteps_total": 88704, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 266112, "timers": {"training_iteration_time_ms": 1000.969, "sample_time_ms": 678.605, "load_time_ms": 0.313, "load_throughput": 823351.162, "learn_time_ms": 17.881, "learn_throughput": 14428.983, "synch_weights_time_ms": 9.752}, "counters": {"num_env_steps_sampled": 88704, "num_env_steps_trained": 25284, "num_agent_steps_sampled": 266112, "num_agent_steps_trained": 25284, "last_target_update_ts": 88704, "num_target_updates": 98}, "done": false, "episodes_total": 0, "training_iteration": 57, "trial_id": "cfa97_00000", "date": "2023-11-18_21-04-05", "timestamp": 1700370245, "time_this_iter_s": 1.9244999885559082, "time_total_s": 98.39838933944702, "pid": 6770, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17f30bce0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 98.39838933944702, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 69.16666666666667, "ram_util_percent": 65.56666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.815340042114258, "actor_loss": -8.63211727142334, "critic_loss": 0.164880633354187, "alpha_loss": -0.29134735465049744, "alpha_value": 0.9707533717155457, "log_alpha_value": -0.029682857915759087, "target_entropy": -6.0, "policy_t": -0.17860758304595947, "mean_q": 4.509204387664795, "max_q": 4.984006881713867, "min_q": 2.676847457885742}, "td_error": [0.8423740863800049, 0.07726740837097168, 1.9794442653656006, 0.7852325439453125, 2.6866812705993652, 0.29217529296875, 0.07360315322875977, 0.7251434326171875, 0.3517444133758545, 0.26011788845062256, 1.5947265625, 1.1067922115325928, 0.34261655807495117, 3.383908748626709, 0.9967169761657715, 1.144019603729248, 1.8683862686157227, 0.24253427982330322, 1.126509666442871, 0.7812838554382324, 0.566429853439331, 1.3856701850891113, 0.33993983268737793, 0.24414396286010742, 2.03983736038208, 0.22198247909545898, 1.4225568771362305, 1.5832927227020264, 1.0147206783294678, 1.8426704406738281, 2.4270331859588623, 0.5942153930664062, 1.9200735092163086, 1.765570878982544, 0.21073758602142334, 0.48174142837524414, 0.45921945571899414, 2.9364068508148193, 1.0547592639923096, 0.45042991638183594, 0.53000807762146, 0.16454815864562988, 0.5528898239135742, 1.2467265129089355, 1.4305310249328613, 0.641798734664917, 0.32745909690856934, 0.5533506870269775, 1.5376079082489014, 0.1162564754486084, 1.4762487411499023, 0.35956859588623047, 1.8898026943206787, 0.05115938186645508, 0.055261850357055664, 0.2599830627441406, 2.5205025672912598, 0.9075822830200195, 1.8166871070861816, 0.5190906524658203, 1.201667308807373, 0.8295824527740479, 0.9615728855133057, 2.6950573921203613, 0.9719133377075195, 0.6764748096466064, 0.31472063064575195, 0.4854464530944824, 0.8893871307373047, 0.32387304306030273, 1.1025164127349854, 1.4666142463684082, 0.6066446304321289, 1.7016651630401611, 0.31325411796569824, 1.002223253250122, 1.5277595520019531, 0.07721066474914551, 1.0091938972473145, 0.5824041366577148, 0.30118799209594727, 0.2899484634399414, 1.0251171588897705, 0.10078096389770508, 1.2171072959899902, 1.0418899059295654], "mean_td_error": 0.9685463309288025, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 100.0, "diff_num_grad_updates_vs_sampler_policy": 99.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.083597183227539, "actor_loss": -6.657255172729492, "critic_loss": 0.17369428277015686, "alpha_loss": -0.2993963956832886, "alpha_value": 0.9707450270652771, "log_alpha_value": -0.02969142608344555, "target_entropy": -6.0, "policy_t": -0.021340150386095047, "mean_q": 2.7090001106262207, "max_q": 4.073006629943848, "min_q": 2.1643574237823486}, "td_error": [1.6672307252883911, 0.6866953372955322, 0.8529446125030518, 0.31148242950439453, 1.4659435749053955, 0.6883957386016846, 0.49210453033447266, 0.8153241872787476, 0.21576154232025146, 2.5089874267578125, 0.3390228748321533, 1.3061668872833252, 0.8920472860336304, 1.0323063135147095, 0.684436559677124, 1.756402850151062, 0.03213143348693848, 0.7038782835006714, 1.3765158653259277, 1.3052788972854614, 0.016842126846313477, 0.019217729568481445, 0.8030056953430176, 0.3329840898513794, 0.024205684661865234, 0.6834284067153931, 0.6722424030303955, 0.5797284841537476, 0.8336126804351807, 0.8420215845108032, 2.0240628719329834, 1.0764144659042358, 1.870091438293457, 1.0823450088500977, 0.5726826190948486, 0.486545205116272, 1.6240856647491455, 0.7851409912109375, 1.2688419818878174, 1.5834143161773682, 1.4551907777786255, 0.191398024559021, 0.3688230514526367, 0.9145040512084961, 0.7979685068130493, 1.4738773107528687, 2.2676539421081543, 1.0445623397827148, 0.329553484916687, 0.6716123819351196, 1.0703117847442627, 2.016211986541748, 2.3996708393096924, 0.16871440410614014, 0.11361074447631836, 0.16550147533416748, 0.6402480602264404, 0.3348855972290039, 0.04189598560333252, 1.8023905754089355, 0.34320855140686035, 2.057826042175293, 2.214231491088867, 0.6583212614059448, 0.6213573217391968, 0.49557387828826904, 1.7371224164962769, 0.03152668476104736, 0.15125250816345215, 0.6370551586151123, 1.8726528882980347, 0.6840856075286865, 0.9478546380996704, 0.03207230567932129, 1.50992751121521, 0.40077030658721924, 0.3008267879486084, 1.316696047782898, 0.26555752754211426, 2.144727945327759, 0.8426196575164795, 1.2344207763671875, 0.032782912254333496, 1.1421724557876587, 2.6335830688476562, 0.9491268396377563], "mean_td_error": 0.928371012210846, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 100.0, "diff_num_grad_updates_vs_sampler_policy": 99.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.060752868652344, "actor_loss": -6.575636863708496, "critic_loss": 0.08535090833902359, "alpha_loss": -0.2988806664943695, "alpha_value": 0.9707293510437012, "log_alpha_value": -0.02970758266746998, "target_entropy": -6.0, "policy_t": -0.00489679304882884, "mean_q": 2.642364501953125, "max_q": 3.224813461303711, "min_q": 2.163862705230713}, "td_error": [0.1847515106201172, 0.09797406196594238, 2.1140127182006836, 1.6774230003356934, 1.8135570287704468, 0.6017982959747314, 0.6670486927032471, 0.14968979358673096, 1.5830700397491455, 0.5401821136474609, 0.20969665050506592, 2.3325953483581543, 0.19630229473114014, 1.0353559255599976, 1.030914306640625, 0.37887489795684814, 0.133142352104187, 0.18584442138671875, 0.37081778049468994, 0.422116756439209, 0.44089674949645996, 0.633399486541748, 1.2874321937561035, 0.3724832534790039, 0.07462048530578613, 0.3561621904373169, 0.7003958225250244, 1.0978859663009644, 0.6248112916946411, 2.550536632537842, 0.12109827995300293, 0.7013754844665527, 2.2545557022094727, 0.22146570682525635, 0.2702449560165405, 1.1609734296798706, 0.46974945068359375, 0.914844274520874, 0.08393049240112305, 1.5162460803985596, 0.10743057727813721, 1.4277915954589844, 1.5675599575042725, 0.44634437561035156, 2.0139834880828857, 0.012137770652770996, 0.6624038219451904, 0.657723069190979, 0.6878597736358643, 0.023749709129333496, 2.035888671875, 0.9612696170806885, 0.6514184474945068, 0.2223811149597168, 0.024928808212280273, 1.5850322246551514, 0.8146969079971313, 1.4909381866455078, 0.4407620429992676, 0.5120521783828735, 0.3954615592956543, 0.7060872316360474, 0.48299694061279297, 0.4120670557022095, 0.8999717235565186, 0.5690208673477173, 0.21571850776672363, 0.26853275299072266, 0.8258200883865356, 1.5828605890274048, 0.6273636817932129, 1.288510799407959, 0.6511224508285522, 0.7911986112594604, 1.4174044132232666, 0.7230952978134155, 0.6892086267471313, 0.5825859308242798, 0.23442697525024414, 0.6468262672424316, 0.13365018367767334, 0.9869405031204224, 0.1259458065032959, 0.8564969301223755, 0.6926320791244507, 1.1526621580123901], "mean_td_error": 0.7660841941833496, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 100.0, "diff_num_grad_updates_vs_sampler_policy": 99.0}}, "num_env_steps_sampled": 90496, "num_env_steps_trained": 25800, "num_agent_steps_sampled": 271488, "num_agent_steps_trained": 25800, "last_target_update_ts": 90496, "num_target_updates": 100}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 271488, "num_agent_steps_trained": 25800, "num_env_steps_sampled": 90496, "num_env_steps_trained": 25800, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 951.8229573657317, "num_env_steps_trained_throughput_per_sec": 274.07402120575756, "timesteps_total": 90496, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 271488, "timers": {"training_iteration_time_ms": 958.385, "sample_time_ms": 675.514, "load_time_ms": 0.314, "load_throughput": 821538.439, "learn_time_ms": 17.884, "learn_throughput": 14426.309, "synch_weights_time_ms": 9.718}, "counters": {"num_env_steps_sampled": 90496, "num_env_steps_trained": 25800, "num_agent_steps_sampled": 271488, "num_agent_steps_trained": 25800, "last_target_update_ts": 90496, "num_target_updates": 100}, "done": false, "episodes_total": 0, "training_iteration": 58, "trial_id": "cfa97_00000", "date": "2023-11-18_21-04-07", "timestamp": 1700370247, "time_this_iter_s": 1.8902578353881836, "time_total_s": 100.2886471748352, "pid": 6770, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17f309a80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 100.2886471748352, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 64.56666666666666, "ram_util_percent": 65.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.038115501403809, "actor_loss": -8.563996315002441, "critic_loss": 0.1831595003604889, "alpha_loss": -0.3039143979549408, "alpha_value": 0.9701777100563049, "log_alpha_value": -0.030276041477918625, "target_entropy": -6.0, "policy_t": -0.06080241501331329, "mean_q": 4.482668876647949, "max_q": 4.953981399536133, "min_q": 2.2328834533691406}, "td_error": [1.0049586296081543, 0.7573041915893555, 1.8929383754730225, 0.25307130813598633, 0.3995542526245117, 1.3622901439666748, 1.1079399585723877, 0.19078803062438965, 1.8235118389129639, 1.1495342254638672, 1.615330696105957, 0.636462926864624, 0.03983163833618164, 2.217667579650879, 0.6407122611999512, 0.5786685943603516, 3.1439056396484375, 1.8896691799163818, 1.247086524963379, 0.4772772789001465, 0.8614199161529541, 0.4997243881225586, 0.15411877632141113, 1.3551430702209473, 0.43416929244995117, 0.8049089908599854, 3.0311310291290283, 1.785029649734497, 0.8533265590667725, 0.13853216171264648, 0.5857453346252441, 1.443631649017334, 1.3351993560791016, 0.21213078498840332, 0.027074813842773438, 0.4910440444946289, 0.7971625328063965, 0.34414219856262207, 1.0281047821044922, 0.39716625213623047, 0.9229307174682617, 1.4824934005737305, 0.45406150817871094, 0.8355100154876709, 1.3566155433654785, 1.1146087646484375, 1.0403978824615479, 0.5642738342285156, 0.8812575340270996, 0.5810246467590332, 1.305860996246338, 1.4321916103363037, 1.1578223705291748, 2.4309377670288086, 0.5518710613250732, 1.5914545059204102, 0.5608596801757812, 2.1630570888519287, 2.7365121841430664, 0.9281446933746338, 0.9191150665283203, 0.39200472831726074, 2.007728099822998, 0.4836103916168213, 3.3356761932373047, 0.11923885345458984, 2.1590218544006348, 0.05624580383300781, 2.2213072776794434, 0.3965137004852295, 0.37459588050842285, 1.401322603225708, 1.5538482666015625, 0.22592568397521973, 1.2353055477142334, 0.34302663803100586, 0.4688279628753662, 1.0934984683990479, 1.4182138442993164, 1.3416271209716797, 0.6426267623901367, 1.841047763824463, 1.1050851345062256, 0.36034631729125977, 0.854433536529541, 1.033818244934082], "mean_td_error": 1.0521315336227417, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 102.0, "diff_num_grad_updates_vs_sampler_policy": 101.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.00079345703125, "actor_loss": -6.623405933380127, "critic_loss": 0.18734312057495117, "alpha_loss": -0.30292102694511414, "alpha_value": 0.97016441822052, "log_alpha_value": -0.030289703980088234, "target_entropy": -6.0, "policy_t": -0.09109695255756378, "mean_q": 2.6965181827545166, "max_q": 3.0277161598205566, "min_q": 2.613795757293701}, "td_error": [0.7471296787261963, 0.46685028076171875, 0.4497361183166504, 1.4818317890167236, 0.14727306365966797, 0.0170058012008667, 0.1965237855911255, 0.9753270149230957, 0.423076868057251, 0.22792387008666992, 1.0456079244613647, 0.41348588466644287, 0.6922827959060669, 2.7323508262634277, 0.5810408592224121, 2.2903175354003906, 0.169905424118042, 0.6785581111907959, 0.5738886594772339, 1.1515839099884033, 1.0033504962921143, 0.23014020919799805, 0.6617518663406372, 0.3009612560272217, 2.051879405975342, 1.0150790214538574, 1.2718125581741333, 2.4614086151123047, 1.5320804119110107, 2.0721564292907715, 1.1225769519805908, 0.5195268392562866, 0.5854120254516602, 0.23833203315734863, 0.5451211929321289, 0.5662600994110107, 1.0387967824935913, 1.426355242729187, 1.3388774394989014, 1.5115320682525635, 1.4412535429000854, 2.0317084789276123, 0.3349182605743408, 0.206024169921875, 0.24409258365631104, 0.29574155807495117, 1.001988172531128, 1.5378879308700562, 1.389683723449707, 0.7786502838134766, 2.522317409515381, 0.7317290306091309, 0.5907399654388428, 0.9936177730560303, 1.622705340385437, 0.8794368505477905, 0.37980806827545166, 0.13713836669921875, 0.664284348487854, 0.5443780422210693, 0.8523820638656616, 0.4189610481262207, 0.5836225748062134, 1.8176367282867432, 0.3607604503631592, 1.4581427574157715, 1.1543673276901245, 0.19270730018615723, 1.408740520477295, 0.9922544956207275, 3.1857054233551025, 2.542721748352051, 0.8158293962478638, 0.3247767686843872, 0.818346381187439, 0.5277856588363647, 0.09050929546356201, 1.923155426979065, 0.9692906141281128, 1.5917067527770996, 0.9028874635696411, 1.6229499578475952, 1.4374998807907104, 0.7975095510482788, 1.275621771812439, 1.5657769441604614], "mean_td_error": 0.9873821139335632, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 102.0, "diff_num_grad_updates_vs_sampler_policy": 101.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.117751121520996, "actor_loss": -6.660058975219727, "critic_loss": 0.10809880495071411, "alpha_loss": -0.3066374361515045, "alpha_value": 0.9701477885246277, "log_alpha_value": -0.030306873843073845, "target_entropy": -6.0, "policy_t": -0.04284561425447464, "mean_q": 2.630725383758545, "max_q": 3.3653202056884766, "min_q": 2.1379811763763428}, "td_error": [1.7778189182281494, 0.3248981237411499, 0.19149911403656006, 0.13792455196380615, 0.41710495948791504, 1.6985054016113281, 0.9451642036437988, 0.48041725158691406, 1.7376855611801147, 1.133819818496704, 1.0089304447174072, 0.9540801048278809, 1.2720575332641602, 0.6754393577575684, 1.6866848468780518, 1.4015369415283203, 0.6942824125289917, 1.4763779640197754, 0.24633574485778809, 0.8641704320907593, 0.11584532260894775, 0.4713171720504761, 0.9740060567855835, 1.691967487335205, 1.4404536485671997, 0.12186384201049805, 1.3431057929992676, 1.6510342359542847, 2.6023519039154053, 1.7589688301086426, 0.15674185752868652, 1.1489977836608887, 1.4363408088684082, 0.1241687536239624, 1.3907994031906128, 0.8215078115463257, 1.9774751663208008, 0.6254045963287354, 0.1544475555419922, 0.8567110300064087, 0.512846827507019, 0.05838322639465332, 0.500220537185669, 2.2053112983703613, 1.6405953168869019, 0.20017170906066895, 0.6025934219360352, 0.2892475128173828, 0.38054561614990234, 0.04725027084350586, 1.6697160005569458, 0.4559924602508545, 1.9371674060821533, 1.175443172454834, 0.2326369285583496, 0.8992797136306763, 0.2637525796890259, 1.8604803085327148, 0.035627126693725586, 1.0227382183074951, 0.040673255920410156, 0.5815591812133789, 1.3044875860214233, 0.32884860038757324, 0.9650696516036987, 0.35445141792297363, 1.4379363059997559, 0.009934782981872559, 0.4730050563812256, 0.04486513137817383, 1.7981984615325928, 0.4825258255004883, 0.35158586502075195, 0.13384485244750977, 2.2385177612304688, 0.6762077808380127, 0.8237612247467041, 0.9090907573699951, 1.324876070022583, 2.3393442630767822, 0.5753663778305054, 0.9017001390457153, 0.05009925365447998, 0.7425038814544678, 0.2623279094696045, 0.8325698375701904], "mean_td_error": 0.8832743167877197, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 102.0, "diff_num_grad_updates_vs_sampler_policy": 101.0}}, "num_env_steps_sampled": 92288, "num_env_steps_trained": 26316, "num_agent_steps_sampled": 276864, "num_agent_steps_trained": 26316, "last_target_update_ts": 92288, "num_target_updates": 102}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 276864, "num_agent_steps_trained": 26316, "num_env_steps_sampled": 92288, "num_env_steps_trained": 26316, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 934.5760996623501, "num_env_steps_trained_throughput_per_sec": 269.1078501259892, "timesteps_total": 92288, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 276864, "timers": {"training_iteration_time_ms": 950.093, "sample_time_ms": 673.966, "load_time_ms": 0.312, "load_throughput": 826179.899, "learn_time_ms": 17.77, "learn_throughput": 14519.18, "synch_weights_time_ms": 9.555}, "counters": {"num_env_steps_sampled": 92288, "num_env_steps_trained": 26316, "num_agent_steps_sampled": 276864, "num_agent_steps_trained": 26316, "last_target_update_ts": 92288, "num_target_updates": 102}, "done": false, "episodes_total": 0, "training_iteration": 59, "trial_id": "cfa97_00000", "date": "2023-11-18_21-04-09", "timestamp": 1700370249, "time_this_iter_s": 1.9278209209442139, "time_total_s": 102.21646809577942, "pid": 6770, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17f308400>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 102.21646809577942, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 78.35, "ram_util_percent": 65.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.967512130737305, "actor_loss": -8.568880081176758, "critic_loss": 0.16236959397792816, "alpha_loss": -0.3076936602592468, "alpha_value": 0.9696019291877747, "log_alpha_value": -0.030869659036397934, "target_entropy": -6.0, "policy_t": -0.09611271321773529, "mean_q": 4.6222639083862305, "max_q": 4.954293251037598, "min_q": 3.729480266571045}, "td_error": [0.9354450702667236, 0.22797250747680664, 1.1053617000579834, 0.2676513195037842, 0.582942008972168, 0.8907070159912109, 0.6612339019775391, 1.0709178447723389, 2.499810218811035, 0.1262977123260498, 0.015236377716064453, 0.0897514820098877, 2.0111141204833984, 1.3556222915649414, 1.3345575332641602, 1.4898433685302734, 0.49498581886291504, 1.0217134952545166, 0.38385820388793945, 0.9432756900787354, 1.3634428977966309, 0.2809004783630371, 1.2382044792175293, 1.609510898590088, 0.9709045886993408, 0.4879720211029053, 0.8732314109802246, 0.9037666320800781, 0.15346336364746094, 1.1693243980407715, 0.9404535293579102, 0.07403552532196045, 2.018214702606201, 1.8294732570648193, 1.7252402305603027, 0.8372595310211182, 1.2130379676818848, 1.1057467460632324, 1.12900710105896, 0.164581298828125, 2.1176469326019287, 0.07743453979492188, 2.237943410873413, 0.4364781379699707, 0.16404151916503906, 0.1832141876220703, 1.085439682006836, 0.1313152313232422, 0.3574380874633789, 1.780409574508667, 2.0433967113494873, 2.36689829826355, 0.4605131149291992, 0.8382716178894043, 0.8847391605377197, 2.5779166221618652, 0.7972254753112793, 1.2713253498077393, 0.8645014762878418, 1.4892492294311523, 0.3013739585876465, 0.50152587890625, 0.8890714645385742, 0.2832217216491699, 0.33703136444091797, 1.8308501243591309, 0.6468207836151123, 0.5686626434326172, 0.6034095287322998, 1.3245604038238525, 1.3844008445739746, 1.1213774681091309, 1.501274824142456, 0.30440330505371094, 0.07885050773620605, 1.3391802310943604, 0.34584879875183105, 0.6393959522247314, 1.2555956840515137, 1.7856371402740479, 0.9653060436248779, 1.5096714496612549, 0.22284603118896484, 1.3176977634429932, 0.8024101257324219, 1.0507206916809082], "mean_td_error": 0.9613094925880432, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 104.0, "diff_num_grad_updates_vs_sampler_policy": 103.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.100569725036621, "actor_loss": -6.644829273223877, "critic_loss": 0.14447495341300964, "alpha_loss": -0.31198394298553467, "alpha_value": 0.9695844054222107, "log_alpha_value": -0.030887756496667862, "target_entropy": -6.0, "policy_t": -0.031666647642850876, "mean_q": 2.70872163772583, "max_q": 4.069656848907471, "min_q": 2.1909141540527344}, "td_error": [0.5449802875518799, 1.8798125982284546, 1.5672717094421387, 0.6288843154907227, 1.674606204032898, 0.29488277435302734, 0.4436178207397461, 0.8540403842926025, 0.08292686939239502, 1.19425630569458, 1.953748106956482, 1.5187091827392578, 0.017786741256713867, 1.8090711832046509, 0.1002277135848999, 0.36269044876098633, 0.977130651473999, 1.0425978899002075, 0.5101339817047119, 0.8718873262405396, 0.07038354873657227, 1.2818535566329956, 1.3722960948944092, 0.7748857736587524, 0.4223247766494751, 1.1430436372756958, 2.889113187789917, 1.5531197786331177, 0.13777399063110352, 0.8056460618972778, 0.7159985303878784, 1.478567123413086, 0.43224596977233887, 0.11580443382263184, 0.013856649398803711, 0.7842527627944946, 0.3048287630081177, 0.25766849517822266, 2.828402280807495, 0.3549981117248535, 1.9191105365753174, 1.3346396684646606, 0.260495662689209, 1.3879259824752808, 1.2071257829666138, 1.316431999206543, 1.7037297487258911, 1.0075278282165527, 0.8691370487213135, 1.300844669342041, 0.7702622413635254, 2.3284714221954346, 0.6458897590637207, 0.19679665565490723, 0.9053201675415039, 0.8691748380661011, 0.527864933013916, 0.2809333801269531, 0.6930876970291138, 1.3287372589111328, 0.23608613014221191, 1.1806137561798096, 1.0490742921829224, 2.1680667400360107, 0.35650157928466797, 0.7510284185409546, 0.9816361665725708, 0.8807699680328369, 0.23315775394439697, 0.3731034994125366, 0.7446674108505249, 1.299916386604309, 0.4122917652130127, 0.7391196489334106, 0.6028096675872803, 0.013081908226013184, 1.3929495811462402, 1.067288875579834, 0.3281947374343872, 0.2220320701599121, 0.28592753410339355, 0.21833324432373047, 1.186678409576416, 0.2876394987106323, 1.38413667678833, 1.063328504562378], "mean_td_error": 0.8881193399429321, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 104.0, "diff_num_grad_updates_vs_sampler_policy": 103.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.060887336730957, "actor_loss": -6.57304573059082, "critic_loss": 0.09811300784349442, "alpha_loss": -0.3109454810619354, "alpha_value": 0.9695663452148438, "log_alpha_value": -0.03090636245906353, "target_entropy": -6.0, "policy_t": -0.009097553789615631, "mean_q": 2.6449968814849854, "max_q": 2.708926200866699, "min_q": 2.21182918548584}, "td_error": [1.6948792934417725, 1.3526362180709839, 0.21383535861968994, 1.8992244005203247, 0.31205618381500244, 1.2878886461257935, 0.7543505430221558, 1.2107584476470947, 1.1656324863433838, 1.4949620962142944, 0.04904592037200928, 0.4193460941314697, 1.8079415559768677, 0.7311955690383911, 0.8568403720855713, 0.48462045192718506, 0.9836339950561523, 0.547438383102417, 1.7284941673278809, 0.5196856260299683, 2.6483044624328613, 1.9355788230895996, 0.9568638801574707, 0.828716516494751, 0.5280182361602783, 0.06960856914520264, 0.36108458042144775, 0.40286290645599365, 1.2781785726547241, 1.0748625993728638, 0.9681490659713745, 0.48291218280792236, 0.49380040168762207, 0.697776198387146, 0.6433614492416382, 0.9191254377365112, 1.9395623207092285, 0.16061198711395264, 0.14809930324554443, 0.2666189670562744, 0.6600286960601807, 1.3172037601470947, 0.306943416595459, 0.45479607582092285, 1.7381489276885986, 1.2727181911468506, 0.07038354873657227, 0.26916754245758057, 0.6060566902160645, 2.186549425125122, 1.5447814464569092, 0.5995824337005615, 0.614978551864624, 0.6673163175582886, 0.0436406135559082, 0.7698135375976562, 0.9667150974273682, 0.2942863702774048, 0.867857813835144, 0.21924161911010742, 0.31322693824768066, 0.6223040819168091, 1.4840861558914185, 0.7871586084365845, 0.25945281982421875, 2.3681232929229736, 0.46474432945251465, 1.2608528137207031, 0.9001293182373047, 1.1845086812973022, 0.7903083562850952, 0.7935839891433716, 1.8617674112319946, 0.5907585620880127, 0.08959639072418213, 1.6739696264266968, 1.563630223274231, 0.40684545040130615, 1.1586564779281616, 0.06452178955078125, 0.4314504861831665, 0.3881101608276367, 0.14393258094787598, 0.0722496509552002, 0.4147380590438843, 0.7347240447998047], "mean_td_error": 0.844327986240387, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 104.0, "diff_num_grad_updates_vs_sampler_policy": 103.0}}, "num_env_steps_sampled": 94080, "num_env_steps_trained": 26832, "num_agent_steps_sampled": 282240, "num_agent_steps_trained": 26832, "last_target_update_ts": 94080, "num_target_updates": 104}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 282240, "num_agent_steps_trained": 26832, "num_env_steps_sampled": 94080, "num_env_steps_trained": 26832, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 956.9893916448667, "num_env_steps_trained_throughput_per_sec": 275.5616775048835, "timesteps_total": 94080, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 282240, "timers": {"training_iteration_time_ms": 946.059, "sample_time_ms": 669.565, "load_time_ms": 0.312, "load_throughput": 827000.712, "learn_time_ms": 17.829, "learn_throughput": 14470.796, "synch_weights_time_ms": 9.651}, "counters": {"num_env_steps_sampled": 94080, "num_env_steps_trained": 26832, "num_agent_steps_sampled": 282240, "num_agent_steps_trained": 26832, "last_target_update_ts": 94080, "num_target_updates": 104}, "done": false, "episodes_total": 0, "training_iteration": 60, "trial_id": "cfa97_00000", "date": "2023-11-18_21-04-11", "timestamp": 1700370251, "time_this_iter_s": 1.8821241855621338, "time_total_s": 104.09859228134155, "pid": 6770, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17f30b100>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 104.09859228134155, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 70.93333333333334, "ram_util_percent": 65.63333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.027432441711426, "actor_loss": -8.618489265441895, "critic_loss": 0.1700248271226883, "alpha_loss": -0.31549912691116333, "alpha_value": 0.9690262079238892, "log_alpha_value": -0.03146360069513321, "target_entropy": -6.0, "policy_t": -0.08873999863862991, "mean_q": 4.593010902404785, "max_q": 4.955618858337402, "min_q": 2.3864240646362305}, "td_error": [4.611662864685059, 0.5728399753570557, 0.6748867034912109, 0.08299112319946289, 1.1230502128601074, 2.0833330154418945, 0.588641881942749, 1.1603844165802002, 0.6879568099975586, 0.3637731075286865, 1.1611034870147705, 0.3273833990097046, 0.3134896755218506, 0.06616091728210449, 0.03883242607116699, 1.586719036102295, 0.3528168201446533, 1.8742523193359375, 2.043800115585327, 0.759911298751831, 0.27283477783203125, 0.7438552379608154, 0.835474967956543, 1.384610891342163, 0.639599084854126, 1.1728286743164062, 1.2070682048797607, 0.03867387771606445, 0.4361598491668701, 1.5786046981811523, 0.6082057952880859, 1.9127516746520996, 1.189742088317871, 3.4007771015167236, 2.233670711517334, 0.6734063625335693, 0.40189623832702637, 1.0929596424102783, 0.6805214881896973, 1.0552328824996948, 0.6844005584716797, 0.831204891204834, 1.0433714389801025, 1.5159506797790527, 0.25481653213500977, 0.9342727661132812, 0.42122721672058105, 1.9307711124420166, 0.16543340682983398, 1.4729642868041992, 1.3212552070617676, 1.0641827583312988, 0.4691634178161621, 1.2722883224487305, 0.21813321113586426, 0.35078001022338867, 1.0058836936950684, 1.1586360931396484, 2.042076826095581, 0.07302355766296387, 0.18600106239318848, 1.4430644512176514, 0.6062731742858887, 0.025651216506958008, 0.6196720600128174, 0.8268978595733643, 1.2399473190307617, 0.7626497745513916, 0.3739614486694336, 0.7511177062988281, 0.578787088394165, 0.10529327392578125, 1.3483011722564697, 2.046873092651367, 0.1841282844543457, 0.7194352149963379, 0.2283036708831787, 0.40069031715393066, 1.8627946376800537, 1.2604005336761475, 2.499734401702881, 0.11336731910705566, 3.3140907287597656, 2.036527156829834, 0.0746450424194336, 0.8998453617095947], "mean_td_error": 0.9857110977172852, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 106.0, "diff_num_grad_updates_vs_sampler_policy": 105.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.021757125854492, "actor_loss": -6.591284275054932, "critic_loss": 0.12404601275920868, "alpha_loss": -0.3155468702316284, "alpha_value": 0.9690043330192566, "log_alpha_value": -0.031486183404922485, "target_entropy": -6.0, "policy_t": -0.07088539749383926, "mean_q": 2.676778554916382, "max_q": 3.6391544342041016, "min_q": 2.174462080001831}, "td_error": [0.413928747177124, 0.4163846969604492, 0.28079140186309814, 0.509162187576294, 0.5123782157897949, 0.6452956199645996, 1.4981119632720947, 0.8911030292510986, 0.5208585262298584, 1.0755290985107422, 0.0626063346862793, 2.568861722946167, 1.4253753423690796, 0.533205509185791, 0.8936175107955933, 1.5040395259857178, 0.4179328680038452, 0.011552691459655762, 0.1050269603729248, 0.1981046199798584, 0.4429081678390503, 2.0651166439056396, 0.9882984161376953, 2.3321404457092285, 1.5765089988708496, 0.46163618564605713, 3.253469467163086, 0.9741109609603882, 1.5867607593536377, 0.8424072265625, 0.9272241592407227, 1.8886196613311768, 0.24703562259674072, 1.1556620597839355, 0.371624231338501, 0.5084737539291382, 0.4912298917770386, 0.7970067262649536, 0.046150803565979004, 0.7337497472763062, 0.29589617252349854, 0.4339172840118408, 0.8506731986999512, 0.7874703407287598, 1.29371178150177, 0.041954636573791504, 0.8184658288955688, 0.350935697555542, 0.2781715393066406, 0.8522064685821533, 1.1918351650238037, 0.7721916437149048, 0.841982364654541, 0.43396449089050293, 0.08490419387817383, 0.050191402435302734, 0.986020565032959, 0.6045094728469849, 1.3301520347595215, 0.33944666385650635, 0.32973945140838623, 0.6082299947738647, 0.7091543674468994, 0.2885175943374634, 0.023963212966918945, 0.4445517063140869, 0.6171690225601196, 2.3413567543029785, 0.9657762050628662, 0.0801548957824707, 1.4429867267608643, 0.1561652421951294, 0.5877348184585571, 1.215408444404602, 0.0979691743850708, 1.319666862487793, 1.2732685804367065, 1.5042452812194824, 0.6454657316207886, 1.2493860721588135, 0.28307461738586426, 0.14465832710266113, 0.8577780723571777, 1.3824150562286377, 0.2918931245803833, 1.391510009765625], "mean_td_error": 0.8030795454978943, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 106.0, "diff_num_grad_updates_vs_sampler_policy": 105.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.114961624145508, "actor_loss": -6.626775741577148, "critic_loss": 0.10325678437948227, "alpha_loss": -0.3186813294887543, "alpha_value": 0.9689851999282837, "log_alpha_value": -0.03150593489408493, "target_entropy": -6.0, "policy_t": -0.004138699732720852, "mean_q": 2.6622159481048584, "max_q": 3.45180082321167, "min_q": 2.2579798698425293}, "td_error": [0.1302628517150879, 1.048914909362793, 0.24694740772247314, 1.115715503692627, 2.073357105255127, 1.7867202758789062, 0.1019129753112793, 0.545384407043457, 0.159873366355896, 0.3810919523239136, 0.9678947925567627, 0.5003790855407715, 0.7135188579559326, 1.0553104877471924, 0.04103362560272217, 0.44383275508880615, 1.8323081731796265, 0.5776994228363037, 0.9767946004867554, 0.29736149311065674, 2.1427464485168457, 0.46288764476776123, 1.689717173576355, 0.856453537940979, 1.3273036479949951, 0.045507192611694336, 1.3987232446670532, 0.06489074230194092, 0.23638999462127686, 2.644153356552124, 1.5135618448257446, 0.20574164390563965, 1.157419204711914, 1.370456337928772, 0.4983329772949219, 0.6379702091217041, 1.5243960618972778, 1.1666926145553589, 1.0263222455978394, 0.40174055099487305, 1.0907407999038696, 0.8683865070343018, 0.3646339178085327, 0.2815093994140625, 0.9302905797958374, 0.09790873527526855, 1.3734315633773804, 0.3232158422470093, 0.17350733280181885, 0.9029884338378906, 1.6133381128311157, 0.101226806640625, 1.7886011600494385, 2.2572977542877197, 1.2927982807159424, 1.8345080614089966, 0.6678255796432495, 1.0732765197753906, 0.93034827709198, 1.2146368026733398, 1.0194880962371826, 1.0807774066925049, 1.1599785089492798, 1.5911204814910889, 2.168867588043213, 0.1790856122970581, 0.28839564323425293, 0.5143533945083618, 0.3838934898376465, 0.3384469747543335, 0.36974668502807617, 0.5199474096298218, 1.5443847179412842, 0.997039794921875, 1.7237660884857178, 0.8843655586242676, 0.9011257886886597, 0.21734356880187988, 0.5481187105178833, 0.21013212203979492, 0.8993959426879883, 0.6472876071929932, 0.43407928943634033, 1.0438870191574097, 1.0161038637161255, 0.21618878841400146], "mean_td_error": 0.8772733807563782, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 106.0, "diff_num_grad_updates_vs_sampler_policy": 105.0}}, "num_env_steps_sampled": 95872, "num_env_steps_trained": 27348, "num_agent_steps_sampled": 287616, "num_agent_steps_trained": 27348, "last_target_update_ts": 95872, "num_target_updates": 106}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 287616, "num_agent_steps_trained": 27348, "num_env_steps_sampled": 95872, "num_env_steps_trained": 27348, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 921.4100949435057, "num_env_steps_trained_throughput_per_sec": 265.31674608864336, "timesteps_total": 95872, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 287616, "timers": {"training_iteration_time_ms": 953.402, "sample_time_ms": 678.825, "load_time_ms": 0.313, "load_throughput": 824354.713, "learn_time_ms": 17.937, "learn_throughput": 14383.529, "synch_weights_time_ms": 9.621}, "counters": {"num_env_steps_sampled": 95872, "num_env_steps_trained": 27348, "num_agent_steps_sampled": 287616, "num_agent_steps_trained": 27348, "last_target_update_ts": 95872, "num_target_updates": 106}, "done": false, "episodes_total": 0, "training_iteration": 61, "trial_id": "cfa97_00000", "date": "2023-11-18_21-04-13", "timestamp": 1700370253, "time_this_iter_s": 1.9550459384918213, "time_total_s": 106.05363821983337, "pid": 6770, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17f30aca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 106.05363821983337, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 63.23333333333333, "ram_util_percent": 65.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.03982162475586, "actor_loss": -8.597757339477539, "critic_loss": 0.13416200876235962, "alpha_loss": -0.3218594789505005, "alpha_value": 0.968450129032135, "log_alpha_value": -0.03205828741192818, "target_entropy": -6.0, "policy_t": -0.08065633475780487, "mean_q": 4.617189884185791, "max_q": 4.9615983963012695, "min_q": 2.361938953399658}, "td_error": [0.16553640365600586, 4.141234874725342, 1.455531120300293, 0.9578733444213867, 2.3086695671081543, 0.4137706756591797, 2.7504961490631104, 1.8342032432556152, 0.882056474685669, 1.2883601188659668, 0.5267236232757568, 0.14334607124328613, 0.22704410552978516, 0.0990135669708252, 0.6384820938110352, 0.3273646831512451, 0.7678930759429932, 0.3186485767364502, 0.8111116886138916, 0.29743075370788574, 0.7484967708587646, 1.941338062286377, 1.083988904953003, 0.27885866165161133, 0.8206219673156738, 0.10154867172241211, 0.9305644035339355, 0.6992588043212891, 2.0794484615325928, 1.0257644653320312, 0.06300687789916992, 2.3965914249420166, 0.37076807022094727, 0.15259742736816406, 0.12813997268676758, 0.573707103729248, 0.056400299072265625, 1.6292145252227783, 2.8314452171325684, 0.16448545455932617, 1.9145643711090088, 0.38506650924682617, 0.558845043182373, 0.3228340148925781, 0.03349614143371582, 0.8628993034362793, 0.3756551742553711, 0.159043550491333, 0.5181365013122559, 1.72267484664917, 0.5078065395355225, 0.09600114822387695, 1.151155710220337, 0.7874128818511963, 1.0948238372802734, 1.103222370147705, 0.38228917121887207, 0.07895517349243164, 0.3101992607116699, 0.8375835418701172, 0.32305026054382324, 1.5800230503082275, 0.04680657386779785, 0.2098839282989502, 1.0380966663360596, 0.5467100143432617, 0.554175853729248, 1.4916753768920898, 0.8627016544342041, 0.6573085784912109, 0.9250640869140625, 1.208289384841919, 0.8119375705718994, 0.1542520523071289, 0.13403534889221191, 0.19916582107543945, 1.0062456130981445, 0.8079268932342529, 0.3161787986755371, 1.4160423278808594, 0.6532728672027588, 0.9250390529632568, 0.26017332077026367, 0.9503684043884277, 0.828596830368042, 0.9641621112823486], "mean_td_error": 0.81982421875, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 108.0, "diff_num_grad_updates_vs_sampler_policy": 107.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.091794967651367, "actor_loss": -6.6128830909729, "critic_loss": 0.13207238912582397, "alpha_loss": -0.32379114627838135, "alpha_value": 0.9684246778488159, "log_alpha_value": -0.032084591686725616, "target_entropy": -6.0, "policy_t": -0.01137143187224865, "mean_q": 2.6506004333496094, "max_q": 2.773386001586914, "min_q": 2.1537094116210938}, "td_error": [0.749516487121582, 1.7919148206710815, 1.5693715810775757, 0.12417829036712646, 1.2072134017944336, 1.5777502059936523, 0.9337339401245117, 1.2589794397354126, 1.8461800813674927, 0.029619216918945312, 0.06960868835449219, 0.2278752326965332, 0.5267928838729858, 0.8226665258407593, 1.0682505369186401, 1.770642876625061, 1.3595612049102783, 0.2395031452178955, 0.15621531009674072, 1.1748192310333252, 0.9791125059127808, 0.8238574266433716, 0.8831723928451538, 1.0972689390182495, 0.986037015914917, 0.6443289518356323, 0.29678571224212646, 0.21884608268737793, 0.800656795501709, 0.7195010185241699, 0.3105424642562866, 0.26254236698150635, 0.8392385244369507, 2.5510990619659424, 0.31295204162597656, 0.8344230651855469, 0.551708459854126, 0.021759748458862305, 0.753288745880127, 2.839130163192749, 0.8027276992797852, 0.2632637023925781, 0.012827873229980469, 0.4606053829193115, 1.531128168106079, 0.2864651679992676, 1.515663743019104, 0.004904985427856445, 1.2954312562942505, 0.4825533628463745, 0.7574807405471802, 0.46819639205932617, 1.217367172241211, 0.6630314588546753, 0.7872720956802368, 0.5640816688537598, 0.4141784906387329, 0.8566381931304932, 0.6948544979095459, 0.42344439029693604, 1.1522462368011475, 0.8216434717178345, 0.26930785179138184, 1.292479395866394, 0.09931695461273193, 0.7551850080490112, 3.3750624656677246, 0.8168803453445435, 0.12791478633880615, 0.6351851224899292, 0.18571734428405762, 0.9417548179626465, 1.5266447067260742, 1.4366141557693481, 0.6378186941146851, 0.9598379135131836, 0.0797954797744751, 0.7510144710540771, 0.9037295579910278, 0.5703632831573486, 0.6973925828933716, 0.46179115772247314, 1.37934410572052, 1.0361582040786743, 0.7354065179824829, 2.1382904052734375], "mean_td_error": 0.8432517647743225, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 108.0, "diff_num_grad_updates_vs_sampler_policy": 107.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.100027084350586, "actor_loss": -6.637279987335205, "critic_loss": 0.09856607764959335, "alpha_loss": -0.32426920533180237, "alpha_value": 0.9684041142463684, "log_alpha_value": -0.03210577741265297, "target_entropy": -6.0, "policy_t": -0.020004162564873695, "mean_q": 2.6989970207214355, "max_q": 3.3880815505981445, "min_q": 2.2722926139831543}, "td_error": [0.47376489639282227, 0.6860899925231934, 0.06893348693847656, 0.09153127670288086, 0.3517247438430786, 0.893844485282898, 0.1582791805267334, 2.12821888923645, 0.1474529504776001, 2.5947930812835693, 1.5593069791793823, 0.14916753768920898, 0.5804051160812378, 0.04585576057434082, 0.11442995071411133, 0.6464368104934692, 1.4486415386199951, 1.7630517482757568, 0.286537766456604, 0.6033657789230347, 0.965057373046875, 0.3811509609222412, 1.2055764198303223, 1.6436091661453247, 0.1935666799545288, 0.5360863208770752, 0.2853536605834961, 0.6555421352386475, 1.6584328413009644, 1.6279369592666626, 0.28009653091430664, 0.5220553874969482, 0.5534366369247437, 0.04871988296508789, 0.2572154998779297, 0.4687931537628174, 0.6114661693572998, 2.349670886993408, 2.062224864959717, 0.2247450351715088, 0.02239251136779785, 1.4064785242080688, 0.26141297817230225, 0.5136781930923462, 1.0691633224487305, 0.028996706008911133, 0.07713484764099121, 1.7039259672164917, 0.13821196556091309, 0.7670180797576904, 0.4198012351989746, 1.7885175943374634, 3.8009936809539795, 1.650407075881958, 0.5748196840286255, 0.2584552764892578, 0.5287880897521973, 1.249383807182312, 0.4880467653274536, 0.33031725883483887, 1.6158106327056885, 1.8563170433044434, 1.6656756401062012, 0.8714219331741333, 0.45010828971862793, 0.7931467294692993, 1.285376787185669, 0.005153179168701172, 0.9071038961410522, 0.29646825790405273, 0.2811911106109619, 0.1614471673965454, 0.0380396842956543, 0.6452919244766235, 0.31211698055267334, 1.7446142435073853, 0.9084712266921997, 0.07273232936859131, 0.28902268409729004, 1.3353776931762695, 0.6630107164382935, 0.9942505359649658, 0.10663914680480957, 2.2726263999938965, 0.9815081357955933, 1.1618436574935913], "mean_td_error": 0.8152939677238464, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 108.0, "diff_num_grad_updates_vs_sampler_policy": 107.0}}, "num_env_steps_sampled": 97664, "num_env_steps_trained": 27864, "num_agent_steps_sampled": 292992, "num_agent_steps_trained": 27864, "last_target_update_ts": 97664, "num_target_updates": 108}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 292992, "num_agent_steps_trained": 27864, "num_env_steps_sampled": 97664, "num_env_steps_trained": 27864, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 939.6336807780208, "num_env_steps_trained_throughput_per_sec": 270.56416254545684, "timesteps_total": 97664, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 292992, "timers": {"training_iteration_time_ms": 952.44, "sample_time_ms": 679.8, "load_time_ms": 0.316, "load_throughput": 816332.553, "learn_time_ms": 17.903, "learn_throughput": 14410.997, "synch_weights_time_ms": 9.671}, "counters": {"num_env_steps_sampled": 97664, "num_env_steps_trained": 27864, "num_agent_steps_sampled": 292992, "num_agent_steps_trained": 27864, "last_target_update_ts": 97664, "num_target_updates": 108}, "done": false, "episodes_total": 0, "training_iteration": 62, "trial_id": "cfa97_00000", "date": "2023-11-18_21-04-15", "timestamp": 1700370255, "time_this_iter_s": 1.9152331352233887, "time_total_s": 107.96887135505676, "pid": 6770, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17f3096c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 107.96887135505676, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 64.96666666666667, "ram_util_percent": 65.76666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.97758674621582, "actor_loss": -8.584136009216309, "critic_loss": 0.15523655712604523, "alpha_loss": -0.32580578327178955, "alpha_value": 0.9678736329078674, "log_alpha_value": -0.03265376761555672, "target_entropy": -6.0, "policy_t": -0.09570419788360596, "mean_q": 4.576125621795654, "max_q": 4.956055641174316, "min_q": 2.508340358734131}, "td_error": [1.6092309951782227, 0.10657453536987305, 0.01897454261779785, 1.9693584442138672, 1.6216976642608643, 1.8667995929718018, 0.2880697250366211, 0.10661602020263672, 1.809992790222168, 2.105085611343384, 0.6354038715362549, 1.5173850059509277, 0.46984100341796875, 0.5568840503692627, 0.26024460792541504, 0.9279634952545166, 1.5784385204315186, 1.0341637134552002, 2.1045663356781006, 0.3394966125488281, 1.5754237174987793, 1.0481770038604736, 0.2376270294189453, 0.8805410861968994, 0.2863478660583496, 1.0896053314208984, 0.10869121551513672, 1.3753912448883057, 2.1040399074554443, 1.6048429012298584, 0.9801962375640869, 0.3573305606842041, 0.8069922924041748, 0.6461565494537354, 0.13719534873962402, 1.0077002048492432, 0.03003859519958496, 0.5776190757751465, 0.45449090003967285, 1.1938481330871582, 0.3342113494873047, 1.2483563423156738, 0.3665432929992676, 1.7138850688934326, 1.2432410717010498, 1.3782644271850586, 1.7032580375671387, 0.07651615142822266, 0.5272202491760254, 1.5427532196044922, 0.6036098003387451, 1.264871597290039, 1.3733627796173096, 0.39626264572143555, 1.1151857376098633, 0.9587750434875488, 1.7702805995941162, 0.1508932113647461, 0.6500668525695801, 0.5507829189300537, 1.0614302158355713, 0.5312356948852539, 2.043259620666504, 2.3057234287261963, 0.39911866188049316, 0.57688307762146, 0.15468835830688477, 0.5357804298400879, 2.690406084060669, 0.3018336296081543, 0.4945542812347412, 0.1876659393310547, 1.068249225616455, 0.9927780628204346, 0.49780941009521484, 0.25005030632019043, 1.2209398746490479, 0.5276703834533691, 1.6354079246520996, 1.4263980388641357, 0.35472536087036133, 0.10580039024353027, 2.8427813053131104, 0.602513313293457, 0.448777437210083, 0.04545736312866211], "mean_td_error": 0.9267363548278809, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 110.0, "diff_num_grad_updates_vs_sampler_policy": 109.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.099390029907227, "actor_loss": -6.618804931640625, "critic_loss": 0.1336781084537506, "alpha_loss": -0.33008214831352234, "alpha_value": 0.9678449630737305, "log_alpha_value": -0.03268337994813919, "target_entropy": -6.0, "policy_t": -0.0035425613168627024, "mean_q": 2.6490495204925537, "max_q": 2.8626537322998047, "min_q": 2.134371280670166}, "td_error": [0.10718011856079102, 0.049455881118774414, 0.6598362922668457, 1.7719416618347168, 0.9183740615844727, 1.4628310203552246, 0.45548176765441895, 0.5287232398986816, 1.0686558485031128, 0.4670144319534302, 0.23430824279785156, 0.46436166763305664, 1.6961170434951782, 2.2051198482513428, 0.2477107048034668, 1.1404482126235962, 0.9013599157333374, 0.4787646532058716, 0.20817279815673828, 1.1805181503295898, 1.051439881324768, 0.4756288528442383, 0.2297292947769165, 0.3621079921722412, 1.6074087619781494, 1.4696800708770752, 1.3729974031448364, 1.105416178703308, 0.2362205982208252, 0.5769929885864258, 0.9461910724639893, 0.35566020011901855, 0.9981236457824707, 0.5897786617279053, 1.3818718194961548, 1.25653076171875, 0.8860934972763062, 0.3983873128890991, 1.16187584400177, 0.14556801319122314, 0.6169764995574951, 0.12253928184509277, 1.2070484161376953, 0.08473467826843262, 0.440097451210022, 0.7504760026931763, 3.3474364280700684, 0.12970638275146484, 0.025804519653320312, 1.2129077911376953, 0.7700248956680298, 1.710724949836731, 0.02268397808074951, 1.2546851634979248, 0.390910267829895, 0.7073366641998291, 0.4943404197692871, 0.5071581602096558, 0.5564144849777222, 0.7698972225189209, 0.5138405561447144, 0.5628383159637451, 0.32897496223449707, 1.2182339429855347, 1.4379397630691528, 2.5552663803100586, 0.14301204681396484, 0.12491226196289062, 2.3082165718078613, 1.158508539199829, 0.24179601669311523, 1.1124728918075562, 1.6546803712844849, 0.2261369228363037, 1.6929113864898682, 0.6402443647384644, 2.2681775093078613, 0.5203191041946411, 1.5540060997009277, 0.5878865718841553, 2.1145715713500977, 1.137346863746643, 1.425390601158142, 0.6135226488113403, 0.20149445533752441, 0.09275519847869873], "mean_td_error": 0.8652492761611938, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 110.0, "diff_num_grad_updates_vs_sampler_policy": 109.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.054902076721191, "actor_loss": -6.600557327270508, "critic_loss": 0.09086064994335175, "alpha_loss": -0.32885321974754333, "alpha_value": 0.9678232669830322, "log_alpha_value": -0.03270576521754265, "target_entropy": -6.0, "policy_t": 0.0004909103154204786, "mean_q": 2.7190706729888916, "max_q": 3.484821319580078, "min_q": 2.666914463043213}, "td_error": [1.1192346811294556, 1.6768032312393188, 2.824732542037964, 0.33125150203704834, 1.3291791677474976, 1.4208165407180786, 0.6772695779800415, 1.2296841144561768, 0.2138667106628418, 1.1175274848937988, 0.23276400566101074, 0.6585590839385986, 0.6999436616897583, 0.6037135124206543, 0.900348424911499, 0.07770037651062012, 0.6206893920898438, 2.6250507831573486, 0.6150102615356445, 1.2516688108444214, 0.3441596031188965, 0.5681130886077881, 0.11037158966064453, 1.1623578071594238, 1.1836174726486206, 1.7724969387054443, 0.34693264961242676, 0.9913469552993774, 0.6159377098083496, 0.07691740989685059, 0.33289992809295654, 0.291878342628479, 1.3119361400604248, 0.1661376953125, 0.3226163387298584, 0.004064798355102539, 0.9835546016693115, 0.4613640308380127, 1.7061233520507812, 0.22187209129333496, 2.7861719131469727, 0.46913743019104004, 2.4406700134277344, 0.5493924617767334, 0.39368951320648193, 1.2546803951263428, 0.9499756097793579, 0.7154941558837891, 0.8957433700561523, 0.13803398609161377, 1.4909212589263916, 0.21630394458770752, 0.46305906772613525, 0.02292919158935547, 0.8385626077651978, 0.15738999843597412, 0.1475456953048706, 0.5443607568740845, 0.15264570713043213, 0.3510587215423584, 0.6969170570373535, 1.7059463262557983, 1.2275108098983765, 0.38779520988464355, 0.8692378997802734, 1.539605736732483, 0.8474311828613281, 0.26036572456359863, 0.5896886587142944, 0.7012530565261841, 0.5079187154769897, 0.6200011968612671, 0.3265955448150635, 1.3743562698364258, 0.9539029598236084, 0.46209943294525146, 1.9361886978149414, 0.6566355228424072, 0.699945330619812, 0.14985430240631104, 0.48294365406036377, 0.2340867519378662, 0.0030826330184936523, 2.665647268295288, 0.5325145721435547, 0.04984307289123535], "mean_td_error": 0.7983680367469788, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 110.0, "diff_num_grad_updates_vs_sampler_policy": 109.0}}, "num_env_steps_sampled": 99456, "num_env_steps_trained": 28380, "num_agent_steps_sampled": 298368, "num_agent_steps_trained": 28380, "last_target_update_ts": 99456, "num_target_updates": 110}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 298368, "num_agent_steps_trained": 28380, "num_env_steps_sampled": 99456, "num_env_steps_trained": 28380, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 905.1835807570807, "num_env_steps_trained_throughput_per_sec": 260.6443792804987, "timesteps_total": 99456, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 298368, "timers": {"training_iteration_time_ms": 962.141, "sample_time_ms": 691.732, "load_time_ms": 0.316, "load_throughput": 815348.427, "learn_time_ms": 17.902, "learn_throughput": 14412.034, "synch_weights_time_ms": 9.742}, "counters": {"num_env_steps_sampled": 99456, "num_env_steps_trained": 28380, "num_agent_steps_sampled": 298368, "num_agent_steps_trained": 28380, "last_target_update_ts": 99456, "num_target_updates": 110}, "done": false, "episodes_total": 0, "training_iteration": 63, "trial_id": "cfa97_00000", "date": "2023-11-18_21-04-17", "timestamp": 1700370257, "time_this_iter_s": 1.987429141998291, "time_total_s": 109.95630049705505, "pid": 6770, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17f28e160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 109.95630049705505, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 76.1, "ram_util_percent": 65.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.064774513244629, "actor_loss": -8.520359992980957, "critic_loss": 0.1299946904182434, "alpha_loss": -0.3346501290798187, "alpha_value": 0.9672970771789551, "log_alpha_value": -0.0332496352493763, "target_entropy": -6.0, "policy_t": -0.016911014914512634, "mean_q": 4.610336780548096, "max_q": 4.961862087249756, "min_q": 2.4826512336730957}, "td_error": [1.1103320121765137, 2.615957736968994, 0.8864209651947021, 1.1171848773956299, 1.858447551727295, 0.21476221084594727, 1.0164828300476074, 1.882948875427246, 1.4547312259674072, 0.47936272621154785, 0.6120123863220215, 0.30538153648376465, 1.294814109802246, 1.6106517314910889, 1.6919595003128052, 0.634263277053833, 0.09025001525878906, 0.09576058387756348, 0.7221386432647705, 1.3359413146972656, 0.7480785846710205, 0.11305665969848633, 0.18022537231445312, 1.0867555141448975, 0.5973167419433594, 1.7944495677947998, 0.34119749069213867, 0.10628652572631836, 0.8855361938476562, 0.8912477493286133, 0.38202714920043945, 1.7209007740020752, 0.4214355945587158, 0.15817594528198242, 2.158787250518799, 1.5601859092712402, 1.0086030960083008, 0.8411784172058105, 1.2907459735870361, 0.9151554107666016, 0.09755516052246094, 0.4534280300140381, 0.19040489196777344, 0.3607773780822754, 0.3817324638366699, 0.5337450504302979, 0.15305256843566895, 1.4744486808776855, 0.1843433380126953, 1.4763426780700684, 0.594062089920044, 1.2166962623596191, 0.3259928226470947, 0.704601526260376, 1.8432834148406982, 1.4367332458496094, 0.06253886222839355, 2.0456383228302, 0.689579963684082, 0.3516063690185547, 1.0533571243286133, 0.5916836261749268, 0.8350460529327393, 1.0825486183166504, 0.677772045135498, 0.2330925464630127, 0.17213106155395508, 0.3100466728210449, 0.3392829895019531, 0.07249212265014648, 0.7606544494628906, 1.9438810348510742, 0.7618579864501953, 0.19890117645263672, 0.44307947158813477, 0.8834969997406006, 0.025577545166015625, 0.757932186126709, 0.9476969242095947, 0.7707953453063965, 0.5806558132171631, 1.4468700885772705, 1.0249595642089844, 0.04699563980102539, 0.724799394607544, 1.404886245727539], "mean_td_error": 0.8243976831436157, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 112.0, "diff_num_grad_updates_vs_sampler_policy": 111.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.075584411621094, "actor_loss": -6.5906500816345215, "critic_loss": 0.14478684961795807, "alpha_loss": -0.33534127473831177, "alpha_value": 0.9672651886940002, "log_alpha_value": -0.0332825630903244, "target_entropy": -6.0, "policy_t": -0.041347719728946686, "mean_q": 2.6245696544647217, "max_q": 2.762340545654297, "min_q": 2.1098155975341797}, "td_error": [1.4595743417739868, 0.3185291290283203, 0.37903308868408203, 2.7724545001983643, 0.8237134218215942, 0.25296294689178467, 1.0974853038787842, 0.5109905004501343, 0.48570311069488525, 1.2855257987976074, 0.44507312774658203, 0.30911779403686523, 0.3169667720794678, 0.5658737421035767, 1.7594534158706665, 0.5399630069732666, 0.5957603454589844, 0.16305863857269287, 0.8603872060775757, 0.0897977352142334, 0.48568570613861084, 1.1063926219940186, 1.5993444919586182, 1.165612816810608, 1.507617473602295, 1.791156530380249, 2.3945252895355225, 2.042506456375122, 2.8549585342407227, 0.40218472480773926, 0.9089667797088623, 0.13196921348571777, 2.281543254852295, 0.6586076021194458, 2.2361321449279785, 1.638503909111023, 1.8962286710739136, 1.0782155990600586, 0.12389636039733887, 0.3238484859466553, 1.5380065441131592, 0.556955099105835, 2.229189872741699, 1.2013638019561768, 1.2068877220153809, 0.6818625926971436, 1.8242563009262085, 0.21276068687438965, 0.4621257781982422, 1.8385872840881348, 0.4414064884185791, 1.1448911428451538, 1.347272515296936, 0.5499796867370605, 0.480053186416626, 0.639407753944397, 0.4131048917770386, 0.5955229997634888, 0.03615689277648926, 1.1904881000518799, 0.22370290756225586, 1.0744991302490234, 0.949371337890625, 1.474388599395752, 0.5756620168685913, 0.26782119274139404, 0.1414114236831665, 0.5354918241500854, 0.8376685380935669, 1.0846363306045532, 0.6003214120864868, 0.3304469585418701, 0.31949663162231445, 0.06807851791381836, 0.597053050994873, 1.4055960178375244, 0.13229894638061523, 0.4261223077774048, 0.011669158935546875, 0.6090641021728516, 1.0394823551177979, 0.6471552848815918, 1.4453840255737305, 0.5834598541259766, 1.0580029487609863, 2.1605021953582764], "mean_td_error": 0.9168417453765869, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 112.0, "diff_num_grad_updates_vs_sampler_policy": 111.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.03182601928711, "actor_loss": -6.614255905151367, "critic_loss": 0.11180433630943298, "alpha_loss": -0.3341144621372223, "alpha_value": 0.9672430753707886, "log_alpha_value": -0.03330545127391815, "target_entropy": -6.0, "policy_t": -0.04681025445461273, "mean_q": 2.7049500942230225, "max_q": 2.7415823936462402, "min_q": 2.3697128295898438}, "td_error": [1.0521600246429443, 0.8485360145568848, 1.5946820974349976, 0.6194379329681396, 0.6529009342193604, 0.7739787101745605, 0.8666441440582275, 1.2789392471313477, 1.0353749990463257, 2.5650296211242676, 1.8922085762023926, 0.569960355758667, 1.6384446620941162, 0.4393119812011719, 1.155008316040039, 0.6887456178665161, 0.6901025772094727, 1.8966100215911865, 0.239113450050354, 1.7830333709716797, 0.44489598274230957, 1.5835751295089722, 0.1622101068496704, 0.3296247720718384, 0.0543367862701416, 0.3509255647659302, 1.075537919998169, 0.7245672941207886, 0.41972804069519043, 2.0572824478149414, 0.546605110168457, 0.8514750003814697, 1.2728952169418335, 0.5869758129119873, 0.1940314769744873, 0.4288499355316162, 2.7314016819000244, 2.305493116378784, 0.07145857810974121, 0.3870350122451782, 1.524656891822815, 0.252954363822937, 0.1975116729736328, 0.14366579055786133, 0.6094790697097778, 1.2321357727050781, 1.277931571006775, 0.4032477140426636, 1.1749274730682373, 0.7108479738235474, 0.13450026512145996, 0.26201367378234863, 1.0083850622177124, 1.560529351234436, 0.4719674587249756, 0.5962013006210327, 1.204857587814331, 0.16400575637817383, 0.8775665760040283, 1.5168699026107788, 1.1929421424865723, 1.8654826879501343, 0.45098960399627686, 1.252124309539795, 0.978759765625, 1.9022784233093262, 1.052526593208313, 2.001574993133545, 0.2948169708251953, 0.8279323577880859, 2.1989259719848633, 0.7764571905136108, 1.0213901996612549, 0.7735137939453125, 1.823888897895813, 0.4746748208999634, 0.5537575483322144, 0.0770035982131958, 0.4859098196029663, 0.5561856031417847, 0.5923616886138916, 0.14224791526794434, 0.6779463291168213, 0.8832067251205444, 0.8300255537033081, 2.433960437774658], "mean_td_error": 0.9337705373764038, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 112.0, "diff_num_grad_updates_vs_sampler_policy": 111.0}}, "num_env_steps_sampled": 101248, "num_env_steps_trained": 28896, "num_agent_steps_sampled": 303744, "num_agent_steps_trained": 28896, "last_target_update_ts": 101248, "num_target_updates": 112}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 303744, "num_agent_steps_trained": 28896, "num_env_steps_sampled": 101248, "num_env_steps_trained": 28896, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 980.2450690672925, "num_env_steps_trained_throughput_per_sec": 282.25806676268024, "timesteps_total": 101248, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 303744, "timers": {"training_iteration_time_ms": 953.213, "sample_time_ms": 681.341, "load_time_ms": 0.318, "load_throughput": 810523.88, "learn_time_ms": 17.928, "learn_throughput": 14391.295, "synch_weights_time_ms": 9.889}, "counters": {"num_env_steps_sampled": 101248, "num_env_steps_trained": 28896, "num_agent_steps_sampled": 303744, "num_agent_steps_trained": 28896, "last_target_update_ts": 101248, "num_target_updates": 112}, "done": true, "episodes_total": 0, "training_iteration": 64, "trial_id": "cfa97_00000", "date": "2023-11-18_21-04-19", "timestamp": 1700370259, "time_this_iter_s": 1.837148904800415, "time_total_s": 111.79344940185547, "pid": 6770, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17f3d4540>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 111.79344940185547, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 69.23333333333333, "ram_util_percent": 65.83333333333333}}
