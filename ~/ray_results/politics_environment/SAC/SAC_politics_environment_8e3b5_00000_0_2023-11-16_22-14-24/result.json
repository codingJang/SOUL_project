{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 896, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2688, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2688, "num_agent_steps_trained": 0, "num_env_steps_sampled": 896, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 304.08277571419995, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 896, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2688, "timers": {"training_iteration_time_ms": 2946.53, "sample_time_ms": 1455.787}, "counters": {"num_env_steps_sampled": 896, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2688, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 1, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-14-44", "timestamp": 1700201684, "time_this_iter_s": 2.951040029525757, "time_total_s": 2.951040029525757, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8c884d040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 2.951040029525757, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 56.38000000000001, "ram_util_percent": 90.56000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.08365249633789, "actor_loss": -4.082467079162598, "critic_loss": 5.016901016235352, "alpha_loss": 0.0, "alpha_value": 1.0, "log_alpha_value": 0.0, "target_entropy": -6.0, "policy_t": 0.016977060586214066, "mean_q": -0.0013718277914449573, "max_q": 0.003513655625283718, "min_q": -0.004059815313667059}, "td_error": [3.2867093086242676, 6.631065845489502, 4.691880226135254, 4.5498762130737305, 6.252780914306641, 5.7313690185546875, 4.385553359985352, 3.686094284057617, 6.309879302978516, 5.4303483963012695, 4.0688652992248535, 5.331314563751221, 6.9359941482543945, 7.094934463500977, 7.204440116882324, 6.669574737548828, 7.366238594055176, 5.467779159545898, 4.386334419250488, 5.055719375610352, 5.558346748352051, 6.291067123413086, 7.14748477935791, 7.067619323730469, 5.572831630706787, 4.996102333068848, 4.0000104904174805, 4.489108085632324, 5.283103942871094, 3.930640459060669, 6.25527286529541, 6.95461893081665, 5.139590263366699, 4.669866561889648, 5.886185169219971, 4.311315536499023, 6.730390548706055, 6.620327949523926, 4.424079895019531, 4.98480224609375, 5.244477272033691, 4.863236427307129, 5.091248512268066, 5.752190113067627, 6.236850738525391, 4.908912658691406, 4.265922546386719, 6.651042938232422, 4.4362688064575195, 6.15631103515625, 5.9820051193237305, 8.402382850646973, 5.654931545257568, 6.435176849365234, 4.1006669998168945, 6.090878486633301, 6.646069526672363, 5.5777482986450195, 4.8785858154296875, 4.506720066070557, 5.282364368438721, 6.866331100463867, 4.5521345138549805, 4.353391170501709, 6.7356977462768555, 4.911338806152344, 7.298374652862549, 7.039427280426025, 5.099733829498291, 3.8407750129699707, 5.293162822723389, 4.703700065612793, 3.2186460494995117, 5.735088348388672, 5.710121154785156, 5.908249855041504, 5.638319492340088, 5.769259452819824, 4.711705684661865, 2.7829651832580566, 6.322056770324707, 2.951113224029541, 6.031148910522461, 7.22983455657959, 4.9048919677734375, 8.83252239227295], "mean_td_error": 5.516901016235352, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1.0, "diff_num_grad_updates_vs_sampler_policy": 0.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.04389476776123, "actor_loss": -4.0437517166137695, "critic_loss": 3.0418176651000977, "alpha_loss": 0.0, "alpha_value": 1.0, "log_alpha_value": 0.0, "target_entropy": -6.0, "policy_t": 0.049025364220142365, "mean_q": 0.0005014898488298059, "max_q": 0.003453909419476986, "min_q": -0.0024760214146226645}, "td_error": [3.0942580699920654, 1.9159722328186035, 5.173159599304199, 2.3182568550109863, 4.6397318840026855, 4.514289855957031, 3.2310774326324463, 1.8312156200408936, 3.790316104888916, 6.176209449768066, 3.4158592224121094, 4.519779205322266, 5.246903896331787, 2.645031213760376, 2.2213807106018066, 4.749792098999023, 2.133877754211426, 3.160034656524658, 3.2667059898376465, 2.7819771766662598, 3.664217710494995, 3.8404250144958496, 1.466444730758667, 3.485074043273926, 2.8687744140625, 4.908092498779297, 3.28556489944458, 3.494642496109009, 3.9651451110839844, 4.781182765960693, 2.3439903259277344, 4.5553460121154785, 4.112933158874512, 3.769080638885498, 3.7309722900390625, 5.97262716293335, 4.22802734375, 2.919144868850708, 3.4624757766723633, 4.781964302062988, 4.712099075317383, 3.5157322883605957, 4.181110382080078, 4.553127288818359, 4.626853942871094, 2.65836238861084, 1.4039099216461182, 3.414641857147217, 3.934561252593994, 2.950784206390381, 3.3014440536499023, 3.6832761764526367, 1.907804012298584, 3.593193531036377, 2.3355283737182617, 3.4549341201782227, 4.55134916305542, 3.38108491897583, 1.598813772201538, 4.61334228515625, 3.287041187286377, 2.6894359588623047, 3.6964502334594727, 5.794676780700684, 3.2987070083618164, 3.44407320022583, 2.5790109634399414, 3.2650861740112305, 3.042435646057129, 2.932063579559326, 3.8992538452148438, 2.606184959411621, 3.383317470550537, 2.487558364868164, 3.7338356971740723, 2.9254002571105957, 2.2992069721221924, 3.2975964546203613, 5.631546974182129, 3.9843151569366455, 4.42438268661499, 1.945165753364563, 3.9021382331848145, 2.953731060028076, 2.939455986022949, 5.32036018371582], "mean_td_error": 3.5418179035186768, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1.0, "diff_num_grad_updates_vs_sampler_policy": 0.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.016789436340332, "actor_loss": -4.015366077423096, "critic_loss": 2.9352006912231445, "alpha_loss": 0.0, "alpha_value": 1.0, "log_alpha_value": 0.0, "target_entropy": -6.0, "policy_t": -0.005309197120368481, "mean_q": -0.0007279419805854559, "max_q": 0.0015428322367370129, "min_q": -0.0031665535643696785}, "td_error": [2.688636302947998, 1.8583425283432007, 4.64703369140625, 3.096919059753418, 3.475036144256592, 2.8190677165985107, 2.5080840587615967, 1.780887484550476, 5.223029136657715, 3.0955281257629395, 2.583932399749756, 5.460481643676758, 4.365477561950684, 4.01535177230835, 3.35117769241333, 4.501201629638672, 3.9272348880767822, 5.348078727722168, 3.7586889266967773, 4.8257951736450195, 0.9857441782951355, 3.3483328819274902, 4.863770484924316, 5.025824069976807, 2.078172445297241, 2.7294869422912598, 3.6010913848876953, 3.439730167388916, 3.5000898838043213, 3.481626510620117, 3.793731927871704, 3.2967259883880615, 4.046051979064941, 3.9850046634674072, 4.02282190322876, 3.5382192134857178, 3.2691266536712646, 4.1868577003479, 6.451241970062256, 3.2703919410705566, 3.5478248596191406, 2.3196558952331543, 1.6223561763763428, 4.1515045166015625, 3.9846765995025635, 2.8985486030578613, 4.851861000061035, 4.099339485168457, 4.457618713378906, 3.8370113372802734, 4.014796257019043, 1.1910256147384644, 0.8989405632019043, 2.29630708694458, 4.547125816345215, 2.942171335220337, 1.6362172365188599, 3.2209694385528564, 1.2781713008880615, 4.6346330642700195, 4.917889595031738, 1.855473279953003, 3.6216535568237305, 2.9217870235443115, 4.738814830780029, 1.9806644916534424, 4.49482536315918, 2.7285051345825195, 5.078957557678223, 2.821899175643921, 2.9544568061828613, 1.73634672164917, 2.6840317249298096, 6.224918842315674, 3.1851048469543457, 1.864213228225708, 2.6883788108825684, 3.601807117462158, 2.7258963584899902, 2.9068968296051025, 4.701589584350586, 1.7377570867538452, 2.8252577781677246, 4.076986789703369, 3.8846511840820312, 3.7884976863861084], "mean_td_error": 3.4351401329040527, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1.0, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 1792, "num_env_steps_trained": 258, "num_agent_steps_sampled": 5376, "num_agent_steps_trained": 258, "last_target_update_ts": 1792, "num_target_updates": 1}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5376, "num_agent_steps_trained": 258, "num_env_steps_sampled": 1792, "num_env_steps_trained": 258, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 354.62160061969433, "num_env_steps_trained_throughput_per_sec": 102.11202339272448, "timesteps_total": 1792, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 5376, "timers": {"training_iteration_time_ms": 2736.561, "sample_time_ms": 1599.608, "load_time_ms": 0.527, "load_throughput": 489651.779, "learn_time_ms": 93.411, "learn_throughput": 2761.988, "synch_weights_time_ms": 15.226}, "counters": {"num_env_steps_sampled": 1792, "num_env_steps_trained": 258, "num_agent_steps_sampled": 5376, "num_agent_steps_trained": 258, "last_target_update_ts": 1792, "num_target_updates": 1}, "done": false, "episodes_total": 0, "training_iteration": 2, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-14-47", "timestamp": 1700201687, "time_this_iter_s": 2.5455620288848877, "time_total_s": 5.4966020584106445, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8c89aaca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 5.4966020584106445, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 79.53333333333332, "ram_util_percent": 90.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.112826347351074, "actor_loss": -4.122897148132324, "critic_loss": 4.968733787536621, "alpha_loss": -0.0030338475480675697, "alpha_value": 0.9997000694274902, "log_alpha_value": -0.00029999998514540493, "target_entropy": -6.0, "policy_t": 0.014147073030471802, "mean_q": 0.0114340391010046, "max_q": 0.014741655439138412, "min_q": 0.009011158719658852}, "td_error": [7.134421348571777, 6.180188179016113, 6.121191024780273, 5.481252670288086, 4.220420837402344, 3.7581710815429688, 4.433586597442627, 6.307328224182129, 6.036166667938232, 6.036328315734863, 4.323775291442871, 7.083727836608887, 5.388240814208984, 5.420937538146973, 3.7956109046936035, 4.2699971199035645, 5.230708122253418, 6.155097484588623, 4.383060455322266, 6.035200119018555, 7.439934730529785, 6.661053657531738, 7.249492645263672, 3.745785713195801, 4.135140419006348, 5.668534278869629, 4.680943489074707, 5.752237796783447, 6.665224552154541, 4.989894390106201, 5.014962196350098, 4.994194030761719, 5.60896110534668, 5.128073692321777, 5.2205047607421875, 7.610265731811523, 5.649157524108887, 4.636663913726807, 5.766040802001953, 5.756025314331055, 6.556032180786133, 6.585757255554199, 6.079989433288574, 3.692101001739502, 6.172905921936035, 6.119772434234619, 6.101402282714844, 5.523268222808838, 3.5513596534729004, 5.84355354309082, 6.148428440093994, 5.653181076049805, 7.015833854675293, 6.127146244049072, 8.46190357208252, 6.064595699310303, 6.526364803314209, 5.83954381942749, 5.413135528564453, 5.878408432006836, 5.682441234588623, 4.669635772705078, 6.290004730224609, 5.71720027923584, 4.939924240112305, 7.967378616333008, 6.798146724700928, 5.543868541717529, 2.944044589996338, 6.425450325012207, 5.622408866882324, 5.1564788818359375, 5.016375541687012, 5.868014335632324, 7.295807838439941, 6.73028039932251, 5.2984089851379395, 5.532410621643066, 4.871753692626953, 6.335221290588379, 4.204787254333496, 6.092162609100342, 1.6806871891021729, 5.405151844024658, 5.007939338684082, 4.498273849487305], "mean_td_error": 5.594388961791992, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 2.0, "diff_num_grad_updates_vs_sampler_policy": 1.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.046148300170898, "actor_loss": -4.060161590576172, "critic_loss": 2.87864351272583, "alpha_loss": -0.003013844368979335, "alpha_value": 0.9997000694274902, "log_alpha_value": -0.0003000000142492354, "target_entropy": -6.0, "policy_t": 0.010655578225851059, "mean_q": 0.015100396238267422, "max_q": 0.020229822024703026, "min_q": 0.010711455717682838}, "td_error": [3.084911346435547, 2.130807876586914, 3.877169132232666, 4.159386157989502, 4.01387882232666, 2.883279323577881, 6.1193928718566895, 3.3461904525756836, 1.7098735570907593, 2.9687294960021973, 4.089474201202393, 4.108773231506348, 4.105504035949707, 2.4145960807800293, 3.143767833709717, 4.582858562469482, 3.1856091022491455, 3.921175479888916, 3.0044431686401367, 2.8336596488952637, 4.798713684082031, 4.153460502624512, 4.243251323699951, 1.9151959419250488, 4.567365646362305, 3.2770869731903076, 4.223536014556885, 4.236136436462402, 2.929332733154297, 2.576125144958496, 2.701570987701416, 2.01235294342041, 3.5499117374420166, 3.8875694274902344, 4.424208641052246, 1.5700514316558838, 2.89532208442688, 2.659952163696289, 2.6225104331970215, 3.489128589630127, 6.18466854095459, 3.6304924488067627, 3.225217819213867, 3.773752212524414, 2.0680904388427734, 2.1797776222229004, 4.554909706115723, 2.233985185623169, 2.488495349884033, 3.624830722808838, 3.116844654083252, 4.538270950317383, 5.261787414550781, 4.744907379150391, 4.931606292724609, 2.792628288269043, 2.432072877883911, 3.8438527584075928, 1.3701061010360718, 2.5551671981811523, 3.101449489593506, 3.118365526199341, 2.691401720046997, 4.381375312805176, 3.8782753944396973, 5.175727844238281, 2.602227210998535, 3.156646251678467, 4.725446701049805, 4.451211929321289, 3.436336040496826, 4.966159343719482, 4.528876304626465, 3.378401756286621, 1.0067942142486572, 4.156734466552734, 3.015460729598999, 2.0594582557678223, 2.435074806213379, 4.473966598510742, 5.031912803649902, 6.007793426513672, 2.1427364349365234, 1.751837968826294, 1.937204360961914, 4.033836364746094], "mean_td_error": 3.4606096744537354, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 2.0, "diff_num_grad_updates_vs_sampler_policy": 1.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.066301345825195, "actor_loss": -4.07765007019043, "critic_loss": 3.210383415222168, "alpha_loss": -0.0030198905151337385, "alpha_value": 0.9997000694274902, "log_alpha_value": -0.0003000000142492354, "target_entropy": -6.0, "policy_t": -0.016811640933156013, "mean_q": 0.013518041931092739, "max_q": 0.01791919395327568, "min_q": 0.010621773079037666}, "td_error": [3.908534049987793, 3.376345157623291, 3.8938403129577637, 4.792344570159912, 3.7523250579833984, 4.3861083984375, 5.34238862991333, 2.70231294631958, 2.640711784362793, 3.7961270809173584, 2.6527137756347656, 6.092565536499023, 2.047208786010742, 2.1628966331481934, 5.1814422607421875, 3.8342227935791016, 6.70913028717041, 3.52992582321167, 3.5893874168395996, 3.8268003463745117, 3.58268404006958, 3.8839640617370605, 4.830696105957031, 5.260617256164551, 4.091665267944336, 3.474195957183838, 4.2927446365356445, 3.3792665004730225, 4.031591415405273, 2.306710720062256, 3.007596254348755, 2.22361421585083, 4.256417274475098, 1.9202642440795898, 2.6748504638671875, 5.6286725997924805, 4.133853912353516, 3.276459217071533, 2.731922149658203, 3.984663724899292, 5.854555130004883, 4.277435302734375, 3.3533899784088135, 2.0163486003875732, 3.0476372241973877, 3.402376651763916, 3.9645795822143555, 3.064171075820923, 5.169044494628906, 4.975519180297852, 3.725968837738037, 3.973073959350586, 2.8532185554504395, 3.7185137271881104, 5.427491664886475, 4.571174621582031, 4.750311374664307, 3.8424158096313477, 4.124537944793701, 2.524747848510742, 3.2936277389526367, 2.521472215652466, 6.690842628479004, 4.059742450714111, 3.9378480911254883, 3.1088509559631348, 1.4533534049987793, 5.830173492431641, 2.8288052082061768, 5.530261993408203, 5.2009663581848145, 3.6392951011657715, 4.104279041290283, 4.229516506195068, 3.321251392364502, 3.3349087238311768, 2.723766803741455, 4.6011152267456055, 5.140514850616455, 3.1549999713897705, 2.9644289016723633, 4.587887287139893, 4.490971088409424, 3.0771188735961914, 3.127368927001953, 3.455465316772461], "mean_td_error": 3.8399431705474854, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 2.0, "diff_num_grad_updates_vs_sampler_policy": 1.0}}, "num_env_steps_sampled": 2688, "num_env_steps_trained": 516, "num_agent_steps_sampled": 8064, "num_agent_steps_trained": 516, "last_target_update_ts": 2688, "num_target_updates": 2}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8064, "num_agent_steps_trained": 516, "num_env_steps_sampled": 2688, "num_env_steps_trained": 516, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 457.348912491609, "num_env_steps_trained_throughput_per_sec": 131.69198596298563, "timesteps_total": 2688, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 8064, "timers": {"training_iteration_time_ms": 2477.399, "sample_time_ms": 1529.619, "load_time_ms": 0.523, "load_throughput": 492885.644, "learn_time_ms": 79.178, "learn_throughput": 3258.487, "synch_weights_time_ms": 14.877}, "counters": {"num_env_steps_sampled": 2688, "num_env_steps_trained": 516, "num_agent_steps_sampled": 8064, "num_agent_steps_trained": 516, "last_target_update_ts": 2688, "num_target_updates": 2}, "done": false, "episodes_total": 0, "training_iteration": 3, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-14-49", "timestamp": 1700201689, "time_this_iter_s": 1.977095127105713, "time_total_s": 7.473697185516357, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8aa45a9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 7.473697185516357, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 72.36666666666666, "ram_util_percent": 90.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.078859329223633, "actor_loss": -4.1004438400268555, "critic_loss": 4.817521572113037, "alpha_loss": -0.006047539878636599, "alpha_value": 0.9994001388549805, "log_alpha_value": -0.0006000222638249397, "target_entropy": -6.0, "policy_t": -0.02945547364652157, "mean_q": 0.024009017273783684, "max_q": 0.030405962839722633, "min_q": 0.01993260346353054}, "td_error": [4.614568710327148, 5.650609970092773, 2.8826093673706055, 6.974939346313477, 7.040820121765137, 4.638189315795898, 5.439487934112549, 5.440084457397461, 4.783197402954102, 3.999483823776245, 6.492382049560547, 4.892036437988281, 7.089580535888672, 4.468385219573975, 5.471340179443359, 5.939746379852295, 5.840379238128662, 4.819704055786133, 7.008162498474121, 6.109090805053711, 6.7536516189575195, 4.457871437072754, 6.606804847717285, 5.70949649810791, 4.425301551818848, 4.437697410583496, 4.534339904785156, 5.321128845214844, 4.284549713134766, 6.386662006378174, 5.456582069396973, 5.128321647644043, 4.003891944885254, 5.766045570373535, 2.9316325187683105, 5.569324493408203, 5.594570159912109, 5.321120262145996, 3.8292295932769775, 5.790900230407715, 5.950277328491211, 5.758861541748047, 4.9860687255859375, 7.168424129486084, 5.984110355377197, 6.405080795288086, 5.3352556228637695, 6.377269744873047, 7.616886138916016, 5.933965682983398, 6.108209133148193, 5.386753082275391, 4.026243686676025, 6.409724235534668, 3.8029260635375977, 7.403733253479004, 5.736119270324707, 4.776909828186035, 6.3429670333862305, 3.783794403076172, 5.446107387542725, 6.06847620010376, 6.058494567871094, 2.807910919189453, 3.7785942554473877, 4.297303199768066, 4.609700679779053, 6.062932014465332, 7.7722368240356445, 6.270183086395264, 5.9383864402771, 5.591490745544434, 6.412571907043457, 3.0758676528930664, 5.9026198387146, 5.040672779083252, 6.449909210205078, 6.824108600616455, 5.313705921173096, 5.217970371246338, 4.804861068725586, 7.091465950012207, 5.418929100036621, 5.276642322540283, 6.027719497680664, 7.178886890411377], "mean_td_error": 5.487618923187256, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 3.0, "diff_num_grad_updates_vs_sampler_policy": 2.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.092106819152832, "actor_loss": -4.119189262390137, "critic_loss": 3.06315541267395, "alpha_loss": -0.006055282428860664, "alpha_value": 0.9994001984596252, "log_alpha_value": -0.0006000017747282982, "target_entropy": -6.0, "policy_t": -0.02011287957429886, "mean_q": 0.030738892033696175, "max_q": 0.038638658821582794, "min_q": 0.02359127253293991}, "td_error": [2.9355628490448, 4.749202728271484, 3.833372116088867, 5.763739585876465, 2.9205055236816406, 4.246260643005371, 4.402856826782227, 3.9601998329162598, 3.3824801445007324, 4.314250946044922, 4.809157371520996, 4.45451545715332, 2.788585662841797, 2.851799488067627, 1.4194443225860596, 4.30459451675415, 2.51107120513916, 2.9404783248901367, 3.905848979949951, 1.8269462585449219, 3.411505699157715, 5.344018936157227, 3.9595377445220947, 3.084416151046753, 2.7253007888793945, 2.0994272232055664, 2.0544114112854004, 4.306807518005371, 2.820387363433838, 2.6634044647216797, 3.649564743041992, 3.970344305038452, 4.264904022216797, 2.4206361770629883, 3.6035947799682617, 3.966684341430664, 2.776991367340088, 1.639230489730835, 4.101608753204346, 4.580783843994141, 5.292158126831055, 2.3301966190338135, 3.5629849433898926, 2.517761707305908, 4.473733425140381, 2.285632610321045, 1.7385972738265991, 3.217719793319702, 2.8762311935424805, 2.6233644485473633, 3.670860528945923, 2.645132541656494, 5.808295249938965, 2.710249900817871, 4.664542198181152, 4.905963897705078, 4.288578510284424, 5.348058700561523, 4.048872470855713, 5.173016548156738, 3.816244125366211, 3.139852285385132, 4.834198474884033, 3.154670238494873, 2.7494711875915527, 4.135466575622559, 5.850730895996094, 4.252268314361572, 4.065019130706787, 3.919281482696533, 2.9752583503723145, 2.315298557281494, 4.152900695800781, 2.5671396255493164, 3.651390552520752, 4.2960944175720215, 4.625246047973633, 4.457284927368164, 4.671642303466797, 3.8459341526031494, 2.41970157623291, 2.7602548599243164, 4.947503566741943, 4.318886756896973, 2.4700822830200195, 5.355624198913574], "mean_td_error": 3.6476027965545654, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 3.0, "diff_num_grad_updates_vs_sampler_policy": 2.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.029242515563965, "actor_loss": -4.053121566772461, "critic_loss": 2.9994025230407715, "alpha_loss": -0.006017924752086401, "alpha_value": 0.9994001388549805, "log_alpha_value": -0.0006000376888550818, "target_entropy": -6.0, "policy_t": 0.004415591713041067, "mean_q": 0.028172509744763374, "max_q": 0.03461780771613121, "min_q": 0.02306252345442772}, "td_error": [4.93918514251709, 2.910159111022949, 4.424223899841309, 3.9762983322143555, 2.0078134536743164, 3.751326084136963, 2.0133821964263916, 3.252607583999634, 2.20377254486084, 4.6182169914245605, 3.3271114826202393, 2.838076591491699, 3.250093460083008, 4.001676559448242, 3.7084803581237793, 4.731715679168701, 2.253030300140381, 3.069917678833008, 4.180086612701416, 3.0398263931274414, 3.590782642364502, 4.568456649780273, 4.417144298553467, 4.026731967926025, 5.71737003326416, 2.690500497817993, 4.304038047790527, 2.3836987018585205, 2.9921164512634277, 1.2633898258209229, 3.7231736183166504, 3.23368239402771, 4.110264778137207, 3.94534969329834, 3.801849365234375, 3.6187517642974854, 2.9415154457092285, 2.1464316844940186, 3.4238831996917725, 3.925255298614502, 4.13984489440918, 4.782543659210205, 3.0251240730285645, 5.697250843048096, 2.6144371032714844, 4.3644208908081055, 5.597672939300537, 1.672553300857544, 2.6890861988067627, 3.9489102363586426, 2.6129915714263916, 3.906489610671997, 4.541299819946289, 3.6882076263427734, 2.2721896171569824, 5.005889415740967, 2.93670654296875, 2.7679200172424316, 2.385862350463867, 5.511567115783691, 3.6008620262145996, 3.1575961112976074, 4.880460739135742, 4.0441718101501465, 5.256805896759033, 3.8585965633392334, 4.984227180480957, 3.6665830612182617, 5.050462245941162, 4.1920270919799805, 2.9445862770080566, 4.21724796295166, 3.966703414916992, 1.3342902660369873, 1.7935324907302856, 4.300653457641602, 5.391376495361328, 3.087834358215332, 5.026488304138184, 3.872708797454834, 3.4608092308044434, 3.9383339881896973, 4.486098289489746, 2.6281237602233887, 4.1900739669799805, 3.5852417945861816], "mean_td_error": 3.6557939052581787, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 3.0, "diff_num_grad_updates_vs_sampler_policy": 2.0}}, "num_env_steps_sampled": 3584, "num_env_steps_trained": 774, "num_agent_steps_sampled": 10752, "num_agent_steps_trained": 774, "last_target_update_ts": 3584, "num_target_updates": 3}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10752, "num_agent_steps_trained": 774, "num_env_steps_sampled": 3584, "num_env_steps_trained": 774, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 493.0400075043015, "num_env_steps_trained_throughput_per_sec": 141.96910930369395, "timesteps_total": 3584, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 10752, "timers": {"training_iteration_time_ms": 2312.366, "sample_time_ms": 1457.91, "load_time_ms": 0.523, "load_throughput": 493597.582, "learn_time_ms": 74.353, "learn_throughput": 3469.942, "synch_weights_time_ms": 14.981}, "counters": {"num_env_steps_sampled": 3584, "num_env_steps_trained": 774, "num_agent_steps_sampled": 10752, "num_agent_steps_trained": 774, "last_target_update_ts": 3584, "num_target_updates": 3}, "done": false, "episodes_total": 0, "training_iteration": 4, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-14-50", "timestamp": 1700201690, "time_this_iter_s": 1.832157850265503, "time_total_s": 9.30585503578186, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8c8977f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 9.30585503578186, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 62.56666666666667, "ram_util_percent": 90.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.02631664276123, "actor_loss": -4.05957555770874, "critic_loss": 4.704757213592529, "alpha_loss": -0.009023844264447689, "alpha_value": 0.999100387096405, "log_alpha_value": -0.0009000158170238137, "target_entropy": -6.0, "policy_t": -0.027345765382051468, "mean_q": 0.03750987723469734, "max_q": 0.045310571789741516, "min_q": 0.030097581446170807}, "td_error": [6.7573652267456055, 6.625168800354004, 3.9745712280273438, 7.343502044677734, 5.51677942276001, 3.500565528869629, 3.4320220947265625, 5.289587020874023, 3.0171756744384766, 6.775759696960449, 5.461993217468262, 6.959454536437988, 4.692683219909668, 6.8770647048950195, 5.389340400695801, 6.203819274902344, 4.914100170135498, 6.126675128936768, 7.70629358291626, 5.956293106079102, 3.7814254760742188, 5.964046478271484, 4.318037033081055, 4.916449069976807, 6.100153923034668, 3.1397602558135986, 3.9036731719970703, 5.526241302490234, 5.387876510620117, 6.0306196212768555, 6.883718490600586, 4.858201026916504, 4.672233581542969, 5.324237823486328, 4.814374923706055, 7.092738151550293, 6.161433219909668, 6.009735107421875, 4.745562553405762, 5.909653663635254, 7.033170223236084, 4.680105209350586, 5.274183750152588, 6.938366413116455, 5.544919967651367, 6.085817337036133, 5.083712577819824, 4.439797401428223, 4.667121410369873, 5.72627067565918, 6.061244964599609, 4.804098129272461, 6.126977920532227, 6.086170673370361, 5.165901184082031, 5.857290267944336, 4.917267799377441, 7.026637077331543, 7.652834892272949, 4.009518623352051, 7.648688316345215, 5.208359241485596, 6.092839241027832, 6.430627822875977, 6.778219223022461, 5.273653507232666, 6.225693702697754, 4.209505081176758, 3.9051616191864014, 4.299444675445557, 6.6632771492004395, 3.7444374561309814, 4.145210266113281, 5.1521806716918945, 6.505779266357422, 8.426013946533203, 5.408447742462158, 5.072403907775879, 6.612161636352539, 4.002087116241455, 5.906317234039307, 5.388584136962891, 4.982921600341797, 6.388030529022217, 5.598252296447754, 6.506936073303223], "mean_td_error": 5.55601167678833, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 4.0, "diff_num_grad_updates_vs_sampler_policy": 3.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.966468811035156, "actor_loss": -4.009028911590576, "critic_loss": 3.0059828758239746, "alpha_loss": -0.00897033791989088, "alpha_value": 0.9991003274917603, "log_alpha_value": -0.0009000517893582582, "target_entropy": -6.0, "policy_t": -0.02155349962413311, "mean_q": 0.047331005334854126, "max_q": 0.060157034546136856, "min_q": 0.03590922802686691}, "td_error": [5.210724830627441, 3.1006546020507812, 3.701451301574707, 3.36148738861084, 3.52410888671875, 2.6375770568847656, 3.593388557434082, 3.2953271865844727, 3.3868746757507324, 2.7441368103027344, 6.244243621826172, 2.499929904937744, 3.128000259399414, 4.138731956481934, 3.069267749786377, 5.0577521324157715, 4.075566291809082, 1.3414603471755981, 3.262787342071533, 4.186888217926025, 2.7838425636291504, 2.663336992263794, 3.2431044578552246, 4.002535820007324, 2.954089641571045, 3.396735191345215, 2.732938528060913, 2.209522008895874, 3.1915230751037598, 3.893357992172241, 2.764409065246582, 4.099968433380127, 5.500974178314209, 3.887873649597168, 2.424542188644409, 3.9600841999053955, 1.8307790756225586, 5.922611236572266, 3.7122740745544434, 4.963645935058594, 3.5447230339050293, 3.8042211532592773, 2.5186095237731934, 3.496845245361328, 4.800824165344238, 3.5861568450927734, 4.107653617858887, 3.2950439453125, 2.9443020820617676, 5.468371391296387, 3.8230652809143066, 2.5365548133850098, 1.6882827281951904, 3.4891114234924316, 3.4973068237304688, 3.4071617126464844, 3.506012439727783, 5.144868850708008, 3.4752559661865234, 4.673828125, 4.390947341918945, 4.450765609741211, 3.3250136375427246, 3.667983055114746, 3.767460584640503, 3.732822895050049, 3.227475166320801, 3.2834181785583496, 3.2926816940307617, 4.361289024353027, 3.9670305252075195, 4.1013689041137695, 2.7921969890594482, 5.864131927490234, 3.6050596237182617, 2.4221034049987793, 4.557991981506348, 4.094433784484863, 2.0781641006469727, 2.9772000312805176, 1.9289112091064453, 4.1245198249816895, 2.3636224269866943, 2.5363845825195312, 3.2729430198669434, 4.386104583740234], "mean_td_error": 3.5706825256347656, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 4.0, "diff_num_grad_updates_vs_sampler_policy": 3.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.062715530395508, "actor_loss": -4.099412441253662, "critic_loss": 2.893883228302002, "alpha_loss": -0.009056929498910904, "alpha_value": 0.9991003274917603, "log_alpha_value": -0.0009000483551062644, "target_entropy": -6.0, "policy_t": 0.0075109973549842834, "mean_q": 0.04355979710817337, "max_q": 0.0550147220492363, "min_q": 0.03643936663866043}, "td_error": [2.480231761932373, 4.969791412353516, 3.107846260070801, 3.6325950622558594, 2.662022829055786, 2.688366413116455, 4.7851057052612305, 4.692254066467285, 2.0517969131469727, 4.127260208129883, 4.623366355895996, 3.832458019256592, 2.5972819328308105, 4.451642036437988, 4.243108749389648, 5.576252460479736, 3.4474434852600098, 4.287563323974609, 2.1852755546569824, 5.030364036560059, 3.5054445266723633, 3.092459201812744, 3.925487518310547, 3.571786880493164, 1.8021135330200195, 4.359583854675293, 4.580278396606445, 1.444657802581787, 2.1453299522399902, 0.26805436611175537, 3.311440944671631, 1.7055416107177734, 3.143733024597168, 4.346930503845215, 3.3432207107543945, 2.613377094268799, 3.1954751014709473, 1.4130933284759521, 3.8067190647125244, 1.3069400787353516, 5.305506706237793, 2.3202195167541504, 4.072498798370361, 4.06306266784668, 1.7953723669052124, 3.137805461883545, 3.9058797359466553, 2.957301616668701, 6.248514175415039, 4.229770183563232, 5.103572845458984, 4.006763935089111, 6.578781604766846, 2.399533748626709, 4.151450157165527, 3.933319091796875, 3.9968485832214355, 4.119073390960693, 4.2586565017700195, 4.481475830078125, 3.252119541168213, 2.363278865814209, 3.220052719116211, 4.638725757598877, 2.9713547229766846, 4.0325469970703125, 3.6413750648498535, 5.073328971862793, 3.290431022644043, 5.158561706542969, 2.3701720237731934, 3.771240234375, 4.348658561706543, 2.9056687355041504, 3.762735366821289, 2.532423496246338, 3.0855178833007812, 2.5244524478912354, 2.503030776977539, 3.354015350341797, 3.456090211868286, 4.321714401245117, 3.277191400527954, 4.742505073547363, 1.345966100692749, 4.560009002685547], "mean_td_error": 3.533980369567871, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 4.0, "diff_num_grad_updates_vs_sampler_policy": 3.0}}, "num_env_steps_sampled": 4480, "num_env_steps_trained": 1032, "num_agent_steps_sampled": 13440, "num_agent_steps_trained": 1032, "last_target_update_ts": 4480, "num_target_updates": 4}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13440, "num_agent_steps_trained": 1032, "num_env_steps_sampled": 4480, "num_env_steps_trained": 1032, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 489.8699224062294, "num_env_steps_trained_throughput_per_sec": 141.0562946214366, "timesteps_total": 4480, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 13440, "timers": {"training_iteration_time_ms": 2215.692, "sample_time_ms": 1416.252, "load_time_ms": 0.523, "load_throughput": 493054.075, "learn_time_ms": 72.104, "learn_throughput": 3578.184, "synch_weights_time_ms": 15.609}, "counters": {"num_env_steps_sampled": 4480, "num_env_steps_trained": 1032, "num_agent_steps_sampled": 13440, "num_agent_steps_trained": 1032, "last_target_update_ts": 4480, "num_target_updates": 4}, "done": false, "episodes_total": 0, "training_iteration": 5, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-14-52", "timestamp": 1700201692, "time_this_iter_s": 1.8468880653381348, "time_total_s": 11.152743101119995, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8c884d0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 11.152743101119995, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 85.5, "ram_util_percent": 90.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.00289249420166, "actor_loss": -4.0498857498168945, "critic_loss": 4.734540939331055, "alpha_loss": -0.01200278289616108, "alpha_value": 0.9988008141517639, "log_alpha_value": -0.0011999312555417418, "target_entropy": -6.0, "policy_t": -0.0004066847905050963, "mean_q": 0.05186726152896881, "max_q": 0.063724085688591, "min_q": 0.04051479324698448}, "td_error": [5.509737014770508, 6.936129093170166, 3.894641399383545, 6.393680572509766, 4.637303352355957, 5.274865627288818, 7.189164638519287, 6.490049362182617, 5.5448455810546875, 4.911332607269287, 5.9028215408325195, 6.71605110168457, 4.531252861022949, 4.888798713684082, 7.389094829559326, 6.691917419433594, 8.354219436645508, 6.6633453369140625, 4.322954177856445, 4.115386962890625, 4.511581897735596, 4.541629314422607, 5.9334611892700195, 7.792937278747559, 5.947641372680664, 4.810478210449219, 6.216673851013184, 6.7932281494140625, 4.522736549377441, 5.235754489898682, 5.942338943481445, 5.081076622009277, 6.5763092041015625, 6.027007102966309, 7.021368026733398, 6.5458149909973145, 4.788822174072266, 6.0500593185424805, 4.063414573669434, 5.881682872772217, 5.684492111206055, 5.934571266174316, 2.937869071960449, 4.902740001678467, 6.045958518981934, 6.629154205322266, 4.527016639709473, 4.291547775268555, 6.406759262084961, 6.039109706878662, 6.0334320068359375, 4.522732734680176, 6.2241435050964355, 5.989742279052734, 7.661556243896484, 4.810443878173828, 5.282938003540039, 4.610301494598389, 5.781632423400879, 6.521240234375, 4.194946765899658, 4.571016788482666, 6.053782939910889, 6.7037200927734375, 4.802193641662598, 6.5665202140808105, 6.676314353942871, 3.7259469032287598, 5.095720291137695, 5.920324802398682, 6.31658935546875, 5.6201066970825195, 2.8806114196777344, 4.53941535949707, 6.108575820922852, 7.518065452575684, 6.428794860839844, 7.875542640686035, 4.559178352355957, 6.347580909729004, 4.212336540222168, 4.347597122192383, 2.9090325832366943, 6.916031837463379, 5.462574005126953, 5.297097682952881], "mean_td_error": 5.617774486541748, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 5.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.032814025878906, "actor_loss": -4.091020584106445, "critic_loss": 3.0955677032470703, "alpha_loss": -0.012039084918797016, "alpha_value": 0.9988007545471191, "log_alpha_value": -0.0011999709531664848, "target_entropy": -6.0, "policy_t": -0.024287113919854164, "mean_q": 0.06416415423154831, "max_q": 0.07647103071212769, "min_q": 0.0523499958217144}, "td_error": [4.090163230895996, 3.535393714904785, 5.497243404388428, 3.559013843536377, 4.5244293212890625, 2.9835197925567627, 5.176138877868652, 3.407283067703247, 3.62520694732666, 5.1602678298950195, 5.760189056396484, 2.9700369834899902, 5.348906517028809, 3.557676315307617, 1.8318545818328857, 4.117796897888184, 3.846000909805298, 3.063823699951172, 3.445225238800049, 3.2387070655822754, 2.6886701583862305, 4.026304244995117, 2.5495400428771973, 5.64461612701416, 4.039949417114258, 3.9930174350738525, 4.027898788452148, 3.2803146839141846, 3.6753273010253906, 3.4667985439300537, 3.7592830657958984, 3.61454701423645, 4.0984721183776855, 2.8931643962860107, 4.174330711364746, 3.6863527297973633, 2.989046096801758, 3.818436622619629, 3.432854413986206, 2.8444595336914062, 4.071104049682617, 5.562543869018555, 2.5748472213745117, 2.5236833095550537, 4.841355800628662, 5.509471893310547, 2.3751730918884277, 3.4484307765960693, 3.949763298034668, 3.5868101119995117, 3.874040365219116, 4.299805641174316, 4.747076988220215, 2.7554752826690674, 3.29266357421875, 4.945259094238281, 4.0554656982421875, 2.089547872543335, 4.159109115600586, 2.926816463470459, 2.0145745277404785, 3.9921865463256836, 4.008610725402832, 2.2907819747924805, 4.121053218841553, 2.278200387954712, 3.639653205871582, 4.851487636566162, 4.235897064208984, 1.5308045148849487, 4.824958801269531, 4.112290382385254, 1.7901002168655396, 4.262211799621582, 2.9217660427093506, 2.318695545196533, 4.508029460906982, 3.7633533477783203, 5.145925521850586, 5.197922706604004, 2.5371766090393066, 6.5373334884643555, 3.8451833724975586, 2.5830864906311035, 4.183259010314941, 4.322938442230225], "mean_td_error": 3.7540485858917236, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 5.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.018999099731445, "actor_loss": -4.070619583129883, "critic_loss": 2.117765426635742, "alpha_loss": -0.012023662216961384, "alpha_value": 0.9988006353378296, "log_alpha_value": -0.0012000862043350935, "target_entropy": -6.0, "policy_t": 0.0033949355129152536, "mean_q": 0.060975346714258194, "max_q": 0.0767148956656456, "min_q": 0.05076814442873001}, "td_error": [5.167959213256836, 4.494544506072998, 4.20880126953125, 3.530595064163208, 5.00633430480957, 2.82558012008667, 3.528364658355713, 3.3128445148468018, 3.460784435272217, 6.487107276916504, 4.309623718261719, 4.600696563720703, 4.141449928283691, 2.705751419067383, 4.122044563293457, 3.420534610748291, 2.594355821609497, 2.1678504943847656, 3.120856761932373, 3.1059021949768066, 1.7341570854187012, 2.9157562255859375, 3.646829128265381, 4.356972694396973, 2.865204334259033, 3.3314342498779297, 4.476741313934326, 3.218494415283203, 4.102863311767578, 3.997424840927124, 4.614259719848633, 4.37711238861084, 3.241786003112793, 0.6161021590232849, 3.4829654693603516, 4.872195720672607, 1.9250462055206299, 3.054889678955078, 3.8654565811157227, 3.761343479156494, 3.1117498874664307, 3.222034454345703, 2.1812267303466797, 4.495695114135742, 3.5767018795013428, 3.636155128479004, 5.006804466247559, 3.265263080596924, 2.692472457885742, 5.078780174255371, 2.242992401123047, 2.452019691467285, 5.501711845397949, 4.794504642486572, 2.861056089401245, 2.193227767944336, 2.139256000518799, 2.039334774017334, 3.3861136436462402, 4.183394432067871, 3.388608694076538, 3.1445984840393066, 4.3453779220581055, 4.546178817749023, 2.9566431045532227, 3.721738815307617, 5.236071586608887, 4.705284118652344, 5.259923934936523, 4.212158203125, 4.847958564758301, 1.6568589210510254, 2.7633447647094727, 2.9349446296691895, 1.3841657638549805, 2.9375457763671875, 2.362298011779785, 4.252579212188721, 3.212502956390381, 1.6669607162475586, 1.4871655702590942, 3.299041271209717, 2.916895866394043, 4.034257888793945, 1.7715024948120117, 2.677868366241455], "mean_td_error": 3.4715349674224854, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 5.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 5376, "num_env_steps_trained": 1290, "num_agent_steps_sampled": 16128, "num_agent_steps_trained": 1290, "last_target_update_ts": 5376, "num_target_updates": 5}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16128, "num_agent_steps_trained": 1290, "num_env_steps_sampled": 5376, "num_env_steps_trained": 1290, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 417.2297459193746, "num_env_steps_trained_throughput_per_sec": 120.13981523124849, "timesteps_total": 5376, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 16128, "timers": {"training_iteration_time_ms": 2204.318, "sample_time_ms": 1407.676, "load_time_ms": 0.536, "load_throughput": 481331.924, "learn_time_ms": 70.588, "learn_throughput": 3655.009, "synch_weights_time_ms": 15.307}, "counters": {"num_env_steps_sampled": 5376, "num_env_steps_trained": 1290, "num_agent_steps_sampled": 16128, "num_agent_steps_trained": 1290, "last_target_update_ts": 5376, "num_target_updates": 5}, "done": false, "episodes_total": 0, "training_iteration": 6, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-14-54", "timestamp": 1700201694, "time_this_iter_s": 2.164734363555908, "time_total_s": 13.317477464675903, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8c89aa8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 13.317477464675903, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 67.33333333333333, "ram_util_percent": 90.59999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.998120307922363, "actor_loss": -4.058352470397949, "critic_loss": 4.698059558868408, "alpha_loss": -0.014994893223047256, "alpha_value": 0.9985013604164124, "log_alpha_value": -0.0014997712569311261, "target_entropy": -6.0, "policy_t": -0.014469904825091362, "mean_q": 0.06607510149478912, "max_q": 0.07983614504337311, "min_q": 0.05428765341639519}, "td_error": [5.918549537658691, 4.405491828918457, 5.056640625, 5.757266044616699, 6.225315093994141, 4.006981372833252, 4.292843818664551, 5.978612899780273, 4.424188613891602, 6.186251640319824, 4.182711601257324, 4.170323371887207, 5.473215103149414, 5.805944919586182, 5.139138221740723, 5.285382270812988, 4.643537998199463, 4.925250053405762, 4.720263481140137, 6.346975326538086, 7.643080711364746, 7.098217010498047, 6.153990745544434, 5.386894226074219, 5.601162910461426, 7.0331339836120605, 6.144404888153076, 4.626354694366455, 8.155875205993652, 6.174925804138184, 5.673688888549805, 5.091061592102051, 6.025303840637207, 4.244536399841309, 5.1444621086120605, 4.0065083503723145, 6.544125556945801, 5.750951766967773, 5.63706111907959, 6.0252790451049805, 6.621037006378174, 5.015402793884277, 5.436944961547852, 5.119927406311035, 4.169809818267822, 5.229870796203613, 5.152895927429199, 3.102804183959961, 6.337977409362793, 3.8756227493286133, 4.954768657684326, 6.2581892013549805, 6.300177097320557, 5.057476997375488, 7.395738124847412, 4.392409324645996, 5.925875663757324, 5.963818550109863, 6.649129867553711, 5.570590019226074, 5.277398109436035, 5.035101890563965, 4.2628889083862305, 4.179562091827393, 6.04824161529541, 7.539190292358398, 5.950007438659668, 4.061779499053955, 3.109743356704712, 5.251795768737793, 6.400146484375, 6.4401702880859375, 5.537654876708984, 6.245471000671387, 3.65484619140625, 6.103941917419434, 5.717886447906494, 5.895525932312012, 5.764606952667236, 7.312057971954346, 4.723430633544922, 3.8563265800476074, 5.377038955688477, 6.574897766113281, 5.169986248016357, 6.734626770019531], "mean_td_error": 5.486752510070801, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 6.0, "diff_num_grad_updates_vs_sampler_policy": 5.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.022258758544922, "actor_loss": -4.098583698272705, "critic_loss": 3.144914150238037, "alpha_loss": -0.01503242738544941, "alpha_value": 0.9985012412071228, "log_alpha_value": -0.0014999040868133307, "target_entropy": -6.0, "policy_t": -0.04228368028998375, "mean_q": 0.08265404403209686, "max_q": 0.10437165200710297, "min_q": 0.06534184515476227}, "td_error": [3.7014870643615723, 2.7650609016418457, 3.7803945541381836, 5.412452697753906, 3.691286325454712, 6.4217119216918945, 4.293696403503418, 3.5939621925354004, 5.439428329467773, 2.4415974617004395, 5.029467582702637, 4.163008689880371, 3.8506312370300293, 2.270338535308838, 4.197887420654297, 5.219860553741455, 2.330822467803955, 3.5551116466522217, 5.671635627746582, 5.298863410949707, 2.1817948818206787, 3.223048686981201, 4.232547760009766, 3.668384552001953, 2.986618995666504, 4.350350379943848, 3.4239718914031982, 1.8843414783477783, 2.948806047439575, 4.477288246154785, 3.3363234996795654, 2.5242676734924316, 5.265542030334473, 3.6852028369903564, 3.9186668395996094, 4.105327606201172, 4.1472978591918945, 3.2814807891845703, 4.029200077056885, 1.1106377840042114, 3.5418269634246826, 4.0946221351623535, 3.436964511871338, 4.054155349731445, 4.276129245758057, 2.4797286987304688, 4.047378063201904, 4.609090328216553, 2.449875831604004, 5.1869611740112305, 2.943711757659912, 2.6850790977478027, 3.7962636947631836, 1.7276713848114014, 3.5070254802703857, 2.528268337249756, 4.540309429168701, 3.575530529022217, 1.9930534362792969, 1.8289694786071777, 4.337924957275391, 5.147533416748047, 4.2242326736450195, 5.03125524520874, 5.523293972015381, 4.268921852111816, 3.36331844329834, 2.0701446533203125, 2.7079882621765137, 3.3150153160095215, 2.813201427459717, 2.9124250411987305, 3.3398361206054688, 4.611412048339844, 4.008057117462158, 3.261627674102783, 5.973896026611328, 4.691720485687256, 2.9049596786499023, 5.496048450469971, 4.749377250671387, 3.611246109008789, 1.9005167484283447, 2.236480712890625, 3.4724559783935547, 4.3105149269104], "mean_td_error": 3.7150681018829346, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 6.0, "diff_num_grad_updates_vs_sampler_policy": 5.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.07060432434082, "actor_loss": -4.137585163116455, "critic_loss": 2.2192060947418213, "alpha_loss": -0.015106734819710255, "alpha_value": 0.9985010623931885, "log_alpha_value": -0.0015000822022557259, "target_entropy": -6.0, "policy_t": 0.006257600151002407, "mean_q": 0.07576107233762741, "max_q": 0.08936243504285812, "min_q": 0.06117083877325058}, "td_error": [1.8268084526062012, 2.7996888160705566, 5.416464805603027, 2.487877130508423, 3.5205955505371094, 2.8102757930755615, 3.6282570362091064, 5.311840534210205, 3.5410776138305664, 4.997383117675781, 4.739473342895508, 3.1429834365844727, 3.134878158569336, 3.1258797645568848, 5.101788520812988, 2.310973644256592, 2.052485942840576, 4.710945129394531, 5.604288101196289, 3.0826780796051025, 4.818873405456543, 3.7769484519958496, 2.64597487449646, 2.0014495849609375, 4.937520980834961, 4.156159400939941, 3.5013279914855957, 5.327581405639648, 3.689743995666504, 3.1970691680908203, 3.9205877780914307, 2.2986795902252197, 4.366576194763184, 2.9256842136383057, 2.9970545768737793, 5.369684219360352, 2.149613857269287, 3.0266671180725098, 4.243878364562988, 1.5123827457427979, 5.587002754211426, 2.1177496910095215, 3.992128372192383, 5.4492106437683105, 4.1209516525268555, 3.676424026489258, 1.5893299579620361, 2.4663150310516357, 3.2913637161254883, 5.288897514343262, 3.1030054092407227, 3.233452796936035, 4.254279136657715, 3.8484926223754883, 2.8593263626098633, 4.041764259338379, 6.331027984619141, 1.3331212997436523, 3.344226360321045, 3.4757280349731445, 2.8407773971557617, 4.596717834472656, 3.841991424560547, 1.7827717065811157, 2.27327823638916, 2.919165849685669, 4.208649635314941, 2.733391761779785, 3.596007823944092, 3.4134817123413086, 5.247518539428711, 4.03056526184082, 2.1612188816070557, 3.074636459350586, 5.499370098114014, 2.9983325004577637, 2.1822454929351807, 2.5257396697998047, 5.526652812957764, 6.49002742767334, 3.781585216522217, 4.249917030334473, 2.7279481887817383, 4.263343811035156, 4.4104485511779785, 2.1485226154327393], "mean_td_error": 3.6178863048553467, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 6.0, "diff_num_grad_updates_vs_sampler_policy": 5.0}}, "num_env_steps_sampled": 6272, "num_env_steps_trained": 1548, "num_agent_steps_sampled": 18816, "num_agent_steps_trained": 1548, "last_target_update_ts": 6272, "num_target_updates": 6}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18816, "num_agent_steps_trained": 1548, "num_env_steps_sampled": 6272, "num_env_steps_trained": 1548, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 447.4276882297153, "num_env_steps_trained_throughput_per_sec": 128.8352048697171, "timesteps_total": 6272, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 18816, "timers": {"training_iteration_time_ms": 2175.491, "sample_time_ms": 1412.281, "load_time_ms": 0.551, "load_throughput": 468218.259, "learn_time_ms": 69.636, "learn_throughput": 3704.96, "synch_weights_time_ms": 15.613}, "counters": {"num_env_steps_sampled": 6272, "num_env_steps_trained": 1548, "num_agent_steps_sampled": 18816, "num_agent_steps_trained": 1548, "last_target_update_ts": 6272, "num_target_updates": 6}, "done": false, "episodes_total": 0, "training_iteration": 7, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-14-57", "timestamp": 1700201697, "time_this_iter_s": 2.0207250118255615, "time_total_s": 15.338202476501465, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8c8ad7550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 15.338202476501465, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 70.46666666666667, "ram_util_percent": 90.59999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.101890563964844, "actor_loss": -4.175727844238281, "critic_loss": 4.936676979064941, "alpha_loss": -0.01817893423140049, "alpha_value": 0.9982020854949951, "log_alpha_value": -0.0017995575908571482, "target_entropy": -6.0, "policy_t": 0.03722498193383217, "mean_q": 0.08374454081058502, "max_q": 0.0990772396326065, "min_q": 0.06657218933105469}, "td_error": [4.605059623718262, 3.8806185722351074, 6.3787946701049805, 5.943716049194336, 7.7259202003479, 6.083303451538086, 5.873707294464111, 4.282373428344727, 5.176747798919678, 6.430165767669678, 6.109740257263184, 4.31397008895874, 4.410721778869629, 7.95832633972168, 5.9719061851501465, 3.863795042037964, 5.696232795715332, 3.187039852142334, 4.994629859924316, 5.559476852416992, 5.079649925231934, 5.397779941558838, 3.7943520545959473, 6.006190299987793, 4.755099773406982, 7.3156538009643555, 4.680480003356934, 5.985241889953613, 5.751459121704102, 3.529175281524658, 3.9729371070861816, 5.014956951141357, 5.900337219238281, 6.465566635131836, 6.520957946777344, 6.486269950866699, 5.572385787963867, 6.727413177490234, 5.241545677185059, 4.090931415557861, 3.7450950145721436, 6.175685405731201, 5.461278915405273, 4.696530342102051, 4.215409278869629, 5.364129066467285, 5.428318977355957, 6.730347633361816, 6.708277702331543, 5.8298516273498535, 5.7972540855407715, 5.927817344665527, 2.9994218349456787, 5.315752983093262, 5.9483747482299805, 5.5959343910217285, 6.175811767578125, 5.372650623321533, 6.242395401000977, 5.6565728187561035, 7.2592010498046875, 5.391629695892334, 6.40069580078125, 4.8211989402771, 6.623814582824707, 7.127443790435791, 5.6072468757629395, 6.457860469818115, 3.954793691635132, 7.4539079666137695, 6.556943893432617, 5.147287845611572, 6.237240791320801, 7.641143798828125, 6.769410133361816, 6.575345039367676, 6.761446952819824, 5.31935977935791, 7.579668045043945, 6.992136001586914, 4.9273881912231445, 6.741447448730469, 4.36977481842041, 7.125898361206055, 5.708540916442871, 6.612818717956543], "mean_td_error": 5.677734851837158, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 7.0, "diff_num_grad_updates_vs_sampler_policy": 6.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.016340255737305, "actor_loss": -4.111257076263428, "critic_loss": 2.889848232269287, "alpha_loss": -0.01802773028612137, "alpha_value": 0.9982017874717712, "log_alpha_value": -0.0017998318653553724, "target_entropy": -6.0, "policy_t": -0.019466163590550423, "mean_q": 0.10146027058362961, "max_q": 0.12902678549289703, "min_q": 0.08192209154367447}, "td_error": [2.748072385787964, 4.628427505493164, 4.79401969909668, 4.813272476196289, 4.787627696990967, 2.2278356552124023, 4.50478982925415, 2.4634976387023926, 3.3629961013793945, 3.726381540298462, 2.630523204803467, 2.005889892578125, 4.9476423263549805, 1.9025530815124512, 2.828871488571167, 1.9762187004089355, 2.7530550956726074, 3.2038888931274414, 4.456192970275879, 3.2146944999694824, 4.562650680541992, 2.7188289165496826, 4.145930290222168, 4.108542442321777, 4.327519416809082, 4.598395347595215, 2.9385690689086914, 5.73569393157959, 3.2470815181732178, 1.9295991659164429, 1.7922773361206055, 4.165458679199219, 6.002713203430176, 2.4048609733581543, 5.5828094482421875, 2.188666343688965, 2.963639974594116, 3.5443577766418457, 4.098310947418213, 2.3983473777770996, 2.5734853744506836, 2.950728178024292, 3.2527503967285156, 3.853149890899658, 3.8387842178344727, 3.3520445823669434, 4.206744194030762, 4.265697956085205, 3.4048643112182617, 4.159165382385254, 3.836855888366699, 4.947380542755127, 1.6656830310821533, 4.489143371582031, 4.017366886138916, 3.239516019821167, 3.232963800430298, 2.6680517196655273, 3.5124616622924805, 4.355927467346191, 2.6732125282287598, 3.5702450275421143, 3.788391590118408, 2.7998690605163574, 0.9553108215332031, 1.4734022617340088, 3.5441017150878906, 2.4085850715637207, 4.727657318115234, 4.9265851974487305, 3.761014938354492, 4.740698337554932, 5.25607967376709, 2.5486388206481934, 1.547102689743042, 4.029898643493652, 2.0646743774414062, 3.5372140407562256, 4.256965637207031, 4.24554443359375, 3.662691593170166, 5.602377891540527, 3.632430076599121, 4.368915557861328, 4.824896812438965, 2.7040059566497803], "mean_td_error": 3.5453951358795166, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 7.0, "diff_num_grad_updates_vs_sampler_policy": 6.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.050334930419922, "actor_loss": -4.133805751800537, "critic_loss": 2.2445149421691895, "alpha_loss": -0.01809183694422245, "alpha_value": 0.9982014894485474, "log_alpha_value": -0.001800122787244618, "target_entropy": -6.0, "policy_t": 0.02295159362256527, "mean_q": 0.09443385899066925, "max_q": 0.1112939715385437, "min_q": 0.07876355946063995}, "td_error": [2.150498867034912, 2.5350141525268555, 3.6485753059387207, 3.756917953491211, 4.86849308013916, 5.083592414855957, 3.576740264892578, 2.5438642501831055, 2.51210880279541, 3.0178158283233643, 3.3821797370910645, 3.4986343383789062, 3.0650634765625, 2.0889177322387695, 1.750166893005371, 2.6079092025756836, 5.33447265625, 5.020631313323975, 4.456365585327148, 4.574337005615234, 4.533103942871094, 4.39665412902832, 3.1958041191101074, 3.6578965187072754, 4.421875, 2.5840516090393066, 4.689971923828125, 5.621860504150391, 5.488715648651123, 4.072500228881836, 3.585381031036377, 4.2633957862854, 3.2603704929351807, 3.4714560508728027, 4.39842414855957, 2.7877979278564453, 3.23482608795166, 3.76621675491333, 5.411645412445068, 3.3312630653381348, 3.9507412910461426, 4.6621317863464355, 3.8263564109802246, 3.078439712524414, 4.177024841308594, 2.5955724716186523, 4.813014030456543, 3.4317026138305664, 2.6876888275146484, 4.034765720367432, 5.533044815063477, 2.338008403778076, 2.7997779846191406, 2.7482218742370605, 4.3633599281311035, 3.70267915725708, 5.07675838470459, 4.123340606689453, 3.821338653564453, 2.6384801864624023, 2.4795122146606445, 3.1716456413269043, 4.506760597229004, 5.285038948059082, 3.281647205352783, 4.081811904907227, 2.2030670642852783, 4.870695114135742, 4.37022590637207, 1.2455065250396729, 2.9604806900024414, 2.742295026779175, 3.207395315170288, 2.179581642150879, 2.5625579357147217, 4.579861640930176, 4.51542854309082, 4.802330017089844, 3.9317097663879395, 3.049905300140381, 3.65250825881958, 3.2139813899993896, 4.179406642913818, 4.033321857452393, 2.7890281677246094, 2.7858476638793945], "mean_td_error": 3.6596453189849854, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 7.0, "diff_num_grad_updates_vs_sampler_policy": 6.0}}, "num_env_steps_sampled": 7168, "num_env_steps_trained": 1806, "num_agent_steps_sampled": 21504, "num_agent_steps_trained": 1806, "last_target_update_ts": 7168, "num_target_updates": 7}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 21504, "num_agent_steps_trained": 1806, "num_env_steps_sampled": 7168, "num_env_steps_trained": 1806, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 336.61773987317594, "num_env_steps_trained_throughput_per_sec": 96.92787599026718, "timesteps_total": 7168, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 21504, "timers": {"training_iteration_time_ms": 2236.271, "sample_time_ms": 1497.235, "load_time_ms": 0.556, "load_throughput": 464035.348, "learn_time_ms": 68.785, "learn_throughput": 3750.807, "synch_weights_time_ms": 15.672}, "counters": {"num_env_steps_sampled": 7168, "num_env_steps_trained": 1806, "num_agent_steps_sampled": 21504, "num_agent_steps_trained": 1806, "last_target_update_ts": 7168, "num_target_updates": 7}, "done": false, "episodes_total": 0, "training_iteration": 8, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-14-59", "timestamp": 1700201699, "time_this_iter_s": 2.675940990447998, "time_total_s": 18.014143466949463, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8c8ad7280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 18.014143466949463, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 77.325, "ram_util_percent": 90.69999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.04136848449707, "actor_loss": -4.131991863250732, "critic_loss": 4.81229305267334, "alpha_loss": -0.021081434562802315, "alpha_value": 0.9979027509689331, "log_alpha_value": -0.0020994585938751698, "target_entropy": -6.0, "policy_t": 0.023844897747039795, "mean_q": 0.10082262754440308, "max_q": 0.13183262944221497, "min_q": 0.08239319920539856}, "td_error": [6.677934646606445, 4.088129043579102, 5.510127544403076, 5.352027893066406, 4.708644866943359, 6.147756576538086, 5.478390693664551, 4.138073444366455, 6.412354946136475, 7.321419715881348, 3.627927303314209, 6.834779739379883, 4.847820281982422, 4.409544944763184, 7.378539085388184, 6.350091934204102, 6.548038959503174, 5.440929412841797, 7.325684547424316, 2.741126298904419, 5.965196132659912, 7.096114635467529, 3.85122013092041, 4.877330780029297, 6.231033802032471, 7.871648788452148, 5.547109603881836, 3.9806575775146484, 6.048106670379639, 5.014983177185059, 6.128297805786133, 6.358206748962402, 5.939944267272949, 3.9045822620391846, 5.043839931488037, 5.940935134887695, 6.403330326080322, 5.544248580932617, 4.944994926452637, 7.4031219482421875, 6.124605178833008, 3.5575969219207764, 4.617298126220703, 6.389617919921875, 6.97042989730835, 4.741616249084473, 6.525609970092773, 4.587508201599121, 4.444744110107422, 4.963762283325195, 4.997166633605957, 5.499422073364258, 6.45341157913208, 5.3073835372924805, 5.877135276794434, 6.399519443511963, 5.790821075439453, 4.227744102478027, 4.496610164642334, 6.292631149291992, 4.035253524780273, 5.593244552612305, 4.743830680847168, 5.052109241485596, 5.131774425506592, 4.090790271759033, 8.478010177612305, 6.305527210235596, 5.157773971557617, 3.5480408668518066, 7.171270370483398, 4.8523101806640625, 5.75195837020874, 4.841617584228516, 5.686882019042969, 5.717938423156738, 5.786288261413574, 5.854799270629883, 7.0531816482543945, 6.006855010986328, 4.9408674240112305, 5.4541826248168945, 6.968173980712891, 6.289490699768066, 6.135846138000488, 3.44039249420166], "mean_td_error": 5.555665969848633, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 8.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.104848861694336, "actor_loss": -4.217648029327393, "critic_loss": 2.8781704902648926, "alpha_loss": -0.02121763303875923, "alpha_value": 0.9979024529457092, "log_alpha_value": -0.002099747769534588, "target_entropy": -6.0, "policy_t": -0.0035635519307106733, "mean_q": 0.12453439831733704, "max_q": 0.1574385166168213, "min_q": 0.10000217705965042}, "td_error": [3.228379726409912, 4.707738399505615, 2.8497047424316406, 4.134262561798096, 3.744358777999878, 3.8221845626831055, 2.323293924331665, 4.2267608642578125, 4.085805892944336, 2.097458839416504, 4.9433441162109375, 3.50650691986084, 3.722231388092041, 2.4715075492858887, 3.777554988861084, 5.186084747314453, 5.019228935241699, 4.137495994567871, 2.635206699371338, 3.001676321029663, 3.5740060806274414, 3.0711331367492676, 2.0609538555145264, 2.8429641723632812, 4.5449628829956055, 4.477743625640869, 2.995917320251465, 3.3124849796295166, 4.920354843139648, 2.8941125869750977, 4.563893795013428, 4.499608516693115, 3.553410053253174, 3.9461870193481445, 3.4491214752197266, 2.933779716491699, 5.174980163574219, 3.27523136138916, 3.2852542400360107, 2.631484270095825, 3.244293451309204, 1.3049919605255127, 2.960125684738159, 3.0117149353027344, 2.636434555053711, 4.00547981262207, 2.699739933013916, 4.2349700927734375, 2.378106117248535, 3.1506142616271973, 4.365007400512695, 4.292275428771973, 3.9667811393737793, 3.2523703575134277, 3.8330821990966797, 2.714405059814453, 2.2026610374450684, 4.46480131149292, 1.0374071598052979, 3.2983109951019287, 3.3591208457946777, 5.06406831741333, 2.665259838104248, 2.630923271179199, 2.991075038909912, 3.8240599632263184, 3.4644558429718018, 5.236905097961426, 1.7097797393798828, 3.2889180183410645, 2.174163579940796, 3.2010316848754883, 3.015885353088379, 3.7796812057495117, 2.024233341217041, 3.118499994277954, 4.53696346282959, 4.274497985839844, 5.597596168518066, 5.161202430725098, 2.2348079681396484, 3.349113941192627, 3.8235409259796143, 3.419250011444092, 4.280272483825684, 4.402853012084961], "mean_td_error": 3.503606081008911, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 8.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.140726089477539, "actor_loss": -4.241238594055176, "critic_loss": 2.1448822021484375, "alpha_loss": -0.021297192201018333, "alpha_value": 0.9979020357131958, "log_alpha_value": -0.0021001645363867283, "target_entropy": -6.0, "policy_t": 0.012526889331638813, "mean_q": 0.11596398800611496, "max_q": 0.13916730880737305, "min_q": 0.09084596484899521}, "td_error": [2.0046308040618896, 3.75750732421875, 3.7014272212982178, 4.9107818603515625, 3.158390522003174, 3.564525604248047, 5.411772727966309, 1.9363422393798828, 3.442570209503174, 2.8824691772460938, 5.7792229652404785, 3.548834800720215, 2.6499884128570557, 3.4414472579956055, 4.204340934753418, 2.545935869216919, 5.342369079589844, 2.6908516883850098, 3.3037943840026855, 3.584117889404297, 3.138934373855591, 3.554410696029663, 3.9765193462371826, 3.7919061183929443, 3.3937785625457764, 3.2580833435058594, 2.765573024749756, 2.8840456008911133, 3.116553783416748, 2.662100315093994, 2.8548548221588135, 2.483004093170166, 2.347294807434082, 4.665165424346924, 5.203873634338379, 4.889349937438965, 1.8323450088500977, 4.044188499450684, 5.319840431213379, 3.968684434890747, 2.966587781906128, 3.490201234817505, 4.447042465209961, 3.3765106201171875, 4.154234886169434, 4.318387031555176, 4.0261125564575195, 4.118968486785889, 1.2004404067993164, 3.9507875442504883, 2.6982831954956055, 3.7027997970581055, 4.923828601837158, 2.818547487258911, 3.401517391204834, 1.063156247138977, 4.929567337036133, 3.6736435890197754, 2.4214658737182617, 3.070929527282715, 2.158504009246826, 4.081644058227539, 1.8171355724334717, 5.297769546508789, 3.4857327938079834, 3.37422251701355, 2.42315411567688, 3.8577308654785156, 4.379267692565918, 3.3061113357543945, 3.769454002380371, 4.73280143737793, 4.413571834564209, 3.8359665870666504, 2.1449484825134277, 4.806419372558594, 3.0390095710754395, 4.113443851470947, 2.7293946743011475, 3.172809362411499, 1.6533920764923096, 5.0740203857421875, 2.771212100982666, 4.522292137145996, 5.8100152015686035, 4.024418830871582], "mean_td_error": 3.5530149936676025, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 8.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 8064, "num_env_steps_trained": 2064, "num_agent_steps_sampled": 24192, "num_agent_steps_trained": 2064, "last_target_update_ts": 8064, "num_target_updates": 8}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24192, "num_agent_steps_trained": 2064, "num_env_steps_sampled": 8064, "num_env_steps_trained": 2064, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 488.5085641492266, "num_env_steps_trained_throughput_per_sec": 140.6642963733264, "timesteps_total": 8064, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 24192, "timers": {"training_iteration_time_ms": 2191.588, "sample_time_ms": 1471.305, "load_time_ms": 0.554, "load_throughput": 465933.448, "learn_time_ms": 68.151, "learn_throughput": 3785.695, "synch_weights_time_ms": 16.479}, "counters": {"num_env_steps_sampled": 8064, "num_env_steps_trained": 2064, "num_agent_steps_sampled": 24192, "num_agent_steps_trained": 2064, "last_target_update_ts": 8064, "num_target_updates": 8}, "done": false, "episodes_total": 0, "training_iteration": 9, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-15-01", "timestamp": 1700201701, "time_this_iter_s": 1.8471732139587402, "time_total_s": 19.861316680908203, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8c8ad7f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 19.861316680908203, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 66.43333333333334, "ram_util_percent": 90.59999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.042400360107422, "actor_loss": -4.151727676391602, "critic_loss": 4.66829776763916, "alpha_loss": -0.024095257744193077, "alpha_value": 0.9976035356521606, "log_alpha_value": -0.002399352379143238, "target_entropy": -6.0, "policy_t": -0.022142531350255013, "mean_q": 0.12118891626596451, "max_q": 0.14763015508651733, "min_q": 0.09920848906040192}, "td_error": [4.9600677490234375, 4.719235420227051, 5.803645133972168, 4.0949506759643555, 4.538991928100586, 6.870326995849609, 5.841951370239258, 6.084321975708008, 6.098690032958984, 3.7359654903411865, 5.9611897468566895, 4.565197467803955, 5.234417915344238, 5.335212707519531, 5.591124057769775, 7.2384443283081055, 4.066916465759277, 5.725370407104492, 4.470086574554443, 5.732062339782715, 4.976466178894043, 5.51882266998291, 6.803725242614746, 5.684789657592773, 6.512645721435547, 5.888001441955566, 6.007632732391357, 4.050050735473633, 6.235986232757568, 5.846591949462891, 7.355947494506836, 5.565670013427734, 4.744451522827148, 4.287004470825195, 6.150912761688232, 8.537908554077148, 4.243391990661621, 5.079869270324707, 3.9287538528442383, 6.310049057006836, 4.822186470031738, 5.273388862609863, 5.652907371520996, 5.659343719482422, 6.329620838165283, 7.422792434692383, 5.261676788330078, 4.80731201171875, 5.7001729011535645, 5.0872602462768555, 6.354269027709961, 6.002016544342041, 6.574275493621826, 6.961220741271973, 6.577888488769531, 4.272763252258301, 6.536749839782715, 6.31340217590332, 4.647150039672852, 6.636940002441406, 6.556069374084473, 5.088932514190674, 5.459927082061768, 3.6303930282592773, 5.23427677154541, 4.877735137939453, 5.490514755249023, 6.905932426452637, 5.5279436111450195, 6.10876989364624, 5.1527509689331055, 4.538955211639404, 5.240359306335449, 5.27319860458374, 5.977627277374268, 5.837916374206543, 5.384047508239746, 4.584597110748291, 4.438075065612793, 6.180937767028809, 3.745300054550171, 5.627259731292725, 4.983358383178711, 4.029754161834717, 6.178105354309082, 5.957065582275391], "mean_td_error": 5.5267438888549805, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 9.0, "diff_num_grad_updates_vs_sampler_policy": 8.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.057117462158203, "actor_loss": -4.193350315093994, "critic_loss": 2.8253538608551025, "alpha_loss": -0.02413494698703289, "alpha_value": 0.9976031184196472, "log_alpha_value": -0.002399787772446871, "target_entropy": -6.0, "policy_t": -0.04043222591280937, "mean_q": 0.15025152266025543, "max_q": 0.18144632875919342, "min_q": 0.12039949744939804}, "td_error": [2.8738389015197754, 2.5800986289978027, 5.089648246765137, 3.8166418075561523, 3.262103796005249, 2.3103795051574707, 3.3736276626586914, 4.369872093200684, 3.431049108505249, 2.5697245597839355, 3.8753223419189453, 2.0865015983581543, 3.2891945838928223, 1.8034099340438843, 2.970846652984619, 5.285940170288086, 3.486720561981201, 3.6285805702209473, 3.8164548873901367, 1.7858407497406006, 4.144595146179199, 3.839364528656006, 4.090122222900391, 3.1557092666625977, 3.852825164794922, 4.445189476013184, 3.664553165435791, 2.909212589263916, 3.08713436126709, 2.238450527191162, 3.2267322540283203, 4.471724033355713, 4.380088806152344, 5.0579118728637695, 4.250105381011963, 4.287559509277344, 2.0403475761413574, 3.2496771812438965, 3.5623369216918945, 4.378782272338867, 4.039885520935059, 3.397310256958008, 2.387882709503174, 1.9582445621490479, 4.307302474975586, 4.614958763122559, 4.571470737457275, 3.842944622039795, 2.0365686416625977, 4.8116350173950195, 1.9854736328125, 3.0949764251708984, 3.0779929161071777, 1.6842105388641357, 2.629088878631592, 5.693998336791992, 1.7477020025253296, 3.343906879425049, 2.281963348388672, 1.4764423370361328, 3.124298572540283, 2.2886970043182373, 4.420407772064209, 3.577996015548706, 3.5866827964782715, 4.677464962005615, 3.5516061782836914, 3.1444389820098877, 3.510014533996582, 3.2866146564483643, 4.973098278045654, 3.888064384460449, 4.124577522277832, 4.907496452331543, 3.2812511920928955, 4.360116004943848, 4.908875465393066, 3.237682819366455, 3.032926559448242, 5.7163567543029785, 3.487344264984131, 3.0680623054504395, 2.777238607406616, 4.0982513427734375, 1.7135212421417236, 2.974515438079834], "mean_td_error": 3.4737184047698975, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 9.0, "diff_num_grad_updates_vs_sampler_policy": 8.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.14758014678955, "actor_loss": -4.267699241638184, "critic_loss": 2.128873825073242, "alpha_loss": -0.024357646703720093, "alpha_value": 0.9976025223731995, "log_alpha_value": -0.002400340512394905, "target_entropy": -6.0, "policy_t": 0.0015117326984182, "mean_q": 0.1364547312259674, "max_q": 0.16596952080726624, "min_q": 0.10752269625663757}, "td_error": [5.599474906921387, 4.120643615722656, 2.7909154891967773, 2.8872134685516357, 3.327491283416748, 3.2409844398498535, 4.263344764709473, 5.281970977783203, 5.319932460784912, 1.984125018119812, 4.126911640167236, 4.017115116119385, 5.197043418884277, 2.520197868347168, 1.8601531982421875, 3.6617002487182617, 4.5424957275390625, 2.187727928161621, 3.5210118293762207, 4.12189245223999, 3.9770491123199463, 4.535187244415283, 3.3445937633514404, 2.467945098876953, 2.8940391540527344, 2.1052467823028564, 2.190558433532715, 2.8176064491271973, 3.9340314865112305, 3.097925901412964, 2.6191916465759277, 3.224700450897217, 3.807438611984253, 2.1120338439941406, 1.5375211238861084, 2.221240282058716, 3.138489246368408, 4.618300437927246, 5.452842712402344, 0.562301516532898, 2.5100367069244385, 4.226856708526611, 3.632340431213379, 4.131075382232666, 3.4867751598358154, 3.7645936012268066, 4.382779598236084, 3.658870220184326, 2.4548439979553223, 4.754183769226074, 4.024158477783203, 4.961119174957275, 3.3586761951446533, 4.336913108825684, 2.98073148727417, 4.820779323577881, 4.81271505355835, 4.464956283569336, 4.465520858764648, 1.3958375453948975, 3.6116974353790283, 3.645332098007202, 3.008341073989868, 3.5774402618408203, 3.1797680854797363, 5.223321914672852, 3.0912322998046875, 4.330371379852295, 2.164397954940796, 2.426759958267212, 1.927103042602539, 3.576404571533203, 3.953310012817383, 2.898435115814209, 3.556910514831543, 3.2046613693237305, 3.875314235687256, 4.417654037475586, 2.716639518737793, 4.818611145019531, 3.5800633430480957, 3.0040762424468994, 2.88767671585083, 4.722865104675293, 2.1044814586639404, 4.34415340423584], "mean_td_error": 3.508155584335327, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 9.0, "diff_num_grad_updates_vs_sampler_policy": 8.0}}, "num_env_steps_sampled": 8960, "num_env_steps_trained": 2322, "num_agent_steps_sampled": 26880, "num_agent_steps_trained": 2322, "last_target_update_ts": 8960, "num_target_updates": 9}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 26880, "num_agent_steps_trained": 2322, "num_env_steps_sampled": 8960, "num_env_steps_trained": 2322, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 446.62704615126813, "num_env_steps_trained_throughput_per_sec": 128.60466284266425, "timesteps_total": 8960, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 26880, "timers": {"training_iteration_time_ms": 2173.04, "sample_time_ms": 1468.496, "load_time_ms": 0.55, "load_throughput": 469176.89, "learn_time_ms": 67.66, "learn_throughput": 3813.172, "synch_weights_time_ms": 16.483}, "counters": {"num_env_steps_sampled": 8960, "num_env_steps_trained": 2322, "num_agent_steps_sampled": 26880, "num_agent_steps_trained": 2322, "last_target_update_ts": 8960, "num_target_updates": 9}, "done": false, "episodes_total": 0, "training_iteration": 10, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-15-03", "timestamp": 1700201703, "time_this_iter_s": 2.020854949951172, "time_total_s": 21.882171630859375, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8c8ad75e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 21.882171630859375, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 70.83333333333333, "ram_util_percent": 90.59999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.096597671508789, "actor_loss": -4.224554538726807, "critic_loss": 5.063464164733887, "alpha_loss": -0.0272531695663929, "alpha_value": 0.997304379940033, "log_alpha_value": -0.0026992429047822952, "target_entropy": -6.0, "policy_t": -0.006575841456651688, "mean_q": 0.13895024359226227, "max_q": 0.1757057160139084, "min_q": 0.11908470839262009}, "td_error": [6.96630334854126, 6.856631755828857, 4.3744354248046875, 5.175820827484131, 4.566288471221924, 8.275359153747559, 4.184723377227783, 5.540142059326172, 5.864134788513184, 6.412256240844727, 6.6902756690979, 5.240963935852051, 7.221829891204834, 7.564511299133301, 4.912783622741699, 4.190278053283691, 5.652158737182617, 4.921948432922363, 5.070341110229492, 6.413887977600098, 7.437424659729004, 4.98734188079834, 4.730567932128906, 5.160952568054199, 6.055058479309082, 7.739958763122559, 5.425503730773926, 6.112155914306641, 6.198500633239746, 5.470643997192383, 6.058115005493164, 6.204626083374023, 5.714481353759766, 4.215241432189941, 5.268376350402832, 3.2263617515563965, 6.727825164794922, 5.805876731872559, 4.671269416809082, 6.2155561447143555, 6.55617094039917, 6.448635101318359, 5.844413757324219, 6.006264686584473, 4.8455986976623535, 5.727689266204834, 4.358625411987305, 5.590743064880371, 6.513674736022949, 5.138187408447266, 6.731235980987549, 5.822011947631836, 5.26173210144043, 5.442561149597168, 4.033716201782227, 7.174978256225586, 4.981838226318359, 6.8366289138793945, 5.288970947265625, 4.915745735168457, 5.477728843688965, 4.754294395446777, 5.696725368499756, 2.9246840476989746, 5.010148048400879, 5.699991226196289, 4.142805099487305, 6.372029781341553, 7.419630527496338, 6.054774761199951, 6.018336296081543, 4.252119064331055, 6.1845808029174805, 5.401639461517334, 6.567890644073486, 6.8797197341918945, 5.216296195983887, 5.169376373291016, 6.415678024291992, 6.4545392990112305, 5.089046478271484, 6.456548690795898, 5.829988479614258, 6.392414093017578, 6.448419570922852, 6.595620155334473], "mean_td_error": 5.720527648925781, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 10.0, "diff_num_grad_updates_vs_sampler_policy": 9.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.121245384216309, "actor_loss": -4.280426502227783, "critic_loss": 2.917628765106201, "alpha_loss": -0.02732580527663231, "alpha_value": 0.9973037838935852, "log_alpha_value": -0.002699846401810646, "target_entropy": -6.0, "policy_t": -0.029262544587254524, "mean_q": 0.17116817831993103, "max_q": 0.2163628190755844, "min_q": 0.1411176472902298}, "td_error": [5.67331600189209, 2.290132999420166, 5.2227020263671875, 2.3379368782043457, 3.585965394973755, 5.807208061218262, 5.05375337600708, 4.304845809936523, 4.109639644622803, 3.24626088142395, 2.3146615028381348, 2.5375144481658936, 2.8448877334594727, 1.7114282846450806, 3.1638543605804443, 2.8908653259277344, 3.388150691986084, 2.9112014770507812, 3.7353782653808594, 3.333308219909668, 3.242526054382324, 3.387193202972412, 3.9378786087036133, 4.16761589050293, 3.17836856842041, 2.668241024017334, 2.3297982215881348, 2.0545191764831543, 4.02920389175415, 1.8792660236358643, 5.246211528778076, 3.406665802001953, 3.729541301727295, 4.848769187927246, 3.3914549350738525, 4.902996063232422, 1.4934091567993164, 2.843942165374756, 2.9933834075927734, 3.533787727355957, 4.538060188293457, 4.114155292510986, 4.673153400421143, 3.7316269874572754, 2.1770005226135254, 2.9379844665527344, 3.046125888824463, 4.471356391906738, 4.55856466293335, 5.918615818023682, 3.3445968627929688, 3.8547730445861816, 4.949390411376953, 3.407604694366455, 2.6820473670959473, 3.020949125289917, 0.8810864090919495, 2.0900049209594727, 4.404149055480957, 3.3089821338653564, 1.2408790588378906, 4.71996545791626, 2.211350917816162, 3.9462730884552, 4.071197032928467, 2.846975326538086, 3.520242691040039, 4.342267036437988, 3.6293625831604004, 3.788034677505493, 4.437255859375, 3.7270586490631104, 3.3353588581085205, 3.836747407913208, 4.020169258117676, 3.374770164489746, 2.1927552223205566, 3.9713449478149414, 3.1578245162963867, 5.235058784484863, 4.872143745422363, 3.1236209869384766, 4.947388648986816, 5.808160305023193, 2.3254899978637695, 4.747825622558594], "mean_td_error": 3.572878122329712, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 10.0, "diff_num_grad_updates_vs_sampler_policy": 9.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.1249418258667, "actor_loss": -4.268921375274658, "critic_loss": 2.1976988315582275, "alpha_loss": -0.027343682944774628, "alpha_value": 0.9973030090332031, "log_alpha_value": -0.002700625918805599, "target_entropy": -6.0, "policy_t": -0.04835914820432663, "mean_q": 0.1618538200855255, "max_q": 0.1914421170949936, "min_q": 0.13160739839076996}, "td_error": [1.9881243705749512, 2.605492353439331, 5.383613586425781, 3.231388568878174, 5.29221773147583, 3.3786699771881104, 3.6028482913970947, 2.748318910598755, 2.1422691345214844, 4.805859088897705, 4.760324478149414, 3.9435248374938965, 4.333186149597168, 3.4043450355529785, 4.661794662475586, 5.410032749176025, 4.481865882873535, 2.6572251319885254, 3.7616500854492188, 2.614557981491089, 6.340538024902344, 5.11659049987793, 2.697279930114746, 3.104044198989868, 5.642220497131348, 3.24515438079834, 3.909397602081299, 5.217623710632324, 3.104341983795166, 2.0158681869506836, 3.5340347290039062, 2.126162528991699, 4.241270065307617, 4.568076133728027, 3.526951313018799, 1.4431483745574951, 1.424830675125122, 3.949924945831299, 3.594076633453369, 4.300378799438477, 5.210980415344238, 2.748455762863159, 1.8190743923187256, 3.785367727279663, 5.215351104736328, 4.582359790802002, 3.066359758377075, 3.175164222717285, 3.903125286102295, 3.6608335971832275, 4.086817741394043, 2.5761260986328125, 2.229067325592041, 3.9711692333221436, 5.563904762268066, 3.697648525238037, 3.713036298751831, 2.7950544357299805, 2.4665966033935547, 4.639546871185303, 3.9745140075683594, 3.6540141105651855, 3.2546329498291016, 4.224837303161621, 2.8407702445983887, 2.765432357788086, 3.136188507080078, 5.984014987945557, 2.861330509185791, 4.78273868560791, 3.1700844764709473, 3.141050100326538, 2.1642580032348633, 2.767232894897461, 4.776125907897949, 3.8123393058776855, 4.397947311401367, 4.0194091796875, 2.6991443634033203, 3.2094616889953613, 3.9793405532836914, 2.9954471588134766, 3.387906551361084, 5.611377716064453, 2.4293856620788574, 3.301738739013672], "mean_td_error": 3.657627582550049, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 10.0, "diff_num_grad_updates_vs_sampler_policy": 9.0}}, "num_env_steps_sampled": 9856, "num_env_steps_trained": 2580, "num_agent_steps_sampled": 29568, "num_agent_steps_trained": 2580, "last_target_update_ts": 9856, "num_target_updates": 10}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 29568, "num_agent_steps_trained": 2580, "num_env_steps_sampled": 9856, "num_env_steps_trained": 2580, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 467.72341702148475, "num_env_steps_trained_throughput_per_sec": 134.67928749056145, "timesteps_total": 9856, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 29568, "timers": {"training_iteration_time_ms": 2069.95, "sample_time_ms": 1456.655, "load_time_ms": 0.565, "load_throughput": 456537.329, "learn_time_ms": 67.777, "learn_throughput": 3806.607, "synch_weights_time_ms": 16.58}, "counters": {"num_env_steps_sampled": 9856, "num_env_steps_trained": 2580, "num_agent_steps_sampled": 29568, "num_agent_steps_trained": 2580, "last_target_update_ts": 9856, "num_target_updates": 10}, "done": false, "episodes_total": 0, "training_iteration": 11, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-15-05", "timestamp": 1700201705, "time_this_iter_s": 1.9318959712982178, "time_total_s": 23.814067602157593, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8981f5550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 23.814067602157593, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 67.86666666666666, "ram_util_percent": 90.66666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.125225067138672, "actor_loss": -4.271411418914795, "critic_loss": 4.5436577796936035, "alpha_loss": -0.030367745086550713, "alpha_value": 0.99700528383255, "log_alpha_value": -0.0029992167837917805, "target_entropy": -6.0, "policy_t": -0.018344270065426826, "mean_q": 0.16385893523693085, "max_q": 0.1902886927127838, "min_q": 0.1369568556547165}, "td_error": [4.607049942016602, 6.196109771728516, 5.31307315826416, 4.1313276290893555, 7.964486122131348, 4.131176948547363, 7.268040657043457, 3.47672963142395, 5.964616775512695, 3.0990145206451416, 5.766722202301025, 5.744199752807617, 6.136316299438477, 6.180909156799316, 4.1980695724487305, 5.645699501037598, 4.363389015197754, 4.623537540435791, 6.150446891784668, 7.937652587890625, 5.3108673095703125, 6.57744836807251, 4.566279411315918, 7.28743839263916, 4.1856279373168945, 5.805606842041016, 4.684015274047852, 4.734719276428223, 6.137730598449707, 4.7990336418151855, 5.649919509887695, 6.373993873596191, 4.795361042022705, 4.5698347091674805, 5.360680103302002, 5.843523025512695, 4.113533973693848, 4.646378517150879, 5.7802324295043945, 5.1725335121154785, 5.469033718109131, 4.533420562744141, 3.163356304168701, 4.942483901977539, 6.169053077697754, 5.605042457580566, 2.7659189701080322, 5.293906211853027, 6.815278053283691, 6.750459671020508, 6.0602874755859375, 5.111785888671875, 5.254059791564941, 6.540304183959961, 5.02689266204834, 4.512851238250732, 6.824447154998779, 6.846782684326172, 5.664764404296875, 5.8977370262146, 4.7402238845825195, 4.632528305053711, 5.192955493927002, 4.991324424743652, 6.205011367797852, 5.442429542541504, 5.24778938293457, 5.0972795486450195, 6.232060432434082, 4.3600664138793945, 6.245392799377441, 5.702701568603516, 7.112882137298584, 6.127300262451172, 5.199237823486328, 3.1393990516662598, 6.155035972595215, 6.9880547523498535, 5.225749969482422, 4.684625625610352, 5.876629829406738, 6.509693145751953, 4.2115044593811035, 6.005181312561035, 4.785102844238281, 3.399902820587158], "mean_td_error": 5.395944595336914, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 11.0, "diff_num_grad_updates_vs_sampler_policy": 10.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.116889953613281, "actor_loss": -4.2998552322387695, "critic_loss": 2.8656435012817383, "alpha_loss": -0.03035087138414383, "alpha_value": 0.9970044493675232, "log_alpha_value": -0.0030000198166817427, "target_entropy": -6.0, "policy_t": 0.01407799031585455, "mean_q": 0.20150133967399597, "max_q": 0.24604520201683044, "min_q": 0.16849489510059357}, "td_error": [2.1327528953552246, 3.766169548034668, 2.6685824394226074, 2.985328435897827, 2.9436864852905273, 5.463181495666504, 2.993330955505371, 4.01317834854126, 3.261751651763916, 4.578895568847656, 2.7375073432922363, 1.6168246269226074, 4.780296325683594, 3.6812500953674316, 3.8990836143493652, 4.05935001373291, 5.267378807067871, 5.408997535705566, 3.6953976154327393, 1.920677661895752, 3.6393165588378906, 3.443227767944336, 3.137906312942505, 3.9293718338012695, 4.043885231018066, 2.8743176460266113, 3.594113826751709, 2.030306100845337, 5.774243354797363, 3.5920498371124268, 4.658077239990234, 3.3422493934631348, 1.5933732986450195, 3.285625457763672, 3.720216751098633, 3.7227425575256348, 2.7120559215545654, 4.438004970550537, 3.772125720977783, 3.6497769355773926, 3.859941005706787, 2.0002074241638184, 4.086014747619629, 5.0359086990356445, 4.503807544708252, 4.405657768249512, 2.3900866508483887, 3.709202527999878, 4.555529594421387, 4.000635147094727, 4.011743545532227, 2.443966865539551, 3.977607250213623, 5.9885711669921875, 3.3013505935668945, 5.2003326416015625, 3.9175267219543457, 2.9297051429748535, 3.4096131324768066, 2.695805072784424, 3.131134033203125, 2.122365951538086, 4.436248302459717, 4.524543762207031, 4.086808681488037, 4.1652936935424805, 3.9308035373687744, 3.1620354652404785, 2.6634907722473145, 3.1694493293762207, 3.017120599746704, 3.1801342964172363, 2.913048267364502, 1.7363909482955933, 3.6109395027160645, 1.5060465335845947, 3.418388843536377, 4.668953895568848, 2.5395216941833496, 4.06829833984375, 2.960096836090088, 2.7409286499023438, 4.096620559692383, 5.0103230476379395, 2.1302263736724854, 4.041900634765625], "mean_td_error": 3.561406373977661, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 11.0, "diff_num_grad_updates_vs_sampler_policy": 10.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.069104194641113, "actor_loss": -4.236937046051025, "critic_loss": 2.082392454147339, "alpha_loss": -0.030216960236430168, "alpha_value": 0.9970035552978516, "log_alpha_value": -0.0030009581241756678, "target_entropy": -6.0, "policy_t": 0.018261367455124855, "mean_q": 0.18475548923015594, "max_q": 0.22650492191314697, "min_q": 0.14992821216583252}, "td_error": [4.439234733581543, 4.170480251312256, 4.392360687255859, 3.3511910438537598, 4.134224891662598, 2.6597235202789307, 4.645059108734131, 2.875321388244629, 5.576498985290527, 3.88806414604187, 4.799370765686035, 3.8580570220947266, 1.4469530582427979, 3.4491143226623535, 3.364778995513916, 1.694428563117981, 3.6005988121032715, 1.90163254737854, 2.4068684577941895, 4.513372421264648, 3.264735221862793, 3.4194869995117188, 4.207640171051025, 3.744673252105713, 2.915701150894165, 2.8421831130981445, 2.894001007080078, 3.0750908851623535, 2.550936698913574, 2.7871384620666504, 5.217887878417969, 3.539105176925659, 4.4759674072265625, 1.9800975322723389, 4.284042835235596, 1.8008114099502563, 2.129204273223877, 5.223689079284668, 5.189342021942139, 3.1347298622131348, 2.4631171226501465, 2.564119815826416, 3.553213119506836, 3.9636740684509277, 5.002269744873047, 3.4657137393951416, 1.4635345935821533, 3.224452018737793, 2.920780658721924, 1.626690149307251, 2.632054567337036, 2.720471143722534, 4.185136795043945, 4.0453033447265625, 4.883325576782227, 4.742600440979004, 3.961719512939453, 3.8015995025634766, 3.470555067062378, 4.079315185546875, 2.9100589752197266, 3.7083547115325928, 3.0802900791168213, 4.308483123779297, 4.686201572418213, 5.113554000854492, 4.531866550445557, 3.6562445163726807, 4.497157096862793, 2.103135347366333, 3.8638103008270264, 2.734982967376709, 3.337965488433838, 2.7943499088287354, 3.258908271789551, 4.236907005310059, 4.298493385314941, 1.9736214876174927, 1.9894604682922363, 4.6861467361450195, 2.3872110843658447, 3.2340078353881836, 3.7146615982055664, 3.6665830612182617, 3.6304101943969727, 2.0558314323425293], "mean_td_error": 3.477583169937134, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 11.0, "diff_num_grad_updates_vs_sampler_policy": 10.0}}, "num_env_steps_sampled": 10752, "num_env_steps_trained": 2838, "num_agent_steps_sampled": 32256, "num_agent_steps_trained": 2838, "last_target_update_ts": 10752, "num_target_updates": 11}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32256, "num_agent_steps_trained": 2838, "num_env_steps_sampled": 10752, "num_env_steps_trained": 2838, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 369.2919312470348, "num_env_steps_trained_throughput_per_sec": 106.33629270282923, "timesteps_total": 10752, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 32256, "timers": {"training_iteration_time_ms": 2059.913, "sample_time_ms": 1446.087, "load_time_ms": 0.567, "load_throughput": 455403.767, "learn_time_ms": 64.79, "learn_throughput": 3982.122, "synch_weights_time_ms": 16.679}, "counters": {"num_env_steps_sampled": 10752, "num_env_steps_trained": 2838, "num_agent_steps_sampled": 32256, "num_agent_steps_trained": 2838, "last_target_update_ts": 10752, "num_target_updates": 11}, "done": false, "episodes_total": 0, "training_iteration": 12, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-15-08", "timestamp": 1700201708, "time_this_iter_s": 2.4412360191345215, "time_total_s": 26.255303621292114, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8c8ad7ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 26.255303621292114, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 77.46666666666667, "ram_util_percent": 90.86666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.078987121582031, "actor_loss": -4.252809524536133, "critic_loss": 4.852544784545898, "alpha_loss": -0.03325362130999565, "alpha_value": 0.9967061281204224, "log_alpha_value": -0.0032993019558489323, "target_entropy": -6.0, "policy_t": -0.004183923825621605, "mean_q": 0.19110670685768127, "max_q": 0.24739211797714233, "min_q": 0.14961832761764526}, "td_error": [4.253896713256836, 6.070401191711426, 5.807698726654053, 5.164262771606445, 5.113533020019531, 6.187107086181641, 6.98978328704834, 6.964591026306152, 5.543335914611816, 5.572548866271973, 4.81541109085083, 4.905279159545898, 5.2440900802612305, 5.406274318695068, 6.289140701293945, 5.896671295166016, 3.287952184677124, 4.6325178146362305, 5.825408458709717, 7.314711093902588, 2.58056640625, 5.845901012420654, 6.474170207977295, 5.376908779144287, 6.652430534362793, 3.948012590408325, 4.553083896636963, 4.655673027038574, 5.804721832275391, 5.690263748168945, 5.690362453460693, 4.793770790100098, 6.179941177368164, 5.273567199707031, 5.439033031463623, 3.3836874961853027, 5.538267612457275, 7.165844917297363, 4.146763324737549, 4.563459396362305, 8.069561004638672, 5.705122470855713, 4.826903343200684, 6.458491325378418, 5.415502548217773, 6.023754119873047, 4.617119789123535, 5.778443336486816, 4.717035293579102, 5.057785511016846, 4.310341835021973, 6.091909408569336, 5.924168586730957, 3.406283378601074, 4.951074600219727, 5.523075580596924, 5.299920082092285, 6.299983024597168, 6.149309158325195, 5.0926194190979, 6.976557731628418, 6.01338005065918, 3.8693408966064453, 6.565029144287109, 5.434587478637695, 4.765528202056885, 7.478854179382324, 5.56646728515625, 4.907886028289795, 5.480051040649414, 5.635852813720703, 5.095552444458008, 6.087952613830566, 6.091889381408691, 6.601530075073242, 7.312368392944336, 6.929448127746582, 6.005620002746582, 6.231450080871582, 6.259067535400391, 3.6215882301330566, 7.446527481079102, 6.5806379318237305, 5.33113431930542, 6.539144515991211, 5.493905067443848], "mean_td_error": 5.570707321166992, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 12.0, "diff_num_grad_updates_vs_sampler_policy": 11.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.080188751220703, "actor_loss": -4.291784286499023, "critic_loss": 2.892561435699463, "alpha_loss": -0.03326739743351936, "alpha_value": 0.996705174446106, "log_alpha_value": -0.0033002751879394054, "target_entropy": -6.0, "policy_t": -0.012242882512509823, "mean_q": 0.23266074061393738, "max_q": 0.28799980878829956, "min_q": 0.19080804288387299}, "td_error": [2.7034287452697754, 2.5181641578674316, 4.8675689697265625, 3.3538880348205566, 3.853579044342041, 4.720245361328125, 5.224475383758545, 4.348598480224609, 2.9589004516601562, 3.819149971008301, 4.169160842895508, 2.9798996448516846, 3.6882331371307373, 3.242825984954834, 2.4695000648498535, 1.9853578805923462, 4.674765586853027, 3.3105690479278564, 2.710939645767212, 2.6416072845458984, 3.727336883544922, 4.626193046569824, 2.643550395965576, 4.21265172958374, 3.2259175777435303, 0.005048669874668121, 2.961869716644287, 3.4576964378356934, 4.20424222946167, 3.093038558959961, 3.3398642539978027, 3.0448684692382812, 3.282203435897827, 2.912137031555176, 3.701493978500366, 4.053569793701172, 1.883357048034668, 4.802130222320557, 1.8306803703308105, 4.415943145751953, 4.097994804382324, 4.148531913757324, 5.144851207733154, 2.1958374977111816, 3.050894021987915, 2.3730649948120117, 3.2101218700408936, 3.0332796573638916, 2.39105224609375, 3.636570692062378, 3.79123592376709, 3.5706262588500977, 6.141493797302246, 3.620650291442871, 3.7088828086853027, 2.3000311851501465, 5.12595272064209, 3.428051233291626, 4.568001747131348, 3.729393482208252, 3.899893283843994, 2.555055856704712, 3.730696201324463, 3.816678524017334, 3.7689948081970215, 4.381547927856445, 1.5293080806732178, 3.0153298377990723, 3.8834118843078613, 3.2446579933166504, 4.415460586547852, 3.2435789108276367, 3.884970188140869, 3.900212287902832, 3.4863955974578857, 4.2168426513671875, 4.5832085609436035, 1.8852531909942627, 4.907294273376465, 2.822071075439453, 3.6376943588256836, 4.893389701843262, 1.8640310764312744, 4.540791988372803, 3.7954115867614746, 5.221674919128418], "mean_td_error": 3.5355234146118164, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 12.0, "diff_num_grad_updates_vs_sampler_policy": 11.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.05277156829834, "actor_loss": -4.246835708618164, "critic_loss": 2.072312831878662, "alpha_loss": -0.03318656608462334, "alpha_value": 0.9967042207717896, "log_alpha_value": -0.003301235381513834, "target_entropy": -6.0, "policy_t": 0.03097417950630188, "mean_q": 0.2143956571817398, "max_q": 0.24942173063755035, "min_q": 0.18174870312213898}, "td_error": [0.9660117626190186, 3.6450607776641846, 1.810715913772583, 3.408674478530884, 2.9941704273223877, 2.3831424713134766, 3.3169198036193848, 4.465699195861816, 2.0752389430999756, 4.7991132736206055, 3.138152599334717, 4.023537635803223, 3.1547441482543945, 4.962878227233887, 3.987922191619873, 4.339099884033203, 3.119476556777954, 3.289389133453369, 4.751284599304199, 2.6299779415130615, 5.6756744384765625, 3.6838252544403076, 3.344858169555664, 3.1788229942321777, 2.868682384490967, 2.0281925201416016, 3.6939282417297363, 1.790535569190979, 1.8231137990951538, 5.073031425476074, 4.882740020751953, 2.9488916397094727, 3.2457356452941895, 4.046451568603516, 3.3388214111328125, 4.164480209350586, 3.9796619415283203, 2.173096179962158, 1.5984547138214111, 3.8962576389312744, 5.533524513244629, 4.106030464172363, 3.645125389099121, 3.1544923782348633, 3.2065370082855225, 3.0234508514404297, 5.048740386962891, 3.2134344577789307, 5.561527252197266, 4.116453170776367, 4.350804328918457, 5.130008697509766, 3.627696990966797, 4.361993789672852, 3.4916155338287354, 3.09108829498291, 2.5929057598114014, 4.727944374084473, 3.629734516143799, 2.950488328933716, 3.8339924812316895, 1.8303064107894897, 2.339390993118286, 2.842298984527588, 5.253069877624512, 3.468134880065918, 3.0899953842163086, 4.517032623291016, 2.459146022796631, 3.3906755447387695, 5.113974571228027, 2.553384780883789, 1.8266525268554688, 2.759669542312622, 2.741061210632324, 1.3305355310440063, 4.809131622314453, 4.385344505310059, 2.6356239318847656, 3.897019624710083, 4.4129204750061035, 4.668334484100342, 4.813413619995117, 1.8851730823516846, 4.023420333862305, 1.8128695487976074], "mean_td_error": 3.487821340560913, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 12.0, "diff_num_grad_updates_vs_sampler_policy": 11.0}}, "num_env_steps_sampled": 11648, "num_env_steps_trained": 3096, "num_agent_steps_sampled": 34944, "num_agent_steps_trained": 3096, "last_target_update_ts": 11648, "num_target_updates": 12}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 34944, "num_agent_steps_trained": 3096, "num_env_steps_sampled": 11648, "num_env_steps_trained": 3096, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 503.881975043331, "num_env_steps_trained_throughput_per_sec": 145.09101513524487, "timesteps_total": 11648, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 34944, "timers": {"training_iteration_time_ms": 2041.82, "sample_time_ms": 1427.446, "load_time_ms": 0.568, "load_throughput": 454123.309, "learn_time_ms": 64.683, "learn_throughput": 3988.702, "synch_weights_time_ms": 16.613}, "counters": {"num_env_steps_sampled": 11648, "num_env_steps_trained": 3096, "num_agent_steps_sampled": 34944, "num_agent_steps_trained": 3096, "last_target_update_ts": 11648, "num_target_updates": 12}, "done": false, "episodes_total": 0, "training_iteration": 13, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-15-09", "timestamp": 1700201709, "time_this_iter_s": 1.795409917831421, "time_total_s": 28.050713539123535, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8c8ad73a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 28.050713539123535, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 62.46666666666667, "ram_util_percent": 90.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.150649070739746, "actor_loss": -4.346895217895508, "critic_loss": 4.805897235870361, "alpha_loss": -0.03653623163700104, "alpha_value": 0.9964070916175842, "log_alpha_value": -0.0035993990022689104, "target_entropy": -6.0, "policy_t": -0.024431468918919563, "mean_q": 0.21537549793720245, "max_q": 0.28306087851524353, "min_q": 0.17328372597694397}, "td_error": [5.905363082885742, 5.287142276763916, 5.246767997741699, 4.665604114532471, 6.478052616119385, 3.802330732345581, 7.396655559539795, 5.523324012756348, 6.8021464347839355, 3.7869668006896973, 7.276681900024414, 6.708004951477051, 4.839425086975098, 6.4635138511657715, 7.246813774108887, 4.563936233520508, 4.630366325378418, 5.96131706237793, 5.295187950134277, 5.681926727294922, 5.077713966369629, 3.73158597946167, 6.413834095001221, 5.815513610839844, 4.41801643371582, 6.236269950866699, 5.866541862487793, 5.906233787536621, 5.858553886413574, 6.319167613983154, 6.803630828857422, 5.2661848068237305, 7.301792144775391, 5.259037971496582, 4.808984756469727, 4.402050971984863, 3.905358076095581, 6.211337089538574, 5.2820329666137695, 5.949252605438232, 6.01008939743042, 5.727241516113281, 5.427463531494141, 6.3311920166015625, 6.256218433380127, 5.785306930541992, 5.530231475830078, 6.05126428604126, 4.239062309265137, 6.776572227478027, 4.504273891448975, 8.11915397644043, 5.040802001953125, 3.710268020629883, 5.12974739074707, 7.770959854125977, 5.977187156677246, 6.463706016540527, 5.590639114379883, 5.09853458404541, 5.57172155380249, 5.492427825927734, 5.537985801696777, 6.018339157104492, 5.13189697265625, 5.290624618530273, 3.8250603675842285, 6.057109832763672, 6.173126220703125, 6.777976989746094, 6.02082633972168, 4.790858268737793, 5.060781955718994, 5.900681495666504, 4.947484016418457, 4.8955488204956055, 7.434202671051025, 5.175503730773926, 5.125702381134033, 5.633260726928711, 5.79404878616333, 5.755727767944336, 4.1872334480285645, 6.119891166687012, 7.216893196105957, 6.041802883148193], "mean_td_error": 5.650130271911621, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 13.0, "diff_num_grad_updates_vs_sampler_policy": 12.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.104850769042969, "actor_loss": -4.35472297668457, "critic_loss": 0.7869607210159302, "alpha_loss": -0.03638286516070366, "alpha_value": 0.9964059591293335, "log_alpha_value": -0.003600534051656723, "target_entropy": -6.0, "policy_t": -0.03197706863284111, "mean_q": 0.26235538721084595, "max_q": 0.3199278712272644, "min_q": 0.20864897966384888}, "td_error": [4.693184852600098, 1.1363458633422852, 2.8207902908325195, 3.524258852005005, 3.0972814559936523, 2.3769044876098633, 4.292421340942383, 3.916186809539795, 2.525338649749756, 2.9246397018432617, 3.7173166275024414, 2.820793628692627, 3.8096835613250732, 3.0094046592712402, 4.531924247741699, 1.8661551475524902, 4.111898899078369, 4.335738182067871, 2.911233425140381, 2.5497894287109375, 3.648073673248291, 2.5844905376434326, 4.068904876708984, 3.1255297660827637, 2.2193262577056885, 2.1138038635253906, 2.1880645751953125, 2.901024341583252, 2.563586711883545, 4.818988800048828, 3.9380946159362793, 3.4981749057769775, 4.372831344604492, 3.9670796394348145, 3.4867870807647705, 5.386537551879883, 3.916626453399658, 3.6446216106414795, 2.7021756172180176, 4.013889312744141, 3.31773042678833, 3.210857391357422, 1.538031816482544, 3.4339451789855957, 2.7432470321655273, 4.097733497619629, 3.0141377449035645, 3.8737800121307373, 3.7858102321624756, 3.8063015937805176, 3.9393744468688965, 3.7987773418426514, 2.6635398864746094, 4.115053653717041, 2.708298683166504, 3.8373639583587646, 3.6790475845336914, 2.5889410972595215, 5.3916120529174805, 4.718971252441406, 5.12072229385376, 3.2229161262512207, 3.427577495574951, 2.9811010360717773, 3.3072705268859863, 4.497714996337891, 3.3513131141662598, 4.138923645019531, 2.6466939449310303, 4.128276348114014, 2.8273518085479736, 2.3243720531463623, 1.7304308414459229, 4.827808380126953, 3.45090389251709, 2.8308913707733154, 5.048398017883301, 2.9172472953796387, 3.282517910003662, 3.76442813873291, 2.388700485229492, 2.797971487045288, 4.40131950378418, 2.873384952545166, 3.8665084838867188, 2.2428388595581055], "mean_td_error": 3.4045352935791016, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 13.0, "diff_num_grad_updates_vs_sampler_policy": 12.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.095935821533203, "actor_loss": -4.317364692687988, "critic_loss": 2.1771841049194336, "alpha_loss": -0.03635992109775543, "alpha_value": 0.9964050650596619, "log_alpha_value": -0.0036014411598443985, "target_entropy": -6.0, "policy_t": -0.0032445411197841167, "mean_q": 0.2465127408504486, "max_q": 0.29910191893577576, "min_q": 0.20721685886383057}, "td_error": [4.282248497009277, 4.801257133483887, 4.144317626953125, 2.8544628620147705, 4.952882766723633, 6.130105018615723, 1.1520588397979736, 2.0339903831481934, 4.481265544891357, 5.581683158874512, 3.9550516605377197, 3.24526047706604, 4.184226036071777, 3.229219436645508, 4.477542877197266, 3.962512493133545, 3.272031307220459, 2.960042715072632, 4.6473588943481445, 3.1345012187957764, 3.661306381225586, 3.0857315063476562, 5.302221775054932, 2.8278064727783203, 4.267555236816406, 2.415722131729126, 4.418848037719727, 2.2023956775665283, 1.6727077960968018, 5.027773857116699, 3.7286577224731445, 3.880500316619873, 2.1782402992248535, 5.40818977355957, 2.856687545776367, 2.4093878269195557, 2.391855478286743, 3.850688934326172, 1.6972776651382446, 2.8867971897125244, 3.319756507873535, 2.1812524795532227, 3.877096652984619, 3.457615375518799, 3.8505983352661133, 3.924473285675049, 5.0268330574035645, 2.7447285652160645, 5.350000381469727, 3.1217904090881348, 3.3485217094421387, 4.524012088775635, 2.268514633178711, 3.4604506492614746, 1.7847098112106323, 4.885096073150635, 3.118030548095703, 3.855991840362549, 2.0849711894989014, 3.85391902923584, 3.0992071628570557, 2.2178492546081543, 3.294015884399414, 4.7220458984375, 5.135684967041016, 4.0687689781188965, 3.5502994060516357, 3.6618175506591797, 2.6083788871765137, 4.880415439605713, 3.6194567680358887, 4.17464542388916, 2.793123722076416, 2.545166015625, 5.400500774383545, 4.666792869567871, 4.583004951477051, 5.15815544128418, 5.633963108062744, 3.8448164463043213, 2.127915382385254, 3.149846076965332, 5.445428848266602, 3.735258102416992, 2.1878952980041504, 2.332552909851074], "mean_td_error": 3.631718158721924, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 13.0, "diff_num_grad_updates_vs_sampler_policy": 12.0}}, "num_env_steps_sampled": 12544, "num_env_steps_trained": 3354, "num_agent_steps_sampled": 37632, "num_agent_steps_trained": 3354, "last_target_update_ts": 12544, "num_target_updates": 13}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37632, "num_agent_steps_trained": 3354, "num_env_steps_sampled": 12544, "num_env_steps_trained": 3354, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 469.07731239323397, "num_env_steps_trained_throughput_per_sec": 135.06913682751605, "timesteps_total": 12544, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 37632, "timers": {"training_iteration_time_ms": 2051.101, "sample_time_ms": 1438.02, "load_time_ms": 0.57, "load_throughput": 452698.474, "learn_time_ms": 64.512, "learn_throughput": 3999.259, "synch_weights_time_ms": 16.655}, "counters": {"num_env_steps_sampled": 12544, "num_env_steps_trained": 3354, "num_agent_steps_sampled": 37632, "num_agent_steps_trained": 3354, "last_target_update_ts": 12544, "num_target_updates": 13}, "done": false, "episodes_total": 0, "training_iteration": 14, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-15-11", "timestamp": 1700201711, "time_this_iter_s": 1.9237890243530273, "time_total_s": 29.974502563476562, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8c8ad75e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 29.974502563476562, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 88.7, "ram_util_percent": 90.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.090449333190918, "actor_loss": -4.317032337188721, "critic_loss": 4.480826377868652, "alpha_loss": -0.03934897482395172, "alpha_value": 0.9961079955101013, "log_alpha_value": -0.00389962550252676, "target_entropy": -6.0, "policy_t": 0.024226564913988113, "mean_q": 0.24392199516296387, "max_q": 0.28805020451545715, "min_q": 0.20436467230319977}, "td_error": [6.166409015655518, 5.019603729248047, 7.287841320037842, 5.492218971252441, 5.075013160705566, 5.096795082092285, 3.5067200660705566, 5.670015335083008, 5.66136360168457, 5.059628486633301, 6.174037933349609, 5.923332214355469, 5.5759429931640625, 3.93208909034729, 3.396148681640625, 5.069845199584961, 7.398164749145508, 5.122834205627441, 5.598080158233643, 4.695685386657715, 5.987226486206055, 5.701732635498047, 5.078895568847656, 4.67397403717041, 5.939544677734375, 4.2130045890808105, 5.69222354888916, 5.946268558502197, 3.764592170715332, 4.585844039916992, 4.590237617492676, 3.010896682739258, 5.513498306274414, 7.538157939910889, 5.4352312088012695, 4.081395626068115, 5.4276323318481445, 5.702513217926025, 3.6310997009277344, 6.265658855438232, 5.701621055603027, 3.406707286834717, 5.988465309143066, 5.085541248321533, 4.389115333557129, 4.985503196716309, 3.8552911281585693, 6.457534313201904, 7.7593278884887695, 6.102832794189453, 5.221671104431152, 4.820428848266602, 5.358844757080078, 6.5832343101501465, 6.31976842880249, 4.738366603851318, 6.085309982299805, 5.020886421203613, 6.369550704956055, 3.228419780731201, 3.7120089530944824, 4.337828636169434, 5.1911821365356445, 5.864467144012451, 6.323986053466797, 5.266079902648926, 5.824132919311523, 4.682147979736328, 5.676736354827881, 5.345390319824219, 5.334473133087158, 6.497258186340332, 6.722668647766113, 6.452249050140381, 4.944709777832031, 4.303053855895996, 4.386784553527832, 4.280464172363281, 6.641873836517334, 4.736080169677734, 4.706373691558838, 4.847708702087402, 6.0300703048706055, 3.980276584625244, 5.328258991241455, 3.7744250297546387], "mean_td_error": 5.260121822357178, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 14.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0673189163208, "actor_loss": -4.342283248901367, "critic_loss": 0.8035738468170166, "alpha_loss": -0.03927096351981163, "alpha_value": 0.996106743812561, "log_alpha_value": -0.0039008362218737602, "target_entropy": -6.0, "policy_t": -0.037129905074834824, "mean_q": 0.3008536994457245, "max_q": 0.3692014515399933, "min_q": 0.2335357367992401}, "td_error": [5.135031223297119, 1.8610999584197998, 3.55415678024292, 2.6892099380493164, 3.1403560638427734, 4.000891208648682, 3.4081220626831055, 5.007746696472168, 4.4030656814575195, 3.6939592361450195, 3.09981107711792, 5.87893009185791, 2.669491767883301, 4.119306564331055, 4.607367515563965, 4.533960342407227, 2.7267723083496094, 3.4834365844726562, 3.5889341831207275, 3.3588061332702637, 4.246060371398926, 2.685089349746704, 4.877549171447754, 3.368338108062744, 2.987973213195801, 3.7506113052368164, 2.56768536567688, 3.9722864627838135, 1.7025243043899536, 3.727419137954712, 3.899995803833008, 3.1343250274658203, 2.7604079246520996, 2.9867613315582275, 1.737842082977295, 3.402444362640381, 3.898712635040283, 4.064881801605225, 2.461881399154663, 5.558351516723633, 4.361379623413086, 4.240283012390137, 3.7449517250061035, 3.3972935676574707, 4.038642406463623, 4.62477970123291, 3.041210174560547, 1.4772557020187378, 3.754232406616211, 3.7988486289978027, 3.484311103820801, 4.248426914215088, 2.6136670112609863, 2.6906678676605225, 3.0817389488220215, 5.825385093688965, 4.088794708251953, 2.988149642944336, 3.6453728675842285, 3.186737060546875, 3.6029043197631836, 3.347970962524414, 4.1567769050598145, 2.3706398010253906, 2.2026376724243164, 5.018190383911133, 4.750514984130859, 3.125777244567871, 2.601229667663574, 2.2914395332336426, 3.5592706203460693, 3.867635726928711, 4.862175464630127, 3.1455702781677246, 2.1939961910247803, 3.252397060394287, 3.1080732345581055, 3.686535358428955, 1.9378324747085571, 2.2338850498199463, 5.246288299560547, 3.574341297149658, 1.4298206567764282, 3.2495601177215576, 3.8623080253601074, 4.426179885864258], "mean_td_error": 3.513810157775879, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 14.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.010282516479492, "actor_loss": -4.2634382247924805, "critic_loss": 2.0076985359191895, "alpha_loss": -0.03905673325061798, "alpha_value": 0.996105968952179, "log_alpha_value": -0.0039016613736748695, "target_entropy": -6.0, "policy_t": 0.008310901001095772, "mean_q": 0.2730625867843628, "max_q": 0.3283257484436035, "min_q": 0.21868561208248138}, "td_error": [4.2215118408203125, 2.493715286254883, 4.1596879959106445, 4.721214294433594, 1.6412010192871094, 4.373201370239258, 2.375607967376709, 3.569007396697998, 4.782343864440918, 3.9851624965667725, 5.287910461425781, 3.7237088680267334, 2.3317975997924805, 2.312373161315918, 2.378584146499634, 5.852155685424805, 2.7268197536468506, 3.460597276687622, 5.473596572875977, 2.006716728210449, 3.3158249855041504, 5.69117546081543, 5.491324424743652, 1.9535778760910034, 2.309443473815918, 4.239995956420898, 4.892420768737793, 4.061566352844238, 4.164580345153809, 3.6616837978363037, 4.397111892700195, 1.8594664335250854, 1.4799906015396118, 2.8824377059936523, 4.427926063537598, 4.3358259201049805, 2.0130109786987305, 4.649717807769775, 4.037083625793457, 3.240694284439087, 3.4919357299804688, 4.015237808227539, 4.21321964263916, 2.5506367683410645, 2.4258933067321777, 1.7961339950561523, 4.812429428100586, 2.03395676612854, 3.512718677520752, 2.002389907836914, 2.8407559394836426, 3.448500156402588, 3.276249885559082, 4.4474992752075195, 3.2963004112243652, 4.394791603088379, 3.8020834922790527, 3.1817240715026855, 2.8106064796447754, 0.7356772422790527, 2.8302173614501953, 4.697141647338867, 2.7237191200256348, 3.352224826812744, 4.254725933074951, 4.161153793334961, 2.670114517211914, 3.007384777069092, 5.018333435058594, 2.643895149230957, 3.488962173461914, 2.2239935398101807, 2.5163183212280273, 3.6390256881713867, 3.7673897743225098, 3.4689242839813232, 0.7412952184677124, 4.056048393249512, 4.011877059936523, 3.3708505630493164, 3.99308443069458, 3.145798921585083, 2.4930617809295654, 2.8792262077331543, 5.02790641784668, 2.3774683475494385], "mean_td_error": 3.4259376525878906, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 14.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 13440, "num_env_steps_trained": 3612, "num_agent_steps_sampled": 40320, "num_agent_steps_trained": 3612, "last_target_update_ts": 13440, "num_target_updates": 14}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40320, "num_agent_steps_trained": 3612, "num_env_steps_sampled": 13440, "num_env_steps_trained": 3612, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 468.716809514782, "num_env_steps_trained_throughput_per_sec": 134.96533131117607, "timesteps_total": 13440, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 40320, "timers": {"training_iteration_time_ms": 2059.355, "sample_time_ms": 1448.42, "load_time_ms": 0.574, "load_throughput": 449371.053, "learn_time_ms": 64.277, "learn_throughput": 4013.868, "synch_weights_time_ms": 16.349}, "counters": {"num_env_steps_sampled": 13440, "num_env_steps_trained": 3612, "num_agent_steps_sampled": 40320, "num_agent_steps_trained": 3612, "last_target_update_ts": 13440, "num_target_updates": 14}, "done": false, "episodes_total": 0, "training_iteration": 15, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-15-13", "timestamp": 1700201713, "time_this_iter_s": 1.927696704864502, "time_total_s": 31.902199268341064, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8c884d160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 31.902199268341064, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 62.73333333333333, "ram_util_percent": 90.59999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.121503829956055, "actor_loss": -4.3734564781188965, "critic_loss": 4.637415409088135, "alpha_loss": -0.04250883683562279, "alpha_value": 0.9958089590072632, "log_alpha_value": -0.004199853632599115, "target_entropy": -6.0, "policy_t": -0.035865768790245056, "mean_q": 0.27698078751564026, "max_q": 0.34070688486099243, "min_q": 0.23073594272136688}, "td_error": [4.815916061401367, 6.598880767822266, 4.808399677276611, 6.190104961395264, 6.2119598388671875, 6.531900882720947, 7.380067825317383, 5.4244537353515625, 6.008434295654297, 5.702557563781738, 7.231536388397217, 4.505214691162109, 7.544235706329346, 4.937290191650391, 5.547062873840332, 6.412187576293945, 5.241179466247559, 5.661220073699951, 6.824522972106934, 5.6004109382629395, 6.032977104187012, 5.130392551422119, 6.19141960144043, 4.485204696655273, 4.5906219482421875, 6.796320915222168, 4.2719221115112305, 6.226858139038086, 3.352996826171875, 6.697155952453613, 4.583986759185791, 4.905152320861816, 5.215517997741699, 5.474508285522461, 7.036582946777344, 6.3133745193481445, 4.715815544128418, 6.2562785148620605, 6.17162561416626, 3.4814233779907227, 4.974377632141113, 6.201812744140625, 4.859143257141113, 4.0428266525268555, 5.747006416320801, 5.2582926750183105, 6.0759382247924805, 5.167386054992676, 6.092184066772461, 5.1152238845825195, 6.439730167388916, 4.626620292663574, 5.467016696929932, 5.813786506652832, 4.778031349182129, 5.976382255554199, 5.215537071228027, 4.904702186584473, 4.849374294281006, 5.288819313049316, 3.729372501373291, 3.658419132232666, 7.095329284667969, 4.798099517822266, 4.022722244262695, 6.778691291809082, 4.874114513397217, 4.2084455490112305, 4.420274257659912, 5.627882957458496, 3.8006465435028076, 4.404842376708984, 4.736307144165039, 6.732541084289551, 6.374794960021973, 3.0699939727783203, 6.301969528198242, 4.160062789916992, 5.1003923416137695, 3.9695777893066406, 6.0963544845581055, 4.669033527374268, 3.849622964859009, 5.065279006958008, 4.66807222366333, 5.515072345733643], "mean_td_error": 5.368951320648193, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 15.0, "diff_num_grad_updates_vs_sampler_policy": 14.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.086103439331055, "actor_loss": -4.392670154571533, "critic_loss": 0.8040429949760437, "alpha_loss": -0.04237280786037445, "alpha_value": 0.9958077073097229, "log_alpha_value": -0.004201108124107122, "target_entropy": -6.0, "policy_t": 0.032559026032686234, "mean_q": 0.32952678203582764, "max_q": 0.39839640259742737, "min_q": 0.2803015112876892}, "td_error": [2.5889508724212646, 4.260581970214844, 4.447218894958496, 2.9461939334869385, 3.1744723320007324, 3.9204769134521484, 4.53468132019043, 4.0703582763671875, 3.1092581748962402, 3.563253879547119, 5.253578186035156, 3.382403612136841, 4.679414749145508, 2.5375447273254395, 3.532621383666992, 4.334954261779785, 3.248340129852295, 3.491356372833252, 2.374645233154297, 3.399216413497925, 1.0419683456420898, 2.0852136611938477, 4.373394966125488, 1.7021905183792114, 3.413226842880249, 4.499524116516113, 2.815366744995117, 3.282393455505371, 2.432097911834717, 3.851856231689453, 5.193646430969238, 2.9298338890075684, 1.521409273147583, 5.009652137756348, 4.40313196182251, 3.1251015663146973, 3.3782029151916504, 3.251789093017578, 3.9813129901885986, 2.4520812034606934, 4.426019668579102, 4.346811771392822, 4.8226752281188965, 3.4279675483703613, 5.112003326416016, 0.7669512629508972, 2.7136688232421875, 3.388850212097168, 3.946194648742676, 3.4411630630493164, 3.92246150970459, 3.0552849769592285, 2.723158836364746, 3.773111343383789, 3.4766910076141357, 2.9525790214538574, 2.4223239421844482, 2.567878246307373, 2.5086703300476074, 2.351062536239624, 6.960738182067871, 5.114777565002441, 4.207157135009766, 2.6612398624420166, 3.8589727878570557, 2.6592416763305664, 3.2645137310028076, 5.164082050323486, 1.2324298620224, 1.6280667781829834, 4.506600379943848, 4.930939674377441, 3.3439297676086426, 3.7313971519470215, 3.630361795425415, 1.8820654153823853, 2.456237316131592, 4.533788681030273, 3.838637590408325, 3.73646879196167, 2.048581600189209, 3.1808743476867676, 3.1209652423858643, 4.325717926025391, 3.562781810760498, 3.8173797130584717], "mean_td_error": 3.4550743103027344, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 15.0, "diff_num_grad_updates_vs_sampler_policy": 14.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.126282691955566, "actor_loss": -4.411154270172119, "critic_loss": 2.045602560043335, "alpha_loss": -0.042548052966594696, "alpha_value": 0.9958070516586304, "log_alpha_value": -0.004201744683086872, "target_entropy": -6.0, "policy_t": -0.0017155460081994534, "mean_q": 0.3103083074092865, "max_q": 0.3591669797897339, "min_q": 0.24405957758426666}, "td_error": [3.2979416847229004, 2.3985252380371094, 2.6812586784362793, 2.528247833251953, 3.489295482635498, 3.402296543121338, 3.526883602142334, 2.955933094024658, 2.3669657707214355, 3.7456233501434326, 2.6902992725372314, 3.078063488006592, 3.0478148460388184, 4.888578414916992, 3.109694004058838, 1.7366806268692017, 3.324483871459961, 2.8346002101898193, 5.238816261291504, 2.9073121547698975, 2.493795156478882, 3.0655617713928223, 4.732608795166016, 2.913496255874634, 2.9646010398864746, 2.187952995300293, 3.3734426498413086, 3.939646005630493, 5.705015182495117, 3.485323905944824, 4.223844528198242, 2.7394206523895264, 2.924466609954834, 2.3039355278015137, 4.360259056091309, 1.668274164199829, 3.9372525215148926, 3.5893497467041016, 3.2208619117736816, 2.0046286582946777, 3.3789985179901123, 1.872162938117981, 3.899320125579834, 2.8374569416046143, 2.9676830768585205, 5.425852298736572, 3.313647747039795, 2.8845396041870117, 2.1694092750549316, 4.054454803466797, 3.7431089878082275, 3.643256425857544, 4.155926704406738, 3.7887206077575684, 3.0151560306549072, 3.175569534301758, 3.998016834259033, 0.4603304862976074, 4.993066787719727, 3.8217854499816895, 2.742151975631714, 3.565295457839966, 2.514382839202881, 4.053982734680176, 4.390672206878662, 4.098807334899902, 4.448808670043945, 4.711652755737305, 2.0708889961242676, 4.825329780578613, 4.956962585449219, 2.166907787322998, 3.902376413345337, 4.485134601593018, 4.871379852294922, 2.684424877166748, 4.106230735778809, 6.390743255615234, 4.634218692779541, 1.9930683374404907, 1.722405195236206, 4.549094200134277, 2.5405988693237305, 4.218731880187988, 3.2296390533447266, 3.1520941257476807], "mean_td_error": 3.415203332901001, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 15.0, "diff_num_grad_updates_vs_sampler_policy": 14.0}}, "num_env_steps_sampled": 14336, "num_env_steps_trained": 3870, "num_agent_steps_sampled": 43008, "num_agent_steps_trained": 3870, "last_target_update_ts": 14336, "num_target_updates": 15}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 43008, "num_agent_steps_trained": 3870, "num_env_steps_sampled": 14336, "num_env_steps_trained": 3870, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 496.4318566339455, "num_env_steps_trained_throughput_per_sec": 142.94578014682804, "timesteps_total": 14336, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 43008, "timers": {"training_iteration_time_ms": 2025.094, "sample_time_ms": 1435.938, "load_time_ms": 0.572, "load_throughput": 451339.019, "learn_time_ms": 64.173, "learn_throughput": 4020.398, "synch_weights_time_ms": 16.4}, "counters": {"num_env_steps_sampled": 14336, "num_env_steps_trained": 3870, "num_agent_steps_sampled": 43008, "num_agent_steps_trained": 3870, "last_target_update_ts": 14336, "num_target_updates": 15}, "done": false, "episodes_total": 0, "training_iteration": 16, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-15-15", "timestamp": 1700201715, "time_this_iter_s": 1.8237948417663574, "time_total_s": 33.72599411010742, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8c8ad7f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 33.72599411010742, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 61.800000000000004, "ram_util_percent": 90.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.05211353302002, "actor_loss": -4.337934494018555, "critic_loss": 4.621873378753662, "alpha_loss": -0.04523588344454765, "alpha_value": 0.9955099821090698, "log_alpha_value": -0.004500136245042086, "target_entropy": -6.0, "policy_t": 0.01889530010521412, "mean_q": 0.30895936489105225, "max_q": 0.3693416714668274, "min_q": 0.2554772198200226}, "td_error": [4.470613479614258, 6.7641730308532715, 6.493612289428711, 4.7268829345703125, 4.852071762084961, 6.306053638458252, 4.145842552185059, 5.244036674499512, 3.372159957885742, 5.482715606689453, 5.994546413421631, 5.463836193084717, 3.890622615814209, 4.800424575805664, 5.894440174102783, 5.838541030883789, 4.623572826385498, 4.364564895629883, 6.471843719482422, 3.799370288848877, 4.328937530517578, 6.0139875411987305, 6.012326240539551, 5.189899444580078, 2.6721997261047363, 7.645282745361328, 6.898923873901367, 4.560864448547363, 5.59154748916626, 6.121699333190918, 6.0422043800354, 5.703619003295898, 5.538760185241699, 6.691287994384766, 3.5584168434143066, 5.430818557739258, 4.215357780456543, 5.558640480041504, 6.857645034790039, 4.169369697570801, 3.5699055194854736, 5.781698226928711, 6.20789909362793, 7.226558208465576, 4.869810104370117, 2.7578516006469727, 5.51666259765625, 5.086853981018066, 5.123523712158203, 4.97214412689209, 5.483150482177734, 6.0269389152526855, 5.905691623687744, 6.235590934753418, 5.678446292877197, 4.870683670043945, 5.046802997589111, 5.632016181945801, 4.684411525726318, 4.542136192321777, 4.536888122558594, 6.060014247894287, 7.7255096435546875, 6.566178798675537, 3.218756914138794, 6.7068376541137695, 4.812833786010742, 5.319252014160156, 4.969427108764648, 5.40399169921875, 5.680203914642334, 4.50235652923584, 5.707645416259766, 6.432302951812744, 6.839070796966553, 4.868780612945557, 2.884645938873291, 5.793550491333008, 6.7765913009643555, 4.382948875427246, 6.026546478271484, 5.634947776794434, 3.385814666748047, 5.362753868103027, 3.362841844558716, 7.506176471710205], "mean_td_error": 5.319620609283447, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 16.0, "diff_num_grad_updates_vs_sampler_policy": 15.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.120804786682129, "actor_loss": -4.455621719360352, "critic_loss": 0.8110525608062744, "alpha_loss": -0.0455576591193676, "alpha_value": 0.9955087304115295, "log_alpha_value": -0.004501387011259794, "target_entropy": -6.0, "policy_t": -0.01277837436646223, "mean_q": 0.37152257561683655, "max_q": 0.4509482681751251, "min_q": 0.29093387722969055}, "td_error": [1.6478207111358643, 2.350834369659424, 5.703970909118652, 4.735080718994141, 3.167593479156494, 2.955933094024658, 3.572063684463501, 4.397899150848389, 2.053610324859619, 3.6452677249908447, 2.2726573944091797, 3.1892263889312744, 2.3982810974121094, 3.317366600036621, 4.328669548034668, 2.0022315979003906, 3.463432788848877, 3.5371193885803223, 3.0030951499938965, 4.351187229156494, 4.749759197235107, 3.854548692703247, 4.22740364074707, 2.987046718597412, 4.377911567687988, 3.8125967979431152, 0.9799062013626099, 3.3447322845458984, 4.770737648010254, 2.7744126319885254, 4.910135746002197, 2.2709741592407227, 3.33076548576355, 4.068084716796875, 2.0975441932678223, 1.960512638092041, 2.836228370666504, 3.1510772705078125, 2.598693370819092, 3.446770191192627, 3.910606861114502, 3.3073692321777344, 2.9939591884613037, 2.981619358062744, 3.2017955780029297, 3.747352123260498, 3.591902256011963, 2.6632676124572754, 4.493074417114258, 4.950849533081055, 1.3934016227722168, 3.159172534942627, 3.4246304035186768, 2.7605011463165283, 4.151969909667969, 4.741377830505371, 3.0925228595733643, 4.992559909820557, 2.642573356628418, 4.356942176818848, 4.900261878967285, 4.073681831359863, 2.106266498565674, 5.5012712478637695, 2.5147972106933594, 3.6267919540405273, 3.7800214290618896, 2.2540526390075684, 4.291123390197754, 3.2179789543151855, 3.312934398651123, 1.8653969764709473, 3.5253119468688965, 3.763519287109375, 2.461217164993286, 3.6377158164978027, 4.169086456298828, 3.9716956615448, 4.560484886169434, 4.292670249938965, 3.557515859603882, 2.9497647285461426, 3.4987072944641113, 3.3560831546783447, 5.1311845779418945, 5.174069404602051], "mean_td_error": 3.473188877105713, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 16.0, "diff_num_grad_updates_vs_sampler_policy": 15.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.085198402404785, "actor_loss": -4.404770374298096, "critic_loss": 2.115670680999756, "alpha_loss": -0.04540273919701576, "alpha_value": 0.9955081939697266, "log_alpha_value": -0.004501918330788612, "target_entropy": -6.0, "policy_t": -0.02707676589488983, "mean_q": 0.3454427719116211, "max_q": 0.4192831516265869, "min_q": 0.2752463221549988}, "td_error": [4.657082557678223, 3.5778565406799316, 3.2005789279937744, 2.43538498878479, 1.808525562286377, 3.4688496589660645, 2.568045139312744, 4.610762596130371, 1.972694754600525, 4.180654525756836, 4.081358909606934, 4.945688247680664, 1.1930248737335205, 3.00911283493042, 2.559893846511841, 3.126166343688965, 4.04347562789917, 2.749363422393799, 2.2812094688415527, 2.502450942993164, 5.752281188964844, 2.350008964538574, 4.8810529708862305, 4.491040229797363, 5.244833946228027, 5.5889692306518555, 4.3336358070373535, 3.336686372756958, 3.4705984592437744, 3.0626044273376465, 2.785461902618408, 2.781069278717041, 3.5349841117858887, 4.792924880981445, 3.22993803024292, 4.765625953674316, 2.8348851203918457, 4.405609130859375, 4.57875919342041, 1.7080250978469849, 3.206514358520508, 4.460883140563965, 4.082259654998779, 2.703486442565918, 4.004827499389648, 2.2903170585632324, 3.6404471397399902, 3.839358329772949, 3.8914546966552734, 4.292396545410156, 4.055826187133789, 4.246642589569092, 2.6895241737365723, 3.8632822036743164, 3.197451114654541, 3.326239585876465, 2.412787914276123, 4.971279144287109, 3.4247477054595947, 3.0487256050109863, 3.7061047554016113, 4.789051055908203, 5.7109880447387695, 5.518479824066162, 3.509251117706299, 3.713442087173462, 3.6446051597595215, 2.8424501419067383, 4.758777618408203, 2.4220070838928223, 0.7098471522331238, 1.855603814125061, 3.5619375705718994, 0.664819598197937, 2.5963048934936523, 3.294271230697632, 3.9057459831237793, 3.5175588130950928, 2.841116428375244, 4.7866926193237305, 4.637544631958008, 4.810880661010742, 3.3367128372192383, 2.6158008575439453, 3.231839656829834, 3.230008125305176], "mean_td_error": 3.520482301712036, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 16.0, "diff_num_grad_updates_vs_sampler_policy": 15.0}}, "num_env_steps_sampled": 15232, "num_env_steps_trained": 4128, "num_agent_steps_sampled": 45696, "num_agent_steps_trained": 4128, "last_target_update_ts": 15232, "num_target_updates": 16}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 45696, "num_agent_steps_trained": 4128, "num_env_steps_sampled": 15232, "num_env_steps_trained": 4128, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 418.102551094426, "num_env_steps_trained_throughput_per_sec": 120.39113636424321, "timesteps_total": 15232, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 45696, "timers": {"training_iteration_time_ms": 2039.139, "sample_time_ms": 1448.865, "load_time_ms": 0.561, "load_throughput": 460187.298, "learn_time_ms": 64.089, "learn_throughput": 4025.662, "synch_weights_time_ms": 16.221}, "counters": {"num_env_steps_sampled": 15232, "num_env_steps_trained": 4128, "num_agent_steps_sampled": 45696, "num_agent_steps_trained": 4128, "last_target_update_ts": 15232, "num_target_updates": 16}, "done": false, "episodes_total": 0, "training_iteration": 17, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-15-17", "timestamp": 1700201717, "time_this_iter_s": 2.1613287925720215, "time_total_s": 35.88732290267944, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8c8ad7ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 35.88732290267944, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 74.93333333333334, "ram_util_percent": 90.76666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.061714172363281, "actor_loss": -4.3830718994140625, "critic_loss": 4.360736846923828, "alpha_loss": -0.0482996441423893, "alpha_value": 0.9952111840248108, "log_alpha_value": -0.004800339695066214, "target_entropy": -6.0, "policy_t": -0.03190857544541359, "mean_q": 0.34984979033470154, "max_q": 0.4311458468437195, "min_q": 0.2915549874305725}, "td_error": [5.179644584655762, 5.354660987854004, 7.628085136413574, 4.512408256530762, 5.077676773071289, 6.9776611328125, 5.275399684906006, 5.057257652282715, 5.344910144805908, 3.909512996673584, 5.3074140548706055, 4.780680179595947, 5.28564453125, 5.167212009429932, 6.00560998916626, 5.891939640045166, 5.482592582702637, 4.745293617248535, 5.310379981994629, 7.272907257080078, 6.202240467071533, 4.676433086395264, 4.5002288818359375, 5.315001487731934, 3.6500210762023926, 4.959664344787598, 6.7922821044921875, 7.0144758224487305, 4.985998153686523, 4.901574611663818, 5.191324234008789, 4.831565856933594, 4.382102012634277, 5.033794403076172, 4.917001724243164, 4.422590255737305, 2.8940834999084473, 5.54557991027832, 5.799555778503418, 6.129532814025879, 3.944735527038574, 4.170760154724121, 6.67667818069458, 3.867828369140625, 5.0027265548706055, 5.0154924392700195, 6.191627502441406, 6.3072590827941895, 4.871182441711426, 6.620541572570801, 5.099247932434082, 5.479706764221191, 5.742627143859863, 5.527876853942871, 4.238571643829346, 5.258229732513428, 6.984391212463379, 6.098653793334961, 4.745922565460205, 5.164259910583496, 6.4645280838012695, 7.244068145751953, 5.66084098815918, 4.7143049240112305, 6.007409572601318, 2.4975905418395996, 4.5524492263793945, 3.763735055923462, 3.9667696952819824, 7.091510772705078, 4.7660441398620605, 5.500633239746094, 4.381665229797363, 6.3046875, 4.707097053527832, 4.066043376922607, 6.309475898742676, 3.3998425006866455, 4.7403411865234375, 6.21299934387207, 4.657663345336914, 5.445720672607422, 5.072542667388916, 4.835841178894043, 5.036417007446289, 6.215296745300293], "mean_td_error": 5.25971794128418, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 17.0, "diff_num_grad_updates_vs_sampler_policy": 16.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.148517608642578, "actor_loss": -4.520877361297607, "critic_loss": 0.7606301307678223, "alpha_loss": -0.04873046651482582, "alpha_value": 0.9952097535133362, "log_alpha_value": -0.004801732487976551, "target_entropy": -6.0, "policy_t": 0.007783935870975256, "mean_q": 0.3978733718395233, "max_q": 0.4895288348197937, "min_q": 0.33600109815597534}, "td_error": [3.482492446899414, 3.7064220905303955, 4.303714752197266, 3.091385841369629, 4.2596588134765625, 5.213809013366699, 4.017422199249268, 1.0020570755004883, 2.875558853149414, 3.7444562911987305, 3.5602848529815674, 4.195656776428223, 2.654451847076416, 3.4106340408325195, 2.7771291732788086, 2.275094509124756, 4.944205284118652, 2.891071319580078, 3.882904052734375, 3.712057590484619, 2.082278251647949, 2.8912301063537598, 3.9378068447113037, 1.3476908206939697, 4.513978958129883, 2.750011682510376, 3.4040098190307617, 4.483455657958984, 3.2519173622131348, 2.1393704414367676, 2.689420700073242, 4.930293083190918, 3.8654489517211914, 1.7184052467346191, 3.2758352756500244, 2.405738353729248, 3.6550416946411133, 3.6428866386413574, 1.435359239578247, 1.5612374544143677, 2.6809005737304688, 2.0736641883850098, 4.86093807220459, 3.235290765762329, 1.286616563796997, 3.6770753860473633, 3.875234603881836, 3.3236327171325684, 2.9959545135498047, 3.531811237335205, 3.6373634338378906, 3.654639959335327, 3.968812942504883, 2.916271686553955, 3.4601030349731445, 3.998502254486084, 4.150662422180176, 4.429725170135498, 2.334719181060791, 3.857889175415039, 3.0608668327331543, 4.096766471862793, 4.093061923980713, 4.0502166748046875, 3.957986831665039, 5.024949073791504, 3.9634087085723877, 2.820986270904541, 4.170825481414795, 2.496669292449951, 4.411853313446045, 0.720617949962616, 2.2807135581970215, 2.477411985397339, 3.7562592029571533, 2.831056594848633, 4.328892707824707, 3.5246407985687256, 4.3165283203125, 4.090529441833496, 3.4718127250671387, 4.0535888671875, 4.70059871673584, 2.69808292388916, 2.0556254386901855, 0.8641548156738281], "mean_td_error": 3.3284859657287598, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 17.0, "diff_num_grad_updates_vs_sampler_policy": 16.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.140121459960938, "actor_loss": -4.49911642074585, "critic_loss": 1.988210678100586, "alpha_loss": -0.048693813383579254, "alpha_value": 0.9952093958854675, "log_alpha_value": -0.004802093841135502, "target_entropy": -6.0, "policy_t": 0.03155386075377464, "mean_q": 0.38572046160697937, "max_q": 0.456236869096756, "min_q": 0.3095189034938812}, "td_error": [3.0568430423736572, 4.137557029724121, 3.903404712677002, 2.9088292121887207, 2.483050584793091, 2.9964396953582764, 4.068220138549805, 3.358917713165283, 3.577296257019043, 2.89666748046875, 2.3684921264648438, 3.437117338180542, 2.2372548580169678, 2.950800657272339, 2.4304847717285156, 3.644031524658203, 3.48837947845459, 4.925443649291992, 2.816804885864258, 2.109492301940918, 1.7566883563995361, 3.6836156845092773, 4.123138427734375, 3.5996251106262207, 3.1514759063720703, 3.6062145233154297, 4.123769760131836, 3.534019947052002, 4.028806686401367, 4.962832450866699, 2.7223777770996094, 3.5436956882476807, 4.4970173835754395, 4.110815048217773, 3.7980823516845703, 4.739411354064941, 2.043367624282837, 1.6569328308105469, 4.510840892791748, 2.5730366706848145, 2.4605765342712402, 3.8890109062194824, 3.407611846923828, 3.7163689136505127, 4.532505512237549, 2.4115512371063232, 2.831468105316162, 2.432800531387329, 5.878880500793457, 4.036337852478027, 1.5156192779541016, 1.4770936965942383, 4.0876336097717285, 4.912508487701416, 2.9887471199035645, 4.28165340423584, 3.859717845916748, 5.186797142028809, 2.866140604019165, 2.2140297889709473, 3.6115808486938477, 3.2699174880981445, 3.1440012454986572, 1.304311990737915, 4.598538398742676, 1.8252549171447754, 1.2007811069488525, 1.6756099462509155, 3.8776278495788574, 3.7682595252990723, 3.5651488304138184, 3.2936148643493652, 3.0791311264038086, 2.7601513862609863, 3.1020302772521973, 5.289151668548584, 4.5575408935546875, 4.127483367919922, 2.1961774826049805, 3.8892812728881836, 3.331287384033203, 3.1931562423706055, 3.563570022583008, 3.4170944690704346, 4.559582710266113, 1.9750845432281494], "mean_td_error": 3.3456244468688965, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 17.0, "diff_num_grad_updates_vs_sampler_policy": 16.0}}, "num_env_steps_sampled": 16128, "num_env_steps_trained": 4386, "num_agent_steps_sampled": 48384, "num_agent_steps_trained": 4386, "last_target_update_ts": 16128, "num_target_updates": 17}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48384, "num_agent_steps_trained": 4386, "num_env_steps_sampled": 16128, "num_env_steps_trained": 4386, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 445.34833084574313, "num_env_steps_trained_throughput_per_sec": 128.2364613372787, "timesteps_total": 16128, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 48384, "timers": {"training_iteration_time_ms": 1974.152, "sample_time_ms": 1384.658, "load_time_ms": 0.555, "load_throughput": 465072.388, "learn_time_ms": 64.069, "learn_throughput": 4026.905, "synch_weights_time_ms": 15.997}, "counters": {"num_env_steps_sampled": 16128, "num_env_steps_trained": 4386, "num_agent_steps_sampled": 48384, "num_agent_steps_trained": 4386, "last_target_update_ts": 16128, "num_target_updates": 17}, "done": false, "episodes_total": 0, "training_iteration": 18, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-15-19", "timestamp": 1700201719, "time_this_iter_s": 2.032701253890991, "time_total_s": 37.920024156570435, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8c884d160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 37.920024156570435, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 70.13333333333334, "ram_util_percent": 90.76666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.071600914001465, "actor_loss": -4.4294538497924805, "critic_loss": 4.651307106018066, "alpha_loss": -0.05137014761567116, "alpha_value": 0.9949125051498413, "log_alpha_value": -0.005100494250655174, "target_entropy": -6.0, "policy_t": -0.012833314947783947, "mean_q": 0.3880527913570404, "max_q": 0.47839808464050293, "min_q": 0.3194260001182556}, "td_error": [4.823453426361084, 5.027749538421631, 7.068328857421875, 7.309372901916504, 4.635169982910156, 6.151604652404785, 6.633871555328369, 2.9464335441589355, 5.241357803344727, 5.380833148956299, 4.5087432861328125, 5.998915672302246, 7.564349174499512, 6.384598731994629, 5.839240074157715, 5.288476943969727, 3.897054433822632, 3.927774429321289, 7.1389899253845215, 5.78940486907959, 3.7723753452301025, 4.536529064178467, 4.628869533538818, 6.114567279815674, 5.30216646194458, 9.716117858886719, 5.268080711364746, 5.963896751403809, 6.155581474304199, 4.703649520874023, 7.750162601470947, 5.814122200012207, 3.6763572692871094, 7.737756729125977, 4.652917861938477, 4.935807228088379, 5.805524826049805, 5.311429977416992, 3.6349778175354004, 4.692216873168945, 5.2697272300720215, 3.7881979942321777, 6.310956001281738, 4.910170555114746, 7.340526580810547, 5.388669967651367, 4.822160720825195, 4.042041301727295, 4.663620948791504, 5.727999210357666, 4.305865287780762, 4.104800701141357, 6.053333759307861, 6.027956962585449, 4.3826422691345215, 4.739996910095215, 7.37908935546875, 6.9940104484558105, 5.014888286590576, 4.122275352478027, 4.769606113433838, 5.52176570892334, 4.104875564575195, 5.096444129943848, 4.899822235107422, 4.897798538208008, 4.257683753967285, 4.9757399559021, 5.486321449279785, 6.037501335144043, 5.095587730407715, 3.5761866569519043, 3.4243831634521484, 3.7727184295654297, 4.841899871826172, 5.166832447052002, 7.155282020568848, 3.9223737716674805, 4.274290561676025, 5.819061279296875, 5.652265548706055, 5.991716384887695, 4.568431377410889, 5.42486572265625, 6.178379535675049, 4.94268798828125], "mean_td_error": 5.313631057739258, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 18.0, "diff_num_grad_updates_vs_sampler_policy": 17.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.079717636108398, "actor_loss": -4.491151332855225, "critic_loss": 0.7657995223999023, "alpha_loss": -0.051428552716970444, "alpha_value": 0.9949108362197876, "log_alpha_value": -0.0051021818071603775, "target_entropy": -6.0, "policy_t": 0.054340481758117676, "mean_q": 0.4460603594779968, "max_q": 0.529890239238739, "min_q": 0.3617497384548187}, "td_error": [2.7119946479797363, 3.2376461029052734, 3.0341153144836426, 5.47572135925293, 4.308487415313721, 3.5459935665130615, 3.855665445327759, 4.6415696144104, 4.131810188293457, 4.6947431564331055, 5.459024429321289, 4.0646257400512695, 2.5378284454345703, 1.6809360980987549, 3.9694936275482178, 4.832451820373535, 5.257305145263672, 2.7741894721984863, 1.4724586009979248, 3.1150918006896973, 3.0177855491638184, 2.979222297668457, 3.1041579246520996, 3.273810625076294, 2.70916748046875, 3.92578125, 3.381974697113037, 3.9575557708740234, 4.392630577087402, 3.5042600631713867, 4.073559761047363, 2.9266645908355713, 3.8316969871520996, 2.947399616241455, 3.50827693939209, 2.1093950271606445, 2.847092628479004, 4.862916469573975, 3.6262829303741455, 3.5449416637420654, 2.9776768684387207, 1.825608730316162, 3.03853178024292, 2.4854354858398438, 2.878793954849243, 2.953545331954956, 3.980480432510376, 1.2647923231124878, 2.781939744949341, 4.180517196655273, 1.537940502166748, 4.673169136047363, 3.533294200897217, 2.8706297874450684, 2.4736876487731934, 3.09572696685791, 1.7990870475769043, 2.4031944274902344, 1.693387746810913, 4.264401435852051, 3.1159603595733643, 4.527749061584473, 1.8979401588439941, 0.22718757390975952, 3.263887643814087, 3.010855197906494, 3.9933929443359375, 2.514307975769043, 2.7524197101593018, 3.9454445838928223, 4.0373125076293945, 2.1994071006774902, 4.959664821624756, 2.427224636077881, 4.540367126464844, 2.6188578605651855, 2.6310172080993652, 2.9044582843780518, 5.825568199157715, 4.737159252166748, 5.105452537536621, 4.0574774742126465, 3.244908571243286, 4.662938117980957, 2.332584857940674, 2.7800192832946777], "mean_td_error": 3.3529202938079834, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 18.0, "diff_num_grad_updates_vs_sampler_policy": 17.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.079639434814453, "actor_loss": -4.482736110687256, "critic_loss": 1.9140751361846924, "alpha_loss": -0.05143003165721893, "alpha_value": 0.9949105978012085, "log_alpha_value": -0.005102368537336588, "target_entropy": -6.0, "policy_t": 0.009152653627097607, "mean_q": 0.43300068378448486, "max_q": 0.5159968137741089, "min_q": 0.36478638648986816}, "td_error": [3.2967209815979004, 2.008327007293701, 1.8084114789962769, 4.3226799964904785, 2.1992831230163574, 2.124913215637207, 3.1070070266723633, 4.671292304992676, 2.775254726409912, 1.9476847648620605, 2.582582473754883, 3.8853678703308105, 1.380576252937317, 1.5640771389007568, 4.176928520202637, 2.189356803894043, 3.3799357414245605, 4.740596771240234, 4.638860702514648, 3.707777738571167, 4.064711570739746, 3.2328567504882812, 3.0661427974700928, 1.1860332489013672, 2.3295278549194336, 3.4970061779022217, 4.2152419090271, 3.7795417308807373, 2.852395534515381, 4.984769821166992, 3.9786767959594727, 0.5962717533111572, 4.057284832000732, 3.9513864517211914, 2.1808266639709473, 3.21453595161438, 4.500798225402832, 3.0325210094451904, 6.513791561126709, 2.9043941497802734, 3.791694164276123, 3.5999839305877686, 2.964829921722412, 0.9530218839645386, 4.646553039550781, 3.13021183013916, 1.4114573001861572, 1.6937544345855713, 3.1792945861816406, 3.956547260284424, 3.254768133163452, 2.8741984367370605, 3.0475854873657227, 3.6652488708496094, 3.9429268836975098, 3.766669273376465, 2.183884859085083, 2.1614136695861816, 3.039132595062256, 2.361483335494995, 2.424014091491699, 3.1694509983062744, 1.6370437145233154, 3.9481921195983887, 4.465946197509766, 2.1408936977386475, 4.304817199707031, 4.448794364929199, 2.3412704467773438, 3.8135480880737305, 5.462380409240723, 2.6528496742248535, 3.527632236480713, 3.583908796310425, 3.502408504486084, 4.060727119445801, 3.919849395751953, 2.1072492599487305, 3.434596061706543, 3.3167190551757812, 0.9664506316184998, 3.1338233947753906, 4.947783470153809, 3.8896660804748535, 2.7904958724975586, 4.37453031539917], "mean_td_error": 3.216698169708252, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 18.0, "diff_num_grad_updates_vs_sampler_policy": 17.0}}, "num_env_steps_sampled": 17024, "num_env_steps_trained": 4644, "num_agent_steps_sampled": 51072, "num_agent_steps_trained": 4644, "last_target_update_ts": 17024, "num_target_updates": 18}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51072, "num_agent_steps_trained": 4644, "num_env_steps_sampled": 17024, "num_env_steps_trained": 4644, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 372.6088907674188, "num_env_steps_trained_throughput_per_sec": 107.29139935043979, "timesteps_total": 17024, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 51072, "timers": {"training_iteration_time_ms": 2031.199, "sample_time_ms": 1417.79, "load_time_ms": 0.554, "load_throughput": 465312.363, "learn_time_ms": 64.062, "learn_throughput": 4027.358, "synch_weights_time_ms": 15.409}, "counters": {"num_env_steps_sampled": 17024, "num_env_steps_trained": 4644, "num_agent_steps_sampled": 51072, "num_agent_steps_trained": 4644, "last_target_update_ts": 17024, "num_target_updates": 18}, "done": false, "episodes_total": 0, "training_iteration": 19, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-15-22", "timestamp": 1700201722, "time_this_iter_s": 2.4220120906829834, "time_total_s": 40.34203624725342, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8981f5310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 40.34203624725342, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 76.03333333333335, "ram_util_percent": 90.73333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.106195449829102, "actor_loss": -4.509910583496094, "critic_loss": 4.192673683166504, "alpha_loss": -0.05457976832985878, "alpha_value": 0.9946139454841614, "log_alpha_value": -0.005400625057518482, "target_entropy": -6.0, "policy_t": 0.03919244557619095, "mean_q": 0.43213778734207153, "max_q": 0.5457863807678223, "min_q": 0.35860830545425415}, "td_error": [6.399030685424805, 4.606938362121582, 4.953922748565674, 5.821235656738281, 4.619385242462158, 5.320269584655762, 3.6335811614990234, 5.636155605316162, 3.3954758644104004, 2.3470046520233154, 4.480961799621582, 5.109978675842285, 4.067503929138184, 4.454824447631836, 5.219131946563721, 4.298109531402588, 4.554800033569336, 4.4638872146606445, 6.230678558349609, 3.7395663261413574, 6.330874919891357, 6.091850280761719, 5.142041206359863, 6.899840354919434, 5.610169887542725, 4.029835224151611, 4.859725475311279, 5.500288009643555, 4.037595272064209, 5.213600158691406, 5.916463851928711, 5.527749061584473, 5.1185784339904785, 7.238715171813965, 4.061153888702393, 6.999904155731201, 2.7688374519348145, 3.387526512145996, 4.904571533203125, 5.809826850891113, 5.395138740539551, 2.9180445671081543, 4.664299964904785, 7.520057678222656, 5.858301162719727, 4.206125259399414, 6.162640571594238, 4.736932754516602, 4.8683342933654785, 3.886751651763916, 4.551390647888184, 5.763840198516846, 5.210240364074707, 2.8432788848876953, 5.1628828048706055, 5.424811363220215, 4.143204212188721, 5.658207893371582, 4.037606239318848, 3.856215476989746, 4.137314319610596, 3.7265818119049072, 4.176884651184082, 4.444192886352539, 4.589809417724609, 4.893512725830078, 4.200891494750977, 3.8223299980163574, 4.851238250732422, 6.787583351135254, 6.145766258239746, 5.320599555969238, 4.77498197555542, 5.062889099121094, 3.705049753189087, 6.173880577087402, 5.702991485595703, 5.295098304748535, 5.962519645690918, 5.145395278930664, 5.366193771362305, 4.13431453704834, 4.863615989685059, 4.836786270141602, 7.537030220031738, 4.5362772941589355], "mean_td_error": 4.951902866363525, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 19.0, "diff_num_grad_updates_vs_sampler_policy": 18.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.089956283569336, "actor_loss": -4.532684803009033, "critic_loss": 0.7253700494766235, "alpha_loss": -0.054511908441782, "alpha_value": 0.9946119785308838, "log_alpha_value": -0.005402591545134783, "target_entropy": -6.0, "policy_t": 0.07742626965045929, "mean_q": 0.4826807975769043, "max_q": 0.5977094173431396, "min_q": 0.39113926887512207}, "td_error": [3.5230987071990967, 2.620149850845337, 2.8315155506134033, 2.9812920093536377, 5.370545387268066, 1.948401689529419, 3.831943988800049, 4.131710052490234, 2.379464626312256, 2.447669506072998, 3.7097954750061035, 3.411893844604492, 3.889833688735962, 3.5657968521118164, 3.049973726272583, 2.1008691787719727, 2.113509178161621, 1.9192161560058594, 1.0964772701263428, 3.517975091934204, 3.7203304767608643, 3.438535451889038, 3.345423698425293, 2.8383753299713135, 3.0412521362304688, 3.622776508331299, 2.9849729537963867, 3.0459513664245605, 4.0009355545043945, 1.9551705121994019, 3.2783265113830566, 2.8246231079101562, 3.564303398132324, 2.595534563064575, 1.6178829669952393, 3.307466506958008, 3.928678274154663, 2.95733904838562, 4.418729305267334, 2.2940454483032227, 2.284135341644287, 1.2146031856536865, 4.407402992248535, 3.801132917404175, 2.771497964859009, 3.362516403198242, 1.7522794008255005, 1.7460702657699585, 2.7081985473632812, 4.970365524291992, 2.481675863265991, 3.4166312217712402, 3.4476823806762695, 3.7498273849487305, 1.9010316133499146, 4.030197620391846, 4.948799133300781, 3.7693471908569336, 2.473592758178711, 4.192954063415527, 2.0715513229370117, 5.480320930480957, 4.9452714920043945, 3.143594741821289, 4.199923992156982, 4.044175148010254, 3.7249252796173096, 3.798877716064453, 4.239314079284668, 2.4045932292938232, 3.3028955459594727, 3.833315849304199, 2.078522205352783, 3.252974510192871, 3.726962089538574, 4.299168109893799, 3.357118606567383, 3.4843204021453857, 3.361112117767334, 4.729004859924316, 2.4982919692993164, 2.735844612121582, 3.0294506549835205, 3.7455060482025146, 4.060540199279785, 3.568852663040161], "mean_td_error": 3.2531180381774902, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 19.0, "diff_num_grad_updates_vs_sampler_policy": 18.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.16213607788086, "actor_loss": -4.611210823059082, "critic_loss": 1.9289655685424805, "alpha_loss": -0.054902125149965286, "alpha_value": 0.9946119785308838, "log_alpha_value": -0.005402615759521723, "target_entropy": -6.0, "policy_t": 0.03774847835302353, "mean_q": 0.48658350110054016, "max_q": 0.5785796642303467, "min_q": 0.4069357216358185}, "td_error": [3.7952475547790527, 4.768576622009277, 4.222929954528809, 5.003632545471191, 3.4525797367095947, 3.1756372451782227, 2.9469943046569824, 4.155503749847412, 3.2649950981140137, 3.176938056945801, 2.020216464996338, 4.009943962097168, 4.2918620109558105, 4.011153221130371, 4.487939834594727, 3.1680073738098145, 2.0472633838653564, 5.254665851593018, 1.8029065132141113, 3.6555137634277344, 3.588644504547119, 2.8833394050598145, 2.9900500774383545, 2.755359172821045, 1.5735447406768799, 1.8236868381500244, 2.811432123184204, 2.3396594524383545, 4.891659736633301, 1.959358811378479, 5.513272762298584, 3.417633056640625, 3.2670817375183105, 3.405637264251709, 3.156816005706787, 4.066003799438477, 4.965612411499023, 2.4497432708740234, 2.6361968517303467, 3.502274990081787, 2.7853996753692627, 4.346464157104492, 3.850033760070801, 2.7057485580444336, 3.9077887535095215, 2.6014084815979004, 2.507688522338867, 2.8696842193603516, 3.863607406616211, 2.4078831672668457, 2.3307275772094727, 3.2355446815490723, 4.205286026000977, 3.9238719940185547, 3.114229679107666, 3.8121585845947266, 1.7257866859436035, 2.9041647911071777, 5.48983097076416, 1.5796027183532715, 2.073415517807007, 5.647977828979492, 4.831936836242676, 3.869396686553955, 3.7072858810424805, 2.142723798751831, 3.7164039611816406, 3.748621940612793, 3.148644208908081, 2.5035758018493652, 1.6477253437042236, 0.4007420539855957, 6.004773139953613, 3.5493500232696533, 4.295632839202881, 1.9271353483200073, 0.5420827865600586, 0.14724302291870117, 2.0176525115966797, 3.3970892429351807, 2.6353142261505127, 2.514070510864258, 4.890859127044678, 1.7127307653427124, 3.607670307159424, 4.718616485595703], "mean_td_error": 3.2590126991271973, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 19.0, "diff_num_grad_updates_vs_sampler_policy": 18.0}}, "num_env_steps_sampled": 17920, "num_env_steps_trained": 4902, "num_agent_steps_sampled": 53760, "num_agent_steps_trained": 4902, "last_target_update_ts": 17920, "num_target_updates": 19}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 53760, "num_agent_steps_trained": 4902, "num_env_steps_sampled": 17920, "num_env_steps_trained": 4902, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 442.9856685198977, "num_env_steps_trained_throughput_per_sec": 127.55614115863125, "timesteps_total": 17920, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 53760, "timers": {"training_iteration_time_ms": 2032.847, "sample_time_ms": 1419.599, "load_time_ms": 0.555, "load_throughput": 465092.376, "learn_time_ms": 64.024, "learn_throughput": 4029.744, "synch_weights_time_ms": 15.014}, "counters": {"num_env_steps_sampled": 17920, "num_env_steps_trained": 4902, "num_agent_steps_sampled": 53760, "num_agent_steps_trained": 4902, "last_target_update_ts": 17920, "num_target_updates": 19}, "done": false, "episodes_total": 0, "training_iteration": 20, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-15-24", "timestamp": 1700201724, "time_this_iter_s": 2.0382039546966553, "time_total_s": 42.38024020195007, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8c8ad7e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 42.38024020195007, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 67.60000000000001, "ram_util_percent": 90.76666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.094308853149414, "actor_loss": -4.544575214385986, "critic_loss": 4.2677764892578125, "alpha_loss": -0.057545628398656845, "alpha_value": 0.9943154454231262, "log_alpha_value": -0.005700799636542797, "target_entropy": -6.0, "policy_t": -0.006715990602970123, "mean_q": 0.4786757528781891, "max_q": 0.5947968363761902, "min_q": 0.4051777124404907}, "td_error": [4.580826759338379, 6.142983436584473, 4.762045860290527, 5.560044288635254, 3.949561595916748, 3.454907178878784, 4.781761646270752, 3.324625015258789, 3.4969091415405273, 4.8050432205200195, 6.306933403015137, 4.322592735290527, 4.329397201538086, 5.2270708084106445, 5.621301651000977, 6.078496932983398, 4.7050065994262695, 4.10417366027832, 4.399239540100098, 4.738346576690674, 4.754805564880371, 3.7312660217285156, 6.186688423156738, 7.231480598449707, 5.341055393218994, 7.002000331878662, 4.596508026123047, 5.345797538757324, 5.886509895324707, 3.96243953704834, 6.76038932800293, 4.258400917053223, 3.7817769050598145, 4.60538387298584, 5.119017601013184, 6.0083723068237305, 5.871542930603027, 4.73444938659668, 5.418665409088135, 4.119263648986816, 6.837010383605957, 4.271393775939941, 5.14540958404541, 5.244321823120117, 4.23647403717041, 4.161890983581543, 6.613590240478516, 5.454671859741211, 5.058383941650391, 5.254360198974609, 3.4926631450653076, 5.6092681884765625, 5.400123119354248, 5.071094512939453, 6.3673295974731445, 5.491950035095215, 6.045043468475342, 3.9212517738342285, 8.046686172485352, 3.994189739227295, 6.496823787689209, 4.8957319259643555, 6.267837047576904, 5.178709983825684, 5.311939239501953, 5.754371643066406, 6.077138900756836, 4.214925765991211, 5.008732795715332, 5.630297660827637, 5.166164398193359, 4.870617866516113, 3.5224270820617676, 4.79853630065918, 6.730166912078857, 4.526039123535156, 5.367912769317627, 4.572834014892578, 5.805145740509033, 6.803360939025879, 3.1480565071105957, 5.850308895111084, 5.745963096618652, 8.06793212890625, 4.179368495941162, 5.066403388977051], "mean_td_error": 5.1649065017700195, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 20.0, "diff_num_grad_updates_vs_sampler_policy": 19.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.058931350708008, "actor_loss": -4.546911239624023, "critic_loss": 0.7338162660598755, "alpha_loss": -0.05736594274640083, "alpha_value": 0.9943132400512695, "log_alpha_value": -0.00570298545062542, "target_entropy": -6.0, "policy_t": 0.023151736706495285, "mean_q": 0.523563027381897, "max_q": 0.6384817361831665, "min_q": 0.4454003572463989}, "td_error": [4.472441673278809, 3.2258286476135254, 3.263587236404419, 4.18630838394165, 3.404165506362915, 3.414414882659912, 3.956239700317383, 4.263500690460205, 2.629166603088379, 2.160443067550659, 5.341611385345459, 3.858745574951172, 2.1973533630371094, 5.286795616149902, 2.8317952156066895, 3.835549831390381, 1.52228844165802, 5.664565563201904, 2.5384769439697266, 1.9287116527557373, 3.770876169204712, 4.779889106750488, 4.124678611755371, 4.012779712677002, 1.985926866531372, 2.81258225440979, 4.190394878387451, 3.3691396713256836, 5.008177280426025, 3.1367669105529785, 3.2461893558502197, 1.4923887252807617, 3.7339611053466797, 3.3866772651672363, 2.6416964530944824, 2.7616984844207764, 3.1897799968719482, 2.2440295219421387, 3.6457223892211914, 1.5142791271209717, 3.90179443359375, 1.2376108169555664, 2.981361150741577, 5.272677898406982, 3.945707321166992, 5.019071102142334, 1.7667646408081055, 2.4559054374694824, 1.8779830932617188, 2.9426822662353516, 2.329408645629883, 2.9063048362731934, 0.843449056148529, 2.813220500946045, 1.355749249458313, 3.56681752204895, 1.6494444608688354, 2.6958489418029785, 3.48506236076355, 4.62232780456543, 3.658133029937744, 4.532057285308838, 2.5364041328430176, 3.907651901245117, 4.328332424163818, 4.5897016525268555, 4.763060569763184, 2.949885129928589, 3.5270466804504395, 1.0870521068572998, 4.840847969055176, 1.5457454919815063, 3.234409809112549, 1.9838385581970215, 3.3735361099243164, 4.051352500915527, 1.5757043361663818, 1.3148475885391235, 2.7490320205688477, 2.3859872817993164, 3.5821990966796875, 3.6758413314819336, 2.8261466026306152, 2.760629653930664, 4.498093605041504, 3.851834297180176], "mean_td_error": 3.2189323902130127, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 20.0, "diff_num_grad_updates_vs_sampler_policy": 19.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.125794410705566, "actor_loss": -4.6192169189453125, "critic_loss": 1.6193482875823975, "alpha_loss": -0.05774731561541557, "alpha_value": 0.9943132400512695, "log_alpha_value": -0.005702991504222155, "target_entropy": -6.0, "policy_t": -0.014768012799322605, "mean_q": 0.5237772464752197, "max_q": 0.612092137336731, "min_q": 0.43284809589385986}, "td_error": [2.1639304161071777, 1.5636804103851318, 2.3465986251831055, 1.6590676307678223, 1.6834197044372559, 3.036092758178711, 2.879777431488037, 3.682720899581909, 2.2667829990386963, 3.3074893951416016, 3.638152599334717, 3.2338528633117676, 3.296602964401245, 3.123108386993408, 4.802690505981445, 1.8063814640045166, 4.8050217628479, 4.001244068145752, 3.8104944229125977, 2.9736292362213135, 3.4698877334594727, 3.361607313156128, 3.6386172771453857, 4.314472198486328, 1.989177942276001, 5.103900909423828, 2.2340915203094482, 1.7950128316879272, 2.800623893737793, 2.5836539268493652, 3.606623411178589, 3.2742576599121094, 3.600464344024658, 2.7509498596191406, 4.539758682250977, 4.571695327758789, 2.4798974990844727, 1.7077007293701172, 3.322936534881592, 3.9136157035827637, 3.941988468170166, 3.544275999069214, 4.096246242523193, 2.8068299293518066, 2.967785358428955, 1.964411973953247, 2.5104618072509766, 4.121358394622803, 2.604177951812744, 3.235591173171997, 4.8961710929870605, 3.9485530853271484, 3.020941734313965, 4.477581024169922, 4.416975021362305, 2.8379592895507812, 4.309789180755615, 2.262152671813965, 4.602203369140625, 2.3743159770965576, 4.471753120422363, 2.1863057613372803, 3.6985859870910645, 4.136231899261475, 4.581002712249756, 3.3047444820404053, 3.713387966156006, 1.610476016998291, 2.8340768814086914, 3.1116719245910645, 3.4288644790649414, 2.8873848915100098, 4.925569534301758, 2.30428409576416, 2.860752582550049, 1.907975435256958, 2.983391284942627, 3.82934308052063, 1.8069535493850708, 3.5530142784118652, 2.168168067932129, 4.846126556396484, 3.876767158508301, 1.5569994449615479, 3.802354335784912, 2.171945571899414], "mean_td_error": 3.2167162895202637, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 20.0, "diff_num_grad_updates_vs_sampler_policy": 19.0}}, "num_env_steps_sampled": 18816, "num_env_steps_trained": 5160, "num_agent_steps_sampled": 56448, "num_agent_steps_trained": 5160, "last_target_update_ts": 18816, "num_target_updates": 20}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56448, "num_agent_steps_trained": 5160, "num_env_steps_sampled": 18816, "num_env_steps_trained": 5160, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 478.2255036286561, "num_env_steps_trained_throughput_per_sec": 137.70332582164428, "timesteps_total": 18816, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 56448, "timers": {"training_iteration_time_ms": 2028.639, "sample_time_ms": 1416.936, "load_time_ms": 0.537, "load_throughput": 480626.441, "learn_time_ms": 63.432, "learn_throughput": 4067.361, "synch_weights_time_ms": 14.606}, "counters": {"num_env_steps_sampled": 18816, "num_env_steps_trained": 5160, "num_agent_steps_sampled": 56448, "num_agent_steps_trained": 5160, "last_target_update_ts": 18816, "num_target_updates": 20}, "done": false, "episodes_total": 0, "training_iteration": 21, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-15-26", "timestamp": 1700201726, "time_this_iter_s": 1.8899569511413574, "time_total_s": 44.27019715309143, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8c8af3790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 44.27019715309143, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 63.666666666666664, "ram_util_percent": 90.73333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.097616195678711, "actor_loss": -4.595522880554199, "critic_loss": 4.2487688064575195, "alpha_loss": -0.06059568375349045, "alpha_value": 0.9940170049667358, "log_alpha_value": -0.0060009886510670185, "target_entropy": -6.0, "policy_t": -0.046401843428611755, "mean_q": 0.5363824367523193, "max_q": 0.6682804822921753, "min_q": 0.43711498379707336}, "td_error": [5.287175178527832, 6.819596290588379, 4.607914924621582, 2.959221839904785, 5.791007041931152, 6.6016340255737305, 5.963886260986328, 5.050276279449463, 6.850245475769043, 5.677220344543457, 2.614229917526245, 4.371930122375488, 5.0413103103637695, 3.6666970252990723, 3.442951202392578, 5.455488204956055, 7.647273063659668, 3.752674102783203, 6.032164573669434, 4.100450038909912, 4.939373970031738, 4.373614311218262, 4.139458656311035, 5.3410186767578125, 4.416597843170166, 6.23690938949585, 6.530043601989746, 5.153109550476074, 5.231764793395996, 6.217129230499268, 4.831082344055176, 1.9896615743637085, 5.220268249511719, 4.026315689086914, 5.075925827026367, 6.560173511505127, 4.783716201782227, 4.820491790771484, 5.146660804748535, 2.892071485519409, 4.2041826248168945, 7.6191534996032715, 5.920809268951416, 3.8610963821411133, 3.8143649101257324, 5.419208526611328, 5.868736743927002, 3.380458116531372, 6.177312850952148, 6.339383125305176, 5.49901819229126, 4.185948371887207, 4.103590965270996, 5.079785346984863, 6.218297004699707, 5.048674583435059, 6.16956901550293, 5.50172758102417, 4.793819427490234, 5.063094139099121, 5.078787803649902, 3.7898011207580566, 6.467966556549072, 6.467896461486816, 5.4047017097473145, 5.162646293640137, 5.196872711181641, 5.314243316650391, 4.3030548095703125, 5.120025634765625, 3.3306961059570312, 5.742048740386963, 4.48809814453125, 5.501491069793701, 5.943690776824951, 5.502992630004883, 4.938082218170166, 6.356554985046387, 3.2777791023254395, 4.4264068603515625, 4.8415327072143555, 4.3255767822265625, 6.752403259277344, 4.942707061767578, 4.244182586669922, 5.83243465423584], "mean_td_error": 5.077670097351074, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 21.0, "diff_num_grad_updates_vs_sampler_policy": 20.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.094256401062012, "actor_loss": -4.617742538452148, "critic_loss": 0.674898624420166, "alpha_loss": -0.06059891730546951, "alpha_value": 0.9940146803855896, "log_alpha_value": -0.0060033067129552364, "target_entropy": -6.0, "policy_t": 0.04899594560265541, "mean_q": 0.5676208138465881, "max_q": 0.719806432723999, "min_q": 0.4547955095767975}, "td_error": [2.3425049781799316, 0.33350709080696106, 1.6323449611663818, 2.644388198852539, 2.8219046592712402, 3.412997245788574, 3.96781063079834, 4.203145980834961, 2.770878314971924, 3.7320632934570312, 4.009951114654541, 2.257646322250366, 1.0980912446975708, 2.8402090072631836, 2.100365161895752, 3.2250006198883057, 2.8474512100219727, 2.7191898822784424, 4.121793746948242, 0.4708701968193054, 2.1793746948242188, 4.013521194458008, 2.909430742263794, 3.5137319564819336, 1.5252567529678345, 3.988572120666504, 4.789244651794434, 1.9261488914489746, 2.8008389472961426, 2.786036968231201, 2.811406135559082, 2.744873523712158, 3.272941827774048, 3.911281108856201, 1.6839773654937744, 4.933084011077881, 4.1146769523620605, 4.327733993530273, 4.842191696166992, 3.042957305908203, 2.9740242958068848, 3.7843708992004395, 2.5122928619384766, 0.749742865562439, 2.358948230743408, 3.064239978790283, 4.095266342163086, 3.2594006061553955, 2.1913321018218994, 2.9388206005096436, 1.9348485469818115, 3.576559066772461, 2.3528013229370117, 0.8685989379882812, 1.3642175197601318, 3.345221996307373, 3.886120319366455, 5.2965545654296875, 3.1064820289611816, 5.346156120300293, 4.237002372741699, 2.4930171966552734, 3.6593756675720215, 1.969024658203125, 3.193262815475464, 3.710127830505371, 2.867357015609741, 1.637991189956665, 3.002047300338745, 2.1766562461853027, 3.991197347640991, 3.6159958839416504, 3.8005270957946777, 2.5151267051696777, 3.725404977798462, 1.9821311235427856, 2.3345656394958496, 1.6649339199066162, 3.5188817977905273, 3.7387003898620605, 1.8086519241333008, 4.051411151885986, 4.617345809936523, 2.3529791831970215, 2.561295509338379, 2.630476951599121], "mean_td_error": 2.982917308807373, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 21.0, "diff_num_grad_updates_vs_sampler_policy": 20.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.11163330078125, "actor_loss": -4.657804489135742, "critic_loss": 1.5667645931243896, "alpha_loss": -0.06070425733923912, "alpha_value": 0.9940145611763, "log_alpha_value": -0.006003407295793295, "target_entropy": -6.0, "policy_t": -0.023307127878069878, "mean_q": 0.5835092067718506, "max_q": 0.7338998317718506, "min_q": 0.4774736166000366}, "td_error": [3.445223808288574, 2.9864578247070312, 2.146615505218506, 0.639767050743103, 5.4259724617004395, 4.089970588684082, 3.522315502166748, 1.8689947128295898, 3.2229666709899902, 4.291441917419434, 2.2757880687713623, 2.011716842651367, 2.648191452026367, 3.7311534881591797, 3.009442090988159, 3.163177013397217, 4.803744316101074, 6.3394951820373535, 2.1110873222351074, 3.4874844551086426, 3.3828768730163574, 4.059636116027832, 3.731881856918335, 3.865506887435913, 3.634183883666992, 1.9179401397705078, 4.280655860900879, 2.807267427444458, 2.3311760425567627, 2.5343518257141113, 3.639008045196533, 3.412630319595337, 5.080454349517822, 3.7388129234313965, 2.490204334259033, 4.229952335357666, 4.069057941436768, 3.0682642459869385, 2.6446890830993652, 2.4097776412963867, 2.8610193729400635, 2.278554916381836, 3.2547128200531006, 3.0450587272644043, 1.893785834312439, 1.2657711505889893, 4.776269435882568, 2.688910484313965, 2.4873082637786865, 5.222655296325684, 3.8286304473876953, 2.1344797611236572, 5.25438117980957, 2.89042329788208, 2.007270336151123, 7.715782165527344, 3.6865768432617188, 2.2425036430358887, 4.161735534667969, 2.0499191284179688, 4.0263519287109375, 3.6344282627105713, 4.030248641967773, 2.7902491092681885, 4.189774990081787, 4.40059757232666, 2.3993711471557617, 4.084768295288086, 2.108569622039795, 2.8049302101135254, 2.7211532592773438, 2.009004831314087, 2.960153102874756, 4.049441814422607, 3.4613752365112305, 4.494784355163574, 1.7246116399765015, 3.477724552154541, 1.9634957313537598, 1.316044807434082, 3.3141980171203613, 3.063693046569824, 1.520216703414917, 3.87502384185791, 1.2312085628509521, 3.4610862731933594], "mean_td_error": 3.2256696224212646, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 21.0, "diff_num_grad_updates_vs_sampler_policy": 20.0}}, "num_env_steps_sampled": 19712, "num_env_steps_trained": 5418, "num_agent_steps_sampled": 59136, "num_agent_steps_trained": 5418, "last_target_update_ts": 19712, "num_target_updates": 21}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 59136, "num_agent_steps_trained": 5418, "num_env_steps_sampled": 19712, "num_env_steps_trained": 5418, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 454.20073344648176, "num_env_steps_trained_throughput_per_sec": 130.78547905043783, "timesteps_total": 19712, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 59136, "timers": {"training_iteration_time_ms": 1983.278, "sample_time_ms": 1392.228, "load_time_ms": 0.536, "load_throughput": 481717.607, "learn_time_ms": 63.386, "learn_throughput": 4070.331, "synch_weights_time_ms": 14.596}, "counters": {"num_env_steps_sampled": 19712, "num_env_steps_trained": 5418, "num_agent_steps_sampled": 59136, "num_agent_steps_trained": 5418, "last_target_update_ts": 19712, "num_target_updates": 21}, "done": false, "episodes_total": 0, "training_iteration": 22, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-15-28", "timestamp": 1700201728, "time_this_iter_s": 1.9873051643371582, "time_total_s": 46.25750231742859, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8c8add700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 46.25750231742859, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 71.5, "ram_util_percent": 90.73333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.016316413879395, "actor_loss": -4.579395771026611, "critic_loss": 4.358539581298828, "alpha_loss": -0.06311476230621338, "alpha_value": 0.9937186241149902, "log_alpha_value": -0.006301195826381445, "target_entropy": -6.0, "policy_t": 0.03498410806059837, "mean_q": 0.5839130282402039, "max_q": 0.6904166340827942, "min_q": 0.4875548481941223}, "td_error": [5.848456382751465, 4.146731376647949, 5.12554931640625, 5.686138153076172, 6.377303123474121, 4.553449630737305, 5.591463088989258, 2.909799337387085, 4.5117387771606445, 7.01481819152832, 4.901281833648682, 4.8502607345581055, 4.68764591217041, 4.393522262573242, 6.564603805541992, 5.964005470275879, 4.932682991027832, 7.388955116271973, 5.242486953735352, 4.109281539916992, 5.607728004455566, 5.003871917724609, 5.1464433670043945, 5.117168426513672, 4.408881187438965, 4.233185768127441, 6.0197038650512695, 4.997672080993652, 5.748081207275391, 6.926307201385498, 3.6971936225891113, 4.319255352020264, 4.456761360168457, 3.8858237266540527, 6.185386657714844, 5.589918613433838, 3.8956243991851807, 5.718791961669922, 5.909685134887695, 3.846937656402588, 4.9026384353637695, 5.6131134033203125, 5.203316688537598, 6.6228437423706055, 4.379451751708984, 3.6454877853393555, 5.405885696411133, 4.560903549194336, 5.038934707641602, 5.4674811363220215, 6.427281379699707, 6.945944309234619, 5.793740272521973, 5.320571422576904, 5.975564479827881, 6.693427085876465, 3.0532984733581543, 6.381356239318848, 3.8384201526641846, 4.539519309997559, 5.386091232299805, 5.383336544036865, 5.5478410720825195, 4.086808204650879, 4.698363304138184, 5.0337724685668945, 4.751289367675781, 5.568524360656738, 3.560504913330078, 2.8416104316711426, 5.8102545738220215, 4.352505683898926, 5.753787040710449, 3.6256103515625, 7.186530113220215, 4.937859058380127, 4.884010314941406, 6.593865871429443, 2.9590377807617188, 3.822620391845703, 4.056236267089844, 4.7013654708862305, 4.451373100280762, 4.597116470336914, 6.258088111877441, 3.525029182434082], "mean_td_error": 5.066246032714844, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 22.0, "diff_num_grad_updates_vs_sampler_policy": 21.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.104211807250977, "actor_loss": -4.682067394256592, "critic_loss": 0.765971302986145, "alpha_loss": -0.06369324028491974, "alpha_value": 0.9937161803245544, "log_alpha_value": -0.006303632166236639, "target_entropy": -6.0, "policy_t": 0.04010511189699173, "mean_q": 0.6169888973236084, "max_q": 0.7706424593925476, "min_q": 0.5081451535224915}, "td_error": [4.890363693237305, 4.891693592071533, 4.782928466796875, 2.6132988929748535, 2.6900181770324707, 2.359112501144409, 2.2565789222717285, 3.418687582015991, 5.020265579223633, 1.96821129322052, 3.232759475708008, 1.9239771366119385, 3.541051149368286, 3.527590036392212, 6.656306266784668, 3.0247912406921387, 3.425445079803467, 5.832963943481445, 2.386913776397705, 2.134049654006958, 3.1923131942749023, 2.8165149688720703, 2.7954792976379395, 2.2130203247070312, 3.870265007019043, 3.6090269088745117, 2.8167972564697266, 3.910767078399658, 1.822870135307312, 3.056936740875244, 3.754270076751709, 3.940559148788452, 0.9568413496017456, 3.0920705795288086, 1.901753544807434, 2.275599479675293, 2.2426376342773438, 1.770756721496582, 4.763219833374023, 4.064784526824951, 1.937159538269043, 2.948951482772827, 2.0309364795684814, 3.140127182006836, 2.531707525253296, 2.4799585342407227, 2.9141898155212402, 4.014211177825928, 2.729456901550293, 5.209952354431152, 0.34357985854148865, 4.085077285766602, 1.8310575485229492, 4.196772575378418, 6.175371170043945, 6.1277570724487305, 5.213529586791992, 1.7444584369659424, 2.561042070388794, 3.2082958221435547, 2.8990578651428223, 3.783163547515869, 2.6676855087280273, 3.024116277694702, 3.7589845657348633, 3.8303589820861816, 4.081375598907471, 6.244892120361328, 2.80230712890625, 3.710136651992798, 3.5890283584594727, 3.1313705444335938, 3.6655116081237793, 4.259864807128906, 2.9219107627868652, 4.205083847045898, 3.127289056777954, 3.6753268241882324, 3.8802618980407715, 2.89264178276062, 3.624936103820801, 3.1005618572235107, 1.3422396183013916, 4.334728240966797, 1.3265577554702759, 4.1707048416137695], "mean_td_error": 3.312990427017212, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 22.0, "diff_num_grad_updates_vs_sampler_policy": 21.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.139654159545898, "actor_loss": -4.7317118644714355, "critic_loss": 1.566927433013916, "alpha_loss": -0.06391864269971848, "alpha_value": 0.9937160015106201, "log_alpha_value": -0.00630382914096117, "target_entropy": -6.0, "policy_t": 0.007276798132807016, "mean_q": 0.634469747543335, "max_q": 0.8123137354850769, "min_q": 0.5323366522789001}, "td_error": [3.527312755584717, 3.3169326782226562, 1.5427769422531128, 4.871818542480469, 3.9366912841796875, 2.7338716983795166, 2.2691125869750977, 1.8749741315841675, 2.5303821563720703, 3.071624279022217, 4.564611434936523, 3.4251770973205566, 5.198422908782959, 3.8019962310791016, 4.276000022888184, 2.6876590251922607, 3.158723831176758, 5.557403564453125, 1.951653003692627, 4.4012250900268555, 3.666656970977783, 2.307162046432495, 3.0617752075195312, 2.489640712738037, 3.747828960418701, 3.0717272758483887, 2.0499825477600098, 2.0799472332000732, 2.0633015632629395, 4.721081733703613, 1.8488960266113281, 2.618082046508789, 1.5997850894927979, 1.3167452812194824, 3.509551763534546, 2.923020839691162, 4.719755172729492, 2.3910791873931885, 0.7861515283584595, 3.2483725547790527, 2.260692596435547, 2.8397891521453857, 2.844644784927368, 2.3960585594177246, 2.0205724239349365, 1.3704290390014648, 3.498741626739502, 2.854595184326172, 0.14867663383483887, 2.0726213455200195, 2.834630012512207, 3.0642852783203125, 3.820486545562744, 3.782130718231201, 1.1590908765792847, 2.739423990249634, 5.653106689453125, 3.3562636375427246, 3.344552993774414, 4.332855224609375, 4.649468421936035, 4.078301429748535, 3.8666791915893555, 5.085235595703125, 0.3215237259864807, 3.5118508338928223, 1.0900033712387085, 1.7987494468688965, 5.137164115905762, 3.005039691925049, 4.675182342529297, 2.9404408931732178, 2.9384372234344482, 3.8446927070617676, 2.120084762573242, 2.9226460456848145, 3.1066935062408447, 1.8960771560668945, 2.87186861038208, 3.6352357864379883, 2.410759449005127, 2.8756752014160156, 5.691736221313477, 3.471386432647705, 2.1168222427368164, 3.922834634780884], "mean_td_error": 3.0615952014923096, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 22.0, "diff_num_grad_updates_vs_sampler_policy": 21.0}}, "num_env_steps_sampled": 20608, "num_env_steps_trained": 5676, "num_agent_steps_sampled": 61824, "num_agent_steps_trained": 5676, "last_target_update_ts": 20608, "num_target_updates": 22}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 61824, "num_agent_steps_trained": 5676, "num_env_steps_sampled": 20608, "num_env_steps_trained": 5676, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 487.32367018707276, "num_env_steps_trained_throughput_per_sec": 140.32311038868838, "timesteps_total": 20608, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 61824, "timers": {"training_iteration_time_ms": 1989.32, "sample_time_ms": 1398.26, "load_time_ms": 0.535, "load_throughput": 482512.343, "learn_time_ms": 63.244, "learn_throughput": 4079.438, "synch_weights_time_ms": 14.843}, "counters": {"num_env_steps_sampled": 20608, "num_env_steps_trained": 5676, "num_agent_steps_sampled": 61824, "num_agent_steps_trained": 5676, "last_target_update_ts": 20608, "num_target_updates": 22}, "done": false, "episodes_total": 0, "training_iteration": 23, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-15-30", "timestamp": 1700201730, "time_this_iter_s": 1.8522448539733887, "time_total_s": 48.10974717140198, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8c8addca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 48.10974717140198, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 87.15, "ram_util_percent": 90.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.18076229095459, "actor_loss": -4.781776428222656, "critic_loss": 4.340683937072754, "alpha_loss": -0.06720586121082306, "alpha_value": 0.9934204816818237, "log_alpha_value": -0.006601260509341955, "target_entropy": -6.0, "policy_t": -0.03502015024423599, "mean_q": 0.6401532292366028, "max_q": 0.7642875909805298, "min_q": 0.5345258116722107}, "td_error": [5.062649726867676, 3.3574118614196777, 6.544333457946777, 4.2564592361450195, 3.457050085067749, 4.009627342224121, 4.169638156890869, 4.745970726013184, 5.156682014465332, 4.509005546569824, 3.1569666862487793, 6.613000392913818, 5.073550224304199, 4.552644729614258, 5.916753768920898, 5.217308521270752, 5.291977882385254, 6.722259998321533, 4.488091468811035, 5.625463485717773, 6.237403869628906, 5.163796424865723, 5.324337959289551, 4.518101692199707, 4.196898460388184, 5.6618123054504395, 5.728540420532227, 5.894986152648926, 3.963809013366699, 5.771037578582764, 5.672634124755859, 5.402885913848877, 4.350610733032227, 6.467487335205078, 5.1547064781188965, 5.609235763549805, 5.473327159881592, 6.37039852142334, 6.576275825500488, 4.843450546264648, 4.529139518737793, 5.9438347816467285, 6.329036712646484, 5.45319938659668, 5.05277681350708, 5.610857963562012, 2.152096748352051, 6.695937633514404, 5.252191543579102, 3.8992910385131836, 6.532976150512695, 4.795589447021484, 4.261835098266602, 5.60340690612793, 4.374139785766602, 5.30272102355957, 4.211231231689453, 5.821369171142578, 5.779271602630615, 4.226846218109131, 4.488131523132324, 5.422515392303467, 5.522921085357666, 6.1393022537231445, 5.337696075439453, 4.926628589630127, 4.424624443054199, 5.573030948638916, 5.178717136383057, 5.776850700378418, 5.6965789794921875, 5.275781631469727, 6.573514938354492, 5.2880635261535645, 5.897803783416748, 5.6015305519104, 5.466882705688477, 5.584024429321289, 6.457232475280762, 6.924216270446777, 3.3430228233337402, 3.4447033405303955, 5.450381278991699, 5.146655082702637, 5.642841815948486, 4.7196760177612305], "mean_td_error": 5.202787399291992, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 23.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.092720031738281, "actor_loss": -4.72124719619751, "critic_loss": 0.7233072519302368, "alpha_loss": -0.06665211915969849, "alpha_value": 0.9934177994728088, "log_alpha_value": -0.006603979971259832, "target_entropy": -6.0, "policy_t": 0.014950326643884182, "mean_q": 0.669622004032135, "max_q": 0.786432683467865, "min_q": 0.5635151267051697}, "td_error": [2.2187907695770264, 0.646141529083252, 3.4466843605041504, 5.300217628479004, 4.256716251373291, 2.2195096015930176, 2.5235133171081543, 4.259826183319092, 4.177074909210205, 2.613288402557373, 2.104991912841797, 4.4242424964904785, 2.986995220184326, 1.1266626119613647, 3.936112642288208, 1.4031301736831665, 4.112155914306641, 3.1794326305389404, 5.509688377380371, 3.8920817375183105, 2.0826778411865234, 3.651893138885498, 2.178394317626953, 4.557100296020508, 2.9907102584838867, 4.481416702270508, 1.8689465522766113, 3.1231961250305176, 3.056922674179077, 4.48630952835083, 2.3465051651000977, 2.4969804286956787, 3.3803224563598633, 3.5847764015197754, 2.5299413204193115, 3.065725803375244, 3.02364444732666, 3.8715782165527344, 4.131931781768799, 0.727199375629425, 2.3485774993896484, 3.830259323120117, 4.569897651672363, 4.857362747192383, 3.101839065551758, 2.704768180847168, 4.212467670440674, 1.1775697469711304, 2.2564949989318848, 5.090743541717529, 1.9375628232955933, 5.045149326324463, 2.260134220123291, 2.957998037338257, 4.384988784790039, 2.981447219848633, 3.326935291290283, 3.011686086654663, 0.6416183710098267, 2.380333423614502, 3.778221368789673, 3.6223926544189453, 1.861793875694275, 1.2818289995193481, 2.8309555053710938, 3.284193992614746, 4.761631011962891, 2.9735631942749023, 3.2913100719451904, 5.439789772033691, 4.279672622680664, 2.895448684692383, 4.308122634887695, 1.5317280292510986, 3.601543664932251, 3.2554423809051514, 2.8287532329559326, 2.35628604888916, 2.3331613540649414, 3.3715906143188477, 3.9772183895111084, 3.051145076751709, 2.0692503452301025, 3.032848358154297, 3.686652660369873, 3.3869190216064453], "mean_td_error": 3.1644504070281982, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 23.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.153879165649414, "actor_loss": -4.820337295532227, "critic_loss": 1.511906385421753, "alpha_loss": -0.06705934554338455, "alpha_value": 0.9934174418449402, "log_alpha_value": -0.006604308728128672, "target_entropy": -6.0, "policy_t": 0.014036514796316624, "mean_q": 0.7017481327056885, "max_q": 0.8553566336631775, "min_q": 0.5835791826248169}, "td_error": [2.690439224243164, 5.755434036254883, 0.6477972269058228, 3.4025707244873047, 5.224966049194336, 3.111423969268799, 2.5499203205108643, 3.289348602294922, 3.503268241882324, 2.1027700901031494, 2.5036065578460693, 3.829824209213257, 4.501701354980469, 3.2745563983917236, 3.0452780723571777, 2.511094331741333, 2.533536911010742, 2.9227447509765625, 4.462726593017578, 4.1168904304504395, 1.0068867206573486, 2.010610580444336, 3.1364493370056152, 3.79842472076416, 3.854618787765503, 3.0551304817199707, 1.7012591361999512, 3.3672733306884766, 3.9292185306549072, 3.2571229934692383, 3.9731030464172363, 2.7082529067993164, 1.2521594762802124, 2.495872974395752, 3.6396942138671875, 1.6366565227508545, 4.652655601501465, 3.1737723350524902, 2.27231502532959, 5.179064750671387, 2.4184823036193848, 2.891139507293701, 4.072431564331055, 1.5901076793670654, 2.40574049949646, 0.9965876936912537, 5.274209022521973, 2.775899887084961, 3.6369447708129883, 2.4260716438293457, 2.733372449874878, 3.5982091426849365, 4.823711395263672, 2.968695878982544, 4.416989326477051, 2.960353374481201, 2.8175649642944336, 4.416720390319824, 3.0184481143951416, 4.09653377532959, 3.01377534866333, 1.3645076751708984, 2.4007272720336914, 1.1692309379577637, 1.0113931894302368, 3.9231460094451904, 3.0471177101135254, 1.780440330505371, 1.713824987411499, 3.4833896160125732, 3.8213183879852295, 3.7330639362335205, 1.7598482370376587, 3.6844825744628906, 3.738476276397705, 4.0163960456848145, 1.2618519067764282, 3.568345069885254, 3.0125441551208496, 2.0012130737304688, 3.126044273376465, 4.007107734680176, 1.0822196006774902, 3.2526323795318604, 3.047118663787842, 1.7720024585723877], "mean_td_error": 3.025707960128784, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 23.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 21504, "num_env_steps_trained": 5934, "num_agent_steps_sampled": 64512, "num_agent_steps_trained": 5934, "last_target_update_ts": 21504, "num_target_updates": 23}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64512, "num_agent_steps_trained": 5934, "num_env_steps_sampled": 21504, "num_env_steps_trained": 5934, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 478.65369860033684, "num_env_steps_trained_throughput_per_sec": 137.826623034472, "timesteps_total": 21504, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 64512, "timers": {"training_iteration_time_ms": 1985.502, "sample_time_ms": 1392.193, "load_time_ms": 0.534, "load_throughput": 482878.372, "learn_time_ms": 63.737, "learn_throughput": 4047.861, "synch_weights_time_ms": 15.275}, "counters": {"num_env_steps_sampled": 21504, "num_env_steps_trained": 5934, "num_agent_steps_sampled": 64512, "num_agent_steps_trained": 5934, "last_target_update_ts": 21504, "num_target_updates": 23}, "done": false, "episodes_total": 0, "training_iteration": 24, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-15-32", "timestamp": 1700201732, "time_this_iter_s": 1.8849318027496338, "time_total_s": 49.99467897415161, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8c8977f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 49.99467897415161, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 65.66666666666667, "ram_util_percent": 90.59999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.166913032531738, "actor_loss": -4.839291095733643, "critic_loss": 4.213350296020508, "alpha_loss": -0.07016719877719879, "alpha_value": 0.9931222200393677, "log_alpha_value": -0.006901524029672146, "target_entropy": -6.0, "policy_t": -0.05672655254602432, "mean_q": 0.6941869258880615, "max_q": 0.8273985981941223, "min_q": 0.599906861782074}, "td_error": [5.650903224945068, 4.8888444900512695, 6.409844398498535, 4.310090065002441, 5.14761209487915, 6.430181980133057, 5.588444709777832, 5.80264949798584, 4.6233625411987305, 2.8788719177246094, 5.125992298126221, 5.046319007873535, 6.377264022827148, 5.756173133850098, 5.8292236328125, 4.249301910400391, 5.912084579467773, 7.064035892486572, 5.044325828552246, 3.921631097793579, 5.737944602966309, 5.403928756713867, 5.6016035079956055, 3.197331666946411, 5.277990341186523, 5.81629753112793, 4.525569915771484, 5.96684455871582, 4.254843711853027, 4.014050483703613, 4.139780521392822, 3.419581413269043, 4.422598838806152, 7.569920539855957, 4.33725118637085, 4.472736358642578, 3.794484853744507, 4.6693620681762695, 3.387213706970215, 6.0247907638549805, 3.7407779693603516, 4.198418617248535, 4.677227020263672, 4.490775108337402, 5.704185485839844, 3.6639904975891113, 5.561293601989746, 5.5724945068359375, 6.2868146896362305, 4.174300670623779, 5.736186504364014, 3.1757047176361084, 5.9814653396606445, 4.632198333740234, 5.732852935791016, 5.132346153259277, 4.257015228271484, 4.493483066558838, 5.551223278045654, 5.7717084884643555, 3.3974838256835938, 6.385956764221191, 6.850832462310791, 4.940131187438965, 3.3773045539855957, 4.958741188049316, 5.23213005065918, 7.649558067321777, 5.074955940246582, 5.320672988891602, 4.581956386566162, 5.244778633117676, 2.5708346366882324, 4.906952857971191, 5.124181747436523, 5.853641510009766, 5.695742607116699, 5.659983158111572, 2.433382511138916, 4.910787582397461, 4.744607925415039, 5.055032730102539, 4.82468843460083, 5.477887153625488, 2.3484156131744385, 4.867914199829102], "mean_td_error": 4.9780731201171875, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 24.0, "diff_num_grad_updates_vs_sampler_policy": 23.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.131627082824707, "actor_loss": -4.799624443054199, "critic_loss": 0.6706266403198242, "alpha_loss": -0.06995201855897903, "alpha_value": 0.993119478225708, "log_alpha_value": -0.006904323119670153, "target_entropy": -6.0, "policy_t": -0.012691744603216648, "mean_q": 0.7103802561759949, "max_q": 0.8239379525184631, "min_q": 0.6077089905738831}, "td_error": [1.7415224313735962, 3.1568922996520996, 3.499189853668213, 2.663154125213623, 4.179390907287598, 5.09078311920166, 1.8273370265960693, 3.4816455841064453, 2.4198789596557617, 4.475722312927246, 5.187471389770508, 1.9093077182769775, 4.9293951988220215, 3.1377456188201904, 7.12992000579834, 2.722817897796631, 3.1679375171661377, 3.08827543258667, 3.5823745727539062, 3.074186086654663, 4.0574846267700195, 3.3441109657287598, 5.2135419845581055, 1.5441519021987915, 4.0605149269104, 0.8703763484954834, 1.7144651412963867, 1.5778485536575317, 5.579639434814453, 2.881082773208618, 2.2225451469421387, 4.356428623199463, 1.5562841892242432, 4.443831920623779, 4.432231426239014, 3.412086009979248, 1.6802562475204468, 2.354729652404785, 1.2089581489562988, 2.682438850402832, 3.4034416675567627, 3.600342273712158, 3.50862979888916, 3.1739397048950195, 2.3784728050231934, 1.9953763484954834, 3.0231878757476807, 3.350492000579834, 3.6166563034057617, 2.6027846336364746, 2.128016948699951, 4.378195762634277, 2.147702932357788, 3.612130880355835, 3.2863564491271973, 2.667588710784912, 1.135805368423462, 2.898294448852539, 3.2370033264160156, 3.985846996307373, 0.7425427436828613, 1.6864633560180664, 1.6866631507873535, 2.654958724975586, 1.1573500633239746, 2.222454309463501, 3.403134346008301, 5.0993428230285645, 2.7487659454345703, 4.402681827545166, 4.2939958572387695, 2.021873950958252, 3.8581643104553223, 2.148016929626465, 2.8930726051330566, 2.605771064758301, 3.0709009170532227, 3.510824203491211, 2.3851985931396484, 2.7294089794158936, 4.17058801651001, 2.4393248558044434, 2.8375039100646973, 4.341381072998047, 3.9478635787963867, 2.389706611633301], "mean_td_error": 3.084141492843628, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 24.0, "diff_num_grad_updates_vs_sampler_policy": 23.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.082048416137695, "actor_loss": -4.814181804656982, "critic_loss": 1.587520956993103, "alpha_loss": -0.06961517035961151, "alpha_value": 0.993118941783905, "log_alpha_value": -0.006904864218086004, "target_entropy": -6.0, "policy_t": 0.016014985740184784, "mean_q": 0.7656277418136597, "max_q": 0.9142107367515564, "min_q": 0.6525787115097046}, "td_error": [2.6981706619262695, 3.319627285003662, 3.626927375793457, 2.6707630157470703, 1.3881957530975342, 2.731822967529297, 3.497023105621338, 3.0040855407714844, 4.345640182495117, 5.057682991027832, 2.422412395477295, 3.1553215980529785, 2.1444644927978516, 3.1134095191955566, 2.6850972175598145, 3.7215781211853027, 2.957181453704834, 4.168590068817139, 2.471432685852051, 3.1517343521118164, 2.1878914833068848, 3.523581027984619, 3.43782114982605, 2.334129810333252, 4.254007339477539, 2.4017510414123535, 2.9263479709625244, 4.370278358459473, 2.296412467956543, 2.9362235069274902, 4.0410566329956055, 4.228964328765869, 4.060385704040527, 4.545901298522949, 3.3079428672790527, 2.4895424842834473, 4.4993486404418945, 3.16593337059021, 2.9249091148376465, 3.9766170978546143, 1.728081226348877, 2.1595888137817383, 3.0038726329803467, 3.060091018676758, 1.686237096786499, 2.2780327796936035, 3.124678134918213, 4.151020050048828, 2.7494394779205322, 2.2328343391418457, 3.5662894248962402, 3.762066602706909, 3.007845401763916, 2.20413875579834, 1.8409074544906616, 3.8071484565734863, 4.177733421325684, 4.124547958374023, 3.6834065914154053, 2.926243305206299, 1.9035098552703857, 3.2305006980895996, 3.6827516555786133, 3.143184185028076, 0.42813363671302795, 3.9257631301879883, 4.700902938842773, 3.606290340423584, 3.9226930141448975, 2.4675517082214355, 3.2041170597076416, 2.8207032680511475, 3.595719814300537, 2.0419015884399414, 2.4499831199645996, 4.460329055786133, 3.652041435241699, 3.40939998626709, 3.7924556732177734, 4.031047344207764, 2.1382651329040527, 2.0192251205444336, 3.2874882221221924, 4.399679660797119, 1.6895251274108887, 2.1639404296875], "mean_td_error": 3.135831594467163, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 24.0, "diff_num_grad_updates_vs_sampler_policy": 23.0}}, "num_env_steps_sampled": 22400, "num_env_steps_trained": 6192, "num_agent_steps_sampled": 67200, "num_agent_steps_trained": 6192, "last_target_update_ts": 22400, "num_target_updates": 24}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 67200, "num_agent_steps_trained": 6192, "num_env_steps_sampled": 22400, "num_env_steps_trained": 6192, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 467.89124334987093, "num_env_steps_trained_throughput_per_sec": 134.72761248244052, "timesteps_total": 22400, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 67200, "timers": {"training_iteration_time_ms": 1985.841, "sample_time_ms": 1390.635, "load_time_ms": 0.53, "load_throughput": 487095.081, "learn_time_ms": 63.618, "learn_throughput": 4055.472, "synch_weights_time_ms": 15.333}, "counters": {"num_env_steps_sampled": 22400, "num_env_steps_trained": 6192, "num_agent_steps_sampled": 67200, "num_agent_steps_trained": 6192, "last_target_update_ts": 22400, "num_target_updates": 24}, "done": false, "episodes_total": 0, "training_iteration": 25, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-15-34", "timestamp": 1700201734, "time_this_iter_s": 1.9297220706939697, "time_total_s": 51.92440104484558, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8aa45ab80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 51.92440104484558, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 70.16666666666667, "ram_util_percent": 90.59999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.167275428771973, "actor_loss": -4.9033613204956055, "critic_loss": 3.987459897994995, "alpha_loss": -0.0732240155339241, "alpha_value": 0.9928239583969116, "log_alpha_value": -0.00720193050801754, "target_entropy": -6.0, "policy_t": -0.005766121204942465, "mean_q": 0.7822467088699341, "max_q": 0.9888315796852112, "min_q": 0.647225558757782}, "td_error": [3.601330280303955, 5.76434326171875, 5.082124710083008, 5.352488994598389, 6.319416522979736, 4.180559158325195, 4.353143692016602, 5.094602584838867, 5.276989936828613, 6.099692344665527, 5.55867862701416, 5.378823757171631, 3.8089218139648438, 5.059220314025879, 3.2039408683776855, 7.252306938171387, 5.943757057189941, 5.5942864418029785, 4.223942756652832, 5.377171516418457, 7.2427449226379395, 4.134774208068848, 5.732996940612793, 4.672520637512207, 3.7294225692749023, 5.3744964599609375, 5.506200790405273, 3.907644748687744, 4.541376113891602, 4.830258369445801, 4.991862773895264, 6.206399917602539, 3.120396137237549, 5.21343994140625, 4.381478309631348, 3.9910776615142822, 2.650005340576172, 6.170920372009277, 3.1507930755615234, 5.28604793548584, 4.3730621337890625, 4.69808292388916, 5.606430530548096, 6.705751895904541, 2.2940006256103516, 5.626302719116211, 5.744289875030518, 5.179872989654541, 4.416708946228027, 6.332596302032471, 2.8422622680664062, 4.4371771812438965, 4.332883358001709, 3.5510475635528564, 5.046357154846191, 4.876003265380859, 4.569259166717529, 5.585497856140137, 5.441030502319336, 4.380454063415527, 5.891819953918457, 5.223433494567871, 4.238372325897217, 3.463531255722046, 5.697738170623779, 5.5208940505981445, 6.468012809753418, 3.6148409843444824, 6.069438934326172, 3.8198699951171875, 3.979685068130493, 5.231600761413574, 6.862297534942627, 3.962738513946533, 3.7597038745880127, 4.113486289978027, 8.842811584472656, 3.1251344680786133, 6.0391764640808105, 4.390393257141113, 4.5275774002075195, 4.136543273925781, 5.253828048706055, 6.601964950561523, 4.831200122833252, 4.0446577072143555], "mean_td_error": 4.919888496398926, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 25.0, "diff_num_grad_updates_vs_sampler_policy": 24.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.05757999420166, "actor_loss": -4.789511203765869, "critic_loss": 0.6352509260177612, "alpha_loss": -0.07246223092079163, "alpha_value": 0.9928211569786072, "log_alpha_value": -0.007204738445580006, "target_entropy": -6.0, "policy_t": -0.01348203793168068, "mean_q": 0.7632556557655334, "max_q": 0.9126371145248413, "min_q": 0.6175748705863953}, "td_error": [2.9970760345458984, 4.249013423919678, 2.112361431121826, 2.6317999362945557, 3.9855337142944336, 3.2208995819091797, 5.174429893493652, 1.5770163536071777, 5.609648704528809, 3.8184866905212402, 2.9141359329223633, 1.9392542839050293, 2.8267245292663574, 0.9727445244789124, 3.1829872131347656, 4.26088809967041, 2.7676215171813965, 2.270724296569824, 2.1408629417419434, 2.248049259185791, 4.715727806091309, 3.1413686275482178, 3.0935866832733154, 4.546222686767578, 2.9573445320129395, 1.5579018592834473, 2.9521288871765137, 2.4813385009765625, 3.1059412956237793, 1.5222349166870117, 3.6169793605804443, 1.7877428531646729, 3.41194224357605, 3.4489498138427734, 2.1927237510681152, 2.779994249343872, 4.961459159851074, 2.7610280513763428, 3.7877650260925293, 3.9851555824279785, 2.1542863845825195, 2.229459524154663, 2.8344712257385254, 2.026543617248535, 2.755077600479126, 3.4475739002227783, 4.214761734008789, 2.825753688812256, 2.197938919067383, 3.3562378883361816, 1.9805630445480347, 2.584456205368042, 4.458986282348633, 3.4576830863952637, 0.9330145716667175, 3.9611942768096924, 2.8674497604370117, 2.752457618713379, 2.521531105041504, 3.5255603790283203, 2.4369359016418457, 4.155206203460693, 3.4756250381469727, 1.7409231662750244, 2.718374252319336, 3.51057767868042, 1.9412384033203125, 1.000788688659668, 3.658695936203003, 2.087169647216797, 2.563701629638672, 1.2737957239151, 2.3553285598754883, 2.7674288749694824, 2.2533998489379883, 1.9573383331298828, 1.7698688507080078, 1.9137921333312988, 3.049485206604004, 3.3505122661590576, 0.5974785089492798, 3.0756325721740723, 2.941788673400879, 2.7796056270599365, 2.4255590438842773, 3.0441737174987793], "mean_td_error": 2.8562467098236084, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 25.0, "diff_num_grad_updates_vs_sampler_policy": 24.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.106623649597168, "actor_loss": -4.909698486328125, "critic_loss": 1.4866712093353271, "alpha_loss": -0.07282168418169022, "alpha_value": 0.9928205609321594, "log_alpha_value": -0.0072053419426083565, "target_entropy": -6.0, "policy_t": -0.03285248577594757, "mean_q": 0.8276107907295227, "max_q": 1.0680770874023438, "min_q": 0.6770725250244141}, "td_error": [3.4022412300109863, 4.56982421875, 1.449414849281311, 2.9831066131591797, 4.556891441345215, 1.3000311851501465, 1.8908863067626953, 3.4899282455444336, 1.2159514427185059, 2.635891914367676, 2.085390090942383, 4.37757682800293, 2.9805071353912354, 3.103245735168457, 3.1252381801605225, 4.45572566986084, 2.030719757080078, 4.504855155944824, 3.775865077972412, 2.7820606231689453, 2.9557275772094727, 2.6142189502716064, 2.644580125808716, 2.359682321548462, 2.8028345108032227, 3.6544477939605713, 2.730649471282959, 4.456301689147949, 2.266234874725342, 3.4040231704711914, 3.512396812438965, 1.838850975036621, 2.157409191131592, 0.19228190183639526, 2.1684513092041016, 4.332827568054199, 5.53446626663208, 3.984970808029175, 3.4872264862060547, 3.09269380569458, 2.0354042053222656, 3.316441297531128, 2.332477569580078, 3.681931972503662, 2.347715377807617, 2.686675548553467, 3.1822197437286377, 1.7781198024749756, 0.5196949243545532, 3.349652051925659, 2.6554903984069824, 1.6302757263183594, 2.6900086402893066, 4.15342903137207, 0.025384247303009033, 1.4380321502685547, 3.0967676639556885, 3.4451160430908203, 3.9296770095825195, 3.40316104888916, 2.1657958030700684, 1.8241348266601562, 3.721864700317383, 3.8912267684936523, 4.82185697555542, 3.1539461612701416, 2.7322998046875, 2.7259156703948975, 2.841407299041748, 3.6885809898376465, 2.6305980682373047, 1.4364936351776123, 3.8008499145507812, 3.8582510948181152, 3.7483277320861816, 2.2560267448425293, 1.065076470375061, 2.952806234359741, 4.352080345153809, 1.7086575031280518, 5.043001174926758, 2.7064402103424072, 4.069812774658203, 4.034822463989258, 4.240028381347656, 2.546090602874756], "mean_td_error": 2.9606943130493164, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 25.0, "diff_num_grad_updates_vs_sampler_policy": 24.0}}, "num_env_steps_sampled": 23296, "num_env_steps_trained": 6450, "num_agent_steps_sampled": 69888, "num_agent_steps_trained": 6450, "last_target_update_ts": 23296, "num_target_updates": 25}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 69888, "num_agent_steps_trained": 6450, "num_env_steps_sampled": 23296, "num_env_steps_trained": 6450, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 488.1708486602665, "num_env_steps_trained_throughput_per_sec": 140.5670524044071, "timesteps_total": 23296, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 69888, "timers": {"training_iteration_time_ms": 1988.895, "sample_time_ms": 1392.407, "load_time_ms": 0.528, "load_throughput": 489098.5, "learn_time_ms": 63.537, "learn_throughput": 4060.596, "synch_weights_time_ms": 15.401}, "counters": {"num_env_steps_sampled": 23296, "num_env_steps_trained": 6450, "num_agent_steps_sampled": 69888, "num_agent_steps_trained": 6450, "last_target_update_ts": 23296, "num_target_updates": 25}, "done": false, "episodes_total": 0, "training_iteration": 26, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-15-36", "timestamp": 1700201736, "time_this_iter_s": 1.850019931793213, "time_total_s": 53.774420976638794, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8981f55e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 53.774420976638794, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 84.4, "ram_util_percent": 90.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.98558521270752, "actor_loss": -4.819416046142578, "critic_loss": 3.991089344024658, "alpha_loss": -0.07491645216941833, "alpha_value": 0.9925256371498108, "log_alpha_value": -0.007502459920942783, "target_entropy": -6.0, "policy_t": 0.01710391789674759, "mean_q": 0.8464447855949402, "max_q": 1.02470064163208, "min_q": 0.6858788728713989}, "td_error": [4.127683162689209, 4.078202247619629, 5.207353115081787, 5.4601521492004395, 3.357753038406372, 3.4558677673339844, 5.650326728820801, 5.00780725479126, 5.218250274658203, 7.570608139038086, 4.927740573883057, 4.243176460266113, 4.982934474945068, 3.164053201675415, 5.045773029327393, 4.354698657989502, 6.5788350105285645, 5.564153671264648, 3.3463239669799805, 4.247089862823486, 3.9813146591186523, 4.773109436035156, 2.7365262508392334, 6.621927738189697, 5.152440071105957, 5.6126909255981445, 7.213108062744141, 6.070470333099365, 4.276947975158691, 3.2879133224487305, 3.9751620292663574, 4.684205055236816, 5.895656585693359, 3.102994441986084, 7.6002044677734375, 4.677852630615234, 3.876371145248413, 4.042260646820068, 2.772383213043213, 2.911792278289795, 5.470616817474365, 3.418694496154785, 6.180703163146973, 4.583768844604492, 8.07433795928955, 6.354310989379883, 5.002861022949219, 4.316939830780029, 4.813440322875977, 3.408475399017334, 2.6872470378875732, 2.010223865509033, 4.602940559387207, 7.152541637420654, 4.093914985656738, 5.4195756912231445, 4.359096527099609, 5.289505958557129, 5.793645858764648, 3.9537980556488037, 3.2009668350219727, 5.064394474029541, 4.379732131958008, 4.1503190994262695, 5.012753486633301, 4.103215217590332, 4.056963920593262, 2.1187171936035156, 5.3683013916015625, 4.6494927406311035, 4.114919662475586, 3.433324098587036, 5.239043235778809, 4.6021552085876465, 3.621457576751709, 5.366055488586426, 5.0054779052734375, 4.096096992492676, 5.926480293273926, 5.496077537536621, 6.318058967590332, 4.905562400817871, 4.472193717956543, 5.720071792602539, 5.953760623931885, 4.402462959289551], "mean_td_error": 4.72812557220459, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 26.0, "diff_num_grad_updates_vs_sampler_policy": 25.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.078056335449219, "actor_loss": -4.867385387420654, "critic_loss": 0.6252675652503967, "alpha_loss": -0.07563648372888565, "alpha_value": 0.9925230145454407, "log_alpha_value": -0.007505067158490419, "target_entropy": -6.0, "policy_t": 0.003971809521317482, "mean_q": 0.8302092552185059, "max_q": 1.0140366554260254, "min_q": 0.7118752598762512}, "td_error": [3.6128954887390137, 2.938507318496704, 4.23214054107666, 1.4086089134216309, 4.418771743774414, 1.2235486507415771, 2.6716017723083496, 4.245683193206787, 0.6916919946670532, 2.8831958770751953, 2.4062347412109375, 2.9018828868865967, 4.535134315490723, 2.0941905975341797, 5.517455101013184, 2.2100024223327637, 1.8385937213897705, 2.2332730293273926, 3.8596088886260986, 2.650458335876465, 0.7547035217285156, 3.0951766967773438, 4.706265926361084, 2.0769803524017334, 2.47940731048584, 4.336383819580078, 2.4662537574768066, 1.9006412029266357, 3.2348875999450684, 2.932861328125, 1.3601676225662231, 1.8385554552078247, 3.6457595825195312, 1.7859376668930054, 3.3261518478393555, 2.818605899810791, 3.0852248668670654, 2.832223653793335, 3.3768749237060547, 4.666204452514648, 3.087963581085205, 4.0712175369262695, 2.2894577980041504, 1.9865928888320923, 2.3098583221435547, 3.3660712242126465, 3.2477622032165527, 2.252349853515625, 1.8447132110595703, 1.3509910106658936, 2.5162477493286133, 6.316547870635986, 2.8106918334960938, 1.8132474422454834, 2.0438950061798096, 3.7204442024230957, 0.9054135084152222, 3.60542631149292, 4.208638668060303, 4.060006141662598, 2.0719661712646484, 3.579815626144409, 4.222338676452637, 1.2671154737472534, 3.8035497665405273, 2.773874044418335, 1.6111356019973755, 1.1445865631103516, 3.1892638206481934, 1.7319083213806152, 2.90372371673584, 3.198132038116455, 2.429225206375122, 0.7028909921646118, 1.9475064277648926, 4.312191963195801, 1.7909482717514038, 1.0427508354187012, 1.7701830863952637, 2.2236781120300293, 4.219845771789551, 2.7733659744262695, 3.4358701705932617, 3.7513012886047363, 3.2999722957611084, 1.309488296508789], "mean_td_error": 2.7861268520355225, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 26.0, "diff_num_grad_updates_vs_sampler_policy": 25.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.086324691772461, "actor_loss": -4.967813014984131, "critic_loss": 0.9739453792572021, "alpha_loss": -0.07570593804121017, "alpha_value": 0.9925222992897034, "log_alpha_value": -0.007505800575017929, "target_entropy": -6.0, "policy_t": 0.030654774978756905, "mean_q": 0.9253978133201599, "max_q": 1.086751937866211, "min_q": 0.7700334191322327}, "td_error": [3.1841821670532227, 4.055366516113281, 3.785085678100586, 3.453531503677368, 5.389535903930664, 1.3297874927520752, 3.087775468826294, 1.6814285516738892, 3.140119791030884, 3.316030979156494, 4.43968391418457, 3.0211968421936035, 3.5962653160095215, 3.2995591163635254, 3.1280202865600586, 2.0480687618255615, 2.8274588584899902, 2.144927978515625, 1.3718563318252563, 3.12894344329834, 2.54671573638916, 3.0899648666381836, 3.250826358795166, 1.3991013765335083, 1.6319772005081177, 3.1814582347869873, 2.0655441284179688, 3.458681583404541, 3.238434314727783, 2.589085578918457, 1.325560450553894, 4.180607795715332, 2.6214652061462402, 3.20273494720459, 2.5827484130859375, 4.261866569519043, 3.9121975898742676, 1.1708921194076538, 2.687897205352783, 1.0890089273452759, 3.20186185836792, 4.092336177825928, 3.759437322616577, 3.4728212356567383, 3.0376927852630615, 2.9107446670532227, 3.3220791816711426, 3.41569185256958, 2.514265775680542, 1.504917860031128, 2.5463621616363525, 2.810863494873047, 2.3987202644348145, 3.514463424682617, 1.2645238637924194, 2.765465259552002, 3.9666593074798584, 3.2062811851501465, 2.5665130615234375, 2.2523317337036133, 2.6680870056152344, 3.0026979446411133, 3.31252384185791, 1.6747775077819824, 2.7114036083221436, 2.730067014694214, 1.5111624002456665, 2.0159785747528076, 2.7085323333740234, 4.702844619750977, 2.521122455596924, 5.2014546394348145, 3.3961730003356934, 3.3146955966949463, 3.0522799491882324, 3.8769798278808594, 2.8447890281677246, 2.443960666656494, 3.316556930541992, 4.785262584686279, 2.5863003730773926, 3.626326560974121, 2.695009708404541, 3.0768842697143555, 3.349872350692749, 1.7191393375396729], "mean_td_error": 2.9335408210754395, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 26.0, "diff_num_grad_updates_vs_sampler_policy": 25.0}}, "num_env_steps_sampled": 24192, "num_env_steps_trained": 6708, "num_agent_steps_sampled": 72576, "num_agent_steps_trained": 6708, "last_target_update_ts": 24192, "num_target_updates": 26}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72576, "num_agent_steps_trained": 6708, "num_env_steps_sampled": 24192, "num_env_steps_trained": 6708, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 453.08358804063613, "num_env_steps_trained_throughput_per_sec": 130.4638010206296, "timesteps_total": 24192, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 72576, "timers": {"training_iteration_time_ms": 1972.348, "sample_time_ms": 1376.727, "load_time_ms": 0.528, "load_throughput": 488568.528, "learn_time_ms": 63.426, "learn_throughput": 4067.727, "synch_weights_time_ms": 15.364}, "counters": {"num_env_steps_sampled": 24192, "num_env_steps_trained": 6708, "num_agent_steps_sampled": 72576, "num_agent_steps_trained": 6708, "last_target_update_ts": 24192, "num_target_updates": 26}, "done": false, "episodes_total": 0, "training_iteration": 27, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-15-38", "timestamp": 1700201738, "time_this_iter_s": 1.9938559532165527, "time_total_s": 55.76827692985535, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8c8ad7280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 55.76827692985535, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 71.89999999999999, "ram_util_percent": 90.63333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.08263874053955, "actor_loss": -4.977996349334717, "critic_loss": 4.114315986633301, "alpha_loss": -0.07867209613323212, "alpha_value": 0.9922276139259338, "log_alpha_value": -0.00780272763222456, "target_entropy": -6.0, "policy_t": -0.05502840504050255, "mean_q": 0.9267481565475464, "max_q": 1.1120387315750122, "min_q": 0.7853307723999023}, "td_error": [5.183449745178223, 5.886838912963867, 5.2510986328125, 3.984046220779419, 6.086193084716797, 6.777736663818359, 5.606722831726074, 5.278345108032227, 3.70997953414917, 3.8260204792022705, 4.118556976318359, 3.7228827476501465, 4.814002990722656, 6.252026557922363, 4.18324613571167, 3.013180732727051, 4.965167999267578, 5.31719970703125, 4.306604385375977, 3.456531524658203, 5.808772087097168, 6.4145355224609375, 3.1774964332580566, 6.049696922302246, 6.4944376945495605, 3.705111026763916, 5.0551958084106445, 6.026003837585449, 4.097293376922607, 5.536872863769531, 4.180813312530518, 5.671233177185059, 4.903258323669434, 5.371739387512207, 5.497020244598389, 5.255125999450684, 1.7522408962249756, 4.447760581970215, 5.678528785705566, 3.5845868587493896, 5.966224670410156, 4.65831184387207, 6.636089324951172, 4.905999183654785, 5.726292610168457, 2.944228410720825, 3.912914276123047, 5.050329208374023, 4.657190322875977, 2.97467041015625, 4.953502178192139, 4.472253322601318, 5.891737937927246, 5.394554138183594, 3.758883476257324, 4.724534511566162, 4.523622512817383, 6.041036128997803, 6.049147129058838, 5.670875549316406, 4.0643696784973145, 3.8042049407958984, 4.615090370178223, 3.4852819442749023, 6.260662078857422, 5.764173984527588, 5.320347785949707, 5.699855804443359, 4.4189534187316895, 4.526156425476074, 5.348365783691406, 4.799258232116699, 4.775092601776123, 3.261565685272217, 3.662355422973633, 3.6946728229522705, 5.550873279571533, 4.063401222229004, 6.764801025390625, 4.923090934753418, 4.938704490661621, 5.530588150024414, 2.7780323028564453, 2.9143753051757812, 5.6521382331848145, 5.141833782196045], "mean_td_error": 4.826955795288086, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 27.0, "diff_num_grad_updates_vs_sampler_policy": 26.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.115937232971191, "actor_loss": -4.955439567565918, "critic_loss": 0.712788999080658, "alpha_loss": -0.07895854860544205, "alpha_value": 0.9922250509262085, "log_alpha_value": -0.007805361412465572, "target_entropy": -6.0, "policy_t": -0.04025149345397949, "mean_q": 0.8924092054367065, "max_q": 1.0867390632629395, "min_q": 0.7433624267578125}, "td_error": [3.1340208053588867, 3.447826862335205, 4.379505157470703, 2.6774566173553467, 2.271040916442871, 4.2155890464782715, 3.2692651748657227, 2.9698970317840576, 1.4547598361968994, 2.4813356399536133, 4.040032863616943, 2.208289623260498, 2.3088948726654053, 2.911220073699951, 5.483952522277832, 2.4145779609680176, 1.4211838245391846, 4.334125518798828, 3.348679542541504, 2.214020252227783, 2.6005868911743164, 3.547191858291626, 2.481541633605957, 3.9273922443389893, 3.073901653289795, 3.2411179542541504, 3.1200366020202637, 3.0343737602233887, 2.243259906768799, 3.7354490756988525, 3.480131149291992, 1.780548095703125, 2.6211800575256348, 2.0701522827148438, 1.6266372203826904, 2.2942869663238525, 5.02312707901001, 3.851698875427246, 2.305006265640259, 3.1470084190368652, 3.5387494564056396, 3.0664501190185547, 4.512723922729492, 2.649456024169922, 3.210440158843994, 2.4062817096710205, 5.092029571533203, 2.5751278400421143, 2.7541682720184326, 2.9012279510498047, 3.901676654815674, 3.448117971420288, 3.4660491943359375, 1.9765692949295044, 4.233063697814941, 2.0706005096435547, 2.2802093029022217, 2.934988498687744, 3.091876268386841, 3.803745746612549, 3.3486571311950684, 4.228797912597656, 2.7367663383483887, 3.0993258953094482, 3.1956520080566406, 2.206489086151123, 2.631582021713257, 2.820258378982544, 3.3340673446655273, 3.124737501144409, 2.9815609455108643, 2.9324560165405273, 3.796133518218994, 3.360261917114258, 3.6029038429260254, 4.76917028427124, 1.6839269399642944, 3.809587240219116, 3.6024117469787598, 3.079740285873413, 2.7045679092407227, 1.3812811374664307, 2.8676741123199463, 3.1992862224578857, 4.33358907699585, 3.468989133834839], "mean_td_error": 3.0977180004119873, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 27.0, "diff_num_grad_updates_vs_sampler_policy": 26.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.17012882232666, "actor_loss": -5.102965831756592, "critic_loss": 0.8944388628005981, "alpha_loss": -0.07939007133245468, "alpha_value": 0.9922242164611816, "log_alpha_value": -0.007806200999766588, "target_entropy": -6.0, "policy_t": -0.004442668054252863, "mean_q": 0.9956721663475037, "max_q": 1.2191840410232544, "min_q": 0.831844687461853}, "td_error": [4.683604717254639, 3.838897228240967, 2.3673431873321533, 2.8763961791992188, 0.26817238330841064, 3.6336827278137207, 1.851377248764038, 2.835545539855957, 3.108981132507324, 4.004833221435547, 1.1672803163528442, 3.7257328033447266, 2.6207761764526367, 1.4082324504852295, 0.3657054305076599, 1.5999163389205933, 2.144979476928711, 4.043013572692871, 2.2479629516601562, 3.8175175189971924, 3.006051778793335, 1.5540292263031006, 0.902709424495697, 2.572751045227051, 1.4273102283477783, 4.00734281539917, 4.750271320343018, 2.983476161956787, 2.4446654319763184, 3.9417104721069336, 1.2730610370635986, 2.3412299156188965, 2.1929917335510254, 1.4695794582366943, 3.239063262939453, 3.015872001647949, 2.4740562438964844, 2.5886189937591553, 0.06860220432281494, 3.073957920074463, 5.3256025314331055, 5.084512710571289, 3.8241989612579346, 3.160501003265381, 2.6910078525543213, 1.9132916927337646, 3.8145694732666016, 3.454864978790283, 4.196555137634277, 3.603525161743164, 3.1533050537109375, 2.61808705329895, 2.2441647052764893, 3.188326358795166, 3.0774712562561035, 3.4639294147491455, 2.4191880226135254, 3.1838438510894775, 2.943065643310547, 1.9657663106918335, 2.0123097896575928, 1.367327094078064, 1.7082866430282593, 2.614983558654785, 2.7371349334716797, 3.0469274520874023, 0.37296122312545776, 1.2998018264770508, 2.063887119293213, 3.280045986175537, 2.015331745147705, 2.7142276763916016, 0.7690646648406982, 3.2439064979553223, 2.888343095779419, 3.837719440460205, 1.5917612314224243, 4.1343889236450195, 3.353057384490967, 2.0155839920043945, 3.6831860542297363, 4.243772506713867, 3.5615577697753906, 3.268263816833496, 2.4512243270874023, 3.18990159034729], "mean_td_error": 2.729396104812622, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 27.0, "diff_num_grad_updates_vs_sampler_policy": 26.0}}, "num_env_steps_sampled": 25088, "num_env_steps_trained": 6966, "num_agent_steps_sampled": 75264, "num_agent_steps_trained": 6966, "last_target_update_ts": 25088, "num_target_updates": 27}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 75264, "num_agent_steps_trained": 6966, "num_env_steps_sampled": 25088, "num_env_steps_trained": 6966, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 424.7679698352399, "num_env_steps_trained_throughput_per_sec": 122.31041988559363, "timesteps_total": 25088, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 75264, "timers": {"training_iteration_time_ms": 1982.096, "sample_time_ms": 1386.366, "load_time_ms": 0.528, "load_throughput": 488833.37, "learn_time_ms": 63.379, "learn_throughput": 4070.734, "synch_weights_time_ms": 15.883}, "counters": {"num_env_steps_sampled": 25088, "num_env_steps_trained": 6966, "num_agent_steps_sampled": 75264, "num_agent_steps_trained": 6966, "last_target_update_ts": 25088, "num_target_updates": 27}, "done": false, "episodes_total": 0, "training_iteration": 28, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-15-40", "timestamp": 1700201740, "time_this_iter_s": 2.1240830421447754, "time_total_s": 57.89235997200012, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8aa45ab80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 57.89235997200012, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 64.39999999999999, "ram_util_percent": 90.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.106252670288086, "actor_loss": -5.080538272857666, "critic_loss": 3.9195375442504883, "alpha_loss": -0.08189062029123306, "alpha_value": 0.9919297695159912, "log_alpha_value": -0.008102966472506523, "target_entropy": -6.0, "policy_t": 0.030813654884696007, "mean_q": 1.0095672607421875, "max_q": 1.1726754903793335, "min_q": 0.8214488625526428}, "td_error": [4.064730644226074, 5.950908660888672, 4.4618988037109375, 4.66374397277832, 4.140822887420654, 5.125251770019531, 5.208103656768799, 6.3066301345825195, 5.995590686798096, 5.34569787979126, 7.1956329345703125, 3.93208646774292, 3.3900859355926514, 2.858898401260376, 4.42014217376709, 4.382002830505371, 4.944306373596191, 3.7172083854675293, 3.8640224933624268, 2.079881429672241, 3.855499744415283, 5.363323211669922, 3.9933011531829834, 5.907708168029785, 6.563032150268555, 3.724628210067749, 3.520318031311035, 4.904450416564941, 5.715084075927734, 2.116804599761963, 4.208394527435303, 2.722318649291992, 4.293952465057373, 5.5560302734375, 5.717809677124023, 4.635200500488281, 4.227795600891113, 4.937204837799072, 3.712977409362793, 5.848819732666016, 5.996381759643555, 4.226534843444824, 4.10107421875, 5.142505645751953, 4.627853870391846, 4.671901226043701, 5.062502861022949, 6.0927019119262695, 8.027795791625977, 6.893068313598633, 2.071732521057129, 4.565274238586426, 4.165282726287842, 3.912417411804199, 4.994555473327637, 4.178995132446289, 4.331916809082031, 2.071845054626465, 5.0258378982543945, 3.4552478790283203, 4.581407070159912, 5.694547653198242, 1.982543706893921, 3.5429909229278564, 3.9547502994537354, 1.7756038904190063, 5.433357238769531, 3.634105682373047, 5.386837959289551, 4.313645362854004, 5.317561626434326, 4.650138854980469, 6.453198432922363, 3.0912299156188965, 4.68095588684082, 5.03047513961792, 3.922562837600708, 3.719421625137329, 3.1977322101593018, 6.759389877319336, 4.552069664001465, 4.451609134674072, 3.795900821685791, 6.313364505767822, 5.309532165527344, 4.612595081329346], "mean_td_error": 4.573781967163086, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 28.0, "diff_num_grad_updates_vs_sampler_policy": 27.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.108720779418945, "actor_loss": -5.027413845062256, "critic_loss": 0.6113481521606445, "alpha_loss": -0.08193828165531158, "alpha_value": 0.9919270873069763, "log_alpha_value": -0.008105702698230743, "target_entropy": -6.0, "policy_t": -0.036651648581027985, "mean_q": 0.9438295364379883, "max_q": 1.1330760717391968, "min_q": 0.7761752605438232}, "td_error": [2.623699188232422, 2.855748176574707, 3.219496488571167, 3.1197328567504883, 2.040898323059082, 2.2492456436157227, 4.749171257019043, 2.748964786529541, 1.6172716617584229, 3.658991575241089, 1.7741491794586182, 3.54170560836792, 2.485590696334839, 1.99355149269104, 2.3289732933044434, 1.8277993202209473, 3.9679791927337646, 1.687520146369934, 2.5231475830078125, 3.380350112915039, 2.5197973251342773, 3.7487661838531494, 4.149388313293457, 3.27634334564209, 3.7153563499450684, 3.380664348602295, 2.455122947692871, 2.3419392108917236, 2.8992648124694824, 2.890003204345703, 2.78639817237854, 2.8685221672058105, 2.115403175354004, 2.758331775665283, 3.8580076694488525, 2.3078389167785645, 4.60895299911499, 3.1246113777160645, 2.014554262161255, 2.648667812347412, 2.243989944458008, 2.6762800216674805, 4.10765266418457, 3.9102847576141357, 2.35447359085083, 2.333529472351074, 2.3367741107940674, 4.002660751342773, 2.113766670227051, 1.9381084442138672, 1.7316932678222656, 2.1261396408081055, 1.7037156820297241, 3.893481731414795, 1.61722731590271, 2.7031478881835938, 3.225821018218994, 2.1219801902770996, 3.0897598266601562, 3.145805835723877, 1.3520596027374268, 3.14016056060791, 1.8848369121551514, 4.732813358306885, 2.850269317626953, 2.454958915710449, 1.9540730714797974, 2.63974666595459, 2.094773530960083, 2.6359500885009766, 3.226634979248047, 3.0422325134277344, 2.6209423542022705, 3.5923194885253906, 4.46298885345459, 3.006638765335083, 2.004033088684082, 3.5399885177612305, 3.812018394470215, 2.5255465507507324, 4.172670364379883, 1.6436724662780762, 2.7849740982055664, 1.7879595756530762, 2.766282558441162, 2.452517509460449], "mean_td_error": 2.8072006702423096, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 28.0, "diff_num_grad_updates_vs_sampler_policy": 27.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.059309005737305, "actor_loss": -5.110556602478027, "critic_loss": 0.8131451606750488, "alpha_loss": -0.08154799789190292, "alpha_value": 0.9919260740280151, "log_alpha_value": -0.008106719702482224, "target_entropy": -6.0, "policy_t": -0.0038111312314867973, "mean_q": 1.0747638940811157, "max_q": 1.2846405506134033, "min_q": 0.8713479042053223}, "td_error": [3.0924439430236816, 0.03584390878677368, 2.5101327896118164, 1.662971019744873, 1.5711987018585205, 5.15855598449707, 2.7481536865234375, 2.2067768573760986, 1.0667250156402588, 0.6609631776809692, 1.0437166690826416, 3.369959592819214, 0.4228011965751648, 2.9596102237701416, 2.690479278564453, 3.155681610107422, 2.312572956085205, 2.5953173637390137, 1.399737000465393, 3.183979034423828, 1.3515528440475464, 1.5399436950683594, 3.0223746299743652, 2.5193357467651367, 2.6847705841064453, 2.101022243499756, 1.3998279571533203, 4.051882743835449, 3.428234338760376, 2.8083572387695312, 1.074601650238037, 4.48881721496582, 4.300485610961914, 2.5359697341918945, 2.8989572525024414, 4.317729949951172, 2.1227338314056396, 2.824974775314331, 2.9361863136291504, 2.539126396179199, 2.6778862476348877, 1.4831019639968872, 1.849024772644043, 1.6343331336975098, 3.1821765899658203, 2.3977322578430176, 2.2114222049713135, 4.511998176574707, 3.002873659133911, 2.754535675048828, 2.8070480823516846, 2.0732579231262207, 2.991776943206787, 3.5950088500976562, 4.598089218139648, 3.3036999702453613, 1.3349332809448242, 3.427642822265625, 3.263979196548462, 1.6670162677764893, 4.269058704376221, 2.5318543910980225, 2.3518543243408203, 2.964215040206909, 3.8412704467773438, 2.653346300125122, 2.3953051567077637, 2.2764105796813965, 1.9904663562774658, 2.1271426677703857, 3.7549755573272705, 1.3740484714508057, 1.5809701681137085, 1.5548884868621826, 3.510403633117676, 1.5028692483901978, 2.026744842529297, 2.221186637878418, 1.5755891799926758, 2.4418816566467285, 1.8001954555511475, 1.778510332107544, 2.232048511505127, 2.66171932220459, 2.608882188796997, 4.1859941482543945], "mean_td_error": 2.532254457473755, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 28.0, "diff_num_grad_updates_vs_sampler_policy": 27.0}}, "num_env_steps_sampled": 25984, "num_env_steps_trained": 7224, "num_agent_steps_sampled": 77952, "num_agent_steps_trained": 7224, "last_target_update_ts": 25984, "num_target_updates": 28}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 77952, "num_agent_steps_trained": 7224, "num_env_steps_sampled": 25984, "num_env_steps_trained": 7224, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 380.06234602079974, "num_env_steps_trained_throughput_per_sec": 109.43759517116779, "timesteps_total": 25984, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 77952, "timers": {"training_iteration_time_ms": 1977.383, "sample_time_ms": 1406.032, "load_time_ms": 0.526, "load_throughput": 490139.701, "learn_time_ms": 63.186, "learn_throughput": 4083.208, "synch_weights_time_ms": 15.767}, "counters": {"num_env_steps_sampled": 25984, "num_env_steps_trained": 7224, "num_agent_steps_sampled": 77952, "num_agent_steps_trained": 7224, "last_target_update_ts": 25984, "num_target_updates": 28}, "done": false, "episodes_total": 0, "training_iteration": 29, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-15-42", "timestamp": 1700201742, "time_this_iter_s": 2.372257947921753, "time_total_s": 60.264617919921875, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8981f5940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 60.264617919921875, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 68.14999999999999, "ram_util_percent": 90.77499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.036892890930176, "actor_loss": -5.11405611038208, "critic_loss": 3.8451149463653564, "alpha_loss": -0.08434229344129562, "alpha_value": 0.9916319847106934, "log_alpha_value": -0.008403227664530277, "target_entropy": -6.0, "policy_t": 0.03078393265604973, "mean_q": 1.1062721014022827, "max_q": 1.3381907939910889, "min_q": 0.9018672704696655}, "td_error": [4.961766242980957, 5.147754669189453, 5.292573928833008, 4.552122116088867, 3.426485538482666, 5.231882095336914, 3.624424695968628, 5.153084754943848, 3.2578234672546387, 5.178798675537109, 5.7066192626953125, 2.867988109588623, 5.867256164550781, 5.183554649353027, 6.142115592956543, 4.366974830627441, 4.253060340881348, 3.5806543827056885, 3.104419708251953, 4.218132495880127, 3.8990964889526367, 3.575978994369507, 3.452456474304199, 3.9334685802459717, 6.030317306518555, 4.611469745635986, 2.4274072647094727, 4.106040000915527, 2.232581615447998, 4.282036781311035, 3.463538646697998, 3.765636444091797, 4.9599175453186035, 5.042922019958496, 3.896493673324585, 4.477725982666016, 3.145476818084717, 3.530050277709961, 6.683994293212891, 3.532733917236328, 3.7655694484710693, 5.95433235168457, 5.131038188934326, 6.4405622482299805, 3.784083604812622, 4.056504249572754, 5.2480363845825195, 4.930885314941406, 4.012551784515381, 7.148303985595703, 5.44412899017334, 4.579029560089111, 4.716663360595703, 5.740847110748291, 4.0316572189331055, 4.008081912994385, 5.391193389892578, 5.941688537597656, 5.47481632232666, 5.920443534851074, 3.837620735168457, 4.282914161682129, 2.890892267227173, 5.926478385925293, 3.1900720596313477, 5.299740791320801, 2.434542179107666, 6.107098579406738, 3.7420406341552734, 6.113183975219727, 5.371217727661133, 3.7896249294281006, 2.694488525390625, 4.620223045349121, 5.970054626464844, 3.938040256500244, 5.1124067306518555, 4.754855632781982, 4.813633918762207, 5.099809646606445, 4.695951461791992, 6.3600029945373535, 3.2640395164489746, 3.0891003608703613, 5.369182586669922, 5.729513168334961], "mean_td_error": 4.5626044273376465, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 29.0, "diff_num_grad_updates_vs_sampler_policy": 28.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.030982971191406, "actor_loss": -5.027792453765869, "critic_loss": 0.6060240268707275, "alpha_loss": -0.08432112634181976, "alpha_value": 0.9916291832923889, "log_alpha_value": -0.008406068198382854, "target_entropy": -6.0, "policy_t": 0.025881102308630943, "mean_q": 1.028658151626587, "max_q": 1.2726237773895264, "min_q": 0.8778669834136963}, "td_error": [3.67572021484375, 2.2524466514587402, 5.053614616394043, 2.975691556930542, 1.9145292043685913, 3.248415946960449, 3.2997870445251465, 1.6699599027633667, 2.777904987335205, 3.319387435913086, 6.520537853240967, 2.25656795501709, 3.008572578430176, 3.1862897872924805, 3.9900550842285156, 1.3540161848068237, 3.1212542057037354, 2.7897582054138184, 1.9246087074279785, 2.622589349746704, 2.3105058670043945, 3.4035611152648926, 2.8306541442871094, 3.3554368019104004, 2.49643611907959, 3.3486568927764893, 1.2671207189559937, 3.318725347518921, 3.3440160751342773, 1.7838096618652344, 2.1068873405456543, 2.6670212745666504, 3.7312674522399902, 3.112515926361084, 2.6494228839874268, 0.8403995037078857, 1.5523232221603394, 2.8185243606567383, 4.079699516296387, 0.8980093002319336, 4.419971942901611, 0.3848244845867157, 4.353987693786621, 3.3307032585144043, 1.86655592918396, 2.319732189178467, 1.102805256843567, 3.026569128036499, 2.030726671218872, 2.3397748470306396, 2.0742597579956055, 3.6710095405578613, 1.8859636783599854, 1.487606406211853, 3.0061357021331787, 2.061051607131958, 3.174286365509033, 2.481574535369873, 5.132510185241699, 2.6404454708099365, 2.933238983154297, 2.5357460975646973, 3.5680794715881348, 1.6413116455078125, 3.571580171585083, 2.9164843559265137, 2.8693368434906006, 2.849686622619629, 3.1390538215637207, 1.8971809148788452, 2.326502561569214, 2.4296369552612305, 0.9231249094009399, 2.428832530975342, 2.204404354095459, 2.688894033432007, 1.9384708404541016, 3.9616754055023193, 0.7562310099601746, 3.7920494079589844, 0.046152710914611816, 2.2838850021362305, 2.898043155670166, 4.107625961303711, 1.9180207252502441, 3.542623281478882], "mean_td_error": 2.695756673812866, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 29.0, "diff_num_grad_updates_vs_sampler_policy": 28.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.106093406677246, "actor_loss": -5.2240095138549805, "critic_loss": 0.8569784760475159, "alpha_loss": -0.08496306091547012, "alpha_value": 0.991628110408783, "log_alpha_value": -0.008407113142311573, "target_entropy": -6.0, "policy_t": 0.014166165143251419, "mean_q": 1.1547229290008545, "max_q": 1.489966630935669, "min_q": 0.9525184035301208}, "td_error": [0.9866999387741089, 2.9819107055664062, 3.334642171859741, 3.3457119464874268, 2.412144184112549, 1.1894173622131348, 4.5265302658081055, 2.210062265396118, 3.8358371257781982, 0.35355865955352783, 2.5825438499450684, 1.966407299041748, 3.185105562210083, 2.4310319423675537, 2.1179933547973633, 4.398769378662109, 1.0220508575439453, 1.4216480255126953, 2.996535301208496, 3.0160303115844727, 1.8439552783966064, 3.388953447341919, 3.8250603675842285, 5.3878607749938965, 2.5291833877563477, 2.221867799758911, 4.270321369171143, 0.8792750835418701, 2.5073018074035645, 3.4825782775878906, 2.34086537361145, 2.937110424041748, 0.6427573561668396, 4.464440822601318, 1.6119470596313477, 2.9138264656066895, 2.6064085960388184, 1.1681679487228394, 3.606842279434204, 5.133581161499023, 1.6630356311798096, 2.7116713523864746, 4.025951385498047, 3.9139082431793213, 2.37001895904541, 3.574172019958496, 1.6863765716552734, 4.172408103942871, 2.9017672538757324, 3.4080820083618164, 2.3743996620178223, 1.6505053043365479, 1.923614263534546, 1.4230427742004395, 2.0609891414642334, 2.41550612449646, 2.7508578300476074, 2.6145105361938477, 2.7364959716796875, 2.5606343746185303, 1.4810822010040283, 3.260171413421631, 2.8058669567108154, 2.986924171447754, 2.3478102684020996, 3.011018753051758, 2.397976875305176, 1.9145292043685913, 1.3153209686279297, 1.6321771144866943, 3.9799060821533203, 3.1577062606811523, 2.0794687271118164, 3.2664008140563965, 2.3281548023223877, 1.9399478435516357, 3.4857394695281982, 4.587132930755615, 2.410374641418457, 1.0731854438781738, 1.8337336778640747, 3.666335105895996, 3.913038730621338, 3.285693883895874, 2.433079957962036, 1.7591906785964966], "mean_td_error": 2.6670563220977783, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 29.0, "diff_num_grad_updates_vs_sampler_policy": 28.0}}, "num_env_steps_sampled": 26880, "num_env_steps_trained": 7482, "num_agent_steps_sampled": 80640, "num_agent_steps_trained": 7482, "last_target_update_ts": 26880, "num_target_updates": 29}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80640, "num_agent_steps_trained": 7482, "num_env_steps_sampled": 26880, "num_env_steps_trained": 7482, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 461.2619700732367, "num_env_steps_trained_throughput_per_sec": 132.81873691840966, "timesteps_total": 26880, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 80640, "timers": {"training_iteration_time_ms": 1969.371, "sample_time_ms": 1398.158, "load_time_ms": 0.529, "load_throughput": 487599.888, "learn_time_ms": 63.059, "learn_throughput": 4091.418, "synch_weights_time_ms": 16.17}, "counters": {"num_env_steps_sampled": 26880, "num_env_steps_trained": 7482, "num_agent_steps_sampled": 80640, "num_agent_steps_trained": 7482, "last_target_update_ts": 26880, "num_target_updates": 29}, "done": false, "episodes_total": 0, "training_iteration": 30, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-15-44", "timestamp": 1700201744, "time_this_iter_s": 1.9587481021881104, "time_total_s": 62.223366022109985, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8981f55e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 62.223366022109985, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 68.06666666666668, "ram_util_percent": 90.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.020299911499023, "actor_loss": -5.182453632354736, "critic_loss": 3.6056008338928223, "alpha_loss": -0.08721031248569489, "alpha_value": 0.9913343787193298, "log_alpha_value": -0.008703364059329033, "target_entropy": -6.0, "policy_t": 0.033223722130060196, "mean_q": 1.19098961353302, "max_q": 1.4740458726882935, "min_q": 1.0012528896331787}, "td_error": [4.363089084625244, 4.301422119140625, 5.447290897369385, 4.698383331298828, 5.539191246032715, 5.032896995544434, 2.58831787109375, 2.734358549118042, 5.284374237060547, 3.653397798538208, 2.866332769393921, 3.3591017723083496, 3.829014539718628, 4.403521537780762, 4.340710163116455, 3.410989284515381, 3.61948299407959, 5.845563888549805, 3.6478261947631836, 3.8604025840759277, 1.8364732265472412, 2.481346368789673, 4.734138488769531, 3.0756006240844727, 3.506838321685791, 5.8985137939453125, 4.997102737426758, 7.795783519744873, 3.9210126399993896, 4.69648551940918, 2.817203998565674, 2.8026630878448486, 2.4114484786987305, 2.7893259525299072, 4.004676342010498, 5.132965087890625, 3.2042737007141113, 4.2231621742248535, 6.010095596313477, 5.614588260650635, 5.895875930786133, 2.7863945960998535, 6.775629043579102, 2.7509241104125977, 4.391907691955566, 3.109030246734619, 4.057955741882324, 5.243399620056152, 5.361924171447754, 4.238362789154053, 4.671536922454834, 5.1229400634765625, 5.396841049194336, 4.794602870941162, 3.0307929515838623, 4.41763162612915, 5.38471794128418, 5.845876216888428, 4.529505252838135, 5.6095967292785645, 2.921118974685669, 6.212674140930176, 2.7803244590759277, 3.024296522140503, 6.252373695373535, 4.862546920776367, 4.874936580657959, 4.8509840965271, 6.123870849609375, 3.640780448913574, 6.116916179656982, 3.9035346508026123, 3.254491090774536, 5.235111236572266, 4.550505638122559, 3.140825033187866, 3.444108247756958, 3.3033499717712402, 4.714291095733643, 3.479922294616699, 3.8146486282348633, 4.189333438873291, 2.0247371196746826, 3.7215981483459473, 4.494110584259033, 4.077077388763428], "mean_td_error": 4.269805908203125, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 30.0, "diff_num_grad_updates_vs_sampler_policy": 29.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.070470809936523, "actor_loss": -5.130868434906006, "critic_loss": 0.5236724615097046, "alpha_loss": -0.08767648041248322, "alpha_value": 0.9913315176963806, "log_alpha_value": -0.008706293068826199, "target_entropy": -6.0, "policy_t": 0.05633994936943054, "mean_q": 1.112177848815918, "max_q": 1.3002023696899414, "min_q": 0.9157370924949646}, "td_error": [1.966552495956421, 2.4071407318115234, 2.0599446296691895, 0.019434094429016113, 1.324530839920044, 2.1916182041168213, 2.6165413856506348, 2.9545187950134277, 4.481353759765625, 1.2850852012634277, 1.0688321590423584, 2.679826498031616, 2.125640869140625, 0.43559569120407104, 2.845975875854492, 2.744347333908081, 2.556819200515747, 1.3412009477615356, 0.918897271156311, 1.5758250951766968, 1.719564437866211, 1.5101287364959717, 0.9422906637191772, 2.032144546508789, 0.905733048915863, 3.7134692668914795, 2.153496265411377, 4.3946685791015625, 1.45646333694458, 1.2006738185882568, 2.417555093765259, 3.1350789070129395, 2.271911144256592, 4.574218273162842, 2.0077762603759766, 4.2316179275512695, 4.980711936950684, 3.7499003410339355, 2.880551815032959, 3.091948986053467, 2.0488436222076416, 4.455522060394287, 2.934621572494507, 2.132014274597168, 3.381995916366577, 2.579893112182617, 3.723839282989502, 2.3303020000457764, 3.5990090370178223, 2.244432210922241, 2.4410128593444824, 3.152378559112549, 2.380225896835327, 2.0293021202087402, 0.45841705799102783, 1.873714804649353, 5.011342525482178, 1.952972650527954, 2.6961302757263184, 1.6264569759368896, 2.0871710777282715, 3.610382080078125, 3.002593755722046, 3.5528688430786133, 1.6169092655181885, 2.679938554763794, 2.3537650108337402, 2.842193126678467, 3.6631388664245605, 3.43267822265625, 4.050975322723389, 1.8773157596588135, 2.9413037300109863, 1.7971787452697754, 1.8873615264892578, 0.0865141749382019, 3.4629788398742676, 0.8743103742599487, 3.0491366386413574, 0.7693783044815063, 2.736039161682129, 3.3203601837158203, 2.0043225288391113, 2.431617021560669, 1.2596046924591064, 1.6308891773223877], "mean_td_error": 2.430732011795044, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 30.0, "diff_num_grad_updates_vs_sampler_policy": 29.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.121527671813965, "actor_loss": -5.334770202636719, "critic_loss": 0.8692471981048584, "alpha_loss": -0.08813314139842987, "alpha_value": 0.9913303256034851, "log_alpha_value": -0.008707492612302303, "target_entropy": -6.0, "policy_t": 0.01157517358660698, "mean_q": 1.2299891710281372, "max_q": 1.5677906274795532, "min_q": 1.020599603652954}, "td_error": [2.6944639682769775, 3.7347936630249023, 1.9164760112762451, 1.4745759963989258, 2.276313304901123, 2.131720781326294, 2.0450992584228516, 2.7951369285583496, 4.234328269958496, 2.4650392532348633, 3.675565242767334, 4.1877570152282715, 3.481949806213379, 4.16909122467041, 3.089007616043091, 2.030487537384033, 1.9358351230621338, 1.4247326850891113, 2.5469634532928467, 4.149663925170898, 0.10626453161239624, 1.758129358291626, 2.615694522857666, 3.8872528076171875, 0.28549057245254517, 1.6737475395202637, 5.276717185974121, 2.618546962738037, 2.2458150386810303, 3.5345728397369385, 1.220521092414856, 4.766422271728516, 2.647186040878296, 1.1203644275665283, 0.9766209721565247, 1.1518738269805908, 3.695324420928955, 3.5086240768432617, 4.33344841003418, 2.4859492778778076, 3.5060386657714844, 2.810739278793335, 4.119694709777832, 4.483530044555664, 1.8849983215332031, 1.8164128065109253, 1.8993780612945557, 1.7420655488967896, 3.226292371749878, 3.8569326400756836, 2.552478313446045, 1.8073114156723022, 1.7246246337890625, 2.869490146636963, 3.5499038696289062, 1.924973487854004, 2.00354266166687, 0.49695199728012085, 4.059464931488037, 3.391909599304199, 3.020876407623291, 4.744558811187744, 1.5546014308929443, 3.118809223175049, 2.7525951862335205, 3.0866270065307617, 2.9427847862243652, 1.4367568492889404, 3.0204408168792725, 1.0712006092071533, 1.1041877269744873, 2.5384936332702637, 4.4542646408081055, 1.6978509426116943, 3.4306437969207764, 0.9535195231437683, 2.5157248973846436, 3.385050058364868, 1.731703519821167, 3.2326197624206543, 2.207723617553711, 3.596625328063965, 2.8750972747802734, 3.0966906547546387, 3.6299233436584473, 3.0422921180725098], "mean_td_error": 2.6783251762390137, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 30.0, "diff_num_grad_updates_vs_sampler_policy": 29.0}}, "num_env_steps_sampled": 27776, "num_env_steps_trained": 7740, "num_agent_steps_sampled": 83328, "num_agent_steps_trained": 7740, "last_target_update_ts": 27776, "num_target_updates": 30}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 83328, "num_agent_steps_trained": 7740, "num_env_steps_sampled": 27776, "num_env_steps_trained": 7740, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 499.8296106203753, "num_env_steps_trained_throughput_per_sec": 143.92415127238485, "timesteps_total": 27776, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 83328, "timers": {"training_iteration_time_ms": 1961.27, "sample_time_ms": 1389.668, "load_time_ms": 0.53, "load_throughput": 486481.942, "learn_time_ms": 62.964, "learn_throughput": 4097.557, "synch_weights_time_ms": 16.308}, "counters": {"num_env_steps_sampled": 27776, "num_env_steps_trained": 7740, "num_agent_steps_sampled": 83328, "num_agent_steps_trained": 7740, "last_target_update_ts": 27776, "num_target_updates": 30}, "done": false, "episodes_total": 0, "training_iteration": 31, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-15-46", "timestamp": 1700201746, "time_this_iter_s": 1.8082220554351807, "time_total_s": 64.03158807754517, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8aa4ca550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 64.03158807754517, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 86.85, "ram_util_percent": 90.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.112031936645508, "actor_loss": -5.362342357635498, "critic_loss": 3.4747462272644043, "alpha_loss": -0.09104222059249878, "alpha_value": 0.9910370707511902, "log_alpha_value": -0.009003355167806149, "target_entropy": -6.0, "policy_t": 0.020610468462109566, "mean_q": 1.2927050590515137, "max_q": 1.561070203781128, "min_q": 1.0692843198776245}, "td_error": [4.2043843269348145, 4.970149040222168, 5.37386417388916, 6.279988765716553, 4.004972457885742, 3.7848305702209473, 4.165034294128418, 2.866102695465088, 4.144998073577881, 3.3625080585479736, 5.47352933883667, 5.003587245941162, 5.9639387130737305, 2.66821026802063, 4.056926250457764, 4.251165390014648, 2.4827322959899902, 7.140034198760986, 5.650321960449219, 2.9196412563323975, 4.368900775909424, 5.3143463134765625, 2.931305170059204, 3.2912354469299316, 3.0458579063415527, 2.5026180744171143, 4.0892229080200195, 3.6722238063812256, 3.7765209674835205, 5.161048889160156, 3.147793769836426, 3.814160108566284, 4.343212604522705, 5.6850690841674805, 4.978941917419434, 3.5096185207366943, 4.359968185424805, 5.245286464691162, 2.573267698287964, 2.952585220336914, 4.906457901000977, 2.7107346057891846, 4.657588005065918, 3.7404117584228516, 3.805175304412842, 4.552731037139893, 4.548694610595703, 2.965317964553833, 4.587218761444092, 3.5997886657714844, 1.1706998348236084, 2.968761920928955, 5.101371765136719, 5.36354923248291, 3.0559277534484863, 4.880342483520508, 2.713632106781006, 6.3134918212890625, 5.034523963928223, 4.5497236251831055, 3.0032920837402344, 4.676910400390625, 3.0759060382843018, 4.142444610595703, 2.684645652770996, 4.963484764099121, 3.7717885971069336, 3.173405170440674, 3.7759454250335693, 5.5298309326171875, 3.954479217529297, 3.698406219482422, 4.556773662567139, 4.265224456787109, 4.26776123046875, 4.54176139831543, 6.117645263671875, 3.2470409870147705, 4.260341644287109, 4.694464683532715, 4.537294387817383, 5.241419792175293, 4.575655460357666, 3.7153351306915283, 5.014620780944824, 3.1961770057678223], "mean_td_error": 4.156259059906006, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 31.0, "diff_num_grad_updates_vs_sampler_policy": 30.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.087108612060547, "actor_loss": -5.2288970947265625, "critic_loss": 0.5695873498916626, "alpha_loss": -0.09084931761026382, "alpha_value": 0.9910339713096619, "log_alpha_value": -0.009006477892398834, "target_entropy": -6.0, "policy_t": 0.0038790989201515913, "mean_q": 1.1814628839492798, "max_q": 1.4093788862228394, "min_q": 1.0068964958190918}, "td_error": [1.9192920923233032, 2.9965085983276367, 2.221545457839966, 3.5558011531829834, 2.2233023643493652, 3.990000009536743, 3.144292116165161, 5.381030559539795, 0.868262529373169, 2.0465903282165527, 2.5580787658691406, 2.074300527572632, 3.859161615371704, 4.455868244171143, 2.969705820083618, 0.8573426604270935, 3.801578998565674, 3.358412265777588, 2.764420986175537, 4.155339241027832, 2.7801342010498047, 3.097775459289551, 2.244438886642456, 5.134023666381836, 2.8255982398986816, 2.3330392837524414, 2.9085569381713867, 3.9265573024749756, 2.3116588592529297, 2.656979560852051, 2.4840831756591797, 3.338951826095581, 2.9126055240631104, 1.5033464431762695, 1.0360920429229736, 3.1648988723754883, 2.3906030654907227, 1.3950477838516235, 1.5369207859039307, 3.531731128692627, 3.7661478519439697, 0.26972800493240356, 1.5098693370819092, 4.093056678771973, 1.7395029067993164, 4.008945941925049, 2.9017555713653564, 1.8963903188705444, 2.4947826862335205, 1.3416047096252441, 1.589216709136963, 1.6119085550308228, 3.1747705936431885, 1.893284559249878, 3.676877498626709, 2.0287952423095703, 1.3377139568328857, 1.184467077255249, 3.2684829235076904, 4.465085983276367, 1.7397866249084473, 2.371288299560547, 3.7973947525024414, 2.6658198833465576, 0.835095226764679, 1.446042537689209, 2.713289976119995, 2.873924732208252, 1.1883822679519653, 2.3848774433135986, 2.2393503189086914, 1.9721142053604126, 3.8153433799743652, 1.2728581428527832, 4.387519836425781, 2.2056241035461426, 2.7471542358398438, 1.9517953395843506, 2.4296927452087402, 2.5423967838287354, 4.748112201690674, 3.16092848777771, 1.1249765157699585, 2.4871034622192383, 1.27651047706604, 0.7733019590377808], "mean_td_error": 2.5827553272247314, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 31.0, "diff_num_grad_updates_vs_sampler_policy": 30.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.125925064086914, "actor_loss": -5.413201332092285, "critic_loss": 0.7659212350845337, "alpha_loss": -0.09121324867010117, "alpha_value": 0.9910325407981873, "log_alpha_value": -0.009007892571389675, "target_entropy": -6.0, "policy_t": -0.00953385978937149, "mean_q": 1.3334825038909912, "max_q": 1.6293343305587769, "min_q": 1.1006907224655151}, "td_error": [1.8848745822906494, 3.42112135887146, 3.2488832473754883, 2.4690611362457275, 3.0264439582824707, 1.9016499519348145, 0.9276815056800842, 1.5333971977233887, 0.7426460981369019, 2.6484413146972656, 2.6120786666870117, 2.4187185764312744, 2.574877977371216, 2.441030979156494, 3.733067274093628, 3.2963197231292725, 0.4507879614830017, 3.5126779079437256, 4.629820346832275, 2.4407453536987305, 0.9180017709732056, 1.7958500385284424, 2.6328511238098145, 2.9429378509521484, 2.0362906455993652, 1.6829273700714111, 2.344550609588623, 4.052059173583984, 2.2741506099700928, 1.4647223949432373, 2.731868028640747, 2.2252888679504395, 2.1583619117736816, 2.9990286827087402, 2.901371955871582, 2.091549873352051, 1.8042936325073242, 0.7861741185188293, 1.8535494804382324, 3.984806537628174, 5.039673805236816, 2.2636804580688477, 2.4224963188171387, 2.93121337890625, 2.35868763923645, 1.8437209129333496, 2.1922831535339355, 1.5385366678237915, 1.060809850692749, 2.9945132732391357, 1.4794491529464722, 3.376368999481201, 1.7337126731872559, 1.803471565246582, 1.141411304473877, 3.210045576095581, 2.566495656967163, 2.8455028533935547, 2.38784122467041, 3.4098711013793945, 2.9827308654785156, 2.3027150630950928, 4.360822677612305, 3.2977185249328613, 3.387812376022339, 2.851957321166992, 3.042762279510498, 2.4621658325195312, 2.762120246887207, 2.6080880165100098, 1.2055985927581787, 4.167727470397949, 3.0968549251556396, 0.2541126608848572, 2.2307424545288086, 1.270190715789795, 2.8903188705444336, 0.8465834856033325, 3.2153563499450684, 2.293074131011963, 1.9880099296569824, 1.6827287673950195, 1.3633244037628174, 2.3433876037597656, 3.2808408737182617, 3.266035795211792], "mean_td_error": 2.4377737045288086, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 31.0, "diff_num_grad_updates_vs_sampler_policy": 30.0}}, "num_env_steps_sampled": 28672, "num_env_steps_trained": 7998, "num_agent_steps_sampled": 86016, "num_agent_steps_trained": 7998, "last_target_update_ts": 28672, "num_target_updates": 31}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 86016, "num_agent_steps_trained": 7998, "num_env_steps_sampled": 28672, "num_env_steps_trained": 7998, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 456.2933519472287, "num_env_steps_trained_throughput_per_sec": 131.3880410740904, "timesteps_total": 28672, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 86016, "timers": {"training_iteration_time_ms": 1960.368, "sample_time_ms": 1391.361, "load_time_ms": 0.529, "load_throughput": 487314.434, "learn_time_ms": 62.855, "learn_throughput": 4104.655, "synch_weights_time_ms": 16.338}, "counters": {"num_env_steps_sampled": 28672, "num_env_steps_trained": 7998, "num_agent_steps_sampled": 86016, "num_agent_steps_trained": 7998, "last_target_update_ts": 28672, "num_target_updates": 31}, "done": false, "episodes_total": 0, "training_iteration": 32, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-15-48", "timestamp": 1700201748, "time_this_iter_s": 1.9770588874816895, "time_total_s": 66.00864696502686, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8aa3a39d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 66.00864696502686, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 66.8, "ram_util_percent": 90.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.108510971069336, "actor_loss": -5.463730335235596, "critic_loss": 3.2687063217163086, "alpha_loss": -0.09404367953538895, "alpha_value": 0.9907397031784058, "log_alpha_value": -0.009303415194153786, "target_entropy": -6.0, "policy_t": -0.00598099734634161, "mean_q": 1.3905363082885742, "max_q": 1.6959702968597412, "min_q": 1.1613891124725342}, "td_error": [4.41811466217041, 3.1015002727508545, 3.5887820720672607, 6.081527233123779, 3.413229465484619, 4.361166954040527, 4.086971282958984, 6.6982269287109375, 3.6285452842712402, 3.0844950675964355, 1.9200598001480103, 3.620181083679199, 5.1681718826293945, 3.8259212970733643, 4.320884704589844, 5.1919074058532715, 5.564857482910156, 3.434573173522949, 5.9080424308776855, 2.539424419403076, 2.6544039249420166, 4.74733829498291, 3.258049249649048, 5.507339954376221, 4.589639186859131, 2.772883415222168, 5.089607238769531, 3.22782564163208, 3.616295576095581, 3.433878183364868, 4.945959568023682, 4.832214832305908, 2.2553200721740723, 3.3728013038635254, 2.770820140838623, 3.6728219985961914, 4.440662384033203, 4.038933753967285, 3.9839062690734863, 3.455592393875122, 5.294088840484619, 4.451053619384766, 3.767697811126709, 3.949216365814209, 2.3740272521972656, 4.47152042388916, 4.02087926864624, 5.352683067321777, 4.994508266448975, 3.8873376846313477, 6.305044174194336, 2.9716579914093018, 6.349362373352051, 5.925356864929199, 5.859779357910156, 4.584244728088379, 2.706015110015869, 3.6922030448913574, 3.5501089096069336, 4.347079277038574, 3.924234628677368, 1.2829428911209106, 3.407960891723633, 3.157864570617676, 4.907423973083496, 4.536432266235352, 4.107384204864502, 2.5418436527252197, 3.7950387001037598, 3.4622550010681152, 2.9429006576538086, 3.9434571266174316, 4.095681190490723, 3.8928513526916504, 3.4522156715393066, 5.8516459465026855, 2.150207757949829, 3.7092061042785645, 4.47064208984375, 3.8742005825042725, 3.720644950866699, 2.5654382705688477, 5.304982662200928, 3.394298553466797, 5.089249134063721, 2.7847533226013184], "mean_td_error": 4.021424293518066, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 32.0, "diff_num_grad_updates_vs_sampler_policy": 31.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.113813400268555, "actor_loss": -5.345322608947754, "critic_loss": 0.5643521547317505, "alpha_loss": -0.09412584453821182, "alpha_value": 0.9907364845275879, "log_alpha_value": -0.009306661784648895, "target_entropy": -6.0, "policy_t": -0.01399085484445095, "mean_q": 1.2743098735809326, "max_q": 1.5469743013381958, "min_q": 1.0498125553131104}, "td_error": [1.0351351499557495, 1.915334701538086, 0.805198609828949, 2.4162960052490234, 2.22719144821167, 3.3057801723480225, 2.6512579917907715, 3.0172464847564697, 3.3855950832366943, 2.6869375705718994, 3.1109890937805176, 1.9211493730545044, 3.3561763763427734, 3.550755262374878, 3.137925624847412, 1.7566049098968506, 2.4494779109954834, 3.5509097576141357, 2.527068614959717, 2.8342435359954834, 2.0191121101379395, 2.3885560035705566, 3.2812185287475586, 2.410841703414917, 1.6430606842041016, 2.176403522491455, 1.614434003829956, 1.2466577291488647, 1.7864632606506348, 0.9996119737625122, 2.4801580905914307, 3.5049374103546143, 2.4668078422546387, 4.464626312255859, 5.184726238250732, 3.033172369003296, 1.7395461797714233, 1.3120160102844238, 1.9975948333740234, 2.382742404937744, 2.8124451637268066, 2.808137893676758, 2.6246256828308105, 1.892809271812439, 3.214895009994507, 1.7401657104492188, 2.0624709129333496, 4.342640399932861, 1.3137617111206055, 2.6649186611175537, 0.23824834823608398, 3.0441782474517822, 3.7024166584014893, 4.253533363342285, 2.5669758319854736, 3.220602512359619, 1.9172658920288086, 3.011098861694336, 1.670013666152954, 2.3218445777893066, 3.958341360092163, 1.9823172092437744, 2.3386363983154297, 3.0229291915893555, 1.488338589668274, 2.697464942932129, 2.602357864379883, 0.5777528882026672, 1.85503089427948, 3.6038753986358643, 4.04463005065918, 4.733116149902344, 2.000138759613037, 0.44781237840652466, 2.2737631797790527, 2.349709987640381, 3.2804911136627197, 0.5208727717399597, 5.475164413452148, 2.0407512187957764, 4.726999282836914, 2.6957223415374756, 4.391657829284668, 1.2594349384307861, 3.0662143230438232, 2.156219720840454], "mean_td_error": 2.5672876834869385, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 32.0, "diff_num_grad_updates_vs_sampler_policy": 31.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.076883316040039, "actor_loss": -5.494515419006348, "critic_loss": 0.7517295479774475, "alpha_loss": -0.09379883855581284, "alpha_value": 0.990734875202179, "log_alpha_value": -0.009308317676186562, "target_entropy": -6.0, "policy_t": -0.017974551767110825, "mean_q": 1.4302716255187988, "max_q": 1.6773622035980225, "min_q": 1.15911066532135}, "td_error": [3.352081298828125, 5.3497314453125, 1.5005987882614136, 2.0006966590881348, 2.8520727157592773, 1.3757851123809814, 3.050450325012207, 0.9936020970344543, 1.5375547409057617, 2.3936634063720703, 2.8544774055480957, 2.5459017753601074, 2.5271451473236084, 0.7574621438980103, 2.4580366611480713, 3.3515639305114746, 2.688964366912842, 1.2014577388763428, 3.3097968101501465, 2.8181464672088623, 1.8082547187805176, 3.998610496520996, 1.5566716194152832, 3.546844482421875, 4.45993709564209, 0.13596218824386597, 4.831173896789551, 0.09098094701766968, 2.6536993980407715, 2.5665836334228516, 2.8009252548217773, 3.81075382232666, 0.5640665292739868, 1.3931665420532227, 4.112789154052734, 1.3390672206878662, 3.0792694091796875, 2.9225966930389404, 2.8266091346740723, 1.2478771209716797, 1.5806825160980225, 3.9875125885009766, 1.1096175909042358, 1.379418134689331, 2.3418164253234863, 1.113618016242981, 2.8419699668884277, 1.383040428161621, 2.032031536102295, 1.5022685527801514, 3.4062182903289795, 2.7149925231933594, 3.718817949295044, 1.793009638786316, 2.4984424114227295, 4.059645652770996, 0.4341707229614258, 3.1212992668151855, 3.7237792015075684, 3.296330451965332, 0.9598010778427124, 2.6343984603881836, 1.1997840404510498, 2.5606541633605957, 1.6291812658309937, 3.2949204444885254, 2.306950330734253, 2.198307514190674, 2.0652565956115723, 2.777740240097046, 2.3105621337890625, 5.469838619232178, 2.3540103435516357, 2.119267702102661, 4.428300857543945, 3.0106143951416016, 2.584728240966797, 1.1758522987365723, 0.4418609142303467, 2.6567270755767822, 3.3706493377685547, 2.1902618408203125, 1.4071966409683228, 2.3667783737182617, 1.4669082164764404, 4.333495140075684], "mean_td_error": 2.4420671463012695, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 32.0, "diff_num_grad_updates_vs_sampler_policy": 31.0}}, "num_env_steps_sampled": 29568, "num_env_steps_trained": 8256, "num_agent_steps_sampled": 88704, "num_agent_steps_trained": 8256, "last_target_update_ts": 29568, "num_target_updates": 32}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88704, "num_agent_steps_trained": 8256, "num_env_steps_sampled": 29568, "num_env_steps_trained": 8256, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 485.75554946617376, "num_env_steps_trained_throughput_per_sec": 139.87157562753666, "timesteps_total": 29568, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 88704, "timers": {"training_iteration_time_ms": 1960.963, "sample_time_ms": 1394.276, "load_time_ms": 0.529, "load_throughput": 487797.706, "learn_time_ms": 62.773, "learn_throughput": 4110.051, "synch_weights_time_ms": 15.97}, "counters": {"num_env_steps_sampled": 29568, "num_env_steps_trained": 8256, "num_agent_steps_sampled": 88704, "num_agent_steps_trained": 8256, "last_target_update_ts": 29568, "num_target_updates": 32}, "done": false, "episodes_total": 0, "training_iteration": 33, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-15-50", "timestamp": 1700201750, "time_this_iter_s": 1.8619592189788818, "time_total_s": 67.87060618400574, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8c8afb550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 67.87060618400574, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 62.300000000000004, "ram_util_percent": 90.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.118732452392578, "actor_loss": -5.566816329956055, "critic_loss": 3.451016664505005, "alpha_loss": -0.09717553108930588, "alpha_value": 0.9904424548149109, "log_alpha_value": -0.009603527374565601, "target_entropy": -6.0, "policy_t": -0.007789396680891514, "mean_q": 1.5089913606643677, "max_q": 1.8661575317382812, "min_q": 1.2648868560791016}, "td_error": [4.476377964019775, 4.067080020904541, 4.332677841186523, 4.800649642944336, 5.133091926574707, 3.897052764892578, 3.200328826904297, 4.005223274230957, 4.8719072341918945, 4.270962238311768, 4.834211349487305, 5.123891830444336, 4.2209014892578125, 3.721066474914551, 3.8778185844421387, 3.57413649559021, 0.9775598049163818, 1.4050672054290771, 5.110470771789551, 3.629300594329834, 3.736013174057007, 4.215185642242432, 3.834700345993042, 3.8262088298797607, 3.703866958618164, 4.097365379333496, 4.640913009643555, 4.2199296951293945, 4.020479202270508, 5.118852615356445, 2.9029603004455566, 4.460639476776123, 3.435299873352051, 4.780426502227783, 4.561857223510742, 2.681029796600342, 5.700506210327148, 2.2023799419403076, 3.703115701675415, 2.630831003189087, 3.7373390197753906, 3.5576345920562744, 4.682049751281738, 5.376436233520508, 5.444075107574463, 5.726356506347656, 5.556309700012207, 4.861479759216309, 3.735760450363159, 2.492563247680664, 5.109556674957275, 4.22067928314209, 5.191744327545166, 2.2784066200256348, 3.265254259109497, 3.14003324508667, 5.100052833557129, 4.705111980438232, 3.927724838256836, 2.1238059997558594, 3.384101629257202, 3.891695499420166, 4.454588890075684, 3.854583263397217, 5.167937278747559, 5.730688095092773, 4.694729804992676, 4.980469703674316, 3.6134183406829834, 3.5121915340423584, 3.70548415184021, 3.3854222297668457, 3.3184010982513428, 4.172813892364502, 3.787534236907959, 4.7456207275390625, 4.162055492401123, 4.229790687561035, 4.936130523681641, 6.547885894775391, 3.233793258666992, 6.366955280303955, 3.0671868324279785, 4.944271087646484, 3.279301881790161, 2.9011192321777344], "mean_td_error": 4.0965447425842285, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 33.0, "diff_num_grad_updates_vs_sampler_policy": 32.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.10322380065918, "actor_loss": -5.413776874542236, "critic_loss": 0.5063027739524841, "alpha_loss": -0.0970606729388237, "alpha_value": 0.9904391169548035, "log_alpha_value": -0.009606902487576008, "target_entropy": -6.0, "policy_t": -0.009241445921361446, "mean_q": 1.3500347137451172, "max_q": 1.6069300174713135, "min_q": 1.1297433376312256}, "td_error": [2.2201993465423584, 1.4476439952850342, 0.5606010556221008, 0.0779830813407898, 2.88657808303833, 0.7689328789710999, 3.032866954803467, 4.378582954406738, 2.7252001762390137, 1.4491543769836426, 2.452788829803467, 1.010849118232727, 0.7673932313919067, 1.6451680660247803, 0.9618045687675476, 2.168361186981201, 2.182037830352783, 1.9094674587249756, 1.8642958402633667, 3.6136879920959473, 3.0677871704101562, 3.7208194732666016, 1.3620390892028809, 4.116184234619141, 2.1183218955993652, 0.047083497047424316, 2.1449828147888184, 2.9360265731811523, 3.0241775512695312, 3.291231632232666, 0.6229085326194763, 1.633763074874878, 3.521162509918213, 0.6013721227645874, 2.5275588035583496, 2.042285919189453, 2.694838523864746, 1.0214934349060059, 0.22044944763183594, 2.3138818740844727, 3.553638458251953, 2.0384223461151123, 4.549254417419434, 3.764664888381958, 2.64088773727417, 2.377349376678467, 4.12076473236084, 3.643604278564453, 3.782837152481079, 2.620631456375122, 0.7488200068473816, 3.5294394493103027, 5.119441986083984, 2.0471928119659424, 3.0549702644348145, 3.787139892578125, 4.422625541687012, 3.147561550140381, 1.775543451309204, 1.3748362064361572, 1.9076111316680908, 0.14026552438735962, 3.294490337371826, 4.454128742218018, 3.6023006439208984, 3.675658941268921, 3.314255475997925, 3.423239231109619, 1.2893751859664917, 4.404279708862305, 0.32319074869155884, 0.9078740477561951, 3.4975671768188477, 0.4254379868507385, 0.9400299191474915, 2.121760845184326, 1.9964622259140015, 2.304295539855957, 2.602149248123169, 1.568397045135498, 2.061073064804077, 1.9626500606536865, 2.584510326385498, 2.382518768310547, 2.337771415710449, 3.6901400089263916], "mean_td_error": 2.377476930618286, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 33.0, "diff_num_grad_updates_vs_sampler_policy": 32.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.100985527038574, "actor_loss": -5.604796886444092, "critic_loss": 0.7101132869720459, "alpha_loss": -0.09705694019794464, "alpha_value": 0.9904373288154602, "log_alpha_value": -0.009608659893274307, "target_entropy": -6.0, "policy_t": -0.025603599846363068, "mean_q": 1.525556206703186, "max_q": 1.924294114112854, "min_q": 1.2896366119384766}, "td_error": [3.933303117752075, 2.870914936065674, 0.9965483546257019, 0.8552024960517883, 3.4076151847839355, 3.7146522998809814, 2.3991427421569824, 3.0584022998809814, 2.4653759002685547, 2.439223289489746, 1.8829115629196167, 1.9853942394256592, 1.9086005687713623, 1.6616764068603516, 2.5594534873962402, 2.726243019104004, 2.137568235397339, 2.1875033378601074, 4.303976535797119, 1.777287244796753, 2.6510868072509766, 1.1290168762207031, 4.041169166564941, 1.5373891592025757, 2.0661823749542236, 3.7219860553741455, 2.715367555618286, 1.6740785837173462, 2.6953353881835938, 2.9179577827453613, 2.826040267944336, 0.7104032039642334, 3.8723645210266113, 3.4106011390686035, 1.357504963874817, 1.7921048402786255, 3.1712722778320312, 1.9179353713989258, 2.2921109199523926, 1.8371264934539795, 1.3406195640563965, 2.315805196762085, 2.968061923980713, 4.2991743087768555, 1.2149081230163574, 1.0302984714508057, 2.08565092086792, 0.32340162992477417, 3.6555593013763428, 2.9819459915161133, 3.866790294647217, 3.257455587387085, 3.02551531791687, 2.5732269287109375, 0.29347461462020874, 1.4955236911773682, 2.132105827331543, 2.4374570846557617, 1.8737785816192627, 1.0876688957214355, 2.1189470291137695, 0.973163902759552, 2.3158202171325684, 4.162977695465088, 1.8380376100540161, 3.043476104736328, 0.15338033437728882, 1.010420799255371, 1.4740362167358398, 2.1415417194366455, 1.20644211769104, 2.6402783393859863, 2.315718412399292, 3.2351953983306885, 2.9859018325805664, 0.8768508434295654, 2.5578136444091797, 1.6857537031173706, 1.2595586776733398, 0.6964389681816101, 2.4460108280181885, 3.3662662506103516, 0.4050273895263672, 2.5799942016601562, 2.1559793949127197, 2.5667026042938232], "mean_td_error": 2.256723165512085, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 33.0, "diff_num_grad_updates_vs_sampler_policy": 32.0}}, "num_env_steps_sampled": 30464, "num_env_steps_trained": 8514, "num_agent_steps_sampled": 91392, "num_agent_steps_trained": 8514, "last_target_update_ts": 30464, "num_target_updates": 33}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 91392, "num_agent_steps_trained": 8514, "num_env_steps_sampled": 30464, "num_env_steps_trained": 8514, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 494.6698497771739, "num_env_steps_trained_throughput_per_sec": 142.4384165653023, "timesteps_total": 30464, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 91392, "timers": {"training_iteration_time_ms": 1954.901, "sample_time_ms": 1390.425, "load_time_ms": 0.526, "load_throughput": 490384.027, "learn_time_ms": 62.106, "learn_throughput": 4154.184, "synch_weights_time_ms": 15.594}, "counters": {"num_env_steps_sampled": 30464, "num_env_steps_trained": 8514, "num_agent_steps_sampled": 91392, "num_agent_steps_trained": 8514, "last_target_update_ts": 30464, "num_target_updates": 33}, "done": false, "episodes_total": 0, "training_iteration": 34, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-15-52", "timestamp": 1700201752, "time_this_iter_s": 1.824936866760254, "time_total_s": 69.69554305076599, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8c8afb940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 69.69554305076599, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 85.55000000000001, "ram_util_percent": 90.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.099259376525879, "actor_loss": -5.686074733734131, "critic_loss": 3.250619888305664, "alpha_loss": -0.10002011060714722, "alpha_value": 0.9901451468467712, "log_alpha_value": -0.00990370661020279, "target_entropy": -6.0, "policy_t": -0.0070958212018013, "mean_q": 1.5834943056106567, "max_q": 1.8875795602798462, "min_q": 1.3146620988845825}, "td_error": [2.8072707653045654, 3.5112767219543457, 3.6430721282958984, 3.6241164207458496, 3.4657979011535645, 3.8237199783325195, 4.709776401519775, 3.7482924461364746, 5.624220848083496, 5.283504009246826, 3.3670883178710938, 4.260710716247559, 2.2559919357299805, 4.813530921936035, 3.376519203186035, 4.544364929199219, 3.7015762329101562, 4.379076957702637, 4.625942707061768, 3.944110870361328, 5.430962562561035, 3.4558470249176025, 0.5286537408828735, 5.845117568969727, 4.887900352478027, 3.3131051063537598, 3.7645559310913086, 2.897244691848755, 3.6122899055480957, 4.7776994705200195, 5.404544830322266, 6.062725067138672, 4.684030055999756, 4.508068084716797, 5.060477256774902, 3.1773557662963867, 4.755685806274414, 5.568253517150879, 4.593175888061523, 4.614663600921631, 3.2465124130249023, 3.413750171661377, 3.1253533363342285, 4.208009719848633, 3.734768867492676, 3.8466546535491943, 2.9894604682922363, 3.638273239135742, 2.996299982070923, 4.9436492919921875, 3.6591789722442627, 4.964311122894287, 6.074121475219727, 1.7448759078979492, 3.4825005531311035, 3.515732765197754, 4.065079689025879, 5.315832614898682, 4.345667362213135, 5.024520397186279, 5.400074005126953, 4.229870796203613, 2.680431604385376, 3.131394863128662, 3.4133846759796143, 3.784036159515381, 4.546238899230957, 4.352553367614746, 4.510440826416016, 2.4274187088012695, 4.289387226104736, 3.0287437438964844, 2.692746162414551, 3.2733545303344727, 3.7737104892730713, 4.418459892272949, 4.341066360473633, 3.1800222396850586, 3.9959118366241455, 1.2850151062011719, 3.6458683013916016, 4.4090118408203125, 4.132746696472168, 3.6533055305480957, 2.059904098510742, 5.36983585357666], "mean_td_error": 3.9629275798797607, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 34.0, "diff_num_grad_updates_vs_sampler_policy": 33.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.021383285522461, "actor_loss": -5.445214748382568, "critic_loss": 0.4789685904979706, "alpha_loss": -0.09928353130817413, "alpha_value": 0.990141749382019, "log_alpha_value": -0.009907168336212635, "target_entropy": -6.0, "policy_t": -0.01810147613286972, "mean_q": 1.480623722076416, "max_q": 1.7449896335601807, "min_q": 1.2145864963531494}, "td_error": [1.9656546115875244, 1.0278342962265015, 3.541656017303467, 3.0311708450317383, 1.8615070581436157, 2.3400628566741943, 2.5172388553619385, 2.458008289337158, 1.0270662307739258, 3.738553524017334, 1.2937184572219849, 1.9927642345428467, 3.2835886478424072, 2.4817488193511963, 5.10844612121582, 1.20277738571167, 2.917102575302124, 1.928532600402832, 1.209223985671997, 1.2870688438415527, 5.413029670715332, 0.9402517676353455, 1.7963271141052246, 3.1695518493652344, 2.9223432540893555, 2.0777716636657715, 1.5827410221099854, 3.659759283065796, 2.1334633827209473, 1.0180926322937012, 2.3332178592681885, 2.277331829071045, 3.2610976696014404, 2.424539566040039, 0.8488025069236755, 2.687284469604492, 0.24483543634414673, 0.4103880524635315, 2.728884220123291, 2.973402500152588, 2.4050517082214355, 1.816053032875061, 1.7457432746887207, 2.907684087753296, 3.1979427337646484, 0.356725811958313, 3.102839708328247, 2.949439287185669, 3.1199402809143066, 3.80352783203125, 3.653775930404663, 3.0926098823547363, 1.8592867851257324, 1.5088258981704712, 1.8482165336608887, 1.7394506931304932, 1.04591965675354, 0.9892299175262451, 0.7827377319335938, 1.597013235092163, 1.7426910400390625, 2.8628320693969727, 2.7207465171813965, 4.005728721618652, 2.0259039402008057, 3.7754297256469727, 3.63918399810791, 1.4291155338287354, 3.8704168796539307, 0.34968066215515137, 1.7188186645507812, 1.5519675016403198, 2.5510997772216797, 1.5880916118621826, 3.454324245452881, 1.9511058330535889, 2.7123336791992188, 2.61678409576416, 2.260896682739258, 1.3350021839141846, 2.8090338706970215, 2.985164165496826, 2.8507187366485596, 0.5731086730957031, 2.016598701477051, 1.5322339534759521], "mean_td_error": 2.2740447521209717, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 34.0, "diff_num_grad_updates_vs_sampler_policy": 33.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.072408676147461, "actor_loss": -5.701730728149414, "critic_loss": 0.6828813552856445, "alpha_loss": -0.09980730712413788, "alpha_value": 0.9901399612426758, "log_alpha_value": -0.009908980689942837, "target_entropy": -6.0, "policy_t": -0.04764818027615547, "mean_q": 1.6516404151916504, "max_q": 2.0033440589904785, "min_q": 1.3512704372406006}, "td_error": [3.429659605026245, 3.1381382942199707, 2.676034450531006, 1.5108370780944824, 3.330308437347412, 1.9602768421173096, 2.7504725456237793, 2.9170095920562744, 3.2457032203674316, 2.4733071327209473, 0.8696538209915161, 4.040482521057129, 1.442710518836975, 0.9765728116035461, 0.9696193337440491, 1.4934368133544922, 1.5530014038085938, 1.6640205383300781, 3.236212730407715, 3.3934061527252197, 0.8151358366012573, 4.062753677368164, 2.2759299278259277, 1.2572474479675293, 2.950439214706421, 3.3073031902313232, 0.5869510769844055, 3.8005788326263428, 2.792874813079834, 2.7631750106811523, 1.7663147449493408, 2.961634397506714, 2.7841529846191406, 2.660547971725464, 2.675565242767334, 2.506744623184204, 3.012462615966797, 2.508864641189575, 2.8422653675079346, 1.3656249046325684, 1.277550220489502, 2.417908191680908, 3.129849433898926, 1.3040554523468018, 2.1869349479675293, 1.9037182331085205, 3.4981493949890137, 1.1684775352478027, 3.5678014755249023, 4.8039116859436035, 2.6515564918518066, 1.3648862838745117, 1.5055471658706665, 3.3449296951293945, 2.274282455444336, 2.8686821460723877, 1.9591007232666016, 0.5917585492134094, 1.6892811059951782, 2.044837474822998, 2.5142078399658203, 0.40366631746292114, 2.6780483722686768, 1.6628005504608154, 2.130254030227661, 1.2089707851409912, 1.38190758228302, 2.190812110900879, 3.5008301734924316, 2.3100719451904297, 0.7570399045944214, 1.9057921171188354, 2.163869857788086, 0.7913211584091187, 2.8983609676361084, 3.0908420085906982, 2.4111948013305664, 1.3313348293304443, 0.6503785252571106, 2.760226249694824, 1.302635908126831, 2.438920021057129, 1.5658912658691406, 1.4380825757980347, 2.776505470275879, 1.9494892358779907], "mean_td_error": 2.2387688159942627, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 34.0, "diff_num_grad_updates_vs_sampler_policy": 33.0}}, "num_env_steps_sampled": 31360, "num_env_steps_trained": 8772, "num_agent_steps_sampled": 94080, "num_agent_steps_trained": 8772, "last_target_update_ts": 31360, "num_target_updates": 34}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 94080, "num_agent_steps_trained": 8772, "num_env_steps_sampled": 31360, "num_env_steps_trained": 8772, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 483.8007358526029, "num_env_steps_trained_throughput_per_sec": 139.3086940289861, "timesteps_total": 31360, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 94080, "timers": {"training_iteration_time_ms": 1948.603, "sample_time_ms": 1385.595, "load_time_ms": 0.528, "load_throughput": 488237.878, "learn_time_ms": 62.158, "learn_throughput": 4150.736, "synch_weights_time_ms": 15.562}, "counters": {"num_env_steps_sampled": 31360, "num_env_steps_trained": 8772, "num_agent_steps_sampled": 94080, "num_agent_steps_trained": 8772, "last_target_update_ts": 31360, "num_target_updates": 34}, "done": false, "episodes_total": 0, "training_iteration": 35, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-15-54", "timestamp": 1700201754, "time_this_iter_s": 1.867431879043579, "time_total_s": 71.56297492980957, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8aa3a39d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 71.56297492980957, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 64.06666666666666, "ram_util_percent": 90.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.145892143249512, "actor_loss": -5.826831340789795, "critic_loss": 2.388091564178467, "alpha_loss": -0.10352770239114761, "alpha_value": 0.9898479580879211, "log_alpha_value": -0.01020390260964632, "target_entropy": -6.0, "policy_t": -0.0206914059817791, "mean_q": 1.7431416511535645, "max_q": 2.051478862762451, "min_q": 1.4879826307296753}, "td_error": [3.370530128479004, 3.786801338195801, 2.9711556434631348, 3.0860767364501953, 2.3039746284484863, 2.0493102073669434, 2.826775550842285, 4.773804664611816, 4.523921489715576, 4.0547943115234375, 3.8894095420837402, 4.077117443084717, 3.81620454788208, 1.1072956323623657, 3.4883933067321777, 3.233975887298584, 4.571715354919434, 3.7091073989868164, 3.212805986404419, 3.1360292434692383, 3.301271438598633, 2.227349281311035, 1.1915210485458374, 2.152336835861206, 3.520832061767578, 3.5026605129241943, 2.9166150093078613, 2.1390833854675293, 2.49991512298584, 5.789297103881836, 4.266785621643066, 2.5843753814697266, 2.9379165172576904, 3.481436252593994, 3.6403231620788574, 3.764101505279541, 4.640394687652588, 3.6259889602661133, 3.964238166809082, 4.177700996398926, 3.607532024383545, 3.6798439025878906, 4.828217506408691, 3.9647154808044434, 1.5257370471954346, 3.1555752754211426, 4.145391464233398, 3.414340019226074, 4.287109375, 3.064936637878418, 2.8700714111328125, 4.036401748657227, 4.982610702514648, 3.194498062133789, 3.426759719848633, 2.8200631141662598, 2.8769187927246094, 3.6313953399658203, 4.945107936859131, 4.835322856903076, 4.371642112731934, 2.2156152725219727, 3.632808208465576, 4.445727348327637, 3.3666529655456543, 5.1532673835754395, 3.9316186904907227, 3.252695083618164, 4.335636138916016, 3.317943572998047, 5.347450256347656, 2.9792325496673584, 4.389023780822754, 5.057942867279053, 1.5501980781555176, 5.571883201599121, 1.9305768013000488, 2.4962611198425293, 4.622813701629639, 1.9252510070800781, 4.419869899749756, 2.307034969329834, 4.28867769241333, 3.6034352779388428, 2.897031784057617, 2.9473562240600586], "mean_td_error": 3.511204242706299, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 35.0, "diff_num_grad_updates_vs_sampler_policy": 34.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.203980445861816, "actor_loss": -5.695024013519287, "critic_loss": 0.47640424966812134, "alpha_loss": -0.10415487736463547, "alpha_value": 0.9898446202278137, "log_alpha_value": -0.010207278653979301, "target_entropy": -6.0, "policy_t": 0.034986112266778946, "mean_q": 1.5622212886810303, "max_q": 1.8274410963058472, "min_q": 1.3409552574157715}, "td_error": [2.2558341026306152, 1.7328941822052002, 0.4209023714065552, 0.549500584602356, 2.404676675796509, 3.061849594116211, 1.8482818603515625, 1.1007169485092163, 2.6862967014312744, 0.5598549842834473, 3.514188289642334, 0.9626430869102478, 3.4944729804992676, 1.4913132190704346, 1.343751311302185, 1.5010175704956055, 1.6333949565887451, 1.7752408981323242, 1.6953434944152832, 3.102842330932617, 1.3383246660232544, 1.9696125984191895, 3.287515163421631, 3.1544570922851562, 3.2546732425689697, 0.9436190128326416, 2.7984399795532227, 1.7858912944793701, 3.1477065086364746, 2.2265565395355225, 3.5740489959716797, 0.8587486147880554, 2.908078908920288, 2.963500499725342, 0.9517183303833008, 2.441941976547241, 0.8146620988845825, 2.819357395172119, 3.231696128845215, 1.551297903060913, 2.379788875579834, 1.8410849571228027, 0.6537724137306213, 2.8643975257873535, 2.0124597549438477, 3.3807010650634766, 2.941215753555298, 3.0787861347198486, 3.270036220550537, 2.797165870666504, 2.819150924682617, 2.831477642059326, 3.6368179321289062, 1.156660556793213, 0.6420432329177856, 0.38425809144973755, 2.0071561336517334, 2.122793674468994, 2.117594003677368, 3.3189988136291504, 0.903173565864563, 1.326824426651001, 1.7383928298950195, 2.403036117553711, 1.8494229316711426, 2.6196279525756836, 2.8737664222717285, 0.8968489170074463, 3.8477096557617188, 2.013460874557495, 5.391467571258545, 3.7191874980926514, 3.5094335079193115, 2.9522769451141357, 3.9336936473846436, 1.94366455078125, 3.097097635269165, 1.5986721515655518, 1.1463963985443115, 0.023793518543243408, 2.8658103942871094, 2.678140163421631, 2.2500081062316895, 2.09027361869812, 2.6983304023742676, 2.950747013092041], "mean_td_error": 2.241098642349243, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 35.0, "diff_num_grad_updates_vs_sampler_policy": 34.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.110225677490234, "actor_loss": -5.8307085037231445, "critic_loss": 0.6081368923187256, "alpha_loss": -0.10321752727031708, "alpha_value": 0.9898427128791809, "log_alpha_value": -0.010209220461547375, "target_entropy": -6.0, "policy_t": -0.010019481182098389, "mean_q": 1.7472805976867676, "max_q": 2.168231725692749, "min_q": 1.4896886348724365}, "td_error": [2.1644210815429688, 1.1943387985229492, 1.455308437347412, 1.2989356517791748, 0.4821293354034424, 2.9848897457122803, 3.691987991333008, 3.098879814147949, 2.0329368114471436, 1.799107551574707, 2.6770529747009277, 2.4875364303588867, 0.5751360654830933, 2.9352867603302, 1.1314526796340942, 1.6139830350875854, 0.35139143466949463, 1.4353525638580322, 0.6275464296340942, 0.05769658088684082, 1.6480145454406738, 0.8500669598579407, 0.3477630615234375, 2.7475509643554688, 1.076902151107788, 1.3860955238342285, 3.7588067054748535, 3.3281102180480957, 2.4554500579833984, 1.3638434410095215, 1.3365237712860107, 1.1572420597076416, 2.3784475326538086, 2.8662452697753906, 1.5883088111877441, 1.0438780784606934, 2.124495029449463, 1.5459531545639038, 3.0788145065307617, 3.0083048343658447, 1.899395227432251, 0.6288267970085144, 2.147935390472412, 2.973026752471924, 0.934378981590271, 2.0500571727752686, 1.5261551141738892, 1.9746880531311035, 2.854142427444458, 3.4828739166259766, 2.053863048553467, 2.4093642234802246, 2.254145860671997, 0.4904107451438904, 3.529104471206665, 2.533989429473877, 0.9492244720458984, 2.510258197784424, 4.256870269775391, 1.773233413696289, 3.5972745418548584, 1.9444758892059326, 2.951760768890381, 2.7678985595703125, 1.296366810798645, 1.9839251041412354, 2.3166558742523193, 2.782062292098999, 0.6084520816802979, 0.8626519441604614, 0.4180600047111511, 3.1711080074310303, 4.018729209899902, 2.70194935798645, 2.3279757499694824, 0.6466032266616821, 0.464374303817749, 2.1913111209869385, 4.332942485809326, 1.409447193145752, 3.106088161468506, 1.913127064704895, 1.7691798210144043, 2.94303035736084, 2.534022808074951, 1.0589330196380615], "mean_td_error": 2.0062386989593506, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 35.0, "diff_num_grad_updates_vs_sampler_policy": 34.0}}, "num_env_steps_sampled": 32256, "num_env_steps_trained": 9030, "num_agent_steps_sampled": 96768, "num_agent_steps_trained": 9030, "last_target_update_ts": 32256, "num_target_updates": 35}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96768, "num_agent_steps_trained": 9030, "num_env_steps_sampled": 32256, "num_env_steps_trained": 9030, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 473.12204246507633, "num_env_steps_trained_throughput_per_sec": 136.2338024062385, "timesteps_total": 32256, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 96768, "timers": {"training_iteration_time_ms": 1954.437, "sample_time_ms": 1393.972, "load_time_ms": 0.527, "load_throughput": 489917.798, "learn_time_ms": 62.061, "learn_throughput": 4157.191, "synch_weights_time_ms": 15.483}, "counters": {"num_env_steps_sampled": 32256, "num_env_steps_trained": 9030, "num_agent_steps_sampled": 96768, "num_agent_steps_trained": 9030, "last_target_update_ts": 32256, "num_target_updates": 35}, "done": false, "episodes_total": 0, "training_iteration": 36, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-15-56", "timestamp": 1700201756, "time_this_iter_s": 1.909193992614746, "time_total_s": 73.47216892242432, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8c8ad70d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 73.47216892242432, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 64.96666666666665, "ram_util_percent": 90.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.086355209350586, "actor_loss": -5.906265735626221, "critic_loss": 2.577315330505371, "alpha_loss": -0.10594923794269562, "alpha_value": 0.989550769329071, "log_alpha_value": -0.010504214093089104, "target_entropy": -6.0, "policy_t": 0.041917573660612106, "mean_q": 1.848107933998108, "max_q": 2.197597026824951, "min_q": 1.5558907985687256}, "td_error": [3.338449478149414, 3.544121265411377, 5.211911678314209, 3.021524429321289, 2.9132728576660156, 2.543184757232666, 4.085269927978516, 2.49721097946167, 3.6279091835021973, 4.1383056640625, 3.7797956466674805, 3.861562728881836, 3.929964065551758, 1.0994892120361328, 3.226350784301758, 3.696104049682617, 5.323827743530273, 2.5693087577819824, 2.555816650390625, 6.623237609863281, 4.985334396362305, 2.3162992000579834, 4.457327365875244, 4.9272894859313965, 3.9424219131469727, 5.744604110717773, 1.7545409202575684, 5.6273722648620605, 3.720564126968384, 2.00175142288208, 2.901554584503174, 3.486143112182617, 4.065368175506592, 3.004953145980835, 3.077981472015381, 4.096035480499268, 3.144627571105957, 3.1208908557891846, 2.330526351928711, 5.018548488616943, 3.3166065216064453, 3.096014976501465, 4.201029300689697, 2.860605239868164, 3.5035977363586426, 3.160172462463379, 5.362687110900879, 3.1922903060913086, 3.2062735557556152, 2.8589515686035156, 2.9531784057617188, 4.446756839752197, 3.2100424766540527, 4.542172908782959, 4.631941318511963, 3.6271250247955322, 2.495608329772949, 2.6026830673217773, 5.368826866149902, 3.771841287612915, 1.5979936122894287, 2.279568672180176, 4.324910640716553, 6.07244873046875, 5.054195404052734, 4.146106243133545, 4.906352996826172, 3.1959657669067383, 3.9508986473083496, 4.197054862976074, 3.9312124252319336, 2.798490047454834, 4.571098804473877, 2.7049970626831055, 4.229040622711182, 3.4202754497528076, 5.260764122009277, 3.560933828353882, 3.3164944648742676, 3.246645212173462, 4.3891096115112305, 4.672769546508789, 4.515756130218506, 3.256774663925171, 2.408553123474121, 3.6149165630340576], "mean_td_error": 3.690028667449951, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 36.0, "diff_num_grad_updates_vs_sampler_policy": 35.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.131538391113281, "actor_loss": -5.741600036621094, "critic_loss": 0.3965715765953064, "alpha_loss": -0.10645869374275208, "alpha_value": 0.9895473718643188, "log_alpha_value": -0.01050765160471201, "target_entropy": -6.0, "policy_t": -0.011887595988810062, "mean_q": 1.6559343338012695, "max_q": 1.943906545639038, "min_q": 1.3889135122299194}, "td_error": [3.261552333831787, 1.9767777919769287, 0.2827097177505493, 4.547014236450195, 2.231231451034546, 1.9967358112335205, 2.439239740371704, 2.383608102798462, 0.6537638306617737, 0.8366783857345581, 2.588529109954834, 3.0445423126220703, 0.5370668172836304, 2.8525028228759766, 2.90994930267334, 1.7721316814422607, 1.3315564393997192, 3.3090546131134033, 0.6908165812492371, 0.827673077583313, 0.6787524819374084, 2.494443893432617, 0.4759337902069092, 2.3348729610443115, 2.0320568084716797, 1.8588764667510986, 1.30657160282135, 2.0771100521087646, 1.6682417392730713, 0.6669954657554626, 3.148813486099243, 2.428941249847412, 0.26645803451538086, 2.2092840671539307, 1.170455813407898, 1.8241362571716309, 3.32997465133667, 2.0973918437957764, 2.8396573066711426, 2.8600425720214844, 2.1298975944519043, 1.6765902042388916, 1.0824956893920898, 1.662463903427124, 3.132147789001465, 2.6964383125305176, 1.0277520418167114, 1.832088589668274, 1.7801711559295654, 2.603548765182495, 0.8509509563446045, 2.762850284576416, 1.7397847175598145, 1.6162071228027344, 2.744295120239258, 2.421996831893921, 2.2285852432250977, 1.927619457244873, 0.05097407102584839, 1.5749750137329102, 2.4400463104248047, 2.007680892944336, 1.3709791898727417, 3.5296497344970703, 1.52938973903656, 1.6300960779190063, 1.3185317516326904, 1.740969181060791, 1.4917296171188354, 1.491059422492981, 0.7480006217956543, 1.688713788986206, 2.5509731769561768, 0.21695750951766968, 3.8072967529296875, 2.930769920349121, 1.7652075290679932, 1.2793476581573486, 2.38761568069458, 1.6825758218765259, 2.412503242492676, 1.5498771667480469, 0.15847134590148926, 1.509888768196106, 2.807796001434326, 2.438106060028076], "mean_td_error": 1.9100953340530396, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 36.0, "diff_num_grad_updates_vs_sampler_policy": 35.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.122912406921387, "actor_loss": -5.9441118240356445, "critic_loss": 0.5318804383277893, "alpha_loss": -0.1063864529132843, "alpha_value": 0.9895455837249756, "log_alpha_value": -0.010509470477700233, "target_entropy": -6.0, "policy_t": 0.027541866526007652, "mean_q": 1.913317084312439, "max_q": 2.335999011993408, "min_q": 1.5524224042892456}, "td_error": [3.730959892272949, 2.285017490386963, 2.48759388923645, 2.7241928577423096, 0.5162140130996704, 1.9065524339675903, 1.980878472328186, 2.5253043174743652, 2.1607351303100586, 0.8515692949295044, 2.1261651515960693, 3.7745461463928223, 2.274827480316162, 1.8880136013031006, 2.78149676322937, 0.13282448053359985, 2.315023899078369, 0.6329126358032227, 1.1496015787124634, 0.13501542806625366, 0.4683871269226074, 0.23428332805633545, 0.28892749547958374, 0.9405815601348877, 1.7135695219039917, 1.9117767810821533, 2.3476123809814453, 0.39202243089675903, 1.5648049116134644, 2.5975077152252197, 3.985416889190674, 1.6786798238754272, 2.7503585815429688, 3.1280620098114014, 1.6534472703933716, 0.2750841975212097, 2.2634098529815674, 1.7512047290802002, 2.372032642364502, 1.96171236038208, 1.9156838655471802, 0.8975294828414917, 3.192300796508789, 2.6075034141540527, 3.0644967555999756, 1.5729050636291504, 0.22281932830810547, 1.785843849182129, 2.2723124027252197, 0.2960221767425537, 0.691993236541748, 0.36640846729278564, 0.18898874521255493, 2.997695207595825, 2.3965320587158203, 3.128904104232788, 1.7402693033218384, 0.45548003911972046, 0.9902519583702087, 0.5946906805038452, 4.3123579025268555, 3.2749223709106445, 0.17927700281143188, 1.4449472427368164, 3.63234281539917, 1.9181928634643555, 2.0767898559570312, 1.7923061847686768, 1.5277621746063232, 2.221649646759033, 0.6507862210273743, 1.413169026374817, 1.1670653820037842, 0.06303465366363525, 0.23817676305770874, 0.19759905338287354, 2.511198043823242, 1.0945510864257812, 1.9004895687103271, 3.0373265743255615, 1.896234154701233, 0.7417604327201843, 2.834289789199829, 3.9086270332336426, 3.642528533935547, 1.2941901683807373], "mean_td_error": 1.7791690826416016, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 36.0, "diff_num_grad_updates_vs_sampler_policy": 35.0}}, "num_env_steps_sampled": 33152, "num_env_steps_trained": 9288, "num_agent_steps_sampled": 99456, "num_agent_steps_trained": 9288, "last_target_update_ts": 33152, "num_target_updates": 36}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 99456, "num_agent_steps_trained": 9288, "num_env_steps_sampled": 33152, "num_env_steps_trained": 9288, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 454.10638963745646, "num_env_steps_trained_throughput_per_sec": 130.75831308757117, "timesteps_total": 33152, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 99456, "timers": {"training_iteration_time_ms": 1953.987, "sample_time_ms": 1393.275, "load_time_ms": 0.53, "load_throughput": 486854.021, "learn_time_ms": 61.952, "learn_throughput": 4164.499, "synch_weights_time_ms": 15.867}, "counters": {"num_env_steps_sampled": 33152, "num_env_steps_trained": 9288, "num_agent_steps_sampled": 99456, "num_agent_steps_trained": 9288, "last_target_update_ts": 33152, "num_target_updates": 36}, "done": false, "episodes_total": 0, "training_iteration": 37, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-15-58", "timestamp": 1700201758, "time_this_iter_s": 1.988647222518921, "time_total_s": 75.46081614494324, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8981f5430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 75.46081614494324, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 71.50000000000001, "ram_util_percent": 90.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.103342056274414, "actor_loss": -6.065492630004883, "critic_loss": 2.3926587104797363, "alpha_loss": -0.10916151106357574, "alpha_value": 0.9892536401748657, "log_alpha_value": -0.0108044957742095, "target_entropy": -6.0, "policy_t": 0.04545864090323448, "mean_q": 2.0268914699554443, "max_q": 2.491084098815918, "min_q": 1.6970837116241455}, "td_error": [6.241846561431885, 2.6444592475891113, 2.4679832458496094, 2.523887872695923, 3.92581844329834, 5.525424003601074, 4.356531143188477, 1.2835206985473633, 3.5556106567382812, 4.2541117668151855, 3.519468069076538, 3.7160487174987793, 2.71865177154541, 2.732508420944214, 3.7018840312957764, 3.9429361820220947, 5.583713531494141, 2.416912317276001, 3.6283864974975586, 2.710996627807617, 3.343876838684082, 3.501232624053955, 4.078030586242676, 4.225663661956787, 3.756913661956787, 1.0512182712554932, 4.124499320983887, 2.495354175567627, 3.260631561279297, 3.403398036956787, 2.3483712673187256, 3.0939760208129883, 1.5769567489624023, 3.5301480293273926, 2.343912363052368, 3.265441417694092, 3.4666709899902344, 3.5741896629333496, 2.52736234664917, 4.610641002655029, 4.109317779541016, 3.3260533809661865, 5.9745025634765625, 4.0709228515625, 4.386059761047363, 2.247831344604492, 3.2618255615234375, 2.22556734085083, 2.5068578720092773, 4.100783824920654, 4.43382453918457, 1.654154658317566, 5.695366382598877, 5.828381538391113, 3.179490566253662, 4.675891876220703, 4.862338066101074, 4.3588666915893555, 3.244058609008789, 4.701490879058838, 5.754706382751465, 3.808892250061035, 2.0669007301330566, 4.170226097106934, 4.2831315994262695, 2.32545804977417, 2.3114075660705566, 4.666378974914551, 3.3235244750976562, 2.421833038330078, 3.493271589279175, 2.78411865234375, 3.4467716217041016, 5.563281059265137, 2.2289986610412598, 1.8438518047332764, 4.138388633728027, 3.6510581970214844, 3.2626357078552246, 3.322021961212158, 2.6470727920532227, 1.2029051780700684, 4.821094512939453, 1.7953218221664429, 3.4901857376098633, 1.6454720497131348], "mean_td_error": 3.4690895080566406, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 37.0, "diff_num_grad_updates_vs_sampler_policy": 36.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.089776039123535, "actor_loss": -5.820078372955322, "critic_loss": 0.4348965287208557, "alpha_loss": -0.10905124992132187, "alpha_value": 0.989250123500824, "log_alpha_value": -0.010808094404637814, "target_entropy": -6.0, "policy_t": -0.02382633276283741, "mean_q": 1.7803213596343994, "max_q": 2.138744354248047, "min_q": 1.5109875202178955}, "td_error": [3.22776460647583, 1.6680099964141846, 1.8278108835220337, 1.0881870985031128, 2.2580623626708984, 2.826091766357422, 3.1324429512023926, 2.330397129058838, 1.3918957710266113, 2.2001237869262695, 2.8618178367614746, 2.4470701217651367, 2.0495078563690186, 3.3360133171081543, 2.032639980316162, 1.5500096082687378, 1.2319183349609375, 4.030546188354492, 0.8641773462295532, 1.0777535438537598, 2.434676170349121, 3.3452301025390625, 2.9074409008026123, 1.7052488327026367, 3.263033628463745, 2.826414108276367, 2.0839643478393555, 2.932342052459717, 2.448735237121582, 1.6849393844604492, 0.5578356385231018, 2.4440202713012695, 1.776557445526123, 1.7213213443756104, 0.16797149181365967, 2.2871346473693848, 2.622084140777588, 2.5599334239959717, 0.4261013865470886, 1.6633312702178955, 0.12413960695266724, 1.5202336311340332, 3.0095505714416504, 3.1571168899536133, 2.059873104095459, 3.575763702392578, 2.2951607704162598, 2.505399465560913, 2.3557512760162354, 1.6868804693222046, 2.649259567260742, 0.16206133365631104, 0.537229061126709, 1.5444291830062866, 2.376276969909668, 3.914358139038086, 3.8066747188568115, 1.5255553722381592, 1.3786647319793701, 2.9680051803588867, 1.5504179000854492, 1.874159812927246, 2.794125556945801, 2.597076177597046, 1.9735244512557983, 2.058851718902588, 1.6745562553405762, 0.4029774069786072, 1.5941914319992065, 3.786003828048706, 0.20445072650909424, 3.156187057495117, 1.9970250129699707, 1.8731930255889893, 2.3531956672668457, 4.221949100494385, 1.321453332901001, 1.8395869731903076, 2.9725728034973145, 0.4006444811820984, 1.7054497003555298, 1.759738802909851, 2.105930805206299, 1.6284739971160889, 3.0811548233032227, 1.7181172370910645], "mean_td_error": 2.1056737899780273, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 37.0, "diff_num_grad_updates_vs_sampler_policy": 36.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.090936660766602, "actor_loss": -6.054487228393555, "critic_loss": 0.5349273085594177, "alpha_loss": -0.10908058285713196, "alpha_value": 0.9892484545707703, "log_alpha_value": -0.010809757746756077, "target_entropy": -6.0, "policy_t": -0.022082392126321793, "mean_q": 2.0052781105041504, "max_q": 2.4867918491363525, "min_q": 1.6460626125335693}, "td_error": [0.6629456281661987, 2.274496555328369, 1.2235708236694336, 0.6634450554847717, 2.2207040786743164, 1.1943554878234863, 0.511552095413208, 1.0052565336227417, 1.2525839805603027, 1.7792097330093384, 1.6803052425384521, 0.33670639991760254, 1.120252013206482, 1.3403325080871582, 1.4823999404907227, 1.9345816373825073, 3.0849294662475586, 1.7629542350769043, 0.6967393159866333, 0.5717155933380127, 0.1830083131790161, 0.25784826278686523, 0.9228987097740173, 2.7909507751464844, 2.340491771697998, 1.9004966020584106, 1.3421645164489746, 2.3277645111083984, 2.8716580867767334, 0.916576623916626, 2.6477580070495605, 3.683231830596924, 3.1273887157440186, 2.0269556045532227, 1.6337058544158936, 1.5723315477371216, 1.9354993104934692, 2.198056936264038, 0.41505002975463867, 2.7278966903686523, 1.9594597816467285, 0.2452073097229004, 2.2806451320648193, 2.645612955093384, 1.5940299034118652, 0.36389589309692383, 3.7121939659118652, 1.797835350036621, 1.0185229778289795, 2.724184989929199, 0.13966894149780273, 1.8717327117919922, 2.3822717666625977, 3.382995128631592, 1.6063556671142578, 0.8820153474807739, 3.6837148666381836, 0.08123064041137695, 2.43027663230896, 3.401512384414673, 2.7714173793792725, 1.4523918628692627, 2.5207581520080566, 1.4335650205612183, 1.040948510169983, 1.30070960521698, 2.15405011177063, 4.276999473571777, 0.10372650623321533, 0.11831963062286377, 2.0924623012542725, 3.4256503582000732, 2.93161940574646, 2.822075366973877, 0.29487860202789307, 3.4906487464904785, 3.512545108795166, 0.6919416785240173, 1.5606915950775146, 2.092529773712158, 1.532381534576416, 2.02390193939209, 0.49470043182373047, 2.634948492050171, 1.5811717510223389, 2.2517716884613037], "mean_td_error": 1.7840806245803833, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 37.0, "diff_num_grad_updates_vs_sampler_policy": 36.0}}, "num_env_steps_sampled": 34048, "num_env_steps_trained": 9546, "num_agent_steps_sampled": 102144, "num_agent_steps_trained": 9546, "last_target_update_ts": 34048, "num_target_updates": 37}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 102144, "num_agent_steps_trained": 9546, "num_env_steps_sampled": 34048, "num_env_steps_trained": 9546, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 402.33877062000226, "num_env_steps_trained_throughput_per_sec": 115.85201207584888, "timesteps_total": 34048, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 102144, "timers": {"training_iteration_time_ms": 1965.746, "sample_time_ms": 1376.727, "load_time_ms": 0.531, "load_throughput": 486307.043, "learn_time_ms": 61.717, "learn_throughput": 4180.361, "synch_weights_time_ms": 15.412}, "counters": {"num_env_steps_sampled": 34048, "num_env_steps_trained": 9546, "num_agent_steps_sampled": 102144, "num_agent_steps_trained": 9546, "last_target_update_ts": 34048, "num_target_updates": 37}, "done": false, "episodes_total": 0, "training_iteration": 38, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-16-00", "timestamp": 1700201760, "time_this_iter_s": 2.243283987045288, "time_total_s": 77.70410013198853, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8c8afb940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 77.70410013198853, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 72.2, "ram_util_percent": 90.53333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.092341423034668, "actor_loss": -6.195744037628174, "critic_loss": 2.167027473449707, "alpha_loss": -0.11207333207130432, "alpha_value": 0.98895663022995, "log_alpha_value": -0.01110478863120079, "target_entropy": -6.0, "policy_t": 0.03142276778817177, "mean_q": 2.132002115249634, "max_q": 2.5224318504333496, "min_q": 1.8176624774932861}, "td_error": [2.3512988090515137, 2.5223164558410645, 3.8936774730682373, 2.8093152046203613, 3.8070383071899414, 1.6857105493545532, 2.7120614051818848, 3.5059924125671387, 4.469965934753418, 4.213232517242432, 2.4118590354919434, 2.5150070190429688, 3.827127456665039, 3.0815725326538086, 2.0468757152557373, 0.23201262950897217, 4.070483207702637, 3.5016584396362305, 3.483079433441162, 1.6616723537445068, 0.6999043226242065, 3.172748565673828, 2.2234644889831543, 5.064136505126953, 3.3044466972351074, 4.262457847595215, 2.1449732780456543, 4.497856140136719, 2.2243847846984863, 3.9910974502563477, 2.7588727474212646, 3.9288783073425293, 3.160825252532959, 2.6532697677612305, 2.767195701599121, 5.635331153869629, 1.719132900238037, 4.9371232986450195, 3.0415596961975098, 3.629265785217285, 2.240424156188965, 2.3154430389404297, 2.9335741996765137, 4.945554256439209, 2.343043804168701, 3.6043221950531006, 1.3005326986312866, 2.604569911956787, 2.1677303314208984, 1.5323683023452759, 2.849628448486328, 3.413544178009033, 4.6913557052612305, 1.5187708139419556, 3.4274039268493652, 1.1278436183929443, 5.220893383026123, 3.933180332183838, 4.579277992248535, 2.5941162109375, 2.038738489151001, 1.9259312152862549, 2.6923863887786865, 5.144558906555176, 3.38889217376709, 3.0813632011413574, 3.8890445232391357, 4.516777038574219, 4.594400405883789, 6.713858127593994, 3.053162097930908, 4.789069175720215, 3.656073570251465, 3.230638027191162, 4.107686996459961, 4.832804203033447, 5.244754791259766, 3.6272835731506348, 1.6683655977249146, 2.3624167442321777, 4.269055366516113, 2.6106138229370117, 2.48832631111145, 1.4682978391647339, 1.6415562629699707, 3.866424560546875], "mean_td_error": 3.196103811264038, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 38.0, "diff_num_grad_updates_vs_sampler_policy": 37.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.107584953308105, "actor_loss": -5.943017482757568, "critic_loss": 0.3728879690170288, "alpha_loss": -0.11228016763925552, "alpha_value": 0.9889529943466187, "log_alpha_value": -0.01110850553959608, "target_entropy": -6.0, "policy_t": 0.006997815333306789, "mean_q": 1.9015883207321167, "max_q": 2.2372171878814697, "min_q": 1.6793787479400635}, "td_error": [1.8887377977371216, 1.0399885177612305, 2.5579652786254883, 2.2154550552368164, 0.36083877086639404, 2.343363046646118, 1.4169058799743652, 1.2699054479599, 3.734724521636963, 0.6108989119529724, 2.8121728897094727, 0.8310490846633911, 1.634462833404541, 1.4645664691925049, 0.46750903129577637, 2.201589822769165, 2.0730061531066895, 1.283512830734253, 3.1332104206085205, 1.473797082901001, 1.9033299684524536, 1.4156970977783203, 0.22855454683303833, 2.985029697418213, 2.8669748306274414, 3.4014711380004883, 1.473684310913086, 3.8290257453918457, 3.6363635063171387, 0.8797765374183655, 3.1778223514556885, 0.903305172920227, 1.4176969528198242, 1.369494915008545, 0.8212252259254456, 1.3959460258483887, 2.7600083351135254, 2.704913377761841, 1.1586427688598633, 1.1317209005355835, 3.559138536453247, 2.8679981231689453, 1.907533049583435, 3.3385796546936035, 0.196444571018219, 1.8933690786361694, 0.7141560912132263, 2.017056941986084, 0.629154622554779, 1.595739722251892, 3.028930187225342, 1.8104519844055176, 1.182699203491211, 3.9846222400665283, 2.6173062324523926, 3.583749294281006, 1.4427684545516968, 3.1390767097473145, 0.7471980452537537, 2.515141487121582, 2.750514268875122, 2.096980094909668, 1.793501615524292, 1.0526689291000366, 3.227555274963379, 2.0692076683044434, 1.3540208339691162, 2.4502925872802734, 1.1935133934020996, 1.3055204153060913, 2.79081392288208, 0.9459261894226074, 0.34817421436309814, 2.9819774627685547, 0.18872958421707153, 1.8239860534667969, 0.15526223182678223, 1.3085825443267822, 3.5892248153686523, 0.4679640531539917, 0.14325493574142456, 1.9966626167297363, 1.880127191543579, 0.09956622123718262, 2.185232639312744, 2.2880754470825195], "mean_td_error": 1.8550324440002441, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 38.0, "diff_num_grad_updates_vs_sampler_policy": 37.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.121352195739746, "actor_loss": -6.184953689575195, "critic_loss": 0.4714387357234955, "alpha_loss": -0.11244828999042511, "alpha_value": 0.9889515042304993, "log_alpha_value": -0.011110005900263786, "target_entropy": -6.0, "policy_t": 0.01586039923131466, "mean_q": 2.1134870052337646, "max_q": 2.5622336864471436, "min_q": 1.722200870513916}, "td_error": [2.5897905826568604, 2.986368179321289, 1.6759313344955444, 1.1906870603561401, 1.5439733266830444, 2.849477767944336, 2.0962305068969727, 1.6497288942337036, 1.705259084701538, 0.18699252605438232, 1.25832200050354, 1.0908379554748535, 2.1237449645996094, 0.7033580541610718, 0.8879212141036987, 1.8892823457717896, 1.5427515506744385, 0.13695251941680908, 1.1042547225952148, 2.274754762649536, 3.9250478744506836, 1.5126416683197021, 0.39659857749938965, 1.6062312126159668, 1.9186002016067505, 1.60374116897583, 0.8112332820892334, 1.6796156167984009, 3.805222988128662, 1.120670199394226, 0.19609153270721436, 3.159653663635254, 1.196195363998413, 3.360751152038574, 2.2338814735412598, 2.931086540222168, 1.053185224533081, 1.9161765575408936, 2.2974390983581543, 1.8086198568344116, 2.335031032562256, 2.3191518783569336, 1.9742571115493774, 0.5391004085540771, 1.3482294082641602, 1.248976230621338, 2.345395565032959, 0.68574059009552, 0.26972103118896484, 3.30590558052063, 0.3203010559082031, 0.8818018436431885, 2.8966574668884277, 1.3428688049316406, 0.6431503295898438, 0.6406644582748413, 2.3996572494506836, 1.0963749885559082, 0.8615008592605591, 1.9421710968017578, 1.9665814638137817, 1.1620136499404907, 3.7311205863952637, 1.0103949308395386, 3.38149094581604, 0.06742799282073975, 1.193264365196228, 2.079601287841797, 0.10921311378479004, 1.9537814855575562, 2.279447078704834, 0.3212014436721802, 0.38324010372161865, 2.088654041290283, 1.6233506202697754, 1.96638822555542, 1.7238520383834839, 2.422269344329834, 2.334575653076172, 0.7063421010971069, 2.4629452228546143, 0.8524210453033447, 2.6551690101623535, 1.401857852935791, 2.559326410293579, 0.3190762996673584], "mean_td_error": 1.6531509160995483, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 38.0, "diff_num_grad_updates_vs_sampler_policy": 37.0}}, "num_env_steps_sampled": 34944, "num_env_steps_trained": 9804, "num_agent_steps_sampled": 104832, "num_agent_steps_trained": 9804, "last_target_update_ts": 34944, "num_target_updates": 38}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104832, "num_agent_steps_trained": 9804, "num_env_steps_sampled": 34944, "num_env_steps_trained": 9804, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 489.84157251013903, "num_env_steps_trained_throughput_per_sec": 141.048131370107, "timesteps_total": 34944, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 104832, "timers": {"training_iteration_time_ms": 1912.914, "sample_time_ms": 1324.218, "load_time_ms": 0.531, "load_throughput": 485783.099, "learn_time_ms": 61.755, "learn_throughput": 4177.794, "synch_weights_time_ms": 15.746}, "counters": {"num_env_steps_sampled": 34944, "num_env_steps_trained": 9804, "num_agent_steps_sampled": 104832, "num_agent_steps_trained": 9804, "last_target_update_ts": 34944, "num_target_updates": 38}, "done": false, "episodes_total": 0, "training_iteration": 39, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-16-02", "timestamp": 1700201762, "time_this_iter_s": 1.8420629501342773, "time_total_s": 79.5461630821228, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8c8ad70d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 79.5461630821228, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 63.13333333333335, "ram_util_percent": 90.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.000636100769043, "actor_loss": -6.295953750610352, "critic_loss": 1.8864538669586182, "alpha_loss": -0.11405792832374573, "alpha_value": 0.9886597394943237, "log_alpha_value": -0.011405065655708313, "target_entropy": -6.0, "policy_t": 0.07440868020057678, "mean_q": 2.3165762424468994, "max_q": 2.8337464332580566, "min_q": 1.8594768047332764}, "td_error": [2.074446678161621, 4.642541885375977, 1.8452273607254028, 4.756447792053223, 5.1618146896362305, 3.5881590843200684, 4.33089542388916, 2.2901625633239746, 5.819518089294434, 4.595921993255615, 4.680258750915527, 2.2291460037231445, 4.941418647766113, 3.2753031253814697, 3.0761423110961914, 2.023918867111206, 2.181180238723755, 5.8406853675842285, 1.7282925844192505, 4.365292549133301, 1.6192394495010376, 2.190680980682373, 4.973703384399414, 3.255488872528076, 3.0971932411193848, 2.411496162414551, 2.449221611022949, 3.835871696472168, 2.7906179428100586, 2.9136767387390137, 4.171276092529297, 4.375492095947266, 4.922506332397461, 3.183054208755493, 1.8859812021255493, 3.7075486183166504, 3.3831262588500977, 4.593539714813232, 5.602646827697754, 2.7018189430236816, 1.508857011795044, 2.5506181716918945, 4.965636253356934, 3.9303579330444336, 2.573812961578369, 2.849982976913452, 3.7053494453430176, 2.565004825592041, 3.618988037109375, 4.782231330871582, 3.805805206298828, 2.4634718894958496, 3.674271583557129, 4.490390777587891, 1.465713620185852, 4.11545991897583, 2.429466485977173, 2.6401071548461914, 3.7020750045776367, 2.2463536262512207, 2.9114060401916504, 2.1516523361206055, 3.3232765197753906, 3.5606813430786133, 1.1703873872756958, 3.545987606048584, 4.156529426574707, 3.797300100326538, 2.3398964405059814, 3.918625831604004, 3.994809150695801, 3.60878324508667, 3.2189292907714844, 1.6919142007827759, 4.677318572998047, 3.650481939315796, 2.5462899208068848, 5.98776912689209, 1.6367863416671753, 2.6567556858062744, 3.1670048236846924, 4.043079853057861, 3.1995186805725098, 3.23754620552063, 0.8647356033325195, 3.357548713684082], "mean_td_error": 3.348952531814575, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 39.0, "diff_num_grad_updates_vs_sampler_policy": 38.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.085247993469238, "actor_loss": -6.0450439453125, "critic_loss": 0.37877994775772095, "alpha_loss": -0.11506185680627823, "alpha_value": 0.9886559247970581, "log_alpha_value": -0.011408927850425243, "target_entropy": -6.0, "policy_t": 0.032009921967983246, "mean_q": 2.0254228115081787, "max_q": 2.4062235355377197, "min_q": 1.6926467418670654}, "td_error": [1.4293348789215088, 2.374429702758789, 1.4954038858413696, 2.2376112937927246, 1.0874601602554321, 2.722856044769287, 1.5304478406906128, 1.9555425643920898, 2.6919054985046387, 1.7579081058502197, 2.7897047996520996, 2.3433849811553955, 1.6793373823165894, 1.7980645895004272, 1.6449053287506104, 2.4291765689849854, 2.905352830886841, 1.4406768083572388, 1.7798562049865723, 2.0304272174835205, 0.22015011310577393, 3.1678357124328613, 0.26452207565307617, 2.000455141067505, 2.6915948390960693, 1.97806978225708, 1.087276577949524, 2.3903331756591797, 2.7083964347839355, 2.2018747329711914, 1.4017668962478638, 2.3542098999023438, 2.7453207969665527, 2.5318312644958496, 0.164833664894104, 2.016860008239746, 2.570620059967041, 1.7796356678009033, 0.9202843308448792, 3.068039894104004, 4.0677714347839355, 3.4479355812072754, 0.2230229377746582, 3.2969565391540527, 2.317434787750244, 0.9109071493148804, 0.9027613401412964, 0.3230656385421753, 1.620177149772644, 1.842549204826355, 1.7767341136932373, 1.354426383972168, 0.4493163824081421, 1.6182196140289307, 1.8924345970153809, 1.350766658782959, 1.3728241920471191, 3.1942927837371826, 1.937306523323059, 2.2661619186401367, 2.79968523979187, 1.2564747333526611, 1.7454664707183838, 0.6278950572013855, 2.034278392791748, 1.9493672847747803, 0.33036094903945923, 3.0657358169555664, 1.5866650342941284, 0.31917035579681396, 1.6930878162384033, 1.7273507118225098, 3.8273463249206543, 2.897813558578491, 3.1665186882019043, 2.0428881645202637, 3.1696279048919678, 0.08967387676239014, 0.08587014675140381, 0.7549300193786621, 0.3966304063796997, 0.8766509294509888, 3.580195188522339, 1.3569822311401367, 2.4784765243530273, 2.2423462867736816], "mean_td_error": 1.868072509765625, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 39.0, "diff_num_grad_updates_vs_sampler_policy": 38.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.09505844116211, "actor_loss": -6.346546173095703, "critic_loss": 0.3709532916545868, "alpha_loss": -0.11518751084804535, "alpha_value": 0.9886545538902283, "log_alpha_value": -0.011410286650061607, "target_entropy": -6.0, "policy_t": -0.041714638471603394, "mean_q": 2.294208288192749, "max_q": 2.783407688140869, "min_q": 1.9093085527420044}, "td_error": [1.738571286201477, 2.0703694820404053, 0.7123034000396729, 0.3245445489883423, 1.9935152530670166, 3.274693489074707, 0.8920251131057739, 2.1501924991607666, 1.8317885398864746, 0.6143285036087036, 0.6852774620056152, 0.5663200616836548, 0.4705590009689331, 0.3238654136657715, 2.9621996879577637, 2.3482491970062256, 2.2648396492004395, 1.2971739768981934, 0.6438232660293579, 1.8460421562194824, 2.108186721801758, 1.5564013719558716, 2.9364054203033447, 0.2587689161300659, 1.2913874387741089, 0.611870288848877, 2.9910635948181152, 2.6141252517700195, 1.1787222623825073, 0.07095968723297119, 2.190230369567871, 1.8076502084732056, 1.2698475122451782, 1.4432477951049805, 0.2934708595275879, 2.0607237815856934, 1.2846081256866455, 2.040148973464966, 1.8559154272079468, 1.7461203336715698, 0.982934832572937, 0.4291723370552063, 2.323202133178711, 1.4686784744262695, 0.31241846084594727, 1.8408424854278564, 0.2003454566001892, 1.6859883069992065, 0.8801172971725464, 2.1903958320617676, 0.7108080387115479, 1.2726229429244995, 0.7498461008071899, 0.30841124057769775, 3.5172431468963623, 0.8492473363876343, 1.4612261056900024, 0.17635011672973633, 0.10397136211395264, 0.579473614692688, 1.9840914011001587, 0.0407717227935791, 1.0908242464065552, 2.10832142829895, 1.1677228212356567, 2.1886603832244873, 2.2164878845214844, 1.9874858856201172, 0.7464417219161987, 1.0647386312484741, 0.1987168788909912, 0.7948421239852905, 0.947883129119873, 0.24395406246185303, 2.1928210258483887, 0.7753446102142334, 1.2931227684020996, 1.569118857383728, 1.8457691669464111, 1.907071590423584, 1.1867843866348267, 2.5121870040893555, 1.0330321788787842, 0.6469974517822266, 0.454659104347229, 1.7720749378204346], "mean_td_error": 1.3562064170837402, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 39.0, "diff_num_grad_updates_vs_sampler_policy": 38.0}}, "num_env_steps_sampled": 35840, "num_env_steps_trained": 10062, "num_agent_steps_sampled": 107520, "num_agent_steps_trained": 10062, "last_target_update_ts": 35840, "num_target_updates": 39}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 107520, "num_agent_steps_trained": 10062, "num_env_steps_sampled": 35840, "num_env_steps_trained": 10062, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 477.59945505749346, "num_env_steps_trained_throughput_per_sec": 137.52305737146574, "timesteps_total": 35840, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 107520, "timers": {"training_iteration_time_ms": 1906.267, "sample_time_ms": 1316.453, "load_time_ms": 0.529, "load_throughput": 487468.099, "learn_time_ms": 61.757, "learn_throughput": 4177.661, "synch_weights_time_ms": 15.777}, "counters": {"num_env_steps_sampled": 35840, "num_env_steps_trained": 10062, "num_agent_steps_sampled": 107520, "num_agent_steps_trained": 10062, "last_target_update_ts": 35840, "num_target_updates": 39}, "done": false, "episodes_total": 0, "training_iteration": 40, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-16-04", "timestamp": 1700201764, "time_this_iter_s": 1.8898448944091797, "time_total_s": 81.43600797653198, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8c8addca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 81.43600797653198, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 89.4, "ram_util_percent": 90.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.051976203918457, "actor_loss": -6.4838690757751465, "critic_loss": 1.512174129486084, "alpha_loss": -0.11765959113836288, "alpha_value": 0.9883630871772766, "log_alpha_value": -0.011705121956765652, "target_entropy": -6.0, "policy_t": 0.0037717430386692286, "mean_q": 2.4786434173583984, "max_q": 2.953124761581421, "min_q": 2.0380702018737793}, "td_error": [2.0195677280426025, 2.604534149169922, 4.215273857116699, 1.3176301717758179, 3.300549030303955, 3.189134120941162, 4.227190017700195, 4.669193744659424, 4.341312408447266, 2.152130603790283, 2.886791229248047, 2.4753060340881348, 1.4668155908584595, 4.778990745544434, 3.156881809234619, 2.6303248405456543, 2.044762134552002, 3.231130361557007, 2.9132275581359863, 2.3910253047943115, 0.5615411996841431, 4.649564743041992, 2.915266513824463, 3.3786864280700684, 3.378034830093384, 5.63442850112915, 2.0235824584960938, 2.9570298194885254, 1.9933269023895264, 0.9890753030776978, 1.3086848258972168, 4.786491394042969, 3.6732659339904785, 2.2263004779815674, 2.1430439949035645, 2.9820809364318848, 2.7987685203552246, 2.50901460647583, 3.404026508331299, 2.71127986907959, 3.047748327255249, 3.6554770469665527, 2.653538703918457, 3.372591018676758, 2.1204028129577637, 2.15212345123291, 2.53554630279541, 2.287107467651367, 2.44392991065979, 1.2103315591812134, 3.869192123413086, 1.238789677619934, 1.4522353410720825, 2.877897262573242, 1.6899577379226685, 2.198246955871582, 3.5442919731140137, 4.005311489105225, 2.598344326019287, 0.8673121929168701, 2.151407480239868, 0.9952739477157593, 4.052252769470215, 2.523606538772583, 2.6882810592651367, 1.9270676374435425, 1.261720895767212, 2.409829616546631, 3.0673980712890625, 1.3980145454406738, 5.087752819061279, 1.4045723676681519, 2.308351516723633, 1.715674638748169, 4.531192302703857, 3.4690868854522705, 2.5009989738464355, 3.2060670852661133, 3.84066104888916, 2.1413681507110596, 2.0659828186035156, 2.669036865234375, 2.750304698944092, 4.32589054107666, 4.069859981536865, 2.9897284507751465], "mean_td_error": 2.772174835205078, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 40.0, "diff_num_grad_updates_vs_sampler_policy": 39.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.07353401184082, "actor_loss": -6.188453197479248, "critic_loss": 0.33338311314582825, "alpha_loss": -0.11795412003993988, "alpha_value": 0.9883589744567871, "log_alpha_value": -0.011709309183061123, "target_entropy": -6.0, "policy_t": 0.01677849143743515, "mean_q": 2.1244618892669678, "max_q": 2.548340320587158, "min_q": 1.7609343528747559}, "td_error": [2.4170024394989014, 0.45490896701812744, 0.12690496444702148, 0.8203117847442627, 0.48265671730041504, 3.592541217803955, 4.496682167053223, 0.4283912181854248, 0.8270409107208252, 1.0780551433563232, 1.5342330932617188, 3.0048131942749023, 3.833728313446045, 3.2126684188842773, 0.24941909313201904, 2.9119744300842285, 0.6070729494094849, 0.2517591714859009, 0.918546199798584, 2.5232925415039062, 2.03444766998291, 3.924112558364868, 1.250476360321045, 1.1271661520004272, 0.5632300972938538, 1.4169931411743164, 0.1295156478881836, 2.579840660095215, 0.9844226837158203, 0.1099855899810791, 0.3213294744491577, 1.844201683998108, 2.346177816390991, 1.4598323106765747, 1.6437664031982422, 1.3805655241012573, 2.2377519607543945, 3.2832889556884766, 1.8004704713821411, 1.337672233581543, 1.2601604461669922, 3.083883285522461, 2.7042641639709473, 2.1136534214019775, 1.3522017002105713, 3.2899668216705322, 1.9457964897155762, 3.145380973815918, 0.48016321659088135, 1.453802466392517, 0.1443624496459961, 2.2860400676727295, 2.1666173934936523, 1.6260180473327637, 2.0705771446228027, 3.020679473876953, 0.6809629201889038, 2.414585590362549, 0.9556959867477417, 2.6875250339508057, 3.066643714904785, 1.7899606227874756, 1.082505226135254, 0.9560731649398804, 1.25156831741333, 0.6987861394882202, 0.8680803179740906, 2.9464426040649414, 1.5680054426193237, 0.6946004629135132, 2.18550443649292, 1.8999837636947632, 1.0592052936553955, 0.3758859634399414, 2.5141093730926514, 1.9413883686065674, 0.741089940071106, 3.29714298248291, 0.3565395474433899, 1.8492097854614258, 1.4345930814743042, 0.4497033953666687, 2.3836429119110107, 1.6557607650756836, 0.1454561948776245, 2.0210132598876953], "mean_td_error": 1.6704939603805542, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 40.0, "diff_num_grad_updates_vs_sampler_policy": 39.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.097176551818848, "actor_loss": -6.4681501388549805, "critic_loss": 0.4112068712711334, "alpha_loss": -0.11824335157871246, "alpha_value": 0.9883577823638916, "log_alpha_value": -0.01171053759753704, "target_entropy": -6.0, "policy_t": 0.014941941946744919, "mean_q": 2.388896942138672, "max_q": 2.7946577072143555, "min_q": 1.95107102394104}, "td_error": [1.1340632438659668, 0.8947464227676392, 0.14855778217315674, 2.4704980850219727, 0.45442652702331543, 0.8964425325393677, 0.5782554149627686, 1.2495923042297363, 0.6595056056976318, 1.5502164363861084, 0.8229235410690308, 2.8425865173339844, 1.8884546756744385, 1.0788519382476807, 1.5781055688858032, 2.5778725147247314, 0.7025295495986938, 1.5343186855316162, 2.9437108039855957, 1.1862753629684448, 2.2286105155944824, 3.853032350540161, 0.5118750333786011, 1.5570317506790161, 0.5102901458740234, 1.6727012395858765, 1.2014331817626953, 0.42215561866760254, 2.608701705932617, 1.2134610414505005, 0.09851670265197754, 2.1415786743164062, 0.4768725633621216, 1.9364111423492432, 4.280825614929199, 1.386536717414856, 0.4698665142059326, 0.29504120349884033, 2.1843934059143066, 0.9120672941207886, 0.9530001878738403, 0.13234150409698486, 0.30442702770233154, 3.295656681060791, 0.23919200897216797, 1.2259094715118408, 4.185939788818359, 2.0712313652038574, 1.4184380769729614, 0.12764310836791992, 0.6558582782745361, 1.7685551643371582, 0.19674348831176758, 0.5535967350006104, 0.6932276487350464, 1.3110157251358032, 4.246585845947266, 3.4034485816955566, 1.0100458860397339, 3.5439724922180176, 1.232673168182373, 1.5073091983795166, 0.8868324756622314, 1.2842780351638794, 1.6814953088760376, 2.21651554107666, 1.3992139101028442, 2.2286393642425537, 2.048780679702759, 2.663485527038574, 2.535114288330078, 1.9005377292633057, 0.1845458745956421, 1.487706184387207, 1.0918636322021484, 1.5709284543991089, 2.375732898712158, 2.3577497005462646, 0.7010835409164429, 0.7872887849807739, 0.1544647216796875, 2.530059814453125, 1.7006701231002808, 1.3441883325576782, 1.3152267932891846, 0.1544022560119629], "mean_td_error": 1.4864064455032349, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 40.0, "diff_num_grad_updates_vs_sampler_policy": 39.0}}, "num_env_steps_sampled": 36736, "num_env_steps_trained": 10320, "num_agent_steps_sampled": 110208, "num_agent_steps_trained": 10320, "last_target_update_ts": 36736, "num_target_updates": 40}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 110208, "num_agent_steps_trained": 10320, "num_env_steps_sampled": 36736, "num_env_steps_trained": 10320, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 460.959394542052, "num_env_steps_trained_throughput_per_sec": 132.73161137483194, "timesteps_total": 36736, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 110208, "timers": {"training_iteration_time_ms": 1921.384, "sample_time_ms": 1332.788, "load_time_ms": 0.527, "load_throughput": 489496.735, "learn_time_ms": 61.771, "learn_throughput": 4176.741, "synch_weights_time_ms": 15.733}, "counters": {"num_env_steps_sampled": 36736, "num_env_steps_trained": 10320, "num_agent_steps_sampled": 110208, "num_agent_steps_trained": 10320, "last_target_update_ts": 36736, "num_target_updates": 40}, "done": false, "episodes_total": 0, "training_iteration": 41, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-16-06", "timestamp": 1700201766, "time_this_iter_s": 1.960387945175171, "time_total_s": 83.39639592170715, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8aa4ca550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 83.39639592170715, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 64.43333333333332, "ram_util_percent": 90.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.187076568603516, "actor_loss": -6.728098392486572, "critic_loss": 1.583693027496338, "alpha_loss": -0.12229687720537186, "alpha_value": 0.9880666732788086, "log_alpha_value": -0.012005100026726723, "target_entropy": -6.0, "policy_t": -0.0019146933918818831, "mean_q": 2.638120174407959, "max_q": 3.139458179473877, "min_q": 2.206885814666748}, "td_error": [4.565497398376465, 2.5238118171691895, 1.626428246498108, 2.55092191696167, 1.8216253519058228, 1.138401746749878, 1.4233958721160889, 4.207890510559082, 1.7514946460723877, 2.355252742767334, 4.383701324462891, 3.0875701904296875, 4.468959331512451, 3.61252760887146, 3.1834330558776855, 3.1591081619262695, 3.415341377258301, 2.6718742847442627, 1.304132103919983, 3.5020718574523926, 2.8964078426361084, 4.94101619720459, 4.256231307983398, 3.6485376358032227, 1.9580938816070557, 4.022181510925293, 1.5803617238998413, 3.105297565460205, 2.8941330909729004, 4.37022066116333, 4.8502349853515625, 2.218238353729248, 3.696969509124756, 1.6911174058914185, 3.304965019226074, 2.2778449058532715, 3.818624973297119, 3.390397071838379, 2.9113340377807617, 1.2845890522003174, 3.5028488636016846, 3.2872934341430664, 2.059661388397217, 2.9074759483337402, 3.5660548210144043, 2.7061636447906494, 4.118346691131592, 2.062791585922241, 2.2067456245422363, 2.1507742404937744, 2.6430814266204834, 2.0328683853149414, 4.4986371994018555, 2.8413963317871094, 2.577228546142578, 2.424781322479248, 0.8933510780334473, 2.362609386444092, 3.192751407623291, 1.4554893970489502, 3.994412899017334, 2.9026403427124023, 3.009413242340088, 2.563112735748291, 0.9612360000610352, 2.6224617958068848, 4.259083271026611, 3.1277012825012207, 2.004657745361328, 2.5687170028686523, 1.619887351989746, 3.5553226470947266, 5.248478889465332, 3.702407121658325, 3.1610665321350098, 2.416421413421631, 2.449920415878296, 3.101456642150879, 1.998497486114502, 3.1117258071899414, 3.4239344596862793, 2.3517355918884277, 2.174572706222534, 2.1385626792907715, 2.7068581581115723, 2.4808666706085205], "mean_td_error": 2.8722760677337646, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 41.0, "diff_num_grad_updates_vs_sampler_policy": 40.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.083674430847168, "actor_loss": -6.325915813446045, "critic_loss": 0.2962496280670166, "alpha_loss": -0.12110115587711334, "alpha_value": 0.9880622029304504, "log_alpha_value": -0.012009627185761929, "target_entropy": -6.0, "policy_t": 0.006278532557189465, "mean_q": 2.302717685699463, "max_q": 2.597829818725586, "min_q": 1.879770040512085}, "td_error": [0.7975130081176758, 1.3575894832611084, 1.9657808542251587, 0.8287878036499023, 3.370062828063965, 0.19684767723083496, 0.3071253299713135, 1.6874380111694336, 0.6913192272186279, 0.773045539855957, 1.376930832862854, 2.9709553718566895, 2.262759208679199, 2.6346449851989746, 1.9050049781799316, 0.18518507480621338, 0.4175598621368408, 0.2613447904586792, 0.47957491874694824, 2.648855686187744, 1.3828423023223877, 2.3859145641326904, 4.03375244140625, 3.9594712257385254, 1.2009141445159912, 1.2382500171661377, 0.7919634580612183, 0.642295241355896, 2.4563140869140625, 0.09825599193572998, 0.18515074253082275, 0.7461618185043335, 2.4699528217315674, 1.2676395177841187, 3.065967559814453, 0.18583595752716064, 1.1665008068084717, 0.6318318843841553, 0.3141663074493408, 1.6635485887527466, 1.149012565612793, 1.0189971923828125, 1.104554533958435, 2.1054000854492188, 0.843101978302002, 2.261291027069092, 1.2048054933547974, 1.0702227354049683, 1.7146148681640625, 1.9440535306930542, 0.8836995363235474, 1.5241973400115967, 1.2814521789550781, 3.2751095294952393, 3.3101305961608887, 3.2176480293273926, 1.5572595596313477, 0.16797983646392822, 1.9848530292510986, 2.5698776245117188, 1.7679648399353027, 0.8244338035583496, 0.06360852718353271, 2.504972219467163, 0.5740827322006226, 1.0734940767288208, 1.6232192516326904, 2.232048749923706, 3.7146637439727783, 1.4770921468734741, 2.893911361694336, 1.647219181060791, 2.109443426132202, 0.9593796730041504, 1.8495261669158936, 2.209404945373535, 1.9698755741119385, 1.1590983867645264, 0.7625703811645508, 0.8168939352035522, 1.3558250665664673, 1.2798247337341309, 3.4233031272888184, 1.8727989196777344, 2.254626512527466, 0.41451847553253174], "mean_td_error": 1.5584548711776733, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 41.0, "diff_num_grad_updates_vs_sampler_policy": 40.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.054637908935547, "actor_loss": -6.604454040527344, "critic_loss": 0.36298996210098267, "alpha_loss": -0.12076391279697418, "alpha_value": 0.9880610704421997, "log_alpha_value": -0.012010766193270683, "target_entropy": -6.0, "policy_t": -0.010446488857269287, "mean_q": 2.586160182952881, "max_q": 3.057831048965454, "min_q": 2.0648231506347656}, "td_error": [3.2290241718292236, 1.0086296796798706, 3.092233180999756, 2.753706455230713, 0.7301598787307739, 1.650505781173706, 1.613089919090271, 0.8133286237716675, 3.0331149101257324, 2.0294175148010254, 0.5775414705276489, 2.2939224243164062, 0.9965075254440308, 0.5553290843963623, 0.2804065942764282, 0.8968058824539185, 1.485557198524475, 0.5535860061645508, 1.1489200592041016, 0.9247804880142212, 1.5319191217422485, 1.2472777366638184, 1.9912968873977661, 1.1388658285140991, 1.995404839515686, 1.1192820072174072, 2.412381172180176, 2.523540496826172, 0.3303251266479492, 2.0686326026916504, 0.043900132179260254, 2.579495429992676, 0.34901750087738037, 0.8502901792526245, 0.7347346544265747, 2.3846797943115234, 2.963453769683838, 1.7549406290054321, 1.4319607019424438, 0.3902418613433838, 0.21248972415924072, 0.14539110660552979, 1.3767421245574951, 0.9249533414840698, 1.370059847831726, 1.7922866344451904, 1.6576412916183472, 1.1214011907577515, 1.1549608707427979, 1.2010064125061035, 2.2872743606567383, 0.30472004413604736, 0.11785376071929932, 0.976001501083374, 0.9243286848068237, 0.3084784746170044, 0.9956967830657959, 2.777949094772339, 0.7061284780502319, 0.07657516002655029, 1.3016157150268555, 0.8932845592498779, 0.8223447799682617, 1.7931617498397827, 0.5757565498352051, 1.2684837579727173, 1.045302152633667, 0.4938591718673706, 3.1360607147216797, 0.44467878341674805, 1.7942510843276978, 2.9171390533447266, 1.8416320085525513, 1.240287184715271, 0.8625556230545044, 0.08406174182891846, 2.6369385719299316, 1.9774706363677979, 0.9266796112060547, 1.7440208196640015, 1.3603920936584473, 2.805880069732666, 0.13328886032104492, 1.0649847984313965, 0.14731788635253906, 0.9596869945526123], "mean_td_error": 1.3280380964279175, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 41.0, "diff_num_grad_updates_vs_sampler_policy": 40.0}}, "num_env_steps_sampled": 37632, "num_env_steps_trained": 10578, "num_agent_steps_sampled": 112896, "num_agent_steps_trained": 10578, "last_target_update_ts": 37632, "num_target_updates": 41}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112896, "num_agent_steps_trained": 10578, "num_env_steps_sampled": 37632, "num_env_steps_trained": 10578, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 461.8285266548595, "num_env_steps_trained_throughput_per_sec": 132.9818748626716, "timesteps_total": 37632, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 112896, "timers": {"training_iteration_time_ms": 1919.029, "sample_time_ms": 1330.756, "load_time_ms": 0.53, "load_throughput": 486722.634, "learn_time_ms": 61.758, "learn_throughput": 4177.6, "synch_weights_time_ms": 15.731}, "counters": {"num_env_steps_sampled": 37632, "num_env_steps_trained": 10578, "num_agent_steps_sampled": 112896, "num_agent_steps_trained": 10578, "last_target_update_ts": 37632, "num_target_updates": 41}, "done": false, "episodes_total": 0, "training_iteration": 42, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-16-08", "timestamp": 1700201768, "time_this_iter_s": 1.9557511806488037, "time_total_s": 85.35214710235596, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8c8977f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 85.35214710235596, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 67.06666666666666, "ram_util_percent": 90.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.110296249389648, "actor_loss": -6.866289138793945, "critic_loss": 1.4387218952178955, "alpha_loss": -0.12441042065620422, "alpha_value": 0.9877700805664062, "log_alpha_value": -0.012305316515266895, "target_entropy": -6.0, "policy_t": 0.004557416308671236, "mean_q": 2.816298484802246, "max_q": 3.4788453578948975, "min_q": 2.330353021621704}, "td_error": [3.759603977203369, 2.2615842819213867, 0.8787987232208252, 1.676872730255127, 2.863905668258667, 2.3216841220855713, 1.716728687286377, 2.871044158935547, 2.81880521774292, 0.8238266706466675, 2.0933752059936523, 2.8486413955688477, 0.21895527839660645, 2.887423515319824, 3.2281806468963623, 3.882986068725586, 0.9972225427627563, 5.712401390075684, 3.2479891777038574, 2.3034005165100098, 1.6066970825195312, 2.568521499633789, 2.198073625564575, 2.0388295650482178, 0.550184965133667, 1.1623650789260864, 3.949669361114502, 2.7196578979492188, 0.6013413667678833, 3.2468295097351074, 3.532562494277954, 2.6794891357421875, 2.7103357315063477, 3.975654125213623, 3.4078454971313477, 4.920548439025879, 2.5073676109313965, 2.711306095123291, 1.3615244626998901, 3.8655242919921875, 2.1206226348876953, 0.5229133367538452, 3.2550368309020996, 2.1033191680908203, 5.237893581390381, 2.160848617553711, 4.081930160522461, 3.993107318878174, 2.2535970211029053, 4.132170677185059, 1.6127583980560303, 3.513850688934326, 5.695164203643799, 5.917126178741455, 0.9255142211914062, 1.6102708578109741, 1.8422693014144897, 2.7035207748413086, 0.822594404220581, 4.971925258636475, 1.956299066543579, 2.562187671661377, 2.340542793273926, 1.9228496551513672, 1.9673142433166504, 4.8063459396362305, 1.9891287088394165, 3.9174935817718506, 3.0740504264831543, 1.4946116209030151, 2.2530384063720703, 1.8012621402740479, 3.8745250701904297, 2.4543704986572266, 2.633193254470825, 1.301379919052124, 3.359743595123291, 2.8260300159454346, 1.786858320236206, 1.9085445404052734, 1.5525449514389038, 1.946909785270691, 3.2715468406677246, 3.158498764038086, 1.2393888235092163, 3.129964828491211], "mean_td_error": 2.624800205230713, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 42.0, "diff_num_grad_updates_vs_sampler_policy": 41.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.11992359161377, "actor_loss": -6.475412845611572, "critic_loss": 0.24527093768119812, "alpha_loss": -0.12457536160945892, "alpha_value": 0.9877655506134033, "log_alpha_value": -0.012309911660850048, "target_entropy": -6.0, "policy_t": -0.000454675784567371, "mean_q": 2.431279182434082, "max_q": 2.8271000385284424, "min_q": 2.0050289630889893}, "td_error": [2.8806018829345703, 2.282871961593628, 0.9169051647186279, 1.2673455476760864, 0.5724374055862427, 1.1583538055419922, 1.8194379806518555, 0.47488582134246826, 0.9299077987670898, 1.4079049825668335, 0.23594701290130615, 0.2323291301727295, 3.7171881198883057, 1.4784371852874756, 1.802208662033081, 0.7252780199050903, 1.1332496404647827, 0.15507960319519043, 1.7777047157287598, 0.7699451446533203, 0.20813333988189697, 1.7860244512557983, 5.092799663543701, 2.4685957431793213, 2.7880454063415527, 2.19346284866333, 0.2442028522491455, 2.517761707305908, 0.6309938430786133, 0.6737809181213379, 0.7406350374221802, 2.29526424407959, 1.166683316230774, 1.1845040321350098, 1.432725429534912, 0.40004003047943115, 0.40542495250701904, 0.28264057636260986, 0.6127581596374512, 2.05672550201416, 3.4708428382873535, 1.7109198570251465, 1.5706576108932495, 2.133786201477051, 1.3032715320587158, 0.30099809169769287, 0.8781470060348511, 1.6606249809265137, 1.339003562927246, 0.6663188934326172, 0.9310183525085449, 1.9785239696502686, 0.17705893516540527, 1.979303240776062, 1.1117055416107178, 0.4736776351928711, 0.07069516181945801, 0.9519785642623901, 1.656097173690796, 1.5147053003311157, 3.2353885173797607, 2.4822983741760254, 0.269891619682312, 0.5978689193725586, 2.559234619140625, 1.8936775922775269, 0.09395837783813477, 0.9424259662628174, 0.8358980417251587, 1.2455899715423584, 1.0219670534133911, 1.2179852724075317, 2.7906620502471924, 1.8718191385269165, 3.1460280418395996, 1.2076632976531982, 0.807623028755188, 0.4674419164657593, 0.18182027339935303, 0.5103491544723511, 0.12328910827636719, 0.48537254333496094, 0.20384633541107178, 4.213848114013672, 0.4799398183822632, 2.4826788902282715], "mean_td_error": 1.3507804870605469, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 42.0, "diff_num_grad_updates_vs_sampler_policy": 41.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.044075012207031, "actor_loss": -6.717290878295898, "critic_loss": 0.3255469799041748, "alpha_loss": -0.12365137040615082, "alpha_value": 0.9877645969390869, "log_alpha_value": -0.012310877442359924, "target_entropy": -6.0, "policy_t": -0.058338992297649384, "mean_q": 2.640470266342163, "max_q": 3.247190475463867, "min_q": 2.096224546432495}, "td_error": [1.174921989440918, 0.6134002208709717, 1.2748591899871826, 2.106370210647583, 2.2426939010620117, 2.2594308853149414, 2.1705336570739746, 0.4017353057861328, 1.1505558490753174, 1.6971253156661987, 0.409709095954895, 2.7904062271118164, 1.4674168825149536, 0.7706971168518066, 1.3056355714797974, 1.0090103149414062, 0.7026159763336182, 0.6176127195358276, 1.570024013519287, 0.33748698234558105, 1.023841142654419, 1.4560139179229736, 1.6555460691452026, 0.2327355146408081, 2.370556592941284, 0.9024814367294312, 0.8109288215637207, 2.4481661319732666, 0.45758938789367676, 2.5546627044677734, 1.1046758890151978, 1.0108840465545654, 1.8062702417373657, 1.506777286529541, 0.4494529962539673, 2.592787742614746, 1.5433616638183594, 0.2750580310821533, 1.860944151878357, 1.8050767183303833, 0.41952240467071533, 1.0492606163024902, 0.11947298049926758, 0.45593225955963135, 1.4075936079025269, 0.6939153671264648, 0.3867388963699341, 1.688140869140625, 0.39201605319976807, 1.5264238119125366, 1.7814953327178955, 1.9398881196975708, 1.1810023784637451, 0.34203922748565674, 0.3846992254257202, 0.0962451696395874, 2.7791590690612793, 1.8216663599014282, 0.35209810733795166, 1.0819993019104004, 1.0155413150787354, 1.5099503993988037, 1.5589375495910645, 0.569985032081604, 0.8701716661453247, 0.43973875045776367, 1.3046700954437256, 2.0319108963012695, 1.3520636558532715, 0.4131416082382202, 1.7066818475723267, 0.10682535171508789, 0.34325742721557617, 0.7351815700531006, 1.507116675376892, 0.871458888053894, 2.3627047538757324, 1.2740333080291748, 1.1880906820297241, 1.4503976106643677, 1.636780023574829, 2.010103702545166, 2.350823163986206, 1.6479706764221191, 3.003080368041992, 0.9831833839416504], "mean_td_error": 1.256780982017517, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 42.0, "diff_num_grad_updates_vs_sampler_policy": 41.0}}, "num_env_steps_sampled": 38528, "num_env_steps_trained": 10836, "num_agent_steps_sampled": 115584, "num_agent_steps_trained": 10836, "last_target_update_ts": 38528, "num_target_updates": 42}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 115584, "num_agent_steps_trained": 10836, "num_env_steps_sampled": 38528, "num_env_steps_trained": 10836, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 480.27779025229785, "num_env_steps_trained_throughput_per_sec": 138.29427442532685, "timesteps_total": 38528, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 115584, "timers": {"training_iteration_time_ms": 1921.131, "sample_time_ms": 1330.769, "load_time_ms": 0.53, "load_throughput": 486810.217, "learn_time_ms": 61.813, "learn_throughput": 4173.889, "synch_weights_time_ms": 16.032}, "counters": {"num_env_steps_sampled": 38528, "num_env_steps_trained": 10836, "num_agent_steps_sampled": 115584, "num_agent_steps_trained": 10836, "last_target_update_ts": 38528, "num_target_updates": 42}, "done": false, "episodes_total": 0, "training_iteration": 43, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-16-10", "timestamp": 1700201770, "time_this_iter_s": 1.8826980590820312, "time_total_s": 87.23484516143799, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8c8add9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 87.23484516143799, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 66.13333333333334, "ram_util_percent": 90.53333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.105438232421875, "actor_loss": -7.027872562408447, "critic_loss": 1.294201135635376, "alpha_loss": -0.12738476693630219, "alpha_value": 0.9874735474586487, "log_alpha_value": -0.012605567462742329, "target_entropy": -6.0, "policy_t": 0.008063959889113903, "mean_q": 2.965526819229126, "max_q": 3.5450599193573, "min_q": 2.442030906677246}, "td_error": [2.4155502319335938, 2.0775351524353027, 1.6238067150115967, 2.3634867668151855, 3.924571990966797, 3.438302516937256, 2.62190842628479, 4.833742618560791, 3.203171730041504, 0.37877821922302246, 3.1316914558410645, 3.0890212059020996, 1.5515656471252441, 3.8479695320129395, 3.9646713733673096, 0.7424672842025757, 1.4025330543518066, 2.7629036903381348, 3.1617021560668945, 2.081286668777466, 2.217639207839966, 3.2298970222473145, 1.5849714279174805, 1.914229393005371, 0.4008316993713379, 2.0455849170684814, 1.308508038520813, 1.7957602739334106, 3.619105815887451, 1.599547266960144, 4.120269298553467, 1.6450642347335815, 3.19698429107666, 1.5820790529251099, 2.494547128677368, 2.890338897705078, 3.3917407989501953, 0.7236189842224121, 0.6017358303070068, 1.870060920715332, 3.423553228378296, 2.0796124935150146, 3.9737749099731445, 3.2054073810577393, 3.1959986686706543, 1.2962515354156494, 3.6866745948791504, 4.542718887329102, 3.7623162269592285, 0.9807665348052979, 1.1109681129455566, 2.8166866302490234, 2.5714311599731445, 0.912886381149292, 2.1746397018432617, 3.8359272480010986, 3.9007081985473633, 3.32999587059021, 1.6028430461883545, 1.362426996231079, 1.713579773902893, 3.813310146331787, 2.4232325553894043, 2.072171211242676, 4.997212886810303, 2.8666608333587646, 2.3794960975646973, 3.0981597900390625, 2.7531652450561523, 1.9708038568496704, 1.2006639242172241, 2.463580369949341, 1.0409668684005737, 3.1102821826934814, 2.527092456817627, 1.4932749271392822, 3.4741854667663574, 3.146294116973877, 2.130882501602173, 0.6832590103149414, 2.1740975379943848, 1.1545636653900146, 0.29364287853240967, 4.014920234680176, 2.098268747329712, 3.067911148071289], "mean_td_error": 2.4508888721466064, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 43.0, "diff_num_grad_updates_vs_sampler_policy": 42.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.147055625915527, "actor_loss": -6.673560619354248, "critic_loss": 0.23798513412475586, "alpha_loss": -0.12795691192150116, "alpha_value": 0.9874688982963562, "log_alpha_value": -0.012610248290002346, "target_entropy": -6.0, "policy_t": -0.0005493953940458596, "mean_q": 2.577929735183716, "max_q": 3.01505970954895, "min_q": 2.16316556930542}, "td_error": [1.0641329288482666, 0.6530369520187378, 0.10518157482147217, 2.0155134201049805, 0.5916374921798706, 0.48830294609069824, 2.707578182220459, 2.0786595344543457, 1.001905083656311, 0.8254590034484863, 2.19154691696167, 0.575036883354187, 0.49720299243927, 0.4817601442337036, 0.39899444580078125, 1.4811396598815918, 0.20939576625823975, 1.8925092220306396, 1.3052719831466675, 1.349056363105774, 2.0604257583618164, 2.5233306884765625, 2.9964022636413574, 2.5786690711975098, 2.529106616973877, 2.136862277984619, 1.5047036409378052, 0.272086501121521, 1.5993138551712036, 4.557741165161133, 0.3595101833343506, 0.465407133102417, 1.1360464096069336, 1.3134902715682983, 1.752215027809143, 1.8535770177841187, 1.706499695777893, 1.8561291694641113, 0.507207989692688, 1.4195419549942017, 1.933834433555603, 1.220945954322815, 1.7827847003936768, 0.5890233516693115, 0.7378789186477661, 0.29913246631622314, 1.2040120363235474, 0.766607403755188, 0.4257028102874756, 1.137247920036316, 1.1999775171279907, 0.9707417488098145, 1.0436420440673828, 0.23744773864746094, 0.197623610496521, 1.4560842514038086, 1.1960389614105225, 1.3367286920547485, 0.6792551279067993, 2.7700107097625732, 0.19989490509033203, 2.0904242992401123, 1.7140229940414429, 0.28917741775512695, 2.028864860534668, 1.6478601694107056, 1.9483262300491333, 1.6385931968688965, 2.0644021034240723, 0.6575256586074829, 2.8534483909606934, 0.8372961282730103, 0.7500717639923096, 1.2670718431472778, 1.9479873180389404, 3.3231372833251953, 0.7960429191589355, 2.456888198852539, 1.4001665115356445, 0.3371553421020508, 0.21707689762115479, 0.2674914598464966, 1.5421420335769653, 1.2507877349853516, 1.5457693338394165, 1.7327795028686523], "mean_td_error": 1.3375664949417114, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 43.0, "diff_num_grad_updates_vs_sampler_policy": 42.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.10481071472168, "actor_loss": -6.923234939575195, "critic_loss": 0.27583056688308716, "alpha_loss": -0.12743036448955536, "alpha_value": 0.9874683022499084, "log_alpha_value": -0.012610861100256443, "target_entropy": -6.0, "policy_t": -0.03767849877476692, "mean_q": 2.8335680961608887, "max_q": 3.567364454269409, "min_q": 2.400719404220581}, "td_error": [1.996451735496521, 1.0771815776824951, 0.3287510871887207, 1.7156949043273926, 1.4747883081436157, 0.9855083227157593, 1.44203782081604, 0.8366096019744873, 0.8016139268875122, 0.745430588722229, 1.1593793630599976, 1.1099343299865723, 0.8333925008773804, 0.17986249923706055, 1.064098596572876, 2.6000702381134033, 0.4020653963088989, 0.8197875022888184, 1.244872808456421, 4.673674583435059, 0.9739001989364624, 1.5004267692565918, 1.6089950799942017, 0.8610080480575562, 0.41481029987335205, 0.8327456712722778, 0.942284345626831, 0.5225768089294434, 2.544996738433838, 1.1234585046768188, 0.6548057794570923, 0.7103872299194336, 0.6359623670578003, 2.2329959869384766, 0.5479270219802856, 0.6151522397994995, 0.40443098545074463, 1.5662713050842285, 0.19100141525268555, 0.8050758838653564, 0.40744054317474365, 1.494390845298767, 1.549821376800537, 0.596331000328064, 0.272152304649353, 0.16124415397644043, 2.639096736907959, 0.7704340219497681, 0.11397421360015869, 2.4646081924438477, 0.6139050722122192, 2.002425193786621, 2.921875476837158, 0.4359804391860962, 1.1757984161376953, 0.6795971393585205, 0.8844234943389893, 0.2250744104385376, 0.35679805278778076, 0.18345963954925537, 2.459926128387451, 0.8575500249862671, 2.838625431060791, 1.293991208076477, 1.1273348331451416, 0.7405050992965698, 2.061257839202881, 1.3052743673324585, 1.2109813690185547, 1.843533992767334, 0.1970449686050415, 0.7883232831954956, 1.579983115196228, 1.5234414339065552, 0.3296107053756714, 0.9531536102294922, 0.17240023612976074, 0.8349672555923462, 1.2439770698547363, 0.7164849042892456, 0.18949341773986816, 0.4654592275619507, 1.3673099279403687, 2.731203079223633, 0.49395763874053955, 1.0845123529434204], "mean_td_error": 1.1109249591827393, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 43.0, "diff_num_grad_updates_vs_sampler_policy": 42.0}}, "num_env_steps_sampled": 39424, "num_env_steps_trained": 11094, "num_agent_steps_sampled": 118272, "num_agent_steps_trained": 11094, "last_target_update_ts": 39424, "num_target_updates": 43}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 118272, "num_agent_steps_trained": 11094, "num_env_steps_sampled": 39424, "num_env_steps_trained": 11094, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 470.4338275056781, "num_env_steps_trained_throughput_per_sec": 135.4597405094475, "timesteps_total": 39424, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 118272, "timers": {"training_iteration_time_ms": 1930.462, "sample_time_ms": 1340.559, "load_time_ms": 0.531, "load_throughput": 485913.979, "learn_time_ms": 61.909, "learn_throughput": 4167.395, "synch_weights_time_ms": 15.866}, "counters": {"num_env_steps_sampled": 39424, "num_env_steps_trained": 11094, "num_agent_steps_sampled": 118272, "num_agent_steps_trained": 11094, "last_target_update_ts": 39424, "num_target_updates": 43}, "done": false, "episodes_total": 0, "training_iteration": 44, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-16-12", "timestamp": 1700201772, "time_this_iter_s": 1.9205832481384277, "time_total_s": 89.15542840957642, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8c89aa310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 89.15542840957642, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 86.65, "ram_util_percent": 90.55}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.154406547546387, "actor_loss": -7.244781017303467, "critic_loss": 1.27510404586792, "alpha_loss": -0.13105109333992004, "alpha_value": 0.9871770739555359, "log_alpha_value": -0.012905837036669254, "target_entropy": -6.0, "policy_t": 0.0050573633052408695, "mean_q": 3.1389713287353516, "max_q": 3.704979419708252, "min_q": 2.6165337562561035}, "td_error": [1.9306789636611938, 4.354559898376465, 2.7206645011901855, 2.2615716457366943, 2.4019827842712402, 2.627467155456543, 2.2840888500213623, 0.6268587112426758, 1.5399094820022583, 1.7188403606414795, 4.467191696166992, 2.187783718109131, 2.123861312866211, 3.061309337615967, 2.4294121265411377, 1.634070634841919, 2.8296239376068115, 3.841825246810913, 3.471583366394043, 2.037684202194214, 1.7360177040100098, 2.39323091506958, 2.7728676795959473, 3.958277702331543, 2.4398226737976074, 2.87081241607666, 2.4012656211853027, 0.7400013208389282, 3.6725568771362305, 1.8642139434814453, 2.0024843215942383, 2.7378406524658203, 3.24741530418396, 2.012507915496826, 1.9149457216262817, 2.5574679374694824, 3.2435531616210938, 1.2883026599884033, 4.547818660736084, 3.0082077980041504, 2.029308557510376, 3.6002893447875977, 2.0143985748291016, 3.1056971549987793, 2.3173184394836426, 3.0171892642974854, 2.0965895652770996, 2.960538625717163, 1.701831340789795, 4.387999534606934, 1.5488780736923218, 1.33201003074646, 0.6092841625213623, 3.614337205886841, 0.5613282918930054, 2.308061122894287, 3.251516103744507, 1.7463433742523193, 3.575141429901123, 3.964064598083496, 2.181551456451416, 4.037187099456787, 2.5736207962036133, 2.411900520324707, 1.298044204711914, 1.3823751211166382, 2.708806037902832, 2.879974365234375, 1.4603691101074219, 1.6776869297027588, 0.24718284606933594, 1.9652355909347534, 2.885514259338379, 1.5245954990386963, 3.5410666465759277, 1.092307448387146, 1.635991096496582, 0.6724934577941895, 2.270500659942627, 2.0100350379943848, 3.3044273853302, 2.259397029876709, 3.772317409515381, 2.8368372917175293, 3.5461745262145996, 1.1649179458618164], "mean_td_error": 2.4307351112365723, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 44.0, "diff_num_grad_updates_vs_sampler_policy": 43.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.086466789245605, "actor_loss": -6.781799793243408, "critic_loss": 0.20255401730537415, "alpha_loss": -0.13022325932979584, "alpha_value": 0.9871723055839539, "log_alpha_value": -0.012910693883895874, "target_entropy": -6.0, "policy_t": -0.053540199995040894, "mean_q": 2.7572131156921387, "max_q": 3.195251703262329, "min_q": 2.3781955242156982}, "td_error": [0.43786847591400146, 2.2429137229919434, 2.412259101867676, 2.541329860687256, 0.5818431377410889, 1.4206641912460327, 0.28094279766082764, 0.2548905611038208, 1.7536283731460571, 1.3223707675933838, 0.31882476806640625, 0.27187955379486084, 1.2226964235305786, 1.7971113920211792, 0.603721022605896, 0.6297235488891602, 0.8971561193466187, 1.026591181755066, 0.3628772497177124, 0.2560105323791504, 1.3090726137161255, 0.12618005275726318, 2.5147743225097656, 1.272228717803955, 0.8862127065658569, 1.1016714572906494, 1.4264791011810303, 0.5132789611816406, 0.8393099308013916, 1.4003263711929321, 0.3369598388671875, 3.133863925933838, 1.3430637121200562, 1.2981946468353271, 2.404266357421875, 0.8769677877426147, 0.5156688690185547, 0.721100926399231, 0.13976836204528809, 1.321372151374817, 0.2148038148880005, 2.6206164360046387, 0.032012104988098145, 0.6328384876251221, 0.14536750316619873, 1.1331456899642944, 3.067532777786255, 1.6402567625045776, 1.679707646369934, 1.5327823162078857, 0.4805649518966675, 0.8155832290649414, 0.9246534109115601, 1.7516640424728394, 0.8025345802307129, 0.23487842082977295, 1.4865243434906006, 0.20082402229309082, 3.4621334075927734, 1.71534264087677, 0.27131080627441406, 1.1870713233947754, 1.6152600049972534, 0.13866114616394043, 0.6989305019378662, 1.1812490224838257, 1.9607454538345337, 1.8658238649368286, 3.580688953399658, 2.351564884185791, 1.4586766958236694, 0.3167024850845337, 1.9993906021118164, 2.3949077129364014, 0.5812591314315796, 1.1104047298431396, 0.01870858669281006, 0.8280819654464722, 1.8425843715667725, 1.2126954793930054, 0.33638012409210205, 2.1228437423706055, 0.33053433895111084, 0.39374589920043945, 1.0607502460479736, 0.14563751220703125], "mean_td_error": 1.1592377424240112, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 44.0, "diff_num_grad_updates_vs_sampler_policy": 43.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.093123435974121, "actor_loss": -7.096704006195068, "critic_loss": 0.2225545346736908, "alpha_loss": -0.1303110271692276, "alpha_value": 0.9871721267700195, "log_alpha_value": -0.012910871766507626, "target_entropy": -6.0, "policy_t": -0.028187116608023643, "mean_q": 3.0496461391448975, "max_q": 3.760040760040283, "min_q": 2.4249234199523926}, "td_error": [0.6596535444259644, 0.39592552185058594, 0.7667042016983032, 1.857312798500061, 1.7629387378692627, 0.9261602163314819, 0.848388671875, 0.08402812480926514, 0.37827014923095703, 0.7536425590515137, 1.5358247756958008, 2.0589561462402344, 0.881827712059021, 1.7467901706695557, 1.2001404762268066, 0.17135322093963623, 2.3344907760620117, 0.3123732805252075, 0.9235351085662842, 0.8567981719970703, 0.5840011835098267, 0.9907957315444946, 2.2395005226135254, 0.5989640951156616, 0.47795629501342773, 0.5192346572875977, 0.17845630645751953, 0.32994914054870605, 1.2753421068191528, 0.7285456657409668, 0.20966529846191406, 1.8087835311889648, 0.9551209211349487, 0.6906925439834595, 0.307645320892334, 0.34086763858795166, 0.3509591817855835, 1.0055803060531616, 0.23354637622833252, 0.7584364414215088, 0.22222566604614258, 0.8176850080490112, 0.9792078733444214, 0.3592863082885742, 1.0878714323043823, 0.7930577993392944, 1.5326838493347168, 0.5350044965744019, 1.6570146083831787, 1.6575065851211548, 0.1765275001525879, 0.7988711595535278, 1.1540477275848389, 0.8533576726913452, 1.5781906843185425, 3.6057486534118652, 0.8484759330749512, 0.11385500431060791, 1.8640620708465576, 1.6951332092285156, 1.449816107749939, 0.4994570016860962, 0.7856857776641846, 1.4046461582183838, 0.9779038429260254, 1.3324055671691895, 1.0295319557189941, 1.271462082862854, 0.49722516536712646, 0.06448864936828613, 0.9099966287612915, 1.1946102380752563, 0.9186900854110718, 1.3971153497695923, 2.201657772064209, 0.2104564905166626, 0.4988466501235962, 0.5653629302978516, 0.5514792203903198, 2.378462791442871, 0.4454113245010376, 1.4313421249389648, 0.22252380847930908, 0.6904799938201904, 1.8880351781845093, 0.07598543167114258], "mean_td_error": 0.9565353989601135, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 44.0, "diff_num_grad_updates_vs_sampler_policy": 43.0}}, "num_env_steps_sampled": 40320, "num_env_steps_trained": 11352, "num_agent_steps_sampled": 120960, "num_agent_steps_trained": 11352, "last_target_update_ts": 40320, "num_target_updates": 44}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120960, "num_agent_steps_trained": 11352, "num_env_steps_sampled": 40320, "num_env_steps_trained": 11352, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 480.09875421528795, "num_env_steps_trained_throughput_per_sec": 138.24272163788427, "timesteps_total": 40320, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 120960, "timers": {"training_iteration_time_ms": 1931.89, "sample_time_ms": 1341.628, "load_time_ms": 0.529, "load_throughput": 487468.099, "learn_time_ms": 61.812, "learn_throughput": 4173.962, "synch_weights_time_ms": 15.863}, "counters": {"num_env_steps_sampled": 40320, "num_env_steps_trained": 11352, "num_agent_steps_sampled": 120960, "num_agent_steps_trained": 11352, "last_target_update_ts": 40320, "num_target_updates": 44}, "done": false, "episodes_total": 0, "training_iteration": 45, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-16-14", "timestamp": 1700201774, "time_this_iter_s": 1.8814449310302734, "time_total_s": 91.03687334060669, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8c8add8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 91.03687334060669, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 65.83333333333333, "ram_util_percent": 90.59999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.082756042480469, "actor_loss": -7.413821697235107, "critic_loss": 1.230625867843628, "alpha_loss": -0.1331552416086197, "alpha_value": 0.9868806004524231, "log_alpha_value": -0.013206235133111477, "target_entropy": -6.0, "policy_t": -0.020479101687669754, "mean_q": 3.35428524017334, "max_q": 4.0018815994262695, "min_q": 2.7299036979675293}, "td_error": [2.088181495666504, 0.3731262683868408, 4.042217254638672, 1.879312515258789, 1.3242229223251343, 2.7917375564575195, 3.565748453140259, 0.25049352645874023, 2.8505876064300537, 2.9074673652648926, 2.549459457397461, 1.7812813520431519, 2.883514881134033, 0.8978286981582642, 1.5679723024368286, 1.8148232698440552, 1.5058695077896118, 2.785231828689575, 1.3448817729949951, 2.25258207321167, 1.855660319328308, 2.1845784187316895, 3.871220827102661, 2.040065288543701, 1.707308292388916, 0.2157609462738037, 1.7395620346069336, 2.3403117656707764, 3.4776084423065186, 2.4191198348999023, 1.2971770763397217, 3.27349853515625, 0.9079300165176392, 4.948772430419922, 0.6985330581665039, 2.753091335296631, 2.4269065856933594, 1.4881043434143066, 3.7246317863464355, 0.6274545192718506, 1.4542262554168701, 1.7734758853912354, 3.62581205368042, 1.7072160243988037, 3.3052122592926025, 1.6262221336364746, 2.8790674209594727, 1.8781321048736572, 2.84969425201416, 0.45018208026885986, 1.4115488529205322, 3.2261786460876465, 1.7231013774871826, 2.2969460487365723, 0.765487790107727, 2.158665657043457, 2.8524680137634277, 4.350622653961182, 1.0365922451019287, 3.332106351852417, 2.2590956687927246, 3.518566370010376, 1.8692294359207153, 2.149702787399292, 3.354938507080078, 1.8395317792892456, 1.4321389198303223, 1.9016056060791016, 3.2084105014801025, 2.7973110675811768, 3.556354522705078, 2.9376955032348633, 3.210895299911499, 2.782775402069092, 3.134007215499878, 3.0663304328918457, 3.204599380493164, 2.3616280555725098, 3.6635429859161377, 0.4237743616104126, 0.9906820058822632, 2.6249091625213623, 1.8469449281692505, 2.368472099304199, 4.069281578063965, 2.7659831047058105], "mean_td_error": 2.2964556217193604, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 45.0, "diff_num_grad_updates_vs_sampler_policy": 44.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.053481101989746, "actor_loss": -6.922129154205322, "critic_loss": 0.19658073782920837, "alpha_loss": -0.13281749188899994, "alpha_value": 0.9868757724761963, "log_alpha_value": -0.013211093842983246, "target_entropy": -6.0, "policy_t": 0.015856746584177017, "mean_q": 2.8872056007385254, "max_q": 3.4441120624542236, "min_q": 2.4301793575286865}, "td_error": [0.07926833629608154, 0.5169150829315186, 0.9145733118057251, 2.770721673965454, 4.553800582885742, 0.45378947257995605, 0.47741246223449707, 0.833755373954773, 0.6088719367980957, 0.747671365737915, 0.1828935146331787, 1.8260226249694824, 1.4628183841705322, 0.45096325874328613, 0.4233987331390381, 0.24096417427062988, 0.6176621913909912, 2.593569040298462, 0.8746069669723511, 1.725786805152893, 1.454699993133545, 2.21714448928833, 1.108585238456726, 0.4378788471221924, 0.416465163230896, 0.04656875133514404, 2.029454231262207, 2.163355827331543, 2.4085440635681152, 0.6563947200775146, 0.5303200483322144, 2.644054889678955, 0.5572518110275269, 1.3505373001098633, 0.49645793437957764, 0.029268383979797363, 1.1624934673309326, 1.219657301902771, 0.054793477058410645, 2.7381420135498047, 0.051869750022888184, 1.5460878610610962, 0.3090555667877197, 1.5268675088882446, 1.1738117933273315, 0.456260085105896, 1.355067491531372, 1.4420855045318604, 2.5477306842803955, 1.5589953660964966, 1.83395254611969, 0.7645440101623535, 3.1098761558532715, 2.1803665161132812, 0.8689264059066772, 0.1360405683517456, 0.29288434982299805, 1.6366162300109863, 1.5480462312698364, 0.4317396879196167, 0.15767669677734375, 0.14895009994506836, 1.848239779472351, 1.0953991413116455, 1.2308610677719116, 0.4807398319244385, 1.4839309453964233, 0.9332787990570068, 0.29510247707366943, 2.2137386798858643, 2.7258641719818115, 0.8047630786895752, 0.4680604934692383, 0.12756311893463135, 0.9793933629989624, 2.0943610668182373, 0.8063271045684814, 0.8146873712539673, 2.4909634590148926, 0.7747465372085571, 1.1268099546432495, 0.3255428075790405, 1.1112059354782104, 0.8778539896011353, 0.667404294013977, 0.5668034553527832], "mean_td_error": 1.1337050199508667, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 45.0, "diff_num_grad_updates_vs_sampler_policy": 44.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.030200958251953, "actor_loss": -7.1964616775512695, "critic_loss": 0.2269076108932495, "alpha_loss": -0.132507786154747, "alpha_value": 0.9868760108947754, "log_alpha_value": -0.013210879638791084, "target_entropy": -6.0, "policy_t": -0.05843447148799896, "mean_q": 3.1080985069274902, "max_q": 3.8467345237731934, "min_q": 2.6601645946502686}, "td_error": [0.2696220874786377, 0.4858802556991577, 1.483657717704773, 0.9542118310928345, 0.2687680721282959, 1.1921340227127075, 0.5718866586685181, 1.7998539209365845, 0.5947484970092773, 0.5754597187042236, 1.157507061958313, 1.8387751579284668, 2.0577948093414307, 0.08087396621704102, 2.265566349029541, 1.2700932025909424, 2.1806225776672363, 1.405173420906067, 1.6023836135864258, 1.5437514781951904, 0.27462804317474365, 0.4759422540664673, 0.365034818649292, 1.5458881855010986, 0.8042079210281372, 1.3743668794631958, 1.397261619567871, 1.64290452003479, 0.7456529140472412, 0.6225142478942871, 0.6120197772979736, 2.933609962463379, 0.9384372234344482, 1.4996140003204346, 1.5878702402114868, 0.6094084978103638, 0.6581085920333862, 1.8128143548965454, 0.971627950668335, 0.5519521236419678, 1.8086071014404297, 0.2260570526123047, 0.45387375354766846, 0.5830941200256348, 0.9906737804412842, 0.2516535520553589, 0.15620386600494385, 2.0900163650512695, 0.01021718978881836, 1.1621346473693848, 1.3411757946014404, 1.096771001815796, 0.8213411569595337, 1.282248616218567, 0.33419132232666016, 0.3148840665817261, 1.1766911745071411, 1.775902271270752, 0.2798755168914795, 1.6187281608581543, 0.7025240659713745, 0.3059234619140625, 2.508962631225586, 0.24730920791625977, 0.07656681537628174, 0.9483546018600464, 0.9448093175888062, 2.6550426483154297, 0.4560188055038452, 0.9089035987854004, 0.27157092094421387, 1.2388805150985718, 0.32312607765197754, 2.30092453956604, 1.481411337852478, 0.47210681438446045, 0.17260515689849854, 0.45455729961395264, 0.13412892818450928, 0.8939840793609619, 0.5931659936904907, 0.10480642318725586, 0.13826048374176025, 0.30111944675445557, 0.646895170211792, 1.0724371671676636], "mean_td_error": 0.9668763875961304, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 45.0, "diff_num_grad_updates_vs_sampler_policy": 44.0}}, "num_env_steps_sampled": 41216, "num_env_steps_trained": 11610, "num_agent_steps_sampled": 123648, "num_agent_steps_trained": 11610, "last_target_update_ts": 41216, "num_target_updates": 45}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 123648, "num_agent_steps_trained": 11610, "num_env_steps_sampled": 41216, "num_env_steps_trained": 11610, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 476.3484585934138, "num_env_steps_trained_throughput_per_sec": 137.16283740747852, "timesteps_total": 41216, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 123648, "timers": {"training_iteration_time_ms": 1930.614, "sample_time_ms": 1338.975, "load_time_ms": 0.53, "load_throughput": 486744.527, "learn_time_ms": 61.747, "learn_throughput": 4178.37, "synch_weights_time_ms": 15.99}, "counters": {"num_env_steps_sampled": 41216, "num_env_steps_trained": 11610, "num_agent_steps_sampled": 123648, "num_agent_steps_trained": 11610, "last_target_update_ts": 41216, "num_target_updates": 45}, "done": false, "episodes_total": 0, "training_iteration": 46, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-16-15", "timestamp": 1700201775, "time_this_iter_s": 1.8975539207458496, "time_total_s": 92.93442726135254, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8c8afb940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 92.93442726135254, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 66.86666666666666, "ram_util_percent": 90.59999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.150187492370605, "actor_loss": -7.612240314483643, "critic_loss": 0.9589431285858154, "alpha_loss": -0.13709431886672974, "alpha_value": 0.9865842461585999, "log_alpha_value": -0.013506580144166946, "target_entropy": -6.0, "policy_t": 0.022189443930983543, "mean_q": 3.53812313079834, "max_q": 4.178318500518799, "min_q": 2.9753596782684326}, "td_error": [0.8764595985412598, 0.3134256601333618, 1.1323456764221191, 2.405937910079956, 1.8689519166946411, 2.362435817718506, 0.4907139539718628, 1.2646207809448242, 1.2142819166183472, 2.2983155250549316, 0.3544328212738037, 2.8802642822265625, 3.300610065460205, 2.278022289276123, 2.2927141189575195, 0.43061304092407227, 2.5960564613342285, 2.248473644256592, 2.622548818588257, 0.5326132774353027, 1.634803295135498, 3.5944857597351074, 2.394272565841675, 2.609869956970215, 1.0595887899398804, 1.4083688259124756, 1.8595356941223145, 1.1153122186660767, 5.148017406463623, 0.9133096933364868, 0.5972905158996582, 0.43907105922698975, 2.1620473861694336, 2.100620746612549, 0.45921099185943604, 2.6598458290100098, 1.547364592552185, 0.8923779726028442, 1.957993507385254, 0.42215192317962646, 1.0822824239730835, 3.3311636447906494, 3.6589038372039795, 4.366140365600586, 2.228515148162842, 1.9060660600662231, 3.313866138458252, 0.812807559967041, 1.9041420221328735, 3.5858232975006104, 1.6642895936965942, 2.4381747245788574, 2.091622829437256, 2.5582010746002197, 0.7925859689712524, 2.400578498840332, 0.12316310405731201, 0.9039639234542847, 1.8547533750534058, 2.5723536014556885, 2.002063274383545, 2.683053493499756, 1.2779277563095093, 0.5866785049438477, 0.3262512683868408, 1.8466734886169434, 2.645599842071533, 0.3813481330871582, 1.5087789297103882, 3.5155742168426514, 0.6213765144348145, 1.0793360471725464, 3.8627536296844482, 1.7345190048217773, 0.5092201232910156, 2.2446045875549316, 1.6161919832229614, 1.6795305013656616, 1.8572113513946533, 2.9642157554626465, 1.6667603254318237, 1.6284524202346802, 3.5747153759002686, 5.168709754943848, 1.5430970191955566, 2.738874912261963], "mean_td_error": 1.9022361040115356, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 46.0, "diff_num_grad_updates_vs_sampler_policy": 45.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.10774040222168, "actor_loss": -7.112881183624268, "critic_loss": 0.20143629610538483, "alpha_loss": -0.13656948506832123, "alpha_value": 0.9865794777870178, "log_alpha_value": -0.013511376455426216, "target_entropy": -6.0, "policy_t": -0.026935674250125885, "mean_q": 3.0707223415374756, "max_q": 3.5902130603790283, "min_q": 2.5674943923950195}, "td_error": [1.031720757484436, 0.6016680002212524, 3.5478310585021973, 1.963435411453247, 0.2929755449295044, 2.2962942123413086, 0.28411412239074707, 1.8213449716567993, 1.3904019594192505, 1.3692511320114136, 0.5494918823242188, 0.20574593544006348, 0.8423980474472046, 1.2583891153335571, 1.1906664371490479, 0.5948187112808228, 1.4481449127197266, 3.350827217102051, 0.9933096170425415, 0.6640341281890869, 0.256305456161499, 1.7450522184371948, 2.402647018432617, 0.9008334875106812, 1.3345292806625366, 0.6797211170196533, 0.10787427425384521, 0.7142826318740845, 0.5318272113800049, 0.8251118659973145, 0.29229938983917236, 2.219816207885742, 1.0299400091171265, 0.05167710781097412, 0.26001954078674316, 2.1309356689453125, 0.20823073387145996, 0.3547869920730591, 2.8315327167510986, 1.0272611379623413, 0.8423749208450317, 1.0121263265609741, 0.3219273090362549, 5.022305488586426, 1.3317781686782837, 0.6914980411529541, 1.1067017316818237, 0.8772940635681152, 0.9743565320968628, 1.1245272159576416, 0.9110614061355591, 1.722339153289795, 1.6355830430984497, 2.285268783569336, 0.22691786289215088, 0.7152050733566284, 0.9880383014678955, 1.0477830171585083, 0.9194117784500122, 1.3209236860275269, 1.2662009000778198, 1.5822434425354004, 0.14254820346832275, 1.736865520477295, 0.20480871200561523, 0.9338788986206055, 0.9649574756622314, 1.0503984689712524, 0.6688593626022339, 0.6812859773635864, 1.1905561685562134, 1.7966870069503784, 1.030962586402893, 0.8746703863143921, 0.2977111339569092, 1.8295258283615112, 1.374147653579712, 0.19083797931671143, 0.8691054582595825, 1.7541476488113403, 1.0339590311050415, 1.3490310907363892, 0.38250553607940674, 1.7747832536697388, 2.263301372528076, 2.9774463176727295], "mean_td_error": 1.1732604503631592, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 46.0, "diff_num_grad_updates_vs_sampler_policy": 45.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.084364891052246, "actor_loss": -7.389673233032227, "critic_loss": 0.15123838186264038, "alpha_loss": -0.13624721765518188, "alpha_value": 0.9865801334381104, "log_alpha_value": -0.013510738499462605, "target_entropy": -6.0, "policy_t": -0.020398030057549477, "mean_q": 3.3398685455322266, "max_q": 4.235455513000488, "min_q": 2.7054402828216553}, "td_error": [0.43714869022369385, 0.6488325595855713, 1.032748818397522, 1.5174832344055176, 0.8626624345779419, 0.7135426998138428, 1.4179167747497559, 1.187230110168457, 0.21983718872070312, 1.2440236806869507, 0.18449842929840088, 1.9841976165771484, 1.181383728981018, 2.682640552520752, 0.24732184410095215, 1.0168559551239014, 0.09583783149719238, 0.5620425939559937, 0.17450487613677979, 0.690804123878479, 0.9829738140106201, 0.9928337335586548, 0.8721954822540283, 0.11356151103973389, 0.8717414140701294, 0.0581974983215332, 1.6077725887298584, 1.048459529876709, 0.6582516431808472, 0.06158602237701416, 1.7262269258499146, 0.6634277105331421, 0.25566065311431885, 0.3776686191558838, 0.8508917093276978, 0.5042903423309326, 0.5364894866943359, 0.6376701593399048, 0.6897233724594116, 0.8436630964279175, 0.7612379789352417, 0.7624188661575317, 1.0715065002441406, 0.7134647369384766, 1.1535063982009888, 0.4709118604660034, 0.09616482257843018, 0.20279037952423096, 0.339680552482605, 0.08495140075683594, 0.503071665763855, 2.047114610671997, 0.2701849937438965, 0.8890336751937866, 0.9696635007858276, 1.568396806716919, 0.15156900882720947, 1.3457657098770142, 0.2046293020248413, 1.3233226537704468, 2.237776517868042, 0.37755560874938965, 0.32868218421936035, 0.8467868566513062, 1.2664885520935059, 0.5570415258407593, 0.44079267978668213, 0.22214794158935547, 1.9345728158950806, 0.9797072410583496, 2.589716911315918, 1.1445059776306152, 1.6579856872558594, 0.7666980028152466, 0.8144550323486328, 1.103143334388733, 0.2797194719314575, 0.35321784019470215, 0.7394996881484985, 1.9298979043960571, 0.8429926633834839, 1.628525733947754, 0.339150071144104, 0.5376154184341431, 1.6935696601867676, 0.19511830806732178], "mean_td_error": 0.8510644435882568, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 46.0, "diff_num_grad_updates_vs_sampler_policy": 45.0}}, "num_env_steps_sampled": 42112, "num_env_steps_trained": 11868, "num_agent_steps_sampled": 126336, "num_agent_steps_trained": 11868, "last_target_update_ts": 42112, "num_target_updates": 46}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 126336, "num_agent_steps_trained": 11868, "num_env_steps_sampled": 42112, "num_env_steps_trained": 11868, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 472.3536161148139, "num_env_steps_trained_throughput_per_sec": 136.01253678306026, "timesteps_total": 42112, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 126336, "timers": {"training_iteration_time_ms": 1922.992, "sample_time_ms": 1331.732, "load_time_ms": 0.526, "load_throughput": 490272.939, "learn_time_ms": 61.723, "learn_throughput": 4179.967, "synch_weights_time_ms": 15.811}, "counters": {"num_env_steps_sampled": 42112, "num_env_steps_trained": 11868, "num_agent_steps_sampled": 126336, "num_agent_steps_trained": 11868, "last_target_update_ts": 42112, "num_target_updates": 46}, "done": false, "episodes_total": 0, "training_iteration": 47, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-16-17", "timestamp": 1700201777, "time_this_iter_s": 1.9122319221496582, "time_total_s": 94.8466591835022, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8c89aa310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 94.8466591835022, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 65.5, "ram_util_percent": 90.59999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.055469512939453, "actor_loss": -7.756397247314453, "critic_loss": 0.802200436592102, "alpha_loss": -0.13883623480796814, "alpha_value": 0.9862878322601318, "log_alpha_value": -0.01380703505128622, "target_entropy": -6.0, "policy_t": -0.019941115751862526, "mean_q": 3.7358415126800537, "max_q": 4.563357353210449, "min_q": 3.154048204421997}, "td_error": [2.140885353088379, 2.682525157928467, 1.381563663482666, 1.5378516912460327, 2.311373710632324, 2.2817282676696777, 1.4141130447387695, 1.6819665431976318, 1.675347924232483, 3.5720603466033936, 2.0393760204315186, 1.5602871179580688, 3.40991473197937, 2.3255937099456787, 0.7635540962219238, 0.6152567863464355, 1.0273100137710571, 2.1882762908935547, 0.5788129568099976, 2.4041268825531006, 1.168340802192688, 1.3358622789382935, 0.9114125967025757, 1.3282228708267212, 1.3944483995437622, 1.7476224899291992, 3.013082265853882, 0.493732213973999, 1.0997707843780518, 1.4052382707595825, 1.2342355251312256, 2.058654308319092, 1.3816226720809937, 3.0759963989257812, 1.5318872928619385, 1.3441143035888672, 1.3643954992294312, 1.6265320777893066, 1.6340802907943726, 1.7270760536193848, 2.457785129547119, 0.4997215270996094, 2.2705087661743164, 3.078561305999756, 2.3207788467407227, 1.6989573240280151, 2.1697964668273926, 2.113856792449951, 0.5153836011886597, 1.7089817523956299, 2.3909802436828613, 3.7149181365966797, 2.3572006225585938, 1.9330083131790161, 1.5520508289337158, 3.339344024658203, 2.2750349044799805, 2.0272397994995117, 2.123805284500122, 0.648047685623169, 2.516531467437744, 2.629185199737549, 0.1612091064453125, 3.0978469848632812, 1.95999014377594, 1.343010663986206, 2.20668888092041, 1.7806147336959839, 1.8523396253585815, 0.35913658142089844, 2.361126184463501, 2.0373334884643555, 3.0997300148010254, 0.8454887866973877, 1.7509154081344604, 1.3746916055679321, 3.155174493789673, 3.9525136947631836, 1.808922290802002, 2.825390338897705, 3.974641799926758, 0.8508961200714111, 2.010222911834717, 2.406334400177002, 1.358100414276123, 2.1755547523498535], "mean_td_error": 1.9018348455429077, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 47.0, "diff_num_grad_updates_vs_sampler_policy": 46.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.100188255310059, "actor_loss": -7.292578220367432, "critic_loss": 0.15236875414848328, "alpha_loss": -0.13950057327747345, "alpha_value": 0.9862832427024841, "log_alpha_value": -0.013811682350933552, "target_entropy": -6.0, "policy_t": -0.02701660245656967, "mean_q": 3.2581772804260254, "max_q": 3.864968776702881, "min_q": 2.7598869800567627}, "td_error": [0.5830076932907104, 0.7868037223815918, 1.972669243812561, 0.27374231815338135, 0.06433284282684326, 2.0932698249816895, 0.9279161691665649, 1.0995862483978271, 2.3512978553771973, 1.7244611978530884, 0.3237522840499878, 0.7826776504516602, 1.571426510810852, 0.19566798210144043, 2.485811710357666, 0.8188064098358154, 0.18683552742004395, 0.8841906785964966, 2.154233694076538, 0.8820114135742188, 0.5541790723800659, 0.8205122947692871, 0.30112218856811523, 1.0209866762161255, 0.974678635597229, 1.273242473602295, 1.1059565544128418, 1.4515347480773926, 0.39632201194763184, 0.9328482151031494, 1.2342265844345093, 0.5448030233383179, 2.005991220474243, 1.8693645000457764, 0.4043295383453369, 0.1464163064956665, 0.5539580583572388, 2.5322041511535645, 0.8579156398773193, 1.071174144744873, 0.686103105545044, 0.5923670530319214, 0.8963618278503418, 0.36691832542419434, 0.06615757942199707, 1.812600016593933, 2.5672051906585693, 0.7419267892837524, 0.6723005771636963, 0.3040130138397217, 1.055010199546814, 0.8021811246871948, 0.8014718294143677, 0.8731886148452759, 0.14208662509918213, 2.588700532913208, 0.13583791255950928, 0.6143585443496704, 0.6773442029953003, 0.7173210382461548, 1.206156611442566, 0.3029472827911377, 1.2082167863845825, 1.8120735883712769, 0.712794303894043, 1.4296786785125732, 1.0671073198318481, 1.1531343460083008, 0.6243530511856079, 0.8190020322799683, 0.5152955055236816, 0.27835893630981445, 0.4735459089279175, 0.24921834468841553, 0.34147024154663086, 1.5808032751083374, 0.48977553844451904, 0.8639851808547974, 1.909170389175415, 0.14352571964263916, 0.5797088146209717, 0.22632086277008057, 4.470522403717041, 0.971132755279541, 0.7061371803283691, 1.4382646083831787], "mean_td_error": 0.9872140884399414, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 47.0, "diff_num_grad_updates_vs_sampler_policy": 46.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.089086532592773, "actor_loss": -7.534599304199219, "critic_loss": 0.14067047834396362, "alpha_loss": -0.13933627307415009, "alpha_value": 0.9862843155860901, "log_alpha_value": -0.013810592703521252, "target_entropy": -6.0, "policy_t": -0.03296484053134918, "mean_q": 3.521998643875122, "max_q": 4.368383884429932, "min_q": 2.8753490447998047}, "td_error": [2.222097873687744, 0.24555230140686035, 0.10642051696777344, 3.184725761413574, 0.28656184673309326, 1.9852995872497559, 0.37135815620422363, 1.1141268014907837, 0.14201021194458008, 1.332594633102417, 0.6375373601913452, 2.174982786178589, 0.14356887340545654, 1.6208566427230835, 0.3282790184020996, 0.7864224910736084, 0.5126669406890869, 0.5008277893066406, 0.23601996898651123, 0.48432111740112305, 0.07938337326049805, 2.1848959922790527, 0.577985405921936, 0.21770703792572021, 0.7205766439437866, 0.4668477773666382, 0.38138318061828613, 1.5275423526763916, 0.680145263671875, 2.0321969985961914, 0.8812048435211182, 1.1375812292099, 0.3147233724594116, 0.274031400680542, 1.0550494194030762, 1.2653851509094238, 0.2882450819015503, 0.716200590133667, 1.4614781141281128, 0.5542902946472168, 0.1616424322128296, 0.1859426498413086, 1.152189016342163, 0.5059469938278198, 0.7526906728744507, 1.320137858390808, 1.4646058082580566, 1.6791222095489502, 0.6217806339263916, 0.5516293048858643, 0.9752839803695679, 0.5799713134765625, 0.6238125562667847, 0.8547070026397705, 0.6434793472290039, 0.9888409376144409, 0.8941526412963867, 0.9490330219268799, 1.1455844640731812, 0.13344120979309082, 0.4853321313858032, 0.7016255855560303, 0.24447786808013916, 0.15132665634155273, 2.036494731903076, 0.3596913814544678, 0.4679081439971924, 1.0971970558166504, 0.8391927480697632, 1.133872389793396, 0.2839529514312744, 1.0995122194290161, 0.7185029983520508, 0.21439075469970703, 0.0633702278137207, 0.10950756072998047, 0.6276981830596924, 0.5578395128250122, 1.0039958953857422, 0.4475870132446289, 1.2658940553665161, 0.37105441093444824, 0.4009658098220825, 0.9903326034545898, 1.8440165519714355, 0.17581415176391602], "mean_td_error": 0.8035886883735657, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 47.0, "diff_num_grad_updates_vs_sampler_policy": 46.0}}, "num_env_steps_sampled": 43008, "num_env_steps_trained": 12126, "num_agent_steps_sampled": 129024, "num_agent_steps_trained": 12126, "last_target_update_ts": 43008, "num_target_updates": 47}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 129024, "num_agent_steps_trained": 12126, "num_env_steps_sampled": 43008, "num_env_steps_trained": 12126, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 473.104650632884, "num_env_steps_trained_throughput_per_sec": 136.2287944902724, "timesteps_total": 43008, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 129024, "timers": {"training_iteration_time_ms": 1889.684, "sample_time_ms": 1326.809, "load_time_ms": 0.526, "load_throughput": 490384.027, "learn_time_ms": 61.769, "learn_throughput": 4176.828, "synch_weights_time_ms": 15.931}, "counters": {"num_env_steps_sampled": 43008, "num_env_steps_trained": 12126, "num_agent_steps_sampled": 129024, "num_agent_steps_trained": 12126, "last_target_update_ts": 43008, "num_target_updates": 47}, "done": false, "episodes_total": 0, "training_iteration": 48, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-16-19", "timestamp": 1700201779, "time_this_iter_s": 1.9095408916473389, "time_total_s": 96.75620007514954, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8aa4ca9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 96.75620007514954, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 88.0, "ram_util_percent": 90.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.133649826049805, "actor_loss": -8.020306587219238, "critic_loss": 0.6166030764579773, "alpha_loss": -0.1429591029882431, "alpha_value": 0.9859916567802429, "log_alpha_value": -0.014107364229857922, "target_entropy": -6.0, "policy_t": 0.018622271716594696, "mean_q": 3.894474506378174, "max_q": 4.766256809234619, "min_q": 3.1486928462982178}, "td_error": [2.1101465225219727, 1.6803438663482666, 2.375359058380127, 0.5531797409057617, 0.27315807342529297, 0.3226362466812134, 2.036956548690796, 2.0125319957733154, 2.4100332260131836, 2.968708038330078, 1.1831392049789429, 1.628857135772705, 0.9846310615539551, 3.1493473052978516, 1.5838574171066284, 1.2809429168701172, 3.0063204765319824, 0.6892268657684326, 2.0356249809265137, 1.6166300773620605, 2.439183235168457, 3.636770248413086, 0.5729423761367798, 2.5401854515075684, 1.5717391967773438, 0.41751396656036377, 0.9022674560546875, 0.5785902738571167, 2.825418710708618, 1.458828330039978, 1.9684723615646362, 0.5174521207809448, 1.2763545513153076, 1.7723642587661743, 1.96293044090271, 2.3883395195007324, 1.001920461654663, 0.26889050006866455, 0.36391782760620117, 2.0699422359466553, 1.6199454069137573, 1.3503227233886719, 0.6445481777191162, 1.12815523147583, 1.048940658569336, 1.2860504388809204, 2.846975564956665, 0.2926003932952881, 1.563889503479004, 0.6003719568252563, 2.297995090484619, 0.08358502388000488, 0.37819361686706543, 1.6941664218902588, 1.2396730184555054, 2.177746295928955, 1.049117088317871, 1.8573648929595947, 0.493837833404541, 2.4220097064971924, 1.636354684829712, 0.9841809272766113, 1.8495718240737915, 1.6239384412765503, 0.10069894790649414, 2.369921922683716, 1.7210536003112793, 0.9784488677978516, 1.3236103057861328, 2.311715602874756, 1.6749169826507568, 1.8628495931625366, 2.1553726196289062, 4.059445858001709, 3.168686866760254, 0.6042903661727905, 0.2540912628173828, 2.164839506149292, 0.5531084537506104, 2.4767913818359375, 2.073068618774414, 1.4024852514266968, 3.121765613555908, 0.34169018268585205, 1.346521258354187, 0.5048775672912598], "mean_td_error": 1.5485516786575317, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 48.0, "diff_num_grad_updates_vs_sampler_policy": 47.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.074258804321289, "actor_loss": -7.425025939941406, "critic_loss": 0.13618901371955872, "alpha_loss": -0.1421678513288498, "alpha_value": 0.98598712682724, "log_alpha_value": -0.014111990109086037, "target_entropy": -6.0, "policy_t": 0.009154099971055984, "mean_q": 3.4490270614624023, "max_q": 4.124763011932373, "min_q": 2.829416275024414}, "td_error": [1.1900644302368164, 0.6008377075195312, 1.8412150144577026, 0.8130291700363159, 2.330631732940674, 0.21765410900115967, 1.5078920125961304, 1.0166661739349365, 0.5933715105056763, 1.9710084199905396, 1.8336501121520996, 0.42997705936431885, 2.0559945106506348, 0.12578284740447998, 0.4300287961959839, 0.3508892059326172, 0.5456023216247559, 1.3189421892166138, 0.9390627145767212, 0.5246280431747437, 0.9444841146469116, 0.1747887134552002, 0.15717554092407227, 0.6158784627914429, 0.4486793279647827, 1.6223279237747192, 0.18482732772827148, 0.18173420429229736, 1.7559438943862915, 1.435981273651123, 1.1290850639343262, 0.193700909614563, 0.682999849319458, 0.3597531318664551, 0.7865808010101318, 2.2203195095062256, 0.27788102626800537, 0.09934496879577637, 1.8249002695083618, 1.123599648475647, 0.46634018421173096, 0.38531315326690674, 0.16619014739990234, 0.21634304523468018, 0.6154453754425049, 1.7849160432815552, 0.2689117193222046, 2.0088131427764893, 0.7774918079376221, 0.39502549171447754, 1.0114061832427979, 1.411269187927246, 0.25765979290008545, 0.2812713384628296, 0.4865152835845947, 0.6487798690795898, 0.8096864223480225, 1.293532133102417, 0.5890063047409058, 1.2320855855941772, 0.19930696487426758, 2.1051902770996094, 0.498241662979126, 0.1519683599472046, 0.3175539970397949, 0.9201455116271973, 0.9356205463409424, 0.05938565731048584, 2.295450210571289, 1.2283369302749634, 0.9951094388961792, 0.1821373701095581, 2.295624256134033, 0.4226123094558716, 0.9857935905456543, 0.2687821388244629, 1.9770699739456177, 0.5720062255859375, 0.18991386890411377, 1.8309680223464966, 0.4859963655471802, 0.3106313943862915, 0.4188227653503418, 0.7420146465301514, 0.41212034225463867, 1.353325605392456], "mean_td_error": 0.8618261814117432, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 48.0, "diff_num_grad_updates_vs_sampler_policy": 47.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.050739288330078, "actor_loss": -7.707765102386475, "critic_loss": 0.14528542757034302, "alpha_loss": -0.14182049036026, "alpha_value": 0.9859886169433594, "log_alpha_value": -0.014110454358160496, "target_entropy": -6.0, "policy_t": 0.03249606117606163, "mean_q": 3.6388254165649414, "max_q": 4.369466304779053, "min_q": 2.889080762863159}, "td_error": [0.19306468963623047, 0.5184506177902222, 1.805358648300171, 0.3017009496688843, 1.680617094039917, 0.7287887334823608, 1.8181549310684204, 0.5778908729553223, 0.2652456760406494, 0.8832036256790161, 0.7526949644088745, 1.529425024986267, 0.7305710315704346, 1.1971427202224731, 0.1871281862258911, 0.28114914894104004, 0.795111894607544, 0.2604433298110962, 0.03393840789794922, 0.34313905239105225, 0.35233330726623535, 0.7914888858795166, 3.143214464187622, 1.20399010181427, 1.4776263236999512, 0.5794832706451416, 0.1735854148864746, 0.3185213804244995, 0.30832910537719727, 0.5005326271057129, 0.6403764486312866, 1.042993426322937, 0.9633997678756714, 0.7562875747680664, 0.6080940961837769, 0.4591357707977295, 1.8360148668289185, 1.597720742225647, 0.4985694885253906, 0.18362975120544434, 0.8921382427215576, 0.208817720413208, 0.26422274112701416, 1.787540078163147, 1.5888140201568604, 0.10579383373260498, 0.7595410346984863, 0.3958883285522461, 0.30933618545532227, 0.9603780508041382, 3.0781712532043457, 0.4346351623535156, 0.8096704483032227, 0.23597586154937744, 0.5038918256759644, 1.8396837711334229, 0.4905005693435669, 0.16207563877105713, 1.4445658922195435, 0.9275411367416382, 1.021510124206543, 0.403957724571228, 1.106946587562561, 0.2864469289779663, 1.596118450164795, 1.021128535270691, 0.44967758655548096, 0.6599278450012207, 0.47670722007751465, 1.3179534673690796, 1.0959863662719727, 0.7122535705566406, 1.560486078262329, 1.0911821126937866, 0.44881677627563477, 0.06545650959014893, 1.6482716798782349, 0.4123612642288208, 0.5673255920410156, 1.0519814491271973, 0.27916431427001953, 0.7108863592147827, 1.107975721359253, 0.8206064701080322, 0.2317500114440918, 1.7672988176345825], "mean_td_error": 0.8305803537368774, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 48.0, "diff_num_grad_updates_vs_sampler_policy": 47.0}}, "num_env_steps_sampled": 43904, "num_env_steps_trained": 12384, "num_agent_steps_sampled": 131712, "num_agent_steps_trained": 12384, "last_target_update_ts": 43904, "num_target_updates": 48}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 131712, "num_agent_steps_trained": 12384, "num_env_steps_sampled": 43904, "num_env_steps_trained": 12384, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 479.57603197125576, "num_env_steps_trained_throughput_per_sec": 138.09220563458035, "timesteps_total": 43904, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 131712, "timers": {"training_iteration_time_ms": 1893.597, "sample_time_ms": 1330.531, "load_time_ms": 0.527, "load_throughput": 489895.619, "learn_time_ms": 61.736, "learn_throughput": 4179.096, "synch_weights_time_ms": 15.606}, "counters": {"num_env_steps_sampled": 43904, "num_env_steps_trained": 12384, "num_agent_steps_sampled": 131712, "num_agent_steps_trained": 12384, "last_target_update_ts": 43904, "num_target_updates": 48}, "done": false, "episodes_total": 0, "training_iteration": 49, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-16-21", "timestamp": 1700201781, "time_this_iter_s": 1.882951021194458, "time_total_s": 98.639151096344, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8c8977f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 98.639151096344, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 64.5, "ram_util_percent": 90.59999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.132135391235352, "actor_loss": -8.221939086914062, "critic_loss": 0.5388201475143433, "alpha_loss": -0.14598143100738525, "alpha_value": 0.9856955409049988, "log_alpha_value": -0.014407766051590443, "target_entropy": -6.0, "policy_t": 0.044159185141325, "mean_q": 4.134271144866943, "max_q": 5.0186543464660645, "min_q": 3.3745994567871094}, "td_error": [1.2736611366271973, 0.7729787826538086, 1.5681359767913818, 1.6906541585922241, 1.583141803741455, 1.0290274620056152, 2.4700636863708496, 0.30304408073425293, 0.7724311351776123, 1.1296169757843018, 0.42808055877685547, 1.4049055576324463, 1.2242944240570068, 0.9638891220092773, 0.5552523136138916, 3.493074417114258, 3.158461570739746, 1.1153194904327393, 2.037497043609619, 1.3899339437484741, 2.1091744899749756, 1.7405900955200195, 2.4090981483459473, 1.5693533420562744, 1.2640275955200195, 0.5968711376190186, 2.8809289932250977, 0.544569730758667, 0.6951743364334106, 1.1001076698303223, 1.967958927154541, 3.6635632514953613, 1.4829169511795044, 0.9432306289672852, 1.305276870727539, 0.8598883152008057, 0.4598715305328369, 0.3741931915283203, 0.815701961517334, 0.6456239223480225, 0.33044910430908203, 2.7504258155822754, 1.7039284706115723, 3.370412588119507, 1.5165691375732422, 0.5708160400390625, 0.2991478443145752, 3.479954481124878, 1.7200376987457275, 1.9451980590820312, 1.059281587600708, 1.1514456272125244, 1.477506160736084, 1.9286823272705078, 2.458700656890869, 1.6541328430175781, 0.8946952819824219, 1.9610984325408936, 3.5184502601623535, 2.770017385482788, 1.381546974182129, 2.457326650619507, 0.09207987785339355, 0.603989839553833, 2.8346991539001465, 1.074186086654663, 1.6955642700195312, 2.038429021835327, 1.320512056350708, 2.097907066345215, 0.3591005802154541, 1.416436791419983, 2.901766061782837, 1.5390129089355469, 1.4497766494750977, 0.20177555084228516, 2.3505699634552, 0.04944348335266113, 0.522700309753418, 0.8838075399398804, 0.6705576181411743, 2.346259117126465, 2.6888022422790527, 0.7000610828399658, 2.6252434253692627, 2.2658753395080566], "mean_td_error": 1.522325038909912, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 49.0, "diff_num_grad_updates_vs_sampler_policy": 48.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.07505989074707, "actor_loss": -7.599404811859131, "critic_loss": 0.10531289875507355, "alpha_loss": -0.14520412683486938, "alpha_value": 0.9856911301612854, "log_alpha_value": -0.014412237331271172, "target_entropy": -6.0, "policy_t": -0.04765203967690468, "mean_q": 3.570728063583374, "max_q": 4.108973026275635, "min_q": 3.09547758102417}, "td_error": [0.2773789167404175, 0.794477105140686, 0.08194291591644287, 0.72892165184021, 0.2251652479171753, 0.9065383672714233, 0.11175477504730225, 0.22841644287109375, 1.4221348762512207, 0.7426116466522217, 2.292417049407959, 1.5491888523101807, 0.2732241153717041, 0.5733635425567627, 0.4381132125854492, 1.4829014539718628, 0.37499165534973145, 0.32881832122802734, 1.4965919256210327, 0.2241448163986206, 1.009793996810913, 1.2162898778915405, 0.8549431562423706, 0.2308664321899414, 0.34915006160736084, 1.3766286373138428, 0.7064768075942993, 0.723811149597168, 0.2823411226272583, 0.3347717523574829, 0.7086470127105713, 0.7548888921737671, 1.877178430557251, 0.1920945644378662, 0.6729891300201416, 0.30225419998168945, 0.11999070644378662, 0.44258153438568115, 0.5252423286437988, 0.9245810508728027, 0.5306320190429688, 0.20159876346588135, 1.3779016733169556, 0.9789693355560303, 1.5368320941925049, 0.9449965953826904, 0.6096668243408203, 0.6558866500854492, 1.3083710670471191, 0.14512860774993896, 0.9237804412841797, 0.5803713798522949, 0.3407633304595947, 0.6087315082550049, 0.707832932472229, 0.06832373142242432, 0.3160440921783447, 0.8447884321212769, 0.29178106784820557, 2.133151054382324, 1.2883625030517578, 1.0558114051818848, 0.908409595489502, 1.3882510662078857, 0.11425471305847168, 0.25085365772247314, 0.6831636428833008, 1.527684211730957, 0.27391064167022705, 0.5447903871536255, 1.0010919570922852, 0.3557436466217041, 0.21961474418640137, 0.22906076908111572, 3.523721933364868, 1.3645684719085693, 1.3462097644805908, 0.8917858600616455, 0.7881267070770264, 0.8091715574264526, 0.3141653537750244, 0.22123432159423828, 0.05558419227600098, 1.8937883377075195, 0.38083863258361816, 0.1618196964263916], "mean_td_error": 0.7541416883468628, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 49.0, "diff_num_grad_updates_vs_sampler_policy": 48.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.140706062316895, "actor_loss": -7.862472057342529, "critic_loss": 0.14077287912368774, "alpha_loss": -0.14612993597984314, "alpha_value": 0.985693097114563, "log_alpha_value": -0.014410232193768024, "target_entropy": -6.0, "policy_t": 0.027186067774891853, "mean_q": 3.8621339797973633, "max_q": 4.891790390014648, "min_q": 3.1315536499023438}, "td_error": [0.1749194860458374, 0.36652207374572754, 1.9168846607208252, 1.0177404880523682, 0.12395954132080078, 1.4011962413787842, 1.8882386684417725, 0.13951539993286133, 1.3019145727157593, 0.2266099452972412, 0.4901162385940552, 0.33202362060546875, 0.6766200065612793, 0.9571230411529541, 0.0637669563293457, 0.7605438232421875, 0.42800307273864746, 0.5938748121261597, 0.14348268508911133, 0.804497241973877, 0.9216722249984741, 1.2894351482391357, 0.2820488214492798, 0.5673401355743408, 2.985616683959961, 0.5850952863693237, 0.39622199535369873, 2.209059715270996, 0.10765063762664795, 1.1625288724899292, 0.8591514825820923, 0.924067497253418, 0.07182025909423828, 1.2407841682434082, 0.7519252300262451, 0.6851975917816162, 0.18345439434051514, 0.1273634433746338, 1.0016334056854248, 1.6610352993011475, 0.7154302597045898, 1.4110863208770752, 0.5985302925109863, 1.1346237659454346, 1.3704009056091309, 0.4885770082473755, 0.5115667581558228, 1.3168686628341675, 0.19191408157348633, 1.675919532775879, 0.7735850811004639, 2.0758183002471924, 0.620853066444397, 1.2580482959747314, 0.17123985290527344, 1.507664442062378, 0.2996542453765869, 0.27988576889038086, 1.1471068859100342, 1.0106136798858643, 0.3048877716064453, 1.6896698474884033, 0.4250521659851074, 2.741539478302002, 1.1849647760391235, 0.6666197776794434, 1.4897778034210205, 0.2825968265533447, 0.24995994567871094, 0.7059258222579956, 0.7586562633514404, 0.21763324737548828, 1.0552923679351807, 0.3390216827392578, 1.123584508895874, 0.7940661907196045, 0.17688989639282227, 0.30822646617889404, 0.5064449310302734, 0.7683302164077759, 0.5902771949768066, 0.7007914781570435, 0.7265458106994629, 0.24851810932159424, 0.4583001136779785, 0.7769079208374023], "mean_td_error": 0.8101223111152649, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 49.0, "diff_num_grad_updates_vs_sampler_policy": 48.0}}, "num_env_steps_sampled": 44800, "num_env_steps_trained": 12642, "num_agent_steps_sampled": 134400, "num_agent_steps_trained": 12642, "last_target_update_ts": 44800, "num_target_updates": 49}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 134400, "num_agent_steps_trained": 12642, "num_env_steps_sampled": 44800, "num_env_steps_trained": 12642, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 469.23749913065933, "num_env_steps_trained_throughput_per_sec": 135.11526202646218, "timesteps_total": 44800, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 134400, "timers": {"training_iteration_time_ms": 1896.942, "sample_time_ms": 1333.945, "load_time_ms": 0.526, "load_throughput": 490073.109, "learn_time_ms": 61.644, "learn_throughput": 4185.353, "synch_weights_time_ms": 15.623}, "counters": {"num_env_steps_sampled": 44800, "num_env_steps_trained": 12642, "num_agent_steps_sampled": 134400, "num_agent_steps_trained": 12642, "last_target_update_ts": 44800, "num_target_updates": 49}, "done": false, "episodes_total": 0, "training_iteration": 50, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-16-23", "timestamp": 1700201783, "time_this_iter_s": 1.9250352382659912, "time_total_s": 100.56418633460999, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8c8afb940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 100.56418633460999, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 67.8, "ram_util_percent": 90.59999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.00932788848877, "actor_loss": -8.40267562866211, "critic_loss": 0.33938735723495483, "alpha_loss": -0.1472194641828537, "alpha_value": 0.9853994250297546, "log_alpha_value": -0.014708227477967739, "target_entropy": -6.0, "policy_t": 0.014414265751838684, "mean_q": 4.362964153289795, "max_q": 5.318071365356445, "min_q": 3.5139071941375732}, "td_error": [1.2831194400787354, 2.170121669769287, 1.4248030185699463, 1.7796876430511475, 0.6297914981842041, 1.895033836364746, 0.08269691467285156, 0.3017079830169678, 0.5387735366821289, 1.4588539600372314, 0.5135965347290039, 0.27886080741882324, 1.1596070528030396, 0.5763311386108398, 0.3581596612930298, 0.32455992698669434, 0.5213654041290283, 1.1185568571090698, 1.5140931606292725, 1.3887994289398193, 0.1982262134552002, 1.656644582748413, 0.36893248558044434, 0.09577107429504395, 0.4608285427093506, 1.1395496129989624, 0.5241808891296387, 2.0294129848480225, 0.5418858528137207, 0.8082082271575928, 0.6152904033660889, 2.0045628547668457, 1.931730031967163, 1.7558245658874512, 1.7238004207611084, 0.5566892623901367, 2.5851545333862305, 0.7238070964813232, 0.4175851345062256, 2.0735082626342773, 0.7736475467681885, 0.7857139110565186, 1.33231782913208, 0.5182645320892334, 1.562691569328308, 1.1155954599380493, 0.7546026706695557, 0.7064914703369141, 1.409602403640747, 0.6145923137664795, 1.3838090896606445, 0.10938692092895508, 0.9409635066986084, 2.1658902168273926, 2.8514933586120605, 1.9398771524429321, 1.3273890018463135, 0.8407213687896729, 0.13856959342956543, 0.35771965980529785, 0.871204137802124, 1.2400853633880615, 0.45653223991394043, 0.490842342376709, 1.7963688373565674, 1.7448670864105225, 0.241868257522583, 1.3312253952026367, 2.565694570541382, 0.7919745445251465, 0.5390822887420654, 1.4732260704040527, 1.0997288227081299, 0.39298808574676514, 2.1348581314086914, 0.8742058277130127, 2.0133450031280518, 0.31050539016723633, 2.1006999015808105, 1.5034499168395996, 3.7686994075775146, 1.9775502681732178, 1.0944468975067139, 1.9901878833770752, 0.0782623291015625, 0.4720652103424072], "mean_td_error": 1.1222491264343262, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 50.0, "diff_num_grad_updates_vs_sampler_policy": 49.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.071487426757812, "actor_loss": -7.754884719848633, "critic_loss": 0.15413165092468262, "alpha_loss": -0.14817608892917633, "alpha_value": 0.9853952527046204, "log_alpha_value": -0.014712433330714703, "target_entropy": -6.0, "policy_t": 0.015654612332582474, "mean_q": 3.752176284790039, "max_q": 4.534568786621094, "min_q": 3.0532267093658447}, "td_error": [1.8724652528762817, 1.1911261081695557, 0.704912543296814, 0.06041550636291504, 1.3056975603103638, 1.0973033905029297, 1.2212330102920532, 2.6212408542633057, 1.2540695667266846, 0.6242828369140625, 0.41998291015625, 0.5615381002426147, 1.851657509803772, 1.8012267351150513, 0.5699782371520996, 0.3458503484725952, 0.1146705150604248, 0.3813132047653198, 1.2938203811645508, 0.998254656791687, 0.8351513147354126, 0.6514308452606201, 1.537369728088379, 2.1426100730895996, 0.8931705951690674, 0.3408937454223633, 1.1505035161972046, 0.8059176206588745, 0.4401034116744995, 0.2552734613418579, 0.22537565231323242, 0.13983237743377686, 1.4104588031768799, 1.5948505401611328, 0.2354370355606079, 1.722916603088379, 2.3510031700134277, 0.35922372341156006, 0.5943228006362915, 0.7682260274887085, 1.1316570043563843, 0.6568307876586914, 2.0817036628723145, 1.3022247552871704, 1.073721170425415, 0.10060465335845947, 1.0773165225982666, 0.38229334354400635, 0.8882923126220703, 1.2058212757110596, 1.073875904083252, 1.4233766794204712, 2.5791280269622803, 0.4501926898956299, 2.80828857421875, 0.44283199310302734, 0.7940882444381714, 1.329066514968872, 0.6088341474533081, 1.0795371532440186, 0.2268688678741455, 0.09212446212768555, 0.5531574487686157, 0.6430753469467163, 1.1164950132369995, 2.633610248565674, 0.577207088470459, 0.7478790283203125, 0.04863154888153076, 0.6224948167800903, 1.0635275840759277, 0.5977733135223389, 1.3479706048965454, 1.4827649593353271, 0.615074634552002, 0.418237566947937, 1.6390732526779175, 0.23031914234161377, 1.816226601600647, 0.26623451709747314, 1.4577242136001587, 0.5171120166778564, 1.016260027885437, 0.2452448606491089, 1.8771616220474243, 0.17642927169799805], "mean_td_error": 0.9681799411773682, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 50.0, "diff_num_grad_updates_vs_sampler_policy": 49.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.04681396484375, "actor_loss": -7.964449882507324, "critic_loss": 0.19086229801177979, "alpha_loss": -0.14779013395309448, "alpha_value": 0.9853975176811218, "log_alpha_value": -0.01471014879643917, "target_entropy": -6.0, "policy_t": 0.004007976967841387, "mean_q": 3.9867424964904785, "max_q": 5.334986209869385, "min_q": 3.13509464263916}, "td_error": [1.178887128829956, 1.1146948337554932, 0.2808823585510254, 1.0450530052185059, 0.9961267709732056, 0.32628118991851807, 0.3585836887359619, 3.279862880706787, 0.18665945529937744, 0.24353408813476562, 1.040271520614624, 0.4145932197570801, 1.1505131721496582, 2.6108510494232178, 0.3220975399017334, 0.2957063913345337, 0.15350735187530518, 0.6590094566345215, 1.4478886127471924, 0.027127861976623535, 1.0160949230194092, 0.5312105417251587, 0.2553788423538208, 1.4251304864883423, 0.252315878868103, 0.5489227771759033, 1.1826411485671997, 0.3707454204559326, 0.39366793632507324, 0.5143871307373047, 0.43357348442077637, 0.9855937957763672, 1.9053964614868164, 1.688614845275879, 0.40320682525634766, 0.13512182235717773, 1.3191008567810059, 1.4056556224822998, 0.566430926322937, 0.6423385143280029, 0.239577054977417, 0.10013926029205322, 1.2701365947723389, 0.44661521911621094, 0.5263245105743408, 0.8041894435882568, 1.7222357988357544, 1.3337351083755493, 0.38255369663238525, 1.5091221332550049, 1.8017926216125488, 2.02006196975708, 2.1793324947357178, 2.015854597091675, 0.4064643383026123, 0.49758172035217285, 2.400951385498047, 0.5361719131469727, 1.094388484954834, 2.776371955871582, 0.32700419425964355, 1.6921792030334473, 1.887695550918579, 2.1785128116607666, 2.1425528526306152, 0.2590517997741699, 0.5630743503570557, 0.9711061716079712, 1.291379690170288, 0.1753065586090088, 0.5569460391998291, 0.17009305953979492, 1.4730806350708008, 1.930295705795288, 1.6539027690887451, 1.4110124111175537, 1.7859246730804443, 0.39512550830841064, 0.41573095321655273, 0.23552751541137695, 0.322399377822876, 0.21903657913208008, 0.9128037691116333, 1.1717119216918945, 1.1130926609039307, 1.0834242105484009], "mean_td_error": 0.9710375666618347, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 50.0, "diff_num_grad_updates_vs_sampler_policy": 49.0}}, "num_env_steps_sampled": 45696, "num_env_steps_trained": 12900, "num_agent_steps_sampled": 137088, "num_agent_steps_trained": 12900, "last_target_update_ts": 45696, "num_target_updates": 50}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 137088, "num_agent_steps_trained": 12900, "num_env_steps_sampled": 45696, "num_env_steps_trained": 12900, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 384.24327885459587, "num_env_steps_trained_throughput_per_sec": 110.6414798487564, "timesteps_total": 45696, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 137088, "timers": {"training_iteration_time_ms": 1935.753, "sample_time_ms": 1336.596, "load_time_ms": 0.532, "load_throughput": 485282.045, "learn_time_ms": 61.602, "learn_throughput": 4188.192, "synch_weights_time_ms": 15.873}, "counters": {"num_env_steps_sampled": 45696, "num_env_steps_trained": 12900, "num_agent_steps_sampled": 137088, "num_agent_steps_trained": 12900, "last_target_update_ts": 45696, "num_target_updates": 50}, "done": false, "episodes_total": 0, "training_iteration": 51, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-16-26", "timestamp": 1700201786, "time_this_iter_s": 2.346987009048462, "time_total_s": 102.91117334365845, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8aa4ca8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 102.91117334365845, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 73.6, "ram_util_percent": 90.59999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.073505401611328, "actor_loss": -8.578240394592285, "critic_loss": 0.34719207882881165, "alpha_loss": -0.1511877030134201, "alpha_value": 0.9851036071777344, "log_alpha_value": -0.015008448623120785, "target_entropy": -6.0, "policy_t": -0.011152314022183418, "mean_q": 4.541400909423828, "max_q": 5.261769771575928, "min_q": 3.735417604446411}, "td_error": [1.2975044250488281, 1.1707239151000977, 1.6596691608428955, 1.2585914134979248, 1.0746411085128784, 0.714771032333374, 0.4812767505645752, 1.1393992900848389, 2.713948965072632, 1.2532105445861816, 1.1291422843933105, 2.1723155975341797, 1.6122314929962158, 1.2922873497009277, 0.8476016521453857, 1.3388965129852295, 2.253814220428467, 0.946415901184082, 0.28748655319213867, 0.758803129196167, 0.9041972160339355, 1.4972684383392334, 0.38327980041503906, 0.1443922519683838, 1.187891960144043, 0.321671724319458, 2.183048725128174, 0.7465057373046875, 2.1072378158569336, 2.056938409805298, 0.5506243705749512, 0.663323163986206, 2.3070566654205322, 0.5423398017883301, 0.6304666996002197, 0.4459397792816162, 1.088555097579956, 4.257985591888428, 1.3182506561279297, 4.472495079040527, 0.7216567993164062, 0.9143643379211426, 1.1668012142181396, 2.2983269691467285, 0.6497182846069336, 0.6201591491699219, 2.126681089401245, 0.42484569549560547, 1.332397699356079, 0.71533203125, 1.9397013187408447, 2.0583248138427734, 1.4183435440063477, 0.4585850238800049, 0.9513132572174072, 0.20347070693969727, 1.3467819690704346, 1.0406746864318848, 1.5452070236206055, 0.9706878662109375, 0.6971273422241211, 0.13625311851501465, 1.9785678386688232, 1.3582870960235596, 2.9809389114379883, 0.4939534664154053, 1.650648593902588, 0.9331493377685547, 1.7048051357269287, 0.6177597045898438, 1.0585763454437256, 0.8306577205657959, 1.5738294124603271, 0.5993115901947021, 0.43526744842529297, 0.8852730989456177, 0.9547431468963623, 0.463364839553833, 0.7824254035949707, 0.4414336681365967, 1.3864014148712158, 1.5865166187286377, 0.276747465133667, 0.12834739685058594, 1.971541166305542, 0.2732264995574951], "mean_td_error": 1.1897062063217163, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 51.0, "diff_num_grad_updates_vs_sampler_policy": 50.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.023130416870117, "actor_loss": -7.874038219451904, "critic_loss": 0.13014733791351318, "alpha_loss": -0.1504729688167572, "alpha_value": 0.9850995540618896, "log_alpha_value": -0.015012574382126331, "target_entropy": -6.0, "policy_t": 0.0015886707697063684, "mean_q": 3.8848721981048584, "max_q": 4.472599506378174, "min_q": 3.356771230697632}, "td_error": [2.7101807594299316, 2.385016441345215, 0.2947133779525757, 0.8716213703155518, 0.8919988870620728, 0.4090614318847656, 1.7493219375610352, 0.2469865083694458, 0.687511682510376, 0.20445740222930908, 2.1494555473327637, 0.7379148006439209, 0.4771106243133545, 0.8485515117645264, 1.5864579677581787, 0.6095287799835205, 0.5077017545700073, 0.1659010648727417, 1.9490900039672852, 0.6403424739837646, 1.0170730352401733, 1.0270061492919922, 0.3043937683105469, 0.5921241044998169, 0.1272428035736084, 0.3292813301086426, 1.909935474395752, 0.15143275260925293, 0.983758807182312, 0.4773228168487549, 1.70271897315979, 0.30088698863983154, 1.942946195602417, 0.14958786964416504, 0.9429266452789307, 0.7950401306152344, 0.22435259819030762, 0.24937200546264648, 0.8867733478546143, 1.8342885971069336, 1.7272872924804688, 0.905742883682251, 1.0399682521820068, 0.1875133514404297, 0.7328317165374756, 1.5636388063430786, 0.1410672664642334, 1.0153822898864746, 0.15569639205932617, 0.11051273345947266, 0.3102535009384155, 0.41060614585876465, 0.6039369106292725, 0.17246794700622559, 1.7452436685562134, 0.6606537103652954, 0.2967902421951294, 0.1493436098098755, 0.24760353565216064, 1.7043375968933105, 1.5862455368041992, 0.20074677467346191, 0.7198807001113892, 0.6118243932723999, 1.846028447151184, 1.2371193170547485, 0.11795902252197266, 2.4101641178131104, 0.7028794288635254, 0.2951507568359375, 0.8023960590362549, 0.768769383430481, 0.2930793762207031, 0.48223328590393066, 1.229828119277954, 0.7394659519195557, 1.3325159549713135, 1.000996470451355, 1.1444681882858276, 0.8236386775970459, 1.2528071403503418, 0.12430596351623535, 1.6753504276275635, 0.8163809776306152, 0.3905426263809204, 0.29595184326171875], "mean_td_error": 0.8471278548240662, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 51.0, "diff_num_grad_updates_vs_sampler_policy": 50.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.092427253723145, "actor_loss": -8.120081901550293, "critic_loss": 0.17005571722984314, "alpha_loss": -0.15148697793483734, "alpha_value": 0.985102117061615, "log_alpha_value": -0.015009965747594833, "target_entropy": -6.0, "policy_t": -0.00534155685454607, "mean_q": 4.037567615509033, "max_q": 5.047379493713379, "min_q": 3.382478713989258}, "td_error": [0.2718740701675415, 2.6377899646759033, 1.7860636711120605, 0.2278883457183838, 0.5773944854736328, 0.10271942615509033, 1.282454490661621, 1.3626786470413208, 0.11055135726928711, 0.379749059677124, 0.7961852550506592, 0.6716899871826172, 2.3694095611572266, 0.5156691074371338, 1.1361483335494995, 0.28662586212158203, 0.352398157119751, 1.328944206237793, 0.9582505226135254, 0.7258208990097046, 0.5160746574401855, 0.16325807571411133, 1.7704625129699707, 2.3575010299682617, 0.6273523569107056, 1.4902983903884888, 0.21695971488952637, 0.47043633460998535, 0.8362958431243896, 1.8232910633087158, 0.11549162864685059, 1.651871681213379, 0.9549905061721802, 0.2611914873123169, 1.1514681577682495, 0.14684772491455078, 1.1712510585784912, 0.7705601453781128, 0.301605224609375, 0.281488299369812, 0.699245810508728, 1.5874122381210327, 0.6479201316833496, 1.0983026027679443, 0.0819249153137207, 0.796120285987854, 2.3497321605682373, 0.5615851879119873, 1.426520586013794, 2.8767621517181396, 0.1507866382598877, 0.2702522277832031, 0.625805139541626, 1.3891468048095703, 0.437485933303833, 1.1857595443725586, 1.0814851522445679, 1.3778905868530273, 0.34622979164123535, 0.2851853370666504, 0.8457467555999756, 0.46859538555145264, 1.3192596435546875, 1.8088202476501465, 0.20934319496154785, 0.9355447292327881, 0.5517046451568604, 1.7779275178909302, 0.37902212142944336, 0.5181386470794678, 1.8355485200881958, 0.4914538860321045, 0.43671274185180664, 0.4185667037963867, 1.1503838300704956, 0.32924866676330566, 0.2946155071258545, 1.8177169561386108, 1.2958449125289917, 1.715456247329712, 0.3320741653442383, 0.8617000579833984, 1.8513257503509521, 0.9875457286834717, 0.5098402500152588, 0.8636798858642578], "mean_td_error": 0.909771740436554, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 51.0, "diff_num_grad_updates_vs_sampler_policy": 50.0}}, "num_env_steps_sampled": 46592, "num_env_steps_trained": 13158, "num_agent_steps_sampled": 139776, "num_agent_steps_trained": 13158, "last_target_update_ts": 46592, "num_target_updates": 51}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 139776, "num_agent_steps_trained": 13158, "num_env_steps_sampled": 46592, "num_env_steps_trained": 13158, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 412.3165135989097, "num_env_steps_trained_throughput_per_sec": 118.72506753182891, "timesteps_total": 46592, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 139776, "timers": {"training_iteration_time_ms": 1959.053, "sample_time_ms": 1359.462, "load_time_ms": 0.531, "load_throughput": 486175.951, "learn_time_ms": 61.612, "learn_throughput": 4187.526, "synch_weights_time_ms": 15.763}, "counters": {"num_env_steps_sampled": 46592, "num_env_steps_trained": 13158, "num_agent_steps_sampled": 139776, "num_agent_steps_trained": 13158, "last_target_update_ts": 46592, "num_target_updates": 51}, "done": false, "episodes_total": 0, "training_iteration": 52, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-16-28", "timestamp": 1700201788, "time_this_iter_s": 2.1885931491851807, "time_total_s": 105.09976649284363, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8c89aa3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 105.09976649284363, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 78.33333333333333, "ram_util_percent": 90.66666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.975340843200684, "actor_loss": -8.820932388305664, "critic_loss": 0.2512584924697876, "alpha_loss": -0.15270860493183136, "alpha_value": 0.9848079681396484, "log_alpha_value": -0.015308610163629055, "target_entropy": -6.0, "policy_t": 0.023964757099747658, "mean_q": 4.836003303527832, "max_q": 5.941814422607422, "min_q": 4.073539733886719}, "td_error": [1.2159509658813477, 0.5410597324371338, 0.7508258819580078, 0.5240671634674072, 0.9309141635894775, 0.8837809562683105, 1.5979247093200684, 1.4144129753112793, 0.6255474090576172, 2.4713315963745117, 0.7831869125366211, 1.3965685367584229, 0.2533905506134033, 0.30031275749206543, 1.4221513271331787, 0.6460931301116943, 0.710712194442749, 0.38158226013183594, 0.9828221797943115, 0.34163856506347656, 0.0330965518951416, 0.17923474311828613, 0.4521515369415283, 1.0101733207702637, 0.529766321182251, 0.9543921947479248, 0.7360937595367432, 1.3916664123535156, 2.4070091247558594, 1.302429437637329, 0.3044552803039551, 0.6887073516845703, 0.9844200611114502, 1.8804373741149902, 0.34398603439331055, 0.15931105613708496, 0.08742904663085938, 2.450828790664673, 0.5192577838897705, 0.5820615291595459, 1.3830022811889648, 0.9901254177093506, 0.5286667346954346, 1.3647186756134033, 0.5652759075164795, 1.0479130744934082, 0.290510892868042, 0.5475876331329346, 1.9063801765441895, 1.2990427017211914, 0.5140957832336426, 1.0653438568115234, 0.6797943115234375, 0.2800109386444092, 0.33715081214904785, 2.8545961380004883, 1.3683440685272217, 0.6781980991363525, 0.8986556529998779, 0.5526852607727051, 1.4314253330230713, 0.5110008716583252, 1.7544424533843994, 0.9746613502502441, 0.22838735580444336, 0.2727792263031006, 0.778231143951416, 0.8410689830780029, 0.3891265392303467, 0.4001913070678711, 1.2473328113555908, 0.9466254711151123, 1.8485429286956787, 0.5174617767333984, 1.1998531818389893, 1.4045608043670654, 1.412738561630249, 2.8266937732696533, 1.0168957710266113, 0.7341606616973877, 3.105435609817505, 0.1600949764251709, 0.7469661235809326, 1.139087200164795, 0.30433177947998047, 0.32730650901794434], "mean_td_error": 0.9400311708450317, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 52.0, "diff_num_grad_updates_vs_sampler_policy": 51.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.135139465332031, "actor_loss": -8.067520141601562, "critic_loss": 0.1215706318616867, "alpha_loss": -0.15519484877586365, "alpha_value": 0.984804093837738, "log_alpha_value": -0.015312551520764828, "target_entropy": -6.0, "policy_t": 0.0127717861905694, "mean_q": 4.075287342071533, "max_q": 5.150880813598633, "min_q": 3.392409086227417}, "td_error": [2.1205267906188965, 0.1988060474395752, 0.822009801864624, 1.9491658210754395, 1.1441237926483154, 0.8645830154418945, 1.1014690399169922, 0.3005368709564209, 0.4746980667114258, 0.292618989944458, 0.20093250274658203, 0.21834015846252441, 1.209411859512329, 0.34588122367858887, 0.3904169797897339, 1.344039797782898, 1.8564200401306152, 0.6881759166717529, 0.36353635787963867, 0.9835991859436035, 0.11304879188537598, 0.44246768951416016, 0.5586847066879272, 0.9394936561584473, 1.6692514419555664, 0.21450448036193848, 0.04770016670227051, 0.6730643510818481, 1.406478762626648, 1.192488670349121, 0.09536778926849365, 0.7265222072601318, 0.8675531148910522, 1.4961183071136475, 0.1597447395324707, 0.6566250324249268, 0.16835665702819824, 0.1434168815612793, 0.5429801940917969, 0.47031891345977783, 1.9807435274124146, 1.1885039806365967, 0.7179033756256104, 0.3437955379486084, 0.2735450267791748, 0.17658531665802002, 0.2654745578765869, 1.539377212524414, 1.6691163778305054, 0.0883479118347168, 0.1465306282043457, 0.8120219707489014, 2.380911111831665, 0.5211998224258423, 0.4959838390350342, 0.3667043447494507, 0.37316131591796875, 0.5315220355987549, 1.3864860534667969, 1.5108468532562256, 1.0568029880523682, 0.8101685047149658, 1.269906759262085, 0.25516438484191895, 2.625239133834839, 0.8932065963745117, 0.4634840488433838, 0.9646360874176025, 1.9141662120819092, 0.245330810546875, 2.1213366985321045, 0.36389124393463135, 0.19026589393615723, 0.1813269853591919, 1.505779504776001, 1.1385266780853271, 0.06116187572479248, 1.270227313041687, 1.0235099792480469, 0.49908447265625, 1.133658766746521, 1.5542476177215576, 0.1011512279510498, 0.18332695960998535, 0.20593082904815674, 1.723508596420288], "mean_td_error": 0.8136892318725586, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 52.0, "diff_num_grad_updates_vs_sampler_policy": 51.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.139811515808105, "actor_loss": -8.199732780456543, "critic_loss": 0.18802472949028015, "alpha_loss": -0.15523852407932281, "alpha_value": 0.9848067760467529, "log_alpha_value": -0.015309803187847137, "target_entropy": -6.0, "policy_t": -0.004422423429787159, "mean_q": 4.170321464538574, "max_q": 5.297152996063232, "min_q": 3.470538854598999}, "td_error": [0.2729051113128662, 1.4792970418930054, 0.304241418838501, 0.14716386795043945, 1.914226770401001, 1.3537349700927734, 0.23481082916259766, 0.8538546562194824, 0.5992920398712158, 1.8796963691711426, 0.29867398738861084, 0.39258909225463867, 1.401860237121582, 0.8867015838623047, 1.4690521955490112, 0.9626953601837158, 2.211888074874878, 0.829031229019165, 0.1727006435394287, 2.2169687747955322, 0.22458398342132568, 1.1333404779434204, 1.484102725982666, 1.558309555053711, 1.0145611763000488, 0.7783827781677246, 1.0896940231323242, 0.9827933311462402, 0.09956932067871094, 2.0865228176116943, 0.25233006477355957, 1.5479769706726074, 1.0760550498962402, 1.2283153533935547, 1.701256275177002, 1.592982292175293, 0.07525038719177246, 0.5108275413513184, 0.18577861785888672, 1.390839695930481, 0.13720965385437012, 1.365570068359375, 1.8854918479919434, 0.1287858486175537, 0.6173089742660522, 0.3294326066970825, 1.741863489151001, 0.5431492328643799, 0.88490891456604, 1.239242434501648, 2.207382917404175, 0.5748882293701172, 1.07826828956604, 1.8403143882751465, 1.0759345293045044, 1.2314438819885254, 1.515100359916687, 3.456486463546753, 0.5908541679382324, 2.285106897354126, 1.5204951763153076, 1.212493896484375, 0.5304760932922363, 1.0348873138427734, 0.1032564640045166, 0.5003154277801514, 0.04492640495300293, 0.21405291557312012, 0.05001997947692871, 1.4756776094436646, 0.44762134552001953, 0.8859987258911133, 2.2204153537750244, 0.17490601539611816, 0.9314601421356201, 0.3852524757385254, 0.0411076545715332, 1.0970399379730225, 0.5695703029632568, 1.3416874408721924, 0.3541285991668701, 1.4413414001464844, 0.3999873399734497, 0.0607151985168457, 1.1044645309448242, 0.3266263008117676], "mean_td_error": 0.9661921262741089, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 52.0, "diff_num_grad_updates_vs_sampler_policy": 51.0}}, "num_env_steps_sampled": 47488, "num_env_steps_trained": 13416, "num_agent_steps_sampled": 142464, "num_agent_steps_trained": 13416, "last_target_update_ts": 47488, "num_target_updates": 52}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 142464, "num_agent_steps_trained": 13416, "num_env_steps_sampled": 47488, "num_env_steps_trained": 13416, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 405.3075139583767, "num_env_steps_trained_throughput_per_sec": 116.706851117479, "timesteps_total": 47488, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 142464, "timers": {"training_iteration_time_ms": 1993.56, "sample_time_ms": 1392.649, "load_time_ms": 0.531, "load_throughput": 485434.43, "learn_time_ms": 61.603, "learn_throughput": 4188.135, "synch_weights_time_ms": 15.666}, "counters": {"num_env_steps_sampled": 47488, "num_env_steps_trained": 13416, "num_agent_steps_sampled": 142464, "num_agent_steps_trained": 13416, "last_target_update_ts": 47488, "num_target_updates": 52}, "done": false, "episodes_total": 0, "training_iteration": 53, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-16-30", "timestamp": 1700201790, "time_this_iter_s": 2.225412130355835, "time_total_s": 107.32517862319946, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8c8ad7e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 107.32517862319946, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 79.73333333333333, "ram_util_percent": 90.59999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.974298477172852, "actor_loss": -9.018306732177734, "critic_loss": 0.2552724778652191, "alpha_loss": -0.15568366646766663, "alpha_value": 0.9845126867294312, "log_alpha_value": -0.015608482994139194, "target_entropy": -6.0, "policy_t": -0.016698960214853287, "mean_q": 5.118259906768799, "max_q": 6.195623874664307, "min_q": 4.187341213226318}, "td_error": [0.28509974479675293, 0.32446837425231934, 0.8469555377960205, 1.8276774883270264, 0.9393877983093262, 1.4310765266418457, 1.6925795078277588, 0.7825279235839844, 0.38269782066345215, 0.9825100898742676, 1.812415599822998, 0.4926018714904785, 0.2216489315032959, 1.0614018440246582, 1.6090753078460693, 0.5071589946746826, 1.3948984146118164, 1.2347276210784912, 0.6615118980407715, 0.8847432136535645, 2.3182373046875, 0.6463117599487305, 1.2559115886688232, 1.5568830966949463, 0.8518030643463135, 1.6869311332702637, 0.10937023162841797, 1.6150052547454834, 0.6161153316497803, 1.24519681930542, 0.466083288192749, 0.4412994384765625, 0.27269959449768066, 0.7915670871734619, 3.1678171157836914, 0.27236437797546387, 0.60086989402771, 0.27516746520996094, 0.9491841793060303, 0.3547995090484619, 1.1318793296813965, 0.21425294876098633, 1.2058618068695068, 0.7753715515136719, 1.279649019241333, 0.9542019367218018, 3.275641679763794, 0.2573680877685547, 0.7326240539550781, 0.9158427715301514, 0.5194425582885742, 0.8442561626434326, 0.21556854248046875, 0.7451379299163818, 1.7695436477661133, 0.8248152732849121, 2.697214126586914, 1.089928388595581, 0.6463117599487305, 1.616875171661377, 1.5069067478179932, 0.20555639266967773, 0.24816370010375977, 0.38758182525634766, 0.6154294013977051, 0.5188174247741699, 0.24925947189331055, 0.18421030044555664, 0.46704888343811035, 1.2538015842437744, 0.2069251537322998, 0.6718244552612305, 0.24017977714538574, 2.0602595806121826, 1.7320938110351562, 1.056513786315918, 0.49485135078430176, 1.0559966564178467, 1.4362938404083252, 1.184403896331787, 2.4002301692962646, 0.19194436073303223, 2.783461809158325, 0.6558117866516113, 1.1219921112060547, 1.769714593887329], "mean_td_error": 0.9916261434555054, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 53.0, "diff_num_grad_updates_vs_sampler_policy": 52.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.007102966308594, "actor_loss": -8.125348091125488, "critic_loss": 0.14852496981620789, "alpha_loss": -0.1562374383211136, "alpha_value": 0.9845085740089417, "log_alpha_value": -0.015612652525305748, "target_entropy": -6.0, "policy_t": -0.04879786819219589, "mean_q": 4.140702247619629, "max_q": 4.785708427429199, "min_q": 3.479964256286621}, "td_error": [2.345975399017334, 0.8436489105224609, 0.042525291442871094, 0.5096737146377563, 1.1092450618743896, 0.6633806228637695, 0.07869482040405273, 0.17987513542175293, 0.8373668193817139, 0.8106274604797363, 0.43532752990722656, 0.48676037788391113, 0.9393038749694824, 0.7601473331451416, 0.11740660667419434, 0.4572794437408447, 1.0070421695709229, 0.2422323226928711, 1.2450413703918457, 1.1824705600738525, 0.45482850074768066, 0.2269747257232666, 1.1424577236175537, 1.4240466356277466, 0.9556176662445068, 1.7564539909362793, 0.2243056297302246, 2.7212555408477783, 0.8727974891662598, 0.4636831283569336, 0.868257999420166, 1.81000816822052, 0.9816808700561523, 1.5185519456863403, 1.8647944927215576, 1.9242010116577148, 0.15111660957336426, 0.4286818504333496, 1.2024922370910645, 0.14019560813903809, 1.7046945095062256, 0.5888321399688721, 0.15239238739013672, 0.13966035842895508, 0.6907556056976318, 0.4828791618347168, 2.2735204696655273, 1.3076276779174805, 0.932131290435791, 0.7849273681640625, 0.789980411529541, 1.0237900018692017, 1.1902647018432617, 0.8971378803253174, 0.8346078395843506, 4.263597011566162, 0.24903154373168945, 0.9942245483398438, 0.630168080329895, 0.613456130027771, 0.2875785827636719, 1.479720115661621, 0.5468076467514038, 0.7068405151367188, 1.0961730480194092, 1.1121678352355957, 1.014613151550293, 1.5772275924682617, 1.5259981155395508, 0.11433649063110352, 0.3368492126464844, 0.6866896152496338, 0.6026076078414917, 0.26837658882141113, 0.9683473110198975, 1.6193115711212158, 0.6577301025390625, 2.493807077407837, 0.94472336769104, 0.15463757514953613, 1.2166216373443604, 2.1024441719055176, 0.9781997203826904, 0.19407951831817627, 1.1332416534423828, 0.9995518922805786], "mean_td_error": 0.9394044876098633, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 53.0, "diff_num_grad_updates_vs_sampler_policy": 52.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.10580062866211, "actor_loss": -8.315238952636719, "critic_loss": 0.1558491289615631, "alpha_loss": -0.1577492654323578, "alpha_value": 0.9845114350318909, "log_alpha_value": -0.015609772875905037, "target_entropy": -6.0, "policy_t": 0.014902355149388313, "mean_q": 4.29277229309082, "max_q": 5.009220600128174, "min_q": 3.5913095474243164}, "td_error": [2.036278009414673, 2.5873656272888184, 1.1150472164154053, 0.19790339469909668, 0.9709432125091553, 1.0802383422851562, 1.0751371383666992, 0.6892478466033936, 0.503058671951294, 0.42751383781433105, 0.12023234367370605, 1.651158332824707, 0.0857841968536377, 2.9204437732696533, 0.39470720291137695, 1.6508915424346924, 0.3259246349334717, 2.3512070178985596, 0.20154452323913574, 1.2872979640960693, 2.197152614593506, 2.3751182556152344, 1.4083364009857178, 0.6115827560424805, 0.19053149223327637, 0.2754199504852295, 0.8365063667297363, 0.03505444526672363, 0.8734843730926514, 0.3544738292694092, 2.0853960514068604, 0.7367043495178223, 0.8301467895507812, 0.6989126205444336, 1.7458341121673584, 0.40598416328430176, 1.2173049449920654, 1.391657829284668, 1.5709803104400635, 0.35861408710479736, 0.19478654861450195, 0.1352839469909668, 0.26727914810180664, 0.3707420825958252, 0.4571988582611084, 1.3321290016174316, 1.8660049438476562, 0.9764680862426758, 0.49640703201293945, 0.2661409378051758, 1.029813289642334, 0.1658036708831787, 0.45370030403137207, 0.7205924987792969, 0.20202410221099854, 0.7997219562530518, 0.840595006942749, 2.180730104446411, 1.8524959087371826, 0.23358619213104248, 0.7129274606704712, 0.6024532318115234, 0.10582733154296875, 0.9106941223144531, 1.4466235637664795, 0.15997672080993652, 0.2958652973175049, 0.8585007190704346, 1.102356195449829, 0.40166521072387695, 0.858543872833252, 0.05541682243347168, 0.4463832378387451, 0.4887549877166748, 0.40344011783599854, 1.576935052871704, 0.9057645797729492, 0.26056981086730957, 1.1512181758880615, 0.7048087120056152, 0.4159708023071289, 0.4337460994720459, 0.48640239238739014, 0.510075569152832, 0.1028745174407959, 0.9845006465911865], "mean_td_error": 0.8499408960342407, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 53.0, "diff_num_grad_updates_vs_sampler_policy": 52.0}}, "num_env_steps_sampled": 48384, "num_env_steps_trained": 13674, "num_agent_steps_sampled": 145152, "num_agent_steps_trained": 13674, "last_target_update_ts": 48384, "num_target_updates": 53}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 145152, "num_agent_steps_trained": 13674, "num_env_steps_sampled": 48384, "num_env_steps_trained": 13674, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 334.9673984717393, "num_env_steps_trained_throughput_per_sec": 96.45266607779993, "timesteps_total": 48384, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 145152, "timers": {"training_iteration_time_ms": 2070.588, "sample_time_ms": 1465.022, "load_time_ms": 0.531, "load_throughput": 485979.446, "learn_time_ms": 61.615, "learn_throughput": 4187.268, "synch_weights_time_ms": 16.16}, "counters": {"num_env_steps_sampled": 48384, "num_env_steps_trained": 13674, "num_agent_steps_sampled": 145152, "num_agent_steps_trained": 13674, "last_target_update_ts": 48384, "num_target_updates": 53}, "done": false, "episodes_total": 0, "training_iteration": 54, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-16-33", "timestamp": 1700201793, "time_this_iter_s": 2.688662052154541, "time_total_s": 110.013840675354, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8c8977f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 110.013840675354, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 80.475, "ram_util_percent": 90.64999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.086793899536133, "actor_loss": -9.249682426452637, "critic_loss": 0.24225971102714539, "alpha_loss": -0.16046170890331268, "alpha_value": 0.9842177629470825, "log_alpha_value": -0.015908097848296165, "target_entropy": -6.0, "policy_t": 0.011615615338087082, "mean_q": 5.243927478790283, "max_q": 6.52613639831543, "min_q": 4.44911003112793}, "td_error": [0.4304358959197998, 0.13097167015075684, 2.6604957580566406, 1.6108460426330566, 1.8382256031036377, 1.491136074066162, 1.617166519165039, 0.11668515205383301, 0.8532352447509766, 1.149892807006836, 0.45340991020202637, 0.2698965072631836, 1.2027497291564941, 0.6079049110412598, 0.7119426727294922, 0.49606800079345703, 1.1231026649475098, 0.27916884422302246, 0.17128705978393555, 0.8736388683319092, 0.9584262371063232, 0.7434086799621582, 0.7686190605163574, 0.8067152500152588, 0.4551210403442383, 2.3502562046051025, 2.324861526489258, 1.5706970691680908, 0.5300397872924805, 0.504913330078125, 0.928002119064331, 1.532130241394043, 1.3594245910644531, 0.26226329803466797, 0.8677468299865723, 0.7262125015258789, 0.9478323459625244, 0.5028438568115234, 0.6150093078613281, 0.7690532207489014, 1.224992275238037, 1.1293795108795166, 2.1934313774108887, 0.09403705596923828, 1.808396339416504, 0.48181748390197754, 0.6697454452514648, 0.4837350845336914, 0.07209467887878418, 0.10868668556213379, 0.299072265625, 0.86728835105896, 2.6436896324157715, 1.8418207168579102, 1.123807668685913, 0.39273691177368164, 0.38825273513793945, 0.6545279026031494, 1.604560375213623, 1.7185509204864502, 0.13863134384155273, 0.43108463287353516, 1.8224565982818604, 0.5349669456481934, 0.3396024703979492, 1.328007698059082, 0.9086494445800781, 1.1256604194641113, 0.6714997291564941, 0.18349504470825195, 0.47521090507507324, 0.2153148651123047, 0.31969237327575684, 1.5854697227478027, 1.4448354244232178, 3.0889198780059814, 0.44025516510009766, 0.8578250408172607, 1.850738525390625, 1.8245394229888916, 0.5361852645874023, 0.6943650245666504, 1.4096121788024902, 0.41646671295166016, 0.16658854484558105, 1.7322733402252197], "mean_td_error": 0.9529629349708557, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 54.0, "diff_num_grad_updates_vs_sampler_policy": 53.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.118558883666992, "actor_loss": -8.237459182739258, "critic_loss": 0.1949423849582672, "alpha_loss": -0.16101211309432983, "alpha_value": 0.9842134118080139, "log_alpha_value": -0.015912553295493126, "target_entropy": -6.0, "policy_t": 0.02717435359954834, "mean_q": 4.276566505432129, "max_q": 4.999927997589111, "min_q": 3.5237362384796143}, "td_error": [0.7167332172393799, 1.9576807022094727, 0.25071167945861816, 1.2535115480422974, 1.4729321002960205, 1.4977214336395264, 1.116219401359558, 0.09295248985290527, 0.22744297981262207, 0.12898540496826172, 0.6942756175994873, 0.14274382591247559, 0.07361733913421631, 2.4401447772979736, 1.2405626773834229, 1.148244857788086, 0.46253490447998047, 2.5226147174835205, 0.4100792407989502, 0.7590963840484619, 0.8021104335784912, 1.6412532329559326, 2.1578705310821533, 2.1122994422912598, 1.1702778339385986, 1.0105576515197754, 0.40604519844055176, 0.73433518409729, 0.06238961219787598, 2.3400933742523193, 1.0843315124511719, 0.5508379936218262, 2.546893358230591, 0.17779791355133057, 0.20525074005126953, 0.5188958644866943, 0.24912261962890625, 1.1646168231964111, 2.5303475856781006, 1.5511188507080078, 1.2574892044067383, 0.438169002532959, 1.9251511096954346, 0.7985503673553467, 1.8975400924682617, 1.6881389617919922, 0.5507854223251343, 2.1854114532470703, 1.2321388721466064, 1.2686196565628052, 1.0105814933776855, 0.7155089378356934, 1.3807464838027954, 0.730445384979248, 0.2870032787322998, 0.3670847415924072, 0.7509992122650146, 2.3238401412963867, 1.3416643142700195, 0.21999740600585938, 0.23609137535095215, 3.3915956020355225, 0.11772298812866211, 0.9370059967041016, 0.9292141199111938, 0.3894803524017334, 0.14589428901672363, 2.564558744430542, 0.2193845510482788, 0.8113222122192383, 2.2331035137176514, 2.0817177295684814, 0.682567834854126, 1.1529749631881714, 2.5614070892333984, 1.3054721355438232, 0.38375258445739746, 0.19015026092529297, 0.6100208759307861, 0.7607476711273193, 0.9517302513122559, 1.4029183387756348, 2.3271801471710205, 1.565587043762207, 1.3691411018371582, 1.9599816799163818], "mean_td_error": 1.107858657836914, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 54.0, "diff_num_grad_updates_vs_sampler_policy": 53.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.106201171875, "actor_loss": -8.391817092895508, "critic_loss": 0.2161775827407837, "alpha_loss": -0.1607874184846878, "alpha_value": 0.9842160940170288, "log_alpha_value": -0.015909777954220772, "target_entropy": -6.0, "policy_t": -0.038975588977336884, "mean_q": 4.350371837615967, "max_q": 5.054751396179199, "min_q": 3.51084303855896}, "td_error": [2.7642064094543457, 1.8153939247131348, 0.09447455406188965, 0.8133001327514648, 0.11283612251281738, 1.028527855873108, 0.7096953392028809, 0.09695029258728027, 1.6984241008758545, 0.980658769607544, 1.3999605178833008, 0.21832513809204102, 0.848257303237915, 0.7113304138183594, 2.655327320098877, 1.101747989654541, 2.2374322414398193, 0.9715752601623535, 1.3797869682312012, 1.3385428190231323, 0.6614022254943848, 0.28908276557922363, 0.07947301864624023, 1.3308179378509521, 1.9509403705596924, 2.011310577392578, 0.8463230133056641, 0.1920151710510254, 0.83526611328125, 3.0707015991210938, 0.44446516036987305, 0.5148591995239258, 0.35956859588623047, 0.595452070236206, 0.752422571182251, 0.7608957290649414, 0.8416330814361572, 0.3426194190979004, 1.1191275119781494, 1.7280809879302979, 3.2140862941741943, 1.159785509109497, 0.14173102378845215, 0.13765954971313477, 2.073812484741211, 1.8755698204040527, 0.4180135726928711, 0.7284469604492188, 0.17354917526245117, 0.1988379955291748, 0.9112861156463623, 1.472590446472168, 0.9769223928451538, 0.9714159965515137, 0.9949121475219727, 1.3538339138031006, 1.0125763416290283, 0.09085536003112793, 0.145125150680542, 0.44053125381469727, 1.2894482612609863, 0.11371922492980957, 0.1670515537261963, 1.4019560813903809, 0.15894079208374023, 1.4155244827270508, 0.8854919672012329, 1.0194110870361328, 1.1917724609375, 0.4155111312866211, 2.556349039077759, 0.2271716594696045, 1.9433083534240723, 2.0029425621032715, 1.6867344379425049, 1.0239059925079346, 2.188990592956543, 1.0366137027740479, 1.2274131774902344, 0.5988088846206665, 2.816767454147339, 0.5424675941467285, 0.380853533744812, 1.7366852760314941, 1.5883146524429321, 1.6843678951263428], "mean_td_error": 1.0638984441757202, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 54.0, "diff_num_grad_updates_vs_sampler_policy": 53.0}}, "num_env_steps_sampled": 49280, "num_env_steps_trained": 13932, "num_agent_steps_sampled": 147840, "num_agent_steps_trained": 13932, "last_target_update_ts": 49280, "num_target_updates": 54}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 147840, "num_agent_steps_trained": 13932, "num_env_steps_sampled": 49280, "num_env_steps_trained": 13932, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 430.03754481636105, "num_env_steps_trained_throughput_per_sec": 123.82777518149682, "timesteps_total": 49280, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 147840, "timers": {"training_iteration_time_ms": 2092.301, "sample_time_ms": 1486.855, "load_time_ms": 0.54, "load_throughput": 477529.867, "learn_time_ms": 62.061, "learn_throughput": 4157.216, "synch_weights_time_ms": 16.232}, "counters": {"num_env_steps_sampled": 49280, "num_env_steps_trained": 13932, "num_agent_steps_sampled": 147840, "num_agent_steps_trained": 13932, "last_target_update_ts": 49280, "num_target_updates": 54}, "done": false, "episodes_total": 0, "training_iteration": 55, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-16-35", "timestamp": 1700201795, "time_this_iter_s": 2.0988399982452393, "time_total_s": 112.11268067359924, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8c89aa3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 112.11268067359924, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 74.76666666666667, "ram_util_percent": 90.60000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.127842903137207, "actor_loss": -9.489030838012695, "critic_loss": 0.24786671996116638, "alpha_loss": -0.16414964199066162, "alpha_value": 0.9839228987693787, "log_alpha_value": -0.016207758337259293, "target_entropy": -6.0, "policy_t": 0.020628834143280983, "mean_q": 5.413872241973877, "max_q": 6.628792762756348, "min_q": 4.529354095458984}, "td_error": [2.351226568222046, 0.574779748916626, 3.5486698150634766, 1.6914167404174805, 2.2302870750427246, 0.4362034797668457, 1.8989601135253906, 0.7098898887634277, 1.1875007152557373, 1.1962745189666748, 0.3858034610748291, 0.7313859462738037, 0.2810485363006592, 1.742920160293579, 0.6628050804138184, 0.9297420978546143, 0.9603440761566162, 0.46448636054992676, 0.3170781135559082, 0.5244524478912354, 0.9314777851104736, 0.7381503582000732, 0.8289303779602051, 1.6227352619171143, 1.0093910694122314, 0.5180282592773438, 0.9690594673156738, 0.16466665267944336, 0.737865686416626, 1.0625362396240234, 0.8172855377197266, 1.4696202278137207, 0.6571266651153564, 0.656804084777832, 0.36335015296936035, 0.8129208087921143, 0.6015307903289795, 0.694969654083252, 0.310222864151001, 0.5206682682037354, 0.6833643913269043, 0.43706631660461426, 3.4618921279907227, 0.3790128231048584, 1.266639232635498, 0.32271909713745117, 0.5093495845794678, 2.0184357166290283, 0.7539982795715332, 0.5868477821350098, 0.5782008171081543, 2.035304307937622, 1.817553997039795, 0.33344149589538574, 0.2108604907989502, 0.6452980041503906, 0.6433475017547607, 1.1873326301574707, 0.3156905174255371, 1.2313718795776367, 1.712644338607788, 0.3707571029663086, 1.8213388919830322, 0.4207470417022705, 0.18862223625183105, 0.7395215034484863, 0.4586358070373535, 0.6663002967834473, 0.9763822555541992, 0.1777329444885254, 1.8571808338165283, 1.690782070159912, 1.202324390411377, 2.534278631210327, 3.137873411178589, 0.5328748226165771, 1.0475542545318604, 0.9662678241729736, 0.3953728675842285, 0.6819939613342285, 0.5648715496063232, 3.20363187789917, 0.660393238067627, 0.5300250053405762, 0.7272717952728271, 0.5298042297363281], "mean_td_error": 0.9944828748703003, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 55.0, "diff_num_grad_updates_vs_sampler_policy": 54.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.15480899810791, "actor_loss": -8.28935432434082, "critic_loss": 0.1579924374818802, "alpha_loss": -0.1646353304386139, "alpha_value": 0.9839181900024414, "log_alpha_value": -0.016212549060583115, "target_entropy": -6.0, "policy_t": -0.010568725876510143, "mean_q": 4.294560432434082, "max_q": 5.205099582672119, "min_q": 3.732142448425293}, "td_error": [1.1109771728515625, 0.5251033306121826, 0.41315627098083496, 0.10422968864440918, 1.243177890777588, 0.7236846685409546, 1.2228152751922607, 0.44865846633911133, 1.7618926763534546, 0.19912219047546387, 0.8017146587371826, 0.37029778957366943, 0.5395481586456299, 0.2714545726776123, 0.09169268608093262, 0.19204282760620117, 1.0849919319152832, 0.16189074516296387, 2.1191768646240234, 0.14035534858703613, 1.9862258434295654, 1.8567447662353516, 0.1358652114868164, 0.7969807386398315, 2.0770697593688965, 0.2673153877258301, 0.8250472545623779, 0.18027734756469727, 1.3662517070770264, 2.2645716667175293, 1.3424880504608154, 1.751187801361084, 0.9305243492126465, 0.303020715713501, 0.6763923168182373, 1.2628512382507324, 0.9853826761245728, 0.42934656143188477, 2.213097095489502, 0.20463311672210693, 0.40989112854003906, 0.4245297908782959, 0.19229555130004883, 1.3117036819458008, 0.698007345199585, 0.9006333351135254, 0.3576991558074951, 0.8638665676116943, 3.1434574127197266, 1.6711559295654297, 0.45716798305511475, 0.5803806781768799, 0.561098575592041, 0.3815786838531494, 0.3580641746520996, 1.4318268299102783, 2.5260136127471924, 0.6391267776489258, 1.396604299545288, 0.8423395156860352, 0.9223964214324951, 0.5389580726623535, 2.366299629211426, 1.4634406566619873, 0.9069983959197998, 1.0134174823760986, 0.8983807563781738, 0.1692943572998047, 0.06987977027893066, 0.38757550716400146, 0.3753318786621094, 2.8460304737091064, 0.7925610542297363, 1.310833215713501, 1.4361131191253662, 1.859674096107483, 0.28913187980651855, 0.3721475601196289, 0.25505661964416504, 0.2831747531890869, 0.2457350492477417, 1.9141361713409424, 2.3800082206726074, 0.12287414073944092, 1.7666637897491455, 1.9061650037765503], "mean_td_error": 0.9467555284500122, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 55.0, "diff_num_grad_updates_vs_sampler_policy": 54.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.093564987182617, "actor_loss": -8.42284870147705, "critic_loss": 0.19336974620819092, "alpha_loss": -0.16361480951309204, "alpha_value": 0.9839208722114563, "log_alpha_value": -0.016209814697504044, "target_entropy": -6.0, "policy_t": -0.019884370267391205, "mean_q": 4.438259601593018, "max_q": 5.44713830947876, "min_q": 3.624621868133545}, "td_error": [0.15062594413757324, 0.5661213397979736, 0.7059047222137451, 0.07422900199890137, 1.675271987915039, 0.9083075523376465, 1.8353180885314941, 0.3063175678253174, 1.2977075576782227, 0.058995723724365234, 1.5329854488372803, 2.0097897052764893, 0.12105536460876465, 1.9295291900634766, 0.22826218605041504, 1.4513542652130127, 1.406934142112732, 0.23853325843811035, 0.7320430278778076, 0.2186446189880371, 1.5864708423614502, 1.3040006160736084, 0.2542452812194824, 0.7558538913726807, 0.40405702590942383, 0.2615654468536377, 1.658534288406372, 3.1043860912323, 1.4058359861373901, 1.4717068672180176, 1.5353872776031494, 0.8749470710754395, 0.45559096336364746, 0.7018287181854248, 0.1244971752166748, 1.1989896297454834, 0.78265380859375, 0.5472269058227539, 0.5570027828216553, 2.6620237827301025, 1.0107433795928955, 0.7523868083953857, 1.5841047763824463, 1.19905686378479, 0.9267210960388184, 1.4599697589874268, 0.46488380432128906, 0.7952554225921631, 2.0282070636749268, 1.279228925704956, 0.9471971988677979, 0.43274807929992676, 2.475365161895752, 1.992241621017456, 1.0360565185546875, 1.179521918296814, 0.5543677806854248, 0.14227652549743652, 2.0253121852874756, 0.8241134881973267, 0.21773481369018555, 2.0197653770446777, 0.43930649757385254, 1.0783288478851318, 0.9683792591094971, 2.8527097702026367, 0.23855233192443848, 0.09109187126159668, 0.12973237037658691, 0.8403036594390869, 1.6884410381317139, 0.183685302734375, 0.7753026485443115, 0.3062171936035156, 0.3417360782623291, 0.3710453510284424, 0.6186052560806274, 1.018263339996338, 0.7684626579284668, 1.7970237731933594, 0.29701900482177734, 0.10378384590148926, 0.5500845909118652, 0.8191013336181641, 1.4170899391174316, 2.6281158924102783], "mean_td_error": 0.9856322407722473, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 55.0, "diff_num_grad_updates_vs_sampler_policy": 54.0}}, "num_env_steps_sampled": 50176, "num_env_steps_trained": 14190, "num_agent_steps_sampled": 150528, "num_agent_steps_trained": 14190, "last_target_update_ts": 50176, "num_target_updates": 55}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 150528, "num_agent_steps_trained": 14190, "num_env_steps_sampled": 50176, "num_env_steps_trained": 14190, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 448.1317373352371, "num_env_steps_trained_throughput_per_sec": 129.03793329519104, "timesteps_total": 50176, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 150528, "timers": {"training_iteration_time_ms": 2104.144, "sample_time_ms": 1498.965, "load_time_ms": 0.542, "load_throughput": 476289.803, "learn_time_ms": 62.116, "learn_throughput": 4153.533, "synch_weights_time_ms": 16.095}, "counters": {"num_env_steps_sampled": 50176, "num_env_steps_trained": 14190, "num_agent_steps_sampled": 150528, "num_agent_steps_trained": 14190, "last_target_update_ts": 50176, "num_target_updates": 55}, "done": false, "episodes_total": 0, "training_iteration": 56, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-16-37", "timestamp": 1700201797, "time_this_iter_s": 2.0141708850860596, "time_total_s": 114.1268515586853, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8c8add790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 114.1268515586853, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 72.26666666666667, "ram_util_percent": 90.59999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.098588943481445, "actor_loss": -9.60184383392334, "critic_loss": 0.2264496237039566, "alpha_loss": -0.1667030304670334, "alpha_value": 0.98362797498703, "log_alpha_value": -0.016507556661963463, "target_entropy": -6.0, "policy_t": -0.022446976974606514, "mean_q": 5.623685836791992, "max_q": 7.118934154510498, "min_q": 4.755700588226318}, "td_error": [1.1907315254211426, 0.18039774894714355, 1.2389726638793945, 0.47895288467407227, 1.6139509677886963, 2.1489412784576416, 0.6802053451538086, 1.7764875888824463, 0.9526360034942627, 1.1887588500976562, 0.6753010749816895, 2.045151472091675, 0.5287215709686279, 1.7478077411651611, 0.5020904541015625, 0.9442977905273438, 1.4442548751831055, 0.8475887775421143, 0.5676956176757812, 1.145341157913208, 0.5925858020782471, 0.37367939949035645, 0.2437126636505127, 0.49883365631103516, 0.9170703887939453, 2.06550669670105, 0.7153418064117432, 0.44652724266052246, 1.6285243034362793, 0.8010413646697998, 0.35037946701049805, 0.6659085750579834, 1.1989781856536865, 0.3841373920440674, 0.9480602741241455, 0.28829002380371094, 0.5294055938720703, 1.0605194568634033, 1.170508623123169, 0.40056443214416504, 0.8727858066558838, 3.493389368057251, 1.3843519687652588, 0.37639617919921875, 0.6240448951721191, 0.41317152976989746, 1.8640897274017334, 1.0504064559936523, 0.6763432025909424, 0.931433916091919, 0.4752366542816162, 1.0079243183135986, 1.19223952293396, 0.2619357109069824, 1.6875970363616943, 0.8549330234527588, 0.8679852485656738, 0.2866661548614502, 0.9143354892730713, 1.0946667194366455, 0.3733201026916504, 0.4940030574798584, 0.597731351852417, 1.2375965118408203, 0.24516963958740234, 0.33805203437805176, 0.3912928104400635, 0.8945553302764893, 0.35695886611938477, 1.219637393951416, 1.6988766193389893, 2.190007209777832, 0.3160092830657959, 0.6242063045501709, 1.377506971359253, 0.8355166912078857, 0.30878162384033203, 0.3020143508911133, 1.7368733882904053, 0.597454309463501, 1.144556999206543, 2.321779727935791, 0.6198692321777344, 0.5961441993713379, 0.548285961151123, 0.503387451171875], "mean_td_error": 0.9229928851127625, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 56.0, "diff_num_grad_updates_vs_sampler_policy": 55.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.091552734375, "actor_loss": -8.33127498626709, "critic_loss": 0.1410990059375763, "alpha_loss": -0.16663891077041626, "alpha_value": 0.9836228489875793, "log_alpha_value": -0.016512714326381683, "target_entropy": -6.0, "policy_t": -0.024144893512129784, "mean_q": 4.351605415344238, "max_q": 5.190910816192627, "min_q": 3.6696386337280273}, "td_error": [0.17436599731445312, 1.188481330871582, 1.3826618194580078, 0.320667028427124, 1.3416117429733276, 1.9167044162750244, 0.8592472076416016, 0.7616064548492432, 0.08687114715576172, 0.326324462890625, 0.07795929908752441, 0.2943592071533203, 2.098860502243042, 1.0260429382324219, 1.8098154067993164, 1.4854321479797363, 3.1943163871765137, 0.16321206092834473, 0.03697681427001953, 0.6731772422790527, 0.48992300033569336, 0.5799914598464966, 2.514655590057373, 0.34609389305114746, 0.20625948905944824, 0.8095419406890869, 0.7478363513946533, 0.3151118755340576, 0.5696845054626465, 1.093083143234253, 1.133683681488037, 0.11371660232543945, 1.0634574890136719, 0.4676544666290283, 1.1424241065979004, 0.8436317443847656, 2.9433696269989014, 0.4902505874633789, 1.4750537872314453, 0.7228567600250244, 1.5818610191345215, 1.4693074226379395, 0.3954963684082031, 0.3340940475463867, 0.7677645683288574, 0.6433320045471191, 0.7017505168914795, 0.46314239501953125, 0.025452852249145508, 0.6678967475891113, 0.0800783634185791, 0.30736422538757324, 1.1945691108703613, 0.6902928352355957, 0.5898654460906982, 0.21619224548339844, 3.7559664249420166, 0.5324711799621582, 2.6387670040130615, 0.20460712909698486, 0.12809467315673828, 0.40482139587402344, 0.23017239570617676, 0.9813656806945801, 0.3189094066619873, 1.4173479080200195, 1.013962984085083, 2.130904197692871, 0.17898201942443848, 0.6814908981323242, 1.3647661209106445, 1.2273404598236084, 0.55379319190979, 2.0565009117126465, 0.21236634254455566, 0.8645312786102295, 0.5565688610076904, 0.6174211502075195, 0.5587592124938965, 0.7227845191955566, 0.2026968002319336, 3.245201826095581, 0.9388236999511719, 1.2524311542510986, 0.5197432041168213, 0.707974910736084], "mean_td_error": 0.9027326703071594, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 56.0, "diff_num_grad_updates_vs_sampler_policy": 55.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.082651138305664, "actor_loss": -8.394415855407715, "critic_loss": 0.17993882298469543, "alpha_loss": -0.16646304726600647, "alpha_value": 0.9836257100105286, "log_alpha_value": -0.016509849578142166, "target_entropy": -6.0, "policy_t": 0.03399057686328888, "mean_q": 4.419721603393555, "max_q": 5.326347351074219, "min_q": 3.783783197402954}, "td_error": [0.3571796417236328, 0.41219639778137207, 1.3844563961029053, 0.9773344993591309, 1.8530969619750977, 0.24906253814697266, 2.027812957763672, 0.4282355308532715, 0.7125184535980225, 0.28170347213745117, 0.11325728893280029, 0.794731855392456, 1.6768431663513184, 0.64261794090271, 1.2032949924468994, 1.0349454879760742, 0.8265089988708496, 0.6232147216796875, 0.20150220394134521, 0.8783113956451416, 1.814133644104004, 0.9194695949554443, 0.45744991302490234, 1.5368602275848389, 1.8572511672973633, 1.5807533264160156, 0.12263250350952148, 0.943364143371582, 1.4721205234527588, 1.18629789352417, 2.701361894607544, 0.6156260967254639, 0.12568163871765137, 0.35588693618774414, 0.20369505882263184, 0.436140775680542, 1.766535997390747, 1.0464198589324951, 0.383131742477417, 1.7122673988342285, 1.2594566345214844, 0.4251786470413208, 1.2501156330108643, 0.2782554626464844, 1.9595544338226318, 1.4992990493774414, 2.8615944385528564, 0.047443389892578125, 0.2706495523452759, 2.268319606781006, 0.053830862045288086, 0.16196274757385254, 0.6761653423309326, 0.48291516304016113, 1.271488904953003, 0.2478024959564209, 2.038273811340332, 0.3816039562225342, 0.2366960048675537, 0.6585028171539307, 1.2908973693847656, 0.46102023124694824, 0.11899328231811523, 0.8340709209442139, 0.8076682090759277, 0.29558587074279785, 1.6840853691101074, 2.238471031188965, 1.1131045818328857, 1.7354238033294678, 0.2005627155303955, 0.8888721466064453, 2.4245967864990234, 1.1057264804840088, 0.150040864944458, 0.3164346218109131, 0.9033529758453369, 0.07754206657409668, 0.5181550979614258, 0.7860956192016602, 1.11602783203125, 1.0115995407104492, 1.7430939674377441, 1.428450107574463, 0.1543424129486084, 0.4387238025665283], "mean_td_error": 0.9312552809715271, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 56.0, "diff_num_grad_updates_vs_sampler_policy": 55.0}}, "num_env_steps_sampled": 51072, "num_env_steps_trained": 14448, "num_agent_steps_sampled": 153216, "num_agent_steps_trained": 14448, "last_target_update_ts": 51072, "num_target_updates": 56}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 153216, "num_agent_steps_trained": 14448, "num_env_steps_sampled": 51072, "num_env_steps_trained": 14448, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 455.81684443835843, "num_env_steps_trained_throughput_per_sec": 131.25083243872373, "timesteps_total": 51072, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 153216, "timers": {"training_iteration_time_ms": 2111.03, "sample_time_ms": 1505.768, "load_time_ms": 0.543, "load_throughput": 475327.432, "learn_time_ms": 62.129, "learn_throughput": 4152.671, "synch_weights_time_ms": 15.902}, "counters": {"num_env_steps_sampled": 51072, "num_env_steps_trained": 14448, "num_agent_steps_sampled": 153216, "num_agent_steps_trained": 14448, "last_target_update_ts": 51072, "num_target_updates": 56}, "done": false, "episodes_total": 0, "training_iteration": 57, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-16-39", "timestamp": 1700201799, "time_this_iter_s": 1.9830927848815918, "time_total_s": 116.1099443435669, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8c8add550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 116.1099443435669, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 68.76666666666667, "ram_util_percent": 90.53333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.015929222106934, "actor_loss": -9.79415512084961, "critic_loss": 0.24500098824501038, "alpha_loss": -0.16834181547164917, "alpha_value": 0.9833330512046814, "log_alpha_value": -0.01680740900337696, "target_entropy": -6.0, "policy_t": 0.010155607014894485, "mean_q": 5.825167179107666, "max_q": 6.953988075256348, "min_q": 4.661609649658203}, "td_error": [0.33638644218444824, 0.5752243995666504, 1.8456461429595947, 0.2525339126586914, 0.2814197540283203, 1.2413828372955322, 0.5440049171447754, 0.6454405784606934, 0.4509453773498535, 2.249046802520752, 0.2103867530822754, 0.29804444313049316, 0.6042554378509521, 1.4406051635742188, 1.5783281326293945, 1.2228953838348389, 1.0842995643615723, 2.0234484672546387, 0.14426302909851074, 1.8391799926757812, 1.4566223621368408, 0.887812614440918, 1.8296363353729248, 1.2762768268585205, 1.5573680400848389, 0.5118720531463623, 0.5787107944488525, 0.7343459129333496, 0.4554307460784912, 0.16669917106628418, 0.5506765842437744, 0.10542130470275879, 0.333698034286499, 1.3555209636688232, 2.0728423595428467, 1.1567480564117432, 0.49147748947143555, 0.8664562702178955, 0.5402131080627441, 1.3877131938934326, 0.7107946872711182, 1.5403544902801514, 1.1472437381744385, 0.29859089851379395, 0.1460857391357422, 0.13498711585998535, 0.30740952491760254, 1.6688199043273926, 0.9447181224822998, 0.4238712787628174, 1.9036827087402344, 0.3768575191497803, 0.6387863159179688, 1.4276549816131592, 1.9064042568206787, 0.19012999534606934, 0.39350104331970215, 0.14889240264892578, 0.46909356117248535, 0.8499352931976318, 0.6559851169586182, 0.49306654930114746, 2.832674741744995, 1.0936501026153564, 0.6309604644775391, 1.7288024425506592, 1.5741841793060303, 0.4402651786804199, 0.33288002014160156, 0.7826228141784668, 1.22837495803833, 1.3139762878417969, 1.8846404552459717, 1.214482069015503, 0.12218260765075684, 0.551593542098999, 1.544400691986084, 2.1773521900177, 1.0583038330078125, 0.23979616165161133, 0.8677644729614258, 0.901771068572998, 1.0076489448547363, 1.9972679615020752, 0.813443660736084, 1.3589372634887695], "mean_td_error": 0.9495130777359009, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 57.0, "diff_num_grad_updates_vs_sampler_policy": 56.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.070693016052246, "actor_loss": -8.356499671936035, "critic_loss": 0.1639097034931183, "alpha_loss": -0.1693173348903656, "alpha_value": 0.9833276867866516, "log_alpha_value": -0.016812875866889954, "target_entropy": -6.0, "policy_t": 0.020268786698579788, "mean_q": 4.461376667022705, "max_q": 5.1692938804626465, "min_q": 3.648399591445923}, "td_error": [3.9673635959625244, 2.07875919342041, 0.5745713710784912, 0.592005729675293, 1.820570468902588, 0.10923171043395996, 1.7908644676208496, 1.1069000959396362, 2.04538631439209, 1.009070634841919, 1.7656338214874268, 0.7345964908599854, 0.5638244152069092, 0.787468433380127, 1.1775014400482178, 0.6407806873321533, 0.18533086776733398, 0.12956690788269043, 0.7289128303527832, 0.7351412773132324, 0.710111141204834, 0.25348377227783203, 0.08766007423400879, 0.2754007577896118, 1.0254321098327637, 2.430657386779785, 1.84373140335083, 0.6746106147766113, 1.2420754432678223, 0.46428823471069336, 0.6407227516174316, 2.7861387729644775, 1.724259376525879, 1.0960899591445923, 0.4119446277618408, 1.666572093963623, 0.1660022735595703, 0.047364234924316406, 1.7459754943847656, 1.7570366859436035, 0.49973154067993164, 0.5776362419128418, 1.1069798469543457, 0.13724827766418457, 2.0060718059539795, 0.5306909084320068, 0.12119293212890625, 2.2859702110290527, 0.20218920707702637, 1.2211964130401611, 0.18806672096252441, 0.5601259469985962, 1.0093460083007812, 0.12530970573425293, 0.18957161903381348, 0.22331452369689941, 2.3595643043518066, 1.4272799491882324, 0.9306445121765137, 0.1650378704071045, 3.3124477863311768, 2.155884027481079, 0.24688410758972168, 0.919929027557373, 0.03465867042541504, 2.093010902404785, 0.564246416091919, 0.689853310585022, 1.642153024673462, 0.9427127838134766, 0.05409550666809082, 0.1180577278137207, 0.14684653282165527, 1.184600830078125, 0.8124644756317139, 0.18645763397216797, 0.17870616912841797, 0.2545667886734009, 1.0028153657913208, 0.21112275123596191, 0.5439913272857666, 0.606013298034668, 0.5032598972320557, 0.8050687313079834, 3.4980289936065674, 0.5995149612426758], "mean_td_error": 0.9624138474464417, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 57.0, "diff_num_grad_updates_vs_sampler_policy": 56.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.059581756591797, "actor_loss": -8.444634437561035, "critic_loss": 0.20395122468471527, "alpha_loss": -0.1691000908613205, "alpha_value": 0.9833306670188904, "log_alpha_value": -0.01680985651910305, "target_entropy": -6.0, "policy_t": 0.007817861624062061, "mean_q": 4.480698108673096, "max_q": 5.50738000869751, "min_q": 3.7757835388183594}, "td_error": [0.8468441963195801, 0.2501490116119385, 2.729262590408325, 0.019498109817504883, 1.0070996284484863, 2.891958475112915, 3.3199830055236816, 0.7586050033569336, 1.9144160747528076, 1.0293025970458984, 0.5546760559082031, 0.6654295921325684, 2.0909740924835205, 0.7474496364593506, 0.11615490913391113, 0.8105852603912354, 0.22087883949279785, 2.3031609058380127, 0.8803670406341553, 1.1133639812469482, 0.1501169204711914, 0.3424098491668701, 0.3296170234680176, 0.9709229469299316, 0.5932365655899048, 0.942889928817749, 0.29041004180908203, 0.8410460948944092, 0.06505274772644043, 0.7310116291046143, 2.566088914871216, 0.9125068187713623, 0.32379817962646484, 1.3075206279754639, 0.6232388019561768, 0.9467203617095947, 1.5451140403747559, 1.5748982429504395, 0.5704865455627441, 0.7409186363220215, 0.286334753036499, 0.5483250617980957, 1.363433599472046, 0.7245697975158691, 0.11323058605194092, 0.26513731479644775, 0.8203227519989014, 2.4699931144714355, 0.991084098815918, 0.5064332485198975, 0.7733216285705566, 0.13875555992126465, 1.1576260328292847, 1.477997064590454, 1.8013942241668701, 0.7859492301940918, 1.3907439708709717, 2.0206806659698486, 1.3951513767242432, 0.11247611045837402, 2.4332048892974854, 0.9122648239135742, 2.3523454666137695, 1.023390293121338, 0.8545417785644531, 0.7859592437744141, 1.4778387546539307, 1.8906373977661133, 0.6312286853790283, 1.2142486572265625, 1.068040370941162, 1.2321646213531494, 1.6431978940963745, 1.342463731765747, 1.2165052890777588, 0.12555670738220215, 0.9105522632598877, 1.797020673751831, 1.6941354274749756, 0.9573390483856201, 0.118194580078125, 0.1301867961883545, 1.563375473022461, 0.868135929107666, 0.3336527347564697, 0.07854056358337402], "mean_td_error": 1.028323769569397, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 57.0, "diff_num_grad_updates_vs_sampler_policy": 56.0}}, "num_env_steps_sampled": 51968, "num_env_steps_trained": 14706, "num_agent_steps_sampled": 155904, "num_agent_steps_trained": 14706, "last_target_update_ts": 51968, "num_target_updates": 57}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 155904, "num_agent_steps_trained": 14706, "num_env_steps_sampled": 51968, "num_env_steps_trained": 14706, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 479.240954845897, "num_env_steps_trained_throughput_per_sec": 137.9957213730373, "timesteps_total": 51968, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 155904, "timers": {"training_iteration_time_ms": 2108.599, "sample_time_ms": 1502.738, "load_time_ms": 0.542, "load_throughput": 475661.728, "learn_time_ms": 62.21, "learn_throughput": 4147.263, "synch_weights_time_ms": 15.957}, "counters": {"num_env_steps_sampled": 51968, "num_env_steps_trained": 14706, "num_agent_steps_sampled": 155904, "num_agent_steps_trained": 14706, "last_target_update_ts": 51968, "num_target_updates": 57}, "done": false, "episodes_total": 0, "training_iteration": 58, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-16-41", "timestamp": 1700201801, "time_this_iter_s": 1.8844389915466309, "time_total_s": 117.99438333511353, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8c8977f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 117.99438333511353, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 66.5, "ram_util_percent": 90.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.080448150634766, "actor_loss": -9.992193222045898, "critic_loss": 0.30893808603286743, "alpha_loss": -0.17244726419448853, "alpha_value": 0.9830383658409119, "log_alpha_value": -0.017107104882597923, "target_entropy": -6.0, "policy_t": 0.024305228143930435, "mean_q": 5.925559043884277, "max_q": 7.05950927734375, "min_q": 4.866755485534668}, "td_error": [1.1992318630218506, 3.590339183807373, 0.9211654663085938, 4.119571685791016, 0.3244462013244629, 0.27437829971313477, 1.8551530838012695, 0.5147194862365723, 3.3882410526275635, 1.4702794551849365, 0.17565011978149414, 0.34568142890930176, 1.414121389389038, 0.678231954574585, 1.9188504219055176, 0.5757696628570557, 1.2534127235412598, 1.2305777072906494, 0.5874252319335938, 1.0605134963989258, 0.9508998394012451, 0.9686183929443359, 0.3940470218658447, 1.9456608295440674, 1.4645888805389404, 0.3782322406768799, 1.371504783630371, 0.3960249423980713, 0.2890634536743164, 0.4675426483154297, 1.2514467239379883, 1.116626501083374, 0.795478105545044, 0.8011934757232666, 0.4218597412109375, 1.1874709129333496, 0.3943653106689453, 2.561469554901123, 0.17737078666687012, 0.6028790473937988, 0.9322531223297119, 0.4085242748260498, 0.3243088722229004, 1.1907551288604736, 0.9599499702453613, 2.1138644218444824, 1.617422103881836, 1.190969705581665, 0.8533244132995605, 0.9051368236541748, 0.6339831352233887, 0.14728569984436035, 0.4160470962524414, 2.030294179916382, 0.4925830364227295, 2.049415111541748, 1.5983102321624756, 0.48696064949035645, 0.23977065086364746, 1.181042194366455, 0.16826820373535156, 1.7846636772155762, 0.7417211532592773, 2.7710483074188232, 0.6588020324707031, 1.1563947200775146, 1.539466142654419, 0.47895288467407227, 4.25870943069458, 1.9919891357421875, 0.10587382316589355, 1.2020800113677979, 1.718271017074585, 0.03704571723937988, 0.47621750831604004, 0.5752718448638916, 0.4934413433074951, 2.159318447113037, 0.3124392032623291, 0.5904552936553955, 0.14063215255737305, 0.6916546821594238, 2.6814780235290527, 1.1934208869934082, 1.3172893524169922, 1.225989580154419], "mean_td_error": 1.1055487394332886, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 58.0, "diff_num_grad_updates_vs_sampler_policy": 57.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.096513748168945, "actor_loss": -8.412068367004395, "critic_loss": 0.1632993519306183, "alpha_loss": -0.17278148233890533, "alpha_value": 0.9830325841903687, "log_alpha_value": -0.017112985253334045, "target_entropy": -6.0, "policy_t": -0.0006411114591173828, "mean_q": 4.450141906738281, "max_q": 5.4310383796691895, "min_q": 3.7623579502105713}, "td_error": [0.32296180725097656, 1.049973964691162, 1.087526559829712, 1.4919531345367432, 0.23383092880249023, 0.5108999013900757, 0.7677145004272461, 0.11445736885070801, 0.6679081916809082, 1.200699806213379, 2.148512601852417, 2.60219407081604, 0.25804924964904785, 0.9359195232391357, 1.1655442714691162, 1.8683483600616455, 0.4140937328338623, 0.5955208539962769, 0.3992757797241211, 0.2157602310180664, 0.411332368850708, 0.5594708919525146, 0.08314943313598633, 0.07259845733642578, 1.0170762538909912, 1.5273982286453247, 0.9219212532043457, 1.6021792888641357, 0.22765707969665527, 0.6192054748535156, 1.4350342750549316, 2.643138885498047, 1.3081963062286377, 0.13749909400939941, 0.160758376121521, 2.033496141433716, 0.5093424320220947, 0.06485891342163086, 1.1083779335021973, 1.1046711206436157, 0.17732715606689453, 1.615051031112671, 0.24214601516723633, 1.020488977432251, 0.1740361452102661, 0.3321700096130371, 0.34290003776550293, 0.5138895511627197, 0.8791518211364746, 0.8033461570739746, 0.07283902168273926, 1.4034595489501953, 1.2693712711334229, 0.4513981342315674, 0.8983358144760132, 1.2658898830413818, 3.0280537605285645, 1.323225498199463, 0.007860660552978516, 0.045197248458862305, 0.37067508697509766, 1.3956842422485352, 1.272336483001709, 1.1466724872589111, 0.43427228927612305, 0.23926854133605957, 1.317885160446167, 0.6913330554962158, 2.0387558937072754, 1.457620620727539, 1.061399221420288, 1.057239294052124, 1.7738873958587646, 2.530747175216675, 1.1089330911636353, 2.3829052448272705, 0.35027778148651123, 1.0488076210021973, 1.783019781112671, 0.301796555519104, 2.756347179412842, 1.9363245964050293, 0.28549695014953613, 2.0335590839385986, 0.2769145965576172, 1.011962652206421], "mean_td_error": 0.971264660358429, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 58.0, "diff_num_grad_updates_vs_sampler_policy": 57.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.069499969482422, "actor_loss": -8.408041000366211, "critic_loss": 0.21555310487747192, "alpha_loss": -0.17228694260120392, "alpha_value": 0.9830357432365417, "log_alpha_value": -0.017109781503677368, "target_entropy": -6.0, "policy_t": -0.01868894323706627, "mean_q": 4.484318733215332, "max_q": 5.188832759857178, "min_q": 3.808380603790283}, "td_error": [0.83211350440979, 2.1642796993255615, 0.10144233703613281, 0.8481830358505249, 1.0778307914733887, 0.8675558567047119, 1.607147455215454, 1.3053340911865234, 1.5341849327087402, 2.7140374183654785, 0.8271653652191162, 0.45137667655944824, 1.0092098712921143, 1.5407865047454834, 2.4883978366851807, 0.8573923110961914, 1.661222219467163, 1.0055372714996338, 1.5808277130126953, 1.9566376209259033, 1.7158050537109375, 0.7083420753479004, 0.6335878372192383, 1.08143150806427, 0.7866432666778564, 1.7000465393066406, 0.25711989402770996, 1.2438983917236328, 1.3055927753448486, 0.032331228256225586, 0.7283174991607666, 0.503680944442749, 1.4890847206115723, 2.8254120349884033, 0.20307469367980957, 2.099383592605591, 0.09912443161010742, 0.6492784023284912, 1.97336745262146, 0.9122854471206665, 1.0945682525634766, 0.5827808380126953, 0.9086860418319702, 1.9145703315734863, 0.14045214653015137, 0.7734689712524414, 0.8036360740661621, 0.5394299030303955, 0.7118921279907227, 0.6773982048034668, 3.0056073665618896, 1.2576987743377686, 0.29916906356811523, 0.7981317043304443, 1.0458710193634033, 1.203126072883606, 0.16031789779663086, 0.24228405952453613, 1.4129912853240967, 1.2716896533966064, 0.42189812660217285, 1.3516004085540771, 1.9460303783416748, 1.3563034534454346, 0.20239686965942383, 0.4939115047454834, 1.4173462390899658, 0.7272322177886963, 1.6296358108520508, 1.4423210620880127, 1.3434791564941406, 1.0057923793792725, 1.1491398811340332, 0.9129691123962402, 0.9846868515014648, 0.9986162185668945, 1.3542888164520264, 0.17984271049499512, 1.1541551351547241, 0.866924524307251, 2.0384552478790283, 0.20100736618041992, 0.39904332160949707, 2.276811361312866, 0.6941828727722168, 0.897466778755188], "mean_td_error": 1.0891602039337158, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 58.0, "diff_num_grad_updates_vs_sampler_policy": 57.0}}, "num_env_steps_sampled": 52864, "num_env_steps_trained": 14964, "num_agent_steps_sampled": 158592, "num_agent_steps_trained": 14964, "last_target_update_ts": 52864, "num_target_updates": 58}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 158592, "num_agent_steps_trained": 14964, "num_env_steps_sampled": 52864, "num_env_steps_trained": 14964, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 474.3868453553695, "num_env_steps_trained_throughput_per_sec": 136.59799788134524, "timesteps_total": 52864, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 158592, "timers": {"training_iteration_time_ms": 2110.641, "sample_time_ms": 1504.805, "load_time_ms": 0.545, "load_throughput": 473642.243, "learn_time_ms": 62.205, "learn_throughput": 4147.578, "synch_weights_time_ms": 16.12}, "counters": {"num_env_steps_sampled": 52864, "num_env_steps_trained": 14964, "num_agent_steps_sampled": 158592, "num_agent_steps_trained": 14964, "last_target_update_ts": 52864, "num_target_updates": 58}, "done": false, "episodes_total": 0, "training_iteration": 59, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-16-43", "timestamp": 1700201803, "time_this_iter_s": 1.9018762111663818, "time_total_s": 119.89625954627991, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8c8add790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 119.89625954627991, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 86.65, "ram_util_percent": 90.45}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.031330108642578, "actor_loss": -10.067010879516602, "critic_loss": 0.30337804555892944, "alpha_loss": -0.1746135801076889, "alpha_value": 0.9827437996864319, "log_alpha_value": -0.017406823113560677, "target_entropy": -6.0, "policy_t": 0.0066187684424221516, "mean_q": 6.147366523742676, "max_q": 7.341604709625244, "min_q": 5.211831092834473}, "td_error": [1.3753759860992432, 2.6792542934417725, 0.06271529197692871, 0.5752005577087402, 1.6269991397857666, 0.7334988117218018, 0.6224722862243652, 0.9484918117523193, 1.3458600044250488, 1.39825439453125, 1.9899110794067383, 1.6023492813110352, 2.2548511028289795, 0.7247598171234131, 1.2094228267669678, 0.31662511825561523, 1.9149062633514404, 0.1518840789794922, 2.4769935607910156, 1.4832208156585693, 1.071359395980835, 0.9247128963470459, 1.9203131198883057, 1.5733733177185059, 2.23958158493042, 3.5386085510253906, 0.9529402256011963, 0.7266130447387695, 3.1548655033111572, 0.5502066612243652, 1.241652488708496, 0.9937553405761719, 0.5357265472412109, 1.682560682296753, 0.08641910552978516, 0.09381103515625, 0.2077953815460205, 0.1795823574066162, 0.4690713882446289, 0.2153768539428711, 1.4097058773040771, 1.8344919681549072, 0.38602519035339355, 0.22565460205078125, 0.27730250358581543, 1.1844120025634766, 1.292398452758789, 1.4545340538024902, 0.5712847709655762, 0.5866892337799072, 1.0828874111175537, 0.8609631061553955, 0.30605268478393555, 0.6748867034912109, 1.000180959701538, 1.8466873168945312, 0.27341175079345703, 1.2427067756652832, 0.7069759368896484, 2.908457040786743, 2.3912816047668457, 0.8497936725616455, 2.0125350952148438, 1.493499755859375, 1.2628364562988281, 0.6672677993774414, 2.1385180950164795, 1.11083984375, 0.16698288917541504, 0.3722267150878906, 0.4641432762145996, 0.37817883491516113, 1.1039073467254639, 2.2051610946655273, 0.5335187911987305, 0.7661104202270508, 0.8956201076507568, 0.6134884357452393, 1.5341949462890625, 0.8037631511688232, 1.0497279167175293, 1.5818777084350586, 1.0175302028656006, 0.6209044456481934, 0.49251508712768555, 0.9921395778656006], "mean_td_error": 1.1104145050048828, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 59.0, "diff_num_grad_updates_vs_sampler_policy": 58.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.089334487915039, "actor_loss": -8.340843200683594, "critic_loss": 0.17507514357566833, "alpha_loss": -0.17568668723106384, "alpha_value": 0.9827376008033752, "log_alpha_value": -0.01741310954093933, "target_entropy": -6.0, "policy_t": -0.022384122014045715, "mean_q": 4.39436674118042, "max_q": 5.229335308074951, "min_q": 3.7191128730773926}, "td_error": [1.6763741970062256, 0.21282339096069336, 1.7426719665527344, 0.13393807411193848, 1.3960719108581543, 1.5581271648406982, 1.7414846420288086, 0.6166346073150635, 1.437488079071045, 1.4656927585601807, 0.48606419563293457, 0.08742451667785645, 0.6503770351409912, 2.186596155166626, 0.2149348258972168, 0.40385007858276367, 1.3350756168365479, 0.5382766723632812, 0.36849308013916016, 0.892822265625, 1.5352239608764648, 1.245140552520752, 1.0181403160095215, 1.594919204711914, 0.35454893112182617, 1.9342625141143799, 1.3669493198394775, 2.1332154273986816, 1.3909366130828857, 1.212141752243042, 0.31561994552612305, 0.28813254833221436, 0.3146170377731323, 0.08894968032836914, 0.793581485748291, 0.7293715476989746, 0.8658475875854492, 0.43027329444885254, 3.483182430267334, 1.4511504173278809, 2.0105533599853516, 0.21650946140289307, 0.4795873165130615, 2.2351741790771484, 1.0143203735351562, 0.18680620193481445, 0.7392532825469971, 0.36954617500305176, 0.0632925033569336, 0.24706721305847168, 0.6546356678009033, 0.067230224609375, 0.1224890947341919, 0.045711517333984375, 1.510764241218567, 2.1558949947357178, 3.702911138534546, 0.5991072654724121, 0.17537915706634521, 0.6895697116851807, 1.6631803512573242, 1.346512794494629, 0.06875872611999512, 2.4586732387542725, 0.8075971603393555, 0.7815216779708862, 0.510753870010376, 1.926358938217163, 0.17016112804412842, 2.7917044162750244, 1.5223215818405151, 1.7470048666000366, 2.098156690597534, 0.8312869071960449, 0.23457741737365723, 0.3288273811340332, 0.823800802230835, 0.5393855571746826, 0.5437287092208862, 0.7887299060821533, 0.8612620830535889, 0.47727108001708984, 3.0316989421844482, 1.0097870826721191, 0.7356917858123779, 0.3081488609313965], "mean_td_error": 1.0160945653915405, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 59.0, "diff_num_grad_updates_vs_sampler_policy": 58.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.119878768920898, "actor_loss": -8.357365608215332, "critic_loss": 0.1695084273815155, "alpha_loss": -0.17618364095687866, "alpha_value": 0.9827409982681274, "log_alpha_value": -0.017409658059477806, "target_entropy": -6.0, "policy_t": 0.05533412843942642, "mean_q": 4.455948352813721, "max_q": 5.403785228729248, "min_q": 3.7081565856933594}, "td_error": [2.1945207118988037, 1.7597047090530396, 0.07530045509338379, 0.6295228004455566, 1.065416693687439, 0.17891621589660645, 0.8834018707275391, 1.5040209293365479, 0.31673526763916016, 0.0662693977355957, 0.2104017734527588, 0.45891261100769043, 0.23882555961608887, 2.8416476249694824, 0.8105180263519287, 0.3275299072265625, 0.7821002006530762, 2.7124810218811035, 0.3066730499267578, 0.6510541439056396, 1.0315592288970947, 0.7356419563293457, 1.9177801609039307, 1.833148717880249, 1.1475107669830322, 0.22790145874023438, 2.4562342166900635, 0.7145001888275146, 0.9004387855529785, 0.8723225593566895, 1.4566199779510498, 0.7093963623046875, 1.2219343185424805, 1.494351863861084, 1.0970628261566162, 0.9784107208251953, 0.2402172088623047, 1.2857532501220703, 1.2410039901733398, 0.9321494102478027, 0.32964277267456055, 1.3824760913848877, 0.3377823829650879, 0.4546928405761719, 1.5861992835998535, 1.185164451599121, 0.891549825668335, 0.1845536231994629, 0.9729673862457275, 1.6103296279907227, 0.4933760166168213, 0.008197784423828125, 1.9001445770263672, 0.4609346389770508, 0.7897336483001709, 0.8522541522979736, 0.45162248611450195, 0.9956610202789307, 1.2383008003234863, 0.8526148796081543, 0.159448504447937, 1.145851492881775, 1.0951085090637207, 1.3564085960388184, 0.7903859615325928, 1.1503560543060303, 1.0588316917419434, 0.20704007148742676, 1.0640983581542969, 0.4900970458984375, 0.9721724987030029, 0.41242504119873047, 0.7288274765014648, 0.6258964538574219, 0.5171058177947998, 0.058098793029785156, 1.206181526184082, 0.18357229232788086, 1.3627238273620605, 1.9287898540496826, 0.8668727874755859, 0.10210871696472168, 1.2986853122711182, 1.081430435180664, 1.6048340797424316, 0.6927490234375], "mean_td_error": 0.9261183738708496, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 59.0, "diff_num_grad_updates_vs_sampler_policy": 58.0}}, "num_env_steps_sampled": 53760, "num_env_steps_trained": 15222, "num_agent_steps_sampled": 161280, "num_agent_steps_trained": 15222, "last_target_update_ts": 53760, "num_target_updates": 59}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 161280, "num_agent_steps_trained": 15222, "num_env_steps_sampled": 53760, "num_env_steps_trained": 15222, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 479.0267852977474, "num_env_steps_trained_throughput_per_sec": 137.93405201653889, "timesteps_total": 53760, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 161280, "timers": {"training_iteration_time_ms": 2106.734, "sample_time_ms": 1502.322, "load_time_ms": 0.545, "load_throughput": 473476.452, "learn_time_ms": 62.199, "learn_throughput": 4147.951, "synch_weights_time_ms": 15.9}, "counters": {"num_env_steps_sampled": 53760, "num_env_steps_trained": 15222, "num_agent_steps_sampled": 161280, "num_agent_steps_trained": 15222, "last_target_update_ts": 53760, "num_target_updates": 59}, "done": false, "episodes_total": 0, "training_iteration": 60, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-16-45", "timestamp": 1700201805, "time_this_iter_s": 1.8856639862060547, "time_total_s": 121.78192353248596, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8981fa670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 121.78192353248596, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 67.56666666666668, "ram_util_percent": 90.40000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.071901321411133, "actor_loss": -10.14876651763916, "critic_loss": 0.26748913526535034, "alpha_loss": -0.17833751440048218, "alpha_value": 0.9824494123458862, "log_alpha_value": -0.017706438899040222, "target_entropy": -6.0, "policy_t": 0.0872865617275238, "mean_q": 6.210857391357422, "max_q": 7.717920780181885, "min_q": 5.186120510101318}, "td_error": [0.9050376415252686, 0.14299440383911133, 0.16912412643432617, 1.500391960144043, 0.5629441738128662, 2.121161937713623, 1.7354474067687988, 1.2531192302703857, 0.8866636753082275, 0.17954421043395996, 0.7512960433959961, 1.579627513885498, 0.43208742141723633, 1.0607099533081055, 0.3680710792541504, 0.8920795917510986, 0.10096359252929688, 2.24615740776062, 0.2701740264892578, 2.0588672161102295, 0.8605906963348389, 1.9551043510437012, 0.6938118934631348, 2.117199182510376, 1.241471290588379, 0.4459254741668701, 0.4365696907043457, 1.8914079666137695, 1.5168380737304688, 0.2527496814727783, 1.586740493774414, 0.27722668647766113, 1.087050437927246, 1.41322660446167, 1.7221670150756836, 0.5388908386230469, 0.527662992477417, 0.2283322811126709, 3.6673922538757324, 0.7176699638366699, 0.3544623851776123, 0.4728109836578369, 2.724562406539917, 1.9763875007629395, 0.5516612529754639, 0.9240765571594238, 0.1740403175354004, 3.020411729812622, 0.16570281982421875, 0.39156055450439453, 1.4802403450012207, 0.2980623245239258, 1.6364448070526123, 0.6055176258087158, 0.32573890686035156, 2.955537796020508, 1.0019876956939697, 0.46693944931030273, 0.762385368347168, 3.2642130851745605, 0.6408765316009521, 0.24548721313476562, 0.8933186531066895, 1.0056498050689697, 0.7136001586914062, 0.2896692752838135, 0.8283178806304932, 1.32733154296875, 0.2137904167175293, 0.5447933673858643, 0.38371920585632324, 0.42554688453674316, 0.9461865425109863, 0.14317750930786133, 0.9953632354736328, 0.6808285713195801, 2.0127451419830322, 1.3635599613189697, 0.3489673137664795, 0.9262077808380127, 0.6514029502868652, 0.9997496604919434, 1.141559362411499, 1.009385585784912, 1.7412118911743164, 0.8565011024475098], "mean_td_error": 1.0148392915725708, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 60.0, "diff_num_grad_updates_vs_sampler_policy": 59.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.166813850402832, "actor_loss": -8.34170913696289, "critic_loss": 0.1629781574010849, "alpha_loss": -0.1800871044397354, "alpha_value": 0.9824427366256714, "log_alpha_value": -0.01771322824060917, "target_entropy": -6.0, "policy_t": -0.023228783160448074, "mean_q": 4.37891960144043, "max_q": 5.003172397613525, "min_q": 3.801520347595215}, "td_error": [0.054594993591308594, 0.6118414402008057, 0.2836494445800781, 1.0139751434326172, 0.13510262966156006, 0.5024909973144531, 0.8544116020202637, 1.6119422912597656, 1.3569486141204834, 1.0989325046539307, 0.19269633293151855, 0.750779390335083, 0.964362621307373, 1.6531481742858887, 1.303588628768921, 0.8188247680664062, 0.09496736526489258, 1.3857688903808594, 0.6655592918395996, 0.516272783279419, 1.3630526065826416, 2.4841809272766113, 2.6610140800476074, 0.9032313823699951, 0.38667380809783936, 1.9171223640441895, 1.454349398612976, 1.8531224727630615, 0.17278015613555908, 1.7988080978393555, 2.425238609313965, 0.7921913862228394, 0.8320634365081787, 0.3402523994445801, 0.3768453598022461, 1.0570764541625977, 2.407691478729248, 1.4014182090759277, 1.9279453754425049, 0.2405247688293457, 0.27204108238220215, 0.4593055248260498, 0.6026203632354736, 0.6502923965454102, 0.6824977397918701, 2.239914655685425, 0.9262514114379883, 0.4324767589569092, 1.106175184249878, 0.9816098213195801, 0.823573112487793, 1.0356128215789795, 2.034306526184082, 2.033991813659668, 0.0840914249420166, 1.1179649829864502, 1.1764323711395264, 0.9155347347259521, 2.3367385864257812, 0.3214991092681885, 0.7222342491149902, 0.24095165729522705, 1.124152660369873, 0.6716148853302002, 0.07106709480285645, 0.14103484153747559, 0.040142059326171875, 1.1443759202957153, 0.9318327903747559, 1.7891745567321777, 0.07309627532958984, 0.6566648483276367, 0.9473088979721069, 2.6255910396575928, 1.068232774734497, 0.36931848526000977, 0.21054458618164062, 1.139531135559082, 1.5689911842346191, 0.4065256118774414, 0.5206553936004639, 2.4792728424072266, 0.11203420162200928, 0.10712027549743652, 0.7141921520233154, 1.8157849311828613], "mean_td_error": 0.9836025834083557, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 60.0, "diff_num_grad_updates_vs_sampler_policy": 59.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.069007873535156, "actor_loss": -8.33031177520752, "critic_loss": 0.19912496209144592, "alpha_loss": -0.17831826210021973, "alpha_value": 0.9824462532997131, "log_alpha_value": -0.01770961657166481, "target_entropy": -6.0, "policy_t": 0.010685710236430168, "mean_q": 4.37700080871582, "max_q": 5.230594635009766, "min_q": 3.694559335708618}, "td_error": [0.6109619140625, 1.4720714092254639, 0.675908088684082, 1.7085580825805664, 0.22774338722229004, 0.5885598659515381, 1.5378270149230957, 0.03457975387573242, 0.8515141010284424, 1.384486436843872, 0.375140905380249, 0.10997343063354492, 3.0603835582733154, 0.5452739000320435, 0.8103368282318115, 0.8088552951812744, 1.2192022800445557, 1.0114201307296753, 0.910414457321167, 0.4823683500289917, 0.30836808681488037, 0.14101481437683105, 1.3720974922180176, 2.0048587322235107, 1.7727024555206299, 2.3643059730529785, 2.222555160522461, 1.8373031616210938, 1.5880818367004395, 2.3858182430267334, 1.2949180603027344, 2.897340774536133, 0.689141035079956, 0.9356505870819092, 0.1009378433227539, 2.947420835494995, 1.9465134143829346, 0.7155641317367554, 0.8290016651153564, 2.3398585319519043, 1.3773431777954102, 0.10682260990142822, 0.5369431972503662, 1.5302541255950928, 0.18834829330444336, 0.18137753009796143, 0.06528854370117188, 0.8545911312103271, 1.4451905488967896, 1.628112554550171, 2.218411445617676, 1.9487330913543701, 1.2184114456176758, 0.7668054103851318, 0.004275321960449219, 0.2823711633682251, 0.8911787271499634, 1.1588468551635742, 0.9054555892944336, 1.9793360233306885, 0.4271061420440674, 0.8481283187866211, 1.4403481483459473, 0.6391968727111816, 1.0556590557098389, 0.4857149124145508, 0.15624189376831055, 0.7834923267364502, 0.9714608192443848, 0.23037171363830566, 0.23445343971252441, 0.6963839530944824, 1.982999324798584, 0.1626187562942505, 0.31241846084594727, 1.754817008972168, 0.9444224834442139, 0.9737074375152588, 0.8372001647949219, 1.0882704257965088, 0.1035541296005249, 0.520735502243042, 0.17792272567749023, 3.0210769176483154, 0.7968993186950684, 0.12859559059143066], "mean_td_error": 1.036987543106079, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 60.0, "diff_num_grad_updates_vs_sampler_policy": 59.0}}, "num_env_steps_sampled": 54656, "num_env_steps_trained": 15480, "num_agent_steps_sampled": 163968, "num_agent_steps_trained": 15480, "last_target_update_ts": 54656, "num_target_updates": 60}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 163968, "num_agent_steps_trained": 15480, "num_env_steps_sampled": 54656, "num_env_steps_trained": 15480, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 456.81816246871915, "num_env_steps_trained_throughput_per_sec": 131.5391583894303, "timesteps_total": 54656, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 163968, "timers": {"training_iteration_time_ms": 2069.688, "sample_time_ms": 1499.837, "load_time_ms": 0.543, "load_throughput": 475223.061, "learn_time_ms": 62.149, "learn_throughput": 4151.282, "synch_weights_time_ms": 15.883}, "counters": {"num_env_steps_sampled": 54656, "num_env_steps_trained": 15480, "num_agent_steps_sampled": 163968, "num_agent_steps_trained": 15480, "last_target_update_ts": 54656, "num_target_updates": 60}, "done": false, "episodes_total": 0, "training_iteration": 61, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-16-47", "timestamp": 1700201807, "time_this_iter_s": 1.9780161380767822, "time_total_s": 123.75993967056274, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8981fa3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 123.75993967056274, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 70.13333333333333, "ram_util_percent": 90.43333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.059524536132812, "actor_loss": -10.282792091369629, "critic_loss": 0.2912200093269348, "alpha_loss": -0.1811324656009674, "alpha_value": 0.9821550846099854, "log_alpha_value": -0.018006065860390663, "target_entropy": -6.0, "policy_t": -0.0007767758215777576, "mean_q": 6.391838550567627, "max_q": 8.05271053314209, "min_q": 5.415818214416504}, "td_error": [1.8212344646453857, 2.083528995513916, 1.3454337120056152, 0.4908726215362549, 1.4429781436920166, 2.8947865962982178, 1.5453495979309082, 0.6850450038909912, 1.0070834159851074, 1.8058123588562012, 0.17433571815490723, 0.45131373405456543, 1.7054846286773682, 0.6128594875335693, 1.4188425540924072, 0.9657773971557617, 1.2386846542358398, 1.0063073635101318, 2.542320966720581, 1.1201839447021484, 3.080294609069824, 1.648939847946167, 2.1884846687316895, 0.6411187648773193, 1.1004667282104492, 0.8045549392700195, 0.19938969612121582, 2.0663161277770996, 0.7330076694488525, 0.2998051643371582, 0.2720928192138672, 2.0087780952453613, 1.5682718753814697, 0.18364262580871582, 1.0291664600372314, 0.15122652053833008, 0.4354424476623535, 1.6216082572937012, 0.8566141128540039, 0.3064100742340088, 1.675222635269165, 1.460801601409912, 0.42493677139282227, 0.23514986038208008, 0.5411601066589355, 0.4775824546813965, 0.21448612213134766, 0.47717761993408203, 3.0392093658447266, 0.7030718326568604, 1.2069969177246094, 1.9286494255065918, 0.3318145275115967, 1.986522912979126, 1.8807621002197266, 0.48954296112060547, 1.588817834854126, 0.4874882698059082, 1.2945916652679443, 2.340653419494629, 0.7115366458892822, 0.4697296619415283, 0.5318660736083984, 0.2018115520477295, 0.5653567314147949, 0.8638548851013184, 1.382035255432129, 1.94398832321167, 0.524482250213623, 2.0147805213928223, 0.7192068099975586, 0.635181188583374, 2.2364585399627686, 1.5997495651245117, 1.1802425384521484, 0.5385584831237793, 0.8427293300628662, 0.3185112476348877, 0.15962529182434082, 0.5381641387939453, 1.6362950801849365, 1.013674020767212, 1.01957368850708, 0.5167908668518066, 1.1578598022460938, 0.5361344814300537], "mean_td_error": 1.0953104496002197, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 61.0, "diff_num_grad_updates_vs_sampler_policy": 60.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.040218353271484, "actor_loss": -8.285187721252441, "critic_loss": 0.15669310092926025, "alpha_loss": -0.18085983395576477, "alpha_value": 0.982147753238678, "log_alpha_value": -0.01801353506743908, "target_entropy": -6.0, "policy_t": -0.040181294083595276, "mean_q": 4.331007957458496, "max_q": 5.111959457397461, "min_q": 3.8345584869384766}, "td_error": [0.7614345550537109, 1.1806306838989258, 0.1475694179534912, 1.0815553665161133, 0.3423680067062378, 2.3963863849639893, 0.8491840362548828, 1.0272111892700195, 0.30136966705322266, 1.3537278175354004, 1.1531665325164795, 0.6336729526519775, 0.4146084785461426, 1.6005637645721436, 0.8646671772003174, 0.9692808389663696, 0.1251671314239502, 2.078174352645874, 0.7215492725372314, 0.286246657371521, 0.5169341564178467, 1.4703795909881592, 0.6150621175765991, 0.4646737575531006, 1.0143496990203857, 0.5238709449768066, 1.0405025482177734, 0.8246023654937744, 0.6576626300811768, 1.5753083229064941, 1.4204065799713135, 0.20992732048034668, 0.5155155658721924, 0.39974069595336914, 1.473313570022583, 2.0786054134368896, 0.07724213600158691, 0.5177470445632935, 1.5313398838043213, 1.0218567848205566, 1.41427743434906, 0.305513858795166, 0.25529026985168457, 2.651395559310913, 0.16453373432159424, 1.6871616840362549, 0.1638627052307129, 1.7467246055603027, 2.4286582469940186, 0.993567943572998, 3.0421547889709473, 0.23121416568756104, 1.0532281398773193, 0.06802678108215332, 0.9925873279571533, 0.5372257232666016, 1.9800901412963867, 0.44951486587524414, 1.0971875190734863, 1.109420895576477, 0.08815646171569824, 2.327101707458496, 0.3855936527252197, 1.7510013580322266, 1.80741548538208, 0.8435003757476807, 0.24407339096069336, 0.1114957332611084, 1.7530683279037476, 1.3385815620422363, 1.2653906345367432, 1.1856882572174072, 0.7474815845489502, 0.6008152961730957, 0.24962067604064941, 0.2957122325897217, 0.5688900947570801, 0.19336819648742676, 1.06044340133667, 2.6134870052337646, 1.0269756317138672, 0.5962793827056885, 0.7764458656311035, 0.4060699939727783, 0.2945668697357178, 1.2839741706848145], "mean_td_error": 0.958423376083374, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 61.0, "diff_num_grad_updates_vs_sampler_policy": 60.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.092114448547363, "actor_loss": -8.278643608093262, "critic_loss": 0.18638339638710022, "alpha_loss": -0.18175415694713593, "alpha_value": 0.9821516871452332, "log_alpha_value": -0.018009521067142487, "target_entropy": -6.0, "policy_t": 0.002333321375772357, "mean_q": 4.357733249664307, "max_q": 5.363028526306152, "min_q": 3.6003916263580322}, "td_error": [0.061548471450805664, 0.36779117584228516, 0.27840662002563477, 1.1186013221740723, 0.7631204128265381, 1.754157304763794, 0.9373819828033447, 0.49016904830932617, 2.8107824325561523, 0.8063817024230957, 0.30771636962890625, 1.8695390224456787, 0.10147929191589355, 2.179994821548462, 1.1319034099578857, 3.1633408069610596, 1.1984052658081055, 0.41820693016052246, 1.1924726963043213, 1.67537522315979, 1.0883709192276, 2.1030831336975098, 1.7154502868652344, 1.2552452087402344, 0.11176133155822754, 0.1900043487548828, 0.7396121025085449, 0.20973753929138184, 0.9380061626434326, 0.44426679611206055, 1.0543556213378906, 3.3449721336364746, 0.5231835842132568, 1.419464349746704, 0.8120336532592773, 1.1829123497009277, 2.079925537109375, 0.2849076986312866, 1.4686741828918457, 2.4867918491363525, 0.10789346694946289, 0.3879197835922241, 1.6235239505767822, 0.2321617603302002, 0.7369856834411621, 2.2337515354156494, 0.8577616214752197, 1.784337043762207, 0.07499527931213379, 2.617014169692993, 0.8913185596466064, 0.10318207740783691, 1.2271239757537842, 1.776423692703247, 1.7620601654052734, 0.24526667594909668, 1.4224361181259155, 0.1829829216003418, 0.0791018009185791, 1.859576940536499, 0.42806947231292725, 0.7545454502105713, 0.9188313484191895, 2.203204870223999, 1.0317225456237793, 1.3419780731201172, 0.4389772415161133, 1.1511824131011963, 1.3213920593261719, 0.9277427196502686, 0.8925848007202148, 0.2559332847595215, 0.8722217082977295, 0.2270735502243042, 2.9640917778015137, 1.1388695240020752, 0.1512622833251953, 2.2166175842285156, 0.16689252853393555, 0.1550300121307373, 2.0267081260681152, 1.0519722700119019, 2.003472089767456, 1.0416154861450195, 0.9209244251251221, 1.1485192775726318], "mean_td_error": 1.0934510231018066, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 61.0, "diff_num_grad_updates_vs_sampler_policy": 60.0}}, "num_env_steps_sampled": 55552, "num_env_steps_trained": 15738, "num_agent_steps_sampled": 166656, "num_agent_steps_trained": 15738, "last_target_update_ts": 55552, "num_target_updates": 61}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 166656, "num_agent_steps_trained": 15738, "num_env_steps_sampled": 55552, "num_env_steps_trained": 15738, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 406.67487902327815, "num_env_steps_trained_throughput_per_sec": 117.10057900447072, "timesteps_total": 55552, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 166656, "timers": {"training_iteration_time_ms": 2072.703, "sample_time_ms": 1493.007, "load_time_ms": 0.542, "load_throughput": 475933.69, "learn_time_ms": 62.253, "learn_throughput": 4144.393, "synch_weights_time_ms": 16.016}, "counters": {"num_env_steps_sampled": 55552, "num_env_steps_trained": 15738, "num_agent_steps_sampled": 166656, "num_agent_steps_trained": 15738, "last_target_update_ts": 55552, "num_target_updates": 61}, "done": false, "episodes_total": 0, "training_iteration": 62, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-16-49", "timestamp": 1700201809, "time_this_iter_s": 2.2181413173675537, "time_total_s": 125.9780809879303, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8981faaf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 125.9780809879303, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 77.93333333333334, "ram_util_percent": 90.53333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.054162979125977, "actor_loss": -10.320265769958496, "critic_loss": 0.2872196137905121, "alpha_loss": -0.18404820561408997, "alpha_value": 0.981860876083374, "log_alpha_value": -0.018305672332644463, "target_entropy": -6.0, "policy_t": -0.018046656623482704, "mean_q": 6.443211555480957, "max_q": 7.46408748626709, "min_q": 5.519084930419922}, "td_error": [0.15769171714782715, 0.5531718730926514, 1.1485512256622314, 0.340944766998291, 1.599963665008545, 0.2308354377746582, 0.7443678379058838, 0.639481782913208, 1.673917531967163, 1.5359363555908203, 2.232274055480957, 0.5099973678588867, 0.6972661018371582, 1.5098958015441895, 3.011326313018799, 0.2444295883178711, 1.4295203685760498, 1.4691405296325684, 3.529600143432617, 0.3308851718902588, 1.026062250137329, 0.9689102172851562, 0.1262059211730957, 0.2531857490539551, 2.5060172080993652, 2.6748294830322266, 0.13060426712036133, 0.5380637645721436, 1.0117566585540771, 0.2757742404937744, 2.046590805053711, 1.8838143348693848, 1.0570640563964844, 0.4469599723815918, 0.7687509059906006, 0.31449031829833984, 0.42203640937805176, 0.5888762474060059, 3.383826732635498, 0.3459157943725586, 1.108248233795166, 0.474590539932251, 0.5321652889251709, 0.935732364654541, 2.4594082832336426, 1.6752305030822754, 1.501284122467041, 0.5770449638366699, 0.47918224334716797, 0.27557921409606934, 0.2885746955871582, 1.3859992027282715, 0.2276015281677246, 0.9945638179779053, 0.19371914863586426, 0.5499956607818604, 4.403862476348877, 0.9812324047088623, 0.7842526435852051, 0.09911251068115234, 0.5338282585144043, 0.7206223011016846, 1.8822100162506104, 1.4443907737731934, 0.7840235233306885, 1.503631591796875, 0.8700172901153564, 0.8458352088928223, 0.29766273498535156, 0.38368773460388184, 0.46496009826660156, 2.5769994258880615, 1.4959683418273926, 1.377854347229004, 0.9055643081665039, 0.2348775863647461, 0.15691590309143066, 0.9542202949523926, 0.9946532249450684, 1.3380424976348877, 0.39276933670043945, 2.1577723026275635, 0.5818183422088623, 0.33644795417785645, 1.6971099376678467, 1.400944471359253], "mean_td_error": 1.0537109375, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 62.0, "diff_num_grad_updates_vs_sampler_policy": 61.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.177286148071289, "actor_loss": -8.271974563598633, "critic_loss": 0.15468351542949677, "alpha_loss": -0.1863837093114853, "alpha_value": 0.9818530082702637, "log_alpha_value": -0.0183136947453022, "target_entropy": -6.0, "policy_t": -0.041111648082733154, "mean_q": 4.293459892272949, "max_q": 5.216985702514648, "min_q": 3.6221463680267334}, "td_error": [0.22028040885925293, 0.9758378267288208, 0.13228940963745117, 2.163444995880127, 0.07068908214569092, 1.2909053564071655, 0.05088210105895996, 0.27102160453796387, 0.7790079116821289, 1.0840775966644287, 2.4106810092926025, 0.23443341255187988, 1.07956862449646, 1.6215105056762695, 0.22344160079956055, 0.23909735679626465, 0.5899393558502197, 0.20500969886779785, 2.0088438987731934, 0.581039309501648, 0.8493317365646362, 1.3524017333984375, 0.6886754035949707, 2.118584156036377, 1.0171163082122803, 1.4304308891296387, 2.3257970809936523, 0.8200268745422363, 0.32967233657836914, 0.6681396961212158, 0.5550304651260376, 3.2735135555267334, 1.3091931343078613, 1.9845690727233887, 0.022406816482543945, 0.5779428482055664, 0.19374310970306396, 0.06137526035308838, 1.4503463506698608, 0.5362100601196289, 1.6815288066864014, 1.739084005355835, 1.848954200744629, 0.36220288276672363, 0.5152437686920166, 1.1722931861877441, 0.6536893844604492, 1.030477523803711, 0.29358959197998047, 1.3578912019729614, 0.5496640205383301, 0.12302756309509277, 0.32086849212646484, 1.9134132862091064, 1.2259528636932373, 0.24475431442260742, 0.6823978424072266, 0.5590393543243408, 0.3847212791442871, 2.164504051208496, 0.2121295928955078, 0.47507262229919434, 0.6428622007369995, 0.37887001037597656, 0.36457228660583496, 0.3910951614379883, 2.159003257751465, 0.23726511001586914, 1.5304443836212158, 2.7630069255828857, 1.5811502933502197, 1.5662388801574707, 0.7014455795288086, 1.987544059753418, 1.4003429412841797, 0.19908881187438965, 1.2018883228302002, 1.3635590076446533, 0.6931781768798828, 1.7238073348999023, 0.6458480358123779, 0.16460752487182617, 0.2056117057800293, 1.0349338054656982, 0.2350168228149414, 0.9517824649810791], "mean_td_error": 0.9468623995780945, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 62.0, "diff_num_grad_updates_vs_sampler_policy": 61.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.03786849975586, "actor_loss": -8.183773040771484, "critic_loss": 0.16308662295341492, "alpha_loss": -0.18378770351409912, "alpha_value": 0.981857180595398, "log_alpha_value": -0.01830943673849106, "target_entropy": -6.0, "policy_t": -0.003567263949662447, "mean_q": 4.34133768081665, "max_q": 5.278985023498535, "min_q": 3.6598048210144043}, "td_error": [1.187119722366333, 2.0218052864074707, 0.18409061431884766, 0.5165181159973145, 0.1574254035949707, 0.2912132740020752, 0.6251378059387207, 0.8146498203277588, 0.8980512619018555, 1.1175920963287354, 1.1046648025512695, 0.6240484714508057, 0.8420917987823486, 1.4167747497558594, 0.39686107635498047, 2.0621249675750732, 2.614654064178467, 0.46123671531677246, 0.056279897689819336, 0.3313136100769043, 2.1265487670898438, 0.23715662956237793, 0.554265022277832, 0.3097968101501465, 0.18404150009155273, 0.8280801773071289, 0.5635950565338135, 0.8670144081115723, 0.3979072570800781, 2.349900960922241, 1.1496355533599854, 0.19751393795013428, 0.18384599685668945, 0.504284143447876, 0.44002997875213623, 0.3223707675933838, 1.5080311298370361, 2.9520485401153564, 1.2663581371307373, 2.6471831798553467, 0.37195050716400146, 2.5999913215637207, 1.5915000438690186, 1.4489519596099854, 0.5580906867980957, 1.6059870719909668, 1.614093542098999, 1.488316535949707, 2.3029208183288574, 1.7649633884429932, 1.3776825666427612, 2.2738919258117676, 0.48715031147003174, 0.9257714748382568, 0.19605040550231934, 1.1450958251953125, 0.41626667976379395, 1.4854319095611572, 0.44503986835479736, 0.2434396743774414, 2.074084520339966, 1.5060441493988037, 0.17398500442504883, 0.912250280380249, 1.7651057243347168, 0.09234142303466797, 1.503856897354126, 1.1098756790161133, 0.5261797904968262, 1.202393651008606, 0.03199124336242676, 0.05656147003173828, 0.5279254913330078, 0.6860721111297607, 1.288029432296753, 0.3242802619934082, 0.508742094039917, 0.967876672744751, 1.175330400466919, 1.3200603723526, 2.341718912124634, 1.6565582752227783, 1.8397040367126465, 0.685725212097168, 0.14191079139709473, 0.736607551574707], "mean_td_error": 1.0094308853149414, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 62.0, "diff_num_grad_updates_vs_sampler_policy": 61.0}}, "num_env_steps_sampled": 56448, "num_env_steps_trained": 15996, "num_agent_steps_sampled": 169344, "num_agent_steps_trained": 15996, "last_target_update_ts": 56448, "num_target_updates": 62}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 169344, "num_agent_steps_trained": 15996, "num_env_steps_sampled": 56448, "num_env_steps_trained": 15996, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 413.2445079091189, "num_env_steps_trained_throughput_per_sec": 118.99228017918826, "timesteps_total": 56448, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 169344, "timers": {"training_iteration_time_ms": 2068.46, "sample_time_ms": 1490.416, "load_time_ms": 0.545, "load_throughput": 473207.291, "learn_time_ms": 62.325, "learn_throughput": 4139.565, "synch_weights_time_ms": 16.227}, "counters": {"num_env_steps_sampled": 56448, "num_env_steps_trained": 15996, "num_agent_steps_sampled": 169344, "num_agent_steps_trained": 15996, "last_target_update_ts": 56448, "num_target_updates": 62}, "done": false, "episodes_total": 0, "training_iteration": 63, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-16-51", "timestamp": 1700201811, "time_this_iter_s": 2.184539794921875, "time_total_s": 128.16262078285217, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8981fa5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 128.16262078285217, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 80.16666666666667, "ram_util_percent": 90.66666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.095691680908203, "actor_loss": -10.398479461669922, "critic_loss": 0.2974255084991455, "alpha_loss": -0.18783284723758698, "alpha_value": 0.9815667867660522, "log_alpha_value": -0.018605247139930725, "target_entropy": -6.0, "policy_t": 0.03959004208445549, "mean_q": 6.495598316192627, "max_q": 7.7706403732299805, "min_q": 5.595274925231934}, "td_error": [1.7101516723632812, 0.690150260925293, 2.2939059734344482, 0.8257575035095215, 0.790391206741333, 1.7087297439575195, 1.6893410682678223, 0.7537472248077393, 1.6049535274505615, 2.040930986404419, 0.7983427047729492, 0.3074312210083008, 0.9333078861236572, 0.31395673751831055, 2.8865749835968018, 0.42663121223449707, 2.1769156455993652, 0.9662611484527588, 1.6054182052612305, 1.1546669006347656, 1.1985149383544922, 2.4090821743011475, 0.7842676639556885, 1.1621675491333008, 0.42235517501831055, 0.37802577018737793, 1.2291100025177002, 0.6735002994537354, 0.06473565101623535, 2.111727476119995, 1.4973781108856201, 0.8903186321258545, 1.3048253059387207, 2.396634817123413, 1.7873823642730713, 0.10434341430664062, 0.5185890197753906, 1.0076255798339844, 0.19444656372070312, 0.5909111499786377, 1.7629976272583008, 1.4207336902618408, 2.310878276824951, 1.5398051738739014, 0.6335227489471436, 0.8353333473205566, 1.1244595050811768, 0.5263206958770752, 2.148540496826172, 1.1724073886871338, 2.379279851913452, 0.6505684852600098, 0.7582607269287109, 0.12394976615905762, 0.6715707778930664, 0.8172664642333984, 0.11032223701477051, 0.2203202247619629, 1.4121379852294922, 0.2662312984466553, 0.142348051071167, 1.6460354328155518, 0.8499677181243896, 2.6859991550445557, 0.6095931529998779, 1.974726676940918, 0.26600170135498047, 2.1552910804748535, 0.36908674240112305, 1.0354886054992676, 2.6551296710968018, 2.0214102268218994, 0.48578572273254395, 1.1241369247436523, 0.9156954288482666, 1.223783254623413, 0.23703432083129883, 2.1638028621673584, 0.13021111488342285, 0.4223766326904297, 0.7821261882781982, 1.1223132610321045, 0.9922783374786377, 1.394935131072998, 1.3494305610656738, 0.4286987781524658], "mean_td_error": 1.121768593788147, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 63.0, "diff_num_grad_updates_vs_sampler_policy": 62.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.083879470825195, "actor_loss": -8.159666061401367, "critic_loss": 0.16397994756698608, "alpha_loss": -0.1877019852399826, "alpha_value": 0.981558084487915, "log_alpha_value": -0.018614063039422035, "target_entropy": -6.0, "policy_t": -0.003308248706161976, "mean_q": 4.254396915435791, "max_q": 5.116272926330566, "min_q": 3.54988431930542}, "td_error": [1.3716444969177246, 2.37308931350708, 0.14398622512817383, 0.4710066318511963, 0.40092015266418457, 0.7639584541320801, 0.0869288444519043, 0.7402127981185913, 0.19358444213867188, 0.24712538719177246, 1.8109493255615234, 1.576693058013916, 0.5600235462188721, 2.6088666915893555, 2.4144461154937744, 0.07205772399902344, 0.4857003688812256, 0.26946449279785156, 0.47945356369018555, 0.7514791488647461, 0.38383734226226807, 0.8866991996765137, 1.4054527282714844, 1.6348966360092163, 0.2674071788787842, 1.0494623184204102, 0.533787727355957, 1.2202789783477783, 0.681612491607666, 2.4873268604278564, 0.06725883483886719, 1.034374475479126, 0.416961669921875, 1.2703748941421509, 1.6907944679260254, 0.7732576131820679, 0.44005918502807617, 1.3283120393753052, 0.3185555934906006, 1.0106940269470215, 0.9883468151092529, 1.2998102903366089, 0.1037755012512207, 2.293241262435913, 0.7712447643280029, 0.5794253349304199, 1.407341718673706, 1.6320652961730957, 0.48378777503967285, 1.6856988668441772, 1.4600303173065186, 0.3225271701812744, 1.6693940162658691, 0.12368607521057129, 0.8728010654449463, 0.8542342185974121, 2.6283507347106934, 0.7533677816390991, 0.15666353702545166, 0.6192061901092529, 0.23315680027008057, 0.8482046127319336, 1.5511810779571533, 2.139573097229004, 2.1289122104644775, 0.14809954166412354, 1.0276544094085693, 1.4367916584014893, 0.18416452407836914, 1.3379790782928467, 0.8093721866607666, 2.90989351272583, 0.6362444162368774, 0.7034809589385986, 1.3987152576446533, 0.11168527603149414, 0.5138359069824219, 1.5429847240447998, 1.3010668754577637, 0.76158607006073, 1.3785839080810547, 1.4821181297302246, 1.4440314769744873, 0.29715466499328613, 0.19138789176940918, 1.7313337326049805], "mean_td_error": 0.996246337890625, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 63.0, "diff_num_grad_updates_vs_sampler_policy": 62.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.998881340026855, "actor_loss": -8.092907905578613, "critic_loss": 0.14451080560684204, "alpha_loss": -0.1860714554786682, "alpha_value": 0.9815628528594971, "log_alpha_value": -0.018609225749969482, "target_entropy": -6.0, "policy_t": -0.05806458741426468, "mean_q": 4.286226272583008, "max_q": 5.014529705047607, "min_q": 3.5270228385925293}, "td_error": [0.11703681945800781, 0.2989163398742676, 2.044790267944336, 0.3315713405609131, 0.8457403182983398, 0.08394861221313477, 0.931767463684082, 1.0251951217651367, 0.18803930282592773, 0.04412388801574707, 0.5361983776092529, 2.018287181854248, 0.26083827018737793, 1.2241265773773193, 0.9513192176818848, 1.888627290725708, 2.0540244579315186, 0.25937771797180176, 0.3180198669433594, 1.0173180103302002, 0.26617908477783203, 1.6275908946990967, 2.4071309566497803, 1.186039924621582, 1.6354281902313232, 0.4905414581298828, 0.4831571578979492, 1.4042401313781738, 0.7181379795074463, 0.598900318145752, 1.4395763874053955, 0.6808121204376221, 0.1762866973876953, 1.7435638904571533, 1.0521832704544067, 1.0762399435043335, 2.0347726345062256, 0.6967532634735107, 0.16130661964416504, 2.6724693775177, 0.644723653793335, 1.4460453987121582, 0.3750746250152588, 1.768240213394165, 0.3354761600494385, 0.14409232139587402, 0.9527273178100586, 0.76043701171875, 0.13413119316101074, 0.13379478454589844, 2.0605854988098145, 1.4853847026824951, 0.9268072843551636, 1.8855903148651123, 0.6628377437591553, 0.6494189500808716, 0.20301270484924316, 1.8356339931488037, 1.369558334350586, 1.1083154678344727, 0.6959877014160156, 0.7610307931900024, 0.5859135389328003, 1.2784156799316406, 0.9307751655578613, 1.6761860847473145, 0.19677495956420898, 0.2509644031524658, 0.7420766353607178, 0.7105422019958496, 0.025806188583374023, 2.271474838256836, 0.6761124134063721, 1.6815297603607178, 0.2804441452026367, 1.3344264030456543, 0.7214045524597168, 1.0241751670837402, 0.2652311325073242, 0.3014911413192749, 1.1083111763000488, 1.1112661361694336, 1.612546682357788, 2.544797897338867, 0.5350000858306885, 0.08930349349975586], "mean_td_error": 0.9451679587364197, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 63.0, "diff_num_grad_updates_vs_sampler_policy": 62.0}}, "num_env_steps_sampled": 57344, "num_env_steps_trained": 16254, "num_agent_steps_sampled": 172032, "num_agent_steps_trained": 16254, "last_target_update_ts": 57344, "num_target_updates": 63}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 172032, "num_agent_steps_trained": 16254, "num_env_steps_sampled": 57344, "num_env_steps_trained": 16254, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 430.2122093795304, "num_env_steps_trained_throughput_per_sec": 123.87806921865942, "timesteps_total": 57344, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 172032, "timers": {"training_iteration_time_ms": 2009.238, "sample_time_ms": 1434.837, "load_time_ms": 0.554, "load_throughput": 465853.215, "learn_time_ms": 63.321, "learn_throughput": 4074.498, "synch_weights_time_ms": 15.743}, "counters": {"num_env_steps_sampled": 57344, "num_env_steps_trained": 16254, "num_agent_steps_sampled": 172032, "num_agent_steps_trained": 16254, "last_target_update_ts": 57344, "num_target_updates": 63}, "done": false, "episodes_total": 0, "training_iteration": 64, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-16-53", "timestamp": 1700201813, "time_this_iter_s": 2.0992660522460938, "time_total_s": 130.26188683509827, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8981f5670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 130.26188683509827, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 75.26666666666667, "ram_util_percent": 90.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.013057708740234, "actor_loss": -10.413633346557617, "critic_loss": 0.36030787229537964, "alpha_loss": -0.18929582834243774, "alpha_value": 0.9812726974487305, "log_alpha_value": -0.018904898315668106, "target_entropy": -6.0, "policy_t": 0.03516387566924095, "mean_q": 6.541478157043457, "max_q": 7.8875651359558105, "min_q": 5.505312442779541}, "td_error": [3.879849433898926, 1.562812089920044, 1.1514933109283447, 2.439690351486206, 1.1306774616241455, 0.39928531646728516, 0.5079398155212402, 1.1557033061981201, 0.7706379890441895, 0.39036130905151367, 0.6099753379821777, 2.9408791065216064, 1.3844389915466309, 1.15205979347229, 0.6500043869018555, 0.4355790615081787, 0.6357853412628174, 0.21534323692321777, 0.4064004421234131, 1.6763522624969482, 0.8324811458587646, 0.7795875072479248, 1.6853673458099365, 0.3917725086212158, 0.4196140766143799, 1.0502128601074219, 3.378774404525757, 0.8296537399291992, 1.5271813869476318, 1.6049976348876953, 0.5895154476165771, 0.6196882724761963, 0.3509640693664551, 0.6756806373596191, 0.808438777923584, 0.35004186630249023, 0.42917847633361816, 0.3083961009979248, 1.3027262687683105, 0.1266498565673828, 1.0925188064575195, 1.9954171180725098, 0.3594498634338379, 1.0439963340759277, 0.1499783992767334, 1.2221753597259521, 2.5099570751190186, 1.0809171199798584, 0.9054133892059326, 0.678612232208252, 2.567659378051758, 1.6546618938446045, 1.6643362045288086, 0.8620927333831787, 1.181891679763794, 2.07017183303833, 0.23392152786254883, 2.5752832889556885, 1.0415973663330078, 0.6911370754241943, 1.8791911602020264, 0.7248432636260986, 3.9296822547912598, 0.481992244720459, 3.6310086250305176, 0.9400990009307861, 0.6797206401824951, 2.9136576652526855, 0.6674494743347168, 3.2086021900177, 1.2149598598480225, 0.598670482635498, 2.464637517929077, 0.8875198364257812, 1.2155098915100098, 3.4207522869110107, 1.1022558212280273, 0.3318216800689697, 2.002220869064331, 1.227548599243164, 0.2879490852355957, 3.369891881942749, 2.1118602752685547, 1.248894214630127, 0.12856531143188477, 1.3315184116363525], "mean_td_error": 1.269048810005188, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 64.0, "diff_num_grad_updates_vs_sampler_policy": 63.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.055057525634766, "actor_loss": -8.07144546508789, "critic_loss": 0.15284937620162964, "alpha_loss": -0.19018521904945374, "alpha_value": 0.9812633991241455, "log_alpha_value": -0.01891438290476799, "target_entropy": -6.0, "policy_t": -0.008310231380164623, "mean_q": 4.178638458251953, "max_q": 4.889078617095947, "min_q": 3.4516704082489014}, "td_error": [0.48026371002197266, 0.07702243328094482, 1.0959231853485107, 0.8062431812286377, 0.239088773727417, 0.38642072677612305, 2.7008814811706543, 0.16202187538146973, 0.6603245735168457, 0.6346433162689209, 2.394768238067627, 0.6182410717010498, 0.34276282787323, 1.0894157886505127, 0.6424705982208252, 0.12012279033660889, 2.279139518737793, 0.2019423246383667, 0.9913234710693359, 0.1342228651046753, 0.14075231552124023, 1.5497384071350098, 2.0721120834350586, 2.090280771255493, 1.1335878372192383, 0.7004585266113281, 1.592970848083496, 1.8184468746185303, 0.5336499214172363, 0.8828177452087402, 0.9313044548034668, 0.55812668800354, 0.8861370086669922, 1.0161503553390503, 1.1252191066741943, 0.48441505432128906, 2.5196800231933594, 0.0841207504272461, 0.7708454132080078, 0.7707126140594482, 0.5652992725372314, 0.651477575302124, 0.166579008102417, 0.28008389472961426, 0.8004412651062012, 0.2444605827331543, 0.17568159103393555, 1.1989413499832153, 0.5262453556060791, 0.7305310964584351, 2.3106884956359863, 0.11647284030914307, 2.155348300933838, 0.11596274375915527, 2.0249834060668945, 1.1309494972229004, 1.1733022928237915, 0.7870184183120728, 0.3785359859466553, 1.8388229608535767, 0.31143808364868164, 0.7660298347473145, 1.9327726364135742, 1.314407467842102, 0.5010825395584106, 0.09826040267944336, 0.5187915563583374, 0.19794654846191406, 1.1374872922897339, 0.44878435134887695, 1.752490758895874, 2.101069927215576, 2.128218173980713, 0.5851149559020996, 0.5161395072937012, 0.5701713562011719, 1.2804665565490723, 2.0200517177581787, 1.41996431350708, 1.6064929962158203, 1.0865182876586914, 0.932600736618042, 1.004564881324768, 0.38315343856811523, 1.3448455333709717, 0.8997342586517334], "mean_td_error": 0.9528975486755371, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 64.0, "diff_num_grad_updates_vs_sampler_policy": 63.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.02564811706543, "actor_loss": -8.054486274719238, "critic_loss": 0.17073214054107666, "alpha_loss": -0.18957304954528809, "alpha_value": 0.9812688231468201, "log_alpha_value": -0.018908806145191193, "target_entropy": -6.0, "policy_t": -0.0025730447378009558, "mean_q": 4.133699417114258, "max_q": 5.056207180023193, "min_q": 3.5154128074645996}, "td_error": [2.2050487995147705, 0.887183427810669, 0.24257886409759521, 2.51279354095459, 2.8002498149871826, 1.1386604309082031, 0.13538360595703125, 1.1389167308807373, 1.5884559154510498, 0.6580169200897217, 1.6060657501220703, 1.1459720134735107, 0.18125343322753906, 1.8487341403961182, 0.25931262969970703, 1.3518800735473633, 1.0627985000610352, 0.9361703395843506, 1.7113957405090332, 1.9422029256820679, 0.8988174200057983, 1.7190967798233032, 1.3038702011108398, 0.5778912305831909, 1.6598247289657593, 1.191091775894165, 0.11927652359008789, 0.25026416778564453, 2.3901686668395996, 0.08856678009033203, 0.09877562522888184, 1.1559860706329346, 1.7396512031555176, 0.5005168914794922, 0.33278703689575195, 0.1748518943786621, 1.0200920104980469, 0.6368057727813721, 1.0553569793701172, 1.54201340675354, 0.31282126903533936, 1.3297948837280273, 0.8007479906082153, 0.9465465545654297, 2.399432897567749, 0.19988667964935303, 0.29661786556243896, 0.6273529529571533, 0.19474554061889648, 0.9429008960723877, 1.0133012533187866, 0.7760066986083984, 0.53032386302948, 1.485671043395996, 0.7562141418457031, 1.9579870700836182, 0.13867640495300293, 1.245879888534546, 0.8154398202896118, 2.1636390686035156, 0.9272875785827637, 0.33233118057250977, 2.877403736114502, 0.6287643909454346, 0.6702089309692383, 1.1063990592956543, 1.7853071689605713, 0.7578846216201782, 0.6178896427154541, 2.6679718494415283, 0.36667919158935547, 1.7122690677642822, 2.3567912578582764, 0.4858589172363281, 1.675837755203247, 2.2517857551574707, 0.7001974582672119, 0.8136717081069946, 0.6182931661605835, 0.3120081424713135, 0.4737520217895508, 0.627300500869751, 2.18019962310791, 0.18718254566192627, 1.3034672737121582, 0.8862268924713135], "mean_td_error": 1.0705317258834839, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 64.0, "diff_num_grad_updates_vs_sampler_policy": 63.0}}, "num_env_steps_sampled": 58240, "num_env_steps_trained": 16512, "num_agent_steps_sampled": 174720, "num_agent_steps_trained": 16512, "last_target_update_ts": 58240, "num_target_updates": 64}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 174720, "num_agent_steps_trained": 16512, "num_env_steps_sampled": 58240, "num_env_steps_trained": 16512, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 448.27611764667995, "num_env_steps_trained_throughput_per_sec": 129.07950709022703, "timesteps_total": 58240, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 174720, "timers": {"training_iteration_time_ms": 2000.774, "sample_time_ms": 1426.571, "load_time_ms": 0.546, "load_throughput": 472876.434, "learn_time_ms": 62.889, "learn_throughput": 4102.435, "synch_weights_time_ms": 15.847}, "counters": {"num_env_steps_sampled": 58240, "num_env_steps_trained": 16512, "num_agent_steps_sampled": 174720, "num_agent_steps_trained": 16512, "last_target_update_ts": 58240, "num_target_updates": 64}, "done": false, "episodes_total": 0, "training_iteration": 65, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-16-55", "timestamp": 1700201815, "time_this_iter_s": 2.0243589878082275, "time_total_s": 132.2862458229065, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8aa4caee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 132.2862458229065, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 74.89999999999999, "ram_util_percent": 90.86666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.952221870422363, "actor_loss": -10.384331703186035, "critic_loss": 0.34092286229133606, "alpha_loss": -0.19112654030323029, "alpha_value": 0.9809788465499878, "log_alpha_value": -0.019204409793019295, "target_entropy": -6.0, "policy_t": 0.021302631124854088, "mean_q": 6.592535018920898, "max_q": 7.931425094604492, "min_q": 5.608215808868408}, "td_error": [0.6085836887359619, 1.507007122039795, 2.8714828491210938, 0.29561901092529297, 3.0377352237701416, 0.887589693069458, 0.9812335968017578, 1.1600852012634277, 1.824397325515747, 1.672821044921875, 0.5411815643310547, 0.4265310764312744, 3.587752103805542, 0.47908878326416016, 2.17020320892334, 2.6549739837646484, 0.9357078075408936, 1.6570186614990234, 0.8179645538330078, 1.2467446327209473, 1.4237957000732422, 0.47939109802246094, 2.2100517749786377, 2.2529549598693848, 1.436985969543457, 0.927962064743042, 0.3135547637939453, 1.0091266632080078, 1.0533831119537354, 0.9597816467285156, 2.2971673011779785, 0.3226923942565918, 1.7977368831634521, 1.1592366695404053, 1.064286708831787, 0.9181904792785645, 1.2394604682922363, 1.8861732482910156, 0.36707067489624023, 0.38556766510009766, 0.6681830883026123, 2.490309238433838, 0.6603744029998779, 1.7044236660003662, 0.9173316955566406, 0.22870850563049316, 1.7490339279174805, 0.7998361587524414, 2.578624963760376, 1.7198622226715088, 0.2143418788909912, 1.5213100910186768, 0.2852802276611328, 3.4665162563323975, 1.9328467845916748, 1.1276495456695557, 0.2390754222869873, 0.5921530723571777, 0.4619178771972656, 2.0585649013519287, 0.26273393630981445, 0.8659350872039795, 0.8482072353363037, 1.4080917835235596, 1.082111120223999, 0.9744141101837158, 0.19613432884216309, 0.35080766677856445, 0.5052652359008789, 2.101896286010742, 0.6381776332855225, 1.8726754188537598, 0.14672327041625977, 0.259169340133667, 0.8859882354736328, 2.8178372383117676, 0.8247847557067871, 1.6528072357177734, 1.1826720237731934, 2.6129727363586426, 0.7697978019714355, 1.1453630924224854, 1.470705509185791, 0.14544129371643066, 1.0816519260406494, 0.4450194835662842], "mean_td_error": 1.2189769744873047, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 65.0, "diff_num_grad_updates_vs_sampler_policy": 64.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.072014808654785, "actor_loss": -8.020705223083496, "critic_loss": 0.15055066347122192, "alpha_loss": -0.1935296654701233, "alpha_value": 0.9809688329696655, "log_alpha_value": -0.019214589148759842, "target_entropy": -6.0, "policy_t": -0.02565639093518257, "mean_q": 4.108927249908447, "max_q": 4.797896862030029, "min_q": 3.617702007293701}, "td_error": [0.2968735694885254, 0.7162814140319824, 1.2496720552444458, 0.575969934463501, 1.3162403106689453, 0.06649374961853027, 0.4030153751373291, 0.9033739566802979, 2.465334415435791, 0.23802220821380615, 1.0137478113174438, 0.2813704013824463, 1.9595357179641724, 0.06703853607177734, 1.164308786392212, 1.2581220865249634, 0.9318701028823853, 1.103926658630371, 0.4239768981933594, 0.5829389095306396, 1.7996742725372314, 0.2728332281112671, 1.8058319091796875, 0.3746604919433594, 0.14547455310821533, 1.769360065460205, 0.01712048053741455, 0.9246103763580322, 0.12091243267059326, 0.6602996587753296, 1.6505060195922852, 0.897375226020813, 2.5007171630859375, 1.033909797668457, 0.9201741218566895, 1.0613627433776855, 1.1016845703125, 0.9550423622131348, 0.2953181266784668, 1.8965036869049072, 0.8775711059570312, 1.1604379415512085, 2.431809425354004, 0.3668935298919678, 1.7011973857879639, 0.18697726726531982, 0.9446737766265869, 0.3885817527770996, 2.3194446563720703, 0.3668644428253174, 0.5468308925628662, 1.3520399332046509, 0.18968570232391357, 0.5921452045440674, 1.4413747787475586, 1.1569105386734009, 0.11842584609985352, 0.773181676864624, 0.23230266571044922, 0.5154649019241333, 1.0221835374832153, 1.4181926250457764, 0.8992265462875366, 0.41368556022644043, 0.5506224632263184, 0.665684700012207, 0.30956244468688965, 0.17662930488586426, 0.6228733062744141, 0.601186990737915, 1.278320074081421, 1.812410831451416, 1.4202293157577515, 1.2900850772857666, 0.3850278854370117, 2.6587166786193848, 0.8436801433563232, 0.3344411849975586, 2.3602566719055176, 0.5030492544174194, 0.1776055097579956, 0.8468673229217529, 0.961482048034668, 2.244727373123169, 0.8073019981384277, 1.6272916793823242], "mean_td_error": 0.9432051181793213, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 65.0, "diff_num_grad_updates_vs_sampler_policy": 64.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.048744201660156, "actor_loss": -7.957763671875, "critic_loss": 0.18636201322078705, "alpha_loss": -0.19301900267601013, "alpha_value": 0.9809750318527222, "log_alpha_value": -0.0192082691937685, "target_entropy": -6.0, "policy_t": -0.022124841809272766, "mean_q": 4.123633861541748, "max_q": 4.821141242980957, "min_q": 3.38789439201355}, "td_error": [0.40063023567199707, 0.19067764282226562, 0.4910910129547119, 0.9758272171020508, 4.19166374206543, 1.5480761528015137, 0.511279821395874, 0.43224668502807617, 0.08407044410705566, 2.402646541595459, 3.4879865646362305, 0.13151073455810547, 0.8801586627960205, 0.16282200813293457, 0.7592611312866211, 1.3540947437286377, 2.5806639194488525, 0.8009902238845825, 0.2010965347290039, 1.1359411478042603, 1.6324405670166016, 2.6559481620788574, 1.5283021926879883, 1.049118995666504, 0.5741961002349854, 0.16853392124176025, 2.0553879737854004, 0.42288827896118164, 0.15679359436035156, 1.2137112617492676, 0.22787129878997803, 0.6093106269836426, 1.3255470991134644, 0.8480192422866821, 0.229020357131958, 0.42478787899017334, 0.8916444778442383, 1.3086836338043213, 1.0165804624557495, 2.3282358646392822, 3.5040690898895264, 1.294802188873291, 2.129286289215088, 0.22751760482788086, 0.22390413284301758, 1.530775547027588, 0.7671290636062622, 0.13848400115966797, 2.2759108543395996, 1.0134835243225098, 1.012352466583252, 1.0429887771606445, 1.936143398284912, 0.25695085525512695, 1.8441929817199707, 1.2892695665359497, 1.7168267965316772, 0.3062260150909424, 1.3242098093032837, 0.6734340190887451, 0.5766866207122803, 0.3998270034790039, 1.6727924346923828, 0.08767139911651611, 1.187619686126709, 0.8731675148010254, 0.1285567283630371, 1.6153016090393066, 0.8218193054199219, 1.1799885034561157, 1.680084228515625, 3.162461519241333, 0.9181970357894897, 0.6818606853485107, 1.4609012603759766, 1.0921313762664795, 2.441880464553833, 0.7403573989868164, 1.2313835620880127, 0.6648354530334473, 0.6568818092346191, 1.2234222888946533, 1.1190152168273926, 0.3051605224609375, 1.119249939918518, 1.1551285982131958], "mean_td_error": 1.1173732280731201, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 65.0, "diff_num_grad_updates_vs_sampler_policy": 64.0}}, "num_env_steps_sampled": 59136, "num_env_steps_trained": 16770, "num_agent_steps_sampled": 177408, "num_agent_steps_trained": 16770, "last_target_update_ts": 59136, "num_target_updates": 65}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 177408, "num_agent_steps_trained": 16770, "num_env_steps_sampled": 59136, "num_env_steps_trained": 16770, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 453.64336217158024, "num_env_steps_trained_throughput_per_sec": 130.62498598244161, "timesteps_total": 59136, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 177408, "timers": {"training_iteration_time_ms": 1998.343, "sample_time_ms": 1425.221, "load_time_ms": 0.543, "load_throughput": 474722.716, "learn_time_ms": 62.766, "learn_throughput": 4110.501, "synch_weights_time_ms": 15.875}, "counters": {"num_env_steps_sampled": 59136, "num_env_steps_trained": 16770, "num_agent_steps_sampled": 177408, "num_agent_steps_trained": 16770, "last_target_update_ts": 59136, "num_target_updates": 65}, "done": false, "episodes_total": 0, "training_iteration": 66, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-16-57", "timestamp": 1700201817, "time_this_iter_s": 1.9909272193908691, "time_total_s": 134.27717304229736, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8981f5dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 134.27717304229736, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 71.66666666666667, "ram_util_percent": 90.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.07321834564209, "actor_loss": -10.310615539550781, "critic_loss": 0.36272111535072327, "alpha_loss": -0.19646452367305756, "alpha_value": 0.980685293674469, "log_alpha_value": -0.019503647461533546, "target_entropy": -6.0, "policy_t": 0.0016347484197467566, "mean_q": 6.50201416015625, "max_q": 7.7660040855407715, "min_q": 5.356146335601807}, "td_error": [2.6477460861206055, 3.0578510761260986, 2.5758869647979736, 0.9298868179321289, 0.4551718235015869, 2.9653913974761963, 0.1411736011505127, 0.6980886459350586, 1.063234567642212, 0.9343278408050537, 0.2890784740447998, 0.6804842948913574, 0.11413860321044922, 0.4511721134185791, 1.6045095920562744, 1.340796947479248, 0.5386486053466797, 1.4892103672027588, 0.45220065116882324, 3.844541072845459, 0.8796279430389404, 1.4336237907409668, 0.9067656993865967, 1.7963027954101562, 1.02671217918396, 2.6994919776916504, 1.1791939735412598, 2.699385166168213, 1.0916874408721924, 0.5668020248413086, 0.3849201202392578, 0.5897037982940674, 0.23591113090515137, 0.4853184223175049, 0.12450170516967773, 1.1731631755828857, 2.9709033966064453, 0.3296489715576172, 1.6548411846160889, 1.027277946472168, 1.9328343868255615, 0.29629087448120117, 1.5693244934082031, 2.076477289199829, 1.359480857849121, 0.3094921112060547, 0.617121696472168, 1.6877634525299072, 2.213332176208496, 1.0926539897918701, 0.7541882991790771, 1.8809921741485596, 0.3667781352996826, 0.7101113796234131, 2.4032771587371826, 1.3996453285217285, 0.6250083446502686, 2.684030771255493, 2.916736602783203, 0.48547840118408203, 0.8514504432678223, 1.8440651893615723, 1.7620844841003418, 1.1105356216430664, 1.6166186332702637, 1.019026517868042, 1.205549716949463, 0.17699146270751953, 2.638608694076538, 2.186108112335205, 1.4242806434631348, 0.9921562671661377, 0.715040922164917, 0.772646427154541, 0.5411031246185303, 0.31598830223083496, 0.2782561779022217, 0.5638270378112793, 1.8912873268127441, 3.3535945415496826, 0.5573036670684814, 1.7768011093139648, 1.371873378753662, 0.5401771068572998, 2.3038477897644043, 0.15044212341308594], "mean_td_error": 1.2659302949905396, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 66.0, "diff_num_grad_updates_vs_sampler_policy": 65.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.036691665649414, "actor_loss": -7.913998126983643, "critic_loss": 0.1489877700805664, "alpha_loss": -0.19586339592933655, "alpha_value": 0.9806744456291199, "log_alpha_value": -0.01951473578810692, "target_entropy": -6.0, "policy_t": 0.004104370251297951, "mean_q": 4.054741859436035, "max_q": 4.737544536590576, "min_q": 3.461176872253418}, "td_error": [0.1463547945022583, 0.0696021318435669, 0.1945803165435791, 0.20777881145477295, 1.0454013347625732, 1.8917937278747559, 1.5724635124206543, 2.0722949504852295, 1.3750529289245605, 2.289527416229248, 1.1935105323791504, 1.5818005800247192, 0.6288517713546753, 0.7268151044845581, 0.3827850818634033, 0.2523982524871826, 0.40056371688842773, 0.9949671030044556, 0.77736496925354, 0.41664743423461914, 0.12890183925628662, 0.7667036056518555, 0.409679651260376, 0.01071012020111084, 0.1879727840423584, 0.18438124656677246, 1.9627132415771484, 1.611928105354309, 0.2049018144607544, 0.13745498657226562, 0.5569964647293091, 0.7117061614990234, 1.194054365158081, 0.7341020107269287, 1.3272565603256226, 0.5107619762420654, 0.6275899410247803, 0.6903355121612549, 1.1437875032424927, 0.7840516567230225, 0.05610156059265137, 1.3739533424377441, 1.6287477016448975, 4.121126651763916, 1.578366994857788, 1.2635812759399414, 0.7974921464920044, 0.09209251403808594, 0.5755510330200195, 1.4179842472076416, 1.4535679817199707, 1.5110883712768555, 0.8609805107116699, 0.6302028894424438, 1.4367727041244507, 0.16880476474761963, 1.5330151319503784, 1.4871690273284912, 0.4964865446090698, 1.053948163986206, 0.9008156061172485, 1.4215402603149414, 0.859868049621582, 0.15053021907806396, 1.104578971862793, 1.4067564010620117, 1.3689532279968262, 1.1559666395187378, 1.5807245969772339, 1.0643374919891357, 1.066497802734375, 0.22014307975769043, 0.617231011390686, 0.17702114582061768, 1.0592141151428223, 0.8681972026824951, 0.6114771366119385, 0.6298162937164307, 0.1653001308441162, 0.812305212020874, 1.360020637512207, 1.8102480173110962, 1.6369129419326782, 0.21361684799194336, 0.5408978462219238, 0.5309330224990845], "mean_td_error": 0.9183428287506104, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 66.0, "diff_num_grad_updates_vs_sampler_policy": 65.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.146220207214355, "actor_loss": -7.978464603424072, "critic_loss": 0.12895530462265015, "alpha_loss": -0.19792932271957397, "alpha_value": 0.9806813597679138, "log_alpha_value": -0.01950768753886223, "target_entropy": -6.0, "policy_t": -0.08253619819879532, "mean_q": 4.124183654785156, "max_q": 4.737401485443115, "min_q": 3.5797677040100098}, "td_error": [0.6673983335494995, 2.537245750427246, 0.9232676029205322, 0.1977994441986084, 0.958078145980835, 0.3509538173675537, 0.5777943134307861, 1.4548556804656982, 0.4808638095855713, 0.4162280559539795, 0.5059678554534912, 0.9270303249359131, 0.30679333209991455, 0.4804185628890991, 0.6237415075302124, 0.3303263187408447, 1.0283660888671875, 0.9621607065200806, 0.30171430110931396, 0.41997790336608887, 1.1816233396530151, 2.4620232582092285, 0.6678450107574463, 0.4427609443664551, 0.2994811534881592, 0.20518946647644043, 0.691901683807373, 3.786529779434204, 0.8346669673919678, 0.9488900899887085, 1.5458333492279053, 1.2057591676712036, 1.3016126155853271, 1.3420166969299316, 1.394444465637207, 0.4378809928894043, 0.060846924781799316, 0.39023101329803467, 1.2249424457550049, 0.1474846601486206, 0.22012531757354736, 1.3390820026397705, 0.4739419221878052, 0.12285113334655762, 0.31482481956481934, 0.8811510801315308, 0.5495835542678833, 0.6843726634979248, 1.7911412715911865, 0.5531058311462402, 0.5002987384796143, 0.11003899574279785, 1.2838084697723389, 0.4549295902252197, 0.19277286529541016, 0.11025655269622803, 0.9934630393981934, 0.9157817363739014, 1.8633286952972412, 0.6684238910675049, 0.23816466331481934, 0.7793378829956055, 0.17494773864746094, 2.167048454284668, 0.5281672477722168, 2.4321322441101074, 1.3233528137207031, 0.11435770988464355, 0.1305485963821411, 0.7378232479095459, 1.7377203702926636, 0.43542981147766113, 2.134772300720215, 0.39900708198547363, 0.7181839942932129, 0.4968137741088867, 0.7765425443649292, 1.631750464439392, 1.3962807655334473, 0.7128934860229492, 1.6843249797821045, 0.5247474908828735, 1.4260928630828857, 1.5429611206054688, 0.07048904895782471, 0.3617769479751587], "mean_td_error": 0.8572313189506531, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 66.0, "diff_num_grad_updates_vs_sampler_policy": 65.0}}, "num_env_steps_sampled": 60032, "num_env_steps_trained": 17028, "num_agent_steps_sampled": 180096, "num_agent_steps_trained": 17028, "last_target_update_ts": 60032, "num_target_updates": 66}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180096, "num_agent_steps_trained": 17028, "num_env_steps_sampled": 60032, "num_env_steps_trained": 17028, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 398.2829109643265, "num_env_steps_trained_throughput_per_sec": 114.68414177321009, "timesteps_total": 60032, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 180096, "timers": {"training_iteration_time_ms": 2026.739, "sample_time_ms": 1415.09, "load_time_ms": 0.542, "load_throughput": 476122.154, "learn_time_ms": 62.729, "learn_throughput": 4112.924, "synch_weights_time_ms": 15.773}, "counters": {"num_env_steps_sampled": 60032, "num_env_steps_trained": 17028, "num_agent_steps_sampled": 180096, "num_agent_steps_trained": 17028, "last_target_update_ts": 60032, "num_target_updates": 66}, "done": false, "episodes_total": 0, "training_iteration": 67, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-17-00", "timestamp": 1700201820, "time_this_iter_s": 2.265139102935791, "time_total_s": 136.54231214523315, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8aa4ca9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 136.54231214523315, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 67.66666666666667, "ram_util_percent": 90.76666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.007723808288574, "actor_loss": -10.295541763305664, "critic_loss": 0.3029212951660156, "alpha_loss": -0.19818243384361267, "alpha_value": 0.9803918600082397, "log_alpha_value": -0.019802946597337723, "target_entropy": -6.0, "policy_t": 0.02878379449248314, "mean_q": 6.595992088317871, "max_q": 8.088749885559082, "min_q": 5.668233871459961}, "td_error": [0.5936441421508789, 0.8988606929779053, 1.3408994674682617, 0.5775203704833984, 0.0115814208984375, 0.22583961486816406, 0.7791187763214111, 2.463606595993042, 1.9524424076080322, 0.04347372055053711, 0.5014815330505371, 0.3155944347381592, 0.6748042106628418, 0.6003241539001465, 0.4050450325012207, 1.513521671295166, 2.934375286102295, 0.5083582401275635, 0.5827891826629639, 2.1425445079803467, 0.7456631660461426, 0.35986852645874023, 1.342024326324463, 1.4053003787994385, 0.20084023475646973, 0.6777567863464355, 1.8047752380371094, 2.77767014503479, 1.6903479099273682, 0.9971470832824707, 1.1483206748962402, 0.6463844776153564, 1.0727052688598633, 1.186265230178833, 4.137437343597412, 2.6628010272979736, 2.563547372817993, 0.15688705444335938, 0.11749553680419922, 0.5998187065124512, 0.32165074348449707, 0.1545729637145996, 0.30973291397094727, 1.201777696609497, 0.579819917678833, 1.021514892578125, 2.7395899295806885, 1.0212159156799316, 2.8358166217803955, 1.2367327213287354, 1.7585978507995605, 0.17567062377929688, 0.7788193225860596, 2.0909810066223145, 1.715514898300171, 0.8250868320465088, 1.2885997295379639, 0.9034783840179443, 2.2283077239990234, 0.7920591831207275, 0.9916646480560303, 1.1175835132598877, 0.23461270332336426, 0.9824726581573486, 1.3769350051879883, 0.9824881553649902, 0.25841546058654785, 0.6833844184875488, 0.4378798007965088, 1.0865871906280518, 0.8604965209960938, 0.5018739700317383, 0.9978494644165039, 1.60322904586792, 2.575021505355835, 1.3161101341247559, 1.5208938121795654, 1.7346141338348389, 0.5117752552032471, 0.5062873363494873, 1.5123889446258545, 0.15147686004638672, 0.8176813125610352, 2.015410900115967, 0.9521276950836182, 1.1861176490783691], "mean_td_error": 1.1192302703857422, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 67.0, "diff_num_grad_updates_vs_sampler_policy": 66.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0988130569458, "actor_loss": -7.856470108032227, "critic_loss": 0.15812349319458008, "alpha_loss": -0.20010535418987274, "alpha_value": 0.9803802967071533, "log_alpha_value": -0.019814739003777504, "target_entropy": -6.0, "policy_t": 0.0452735498547554, "mean_q": 3.944669246673584, "max_q": 4.755798816680908, "min_q": 3.3252975940704346}, "td_error": [0.7622939348220825, 0.5879906415939331, 0.5604207515716553, 0.5927639007568359, 1.8141599893569946, 0.07563316822052002, 1.305056095123291, 0.09716272354125977, 0.4782160520553589, 0.8025476932525635, 1.7405269145965576, 0.18990540504455566, 0.09115481376647949, 0.5076586008071899, 1.3585014343261719, 1.139399766921997, 0.9562335014343262, 0.9008015394210815, 0.17670345306396484, 0.7628535032272339, 0.5650078058242798, 2.394961357116699, 2.1914093494415283, 0.7591434717178345, 1.5254894495010376, 0.6668921709060669, 1.5862149000167847, 1.3049007654190063, 1.2516088485717773, 0.9419021606445312, 1.0311521291732788, 0.4814249277114868, 1.6014583110809326, 1.1414943933486938, 0.6102120876312256, 1.0905606746673584, 1.4179096221923828, 0.14366137981414795, 0.7346211671829224, 0.6847844123840332, 1.6124937534332275, 0.04468822479248047, 0.3448657989501953, 1.1641393899917603, 0.9066277742385864, 0.18622303009033203, 1.2781654596328735, 0.2136760950088501, 0.2830315828323364, 0.8079339265823364, 3.466978073120117, 0.36878812313079834, 0.6057791709899902, 2.928504467010498, 0.5445469617843628, 1.2397639751434326, 2.6661736965179443, 1.9368598461151123, 1.0586884021759033, 1.3523104190826416, 1.360138177871704, 1.4130374193191528, 2.2120978832244873, 0.11756682395935059, 0.7758466005325317, 0.7445757389068604, 0.970824122428894, 1.1647579669952393, 0.7694993019104004, 0.17421793937683105, 1.8390283584594727, 0.07062482833862305, 0.47734975814819336, 1.2764034271240234, 0.08564233779907227, 1.3983099460601807, 1.218461275100708, 0.3671455383300781, 0.7118784189224243, 1.8402782678604126, 0.4216628074645996, 0.2365790605545044, 2.177049160003662, 0.6483126878738403, 0.23966002464294434, 0.44282984733581543], "mean_td_error": 0.9673117995262146, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 67.0, "diff_num_grad_updates_vs_sampler_policy": 66.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.980104446411133, "actor_loss": -7.857025623321533, "critic_loss": 0.15237757563591003, "alpha_loss": -0.19767902791500092, "alpha_value": 0.9803875684738159, "log_alpha_value": -0.01980731077492237, "target_entropy": -6.0, "policy_t": 0.025998642668128014, "mean_q": 4.0267534255981445, "max_q": 5.027205467224121, "min_q": 3.431459426879883}, "td_error": [0.488386869430542, 1.587385654449463, 0.44334614276885986, 1.341326117515564, 1.2281042337417603, 0.7077183723449707, 0.19886445999145508, 1.552741527557373, 0.9713196754455566, 0.3686189651489258, 1.6645610332489014, 0.14813804626464844, 1.7325383424758911, 0.7378329038619995, 0.16891002655029297, 1.9923148155212402, 2.3288543224334717, 0.1252288818359375, 1.673298954963684, 2.427847385406494, 0.7675808668136597, 1.582647681236267, 0.20567655563354492, 1.0265130996704102, 0.9820799827575684, 1.8001039028167725, 1.0839507579803467, 1.080270528793335, 2.4671616554260254, 0.19756245613098145, 0.08444499969482422, 1.657997488975525, 0.35223913192749023, 0.4620475769042969, 0.16670584678649902, 0.6580550670623779, 0.9945592880249023, 1.9525487422943115, 0.41219162940979004, 1.4843599796295166, 0.595215916633606, 0.15757369995117188, 1.3371915817260742, 0.4281430244445801, 0.6952521800994873, 0.9714531898498535, 0.8891727924346924, 0.6810934543609619, 0.5060341358184814, 0.34192895889282227, 1.2264717817306519, 0.5520215034484863, 0.5498595237731934, 1.014460802078247, 1.7572154998779297, 0.3150213956832886, 0.09761595726013184, 1.1037683486938477, 0.6555114984512329, 0.06997990608215332, 0.962805986404419, 0.8706200122833252, 3.088362693786621, 0.6934884786605835, 1.4769490957260132, 0.6090720891952515, 0.5148452520370483, 0.8132288455963135, 1.1839569807052612, 2.2677485942840576, 1.6842435598373413, 1.2165422439575195, 1.5741524696350098, 1.5922937393188477, 1.1334526538848877, 1.6811503171920776, 0.5690207481384277, 0.5285307168960571, 0.3187847137451172, 0.4430208206176758, 1.2534505128860474, 1.4799330234527588, 0.9154584407806396, 0.34606635570526123, 1.137709379196167, 1.2749273777008057], "mean_td_error": 0.9869864583015442, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 67.0, "diff_num_grad_updates_vs_sampler_policy": 66.0}}, "num_env_steps_sampled": 60928, "num_env_steps_trained": 17286, "num_agent_steps_sampled": 182784, "num_agent_steps_trained": 17286, "last_target_update_ts": 60928, "num_target_updates": 67}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 182784, "num_agent_steps_trained": 17286, "num_env_steps_sampled": 60928, "num_env_steps_trained": 17286, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 499.6921060777383, "num_env_steps_trained_throughput_per_sec": 143.88455733042017, "timesteps_total": 60928, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 182784, "timers": {"training_iteration_time_ms": 2019.093, "sample_time_ms": 1407.304, "load_time_ms": 0.543, "load_throughput": 475410.962, "learn_time_ms": 62.686, "learn_throughput": 4115.758, "synch_weights_time_ms": 16.086}, "counters": {"num_env_steps_sampled": 60928, "num_env_steps_trained": 17286, "num_agent_steps_sampled": 182784, "num_agent_steps_trained": 17286, "last_target_update_ts": 60928, "num_target_updates": 67}, "done": false, "episodes_total": 0, "training_iteration": 68, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-17-02", "timestamp": 1700201822, "time_this_iter_s": 1.8068218231201172, "time_total_s": 138.34913396835327, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8aa4caee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 138.34913396835327, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 62.5, "ram_util_percent": 90.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.973846435546875, "actor_loss": -10.185351371765137, "critic_loss": 0.2533344030380249, "alpha_loss": -0.2004956156015396, "alpha_value": 0.9800985455513, "log_alpha_value": -0.020102135837078094, "target_entropy": -6.0, "policy_t": 0.021435152739286423, "mean_q": 6.556310653686523, "max_q": 7.603855609893799, "min_q": 5.548254489898682}, "td_error": [1.4480764865875244, 0.2562727928161621, 0.9032280445098877, 0.6993124485015869, 0.7980320453643799, 0.19634222984313965, 0.4195554256439209, 1.0687716007232666, 1.506138563156128, 1.217273473739624, 2.3151910305023193, 0.48143935203552246, 2.4420969486236572, 1.1662676334381104, 0.5110194683074951, 0.2684643268585205, 0.33869433403015137, 1.2778708934783936, 0.787952184677124, 0.9554870128631592, 2.047708034515381, 0.2736687660217285, 0.35495424270629883, 1.9243643283843994, 1.4131782054901123, 1.1847050189971924, 2.306488275527954, 0.7809066772460938, 0.48939085006713867, 1.4939396381378174, 2.3750429153442383, 0.19706273078918457, 1.567631721496582, 0.9475069046020508, 0.14223074913024902, 2.3384933471679688, 2.3751718997955322, 1.6401395797729492, 0.21673083305358887, 0.30742454528808594, 1.4513051509857178, 0.4681084156036377, 0.43909621238708496, 0.9508464336395264, 0.5400440692901611, 0.5150799751281738, 1.468954086303711, 1.3258123397827148, 2.2386746406555176, 1.871812343597412, 0.25362229347229004, 0.40438318252563477, 0.2337486743927002, 2.912198305130005, 0.04997110366821289, 0.6427719593048096, 2.3111746311187744, 1.3757355213165283, 1.4124443531036377, 1.3698527812957764, 1.7951626777648926, 2.2574665546417236, 0.04222726821899414, 0.5518438816070557, 2.0361809730529785, 0.7567167282104492, 0.9463660717010498, 0.9414539337158203, 0.2629725933074951, 0.66141676902771, 0.7341902256011963, 1.1634647846221924, 1.2113420963287354, 1.4954514503479004, 0.44974589347839355, 0.3903212547302246, 0.5912048816680908, 2.9193379878997803, 1.59382963180542, 2.322444200515747, 2.052164077758789, 0.29534101486206055, 0.9813196659088135, 3.101477861404419, 3.0455727577209473, 1.1625967025756836], "mean_td_error": 1.1561799049377441, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 68.0, "diff_num_grad_updates_vs_sampler_policy": 67.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.116044998168945, "actor_loss": -7.800785541534424, "critic_loss": 0.15718330442905426, "alpha_loss": -0.20348195731639862, "alpha_value": 0.9800862073898315, "log_alpha_value": -0.020114773884415627, "target_entropy": -6.0, "policy_t": 6.909102376084775e-05, "mean_q": 3.8823962211608887, "max_q": 4.5804901123046875, "min_q": 3.39259672164917}, "td_error": [0.2844799757003784, 1.7112151384353638, 0.7062132358551025, 1.1168878078460693, 0.37425196170806885, 1.3817670345306396, 1.0989762544631958, 0.8243074417114258, 1.6889030933380127, 1.6268517971038818, 1.8628642559051514, 0.4938993453979492, 0.09667444229125977, 0.14591467380523682, 1.4418853521347046, 0.31552577018737793, 0.2098848819732666, 0.973822832107544, 0.1808638572692871, 2.564979076385498, 1.0565173625946045, 0.2359457015991211, 0.12830066680908203, 0.3648747205734253, 0.3437328338623047, 0.2908865213394165, 1.2930583953857422, 0.8024797439575195, 1.1896458864212036, 0.7094582319259644, 0.2514166831970215, 2.7004528045654297, 0.06453585624694824, 2.7382307052612305, 0.15455663204193115, 1.776119589805603, 0.35420942306518555, 1.468053936958313, 0.3949660062789917, 1.5864248275756836, 0.4868885278701782, 2.951237916946411, 0.6520261764526367, 0.5150814056396484, 0.559067964553833, 1.1520357131958008, 1.463437557220459, 0.7909250259399414, 0.6124871969223022, 0.9079866409301758, 0.6111667156219482, 0.6669585704803467, 0.4295930862426758, 0.9503611326217651, 0.8695094585418701, 0.07699930667877197, 1.1273783445358276, 1.9317142963409424, 1.893717646598816, 2.0350770950317383, 0.3000352382659912, 0.21062743663787842, 0.14788782596588135, 0.5615489482879639, 0.7997574806213379, 0.5177431106567383, 2.0229058265686035, 0.9879550933837891, 0.31317973136901855, 0.157812237739563, 2.0647706985473633, 1.2892751693725586, 3.076951503753662, 1.5222121477127075, 0.7585766315460205, 0.44512927532196045, 2.4770567417144775, 0.37303364276885986, 0.4771432876586914, 0.7459747791290283, 1.3704009056091309, 0.5354838371276855, 1.4424183368682861, 0.14263713359832764, 0.8825852870941162, 1.4718698263168335], "mean_td_error": 0.9625890851020813, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 68.0, "diff_num_grad_updates_vs_sampler_policy": 67.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.993760108947754, "actor_loss": -7.767755031585693, "critic_loss": 0.14111989736557007, "alpha_loss": -0.20094150304794312, "alpha_value": 0.9800940752029419, "log_alpha_value": -0.02010669745504856, "target_entropy": -6.0, "policy_t": -0.01544051244854927, "mean_q": 3.9466493129730225, "max_q": 4.62390661239624, "min_q": 3.173647165298462}, "td_error": [0.16102492809295654, 0.49351561069488525, 0.5535606145858765, 1.2675789594650269, 1.6361781358718872, 0.5942163467407227, 0.6082074642181396, 0.2636909484863281, 0.2242567539215088, 2.3592453002929688, 0.09029638767242432, 1.1965417861938477, 0.6185168027877808, 0.2879791259765625, 1.2396748065948486, 2.3177571296691895, 0.6114823818206787, 0.34913015365600586, 1.3330382108688354, 0.1290912628173828, 1.7627158164978027, 0.9947493076324463, 0.6436582803726196, 0.5530637502670288, 0.9499603509902954, 1.9270105361938477, 2.533818006515503, 0.1637669801712036, 0.8234031200408936, 0.26306843757629395, 0.16350972652435303, 0.5080909729003906, 0.7978416681289673, 0.603969931602478, 0.6130117177963257, 0.6479232311248779, 0.698451042175293, 1.5725284814834595, 1.1309082508087158, 0.7623380422592163, 0.31666505336761475, 1.7129473686218262, 1.0137267112731934, 0.8052411079406738, 2.007282018661499, 0.5836480855941772, 0.4632474184036255, 0.7907074689865112, 0.8761777877807617, 0.3383975028991699, 1.6480515003204346, 0.6618599891662598, 1.226372241973877, 1.0823744535446167, 0.05855095386505127, 0.2151484489440918, 0.17229759693145752, 1.1269274950027466, 0.24235248565673828, 2.0247769355773926, 1.2350338697433472, 1.416245460510254, 0.9284912347793579, 2.8706204891204834, 0.6077022552490234, 0.26198601722717285, 1.3486554622650146, 0.7445495128631592, 0.0737156867980957, 0.7870476245880127, 0.7021670341491699, 0.2745633125305176, 2.0112147331237793, 0.2590353488922119, 2.279379367828369, 0.4385737180709839, 1.6484649181365967, 1.8662608861923218, 0.13031721115112305, 1.7659004926681519, 3.184725046157837, 0.6831889152526855, 0.4445655345916748, 0.07122361660003662, 0.2974231243133545, 0.18743085861206055], "mean_td_error": 0.910860538482666, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 68.0, "diff_num_grad_updates_vs_sampler_policy": 67.0}}, "num_env_steps_sampled": 61824, "num_env_steps_trained": 17544, "num_agent_steps_sampled": 185472, "num_agent_steps_trained": 17544, "last_target_update_ts": 61824, "num_target_updates": 68}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 185472, "num_agent_steps_trained": 17544, "num_env_steps_sampled": 61824, "num_env_steps_trained": 17544, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 477.695677524283, "num_env_steps_trained_throughput_per_sec": 137.55076428712613, "timesteps_total": 61824, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 185472, "timers": {"training_iteration_time_ms": 2017.788, "sample_time_ms": 1406.522, "load_time_ms": 0.544, "load_throughput": 473932.655, "learn_time_ms": 62.676, "learn_throughput": 4116.419, "synch_weights_time_ms": 15.875}, "counters": {"num_env_steps_sampled": 61824, "num_env_steps_trained": 17544, "num_agent_steps_sampled": 185472, "num_agent_steps_trained": 17544, "last_target_update_ts": 61824, "num_target_updates": 68}, "done": false, "episodes_total": 0, "training_iteration": 69, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-17-04", "timestamp": 1700201824, "time_this_iter_s": 1.8946430683135986, "time_total_s": 140.24377703666687, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8981f5670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 140.24377703666687, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 64.26666666666667, "ram_util_percent": 90.56666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.024434089660645, "actor_loss": -10.188039779663086, "critic_loss": 0.178970605134964, "alpha_loss": -0.2045099139213562, "alpha_value": 0.9798055291175842, "log_alpha_value": -0.02040114253759384, "target_entropy": -6.0, "policy_t": 0.032634031027555466, "mean_q": 6.512815475463867, "max_q": 7.4893951416015625, "min_q": 5.536262035369873}, "td_error": [2.7657339572906494, 2.0661864280700684, 0.34735965728759766, 0.18213295936584473, 0.6008398532867432, 1.4605927467346191, 0.8733913898468018, 1.3225603103637695, 0.36097145080566406, 1.4858074188232422, 0.6359415054321289, 0.3038182258605957, 1.4693286418914795, 1.3018853664398193, 1.164276123046875, 0.3372471332550049, 1.407259464263916, 1.1642439365386963, 1.9483964443206787, 0.3439774513244629, 0.2216954231262207, 1.1659486293792725, 0.5876402854919434, 1.7465898990631104, 0.3857100009918213, 1.838346004486084, 1.1544544696807861, 2.787386655807495, 0.37203526496887207, 0.214677095413208, 0.806739091873169, 0.2776072025299072, 0.16388392448425293, 0.2665402889251709, 1.0435514450073242, 1.3297083377838135, 1.6697592735290527, 0.7162902355194092, 0.7019598484039307, 1.5049138069152832, 0.1242680549621582, 0.35871148109436035, 1.254371166229248, 1.5353267192840576, 0.38123488426208496, 0.17029190063476562, 0.40076565742492676, 0.22073936462402344, 0.7513794898986816, 1.323387861251831, 0.8557078838348389, 0.8937809467315674, 1.959162712097168, 0.2689671516418457, 1.7121686935424805, 0.308605432510376, 0.5288176536560059, 0.40207743644714355, 0.7065503597259521, 0.2098538875579834, 0.22512125968933105, 0.5518312454223633, 1.6604831218719482, 0.8264980316162109, 0.1313624382019043, 0.19282126426696777, 1.6022944450378418, 0.1577587127685547, 0.24136972427368164, 0.9890105724334717, 0.20122623443603516, 1.0109658241271973, 0.5955367088317871, 3.002746820449829, 1.5278403759002686, 0.9668726921081543, 0.41229844093322754, 0.719963788986206, 1.7816133499145508, 2.0199337005615234, 1.1804823875427246, 2.359248161315918, 1.0431010723114014, 0.546095609664917, 0.6024446487426758, 0.6313769817352295], "mean_td_error": 0.9307425022125244, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 69.0, "diff_num_grad_updates_vs_sampler_policy": 68.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.050178527832031, "actor_loss": -7.689509391784668, "critic_loss": 0.15297868847846985, "alpha_loss": -0.20517320930957794, "alpha_value": 0.9797921180725098, "log_alpha_value": -0.02041487954556942, "target_entropy": -6.0, "policy_t": 0.0044490257278084755, "mean_q": 3.886998414993286, "max_q": 4.429623603820801, "min_q": 3.311072826385498}, "td_error": [0.5643857717514038, 1.2422927618026733, 0.46737825870513916, 1.52511465549469, 1.8347134590148926, 1.2763475179672241, 2.470770835876465, 1.3823658227920532, 1.6799826622009277, 1.1550793647766113, 1.7962464094161987, 1.2881768941879272, 0.8373029232025146, 0.8323767185211182, 0.5628306865692139, 1.1748120784759521, 0.166961669921875, 0.2230309247970581, 0.8308755159378052, 2.2552881240844727, 0.18102312088012695, 1.2754125595092773, 1.2150499820709229, 1.075110673904419, 0.9887856245040894, 1.3188457489013672, 0.6331163644790649, 0.5900858640670776, 0.3321042060852051, 0.9199899435043335, 1.1277790069580078, 0.1344900131225586, 0.435155987739563, 1.2717669010162354, 2.3803672790527344, 1.3250164985656738, 0.1905536651611328, 0.047641754150390625, 2.0751514434814453, 1.3492697477340698, 0.06949639320373535, 1.5201845169067383, 1.6635758876800537, 0.6217514276504517, 1.3357017040252686, 0.19554007053375244, 1.0140931606292725, 0.10571277141571045, 1.1574190855026245, 0.40810346603393555, 1.891658067703247, 1.3265440464019775, 0.20221757888793945, 1.4732249975204468, 0.621427059173584, 0.6822285652160645, 0.7046468257904053, 0.41503310203552246, 0.1843029260635376, 1.6717617511749268, 0.27584147453308105, 0.1178814172744751, 2.184292793273926, 2.1720376014709473, 0.7077670097351074, 0.991095781326294, 0.21402621269226074, 2.656022787094116, 1.3103227615356445, 0.9946939945220947, 0.6757736206054688, 0.251934289932251, 1.343401551246643, 0.6458592414855957, 1.4040331840515137, 0.8656049966812134, 0.32132577896118164, 0.5220891237258911, 0.997759222984314, 0.23911833763122559, 0.09167718887329102, 0.19858980178833008, 1.688583254814148, 0.2595381736755371, 0.657575249671936, 0.626322865486145], "mean_td_error": 0.954777181148529, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 69.0, "diff_num_grad_updates_vs_sampler_policy": 68.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.083748817443848, "actor_loss": -7.7779974937438965, "critic_loss": 0.11840883642435074, "alpha_loss": -0.20576807856559753, "alpha_value": 0.9798008799552917, "log_alpha_value": -0.020405909046530724, "target_entropy": -6.0, "policy_t": 0.0038767268415540457, "mean_q": 3.9050254821777344, "max_q": 4.6080169677734375, "min_q": 3.1680338382720947}, "td_error": [0.5953347682952881, 0.5903040170669556, 0.8756308555603027, 0.9480553865432739, 0.9398159980773926, 0.12942028045654297, 0.46170854568481445, 0.8023265600204468, 0.7704716920852661, 0.10431849956512451, 0.2258923053741455, 0.40201425552368164, 0.6090313196182251, 1.597198247909546, 0.34874939918518066, 0.6122621297836304, 1.064896583557129, 0.6942280530929565, 0.728055477142334, 0.24256682395935059, 0.6097714900970459, 0.4493379592895508, 0.19779932498931885, 0.7703481912612915, 0.3668569326400757, 0.8170957565307617, 0.7990646362304688, 1.4381873607635498, 1.2462763786315918, 2.3618202209472656, 0.9119341373443604, 1.5313549041748047, 0.1558549404144287, 1.228097677230835, 1.4770228862762451, 0.5200228691101074, 0.5894734859466553, 0.4057430028915405, 0.09203410148620605, 1.7993463277816772, 0.23511826992034912, 0.40231966972351074, 0.900174617767334, 1.3978458642959595, 2.0520787239074707, 0.2241734266281128, 0.10012459754943848, 0.10596215724945068, 0.7273565530776978, 0.18396246433258057, 1.3463214635849, 0.8753111362457275, 0.1678234338760376, 2.2144622802734375, 1.6771727800369263, 0.8981891870498657, 1.5400049686431885, 0.1140279769897461, 0.28004980087280273, 1.1897547245025635, 0.24847197532653809, 1.758541464805603, 1.280354380607605, 0.11697077751159668, 0.5379102230072021, 1.2284157276153564, 0.31450438499450684, 1.4003922939300537, 0.37670111656188965, 0.07464098930358887, 0.6417931318283081, 0.06755352020263672, 0.3740427494049072, 2.134624481201172, 2.5368576049804688, 0.3232163190841675, 0.31563901901245117, 0.9708871841430664, 0.3317755460739136, 2.3267135620117188, 0.36839795112609863, 1.1601680517196655, 0.5148036479949951, 2.723113536834717, 0.2798806428909302, 0.8898711204528809], "mean_td_error": 0.8190488815307617, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 69.0, "diff_num_grad_updates_vs_sampler_policy": 68.0}}, "num_env_steps_sampled": 62720, "num_env_steps_trained": 17802, "num_agent_steps_sampled": 188160, "num_agent_steps_trained": 17802, "last_target_update_ts": 62720, "num_target_updates": 69}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 188160, "num_agent_steps_trained": 17802, "num_env_steps_sampled": 62720, "num_env_steps_trained": 17802, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 443.71571374529435, "num_env_steps_trained_throughput_per_sec": 127.76635507397985, "timesteps_total": 62720, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 188160, "timers": {"training_iteration_time_ms": 2032.675, "sample_time_ms": 1417.194, "load_time_ms": 0.542, "load_throughput": 475766.292, "learn_time_ms": 62.667, "learn_throughput": 4117.022, "synch_weights_time_ms": 15.929}, "counters": {"num_env_steps_sampled": 62720, "num_env_steps_trained": 17802, "num_agent_steps_sampled": 188160, "num_agent_steps_trained": 17802, "last_target_update_ts": 62720, "num_target_updates": 69}, "done": false, "episodes_total": 0, "training_iteration": 70, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-17-06", "timestamp": 1700201826, "time_this_iter_s": 2.0350852012634277, "time_total_s": 142.2788622379303, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe868078430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 142.2788622379303, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 73.19999999999999, "ram_util_percent": 90.60000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.054738998413086, "actor_loss": -10.103225708007812, "critic_loss": 0.246469184756279, "alpha_loss": -0.2081342339515686, "alpha_value": 0.979512631893158, "log_alpha_value": -0.020700115710496902, "target_entropy": -6.0, "policy_t": 0.059699803590774536, "mean_q": 6.324373245239258, "max_q": 7.306671619415283, "min_q": 5.299088954925537}, "td_error": [0.8344707489013672, 1.3095948696136475, 1.1425955295562744, 0.9411277770996094, 1.966379165649414, 2.71280574798584, 2.4243881702423096, 0.6283948421478271, 0.7900562286376953, 0.06636667251586914, 1.2751834392547607, 0.08087968826293945, 1.507200002670288, 2.3093504905700684, 1.3915917873382568, 0.47913479804992676, 2.132185459136963, 1.3136982917785645, 0.18266773223876953, 1.7252542972564697, 2.1114747524261475, 1.5785741806030273, 0.8912496566772461, 1.084153175354004, 1.0647461414337158, 1.7312264442443848, 1.053908348083496, 1.1935086250305176, 0.5844583511352539, 1.2053582668304443, 0.43854689598083496, 1.7143042087554932, 0.368818998336792, 0.1943798065185547, 0.0759434700012207, 0.7887120246887207, 0.18859601020812988, 0.28154444694519043, 1.102858304977417, 0.609933614730835, 0.41565442085266113, 1.1767868995666504, 0.9633371829986572, 0.8614015579223633, 1.531693935394287, 0.7107558250427246, 0.5320093631744385, 0.8207442760467529, 2.420034646987915, 0.3499112129211426, 1.143735408782959, 0.7345428466796875, 1.204908847808838, 2.1914222240448, 3.17535662651062, 2.7389936447143555, 0.4681997299194336, 1.382164478302002, 0.45046377182006836, 3.2028017044067383, 0.7661442756652832, 0.491868257522583, 4.316767692565918, 1.0703966617584229, 0.5595517158508301, 0.18330621719360352, 2.288130044937134, 0.7904245853424072, 0.6724917888641357, 1.1763648986816406, 1.2874815464019775, 0.9021563529968262, 0.22000908851623535, 0.41188645362854004, 3.11251163482666, 1.8067708015441895, 0.37982845306396484, 1.547480821609497, 0.6787278652191162, 1.9203710556030273, 0.2768256664276123, 2.0138814449310303, 0.1482071876525879, 0.7414522171020508, 1.505753755569458, 1.029299020767212], "mean_td_error": 1.1656817197799683, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 70.0, "diff_num_grad_updates_vs_sampler_policy": 69.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.082756042480469, "actor_loss": -7.683241844177246, "critic_loss": 0.145990252494812, "alpha_loss": -0.20886307954788208, "alpha_value": 0.9794982075691223, "log_alpha_value": -0.020714880898594856, "target_entropy": -6.0, "policy_t": 0.044275786727666855, "mean_q": 3.758270025253296, "max_q": 4.236252784729004, "min_q": 3.286857843399048}, "td_error": [0.3910636901855469, 1.9356883764266968, 0.5531318187713623, 0.895774245262146, 1.1566064357757568, 0.7853066921234131, 0.10547304153442383, 0.49816763401031494, 1.678550362586975, 0.179665207862854, 0.6201609373092651, 0.4781954288482666, 1.6115081310272217, 2.1264290809631348, 0.9221763610839844, 0.08894896507263184, 3.2586405277252197, 0.5123602151870728, 1.4765092134475708, 1.2122325897216797, 2.0576224327087402, 0.541130781173706, 0.5702207088470459, 2.663175106048584, 2.2971205711364746, 0.5612828731536865, 0.1694546937942505, 1.3830794095993042, 0.43520915508270264, 0.35496044158935547, 0.23331665992736816, 0.35999178886413574, 1.0832641124725342, 0.3130251169204712, 0.5890531539916992, 1.0097559690475464, 0.015120983123779297, 2.4856338500976562, 0.4191974401473999, 1.0513412952423096, 0.23835790157318115, 0.6881047487258911, 0.5600309371948242, 1.8129030466079712, 0.5144052505493164, 0.1517277956008911, 0.11592888832092285, 1.3881263732910156, 0.5618419647216797, 0.6468225717544556, 1.0483018159866333, 0.1331162452697754, 0.8054341077804565, 0.9885309934616089, 0.7342453002929688, 1.6581251621246338, 2.492579936981201, 1.5582011938095093, 0.1225888729095459, 0.8958419561386108, 2.0903358459472656, 0.8649148941040039, 1.346356987953186, 2.0012917518615723, 1.158575415611267, 0.3197133541107178, 0.3581477403640747, 0.24150371551513672, 0.843462347984314, 0.35455334186553955, 0.28231561183929443, 1.0755337476730347, 0.37799620628356934, 0.48953545093536377, 0.29045259952545166, 1.0119421482086182, 1.4460821151733398, 0.28302979469299316, 0.8510822057723999, 0.3996467590332031, 0.8575996160507202, 1.4580411911010742, 0.6389093399047852, 2.250856399536133, 0.38574695587158203, 1.2641513347625732], "mean_td_error": 0.9201923608779907, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 70.0, "diff_num_grad_updates_vs_sampler_policy": 69.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.026214599609375, "actor_loss": -7.710891246795654, "critic_loss": 0.1141737848520279, "alpha_loss": -0.20759473741054535, "alpha_value": 0.9795076847076416, "log_alpha_value": -0.020705195143818855, "target_entropy": -6.0, "policy_t": -0.05934661254286766, "mean_q": 3.842216968536377, "max_q": 4.500455856323242, "min_q": 3.180244207382202}, "td_error": [0.22345435619354248, 1.4390265941619873, 0.8259081840515137, 2.6474289894104004, 0.8915600776672363, 0.7291157245635986, 0.5227416753768921, 0.5078531503677368, 1.2627227306365967, 0.5752007961273193, 1.4047293663024902, 1.8905888795852661, 0.8461297750473022, 0.6622354984283447, 1.2061723470687866, 0.124031662940979, 0.9916529655456543, 0.7162100076675415, 1.0436477661132812, 0.3780409097671509, 0.5404876470565796, 0.3500016927719116, 0.32634854316711426, 0.14285314083099365, 0.18340885639190674, 0.8530375957489014, 1.081791877746582, 0.8931050300598145, 0.6585111618041992, 0.07653284072875977, 0.4397125244140625, 1.1143258810043335, 0.07538819313049316, 0.15046322345733643, 0.2840449810028076, 0.14455413818359375, 0.6103427410125732, 0.5824711322784424, 2.459651231765747, 0.5003798007965088, 0.821894645690918, 1.2459526062011719, 0.07262420654296875, 0.7656122446060181, 0.4023306369781494, 0.35332775115966797, 0.20649933815002441, 1.706292748451233, 0.08532428741455078, 0.5076751708984375, 0.8731932640075684, 1.6684212684631348, 1.0363301038742065, 0.16783249378204346, 1.0949434041976929, 1.0467422008514404, 0.16147267818450928, 1.3122332096099854, 2.095848321914673, 0.09285640716552734, 0.09588885307312012, 0.2389432191848755, 0.595739483833313, 0.5350090265274048, 1.0459755659103394, 0.8877393007278442, 1.2665058374404907, 1.1754074096679688, 0.7626006603240967, 0.39081883430480957, 2.7250280380249023, 2.31105375289917, 0.8438618183135986, 1.4102474451065063, 0.7401010990142822, 0.5958596467971802, 0.22807300090789795, 1.637782096862793, 0.5057971477508545, 1.219651699066162, 0.9250553846359253, 1.3636927604675293, 0.36933016777038574, 1.364766240119934, 0.42664670944213867, 0.1983480453491211], "mean_td_error": 0.8131766319274902, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 70.0, "diff_num_grad_updates_vs_sampler_policy": 69.0}}, "num_env_steps_sampled": 63616, "num_env_steps_trained": 18060, "num_agent_steps_sampled": 190848, "num_agent_steps_trained": 18060, "last_target_update_ts": 63616, "num_target_updates": 70}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 190848, "num_agent_steps_trained": 18060, "num_env_steps_sampled": 63616, "num_env_steps_trained": 18060, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 473.8742099251782, "num_env_steps_trained_throughput_per_sec": 136.45038634006247, "timesteps_total": 63616, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 190848, "timers": {"training_iteration_time_ms": 2025.615, "sample_time_ms": 1409.648, "load_time_ms": 0.539, "load_throughput": 478331.977, "learn_time_ms": 62.605, "learn_throughput": 4121.075, "synch_weights_time_ms": 15.73}, "counters": {"num_env_steps_sampled": 63616, "num_env_steps_trained": 18060, "num_agent_steps_sampled": 190848, "num_agent_steps_trained": 18060, "last_target_update_ts": 63616, "num_target_updates": 70}, "done": false, "episodes_total": 0, "training_iteration": 71, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-17-08", "timestamp": 1700201828, "time_this_iter_s": 1.9067301750183105, "time_total_s": 144.1855924129486, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8981e1280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 144.1855924129486, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 65.36666666666667, "ram_util_percent": 90.90000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.084081649780273, "actor_loss": -10.06977367401123, "critic_loss": 0.231839120388031, "alpha_loss": -0.21175703406333923, "alpha_value": 0.9792197942733765, "log_alpha_value": -0.020999139174818993, "target_entropy": -6.0, "policy_t": 0.01982193998992443, "mean_q": 6.217700481414795, "max_q": 7.383420467376709, "min_q": 5.397775650024414}, "td_error": [1.345536231994629, 0.461031436920166, 0.5589227676391602, 1.1037688255310059, 0.23005032539367676, 1.7505500316619873, 1.7437212467193604, 1.6232481002807617, 0.8584291934967041, 1.6176583766937256, 0.8849728107452393, 0.764380931854248, 0.449505090713501, 0.5711753368377686, 1.9855763912200928, 0.7365665435791016, 0.05153775215148926, 0.5909554958343506, 0.30129384994506836, 0.8021059036254883, 0.7287008762359619, 1.814326524734497, 2.1296207904815674, 0.655519962310791, 0.1173563003540039, 2.6553614139556885, 1.4395809173583984, 0.5804483890533447, 0.5609195232391357, 1.6274807453155518, 4.274276256561279, 0.3869163990020752, 0.07689309120178223, 0.7158899307250977, 1.1203818321228027, 1.0243356227874756, 0.847740650177002, 0.5026488304138184, 3.2098958492279053, 1.597534418106079, 1.153599500656128, 0.4887962341308594, 0.3588836193084717, 2.4665191173553467, 2.514707088470459, 0.27199387550354004, 0.14645051956176758, 2.259931802749634, 0.08356118202209473, 3.323176383972168, 2.2856948375701904, 1.4657254219055176, 0.421985387802124, 1.5834760665893555, 0.4697093963623047, 1.6491856575012207, 1.5869171619415283, 0.14109325408935547, 1.314974308013916, 0.6570403575897217, 0.25148653984069824, 0.49677062034606934, 0.788203239440918, 0.18661904335021973, 0.31223320960998535, 1.7700166702270508, 1.4958479404449463, 0.8048913478851318, 0.5857222080230713, 0.021748065948486328, 1.7462084293365479, 0.16790986061096191, 0.01155710220336914, 1.2582719326019287, 1.9731910228729248, 0.6221518516540527, 0.25009989738464355, 1.0102808475494385, 1.0149147510528564, 2.354186534881592, 0.48427581787109375, 0.18332886695861816, 2.269894599914551, 1.1048753261566162, 0.4630570411682129, 1.7225496768951416], "mean_td_error": 1.0754711627960205, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 71.0, "diff_num_grad_updates_vs_sampler_policy": 70.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.122049331665039, "actor_loss": -7.653057098388672, "critic_loss": 0.15057480335235596, "alpha_loss": -0.2127135694026947, "alpha_value": 0.9792044162750244, "log_alpha_value": -0.021014871075749397, "target_entropy": -6.0, "policy_t": -0.011742672882974148, "mean_q": 3.665872573852539, "max_q": 4.206996440887451, "min_q": 3.183382034301758}, "td_error": [1.9264988899230957, 0.1171875, 3.0049009323120117, 0.24846339225769043, 1.3077768087387085, 1.16121506690979, 1.6925206184387207, 1.3435215950012207, 0.23630380630493164, 0.12102150917053223, 0.02879798412322998, 0.06198608875274658, 0.04691267013549805, 0.28064799308776855, 0.4053177833557129, 0.6173126697540283, 1.069034218788147, 0.2645590305328369, 0.9948916435241699, 0.6677887439727783, 1.530571699142456, 1.5746221542358398, 1.8572998046875, 2.2395291328430176, 0.6474450826644897, 0.21019768714904785, 2.046586513519287, 0.8485198020935059, 0.8648873567581177, 1.457273006439209, 0.5620875358581543, 0.4113723039627075, 0.2341393232345581, 0.04118084907531738, 0.4570484161376953, 0.6800655126571655, 0.17857086658477783, 1.7109030485153198, 1.8208084106445312, 0.21739912033081055, 0.2304990291595459, 0.06011700630187988, 1.2797423601150513, 0.49866175651550293, 0.4350471496582031, 0.3434884548187256, 0.9589928388595581, 0.6025702953338623, 0.23509061336517334, 0.19313549995422363, 0.5849692821502686, 0.8336235284805298, 0.23003029823303223, 1.7072093486785889, 1.0656781196594238, 1.1894994974136353, 0.5438759326934814, 1.306938886642456, 1.6412405967712402, 0.9819585084915161, 1.5357965230941772, 0.8727784156799316, 2.339873790740967, 0.5094518661499023, 0.9422106742858887, 0.6786363124847412, 1.2993773221969604, 0.11221718788146973, 0.054755449295043945, 0.18235337734222412, 1.6500006914138794, 0.8545254468917847, 1.4098409414291382, 0.07192552089691162, 1.07157564163208, 1.2534154653549194, 2.1460561752319336, 0.7112369537353516, 1.989497423171997, 0.7187470197677612, 1.3016605377197266, 0.31158244609832764, 2.533092498779297, 0.22678422927856445, 3.1215834617614746, 1.294220209121704], "mean_td_error": 0.9221247434616089, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 71.0, "diff_num_grad_updates_vs_sampler_policy": 70.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.033992767333984, "actor_loss": -7.671703815460205, "critic_loss": 0.1256764531135559, "alpha_loss": -0.2107580155134201, "alpha_value": 0.9792146682739258, "log_alpha_value": -0.02100440114736557, "target_entropy": -6.0, "policy_t": -0.034751374274492264, "mean_q": 3.7860987186431885, "max_q": 4.542045593261719, "min_q": 3.091261625289917}, "td_error": [0.37054944038391113, 1.4057445526123047, 0.11853432655334473, 0.778688907623291, 1.9698585271835327, 0.22492218017578125, 1.3977665901184082, 0.7723572254180908, 0.5626498460769653, 0.02606213092803955, 0.2578355073928833, 0.6837669610977173, 0.32771217823028564, 0.22815048694610596, 0.746877908706665, 1.2299960851669312, 1.8837734460830688, 0.15154755115509033, 0.15101945400238037, 0.602632999420166, 0.1610705852508545, 0.8819133043289185, 1.556354284286499, 0.6702682971954346, 0.7872116565704346, 0.10782146453857422, 0.4469848871231079, 1.5066074132919312, 0.6686720848083496, 0.5996371507644653, 0.8799858093261719, 0.2578597068786621, 1.6443283557891846, 1.3567672967910767, 0.468234658241272, 0.9991319179534912, 0.651335597038269, 0.9067327976226807, 0.5910459756851196, 0.7304869890213013, 1.1081594228744507, 2.2008798122406006, 0.389931321144104, 0.1393885612487793, 1.4891589879989624, 2.3557653427124023, 0.4023318290710449, 0.7696677446365356, 0.4941422939300537, 0.4913705587387085, 0.5202770233154297, 0.1365361213684082, 1.386948585510254, 0.728168249130249, 1.6791073083877563, 1.9454118013381958, 1.3433181047439575, 0.18142926692962646, 1.394618272781372, 1.9039742946624756, 1.1954270601272583, 0.30192482471466064, 0.7605408430099487, 0.5590924024581909, 1.770941138267517, 3.019618272781372, 0.7035075426101685, 0.06376850605010986, 1.9586865901947021, 0.5050867795944214, 0.8739808797836304, 0.8471884727478027, 0.09744429588317871, 1.1467032432556152, 0.2606748342514038, 1.6013133525848389, 0.8139930963516235, 1.3064700365066528, 2.008535861968994, 0.9089032411575317, 0.1401195526123047, 0.50165855884552, 0.5484218597412109, 0.7866182327270508, 0.05047714710235596, 1.3205119371414185], "mean_td_error": 0.8706405758857727, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 71.0, "diff_num_grad_updates_vs_sampler_policy": 70.0}}, "num_env_steps_sampled": 64512, "num_env_steps_trained": 18318, "num_agent_steps_sampled": 193536, "num_agent_steps_trained": 18318, "last_target_update_ts": 64512, "num_target_updates": 71}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 193536, "num_agent_steps_trained": 18318, "num_env_steps_sampled": 64512, "num_env_steps_trained": 18318, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 483.5754409167161, "num_env_steps_trained_throughput_per_sec": 139.24382115682226, "timesteps_total": 64512, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 193536, "timers": {"training_iteration_time_ms": 1990.579, "sample_time_ms": 1383.527, "load_time_ms": 0.542, "load_throughput": 476143.104, "learn_time_ms": 62.47, "learn_throughput": 4130.007, "synch_weights_time_ms": 15.548}, "counters": {"num_env_steps_sampled": 64512, "num_env_steps_trained": 18318, "num_agent_steps_sampled": 193536, "num_agent_steps_trained": 18318, "last_target_update_ts": 64512, "num_target_updates": 71}, "done": false, "episodes_total": 0, "training_iteration": 72, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-17-09", "timestamp": 1700201829, "time_this_iter_s": 1.868382215499878, "time_total_s": 146.0539746284485, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8aa4caa60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 146.0539746284485, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 83.6, "ram_util_percent": 90.85}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.060335159301758, "actor_loss": -10.000553131103516, "critic_loss": 0.1785770207643509, "alpha_loss": -0.21426786482334137, "alpha_value": 0.9789268970489502, "log_alpha_value": -0.021298281848430634, "target_entropy": -6.0, "policy_t": 0.027301397174596786, "mean_q": 6.301445484161377, "max_q": 7.7482147216796875, "min_q": 5.455342769622803}, "td_error": [0.15329599380493164, 0.23089218139648438, 1.4926562309265137, 0.8479139804840088, 0.5872440338134766, 1.9434082508087158, 1.3024888038635254, 0.7322452068328857, 2.370570421218872, 0.6390516757965088, 0.4800896644592285, 0.729180097579956, 0.21512961387634277, 0.22999119758605957, 0.4151334762573242, 0.42861318588256836, 1.0096688270568848, 2.873870372772217, 0.28800129890441895, 0.41172242164611816, 0.4008357524871826, 1.5885999202728271, 2.362076997756958, 1.4686977863311768, 0.12198090553283691, 0.7756471633911133, 0.5391876697540283, 1.7653086185455322, 0.10094761848449707, 0.4634742736816406, 0.19754528999328613, 1.070202112197876, 0.8042223453521729, 1.6374192237854004, 1.510521650314331, 2.729600191116333, 0.9840841293334961, 0.43308067321777344, 1.2363240718841553, 1.302016258239746, 0.8117868900299072, 0.3179738521575928, 2.1649558544158936, 0.5508670806884766, 2.4242420196533203, 0.4320836067199707, 0.1989128589630127, 1.5395195484161377, 1.5585384368896484, 0.32427453994750977, 0.48436546325683594, 0.2448132038116455, 1.3649916648864746, 0.27251601219177246, 0.2690865993499756, 0.5773053169250488, 0.2017078399658203, 0.4264566898345947, 1.8587417602539062, 0.7339160442352295, 1.8923401832580566, 0.4639410972595215, 3.0362277030944824, 0.39464759826660156, 0.43577003479003906, 0.927800178527832, 0.4266190528869629, 2.0042269229888916, 0.09909725189208984, 1.1158761978149414, 0.26842164993286133, 1.1082603931427002, 0.8887090682983398, 0.9335393905639648, 0.5144176483154297, 1.616020679473877, 0.7752590179443359, 1.7747361660003662, 0.6926381587982178, 0.8072917461395264, 0.29665470123291016, 1.2819762229919434, 0.07587337493896484, 0.44765138626098633, 0.42989397048950195, 0.48590588569641113], "mean_td_error": 0.9165557026863098, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 72.0, "diff_num_grad_updates_vs_sampler_policy": 71.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.113725662231445, "actor_loss": -7.638218879699707, "critic_loss": 0.1373966932296753, "alpha_loss": -0.21557359397411346, "alpha_value": 0.9789106249809265, "log_alpha_value": -0.02131495252251625, "target_entropy": -6.0, "policy_t": 0.015449599362909794, "mean_q": 3.7044930458068848, "max_q": 4.24939489364624, "min_q": 3.226151704788208}, "td_error": [0.9457213878631592, 0.1741189956665039, 0.7772130966186523, 1.8759822845458984, 1.9196722507476807, 0.2972460985183716, 0.7494559288024902, 0.7213860750198364, 0.2828991413116455, 1.605883002281189, 0.11695563793182373, 0.9696593284606934, 1.0219448804855347, 0.27255380153656006, 1.6953250169754028, 1.125960350036621, 1.6663135290145874, 0.13937091827392578, 0.06212878227233887, 0.07623016834259033, 0.42866945266723633, 2.6380958557128906, 2.02317476272583, 0.15420031547546387, 0.6573653221130371, 1.1942808628082275, 2.0762534141540527, 0.1748518943786621, 0.8301502466201782, 0.5382146835327148, 0.6891447305679321, 0.4056415557861328, 0.17801356315612793, 0.7695817947387695, 0.04976081848144531, 0.3913567066192627, 1.4547233581542969, 0.8492406606674194, 0.18823504447937012, 1.0967392921447754, 2.213029623031616, 0.27730727195739746, 0.5143423080444336, 0.103851318359375, 1.3813111782073975, 0.4868948459625244, 0.9238786697387695, 1.4608004093170166, 1.0506582260131836, 0.4636986255645752, 2.07997727394104, 0.15828347206115723, 0.3713270425796509, 0.4658559560775757, 1.2577407360076904, 1.2442293167114258, 0.8954098224639893, 0.7989988327026367, 0.25697267055511475, 0.856696605682373, 0.8702232837677002, 1.5779207944869995, 2.5625839233398438, 0.061348795890808105, 0.12977123260498047, 1.5309648513793945, 0.8086714744567871, 1.1581990718841553, 0.5213747024536133, 2.1216297149658203, 0.764428973197937, 0.7697771787643433, 1.336696982383728, 0.21063637733459473, 0.2463979721069336, 1.1084061861038208, 2.0095090866088867, 0.9760168790817261, 0.5404069423675537, 0.7866418361663818, 1.0721486806869507, 0.6098110675811768, 0.6577305793762207, 2.228558301925659, 0.2805793285369873, 0.7927929162979126], "mean_td_error": 0.8869557976722717, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 72.0, "diff_num_grad_updates_vs_sampler_policy": 71.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.098763465881348, "actor_loss": -7.656646728515625, "critic_loss": 0.1269250512123108, "alpha_loss": -0.21513958275318146, "alpha_value": 0.9789217710494995, "log_alpha_value": -0.021303558722138405, "target_entropy": -6.0, "policy_t": -0.033487360924482346, "mean_q": 3.7998366355895996, "max_q": 4.479532718658447, "min_q": 3.0789668560028076}, "td_error": [0.2555164098739624, 1.0794007778167725, 0.7227144241333008, 1.3389692306518555, 0.6738693714141846, 0.8909897804260254, 1.1623283624649048, 0.4483072757720947, 1.4389910697937012, 2.333436965942383, 0.7654967308044434, 1.0202604532241821, 1.2585340738296509, 0.32060980796813965, 0.19339501857757568, 0.6383341550827026, 0.022075533866882324, 0.9752511978149414, 0.04911231994628906, 0.8329377174377441, 0.12992417812347412, 0.3788260221481323, 0.29450953006744385, 1.4503169059753418, 1.5485557317733765, 0.6864883899688721, 0.797244668006897, 1.0119588375091553, 0.711575984954834, 0.8337914943695068, 0.06310415267944336, 1.259157419204712, 0.19079828262329102, 0.3829319477081299, 1.2909398078918457, 1.8020269870758057, 0.15194952487945557, 1.2315669059753418, 0.3797628879547119, 0.9002671241760254, 0.7900944948196411, 0.4686228036880493, 0.9701571464538574, 0.16721022129058838, 0.5661298036575317, 1.1959073543548584, 1.1972339153289795, 1.6928411722183228, 2.555799722671509, 0.6276726722717285, 0.2490224838256836, 0.1699289083480835, 1.7013885974884033, 2.0529019832611084, 2.666524887084961, 1.0718432664871216, 0.625507116317749, 1.0021809339523315, 0.14812207221984863, 1.4187626838684082, 0.2173975706100464, 1.6706463098526, 0.16548633575439453, 0.2789790630340576, 0.7319917678833008, 1.8505463600158691, 0.48415350914001465, 0.840929388999939, 0.4508178234100342, 1.599753975868225, 0.6605215072631836, 1.8375433683395386, 0.11947894096374512, 0.6534851789474487, 2.044261932373047, 0.7292170524597168, 0.9289945363998413, 1.8178430795669556, 0.5049676895141602, 0.23547601699829102, 0.10392534732818604, 1.8806246519088745, 1.6127148866653442, 0.2249072790145874, 0.48230183124542236, 0.5289809703826904], "mean_td_error": 0.8826746344566345, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 72.0, "diff_num_grad_updates_vs_sampler_policy": 71.0}}, "num_env_steps_sampled": 65408, "num_env_steps_trained": 18576, "num_agent_steps_sampled": 196224, "num_agent_steps_trained": 18576, "last_target_update_ts": 65408, "num_target_updates": 72}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 196224, "num_agent_steps_trained": 18576, "num_env_steps_sampled": 65408, "num_env_steps_trained": 18576, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 478.00105340691664, "num_env_steps_trained_throughput_per_sec": 137.63869618190233, "timesteps_total": 65408, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 196224, "timers": {"training_iteration_time_ms": 1961.202, "sample_time_ms": 1353.96, "load_time_ms": 0.54, "load_throughput": 478120.634, "learn_time_ms": 62.258, "learn_throughput": 4144.072, "synch_weights_time_ms": 15.474}, "counters": {"num_env_steps_sampled": 65408, "num_env_steps_trained": 18576, "num_agent_steps_sampled": 196224, "num_agent_steps_trained": 18576, "last_target_update_ts": 65408, "num_target_updates": 72}, "done": false, "episodes_total": 0, "training_iteration": 73, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-17-11", "timestamp": 1700201831, "time_this_iter_s": 1.8888301849365234, "time_total_s": 147.942804813385, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8c884d0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 147.942804813385, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 64.56666666666666, "ram_util_percent": 90.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.078608512878418, "actor_loss": -9.910696029663086, "critic_loss": 0.17462921142578125, "alpha_loss": -0.2176724523305893, "alpha_value": 0.9786340594291687, "log_alpha_value": -0.021597471088171005, "target_entropy": -6.0, "policy_t": 0.06612405925989151, "mean_q": 6.147775173187256, "max_q": 7.689791202545166, "min_q": 5.218365669250488}, "td_error": [0.4091796875, 1.069528579711914, 1.0575132369995117, 3.1928720474243164, 0.11359882354736328, 0.19233441352844238, 1.915673017501831, 1.917860984802246, 0.22545957565307617, 2.466602087020874, 0.3035597801208496, 0.5288448333740234, 0.11139464378356934, 0.9599347114562988, 0.25900697708129883, 0.48247480392456055, 1.1895241737365723, 1.0613038539886475, 0.4829120635986328, 0.704315185546875, 1.4400646686553955, 0.204268217086792, 0.45775699615478516, 0.9924399852752686, 0.4595673084259033, 1.0247597694396973, 0.6734945774078369, 1.8209595680236816, 0.7765529155731201, 1.7463569641113281, 0.365462064743042, 0.3467273712158203, 0.4604494571685791, 1.2792677879333496, 0.25205230712890625, 0.22527575492858887, 1.7109220027923584, 1.1139788627624512, 1.7201189994812012, 0.294513463973999, 0.9921684265136719, 0.2368144989013672, 0.7796604633331299, 0.8357880115509033, 0.2335829734802246, 0.41068339347839355, 1.8469336032867432, 0.25706052780151367, 1.5814855098724365, 1.781644344329834, 0.5278782844543457, 0.9321389198303223, 0.8490645885467529, 0.6423766613006592, 1.5803215503692627, 1.7370922565460205, 0.07024502754211426, 1.1032021045684814, 0.8292574882507324, 0.4694828987121582, 0.6955611705780029, 0.17819833755493164, 0.705883264541626, 0.3388345241546631, 0.5646202564239502, 0.2297685146331787, 2.5471088886260986, 0.20830845832824707, 1.8679676055908203, 1.6013669967651367, 0.413607120513916, 1.6469345092773438, 0.9335498809814453, 2.449423313140869, 0.5345919132232666, 0.6374437808990479, 2.2079837322235107, 0.46230030059814453, 0.1939096450805664, 1.5278871059417725, 1.2883315086364746, 0.9356143474578857, 0.6588723659515381, 0.0968179702758789, 1.0156004428863525, 0.9503111839294434], "mean_td_error": 0.9139134883880615, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 73.0, "diff_num_grad_updates_vs_sampler_policy": 72.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.072555541992188, "actor_loss": -7.5486860275268555, "critic_loss": 0.11628232151269913, "alpha_loss": -0.21771922707557678, "alpha_value": 0.9786168336868286, "log_alpha_value": -0.02161509357392788, "target_entropy": -6.0, "policy_t": -0.031538575887680054, "mean_q": 3.6452245712280273, "max_q": 4.227916240692139, "min_q": 3.106210947036743}, "td_error": [0.09801590442657471, 1.3876193761825562, 0.9457777738571167, 1.1998239755630493, 0.4810621738433838, 0.48398756980895996, 0.2641962766647339, 0.3176997900009155, 1.9740866422653198, 0.3298379182815552, 0.6846117973327637, 0.2466292381286621, 1.2067267894744873, 0.15550971031188965, 0.09520888328552246, 0.09313702583312988, 1.372681975364685, 0.18561828136444092, 0.171675443649292, 0.06392931938171387, 0.4812201261520386, 0.39321720600128174, 0.09592914581298828, 1.0060142278671265, 0.7912802696228027, 2.235576868057251, 0.40702271461486816, 0.41767311096191406, 2.3832449913024902, 1.0132173299789429, 0.07146739959716797, 0.3910026550292969, 0.8089567422866821, 1.1409070491790771, 1.3960484266281128, 1.9879330396652222, 0.19088447093963623, 0.2950167655944824, 0.47164952754974365, 0.7564845085144043, 0.0830545425415039, 1.6435420513153076, 0.16105246543884277, 0.04072427749633789, 0.09512722492218018, 0.1685173511505127, 1.72789466381073, 2.389967203140259, 0.9940768480300903, 0.0681755542755127, 0.5259386301040649, 0.8404693603515625, 0.8564884662628174, 1.0481410026550293, 3.0379371643066406, 2.289660692214966, 0.4867706298828125, 0.10390079021453857, 1.4673233032226562, 0.2638031244277954, 0.8566644191741943, 0.9744848012924194, 1.804369568824768, 0.1394435167312622, 0.05822098255157471, 1.5397793054580688, 1.6257939338684082, 1.025745153427124, 0.73504638671875, 1.2107000350952148, 0.2441037893295288, 0.15028631687164307, 0.646263837814331, 0.13528680801391602, 1.0844874382019043, 0.09059798717498779, 0.06209290027618408, 0.4333862066268921, 0.3761899471282959, 0.17020666599273682, 1.3751810789108276, 0.44493067264556885, 0.8203288316726685, 1.2948358058929443, 0.5989421606063843, 1.0290948152542114], "mean_td_error": 0.7640884518623352, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 73.0, "diff_num_grad_updates_vs_sampler_policy": 72.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.049398422241211, "actor_loss": -7.619225025177002, "critic_loss": 0.1633673906326294, "alpha_loss": -0.21709555387496948, "alpha_value": 0.9786288142204285, "log_alpha_value": -0.02160283736884594, "target_entropy": -6.0, "policy_t": 0.004102902486920357, "mean_q": 3.6831281185150146, "max_q": 4.4300150871276855, "min_q": 3.2271344661712646}, "td_error": [1.8513336181640625, 3.262101888656616, 0.4915221929550171, 1.4197356700897217, 2.1333959102630615, 0.09218621253967285, 0.2111111879348755, 1.2590787410736084, 1.409991979598999, 0.8241922855377197, 0.8281240463256836, 1.6150680780410767, 1.7552897930145264, 0.5813437700271606, 0.345961332321167, 0.8002669811248779, 1.1977425813674927, 0.1891489028930664, 0.9917558431625366, 2.042661190032959, 0.35005438327789307, 0.46277475357055664, 0.596319317817688, 0.887302041053772, 0.9229452610015869, 1.2750957012176514, 0.7865512371063232, 2.120681047439575, 1.0592598915100098, 1.1202976703643799, 0.08326411247253418, 1.3829559087753296, 0.11211633682250977, 0.38192176818847656, 0.920220136642456, 1.002368450164795, 1.2042508125305176, 0.9999468326568604, 0.9930820465087891, 2.5805504322052, 0.7610410451889038, 2.218135118484497, 0.14254605770111084, 0.4183015823364258, 0.6947165727615356, 1.0784027576446533, 2.038965940475464, 0.7544317245483398, 1.664210557937622, 0.09143435955047607, 0.8191344738006592, 0.9711334705352783, 0.9647344350814819, 1.4138494729995728, 1.3517065048217773, 1.9235949516296387, 0.45227718353271484, 1.985814094543457, 2.236640453338623, 1.2467951774597168, 1.3179041147232056, 1.4687706232070923, 0.16968917846679688, 1.2301568984985352, 0.6579328775405884, 2.5529983043670654, 0.9716607332229614, 2.0274837017059326, 0.2479264736175537, 0.07349884510040283, 0.08940589427947998, 1.0732814073562622, 0.2744886875152588, 0.4821431636810303, 0.9025249481201172, 0.5962567329406738, 1.0019993782043457, 0.8979921340942383, 0.23053371906280518, 0.6762562990188599, 0.7855502367019653, 3.476985454559326, 0.9236247539520264, 0.143926739692688, 0.5130437612533569, 0.18029844760894775], "mean_td_error": 1.0318392515182495, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 73.0, "diff_num_grad_updates_vs_sampler_policy": 72.0}}, "num_env_steps_sampled": 66304, "num_env_steps_trained": 18834, "num_agent_steps_sampled": 198912, "num_agent_steps_trained": 18834, "last_target_update_ts": 66304, "num_target_updates": 73}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 198912, "num_agent_steps_trained": 18834, "num_env_steps_sampled": 66304, "num_env_steps_trained": 18834, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 489.1817693216962, "num_env_steps_trained_throughput_per_sec": 140.85814339843483, "timesteps_total": 66304, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 198912, "timers": {"training_iteration_time_ms": 1936.097, "sample_time_ms": 1328.539, "load_time_ms": 0.533, "load_throughput": 484413.104, "learn_time_ms": 61.16, "learn_throughput": 4218.449, "synch_weights_time_ms": 15.638}, "counters": {"num_env_steps_sampled": 66304, "num_env_steps_trained": 18834, "num_agent_steps_sampled": 198912, "num_agent_steps_trained": 18834, "last_target_update_ts": 66304, "num_target_updates": 73}, "done": false, "episodes_total": 0, "training_iteration": 74, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-17-13", "timestamp": 1700201833, "time_this_iter_s": 1.84450101852417, "time_total_s": 149.78730583190918, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8c8add550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 149.78730583190918, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 62.23333333333333, "ram_util_percent": 90.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.081619262695312, "actor_loss": -9.879925727844238, "critic_loss": 0.21022875607013702, "alpha_loss": -0.2207547277212143, "alpha_value": 0.9783412218093872, "log_alpha_value": -0.02189675159752369, "target_entropy": -6.0, "policy_t": 0.036878280341625214, "mean_q": 6.11366605758667, "max_q": 7.287288188934326, "min_q": 5.1856913566589355}, "td_error": [0.9637248516082764, 0.11680364608764648, 0.3670666217803955, 0.5129327774047852, 1.6946847438812256, 0.41310787200927734, 0.16562414169311523, 1.0325090885162354, 1.156618356704712, 2.2512495517730713, 1.2301104068756104, 1.5072863101959229, 0.7156116962432861, 0.3927640914916992, 0.46550631523132324, 0.3445093631744385, 0.40840697288513184, 0.2936251163482666, 0.35547327995300293, 0.5740642547607422, 1.632309913635254, 0.18682003021240234, 1.9684789180755615, 0.853360652923584, 0.25438618659973145, 0.48357343673706055, 0.2990875244140625, 2.391472339630127, 0.46993398666381836, 1.4138062000274658, 0.531038761138916, 2.4254987239837646, 0.30921173095703125, 0.12385392189025879, 1.0301873683929443, 2.8763983249664307, 2.1033332347869873, 1.0358881950378418, 1.3582146167755127, 1.7666161060333252, 2.540835380554199, 0.33324694633483887, 2.5404140949249268, 1.2075412273406982, 1.5505406856536865, 0.5771667957305908, 0.08280229568481445, 0.386444091796875, 0.771939754486084, 1.2105162143707275, 0.974818229675293, 1.0068392753601074, 1.715559959411621, 1.8884618282318115, 0.07623171806335449, 0.9620180130004883, 0.8736481666564941, 0.8997781276702881, 1.223479986190796, 0.8639898300170898, 0.4928467273712158, 1.906158685684204, 0.5118401050567627, 0.5337660312652588, 0.7430219650268555, 0.1389927864074707, 1.8712618350982666, 1.3916475772857666, 0.9327285289764404, 1.0487020015716553, 0.05790066719055176, 1.6252548694610596, 1.2303645610809326, 0.7005140781402588, 2.850109815597534, 0.5642023086547852, 1.5283279418945312, 2.6507649421691895, 0.520139217376709, 1.035970687866211, 1.1953904628753662, 2.157456874847412, 1.2711822986602783, 0.07960247993469238, 0.5825808048248291, 1.3655002117156982], "mean_td_error": 1.0366007089614868, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 74.0, "diff_num_grad_updates_vs_sampler_policy": 73.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.058928489685059, "actor_loss": -7.538049697875977, "critic_loss": 0.14630714058876038, "alpha_loss": -0.2204432636499405, "alpha_value": 0.978323221206665, "log_alpha_value": -0.02191518247127533, "target_entropy": -6.0, "policy_t": -0.0027392811607569456, "mean_q": 3.6358163356781006, "max_q": 4.182922840118408, "min_q": 3.1018788814544678}, "td_error": [0.13786005973815918, 1.315962553024292, 0.34687674045562744, 1.4092708826065063, 0.4093623161315918, 1.5003972053527832, 0.09550416469573975, 2.810020923614502, 0.48857080936431885, 1.0865055322647095, 0.7070630788803101, 0.12602484226226807, 1.1276010274887085, 0.12943685054779053, 0.1239767074584961, 2.0435571670532227, 0.33665215969085693, 0.20526516437530518, 0.04030454158782959, 1.420111060142517, 0.24866461753845215, 0.09176182746887207, 0.13850104808807373, 0.1981959342956543, 2.6615676879882812, 0.8036043643951416, 1.5485104322433472, 0.17932641506195068, 0.6009907722473145, 0.7911982536315918, 0.2175365686416626, 1.584657907485962, 0.6184238195419312, 2.772871971130371, 1.0449965000152588, 0.36407148838043213, 0.3943556547164917, 0.7571686506271362, 1.5089863538742065, 0.7956874370574951, 0.7444701194763184, 0.528795599937439, 0.2475144863128662, 0.5358494520187378, 0.4639573097229004, 0.4626178741455078, 0.434548020362854, 2.6489133834838867, 0.12542939186096191, 0.3592569828033447, 0.09659349918365479, 0.578577995300293, 0.09802556037902832, 1.5903916358947754, 0.3917250633239746, 1.446980595588684, 1.1553020477294922, 1.3481870889663696, 0.250893235206604, 1.2757606506347656, 0.1933361291885376, 0.7157334089279175, 0.6448462009429932, 0.9727438688278198, 1.5810234546661377, 0.5680147409439087, 1.974363923072815, 1.0121740102767944, 0.43371307849884033, 0.10316061973571777, 1.1375552415847778, 1.5384441614151, 1.9293652772903442, 2.2160565853118896, 2.42279052734375, 0.8638607263565063, 0.6264914274215698, 0.29736340045928955, 0.16042399406433105, 0.7540167570114136, 0.31266725063323975, 2.0499231815338135, 1.7357946634292603, 1.4712934494018555, 1.1328895092010498, 1.9652788639068604], "mean_td_error": 0.892773449420929, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 74.0, "diff_num_grad_updates_vs_sampler_policy": 73.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.050067901611328, "actor_loss": -7.587404251098633, "critic_loss": 0.1602734625339508, "alpha_loss": -0.22011758387088776, "alpha_value": 0.9783360362052917, "log_alpha_value": -0.02190209925174713, "target_entropy": -6.0, "policy_t": -0.0706503689289093, "mean_q": 3.6383419036865234, "max_q": 4.305383205413818, "min_q": 3.1187615394592285}, "td_error": [2.3146920204162598, 0.06936275959014893, 0.008542180061340332, 3.5102944374084473, 0.6837623119354248, 0.6861659288406372, 0.8469305038452148, 0.6181765794754028, 0.28731203079223633, 1.8979493379592896, 1.9293115139007568, 1.56801438331604, 2.0449109077453613, 0.7443493604660034, 0.37473297119140625, 0.6391310691833496, 0.7740401029586792, 0.9245196580886841, 0.07019412517547607, 1.2497824430465698, 0.8844655752182007, 0.7023482322692871, 2.280339479446411, 1.1078085899353027, 0.08509063720703125, 0.3247640132904053, 0.01235508918762207, 0.9084925651550293, 0.3790222406387329, 1.0240883827209473, 1.4670584201812744, 1.3715808391571045, 1.5736033916473389, 1.1957316398620605, 1.4487000703811646, 0.24010169506072998, 0.7807471752166748, 1.494360327720642, 3.0978410243988037, 0.5132249593734741, 0.7766472101211548, 0.09746980667114258, 1.7589898109436035, 0.49804162979125977, 0.14660298824310303, 0.44295692443847656, 0.8895066976547241, 0.9012905359268188, 0.7626241445541382, 0.568562388420105, 1.1859674453735352, 1.2699894905090332, 0.9200872182846069, 0.28731513023376465, 1.454935908317566, 0.05215322971343994, 0.6929423809051514, 0.40608251094818115, 1.5482687950134277, 1.0890607833862305, 1.6637221574783325, 0.9991583824157715, 2.0700037479400635, 1.4880183935165405, 0.13055920600891113, 1.015069603919983, 1.1369482278823853, 0.8458850383758545, 1.4301091432571411, 1.6613343954086304, 1.0085949897766113, 1.6252373456954956, 0.06800258159637451, 0.3228358030319214, 2.1170506477355957, 0.48014724254608154, 0.4990997314453125, 0.8788952827453613, 0.3682675361633301, 0.43834125995635986, 1.5611565113067627, 0.31848347187042236, 0.8381091356277466, 1.3212465047836304, 1.0100932121276855, 2.868481397628784], "mean_td_error": 1.000560998916626, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 74.0, "diff_num_grad_updates_vs_sampler_policy": 73.0}}, "num_env_steps_sampled": 67200, "num_env_steps_trained": 19092, "num_agent_steps_sampled": 201600, "num_agent_steps_trained": 19092, "last_target_update_ts": 67200, "num_target_updates": 74}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 201600, "num_agent_steps_trained": 19092, "num_env_steps_sampled": 67200, "num_env_steps_trained": 19092, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 497.1447826271007, "num_env_steps_trained_throughput_per_sec": 143.15106464039283, "timesteps_total": 67200, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 201600, "timers": {"training_iteration_time_ms": 1916.449, "sample_time_ms": 1306.871, "load_time_ms": 0.534, "load_throughput": 483115.511, "learn_time_ms": 61.154, "learn_throughput": 4218.844, "synch_weights_time_ms": 15.586}, "counters": {"num_env_steps_sampled": 67200, "num_env_steps_trained": 19092, "num_agent_steps_sampled": 201600, "num_agent_steps_trained": 19092, "last_target_update_ts": 67200, "num_target_updates": 74}, "done": false, "episodes_total": 0, "training_iteration": 75, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-17-15", "timestamp": 1700201835, "time_this_iter_s": 1.8167827129364014, "time_total_s": 151.60408854484558, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8981f5670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 151.60408854484558, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 84.25, "ram_util_percent": 90.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.081640243530273, "actor_loss": -9.774787902832031, "critic_loss": 0.19732683897018433, "alpha_loss": -0.2237733155488968, "alpha_value": 0.9780483841896057, "log_alpha_value": -0.022196119651198387, "target_entropy": -6.0, "policy_t": -0.014008616097271442, "mean_q": 6.086992263793945, "max_q": 6.927806377410889, "min_q": 5.082687854766846}, "td_error": [1.3089306354522705, 0.4066579341888428, 0.5496342182159424, 1.8499181270599365, 0.23121237754821777, 0.08210492134094238, 0.04436230659484863, 2.0771946907043457, 1.9207887649536133, 0.6638226509094238, 2.6743156909942627, 0.24797749519348145, 0.9190022945404053, 0.5987727642059326, 0.3151588439941406, 2.1214983463287354, 1.078174114227295, 0.503178596496582, 0.25603199005126953, 1.679297685623169, 1.8006107807159424, 0.2727060317993164, 0.6122398376464844, 3.5626652240753174, 0.3594050407409668, 0.0456540584564209, 0.3328371047973633, 2.9295995235443115, 0.11202883720397949, 1.1635875701904297, 0.9398434162139893, 1.8986306190490723, 0.17832565307617188, 0.880279541015625, 0.2996230125427246, 1.641855001449585, 0.739464282989502, 0.6161677837371826, 0.06186199188232422, 1.073106288909912, 1.7333638668060303, 0.37273168563842773, 1.3961420059204102, 3.061079502105713, 0.5130822658538818, 1.1190769672393799, 0.15289878845214844, 0.6816909313201904, 0.9203739166259766, 1.183002233505249, 0.3066573143005371, 0.9296391010284424, 0.3836667537689209, 0.8215146064758301, 0.6821961402893066, 0.22661185264587402, 0.09175682067871094, 1.1500239372253418, 0.2708170413970947, 0.2508583068847656, 0.09881925582885742, 0.23189854621887207, 0.11979556083679199, 2.3316590785980225, 0.10780072212219238, 0.3952176570892334, 2.0827863216400146, 1.551835298538208, 0.09755539894104004, 0.20102143287658691, 0.5643751621246338, 0.9632070064544678, 0.5955507755279541, 1.2463901042938232, 0.7207551002502441, 0.19586706161499023, 0.8233790397644043, 2.1416666507720947, 1.692993402481079, 0.8629148006439209, 1.8205416202545166, 1.1621508598327637, 2.6288185119628906, 1.1387333869934082, 2.8480141162872314, 0.9062471389770508], "mean_td_error": 0.9630895256996155, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 75.0, "diff_num_grad_updates_vs_sampler_policy": 74.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.085193634033203, "actor_loss": -7.554696559906006, "critic_loss": 0.1316637396812439, "alpha_loss": -0.224044531583786, "alpha_value": 0.978029727935791, "log_alpha_value": -0.022215191274881363, "target_entropy": -6.0, "policy_t": -0.03079395182430744, "mean_q": 3.5881600379943848, "max_q": 4.28242301940918, "min_q": 2.9710137844085693}, "td_error": [1.8516334295272827, 0.6762508153915405, 2.3583521842956543, 0.8858062028884888, 0.5751016139984131, 0.29415345191955566, 0.7989994287490845, 0.14921307563781738, 0.24126803874969482, 0.08041048049926758, 0.35835111141204834, 0.8751446008682251, 1.5860955715179443, 0.5140558481216431, 0.02751898765563965, 0.9567598104476929, 0.01278698444366455, 0.2713310718536377, 0.7668893337249756, 0.18805468082427979, 1.309300184249878, 0.8047322034835815, 0.39781928062438965, 0.7903060913085938, 1.029016375541687, 0.3139568567276001, 2.814812183380127, 0.776252269744873, 1.1535595655441284, 1.1126080751419067, 0.4414658546447754, 0.06775271892547607, 1.8422871828079224, 0.27564573287963867, 0.9450069665908813, 1.0030715465545654, 0.6874374151229858, 0.7943315505981445, 0.3734004497528076, 0.24297714233398438, 0.11056280136108398, 0.425142765045166, 2.330576181411743, 0.30995607376098633, 0.32624709606170654, 1.1452986001968384, 1.4196784496307373, 0.2735779285430908, 0.04549384117126465, 0.7227492332458496, 0.9770625829696655, 0.28081071376800537, 1.88164484500885, 0.454542875289917, 0.300179123878479, 1.1541966199874878, 1.781081199645996, 1.5580376386642456, 0.4273231029510498, 1.8262479305267334, 0.8230115175247192, 2.2884469032287598, 0.29092729091644287, 0.23342180252075195, 0.582439661026001, 1.8410645723342896, 1.7169911861419678, 1.0118409395217896, 2.2578158378601074, 0.45550036430358887, 0.17998480796813965, 0.1750507354736328, 0.9974929094314575, 0.17486989498138428, 0.44989216327667236, 0.06913292407989502, 0.2185901403427124, 1.7467941045761108, 0.9436299800872803, 0.6812452077865601, 0.6451454162597656, 0.3461320400238037, 2.0845460891723633, 1.6127673387527466, 1.4262787103652954, 1.696610927581787], "mean_td_error": 0.8528366684913635, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 75.0, "diff_num_grad_updates_vs_sampler_policy": 74.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.031171798706055, "actor_loss": -7.573447227478027, "critic_loss": 0.13184770941734314, "alpha_loss": -0.22270555794239044, "alpha_value": 0.978043258190155, "log_alpha_value": -0.022201349958777428, "target_entropy": -6.0, "policy_t": -0.04356258362531662, "mean_q": 3.680097818374634, "max_q": 4.544145107269287, "min_q": 3.105146646499634}, "td_error": [1.074365496635437, 0.14044320583343506, 0.7635929584503174, 0.6733345985412598, 0.15901625156402588, 0.505685567855835, 1.0869030952453613, 1.2736440896987915, 0.3071022033691406, 1.0944570302963257, 1.498327612876892, 1.1795120239257812, 0.07743716239929199, 0.7184951305389404, 0.0659782886505127, 1.9926021099090576, 0.30522847175598145, 0.1825401782989502, 0.10490560531616211, 0.3990156650543213, 0.40543365478515625, 1.5101981163024902, 0.7374405860900879, 0.4821608066558838, 0.8802231550216675, 0.1637972593307495, 1.386886715888977, 0.42415833473205566, 0.39118266105651855, 0.3651261329650879, 0.9599725008010864, 1.0608407258987427, 2.6559815406799316, 1.1092058420181274, 0.9782422780990601, 0.08728659152984619, 0.5435450077056885, 0.10521245002746582, 1.7544955015182495, 1.1939083337783813, 0.042397141456604004, 0.9347585439682007, 0.7771342992782593, 0.24479389190673828, 0.996421217918396, 0.6017489433288574, 1.4393373727798462, 1.3488755226135254, 0.39837145805358887, 1.8029909133911133, 0.627711296081543, 0.4495285749435425, 0.5543651580810547, 1.880900502204895, 0.4591531753540039, 0.15262746810913086, 1.118761658668518, 1.313685417175293, 0.24689185619354248, 2.3069067001342773, 0.4287623167037964, 1.8112082481384277, 0.04040539264678955, 0.09390711784362793, 1.2970600128173828, 0.6982290744781494, 0.5058050155639648, 1.6049703359603882, 1.635047197341919, 1.5339679718017578, 0.6529625654220581, 0.8026976585388184, 2.0638842582702637, 0.6173486709594727, 0.3669276237487793, 0.21698534488677979, 1.4209315776824951, 0.6619099378585815, 2.765745162963867, 0.2994762659072876, 1.2464064359664917, 0.7630901336669922, 1.9873182773590088, 0.4573245048522949, 2.4682366847991943, 0.40852344036102295], "mean_td_error": 0.8760973811149597, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 75.0, "diff_num_grad_updates_vs_sampler_policy": 74.0}}, "num_env_steps_sampled": 68096, "num_env_steps_trained": 19350, "num_agent_steps_sampled": 204288, "num_agent_steps_trained": 19350, "last_target_update_ts": 68096, "num_target_updates": 75}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 204288, "num_agent_steps_trained": 19350, "num_env_steps_sampled": 68096, "num_env_steps_trained": 19350, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 475.3666204551664, "num_env_steps_trained_throughput_per_sec": 136.88012062213497, "timesteps_total": 68096, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 204288, "timers": {"training_iteration_time_ms": 1907.423, "sample_time_ms": 1295.008, "load_time_ms": 0.535, "load_throughput": 482383.289, "learn_time_ms": 61.172, "learn_throughput": 4217.63, "synch_weights_time_ms": 15.862}, "counters": {"num_env_steps_sampled": 68096, "num_env_steps_trained": 19350, "num_agent_steps_sampled": 204288, "num_agent_steps_trained": 19350, "last_target_update_ts": 68096, "num_target_updates": 75}, "done": false, "episodes_total": 0, "training_iteration": 76, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-17-17", "timestamp": 1700201837, "time_this_iter_s": 1.8988471031188965, "time_total_s": 153.50293564796448, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8981fa5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 153.50293564796448, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 65.53333333333333, "ram_util_percent": 90.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.011442184448242, "actor_loss": -9.715396881103516, "critic_loss": 0.20968082547187805, "alpha_loss": -0.22521305084228516, "alpha_value": 0.9777555465698242, "log_alpha_value": -0.022495565935969353, "target_entropy": -6.0, "policy_t": 0.05146915465593338, "mean_q": 5.91410493850708, "max_q": 7.003681659698486, "min_q": 4.983688831329346}, "td_error": [0.07021427154541016, 1.2518484592437744, 0.13596820831298828, 0.3134946823120117, 1.793039083480835, 0.7980070114135742, 1.4683778285980225, 1.9001133441925049, 1.6066055297851562, 0.9355206489562988, 0.38504481315612793, 0.16790103912353516, 0.8409614562988281, 0.29288291931152344, 2.1405467987060547, 1.7664580345153809, 0.35549497604370117, 1.5698533058166504, 0.3704085350036621, 0.2950105667114258, 0.9458494186401367, 1.0709261894226074, 0.7357132434844971, 1.9122726917266846, 0.769916296005249, 0.3815433979034424, 0.27230024337768555, 1.879509687423706, 3.9249844551086426, 2.3411786556243896, 0.8750495910644531, 2.1228299140930176, 0.5102260112762451, 0.273068904876709, 1.9994187355041504, 0.95147705078125, 1.9941086769104004, 1.6381189823150635, 0.25617456436157227, 0.9209995269775391, 0.35915708541870117, 2.075483560562134, 0.6322708129882812, 0.37572526931762695, 0.48299741744995117, 1.4656846523284912, 1.3485121726989746, 0.4438905715942383, 0.557136058807373, 1.492567777633667, 1.8895561695098877, 0.8150510787963867, 1.3745512962341309, 1.041600227355957, 0.6248204708099365, 0.3351750373840332, 0.7047209739685059, 0.5407698154449463, 2.0318868160247803, 0.28443002700805664, 0.557166576385498, 0.5270812511444092, 1.959129810333252, 1.1532537937164307, 0.7946810722351074, 0.4335465431213379, 1.5414884090423584, 0.05406308174133301, 0.8784070014953613, 0.9354040622711182, 0.35336852073669434, 0.4580039978027344, 0.9537301063537598, 2.0443217754364014, 0.07404017448425293, 0.85270094871521, 1.6818766593933105, 0.6524169445037842, 1.5900211334228516, 0.541020393371582, 1.4423494338989258, 1.0634784698486328, 1.371018648147583, 1.6033790111541748, 0.3584122657775879, 0.5011482238769531], "mean_td_error": 1.0172663927078247, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 76.0, "diff_num_grad_updates_vs_sampler_policy": 75.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.004843711853027, "actor_loss": -7.528744697570801, "critic_loss": 0.13905873894691467, "alpha_loss": -0.22526100277900696, "alpha_value": 0.9777363538742065, "log_alpha_value": -0.02251519449055195, "target_entropy": -6.0, "policy_t": 0.0020248221699148417, "mean_q": 3.6136062145233154, "max_q": 4.1992034912109375, "min_q": 3.1070234775543213}, "td_error": [0.22083497047424316, 0.8604171276092529, 1.1061729192733765, 2.057875633239746, 1.3666912317276, 0.5156093835830688, 1.7226002216339111, 1.9919638633728027, 0.22494757175445557, 1.2155078649520874, 0.10959088802337646, 1.83619225025177, 2.066845417022705, 0.2647436857223511, 1.1076022386550903, 0.6429637670516968, 1.7622512578964233, 1.8358161449432373, 0.6980071067810059, 0.5536746978759766, 0.7159255743026733, 0.9257688522338867, 0.7926734685897827, 1.2766209840774536, 1.4383831024169922, 1.2776950597763062, 1.5049834251403809, 1.231020450592041, 1.277563214302063, 2.8348565101623535, 0.43477535247802734, 0.2950948476791382, 0.18347954750061035, 0.13302552700042725, 2.4241411685943604, 0.2583872079849243, 0.3920247554779053, 0.3278470039367676, 0.3956620693206787, 0.2793245315551758, 0.6910433769226074, 0.10224747657775879, 0.488811731338501, 0.8555501699447632, 0.43574297428131104, 2.5897488594055176, 0.48074066638946533, 0.5106098651885986, 1.3585175275802612, 1.264658808708191, 0.12330830097198486, 0.40750300884246826, 1.2798848152160645, 0.4938020706176758, 0.7879809141159058, 1.2966715097427368, 2.2328648567199707, 0.06391417980194092, 0.21743512153625488, 0.22945773601531982, 0.9824535846710205, 0.254449725151062, 0.4444190263748169, 1.4164044857025146, 0.7810220718383789, 1.393367886543274, 0.07039570808410645, 0.4831717014312744, 0.6551018953323364, 0.33841216564178467, 0.37401771545410156, 1.113188624382019, 0.8337472677230835, 2.1610422134399414, 1.798280119895935, 0.6932510137557983, 0.22486674785614014, 1.0990321636199951, 0.10377097129821777, 0.48091697692871094, 0.9317585229873657, 1.058135986328125, 0.36809372901916504, 0.7030620574951172, 0.6202859878540039, 1.1421791315078735], "mean_td_error": 0.8952892422676086, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 76.0, "diff_num_grad_updates_vs_sampler_policy": 75.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.06164264678955, "actor_loss": -7.593463897705078, "critic_loss": 0.12410805374383926, "alpha_loss": -0.22639238834381104, "alpha_value": 0.9777507185935974, "log_alpha_value": -0.02250054106116295, "target_entropy": -6.0, "policy_t": -0.015019180253148079, "mean_q": 3.6591665744781494, "max_q": 4.570977687835693, "min_q": 3.076531171798706}, "td_error": [1.6338781118392944, 1.2599539756774902, 0.14006221294403076, 0.298234224319458, 1.2880005836486816, 0.5454014539718628, 2.7204766273498535, 0.8858734369277954, 1.20033597946167, 0.6998711824417114, 0.6226245164871216, 0.5718874931335449, 0.3545682430267334, 1.1617729663848877, 0.3125138282775879, 1.1747781038284302, 1.794297695159912, 0.03621697425842285, 0.06223273277282715, 0.6559751033782959, 0.4610937833786011, 2.182793617248535, 1.4967113733291626, 0.6998428106307983, 0.9988625049591064, 1.0400140285491943, 1.1961013078689575, 0.2995349168777466, 0.7728480100631714, 0.9025322198867798, 0.29902970790863037, 0.359073281288147, 2.701824188232422, 1.3805766105651855, 0.5583270788192749, 0.520891547203064, 0.03302323818206787, 1.0445326566696167, 1.3213837146759033, 0.5898009538650513, 0.08270585536956787, 0.14792585372924805, 1.216894507408142, 1.010736346244812, 0.37391602993011475, 0.8866838216781616, 1.4144929647445679, 1.8627179861068726, 1.6828033924102783, 2.1898908615112305, 0.19546902179718018, 0.37906718254089355, 2.347085952758789, 1.254717469215393, 0.5953911542892456, 1.0209550857543945, 0.6359184980392456, 0.7703651189804077, 0.6905225515365601, 0.750491738319397, 0.4898338317871094, 0.21171224117279053, 1.3818044662475586, 0.11496388912200928, 1.6896809339523315, 0.39920079708099365, 0.15391993522644043, 1.7451934814453125, 0.4935169219970703, 0.3464181423187256, 0.7889869213104248, 1.0429344177246094, 0.34192490577697754, 0.37367355823516846, 0.8024638891220093, 1.6233845949172974, 0.8180932998657227, 1.3382408618927002, 0.7885539531707764, 0.375829815864563, 0.3375115394592285, 0.44603431224823, 0.22569561004638672, 0.5938231945037842, 1.1942181587219238, 0.19141995906829834], "mean_td_error": 0.8615760803222656, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 76.0, "diff_num_grad_updates_vs_sampler_policy": 75.0}}, "num_env_steps_sampled": 68992, "num_env_steps_trained": 19608, "num_agent_steps_sampled": 206976, "num_agent_steps_trained": 19608, "last_target_update_ts": 68992, "num_target_updates": 76}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 206976, "num_agent_steps_trained": 19608, "num_env_steps_sampled": 68992, "num_env_steps_trained": 19608, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 481.3891607468078, "num_env_steps_trained_throughput_per_sec": 138.61428959004064, "timesteps_total": 68992, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 206976, "timers": {"training_iteration_time_ms": 1868.585, "sample_time_ms": 1293.894, "load_time_ms": 0.535, "load_throughput": 482018.01, "learn_time_ms": 61.166, "learn_throughput": 4218.053, "synch_weights_time_ms": 16.104}, "counters": {"num_env_steps_sampled": 68992, "num_env_steps_trained": 19608, "num_agent_steps_sampled": 206976, "num_agent_steps_trained": 19608, "last_target_update_ts": 68992, "num_target_updates": 76}, "done": false, "episodes_total": 0, "training_iteration": 77, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-17-19", "timestamp": 1700201839, "time_this_iter_s": 1.8751518726348877, "time_total_s": 155.37808752059937, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8c8add0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 155.37808752059937, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 64.63333333333333, "ram_util_percent": 90.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.989213943481445, "actor_loss": -9.623750686645508, "critic_loss": 0.18604353070259094, "alpha_loss": -0.22770319879055023, "alpha_value": 0.9774629473686218, "log_alpha_value": -0.022794904187321663, "target_entropy": -6.0, "policy_t": 0.03821680322289467, "mean_q": 5.908292770385742, "max_q": 7.174688816070557, "min_q": 4.8429436683654785}, "td_error": [0.30573034286499023, 1.1378979682922363, 0.8677904605865479, 1.000335693359375, 0.10634374618530273, 1.400068759918213, 0.18671679496765137, 0.9733531475067139, 0.10739731788635254, 0.6409437656402588, 2.2377333641052246, 0.3081815242767334, 1.883985996246338, 0.12516355514526367, 1.7658567428588867, 2.410888910293579, 0.2644209861755371, 0.2588357925415039, 1.174813985824585, 0.48497533798217773, 1.8174738883972168, 0.9220001697540283, 1.2385222911834717, 0.8987703323364258, 1.2290573120117188, 0.7946140766143799, 0.6065411567687988, 0.12844252586364746, 1.0397608280181885, 1.9106450080871582, 0.17749714851379395, 1.380286693572998, 1.1513969898223877, 1.9889781475067139, 0.2575845718383789, 0.11667537689208984, 3.8642706871032715, 0.4640531539916992, 0.8473217487335205, 0.7593307495117188, 1.394191026687622, 1.003342628479004, 1.56976318359375, 0.24748778343200684, 0.26123666763305664, 1.1077275276184082, 0.7650120258331299, 0.700441837310791, 1.0585386753082275, 0.24488568305969238, 0.5848629474639893, 0.34969520568847656, 0.6272141933441162, 1.4443156719207764, 0.5011081695556641, 0.7910597324371338, 0.9943699836730957, 0.48122525215148926, 0.4302022457122803, 1.536879301071167, 1.37544846534729, 1.1110270023345947, 0.4285590648651123, 1.9160356521606445, 0.4951765537261963, 0.9505555629730225, 0.9149441719055176, 1.5565845966339111, 0.7862448692321777, 0.3953745365142822, 1.9374470710754395, 0.3775057792663574, 0.45166945457458496, 1.106107473373413, 1.6073400974273682, 1.550929307937622, 0.291745662689209, 0.48197007179260254, 1.648942232131958, 0.7003822326660156, 3.087411403656006, 0.3350234031677246, 1.692634105682373, 0.1933119297027588, 0.27013587951660156, 0.4292750358581543], "mean_td_error": 0.9467441439628601, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 77.0, "diff_num_grad_updates_vs_sampler_policy": 76.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.010089874267578, "actor_loss": -7.513647556304932, "critic_loss": 0.13195203244686127, "alpha_loss": -0.22838006913661957, "alpha_value": 0.9774433374404907, "log_alpha_value": -0.022814985364675522, "target_entropy": -6.0, "policy_t": 0.06286919862031937, "mean_q": 3.6509528160095215, "max_q": 4.27107572555542, "min_q": 3.142987012863159}, "td_error": [1.8892794847488403, 1.0890806913375854, 0.7990648746490479, 0.5799444913864136, 0.9723918437957764, 0.1978989839553833, 1.4533531665802002, 0.8475375175476074, 1.341869592666626, 0.06079232692718506, 0.8640726804733276, 0.089119553565979, 0.8220726251602173, 0.16145706176757812, 0.6433610916137695, 0.052913784980773926, 1.6698089838027954, 1.7479037046432495, 0.8103698492050171, 1.1874994039535522, 0.9560947418212891, 0.3685176372528076, 1.5232412815093994, 1.0167409181594849, 0.7001534700393677, 0.7444480657577515, 0.8148750066757202, 0.17163348197937012, 0.1849278211593628, 0.19932186603546143, 1.940317153930664, 1.794268250465393, 0.8773255348205566, 0.5023849010467529, 1.036308765411377, 0.08081376552581787, 0.6878281831741333, 0.9147971868515015, 2.4258275032043457, 1.0872021913528442, 1.1344659328460693, 0.10651779174804688, 0.900581955909729, 0.0157240629196167, 0.8124943971633911, 1.7638589143753052, 0.1592310667037964, 1.072866439819336, 0.4901113510131836, 0.7494708299636841, 1.361125111579895, 1.1793280839920044, 2.431783676147461, 0.4381828308105469, 0.45167016983032227, 1.173935055732727, 1.343497633934021, 1.7740281820297241, 1.6554087400436401, 0.14375102519989014, 1.3480852842330933, 0.8813260793685913, 0.178910493850708, 0.510291576385498, 1.0557132959365845, 2.2465672492980957, 1.5070226192474365, 1.3956542015075684, 0.0843510627746582, 0.5020523071289062, 1.9244136810302734, 0.3034639358520508, 0.4506349563598633, 0.10990309715270996, 0.6086910963058472, 0.7207241058349609, 0.08898437023162842, 1.1695477962493896, 1.0761206150054932, 0.40468263626098633, 0.33316314220428467, 0.29020678997039795, 1.0674700736999512, 0.7167220115661621, 0.1319136619567871, 0.24401187896728516], "mean_td_error": 0.8583195805549622, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 77.0, "diff_num_grad_updates_vs_sampler_policy": 76.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.068241119384766, "actor_loss": -7.545286655426025, "critic_loss": 0.16436000168323517, "alpha_loss": -0.2295534908771515, "alpha_value": 0.9774581789970398, "log_alpha_value": -0.022799760103225708, "target_entropy": -6.0, "policy_t": -0.06041603535413742, "mean_q": 3.592205047607422, "max_q": 4.1800217628479, "min_q": 3.0029208660125732}, "td_error": [0.9244588613510132, 0.753058910369873, 1.7912673950195312, 0.12186884880065918, 0.746634840965271, 0.11866128444671631, 0.788396954536438, 0.9280562400817871, 0.7079294919967651, 0.9996417760848999, 0.3830031156539917, 0.12078213691711426, 2.7579851150512695, 0.24834609031677246, 0.7876601219177246, 1.5151376724243164, 1.7820888757705688, 1.5978525876998901, 1.0609207153320312, 0.6296474933624268, 1.5770388841629028, 0.18686246871948242, 0.3569561243057251, 0.549318790435791, 0.6988633871078491, 1.7769428491592407, 0.18075990676879883, 0.26828956604003906, 0.027698278427124023, 2.608639717102051, 0.7504575252532959, 0.29465317726135254, 2.4800753593444824, 2.8063385486602783, 2.149705410003662, 0.2758166790008545, 0.3454854488372803, 1.1092476844787598, 0.8225425481796265, 0.01597881317138672, 0.2831035852432251, 0.6239701509475708, 3.091790199279785, 0.30839085578918457, 0.2531026601791382, 3.0446510314941406, 0.060807228088378906, 0.1231386661529541, 0.20788586139678955, 0.716278076171875, 0.026271343231201172, 1.1175817251205444, 0.7284027338027954, 0.4657353162765503, 1.3947908878326416, 0.12629461288452148, 0.8769159317016602, 0.2860291004180908, 0.05867111682891846, 0.2633705139160156, 1.4649254083633423, 1.110960602760315, 1.8857975006103516, 2.095078945159912, 0.7029604911804199, 2.6660914421081543, 0.5209753513336182, 0.6932951211929321, 1.163800835609436, 0.34168803691864014, 1.1825671195983887, 2.793687105178833, 1.0278997421264648, 0.9522762298583984, 0.9734863042831421, 1.8784114122390747, 0.5932315587997437, 2.6915225982666016, 1.4442741870880127, 0.30560553073883057, 0.3617333173751831, 1.2087804079055786, 1.3307247161865234, 2.3771471977233887, 0.745368242263794, 1.075914740562439], "mean_td_error": 0.9964007139205933, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 77.0, "diff_num_grad_updates_vs_sampler_policy": 76.0}}, "num_env_steps_sampled": 69888, "num_env_steps_trained": 19866, "num_agent_steps_sampled": 209664, "num_agent_steps_trained": 19866, "last_target_update_ts": 69888, "num_target_updates": 77}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 209664, "num_agent_steps_trained": 19866, "num_env_steps_sampled": 69888, "num_env_steps_trained": 19866, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 495.4980298591216, "num_env_steps_trained_throughput_per_sec": 142.67688806211314, "timesteps_total": 69888, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 209664, "timers": {"training_iteration_time_ms": 1870.103, "sample_time_ms": 1294.525, "load_time_ms": 0.535, "load_throughput": 481846.305, "learn_time_ms": 61.131, "learn_throughput": 4220.468, "synch_weights_time_ms": 15.831}, "counters": {"num_env_steps_sampled": 69888, "num_env_steps_trained": 19866, "num_agent_steps_sampled": 209664, "num_agent_steps_trained": 19866, "last_target_update_ts": 69888, "num_target_updates": 77}, "done": false, "episodes_total": 0, "training_iteration": 78, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-17-21", "timestamp": 1700201841, "time_this_iter_s": 1.822666883468628, "time_total_s": 157.200754404068, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8c8add940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 157.200754404068, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 86.25, "ram_util_percent": 90.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.102143287658691, "actor_loss": -9.626212120056152, "critic_loss": 0.17589342594146729, "alpha_loss": -0.23329976201057434, "alpha_value": 0.9771705269813538, "log_alpha_value": -0.023094087839126587, "target_entropy": -6.0, "policy_t": 0.04168068245053291, "mean_q": 5.93485689163208, "max_q": 7.050395488739014, "min_q": 5.035499572753906}, "td_error": [1.467252254486084, 0.2992541790008545, 0.9337575435638428, 1.1584663391113281, 1.7670998573303223, 1.2931013107299805, 1.991870641708374, 1.0091474056243896, 0.24300503730773926, 0.38623785972595215, 1.1410319805145264, 1.3099467754364014, 0.7939047813415527, 0.31305384635925293, 1.0370779037475586, 0.21039032936096191, 1.924992561340332, 1.3050870895385742, 0.22225379943847656, 0.7194509506225586, 1.3776953220367432, 2.9017553329467773, 0.5904734134674072, 0.2740926742553711, 0.308135986328125, 1.7136881351470947, 0.07249927520751953, 0.33420610427856445, 2.048865795135498, 1.6422662734985352, 1.5562658309936523, 1.8568146228790283, 0.5589025020599365, 0.22377800941467285, 0.24654197692871094, 0.8747355937957764, 0.09202718734741211, 0.35688257217407227, 0.5670604705810547, 0.25084829330444336, 1.6055753231048584, 0.42659711837768555, 1.1348907947540283, 0.25820469856262207, 0.8132524490356445, 1.3709256649017334, 3.110062599182129, 0.21330928802490234, 0.35418081283569336, 2.109689712524414, 0.09005212783813477, 1.2943201065063477, 0.6558670997619629, 0.2696661949157715, 0.2629706859588623, 0.44025731086730957, 0.4168252944946289, 0.8857097625732422, 1.0399250984191895, 0.47362518310546875, 0.4662168025970459, 0.09430408477783203, 1.7881574630737305, 1.1814687252044678, 0.5752134323120117, 1.5726966857910156, 0.2526369094848633, 0.3470585346221924, 0.6190698146820068, 0.2547602653503418, 1.1140635013580322, 0.37750792503356934, 1.0907466411590576, 2.125544548034668, 1.1171376705169678, 1.079305648803711, 0.6036627292633057, 1.0219700336456299, 0.4336812496185303, 1.4509086608886719, 0.32276034355163574, 1.3442156314849854, 0.11125326156616211, 1.5142707824707031, 0.25330066680908203, 1.7547316551208496], "mean_td_error": 0.9007728695869446, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 78.0, "diff_num_grad_updates_vs_sampler_policy": 77.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.047723770141602, "actor_loss": -7.569315433502197, "critic_loss": 0.12441776692867279, "alpha_loss": -0.23224912583827972, "alpha_value": 0.9771504998207092, "log_alpha_value": -0.023114603012800217, "target_entropy": -6.0, "policy_t": 0.0034511263947933912, "mean_q": 3.5898163318634033, "max_q": 4.279206275939941, "min_q": 3.11944580078125}, "td_error": [1.7512503862380981, 0.20616769790649414, 0.43290507793426514, 0.967293381690979, 1.5088794231414795, 0.8396885395050049, 0.41446495056152344, 1.7818084955215454, 0.9077340364456177, 1.118218183517456, 1.1242907047271729, 2.633347749710083, 0.4092909097671509, 0.04295074939727783, 0.9501253366470337, 0.6783275604248047, 1.0817179679870605, 1.966742992401123, 0.43296337127685547, 0.3175690174102783, 2.458838939666748, 0.20200753211975098, 0.46992504596710205, 0.2927672863006592, 0.07613074779510498, 0.5341407060623169, 0.46797382831573486, 1.5616248846054077, 2.225555896759033, 0.4129248857498169, 0.2857975959777832, 0.425862193107605, 0.5854333639144897, 0.7531716823577881, 1.0560425519943237, 1.038007140159607, 0.04304003715515137, 1.6884578466415405, 0.44243454933166504, 0.010169267654418945, 0.23852980136871338, 0.31047677993774414, 1.0298662185668945, 0.5702556371688843, 1.176999807357788, 0.7314163446426392, 0.8944532871246338, 0.3313865661621094, 2.0875000953674316, 1.0917261838912964, 0.23566198348999023, 0.852642297744751, 0.0892488956451416, 0.5500472784042358, 0.5446140766143799, 0.44236791133880615, 0.33431148529052734, 0.1512991189956665, 0.159682035446167, 1.2969850301742554, 1.1175572872161865, 0.6017872095108032, 1.3798828125, 0.3704814910888672, 0.680309534072876, 0.2447822093963623, 0.3497370481491089, 1.5762944221496582, 0.8243080377578735, 0.759626030921936, 0.29212915897369385, 1.1520122289657593, 0.3302485942840576, 1.2048393487930298, 2.8929061889648438, 2.2134053707122803, 2.2899088859558105, 0.10820126533508301, 0.48435091972351074, 0.4126697778701782, 1.6121280193328857, 0.24762654304504395, 0.2713296413421631, 1.2572174072265625, 0.613760232925415, 0.03654205799102783], "mean_td_error": 0.8260412812232971, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 78.0, "diff_num_grad_updates_vs_sampler_policy": 77.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.016949653625488, "actor_loss": -7.490731239318848, "critic_loss": 0.1334068775177002, "alpha_loss": -0.23138169944286346, "alpha_value": 0.977165699005127, "log_alpha_value": -0.02309902012348175, "target_entropy": -6.0, "policy_t": -0.041328538209199905, "mean_q": 3.6110177040100098, "max_q": 4.23020076751709, "min_q": 3.148695230484009}, "td_error": [0.06836271286010742, 0.4051525592803955, 3.179980754852295, 0.5606750249862671, 0.6184929609298706, 0.7230688333511353, 0.24344515800476074, 0.9068807363510132, 0.5336072444915771, 1.283896565437317, 0.050907135009765625, 1.3115205764770508, 0.697300910949707, 1.1369965076446533, 0.03347766399383545, 1.3105536699295044, 0.17668366432189941, 0.0951308012008667, 0.45479559898376465, 0.7839338779449463, 0.48378896713256836, 0.11371457576751709, 0.849418044090271, 1.368529200553894, 0.5686619281768799, 0.5796669721603394, 0.21847641468048096, 0.21798837184906006, 0.0984429121017456, 0.5149989128112793, 0.1306612491607666, 0.6941182613372803, 1.3179219961166382, 1.521600604057312, 0.44456708431243896, 1.6764882802963257, 1.3865134716033936, 2.120666265487671, 0.745451807975769, 0.1234581470489502, 1.3006378412246704, 2.5510878562927246, 0.19472134113311768, 0.2805745601654053, 0.23483967781066895, 1.474048137664795, 0.3168874979019165, 1.6732631921768188, 1.1032437086105347, 1.0715923309326172, 2.88499116897583, 2.344308853149414, 0.5486862659454346, 0.08356893062591553, 1.0048449039459229, 1.0911941528320312, 0.23960638046264648, 2.2635223865509033, 0.025182604789733887, 2.4498143196105957, 1.2595818042755127, 1.7530107498168945, 0.6409969329833984, 0.06416630744934082, 0.8490313291549683, 0.7994934320449829, 0.2403048276901245, 1.0490963459014893, 0.4938098192214966, 1.7243854999542236, 2.6302857398986816, 0.28105854988098145, 1.1823804378509521, 0.7145324945449829, 0.17515766620635986, 0.8755342960357666, 1.6109596490859985, 0.6215063333511353, 0.36335527896881104, 1.3122791051864624, 0.7558552026748657, 0.8007907867431641, 0.11006081104278564, 1.3383201360702515, 1.4632714986801147, 0.8419549465179443], "mean_td_error": 0.893462598323822, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 78.0, "diff_num_grad_updates_vs_sampler_policy": 77.0}}, "num_env_steps_sampled": 70784, "num_env_steps_trained": 20124, "num_agent_steps_sampled": 212352, "num_agent_steps_trained": 20124, "last_target_update_ts": 70784, "num_target_updates": 78}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 212352, "num_agent_steps_trained": 20124, "num_env_steps_sampled": 70784, "num_env_steps_trained": 20124, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 472.8286967197501, "num_env_steps_trained_throughput_per_sec": 136.1493345465352, "timesteps_total": 70784, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 212352, "timers": {"training_iteration_time_ms": 1872.031, "sample_time_ms": 1295.539, "load_time_ms": 0.531, "load_throughput": 485761.293, "learn_time_ms": 61.201, "learn_throughput": 4215.627, "synch_weights_time_ms": 16.011}, "counters": {"num_env_steps_sampled": 70784, "num_env_steps_trained": 20124, "num_agent_steps_sampled": 212352, "num_agent_steps_trained": 20124, "last_target_update_ts": 70784, "num_target_updates": 78}, "done": false, "episodes_total": 0, "training_iteration": 79, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-17-23", "timestamp": 1700201843, "time_this_iter_s": 1.9099740982055664, "time_total_s": 159.11072850227356, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8c8addee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 159.11072850227356, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 63.53333333333334, "ram_util_percent": 90.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.966959953308105, "actor_loss": -9.500024795532227, "critic_loss": 0.199039489030838, "alpha_loss": -0.2331613302230835, "alpha_value": 0.9768781065940857, "log_alpha_value": -0.023393426090478897, "target_entropy": -6.0, "policy_t": 0.04800013080239296, "mean_q": 5.712284564971924, "max_q": 6.601982116699219, "min_q": 4.940873146057129}, "td_error": [0.779456377029419, 3.5163304805755615, 0.596451997756958, 0.93955397605896, 0.010819673538208008, 1.2439486980438232, 0.13065361976623535, 0.6507375240325928, 0.32863616943359375, 1.702979326248169, 0.652968168258667, 0.2717630863189697, 0.24860930442810059, 3.424595832824707, 0.42586350440979004, 0.8053367137908936, 1.8809478282928467, 1.8937008380889893, 0.6346001625061035, 1.408085823059082, 0.8021302223205566, 1.1848318576812744, 0.32501816749572754, 0.9208817481994629, 1.4540929794311523, 0.24236273765563965, 0.9580557346343994, 0.3556399345397949, 0.5134694576263428, 0.24651360511779785, 0.4296598434448242, 0.807103157043457, 2.2096669673919678, 0.6093380451202393, 1.7376489639282227, 1.8441181182861328, 0.10538458824157715, 1.2927992343902588, 2.0053699016571045, 1.3120057582855225, 0.23430800437927246, 1.0813210010528564, 0.39818453788757324, 0.9259347915649414, 1.0271062850952148, 1.0060250759124756, 1.17543363571167, 0.45566463470458984, 1.5758552551269531, 0.04138970375061035, 1.1117684841156006, 0.8896892070770264, 0.7143335342407227, 0.5867390632629395, 0.46597957611083984, 1.837904453277588, 0.40598034858703613, 1.3419885635375977, 0.5681664943695068, 0.8577780723571777, 0.19035029411315918, 0.930509090423584, 2.290886402130127, 0.6806538105010986, 1.1647419929504395, 0.6953532695770264, 2.0099411010742188, 1.835658311843872, 0.8530504703521729, 1.5031194686889648, 0.40992021560668945, 0.945659875869751, 1.78908109664917, 1.5558221340179443, 0.2075519561767578, 0.2532217502593994, 0.32610058784484863, 0.9311645030975342, 1.5951530933380127, 0.5809962749481201, 0.29717445373535156, 2.341000556945801, 0.9523580074310303, 1.1533808708190918, 2.1693646907806396, 0.7000508308410645], "mean_td_error": 0.9996039867401123, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 79.0, "diff_num_grad_updates_vs_sampler_policy": 78.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.109352111816406, "actor_loss": -7.604256629943848, "critic_loss": 0.16141587495803833, "alpha_loss": -0.23670201003551483, "alpha_value": 0.9768578410148621, "log_alpha_value": -0.023414162918925285, "target_entropy": -6.0, "policy_t": 0.015614748001098633, "mean_q": 3.6311020851135254, "max_q": 4.391244411468506, "min_q": 3.066861152648926}, "td_error": [1.2265280485153198, 1.0045981407165527, 0.28698551654815674, 2.2299771308898926, 0.147993803024292, 0.07276475429534912, 0.42728281021118164, 0.36647844314575195, 1.0542863607406616, 0.760475754737854, 1.1330797672271729, 0.740447998046875, 1.408498764038086, 1.6138378381729126, 1.1971594095230103, 0.9497233629226685, 0.24225640296936035, 0.6103663444519043, 0.1441645622253418, 0.6336910724639893, 0.024310588836669922, 1.6058262586593628, 1.7877763509750366, 0.5026912689208984, 0.8806920051574707, 1.175378680229187, 1.5426846742630005, 1.4971693754196167, 0.9057868719100952, 0.7939082384109497, 0.5728278160095215, 0.7969570159912109, 1.9996594190597534, 1.5119543075561523, 0.4521334171295166, 0.18147540092468262, 0.8195725679397583, 1.5684128999710083, 1.2403444051742554, 0.9335753917694092, 2.2804718017578125, 1.2234119176864624, 1.78135085105896, 1.0452744960784912, 1.7086853981018066, 0.6612992286682129, 0.3805110454559326, 0.41488945484161377, 0.4254322052001953, 1.0657005310058594, 2.1396515369415283, 0.697798490524292, 0.0756152868270874, 0.6464762687683105, 0.47838294506073, 2.4355201721191406, 0.7073003053665161, 0.011588096618652344, 0.49722135066986084, 0.8370180130004883, 2.8482134342193604, 0.15475356578826904, 0.17917633056640625, 0.5730440616607666, 2.886948585510254, 0.038794517517089844, 0.6901196241378784, 0.9697270393371582, 0.4466743469238281, 0.5910608768463135, 0.6948330402374268, 0.8340928554534912, 0.2700709104537964, 1.1190733909606934, 1.6731224060058594, 1.3892070055007935, 2.2862486839294434, 1.1429214477539062, 2.228100299835205, 1.7108094692230225, 0.5648514032363892, 1.8673721551895142, 0.9131650924682617, 1.662858486175537, 0.6744383573532104, 1.6268963813781738], "mean_td_error": 1.0069059133529663, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 79.0, "diff_num_grad_updates_vs_sampler_policy": 78.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.073392868041992, "actor_loss": -7.537755012512207, "critic_loss": 0.14283570647239685, "alpha_loss": -0.2356991171836853, "alpha_value": 0.9768734574317932, "log_alpha_value": -0.02339818701148033, "target_entropy": -6.0, "policy_t": 0.039188452064991, "mean_q": 3.5758979320526123, "max_q": 4.160152912139893, "min_q": 3.1121773719787598}, "td_error": [1.4486713409423828, 2.862474203109741, 0.09876739978790283, 0.07421481609344482, 0.9331783056259155, 1.4921634197235107, 0.7099611759185791, 0.7795881032943726, 0.5483479499816895, 0.4353973865509033, 0.19449639320373535, 0.2102605104446411, 2.568966865539551, 1.1066439151763916, 1.4065337181091309, 0.2454242706298828, 2.1082706451416016, 0.49547290802001953, 0.8374438285827637, 1.4304306507110596, 2.5748984813690186, 1.6372982263565063, 0.3548091650009155, 0.11431264877319336, 0.7850754261016846, 0.5107909440994263, 0.21293866634368896, 0.4163280725479126, 1.8246665000915527, 0.5985130071640015, 1.8184635639190674, 1.1582127809524536, 0.07444345951080322, 1.4973655939102173, 1.5105942487716675, 1.1261405944824219, 0.250852108001709, 0.3670046329498291, 0.1270378828048706, 0.7290447950363159, 0.6758996248245239, 0.9909355640411377, 0.047270894050598145, 1.8844283819198608, 0.9396847486495972, 0.8368643522262573, 2.6239829063415527, 0.5521762371063232, 1.1789796352386475, 0.04851257801055908, 1.9093655347824097, 0.735032320022583, 0.5248798131942749, 0.09575891494750977, 1.0174262523651123, 1.4155060052871704, 0.06413137912750244, 1.8659451007843018, 0.3302651643753052, 2.0263357162475586, 0.4344005584716797, 1.0453060865402222, 1.7940815687179565, 0.13713765144348145, 1.7142938375473022, 1.2690354585647583, 0.833416223526001, 0.6199173927307129, 0.7482753992080688, 0.7670726776123047, 0.828873872756958, 0.5092841386795044, 0.2977480888366699, 2.2089972496032715, 0.6406675577163696, 0.04761397838592529, 0.5319207906723022, 0.2057584524154663, 0.6207525730133057, 0.3459357023239136, 0.4022778272628784, 1.005452036857605, 2.8523287773132324, 0.9895830154418945, 1.192124366760254, 0.35969972610473633], "mean_td_error": 0.9283817410469055, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 79.0, "diff_num_grad_updates_vs_sampler_policy": 78.0}}, "num_env_steps_sampled": 71680, "num_env_steps_trained": 20382, "num_agent_steps_sampled": 215040, "num_agent_steps_trained": 20382, "last_target_update_ts": 71680, "num_target_updates": 79}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 215040, "num_agent_steps_trained": 20382, "num_env_steps_sampled": 71680, "num_env_steps_trained": 20382, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 492.94228945489954, "num_env_steps_trained_throughput_per_sec": 141.9409717403617, "timesteps_total": 71680, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 215040, "timers": {"training_iteration_time_ms": 1851.863, "sample_time_ms": 1277.557, "load_time_ms": 0.534, "load_throughput": 482856.826, "learn_time_ms": 61.217, "learn_throughput": 4214.498, "synch_weights_time_ms": 15.893}, "counters": {"num_env_steps_sampled": 71680, "num_env_steps_trained": 20382, "num_agent_steps_sampled": 215040, "num_agent_steps_trained": 20382, "last_target_update_ts": 71680, "num_target_updates": 79}, "done": false, "episodes_total": 0, "training_iteration": 80, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-17-25", "timestamp": 1700201845, "time_this_iter_s": 1.8351020812988281, "time_total_s": 160.9458305835724, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8981fa040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 160.9458305835724, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 62.53333333333333, "ram_util_percent": 90.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.051582336425781, "actor_loss": -9.452298164367676, "critic_loss": 0.1497885286808014, "alpha_loss": -0.23814769089221954, "alpha_value": 0.9765859246253967, "log_alpha_value": -0.023692553862929344, "target_entropy": -6.0, "policy_t": 0.043651361018419266, "mean_q": 5.7063703536987305, "max_q": 6.937868118286133, "min_q": 4.872324466705322}, "td_error": [1.5180809497833252, 0.3424530029296875, 1.3144645690917969, 1.0841081142425537, 1.1078314781188965, 1.0444657802581787, 1.0387177467346191, 0.7253260612487793, 0.45348143577575684, 0.6783263683319092, 0.842653751373291, 0.5287322998046875, 0.26039862632751465, 0.3111262321472168, 1.6735591888427734, 0.2717738151550293, 0.22584939002990723, 1.6080539226531982, 0.26354432106018066, 0.8586080074310303, 0.9394636154174805, 0.352663516998291, 0.33928561210632324, 0.30686426162719727, 0.14333534240722656, 0.3496263027191162, 0.8105857372283936, 0.4581122398376465, 0.7734627723693848, 0.9782984256744385, 0.2754039764404297, 0.4752674102783203, 0.4201061725616455, 0.348616361618042, 0.5918900966644287, 0.08742475509643555, 1.3097937107086182, 1.3729987144470215, 0.43909525871276855, 0.388460636138916, 1.1499357223510742, 2.0033555030822754, 1.3672354221343994, 0.1693124771118164, 0.0648655891418457, 1.3032803535461426, 1.1450073719024658, 1.0692329406738281, 2.281925916671753, 1.085874080657959, 0.5606570243835449, 1.1556403636932373, 0.8369593620300293, 1.1091022491455078, 2.7510986328125, 0.512840747833252, 0.20803213119506836, 2.559103488922119, 0.4911789894104004, 0.4517827033996582, 0.12753748893737793, 1.1426661014556885, 1.9687168598175049, 0.9508852958679199, 1.7390005588531494, 0.2208099365234375, 1.683234691619873, 0.2497093677520752, 2.4113481044769287, 1.329223394393921, 0.5917801856994629, 0.6632745265960693, 0.199263334274292, 0.2747313976287842, 0.9358408451080322, 1.322171688079834, 1.1108829975128174, 0.7619414329528809, 0.695655345916748, 0.5518178939819336, 0.31253480911254883, 0.6411786079406738, 0.40985822677612305, 1.2468366622924805, 0.511744499206543, 0.7368001937866211], "mean_td_error": 0.8416066765785217, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 80.0, "diff_num_grad_updates_vs_sampler_policy": 79.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.175557136535645, "actor_loss": -7.662875652313232, "critic_loss": 0.11113498359918594, "alpha_loss": -0.24130144715309143, "alpha_value": 0.9765651226043701, "log_alpha_value": -0.02371383272111416, "target_entropy": -6.0, "policy_t": -0.01700110360980034, "mean_q": 3.633150339126587, "max_q": 4.353672504425049, "min_q": 3.1335270404815674}, "td_error": [0.04626905918121338, 0.023131370544433594, 0.6424249410629272, 1.2343889474868774, 0.4706599712371826, 1.4678058624267578, 0.7524715662002563, 2.56113338470459, 0.6821446418762207, 1.2716987133026123, 2.9557693004608154, 0.5435788631439209, 0.19041621685028076, 0.9462604522705078, 0.20670104026794434, 0.5810868740081787, 0.9725285768508911, 0.20051956176757812, 0.37934696674346924, 0.10329055786132812, 0.19303500652313232, 0.34386181831359863, 0.08665728569030762, 0.3023719787597656, 0.23259103298187256, 0.9404302835464478, 1.4526121616363525, 1.7620947360992432, 0.5715056657791138, 1.2805863618850708, 0.7899937629699707, 0.1666736602783203, 0.14231812953948975, 0.29513096809387207, 0.349820613861084, 0.19103479385375977, 0.8212628364562988, 0.7256482839584351, 0.6446950435638428, 0.4754995107650757, 1.4990156888961792, 0.15898847579956055, 0.9085612297058105, 2.5043492317199707, 0.5766053199768066, 0.2736830711364746, 0.5194926261901855, 0.426723837852478, 1.6108169555664062, 1.6719132661819458, 0.12607169151306152, 0.2586338520050049, 0.7039201259613037, 0.4299147129058838, 1.4708669185638428, 0.2748802900314331, 1.2813544273376465, 0.6691323518753052, 0.29556751251220703, 0.401961088180542, 0.3577951192855835, 0.8643093109130859, 0.867530107498169, 0.7755788564682007, 0.12730002403259277, 1.4135761260986328, 1.2674251794815063, 0.3786647319793701, 0.125757098197937, 1.0408223867416382, 1.224022388458252, 0.17619729042053223, 1.1517304182052612, 0.15323936939239502, 0.10717225074768066, 0.44821619987487793, 0.9114205837249756, 0.7996110916137695, 0.05952882766723633, 1.0772873163223267, 1.0530157089233398, 1.4577054977416992, 0.2659398317337036, 2.130319118499756, 1.4868918657302856, 1.4481618404388428], "mean_td_error": 0.7585014700889587, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 80.0, "diff_num_grad_updates_vs_sampler_policy": 79.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.009471893310547, "actor_loss": -7.503743648529053, "critic_loss": 0.1287306547164917, "alpha_loss": -0.2371986359357834, "alpha_value": 0.9765811562538147, "log_alpha_value": -0.023697417229413986, "target_entropy": -6.0, "policy_t": -0.02929527312517166, "mean_q": 3.6069533824920654, "max_q": 4.432192325592041, "min_q": 3.1082239151000977}, "td_error": [0.06218421459197998, 0.8397791385650635, 0.36591005325317383, 0.4569042921066284, 0.13799214363098145, 1.3626118898391724, 0.6892390251159668, 1.3290106058120728, 0.29594433307647705, 0.20223534107208252, 1.6641669273376465, 0.3717632293701172, 0.7096402645111084, 0.5516223907470703, 2.3921236991882324, 0.19313597679138184, 1.0100035667419434, 0.7261635065078735, 0.6240514516830444, 1.4417303800582886, 0.22344255447387695, 0.41534435749053955, 1.7654056549072266, 0.384163498878479, 0.21354031562805176, 0.40970563888549805, 1.014976978302002, 1.2418452501296997, 0.24238872528076172, 1.970299243927002, 0.2343817949295044, 0.24904870986938477, 0.8388863801956177, 0.33249926567077637, 1.6554641723632812, 3.245488166809082, 0.3536628484725952, 0.9498990774154663, 0.6327025890350342, 0.06649374961853027, 2.6544923782348633, 0.26154470443725586, 0.9675480127334595, 1.5070487260818481, 0.6514546871185303, 1.038519263267517, 0.8491390943527222, 1.2993760108947754, 0.06709027290344238, 0.9733163118362427, 0.6631815433502197, 1.712674856185913, 0.9876389503479004, 1.801533818244934, 1.7905399799346924, 1.4771329164505005, 1.8453618288040161, 0.4249929189682007, 0.08772492408752441, 1.4420028924942017, 0.31644511222839355, 1.5046768188476562, 0.24872004985809326, 0.9777368307113647, 1.7956162691116333, 0.2866630554199219, 0.06910014152526855, 0.29109251499176025, 1.267322301864624, 0.2976013422012329, 0.8904706239700317, 1.7621577978134155, 0.38026726245880127, 0.36387431621551514, 0.11190521717071533, 0.7004051208496094, 0.3364061117172241, 0.16396188735961914, 1.0644173622131348, 1.4145933389663696, 2.233555793762207, 0.8609424829483032, 1.437994122505188, 0.48184800148010254, 0.10793042182922363, 0.3682987689971924], "mean_td_error": 0.8616531491279602, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 80.0, "diff_num_grad_updates_vs_sampler_policy": 79.0}}, "num_env_steps_sampled": 72576, "num_env_steps_trained": 20640, "num_agent_steps_sampled": 217728, "num_agent_steps_trained": 20640, "last_target_update_ts": 72576, "num_target_updates": 80}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 217728, "num_agent_steps_trained": 20640, "num_env_steps_sampled": 72576, "num_env_steps_trained": 20640, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 482.6605478146621, "num_env_steps_trained_throughput_per_sec": 138.98038095556117, "timesteps_total": 72576, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 217728, "timers": {"training_iteration_time_ms": 1848.42, "sample_time_ms": 1275.726, "load_time_ms": 0.536, "load_throughput": 481139.314, "learn_time_ms": 61.282, "learn_throughput": 4210.059, "synch_weights_time_ms": 15.949}, "counters": {"num_env_steps_sampled": 72576, "num_env_steps_trained": 20640, "num_agent_steps_sampled": 217728, "num_agent_steps_trained": 20640, "last_target_update_ts": 72576, "num_target_updates": 80}, "done": false, "episodes_total": 0, "training_iteration": 81, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-17-27", "timestamp": 1700201847, "time_this_iter_s": 1.8709807395935059, "time_total_s": 162.8168113231659, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8981e1d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 162.8168113231659, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 85.0, "ram_util_percent": 90.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.918462753295898, "actor_loss": -9.457780838012695, "critic_loss": 0.19485065340995789, "alpha_loss": -0.23796094954013824, "alpha_value": 0.9762938022613525, "log_alpha_value": -0.023991715162992477, "target_entropy": -6.0, "policy_t": 0.03091449663043022, "mean_q": 5.657412528991699, "max_q": 6.835925579071045, "min_q": 4.642014503479004}, "td_error": [1.6893858909606934, 0.19604229927062988, 2.672698974609375, 0.8586175441741943, 0.5967340469360352, 0.2846817970275879, 0.17221975326538086, 0.9983232021331787, 0.43059873580932617, 0.4885704517364502, 1.338712453842163, 0.8164658546447754, 0.28869175910949707, 1.7795703411102295, 1.40458345413208, 0.9009525775909424, 0.5718200206756592, 2.0853095054626465, 0.8414585590362549, 0.3412466049194336, 0.8936560153961182, 0.2809145450592041, 0.8483984470367432, 1.7237889766693115, 1.1610465049743652, 1.4428660869598389, 0.8806405067443848, 1.319899320602417, 2.625947952270508, 1.7126843929290771, 0.7984030246734619, 1.5322506427764893, 0.6375377178192139, 0.6987760066986084, 1.387274980545044, 1.4847724437713623, 0.3175694942474365, 0.10540485382080078, 0.15470528602600098, 1.1574580669403076, 0.9162931442260742, 1.7477490901947021, 1.1684606075286865, 0.13846325874328613, 1.172456979751587, 0.9303042888641357, 1.5460076332092285, 0.884779691696167, 1.3015344142913818, 1.5647966861724854, 0.539355993270874, 1.541734218597412, 0.5545358657836914, 0.8580994606018066, 1.4815583229064941, 0.20256471633911133, 0.531083345413208, 1.059373378753662, 0.8453648090362549, 1.5495810508728027, 1.4933371543884277, 0.29118871688842773, 0.9139034748077393, 0.14905834197998047, 2.4742822647094727, 0.7017536163330078, 0.9973113536834717, 1.0428078174591064, 0.8672568798065186, 0.9440202713012695, 1.6517179012298584, 1.110131025314331, 0.7452614307403564, 3.9436776638031006, 1.03371000289917, 0.903792142868042, 0.3588113784790039, 0.49468111991882324, 0.5812339782714844, 1.4454631805419922, 0.5510540008544922, 0.19601082801818848, 1.0269386768341064, 0.8797516822814941, 0.18314599990844727, 0.972400426864624], "mean_td_error": 1.0047379732131958, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 81.0, "diff_num_grad_updates_vs_sampler_policy": 80.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.138157844543457, "actor_loss": -7.645065784454346, "critic_loss": 0.13075973093509674, "alpha_loss": -0.24345539510250092, "alpha_value": 0.9762722849845886, "log_alpha_value": -0.02401377074420452, "target_entropy": -6.0, "policy_t": -0.002406207611784339, "mean_q": 3.692978620529175, "max_q": 4.192966461181641, "min_q": 3.2724945545196533}, "td_error": [0.018283486366271973, 2.316605567932129, 0.42253363132476807, 0.017690658569335938, 2.5488381385803223, 0.6246950626373291, 0.11702096462249756, 0.3038461208343506, 1.1733020544052124, 0.6194463968276978, 0.8382604122161865, 0.25969529151916504, 0.1908266544342041, 0.4724820852279663, 0.48696649074554443, 1.5818873643875122, 1.4374215602874756, 1.7370878458023071, 0.8582396507263184, 0.2881382703781128, 0.2754770517349243, 0.8336607217788696, 0.16928315162658691, 0.7906104326248169, 1.3662123680114746, 1.146924614906311, 1.1693131923675537, 2.3215408325195312, 1.2439154386520386, 1.307059407234192, 1.0189235210418701, 0.2748299837112427, 1.2139639854431152, 0.03843820095062256, 0.5539470911026001, 0.454479455947876, 0.36278343200683594, 1.1170060634613037, 0.5286006927490234, 0.6415159702301025, 1.140047550201416, 2.488374948501587, 2.4044623374938965, 0.06828713417053223, 0.9801280498504639, 2.366786241531372, 0.1310793161392212, 0.37685132026672363, 1.7432929277420044, 0.3402928113937378, 0.9682520627975464, 0.370918869972229, 1.5797410011291504, 0.23983144760131836, 0.39271605014801025, 1.927944302558899, 0.2528113126754761, 0.25523531436920166, 0.20060276985168457, 0.5611617565155029, 0.4787389039993286, 2.285325765609741, 1.18129563331604, 0.05846965312957764, 0.5886534452438354, 0.03291058540344238, 1.817489743232727, 0.3022817373275757, 0.19133126735687256, 0.08777451515197754, 0.12410271167755127, 0.47112250328063965, 0.22070538997650146, 0.06052231788635254, 0.3511272668838501, 0.8061649799346924, 0.7441073656082153, 1.3745412826538086, 1.5660358667373657, 1.5124613046646118, 0.3552132844924927, 1.172594428062439, 0.4579355716705322, 0.7651292085647583, 2.519887924194336, 0.43270885944366455], "mean_td_error": 0.8359209299087524, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 81.0, "diff_num_grad_updates_vs_sampler_policy": 80.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.126189231872559, "actor_loss": -7.593141555786133, "critic_loss": 0.17309240996837616, "alpha_loss": -0.24299345910549164, "alpha_value": 0.9762890934944153, "log_alpha_value": -0.023996537551283836, "target_entropy": -6.0, "policy_t": -0.053939662873744965, "mean_q": 3.6182308197021484, "max_q": 4.064786434173584, "min_q": 3.2775211334228516}, "td_error": [0.08437013626098633, 2.003119945526123, 1.6362049579620361, 1.8855750560760498, 0.7941551208496094, 1.7541987895965576, 0.7278655767440796, 0.47994744777679443, 0.8025410175323486, 0.12293744087219238, 1.9268138408660889, 0.022843122482299805, 0.4819967746734619, 0.6617252826690674, 1.2100359201431274, 1.7405157089233398, 0.23772859573364258, 1.0116121768951416, 0.8276742696762085, 2.3362860679626465, 2.1941187381744385, 1.0216506719589233, 0.3024022579193115, 0.28199315071105957, 0.5160833597183228, 0.7843449115753174, 0.43662166595458984, 1.353337049484253, 0.24046754837036133, 0.7492636442184448, 2.4696497917175293, 1.2905726432800293, 0.43982255458831787, 0.2958325147628784, 0.4002697467803955, 1.6218442916870117, 2.826477289199829, 1.5987664461135864, 1.6530654430389404, 0.16340160369873047, 0.2911570072174072, 0.34188222885131836, 0.8235170841217041, 1.3041728734970093, 2.3883588314056396, 1.0143595933914185, 0.7760895490646362, 0.44298553466796875, 1.209582805633545, 1.4607856273651123, 0.4994041919708252, 3.124598979949951, 1.0241507291793823, 1.371799349784851, 0.4503244161605835, 0.5974022150039673, 0.2746196985244751, 1.1120433807373047, 2.137287139892578, 2.292501449584961, 0.640143632888794, 0.7979310750961304, 1.042763590812683, 0.5844440460205078, 0.8961459398269653, 1.3609939813613892, 0.28984522819519043, 1.9280908107757568, 0.16390061378479004, 0.33860111236572266, 0.9754166603088379, 1.947767972946167, 1.554087519645691, 2.0562126636505127, 1.11958646774292, 0.14297664165496826, 0.9002416133880615, 0.8555585145950317, 0.3350766897201538, 0.22060787677764893, 2.009275436401367, 0.31059396266937256, 0.9517601728439331, 3.364199638366699, 0.42940282821655273, 1.5722898244857788], "mean_td_error": 1.059454321861267, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 81.0, "diff_num_grad_updates_vs_sampler_policy": 80.0}}, "num_env_steps_sampled": 73472, "num_env_steps_trained": 20898, "num_agent_steps_sampled": 220416, "num_agent_steps_trained": 20898, "last_target_update_ts": 73472, "num_target_updates": 81}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 220416, "num_agent_steps_trained": 20898, "num_env_steps_sampled": 73472, "num_env_steps_trained": 20898, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 369.30760864224465, "num_env_steps_trained_throughput_per_sec": 106.3408069527892, "timesteps_total": 73472, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 220416, "timers": {"training_iteration_time_ms": 1905.748, "sample_time_ms": 1331.602, "load_time_ms": 0.537, "load_throughput": 480391.739, "learn_time_ms": 61.303, "learn_throughput": 4208.571, "synch_weights_time_ms": 16.185}, "counters": {"num_env_steps_sampled": 73472, "num_env_steps_trained": 20898, "num_agent_steps_sampled": 220416, "num_agent_steps_trained": 20898, "last_target_update_ts": 73472, "num_target_updates": 81}, "done": false, "episodes_total": 0, "training_iteration": 82, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-17-29", "timestamp": 1700201849, "time_this_iter_s": 2.442117929458618, "time_total_s": 165.2589292526245, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8c8addee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 165.2589292526245, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 68.075, "ram_util_percent": 90.85}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.950374603271484, "actor_loss": -9.423501968383789, "critic_loss": 0.1824038177728653, "alpha_loss": -0.2417001724243164, "alpha_value": 0.9760020971298218, "log_alpha_value": -0.02429055981338024, "target_entropy": -6.0, "policy_t": 0.026411481201648712, "mean_q": 5.665553569793701, "max_q": 6.587547302246094, "min_q": 4.851169586181641}, "td_error": [2.158153772354126, 1.7458951473236084, 0.4385528564453125, 0.9391586780548096, 0.8555774688720703, 0.943756103515625, 0.8406875133514404, 0.3087925910949707, 0.13673114776611328, 1.9348318576812744, 0.2584648132324219, 1.6148216724395752, 0.42444300651550293, 0.9708333015441895, 1.8803482055664062, 2.1202855110168457, 2.5106382369995117, 1.851318120956421, 0.6417286396026611, 0.8852345943450928, 0.3624866008758545, 0.33104538917541504, 1.0381567478179932, 0.8375489711761475, 1.538855791091919, 1.5144457817077637, 2.0838093757629395, 0.17042231559753418, 0.6075437068939209, 2.272888660430908, 3.1197729110717773, 1.0773258209228516, 1.0703670978546143, 0.7306389808654785, 0.22749948501586914, 1.415123701095581, 0.5522878170013428, 1.1313841342926025, 0.7983746528625488, 1.6565978527069092, 0.7423524856567383, 1.273097038269043, 0.542776346206665, 1.2221648693084717, 0.4368574619293213, 0.5922765731811523, 0.351154088973999, 0.5878136157989502, 0.1725919246673584, 1.6142003536224365, 0.5532662868499756, 1.2345266342163086, 1.1240038871765137, 0.2672922611236572, 0.33258724212646484, 1.472212314605713, 0.2255403995513916, 1.7604289054870605, 0.1230018138885498, 1.3519279956817627, 0.5812451839447021, 1.2760462760925293, 0.3591909408569336, 0.27838134765625, 0.39220380783081055, 1.2771592140197754, 0.7709195613861084, 0.5335021018981934, 1.0431270599365234, 0.8435473442077637, 0.35523343086242676, 0.33840012550354004, 0.9959104061126709, 0.7965621948242188, 0.2977895736694336, 1.0786941051483154, 1.2823772430419922, 1.5338671207427979, 1.9634449481964111, 0.8357465267181396, 0.8415713310241699, 0.8695948123931885, 2.300670862197876, 0.2016451358795166, 0.06499838829040527, 0.5770864486694336], "mean_td_error": 0.9728583693504333, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 82.0, "diff_num_grad_updates_vs_sampler_policy": 81.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.085275650024414, "actor_loss": -7.684346675872803, "critic_loss": 0.16617640852928162, "alpha_loss": -0.2452118843793869, "alpha_value": 0.9759793281555176, "log_alpha_value": -0.024313850328326225, "target_entropy": -6.0, "policy_t": 0.03142741695046425, "mean_q": 3.6879918575286865, "max_q": 4.215190887451172, "min_q": 3.2681803703308105}, "td_error": [0.4968857765197754, 3.1932506561279297, 1.2107023000717163, 2.22367525100708, 0.8654004335403442, 0.6488316059112549, 0.15558886528015137, 1.3321127891540527, 0.8920341730117798, 2.3241264820098877, 1.4531735181808472, 1.6153488159179688, 0.40149736404418945, 2.222677707672119, 0.9138034582138062, 0.8675873279571533, 1.1991933584213257, 0.1538701057434082, 1.9131357669830322, 0.763303279876709, 1.9349937438964844, 0.18190991878509521, 2.4894649982452393, 0.4745001792907715, 2.2377161979675293, 0.15580511093139648, 0.6643339395523071, 1.0910649299621582, 0.9453729391098022, 1.0777467489242554, 0.3348463773727417, 2.442979574203491, 0.6760451793670654, 0.8617193698883057, 0.6463930606842041, 0.9287256002426147, 1.6743080615997314, 0.255770206451416, 1.144116759300232, 1.3928892612457275, 0.885387659072876, 0.6051168441772461, 0.41067206859588623, 0.43066883087158203, 1.3839209079742432, 1.9202747344970703, 0.07241475582122803, 0.3673136234283447, 0.0715177059173584, 0.4197986125946045, 0.6105643510818481, 0.23383402824401855, 0.4286532402038574, 1.348445177078247, 0.9184005260467529, 0.9671717882156372, 0.7540194988250732, 1.0977263450622559, 0.3694772720336914, 1.8572907447814941, 0.2587696313858032, 0.7244834899902344, 1.1813825368881226, 0.8487451076507568, 0.06205189228057861, 2.4964969158172607, 0.371177077293396, 0.47030138969421387, 0.9089821577072144, 0.3506661653518677, 1.9005048274993896, 1.2923479080200195, 0.3569711446762085, 1.0200424194335938, 1.0587660074234009, 0.3435438871383667, 0.08680379390716553, 1.0819441080093384, 1.9174844026565552, 1.4785375595092773, 0.05703699588775635, 2.0992259979248047, 0.05587661266326904, 3.2951416969299316, 0.43726539611816406, 0.6150037050247192], "mean_td_error": 1.0044084787368774, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 82.0, "diff_num_grad_updates_vs_sampler_policy": 81.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.048497200012207, "actor_loss": -7.524521827697754, "critic_loss": 0.10321937501430511, "alpha_loss": -0.24413694441318512, "alpha_value": 0.9759969115257263, "log_alpha_value": -0.0242958664894104, "target_entropy": -6.0, "policy_t": -0.00426632771268487, "mean_q": 3.6078078746795654, "max_q": 4.158184051513672, "min_q": 2.9358065128326416}, "td_error": [1.015085220336914, 0.29188692569732666, 1.2223708629608154, 1.6989436149597168, 0.10206282138824463, 0.15532279014587402, 1.3271781206130981, 0.3493865728378296, 0.6629910469055176, 1.1454887390136719, 0.34403491020202637, 0.7435593605041504, 1.1179782152175903, 0.6362390518188477, 0.23222672939300537, 1.176055669784546, 1.2361093759536743, 0.9181454181671143, 0.9625499248504639, 0.4990018606185913, 0.5865753889083862, 0.5429891347885132, 0.9731727838516235, 0.42059123516082764, 1.1368626356124878, 1.0746573209762573, 0.13967669010162354, 0.30927574634552, 0.4460313320159912, 0.7577906847000122, 0.3171205520629883, 0.1053849458694458, 0.3550126552581787, 0.43110525608062744, 0.8486860990524292, 0.785849928855896, 0.34380054473876953, 0.057138681411743164, 0.6016734838485718, 1.8345052003860474, 0.07088148593902588, 0.4693591594696045, 0.6744993925094604, 0.6960575580596924, 0.5122067928314209, 1.1153323650360107, 1.6156400442123413, 0.8939615488052368, 0.0600736141204834, 1.0217880010604858, 1.3174302577972412, 0.9525083303451538, 0.20737862586975098, 0.6233350038528442, 1.2573226690292358, 1.5391703844070435, 0.24986982345581055, 1.7555092573165894, 0.840684175491333, 0.6604385375976562, 0.1876434087753296, 1.1529524326324463, 2.6593494415283203, 1.3657376766204834, 0.13592112064361572, 0.10631883144378662, 0.11135053634643555, 0.07768726348876953, 0.44885098934173584, 0.4535752534866333, 0.8907898664474487, 0.04734468460083008, 0.5573654174804688, 0.903605580329895, 0.9205390214920044, 0.7143489122390747, 0.20046281814575195, 0.6051015853881836, 1.1987179517745972, 1.1326792240142822, 1.2484978437423706, 1.2036727666854858, 1.8217929601669312, 0.48072659969329834, 1.528184175491333, 1.5904737710952759], "mean_td_error": 0.7695541381835938, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 82.0, "diff_num_grad_updates_vs_sampler_policy": 81.0}}, "num_env_steps_sampled": 74368, "num_env_steps_trained": 21156, "num_agent_steps_sampled": 223104, "num_agent_steps_trained": 21156, "last_target_update_ts": 74368, "num_target_updates": 82}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 223104, "num_agent_steps_trained": 21156, "num_env_steps_sampled": 74368, "num_env_steps_trained": 21156, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 399.4030134492699, "num_env_steps_trained_throughput_per_sec": 115.00667128338351, "timesteps_total": 74368, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 223104, "timers": {"training_iteration_time_ms": 1942.639, "sample_time_ms": 1365.438, "load_time_ms": 0.539, "load_throughput": 478416.567, "learn_time_ms": 61.778, "learn_throughput": 4176.267, "synch_weights_time_ms": 16.631}, "counters": {"num_env_steps_sampled": 74368, "num_env_steps_trained": 21156, "num_agent_steps_sampled": 223104, "num_agent_steps_trained": 21156, "last_target_update_ts": 74368, "num_target_updates": 82}, "done": false, "episodes_total": 0, "training_iteration": 83, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-17-31", "timestamp": 1700201851, "time_this_iter_s": 2.2569830417633057, "time_total_s": 167.51591229438782, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8aa4cae50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 167.51591229438782, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 81.56666666666666, "ram_util_percent": 90.90000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.105493545532227, "actor_loss": -9.450186729431152, "critic_loss": 0.16329768300056458, "alpha_loss": -0.24848611652851105, "alpha_value": 0.9757106304168701, "log_alpha_value": -0.024589208886027336, "target_entropy": -6.0, "policy_t": 0.013119760900735855, "mean_q": 5.57985258102417, "max_q": 6.645040988922119, "min_q": 4.782426834106445}, "td_error": [0.8370764255523682, 0.08004426956176758, 1.5293407440185547, 1.8867344856262207, 0.3672783374786377, 0.665461540222168, 0.9330482482910156, 0.8228559494018555, 1.506424903869629, 0.9804592132568359, 1.1094119548797607, 0.6811380386352539, 2.119387626647949, 0.29399776458740234, 0.3350679874420166, 0.627993106842041, 0.8366162776947021, 0.999835729598999, 1.2571754455566406, 1.1224093437194824, 1.3935647010803223, 0.4970989227294922, 1.031733512878418, 0.06163215637207031, 0.6471593379974365, 0.12865781784057617, 0.2775247097015381, 0.5503852367401123, 0.42749500274658203, 0.4368746280670166, 0.567025899887085, 1.5020935535430908, 0.9194648265838623, 0.16087031364440918, 0.5139365196228027, 0.9984102249145508, 2.356513500213623, 1.0209088325500488, 0.255892276763916, 0.8339197635650635, 1.7896032333374023, 0.10407733917236328, 0.3049581050872803, 0.4103376865386963, 0.9468529224395752, 1.449951171875, 1.6032090187072754, 0.34880995750427246, 0.8535716533660889, 0.291644811630249, 1.5251519680023193, 0.21110868453979492, 0.7318105697631836, 1.2385363578796387, 1.1291489601135254, 0.16460347175598145, 0.44372129440307617, 0.7528152465820312, 1.500685691833496, 0.26987504959106445, 1.9434325695037842, 2.2642862796783447, 1.3587653636932373, 0.24977421760559082, 0.0771784782409668, 1.2085504531860352, 1.1052937507629395, 0.5250403881072998, 0.7604501247406006, 0.17118430137634277, 0.441575288772583, 0.5687572956085205, 1.7865288257598877, 0.7500796318054199, 1.0319199562072754, 0.15758538246154785, 0.3701624870300293, 0.16606760025024414, 1.4714345932006836, 1.357656478881836, 2.8857839107513428, 0.3198268413543701, 2.0617496967315674, 1.0584759712219238, 1.6804397106170654, 0.37432050704956055], "mean_td_error": 0.8812757134437561, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 83.0, "diff_num_grad_updates_vs_sampler_policy": 82.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.140510559082031, "actor_loss": -7.732287883758545, "critic_loss": 0.15670320391654968, "alpha_loss": -0.2495976835489273, "alpha_value": 0.9756865501403809, "log_alpha_value": -0.024613918736577034, "target_entropy": -6.0, "policy_t": 0.02107391692698002, "mean_q": 3.716639995574951, "max_q": 4.629623889923096, "min_q": 3.3590757846832275}, "td_error": [1.5747648477554321, 2.7991249561309814, 1.033331036567688, 2.0291595458984375, 1.7307989597320557, 1.2399910688400269, 0.2882266044616699, 0.3818166255950928, 0.3762362003326416, 0.8755927085876465, 1.5688234567642212, 0.9182020425796509, 1.189054012298584, 1.5651538372039795, 2.7943053245544434, 1.121045470237732, 0.04732656478881836, 1.7540744543075562, 0.14607656002044678, 2.2267374992370605, 1.5359241962432861, 0.8405721187591553, 0.6087725162506104, 2.5157508850097656, 1.029527187347412, 0.364294171333313, 1.986860990524292, 1.0044994354248047, 0.7869822978973389, 1.4050607681274414, 0.27605974674224854, 0.09347689151763916, 0.17570924758911133, 1.7587441205978394, 2.359623432159424, 1.4657350778579712, 0.635875940322876, 0.9368305206298828, 0.4578777551651001, 0.8508820533752441, 2.551693916320801, 0.24657690525054932, 0.696969747543335, 0.19865715503692627, 0.7866723537445068, 0.27350378036499023, 0.1826709508895874, 0.47189605236053467, 1.026792287826538, 0.1507580280303955, 0.5830504894256592, 0.4368155002593994, 0.8286042213439941, 0.6590993404388428, 1.4751540422439575, 0.7753428220748901, 0.32267117500305176, 1.469941258430481, 1.7764238119125366, 0.754207968711853, 1.1032536029815674, 1.2002065181732178, 0.3775825500488281, 0.11276113986968994, 0.284523606300354, 0.6354008913040161, 0.46946704387664795, 0.6249392032623291, 1.0906081199645996, 1.4568604230880737, 0.292219877243042, 0.0683741569519043, 1.4960671663284302, 1.0651723146438599, 1.1733806133270264, 1.1056225299835205, 1.2672078609466553, 0.755292534828186, 1.5716629028320312, 1.7106306552886963, 0.33518898487091064, 0.3858602046966553, 0.7855224609375, 0.3692634105682373, 0.2877192497253418, 0.9413717985153198], "mean_td_error": 0.96956467628479, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 83.0, "diff_num_grad_updates_vs_sampler_policy": 82.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.06247615814209, "actor_loss": -7.542557239532471, "critic_loss": 0.1314394325017929, "alpha_loss": -0.2474883794784546, "alpha_value": 0.9757047891616821, "log_alpha_value": -0.02459517866373062, "target_entropy": -6.0, "policy_t": -0.019051847979426384, "mean_q": 3.6625356674194336, "max_q": 4.393768787384033, "min_q": 3.0963211059570312}, "td_error": [1.083647608757019, 1.2156078815460205, 0.5962821245193481, 3.5950088500976562, 1.748338222503662, 0.5155898332595825, 1.3515477180480957, 1.42653226852417, 1.5166401863098145, 0.14356982707977295, 0.4275391101837158, 0.1828155517578125, 0.06422948837280273, 1.0309542417526245, 0.5537524223327637, 1.3062182664871216, 1.0543646812438965, 0.19109034538269043, 2.1181015968322754, 1.950947642326355, 0.7645608186721802, 0.880384087562561, 2.5837624073028564, 0.7116868495941162, 0.5281819105148315, 0.6627118587493896, 0.2964191436767578, 0.35894548892974854, 0.8215410709381104, 2.288949966430664, 1.1418578624725342, 0.26927614212036133, 1.6949321031570435, 0.6436567306518555, 0.5664492845535278, 0.8603986501693726, 0.0681314468383789, 0.5668208599090576, 0.15657246112823486, 1.206058382987976, 1.8158423900604248, 1.996411919593811, 1.2402290105819702, 0.09067177772521973, 0.15007197856903076, 0.8697524070739746, 0.48479533195495605, 0.451275110244751, 0.14909684658050537, 1.0305912494659424, 2.4552230834960938, 2.45035982131958, 0.1013784408569336, 1.0026638507843018, 0.24470794200897217, 1.6846623420715332, 0.13413119316101074, 0.49331343173980713, 0.04831051826477051, 0.7431900501251221, 0.14224696159362793, 0.5771430730819702, 0.30592143535614014, 0.20872211456298828, 0.06688272953033447, 1.0191738605499268, 0.09180963039398193, 1.9597793817520142, 1.2933061122894287, 0.08574330806732178, 2.0700759887695312, 0.11903417110443115, 0.7944105863571167, 0.009147286415100098, 0.27701783180236816, 1.4389511346817017, 0.4032266139984131, 0.9701461791992188, 0.5801883935928345, 0.6937689781188965, 1.7813434600830078, 0.06256687641143799, 0.950459361076355, 0.861424446105957, 0.8252629041671753, 0.33320868015289307], "mean_td_error": 0.8686245679855347, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 83.0, "diff_num_grad_updates_vs_sampler_policy": 82.0}}, "num_env_steps_sampled": 75264, "num_env_steps_trained": 21414, "num_agent_steps_sampled": 225792, "num_agent_steps_trained": 21414, "last_target_update_ts": 75264, "num_target_updates": 83}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 225792, "num_agent_steps_trained": 21414, "num_env_steps_sampled": 75264, "num_env_steps_trained": 21414, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 418.6886761878204, "num_env_steps_trained_throughput_per_sec": 120.5599089915822, "timesteps_total": 75264, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 225792, "timers": {"training_iteration_time_ms": 1973.474, "sample_time_ms": 1395.292, "load_time_ms": 0.541, "load_throughput": 476646.448, "learn_time_ms": 61.984, "learn_throughput": 4162.367, "synch_weights_time_ms": 16.703}, "counters": {"num_env_steps_sampled": 75264, "num_env_steps_trained": 21414, "num_agent_steps_sampled": 225792, "num_agent_steps_trained": 21414, "last_target_update_ts": 75264, "num_target_updates": 83}, "done": false, "episodes_total": 0, "training_iteration": 84, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-17-33", "timestamp": 1700201853, "time_this_iter_s": 2.16040301322937, "time_total_s": 169.6763153076172, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8981e1d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 169.6763153076172, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 77.33333333333333, "ram_util_percent": 90.86666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.953933715820312, "actor_loss": -9.333985328674316, "critic_loss": 0.19887623190879822, "alpha_loss": -0.24773438274860382, "alpha_value": 0.9754190444946289, "log_alpha_value": -0.024888088926672935, "target_entropy": -6.0, "policy_t": 0.01562254037708044, "mean_q": 5.491919040679932, "max_q": 6.802570819854736, "min_q": 4.46829080581665}, "td_error": [0.394212007522583, 0.7688620090484619, 1.30399751663208, 1.5227587223052979, 0.10082435607910156, 0.47573113441467285, 0.5584619045257568, 0.6451470851898193, 0.029722213745117188, 0.6382315158843994, 0.9767756462097168, 0.5346107482910156, 0.11448073387145996, 1.566270112991333, 0.9325554370880127, 0.20286035537719727, 1.2892167568206787, 1.4747765064239502, 1.555685043334961, 0.3519620895385742, 1.8153996467590332, 1.8849737644195557, 0.584479808807373, 1.9734597206115723, 0.9382939338684082, 0.8852927684783936, 0.18403220176696777, 2.3808844089508057, 3.1709113121032715, 0.3146343231201172, 1.0778231620788574, 0.6973116397857666, 1.0264794826507568, 0.8055918216705322, 1.662630319595337, 1.591099739074707, 1.6582183837890625, 0.21219110488891602, 1.8404436111450195, 0.6057529449462891, 0.44867610931396484, 0.3645205497741699, 0.4905524253845215, 0.8629586696624756, 1.6435470581054688, 0.7117249965667725, 1.7007062435150146, 2.673677444458008, 1.3557047843933105, 0.27865147590637207, 0.650925874710083, 1.5587358474731445, 0.6760668754577637, 0.40059971809387207, 1.7798068523406982, 1.1853344440460205, 1.1228046417236328, 1.666717290878296, 0.2545614242553711, 0.26007699966430664, 0.8059983253479004, 0.7521131038665771, 0.6385526657104492, 1.3122186660766602, 1.6741747856140137, 0.5679500102996826, 0.13966798782348633, 2.473778486251831, 0.5407977104187012, 1.776235818862915, 1.3965401649475098, 0.9964470863342285, 1.8477354049682617, 1.3519442081451416, 0.21317553520202637, 0.7132523059844971, 0.12616634368896484, 1.284994125366211, 0.8589417934417725, 2.075598955154419, 0.3527646064758301, 0.9416725635528564, 1.4554147720336914, 0.1421506404876709, 2.3583834171295166, 0.22596001625061035], "mean_td_error": 1.0215816497802734, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 84.0, "diff_num_grad_updates_vs_sampler_policy": 83.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.059234619140625, "actor_loss": -7.723861217498779, "critic_loss": 0.13429415225982666, "alpha_loss": -0.25061699748039246, "alpha_value": 0.9753936529159546, "log_alpha_value": -0.024914121255278587, "target_entropy": -6.0, "policy_t": -0.021691063418984413, "mean_q": 3.7709734439849854, "max_q": 4.310432434082031, "min_q": 3.2323765754699707}, "td_error": [1.2689521312713623, 0.07116162776947021, 0.34160661697387695, 0.14561843872070312, 0.0800560712814331, 0.121673583984375, 1.5108693838119507, 0.16384196281433105, 0.7181322574615479, 0.07366406917572021, 0.3301354646682739, 0.719099760055542, 0.9728765487670898, 0.18841636180877686, 1.1278773546218872, 1.9563813209533691, 1.1108031272888184, 1.5083537101745605, 3.4533276557922363, 1.8863024711608887, 0.35485076904296875, 0.5794296264648438, 0.5992584228515625, 0.32762837409973145, 0.8638057708740234, 0.20941472053527832, 1.2836792469024658, 0.18745112419128418, 1.4064933061599731, 1.184098482131958, 0.6458022594451904, 0.9840234518051147, 0.27335309982299805, 1.0558828115463257, 0.25868380069732666, 0.5597250461578369, 2.106152296066284, 1.8315837383270264, 0.6469154357910156, 0.5386420488357544, 1.608731746673584, 0.40683412551879883, 0.5984656810760498, 1.3707321882247925, 1.3767943382263184, 2.3853707313537598, 1.2883906364440918, 1.2055392265319824, 1.116733193397522, 1.4712969064712524, 0.11950516700744629, 0.06656861305236816, 0.468630313873291, 0.1274813413619995, 0.7897565364837646, 0.6338034868240356, 1.1149110794067383, 0.11673223972320557, 0.10966122150421143, 0.6352834701538086, 1.2904455661773682, 0.8769732713699341, 0.5396064519882202, 1.5645501613616943, 1.5538485050201416, 0.13462316989898682, 2.4363245964050293, 0.9071507453918457, 0.16356587409973145, 2.1371278762817383, 0.2847045660018921, 1.2238694429397583, 0.19444072246551514, 2.1434783935546875, 0.6731449365615845, 0.31512558460235596, 0.5440133810043335, 0.08098781108856201, 1.1716954708099365, 0.5222070217132568, 0.9719761610031128, 0.9122889041900635, 1.5064955949783325, 0.680591344833374, 0.3172607421875, 0.07310605049133301], "mean_td_error": 0.8590331077575684, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 84.0, "diff_num_grad_updates_vs_sampler_policy": 83.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.072402954101562, "actor_loss": -7.547816753387451, "critic_loss": 0.1377335786819458, "alpha_loss": -0.25074756145477295, "alpha_value": 0.9754127860069275, "log_alpha_value": -0.024894513189792633, "target_entropy": -6.0, "policy_t": -0.03431984409689903, "mean_q": 3.6186296939849854, "max_q": 4.227492332458496, "min_q": 3.043588638305664}, "td_error": [0.5925216674804688, 0.05332589149475098, 0.2342137098312378, 0.19035613536834717, 1.8180112838745117, 0.8295953273773193, 1.8710802793502808, 0.9210381507873535, 0.3563234806060791, 1.0516494512557983, 2.2865662574768066, 1.565696358680725, 1.033329725265503, 0.2134913206100464, 1.4032697677612305, 0.35353636741638184, 0.6880209445953369, 0.6581671237945557, 1.3991496562957764, 2.021296739578247, 1.8450419902801514, 1.4422227144241333, 0.5460807085037231, 0.44247305393218994, 0.06919527053833008, 1.0042035579681396, 0.430922269821167, 0.4933431148529053, 0.3837869167327881, 0.13118374347686768, 0.921960711479187, 1.12553071975708, 1.436279296875, 1.8350460529327393, 1.0065308809280396, 0.07302474975585938, 0.3698916435241699, 0.07929027080535889, 0.9922845363616943, 0.7170023918151855, 0.9761269092559814, 0.5892664194107056, 1.56719970703125, 0.09901046752929688, 1.5324616432189941, 0.5376708507537842, 0.526024580001831, 1.311723232269287, 0.989534854888916, 0.1433337926864624, 0.6902624368667603, 1.4130741357803345, 0.27266931533813477, 0.30818700790405273, 0.21088004112243652, 1.6022088527679443, 0.38925135135650635, 0.4288206100463867, 1.9090397357940674, 0.178267240524292, 1.540753722190857, 1.9196875095367432, 0.6669039726257324, 0.978417158126831, 0.07047140598297119, 0.358731746673584, 0.5788387060165405, 1.1728252172470093, 1.1803319454193115, 0.45387542247772217, 0.31465673446655273, 2.423008918762207, 0.714897871017456, 0.9887571334838867, 1.7496778964996338, 1.7239644527435303, 1.6897900104522705, 1.0230991840362549, 0.8727318048477173, 0.7861469984054565, 0.14374589920043945, 1.6494379043579102, 1.0711944103240967, 2.3905837535858154, 1.6354316473007202, 0.14922738075256348], "mean_td_error": 0.9163737893104553, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 84.0, "diff_num_grad_updates_vs_sampler_policy": 83.0}}, "num_env_steps_sampled": 76160, "num_env_steps_trained": 21672, "num_agent_steps_sampled": 228480, "num_agent_steps_trained": 21672, "last_target_update_ts": 76160, "num_target_updates": 84}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 228480, "num_agent_steps_trained": 21672, "num_env_steps_sampled": 76160, "num_env_steps_trained": 21672, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 416.4760693646487, "num_env_steps_trained_throughput_per_sec": 119.92279675901715, "timesteps_total": 76160, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 228480, "timers": {"training_iteration_time_ms": 2008.384, "sample_time_ms": 1431.101, "load_time_ms": 0.54, "load_throughput": 477825.068, "learn_time_ms": 62.054, "learn_throughput": 4157.676, "synch_weights_time_ms": 16.86}, "counters": {"num_env_steps_sampled": 76160, "num_env_steps_trained": 21672, "num_agent_steps_sampled": 228480, "num_agent_steps_trained": 21672, "last_target_update_ts": 76160, "num_target_updates": 84}, "done": false, "episodes_total": 0, "training_iteration": 85, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-17-36", "timestamp": 1700201856, "time_this_iter_s": 2.1685197353363037, "time_total_s": 171.8448350429535, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8aa4cadc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 171.8448350429535, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 75.43333333333334, "ram_util_percent": 90.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.99639892578125, "actor_loss": -9.339417457580566, "critic_loss": 0.18688316643238068, "alpha_loss": -0.25177711248397827, "alpha_value": 0.9751277565956116, "log_alpha_value": -0.025186778977513313, "target_entropy": -6.0, "policy_t": 0.03167743980884552, "mean_q": 5.513416767120361, "max_q": 6.672115325927734, "min_q": 4.740863800048828}, "td_error": [0.5882105827331543, 0.9119699001312256, 0.45798277854919434, 0.6662313938140869, 0.7519903182983398, 1.3845958709716797, 2.726032257080078, 2.2956931591033936, 1.7895562648773193, 0.08083271980285645, 1.0298490524291992, 0.19204425811767578, 1.5361089706420898, 0.8906970024108887, 0.8551421165466309, 0.4258277416229248, 0.2991161346435547, 0.2169814109802246, 0.32221484184265137, 1.5991873741149902, 0.5890891551971436, 1.7504222393035889, 0.4159882068634033, 1.622438669204712, 0.13196873664855957, 0.9691464900970459, 0.2935347557067871, 1.4610099792480469, 1.3608803749084473, 1.553802490234375, 0.2642707824707031, 0.42661237716674805, 0.6620984077453613, 1.3799433708190918, 2.393908739089966, 0.45064449310302734, 0.0639641284942627, 0.2906947135925293, 2.0125865936279297, 0.4671452045440674, 0.15538454055786133, 1.2578632831573486, 1.3750357627868652, 0.5192708969116211, 0.1920325756072998, 0.2803812026977539, 1.0580153465270996, 2.325451374053955, 1.1807241439819336, 1.5665180683135986, 0.26255083084106445, 0.46219849586486816, 0.18946480751037598, 0.3546264171600342, 2.895155906677246, 1.094627857208252, 0.5642900466918945, 1.1699371337890625, 1.040771484375, 1.57420015335083, 0.5005557537078857, 0.6663389205932617, 0.6347475051879883, 0.12624573707580566, 0.9447529315948486, 2.017630100250244, 0.3349783420562744, 1.4877474308013916, 0.34419727325439453, 0.84967041015625, 0.1251530647277832, 1.2051942348480225, 0.8540081977844238, 0.9707577228546143, 0.23651790618896484, 1.4894907474517822, 2.471647024154663, 0.565284013748169, 1.0864500999450684, 1.6545295715332031, 0.5620317459106445, 1.898869514465332, 0.13599419593811035, 0.05572199821472168, 1.6196999549865723, 2.424619436264038], "mean_td_error": 0.9576948285102844, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 85.0, "diff_num_grad_updates_vs_sampler_policy": 84.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.055753707885742, "actor_loss": -7.775102615356445, "critic_loss": 0.12924985587596893, "alpha_loss": -0.25354811549186707, "alpha_value": 0.9751009941101074, "log_alpha_value": -0.02521423064172268, "target_entropy": -6.0, "policy_t": 0.022624723613262177, "mean_q": 3.8032922744750977, "max_q": 4.393860816955566, "min_q": 3.342236280441284}, "td_error": [0.921419620513916, 0.7744406461715698, 0.5496406555175781, 0.1444162130355835, 0.07943236827850342, 0.6176023483276367, 1.773584246635437, 1.6485728025436401, 0.5815457105636597, 0.13432884216308594, 2.0283150672912598, 0.512175440788269, 0.4294964075088501, 0.4144226312637329, 1.222746729850769, 0.15857911109924316, 1.8051083087921143, 1.310379981994629, 1.3439704179763794, 0.842137336730957, 0.044632673263549805, 1.0910882949829102, 0.12047791481018066, 0.06315457820892334, 0.8490288257598877, 1.9631192684173584, 1.864305853843689, 0.5317879915237427, 1.073657512664795, 1.6561901569366455, 1.807799220085144, 0.12746047973632812, 0.31527936458587646, 1.3180735111236572, 0.16329920291900635, 0.8158878087997437, 0.3883194923400879, 0.941769003868103, 0.6798990964889526, 0.11677002906799316, 2.011716365814209, 0.2694498300552368, 3.5908737182617188, 0.6886477470397949, 0.40713465213775635, 1.17336905002594, 0.9178407192230225, 0.33903205394744873, 0.043205857276916504, 1.1049977540969849, 0.49977755546569824, 0.08239579200744629, 0.2778439521789551, 1.3247334957122803, 2.40191650390625, 0.14935636520385742, 0.43406450748443604, 0.40077340602874756, 1.5313076972961426, 0.3732266426086426, 0.579573392868042, 0.0700005292892456, 0.27399277687072754, 0.16232240200042725, 0.8306877613067627, 0.9424326419830322, 0.061307311058044434, 1.6233772039413452, 1.2511810064315796, 0.2708362340927124, 0.44455230236053467, 1.3593130111694336, 0.4498034715652466, 0.49237537384033203, 0.44555914402008057, 0.9110373258590698, 1.7881582975387573, 0.8600395917892456, 0.9184378385543823, 2.4639201164245605, 0.13123548030853271, 0.07907581329345703, 0.23162484169006348, 1.2551225423812866, 0.2114626169204712, 1.3278687000274658], "mean_td_error": 0.821875274181366, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 85.0, "diff_num_grad_updates_vs_sampler_policy": 84.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.024370193481445, "actor_loss": -7.577977180480957, "critic_loss": 0.1312631517648697, "alpha_loss": -0.25255295634269714, "alpha_value": 0.9751208424568176, "log_alpha_value": -0.025193894281983376, "target_entropy": -6.0, "policy_t": -0.012659667059779167, "mean_q": 3.671675682067871, "max_q": 4.344363212585449, "min_q": 3.131798505783081}, "td_error": [0.6381689310073853, 1.5968793630599976, 1.1102385520935059, 1.987293004989624, 0.8933782577514648, 0.2808258533477783, 2.7019996643066406, 0.6439287662506104, 0.47984790802001953, 0.23774898052215576, 0.6088699102401733, 1.3388432264328003, 0.19971215724945068, 0.9791572093963623, 0.9626812934875488, 1.5955294370651245, 0.11475610733032227, 1.2287583351135254, 0.05579233169555664, 1.329960584640503, 0.7814856767654419, 0.1541348695755005, 0.46059274673461914, 0.5917994976043701, 0.6108227968215942, 0.2621800899505615, 0.8417577743530273, 1.7592605352401733, 0.05153489112854004, 1.5085668563842773, 1.3692827224731445, 1.6161526441574097, 0.18542253971099854, 1.1934012174606323, 0.5364099740982056, 0.7436262369155884, 0.5454616546630859, 0.827182412147522, 2.2151834964752197, 0.9562408924102783, 0.8822096586227417, 1.3028991222381592, 0.3002312183380127, 0.34702324867248535, 0.028681635856628418, 0.8139826059341431, 0.8268687725067139, 0.18077921867370605, 1.0307111740112305, 0.15156185626983643, 2.119093418121338, 1.2297319173812866, 0.8125951290130615, 0.9868414402008057, 0.7394798994064331, 0.03898429870605469, 1.8818295001983643, 2.557358980178833, 1.029529333114624, 1.1428821086883545, 2.2916626930236816, 0.2709904909133911, 1.7872734069824219, 0.275860071182251, 1.9962737560272217, 0.6929341554641724, 0.46126222610473633, 0.9029121398925781, 0.6929798126220703, 0.6120418310165405, 1.238328218460083, 0.3865032196044922, 0.7750321626663208, 0.8517825603485107, 0.4473646879196167, 0.9422973394393921, 0.5521241426467896, 1.3373576402664185, 0.6284387111663818, 0.8480448722839355, 0.6033904552459717, 0.22632503509521484, 0.4034276008605957, 0.27312302589416504, 1.7612601518630981, 0.4905574321746826], "mean_td_error": 0.8877637982368469, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 85.0, "diff_num_grad_updates_vs_sampler_policy": 84.0}}, "num_env_steps_sampled": 77056, "num_env_steps_trained": 21930, "num_agent_steps_sampled": 231168, "num_agent_steps_trained": 21930, "last_target_update_ts": 77056, "num_target_updates": 85}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 231168, "num_agent_steps_trained": 21930, "num_env_steps_sampled": 77056, "num_env_steps_trained": 21930, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 439.7461828599806, "num_env_steps_trained_throughput_per_sec": 126.62334283244977, "timesteps_total": 77056, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 231168, "timers": {"training_iteration_time_ms": 2023.631, "sample_time_ms": 1447.955, "load_time_ms": 0.54, "load_throughput": 477466.657, "learn_time_ms": 62.101, "learn_throughput": 4154.509, "synch_weights_time_ms": 16.438}, "counters": {"num_env_steps_sampled": 77056, "num_env_steps_trained": 21930, "num_agent_steps_sampled": 231168, "num_agent_steps_trained": 21930, "last_target_update_ts": 77056, "num_target_updates": 85}, "done": false, "episodes_total": 0, "training_iteration": 86, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-17-38", "timestamp": 1700201858, "time_this_iter_s": 2.054859161376953, "time_total_s": 173.89969420433044, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8c8afb4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 173.89969420433044, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 71.8, "ram_util_percent": 90.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.06358528137207, "actor_loss": -9.33695125579834, "critic_loss": 0.20970860123634338, "alpha_loss": -0.2564746141433716, "alpha_value": 0.9748365879058838, "log_alpha_value": -0.025485413148999214, "target_entropy": -6.0, "policy_t": 0.007244337350130081, "mean_q": 5.519726753234863, "max_q": 6.3891215324401855, "min_q": 4.617440223693848}, "td_error": [3.4666082859039307, 1.365255355834961, 1.9659037590026855, 2.563096046447754, 1.1867918968200684, 1.8323383331298828, 2.119877576828003, 0.7357773780822754, 1.8647315502166748, 1.374518871307373, 0.09513258934020996, 1.674238681793213, 1.570303201675415, 0.8708794116973877, 1.2255542278289795, 0.94765305519104, 0.9234626293182373, 0.7468216419219971, 1.2127327919006348, 0.47241878509521484, 0.3518202304840088, 0.37804079055786133, 1.6538069248199463, 1.00266432762146, 0.6145308017730713, 2.075349807739258, 0.2089371681213379, 0.3156321048736572, 0.705679178237915, 3.4503185749053955, 0.4109776020050049, 0.5360536575317383, 1.3019354343414307, 1.3802673816680908, 1.9592092037200928, 0.2173464298248291, 1.2591593265533447, 0.13362526893615723, 0.2952239513397217, 2.476846694946289, 1.2824718952178955, 1.147217035293579, 2.423497438430786, 0.4902656078338623, 1.048804521560669, 0.09002065658569336, 0.558452844619751, 1.9469590187072754, 0.0986948013305664, 1.9448485374450684, 1.09596586227417, 0.8546380996704102, 0.030002117156982422, 0.1568007469177246, 1.283508539199829, 0.7116737365722656, 0.6833691596984863, 0.42267942428588867, 2.6157567501068115, 0.15760350227355957, 0.660771369934082, 0.40771913528442383, 1.5199205875396729, 0.08822274208068848, 1.2450556755065918, 1.357398509979248, 0.9207417964935303, 1.4336822032928467, 0.07870602607727051, 0.0326237678527832, 1.1275279521942139, 0.23732328414916992, 0.11786365509033203, 0.06534385681152344, 1.3460733890533447, 1.161332368850708, 1.4030711650848389, 0.36718082427978516, 0.1819448471069336, 0.16565203666687012, 0.317779541015625, 0.832564115524292, 0.0026128292083740234, 0.9582593441009521, 0.31662464141845703, 2.0439884662628174], "mean_td_error": 1.0043573379516602, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 86.0, "diff_num_grad_updates_vs_sampler_policy": 85.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.096362113952637, "actor_loss": -7.839438438415527, "critic_loss": 0.16177335381507874, "alpha_loss": -0.2576010823249817, "alpha_value": 0.9748085141181946, "log_alpha_value": -0.02551424875855446, "target_entropy": -6.0, "policy_t": 0.01922275871038437, "mean_q": 3.8851261138916016, "max_q": 4.4306321144104, "min_q": 3.396939516067505}, "td_error": [1.516798734664917, 1.2081644535064697, 2.152679443359375, 1.852232575416565, 0.06920516490936279, 1.3403433561325073, 0.5379660129547119, 1.7167837619781494, 0.35707688331604004, 0.6978036165237427, 0.5036177635192871, 2.4754252433776855, 0.21825897693634033, 0.5538370609283447, 0.16107380390167236, 1.435232400894165, 2.674014091491699, 0.7278722524642944, 0.45656275749206543, 0.14194834232330322, 0.050766944885253906, 0.6768741607666016, 0.707553505897522, 1.2956140041351318, 1.0181899070739746, 3.3003759384155273, 0.35561060905456543, 1.6863077878952026, 1.7335474491119385, 2.4610424041748047, 0.9126579761505127, 1.874834418296814, 0.2886784076690674, 1.3607903718948364, 2.984982967376709, 0.9482779502868652, 0.19721388816833496, 1.5829510688781738, 0.8027591705322266, 0.04893159866333008, 0.9899404048919678, 0.1844480037689209, 1.5166542530059814, 0.37376606464385986, 1.4342459440231323, 0.5014853477478027, 0.5004270076751709, 0.06526410579681396, 0.7392218112945557, 0.8651900291442871, 0.7001566886901855, 1.7223635911941528, 0.9517006874084473, 1.9834625720977783, 0.4811110496520996, 0.04207146167755127, 0.6456863880157471, 0.06221175193786621, 0.8417377471923828, 1.7221956253051758, 0.42832279205322266, 0.058144330978393555, 1.6836174726486206, 1.4335075616836548, 2.582634687423706, 0.2351846694946289, 0.5593326091766357, 1.1404852867126465, 0.42572021484375, 0.4887537956237793, 0.5874981880187988, 0.363322377204895, 0.3657681941986084, 0.6799300909042358, 0.6624124050140381, 0.557664155960083, 0.7342214584350586, 0.6959595680236816, 0.170698881149292, 0.17366766929626465, 2.1176960468292236, 1.0974111557006836, 0.9484081268310547, 1.2399373054504395, 1.7089788913726807, 0.1177666187286377], "mean_td_error": 0.961223840713501, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 86.0, "diff_num_grad_updates_vs_sampler_policy": 85.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.983081817626953, "actor_loss": -7.544618129730225, "critic_loss": 0.16669239103794098, "alpha_loss": -0.2545006275177002, "alpha_value": 0.9748290181159973, "log_alpha_value": -0.025493191555142403, "target_entropy": -6.0, "policy_t": 0.0029782126657664776, "mean_q": 3.6540169715881348, "max_q": 4.339387893676758, "min_q": 3.027129650115967}, "td_error": [0.042938232421875, 0.6886178255081177, 0.9893585443496704, 1.3761295080184937, 0.5482786893844604, 0.8080090284347534, 0.6134073734283447, 1.0742805004119873, 1.1819177865982056, 1.7404085397720337, 0.9023287296295166, 0.16083836555480957, 1.2244185209274292, 0.8023874759674072, 0.0799863338470459, 1.5872434377670288, 1.629871129989624, 0.40777671337127686, 0.020400643348693848, 0.04175424575805664, 0.5074882507324219, 0.8054273128509521, 2.650993824005127, 0.7997802495956421, 0.6506646871566772, 2.97153377532959, 0.4848899841308594, 0.08961129188537598, 0.22334134578704834, 1.2817500829696655, 0.2546426057815552, 1.3765935897827148, 2.7055954933166504, 1.0296735763549805, 0.963645339012146, 0.3576136827468872, 1.4481943845748901, 0.9832587242126465, 0.716667652130127, 1.381250262260437, 1.6910499334335327, 0.2729867696762085, 0.2305436134338379, 0.07813870906829834, 0.6157464981079102, 0.6116557121276855, 1.423072099685669, 0.4844461679458618, 1.780049204826355, 0.17018258571624756, 3.098092555999756, 0.1645510196685791, 0.4420795440673828, 0.6778033971786499, 1.292887568473816, 0.5311734676361084, 0.2254478931427002, 1.9516257047653198, 0.24382853507995605, 0.849287748336792, 3.172244071960449, 0.8398562669754028, 2.7868850231170654, 0.20460820198059082, 0.9201418161392212, 0.8929493427276611, 2.3023812770843506, 2.0910768508911133, 1.2963886260986328, 0.8921163082122803, 1.6045550107955933, 0.4449101686477661, 0.7933166027069092, 3.6885018348693848, 1.856337308883667, 0.36033713817596436, 0.0996164083480835, 1.8253694772720337, 1.1412934064865112, 0.6585639715194702, 1.6617988348007202, 0.11624610424041748, 0.8252325057983398, 0.20978474617004395, 1.5498826503753662, 0.22755718231201172], "mean_td_error": 1.0104600191116333, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 86.0, "diff_num_grad_updates_vs_sampler_policy": 85.0}}, "num_env_steps_sampled": 77952, "num_env_steps_trained": 22188, "num_agent_steps_sampled": 233856, "num_agent_steps_trained": 22188, "last_target_update_ts": 77952, "num_target_updates": 86}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 233856, "num_agent_steps_trained": 22188, "num_env_steps_sampled": 77952, "num_env_steps_trained": 22188, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 435.18633082136824, "num_env_steps_trained_throughput_per_sec": 125.3103497231172, "timesteps_total": 77952, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 233856, "timers": {"training_iteration_time_ms": 2043.392, "sample_time_ms": 1466.837, "load_time_ms": 0.541, "load_throughput": 476835.477, "learn_time_ms": 62.179, "learn_throughput": 4149.343, "synch_weights_time_ms": 16.358}, "counters": {"num_env_steps_sampled": 77952, "num_env_steps_trained": 22188, "num_agent_steps_sampled": 233856, "num_agent_steps_trained": 22188, "last_target_update_ts": 77952, "num_target_updates": 86}, "done": false, "episodes_total": 0, "training_iteration": 87, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-17-40", "timestamp": 1700201860, "time_this_iter_s": 2.076900005340576, "time_total_s": 175.97659420967102, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8981fa280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 175.97659420967102, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 76.60000000000001, "ram_util_percent": 90.73333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.085834503173828, "actor_loss": -9.338547706604004, "critic_loss": 0.13175716996192932, "alpha_loss": -0.26005491614341736, "alpha_value": 0.974545419216156, "log_alpha_value": -0.025784175843000412, "target_entropy": -6.0, "policy_t": -0.04259495809674263, "mean_q": 5.544972896575928, "max_q": 6.381106376647949, "min_q": 4.801318168640137}, "td_error": [0.24732589721679688, 0.19515323638916016, 1.6777257919311523, 0.1645677089691162, 0.27075934410095215, 1.8718194961547852, 0.7410955429077148, 2.4319839477539062, 0.2505779266357422, 1.871138334274292, 0.18758320808410645, 2.8888280391693115, 0.575742244720459, 2.2862532138824463, 0.11835074424743652, 2.3840267658233643, 1.220686912536621, 0.67352294921875, 0.10501646995544434, 1.0408203601837158, 0.6291882991790771, 0.3852720260620117, 0.4711589813232422, 0.6254622936248779, 0.4931955337524414, 0.3135566711425781, 0.7242951393127441, 1.0945725440979004, 2.1231110095977783, 0.42976856231689453, 1.0737254619598389, 1.2497060298919678, 2.8493874073028564, 1.688490629196167, 0.9621274471282959, 1.080648422241211, 1.0891363620758057, 0.17478179931640625, 0.8987324237823486, 3.37412691116333, 0.5913136005401611, 1.0465683937072754, 1.2679510116577148, 1.3930983543395996, 1.7897953987121582, 1.259345531463623, 0.9362623691558838, 0.9652564525604248, 1.570303201675415, 0.2771620750427246, 1.9078929424285889, 1.4900109767913818, 0.1790013313293457, 0.05523061752319336, 0.6380834579467773, 0.8868753910064697, 0.03287911415100098, 0.7524325847625732, 0.3734748363494873, 0.6039345264434814, 1.1212153434753418, 0.07925224304199219, 0.2001018524169922, 0.5066916942596436, 0.7552433013916016, 0.504652738571167, 0.20562362670898438, 0.7526016235351562, 0.7482564449310303, 2.6100287437438965, 2.2596559524536133, 1.030991792678833, 1.234501600265503, 0.14378976821899414, 1.1343326568603516, 0.22153925895690918, 0.6338949203491211, 0.9454588890075684, 0.24524140357971191, 0.02939319610595703, 1.3083758354187012, 0.3064744472503662, 1.2261836528778076, 1.1821081638336182, 0.48288536071777344, 0.6412346363067627], "mean_td_error": 0.9472095370292664, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 87.0, "diff_num_grad_updates_vs_sampler_policy": 86.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.012796401977539, "actor_loss": -7.829521656036377, "critic_loss": 0.1610850989818573, "alpha_loss": -0.2584732174873352, "alpha_value": 0.9745160341262817, "log_alpha_value": -0.025814291089773178, "target_entropy": -6.0, "policy_t": -0.021040471270680428, "mean_q": 3.8929741382598877, "max_q": 4.423009395599365, "min_q": 3.4246034622192383}, "td_error": [0.03943002223968506, 0.2701451778411865, 1.6324416399002075, 1.3795613050460815, 1.8413043022155762, 0.7193841934204102, 0.9038996696472168, 0.8619415760040283, 2.707993984222412, 1.0373165607452393, 0.3876669406890869, 2.1669044494628906, 1.6677929162979126, 0.35373663902282715, 0.5323246717453003, 0.9168306589126587, 1.2184041738510132, 0.17853295803070068, 2.708275079727173, 0.3245723247528076, 0.2628147602081299, 1.1979951858520508, 2.7729203701019287, 0.8333566188812256, 1.2733118534088135, 0.6108965873718262, 1.4938697814941406, 0.3674643039703369, 0.37007367610931396, 0.09314632415771484, 0.6808651685714722, 1.2370431423187256, 0.024835824966430664, 0.4822237491607666, 1.3127905130386353, 1.1204237937927246, 0.5770539045333862, 1.1515876054763794, 0.33769428730010986, 1.8949902057647705, 0.0968085527420044, 0.5099086761474609, 0.14045965671539307, 1.4282009601593018, 0.05816364288330078, 0.5620671510696411, 0.9744396209716797, 0.5224094390869141, 0.07011198997497559, 0.11445081233978271, 1.202265739440918, 0.4497342109680176, 0.4959571361541748, 1.755119800567627, 0.5547373294830322, 0.4475138187408447, 0.2291790246963501, 0.16092801094055176, 1.1286700963974, 0.37005460262298584, 0.6944917440414429, 0.033093929290771484, 1.6595585346221924, 1.7549028396606445, 0.8256510496139526, 2.072721481323242, 1.2868235111236572, 0.11495721340179443, 1.6807861328125, 2.050312042236328, 1.7158420085906982, 0.45410966873168945, 1.839047908782959, 2.2212088108062744, 1.450160026550293, 2.18839168548584, 0.47606396675109863, 0.2823019027709961, 1.7365515232086182, 0.4771183729171753, 0.10157501697540283, 1.8209338188171387, 0.7416889667510986, 1.0291955471038818, 1.9762904644012451, 1.0543644428253174], "mean_td_error": 0.9645714163780212, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 87.0, "diff_num_grad_updates_vs_sampler_policy": 86.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.12122631072998, "actor_loss": -7.620761394500732, "critic_loss": 0.11968834698200226, "alpha_loss": -0.2610497772693634, "alpha_value": 0.9745374917984009, "log_alpha_value": -0.025792306289076805, "target_entropy": -6.0, "policy_t": 0.03526303172111511, "mean_q": 3.624232530593872, "max_q": 4.191446781158447, "min_q": 3.058117628097534}, "td_error": [0.22910654544830322, 0.7605202198028564, 1.1131770610809326, 2.696686267852783, 0.6436494588851929, 0.18107914924621582, 2.3358240127563477, 2.199249744415283, 0.7281237840652466, 0.9851062297821045, 0.18480992317199707, 0.44653594493865967, 0.6688635349273682, 0.02759230136871338, 0.2782864570617676, 0.40506434440612793, 0.4423481225967407, 1.4331140518188477, 0.9495205879211426, 0.10905265808105469, 0.8368227481842041, 2.421835422515869, 0.023087024688720703, 0.3814513683319092, 1.4054616689682007, 0.9246797561645508, 0.7841396331787109, 0.20110678672790527, 1.2704644203186035, 1.367849349975586, 1.1351628303527832, 1.3447374105453491, 0.9290151596069336, 0.3211190700531006, 0.19948172569274902, 0.2596015930175781, 0.8704599142074585, 1.085906744003296, 1.2907694578170776, 1.3897119760513306, 1.0507698059082031, 1.3637449741363525, 0.603630781173706, 0.88753342628479, 0.14761090278625488, 1.3024046421051025, 1.1284221410751343, 0.3315441608428955, 0.46874308586120605, 1.031978726387024, 0.5205764770507812, 0.7898159027099609, 0.016216039657592773, 0.2990511655807495, 0.9037426710128784, 0.0188596248626709, 0.8089795112609863, 0.7432351112365723, 1.1747044324874878, 1.130752444267273, 0.21921312808990479, 0.758089542388916, 1.2407056093215942, 1.6754968166351318, 1.6632049083709717, 1.1521676778793335, 0.3046557903289795, 0.5242128372192383, 1.4557781219482422, 1.013137936592102, 2.4839000701904297, 0.8829202651977539, 0.5546503067016602, 0.24465107917785645, 0.9514166116714478, 0.9111219644546509, 0.5591558218002319, 0.1613079309463501, 1.6927658319473267, 0.7892477512359619, 1.2941019535064697, 0.4086124897003174, 0.3711233139038086, 0.37020397186279297, 0.2606325149536133, 1.4845104217529297], "mean_td_error": 0.853603184223175, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 87.0, "diff_num_grad_updates_vs_sampler_policy": 86.0}}, "num_env_steps_sampled": 78848, "num_env_steps_trained": 22446, "num_agent_steps_sampled": 236544, "num_agent_steps_trained": 22446, "last_target_update_ts": 78848, "num_target_updates": 87}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 236544, "num_agent_steps_trained": 22446, "num_env_steps_sampled": 78848, "num_env_steps_trained": 22446, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 352.3010805185124, "num_env_steps_trained_throughput_per_sec": 101.44383791716093, "timesteps_total": 78848, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 236544, "timers": {"training_iteration_time_ms": 2116.891, "sample_time_ms": 1541.741, "load_time_ms": 0.54, "load_throughput": 477740.688, "learn_time_ms": 62.475, "learn_throughput": 4129.637, "synch_weights_time_ms": 16.402}, "counters": {"num_env_steps_sampled": 78848, "num_env_steps_trained": 22446, "num_agent_steps_sampled": 236544, "num_agent_steps_trained": 22446, "last_target_update_ts": 78848, "num_target_updates": 87}, "done": false, "episodes_total": 0, "training_iteration": 88, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-17-42", "timestamp": 1700201862, "time_this_iter_s": 2.558873176574707, "time_total_s": 178.53546738624573, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8aa4cadc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 178.53546738624573, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 61.47500000000001, "ram_util_percent": 90.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.052635192871094, "actor_loss": -9.321906089782715, "critic_loss": 0.11412166059017181, "alpha_loss": -0.26220405101776123, "alpha_value": 0.9742541313171387, "log_alpha_value": -0.02608311176300049, "target_entropy": -6.0, "policy_t": -0.0032735010609030724, "mean_q": 5.457312107086182, "max_q": 6.226667881011963, "min_q": 4.6310343742370605}, "td_error": [0.20694518089294434, 0.2859070301055908, 1.8841898441314697, 1.9618546962738037, 1.6075704097747803, 0.24675798416137695, 1.8761262893676758, 1.5220293998718262, 0.9124081134796143, 0.6223444938659668, 0.07107686996459961, 1.8874690532684326, 3.0594606399536133, 0.5307979583740234, 1.2393755912780762, 0.2071056365966797, 0.4404256343841553, 0.4001307487487793, 0.3123350143432617, 0.8371498584747314, 0.761265754699707, 0.37944507598876953, 0.5060324668884277, 0.593069314956665, 1.0788841247558594, 0.301377534866333, 0.37665319442749023, 0.7389624118804932, 0.4433894157409668, 1.2095136642456055, 0.4335649013519287, 1.2431073188781738, 0.19444727897644043, 2.328153371810913, 0.7612488269805908, 0.6518290042877197, 0.21445941925048828, 1.1168949604034424, 1.497697114944458, 0.6976215839385986, 0.4171936511993408, 1.262765884399414, 0.23868322372436523, 0.4310441017150879, 0.17765426635742188, 0.5392031669616699, 0.2735590934753418, 0.8723411560058594, 1.6508440971374512, 1.3396968841552734, 0.16216778755187988, 0.794346809387207, 0.20211243629455566, 0.1705493927001953, 0.4517207145690918, 0.27602195739746094, 0.2899613380432129, 0.8270535469055176, 1.33056640625, 2.0656261444091797, 1.205897569656372, 0.48453783988952637, 1.3108584880828857, 0.5818893909454346, 0.22597169876098633, 0.3122119903564453, 0.7792196273803711, 0.6230514049530029, 1.1833529472351074, 1.8867943286895752, 0.44669651985168457, 0.9503850936889648, 0.30025196075439453, 1.8839266300201416, 2.5253005027770996, 0.21312379837036133, 0.09886622428894043, 0.4586822986602783, 1.2863645553588867, 1.870274543762207, 1.365447998046875, 1.0985403060913086, 1.1893105506896973, 1.7231793403625488, 1.072214126586914, 1.1630802154541016], "mean_td_error": 0.8796699643135071, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 88.0, "diff_num_grad_updates_vs_sampler_policy": 87.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.103935241699219, "actor_loss": -7.879711151123047, "critic_loss": 0.16739429533481598, "alpha_loss": -0.26385554671287537, "alpha_value": 0.9742239117622375, "log_alpha_value": -0.02611413598060608, "target_entropy": -6.0, "policy_t": 0.04212548956274986, "mean_q": 3.9398434162139893, "max_q": 4.453981399536133, "min_q": 3.427011251449585}, "td_error": [0.5347669124603271, 2.5081353187561035, 0.2157745361328125, 0.19270706176757812, 2.090611219406128, 1.7483980655670166, 0.42175137996673584, 1.5322498083114624, 1.1407482624053955, 0.7307703495025635, 0.29017889499664307, 0.20735549926757812, 2.1792664527893066, 2.0560953617095947, 0.829211950302124, 1.7446887493133545, 0.42598414421081543, 0.4863858222961426, 0.8712455034255981, 1.0347481966018677, 1.544454574584961, 0.31491637229919434, 0.995962381362915, 0.3469599485397339, 1.647206425666809, 1.8080092668533325, 0.2440410852432251, 0.5092760324478149, 1.4509862661361694, 0.9793210029602051, 1.0690836906433105, 0.8688690662384033, 0.03948390483856201, 1.598577857017517, 0.15612900257110596, 0.3368927240371704, 0.5427155494689941, 1.0377367734909058, 0.8908122777938843, 0.6664586067199707, 0.11681890487670898, 0.6695108413696289, 1.1693302392959595, 1.5209922790527344, 1.0301129817962646, 1.2184736728668213, 1.2292367219924927, 1.7617830038070679, 0.5373685359954834, 0.358479380607605, 0.6135551929473877, 0.3718578815460205, 0.38651084899902344, 0.755326509475708, 1.6670148372650146, 1.4607300758361816, 2.295199394226074, 0.9576985836029053, 0.23650407791137695, 2.057734966278076, 0.8690263032913208, 0.6880769729614258, 0.5205364227294922, 0.17461836338043213, 2.0699965953826904, 0.675217866897583, 1.4064944982528687, 0.4800124168395996, 1.7575945854187012, 1.7262184619903564, 1.4319849014282227, 1.0782768726348877, 2.6772613525390625, 0.7501624822616577, 0.33652520179748535, 1.1524677276611328, 1.815304160118103, 1.4102909564971924, 0.6581755876541138, 1.3930556774139404, 2.1711859703063965, 0.389157772064209, 1.6354014873504639, 0.4823821783065796, 0.6009304523468018, 0.17290854454040527], "mean_td_error": 1.014261245727539, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 88.0, "diff_num_grad_updates_vs_sampler_policy": 87.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.061898231506348, "actor_loss": -7.648171901702881, "critic_loss": 0.15247857570648193, "alpha_loss": -0.26253125071525574, "alpha_value": 0.9742458462715149, "log_alpha_value": -0.026091622188687325, "target_entropy": -6.0, "policy_t": -0.052243687212467194, "mean_q": 3.6712844371795654, "max_q": 4.290701389312744, "min_q": 3.15905499458313}, "td_error": [0.0356297492980957, 0.3308541774749756, 0.5607768297195435, 0.548241138458252, 1.2491059303283691, 0.9037792682647705, 1.3327051401138306, 0.8027561902999878, 0.5297180414199829, 0.998584508895874, 1.0111911296844482, 0.8193939924240112, 0.5813959836959839, 0.37270641326904297, 1.4028838872909546, 2.164949893951416, 2.8390860557556152, 0.08892130851745605, 1.353454351425171, 1.1083486080169678, 1.5387229919433594, 0.6650067567825317, 0.7556474208831787, 0.634247899055481, 1.6158337593078613, 0.24213290214538574, 1.3812862634658813, 2.6958274841308594, 0.8190102577209473, 0.7476303577423096, 1.5612993240356445, 0.7306231260299683, 0.7783876657485962, 1.7459774017333984, 0.5275281667709351, 0.24469733238220215, 0.611565113067627, 2.6333415508270264, 1.2152119874954224, 1.350682258605957, 0.12986886501312256, 0.6893975734710693, 0.7072147130966187, 1.2057024240493774, 0.14721167087554932, 0.896582841873169, 2.9240128993988037, 0.058649420738220215, 0.16756439208984375, 2.5253701210021973, 0.6633381843566895, 0.3532404899597168, 0.9581897258758545, 1.3190678358078003, 1.100712537765503, 0.4418121576309204, 1.0553693771362305, 0.33684349060058594, 0.4989427328109741, 1.2977467775344849, 0.06264984607696533, 0.29904305934906006, 0.6141904592514038, 0.042494893074035645, 1.10502290725708, 1.2437278032302856, 0.5483479499816895, 0.9578989744186401, 1.4846296310424805, 1.1531931161880493, 0.09667587280273438, 0.9287896156311035, 0.8121370077133179, 0.6145563125610352, 2.299468994140625, 0.4042820930480957, 1.953993558883667, 0.16680586338043213, 2.2328085899353027, 0.27990293502807617, 0.5084954500198364, 2.183155059814453, 0.8166803121566772, 1.7289828062057495, 0.16083192825317383, 2.3596384525299072], "mean_td_error": 0.9774928689002991, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 88.0, "diff_num_grad_updates_vs_sampler_policy": 87.0}}, "num_env_steps_sampled": 79744, "num_env_steps_trained": 22704, "num_agent_steps_sampled": 239232, "num_agent_steps_trained": 22704, "last_target_update_ts": 79744, "num_target_updates": 88}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 239232, "num_agent_steps_trained": 22704, "num_env_steps_sampled": 79744, "num_env_steps_trained": 22704, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 482.275283063178, "num_env_steps_trained_throughput_per_sec": 138.86944534631687, "timesteps_total": 79744, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 239232, "timers": {"training_iteration_time_ms": 2113.179, "sample_time_ms": 1536.706, "load_time_ms": 0.54, "load_throughput": 477803.97, "learn_time_ms": 62.396, "learn_throughput": 4134.887, "synch_weights_time_ms": 16.379}, "counters": {"num_env_steps_sampled": 79744, "num_env_steps_trained": 22704, "num_agent_steps_sampled": 239232, "num_agent_steps_trained": 22704, "last_target_update_ts": 79744, "num_target_updates": 88}, "done": false, "episodes_total": 0, "training_iteration": 89, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-17-44", "timestamp": 1700201864, "time_this_iter_s": 1.873124122619629, "time_total_s": 180.40859150886536, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8c8afb4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 180.40859150886536, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 68.93333333333334, "ram_util_percent": 90.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.07097339630127, "actor_loss": -9.327313423156738, "critic_loss": 0.1721082627773285, "alpha_loss": -0.2656935751438141, "alpha_value": 0.9739628434181213, "log_alpha_value": -0.026382116600871086, "target_entropy": -6.0, "policy_t": 0.04019704833626747, "mean_q": 5.495802879333496, "max_q": 6.575110912322998, "min_q": 4.553561687469482}, "td_error": [1.4746947288513184, 0.08911585807800293, 1.3843309879302979, 0.5480334758758545, 1.3533499240875244, 1.2839136123657227, 2.94246506690979, 1.5845472812652588, 0.21758580207824707, 0.9501886367797852, 0.5741689205169678, 0.4640624523162842, 0.28300023078918457, 0.7157177925109863, 0.415616512298584, 1.9376590251922607, 0.6786410808563232, 0.6773381233215332, 3.374668598175049, 0.32004690170288086, 0.28767895698547363, 0.33597588539123535, 0.4800136089324951, 0.35178160667419434, 1.753061056137085, 0.8365926742553711, 0.5183637142181396, 1.99216890335083, 1.9242184162139893, 0.7616839408874512, 0.8134510517120361, 0.46813297271728516, 2.3127365112304688, 0.5801396369934082, 2.7126803398132324, 0.4362599849700928, 1.5677094459533691, 0.29076457023620605, 2.109067916870117, 0.5395965576171875, 0.2963533401489258, 0.716346025466919, 0.05510997772216797, 2.516024351119995, 1.5228676795959473, 0.27092814445495605, 0.8825376033782959, 0.9826018810272217, 0.5304064750671387, 1.032097339630127, 1.7110462188720703, 0.8080711364746094, 0.2456831932067871, 1.8219778537750244, 0.08630108833312988, 0.41106104850769043, 1.4318218231201172, 1.2369356155395508, 1.4868710041046143, 3.6184566020965576, 1.9464447498321533, 2.0665595531463623, 1.6043634414672852, 0.308455228805542, 0.49164843559265137, 0.5480475425720215, 1.7231242656707764, 1.9400568008422852, 3.211756944656372, 0.6361804008483887, 0.060880184173583984, 0.7522199153900146, 0.5817375183105469, 0.8896160125732422, 4.133938789367676, 1.28887939453125, 1.215529203414917, 1.3823328018188477, 2.12907075881958, 0.7264440059661865, 0.1349480152130127, 0.5491304397583008, 1.271467685699463, 1.758559226989746, 0.32941675186157227, 3.2977516651153564], "mean_td_error": 1.150968313217163, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 89.0, "diff_num_grad_updates_vs_sampler_policy": 88.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.074440002441406, "actor_loss": -7.927364826202393, "critic_loss": 0.12785694003105164, "alpha_loss": -0.2661067247390747, "alpha_value": 0.9739317297935486, "log_alpha_value": -0.026414044201374054, "target_entropy": -6.0, "policy_t": 0.01929924450814724, "mean_q": 3.965569496154785, "max_q": 4.5412702560424805, "min_q": 3.5301859378814697}, "td_error": [0.4943399429321289, 0.49307775497436523, 0.19147133827209473, 0.5153745412826538, 0.959561824798584, 0.9155505895614624, 0.40016376972198486, 1.0152640342712402, 0.32453978061676025, 0.42961883544921875, 0.9417095184326172, 0.43803954124450684, 0.025240540504455566, 2.232851982116699, 0.18905127048492432, 0.8397488594055176, 0.8926469087600708, 0.9086122512817383, 1.1673568487167358, 1.3142850399017334, 0.7274000644683838, 1.8818714618682861, 0.3489513397216797, 0.03296613693237305, 1.2833715677261353, 1.1435728073120117, 1.4827136993408203, 0.4245173931121826, 0.4283071756362915, 0.8345952033996582, 0.4024069309234619, 2.3598618507385254, 2.0545997619628906, 0.16390252113342285, 1.8128901720046997, 0.21279597282409668, 1.1557514667510986, 1.438472032546997, 1.180434226989746, 1.084319829940796, 0.23796164989471436, 0.36854255199432373, 0.07617497444152832, 0.8669226169586182, 2.3653717041015625, 0.422680139541626, 0.9359211921691895, 0.7011797428131104, 0.5383701324462891, 0.39498066902160645, 0.4436213970184326, 1.3804067373275757, 1.4222195148468018, 0.42843377590179443, 1.0731351375579834, 0.6063199043273926, 0.3409080505371094, 0.44880425930023193, 0.1375107765197754, 0.6707783937454224, 0.5126163959503174, 1.1571024656295776, 1.0773918628692627, 1.2509994506835938, 1.865456461906433, 1.901875376701355, 0.8533140420913696, 0.3871302604675293, 1.34209406375885, 0.28488755226135254, 2.0254998207092285, 1.0634891986846924, 1.0042142868041992, 0.4174231290817261, 1.5418567657470703, 0.42861342430114746, 0.5558875799179077, 0.9760829210281372, 0.30221498012542725, 0.6105904579162598, 1.1778041124343872, 0.5641735792160034, 0.9017379283905029, 0.8414801359176636, 0.8341097831726074, 0.06299614906311035], "mean_td_error": 0.8481801152229309, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 89.0, "diff_num_grad_updates_vs_sampler_policy": 88.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.122092247009277, "actor_loss": -7.696155071258545, "critic_loss": 0.1360451579093933, "alpha_loss": -0.2671317756175995, "alpha_value": 0.9739542603492737, "log_alpha_value": -0.026390962302684784, "target_entropy": -6.0, "policy_t": -0.003968672826886177, "mean_q": 3.70829701423645, "max_q": 4.293737411499023, "min_q": 3.2088489532470703}, "td_error": [0.3015979528427124, 2.209284543991089, 0.8219294548034668, 0.3967726230621338, 1.4954938888549805, 0.8055360317230225, 0.0634239912033081, 0.5713729858398438, 0.6781643629074097, 0.5022172927856445, 0.7914482355117798, 1.4643797874450684, 1.7512840032577515, 1.5599733591079712, 1.4510539770126343, 1.1192448139190674, 1.4668869972229004, 0.8581640720367432, 1.407080888748169, 0.8198956251144409, 1.2259109020233154, 2.667471408843994, 0.2892611026763916, 1.3652615547180176, 0.5722734928131104, 0.30834412574768066, 0.4093400239944458, 0.5399425029754639, 1.7300560474395752, 3.2496678829193115, 0.5051016807556152, 0.8484823703765869, 0.675391674041748, 2.7389464378356934, 0.9933962821960449, 0.3649930953979492, 0.1602952480316162, 2.098315477371216, 0.5867791175842285, 0.4151571989059448, 0.17045676708221436, 0.31803905963897705, 1.6331148147583008, 2.2212514877319336, 0.866854190826416, 0.5779043436050415, 1.0441911220550537, 0.3240804672241211, 1.8578829765319824, 1.625739336013794, 0.059823036193847656, 0.7112479209899902, 0.28138256072998047, 0.07076430320739746, 1.4153754711151123, 1.3061778545379639, 0.44716358184814453, 0.14064359664916992, 0.17206120491027832, 0.05547130107879639, 0.6072726249694824, 0.86128830909729, 0.6179308891296387, 1.1383113861083984, 0.8051414489746094, 0.46361851692199707, 0.7898707389831543, 0.47286486625671387, 1.3497133255004883, 0.25496768951416016, 1.8344675302505493, 0.062412142753601074, 0.9650375843048096, 0.3132222890853882, 0.8697519302368164, 0.11883163452148438, 1.71861732006073, 0.26043009757995605, 1.21006441116333, 0.2337876558303833, 0.5217487812042236, 0.6560838222503662, 0.8855850696563721, 1.6827412843704224, 0.7967735528945923, 2.101198673248291], "mean_td_error": 0.9205923676490784, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 89.0, "diff_num_grad_updates_vs_sampler_policy": 88.0}}, "num_env_steps_sampled": 80640, "num_env_steps_trained": 22962, "num_agent_steps_sampled": 241920, "num_agent_steps_trained": 22962, "last_target_update_ts": 80640, "num_target_updates": 89}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 241920, "num_agent_steps_trained": 22962, "num_env_steps_sampled": 80640, "num_env_steps_trained": 22962, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 423.18570078903304, "num_env_steps_trained_throughput_per_sec": 121.85481116469924, "timesteps_total": 80640, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 241920, "timers": {"training_iteration_time_ms": 2143.147, "sample_time_ms": 1565.787, "load_time_ms": 0.606, "load_throughput": 425918.224, "learn_time_ms": 62.668, "learn_throughput": 4116.941, "synch_weights_time_ms": 16.708}, "counters": {"num_env_steps_sampled": 80640, "num_env_steps_trained": 22962, "num_agent_steps_sampled": 241920, "num_agent_steps_trained": 22962, "last_target_update_ts": 80640, "num_target_updates": 89}, "done": false, "episodes_total": 0, "training_iteration": 90, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-17-47", "timestamp": 1700201867, "time_this_iter_s": 2.13472318649292, "time_total_s": 182.54331469535828, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8c884d0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 182.54331469535828, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 75.26666666666667, "ram_util_percent": 90.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.058507919311523, "actor_loss": -9.344057083129883, "critic_loss": 0.13152194023132324, "alpha_loss": -0.26837337017059326, "alpha_value": 0.973671555519104, "log_alpha_value": -0.02668123133480549, "target_entropy": -6.0, "policy_t": -0.007774684578180313, "mean_q": 5.502086162567139, "max_q": 6.436267375946045, "min_q": 4.715521335601807}, "td_error": [0.825023889541626, 0.31552934646606445, 0.5131130218505859, 0.7797560691833496, 1.3293101787567139, 2.1911349296569824, 0.023371458053588867, 1.2116341590881348, 1.2425322532653809, 0.23352265357971191, 0.5003149509429932, 1.3127803802490234, 0.2200014591217041, 0.6153774261474609, 0.963207483291626, 0.5453915596008301, 1.1585776805877686, 1.423215389251709, 1.8259072303771973, 1.4176809787750244, 1.3089218139648438, 2.9228451251983643, 0.9844193458557129, 0.8013272285461426, 0.938847541809082, 0.3794741630554199, 0.8382551670074463, 0.30220985412597656, 2.7046895027160645, 1.8917343616485596, 1.2551953792572021, 0.9086499214172363, 1.0548889636993408, 0.1918933391571045, 1.96284818649292, 1.7367644309997559, 1.241058588027954, 2.016854763031006, 0.923823356628418, 0.8380494117736816, 0.737738847732544, 1.220109224319458, 0.887974739074707, 0.23552751541137695, 0.8229618072509766, 0.1383957862854004, 0.9191586971282959, 0.16521072387695312, 1.54252290725708, 0.3239705562591553, 0.04799246788024902, 1.179337978363037, 1.4562840461730957, 2.0968174934387207, 0.3599834442138672, 0.24016284942626953, 1.655219554901123, 1.1562285423278809, 0.2433032989501953, 0.4544062614440918, 0.12419748306274414, 0.9552662372589111, 0.34943556785583496, 1.2284479141235352, 0.45980048179626465, 0.12776613235473633, 1.5259735584259033, 0.3439662456512451, 1.56492018699646, 2.4021902084350586, 0.19104480743408203, 1.0907669067382812, 2.275540590286255, 0.9557528495788574, 0.2400507926940918, 1.7358381748199463, 0.1685798168182373, 0.6236543655395508, 1.3800220489501953, 1.5424082279205322, 1.0009288787841797, 0.9288210868835449, 0.5618300437927246, 0.9451701641082764, 0.9570870399475098, 1.434180498123169], "mean_td_error": 0.9865939021110535, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 90.0, "diff_num_grad_updates_vs_sampler_policy": 89.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.067045211791992, "actor_loss": -7.940473556518555, "critic_loss": 0.136294424533844, "alpha_loss": -0.2689303457736969, "alpha_value": 0.973639726638794, "log_alpha_value": -0.026713931933045387, "target_entropy": -6.0, "policy_t": -0.043775442987680435, "mean_q": 3.945858955383301, "max_q": 4.448051452636719, "min_q": 3.4244401454925537}, "td_error": [1.0432683229446411, 0.33437442779541016, 0.13231492042541504, 0.8990411758422852, 0.5810754299163818, 1.054856538772583, 0.7598856687545776, 0.4661858081817627, 2.046962261199951, 1.6423985958099365, 2.2962779998779297, 0.6420289278030396, 1.7925128936767578, 0.5518639087677002, 0.8651978969573975, 0.77012038230896, 1.5657492876052856, 1.3458870649337769, 0.36512136459350586, 1.433025598526001, 0.8028805255889893, 0.021355390548706055, 0.10760927200317383, 0.7316439151763916, 1.5725282430648804, 1.1520676612854004, 0.890925407409668, 0.5234930515289307, 1.252124547958374, 1.5763318538665771, 0.21815252304077148, 1.893601417541504, 0.7897799015045166, 0.09758615493774414, 1.0400123596191406, 0.6799969673156738, 1.3271446228027344, 0.6878767013549805, 1.2869000434875488, 0.23290729522705078, 1.1496233940124512, 0.7378113269805908, 2.661766290664673, 1.66581130027771, 0.5337210893630981, 0.29914283752441406, 0.39226090908050537, 0.3590594530105591, 1.1728217601776123, 0.9637646675109863, 1.6316280364990234, 0.32140791416168213, 0.2401447296142578, 2.8400063514709473, 1.167688012123108, 0.8750629425048828, 0.3363006114959717, 0.6927980184555054, 2.2446651458740234, 0.5188666582107544, 1.166482925415039, 1.622972846031189, 0.8042012453079224, 0.1308431625366211, 1.5771520137786865, 0.8397417068481445, 0.17473220825195312, 0.8969660997390747, 0.8379032611846924, 0.3193356990814209, 0.9160847663879395, 1.1318309307098389, 0.6122956275939941, 0.3983628749847412, 0.2988409996032715, 0.27602076530456543, 0.2766566276550293, 1.0256168842315674, 0.3737223148345947, 0.33580994606018066, 0.6182820796966553, 1.055755853652954, 0.9328165054321289, 1.1509034633636475, 0.18913781642913818, 0.9551341533660889], "mean_td_error": 0.8976165652275085, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 90.0, "diff_num_grad_updates_vs_sampler_policy": 89.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.047957420349121, "actor_loss": -7.698836326599121, "critic_loss": 0.1662541776895523, "alpha_loss": -0.2681848704814911, "alpha_value": 0.9736625552177429, "log_alpha_value": -0.02669048309326172, "target_entropy": -6.0, "policy_t": -0.032266441732645035, "mean_q": 3.758031129837036, "max_q": 4.349403381347656, "min_q": 3.220977783203125}, "td_error": [1.4104044437408447, 1.1256117820739746, 1.4089903831481934, 0.8675906658172607, 1.6202903985977173, 0.3388015031814575, 1.191878080368042, 1.2356560230255127, 0.6617789268493652, 0.31151795387268066, 0.3450586795806885, 1.013866901397705, 1.3197166919708252, 1.8716411590576172, 0.6704082489013672, 1.5447863340377808, 0.3685450553894043, 1.050240397453308, 0.3854767084121704, 1.010062336921692, 1.8066840171813965, 1.1397372484207153, 0.18430042266845703, 0.7897591590881348, 1.468342661857605, 0.8114889860153198, 0.5136299133300781, 1.1965562105178833, 0.8894617557525635, 1.7678165435791016, 0.9555351734161377, 3.607363700866699, 1.152933955192566, 2.2693660259246826, 1.6692864894866943, 0.4267914295196533, 0.05529975891113281, 2.7941653728485107, 2.2931668758392334, 2.3536269664764404, 0.12502789497375488, 1.0730708837509155, 1.7052181959152222, 1.5513548851013184, 0.5288143157958984, 0.9171919822692871, 0.10184276103973389, 1.1431783437728882, 1.0121846199035645, 0.7669308185577393, 0.37730932235717773, 1.2143239974975586, 0.779646635055542, 1.4028079509735107, 0.30606651306152344, 0.35376131534576416, 1.2958686351776123, 0.8875242471694946, 0.5690553188323975, 2.2555458545684814, 0.6811935901641846, 1.0196446180343628, 1.0362974405288696, 0.04654228687286377, 1.1016757488250732, 1.7886383533477783, 0.5856037139892578, 2.295032501220703, 0.2728755474090576, 0.512108325958252, 0.3836710453033447, 1.0238354206085205, 0.9201836585998535, 0.3505680561065674, 2.2370123863220215, 0.5151093006134033, 0.23310816287994385, 0.3757021427154541, 2.4441208839416504, 0.11702466011047363, 0.6019865274429321, 0.42702507972717285, 1.6306253671646118, 0.9334869384765625, 1.4326162338256836, 1.8498737812042236], "mean_td_error": 1.0590686798095703, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 90.0, "diff_num_grad_updates_vs_sampler_policy": 89.0}}, "num_env_steps_sampled": 81536, "num_env_steps_trained": 23220, "num_agent_steps_sampled": 244608, "num_agent_steps_trained": 23220, "last_target_update_ts": 81536, "num_target_updates": 90}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 244608, "num_agent_steps_trained": 23220, "num_env_steps_sampled": 81536, "num_env_steps_trained": 23220, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 418.5842618136196, "num_env_steps_trained_throughput_per_sec": 120.52984324543958, "timesteps_total": 81536, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 244608, "timers": {"training_iteration_time_ms": 2171.564, "sample_time_ms": 1592.994, "load_time_ms": 0.62, "load_throughput": 416300.082, "learn_time_ms": 62.836, "learn_throughput": 4105.942, "synch_weights_time_ms": 16.766}, "counters": {"num_env_steps_sampled": 81536, "num_env_steps_trained": 23220, "num_agent_steps_sampled": 244608, "num_agent_steps_trained": 23220, "last_target_update_ts": 81536, "num_target_updates": 90}, "done": false, "episodes_total": 0, "training_iteration": 91, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-17-49", "timestamp": 1700201869, "time_this_iter_s": 2.15527606010437, "time_total_s": 184.69859075546265, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8c8afb4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 184.69859075546265, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 76.89999999999999, "ram_util_percent": 90.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.045869827270508, "actor_loss": -9.337964057922363, "critic_loss": 0.1327541172504425, "alpha_loss": -0.2710416913032532, "alpha_value": 0.9733803272247314, "log_alpha_value": -0.026980413123965263, "target_entropy": -6.0, "policy_t": 0.03319951891899109, "mean_q": 5.512294769287109, "max_q": 6.365011692047119, "min_q": 4.635193824768066}, "td_error": [0.5718438625335693, 0.7802746295928955, 0.19383478164672852, 0.998361349105835, 0.14306068420410156, 0.8884150981903076, 1.6066687107086182, 0.30976295471191406, 1.4693074226379395, 0.48573827743530273, 1.8944792747497559, 1.3077929019927979, 2.586540460586548, 0.8732647895812988, 0.8497772216796875, 0.8405632972717285, 1.590461015701294, 0.7243971824645996, 1.1320106983184814, 1.16996169090271, 1.7149717807769775, 0.14361906051635742, 2.5524306297302246, 0.2868661880493164, 0.8930251598358154, 1.3879570960998535, 0.30026769638061523, 0.4227609634399414, 1.0972704887390137, 0.4021422863006592, 0.08348536491394043, 0.09439969062805176, 1.2874443531036377, 0.5848345756530762, 0.9182498455047607, 1.7443633079528809, 0.9403831958770752, 0.28375697135925293, 1.2325077056884766, 1.3129246234893799, 0.1528472900390625, 0.6005980968475342, 0.8055031299591064, 0.6088263988494873, 0.2269279956817627, 1.4988377094268799, 0.33480381965637207, 2.6001651287078857, 2.5358572006225586, 1.416438341140747, 0.07540535926818848, 1.054462194442749, 0.18212509155273438, 2.1502058506011963, 0.6447856426239014, 0.7143051624298096, 0.6188290119171143, 0.06804013252258301, 0.9703145027160645, 1.592653751373291, 0.7420172691345215, 0.4175686836242676, 0.0963747501373291, 0.14791274070739746, 0.307875394821167, 1.531860589981079, 0.4856913089752197, 1.0854167938232422, 1.062345027923584, 0.94923996925354, 0.3014645576477051, 0.9000375270843506, 0.6192517280578613, 3.2587430477142334, 2.0756888389587402, 1.5582096576690674, 0.17203116416931152, 0.468944787979126, 0.9704573154449463, 1.890364408493042, 1.2534198760986328, 0.2571604251861572, 0.3166027069091797, 2.0424671173095703, 0.5798921585083008, 2.451101303100586], "mean_td_error": 0.9638864994049072, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 91.0, "diff_num_grad_updates_vs_sampler_policy": 90.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.082637786865234, "actor_loss": -7.986894607543945, "critic_loss": 0.16239149868488312, "alpha_loss": -0.27237021923065186, "alpha_value": 0.9733478426933289, "log_alpha_value": -0.027013782411813736, "target_entropy": -6.0, "policy_t": 0.025113439187407494, "mean_q": 4.017171859741211, "max_q": 4.525460720062256, "min_q": 3.520050287246704}, "td_error": [0.7120699882507324, 0.6094541549682617, 0.9337010383605957, 0.6230732202529907, 0.128523588180542, 0.40570175647735596, 1.9983465671539307, 1.0771265029907227, 1.6377626657485962, 2.3149890899658203, 1.4880834817886353, 1.5741491317749023, 0.6336319446563721, 0.1453702449798584, 0.02274298667907715, 1.1117240190505981, 0.6310000419616699, 1.7816953659057617, 1.9056169986724854, 0.43479251861572266, 1.5549638271331787, 1.193465232849121, 1.8483363389968872, 1.3237401247024536, 1.4543797969818115, 1.8136311769485474, 1.6631338596343994, 0.2787508964538574, 1.7393325567245483, 0.6794850826263428, 1.754845142364502, 0.27070116996765137, 0.25641345977783203, 0.05721855163574219, 0.11782169342041016, 2.4197113513946533, 0.5685915946960449, 0.590139627456665, 0.6773079633712769, 1.0787453651428223, 1.0970473289489746, 1.0176043510437012, 0.9954382181167603, 0.7989299297332764, 1.4123769998550415, 2.1545376777648926, 0.41166985034942627, 1.458300232887268, 1.9930615425109863, 0.2893960475921631, 0.7810227870941162, 0.48555219173431396, 1.8875913619995117, 0.9394114017486572, 0.4908989667892456, 1.023747205734253, 0.34298205375671387, 0.48793554306030273, 0.6147282123565674, 0.07927250862121582, 0.38944387435913086, 1.0876268148422241, 0.04843783378601074, 1.0498981475830078, 0.21538281440734863, 2.1128501892089844, 1.1401715278625488, 3.4309842586517334, 0.7863084077835083, 2.62349009513855, 0.49623847007751465, 0.9876003265380859, 0.47053027153015137, 0.12499773502349854, 1.2822742462158203, 1.7113604545593262, 0.3259392976760864, 0.5303044319152832, 0.1783686876296997, 0.9804482460021973, 0.8995013236999512, 0.4466559886932373, 1.0811800956726074, 0.8495054244995117, 0.03793168067932129, 1.7518696784973145], "mean_td_error": 0.9919891953468323, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 91.0, "diff_num_grad_updates_vs_sampler_policy": 90.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.043310165405273, "actor_loss": -7.746414661407471, "critic_loss": 0.100828617811203, "alpha_loss": -0.27106866240501404, "alpha_value": 0.9733710289001465, "log_alpha_value": -0.026989970356225967, "target_entropy": -6.0, "policy_t": 0.024522077292203903, "mean_q": 3.804440498352051, "max_q": 4.355573654174805, "min_q": 3.1271445751190186}, "td_error": [0.8097500801086426, 0.04198622703552246, 0.017267227172851562, 1.8958547115325928, 0.05872941017150879, 0.09533119201660156, 0.4392024278640747, 0.07246124744415283, 0.5172243118286133, 0.5240330696105957, 0.24340367317199707, 0.46716082096099854, 1.177696943283081, 0.025992274284362793, 0.7216905355453491, 1.1225712299346924, 0.9090919494628906, 1.2285423278808594, 0.9891681671142578, 0.9533333778381348, 0.023793578147888184, 0.2572062015533447, 0.10846388339996338, 0.752524733543396, 0.4591662883758545, 0.33181798458099365, 0.5286961793899536, 3.170546293258667, 0.5956544876098633, 0.7967650890350342, 1.3103232383728027, 0.7633451223373413, 0.047859787940979004, 0.7394695281982422, 0.4556117057800293, 0.05175983905792236, 0.9684016704559326, 0.4279712438583374, 0.12574923038482666, 0.7388865947723389, 0.0602724552154541, 0.09987890720367432, 0.951725959777832, 1.094228744506836, 0.8198549747467041, 0.25440704822540283, 0.7095917463302612, 0.5641858577728271, 0.22346723079681396, 0.8364828824996948, 0.045966267585754395, 0.46090006828308105, 0.11049461364746094, 1.3764747381210327, 0.07933402061462402, 0.6130654811859131, 0.8674931526184082, 0.950486421585083, 0.8572831153869629, 0.8160492181777954, 0.8608793020248413, 0.8897926807403564, 1.3611832857131958, 0.9313123226165771, 0.610893726348877, 1.0724270343780518, 0.4016300439834595, 1.1881831884384155, 1.4206622838974, 1.601682424545288, 0.20037877559661865, 0.13935625553131104, 1.8948297500610352, 1.309300422668457, 0.9545921087265015, 1.4424582719802856, 0.9357149600982666, 1.0143052339553833, 0.024008870124816895, 1.3301068544387817, 1.0304080247879028, 2.2683699131011963, 1.1682201623916626, 1.225793719291687, 0.48264598846435547, 0.8174300193786621], "mean_td_error": 0.7364268898963928, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 91.0, "diff_num_grad_updates_vs_sampler_policy": 90.0}}, "num_env_steps_sampled": 82432, "num_env_steps_trained": 23478, "num_agent_steps_sampled": 247296, "num_agent_steps_trained": 23478, "last_target_update_ts": 82432, "num_target_updates": 91}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 247296, "num_agent_steps_trained": 23478, "num_env_steps_sampled": 82432, "num_env_steps_trained": 23478, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 425.62331422720996, "num_env_steps_trained_throughput_per_sec": 122.55671324846001, "timesteps_total": 82432, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 247296, "timers": {"training_iteration_time_ms": 2139.462, "sample_time_ms": 1559.884, "load_time_ms": 0.618, "load_throughput": 417649.723, "learn_time_ms": 62.832, "learn_throughput": 4106.169, "synch_weights_time_ms": 16.539}, "counters": {"num_env_steps_sampled": 82432, "num_env_steps_trained": 23478, "num_agent_steps_sampled": 247296, "num_agent_steps_trained": 23478, "last_target_update_ts": 82432, "num_target_updates": 91}, "done": false, "episodes_total": 0, "training_iteration": 92, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-17-51", "timestamp": 1700201871, "time_this_iter_s": 2.1200411319732666, "time_total_s": 186.8186318874359, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe868078670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 186.8186318874359, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 74.96666666666667, "ram_util_percent": 90.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.012675285339355, "actor_loss": -9.365693092346191, "critic_loss": 0.13015379011631012, "alpha_loss": -0.2731419801712036, "alpha_value": 0.9730890989303589, "log_alpha_value": -0.027279620990157127, "target_entropy": -6.0, "policy_t": 0.013711984269320965, "mean_q": 5.437753200531006, "max_q": 6.215053081512451, "min_q": 4.723790168762207}, "td_error": [0.5411770343780518, 0.6340038776397705, 0.5401773452758789, 1.219949722290039, 0.723536491394043, 0.5170550346374512, 0.08458876609802246, 0.63283371925354, 0.2058086395263672, 0.9206562042236328, 1.2634594440460205, 0.7951691150665283, 2.001871347427368, 3.084425210952759, 0.347125768661499, 0.3198542594909668, 0.15645170211791992, 0.22105121612548828, 0.961381196975708, 1.1653761863708496, 0.5191164016723633, 0.5212564468383789, 0.3997769355773926, 0.5156135559082031, 0.1688709259033203, 1.856778621673584, 1.7738826274871826, 1.0206356048583984, 1.8190741539001465, 0.7492499351501465, 1.459226369857788, 1.1000185012817383, 1.0969905853271484, 0.6933832168579102, 0.11160778999328613, 1.6887049674987793, 0.4678370952606201, 0.5427272319793701, 0.43971824645996094, 1.8520948886871338, 0.6013009548187256, 2.017768621444702, 1.5931305885314941, 1.2815062999725342, 1.509119987487793, 1.575530767440796, 1.1005795001983643, 0.47264528274536133, 0.49350643157958984, 0.7378644943237305, 1.042088270187378, 0.8574631214141846, 1.3025524616241455, 0.8848114013671875, 0.08593440055847168, 0.5247681140899658, 0.31670188903808594, 1.6512293815612793, 0.616379976272583, 1.5664517879486084, 0.5167529582977295, 1.5329563617706299, 1.8008382320404053, 0.19555425643920898, 1.5031349658966064, 1.414977788925171, 0.9391684532165527, 1.7811131477355957, 1.5441081523895264, 0.25748467445373535, 1.141836166381836, 1.3007895946502686, 1.2773661613464355, 1.5069210529327393, 2.098328113555908, 1.3520612716674805, 2.101780652999878, 0.1537008285522461, 0.08233809471130371, 0.8393433094024658, 0.9934952259063721, 0.7531492710113525, 0.14125490188598633, 1.2812237739562988, 0.03147530555725098, 0.5615403652191162], "mean_td_error": 0.9589133262634277, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 92.0, "diff_num_grad_updates_vs_sampler_policy": 91.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.132617950439453, "actor_loss": -8.018555641174316, "critic_loss": 0.16946841776371002, "alpha_loss": -0.27675873041152954, "alpha_value": 0.9730560183525085, "log_alpha_value": -0.02731364034116268, "target_entropy": -6.0, "policy_t": -0.01797858439385891, "mean_q": 4.055109024047852, "max_q": 4.516486167907715, "min_q": 3.439129590988159}, "td_error": [1.0836725234985352, 0.06151139736175537, 1.4039463996887207, 2.073873996734619, 0.9948070049285889, 1.9249601364135742, 0.20307326316833496, 0.43462610244750977, 1.3068230152130127, 0.016324520111083984, 0.6048284769058228, 2.298060894012451, 0.4450340270996094, 0.6945483684539795, 0.0512847900390625, 0.7110562324523926, 1.6270554065704346, 0.05227851867675781, 0.2527768611907959, 1.0335702896118164, 0.0066182613372802734, 3.179084062576294, 1.1923282146453857, 0.43484175205230713, 1.5329281091690063, 0.47578930854797363, 0.6606308221817017, 0.08015561103820801, 0.045395493507385254, 0.9076775312423706, 0.5032353401184082, 1.5703456401824951, 2.9050095081329346, 1.196549892425537, 1.4462566375732422, 0.6078479290008545, 0.88490891456604, 2.0631961822509766, 1.1282806396484375, 0.20155620574951172, 1.5379539728164673, 0.03000473976135254, 2.972461223602295, 1.3893117904663086, 1.1822803020477295, 0.32018494606018066, 0.5164549350738525, 0.11431741714477539, 1.761523723602295, 2.111340045928955, 0.7151644229888916, 2.429586410522461, 1.3285843133926392, 0.37300026416778564, 0.18615305423736572, 1.2838068008422852, 1.8499393463134766, 0.7062394618988037, 0.7507548332214355, 0.713043212890625, 0.993309736251831, 0.5402283668518066, 1.7964870929718018, 1.8595385551452637, 2.051118850708008, 0.39285778999328613, 0.9700777530670166, 0.13828051090240479, 0.08932328224182129, 0.5402005910873413, 0.13712549209594727, 0.8762102127075195, 0.7786083221435547, 1.233887791633606, 0.9029374122619629, 0.6709518432617188, 0.41492652893066406, 0.31478095054626465, 0.9641263484954834, 0.4604661464691162, 1.3140466213226318, 1.126023292541504, 2.173734188079834, 0.8797240257263184, 2.4139244556427, 1.234982967376709], "mean_td_error": 0.998101532459259, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 92.0, "diff_num_grad_updates_vs_sampler_policy": 91.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.104158401489258, "actor_loss": -7.803990364074707, "critic_loss": 0.12159173935651779, "alpha_loss": -0.27573657035827637, "alpha_value": 0.9730795621871948, "log_alpha_value": -0.027289416640996933, "target_entropy": -6.0, "policy_t": 0.0018428758485242724, "mean_q": 3.8132169246673584, "max_q": 4.466627597808838, "min_q": 3.1911237239837646}, "td_error": [1.0700982809066772, 1.4693163633346558, 0.9822536706924438, 0.23724651336669922, 0.12428319454193115, 0.33767080307006836, 0.08880162239074707, 1.041611909866333, 2.7049942016601562, 0.5641627311706543, 0.2588639259338379, 1.028191089630127, 0.4999004602432251, 0.3146291971206665, 0.08594202995300293, 2.329146385192871, 0.5643205642700195, 0.11447000503540039, 0.40370190143585205, 1.8337712287902832, 0.6345198154449463, 0.6517190933227539, 0.7845869064331055, 1.7836793661117554, 0.6159833669662476, 0.5131762027740479, 0.830072283744812, 1.362919807434082, 1.197434902191162, 1.8146398067474365, 0.29336416721343994, 0.7580714225769043, 0.3585028648376465, 0.6995480060577393, 0.8776516914367676, 0.8198643922805786, 1.231690764427185, 2.022400379180908, 1.3305530548095703, 1.8394540548324585, 0.3026341199874878, 0.6678297519683838, 0.0862574577331543, 1.1795505285263062, 1.0352773666381836, 0.9783332347869873, 0.2235957384109497, 1.0716383457183838, 1.004073143005371, 0.6429295539855957, 1.5323336124420166, 0.2711961269378662, 1.014318823814392, 0.518903374671936, 0.03247630596160889, 0.37063491344451904, 1.4552733898162842, 1.1343066692352295, 0.2853797674179077, 0.13654184341430664, 0.6433265209197998, 0.6370840072631836, 1.2040594816207886, 1.3398287296295166, 1.0853238105773926, 0.4787869453430176, 0.5609915256500244, 0.8074150085449219, 0.7876583337783813, 0.436740517616272, 1.4266884326934814, 0.12036418914794922, 0.34144020080566406, 0.5616549253463745, 1.3656548261642456, 0.07956290245056152, 1.0628443956375122, 0.6179550886154175, 0.14204657077789307, 1.4976476430892944, 1.1411243677139282, 0.5045193433761597, 1.568984866142273, 1.3178277015686035, 1.8725918531417847, 1.3557988405227661], "mean_td_error": 0.8531931638717651, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 92.0, "diff_num_grad_updates_vs_sampler_policy": 91.0}}, "num_env_steps_sampled": 83328, "num_env_steps_trained": 23736, "num_agent_steps_sampled": 249984, "num_agent_steps_trained": 23736, "last_target_update_ts": 83328, "num_target_updates": 92}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 249984, "num_agent_steps_trained": 23736, "num_env_steps_sampled": 83328, "num_env_steps_trained": 23736, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 471.98409009817095, "num_env_steps_trained_throughput_per_sec": 135.90613308630367, "timesteps_total": 83328, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 249984, "timers": {"training_iteration_time_ms": 2104.962, "sample_time_ms": 1527.717, "load_time_ms": 0.616, "load_throughput": 418943.257, "learn_time_ms": 62.488, "learn_throughput": 4128.8, "synch_weights_time_ms": 15.927}, "counters": {"num_env_steps_sampled": 83328, "num_env_steps_trained": 23736, "num_agent_steps_sampled": 249984, "num_agent_steps_trained": 23736, "last_target_update_ts": 83328, "num_target_updates": 92}, "done": false, "episodes_total": 0, "training_iteration": 93, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-17-53", "timestamp": 1700201873, "time_this_iter_s": 1.9153518676757812, "time_total_s": 188.7339837551117, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8c884d0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 188.7339837551117, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 64.96666666666667, "ram_util_percent": 90.83333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.057276725769043, "actor_loss": -9.335805892944336, "critic_loss": 0.14200091361999512, "alpha_loss": -0.2773672640323639, "alpha_value": 0.9727980494499207, "log_alpha_value": -0.027578765526413918, "target_entropy": -6.0, "policy_t": 0.024523982778191566, "mean_q": 5.481323719024658, "max_q": 6.2343339920043945, "min_q": 4.544910430908203}, "td_error": [0.38814592361450195, 1.357689619064331, 1.2512290477752686, 3.0713746547698975, 1.6707789897918701, 0.6755452156066895, 2.0985889434814453, 2.6175408363342285, 1.2054362297058105, 1.1645677089691162, 2.1408724784851074, 1.1700119972229004, 0.36037158966064453, 1.7873528003692627, 1.7832679748535156, 1.483260154724121, 1.293649673461914, 1.8992648124694824, 1.5727028846740723, 1.4630990028381348, 0.8811469078063965, 0.34523916244506836, 0.5586934089660645, 0.8216524124145508, 0.7780842781066895, 1.590083122253418, 1.9886012077331543, 0.15667200088500977, 0.9130055904388428, 0.570040225982666, 0.717137336730957, 1.6620326042175293, 0.4772193431854248, 0.15055298805236816, 3.054328441619873, 0.8230395317077637, 1.5724244117736816, 0.17593908309936523, 1.2478151321411133, 0.17144250869750977, 1.6076326370239258, 0.7663064002990723, 0.2898437976837158, 0.9507858753204346, 0.4471580982208252, 1.1848604679107666, 0.9476823806762695, 0.5430464744567871, 0.7427804470062256, 0.2384657859802246, 0.048047780990600586, 0.9871459007263184, 0.04385638236999512, 0.757554292678833, 1.7755677700042725, 0.2401139736175537, 1.163440227508545, 0.6258554458618164, 0.30280303955078125, 0.23995518684387207, 1.5689361095428467, 1.0318164825439453, 0.38796114921569824, 0.2238631248474121, 0.8127665519714355, 0.6858549118041992, 1.1993660926818848, 1.9288816452026367, 0.10980963706970215, 1.0284433364868164, 0.791259765625, 1.181225061416626, 0.40590524673461914, 0.7886264324188232, 0.5862205028533936, 1.4574229717254639, 1.9214305877685547, 0.1483912467956543, 0.05507373809814453, 2.3270888328552246, 0.2788963317871094, 2.1067354679107666, 0.6227216720581055, 0.7065737247467041, 1.5059103965759277, 0.2716856002807617], "mean_td_error": 1.0133217573165894, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 93.0, "diff_num_grad_updates_vs_sampler_policy": 92.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.036864280700684, "actor_loss": -7.9748334884643555, "critic_loss": 0.11400380730628967, "alpha_loss": -0.2771543264389038, "alpha_value": 0.9727641344070435, "log_alpha_value": -0.02761363610625267, "target_entropy": -6.0, "policy_t": 0.0002741610223893076, "mean_q": 4.097542762756348, "max_q": 4.687324523925781, "min_q": 3.495654582977295}, "td_error": [0.24770879745483398, 0.7005243301391602, 0.46750569343566895, 0.8775010108947754, 0.7823606729507446, 0.5660214424133301, 0.7025628089904785, 1.441943645477295, 0.14292168617248535, 0.36936473846435547, 0.5851125717163086, 0.388873815536499, 1.6330081224441528, 0.28737974166870117, 0.5772078037261963, 1.274115800857544, 0.2292259931564331, 0.3289330005645752, 1.634920358657837, 1.0000884532928467, 1.0067412853240967, 2.8445658683776855, 0.3865525722503662, 1.2910552024841309, 0.27309274673461914, 1.1119225025177002, 0.4782986640930176, 0.035919189453125, 2.3189632892608643, 1.21897554397583, 0.4322047233581543, 1.0270622968673706, 0.8333518505096436, 0.056842803955078125, 0.4912797212600708, 1.4880138635635376, 0.49469900131225586, 1.1254315376281738, 0.1142723560333252, 0.8543362617492676, 3.1880788803100586, 1.0841509103775024, 1.4157884120941162, 1.250850796699524, 0.044071078300476074, 0.44616591930389404, 0.03978681564331055, 0.6325807571411133, 1.2278916835784912, 0.9233229160308838, 2.165160894393921, 0.21196341514587402, 0.1194467544555664, 0.16719555854797363, 0.34929895401000977, 0.4395095109939575, 0.28981518745422363, 0.21263456344604492, 1.6807419061660767, 0.18628299236297607, 0.6765031814575195, 1.344214677810669, 0.7424089908599854, 0.6350924968719482, 0.0807952880859375, 0.5740885734558105, 0.887847900390625, 0.678175687789917, 0.1039116382598877, 0.7817237377166748, 0.13014090061187744, 0.05165410041809082, 0.732642412185669, 0.12918519973754883, 0.45430612564086914, 1.9640405178070068, 0.6906938552856445, 0.5448387861251831, 0.1472303867340088, 0.848408579826355, 0.3965117931365967, 0.34548866748809814, 1.997680425643921, 0.2754685878753662, 2.4343161582946777, 0.7980369329452515], "mean_td_error": 0.774895429611206, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 93.0, "diff_num_grad_updates_vs_sampler_policy": 92.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.057281494140625, "actor_loss": -7.818039417266846, "critic_loss": 0.12342847883701324, "alpha_loss": -0.277470201253891, "alpha_value": 0.9727880954742432, "log_alpha_value": -0.027588985860347748, "target_entropy": -6.0, "policy_t": -0.01496049016714096, "mean_q": 3.927830934524536, "max_q": 4.521979331970215, "min_q": 3.458453893661499}, "td_error": [1.2291691303253174, 0.8525550365447998, 1.1001056432724, 0.2859771251678467, 2.338400363922119, 0.7910381555557251, 0.3883277177810669, 2.0424413681030273, 1.185806393623352, 1.6895012855529785, 1.9263181686401367, 0.4527268409729004, 1.632035732269287, 0.43550825119018555, 1.1893341541290283, 1.8856769800186157, 0.44649720191955566, 0.21668291091918945, 0.24322271347045898, 1.516977310180664, 2.0560126304626465, 1.1779444217681885, 0.9880702495574951, 0.39662861824035645, 0.8873229026794434, 0.22581744194030762, 0.25987839698791504, 1.5098602771759033, 2.721864700317383, 1.717403531074524, 0.3419830799102783, 0.6686983108520508, 0.5286865234375, 1.0093573331832886, 0.5863118171691895, 0.10425758361816406, 0.8010554313659668, 0.23429334163665771, 0.35860157012939453, 0.7040152549743652, 1.8809329271316528, 0.434802770614624, 0.9916496276855469, 0.649202823638916, 0.9901552200317383, 0.037648677825927734, 0.06330251693725586, 1.1113393306732178, 1.1555871963500977, 0.4545844793319702, 0.13994193077087402, 1.3187134265899658, 0.04483449459075928, 1.4325121641159058, 0.7119936943054199, 0.6216375827789307, 0.2814844846725464, 0.6828950643539429, 0.8944075107574463, 0.5312659740447998, 1.7410564422607422, 0.12574982643127441, 1.1985211372375488, 0.10108864307403564, 0.24404001235961914, 0.5366616249084473, 0.6456512212753296, 0.6741198301315308, 0.7141690254211426, 0.7649968862533569, 0.12979662418365479, 1.1424994468688965, 0.07609820365905762, 0.932750940322876, 0.12536799907684326, 0.8622729778289795, 0.6434226036071777, 0.05158805847167969, 2.1042463779449463, 0.7303723096847534, 1.2689965963363647, 1.4677588939666748, 0.9311808347702026, 0.9720826148986816, 0.0613018274307251, 1.5401498079299927], "mean_td_error": 0.8528046607971191, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 93.0, "diff_num_grad_updates_vs_sampler_policy": 92.0}}, "num_env_steps_sampled": 84224, "num_env_steps_trained": 23994, "num_agent_steps_sampled": 252672, "num_agent_steps_trained": 23994, "last_target_update_ts": 84224, "num_target_updates": 93}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 252672, "num_agent_steps_trained": 23994, "num_env_steps_sampled": 84224, "num_env_steps_trained": 23994, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 480.35127169673666, "num_env_steps_trained_throughput_per_sec": 138.31543314481925, "timesteps_total": 84224, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 252672, "timers": {"training_iteration_time_ms": 2077.494, "sample_time_ms": 1500.422, "load_time_ms": 0.616, "load_throughput": 418797.334, "learn_time_ms": 62.333, "learn_throughput": 4139.073, "synch_weights_time_ms": 15.651}, "counters": {"num_env_steps_sampled": 84224, "num_env_steps_trained": 23994, "num_agent_steps_sampled": 252672, "num_agent_steps_trained": 23994, "last_target_update_ts": 84224, "num_target_updates": 93}, "done": false, "episodes_total": 0, "training_iteration": 94, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-17-55", "timestamp": 1700201875, "time_this_iter_s": 1.8810198307037354, "time_total_s": 190.61500358581543, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8c8afb4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 190.61500358581543, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 85.85, "ram_util_percent": 90.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.13228702545166, "actor_loss": -9.413378715515137, "critic_loss": 0.12181295454502106, "alpha_loss": -0.2824676036834717, "alpha_value": 0.9725070595741272, "log_alpha_value": -0.027877971529960632, "target_entropy": -6.0, "policy_t": -0.051910147070884705, "mean_q": 5.538136959075928, "max_q": 6.30623722076416, "min_q": 4.819218635559082}, "td_error": [0.5062081813812256, 0.5612499713897705, 2.0035946369171143, 0.21169686317443848, 1.871776819229126, 0.6520705223083496, 0.7334411144256592, 1.9930698871612549, 1.3518521785736084, 0.3428645133972168, 1.2269940376281738, 0.10675859451293945, 0.6579718589782715, 1.6212899684906006, 0.8559589385986328, 1.0526773929595947, 1.8677210807800293, 0.4589426517486572, 2.4201900959014893, 1.6425268650054932, 0.15217137336730957, 0.31221556663513184, 0.7632176876068115, 0.14996957778930664, 0.8686249256134033, 0.8250997066497803, 0.6671826839447021, 0.19077396392822266, 0.18518972396850586, 0.4107935428619385, 1.4398772716522217, 0.9006216526031494, 0.8673617839813232, 1.337648630142212, 1.3330185413360596, 0.27826833724975586, 1.6552822589874268, 1.2079308032989502, 1.1586177349090576, 0.10995221138000488, 1.7680339813232422, 0.9319307804107666, 1.0867362022399902, 0.7334299087524414, 1.1885173320770264, 0.43942928314208984, 0.8577461242675781, 0.4510674476623535, 3.0745623111724854, 1.655212640762329, 0.3134028911590576, 0.6359896659851074, 0.24254679679870605, 1.5350706577301025, 0.4335777759552002, 0.36569762229919434, 1.3400862216949463, 0.5871732234954834, 0.9920370578765869, 0.9040834903717041, 0.43503403663635254, 0.360823392868042, 0.687495231628418, 0.1742231845855713, 1.7429027557373047, 0.4392516613006592, 0.10604429244995117, 0.7988607883453369, 0.32221245765686035, 0.9061503410339355, 1.1771330833435059, 1.286113977432251, 0.9131147861480713, 0.36968493461608887, 0.6057262420654297, 1.1324453353881836, 1.939676284790039, 1.3452293872833252, 0.38204312324523926, 0.47446393966674805, 1.6696124076843262, 1.2155685424804688, 1.7014944553375244, 1.1907646656036377, 0.2452843189239502, 1.4300453662872314], "mean_td_error": 0.9248883724212646, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 94.0, "diff_num_grad_updates_vs_sampler_policy": 93.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0750732421875, "actor_loss": -7.997973918914795, "critic_loss": 0.12587986886501312, "alpha_loss": -0.281230628490448, "alpha_value": 0.9724724888801575, "log_alpha_value": -0.027913503348827362, "target_entropy": -6.0, "policy_t": 0.032505013048648834, "mean_q": 4.126123428344727, "max_q": 4.712535858154297, "min_q": 3.5163445472717285}, "td_error": [0.9341824054718018, 0.43802642822265625, 1.1202826499938965, 0.5777878761291504, 0.36394166946411133, 0.11681461334228516, 1.7721574306488037, 0.01535022258758545, 0.2965407371520996, 0.2967410087585449, 0.4751312732696533, 1.043731689453125, 0.28549981117248535, 1.139793872833252, 0.07378697395324707, 0.8934471607208252, 0.17053377628326416, 1.2360844612121582, 0.49914538860321045, 0.5205504894256592, 0.8050153255462646, 1.388545036315918, 0.16103267669677734, 0.4884483814239502, 0.6694093942642212, 3.1355905532836914, 0.08841443061828613, 0.04925799369812012, 0.02949666976928711, 0.7891771793365479, 0.9994220733642578, 1.3282716274261475, 0.8307366371154785, 0.3775062561035156, 0.644700288772583, 0.43652963638305664, 1.4653594493865967, 0.45430660247802734, 0.5298981666564941, 1.0290535688400269, 1.0263395309448242, 0.21516788005828857, 0.7385146617889404, 0.5801751613616943, 0.15709078311920166, 2.6676394939422607, 1.282346248626709, 1.50031316280365, 0.08532977104187012, 0.4733930826187134, 0.9332034587860107, 0.6967921257019043, 1.5594053268432617, 1.3175368309020996, 0.8731474876403809, 0.08314704895019531, 0.9473855495452881, 1.3102211952209473, 1.138832688331604, 0.900068998336792, 0.0048274993896484375, 0.5510311126708984, 0.29913151264190674, 0.6209409236907959, 0.04047870635986328, 0.04645860195159912, 2.652801275253296, 0.5515809059143066, 4.129417419433594, 0.4578676223754883, 1.1094826459884644, 0.7354589700698853, 1.1898729801177979, 0.23599934577941895, 0.24796724319458008, 1.335026502609253, 1.026916742324829, 0.584202766418457, 0.6977477073669434, 1.402742862701416, 0.13902020454406738, 1.4384808540344238, 0.8498673439025879, 2.7758970260620117, 1.2245876789093018, 1.2628302574157715], "mean_td_error": 0.8379812836647034, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 94.0, "diff_num_grad_updates_vs_sampler_policy": 93.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.072187423706055, "actor_loss": -7.852534294128418, "critic_loss": 0.13257338106632233, "alpha_loss": -0.28089866042137146, "alpha_value": 0.972496747970581, "log_alpha_value": -0.027888542041182518, "target_entropy": -6.0, "policy_t": -0.04097319766879082, "mean_q": 3.920797348022461, "max_q": 4.633191108703613, "min_q": 3.3020503520965576}, "td_error": [0.2651710510253906, 1.8183934688568115, 1.1183899641036987, 0.9565765857696533, 1.0858275890350342, 1.3091282844543457, 0.5329557657241821, 1.596567153930664, 0.15316295623779297, 1.3724563121795654, 0.32835841178894043, 0.2118898630142212, 2.121093273162842, 0.39452624320983887, 0.916063666343689, 0.40529489517211914, 2.0903003215789795, 0.4395592212677002, 0.020568013191223145, 1.4527496099472046, 0.7905821800231934, 1.2938637733459473, 1.0516846179962158, 0.46922123432159424, 2.4685826301574707, 1.6026062965393066, 0.3168337345123291, 0.16469693183898926, 0.045941710472106934, 1.843234896659851, 1.2299933433532715, 1.598242163658142, 0.641380786895752, 0.4395909309387207, 0.9643319845199585, 0.512272834777832, 1.4695050716400146, 1.4404151439666748, 0.6698487997055054, 0.7755539417266846, 0.7135188579559326, 2.013706684112549, 0.9890503883361816, 0.3335087299346924, 0.48893606662750244, 1.7593176364898682, 0.6796876192092896, 0.6045994758605957, 2.4260056018829346, 0.13115262985229492, 0.3732786178588867, 0.06313955783843994, 0.553476095199585, 0.7207174301147461, 0.44169509410858154, 0.6299203634262085, 0.5830889940261841, 0.12581396102905273, 0.507671594619751, 0.504231333732605, 0.17979931831359863, 0.08976268768310547, 0.24116826057434082, 1.0152370929718018, 0.1653810739517212, 0.3800302743911743, 0.3296194076538086, 0.537142276763916, 1.871448040008545, 0.15475702285766602, 1.1421254873275757, 0.40790629386901855, 1.9786031246185303, 1.5186920166015625, 0.5608726739883423, 1.5181958675384521, 0.6936053037643433, 0.2974967956542969, 0.4820595979690552, 0.10508942604064941, 1.1744548082351685, 0.30306100845336914, 1.9115512371063232, 0.5864310264587402, 2.491424560546875, 2.1697771549224854], "mean_td_error": 0.8758793473243713, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 94.0, "diff_num_grad_updates_vs_sampler_policy": 93.0}}, "num_env_steps_sampled": 85120, "num_env_steps_trained": 24252, "num_agent_steps_sampled": 255360, "num_agent_steps_trained": 24252, "last_target_update_ts": 85120, "num_target_updates": 94}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 255360, "num_agent_steps_trained": 24252, "num_env_steps_sampled": 85120, "num_env_steps_trained": 24252, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 480.9000539239184, "num_env_steps_trained_throughput_per_sec": 138.47345302719972, "timesteps_total": 85120, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 255360, "timers": {"training_iteration_time_ms": 2048.674, "sample_time_ms": 1470.103, "load_time_ms": 0.614, "load_throughput": 419869.799, "learn_time_ms": 62.306, "learn_throughput": 4140.841, "synch_weights_time_ms": 15.36}, "counters": {"num_env_steps_sampled": 85120, "num_env_steps_trained": 24252, "num_agent_steps_sampled": 255360, "num_agent_steps_trained": 24252, "last_target_update_ts": 85120, "num_target_updates": 94}, "done": false, "episodes_total": 0, "training_iteration": 95, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-17-57", "timestamp": 1700201877, "time_this_iter_s": 1.8790879249572754, "time_total_s": 192.4940915107727, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8981e1c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 192.4940915107727, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 66.39999999999999, "ram_util_percent": 90.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.970314025878906, "actor_loss": -9.398733139038086, "critic_loss": 0.13564981520175934, "alpha_loss": -0.2809378504753113, "alpha_value": 0.9722158312797546, "log_alpha_value": -0.028177432715892792, "target_entropy": -6.0, "policy_t": -0.008814680390059948, "mean_q": 5.534903526306152, "max_q": 6.490897178649902, "min_q": 4.634332180023193}, "td_error": [1.207360029220581, 0.2989838123321533, 0.5581457614898682, 0.6136400699615479, 1.1005070209503174, 1.3992977142333984, 1.0979409217834473, 0.1177833080291748, 0.5504014492034912, 0.2702646255493164, 1.2313826084136963, 1.6739680767059326, 0.31110501289367676, 2.1035964488983154, 1.4015111923217773, 0.18137335777282715, 0.6665065288543701, 1.0111145973205566, 0.5739459991455078, 1.2834782600402832, 0.2057497501373291, 2.3831892013549805, 0.2989013195037842, 1.4623346328735352, 0.12685394287109375, 0.5164675712585449, 1.7647368907928467, 1.3448026180267334, 1.7113242149353027, 1.406489610671997, 0.04020571708679199, 1.2997260093688965, 1.282440423965454, 3.529116153717041, 0.7089037895202637, 0.3861985206604004, 0.5079500675201416, 0.5991759300231934, 0.14795374870300293, 1.2882764339447021, 1.9521043300628662, 0.37679576873779297, 1.8631649017333984, 0.7043399810791016, 0.7359287738800049, 1.7858555316925049, 1.4106440544128418, 0.13570857048034668, 1.2345004081726074, 0.26189374923706055, 0.8716459274291992, 1.052394151687622, 0.12929177284240723, 0.7007632255554199, 1.874671459197998, 0.05420064926147461, 1.195805549621582, 1.5438859462738037, 0.21507573127746582, 0.266437292098999, 1.4103615283966064, 2.515458345413208, 0.25643301010131836, 1.5920250415802002, 1.7034103870391846, 1.4716126918792725, 0.5202772617340088, 0.31308865547180176, 1.4624736309051514, 0.26796913146972656, 1.1960761547088623, 0.26296091079711914, 0.5220236778259277, 1.2350337505340576, 2.1317081451416016, 1.816951036453247, 0.4264843463897705, 0.7952735424041748, 0.9822595119476318, 1.4526357650756836, 2.0852067470550537, 0.6088590621948242, 0.4173095226287842, 0.9779403209686279, 1.4191851615905762, 0.4372098445892334], "mean_td_error": 0.9919585585594177, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 95.0, "diff_num_grad_updates_vs_sampler_policy": 94.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.069015502929688, "actor_loss": -7.985517501831055, "critic_loss": 0.15544834733009338, "alpha_loss": -0.28408071398735046, "alpha_value": 0.9721809029579163, "log_alpha_value": -0.02821335569024086, "target_entropy": -6.0, "policy_t": 0.03649596869945526, "mean_q": 3.9946179389953613, "max_q": 4.693797588348389, "min_q": 3.4011316299438477}, "td_error": [0.3492105007171631, 2.059162139892578, 1.2570996284484863, 1.1710401773452759, 1.7332764863967896, 1.2778921127319336, 0.33488035202026367, 0.6061203479766846, 0.33442234992980957, 0.4884864091873169, 1.4952003955841064, 0.1473677158355713, 0.7006721496582031, 2.3680899143218994, 1.3137739896774292, 0.865192174911499, 0.7307450771331787, 0.8505499362945557, 0.8305960893630981, 1.8779404163360596, 0.8829658031463623, 1.1765451431274414, 1.7082513570785522, 3.0706515312194824, 0.7245051860809326, 1.2395075559616089, 1.6168625354766846, 0.06358551979064941, 1.1787375211715698, 0.24635648727416992, 1.3321449756622314, 0.5410572290420532, 0.7156245708465576, 1.7263728380203247, 0.13044190406799316, 1.986924409866333, 1.473012089729309, 0.4085273742675781, 0.3994302749633789, 0.5682415962219238, 0.9333750009536743, 0.4347052574157715, 0.3256412744522095, 2.0534071922302246, 0.08694720268249512, 0.1618419885635376, 1.348053216934204, 1.1550973653793335, 0.551311731338501, 1.092071771621704, 0.11420226097106934, 1.3398375511169434, 0.9882901906967163, 0.011713027954101562, 0.8759232759475708, 0.6912107467651367, 1.728947639465332, 1.772402286529541, 0.46402406692504883, 0.06767940521240234, 0.9034414291381836, 0.5971229076385498, 1.817162275314331, 1.2826647758483887, 0.611055850982666, 1.569661021232605, 0.05979585647583008, 0.3615638017654419, 1.2865996360778809, 0.1408398151397705, 0.4344182014465332, 1.8991279602050781, 0.4130716323852539, 2.7876193523406982, 0.5796165466308594, 0.8618402481079102, 0.7340438365936279, 0.6729187965393066, 0.4124448299407959, 0.9334280490875244, 1.995760202407837, 0.7187361717224121, 1.0895296335220337, 0.8881106376647949, 1.2454978227615356, 1.9915766716003418], "mean_td_error": 0.9821604490280151, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 95.0, "diff_num_grad_updates_vs_sampler_policy": 94.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.039958000183105, "actor_loss": -7.8922438621521, "critic_loss": 0.10933426767587662, "alpha_loss": -0.28300759196281433, "alpha_value": 0.9722054600715637, "log_alpha_value": -0.028188126161694527, "target_entropy": -6.0, "policy_t": -0.012640970759093761, "mean_q": 3.9396817684173584, "max_q": 4.701956272125244, "min_q": 3.3775947093963623}, "td_error": [0.5873756408691406, 0.3248884677886963, 0.07809329032897949, 2.047028064727783, 1.3049553632736206, 1.493989109992981, 0.08371686935424805, 1.1865257024765015, 1.4624375104904175, 0.1401146650314331, 1.2339723110198975, 0.36807870864868164, 0.8354737758636475, 1.0519635677337646, 1.7945054769515991, 1.4555048942565918, 0.2698681354522705, 0.46423566341400146, 0.2344672679901123, 0.4407975673675537, 0.8701345920562744, 0.7183902263641357, 1.6226695775985718, 0.3923771381378174, 1.6727689504623413, 0.6563382148742676, 0.2470860481262207, 0.39521992206573486, 0.7736940383911133, 0.0805673599243164, 0.4403390884399414, 0.6257256269454956, 0.7643413543701172, 1.3023056983947754, 0.2489793300628662, 0.4715501070022583, 0.6531388759613037, 1.589262843132019, 0.3376624584197998, 0.5809671878814697, 0.8295812606811523, 0.31154584884643555, 0.08173525333404541, 0.09414982795715332, 0.5565330982208252, 0.8349156379699707, 0.2936815023422241, 1.1645039319992065, 0.8708021640777588, 0.980879545211792, 1.1269975900650024, 0.7799134254455566, 1.1595052480697632, 1.1820509433746338, 2.0593032836914062, 0.5664081573486328, 0.5090208053588867, 0.8297051191329956, 0.4743725061416626, 0.32478415966033936, 1.5198800563812256, 0.18900012969970703, 1.0560169219970703, 1.1923401355743408, 0.9915741682052612, 0.8424773216247559, 1.8351597785949707, 0.6339445114135742, 0.11401963233947754, 0.7537517547607422, 1.6193920373916626, 0.4548373222351074, 0.4871166944503784, 0.33375084400177, 1.3642115592956543, 0.42750871181488037, 0.20448529720306396, 0.27692413330078125, 0.9197609424591064, 0.4380265474319458, 0.6043617725372314, 1.2263314723968506, 1.1741669178009033, 1.5005066394805908, 0.2931004762649536, 1.5853867530822754], "mean_td_error": 0.7949992418289185, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 95.0, "diff_num_grad_updates_vs_sampler_policy": 94.0}}, "num_env_steps_sampled": 86016, "num_env_steps_trained": 24510, "num_agent_steps_sampled": 258048, "num_agent_steps_trained": 24510, "last_target_update_ts": 86016, "num_target_updates": 95}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 258048, "num_agent_steps_trained": 24510, "num_env_steps_sampled": 86016, "num_env_steps_trained": 24510, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 482.1686697707884, "num_env_steps_trained_throughput_per_sec": 138.83874642953506, "timesteps_total": 86016, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 258048, "timers": {"training_iteration_time_ms": 2030.766, "sample_time_ms": 1451.382, "load_time_ms": 0.612, "load_throughput": 421226.326, "learn_time_ms": 62.432, "learn_throughput": 4132.524, "synch_weights_time_ms": 15.721}, "counters": {"num_env_steps_sampled": 86016, "num_env_steps_trained": 24510, "num_agent_steps_sampled": 258048, "num_agent_steps_trained": 24510, "last_target_update_ts": 86016, "num_target_updates": 95}, "done": false, "episodes_total": 0, "training_iteration": 96, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-17-59", "timestamp": 1700201879, "time_this_iter_s": 1.8715362548828125, "time_total_s": 194.36562776565552, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8c884d0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 194.36562776565552, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 64.36666666666667, "ram_util_percent": 90.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.019166946411133, "actor_loss": -9.42636775970459, "critic_loss": 0.12427747994661331, "alpha_loss": -0.2853127121925354, "alpha_value": 0.9719249606132507, "log_alpha_value": -0.028476692736148834, "target_entropy": -6.0, "policy_t": -0.012870035134255886, "mean_q": 5.615547180175781, "max_q": 6.284316062927246, "min_q": 4.8682661056518555}, "td_error": [0.41876649856567383, 1.3823585510253906, 1.2610745429992676, 0.30622315406799316, 0.7799928188323975, 0.463853120803833, 1.9332096576690674, 0.8745415210723877, 0.5064904689788818, 1.7037231922149658, 1.4627699851989746, 2.011772632598877, 0.9437284469604492, 0.3672044277191162, 1.746018648147583, 2.878955364227295, 0.677685022354126, 1.213775396347046, 0.6669249534606934, 0.14458727836608887, 0.2581617832183838, 0.1714487075805664, 0.2997255325317383, 0.8099818229675293, 1.562413215637207, 0.35416460037231445, 0.5625357627868652, 0.18652105331420898, 2.0051345825195312, 0.16355276107788086, 0.10182833671569824, 0.47870588302612305, 0.8584234714508057, 0.9936351776123047, 0.32306909561157227, 0.7117486000061035, 2.0613651275634766, 0.5145151615142822, 0.6206438541412354, 1.1371543407440186, 0.03424191474914551, 0.684058666229248, 2.5133275985717773, 0.13862371444702148, 0.3824009895324707, 1.2300310134887695, 0.2964653968811035, 0.43732523918151855, 1.1724629402160645, 1.8632819652557373, 0.5259182453155518, 1.4445319175720215, 0.6368851661682129, 1.2954075336456299, 0.480973482131958, 0.9972000122070312, 0.7490372657775879, 1.6385493278503418, 1.396444320678711, 0.39453697204589844, 0.07877278327941895, 0.3476228713989258, 1.8217644691467285, 0.5358898639678955, 1.2855284214019775, 0.6126556396484375, 0.1589794158935547, 0.4594128131866455, 0.222182035446167, 2.952777862548828, 0.6296083927154541, 1.346808910369873, 0.47041845321655273, 1.256803274154663, 0.43457770347595215, 0.534367561340332, 1.1599230766296387, 1.5322651863098145, 0.7649998664855957, 2.1886043548583984, 0.20949983596801758, 0.18547558784484863, 0.8087825775146484, 2.1570310592651367, 0.7574865818023682, 1.0876765251159668], "mean_td_error": 0.9096512198448181, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 96.0, "diff_num_grad_updates_vs_sampler_policy": 95.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.121757507324219, "actor_loss": -7.976828575134277, "critic_loss": 0.12802064418792725, "alpha_loss": -0.2886034846305847, "alpha_value": 0.9718894958496094, "log_alpha_value": -0.02851318009197712, "target_entropy": -6.0, "policy_t": 0.016904128715395927, "mean_q": 4.065980911254883, "max_q": 4.609105587005615, "min_q": 3.387735366821289}, "td_error": [0.30526018142700195, 0.6015094518661499, 0.7426174879074097, 1.02765953540802, 1.2796807289123535, 1.5742309093475342, 0.6372287273406982, 1.1968183517456055, 1.849313735961914, 0.5081820487976074, 0.5260765552520752, 1.931140661239624, 1.6346776485443115, 0.6149308681488037, 0.45189595222473145, 1.301949143409729, 0.11579656600952148, 0.27224278450012207, 1.147559642791748, 0.05341982841491699, 0.401067852973938, 0.23935484886169434, 0.5883834362030029, 0.277921199798584, 0.36957693099975586, 0.619042158126831, 0.3982229232788086, 0.2840428352355957, 0.840794563293457, 1.8966212272644043, 0.2084054946899414, 0.79721999168396, 0.7835564613342285, 0.9456183910369873, 0.4465850591659546, 1.556241512298584, 0.8470455408096313, 1.956831455230713, 0.9263182878494263, 2.1995160579681396, 0.7299356460571289, 1.3204622268676758, 2.276695489883423, 0.6927704811096191, 0.6968941688537598, 0.9936630725860596, 0.9244511127471924, 1.5178662538528442, 1.1517773866653442, 0.35005295276641846, 0.5752499103546143, 0.14988970756530762, 0.5246381759643555, 2.6734466552734375, 0.09144341945648193, 1.6307265758514404, 0.3327927589416504, 0.4156157970428467, 1.0631929636001587, 1.0714221000671387, 0.966210126876831, 0.8895957469940186, 0.0307159423828125, 0.31656742095947266, 1.543365716934204, 0.8609766960144043, 0.9419360160827637, 0.4480316638946533, 1.1162738800048828, 1.889308214187622, 0.047363877296447754, 0.5975909233093262, 0.8967384099960327, 2.6648125648498535, 0.34920287132263184, 0.3933529853820801, 1.395662546157837, 0.3955683708190918, 0.33269786834716797, 0.8957843780517578, 1.1778916120529175, 0.8390400409698486, 0.8130626678466797, 0.23709642887115479, 0.40334296226501465, 1.0738706588745117], "mean_td_error": 0.8727163076400757, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 96.0, "diff_num_grad_updates_vs_sampler_policy": 95.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.055259704589844, "actor_loss": -7.9103522300720215, "critic_loss": 0.12166717648506165, "alpha_loss": -0.28645071387290955, "alpha_value": 0.9719142913818359, "log_alpha_value": -0.02848765067756176, "target_entropy": -6.0, "policy_t": 0.02677854709327221, "mean_q": 3.9389777183532715, "max_q": 4.588510036468506, "min_q": 3.3861873149871826}, "td_error": [1.0214276313781738, 0.5528258085250854, 0.8931668996810913, 1.1526968479156494, 2.74541974067688, 0.675429105758667, 0.1945093870162964, 0.9074169397354126, 1.2239837646484375, 1.6040396690368652, 1.1117923259735107, 0.10848283767700195, 0.5358911752700806, 1.8540364503860474, 0.17024445533752441, 1.1834864616394043, 1.155403733253479, 1.1872789859771729, 0.4555995464324951, 0.03213691711425781, 0.9913045167922974, 0.6564064025878906, 0.726423978805542, 0.924724817276001, 0.9597206115722656, 0.15211641788482666, 0.9887688159942627, 0.09282779693603516, 0.2879951000213623, 0.07744121551513672, 0.13043951988220215, 0.28815579414367676, 2.17065691947937, 0.12261736392974854, 0.06975412368774414, 0.9425028562545776, 1.3312737941741943, 0.47511160373687744, 0.38241076469421387, 0.2214353084564209, 0.3437156677246094, 1.6383116245269775, 0.19612336158752441, 0.9296705722808838, 0.8716573715209961, 1.753650188446045, 2.73663067817688, 0.22138166427612305, 1.006371259689331, 1.2160851955413818, 0.780357837677002, 1.3320341110229492, 0.5707720518112183, 1.4432616233825684, 0.14711380004882812, 0.14515352249145508, 1.7592577934265137, 0.1475968360900879, 0.7554352283477783, 0.6938879489898682, 0.41789674758911133, 0.8458096981048584, 1.557247519493103, 0.2841653823852539, 0.5278924703598022, 1.7935278415679932, 1.009812593460083, 0.47632932662963867, 0.7832698822021484, 0.8392519950866699, 0.7466386556625366, 0.2861182689666748, 0.31953203678131104, 0.39069104194641113, 1.4755878448486328, 0.05807507038116455, 1.036755919456482, 1.829009771347046, 0.49135148525238037, 0.4585312604904175, 1.0421028137207031, 0.8803658485412598, 2.0204885005950928, 0.5573992729187012, 2.694460391998291, 1.1316332817077637], "mean_td_error": 0.8534857034683228, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 96.0, "diff_num_grad_updates_vs_sampler_policy": 95.0}}, "num_env_steps_sampled": 86912, "num_env_steps_trained": 24768, "num_agent_steps_sampled": 260736, "num_agent_steps_trained": 24768, "last_target_update_ts": 86912, "num_target_updates": 96}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 260736, "num_agent_steps_trained": 24768, "num_env_steps_sampled": 86912, "num_env_steps_trained": 24768, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 494.3227194786568, "num_env_steps_trained_throughput_per_sec": 142.33846163559537, "timesteps_total": 86912, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 260736, "timers": {"training_iteration_time_ms": 2006.136, "sample_time_ms": 1427.646, "load_time_ms": 0.614, "load_throughput": 420473.435, "learn_time_ms": 62.376, "learn_throughput": 4136.187, "synch_weights_time_ms": 15.733}, "counters": {"num_env_steps_sampled": 86912, "num_env_steps_trained": 24768, "num_agent_steps_sampled": 260736, "num_agent_steps_trained": 24768, "last_target_update_ts": 86912, "num_target_updates": 96}, "done": false, "episodes_total": 0, "training_iteration": 97, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-18-00", "timestamp": 1700201880, "time_this_iter_s": 1.8268790245056152, "time_total_s": 196.19250679016113, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8aa4e7ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 196.19250679016113, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 80.6, "ram_util_percent": 90.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.10412883758545, "actor_loss": -9.498723030090332, "critic_loss": 0.14473798871040344, "alpha_loss": -0.29075542092323303, "alpha_value": 0.9716341495513916, "log_alpha_value": -0.028775904327630997, "target_entropy": -6.0, "policy_t": 0.02551468461751938, "mean_q": 5.6136298179626465, "max_q": 6.594897270202637, "min_q": 4.714162826538086}, "td_error": [0.9574728012084961, 0.7029900550842285, 0.9190690517425537, 1.470649242401123, 0.03765225410461426, 0.5063562393188477, 0.34848928451538086, 0.8745942115783691, 0.8565137386322021, 2.3671956062316895, 0.15920376777648926, 0.17810988426208496, 0.1424705982208252, 2.3750054836273193, 2.2268521785736084, 0.8806231021881104, 3.823003053665161, 3.029454231262207, 1.0044748783111572, 0.4822232723236084, 0.15340209007263184, 2.816108226776123, 0.07272863388061523, 0.5052416324615479, 2.5980849266052246, 0.5721967220306396, 0.8909132480621338, 0.5577905178070068, 0.5414667129516602, 0.29862332344055176, 0.6453986167907715, 0.41376280784606934, 1.8779606819152832, 0.30313634872436523, 0.8073620796203613, 0.6137597560882568, 0.27820563316345215, 1.3402369022369385, 0.48087644577026367, 1.969163179397583, 0.6376972198486328, 0.07827162742614746, 1.7617809772491455, 3.635359287261963, 0.1305074691772461, 0.23720049858093262, 0.7371804714202881, 1.217806339263916, 1.0463206768035889, 0.8283679485321045, 0.8368730545043945, 1.5767998695373535, 1.3659412860870361, 0.20135188102722168, 0.9551205635070801, 0.09881281852722168, 2.2297627925872803, 1.068241834640503, 0.061715126037597656, 0.5498733520507812, 0.13272953033447266, 1.4249067306518555, 0.294696569442749, 0.6217300891876221, 1.9934709072113037, 0.76967453956604, 0.8897576332092285, 0.19634747505187988, 0.9155745506286621, 1.7464280128479004, 1.609142780303955, 0.7975993156433105, 0.5309538841247559, 0.532325267791748, 0.48868513107299805, 0.19456005096435547, 2.8589718341827393, 0.5787475109100342, 0.025439739227294922, 1.9068021774291992, 3.0181329250335693, 0.09728217124938965, 2.137129306793213, 1.5337884426116943, 0.7860972881317139, 0.6805987358093262], "mean_td_error": 1.0127369165420532, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 97.0, "diff_num_grad_updates_vs_sampler_policy": 96.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.047499656677246, "actor_loss": -7.957209587097168, "critic_loss": 0.12889283895492554, "alpha_loss": -0.28949981927871704, "alpha_value": 0.9715980291366577, "log_alpha_value": -0.02881311997771263, "target_entropy": -6.0, "policy_t": 0.02352192997932434, "mean_q": 4.040951251983643, "max_q": 4.6745924949646, "min_q": 3.528728723526001}, "td_error": [0.4680449962615967, 0.7158751487731934, 2.2229065895080566, 0.8706381320953369, 0.6435850858688354, 0.19551241397857666, 0.019787907600402832, 2.7702548503875732, 0.0019617080688476562, 2.943002939224243, 0.6545649766921997, 0.29011332988739014, 0.20550024509429932, 1.5872913599014282, 0.22730565071105957, 0.241377592086792, 1.522301197052002, 0.5355695486068726, 0.15176630020141602, 1.39082932472229, 0.478610634803772, 0.4031977653503418, 0.08727264404296875, 0.09785819053649902, 0.6281509399414062, 0.4290003776550293, 2.009385108947754, 0.9788185358047485, 0.527864933013916, 0.26808083057403564, 0.24108946323394775, 0.4096689224243164, 0.3337435722351074, 1.172356128692627, 0.7325607538223267, 1.3064703941345215, 1.99432373046875, 0.5226620435714722, 0.2332935333251953, 0.5156294107437134, 0.03716421127319336, 0.5675832033157349, 0.3979637622833252, 0.853043794631958, 0.5836784839630127, 1.3563802242279053, 0.24621880054473877, 3.019413709640503, 1.150614619255066, 0.305560827255249, 0.04011034965515137, 1.839989185333252, 0.2263190746307373, 0.6647169589996338, 1.1817054748535156, 1.0751944780349731, 2.2618579864501953, 1.3988401889801025, 0.15578138828277588, 2.19627046585083, 1.6148390769958496, 0.2446134090423584, 1.2620058059692383, 0.2427959442138672, 0.1346747875213623, 0.9760003089904785, 0.08998227119445801, 0.6598765850067139, 0.7493140697479248, 2.151618480682373, 1.4288835525512695, 1.2399320602416992, 0.5417798757553101, 0.36464428901672363, 0.7502903938293457, 0.22342538833618164, 1.2270185947418213, 1.908400297164917, 0.8645596504211426, 0.7747530937194824, 0.5914397239685059, 0.4636423587799072, 0.04344034194946289, 0.6897697448730469, 0.22877979278564453, 1.1067719459533691], "mean_td_error": 0.8274405598640442, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 97.0, "diff_num_grad_updates_vs_sampler_policy": 96.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.087275505065918, "actor_loss": -7.958528518676758, "critic_loss": 0.1187271773815155, "alpha_loss": -0.2903840243816376, "alpha_value": 0.9716232419013977, "log_alpha_value": -0.02878716215491295, "target_entropy": -6.0, "policy_t": -0.036157846450805664, "mean_q": 3.9811813831329346, "max_q": 4.5967912673950195, "min_q": 3.324491500854492}, "td_error": [0.11658215522766113, 1.0183908939361572, 2.0009632110595703, 0.9824154376983643, 0.1138608455657959, 1.2352749109268188, 0.7943756580352783, 0.1864333152770996, 0.36454153060913086, 2.361560106277466, 0.9900110960006714, 0.07601511478424072, 1.0725696086883545, 0.13044822216033936, 0.2023545503616333, 1.265730381011963, 0.151658296585083, 0.23997557163238525, 1.932125210762024, 0.4638850688934326, 0.5688223838806152, 0.33061695098876953, 0.15348303318023682, 0.5991225242614746, 0.635053277015686, 0.05051088333129883, 0.8738679885864258, 0.4867013692855835, 0.6212053298950195, 0.25313901901245117, 0.8058451414108276, 1.9804869890213013, 0.26886773109436035, 0.3657844066619873, 0.2989959716796875, 1.2549279928207397, 0.479569673538208, 1.1723626852035522, 1.5112779140472412, 3.1843395233154297, 2.52516508102417, 0.6753376722335815, 0.08315002918243408, 0.12841391563415527, 1.0648889541625977, 1.1221272945404053, 1.0719995498657227, 2.025859832763672, 0.33221495151519775, 0.6185017824172974, 0.10642337799072266, 0.696894645690918, 0.6677101850509644, 0.08280801773071289, 0.7095296382904053, 1.0254050493240356, 0.7309346199035645, 3.237208604812622, 0.8566793203353882, 0.5929915904998779, 0.3032543659210205, 0.9812061786651611, 2.299858808517456, 0.7779867649078369, 0.2689323425292969, 1.0930209159851074, 0.9919582605361938, 0.27995502948760986, 0.8851454257965088, 1.8149266242980957, 0.3740570545196533, 1.4855396747589111, 0.9358868598937988, 1.2064226865768433, 0.6227011680603027, 0.36425304412841797, 0.8618979454040527, 0.017209768295288086, 0.4022427797317505, 0.45389294624328613, 0.35678768157958984, 0.5008114576339722, 0.35800886154174805, 0.765657901763916, 1.019516944885254, 1.1010956764221191], "mean_td_error": 0.8194258213043213, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 97.0, "diff_num_grad_updates_vs_sampler_policy": 96.0}}, "num_env_steps_sampled": 87808, "num_env_steps_trained": 25026, "num_agent_steps_sampled": 263424, "num_agent_steps_trained": 25026, "last_target_update_ts": 87808, "num_target_updates": 97}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 263424, "num_agent_steps_trained": 25026, "num_env_steps_sampled": 87808, "num_env_steps_trained": 25026, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 445.23462884046484, "num_env_steps_trained_throughput_per_sec": 128.20372125093743, "timesteps_total": 87808, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 263424, "timers": {"training_iteration_time_ms": 1953.05, "sample_time_ms": 1372.569, "load_time_ms": 0.616, "load_throughput": 418683.909, "learn_time_ms": 62.178, "learn_throughput": 4149.38, "synch_weights_time_ms": 16.047}, "counters": {"num_env_steps_sampled": 87808, "num_env_steps_trained": 25026, "num_agent_steps_sampled": 263424, "num_agent_steps_trained": 25026, "last_target_update_ts": 87808, "num_target_updates": 97}, "done": false, "episodes_total": 0, "training_iteration": 98, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-18-02", "timestamp": 1700201882, "time_this_iter_s": 2.0259459018707275, "time_total_s": 198.21845269203186, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8c8afb4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 198.21845269203186, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 72.33333333333333, "ram_util_percent": 90.76666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.08403205871582, "actor_loss": -9.4927978515625, "critic_loss": 0.1255316138267517, "alpha_loss": -0.2931962311267853, "alpha_value": 0.9713433384895325, "log_alpha_value": -0.029075298458337784, "target_entropy": -6.0, "policy_t": 0.04365973547101021, "mean_q": 5.556779861450195, "max_q": 6.470244407653809, "min_q": 4.880760192871094}, "td_error": [2.4152591228485107, 0.5979809761047363, 0.7134730815887451, 1.2250514030456543, 0.9837188720703125, 0.22434592247009277, 2.804694414138794, 2.4203200340270996, 1.0850958824157715, 0.7093040943145752, 2.0971572399139404, 0.3453342914581299, 0.20019984245300293, 0.6203155517578125, 0.20639252662658691, 0.709697961807251, 2.1032392978668213, 0.8012974262237549, 0.23850274085998535, 0.6575837135314941, 0.285996675491333, 0.49468278884887695, 2.5897908210754395, 1.9309382438659668, 0.12162089347839355, 0.7125732898712158, 0.5170063972473145, 1.0252220630645752, 1.1416735649108887, 0.05036807060241699, 0.5007119178771973, 0.12187671661376953, 0.5798113346099854, 0.9452006816864014, 1.1362524032592773, 0.9666178226470947, 1.0404846668243408, 0.30200910568237305, 0.3443624973297119, 1.012862205505371, 1.2406184673309326, 0.3868849277496338, 0.9732065200805664, 1.790771245956421, 1.0034191608428955, 0.11432623863220215, 1.2721264362335205, 0.13923263549804688, 1.9824492931365967, 0.13290858268737793, 0.4614884853363037, 0.4836132526397705, 1.1646881103515625, 0.47331881523132324, 0.8604598045349121, 1.2750556468963623, 1.4686472415924072, 0.6376519203186035, 1.5634164810180664, 0.3678286075592041, 2.339984178543091, 1.1063473224639893, 0.9244277477264404, 0.0825953483581543, 0.7572829723358154, 0.40401482582092285, 1.9790160655975342, 0.9755933284759521, 2.4524765014648438, 2.0078279972076416, 1.3063850402832031, 1.2587106227874756, 0.850898265838623, 1.307361125946045, 1.570544958114624, 0.6008470058441162, 0.349653959274292, 0.0933218002319336, 0.4533233642578125, 1.3222618103027344, 0.4067263603210449, 1.4989027976989746, 0.8641226291656494, 0.07574868202209473, 0.4732041358947754, 0.7941000461578369], "mean_td_error": 0.9421722888946533, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 98.0, "diff_num_grad_updates_vs_sampler_policy": 97.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.05929183959961, "actor_loss": -7.941918849945068, "critic_loss": 0.11174698173999786, "alpha_loss": -0.292855829000473, "alpha_value": 0.9713067412376404, "log_alpha_value": -0.029112964868545532, "target_entropy": -6.0, "policy_t": -0.011571832001209259, "mean_q": 3.998843193054199, "max_q": 4.5430006980896, "min_q": 3.5517897605895996}, "td_error": [0.05955052375793457, 0.626441478729248, 0.10611867904663086, 0.047721028327941895, 0.10304582118988037, 0.14419913291931152, 0.12571310997009277, 0.8419709205627441, 2.5475387573242188, 0.21769392490386963, 0.750691294670105, 0.9101663827896118, 0.608889102935791, 0.8738465309143066, 3.1129720211029053, 0.040132999420166016, 0.9457604885101318, 1.3666378259658813, 0.38968122005462646, 2.498384475708008, 0.6116013526916504, 0.3745079040527344, 0.5619330406188965, 1.030297040939331, 0.7560217380523682, 2.035834789276123, 2.147749423980713, 0.6856000423431396, 0.6706396341323853, 0.9851040840148926, 0.5675960779190063, 0.1354835033416748, 0.3704648017883301, 1.595899224281311, 0.21032488346099854, 0.6173243522644043, 1.211786150932312, 1.140568733215332, 0.7615435123443604, 1.0105047225952148, 2.5936388969421387, 1.8640937805175781, 2.2497105598449707, 0.9534448385238647, 0.21857261657714844, 1.6865134239196777, 1.015038251876831, 0.7001357078552246, 0.23526310920715332, 0.21406078338623047, 0.5190305709838867, 1.2482101917266846, 0.42150235176086426, 0.2644345760345459, 0.6746649742126465, 1.6979870796203613, 0.8432310819625854, 0.8022533655166626, 0.21671605110168457, 0.4887930154800415, 0.7543925046920776, 0.5377836227416992, 1.1567394733428955, 1.823586344718933, 1.0394588708877563, 1.1592752933502197, 0.20040202140808105, 1.3799269199371338, 0.3729419708251953, 0.02974092960357666, 0.3015940189361572, 0.2958648204803467, 0.6328961849212646, 0.5841517448425293, 0.8961025476455688, 0.6663413047790527, 0.3567321300506592, 3.256890058517456, 1.1326000690460205, 1.1560020446777344, 1.527730107307434, 0.44592106342315674, 2.1720807552337646, 0.7256138324737549, 1.43172025680542, 0.2689645290374756], "mean_td_error": 0.8954731225967407, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 98.0, "diff_num_grad_updates_vs_sampler_policy": 97.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.144247055053711, "actor_loss": -8.006160736083984, "critic_loss": 0.15416952967643738, "alpha_loss": -0.2950631380081177, "alpha_value": 0.9713321924209595, "log_alpha_value": -0.029086748138070107, "target_entropy": -6.0, "policy_t": 0.03427926078438759, "mean_q": 4.064139366149902, "max_q": 4.664580821990967, "min_q": 3.4400644302368164}, "td_error": [0.46632862091064453, 0.6474323272705078, 0.7955658435821533, 0.5842583179473877, 0.5354421138763428, 1.0994527339935303, 1.3547747135162354, 1.3190293312072754, 0.3614999055862427, 0.4382600784301758, 0.8435032367706299, 0.8866994380950928, 0.9538203477859497, 0.5374002456665039, 0.12470459938049316, 1.1297216415405273, 0.21559035778045654, 1.2970772981643677, 1.2826640605926514, 0.3651878833770752, 0.19104528427124023, 1.531212568283081, 1.3795175552368164, 0.7106850147247314, 0.6600680351257324, 1.620882511138916, 0.7202765941619873, 1.0080370903015137, 1.1431173086166382, 1.5433900356292725, 1.1337050199508667, 1.1373703479766846, 2.0238776206970215, 0.6774156093597412, 0.7830166816711426, 1.7126834392547607, 1.7817039489746094, 0.9764993190765381, 0.7277127504348755, 0.12547588348388672, 0.08163046836853027, 0.1754617691040039, 2.4553451538085938, 1.7850598096847534, 0.3844761848449707, 0.5292854309082031, 1.069413185119629, 0.0741736888885498, 0.46348023414611816, 1.0897014141082764, 1.9132156372070312, 0.8938343524932861, 0.571906566619873, 0.8958375453948975, 0.43930792808532715, 1.5881648063659668, 1.7980645895004272, 1.5494513511657715, 1.0459414720535278, 1.6987295150756836, 0.4167754650115967, 1.21921968460083, 0.1087186336517334, 0.6950900554656982, 0.4899771213531494, 0.3525940179824829, 0.19722437858581543, 1.3101176023483276, 0.6037168502807617, 2.9878768920898438, 1.8504478931427002, 0.07516026496887207, 1.0113818645477295, 0.11163187026977539, 1.9045231342315674, 0.2529299259185791, 1.476881980895996, 1.7422226667404175, 0.8271353244781494, 0.6961556673049927, 0.8996942043304443, 2.8998546600341797, 1.2872462272644043, 2.1813366413116455, 0.19736111164093018, 1.6438971757888794], "mean_td_error": 0.9856716394424438, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 98.0, "diff_num_grad_updates_vs_sampler_policy": 97.0}}, "num_env_steps_sampled": 88704, "num_env_steps_trained": 25284, "num_agent_steps_sampled": 266112, "num_agent_steps_trained": 25284, "last_target_update_ts": 88704, "num_target_updates": 98}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 266112, "num_agent_steps_trained": 25284, "num_env_steps_sampled": 88704, "num_env_steps_trained": 25284, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 439.3027193870961, "num_env_steps_trained_throughput_per_sec": 126.49564910923078, "timesteps_total": 88704, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 266112, "timers": {"training_iteration_time_ms": 1971.225, "sample_time_ms": 1390.758, "load_time_ms": 0.619, "load_throughput": 416861.371, "learn_time_ms": 62.421, "learn_throughput": 4133.23, "synch_weights_time_ms": 16.061}, "counters": {"num_env_steps_sampled": 88704, "num_env_steps_trained": 25284, "num_agent_steps_sampled": 266112, "num_agent_steps_trained": 25284, "last_target_update_ts": 88704, "num_target_updates": 98}, "done": false, "episodes_total": 0, "training_iteration": 99, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-18-05", "timestamp": 1700201885, "time_this_iter_s": 2.053636312484741, "time_total_s": 200.2720890045166, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8981e1c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 200.2720890045166, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 74.16666666666667, "ram_util_percent": 90.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.028593063354492, "actor_loss": -9.484793663024902, "critic_loss": 0.11774279177188873, "alpha_loss": -0.29458796977996826, "alpha_value": 0.9710524678230286, "log_alpha_value": -0.029374802485108376, "target_entropy": -6.0, "policy_t": -0.02168821170926094, "mean_q": 5.566490650177002, "max_q": 6.528095722198486, "min_q": 4.7838616371154785}, "td_error": [1.2205524444580078, 0.5700578689575195, 0.7679708003997803, 0.22661066055297852, 0.7949175834655762, 0.3404707908630371, 0.21683907508850098, 0.46744227409362793, 1.2450878620147705, 0.8043015003204346, 1.9855592250823975, 1.0836753845214844, 0.2430706024169922, 0.5027976036071777, 0.8800668716430664, 0.32233309745788574, 2.013188123703003, 0.11728882789611816, 1.2516937255859375, 0.4714324474334717, 0.2622804641723633, 1.0089654922485352, 0.5267126560211182, 0.07699751853942871, 0.5115499496459961, 0.2816791534423828, 0.15834712982177734, 0.845982551574707, 1.1458497047424316, 1.7322936058044434, 3.827230215072632, 0.22304701805114746, 0.6308398246765137, 1.2978684902191162, 0.08211040496826172, 2.528740644454956, 0.4925694465637207, 0.6110105514526367, 0.1199026107788086, 0.7970578670501709, 1.7767982482910156, 0.6160907745361328, 0.9767093658447266, 0.7003204822540283, 1.277268886566162, 3.5139153003692627, 0.17976164817810059, 0.4328188896179199, 1.9674253463745117, 2.158597946166992, 0.20102787017822266, 0.24532413482666016, 1.302259922027588, 1.0602374076843262, 0.5113487243652344, 2.0868735313415527, 1.475203514099121, 0.2914540767669678, 0.927922248840332, 1.3276710510253906, 1.6846551895141602, 0.9063694477081299, 0.6339471340179443, 1.1942148208618164, 1.680680751800537, 0.1779320240020752, 0.23163986206054688, 1.4747071266174316, 0.6020495891571045, 0.47928524017333984, 0.3449869155883789, 0.8194701671600342, 0.15446805953979492, 0.7663037776947021, 0.8390374183654785, 0.25713014602661133, 0.5504884719848633, 0.25516319274902344, 2.385702610015869, 1.4021782875061035, 0.5286853313446045, 0.3325181007385254, 0.21129727363586426, 1.563723087310791, 1.306180715560913, 0.6942863464355469], "mean_td_error": 0.8975874185562134, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 99.0, "diff_num_grad_updates_vs_sampler_policy": 98.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.110313415527344, "actor_loss": -7.99176025390625, "critic_loss": 0.10283201932907104, "alpha_loss": -0.29737216234207153, "alpha_value": 0.9710155725479126, "log_alpha_value": -0.029412755742669106, "target_entropy": -6.0, "policy_t": -0.01339581236243248, "mean_q": 4.0078816413879395, "max_q": 4.575467109680176, "min_q": 3.4276955127716064}, "td_error": [0.1474388837814331, 0.7943570613861084, 1.5743275880813599, 0.17733371257781982, 0.5870822668075562, 0.40395021438598633, 2.0856971740722656, 0.31322240829467773, 1.564828872680664, 0.3509742021560669, 1.4661328792572021, 0.503158688545227, 0.1656050682067871, 0.16192173957824707, 1.355412483215332, 1.0409526824951172, 0.46831274032592773, 0.3908674716949463, 1.3071789741516113, 0.16401147842407227, 0.5731441974639893, 0.3998526334762573, 0.5909109115600586, 0.1641937494277954, 0.5288143157958984, 1.1956496238708496, 1.620417594909668, 0.09930217266082764, 0.605682373046875, 0.920141339302063, 1.1548137664794922, 1.9660428762435913, 0.7930699586868286, 2.107757091522217, 0.9622631072998047, 0.12883734703063965, 1.3991721868515015, 1.3485074043273926, 0.19271302223205566, 0.3080545663833618, 0.41605520248413086, 0.06420063972473145, 0.7471363544464111, 1.501410961151123, 1.1620373725891113, 0.8545658588409424, 0.35065793991088867, 1.6993217468261719, 3.299562692642212, 1.5806143283843994, 0.8326855897903442, 0.5913972854614258, 0.3768564462661743, 2.624717950820923, 1.586424708366394, 0.9390521049499512, 1.4955651760101318, 0.02718174457550049, 0.0207822322845459, 0.13433992862701416, 0.6240259408950806, 0.7395434379577637, 1.4581727981567383, 1.3996779918670654, 0.6779251098632812, 0.31088805198669434, 0.3585383892059326, 0.3856562376022339, 1.3256402015686035, 1.6501893997192383, 0.24341773986816406, 0.6453506946563721, 1.095411777496338, 0.1384284496307373, 0.31547868251800537, 0.3366405963897705, 0.5701725482940674, 2.0747861862182617, 1.1169320344924927, 0.014899015426635742, 0.3945040702819824, 0.5694376230239868, 1.017024040222168, 0.05812406539916992, 1.6799944639205933, 0.23543500900268555], "mean_td_error": 0.8351507782936096, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 99.0, "diff_num_grad_updates_vs_sampler_policy": 98.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.072623252868652, "actor_loss": -7.984975337982178, "critic_loss": 0.1378447711467743, "alpha_loss": -0.295999675989151, "alpha_value": 0.9710410237312317, "log_alpha_value": -0.029386553913354874, "target_entropy": -6.0, "policy_t": 0.007744632661342621, "mean_q": 4.041522979736328, "max_q": 4.535940647125244, "min_q": 3.4200453758239746}, "td_error": [0.2702869176864624, 0.16358709335327148, 0.5111238956451416, 0.9684963226318359, 1.3793548345565796, 1.9782782793045044, 2.0977046489715576, 1.6053340435028076, 1.013410210609436, 1.0782170295715332, 1.6322540044784546, 0.9325178861618042, 0.34779083728790283, 0.5267820358276367, 1.0625054836273193, 0.0502622127532959, 0.18947172164916992, 0.6200006008148193, 0.9398068189620972, 1.205543041229248, 0.9445400238037109, 1.672703504562378, 1.6930201053619385, 0.5410559177398682, 0.5782957077026367, 0.7376022338867188, 0.04704642295837402, 1.3679214715957642, 0.5940704345703125, 0.31616389751434326, 1.4780669212341309, 0.7117624282836914, 0.8428835868835449, 0.1354999542236328, 0.00461268424987793, 0.1261744499206543, 0.8033936023712158, 1.1798851490020752, 0.500912070274353, 2.6504530906677246, 2.3020713329315186, 0.04674577713012695, 1.2641223669052124, 1.1041443347930908, 2.538604497909546, 0.7857314348220825, 0.6365443468093872, 0.6746611595153809, 0.7283986806869507, 0.08571600914001465, 0.9696704149246216, 0.32909107208251953, 0.2675597667694092, 0.9458547830581665, 1.037043809890747, 2.7275261878967285, 0.4489119052886963, 0.19753754138946533, 0.9477505683898926, 0.5220085382461548, 0.8977460861206055, 0.8429610729217529, 0.48940062522888184, 0.3990105390548706, 1.6981220245361328, 0.7324690818786621, 1.7400249242782593, 2.375396251678467, 0.6035975217819214, 1.3410797119140625, 0.4502551555633545, 1.913858413696289, 0.5824699401855469, 2.338127851486206, 0.4536890983581543, 1.204687237739563, 0.22950196266174316, 0.04446053504943848, 1.201709270477295, 0.7137064933776855, 1.3317744731903076, 0.20830917358398438, 0.11971306800842285, 1.0879836082458496, 0.03579306602478027, 0.48017942905426025], "mean_td_error": 0.902029275894165, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 99.0, "diff_num_grad_updates_vs_sampler_policy": 98.0}}, "num_env_steps_sampled": 89600, "num_env_steps_trained": 25542, "num_agent_steps_sampled": 268800, "num_agent_steps_trained": 25542, "last_target_update_ts": 89600, "num_target_updates": 99}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 268800, "num_agent_steps_trained": 25542, "num_env_steps_sampled": 89600, "num_env_steps_trained": 25542, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 439.7593559972487, "num_env_steps_trained_throughput_per_sec": 126.6271359902792, "timesteps_total": 89600, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 268800, "timers": {"training_iteration_time_ms": 1963.244, "sample_time_ms": 1385.112, "load_time_ms": 0.552, "load_throughput": 467362.197, "learn_time_ms": 62.395, "learn_throughput": 4134.959, "synch_weights_time_ms": 15.837}, "counters": {"num_env_steps_sampled": 89600, "num_env_steps_trained": 25542, "num_agent_steps_sampled": 268800, "num_agent_steps_trained": 25542, "last_target_update_ts": 89600, "num_target_updates": 99}, "done": false, "episodes_total": 0, "training_iteration": 100, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-18-07", "timestamp": 1700201887, "time_this_iter_s": 2.0547940731048584, "time_total_s": 202.32688307762146, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8aa4c7280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 202.32688307762146, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 69.43333333333334, "ram_util_percent": 90.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.075779914855957, "actor_loss": -9.524772644042969, "critic_loss": 0.12532535195350647, "alpha_loss": -0.29899123311042786, "alpha_value": 0.9707617163658142, "log_alpha_value": -0.029674256220459938, "target_entropy": -6.0, "policy_t": 0.06282995641231537, "mean_q": 5.683125019073486, "max_q": 6.604564666748047, "min_q": 4.864418983459473}, "td_error": [0.18310785293579102, 1.6421382427215576, 0.5314846038818359, 0.4155397415161133, 0.01077890396118164, 0.9038753509521484, 0.0900125503540039, 0.39590024948120117, 0.10393857955932617, 2.5182831287384033, 0.28597068786621094, 0.40421533584594727, 0.8820230960845947, 1.7316925525665283, 2.5941998958587646, 2.2383317947387695, 1.0466008186340332, 0.23400545120239258, 0.5896334648132324, 0.9936790466308594, 1.1384735107421875, 2.316490888595581, 1.0283324718475342, 1.2742385864257812, 1.3553004264831543, 0.8356382846832275, 0.9874007701873779, 0.3682548999786377, 1.3720240592956543, 0.4338350296020508, 0.5092833042144775, 0.6962459087371826, 0.20013093948364258, 0.6376349925994873, 0.9332826137542725, 0.9897291660308838, 1.7278594970703125, 0.8125507831573486, 0.46578168869018555, 0.47023487091064453, 0.2661914825439453, 1.320218563079834, 0.9065854549407959, 0.029896974563598633, 0.19123578071594238, 1.0420680046081543, 0.18332195281982422, 1.0085244178771973, 0.3492298126220703, 1.9418106079101562, 0.07459306716918945, 0.39091062545776367, 2.530484437942505, 0.7183835506439209, 3.3835175037384033, 0.25241947174072266, 0.4273805618286133, 0.6480767726898193, 1.2544262409210205, 0.5703654289245605, 0.5764541625976562, 0.21267318725585938, 0.1830427646636963, 1.0819306373596191, 1.373072624206543, 1.1600244045257568, 0.9059078693389893, 1.5142812728881836, 1.2259423732757568, 0.6043233871459961, 1.8151321411132812, 0.4791138172149658, 0.5307314395904541, 0.7783498764038086, 1.0840938091278076, 2.087477922439575, 0.3083348274230957, 1.2241380214691162, 0.2743189334869385, 0.22754693031311035, 0.4698331356048584, 2.5563721656799316, 0.9127500057220459, 1.1012334823608398, 2.1056883335113525, 0.5068140029907227], "mean_td_error": 0.9202017784118652, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 100.0, "diff_num_grad_updates_vs_sampler_policy": 99.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.078695297241211, "actor_loss": -7.9501824378967285, "critic_loss": 0.10009343922138214, "alpha_loss": -0.2994645833969116, "alpha_value": 0.9707244634628296, "log_alpha_value": -0.029712636023759842, "target_entropy": -6.0, "policy_t": 0.030164025723934174, "mean_q": 3.992312431335449, "max_q": 4.5735273361206055, "min_q": 3.5190742015838623}, "td_error": [0.07627224922180176, 0.7172335386276245, 0.5382815599441528, 0.6399203538894653, 1.1700102090835571, 1.356583833694458, 0.1658034324645996, 0.41172611713409424, 1.3620885610580444, 0.579326868057251, 1.250869870185852, 0.24926340579986572, 1.3270900249481201, 0.6855003833770752, 0.9853007793426514, 2.268685817718506, 1.9959890842437744, 1.7779593467712402, 0.7238123416900635, 0.4906606674194336, 0.3602604866027832, 1.3034603595733643, 0.24347305297851562, 1.2730133533477783, 0.26910877227783203, 0.28267574310302734, 0.3901721239089966, 0.1488422155380249, 0.2845419645309448, 0.2941756248474121, 1.124197006225586, 1.121008276939392, 0.39540863037109375, 0.34992480278015137, 1.173642873764038, 0.4481346607208252, 0.1831958293914795, 0.5801472663879395, 0.8260743618011475, 0.60643470287323, 1.9272592067718506, 1.498109221458435, 0.9112343788146973, 0.9133578538894653, 1.40806245803833, 0.4512752294540405, 0.1794220209121704, 0.6545699834823608, 0.592376708984375, 0.43413448333740234, 1.6832118034362793, 0.5144842863082886, 0.7435269355773926, 0.6733371019363403, 0.24666094779968262, 1.517139196395874, 0.6318832635879517, 0.24686717987060547, 0.4047868251800537, 1.7584890127182007, 0.4351705312728882, 1.8952841758728027, 0.32583868503570557, 0.7698912620544434, 0.6530148983001709, 0.6376945972442627, 1.4712612628936768, 0.6095044612884521, 0.3648442029953003, 0.6078565120697021, 1.3690598011016846, 0.2916593551635742, 2.2767045497894287, 1.3376879692077637, 0.2343529462814331, 0.4424091577529907, 0.9881997108459473, 1.7946219444274902, 1.0942463874816895, 0.2748364210128784, 1.4320539236068726, 1.7518330812454224, 2.360501766204834, 0.6355166435241699, 0.6787652969360352, 0.8140170574188232], "mean_td_error": 0.8531078696250916, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 100.0, "diff_num_grad_updates_vs_sampler_policy": 99.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.054764747619629, "actor_loss": -7.97374153137207, "critic_loss": 0.12471354007720947, "alpha_loss": -0.29848936200141907, "alpha_value": 0.9707499742507935, "log_alpha_value": -0.02968636341392994, "target_entropy": -6.0, "policy_t": -0.05050302669405937, "mean_q": 4.07528829574585, "max_q": 4.630303859710693, "min_q": 3.3388495445251465}, "td_error": [0.3923511505126953, 1.1872634887695312, 1.7730739116668701, 0.0161820650100708, 0.4078671932220459, 1.84678053855896, 0.031080007553100586, 0.8038443326950073, 0.04871976375579834, 0.8118757009506226, 1.2318291664123535, 0.5304702520370483, 1.1821014881134033, 0.5184066295623779, 0.8127080202102661, 0.4845762252807617, 0.4498767852783203, 0.1458888053894043, 0.06604337692260742, 1.8827970027923584, 0.8056102991104126, 1.2296769618988037, 2.0909690856933594, 1.9557832479476929, 0.2511904239654541, 1.856614351272583, 0.1863691806793213, 0.8104493618011475, 0.10456728935241699, 0.23786330223083496, 0.9036657810211182, 0.3188810348510742, 0.44295430183410645, 0.44937753677368164, 1.5577785968780518, 0.3344137668609619, 0.61332106590271, 1.3034310340881348, 0.3773372173309326, 0.25676655769348145, 2.1123945713043213, 2.0954627990722656, 0.8850083351135254, 0.7957415580749512, 3.0381851196289062, 0.5757875442504883, 0.26245689392089844, 1.0067102909088135, 1.3984448909759521, 0.8343324661254883, 1.1432335376739502, 1.2216094732284546, 0.5585495233535767, 0.5956616401672363, 0.06345820426940918, 0.9145302772521973, 1.1921169757843018, 0.47905755043029785, 0.16657018661499023, 0.28690826892852783, 0.7707295417785645, 0.9814457893371582, 0.5563970804214478, 0.4842042922973633, 1.3141376972198486, 0.06350672245025635, 0.16802382469177246, 0.9509322643280029, 1.3597493171691895, 0.49493956565856934, 0.13779377937316895, 2.9704151153564453, 0.651646614074707, 0.08211994171142578, 0.8554052114486694, 1.5245673656463623, 0.4222712516784668, 0.15497291088104248, 1.0309640169143677, 2.1608948707580566, 1.164074182510376, 0.7482616901397705, 1.398442268371582, 0.9765105247497559, 0.07042098045349121, 0.8917518854141235], "mean_td_error": 0.8455995321273804, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 100.0, "diff_num_grad_updates_vs_sampler_policy": 99.0}}, "num_env_steps_sampled": 90496, "num_env_steps_trained": 25800, "num_agent_steps_sampled": 271488, "num_agent_steps_trained": 25800, "last_target_update_ts": 90496, "num_target_updates": 100}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 271488, "num_agent_steps_trained": 25800, "num_env_steps_sampled": 90496, "num_env_steps_trained": 25800, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 394.6463866891435, "num_env_steps_trained_throughput_per_sec": 113.63701759575784, "timesteps_total": 90496, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 271488, "timers": {"training_iteration_time_ms": 1976.228, "sample_time_ms": 1398.03, "load_time_ms": 0.539, "load_throughput": 478797.589, "learn_time_ms": 62.321, "learn_throughput": 4139.843, "synch_weights_time_ms": 15.87}, "counters": {"num_env_steps_sampled": 90496, "num_env_steps_trained": 25800, "num_agent_steps_sampled": 271488, "num_agent_steps_trained": 25800, "last_target_update_ts": 90496, "num_target_updates": 100}, "done": false, "episodes_total": 0, "training_iteration": 101, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-18-09", "timestamp": 1700201889, "time_this_iter_s": 2.288041830062866, "time_total_s": 204.61492490768433, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8981e1c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 204.61492490768433, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 68.35, "ram_util_percent": 90.85}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0592622756958, "actor_loss": -9.572420120239258, "critic_loss": 0.13813811540603638, "alpha_loss": -0.30151423811912537, "alpha_value": 0.9704709649085999, "log_alpha_value": -0.029973791912198067, "target_entropy": -6.0, "policy_t": -0.02794492430984974, "mean_q": 5.6550726890563965, "max_q": 6.486130714416504, "min_q": 4.728516578674316}, "td_error": [1.511279821395874, 0.7986652851104736, 0.6137309074401855, 0.9596643447875977, 1.8427844047546387, 0.22535181045532227, 0.34221410751342773, 0.04636812210083008, 1.9154775142669678, 1.7174928188323975, 0.8880734443664551, 0.0278170108795166, 1.6992170810699463, 1.631267786026001, 0.43448543548583984, 0.7498078346252441, 1.177083969116211, 0.5126457214355469, 1.5124287605285645, 0.874478816986084, 1.338695764541626, 0.6870622634887695, 0.8075299263000488, 1.4026398658752441, 0.8340628147125244, 2.131882429122925, 0.8273992538452148, 0.10050630569458008, 0.6496763229370117, 0.5020537376403809, 0.4170534610748291, 1.3689439296722412, 2.1740970611572266, 0.4826629161834717, 0.9236023426055908, 0.6593103408813477, 0.07516908645629883, 1.8773329257965088, 1.013441801071167, 0.5771510601043701, 0.22181487083435059, 0.29415202140808105, 0.6224188804626465, 1.0238616466522217, 0.23689937591552734, 1.6481225490570068, 0.25264406204223633, 1.2727611064910889, 0.697486162185669, 0.13355588912963867, 0.866736650466919, 1.310312271118164, 0.10790061950683594, 0.6229140758514404, 0.12094497680664062, 0.7104966640472412, 0.8521735668182373, 0.24410104751586914, 0.3220033645629883, 1.5823776721954346, 0.2942233085632324, 1.589362621307373, 1.5867631435394287, 2.1253957748413086, 2.034585952758789, 0.5070531368255615, 2.935821771621704, 1.445465087890625, 1.698540210723877, 2.1522622108459473, 0.8433690071105957, 0.8099923133850098, 0.9542624950408936, 2.247396945953369, 0.49117398262023926, 0.8764407634735107, 0.7949142456054688, 0.05496978759765625, 1.26155686378479, 1.2308025360107422, 2.1237599849700928, 1.5376667976379395, 0.1694035530090332, 2.4820926189422607, 0.7395501136779785, 0.8305473327636719], "mean_td_error": 0.9917633533477783, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 101.0, "diff_num_grad_updates_vs_sampler_policy": 100.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.063248634338379, "actor_loss": -7.924220085144043, "critic_loss": 0.12632927298545837, "alpha_loss": -0.302023321390152, "alpha_value": 0.9704334139823914, "log_alpha_value": -0.03001251071691513, "target_entropy": -6.0, "policy_t": 0.03555310145020485, "mean_q": 4.013842582702637, "max_q": 4.6609721183776855, "min_q": 3.525418758392334}, "td_error": [2.2432446479797363, 1.1421087980270386, 1.3046584129333496, 1.0116353034973145, 0.9483108520507812, 0.1830291748046875, 1.454999566078186, 0.057114362716674805, 0.5741074085235596, 0.5135229825973511, 0.5730314254760742, 1.6808174848556519, 1.2594835758209229, 1.5041823387145996, 0.3907233476638794, 1.8403304815292358, 1.0896263122558594, 0.0955801010131836, 0.45810675621032715, 1.8674726486206055, 0.25191783905029297, 1.1209766864776611, 0.304584264755249, 0.10799312591552734, 0.9213078022003174, 0.5920934677124023, 1.1730015277862549, 0.9282279014587402, 1.0454940795898438, 0.2517738342285156, 0.9526469707489014, 0.06247401237487793, 1.4462053775787354, 0.9065150022506714, 0.5644409656524658, 1.2232588529586792, 0.16689229011535645, 1.0791010856628418, 3.0425405502319336, 0.9560136795043945, 2.046959400177002, 1.767089605331421, 1.2471859455108643, 0.9886703491210938, 1.6064515113830566, 1.5190637111663818, 1.3707195520401, 0.31513941287994385, 1.363987684249878, 0.5373566150665283, 1.9307842254638672, 0.5351555347442627, 0.8616828918457031, 2.0210318565368652, 0.41092538833618164, 1.82487154006958, 0.5423276424407959, 0.21782755851745605, 0.41199779510498047, 0.5487613677978516, 0.27129626274108887, 0.47747039794921875, 3.460935115814209, 1.4443600177764893, 0.7120081186294556, 0.4832574129104614, 1.329237699508667, 0.5520129203796387, 1.2390267848968506, 1.2563180923461914, 0.17744851112365723, 0.9297506809234619, 0.9172217845916748, 0.14112353324890137, 0.554163932800293, 0.7386369705200195, 0.7633934020996094, 0.9089196920394897, 0.9342800378799438, 2.4480156898498535, 0.7941937446594238, 2.4532277584075928, 0.09984290599822998, 1.1260639429092407, 0.19212448596954346, 1.0123714208602905], "mean_td_error": 0.9857469797134399, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 101.0, "diff_num_grad_updates_vs_sampler_policy": 100.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.130498886108398, "actor_loss": -8.027620315551758, "critic_loss": 0.13094335794448853, "alpha_loss": -0.3037744462490082, "alpha_value": 0.970458984375, "log_alpha_value": -0.029986128211021423, "target_entropy": -6.0, "policy_t": -0.020801234990358353, "mean_q": 4.086101531982422, "max_q": 4.8489580154418945, "min_q": 3.3601324558258057}, "td_error": [0.47764289379119873, 0.8677456378936768, 0.5524337291717529, 0.754592776298523, 0.49145591259002686, 0.6308603286743164, 2.0392584800720215, 0.6400706768035889, 0.7751425504684448, 1.6361932754516602, 0.29335904121398926, 0.72807776927948, 0.1535416841506958, 0.9420430660247803, 1.4876996278762817, 1.1825904846191406, 0.9250990152359009, 0.4645555019378662, 0.31510424613952637, 1.0806899070739746, 0.7753081321716309, 0.5378216505050659, 0.4930539131164551, 1.1846833229064941, 0.876267671585083, 0.5557377338409424, 0.15231764316558838, 1.9186615943908691, 0.3649144172668457, 0.3547171354293823, 0.7568008899688721, 1.1016958951950073, 0.34299182891845703, 0.9413138628005981, 1.5620477199554443, 0.12770390510559082, 0.9934149980545044, 0.1055217981338501, 2.0565531253814697, 1.3967382907867432, 0.585181713104248, 0.9865179061889648, 1.627995252609253, 1.405146837234497, 1.2947256565093994, 0.8862841129302979, 0.16328299045562744, 0.7918312549591064, 0.13628828525543213, 0.2120656967163086, 0.048216819763183594, 1.0150091648101807, 0.6797330379486084, 0.8302013874053955, 0.09532618522644043, 2.2227845191955566, 1.224520206451416, 1.3976677656173706, 1.7335569858551025, 0.3790109157562256, 0.19005990028381348, 0.4317286014556885, 1.2596514225006104, 0.8426542282104492, 0.06511986255645752, 0.9823076725006104, 1.335287094116211, 1.694979190826416, 0.4100435972213745, 0.31901848316192627, 1.830348253250122, 1.0857391357421875, 0.13297224044799805, 0.6367230415344238, 0.9803621768951416, 0.7510472536087036, 1.4252870082855225, 1.4739892482757568, 3.4265074729919434, 0.057187557220458984, 0.6800129413604736, 1.3426504135131836, 1.7525787353515625, 1.236262559890747, 0.8226456642150879, 2.262718677520752], "mean_td_error": 0.9090656638145447, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 101.0, "diff_num_grad_updates_vs_sampler_policy": 100.0}}, "num_env_steps_sampled": 91392, "num_env_steps_trained": 26058, "num_agent_steps_sampled": 274176, "num_agent_steps_trained": 26058, "last_target_update_ts": 91392, "num_target_updates": 101}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 274176, "num_agent_steps_trained": 26058, "num_env_steps_sampled": 91392, "num_env_steps_trained": 26058, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 399.52300685337667, "num_env_steps_trained_throughput_per_sec": 115.04122295554819, "timesteps_total": 91392, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 274176, "timers": {"training_iteration_time_ms": 1989.977, "sample_time_ms": 1414.064, "load_time_ms": 0.538, "load_throughput": 479965.596, "learn_time_ms": 62.311, "learn_throughput": 4140.495, "synch_weights_time_ms": 15.805}, "counters": {"num_env_steps_sampled": 91392, "num_env_steps_trained": 26058, "num_agent_steps_sampled": 274176, "num_agent_steps_trained": 26058, "last_target_update_ts": 91392, "num_target_updates": 101}, "done": false, "episodes_total": 0, "training_iteration": 102, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-18-11", "timestamp": 1700201891, "time_this_iter_s": 2.2595090866088867, "time_total_s": 206.8744339942932, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8981e1d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 206.8744339942932, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 76.93333333333334, "ram_util_percent": 90.83333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.031533241271973, "actor_loss": -9.564580917358398, "critic_loss": 0.12705576419830322, "alpha_loss": -0.3036881685256958, "alpha_value": 0.9701802730560303, "log_alpha_value": -0.030273359268903732, "target_entropy": -6.0, "policy_t": 0.03058851882815361, "mean_q": 5.731142044067383, "max_q": 6.61779260635376, "min_q": 5.0354156494140625}, "td_error": [0.6582541465759277, 0.1975231170654297, 1.5515069961547852, 1.3586857318878174, 2.4802052974700928, 0.615515947341919, 0.10358643531799316, 0.7531094551086426, 0.2628316879272461, 1.2137815952301025, 0.20629286766052246, 0.2895517349243164, 2.791933536529541, 0.501666784286499, 1.155045747756958, 0.8172352313995361, 0.2563788890838623, 0.5936877727508545, 0.5509560108184814, 2.5413947105407715, 0.21742963790893555, 0.6466929912567139, 0.6830911636352539, 2.0561728477478027, 0.3413081169128418, 2.8319661617279053, 1.4509170055389404, 2.9582395553588867, 0.09799742698669434, 0.5566492080688477, 0.6876444816589355, 0.37138962745666504, 0.6747493743896484, 0.10090351104736328, 0.9902501106262207, 1.9039092063903809, 1.8545379638671875, 0.8032982349395752, 0.39829206466674805, 0.5113763809204102, 0.1044473648071289, 1.7269277572631836, 0.8806719779968262, 0.12624454498291016, 0.19763708114624023, 3.6394460201263428, 1.7261042594909668, 1.5505807399749756, 1.135591745376587, 1.3139638900756836, 1.1889116764068604, 0.12180757522583008, 1.708305835723877, 1.547414779663086, 0.9873263835906982, 1.411287546157837, 1.8971691131591797, 0.8504774570465088, 0.9908883571624756, 0.5803649425506592, 1.3020243644714355, 0.9958925247192383, 1.8605895042419434, 0.7858383655548096, 0.7339076995849609, 0.5505290031433105, 0.6800961494445801, 0.48876953125, 0.657029390335083, 0.4699714183807373, 0.4002528190612793, 1.1574738025665283, 1.3479180335998535, 1.6053757667541504, 0.5542230606079102, 0.10686945915222168, 0.8345773220062256, 0.13094663619995117, 0.11049127578735352, 1.387150764465332, 0.40725040435791016, 0.7216207981109619, 0.4328594207763672, 0.9465973377227783, 0.11490607261657715, 0.4663679599761963], "mean_td_error": 0.9531517624855042, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 102.0, "diff_num_grad_updates_vs_sampler_policy": 101.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.107316970825195, "actor_loss": -7.94315767288208, "critic_loss": 0.11018630862236023, "alpha_loss": -0.3063764274120331, "alpha_value": 0.9701424837112427, "log_alpha_value": -0.030312340706586838, "target_entropy": -6.0, "policy_t": -0.01623988337814808, "mean_q": 4.025341510772705, "max_q": 4.739948272705078, "min_q": 3.380539655685425}, "td_error": [0.4033091068267822, 1.0262765884399414, 0.2294025421142578, 0.572420597076416, 1.513082504272461, 0.18960237503051758, 1.5134655237197876, 0.6912515163421631, 1.702674388885498, 1.636380672454834, 1.2683141231536865, 1.016040325164795, 1.1306052207946777, 1.239922046661377, 1.9529030323028564, 0.16549575328826904, 0.2883192300796509, 1.2176034450531006, 0.10753965377807617, 0.41250789165496826, 0.07397985458374023, 0.6467123031616211, 0.7314615249633789, 0.5444793701171875, 1.273480772972107, 1.0466437339782715, 1.3052922487258911, 1.094775676727295, 1.2765436172485352, 1.1100795269012451, 0.31540751457214355, 0.36154818534851074, 0.03471231460571289, 1.1257743835449219, 1.8528320789337158, 2.3734946250915527, 1.6067732572555542, 0.4238619804382324, 1.5841197967529297, 0.5267674922943115, 0.5611140727996826, 1.0343743562698364, 0.5976710319519043, 1.4910295009613037, 0.01189112663269043, 0.7122920751571655, 2.205441474914551, 0.43245506286621094, 0.676058292388916, 0.7442420721054077, 0.10533022880554199, 0.6287736892700195, 1.6501953601837158, 0.9129183292388916, 3.816737174987793, 1.6334283351898193, 0.7835184335708618, 0.10720932483673096, 1.5593633651733398, 0.6552872657775879, 0.0695943832397461, 1.1834237575531006, 0.3545781373977661, 0.6499775648117065, 0.33930540084838867, 0.8516840934753418, 0.08791756629943848, 0.6765514612197876, 0.7558727264404297, 1.462714433670044, 0.5130659341812134, 0.7620346546173096, 0.07211601734161377, 1.182117223739624, 1.499269723892212, 0.5946080684661865, 0.29752206802368164, 0.551237940788269, 0.6010346412658691, 0.7055660486221313, 1.0148577690124512, 0.21852290630340576, 0.7994816303253174, 1.2447248697280884, 2.8521742820739746, 1.0958032608032227], "mean_td_error": 0.9109411835670471, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 102.0, "diff_num_grad_updates_vs_sampler_policy": 101.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.090822219848633, "actor_loss": -8.035295486450195, "critic_loss": 0.1156449168920517, "alpha_loss": -0.3056112229824066, "alpha_value": 0.9701679944992065, "log_alpha_value": -0.03028605692088604, "target_entropy": -6.0, "policy_t": -0.018430136144161224, "mean_q": 4.092220306396484, "max_q": 4.740853786468506, "min_q": 3.690117835998535}, "td_error": [1.574143648147583, 0.22284483909606934, 1.282745361328125, 0.09853887557983398, 0.6749833822250366, 1.189284086227417, 0.542566180229187, 0.5915873050689697, 0.035286784172058105, 1.6822609901428223, 1.7738378047943115, 0.43955349922180176, 0.263759970664978, 0.28162574768066406, 1.377694010734558, 0.36008739471435547, 0.8460017442703247, 2.1895265579223633, 1.660069465637207, 1.528898000717163, 0.02551126480102539, 0.07375955581665039, 1.4271870851516724, 0.03927898406982422, 0.4950690269470215, 0.1331775188446045, 0.14946389198303223, 0.5602202415466309, 1.6879456043243408, 1.0731755495071411, 0.26308250427246094, 0.915926456451416, 0.6766095161437988, 0.3091275691986084, 1.0626715421676636, 0.6318998336791992, 0.5163567066192627, 0.31002020835876465, 0.9979503154754639, 0.0669480562210083, 1.3438129425048828, 1.0648202896118164, 0.39437806606292725, 1.0710079669952393, 1.0014631748199463, 1.197829246520996, 0.24861478805541992, 0.5505690574645996, 0.8368628025054932, 1.291663408279419, 1.4034126996994019, 2.4504525661468506, 0.05691337585449219, 0.1160130500793457, 0.6335135698318481, 0.916837215423584, 0.9061834812164307, 1.0474357604980469, 2.5140769481658936, 0.6838648319244385, 1.127868890762329, 1.358221411705017, 0.8183193206787109, 1.1100623607635498, 0.44654011726379395, 0.9010210037231445, 1.1994924545288086, 0.9228502511978149, 0.6795752048492432, 0.7948031425476074, 0.7889750003814697, 0.32366645336151123, 0.008966207504272461, 0.15927958488464355, 0.07196569442749023, 1.2695224285125732, 0.03590679168701172, 0.5997819900512695, 0.5249590873718262, 0.7126741409301758, 0.5480880737304688, 0.19906628131866455, 0.889092206954956, 2.0272650718688965, 0.32373666763305664, 1.5303577184677124], "mean_td_error": 0.8038658499717712, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 102.0, "diff_num_grad_updates_vs_sampler_policy": 101.0}}, "num_env_steps_sampled": 92288, "num_env_steps_trained": 26316, "num_agent_steps_sampled": 276864, "num_agent_steps_trained": 26316, "last_target_update_ts": 92288, "num_target_updates": 102}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 276864, "num_agent_steps_trained": 26316, "num_env_steps_sampled": 92288, "num_env_steps_trained": 26316, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 426.199069099863, "num_env_steps_trained_throughput_per_sec": 122.72249980777305, "timesteps_total": 92288, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 276864, "timers": {"training_iteration_time_ms": 2010.37, "sample_time_ms": 1433.836, "load_time_ms": 0.537, "load_throughput": 480775.916, "learn_time_ms": 62.399, "learn_throughput": 4134.695, "synch_weights_time_ms": 15.827}, "counters": {"num_env_steps_sampled": 92288, "num_env_steps_trained": 26316, "num_agent_steps_sampled": 276864, "num_agent_steps_trained": 26316, "last_target_update_ts": 92288, "num_target_updates": 102}, "done": false, "episodes_total": 0, "training_iteration": 103, "trial_id": "8e3b5_00000", "date": "2023-11-16_22-18-13", "timestamp": 1700201893, "time_this_iter_s": 2.11806583404541, "time_total_s": 208.99249982833862, "pid": 47759, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fe8981e1ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 208.99249982833862, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 74.66666666666667, "ram_util_percent": 90.83333333333333}}
