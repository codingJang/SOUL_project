{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 896, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2688, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2688, "num_agent_steps_trained": 0, "num_env_steps_sampled": 896, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 306.1396353577811, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 896, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2688, "timers": {"training_iteration_time_ms": 2926.734, "sample_time_ms": 1427.013}, "counters": {"num_env_steps_sampled": 896, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2688, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 1, "trial_id": "566d8_00000", "date": "2023-11-16_22-20-19", "timestamp": 1700202019, "time_this_iter_s": 2.930453062057495, "time_total_s": 2.930453062057495, "pid": 48481, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fb7725be1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 2.930453062057495, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 44.42, "ram_util_percent": 92.22}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.050337791442871, "actor_loss": -4.047609329223633, "critic_loss": 5.358755111694336, "alpha_loss": 0.0, "alpha_value": 1.0, "log_alpha_value": 0.0, "target_entropy": -6.0, "policy_t": -0.024426264688372612, "mean_q": -0.0027609553653746843, "max_q": -0.0005349030252546072, "min_q": -0.00649315444752574}, "td_error": [6.066519260406494, 7.515981674194336, 7.497823715209961, 4.20672607421875, 4.187328338623047, 5.99675178527832, 4.921453952789307, 4.564022064208984, 6.212399482727051, 5.405540466308594, 6.656886100769043, 7.264965534210205, 6.903537750244141, 5.635145664215088, 5.395158767700195, 7.940128326416016, 5.020856857299805, 7.729766845703125, 6.318785667419434, 5.549848556518555, 5.6180419921875, 3.526503086090088, 3.573676347732544, 4.91393518447876, 8.572793960571289, 6.982913017272949, 3.6076009273529053, 6.679856300354004, 6.2983527183532715, 5.681372165679932, 4.169540882110596, 6.4775543212890625, 6.279670715332031, 4.445160388946533, 4.005146026611328, 5.121226787567139, 7.720810413360596, 7.504983901977539, 3.672013759613037, 4.872130393981934, 5.695976257324219, 6.2214508056640625, 7.143056392669678, 5.855011940002441, 5.312050819396973, 8.180469512939453, 7.195688247680664, 6.303737640380859, 6.137825965881348, 4.888369560241699, 6.280218124389648, 7.966289520263672, 5.16366720199585, 6.627159595489502, 6.366115570068359, 4.322257041931152, 5.326196670532227, 5.237575531005859, 4.736449241638184, 5.3525543212890625, 5.835755348205566, 5.171258926391602, 7.845479965209961, 5.329606533050537, 6.285017967224121, 5.543740749359131, 6.28795051574707, 5.58474063873291, 4.609730243682861, 4.769298553466797, 4.204671859741211, 5.284931182861328, 5.729508399963379, 6.651538848876953, 7.878644943237305, 7.603854179382324, 5.55518913269043, 5.759059906005859, 6.290475845336914, 3.8596527576446533, 6.191039085388184, 7.076920509338379, 5.66287899017334, 4.828310966491699, 6.431367874145508, 6.557255268096924], "mean_td_error": 5.8587541580200195, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1.0, "diff_num_grad_updates_vs_sampler_policy": 0.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.95242691040039, "actor_loss": -3.9534738063812256, "critic_loss": 3.0959339141845703, "alpha_loss": 0.0, "alpha_value": 1.0, "log_alpha_value": 0.0, "target_entropy": -6.0, "policy_t": -0.042281925678253174, "mean_q": 0.0030646517407149076, "max_q": 0.006707089953124523, "min_q": -0.0010576038621366024}, "td_error": [2.5371923446655273, 4.090381622314453, 2.9535653591156006, 1.7595999240875244, 5.07306432723999, 4.010115623474121, 4.5422868728637695, 2.0596156120300293, 4.72147798538208, 5.032308578491211, 4.574367523193359, 2.1973493099212646, 4.391308784484863, 3.534721612930298, 3.093313455581665, 4.395801544189453, 3.9148640632629395, 5.336175918579102, 2.7402851581573486, 5.322673320770264, 4.6915602684021, 6.230985164642334, 4.085024833679199, 3.6103034019470215, 2.807426691055298, 4.039091110229492, 5.610147953033447, 3.537550210952759, 3.558495044708252, 3.5872063636779785, 4.233399391174316, 5.576437950134277, 3.913076400756836, 5.0119476318359375, 3.09487247467041, 1.2842539548873901, 3.5593509674072266, 2.842895030975342, 1.684314489364624, 3.138157844543457, 3.2706875801086426, 3.36564302444458, 3.7081661224365234, 4.334650993347168, 3.5267891883850098, 4.79043436050415, 3.189979314804077, 3.6692214012145996, 4.43228816986084, 3.412614345550537, 3.233203649520874, 2.0109853744506836, 4.553867340087891, 2.432133436203003, 4.551824569702148, 1.672757625579834, 2.6091794967651367, 4.227295875549316, 2.796313762664795, 2.7393076419830322, 3.14457106590271, 2.3016767501831055, 3.164083480834961, 2.2214574813842773, 5.959066390991211, 3.5120482444763184, 4.594588756561279, 3.5831313133239746, 2.8538641929626465, 3.153672218322754, 4.623400688171387, 3.037381410598755, 5.0173444747924805, 3.9822325706481934, 2.2650957107543945, 2.506983757019043, 3.356036901473999, 2.7750020027160645, 2.718140125274658, 4.8679704666137695, 3.4414453506469727, 2.506542921066284, 2.8242979049682617, 3.182718276977539, 2.8529675006866455, 3.900256633758545], "mean_td_error": 3.595933675765991, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1.0, "diff_num_grad_updates_vs_sampler_policy": 0.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.105775833129883, "actor_loss": -4.1041669845581055, "critic_loss": 3.188166618347168, "alpha_loss": 0.0, "alpha_value": 1.0, "log_alpha_value": 0.0, "target_entropy": -6.0, "policy_t": 0.024575211107730865, "mean_q": -0.0014148392947390676, "max_q": 0.0013636521762236953, "min_q": -0.004725091625005007}, "td_error": [4.4910173416137695, 5.66916561126709, 5.681814670562744, 1.610954999923706, 3.998337745666504, 3.223599910736084, 3.635071277618408, 1.4065892696380615, 4.401877403259277, 5.068482398986816, 3.7538092136383057, 1.021143913269043, 4.082807540893555, 3.8059887886047363, 3.2380447387695312, 3.285304307937622, 3.3575356006622314, 6.094967842102051, 3.880171298980713, 2.777679920196533, 2.3637075424194336, 4.019430160522461, 3.8431835174560547, 3.853182077407837, 1.6984200477600098, 2.532907009124756, 3.9705090522766113, 2.5313687324523926, 4.487311363220215, 3.757561206817627, 5.386646747589111, 6.375286102294922, 3.478151321411133, 3.150021553039551, 3.531184196472168, 4.325243949890137, 1.850710391998291, 2.5397117137908936, 3.9465880393981934, 5.101727485656738, 3.2330026626586914, 2.9372005462646484, 3.4901351928710938, 4.024657726287842, 4.8982648849487305, 3.390566825866699, 3.7345995903015137, 5.507477760314941, 3.3865442276000977, 4.159661293029785, 4.518183708190918, 1.7966477870941162, 1.521162986755371, 4.15443754196167, 3.9546797275543213, 2.919142007827759, 4.399348258972168, 3.8398971557617188, 4.618743419647217, 4.363796234130859, 2.795780897140503, 3.8332629203796387, 2.4370744228363037, 4.174554824829102, 4.332276344299316, 2.9594674110412598, 5.145351409912109, 5.026688575744629, 5.1437482833862305, 2.3520302772521973, 1.4633063077926636, 5.0015716552734375, 3.9068546295166016, 1.9987130165100098, 3.8335933685302734, 4.151741981506348, 2.7330760955810547, 4.485905647277832, 4.110595226287842, 3.9293336868286133, 2.4432220458984375, 4.64259147644043, 4.235461711883545, 3.9874753952026367, 2.261263608932495, 3.7219901084899902], "mean_td_error": 3.688166379928589, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1.0, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 1792, "num_env_steps_trained": 258, "num_agent_steps_sampled": 5376, "num_agent_steps_trained": 258, "last_target_update_ts": 1792, "num_target_updates": 1}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5376, "num_agent_steps_trained": 258, "num_env_steps_sampled": 1792, "num_env_steps_trained": 258, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 389.4556987369026, "num_env_steps_trained_throughput_per_sec": 112.14237753808132, "timesteps_total": 1792, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 5376, "timers": {"training_iteration_time_ms": 2613.677, "sample_time_ms": 1479.782, "load_time_ms": 0.532, "load_throughput": 484608.344, "learn_time_ms": 90.405, "learn_throughput": 2853.817, "synch_weights_time_ms": 14.501}, "counters": {"num_env_steps_sampled": 1792, "num_env_steps_trained": 258, "num_agent_steps_sampled": 5376, "num_agent_steps_trained": 258, "last_target_update_ts": 1792, "num_target_updates": 1}, "done": false, "episodes_total": 0, "training_iteration": 2, "trial_id": "566d8_00000", "date": "2023-11-16_22-20-21", "timestamp": 1700202021, "time_this_iter_s": 2.317509889602661, "time_total_s": 5.247962951660156, "pid": 48481, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fb763906f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 5.247962951660156, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 69.3, "ram_util_percent": 92.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.037561416625977, "actor_loss": -4.047647476196289, "critic_loss": 4.793096542358398, "alpha_loss": -0.003011268563568592, "alpha_value": 0.9997000694274902, "log_alpha_value": -0.0003000000142492354, "target_entropy": -6.0, "policy_t": 0.004729251377284527, "mean_q": 0.011053873226046562, "max_q": 0.01547771506011486, "min_q": 0.007709238212555647}, "td_error": [3.965061664581299, 5.592838287353516, 4.594099044799805, 4.615635395050049, 4.723044395446777, 7.275143623352051, 4.721750259399414, 5.301375865936279, 3.8417794704437256, 6.433287143707275, 6.216154098510742, 4.711947441101074, 4.373787879943848, 7.138577461242676, 4.7418060302734375, 5.836847305297852, 5.102243423461914, 6.04403018951416, 5.224538803100586, 6.5602569580078125, 5.341765403747559, 5.372954845428467, 4.298724174499512, 7.643352508544922, 3.216536521911621, 4.8345947265625, 8.064767837524414, 7.376859664916992, 4.481863498687744, 6.226786136627197, 4.722639560699463, 4.666674613952637, 4.8440351486206055, 7.4947309494018555, 6.898706436157227, 7.087536811828613, 5.582110404968262, 5.656641960144043, 5.898406505584717, 5.704021453857422, 4.5266571044921875, 5.327906608581543, 5.276522636413574, 6.489694595336914, 4.685935020446777, 6.72361421585083, 3.8008029460906982, 5.33162784576416, 7.376604080200195, 5.2001423835754395, 6.205866813659668, 4.648752212524414, 6.286873817443848, 6.537489414215088, 5.7704243659973145, 6.7288079261779785, 5.559660911560059, 6.089411735534668, 3.4433159828186035, 4.5836710929870605, 6.271562576293945, 3.7309682369232178, 4.803526878356934, 3.5306451320648193, 5.5809326171875, 6.143299102783203, 3.491621971130371, 5.204870223999023, 5.589842796325684, 4.3157501220703125, 5.046695232391357, 4.6123762130737305, 6.35723352432251, 5.417353630065918, 7.553415298461914, 7.294629096984863, 4.795932769775391, 5.473991870880127, 5.826718330383301, 6.701744556427002, 3.3647966384887695, 4.266247749328613, 5.118656158447266, 7.6720428466796875, 6.445718765258789, 7.281762599945068], "mean_td_error": 5.522256374359131, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 2.0, "diff_num_grad_updates_vs_sampler_policy": 1.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.04036808013916, "actor_loss": -4.053833484649658, "critic_loss": 3.0552425384521484, "alpha_loss": -0.003012110013514757, "alpha_value": 0.9997000694274902, "log_alpha_value": -0.0002999999560415745, "target_entropy": -6.0, "policy_t": -0.034909654408693314, "mean_q": 0.018197404220700264, "max_q": 0.02404610998928547, "min_q": 0.014280224218964577}, "td_error": [6.407719612121582, 1.3769547939300537, 5.538774013519287, 3.0947742462158203, 1.9072821140289307, 3.013686180114746, 3.865489959716797, 2.847614049911499, 3.2836179733276367, 1.6360468864440918, 3.0004513263702393, 3.5007505416870117, 2.0822994709014893, 3.794341564178467, 3.7127184867858887, 2.0218772888183594, 3.93381929397583, 4.454124450683594, 3.1749792098999023, 2.955427408218384, 3.127788543701172, 2.991665840148926, 1.9300888776779175, 4.538845539093018, 4.133393287658691, 2.597766876220703, 2.84913969039917, 3.2643139362335205, 5.620616912841797, 4.223731994628906, 2.592155933380127, 4.221168518066406, 3.5356006622314453, 3.2096550464630127, 3.448431968688965, 5.014765739440918, 3.3104472160339355, 4.348110198974609, 2.5852742195129395, 4.027904987335205, 4.882409572601318, 3.635085105895996, 3.8802428245544434, 4.860543251037598, 2.725140333175659, 2.640653371810913, 3.6254401206970215, 4.553517818450928, 4.809711456298828, 3.46685791015625, 4.6680755615234375, 2.637540340423584, 3.336726188659668, 3.3799166679382324, 4.546942710876465, 4.636030673980713, 3.811896324157715, 4.257163047790527, 3.4727578163146973, 3.964184284210205, 4.405345916748047, 3.19726300239563, 4.480623245239258, 3.353440761566162, 4.718912124633789, 3.5859994888305664, 4.50369930267334, 4.6540937423706055, 2.759324073791504, 3.5507678985595703, 3.530322551727295, 3.8950581550598145, 2.9049863815307617, 2.813608407974243, 2.728893280029297, 4.2515106201171875, 4.63165283203125, 5.55880069732666, 4.5378007888793945, 3.3400940895080566, 3.809962272644043, 5.312017917633057, 1.304711103439331, 3.0182015895843506, 4.354386329650879, 5.220376491546631], "mean_td_error": 3.667282819747925, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 2.0, "diff_num_grad_updates_vs_sampler_policy": 1.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.104353904724121, "actor_loss": -4.116639614105225, "critic_loss": 3.234442710876465, "alpha_loss": -0.0030313062015920877, "alpha_value": 0.9997000694274902, "log_alpha_value": -0.0003000000142492354, "target_entropy": -6.0, "policy_t": -0.0009940977906808257, "mean_q": 0.013287109322845936, "max_q": 0.017878802493214607, "min_q": 0.010475840419530869}, "td_error": [3.604790687561035, 2.6843719482421875, 3.4119908809661865, 4.137482643127441, 4.582937717437744, 3.8712339401245117, 2.9846715927124023, 5.2760910987854, 3.8690638542175293, 2.842053174972534, 4.34709358215332, 4.707183837890625, 3.9780731201171875, 4.266340732574463, 2.693737506866455, 1.766209363937378, 5.791501998901367, 3.9966201782226562, 5.706146240234375, 3.6452999114990234, 1.3498998880386353, 4.217060089111328, 4.0739545822143555, 3.0333919525146484, 1.1609368324279785, 3.4231152534484863, 2.582982063293457, 3.294301986694336, 2.840388298034668, 2.3169870376586914, 4.057477951049805, 2.2831029891967773, 3.125058650970459, 3.2723026275634766, 2.539666175842285, 5.413572311401367, 5.568442344665527, 3.3606374263763428, 1.9806663990020752, 4.482263565063477, 4.666593074798584, 4.29458475112915, 4.85612678527832, 5.777111530303955, 3.6512866020202637, 4.621500492095947, 4.624028205871582, 3.2953455448150635, 2.2934160232543945, 4.794502258300781, 3.7157325744628906, 4.210325241088867, 2.8591580390930176, 4.429895401000977, 3.1820571422576904, 3.8911824226379395, 3.8541083335876465, 2.9803056716918945, 5.0729169845581055, 4.5507402420043945, 3.037073850631714, 5.680008888244629, 5.116750240325928, 3.7004075050354004, 4.760800361633301, 4.76112174987793, 3.1412103176116943, 4.674413681030273, 4.11550235748291, 3.4995737075805664, 4.514527320861816, 3.3878889083862305, 5.103640556335449, 1.3991880416870117, 3.594451904296875, 2.7692742347717285, 4.593090057373047, 3.0412697792053223, 4.119171142578125, 1.9514191150665283, 4.709694862365723, 2.822906970977783, 3.1111583709716797, 4.354957580566406, 3.586418390274048, 3.834869861602783], "mean_td_error": 3.7621023654937744, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 2.0, "diff_num_grad_updates_vs_sampler_policy": 1.0}}, "num_env_steps_sampled": 2688, "num_env_steps_trained": 516, "num_agent_steps_sampled": 8064, "num_agent_steps_trained": 516, "last_target_update_ts": 2688, "num_target_updates": 2}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8064, "num_agent_steps_trained": 516, "num_env_steps_sampled": 2688, "num_env_steps_trained": 516, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 477.3384231190484, "num_env_steps_trained_throughput_per_sec": 137.44789415704741, "timesteps_total": 2688, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 8064, "timers": {"training_iteration_time_ms": 2368.133, "sample_time_ms": 1420.595, "load_time_ms": 0.524, "load_throughput": 492549.127, "learn_time_ms": 77.808, "learn_throughput": 3315.833, "synch_weights_time_ms": 15.04}, "counters": {"num_env_steps_sampled": 2688, "num_env_steps_trained": 516, "num_agent_steps_sampled": 8064, "num_agent_steps_trained": 516, "last_target_update_ts": 2688, "num_target_updates": 2}, "done": false, "episodes_total": 0, "training_iteration": 3, "trial_id": "566d8_00000", "date": "2023-11-16_22-20-23", "timestamp": 1700202023, "time_this_iter_s": 1.8931279182434082, "time_total_s": 7.1410908699035645, "pid": 48481, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fb7637bab80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 7.1410908699035645, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 66.1, "ram_util_percent": 92.26666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.117574691772461, "actor_loss": -4.13950777053833, "critic_loss": 4.862798690795898, "alpha_loss": -0.006070443894714117, "alpha_value": 0.9994001984596252, "log_alpha_value": -0.0005999900167807937, "target_entropy": -6.0, "policy_t": -0.021899467334151268, "mean_q": 0.02428426221013069, "max_q": 0.03293837606906891, "min_q": 0.01897948980331421}, "td_error": [5.848995208740234, 5.252952575683594, 3.928494930267334, 5.269726276397705, 5.087517738342285, 5.593896865844727, 6.948362827301025, 7.375983238220215, 6.817915916442871, 6.0770721435546875, 6.786904335021973, 3.4556546211242676, 6.747671604156494, 5.371215343475342, 4.191183090209961, 6.8762335777282715, 4.94964599609375, 6.390102863311768, 6.144621849060059, 7.138012886047363, 5.741146564483643, 6.304305076599121, 4.183027744293213, 5.04312801361084, 5.102304458618164, 5.806007385253906, 2.2794504165649414, 6.108956336975098, 7.325277328491211, 6.601077556610107, 6.319416046142578, 5.447544097900391, 4.9314680099487305, 4.558337688446045, 7.618553161621094, 6.407139301300049, 5.0915045738220215, 3.9004435539245605, 4.6579389572143555, 4.72420072555542, 5.839883327484131, 4.316718101501465, 5.753993988037109, 4.179180145263672, 5.189446449279785, 6.278038024902344, 4.12556791305542, 5.390311241149902, 7.32923698425293, 5.5811896324157715, 7.498142242431641, 6.598254680633545, 5.71848201751709, 3.5395941734313965, 6.379818916320801, 6.44197416305542, 5.8548994064331055, 4.811925411224365, 5.902414321899414, 7.148167610168457, 7.190160751342773, 4.466126441955566, 6.263432502746582, 5.330405235290527, 3.4835550785064697, 6.140223026275635, 7.414660453796387, 5.618995189666748, 5.160820960998535, 5.214221000671387, 6.495475769042969, 5.090152740478516, 5.602168560028076, 5.537870407104492, 5.117941856384277, 3.232884168624878, 6.078500270843506, 5.859601974487305, 6.641749382019043, 6.695601463317871, 5.581869125366211, 5.640988349914551, 6.285455226898193, 4.695041656494141, 6.484285831451416, 5.406846046447754], "mean_td_error": 5.639647006988525, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 3.0, "diff_num_grad_updates_vs_sampler_policy": 2.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.142261505126953, "actor_loss": -4.1682305335998535, "critic_loss": 3.064852237701416, "alpha_loss": -0.006086023524403572, "alpha_value": 0.9994001388549805, "log_alpha_value": -0.000600065803155303, "target_entropy": -6.0, "policy_t": -0.030130324885249138, "mean_q": 0.03438671678304672, "max_q": 0.043240565806627274, "min_q": 0.02784407138824463}, "td_error": [3.9247007369995117, 2.1972484588623047, 4.036974906921387, 3.1146979331970215, 5.072684288024902, 1.6129813194274902, 3.5075082778930664, 3.8144850730895996, 3.718568801879883, 4.9536590576171875, 2.2363672256469727, 3.793015480041504, 3.964657783508301, 5.080726623535156, 5.459607124328613, 3.1291537284851074, 4.919034004211426, 6.021596908569336, 4.875296592712402, 4.286052703857422, 3.3914833068847656, 2.8850245475769043, 3.295395851135254, 3.0444624423980713, 4.0882110595703125, 4.243992805480957, 3.1423139572143555, 2.950143814086914, 4.797750473022461, 4.228351593017578, 2.9524550437927246, 3.0991997718811035, 3.049154281616211, 3.776656150817871, 4.580016613006592, 3.9635744094848633, 3.525418519973755, 2.3998055458068848, 5.397038459777832, 5.2816362380981445, 2.910289764404297, 3.968716621398926, 2.681387424468994, 3.1829962730407715, 1.7548861503601074, 3.6640186309814453, 3.3516845703125, 5.541962146759033, 4.940845489501953, 4.335660934448242, 5.616178512573242, 3.6441469192504883, 4.928121566772461, 4.140972137451172, 3.0672402381896973, 3.714588165283203, 4.288309574127197, 3.5722756385803223, 2.921844482421875, 2.800328254699707, 4.293252468109131, 3.0257511138916016, 4.128595352172852, 5.007223129272461, 1.7701215744018555, 3.6543378829956055, 4.043055534362793, 4.410040855407715, 3.267550468444824, 3.0824263095855713, 4.259696006774902, 2.531540870666504, 2.3439745903015137, 2.7258434295654297, 1.9488108158111572, 3.429089069366455, 4.329583644866943, 3.364881992340088, 2.981736660003662, 3.2947325706481934, 3.717963218688965, 3.695291757583618, 2.3478212356567383, 3.216139078140259, 2.456597328186035, 3.0840625762939453], "mean_td_error": 3.66567063331604, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 3.0, "diff_num_grad_updates_vs_sampler_policy": 2.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.134929656982422, "actor_loss": -4.160367012023926, "critic_loss": 3.2002081871032715, "alpha_loss": -0.006080946419388056, "alpha_value": 0.9994001984596252, "log_alpha_value": -0.0005999989225529134, "target_entropy": -6.0, "policy_t": -0.004540516063570976, "mean_q": 0.0285994540899992, "max_q": 0.03587261587381363, "min_q": 0.02172812819480896}, "td_error": [2.7481400966644287, 2.20327091217041, 3.490628719329834, 3.6099681854248047, 1.488844633102417, 2.2444114685058594, 4.183378219604492, 3.7138047218322754, 2.365886926651001, 3.4159646034240723, 3.042109489440918, 5.318916320800781, 3.5853538513183594, 5.23587703704834, 1.513045072555542, 4.075778961181641, 4.1700286865234375, 4.183911323547363, 2.615816354751587, 2.943873643875122, 2.1340413093566895, 5.213562965393066, 3.3117716312408447, 5.306909561157227, 3.9338011741638184, 5.0698347091674805, 3.616326332092285, 2.9002599716186523, 4.053606986999512, 5.281264305114746, 4.2135467529296875, 3.6113319396972656, 2.597386360168457, 2.6090006828308105, 4.502334117889404, 3.115365505218506, 2.844452142715454, 4.16316556930542, 3.8394718170166016, 3.31174635887146, 3.5470805168151855, 4.339771270751953, 4.677548885345459, 3.5542984008789062, 4.653726100921631, 5.095223426818848, 4.6378960609436035, 4.916952133178711, 4.661224365234375, 3.670166492462158, 2.9111828804016113, 4.54586124420166, 4.0869646072387695, 4.617176055908203, 4.148920059204102, 5.617635726928711, 3.0391836166381836, 5.188100814819336, 4.271270751953125, 5.108506202697754, 3.455946683883667, 3.5814008712768555, 4.516069412231445, 3.7103652954101562, 3.7069523334503174, 5.8528571128845215, 4.100264549255371, 4.894309043884277, 4.291539669036865, 3.5096423625946045, 4.7861433029174805, 3.1964468955993652, 2.0596635341644287, 3.1584668159484863, 4.464404106140137, 3.411330461502075, 4.6473894119262695, 3.8042235374450684, 4.184263229370117, 3.5881223678588867, 2.9315714836120605, 3.69043231010437, 2.1162099838256836, 1.6392120122909546, 3.1760716438293457, 3.995260715484619], "mean_td_error": 3.7852959632873535, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 3.0, "diff_num_grad_updates_vs_sampler_policy": 2.0}}, "num_env_steps_sampled": 3584, "num_env_steps_trained": 774, "num_agent_steps_sampled": 10752, "num_agent_steps_trained": 774, "last_target_update_ts": 3584, "num_target_updates": 3}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10752, "num_agent_steps_trained": 774, "num_env_steps_sampled": 3584, "num_env_steps_trained": 774, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 465.6112978836044, "num_env_steps_trained_throughput_per_sec": 134.07111032809144, "timesteps_total": 3584, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 10752, "timers": {"training_iteration_time_ms": 2257.181, "sample_time_ms": 1403.571, "load_time_ms": 0.523, "load_throughput": 493447.529, "learn_time_ms": 73.274, "learn_throughput": 3521.013, "synch_weights_time_ms": 16.179}, "counters": {"num_env_steps_sampled": 3584, "num_env_steps_trained": 774, "num_agent_steps_sampled": 10752, "num_agent_steps_trained": 774, "last_target_update_ts": 3584, "num_target_updates": 3}, "done": false, "episodes_total": 0, "training_iteration": 4, "trial_id": "566d8_00000", "date": "2023-11-16_22-20-25", "timestamp": 1700202025, "time_this_iter_s": 1.9378609657287598, "time_total_s": 9.078951835632324, "pid": 48481, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fb7637ba9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 9.078951835632324, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 63.866666666666674, "ram_util_percent": 92.23333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.995965957641602, "actor_loss": -4.032257556915283, "critic_loss": 4.851367950439453, "alpha_loss": -0.008996963500976562, "alpha_value": 0.9991003274917603, "log_alpha_value": -0.0009000594727694988, "target_entropy": -6.0, "policy_t": 0.026072537526488304, "mean_q": 0.03984799608588219, "max_q": 0.049976252019405365, "min_q": 0.030186684802174568}, "td_error": [3.5022730827331543, 5.245244979858398, 6.939124584197998, 5.267397880554199, 5.1790771484375, 4.39626407623291, 6.781219482421875, 6.391876220703125, 6.053112983703613, 3.6198601722717285, 4.356644630432129, 3.388157844543457, 5.76051139831543, 5.9128570556640625, 6.236570358276367, 7.308376312255859, 5.1010589599609375, 5.367205619812012, 6.453577518463135, 6.162125110626221, 5.973857402801514, 6.110754013061523, 5.043842315673828, 5.88197135925293, 4.5165228843688965, 8.165675163269043, 5.660409927368164, 6.12862491607666, 3.234950065612793, 5.9609575271606445, 4.449100494384766, 5.069072723388672, 6.070581436157227, 5.836124897003174, 6.475665092468262, 4.707211494445801, 4.4506120681762695, 5.400311470031738, 6.048687934875488, 4.750764846801758, 5.4238128662109375, 4.99611759185791, 5.533671855926514, 6.32966947555542, 4.936404228210449, 5.122148513793945, 4.908562660217285, 4.515515327453613, 7.217577934265137, 4.728304862976074, 6.436063766479492, 5.618324279785156, 4.144052982330322, 4.032434463500977, 6.0857086181640625, 5.521149158477783, 5.074460029602051, 5.493090629577637, 4.901477813720703, 5.5097198486328125, 4.797386169433594, 8.556648254394531, 5.200738906860352, 5.570507049560547, 5.112127304077148, 4.533876895904541, 5.8662109375, 4.73255729675293, 6.127060890197754, 5.9056396484375, 6.010394096374512, 5.973158836364746, 6.36132287979126, 6.50316047668457, 4.861955642700195, 5.934898376464844, 4.383050918579102, 6.27253532409668, 5.370303153991699, 6.671597480773926, 6.678883075714111, 4.702068328857422, 7.058115005493164, 4.163492202758789, 7.61607551574707, 6.795001029968262], "mean_td_error": 5.554015159606934, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 4.0, "diff_num_grad_updates_vs_sampler_policy": 3.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.982603073120117, "actor_loss": -4.023359775543213, "critic_loss": 3.2131104469299316, "alpha_loss": -0.008986878208816051, "alpha_value": 0.9991001486778259, "log_alpha_value": -0.0009002539445646107, "target_entropy": -6.0, "policy_t": 0.058324459940195084, "mean_q": 0.04980411008000374, "max_q": 0.06044546142220497, "min_q": 0.039610717445611954}, "td_error": [4.568314075469971, 4.159563064575195, 2.6684064865112305, 4.320289134979248, 2.6186375617980957, 3.717057228088379, 4.582311630249023, 3.700300693511963, 1.5520603656768799, 3.4056200981140137, 3.2639927864074707, 5.071863174438477, 4.185938835144043, 3.9091672897338867, 4.372725486755371, 4.667630195617676, 4.172723770141602, 4.534746170043945, 3.3923516273498535, 3.803548812866211, 3.1064064502716064, 2.3147153854370117, 2.7992684841156006, 4.93504524230957, 3.396718978881836, 3.7998909950256348, 3.267047882080078, 4.510020732879639, 4.094243049621582, 2.983487606048584, 3.7785181999206543, 3.0659945011138916, 4.026549339294434, 5.512803554534912, 4.4043426513671875, 3.508427619934082, 4.857219696044922, 4.148487091064453, 2.629079818725586, 4.686349868774414, 3.2648258209228516, 3.426396369934082, 2.827585220336914, 2.7405529022216797, 4.071673393249512, 5.248035430908203, 4.9325032234191895, 3.9548449516296387, 4.6040754318237305, 3.593602418899536, 4.657734394073486, 3.2513699531555176, 3.04380202293396, 4.149997711181641, 2.8575682640075684, 3.3610148429870605, 3.4079813957214355, 4.066357612609863, 4.6862993240356445, 3.7222847938537598, 2.9491004943847656, 3.579949378967285, 3.9905776977539062, 5.423882484436035, 4.037238121032715, 2.3946242332458496, 2.9589905738830566, 1.4303061962127686, 4.744435787200928, 3.409562587738037, 4.373749256134033, 3.020177125930786, 2.8179550170898438, 5.5623579025268555, 5.058096885681152, 1.470771074295044, 4.4075422286987305, 4.163246154785156, 3.4967846870422363, 3.1520614624023438, 3.9632134437561035, 5.836540222167969, 5.106807708740234, 3.6769111156463623, 3.376518726348877, 3.932786464691162], "mean_td_error": 3.798774242401123, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 4.0, "diff_num_grad_updates_vs_sampler_policy": 3.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.009810447692871, "actor_loss": -4.049638748168945, "critic_loss": 3.02738094329834, "alpha_loss": -0.009009120985865593, "alpha_value": 0.999100387096405, "log_alpha_value": -0.0009000292047858238, "target_entropy": -6.0, "policy_t": -0.008847732096910477, "mean_q": 0.04496432840824127, "max_q": 0.05743767321109772, "min_q": 0.03595687448978424}, "td_error": [4.1376166343688965, 3.696864128112793, 5.701530456542969, 3.0856034755706787, 1.8835952281951904, 3.5038442611694336, 3.625518798828125, 1.614572525024414, 3.858253240585327, 3.067687511444092, 5.548069000244141, 2.739893913269043, 4.011601448059082, 3.2909531593322754, 3.4763994216918945, 2.6419315338134766, 3.9885807037353516, 3.5429787635803223, 3.8970601558685303, 3.5894713401794434, 3.900710105895996, 5.393080711364746, 4.752521514892578, 3.5958971977233887, 3.0817477703094482, 1.9074876308441162, 3.4263806343078613, 3.1739954948425293, 5.245119094848633, 3.2646429538726807, 0.4082027077674866, 3.1081182956695557, 3.4443838596343994, 3.180689811706543, 3.265532970428467, 1.1950976848602295, 3.273524284362793, 5.271203994750977, 4.335915565490723, 4.181009292602539, 3.1159818172454834, 4.355032444000244, 3.7211012840270996, 3.2140564918518066, 4.321249961853027, 3.5154852867126465, 4.227519989013672, 3.1282849311828613, 1.272394061088562, 4.1474103927612305, 2.904397964477539, 3.42142915725708, 4.630309104919434, 3.6484198570251465, 3.3278050422668457, 4.037357807159424, 3.6300621032714844, 4.366220474243164, 3.147207260131836, 4.093988418579102, 3.3886947631835938, 3.1701464653015137, 2.2790281772613525, 5.158363342285156, 3.1226625442504883, 3.176023006439209, 5.372685432434082, 5.588749885559082, 3.7873244285583496, 2.2184910774230957, 4.605240821838379, 3.019861936569214, 3.4887304306030273, 3.9939687252044678, 3.7012109756469727, 3.8567147254943848, 3.1346685886383057, 2.448441505432129, 4.349099636077881, 3.5253682136535645, 3.4890527725219727, 4.455460548400879, 4.693565368652344, 3.896958351135254, 4.240713119506836, 3.339705467224121], "mean_td_error": 3.605045795440674, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 4.0, "diff_num_grad_updates_vs_sampler_policy": 3.0}}, "num_env_steps_sampled": 4480, "num_env_steps_trained": 1032, "num_agent_steps_sampled": 13440, "num_agent_steps_trained": 1032, "last_target_update_ts": 4480, "num_target_updates": 4}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13440, "num_agent_steps_trained": 1032, "num_env_steps_sampled": 4480, "num_env_steps_trained": 1032, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 473.7602887367578, "num_env_steps_trained_throughput_per_sec": 136.4175831407182, "timesteps_total": 4480, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 13440, "timers": {"training_iteration_time_ms": 2183.989, "sample_time_ms": 1388.766, "load_time_ms": 0.525, "load_throughput": 491319.152, "learn_time_ms": 70.674, "learn_throughput": 3650.54, "synch_weights_time_ms": 15.911}, "counters": {"num_env_steps_sampled": 4480, "num_env_steps_trained": 1032, "num_agent_steps_sampled": 13440, "num_agent_steps_trained": 1032, "last_target_update_ts": 4480, "num_target_updates": 4}, "done": false, "episodes_total": 0, "training_iteration": 5, "trial_id": "566d8_00000", "date": "2023-11-16_22-20-27", "timestamp": 1700202027, "time_this_iter_s": 1.9089500904083252, "time_total_s": 10.98790192604065, "pid": 48481, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fb763906280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 10.98790192604065, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 85.8, "ram_util_percent": 92.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.001358985900879, "actor_loss": -4.05034065246582, "critic_loss": 4.83032751083374, "alpha_loss": -0.012001827359199524, "alpha_value": 0.9988006949424744, "log_alpha_value": -0.0012000197311863303, "target_entropy": -6.0, "policy_t": 0.04628390073776245, "mean_q": 0.05449371412396431, "max_q": 0.06984446197748184, "min_q": 0.041760560125112534}, "td_error": [5.12477970123291, 4.530910015106201, 5.975950241088867, 4.319336891174316, 3.5605764389038086, 6.597286224365234, 9.458525657653809, 4.68287992477417, 5.535675048828125, 6.281172752380371, 6.449251651763916, 2.7502570152282715, 6.677425384521484, 5.249951362609863, 4.86226749420166, 5.254964828491211, 6.395123481750488, 6.063114166259766, 6.246569633483887, 4.408645153045654, 4.5028533935546875, 5.860854148864746, 4.344031810760498, 6.670600414276123, 7.545112609863281, 4.936186790466309, 2.5245230197906494, 6.814942359924316, 4.855628967285156, 5.658364772796631, 4.179491996765137, 5.1930694580078125, 7.554955005645752, 7.040365219116211, 3.6977453231811523, 6.016808986663818, 4.275369644165039, 4.124783515930176, 4.868575096130371, 3.4667115211486816, 4.393835067749023, 5.962522983551025, 7.280491352081299, 5.067517280578613, 4.640309810638428, 4.133502960205078, 6.646430969238281, 4.719294548034668, 6.656988143920898, 6.121870040893555, 5.149563312530518, 6.989800453186035, 4.999654769897461, 5.891758441925049, 7.198417663574219, 4.581438064575195, 3.8074095249176025, 4.570682525634766, 6.596498489379883, 5.429286956787109, 6.286159038543701, 5.8150787353515625, 5.845024585723877, 5.234413146972656, 4.53203010559082, 7.0314130783081055, 4.691757678985596, 6.182640075683594, 4.844146251678467, 7.079628944396973, 5.936634063720703, 5.517132759094238, 6.103762149810791, 6.99156379699707, 7.154035568237305, 6.256618499755859, 6.4507551193237305, 3.782480239868164, 4.801545143127441, 5.992244720458984, 8.284979820251465, 6.624300956726074, 6.917731285095215, 6.46004056930542, 7.0136260986328125, 5.553171157836914], "mean_td_error": 5.613672256469727, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 5.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0506010055542, "actor_loss": -4.105644226074219, "critic_loss": 3.0317606925964355, "alpha_loss": -0.012063844129443169, "alpha_value": 0.9988003969192505, "log_alpha_value": -0.0012003106530755758, "target_entropy": -6.0, "policy_t": 0.02128676511347294, "mean_q": 0.067160964012146, "max_q": 0.0824308767914772, "min_q": 0.05339231342077255}, "td_error": [4.470961570739746, 4.190387725830078, 4.402676582336426, 4.009655952453613, 3.6405961513519287, 2.614961624145508, 3.863786220550537, 5.721899032592773, 2.7706310749053955, 3.5132699012756348, 5.281759738922119, 4.153172969818115, 3.5761659145355225, 3.202819585800171, 4.535686492919922, 3.2329893112182617, 4.490707874298096, 6.000265121459961, 5.388764381408691, 2.8037197589874268, 2.883164405822754, 3.682450294494629, 1.5143954753875732, 2.923123836517334, 5.443004131317139, 2.9913692474365234, 5.387598037719727, 2.802191972732544, 3.358963966369629, 3.385880947113037, 2.497958183288574, 1.8302669525146484, 5.105063438415527, 4.0945892333984375, 3.6116535663604736, 3.0048866271972656, 2.771357536315918, 3.6154184341430664, 3.439274311065674, 4.086341381072998, 3.334315299987793, 4.368505001068115, 4.617578983306885, 3.3443422317504883, 2.8012614250183105, 2.2922706604003906, 2.629998207092285, 4.1141557693481445, 2.9664859771728516, 4.656183242797852, 4.019646167755127, 5.059784889221191, 3.2584424018859863, 3.2221436500549316, 1.5397090911865234, 2.7464380264282227, 2.9527201652526855, 3.087496757507324, 5.0416107177734375, 5.686687469482422, 3.6375303268432617, 2.993863582611084, 3.0303406715393066, 1.8036446571350098, 4.473859786987305, 3.705073833465576, 3.2381834983825684, 3.506605863571167, 2.569355010986328, 1.2539892196655273, 5.212517738342285, 4.393931865692139, 3.9390177726745605, 6.632277011871338, 3.1917061805725098, 4.893155574798584, 3.4354612827301025, 2.903714656829834, 4.624574661254883, 2.433133602142334, 4.552330017089844, 5.513425350189209, 3.2420616149902344, 2.665454864501953, 3.4076058864593506, 4.556960582733154], "mean_td_error": 3.6958532333374023, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 5.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.09367561340332, "actor_loss": -4.148621082305908, "critic_loss": 2.575178384780884, "alpha_loss": -0.01211161632090807, "alpha_value": 0.9988008141517639, "log_alpha_value": -0.0011999212438240647, "target_entropy": -6.0, "policy_t": -0.027708228677511215, "mean_q": 0.06144632399082184, "max_q": 0.07413236051797867, "min_q": 0.04687537997961044}, "td_error": [4.48107385635376, 5.595394134521484, 3.8881125450134277, 4.312727928161621, 4.896831512451172, 3.4892756938934326, 1.6842604875564575, 4.4606122970581055, 2.3104562759399414, 2.312715768814087, 6.382168769836426, 3.7106246948242188, 3.782453775405884, 3.470151424407959, 4.48909854888916, 3.200223922729492, 4.2078680992126465, 5.257508277893066, 2.0583040714263916, 3.4161622524261475, 1.4524197578430176, 4.6158246994018555, 2.120551586151123, 4.020354270935059, 2.8797340393066406, 3.224863052368164, 6.2679443359375, 4.173863410949707, 5.3829193115234375, 4.3570146560668945, 5.13071346282959, 5.568805694580078, 5.182435035705566, 4.29295539855957, 3.895446300506592, 2.876953601837158, 1.852916955947876, 4.994016647338867, 1.917152762413025, 2.768080949783325, 4.680771827697754, 5.136363983154297, 2.561483383178711, 3.4597885608673096, 4.423862934112549, 4.9372100830078125, 2.032480001449585, 5.127290725708008, 4.911808967590332, 2.9557111263275146, 2.060865879058838, 1.9951450824737549, 3.752505302429199, 5.452281951904297, 4.940769672393799, 2.8246846199035645, 3.3161115646362305, 3.356675386428833, 2.346912384033203, 5.760361671447754, 4.507645606994629, 4.082193374633789, 5.200668811798096, 2.7337427139282227, 3.8691048622131348, 3.7097766399383545, 3.724701404571533, 3.859863042831421, 1.2942702770233154, 4.714330673217773, 3.7974021434783936, 4.565728187561035, 3.9362783432006836, 3.764497756958008, 4.591907501220703, 5.076936721801758, 3.551750659942627, 4.555247783660889, 3.4294943809509277, 5.033858299255371, 1.8851127624511719, 4.4601240158081055, 3.870400905609131, 4.774656295776367, 4.231914520263672, 3.490281105041504], "mean_td_error": 3.8735575675964355, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 5.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 5376, "num_env_steps_trained": 1290, "num_agent_steps_sampled": 16128, "num_agent_steps_trained": 1290, "last_target_update_ts": 5376, "num_target_updates": 5}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16128, "num_agent_steps_trained": 1290, "num_env_steps_sampled": 5376, "num_env_steps_trained": 1290, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 441.4715054367854, "num_env_steps_trained_throughput_per_sec": 127.12014330657436, "timesteps_total": 5376, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 16128, "timers": {"training_iteration_time_ms": 2158.246, "sample_time_ms": 1364.097, "load_time_ms": 0.53, "load_throughput": 487051.234, "learn_time_ms": 69.215, "learn_throughput": 3727.492, "synch_weights_time_ms": 15.904}, "counters": {"num_env_steps_sampled": 5376, "num_env_steps_trained": 1290, "num_agent_steps_sampled": 16128, "num_agent_steps_trained": 1290, "last_target_update_ts": 5376, "num_target_updates": 5}, "done": false, "episodes_total": 0, "training_iteration": 6, "trial_id": "566d8_00000", "date": "2023-11-16_22-20-29", "timestamp": 1700202029, "time_this_iter_s": 2.046700954437256, "time_total_s": 13.034602880477905, "pid": 48481, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fb7637bab80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 13.034602880477905, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 58.96666666666667, "ram_util_percent": 92.23333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.10866641998291, "actor_loss": -4.172379016876221, "critic_loss": 5.005908489227295, "alpha_loss": -0.015162241645157337, "alpha_value": 0.998501181602478, "log_alpha_value": -0.0014999249251559377, "target_entropy": -6.0, "policy_t": -0.0210694819688797, "mean_q": 0.07066408544778824, "max_q": 0.08738075941801071, "min_q": 0.05373988300561905}, "td_error": [5.8434295654296875, 6.399260520935059, 4.089824676513672, 7.296997547149658, 7.3672776222229, 7.056920528411865, 4.204900741577148, 6.685978889465332, 5.835338592529297, 6.905957221984863, 5.2620649337768555, 5.914128303527832, 7.352126598358154, 7.834089279174805, 5.784937858581543, 5.629232406616211, 4.87975549697876, 6.054352760314941, 6.569035530090332, 5.060826301574707, 4.562483787536621, 5.1599225997924805, 5.393399238586426, 3.1500730514526367, 6.573027610778809, 5.90593957901001, 5.200060844421387, 4.965856552124023, 5.533244609832764, 7.180994033813477, 5.795738220214844, 5.530092239379883, 5.652420997619629, 5.826112747192383, 7.590948104858398, 4.800863265991211, 5.596721172332764, 4.5566606521606445, 6.5456037521362305, 4.874608993530273, 5.081045150756836, 5.526639938354492, 4.7386627197265625, 5.133634567260742, 6.851628303527832, 5.001519203186035, 7.954921722412109, 5.463644981384277, 5.314006805419922, 5.9842987060546875, 5.869444370269775, 5.42400598526001, 4.7925615310668945, 5.673483848571777, 7.953581809997559, 7.851912498474121, 5.611203670501709, 4.958550930023193, 6.125466823577881, 6.632709503173828, 6.143532752990723, 6.610725402832031, 4.411935806274414, 5.3679046630859375, 4.118950843811035, 4.42646598815918, 7.095954895019531, 6.970033168792725, 6.224605560302734, 6.392212390899658, 5.475897789001465, 4.783471584320068, 6.654415130615234, 6.317314147949219, 3.4769155979156494, 4.82663631439209, 5.849346160888672, 4.779287338256836, 5.111310958862305, 5.707390785217285, 5.926704406738281, 5.905287742614746, 4.72578239440918, 4.736294269561768, 6.764411449432373, 4.002784729003906], "mean_td_error": 5.734531402587891, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 6.0, "diff_num_grad_updates_vs_sampler_policy": 5.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.109540939331055, "actor_loss": -4.179680824279785, "critic_loss": 3.0490260124206543, "alpha_loss": -0.015168161131441593, "alpha_value": 0.9985007643699646, "log_alpha_value": -0.0015003806911408901, "target_entropy": -6.0, "policy_t": 0.04246008023619652, "mean_q": 0.08654896169900894, "max_q": 0.10456826537847519, "min_q": 0.07205479592084885}, "td_error": [5.330441474914551, 3.6737451553344727, 4.087367057800293, 2.686081886291504, 3.6659889221191406, 4.856440544128418, 2.449101448059082, 2.9225502014160156, 5.144588470458984, 3.3252272605895996, 2.734130382537842, 5.410971164703369, 1.1644691228866577, 5.208702087402344, 5.950289726257324, 3.823340654373169, 4.190069675445557, 4.81146240234375, 2.560182571411133, 3.668402671813965, 2.952702522277832, 5.998260974884033, 4.282562255859375, 3.916430950164795, 4.6525983810424805, 1.7968151569366455, 3.180748462677002, 4.553824424743652, 4.136839389801025, 2.7493810653686523, 3.65478515625, 4.541121006011963, 3.7503910064697266, 4.855781078338623, 3.21822452545166, 1.905318260192871, 5.4845476150512695, 4.0393877029418945, 2.7317328453063965, 4.015441417694092, 5.720588684082031, 3.2311384677886963, 3.2445101737976074, 4.5193071365356445, 3.9620842933654785, 3.2139387130737305, 5.276585578918457, 2.779122829437256, 4.785331726074219, 2.3982887268066406, 4.387317657470703, 2.8054065704345703, 3.3600564002990723, 2.8076975345611572, 5.2095794677734375, 2.5724239349365234, 2.854224681854248, 1.8633350133895874, 4.566873073577881, 2.6205477714538574, 3.3608200550079346, 4.831137657165527, 4.054986953735352, 4.845303058624268, 5.318687915802002, 4.299623489379883, 2.234092950820923, 3.367117404937744, 4.285348892211914, 4.004932880401611, 4.414915084838867, 2.7703857421875, 0.8718329668045044, 2.780913829803467, 4.656362533569336, 2.767551898956299, 2.4601330757141113, 2.5898215770721436, 3.060352087020874, 1.5584731101989746, 3.4745850563049316, 3.0581836700439453, 2.4413223266601562, 3.864931344985962, 4.246722221374512, 4.411813735961914], "mean_td_error": 3.677780866622925, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 6.0, "diff_num_grad_updates_vs_sampler_policy": 5.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.979339599609375, "actor_loss": -4.053213119506836, "critic_loss": 2.6227002143859863, "alpha_loss": -0.014967473223805428, "alpha_value": 0.9985013008117676, "log_alpha_value": -0.001499845995567739, "target_entropy": -6.0, "policy_t": -0.01523504313081503, "mean_q": 0.08071241527795792, "max_q": 0.1067100316286087, "min_q": 0.0625329315662384}, "td_error": [3.09765625, 3.800548791885376, 1.6141893863677979, 3.5787062644958496, 3.738067150115967, 5.040213584899902, 4.363243579864502, 4.8219404220581055, 3.030816078186035, 3.8967814445495605, 6.251191139221191, 3.1163554191589355, 5.944003105163574, 3.895066261291504, 3.6633496284484863, 4.274408340454102, 3.5866174697875977, 4.029206275939941, 2.9777631759643555, 4.2831597328186035, 3.8089985847473145, 3.4892630577087402, 3.0369503498077393, 3.583643674850464, 4.028044700622559, 4.827753067016602, 5.453845024108887, 3.8622517585754395, 2.7748093605041504, 6.3708415031433105, 3.593339443206787, 5.307133674621582, 5.403687477111816, 3.4024715423583984, 2.9667763710021973, 3.137352466583252, 2.9502410888671875, 4.533318519592285, 4.182197570800781, 3.4792258739471436, 3.7512264251708984, 2.771056652069092, 5.419222354888916, 4.094387531280518, 4.993010520935059, 4.033573150634766, 3.0522594451904297, 5.135587692260742, 4.3110737800598145, 2.6410045623779297, 1.822389841079712, 2.593512773513794, 2.50449538230896, 1.709457278251648, 4.748451232910156, 4.378741264343262, 4.582633972167969, 3.6403539180755615, 4.62364387512207, 3.916412830352783, 2.6611218452453613, 2.4647023677825928, 4.519303321838379, 2.6099085807800293, 3.3034143447875977, 3.7970714569091797, 4.759180545806885, 3.816688060760498, 5.150022506713867, 3.782247543334961, 4.096429347991943, 4.860513210296631, 4.414735794067383, 3.6556787490844727, 4.30197811126709, 5.543605804443359, 3.949683666229248, 2.0824365615844727, 4.254824161529541, 4.353673934936523, 3.5420403480529785, 4.564528465270996, 3.50136661529541, 3.3217062950134277, 2.9598989486694336, 2.8106017112731934], "mean_td_error": 3.8720381259918213, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 6.0, "diff_num_grad_updates_vs_sampler_policy": 5.0}}, "num_env_steps_sampled": 6272, "num_env_steps_trained": 1548, "num_agent_steps_sampled": 18816, "num_agent_steps_trained": 1548, "last_target_update_ts": 6272, "num_target_updates": 6}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18816, "num_agent_steps_trained": 1548, "num_env_steps_sampled": 6272, "num_env_steps_trained": 1548, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 454.8643864723073, "num_env_steps_trained_throughput_per_sec": 130.9765755690349, "timesteps_total": 6272, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 18816, "timers": {"training_iteration_time_ms": 2131.324, "sample_time_ms": 1366.522, "load_time_ms": 0.529, "load_throughput": 487922.341, "learn_time_ms": 68.842, "learn_throughput": 3747.737, "synch_weights_time_ms": 17.315}, "counters": {"num_env_steps_sampled": 6272, "num_env_steps_trained": 1548, "num_agent_steps_sampled": 18816, "num_agent_steps_trained": 1548, "last_target_update_ts": 6272, "num_target_updates": 6}, "done": false, "episodes_total": 0, "training_iteration": 7, "trial_id": "566d8_00000", "date": "2023-11-16_22-20-31", "timestamp": 1700202031, "time_this_iter_s": 1.988245964050293, "time_total_s": 15.022848844528198, "pid": 48481, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fb780e85d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 15.022848844528198, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 71.13333333333334, "ram_util_percent": 92.26666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.127087593078613, "actor_loss": -4.205081462860107, "critic_loss": 4.817312240600586, "alpha_loss": -0.018228186294436455, "alpha_value": 0.9982016682624817, "log_alpha_value": -0.0017999435076490045, "target_entropy": -6.0, "policy_t": 0.05027949810028076, "mean_q": 0.08795217424631119, "max_q": 0.11038830876350403, "min_q": 0.06998006999492645}, "td_error": [6.020798206329346, 4.670367240905762, 6.283599853515625, 5.031459331512451, 6.619048595428467, 5.702988624572754, 6.780581474304199, 6.020749092102051, 6.1202392578125, 6.749357223510742, 7.393966197967529, 4.575010299682617, 6.345027446746826, 5.499086856842041, 7.522165775299072, 6.860028266906738, 6.045126914978027, 5.6096906661987305, 6.353570938110352, 4.73713493347168, 6.606201171875, 4.738263130187988, 4.082955360412598, 4.086751937866211, 5.611441612243652, 7.169442176818848, 5.257919788360596, 6.28798770904541, 4.875587463378906, 4.324305057525635, 5.369436264038086, 4.12531042098999, 6.749234199523926, 5.4053215980529785, 8.46528434753418, 4.742629051208496, 6.4193830490112305, 5.209017276763916, 5.690528869628906, 4.31913423538208, 6.696653366088867, 4.406589984893799, 4.835453510284424, 5.751416206359863, 5.418701171875, 4.80974006652832, 6.193920612335205, 6.258254528045654, 4.501527309417725, 6.404448509216309, 5.871652603149414, 7.287333965301514, 3.9608728885650635, 4.536664009094238, 4.875877380371094, 5.10507869720459, 4.921728134155273, 5.153308868408203, 5.9876580238342285, 6.140430450439453, 5.18305778503418, 4.230875492095947, 7.486199855804443, 5.8555121421813965, 4.16994571685791, 7.8126115798950195, 5.777717590332031, 4.811310768127441, 6.5718231201171875, 4.171594142913818, 6.840519428253174, 4.381810188293457, 9.129354476928711, 5.346999168395996, 4.402222633361816, 5.631748676300049, 7.298491954803467, 4.923901081085205, 5.1046600341796875, 4.030028343200684, 6.548051834106445, 4.092807292938232, 3.861443519592285, 6.37653923034668, 7.644778251647949, 4.782559394836426], "mean_td_error": 5.651860237121582, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 7.0, "diff_num_grad_updates_vs_sampler_policy": 6.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.09783935546875, "actor_loss": -4.186236381530762, "critic_loss": 3.075860023498535, "alpha_loss": -0.018181554973125458, "alpha_value": 0.9982010722160339, "log_alpha_value": -0.0018005392048507929, "target_entropy": -6.0, "policy_t": 0.011243127286434174, "mean_q": 0.10704805701971054, "max_q": 0.1243225559592247, "min_q": 0.09054645150899887}, "td_error": [3.0580921173095703, 4.85930061340332, 4.267941474914551, 4.95050048828125, 5.225584030151367, 4.132319450378418, 1.3585724830627441, 3.438706874847412, 2.019118309020996, 3.9183602333068848, 4.767280578613281, 4.26387882232666, 3.4659790992736816, 3.8259668350219727, 2.398129463195801, 5.138954162597656, 3.8769683837890625, 3.6077682971954346, 5.254171848297119, 4.303356170654297, 6.342418670654297, 3.561765670776367, 3.1632959842681885, 5.310362815856934, 1.1788687705993652, 4.669054985046387, 4.450714588165283, 3.2325215339660645, 2.9848036766052246, 5.293886184692383, 3.618762493133545, 3.957589864730835, 5.370181560516357, 3.3296992778778076, 2.423560619354248, 3.105536937713623, 5.601405143737793, 4.117031097412109, 2.1453962326049805, 3.0523886680603027, 2.6506741046905518, 3.654176712036133, 2.072803497314453, 4.26115083694458, 3.83211350440979, 4.662290573120117, 4.763454914093018, 4.503179550170898, 4.986380577087402, 2.3377795219421387, 4.934595108032227, 3.370493173599243, 2.881112813949585, 4.026351451873779, 5.92122220993042, 2.9346132278442383, 5.061690330505371, 2.587249517440796, 2.5712900161743164, 1.5003001689910889, 2.3373498916625977, 4.22302770614624, 4.418561935424805, 3.901087522506714, 3.473891019821167, 4.804910659790039, 5.467521667480469, 4.638208389282227, 4.30424165725708, 5.564784049987793, 2.658189296722412, 3.7510528564453125, 3.6537513732910156, 2.069049835205078, 3.185209274291992, 4.77147102355957, 4.7454657554626465, 2.577331066131592, 4.677996635437012, 4.685604095458984, 3.114314079284668, 3.084794044494629, 3.145305633544922, 5.671963691711426, 3.1441421508789062, 2.481346607208252], "mean_td_error": 3.826787233352661, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 7.0, "diff_num_grad_updates_vs_sampler_policy": 6.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.106414794921875, "actor_loss": -4.19680643081665, "critic_loss": 2.455625534057617, "alpha_loss": -0.01818782277405262, "alpha_value": 0.9982019662857056, "log_alpha_value": -0.001799631747417152, "target_entropy": -6.0, "policy_t": 0.03756839781999588, "mean_q": 0.09816630184650421, "max_q": 0.12173860520124435, "min_q": 0.07881010323762894}, "td_error": [3.4798483848571777, 3.1834473609924316, 4.542783260345459, 4.137428283691406, 3.3842673301696777, 3.9805750846862793, 2.602201223373413, 1.0447523593902588, 4.707096099853516, 4.672097206115723, 5.08854866027832, 3.4106249809265137, 2.6831090450286865, 4.9183149337768555, 4.705992221832275, 4.107165813446045, 2.602113723754883, 3.71787166595459, 2.8709020614624023, 4.015827655792236, 5.991474151611328, 4.0723090171813965, 3.3332161903381348, 3.7953081130981445, 3.9167392253875732, 4.268259048461914, 2.273956537246704, 3.9121625423431396, 4.411694526672363, 3.5575151443481445, 1.9519374370574951, 3.8382785320281982, 3.058621406555176, 4.392280578613281, 2.4308552742004395, 3.6854281425476074, 2.891178846359253, 3.8237764835357666, 0.6160011291503906, 3.4485769271850586, 2.7363739013671875, 1.8339422941207886, 4.267152786254883, 2.3572616577148438, 3.333014965057373, 3.0456466674804688, 4.036473751068115, 4.514995098114014, 5.510379314422607, 5.267136573791504, 4.715754508972168, 2.7131447792053223, 2.1105849742889404, 4.539956092834473, 4.957976818084717, 4.506923675537109, 1.7964727878570557, 4.184835433959961, 2.7900540828704834, 4.870623588562012, 4.749530792236328, 4.215324401855469, 4.833170413970947, 2.748075485229492, 4.053505897521973, 2.3731231689453125, 3.175426483154297, 0.8992406129837036, 5.394082069396973, 3.7357778549194336, 4.010858535766602, 2.9828543663024902, 4.463168144226074, 3.892090320587158, 4.403075218200684, 3.8667032718658447, 4.073554992675781, 3.76511287689209, 3.910824775695801, 2.994277000427246, 4.350678443908691, 4.2460479736328125, 2.8825716972351074, 2.8707313537597656, 1.5285534858703613, 2.961057186126709], "mean_td_error": 3.616194009780884, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 7.0, "diff_num_grad_updates_vs_sampler_policy": 6.0}}, "num_env_steps_sampled": 7168, "num_env_steps_trained": 1806, "num_agent_steps_sampled": 21504, "num_agent_steps_trained": 1806, "last_target_update_ts": 7168, "num_target_updates": 7}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 21504, "num_agent_steps_trained": 1806, "num_env_steps_sampled": 7168, "num_env_steps_trained": 1806, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 442.3171012142223, "num_env_steps_trained_throughput_per_sec": 127.3636295907024, "timesteps_total": 7168, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 21504, "timers": {"training_iteration_time_ms": 2118.113, "sample_time_ms": 1376.417, "load_time_ms": 0.53, "load_throughput": 486819.603, "learn_time_ms": 68.529, "learn_throughput": 3764.826, "synch_weights_time_ms": 17.388}, "counters": {"num_env_steps_sampled": 7168, "num_env_steps_trained": 1806, "num_agent_steps_sampled": 21504, "num_agent_steps_trained": 1806, "last_target_update_ts": 7168, "num_target_updates": 7}, "done": false, "episodes_total": 0, "training_iteration": 8, "trial_id": "566d8_00000", "date": "2023-11-16_22-20-33", "timestamp": 1700202033, "time_this_iter_s": 2.0422632694244385, "time_total_s": 17.065112113952637, "pid": 48481, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fb763906c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 17.065112113952637, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 73.0, "ram_util_percent": 92.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.051959037780762, "actor_loss": -4.148324489593506, "critic_loss": 4.8849687576293945, "alpha_loss": -0.021109778434038162, "alpha_value": 0.9979021549224854, "log_alpha_value": -0.002100065816193819, "target_entropy": -6.0, "policy_t": 0.03730325028300285, "mean_q": 0.10758134722709656, "max_q": 0.14258965849876404, "min_q": 0.08451709896326065}, "td_error": [5.58614444732666, 7.02961540222168, 3.9373772144317627, 5.045422554016113, 6.034282684326172, 6.07375431060791, 6.534005641937256, 4.793275833129883, 7.357536315917969, 5.774500846862793, 7.712709426879883, 5.801694869995117, 6.992404460906982, 4.34715461730957, 5.8343586921691895, 5.745201110839844, 5.728080749511719, 5.959952354431152, 5.135298252105713, 5.044098854064941, 4.597383975982666, 5.681093215942383, 4.54136323928833, 6.7219085693359375, 5.143099784851074, 6.987409591674805, 6.2582807540893555, 5.161249160766602, 4.555667877197266, 5.98797082901001, 5.799257755279541, 4.050614833831787, 5.44844913482666, 4.967858791351318, 7.755696773529053, 7.100485801696777, 6.44603157043457, 6.299272537231445, 5.324894905090332, 5.000816345214844, 6.647759437561035, 3.2033262252807617, 2.970388889312744, 5.453528881072998, 6.572223663330078, 7.348788738250732, 4.5423583984375, 5.180397033691406, 6.939462184906006, 6.595829010009766, 5.517910957336426, 6.8376545906066895, 7.8465986251831055, 5.254549503326416, 6.007540702819824, 5.784302711486816, 5.670788764953613, 4.717253684997559, 5.709012985229492, 6.281853675842285, 5.286472320556641, 5.9861931800842285, 6.808255672454834, 5.526738166809082, 7.518915176391602, 5.884374618530273, 4.995669841766357, 5.01345157623291, 5.455924987792969, 5.526183128356934, 4.664577484130859, 6.582053184509277, 4.088584899902344, 5.397631645202637, 6.095848560333252, 6.623857498168945, 6.1333088874816895, 3.4992318153381348, 5.203414440155029, 5.811129093170166, 4.695270538330078, 4.292160987854004, 5.956442356109619, 6.407112121582031, 4.842185974121094, 4.207537651062012], "mean_td_error": 5.673019886016846, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 8.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.065102577209473, "actor_loss": -4.173341274261475, "critic_loss": 3.1072514057159424, "alpha_loss": -0.02114417403936386, "alpha_value": 0.997901439666748, "log_alpha_value": -0.0021007407922297716, "target_entropy": -6.0, "policy_t": 0.03685571253299713, "mean_q": 0.12862318754196167, "max_q": 0.15034659206867218, "min_q": 0.10339204221963882}, "td_error": [2.2102227210998535, 3.1714425086975098, 5.918900489807129, 3.2561299800872803, 3.4539549350738525, 5.109918594360352, 5.5143232345581055, 3.3606014251708984, 4.378003120422363, 5.551758766174316, 5.333304405212402, 3.1619458198547363, 5.044615745544434, 1.9890501499176025, 3.8179492950439453, 6.012308597564697, 3.4133172035217285, 2.6513924598693848, 4.466978073120117, 4.6162109375, 3.917585849761963, 4.581907272338867, 4.010601997375488, 3.6852142810821533, 4.687041282653809, 3.5596487522125244, 2.4487533569335938, 4.476540565490723, 4.268918037414551, 2.6010427474975586, 2.953667640686035, 3.067681312561035, 2.432952404022217, 3.4959373474121094, 4.078448295593262, 5.17950439453125, 4.729217052459717, 3.255451202392578, 3.863548994064331, 1.7988170385360718, 2.458080768585205, 5.779062271118164, 1.9794516563415527, 4.173131942749023, 2.541456937789917, 4.189441680908203, 3.0076961517333984, 3.27321195602417, 4.454779624938965, 2.0968518257141113, 3.8822250366210938, 2.9298300743103027, 2.1744208335876465, 2.715195655822754, 2.094424247741699, 2.8575611114501953, 3.699220657348633, 3.7880501747131348, 3.649419069290161, 5.1393232345581055, 4.908419609069824, 2.4085402488708496, 6.138316631317139, 3.924802780151367, 5.617074966430664, 1.4104893207550049, 5.0688300132751465, 3.279766798019409, 3.562856912612915, 3.821889877319336, 4.835005760192871, 2.806988000869751, 3.5849716663360596, 4.639427185058594, 5.440541744232178, 4.132610321044922, 3.413578987121582, 4.943617820739746, 5.307374000549316, 3.601979970932007, 2.33662748336792, 3.2108826637268066, 4.184347152709961, 3.9867773056030273, 3.221811056137085, 3.539523124694824], "mean_td_error": 3.7876126766204834, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 8.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.110207557678223, "actor_loss": -4.220209121704102, "critic_loss": 2.5172483921051025, "alpha_loss": -0.02122647315263748, "alpha_value": 0.9979026913642883, "log_alpha_value": -0.002099508885294199, "target_entropy": -6.0, "policy_t": 0.0313781201839447, "mean_q": 0.12227129191160202, "max_q": 0.15981212258338928, "min_q": 0.0949910581111908}, "td_error": [4.331429481506348, 5.15158748626709, 3.084449529647827, 3.6483404636383057, 3.0838379859924316, 3.729015827178955, 3.91278076171875, 4.701503276824951, 3.8933026790618896, 5.134976387023926, 4.006737232208252, 4.429814338684082, 3.1608591079711914, 4.075683116912842, 5.966524600982666, 6.7545576095581055, 2.6840028762817383, 4.653224945068359, 3.9053397178649902, 5.579850673675537, 2.558971405029297, 4.9927825927734375, 3.515615701675415, 3.151599407196045, 4.037431716918945, 2.6608810424804688, 3.6274313926696777, 3.6327643394470215, 3.196316719055176, 2.22872257232666, 3.4065566062927246, 3.6137471199035645, 2.1467576026916504, 3.820704460144043, 3.6518068313598633, 4.8621826171875, 2.5851948261260986, 3.194552183151245, 0.12001965939998627, 3.37656307220459, 3.435875654220581, 3.1356844902038574, 3.07320499420166, 4.731960296630859, 5.305461883544922, 5.888092517852783, 4.937849044799805, 4.3450212478637695, 5.470404624938965, 3.3246889114379883, 0.5892338752746582, 3.7097721099853516, 2.4867396354675293, 2.112684726715088, 6.376856803894043, 4.592695713043213, 5.460482597351074, 2.761655330657959, 4.3944091796875, 2.3320932388305664, 2.9840750694274902, 4.560311794281006, 3.4540984630584717, 2.2145848274230957, 4.317781925201416, 2.519714593887329, 3.632742404937744, 4.55213737487793, 4.732200622558594, 2.1462326049804688, 3.000427484512329, 3.3977184295654297, 4.133108139038086, 3.2760837078094482, 5.138474464416504, 4.682527542114258, 4.312198162078857, 3.8304076194763184, 2.5334434509277344, 4.155109405517578, 5.622849464416504, 3.6138663291931152, 3.5333309173583984, 2.9802865982055664, 2.3673348426818848, 3.165921688079834], "mean_td_error": 3.7626771926879883, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 8.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 8064, "num_env_steps_trained": 2064, "num_agent_steps_sampled": 24192, "num_agent_steps_trained": 2064, "last_target_update_ts": 8064, "num_target_updates": 8}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24192, "num_agent_steps_trained": 2064, "num_env_steps_sampled": 8064, "num_env_steps_trained": 2064, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 468.10932949853924, "num_env_steps_trained_throughput_per_sec": 134.79040961007044, "timesteps_total": 8064, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 24192, "timers": {"training_iteration_time_ms": 2095.438, "sample_time_ms": 1371.946, "load_time_ms": 0.529, "load_throughput": 487418.696, "learn_time_ms": 67.821, "learn_throughput": 3804.12, "synch_weights_time_ms": 17.028}, "counters": {"num_env_steps_sampled": 8064, "num_env_steps_trained": 2064, "num_agent_steps_sampled": 24192, "num_agent_steps_trained": 2064, "last_target_update_ts": 8064, "num_target_updates": 8}, "done": false, "episodes_total": 0, "training_iteration": 9, "trial_id": "566d8_00000", "date": "2023-11-16_22-20-35", "timestamp": 1700202035, "time_this_iter_s": 1.930053949356079, "time_total_s": 18.995166063308716, "pid": 48481, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fb7638cfee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 18.995166063308716, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 67.6, "ram_util_percent": 92.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.095967292785645, "actor_loss": -4.212085723876953, "critic_loss": 4.833309650421143, "alpha_loss": -0.024231841787695885, "alpha_value": 0.9976027011871338, "log_alpha_value": -0.0024001505225896835, "target_entropy": -6.0, "policy_t": -0.005655876360833645, "mean_q": 0.1253197193145752, "max_q": 0.1729191541671753, "min_q": 0.09604071080684662}, "td_error": [6.402944564819336, 5.661709785461426, 7.011116981506348, 6.152814865112305, 3.9444456100463867, 4.400485992431641, 5.646675109863281, 5.092720031738281, 4.821910858154297, 3.948709487915039, 5.035393714904785, 6.249087810516357, 6.813113689422607, 5.779689311981201, 6.600955009460449, 6.191416263580322, 4.946381092071533, 6.379345893859863, 6.345025062561035, 4.34857177734375, 7.987419128417969, 4.873958110809326, 5.5410261154174805, 6.419008255004883, 5.964883327484131, 6.864893913269043, 5.8589067459106445, 4.72884464263916, 7.099783897399902, 5.344964027404785, 6.195915222167969, 6.527604103088379, 6.054845809936523, 6.156333923339844, 5.71677303314209, 6.061022758483887, 4.574364185333252, 5.627396583557129, 5.883886337280273, 4.970900535583496, 5.082523822784424, 6.33846378326416, 4.1275177001953125, 5.185168266296387, 5.298155307769775, 4.820291996002197, 5.082815170288086, 4.945130825042725, 6.451898097991943, 6.749145030975342, 6.803948879241943, 4.335930824279785, 7.483404159545898, 5.563611030578613, 3.4540836811065674, 3.619567394256592, 6.6557207107543945, 7.546362400054932, 6.578051567077637, 5.480160713195801, 4.193018436431885, 5.790241718292236, 4.803145885467529, 5.599575519561768, 6.426929473876953, 5.810204982757568, 3.9598469734191895, 5.582903861999512, 5.039017677307129, 5.640181541442871, 5.554219722747803, 6.027860641479492, 6.70640230178833, 5.0721940994262695, 6.145870685577393, 5.34681510925293, 8.095629692077637, 5.028334140777588, 5.190119743347168, 6.040488243103027, 4.120102882385254, 6.414663314819336, 6.072358131408691, 1.7340248823165894, 6.705124855041504, 4.460439682006836], "mean_td_error": 5.6207780838012695, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 9.0, "diff_num_grad_updates_vs_sampler_policy": 8.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.081160545349121, "actor_loss": -4.211861610412598, "critic_loss": 2.883707046508789, "alpha_loss": -0.02420409582555294, "alpha_value": 0.9976019859313965, "log_alpha_value": -0.0024009235203266144, "target_entropy": -6.0, "policy_t": 0.03762546181678772, "mean_q": 0.15416528284549713, "max_q": 0.18829567730426788, "min_q": 0.12564517557621002}, "td_error": [2.420355796813965, 2.0993571281433105, 4.37619686126709, 2.4041738510131836, 3.521061897277832, 2.6599371433258057, 2.756274700164795, 5.613409042358398, 1.315316915512085, 1.953981637954712, 4.245650768280029, 5.065759658813477, 6.215153694152832, 4.576498985290527, 3.9822444915771484, 4.338508129119873, 2.72249436378479, 4.966676712036133, 2.5487167835235596, 4.453894138336182, 2.260840892791748, 4.034198760986328, 3.5540809631347656, 3.7075178623199463, 4.570926666259766, 3.1221518516540527, 2.7100374698638916, 2.1492111682891846, 4.9214630126953125, 3.045668363571167, 3.949976921081543, 4.147895812988281, 3.5648794174194336, 4.779302597045898, 3.75286602973938, 1.7668559551239014, 2.5339787006378174, 3.5431604385375977, 3.1470961570739746, 1.9124808311462402, 2.677593469619751, 3.857300281524658, 4.790627956390381, 2.94238543510437, 3.7061381340026855, 4.830016136169434, 2.467095375061035, 3.3685262203216553, 5.062564849853516, 2.9334545135498047, 5.262183666229248, 4.620987892150879, 3.670722007751465, 2.842172384262085, 3.1239776611328125, 4.082371711730957, 3.032318115234375, 4.297266006469727, 3.1384687423706055, 4.777862548828125, 3.2042927742004395, 3.194632053375244, 3.3014590740203857, 4.219273567199707, 2.983964204788208, 3.3691792488098145, 3.020629405975342, 3.272268533706665, 3.030080795288086, 3.7000889778137207, 5.120702266693115, 2.927651882171631, 3.933688163757324, 4.030210971832275, 3.164933204650879, 4.272435188293457, 4.645000457763672, 3.005315065383911, 2.941494941711426, 5.1884589195251465, 2.5206995010375977, 3.064117431640625, 4.83140754699707, 3.152150869369507, 4.301916122436523, 2.913658618927002], "mean_td_error": 3.5837676525115967, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 9.0, "diff_num_grad_updates_vs_sampler_policy": 8.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.13821792602539, "actor_loss": -4.267541408538818, "critic_loss": 1.7561936378479004, "alpha_loss": -0.024326223880052567, "alpha_value": 0.9976034164428711, "log_alpha_value": -0.0023994578514248133, "target_entropy": -6.0, "policy_t": 0.025278853252530098, "mean_q": 0.14269234240055084, "max_q": 0.1734074056148529, "min_q": 0.11157210171222687}, "td_error": [2.8789563179016113, 2.6079673767089844, 4.767520904541016, 3.89167857170105, 3.6854357719421387, 4.505826950073242, 3.093811273574829, 2.6908485889434814, 2.582784652709961, 3.1857526302337646, 1.9934003353118896, 3.6673855781555176, 4.806661128997803, 2.333439350128174, 2.4672818183898926, 3.2875256538391113, 5.182096481323242, 3.004673480987549, 4.494051933288574, 3.0553138256073, 4.694581985473633, 2.2310523986816406, 3.5012142658233643, 5.647943496704102, 5.626523971557617, 2.848335027694702, 4.258725643157959, 2.2740330696105957, 3.811701536178589, 4.309718132019043, 4.858747959136963, 4.930942058563232, 4.590845584869385, 3.0780153274536133, 3.073126792907715, 4.609726905822754, 3.5118210315704346, 2.798128604888916, 2.9087460041046143, 5.43012809753418, 3.4152333736419678, 3.714165210723877, 4.561985015869141, 2.8095223903656006, 3.5461888313293457, 2.5427427291870117, 3.146239757537842, 2.012674570083618, 3.3422937393188477, 1.2888870239257812, 2.3789515495300293, 4.619617462158203, 3.610643148422241, 3.47699236869812, 4.850424289703369, 1.249085783958435, 2.493349552154541, 3.7870864868164062, 4.595576763153076, 3.334958076477051, 3.065068244934082, 4.05034065246582, 3.6582860946655273, 3.679603338241577, 4.730236053466797, 4.4943037033081055, 4.0077223777771, 5.972015857696533, 2.3866305351257324, 2.330289602279663, 1.6662781238555908, 5.0019025802612305, 3.505190849304199, 4.853300094604492, 4.351552963256836, 3.5383877754211426, 1.9248125553131104, 4.886380195617676, 4.502998352050781, 3.0728633403778076, 4.531609535217285, 2.1654305458068848, 2.4733338356018066, 2.878281593322754, 4.097511291503906, 2.118764877319336], "mean_td_error": 3.556932210922241, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 9.0, "diff_num_grad_updates_vs_sampler_policy": 8.0}}, "num_env_steps_sampled": 8960, "num_env_steps_trained": 2322, "num_agent_steps_sampled": 26880, "num_agent_steps_trained": 2322, "last_target_update_ts": 8960, "num_target_updates": 9}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 26880, "num_agent_steps_trained": 2322, "num_env_steps_sampled": 8960, "num_env_steps_trained": 2322, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 490.8765505873975, "num_env_steps_trained_throughput_per_sec": 141.3461496111033, "timesteps_total": 8960, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 26880, "timers": {"training_iteration_time_ms": 2068.417, "sample_time_ms": 1359.888, "load_time_ms": 0.528, "load_throughput": 488693.557, "learn_time_ms": 67.29, "learn_throughput": 3834.153, "synch_weights_time_ms": 16.554}, "counters": {"num_env_steps_sampled": 8960, "num_env_steps_trained": 2322, "num_agent_steps_sampled": 26880, "num_agent_steps_trained": 2322, "last_target_update_ts": 8960, "num_target_updates": 9}, "done": false, "episodes_total": 0, "training_iteration": 10, "trial_id": "566d8_00000", "date": "2023-11-16_22-20-37", "timestamp": 1700202037, "time_this_iter_s": 1.8415238857269287, "time_total_s": 20.836689949035645, "pid": 48481, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fb780e85af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 20.836689949035645, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 85.85, "ram_util_percent": 92.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.143155097961426, "actor_loss": -4.276862621307373, "critic_loss": 4.75474739074707, "alpha_loss": -0.027389299124479294, "alpha_value": 0.9973033666610718, "log_alpha_value": -0.002700274344533682, "target_entropy": -6.0, "policy_t": -0.030781669542193413, "mean_q": 0.1476012021303177, "max_q": 0.20351065695285797, "min_q": 0.1173986941576004}, "td_error": [5.908749580383301, 4.527647018432617, 4.955245018005371, 6.283842086791992, 6.188787937164307, 5.456384658813477, 6.0627336502075195, 6.938621997833252, 5.099530220031738, 6.129510879516602, 6.156977653503418, 6.600053787231445, 6.725500583648682, 7.159353256225586, 5.674405097961426, 4.445644378662109, 3.6070752143859863, 5.245160102844238, 6.978549003601074, 4.312577247619629, 6.049107551574707, 5.28872537612915, 5.079812526702881, 5.961760520935059, 4.934600830078125, 6.235718727111816, 6.164008617401123, 7.538855075836182, 5.029327392578125, 4.073286056518555, 5.78464412689209, 6.719651222229004, 6.453557014465332, 5.199750900268555, 5.971639633178711, 5.867845058441162, 5.24376916885376, 7.364410877227783, 6.480597496032715, 5.328315258026123, 6.2286882400512695, 5.108656883239746, 6.5561017990112305, 5.751220226287842, 5.749753475189209, 4.14893102645874, 5.686594009399414, 5.625951766967773, 6.823548316955566, 7.264108180999756, 6.354304313659668, 5.847959041595459, 6.294689655303955, 5.870916366577148, 6.368806838989258, 6.292708396911621, 3.770292282104492, 6.672685146331787, 3.475677967071533, 5.565850257873535, 4.246533393859863, 7.004901885986328, 4.055529594421387, 5.307034969329834, 5.117788791656494, 5.836329936981201, 5.600728988647461, 5.947409629821777, 5.096168041229248, 6.0522308349609375, 5.873329162597656, 6.486971378326416, 6.377097129821777, 3.632377862930298, 4.235053062438965, 7.082974910736084, 5.5442070960998535, 4.260437965393066, 5.668392658233643, 5.289021968841553, 6.438687801361084, 6.338831901550293, 7.365710258483887, 6.165811061859131, 5.589512825012207, 4.342276096343994], "mean_td_error": 5.716727256774902, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 10.0, "diff_num_grad_updates_vs_sampler_policy": 9.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.059388160705566, "actor_loss": -4.20949649810791, "critic_loss": 3.0133323669433594, "alpha_loss": -0.027171572670340538, "alpha_value": 0.9973025321960449, "log_alpha_value": -0.0027011162601411343, "target_entropy": -6.0, "policy_t": 0.009645748883485794, "mean_q": 0.1771397739648819, "max_q": 0.218113973736763, "min_q": 0.14049270749092102}, "td_error": [2.303845167160034, 3.5991129875183105, 4.967413902282715, 3.0822372436523438, 3.5074424743652344, 4.434416770935059, 5.691872596740723, 0.9249709248542786, 3.7399024963378906, 1.7614965438842773, 3.567544460296631, 3.849363088607788, 4.0178303718566895, 3.5494866371154785, 4.740738391876221, 4.132854461669922, 3.030942916870117, 4.636523723602295, 4.566308975219727, 2.1248984336853027, 3.997234344482422, 3.3106741905212402, 2.3826003074645996, 2.796478748321533, 3.543684959411621, 4.912223815917969, 2.3528871536254883, 7.262306213378906, 4.146735191345215, 5.190469741821289, 3.3538360595703125, 1.9126802682876587, 3.674271583557129, 3.224313974380493, 4.251988410949707, 1.9297946691513062, 4.3098554611206055, 4.478241920471191, 4.685506820678711, 4.565160274505615, 3.591585159301758, 2.0744056701660156, 4.711200714111328, 4.8090009689331055, 5.59013032913208, 1.9701850414276123, 2.9619369506835938, 2.5847275257110596, 3.3706912994384766, 2.1285319328308105, 4.3666887283325195, 3.6275672912597656, 4.169430732727051, 2.5193135738372803, 4.5212907791137695, 3.4679808616638184, 2.426501989364624, 3.3725361824035645, 3.5452113151550293, 6.782815933227539, 4.523294925689697, 3.903679609298706, 3.101134777069092, 3.4424667358398438, 5.682520866394043, 4.73669958114624, 2.4100375175476074, 4.515122413635254, 3.160912036895752, 4.281733989715576, 3.2600643634796143, 3.8894824981689453, 5.274012088775635, 4.736379623413086, 1.060396432876587, 4.462625503540039, 5.475191116333008, 3.5282187461853027, 4.102300643920898, 3.684296131134033, 4.902482032775879, 3.87568998336792, 2.3680906295776367, 2.814582347869873, 2.9660258293151855, 4.0221147537231445], "mean_td_error": 3.735830545425415, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 10.0, "diff_num_grad_updates_vs_sampler_policy": 9.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.123340606689453, "actor_loss": -4.2773118019104, "critic_loss": 1.8905514478683472, "alpha_loss": -0.027327990159392357, "alpha_value": 0.9973041415214539, "log_alpha_value": -0.0026995032094419003, "target_entropy": -6.0, "policy_t": -0.0291544608771801, "mean_q": 0.16997778415679932, "max_q": 0.20694398880004883, "min_q": 0.14446699619293213}, "td_error": [2.573033571243286, 3.7060341835021973, 4.568543434143066, 2.028726100921631, 4.537871360778809, 1.761662483215332, 5.43375301361084, 5.042194366455078, 4.708765506744385, 3.8505725860595703, 4.734655380249023, 2.7085721492767334, 3.2260825634002686, 3.7847681045532227, 4.58641242980957, 2.9104065895080566, 2.8569693565368652, 2.6165223121643066, 3.3761706352233887, 4.353852272033691, 2.3461337089538574, 4.787748336791992, 3.860074281692505, 3.4780993461608887, 4.094079971313477, 7.053168296813965, 4.5234575271606445, 2.6248619556427, 2.3749892711639404, 4.649752616882324, 3.67669677734375, 3.4352059364318848, 4.4746270179748535, 3.1382317543029785, 4.371006011962891, 2.252713680267334, 4.100218772888184, 3.061136245727539, 1.398845911026001, 4.451872825622559, 3.057497978210449, 4.1741743087768555, 2.430543899536133, 5.239216327667236, 5.218520641326904, 3.8847150802612305, 4.748929023742676, 5.201102256774902, 4.755664348602295, 2.271793842315674, 5.202475547790527, 3.5364789962768555, 3.7047019004821777, 3.1914892196655273, 3.8454272747039795, 5.195358753204346, 3.5425667762756348, 3.5160715579986572, 5.045075416564941, 3.3017897605895996, 3.3090715408325195, 3.9404187202453613, 3.880983829498291, 3.135507583618164, 4.971912384033203, 3.6127285957336426, 2.3727197647094727, 5.059482574462891, 3.036118984222412, 2.1444263458251953, 2.306694507598877, 3.4358181953430176, 4.146527290344238, 3.8823766708374023, 2.616694927215576, 4.178760051727295, 3.4999632835388184, 6.075878143310547, 5.295889854431152, 5.4259233474731445, 3.127614974975586, 3.157352924346924, 4.473014831542969, 2.5722851753234863, 3.7835991382598877, 2.205174207687378], "mean_td_error": 3.7701046466827393, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 10.0, "diff_num_grad_updates_vs_sampler_policy": 9.0}}, "num_env_steps_sampled": 9856, "num_env_steps_trained": 2580, "num_agent_steps_sampled": 29568, "num_agent_steps_trained": 2580, "last_target_update_ts": 9856, "num_target_updates": 10}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 29568, "num_agent_steps_trained": 2580, "num_env_steps_sampled": 9856, "num_env_steps_trained": 2580, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 473.0325953643491, "num_env_steps_trained_throughput_per_sec": 136.20804643303802, "timesteps_total": 9856, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 29568, "timers": {"training_iteration_time_ms": 1965.156, "sample_time_ms": 1349.687, "load_time_ms": 0.527, "load_throughput": 489541.023, "learn_time_ms": 66.95, "learn_throughput": 3853.613, "synch_weights_time_ms": 16.313}, "counters": {"num_env_steps_sampled": 9856, "num_env_steps_trained": 2580, "num_agent_steps_sampled": 29568, "num_agent_steps_trained": 2580, "last_target_update_ts": 9856, "num_target_updates": 10}, "done": false, "episodes_total": 0, "training_iteration": 11, "trial_id": "566d8_00000", "date": "2023-11-16_22-20-39", "timestamp": 1700202039, "time_this_iter_s": 1.9100120067596436, "time_total_s": 22.746701955795288, "pid": 48481, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fb7638cfee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 22.746701955795288, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 65.93333333333332, "ram_util_percent": 92.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.082786560058594, "actor_loss": -4.241790294647217, "critic_loss": 4.947238445281982, "alpha_loss": -0.030253412202000618, "alpha_value": 0.997003972530365, "log_alpha_value": -0.003000501310452819, "target_entropy": -6.0, "policy_t": 0.0014518110547214746, "mean_q": 0.1730222851037979, "max_q": 0.2220989614725113, "min_q": 0.14027263224124908}, "td_error": [5.675786972045898, 4.129871368408203, 5.312767028808594, 4.728447914123535, 4.328003883361816, 5.778830528259277, 4.9696550369262695, 5.526221752166748, 5.933457851409912, 6.458998680114746, 6.069418907165527, 6.204545021057129, 4.612372398376465, 5.292896270751953, 7.561881065368652, 4.835236072540283, 4.250899314880371, 7.83613395690918, 4.7111616134643555, 6.284890174865723, 5.402167797088623, 4.672441482543945, 6.007620811462402, 5.479896068572998, 4.852089881896973, 5.183493614196777, 6.130053520202637, 7.187836647033691, 4.76912784576416, 4.665219306945801, 4.830197334289551, 5.812525749206543, 5.551397323608398, 5.355855941772461, 6.513845443725586, 5.751709461212158, 4.110827922821045, 4.548694133758545, 5.394885540008545, 5.300089359283447, 7.110441207885742, 5.978839874267578, 4.995887756347656, 5.443355083465576, 4.7851972579956055, 7.10533332824707, 6.437300682067871, 6.296322822570801, 4.869846343994141, 6.494184494018555, 5.384498119354248, 5.920536041259766, 7.417917251586914, 6.2317609786987305, 4.996447563171387, 5.686507225036621, 5.893817901611328, 3.719414234161377, 5.734865188598633, 7.003520965576172, 4.766873359680176, 4.891380786895752, 3.8818655014038086, 5.394913673400879, 6.532693862915039, 5.93634033203125, 6.393776893615723, 4.272857666015625, 3.3962533473968506, 7.180583477020264, 5.843204498291016, 5.505012035369873, 7.303483963012695, 5.70084810256958, 6.721155643463135, 5.668393135070801, 5.523693084716797, 5.559289455413818, 5.680660247802734, 6.404287338256836, 5.831300735473633, 3.734407424926758, 5.827012062072754, 7.3544440269470215, 5.216381072998047, 5.415502548217773], "mean_td_error": 5.598419189453125, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 11.0, "diff_num_grad_updates_vs_sampler_policy": 10.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.116633415222168, "actor_loss": -4.29331636428833, "critic_loss": 2.9389779567718506, "alpha_loss": -0.03036286123096943, "alpha_value": 0.9970031976699829, "log_alpha_value": -0.0030012810602784157, "target_entropy": -6.0, "policy_t": 0.019504254683852196, "mean_q": 0.20861011743545532, "max_q": 0.24624362587928772, "min_q": 0.17403367161750793}, "td_error": [3.381000518798828, 4.966156005859375, 5.613804340362549, 1.9052996635437012, 3.422403335571289, 1.9958726167678833, 3.5541977882385254, 5.643975257873535, 3.4019174575805664, 5.131956100463867, 3.9604477882385254, 4.1345930099487305, 4.687315940856934, 4.981665134429932, 2.547193765640259, 4.490723133087158, 3.938108444213867, 3.4055376052856445, 3.4827561378479004, 4.3992414474487305, 2.2081174850463867, 3.929280996322632, 3.2827348709106445, 3.538776397705078, 3.185042142868042, 4.019346237182617, 4.822657108306885, 3.9697861671447754, 3.420158863067627, 3.752777576446533, 2.9150843620300293, 3.419332981109619, 3.7566118240356445, 2.832967758178711, 3.079343795776367, 6.091750144958496, 2.6403462886810303, 3.464710235595703, 2.9874706268310547, 6.2730207443237305, 4.432550430297852, 2.5767171382904053, 5.274082660675049, 4.0872955322265625, 2.895160436630249, 3.3818092346191406, 2.7093772888183594, 6.229352951049805, 2.555363893508911, 3.768768310546875, 3.501908302307129, 1.639788031578064, 3.032320976257324, 4.089130878448486, 3.810652256011963, 3.0613577365875244, 2.681378126144409, 2.96213698387146, 2.675107717514038, 3.3715879917144775, 3.9855008125305176, 3.506772994995117, 6.0101423263549805, 5.083849906921387, 3.339906692504883, 1.8950209617614746, 3.9167141914367676, 5.247446060180664, 3.0764381885528564, 5.254335880279541, 2.902827262878418, 3.933119058609009, 2.7442474365234375, 2.8243913650512695, 3.7110435962677, 2.751178503036499, 2.7904038429260254, 2.5398383140563965, 4.47938346862793, 3.2067956924438477, 3.7044782638549805, 4.390811443328857, 3.3443245887756348, 1.9826747179031372, 2.308514356613159, 2.3361897468566895], "mean_td_error": 3.635298728942871, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 11.0, "diff_num_grad_updates_vs_sampler_policy": 10.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.052478790283203, "actor_loss": -4.2326483726501465, "critic_loss": 1.8095262050628662, "alpha_loss": -0.03015339933335781, "alpha_value": 0.9970048666000366, "log_alpha_value": -0.002999598626047373, "target_entropy": -6.0, "policy_t": -0.061349086463451385, "mean_q": 0.1954963654279709, "max_q": 0.24389438331127167, "min_q": 0.15798835456371307}, "td_error": [3.4046518802642822, 2.874873161315918, 4.102166652679443, 4.873862266540527, 2.2711877822875977, 3.0346274375915527, 4.273555755615234, 3.6258349418640137, 3.2988648414611816, 2.1360650062561035, 5.149618625640869, 2.6125192642211914, 4.2579545974731445, 4.346888542175293, 3.1999220848083496, 3.5385584831237793, 4.439113616943359, 2.6211891174316406, 5.000950813293457, 2.4373927116394043, 5.4544677734375, 3.721473217010498, 2.86519193649292, 2.060084819793701, 1.5546565055847168, 4.2351393699646, 3.9264862537384033, 3.3443870544433594, 2.8839452266693115, 2.255237340927124, 3.9841299057006836, 4.043769836425781, 3.4678361415863037, 3.33280086517334, 2.833343982696533, 4.7520551681518555, 1.0403249263763428, 3.598865509033203, 1.114711046218872, 4.1784467697143555, 4.330456733703613, 4.747411251068115, 3.0215609073638916, 3.8371450901031494, 3.8875584602355957, 3.4848947525024414, 3.877237558364868, 1.9930872917175293, 2.0066542625427246, 3.8379836082458496, 2.226832151412964, 3.61812162399292, 4.157215118408203, 5.264017105102539, 2.904968738555908, 3.128483772277832, 5.218557357788086, 2.392932176589966, 5.195101737976074, 4.439371585845947, 3.5318987369537354, 3.9597272872924805, 3.265592336654663, 3.7550361156463623, 2.7422375679016113, 6.1547465324401855, 2.3702011108398438, 3.6542916297912598, 3.309441089630127, 2.378096580505371, 5.519437789916992, 2.786220073699951, 4.68209981918335, 3.4574859142303467, 2.989548444747925, 4.921499252319336, 4.672800064086914, 3.1695733070373535, 3.74220609664917, 3.2165439128875732, 3.9469804763793945, 4.282609462738037, 6.634614944458008, 3.9289674758911133, 4.8973541259765625, 1.2209789752960205], "mean_td_error": 3.5919408798217773, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 11.0, "diff_num_grad_updates_vs_sampler_policy": 10.0}}, "num_env_steps_sampled": 10752, "num_env_steps_trained": 2838, "num_agent_steps_sampled": 32256, "num_agent_steps_trained": 2838, "last_target_update_ts": 10752, "num_target_updates": 11}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32256, "num_agent_steps_trained": 2838, "num_env_steps_sampled": 10752, "num_env_steps_trained": 2838, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 426.0071709745792, "num_env_steps_trained_throughput_per_sec": 122.66724342794802, "timesteps_total": 10752, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 32256, "timers": {"training_iteration_time_ms": 1945.414, "sample_time_ms": 1327.19, "load_time_ms": 0.53, "load_throughput": 487204.733, "learn_time_ms": 64.696, "learn_throughput": 3987.855, "synch_weights_time_ms": 16.837}, "counters": {"num_env_steps_sampled": 10752, "num_env_steps_trained": 2838, "num_agent_steps_sampled": 32256, "num_agent_steps_trained": 2838, "last_target_update_ts": 10752, "num_target_updates": 11}, "done": false, "episodes_total": 0, "training_iteration": 12, "trial_id": "566d8_00000", "date": "2023-11-16_22-20-41", "timestamp": 1700202041, "time_this_iter_s": 2.122781991958618, "time_total_s": 24.869483947753906, "pid": 48481, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fb780eab700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 24.869483947753906, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 68.1, "ram_util_percent": 92.33333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.11993408203125, "actor_loss": -4.302160739898682, "critic_loss": 4.7645368576049805, "alpha_loss": -0.03340297192335129, "alpha_value": 0.9967047572135925, "log_alpha_value": -0.003300710581243038, "target_entropy": -6.0, "policy_t": 0.0037111034616827965, "mean_q": 0.20331640541553497, "max_q": 0.25463011860847473, "min_q": 0.1617753654718399}, "td_error": [8.30910873413086, 4.3252716064453125, 6.078280448913574, 5.265285968780518, 5.435854911804199, 4.524487495422363, 7.290055274963379, 4.370795726776123, 5.202939033508301, 5.855727195739746, 6.844374656677246, 6.478750228881836, 7.049576759338379, 6.262024879455566, 5.90830135345459, 3.8255538940429688, 3.2146363258361816, 5.354245185852051, 6.030674457550049, 5.795323371887207, 4.2968878746032715, 6.721185684204102, 3.9846062660217285, 6.185513496398926, 5.345473289489746, 6.868816375732422, 7.024481296539307, 5.14653205871582, 4.29242467880249, 3.313892364501953, 5.049131870269775, 6.690874099731445, 5.125751495361328, 6.341401100158691, 5.056344985961914, 6.049253463745117, 3.6343045234680176, 5.191323280334473, 7.109665393829346, 5.129373073577881, 4.303377151489258, 4.180300712585449, 5.1463847160339355, 4.9522528648376465, 6.443254470825195, 5.176152229309082, 4.646471977233887, 4.95039176940918, 6.162130355834961, 5.638960838317871, 7.617131233215332, 6.57795524597168, 6.034819602966309, 6.678837776184082, 7.006756782531738, 4.636902809143066, 5.563088417053223, 4.812544345855713, 3.4757492542266846, 6.277254104614258, 4.9630231857299805, 5.149032115936279, 4.675792694091797, 5.065603256225586, 6.588311195373535, 5.227016925811768, 5.499975204467773, 3.9366612434387207, 7.122570514678955, 6.038575172424316, 6.236937522888184, 6.994250297546387, 7.564733505249023, 5.163885116577148, 6.308753967285156, 3.6072051525115967, 8.103750228881836, 4.332613468170166, 7.066507339477539, 4.554531097412109, 5.442131042480469, 5.838541030883789, 6.710895538330078, 4.958898544311523, 5.645916938781738, 5.15172004699707], "mean_td_error": 5.583803176879883, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 12.0, "diff_num_grad_updates_vs_sampler_policy": 11.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.086294174194336, "actor_loss": -4.291088581085205, "critic_loss": 2.9321508407592773, "alpha_loss": -0.03330005705356598, "alpha_value": 0.9967039227485657, "log_alpha_value": -0.003301515942439437, "target_entropy": -6.0, "policy_t": -0.03215281292796135, "mean_q": 0.2377626895904541, "max_q": 0.29563063383102417, "min_q": 0.1837904155254364}, "td_error": [5.959519386291504, 4.353724479675293, 3.853773832321167, 4.092558860778809, 4.935068130493164, 4.135721206665039, 4.598278999328613, 2.827913761138916, 2.529099464416504, 4.416476726531982, 4.1257758140563965, 2.0825884342193604, 2.4501137733459473, 2.233510971069336, 3.486870527267456, 4.783687591552734, 3.523683547973633, 1.3389939069747925, 4.869810104370117, 4.8878374099731445, 3.715808868408203, 3.4376373291015625, 2.5824813842773438, 4.138162136077881, 3.2003355026245117, 2.703831672668457, 4.2291259765625, 5.669075965881348, 1.6172780990600586, 1.7297310829162598, 5.295480728149414, 3.032155990600586, 2.3522133827209473, 2.6291470527648926, 4.1388139724731445, 3.51969051361084, 2.976907253265381, 5.449650764465332, 4.996339797973633, 3.5546469688415527, 4.686262130737305, 3.0631818771362305, 3.896986722946167, 6.142232894897461, 2.3358469009399414, 4.982847690582275, 2.3730170726776123, 3.7365503311157227, 3.795286178588867, 3.2098875045776367, 1.2681608200073242, 4.637940406799316, 3.7259268760681152, 4.388758659362793, 2.1031076908111572, 3.6820740699768066, 1.83364737033844, 3.623251438140869, 2.209066390991211, 3.0074806213378906, 4.968448638916016, 4.248720169067383, 3.105522632598877, 2.560584783554077, 3.292715549468994, 3.3422303199768066, 4.709219455718994, 2.0864391326904297, 1.2381527423858643, 4.819445610046387, 3.9601798057556152, 2.61921763420105, 4.840070724487305, 4.230714321136475, 2.3953797817230225, 4.677823066711426, 4.271211624145508, 4.655604839324951, 4.328325271606445, 3.330514430999756, 5.821171760559082, 3.287907123565674, 2.9817752838134766, 6.646605491638184, 3.034576892852783, 4.960465908050537], "mean_td_error": 3.669395923614502, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 12.0, "diff_num_grad_updates_vs_sampler_policy": 11.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.058393478393555, "actor_loss": -4.267862319946289, "critic_loss": 1.854682207107544, "alpha_loss": -0.03318885341286659, "alpha_value": 0.9967058300971985, "log_alpha_value": -0.0032996179070323706, "target_entropy": -6.0, "policy_t": 0.007437655236572027, "mean_q": 0.2242148220539093, "max_q": 0.2724491059780121, "min_q": 0.1885475069284439}, "td_error": [2.9550182819366455, 4.864036560058594, 3.3918347358703613, 4.286320686340332, 3.009157180786133, 5.058173179626465, 2.7733216285705566, 2.980562210083008, 3.3679471015930176, 5.212623596191406, 3.101029872894287, 2.259913444519043, 3.3884224891662598, 5.080402851104736, 4.632585525512695, 4.04488468170166, 2.9237074851989746, 4.109314918518066, 4.919288635253906, 5.0157036781311035, 4.607183456420898, 4.811277389526367, 3.43904972076416, 4.427981853485107, 2.421144485473633, 3.239744186401367, 3.854792833328247, 3.928203582763672, 4.417109489440918, 2.8369407653808594, 2.841196060180664, 3.0494184494018555, 4.869466781616211, 3.709176778793335, 5.285490989685059, 2.372030735015869, 2.965345621109009, 5.165563583374023, 3.630053997039795, 4.530776500701904, 1.6816754341125488, 4.522767066955566, 2.2959184646606445, 2.04951810836792, 2.8566646575927734, 3.5082125663757324, 5.743740081787109, 2.344987392425537, 5.074369430541992, 2.8837838172912598, 3.284123420715332, 4.705785274505615, 2.822178363800049, 2.8761558532714844, 5.175477027893066, 4.436957359313965, 4.674349784851074, 2.4802327156066895, 2.465789794921875, 4.226067543029785, 3.0291929244995117, 5.953909873962402, 2.947291851043701, 5.53486442565918, 3.670889377593994, 2.7466540336608887, 3.241316795349121, 3.1862568855285645, 3.7708005905151367, 4.093995094299316, 3.0083236694335938, 3.0789453983306885, 1.9291629791259766, 4.590095520019531, 3.2375316619873047, 4.781797409057617, 2.8555891513824463, 5.703283309936523, 3.6360058784484863, 4.182389259338379, 3.544499158859253, 3.2523202896118164, 2.1410844326019287, 3.945307970046997, 2.3524417877197266, 3.9376156330108643], "mean_td_error": 3.7004244327545166, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 12.0, "diff_num_grad_updates_vs_sampler_policy": 11.0}}, "num_env_steps_sampled": 11648, "num_env_steps_trained": 3096, "num_agent_steps_sampled": 34944, "num_agent_steps_trained": 3096, "last_target_update_ts": 11648, "num_target_updates": 12}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 34944, "num_agent_steps_trained": 3096, "num_env_steps_sampled": 11648, "num_env_steps_trained": 3096, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 431.05567323193424, "num_env_steps_trained_throughput_per_sec": 124.1209416225882, "timesteps_total": 11648, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 34944, "timers": {"training_iteration_time_ms": 1965.565, "sample_time_ms": 1348.305, "load_time_ms": 0.53, "load_throughput": 486766.422, "learn_time_ms": 64.549, "learn_throughput": 3996.948, "synch_weights_time_ms": 16.906}, "counters": {"num_env_steps_sampled": 11648, "num_env_steps_trained": 3096, "num_agent_steps_sampled": 34944, "num_agent_steps_trained": 3096, "last_target_update_ts": 11648, "num_target_updates": 12}, "done": false, "episodes_total": 0, "training_iteration": 13, "trial_id": "566d8_00000", "date": "2023-11-16_22-20-43", "timestamp": 1700202043, "time_this_iter_s": 2.0951499938964844, "time_total_s": 26.96463394165039, "pid": 48481, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fb780e85af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 26.96463394165039, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 77.5, "ram_util_percent": 92.36666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.073880195617676, "actor_loss": -4.285287380218506, "critic_loss": 4.681100845336914, "alpha_loss": -0.0362757071852684, "alpha_value": 0.9964054822921753, "log_alpha_value": -0.0036009664181619883, "target_entropy": -6.0, "policy_t": 0.006769861094653606, "mean_q": 0.23275767266750336, "max_q": 0.32000285387039185, "min_q": 0.17966634035110474}, "td_error": [7.912416458129883, 5.484014511108398, 6.180181980133057, 5.257524013519287, 5.65988826751709, 4.380932807922363, 6.6054863929748535, 5.418776035308838, 5.8673906326293945, 4.817596435546875, 6.002450942993164, 3.9684762954711914, 5.21884822845459, 4.414968490600586, 5.139081954956055, 3.648566484451294, 6.9488677978515625, 4.09525203704834, 4.195622444152832, 6.546724319458008, 7.327978134155273, 5.597866058349609, 5.239287853240967, 4.023497581481934, 5.19476318359375, 5.086261749267578, 4.1519389152526855, 5.903175354003906, 4.9623003005981445, 5.762560844421387, 9.188596725463867, 4.954386234283447, 5.018187522888184, 7.284253120422363, 5.871662139892578, 5.722648620605469, 4.860184669494629, 7.060059547424316, 5.303188323974609, 5.512548446655273, 6.096014976501465, 4.918963432312012, 6.284971237182617, 6.066142559051514, 6.469156265258789, 4.780963897705078, 5.322836875915527, 6.966922760009766, 7.166219711303711, 4.584451675415039, 4.326635360717773, 5.8295135498046875, 4.670635223388672, 5.3548479080200195, 5.333442687988281, 5.640944480895996, 6.0301337242126465, 5.616518497467041, 5.315227508544922, 5.432066440582275, 3.7555551528930664, 6.080260753631592, 3.954939365386963, 5.739775657653809, 5.288785934448242, 6.261466979980469, 5.120718002319336, 6.056087493896484, 4.085749626159668, 4.507342338562012, 5.481509208679199, 4.383871078491211, 6.453922748565674, 5.049436092376709, 4.180927276611328, 4.221911430358887, 4.911726474761963, 5.8607378005981445, 4.735752105712891, 7.08098840713501, 5.3150177001953125, 4.659322261810303, 6.656161785125732, 5.688591003417969, 4.315205097198486, 4.94484806060791], "mean_td_error": 5.450995445251465, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 13.0, "diff_num_grad_updates_vs_sampler_policy": 12.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.106755256652832, "actor_loss": -4.345301628112793, "critic_loss": 2.8756675720214844, "alpha_loss": -0.036402057856321335, "alpha_value": 0.9964047074317932, "log_alpha_value": -0.0036017554812133312, "target_entropy": -6.0, "policy_t": -0.0006994997966103256, "mean_q": 0.27088576555252075, "max_q": 0.32647615671157837, "min_q": 0.22089453041553497}, "td_error": [5.828840255737305, 2.9169187545776367, 3.2987451553344727, 4.608531951904297, 3.553274631500244, 4.1121416091918945, 5.396452903747559, 4.531227111816406, 2.4620275497436523, 4.934347152709961, 3.1169958114624023, 3.0793609619140625, 2.954890251159668, 4.485316276550293, 3.4574151039123535, 2.935154914855957, 2.4191017150878906, 3.2704200744628906, 4.741083145141602, 3.012317180633545, 4.244418144226074, 5.127513885498047, 1.9791526794433594, 2.748979091644287, 5.1703338623046875, 4.4766645431518555, 2.130009651184082, 2.721609115600586, 3.4119441509246826, 4.639482021331787, 2.2287540435791016, 3.325934410095215, 3.549302101135254, 4.708494663238525, 3.52154803276062, 2.889169216156006, 4.0977983474731445, 3.2458229064941406, 3.0929653644561768, 3.7947168350219727, 3.6998438835144043, 4.607544422149658, 4.837050437927246, 1.5813369750976562, 4.4065775871276855, 2.4076716899871826, 2.695946455001831, 4.649011135101318, 4.519710540771484, 3.629870653152466, 2.3163585662841797, 3.7270076274871826, 2.6468005180358887, 5.062222480773926, 3.4733176231384277, 1.2815380096435547, 2.736459732055664, 2.201082468032837, 4.500882148742676, 3.8728280067443848, 3.337563991546631, 3.798557996749878, 3.734450578689575, 3.469407558441162, 2.1392171382904053, 2.60127592086792, 3.6320748329162598, 1.708513617515564, 3.7673697471618652, 4.683183670043945, 4.706582069396973, 4.320334434509277, 3.639693260192871, 1.3187942504882812, 3.093771457672119, 2.048146963119507, 3.6902832984924316, 2.9765615463256836, 4.4826250076293945, 4.250502109527588, 2.7233386039733887, 5.294468879699707, 3.6849710941314697, 5.398191452026367, 4.9037766456604, 5.309743881225586], "mean_td_error": 3.602158308029175, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 13.0, "diff_num_grad_updates_vs_sampler_policy": 12.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.082826614379883, "actor_loss": -4.319687366485596, "critic_loss": 1.853182315826416, "alpha_loss": -0.03629400581121445, "alpha_value": 0.9964069128036499, "log_alpha_value": -0.0035995866637676954, "target_entropy": -6.0, "policy_t": 0.032637160271406174, "mean_q": 0.2563171684741974, "max_q": 0.3205930292606354, "min_q": 0.2169007956981659}, "td_error": [2.6111578941345215, 4.024399757385254, 5.249201774597168, 5.0910539627075195, 3.324645757675171, 2.9968605041503906, 2.9489221572875977, 3.9413862228393555, 5.814663410186768, 4.004533290863037, 3.938231945037842, 4.2806854248046875, 5.374807834625244, 3.2312521934509277, 2.2881851196289062, 4.4562225341796875, 3.3837270736694336, 4.7794294357299805, 2.860894203186035, 2.9955050945281982, 3.655975818634033, 2.6031084060668945, 2.8856587409973145, 3.9220077991485596, 4.6185102462768555, 4.867828369140625, 4.864717483520508, 5.203406810760498, 1.9245898723602295, 3.467137336730957, 4.803725719451904, 2.651674509048462, 5.2271528244018555, 3.512183427810669, 2.7692108154296875, 6.478338241577148, 2.625589609146118, 5.144467353820801, 2.73264741897583, 3.2675344944000244, 3.846266746520996, 3.0022988319396973, 2.272089958190918, 3.1432671546936035, 3.7641894817352295, 2.33454966545105, 1.214401125907898, 3.2664151191711426, 2.770077705383301, 4.493546485900879, 6.852517127990723, 2.659160852432251, 4.055055618286133, 4.577241897583008, 3.211864471435547, 3.6871871948242188, 4.228578567504883, 4.301909446716309, 3.247744560241699, 4.202450752258301, 1.7441511154174805, 4.634794235229492, 3.7284555435180664, 5.065133571624756, 3.8747031688690186, 4.208401679992676, 4.006129264831543, 3.289785623550415, 3.2984447479248047, 3.646648406982422, 3.863612174987793, 2.0764238834381104, 4.311816215515137, 3.4656472206115723, 3.9243531227111816, 5.2249579429626465, 3.812537908554077, 5.407522201538086, 2.9392476081848145, 2.747556209564209, 4.0668487548828125, 3.748598575592041, 4.054841995239258, 3.0399656295776367, 1.5518531799316406, 2.9357681274414062], "mean_td_error": 3.728142261505127, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 13.0, "diff_num_grad_updates_vs_sampler_policy": 12.0}}, "num_env_steps_sampled": 12544, "num_env_steps_trained": 3354, "num_agent_steps_sampled": 37632, "num_agent_steps_trained": 3354, "last_target_update_ts": 12544, "num_target_updates": 13}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37632, "num_agent_steps_trained": 3354, "num_env_steps_sampled": 12544, "num_env_steps_trained": 3354, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 458.36245905274353, "num_env_steps_trained_throughput_per_sec": 131.98383307545515, "timesteps_total": 12544, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 37632, "timers": {"training_iteration_time_ms": 1968.603, "sample_time_ms": 1351.39, "load_time_ms": 0.531, "load_throughput": 486001.272, "learn_time_ms": 64.539, "learn_throughput": 3997.614, "synch_weights_time_ms": 16.67}, "counters": {"num_env_steps_sampled": 12544, "num_env_steps_trained": 3354, "num_agent_steps_sampled": 37632, "num_agent_steps_trained": 3354, "last_target_update_ts": 12544, "num_target_updates": 13}, "done": false, "episodes_total": 0, "training_iteration": 14, "trial_id": "566d8_00000", "date": "2023-11-16_22-20-45", "timestamp": 1700202045, "time_this_iter_s": 1.9691269397735596, "time_total_s": 28.93376088142395, "pid": 48481, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fb7638cfee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 28.93376088142395, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 68.93333333333334, "ram_util_percent": 92.36666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.088430404663086, "actor_loss": -4.3249006271362305, "critic_loss": 4.549356460571289, "alpha_loss": -0.03935679793357849, "alpha_value": 0.9961064457893372, "log_alpha_value": -0.0039011812768876553, "target_entropy": -6.0, "policy_t": -0.011907682754099369, "mean_q": 0.25599363446235657, "max_q": 0.3244139552116394, "min_q": 0.20391446352005005}, "td_error": [7.359537124633789, 5.003907203674316, 6.772586822509766, 3.765634536743164, 6.024539470672607, 6.875174045562744, 4.485544204711914, 4.908733367919922, 5.395565032958984, 5.743818283081055, 3.7843434810638428, 6.540502548217773, 7.400396347045898, 4.221831321716309, 5.537641525268555, 5.481175422668457, 5.801210403442383, 5.592399597167969, 5.115060806274414, 5.694106101989746, 6.48185920715332, 4.447061061859131, 5.65286922454834, 5.4394683837890625, 4.961456298828125, 4.42744779586792, 5.761653900146484, 5.920080661773682, 4.4946980476379395, 4.313823699951172, 5.86435604095459, 5.769526958465576, 5.595730781555176, 4.048452854156494, 4.3001933097839355, 5.842523574829102, 4.622632026672363, 3.955801010131836, 6.712677001953125, 3.8895554542541504, 4.12092399597168, 6.011700630187988, 6.212275505065918, 4.467267990112305, 6.0446271896362305, 5.277905464172363, 6.171981334686279, 4.9736409187316895, 7.964940071105957, 5.458622455596924, 4.202301979064941, 2.9957733154296875, 4.3070902824401855, 5.7714433670043945, 5.830233573913574, 5.913187026977539, 5.315590858459473, 5.94419002532959, 3.887265205383301, 5.337398529052734, 4.304495811462402, 4.023861408233643, 6.002972602844238, 5.451803207397461, 4.795693397521973, 3.877906560897827, 1.9895906448364258, 6.103493690490723, 5.820033073425293, 5.363489151000977, 6.386990070343018, 4.958457946777344, 4.509880065917969, 5.34516716003418, 6.482548236846924, 5.042882919311523, 5.964361667633057, 6.3678789138793945, 5.014590263366699, 6.887417793273926, 5.121427536010742, 4.8070454597473145, 6.317371368408203, 6.160299301147461, 4.1915483474731445, 6.40609073638916], "mean_td_error": 5.324549674987793, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 14.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.071524620056152, "actor_loss": -4.3413190841674805, "critic_loss": 2.928548812866211, "alpha_loss": -0.039299413561820984, "alpha_value": 0.9961055517196655, "log_alpha_value": -0.00390203227289021, "target_entropy": -6.0, "policy_t": -0.021560581400990486, "mean_q": 0.3027198910713196, "max_q": 0.35196080803871155, "min_q": 0.25988516211509705}, "td_error": [3.4754886627197266, 5.2920331954956055, 2.963909864425659, 3.0114080905914307, 1.8998470306396484, 3.501847982406616, 3.149562358856201, 4.394528388977051, 3.6127285957336426, 5.073359966278076, 3.375945568084717, 3.393113374710083, 3.7254791259765625, 3.6425018310546875, 3.2325048446655273, 5.17701530456543, 4.125463485717773, 2.536062717437744, 4.624932765960693, 6.016638278961182, 3.6413252353668213, 3.050637722015381, 2.750056266784668, 3.4931161403656006, 5.654181480407715, 1.445044994354248, 4.747990608215332, 3.3897812366485596, 3.8257079124450684, 4.933788776397705, 2.140512228012085, 3.4714527130126953, 3.803459644317627, 3.551393747329712, 3.3728585243225098, 4.407329082489014, 2.232790470123291, 2.660210371017456, 3.0228986740112305, 4.982515335083008, 4.4457292556762695, 4.012564659118652, 5.290419578552246, 4.467066287994385, 3.6808249950408936, 4.460285663604736, 5.364036560058594, 2.715414524078369, 4.737467288970947, 3.1203248500823975, 3.6663384437561035, 4.83008337020874, 3.949178695678711, 4.178335666656494, 3.767399787902832, 4.52361536026001, 3.208991289138794, 3.8883044719696045, 3.342252731323242, 0.763318657875061, 4.307807922363281, 2.062161445617676, 5.180272102355957, 4.559587478637695, 3.5573551654815674, 4.4297943115234375, 1.2026727199554443, 2.448756694793701, 3.6610326766967773, 3.2385871410369873, 3.3838348388671875, 4.319538116455078, 3.669625759124756, 3.8805980682373047, 3.167742967605591, 4.077727317810059, 3.4551515579223633, 2.2000906467437744, 3.126952648162842, 2.7684695720672607, 3.823564052581787, 2.8265042304992676, 3.563345193862915, 3.4159750938415527, 2.981609344482422, 3.996030807495117], "mean_td_error": 3.6571879386901855, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 14.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.092833518981934, "actor_loss": -4.365606307983398, "critic_loss": 1.827730417251587, "alpha_loss": -0.03935757279396057, "alpha_value": 0.9961080551147461, "log_alpha_value": -0.003899556351825595, "target_entropy": -6.0, "policy_t": 0.049799222499132156, "mean_q": 0.29683586955070496, "max_q": 0.35910913348197937, "min_q": 0.2538556456565857}, "td_error": [3.575655937194824, 3.4379682540893555, 4.261649131774902, 3.039407253265381, 2.705354928970337, 2.3812832832336426, 4.634578227996826, 3.3748652935028076, 2.276336193084717, 3.156975746154785, 3.872119903564453, 4.451281547546387, 3.446361541748047, 2.205143451690674, 1.849343180656433, 4.958498001098633, 2.3152105808258057, 4.642139911651611, 1.8679397106170654, 2.6619443893432617, 5.271867275238037, 4.509585380554199, 3.1651809215545654, 3.2117152214050293, 2.4719600677490234, 5.431751728057861, 2.6162917613983154, 3.0334949493408203, 1.363531470298767, 4.514237403869629, 4.980914115905762, 1.9040677547454834, 5.297430992126465, 5.53176212310791, 2.596652030944824, 3.249159336090088, 4.169377326965332, 3.043985605239868, 5.5149126052856445, 4.063657760620117, 4.016092300415039, 4.452049255371094, 2.6422481536865234, 3.705761671066284, 3.3583760261535645, 4.199856281280518, 4.769071102142334, 4.600701332092285, 3.959944248199463, 4.1701154708862305, 3.5515620708465576, 3.8271217346191406, 3.2538609504699707, 6.355368614196777, 3.729832649230957, 2.3966050148010254, 2.6248693466186523, 5.087254524230957, 3.1215758323669434, 3.87898588180542, 2.3211679458618164, 3.19514799118042, 3.0927910804748535, 2.6225314140319824, 3.8891072273254395, 3.7740633487701416, 3.1430928707122803, 4.658163547515869, 3.483386516571045, 2.674504041671753, 4.192063331604004, 3.489630699157715, 4.507099151611328, 5.402128219604492, 3.8065080642700195, 3.870077133178711, 4.0150041580200195, 3.6789002418518066, 5.475137710571289, 3.030313014984131, 2.5048255920410156, 3.160862922668457, 4.012129783630371, 4.6378889083862305, 4.525102615356445, 4.22542667388916], "mean_td_error": 3.6760921478271484, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 14.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 13440, "num_env_steps_trained": 3612, "num_agent_steps_sampled": 40320, "num_agent_steps_trained": 3612, "last_target_update_ts": 13440, "num_target_updates": 14}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40320, "num_agent_steps_trained": 3612, "num_env_steps_sampled": 13440, "num_env_steps_trained": 3612, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 458.5873631060919, "num_env_steps_trained_throughput_per_sec": 132.04859339438806, "timesteps_total": 13440, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 40320, "timers": {"training_iteration_time_ms": 1974.858, "sample_time_ms": 1356.858, "load_time_ms": 0.53, "load_throughput": 486525.687, "learn_time_ms": 64.551, "learn_throughput": 3996.864, "synch_weights_time_ms": 16.638}, "counters": {"num_env_steps_sampled": 13440, "num_env_steps_trained": 3612, "num_agent_steps_sampled": 40320, "num_agent_steps_trained": 3612, "last_target_update_ts": 13440, "num_target_updates": 14}, "done": false, "episodes_total": 0, "training_iteration": 15, "trial_id": "566d8_00000", "date": "2023-11-16_22-20-47", "timestamp": 1700202047, "time_this_iter_s": 1.9737811088562012, "time_total_s": 30.90754199028015, "pid": 48481, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fb763906160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 30.90754199028015, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 68.03333333333335, "ram_util_percent": 92.40000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.14250373840332, "actor_loss": -4.4098687171936035, "critic_loss": 4.478044033050537, "alpha_loss": -0.042612578719854355, "alpha_value": 0.995807409286499, "log_alpha_value": -0.00420138705521822, "target_entropy": -6.0, "policy_t": -0.014915214851498604, "mean_q": 0.29392799735069275, "max_q": 0.38627347350120544, "min_q": 0.22885912656784058}, "td_error": [4.1415791511535645, 4.57252836227417, 1.8583176136016846, 5.986535549163818, 4.799262046813965, 5.659902572631836, 4.67702579498291, 6.772863388061523, 4.607115745544434, 5.910296440124512, 6.291705131530762, 4.6734418869018555, 5.051321983337402, 4.084561824798584, 7.729469299316406, 4.20457649230957, 5.099613189697266, 6.256012439727783, 4.986435890197754, 5.467010498046875, 6.451696395874023, 3.656848192214966, 7.196269989013672, 7.344900131225586, 5.575150489807129, 5.363451957702637, 4.526393413543701, 6.758655548095703, 3.3061225414276123, 4.418687343597412, 9.142120361328125, 5.026801109313965, 6.250511646270752, 6.194545745849609, 7.293581962585449, 2.7885379791259766, 7.305398941040039, 6.586368560791016, 4.986623764038086, 7.330638408660889, 5.585764408111572, 7.697653770446777, 3.6166343688964844, 5.42390251159668, 5.670278549194336, 5.226489067077637, 4.388206958770752, 4.699443817138672, 4.27878475189209, 5.679766654968262, 5.004363059997559, 4.591626167297363, 4.5290069580078125, 3.793165683746338, 6.976729393005371, 4.103876113891602, 3.695106029510498, 5.912344932556152, 5.052485466003418, 4.125988960266113, 6.527168273925781, 6.092121124267578, 3.9220962524414062, 4.629209518432617, 6.308775424957275, 3.593782424926758, 7.032808780670166, 4.890419006347656, 5.993504524230957, 5.775567054748535, 6.760732650756836, 5.508115768432617, 3.5231237411499023, 3.036931037902832, 6.396125793457031, 6.7434868812561035, 5.756004333496094, 3.951810121536255, 4.55880069732666, 4.690403938293457, 6.1702399253845215, 4.602689743041992, 4.80992317199707, 4.80925178527832, 5.762599945068359, 3.1552677154541016], "mean_td_error": 5.29517936706543, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 15.0, "diff_num_grad_updates_vs_sampler_policy": 14.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.032649993896484, "actor_loss": -4.3415207862854, "critic_loss": 2.8832969665527344, "alpha_loss": -0.04215998575091362, "alpha_value": 0.9958065152168274, "log_alpha_value": -0.0042022778652608395, "target_entropy": -6.0, "policy_t": 0.030341653153300285, "mean_q": 0.34363144636154175, "max_q": 0.4323490858078003, "min_q": 0.3011069595813751}, "td_error": [4.841259956359863, 3.3092970848083496, 4.5572509765625, 2.9662222862243652, 3.4437005519866943, 2.669093132019043, 4.167352199554443, 2.4665143489837646, 1.5089467763900757, 4.715697288513184, 2.474269390106201, 3.8294291496276855, 3.296755790710449, 3.4112954139709473, 2.3500914573669434, 3.390502452850342, 3.647747278213501, 3.9661128520965576, 2.655999183654785, 2.7856333255767822, 3.5332937240600586, 5.110878944396973, 2.854541778564453, 3.7254505157470703, 5.01392936706543, 2.4804635047912598, 2.1098556518554688, 4.3738813400268555, 3.3095760345458984, 3.7413573265075684, 3.7625532150268555, 5.1722846031188965, 2.0126848220825195, 4.420875549316406, 4.062803268432617, 3.662667751312256, 3.782182455062866, 5.284063339233398, 6.449305534362793, 3.9687588214874268, 3.880979299545288, 3.737262487411499, 4.386082649230957, 3.647291660308838, 4.0997090339660645, 5.957876205444336, 2.989895820617676, 3.28275203704834, 5.121614456176758, 4.012212753295898, 4.084000587463379, 2.8251359462738037, 5.075107574462891, 3.8186450004577637, 1.4747302532196045, 3.128901481628418, 4.574127674102783, 4.277063369750977, 3.898709535598755, 4.700636863708496, 5.869103908538818, 2.368741035461426, 3.960585832595825, 2.714247703552246, 3.211371421813965, 3.6817917823791504, 2.04425048828125, 4.212885856628418, 2.7034976482391357, 2.641049385070801, 3.81772518157959, 2.4964120388031006, 2.1491293907165527, 3.895421028137207, 4.65919303894043, 3.392599105834961, 4.112731456756592, 3.4888863563537598, 2.442901134490967, 3.58333158493042, 4.149409294128418, 3.33016300201416, 5.646984100341797, 4.351158142089844, 5.355271339416504, 2.919360637664795], "mean_td_error": 3.691343069076538, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 15.0, "diff_num_grad_updates_vs_sampler_policy": 14.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0748929977417, "actor_loss": -4.382512092590332, "critic_loss": 1.7784619331359863, "alpha_loss": -0.0423099510371685, "alpha_value": 0.9958092570304871, "log_alpha_value": -0.004199543967843056, "target_entropy": -6.0, "policy_t": -0.005166247952729464, "mean_q": 0.3351074159145355, "max_q": 0.40927988290786743, "min_q": 0.2478562593460083}, "td_error": [2.9073047637939453, 4.832015514373779, 3.7733192443847656, 4.28624153137207, 4.358333587646484, 3.5141587257385254, 3.8315980434417725, 4.599639892578125, 2.3688676357269287, 3.7524170875549316, 4.434429168701172, 2.5928165912628174, 4.506306171417236, 2.9541168212890625, 2.2156200408935547, 4.77337121963501, 2.5385985374450684, 4.919649600982666, 3.4550299644470215, 3.561798095703125, 3.163208484649658, 4.896490573883057, 4.466468334197998, 3.944166660308838, 3.0839321613311768, 3.6188101768493652, 3.435067653656006, 4.289915084838867, 2.647162437438965, 5.494935989379883, 4.104134559631348, 4.054841041564941, 4.415871620178223, 4.0009050369262695, 3.088268756866455, 1.8386934995651245, 4.593632698059082, 4.112549781799316, 4.540127754211426, 3.2027904987335205, 2.6686935424804688, 3.0493502616882324, 3.6350114345550537, 4.1541748046875, 3.338484287261963, 2.6361899375915527, 4.339303970336914, 5.20650053024292, 3.943300247192383, 3.5216662883758545, 4.146450996398926, 2.5523195266723633, 4.079232215881348, 4.605096340179443, 2.658926248550415, 3.5623779296875, 3.6746387481689453, 5.383565902709961, 3.939659595489502, 2.614814043045044, 2.8209900856018066, 3.297321319580078, 2.5301570892333984, 2.6617586612701416, 3.5983128547668457, 5.093830108642578, 4.597663879394531, 4.3955078125, 4.1348795890808105, 3.2538845539093018, 2.1397175788879395, 4.0674238204956055, 2.5842952728271484, 5.444889068603516, 4.549530982971191, 3.146693706512451, 3.642779588699341, 1.7818472385406494, 4.291532516479492, 2.9377381801605225, 4.1393914222717285, 2.187049388885498, 1.743233323097229, 3.052884101867676, 2.6021976470947266, 2.0721144676208496], "mean_td_error": 3.623779058456421, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 15.0, "diff_num_grad_updates_vs_sampler_policy": 14.0}}, "num_env_steps_sampled": 14336, "num_env_steps_trained": 3870, "num_agent_steps_sampled": 43008, "num_agent_steps_trained": 3870, "last_target_update_ts": 14336, "num_target_updates": 15}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 43008, "num_agent_steps_trained": 3870, "num_env_steps_sampled": 14336, "num_env_steps_trained": 3870, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 469.6095423011377, "num_env_steps_trained_throughput_per_sec": 135.22239052867582, "timesteps_total": 14336, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 43008, "timers": {"training_iteration_time_ms": 1962.692, "sample_time_ms": 1366.196, "load_time_ms": 0.529, "load_throughput": 487446.141, "learn_time_ms": 64.609, "learn_throughput": 3993.253, "synch_weights_time_ms": 16.599}, "counters": {"num_env_steps_sampled": 14336, "num_env_steps_trained": 3870, "num_agent_steps_sampled": 43008, "num_agent_steps_trained": 3870, "last_target_update_ts": 14336, "num_target_updates": 15}, "done": false, "episodes_total": 0, "training_iteration": 16, "trial_id": "566d8_00000", "date": "2023-11-16_22-20-49", "timestamp": 1700202049, "time_this_iter_s": 1.9229748249053955, "time_total_s": 32.83051681518555, "pid": 48481, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fb763906820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 32.83051681518555, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 68.10000000000001, "ram_util_percent": 92.40000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.125146865844727, "actor_loss": -4.429353713989258, "critic_loss": 4.495868682861328, "alpha_loss": -0.04558015614748001, "alpha_value": 0.9955084323883057, "log_alpha_value": -0.004501678515225649, "target_entropy": -6.0, "policy_t": -0.03330130875110626, "mean_q": 0.31769609451293945, "max_q": 0.3991401195526123, "min_q": 0.2622726559638977}, "td_error": [5.881725311279297, 4.489612579345703, 5.045892715454102, 4.126802921295166, 5.924656391143799, 4.6925153732299805, 6.0606536865234375, 5.231474876403809, 5.41533088684082, 3.185884475708008, 5.723379135131836, 3.153463363647461, 4.8959808349609375, 7.882428169250488, 3.4020519256591797, 5.9650163650512695, 4.977729320526123, 6.171314239501953, 5.2616376876831055, 4.586674690246582, 5.354951858520508, 4.163908958435059, 6.029818534851074, 5.730917930603027, 3.891697406768799, 4.588408470153809, 5.563840866088867, 5.868325233459473, 4.432830810546875, 4.893823623657227, 5.78010368347168, 3.4753623008728027, 3.5149824619293213, 4.31090784072876, 6.499085426330566, 5.892529487609863, 5.552884101867676, 5.272246837615967, 4.322718620300293, 6.433961868286133, 4.925183296203613, 4.617190361022949, 4.866306304931641, 5.5660719871521, 4.466366767883301, 5.97169303894043, 5.544693946838379, 5.941938877105713, 5.768274307250977, 3.7603654861450195, 6.119232177734375, 4.040630340576172, 5.758183002471924, 6.290545463562012, 5.568018913269043, 4.732553482055664, 4.673421859741211, 5.1677961349487305, 4.342099666595459, 4.584329605102539, 7.0699357986450195, 5.4557976722717285, 4.611181259155273, 4.782360076904297, 4.545628070831299, 3.394432783126831, 6.216334819793701, 6.643768310546875, 5.567924499511719, 4.638327598571777, 4.927896976470947, 4.159635543823242, 6.730225563049316, 6.518580913543701, 5.906606674194336, 7.193615436553955, 5.453908443450928, 5.868581771850586, 5.851261138916016, 2.201539993286133, 5.567091941833496, 5.192187309265137, 3.3730499744415283, 4.123149871826172, 6.317007064819336, 4.304825782775879], "mean_td_error": 5.150782585144043, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 16.0, "diff_num_grad_updates_vs_sampler_policy": 15.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.100894927978516, "actor_loss": -4.452328681945801, "critic_loss": 2.8599164485931396, "alpha_loss": -0.045478563755750656, "alpha_value": 0.9955077171325684, "log_alpha_value": -0.004502428695559502, "target_entropy": -6.0, "policy_t": -0.0046620117500424385, "mean_q": 0.3908943831920624, "max_q": 0.49211251735687256, "min_q": 0.31340208649635315}, "td_error": [2.6718740463256836, 4.722694396972656, 1.936318039894104, 4.311749458312988, 3.502812385559082, 3.8057188987731934, 3.562626600265503, 3.762545585632324, 5.7104949951171875, 3.294597625732422, 3.482241630554199, 3.847712993621826, 5.530572891235352, 3.0973339080810547, 3.476210117340088, 4.289751052856445, 4.3414459228515625, 3.98394513130188, 3.522193431854248, 3.9913363456726074, 3.858917236328125, 3.772843837738037, 3.4882402420043945, 1.2769596576690674, 2.7344815731048584, 3.360612392425537, 2.0607571601867676, 4.841724395751953, 1.9764920473098755, 3.8244593143463135, 2.0527820587158203, 3.206177234649658, 3.2399744987487793, 3.0155839920043945, 4.84774923324585, 3.936345100402832, 6.052115440368652, 1.6930346488952637, 4.468321800231934, 5.563579082489014, 5.4189910888671875, 4.36639404296875, 2.766073226928711, 4.32612419128418, 1.5502071380615234, 5.8855085372924805, 3.6228232383728027, 4.033989429473877, 4.00786018371582, 4.6772871017456055, 3.7275595664978027, 4.467111587524414, 3.326479911804199, 4.342878818511963, 3.0026493072509766, 3.2417526245117188, 3.013242721557617, 3.0385379791259766, 3.4267516136169434, 2.8846373558044434, 1.7115764617919922, 2.860670328140259, 5.991661071777344, 3.8406946659088135, 3.130795955657959, 4.1517438888549805, 4.120102882385254, 5.372354030609131, 3.8988194465637207, 3.845170736312866, 4.777156829833984, 2.8914849758148193, 2.8215079307556152, 1.3218268156051636, 3.489013195037842, 3.300157070159912, 3.400266647338867, 3.3594260215759277, 4.123924732208252, 3.0800344944000244, 3.470907211303711, 3.9732155799865723, 3.7711052894592285, 4.254570960998535, 4.4702653884887695, 3.3356733322143555], "mean_td_error": 3.6744916439056396, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 16.0, "diff_num_grad_updates_vs_sampler_policy": 15.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.104703903198242, "actor_loss": -4.451716423034668, "critic_loss": 1.6680248975753784, "alpha_loss": -0.04546626657247543, "alpha_value": 0.9955105781555176, "log_alpha_value": -0.004499515052884817, "target_entropy": -6.0, "policy_t": 0.033848732709884644, "mean_q": 0.3713882863521576, "max_q": 0.47109100222587585, "min_q": 0.31229737401008606}, "td_error": [2.5190558433532715, 1.887272834777832, 3.7977161407470703, 2.5756783485412598, 4.788376808166504, 3.387814998626709, 3.0338377952575684, 3.895002841949463, 2.396420955657959, 3.207094669342041, 2.6044564247131348, 3.8920950889587402, 0.9415470957756042, 2.854499340057373, 2.859450340270996, 4.308999538421631, 3.0204057693481445, 0.6011907458305359, 3.319094181060791, 4.311953067779541, 2.5679378509521484, 3.724485397338867, 3.8221821784973145, 3.4367313385009766, 3.629058837890625, 4.917300224304199, 3.2283620834350586, 3.5661537647247314, 4.120724678039551, 2.99110746383667, 3.901618003845215, 3.2271852493286133, 3.1960136890411377, 3.340265989303589, 4.770916938781738, 3.0894856452941895, 2.0573649406433105, 5.334991931915283, 5.388028621673584, 2.9570274353027344, 2.6919307708740234, 5.08531379699707, 2.39115571975708, 4.029524803161621, 3.7194690704345703, 1.8576050996780396, 2.946683883666992, 3.3271291255950928, 4.431082725524902, 2.994760513305664, 3.580777168273926, 5.139492988586426, 1.9902279376983643, 3.5283451080322266, 1.5825015306472778, 3.668034315109253, 2.933443546295166, 3.7556536197662354, 3.9388647079467773, 4.2344560623168945, 4.425363540649414, 4.195422172546387, 3.518266439437866, 3.4268879890441895, 4.417600631713867, 3.0936803817749023, 3.4640467166900635, 3.004833698272705, 3.5052976608276367, 4.940934181213379, 4.958371162414551, 3.7979178428649902, 3.066169261932373, 3.038675546646118, 2.614736557006836, 4.384443283081055, 4.058053970336914, 3.612830638885498, 5.289700984954834, 2.75754714012146, 2.6760127544403076, 2.543114423751831, 4.67484188079834, 2.6465811729431152, 4.518885612487793, 1.8302991390228271], "mean_td_error": 3.4390220642089844, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 16.0, "diff_num_grad_updates_vs_sampler_policy": 15.0}}, "num_env_steps_sampled": 15232, "num_env_steps_trained": 4128, "num_agent_steps_sampled": 45696, "num_agent_steps_trained": 4128, "last_target_update_ts": 15232, "num_target_updates": 16}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 45696, "num_agent_steps_trained": 4128, "num_env_steps_sampled": 15232, "num_env_steps_trained": 4128, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 463.7241852119707, "num_env_steps_trained_throughput_per_sec": 133.52772297398263, "timesteps_total": 15232, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 45696, "timers": {"training_iteration_time_ms": 1958.928, "sample_time_ms": 1362.692, "load_time_ms": 0.533, "load_throughput": 484326.381, "learn_time_ms": 64.613, "learn_throughput": 3992.995, "synch_weights_time_ms": 16.182}, "counters": {"num_env_steps_sampled": 15232, "num_env_steps_trained": 4128, "num_agent_steps_sampled": 45696, "num_agent_steps_trained": 4128, "last_target_update_ts": 15232, "num_target_updates": 16}, "done": false, "episodes_total": 0, "training_iteration": 17, "trial_id": "566d8_00000", "date": "2023-11-16_22-20-51", "timestamp": 1700202051, "time_this_iter_s": 1.9528801441192627, "time_total_s": 34.78339695930481, "pid": 48481, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fb7906b08b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 34.78339695930481, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 92.15, "ram_util_percent": 92.35}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.105717658996582, "actor_loss": -4.449004650115967, "critic_loss": 4.645925521850586, "alpha_loss": -0.048527754843235016, "alpha_value": 0.9952095150947571, "log_alpha_value": -0.004802009556442499, "target_entropy": -6.0, "policy_t": 0.004383563529700041, "mean_q": 0.37050241231918335, "max_q": 0.46952658891677856, "min_q": 0.29398491978645325}, "td_error": [4.764101028442383, 4.642238140106201, 6.116135597229004, 5.277067184448242, 5.309956073760986, 4.200058937072754, 6.516776084899902, 4.487070083618164, 5.833034515380859, 6.13911247253418, 6.734776496887207, 5.118038177490234, 3.331918478012085, 3.7338218688964844, 5.187149524688721, 5.497818946838379, 5.2083940505981445, 5.9255690574646, 4.613643646240234, 6.367081642150879, 3.3894481658935547, 5.1946611404418945, 6.427873611450195, 4.768470287322998, 5.475746154785156, 5.586598873138428, 6.2557148933410645, 4.075547218322754, 5.882808685302734, 4.7889604568481445, 5.322134017944336, 6.882769584655762, 6.334697723388672, 4.300683975219727, 5.146100044250488, 4.543144226074219, 5.225630760192871, 4.316494941711426, 6.3542256355285645, 4.105238914489746, 6.321848392486572, 6.003999710083008, 6.159062385559082, 5.985890865325928, 6.522195816040039, 4.717681407928467, 3.958717107772827, 3.7981534004211426, 3.582961082458496, 4.68242073059082, 6.127190113067627, 6.743893623352051, 4.840948104858398, 5.781088829040527, 4.175161361694336, 5.017977714538574, 5.441448211669922, 6.711812973022461, 5.324223518371582, 4.558445930480957, 6.286581039428711, 5.583436965942383, 4.778900623321533, 6.034990310668945, 4.691018104553223, 5.897607803344727, 6.317542552947998, 6.42516565322876, 4.937992572784424, 5.920588493347168, 4.088603973388672, 5.602176189422607, 7.944935321807861, 4.68099308013916, 5.582544803619385, 1.8323180675506592, 4.476842880249023, 4.951250076293945, 5.363831520080566, 6.830573081970215, 6.8174285888671875, 5.127058506011963, 4.643954753875732, 7.042085647583008, 5.227543354034424, 6.991299629211426], "mean_td_error": 5.3478264808654785, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 17.0, "diff_num_grad_updates_vs_sampler_policy": 16.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.043042182922363, "actor_loss": -4.444601535797119, "critic_loss": 2.7970128059387207, "alpha_loss": -0.04823293164372444, "alpha_value": 0.9952089190483093, "log_alpha_value": -0.004802621901035309, "target_entropy": -6.0, "policy_t": 0.008096687495708466, "mean_q": 0.4358602464199066, "max_q": 0.5186128616333008, "min_q": 0.3802523910999298}, "td_error": [4.039963245391846, 1.9617037773132324, 5.509294509887695, 3.299436092376709, 2.752593517303467, 5.40248441696167, 4.908607482910156, 2.5066115856170654, 3.9971556663513184, 5.389315605163574, 2.9846112728118896, 3.469820499420166, 1.4571102857589722, 4.454255104064941, 2.0093419551849365, 1.3056379556655884, 2.8279876708984375, 4.2626633644104, 4.387917995452881, 3.4046597480773926, 4.030406951904297, 2.1865429878234863, 2.5941929817199707, 3.479851245880127, 2.9844202995300293, 4.687904357910156, 4.7540602684021, 3.368614912033081, 2.0573041439056396, 4.030731201171875, 3.798961639404297, 2.4393749237060547, 5.493758678436279, 4.544737815856934, 2.6940770149230957, 3.845791816711426, 1.1124818325042725, 3.9908640384674072, 6.355898857116699, 3.909149646759033, 4.43962287902832, 3.6489906311035156, 1.6379560232162476, 4.062410354614258, 3.7435879707336426, 3.8371708393096924, 5.237340927124023, 5.505389213562012, 2.816415309906006, 2.1106863021850586, 3.9211368560791016, 2.6330924034118652, 2.8008174896240234, 3.5965576171875, 4.937361240386963, 4.244503974914551, 1.4668923616409302, 1.4588886499404907, 2.0786564350128174, 3.289682149887085, 3.144247531890869, 4.612250328063965, 3.442600727081299, 2.8219425678253174, 4.744945526123047, 3.20640230178833, 1.4949496984481812, 4.192781448364258, 5.376279354095459, 3.3752851486206055, 2.809340000152588, 3.3243038654327393, 2.2066550254821777, 3.630788803100586, 4.659859657287598, 2.2703990936279297, 4.231678009033203, 2.934413194656372, 5.610042572021484, 3.4875729084014893, 4.3653717041015625, 4.839941501617432, 1.8389261960983276, 3.6794118881225586, 2.4520554542541504, 5.560869216918945], "mean_td_error": 3.540358543395996, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 17.0, "diff_num_grad_updates_vs_sampler_policy": 16.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.08487319946289, "actor_loss": -4.477952003479004, "critic_loss": 1.7910852432250977, "alpha_loss": -0.04840260371565819, "alpha_value": 0.9952119588851929, "log_alpha_value": -0.004799525253474712, "target_entropy": -6.0, "policy_t": -0.020126013085246086, "mean_q": 0.4165942966938019, "max_q": 0.479780375957489, "min_q": 0.3319229185581207}, "td_error": [3.0796608924865723, 3.5105948448181152, 3.6975479125976562, 5.259997367858887, 3.5704751014709473, 2.927961826324463, 4.162960052490234, 2.434004306793213, 2.85465931892395, 3.489265203475952, 1.8545076847076416, 3.6237640380859375, 3.357451915740967, 4.137246131896973, 3.9605791568756104, 2.617499351501465, 4.381523132324219, 3.627715587615967, 3.5223121643066406, 2.9583988189697266, 4.972898960113525, 2.6752471923828125, 2.5064282417297363, 3.800137996673584, 3.620913028717041, 3.5244908332824707, 3.8653488159179688, 5.392728805541992, 1.935570478439331, 2.8473992347717285, 3.231074333190918, 4.9718017578125, 2.5647974014282227, 3.7729740142822266, 3.553156852722168, 4.797295570373535, 1.8271386623382568, 3.741212844848633, 2.4601492881774902, 4.2431840896606445, 3.7762317657470703, 2.253619432449341, 3.514641284942627, 4.47537899017334, 4.584300518035889, 3.5197792053222656, 2.180083751678467, 5.23879861831665, 2.883305072784424, 2.890302896499634, 3.4790244102478027, 3.2201223373413086, 2.8656513690948486, 3.756012439727783, 1.6958881616592407, 4.7840495109558105, 3.8704681396484375, 2.9973227977752686, 5.49729061126709, 4.4730730056762695, 4.097008228302002, 2.69461727142334, 4.611180782318115, 2.5110201835632324, 4.676092147827148, 2.768282890319824, 3.920645236968994, 3.1440513134002686, 3.6363205909729004, 5.176662921905518, 4.248588562011719, 3.717028856277466, 4.574662208557129, 4.067587852478027, 4.555697917938232, 3.107219696044922, 4.5426177978515625, 2.313708782196045, 4.619170188903809, 2.1550989151000977, 3.98686146736145, 3.520778179168701, 4.385262966156006, 3.991882562637329, 3.8606724739074707, 3.210784912109375], "mean_td_error": 3.5974526405334473, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 17.0, "diff_num_grad_updates_vs_sampler_policy": 16.0}}, "num_env_steps_sampled": 16128, "num_env_steps_trained": 4386, "num_agent_steps_sampled": 48384, "num_agent_steps_trained": 4386, "last_target_update_ts": 16128, "num_target_updates": 17}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48384, "num_agent_steps_trained": 4386, "num_env_steps_sampled": 16128, "num_env_steps_trained": 4386, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 359.99881446751954, "num_env_steps_trained_throughput_per_sec": 103.66037291587058, "timesteps_total": 16128, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 48384, "timers": {"training_iteration_time_ms": 2005.25, "sample_time_ms": 1409.463, "load_time_ms": 0.531, "load_throughput": 486285.189, "learn_time_ms": 64.221, "learn_throughput": 4017.369, "synch_weights_time_ms": 16.048}, "counters": {"num_env_steps_sampled": 16128, "num_env_steps_trained": 4386, "num_agent_steps_sampled": 48384, "num_agent_steps_trained": 4386, "last_target_update_ts": 16128, "num_target_updates": 17}, "done": false, "episodes_total": 0, "training_iteration": 18, "trial_id": "566d8_00000", "date": "2023-11-16_22-20-54", "timestamp": 1700202054, "time_this_iter_s": 2.5036041736602783, "time_total_s": 37.28700113296509, "pid": 48481, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fb7906b0e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 37.28700113296509, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 69.45, "ram_util_percent": 92.45}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.062800407409668, "actor_loss": -4.439181804656982, "critic_loss": 4.267425537109375, "alpha_loss": -0.051343802362680435, "alpha_value": 0.9949106574058533, "log_alpha_value": -0.005102337338030338, "target_entropy": -6.0, "policy_t": -0.0029394826851785183, "mean_q": 0.4017694294452667, "max_q": 0.5013234615325928, "min_q": 0.31505173444747925}, "td_error": [6.456901550292969, 4.866537094116211, 6.100249290466309, 3.5664634704589844, 4.010019302368164, 6.031290054321289, 4.164085865020752, 3.5348401069641113, 2.033979892730713, 4.108471870422363, 4.703038692474365, 3.122006893157959, 3.9428420066833496, 5.771526336669922, 6.029782295227051, 4.279170036315918, 2.7815303802490234, 4.409665107727051, 4.078516483306885, 3.7678511142730713, 4.115261077880859, 6.595616817474365, 6.073363304138184, 3.8141462802886963, 3.951376438140869, 5.2624335289001465, 5.216884613037109, 4.534749507904053, 5.470266342163086, 5.910678386688232, 4.383137226104736, 2.905945301055908, 6.536779403686523, 6.446724891662598, 5.182635307312012, 5.328240871429443, 3.889880895614624, 5.057454586029053, 5.830012798309326, 3.881985902786255, 2.7385196685791016, 5.120017051696777, 4.758508682250977, 5.874120712280273, 3.7001357078552246, 6.3128838539123535, 4.844971656799316, 3.78277587890625, 6.576684951782227, 5.590097427368164, 5.3669304847717285, 4.37994384765625, 7.627431869506836, 5.751016616821289, 5.594083786010742, 4.4536237716674805, 6.00216007232666, 3.573805093765259, 5.556629180908203, 4.8385138511657715, 4.126763343811035, 5.320223808288574, 3.8182296752929688, 5.340188980102539, 6.510531425476074, 6.641902923583984, 8.841838836669922, 3.1176114082336426, 3.7427449226379395, 5.903438568115234, 5.211688041687012, 4.676520347595215, 4.795763969421387, 3.121530771255493, 5.413987159729004, 6.089380264282227, 6.320600509643555, 7.09710168838501, 4.933026313781738, 5.428367614746094, 6.330702781677246, 5.816256523132324, 7.585122108459473, 6.427217483520508, 4.695524215698242, 4.259670734405518], "mean_td_error": 5.025059700012207, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 18.0, "diff_num_grad_updates_vs_sampler_policy": 17.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.09177303314209, "actor_loss": -4.541057109832764, "critic_loss": 2.7944908142089844, "alpha_loss": -0.0514957532286644, "alpha_value": 0.9949102401733398, "log_alpha_value": -0.005102745722979307, "target_entropy": -6.0, "policy_t": 0.02568911388516426, "mean_q": 0.488417387008667, "max_q": 0.6150417923927307, "min_q": 0.402033269405365}, "td_error": [4.618436813354492, 1.772705316543579, 4.235383987426758, 2.904155731201172, 3.6633729934692383, 3.1354455947875977, 5.414522171020508, 4.1493120193481445, 3.620448589324951, 4.421720504760742, 2.262235164642334, 2.845562219619751, 4.083019256591797, 2.7817492485046387, 2.7833900451660156, 3.250026226043701, 5.622042655944824, 5.642488479614258, 3.972529649734497, 3.5800743103027344, 2.6524765491485596, 3.8210153579711914, 3.326263427734375, 3.009878635406494, 2.20938777923584, 3.271087408065796, 2.56887149810791, 2.2355754375457764, 3.1652090549468994, 4.524257183074951, 2.7872047424316406, 3.2481918334960938, 3.5335795879364014, 3.8747100830078125, 3.5360522270202637, 1.8762645721435547, 3.6304969787597656, 0.45504122972488403, 2.9400434494018555, 4.8787384033203125, 4.142874240875244, 5.222315311431885, 4.234719276428223, 2.8146350383758545, 5.2194061279296875, 3.9128899574279785, 5.419716835021973, 4.276689529418945, 2.552752733230591, 5.33464241027832, 1.6646167039871216, 3.940864086151123, 5.133829593658447, 4.820498466491699, 3.0341944694519043, 4.340933799743652, 3.4235787391662598, 4.986190319061279, 4.231433868408203, 3.777647018432617, 3.2973012924194336, 2.693995475769043, 2.098123073577881, 2.7649621963500977, 3.253408908843994, 3.955428123474121, 2.8569302558898926, 3.859827995300293, 4.180329322814941, 3.434231758117676, 2.7217676639556885, 3.041834831237793, 4.078861713409424, 4.769120216369629, 3.7790727615356445, 4.040361404418945, 2.729581356048584, 4.156988143920898, 3.389038562774658, 2.472933292388916, 3.0991625785827637, 3.3356335163116455, 4.092846870422363, 3.3948264122009277, 4.067628860473633, 2.714704751968384], "mean_td_error": 3.5705385208129883, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 18.0, "diff_num_grad_updates_vs_sampler_policy": 17.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.065717697143555, "actor_loss": -4.50608491897583, "critic_loss": 1.6679524183273315, "alpha_loss": -0.051330454647541046, "alpha_value": 0.9949134588241577, "log_alpha_value": -0.005099532660096884, "target_entropy": -6.0, "policy_t": 0.0014686168869957328, "mean_q": 0.46574312448501587, "max_q": 0.6489173769950867, "min_q": 0.37129083275794983}, "td_error": [2.4476304054260254, 3.567748785018921, 4.276793479919434, 3.073880672454834, 2.514983892440796, 4.026002883911133, 2.9446399211883545, 1.7124555110931396, 2.5741162300109863, 2.9939804077148438, 3.978672504425049, 3.5629968643188477, 4.004441738128662, 2.2181692123413086, 3.8882594108581543, 1.6600769758224487, 2.942246913909912, 3.5890541076660156, 3.7194766998291016, 3.0710062980651855, 3.6311304569244385, 2.6594080924987793, 2.7752304077148438, 1.4938305616378784, 3.0145230293273926, 4.185965538024902, 2.033877372741699, 3.4868078231811523, 1.6371395587921143, 5.69370174407959, 3.3544979095458984, 4.254544734954834, 2.9499244689941406, 5.335049629211426, 1.511961817741394, 4.132086753845215, 4.299943923950195, 2.470917224884033, 4.241471290588379, 3.961543083190918, 3.5280399322509766, 5.4759135246276855, 3.264148235321045, 4.014579772949219, 3.2236433029174805, 2.9534213542938232, 0.9595295190811157, 3.896268367767334, 3.7696118354797363, 4.820164680480957, 3.93544602394104, 3.9915637969970703, 3.437134027481079, 1.8340938091278076, 3.8621835708618164, 3.22088623046875, 4.4271745681762695, 2.2549521923065186, 3.036245107650757, 3.9766416549682617, 3.903101682662964, 3.454484462738037, 2.836670398712158, 5.926695823669434, 2.224616050720215, 1.0681939125061035, 3.8267927169799805, 4.416090965270996, 3.737180233001709, 5.578010559082031, 2.749112129211426, 2.521397113800049, 3.867615222930908, 2.7015976905822754, 2.3284530639648438, 3.3379318714141846, 4.167355537414551, 4.26826286315918, 4.570749759674072, 2.7892966270446777, 3.5786170959472656, 2.1621196269989014, 3.7585673332214355, 4.643436431884766, 4.573988437652588, 1.59275221824646], "mean_td_error": 3.3762199878692627, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 18.0, "diff_num_grad_updates_vs_sampler_policy": 17.0}}, "num_env_steps_sampled": 17024, "num_env_steps_trained": 4644, "num_agent_steps_sampled": 51072, "num_agent_steps_trained": 4644, "last_target_update_ts": 17024, "num_target_updates": 18}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51072, "num_agent_steps_trained": 4644, "num_env_steps_sampled": 17024, "num_env_steps_trained": 4644, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 420.0819959352129, "num_env_steps_trained_throughput_per_sec": 120.96111043670193, "timesteps_total": 17024, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 51072, "timers": {"training_iteration_time_ms": 2027.133, "sample_time_ms": 1408.268, "load_time_ms": 0.531, "load_throughput": 486263.338, "learn_time_ms": 64.087, "learn_throughput": 4025.769, "synch_weights_time_ms": 16.294}, "counters": {"num_env_steps_sampled": 17024, "num_env_steps_trained": 4644, "num_agent_steps_sampled": 51072, "num_agent_steps_trained": 4644, "last_target_update_ts": 17024, "num_target_updates": 18}, "done": false, "episodes_total": 0, "training_iteration": 19, "trial_id": "566d8_00000", "date": "2023-11-16_22-20-56", "timestamp": 1700202056, "time_this_iter_s": 2.1493351459503174, "time_total_s": 39.436336278915405, "pid": 48481, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fb7906b0dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 39.436336278915405, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 66.06666666666666, "ram_util_percent": 92.40000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.134872436523438, "actor_loss": -4.5554046630859375, "critic_loss": 4.312658309936523, "alpha_loss": -0.054754484444856644, "alpha_value": 0.9946119785308838, "log_alpha_value": -0.005402583163231611, "target_entropy": -6.0, "policy_t": -0.048610080033540726, "mean_q": 0.4590305984020233, "max_q": 0.5878044962882996, "min_q": 0.36768776178359985}, "td_error": [4.52243709564209, 7.4395012855529785, 4.997133255004883, 6.444117546081543, 6.187225818634033, 3.787177324295044, 5.520238876342773, 8.118867874145508, 5.544508934020996, 3.8393120765686035, 5.3101420402526855, 4.744715213775635, 4.816901206970215, 5.905616760253906, 4.559950828552246, 6.567556381225586, 4.589493751525879, 4.355335712432861, 5.85273551940918, 5.20196533203125, 5.09476375579834, 5.927465438842773, 5.809677600860596, 5.172011375427246, 6.053926467895508, 4.863215446472168, 5.025762557983398, 4.8870038986206055, 5.408891677856445, 4.963815689086914, 6.1257524490356445, 5.502346038818359, 3.454374313354492, 4.19766902923584, 4.6760711669921875, 4.401695251464844, 3.8599212169647217, 3.455535411834717, 3.9350552558898926, 6.167760848999023, 5.368762016296387, 4.076725482940674, 4.4582061767578125, 5.880054473876953, 7.716131210327148, 6.708295822143555, 6.757796287536621, 5.566571235656738, 6.26075553894043, 5.868160247802734, 6.0685529708862305, 5.736886978149414, 2.3919517993927, 3.890399217605591, 2.211088180541992, 6.134771347045898, 5.61810827255249, 5.447546005249023, 3.6934409141540527, 5.0662150382995605, 3.606675624847412, 4.257830619812012, 3.100926160812378, 5.161011219024658, 4.771007537841797, 3.0974137783050537, 4.141672611236572, 5.713505744934082, 4.897944450378418, 4.772434234619141, 5.264373779296875, 4.158596038818359, 5.439436435699463, 4.6213884353637695, 3.9486985206604004, 5.442663192749023, 4.110598564147949, 5.374844551086426, 5.060853004455566, 6.6082940101623535, 5.352419853210449, 5.8173747062683105, 4.5605878829956055, 3.3045597076416016, 4.027658939361572, 4.338808059692383], "mean_td_error": 5.036739826202393, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 19.0, "diff_num_grad_updates_vs_sampler_policy": 18.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.065339088439941, "actor_loss": -4.56579065322876, "critic_loss": 2.3332221508026123, "alpha_loss": -0.05438202992081642, "alpha_value": 0.9946116805076599, "log_alpha_value": -0.005402900278568268, "target_entropy": -6.0, "policy_t": 0.00525977136567235, "mean_q": 0.5252643823623657, "max_q": 0.6177166700363159, "min_q": 0.4240477383136749}, "td_error": [2.709989309310913, 1.5924365520477295, 5.895583629608154, 3.151263475418091, 2.415548086166382, 3.6218385696411133, 2.2668509483337402, 4.084240913391113, 2.3871357440948486, 4.008969783782959, 4.540088653564453, 1.9999573230743408, 3.7065820693969727, 2.604316473007202, 3.8014168739318848, 4.188356399536133, 2.2595856189727783, 4.609953880310059, 5.339343070983887, 2.260481834411621, 3.9159438610076904, 3.291339635848999, 2.954498767852783, 3.3024864196777344, 3.631948471069336, 2.679422378540039, 3.4761464595794678, 2.4074866771698, 3.8103902339935303, 4.131490230560303, 3.817058563232422, 2.388289451599121, 2.45174241065979, 1.7877154350280762, 5.157101154327393, 3.607872486114502, 3.37050461769104, 4.5507025718688965, 4.030616760253906, 2.5001325607299805, 1.9715158939361572, 3.8466403484344482, 2.468900680541992, 2.3199548721313477, 3.4509289264678955, 5.0279541015625, 5.409398078918457, 5.121242523193359, 4.505980491638184, 3.0761959552764893, 3.7244949340820312, 2.7757346630096436, 1.991278052330017, 6.029421329498291, 2.982954502105713, 4.202213287353516, 3.4360716342926025, 3.9447460174560547, 3.093964099884033, 3.8305253982543945, 0.9807481169700623, 4.805469989776611, 2.1264500617980957, 5.219653129577637, 3.1314125061035156, 3.519538402557373, 2.0883593559265137, 4.23191499710083, 2.699209213256836, 3.8981781005859375, 4.510439872741699, 3.145969867706299, 2.9775142669677734, 3.368134021759033, 3.029078483581543, 3.2665622234344482, 4.543727874755859, 3.8998661041259766, 5.734667778015137, 3.28953218460083, 4.034190654754639, 3.6425204277038574, 6.0222015380859375, 2.875126361846924, 3.606792449951172, 3.3003811836242676], "mean_td_error": 3.5100533962249756, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 19.0, "diff_num_grad_updates_vs_sampler_policy": 18.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.084269523620605, "actor_loss": -4.571286201477051, "critic_loss": 1.7643640041351318, "alpha_loss": -0.05445003882050514, "alpha_value": 0.9946150779724121, "log_alpha_value": -0.005399502348154783, "target_entropy": -6.0, "policy_t": -0.03992018476128578, "mean_q": 0.519859254360199, "max_q": 0.6040990352630615, "min_q": 0.44068318605422974}, "td_error": [4.542494773864746, 3.8914198875427246, 2.315525770187378, 3.530611753463745, 3.501530170440674, 4.739840507507324, 2.5747077465057373, 3.4796056747436523, 1.9249374866485596, 4.007023334503174, 2.837085723876953, 4.485710144042969, 2.987241744995117, 3.1200671195983887, 3.9242804050445557, 3.883347511291504, 3.2978646755218506, 3.6152589321136475, 2.2346317768096924, 4.278619766235352, 4.542361259460449, 3.385880470275879, 3.910461664199829, 3.8398945331573486, 4.394678115844727, 3.2484962940216064, 4.06101131439209, 1.1614582538604736, 2.9168591499328613, 4.6998090744018555, 3.6844229698181152, 4.483379364013672, 3.6272478103637695, 3.2727084159851074, 2.8886756896972656, 3.276233673095703, 3.079979419708252, 4.3333964347839355, 2.9931588172912598, 3.1448843479156494, 4.697796821594238, 3.8704769611358643, 4.634575366973877, 5.115273475646973, 1.6608765125274658, 4.367413520812988, 4.648050308227539, 4.248471260070801, 3.262739419937134, 3.6829111576080322, 0.29682379961013794, 3.4096193313598633, 2.974635124206543, 3.569610118865967, 4.562442302703857, 1.4988303184509277, 3.8155357837677, 3.150005340576172, 3.375878095626831, 5.018300533294678, 3.4369192123413086, 3.9968204498291016, 4.287275314331055, 4.130297660827637, 3.9923861026763916, 2.7595252990722656, 3.3440022468566895, 3.7773513793945312, 4.50909423828125, 2.5014729499816895, 3.4316391944885254, 2.865277051925659, 6.1307244300842285, 5.029024124145508, 3.3652939796447754, 2.388338088989258, 2.4489011764526367, 3.3083596229553223, 3.1385955810546875, 3.9931416511535645, 6.672286510467529, 3.7780253887176514, 5.924325942993164, 2.9556214809417725, 3.1021995544433594, 1.8438396453857422], "mean_td_error": 3.5940442085266113, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 19.0, "diff_num_grad_updates_vs_sampler_policy": 18.0}}, "num_env_steps_sampled": 17920, "num_env_steps_trained": 4902, "num_agent_steps_sampled": 53760, "num_agent_steps_trained": 4902, "last_target_update_ts": 17920, "num_target_updates": 19}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 53760, "num_agent_steps_trained": 4902, "num_env_steps_sampled": 17920, "num_env_steps_trained": 4902, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 485.35987633585165, "num_env_steps_trained_throughput_per_sec": 139.7576429627787, "timesteps_total": 17920, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 53760, "timers": {"training_iteration_time_ms": 2029.212, "sample_time_ms": 1409.97, "load_time_ms": 0.533, "load_throughput": 484348.058, "learn_time_ms": 64.102, "learn_throughput": 4024.811, "synch_weights_time_ms": 16.667}, "counters": {"num_env_steps_sampled": 17920, "num_env_steps_trained": 4902, "num_agent_steps_sampled": 53760, "num_agent_steps_trained": 4902, "last_target_update_ts": 17920, "num_target_updates": 19}, "done": false, "episodes_total": 0, "training_iteration": 20, "trial_id": "566d8_00000", "date": "2023-11-16_22-20-58", "timestamp": 1700202058, "time_this_iter_s": 1.8593342304229736, "time_total_s": 41.29567050933838, "pid": 48481, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fb7906b04c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 41.29567050933838, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 63.53333333333334, "ram_util_percent": 92.40000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.104371070861816, "actor_loss": -4.5717339515686035, "critic_loss": 4.4625091552734375, "alpha_loss": -0.057624150067567825, "alpha_value": 0.9943133592605591, "log_alpha_value": -0.005702892318367958, "target_entropy": -6.0, "policy_t": -0.013585086911916733, "mean_q": 0.5004547238349915, "max_q": 0.6528761386871338, "min_q": 0.40641817450523376}, "td_error": [3.905282497406006, 4.972357749938965, 4.596802711486816, 6.818325042724609, 3.3052358627319336, 5.526954650878906, 5.44468355178833, 6.0160417556762695, 4.2637619972229, 4.973662853240967, 5.463844299316406, 5.314382553100586, 4.747556209564209, 5.785812854766846, 7.598649024963379, 5.092504501342773, 5.3878173828125, 4.81158971786499, 3.719330310821533, 5.253575325012207, 4.489451885223389, 5.81142520904541, 5.801793098449707, 4.923710823059082, 5.598125457763672, 6.16990327835083, 6.903481483459473, 5.563019275665283, 5.9323883056640625, 4.0769476890563965, 6.150962829589844, 4.78248405456543, 7.197815418243408, 5.19236946105957, 5.704718589782715, 6.414669036865234, 5.144625186920166, 4.53685188293457, 4.202414512634277, 4.472770690917969, 4.56613302230835, 4.429588317871094, 5.360177993774414, 5.4331583976745605, 6.962729454040527, 5.299585342407227, 3.78745174407959, 4.861813545227051, 6.1295485496521, 6.2181220054626465, 4.86090087890625, 6.883305549621582, 4.24530029296875, 6.081669330596924, 3.7848284244537354, 3.7744462490081787, 4.285306930541992, 6.290470123291016, 4.952121734619141, 5.818866729736328, 6.0003461837768555, 4.962199687957764, 6.01020622253418, 3.8382444381713867, 5.389000415802002, 3.9201135635375977, 5.6027984619140625, 6.259955406188965, 5.908771514892578, 7.1081342697143555, 5.212141990661621, 5.104419708251953, 6.303672790527344, 5.833747386932373, 3.056049346923828, 4.296523094177246, 6.995208740234375, 4.5276899337768555, 3.8463587760925293, 4.492597579956055, 3.7860913276672363, 4.173373222351074, 4.057890892028809, 3.233678102493286, 5.954456329345703, 5.218411445617676], "mean_td_error": 5.199833869934082, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 20.0, "diff_num_grad_updates_vs_sampler_policy": 19.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.075157165527344, "actor_loss": -4.627720355987549, "critic_loss": 2.419105052947998, "alpha_loss": -0.05745893344283104, "alpha_value": 0.9943131804466248, "log_alpha_value": -0.0057030306197702885, "target_entropy": -6.0, "policy_t": -0.00042991721420548856, "mean_q": 0.592306911945343, "max_q": 0.7102071642875671, "min_q": 0.5019312500953674}, "td_error": [3.1205363273620605, 4.578535079956055, 3.927729845046997, 2.1661274433135986, 4.204690456390381, 1.756096363067627, 2.1677889823913574, 2.9914090633392334, 3.8554654121398926, 1.6781589984893799, 2.9124653339385986, 1.7989413738250732, 3.2790746688842773, 2.589371681213379, 4.094363212585449, 3.6640610694885254, 5.1379804611206055, 4.023665428161621, 3.565288543701172, 3.150599479675293, 3.8315494060516357, 5.912470817565918, 2.9595606327056885, 3.440247058868408, 5.582329750061035, 3.8642189502716064, 3.4695048332214355, 1.2505213022232056, 2.549787998199463, 3.0903406143188477, 3.7981934547424316, 4.016223907470703, 3.1216750144958496, 3.5576272010803223, 3.2848095893859863, 2.8877933025360107, 3.780566930770874, 4.395026206970215, 3.1700048446655273, 5.047311782836914, 2.5341873168945312, 4.892218589782715, 1.3632557392120361, 4.749306678771973, 4.066251754760742, 2.9538278579711914, 2.335752487182617, 3.8949241638183594, 4.287016868591309, 3.48185396194458, 3.567054033279419, 6.925922870635986, 4.121637344360352, 3.571655750274658, 4.6209869384765625, 3.667402744293213, 2.453120470046997, 3.535717487335205, 3.479515552520752, 3.064347267150879, 4.172684192657471, 3.723259687423706, 1.5133635997772217, 3.614393949508667, 4.027676582336426, 4.2587995529174805, 5.999999046325684, 2.833494186401367, 2.962479591369629, 3.5319113731384277, 2.3788535594940186, 2.493586301803589, 3.609005928039551, 4.336841583251953, 3.7267608642578125, 3.3279786109924316, 2.969656467437744, 3.7960054874420166, 4.874089241027832, 3.9694631099700928, 3.60892653465271, 3.4379830360412598, 3.774862766265869, 1.6352920532226562, 3.1750969886779785, 3.73347806930542], "mean_td_error": 3.520047187805176, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 20.0, "diff_num_grad_updates_vs_sampler_policy": 19.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.10329818725586, "actor_loss": -4.64817476272583, "critic_loss": 1.7407652139663696, "alpha_loss": -0.05758349224925041, "alpha_value": 0.9943167567253113, "log_alpha_value": -0.005699474830180407, "target_entropy": -6.0, "policy_t": 0.02376335673034191, "mean_q": 0.5768101811408997, "max_q": 0.7024528980255127, "min_q": 0.4772569239139557}, "td_error": [3.142805576324463, 3.3684325218200684, 3.1286001205444336, 2.6526479721069336, 2.3858537673950195, 2.6786394119262695, 0.9236810803413391, 3.3506100177764893, 3.5365543365478516, 4.187506198883057, 3.8749053478240967, 5.19149923324585, 4.747317314147949, 5.10260534286499, 6.666196823120117, 3.6569695472717285, 2.5251247882843018, 3.4119133949279785, 4.255383491516113, 4.2885026931762695, 4.551782131195068, 3.467341899871826, 3.113373279571533, 2.6407089233398438, 4.689939498901367, 2.7315783500671387, 2.2831294536590576, 3.582881450653076, 2.0444822311401367, 4.782344341278076, 2.6509041786193848, 3.9880919456481934, 4.694039344787598, 3.80208683013916, 2.1131534576416016, 3.129892349243164, 4.699472904205322, 1.8242536783218384, 3.613485813140869, 3.772493839263916, 1.6710143089294434, 4.229841232299805, 4.389784812927246, 3.4435577392578125, 1.356142282485962, 2.2215447425842285, 3.689253330230713, 6.307314872741699, 1.7966389656066895, 3.3620951175689697, 4.392887115478516, 6.433388710021973, 2.0281198024749756, 1.5056400299072266, 4.372185230255127, 3.0169405937194824, 2.9640393257141113, 3.633350372314453, 2.8375954627990723, 1.0940947532653809, 4.66949987411499, 3.3412325382232666, 3.5267035961151123, 3.779745101928711, 3.6839938163757324, 5.254737854003906, 4.0604729652404785, 3.1325790882110596, 3.7429141998291016, 0.9690146446228027, 3.732624053955078, 4.143423080444336, 4.3202009201049805, 4.311063289642334, 1.2465200424194336, 2.2758264541625977, 3.3584697246551514, 5.0448503494262695, 3.4844133853912354, 2.6045191287994385, 3.334015369415283, 3.620429039001465, 4.077492713928223, 6.441455364227295, 3.69028377532959, 3.4036550521850586], "mean_td_error": 3.5028693675994873, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 20.0, "diff_num_grad_updates_vs_sampler_policy": 19.0}}, "num_env_steps_sampled": 18816, "num_env_steps_trained": 5160, "num_agent_steps_sampled": 56448, "num_agent_steps_trained": 5160, "last_target_update_ts": 18816, "num_target_updates": 20}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56448, "num_agent_steps_trained": 5160, "num_env_steps_sampled": 18816, "num_env_steps_trained": 5160, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 479.8650058672782, "num_env_steps_trained_throughput_per_sec": 138.17541463589038, "timesteps_total": 18816, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 56448, "timers": {"training_iteration_time_ms": 2026.512, "sample_time_ms": 1405.737, "load_time_ms": 0.535, "load_throughput": 482146.869, "learn_time_ms": 64.086, "learn_throughput": 4025.828, "synch_weights_time_ms": 16.903}, "counters": {"num_env_steps_sampled": 18816, "num_env_steps_trained": 5160, "num_agent_steps_sampled": 56448, "num_agent_steps_trained": 5160, "last_target_update_ts": 18816, "num_target_updates": 20}, "done": false, "episodes_total": 0, "training_iteration": 21, "trial_id": "566d8_00000", "date": "2023-11-16_22-21-00", "timestamp": 1700202060, "time_this_iter_s": 1.8802998065948486, "time_total_s": 43.17597031593323, "pid": 48481, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fb7906b0dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 43.17597031593323, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 87.7, "ram_util_percent": 92.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.080832481384277, "actor_loss": -4.6160736083984375, "critic_loss": 4.397609710693359, "alpha_loss": -0.06051723286509514, "alpha_value": 0.9940147995948792, "log_alpha_value": -0.006003197282552719, "target_entropy": -6.0, "policy_t": 0.03521892800927162, "mean_q": 0.5547271370887756, "max_q": 0.6888981461524963, "min_q": 0.42404115200042725}, "td_error": [5.132189750671387, 6.297581672668457, 3.7214980125427246, 6.0045599937438965, 5.0621018409729, 4.7661237716674805, 5.178325653076172, 5.595979690551758, 4.212099075317383, 4.24695348739624, 7.542169094085693, 7.494424819946289, 4.671933650970459, 2.515187978744507, 3.899428367614746, 5.802435874938965, 5.740631103515625, 6.127979278564453, 4.758057594299316, 4.029897689819336, 4.033875465393066, 6.3108110427856445, 5.896580696105957, 5.638442516326904, 4.649724006652832, 6.7708635330200195, 3.343971014022827, 4.815979957580566, 6.5471110343933105, 5.026232719421387, 4.5914154052734375, 6.059910774230957, 4.714205741882324, 4.109354019165039, 4.116460800170898, 5.1951398849487305, 5.892638683319092, 5.954985618591309, 3.1139323711395264, 6.03896427154541, 2.2309279441833496, 6.0139079093933105, 4.457237243652344, 3.2157821655273438, 4.3368706703186035, 4.136301517486572, 4.822497844696045, 6.604928970336914, 7.058686256408691, 5.552940845489502, 6.0394792556762695, 5.212029933929443, 7.0232744216918945, 4.128676891326904, 7.461698532104492, 4.191193580627441, 6.207754611968994, 6.119668960571289, 4.158430576324463, 6.843874931335449, 8.164257049560547, 5.000605583190918, 4.837739944458008, 5.160788536071777, 7.484498023986816, 5.156281471252441, 5.309192180633545, 4.940311431884766, 7.35952091217041, 3.5426418781280518, 4.714070796966553, 5.572833061218262, 5.4881792068481445, 2.2788097858428955, 5.772448539733887, 4.5568342208862305, 5.402534484863281, 4.876208305358887, 4.670797348022461, 6.636114120483398, 5.261124610900879, 5.3999552726745605, 4.925995826721191, 5.3309736251831055, 3.8076744079589844, 4.527197360992432], "mean_td_error": 5.204813480377197, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 21.0, "diff_num_grad_updates_vs_sampler_policy": 20.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.103724479675293, "actor_loss": -4.716628551483154, "critic_loss": 2.2933053970336914, "alpha_loss": -0.06065426394343376, "alpha_value": 0.9940147995948792, "log_alpha_value": -0.00600315909832716, "target_entropy": -6.0, "policy_t": -0.035679891705513, "mean_q": 0.6517106890678406, "max_q": 0.7826783657073975, "min_q": 0.5031511187553406}, "td_error": [3.7839090824127197, 3.2972354888916016, 4.069700717926025, 3.789703369140625, 1.8319780826568604, 3.8899292945861816, 2.676870822906494, 4.629071235656738, 3.8501713275909424, 5.243426322937012, 4.464284420013428, 1.9900869131088257, 5.409848213195801, 3.6333231925964355, 3.898930072784424, 4.961112976074219, 2.795130729675293, 5.03995418548584, 3.4602813720703125, 3.824829578399658, 2.399260997772217, 2.8199801445007324, 4.841503143310547, 1.893788456916809, 3.1966500282287598, 2.466123104095459, 1.9565577507019043, 4.550380706787109, 3.256866931915283, 4.2936882972717285, 4.454627513885498, 3.353579044342041, 2.4513742923736572, 3.972648859024048, 3.462953805923462, 5.25478458404541, 3.530042886734009, 3.1369807720184326, 3.1553969383239746, 3.363417387008667, 3.148404598236084, 2.0839247703552246, 2.0497305393218994, 2.8016419410705566, 4.5716552734375, 4.864422798156738, 2.9016027450561523, 2.8546018600463867, 4.775731086730957, 2.623279571533203, 3.961698293685913, 2.89847993850708, 3.031550407409668, 2.49139404296875, 2.8524351119995117, 2.093925952911377, 3.284731149673462, 2.3358139991760254, 4.345254898071289, 3.17189884185791, 4.567981243133545, 3.242043972015381, 1.2554290294647217, 3.5227818489074707, 1.5125622749328613, 3.8722076416015625, 3.7023186683654785, 1.588433027267456, 5.473392009735107, 3.0575432777404785, 3.316983461380005, 3.5052714347839355, 2.42832088470459, 2.7341675758361816, 1.723015308380127, 3.339522361755371, 4.196640491485596, 4.3542680740356445, 2.8060879707336426, 3.6903727054595947, 2.761826753616333, 3.0863537788391113, 1.76607084274292, 3.5439558029174805, 2.4502389430999756, 2.853910446166992], "mean_td_error": 3.3470263481140137, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 21.0, "diff_num_grad_updates_vs_sampler_policy": 20.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.110482215881348, "actor_loss": -4.71142578125, "critic_loss": 1.8084828853607178, "alpha_loss": -0.060657694935798645, "alpha_value": 0.9940184950828552, "log_alpha_value": -0.005999485496431589, "target_entropy": -6.0, "policy_t": -0.023565754294395447, "mean_q": 0.6378355026245117, "max_q": 0.7822132706642151, "min_q": 0.5381933450698853}, "td_error": [3.5736279487609863, 4.132689952850342, 2.4263718128204346, 5.2938737869262695, 3.1311235427856445, 3.3608200550079346, 3.2831192016601562, 3.1417765617370605, 3.5016398429870605, 3.1846163272857666, 1.6049482822418213, 1.986851453781128, 4.079900741577148, 2.5518486499786377, 3.6358861923217773, 6.3881683349609375, 3.8024067878723145, 2.92075252532959, 4.879398345947266, 3.396346092224121, 2.504734516143799, 3.4851484298706055, 3.403426170349121, 4.4673614501953125, 3.299222469329834, 3.2145891189575195, 3.525935411453247, 2.7845635414123535, 5.549644470214844, 2.815483808517456, 2.732696056365967, 2.5654220581054688, 4.2071967124938965, 2.9781136512756348, 3.743162155151367, 4.833666801452637, 2.0077009201049805, 3.375887155532837, 2.905829906463623, 2.4431345462799072, 2.4572603702545166, 4.481894493103027, 3.0260982513427734, 3.0067853927612305, 4.456974506378174, 2.547494411468506, 2.78271484375, 3.692809581756592, 3.9504430294036865, 4.586281776428223, 5.745755672454834, 3.470856189727783, 3.7569239139556885, 3.595672130584717, 4.500698566436768, 1.8861297369003296, 2.860327959060669, 4.476282119750977, 4.259580612182617, 4.006197452545166, 2.973086357116699, 6.194889068603516, 4.760692596435547, 5.3873772621154785, 1.4392151832580566, 5.773499488830566, 5.888211250305176, 2.8883309364318848, 3.107506275177002, 4.799724578857422, 3.2420401573181152, 4.202325344085693, 3.197932720184326, 4.7901763916015625, 1.4821982383728027, 3.908325672149658, 4.16085147857666, 2.9748787879943848, 2.6597166061401367, 3.242252826690674, 4.788122177124023, 0.9336898326873779, 5.237478256225586, 3.7406978607177734, 4.787075519561768, 3.06284236907959], "mean_td_error": 3.6080167293548584, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 21.0, "diff_num_grad_updates_vs_sampler_policy": 20.0}}, "num_env_steps_sampled": 19712, "num_env_steps_trained": 5418, "num_agent_steps_sampled": 59136, "num_agent_steps_trained": 5418, "last_target_update_ts": 19712, "num_target_updates": 21}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 59136, "num_agent_steps_trained": 5418, "num_env_steps_sampled": 19712, "num_env_steps_trained": 5418, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 454.4357479641607, "num_env_steps_trained_throughput_per_sec": 130.85315064146593, "timesteps_total": 19712, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 59136, "timers": {"training_iteration_time_ms": 2013.35, "sample_time_ms": 1414.492, "load_time_ms": 0.532, "load_throughput": 484738.592, "learn_time_ms": 63.646, "learn_throughput": 4053.685, "synch_weights_time_ms": 16.778}, "counters": {"num_env_steps_sampled": 19712, "num_env_steps_trained": 5418, "num_agent_steps_sampled": 59136, "num_agent_steps_trained": 5418, "last_target_update_ts": 19712, "num_target_updates": 21}, "done": false, "episodes_total": 0, "training_iteration": 22, "trial_id": "566d8_00000", "date": "2023-11-16_22-21-02", "timestamp": 1700202062, "time_this_iter_s": 1.9853298664093018, "time_total_s": 45.16130018234253, "pid": 48481, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fb763906ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 45.16130018234253, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 70.23333333333333, "ram_util_percent": 92.43333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.144922256469727, "actor_loss": -4.735702991485596, "critic_loss": 4.310421943664551, "alpha_loss": -0.06394803524017334, "alpha_value": 0.9937163591384888, "log_alpha_value": -0.0063034528866410255, "target_entropy": -6.0, "policy_t": 0.05730060860514641, "mean_q": 0.6050910949707031, "max_q": 0.7458371520042419, "min_q": 0.4853035807609558}, "td_error": [6.188047885894775, 5.748766899108887, 6.319394588470459, 3.233865737915039, 3.976423740386963, 6.362327575683594, 3.920591354370117, 4.2986531257629395, 4.317050933837891, 4.889074325561523, 4.564550876617432, 4.58636474609375, 5.629655838012695, 5.160547256469727, 4.053240776062012, 5.655835151672363, 6.091496467590332, 4.984710693359375, 3.3774054050445557, 6.166653633117676, 5.190253257751465, 6.143110752105713, 5.2907819747924805, 5.679072380065918, 5.009352207183838, 4.62495231628418, 4.2357378005981445, 4.257124900817871, 4.854926109313965, 2.486508846282959, 3.7929391860961914, 7.507316589355469, 6.10399866104126, 4.571407794952393, 6.772398471832275, 6.399212837219238, 4.367535591125488, 4.571596145629883, 6.794040203094482, 6.3557047843933105, 8.684860229492188, 3.320765495300293, 5.914870738983154, 4.773130416870117, 1.557223916053772, 4.628683090209961, 5.531964302062988, 4.425764083862305, 5.933258056640625, 6.804848670959473, 4.336899757385254, 4.554059982299805, 4.891604900360107, 6.675652027130127, 4.41126012802124, 5.230380058288574, 4.485363960266113, 5.713625907897949, 6.716541290283203, 5.035266876220703, 7.176542282104492, 5.606612205505371, 5.027048110961914, 5.03586483001709, 3.7830452919006348, 4.108022689819336, 5.631863594055176, 5.761199951171875, 5.177330017089844, 4.691826820373535, 5.884521484375, 3.561037540435791, 4.728902816772461, 5.7520551681518555, 3.7951574325561523, 3.67401123046875, 4.302433013916016, 3.8540191650390625, 3.914651393890381, 6.961816310882568, 5.508482933044434, 7.69041633605957, 4.328045845031738, 4.552092552185059, 6.667610168457031, 7.200912952423096], "mean_td_error": 5.145746231079102, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 22.0, "diff_num_grad_updates_vs_sampler_policy": 21.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.079256057739258, "actor_loss": -4.753239154815674, "critic_loss": 2.2967028617858887, "alpha_loss": -0.06353297084569931, "alpha_value": 0.9937164783477783, "log_alpha_value": -0.00630333973094821, "target_entropy": -6.0, "policy_t": 0.007602259051054716, "mean_q": 0.7269243597984314, "max_q": 0.8382874727249146, "min_q": 0.6057647466659546}, "td_error": [5.540554046630859, 3.1867308616638184, 3.2927660942077637, 3.5856590270996094, 2.5260496139526367, 3.7864670753479004, 3.375731945037842, 3.0623648166656494, 2.0171172618865967, 2.830605983734131, 5.749390125274658, 4.881056785583496, 3.2200355529785156, 3.31280517578125, 1.3177261352539062, 2.6653287410736084, 5.144285202026367, 3.9038329124450684, 3.7580580711364746, 3.5550899505615234, 3.415433406829834, 5.265589714050293, 2.141083240509033, 3.8190970420837402, 3.24001407623291, 2.5873732566833496, 2.7699248790740967, 4.016435623168945, 2.98081636428833, 4.601635932922363, 5.234392166137695, 2.5811100006103516, 4.024688720703125, 3.346859931945801, 2.558159589767456, 4.1918110847473145, 1.4725315570831299, 3.922111988067627, 5.622321128845215, 5.942177772521973, 4.281512260437012, 5.508843421936035, 3.247279644012451, 4.611484050750732, 4.237179279327393, 3.0560314655303955, 2.384165048599243, 3.7446775436401367, 3.0287203788757324, 4.629256248474121, 3.768742561340332, 3.246756076812744, 4.2084503173828125, 3.4606423377990723, 2.0865514278411865, 1.4400007724761963, 4.105596542358398, 2.256269931793213, 3.6616945266723633, 2.8271405696868896, 1.9349446296691895, 4.667672157287598, 1.7468037605285645, 3.6045966148376465, 4.352953910827637, 3.9310712814331055, 3.174086332321167, 2.582172393798828, 4.132128715515137, 2.545302391052246, 2.0290660858154297, 1.9374816417694092, 5.376682281494141, 2.3698434829711914, 2.8535714149475098, 3.4674360752105713, 2.7475597858428955, 4.847103118896484, 2.8901124000549316, 4.488686561584473, 1.6191210746765137, 3.244584560394287, 1.7206754684448242, 2.763301372528076, 2.8418378829956055, 2.4996814727783203], "mean_td_error": 3.425635814666748, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 22.0, "diff_num_grad_updates_vs_sampler_policy": 21.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.052506446838379, "actor_loss": -4.721119403839111, "critic_loss": 1.6947925090789795, "alpha_loss": -0.06332619488239288, "alpha_value": 0.9937202334403992, "log_alpha_value": -0.006299542263150215, "target_entropy": -6.0, "policy_t": -0.04096396267414093, "mean_q": 0.7116276025772095, "max_q": 0.8605230450630188, "min_q": 0.5613691210746765}, "td_error": [3.862724781036377, 2.963773727416992, 5.18545389175415, 5.8005194664001465, 2.0752816200256348, 2.7105560302734375, 2.177858829498291, 3.172327995300293, 2.536766529083252, 4.530611991882324, 3.1765170097351074, 4.821896553039551, 2.5564053058624268, 1.5754785537719727, 4.810065746307373, 3.516279458999634, 5.099787712097168, 4.263607978820801, 2.9864108562469482, 3.8009324073791504, 4.438954830169678, 2.6220788955688477, 4.011679172515869, 2.889883041381836, 4.11476993560791, 3.4496192932128906, 4.793210983276367, 0.9914067983627319, 4.590500354766846, 1.7999331951141357, 1.6252663135528564, 3.3764171600341797, 4.463524341583252, 4.612648010253906, 3.4953970909118652, 3.93927001953125, 3.976207733154297, 2.074158191680908, 1.8790643215179443, 3.6355743408203125, 1.5062559843063354, 5.2002644538879395, 2.6712608337402344, 3.8424954414367676, 3.769137144088745, 3.67939829826355, 3.3332018852233887, 4.733224868774414, 4.017755508422852, 3.6485836505889893, 3.8610153198242188, 2.609933614730835, 2.4182257652282715, 2.2748117446899414, 5.694019317626953, 2.8060178756713867, 3.0367796421051025, 4.115660667419434, 2.628176212310791, 2.4888038635253906, 3.464653968811035, 2.223203659057617, 4.354613304138184, 4.2188897132873535, 4.106810569763184, 2.7410190105438232, 4.640571594238281, 2.847902774810791, 2.473236083984375, 2.980146884918213, 4.948538780212402, 4.406113147735596, 3.36566162109375, 3.3527050018310547, 1.772217035293579, 3.816683053970337, 4.87136173248291, 2.790339469909668, 2.188629150390625, 3.8455512523651123, 2.1392159461975098, 4.441224575042725, 2.982675313949585, 2.87534499168396, 3.7749063968658447, 4.084164619445801], "mean_td_error": 3.447025775909424, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 22.0, "diff_num_grad_updates_vs_sampler_policy": 21.0}}, "num_env_steps_sampled": 20608, "num_env_steps_trained": 5676, "num_agent_steps_sampled": 61824, "num_agent_steps_trained": 5676, "last_target_update_ts": 20608, "num_target_updates": 22}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 61824, "num_agent_steps_trained": 5676, "num_env_steps_sampled": 20608, "num_env_steps_trained": 5676, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 394.4021087692818, "num_env_steps_trained_throughput_per_sec": 113.56667864115481, "timesteps_total": 20608, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 61824, "timers": {"training_iteration_time_ms": 2032.668, "sample_time_ms": 1429.135, "load_time_ms": 0.532, "load_throughput": 485173.257, "learn_time_ms": 63.566, "learn_throughput": 4058.776, "synch_weights_time_ms": 16.559}, "counters": {"num_env_steps_sampled": 20608, "num_env_steps_trained": 5676, "num_agent_steps_sampled": 61824, "num_agent_steps_trained": 5676, "last_target_update_ts": 20608, "num_target_updates": 22}, "done": false, "episodes_total": 0, "training_iteration": 23, "trial_id": "566d8_00000", "date": "2023-11-16_22-21-04", "timestamp": 1700202064, "time_this_iter_s": 2.288069009780884, "time_total_s": 47.44936919212341, "pid": 48481, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fb780eab820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 47.44936919212341, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 62.475, "ram_util_percent": 92.475}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.10407829284668, "actor_loss": -4.75501823425293, "critic_loss": 4.118463516235352, "alpha_loss": -0.06672520190477371, "alpha_value": 0.9934179782867432, "log_alpha_value": -0.0066037895157933235, "target_entropy": -6.0, "policy_t": 0.004293692298233509, "mean_q": 0.6855884194374084, "max_q": 0.8550888895988464, "min_q": 0.5284294486045837}, "td_error": [4.410234451293945, 4.5263671875, 5.157681941986084, 3.33558988571167, 3.661729335784912, 6.290002822875977, 5.858417510986328, 7.515612602233887, 6.888241767883301, 8.900347709655762, 4.898636341094971, 6.081857681274414, 4.440929412841797, 4.285754680633545, 6.489721775054932, 4.593106746673584, 4.38420295715332, 5.037274360656738, 4.978227615356445, 4.327315807342529, 6.250302791595459, 4.3693742752075195, 4.100581169128418, 6.1246232986450195, 4.339019775390625, 4.506590843200684, 4.558250427246094, 4.160701274871826, 2.7739768028259277, 7.14788818359375, 4.8763298988342285, 6.10894775390625, 3.8862290382385254, 6.0876665115356445, 4.057112216949463, 3.7363548278808594, 4.090715408325195, 5.383054733276367, 2.2653322219848633, 4.190739631652832, 6.554001331329346, 3.952153205871582, 4.82049560546875, 7.210552215576172, 6.589811325073242, 6.257593154907227, 4.038252830505371, 4.017064094543457, 6.287156105041504, 4.51908016204834, 4.660539150238037, 5.753872871398926, 5.247733116149902, 5.459634304046631, 5.112666606903076, 5.109703063964844, 3.9156384468078613, 1.572042465209961, 4.1629862785339355, 6.428094863891602, 3.8521170616149902, 7.167667388916016, 3.193319320678711, 4.840083122253418, 4.68255090713501, 5.861711502075195, 3.5730419158935547, 5.036215305328369, 3.4863686561584473, 3.4534823894500732, 5.240015029907227, 5.000571250915527, 6.341982841491699, 4.136870384216309, 5.067712783813477, 4.9008588790893555, 6.657492160797119, 4.511366844177246, 6.504403114318848, 5.251235008239746, 5.452969551086426, 3.4672622680664062, 1.9881625175476074, 4.378087997436523, 2.4883956909179688, 3.645963668823242], "mean_td_error": 4.894465446472168, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 23.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.084287643432617, "actor_loss": -4.841819763183594, "critic_loss": 2.154980421066284, "alpha_loss": -0.0665917694568634, "alpha_value": 0.9934182167053223, "log_alpha_value": -0.006603517569601536, "target_entropy": -6.0, "policy_t": -0.019931545481085777, "mean_q": 0.7888648509979248, "max_q": 0.9652107954025269, "min_q": 0.6449121236801147}, "td_error": [1.4645622968673706, 2.4653749465942383, 5.952865123748779, 1.9668045043945312, 3.1346487998962402, 3.3838257789611816, 1.8188377618789673, 1.2160089015960693, 4.440640449523926, 3.521932363510132, 4.335939407348633, 2.4349489212036133, 3.41348934173584, 1.262449026107788, 4.5894775390625, 3.526431083679199, 6.642261505126953, 2.953528642654419, 2.5848464965820312, 5.696725368499756, 2.875448226928711, 2.3060717582702637, 3.6993417739868164, 1.9883310794830322, 3.1693973541259766, 1.0703046321868896, 2.4367191791534424, 5.600107192993164, 1.7644145488739014, 4.508471488952637, 1.1844496726989746, 2.2533841133117676, 4.477782726287842, 1.4743380546569824, 4.102550506591797, 1.3490592241287231, 2.2817392349243164, 2.2691988945007324, 4.622910499572754, 4.458120346069336, 4.308114051818848, 3.8948652744293213, 1.3750994205474854, 4.303121089935303, 2.4699692726135254, 1.5053801536560059, 3.061021566390991, 1.1504650115966797, 2.1073927879333496, 4.264634609222412, 2.888763904571533, 3.5724573135375977, 4.3941497802734375, 3.024592399597168, 2.230609655380249, 3.5749263763427734, 3.2531986236572266, 2.782240867614746, 2.9518656730651855, 5.057422161102295, 3.108383893966675, 5.288237571716309, 2.4762425422668457, 3.8317816257476807, 2.9576447010040283, 1.4134521484375, 4.14479923248291, 4.555411338806152, 3.0139031410217285, 2.8506298065185547, 5.12999153137207, 3.1102793216705322, 2.986684799194336, 3.529860019683838, 3.6169919967651367, 3.3222861289978027, 4.759695053100586, 0.8510078191757202, 5.124081134796143, 0.8524580001831055, 3.804591178894043, 3.0085346698760986, 5.561922550201416, 2.8741400241851807, 5.562718391418457, 4.5554680824279785], "mean_td_error": 3.246037244796753, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 23.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.115387916564941, "actor_loss": -4.846402168273926, "critic_loss": 1.7641888856887817, "alpha_loss": -0.06675676256418228, "alpha_value": 0.9934222102165222, "log_alpha_value": -0.006599526386708021, "target_entropy": -6.0, "policy_t": -0.013332847505807877, "mean_q": 0.784210205078125, "max_q": 0.9712173938751221, "min_q": 0.6357176303863525}, "td_error": [2.701380729675293, 3.7517919540405273, 1.7082382440567017, 2.209559917449951, 4.044460773468018, 4.199972152709961, 3.735020160675049, 4.970810413360596, 3.867448329925537, 3.2508578300476074, 4.765751838684082, 1.3065860271453857, 3.630774736404419, 3.793318510055542, 3.8102660179138184, 2.6074881553649902, 3.694216251373291, 2.300267219543457, 6.215227127075195, 3.6466927528381348, 4.8737897872924805, 2.935272216796875, 5.815525531768799, 2.9670538902282715, 3.866743564605713, 3.4502182006835938, 3.5766875743865967, 2.6595654487609863, 5.1342878341674805, 4.700222015380859, 4.869655132293701, 4.46955680847168, 4.2205119132995605, 3.3394007682800293, 4.640368938446045, 2.543994426727295, 3.3789777755737305, 4.905284881591797, 4.024502754211426, 2.7579259872436523, 6.2312846183776855, 4.368504524230957, 4.145101070404053, 2.0191125869750977, 2.8138890266418457, 2.347620964050293, 3.193551540374756, 5.713839530944824, 1.6140260696411133, 4.083985328674316, 2.666800022125244, 2.4579615592956543, 1.265135407447815, 3.3452110290527344, 3.69016170501709, 2.5846972465515137, 2.2730681896209717, 2.429253101348877, 2.4047882556915283, 3.779707908630371, 4.188425064086914, 3.5721051692962646, 1.9733593463897705, 4.8753743171691895, 4.32335090637207, 6.32597017288208, 2.8888728618621826, 3.259524345397949, 3.1837167739868164, 4.071661949157715, 4.813683986663818, 3.1785569190979004, 3.069692611694336, 2.9777817726135254, 2.9169888496398926, 2.3318982124328613, 4.031511306762695, 3.6554458141326904, 3.6568589210510254, 4.053775787353516, 3.3817152976989746, 3.780043125152588, 3.1851420402526855, 4.637783527374268, 4.738254070281982, 2.05338716506958], "mean_td_error": 3.5801422595977783, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 23.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 21504, "num_env_steps_trained": 5934, "num_agent_steps_sampled": 64512, "num_agent_steps_trained": 5934, "last_target_update_ts": 21504, "num_target_updates": 23}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64512, "num_agent_steps_trained": 5934, "num_env_steps_sampled": 21504, "num_env_steps_trained": 5934, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 382.5518469155945, "num_env_steps_trained_throughput_per_sec": 110.1544380627493, "timesteps_total": 21504, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 64512, "timers": {"training_iteration_time_ms": 2071.409, "sample_time_ms": 1467.316, "load_time_ms": 0.531, "load_throughput": 485652.29, "learn_time_ms": 63.42, "learn_throughput": 4068.124, "synch_weights_time_ms": 16.524}, "counters": {"num_env_steps_sampled": 21504, "num_env_steps_trained": 5934, "num_agent_steps_sampled": 64512, "num_agent_steps_trained": 5934, "last_target_update_ts": 21504, "num_target_updates": 23}, "done": false, "episodes_total": 0, "training_iteration": 24, "trial_id": "566d8_00000", "date": "2023-11-16_22-21-06", "timestamp": 1700202066, "time_this_iter_s": 2.3588201999664307, "time_total_s": 49.808189392089844, "pid": 48481, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fb780eab940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 49.808189392089844, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 79.06666666666666, "ram_util_percent": 92.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.112176895141602, "actor_loss": -4.829867362976074, "critic_loss": 3.952561378479004, "alpha_loss": -0.06981562823057175, "alpha_value": 0.9931196570396423, "log_alpha_value": -0.006904114969074726, "target_entropy": -6.0, "policy_t": 5.746349779656157e-05, "mean_q": 0.7598284482955933, "max_q": 0.9887669682502747, "min_q": 0.6026628613471985}, "td_error": [5.901756286621094, 5.9164886474609375, 5.071318626403809, 3.8146867752075195, 3.9429256916046143, 4.369726181030273, 4.8645148277282715, 4.822725772857666, 4.377824783325195, 3.359415054321289, 4.507352352142334, 3.7023725509643555, 3.6173648834228516, 4.898064613342285, 4.084079742431641, 5.835732460021973, 4.706349849700928, 4.504246234893799, 4.600790977478027, 2.5594515800476074, 4.3499755859375, 6.927102088928223, 3.994253396987915, 4.43736457824707, 6.175142288208008, 4.668611526489258, 4.351507186889648, 5.645474910736084, 3.5163321495056152, 3.02866792678833, 5.473692893981934, 4.6976704597473145, 3.5463359355926514, 6.953618049621582, 6.15654182434082, 4.865190029144287, 5.909669399261475, 4.133308410644531, 6.190262317657471, 4.571900367736816, 3.9673967361450195, 3.7177982330322266, 6.230724334716797, 6.470212936401367, 5.049383163452148, 5.477292060852051, 3.9691991806030273, 4.565204620361328, 5.683760166168213, 4.950159072875977, 3.0726113319396973, 4.629318714141846, 4.648112773895264, 5.433531761169434, 3.4992547035217285, 4.6822004318237305, 5.49664306640625, 3.055934429168701, 5.8994550704956055, 3.472949743270874, 4.777336120605469, 3.9355733394622803, 4.97515869140625, 4.655054569244385, 4.695727348327637, 4.707980155944824, 3.9590911865234375, 3.670118808746338, 5.129766464233398, 6.87973690032959, 5.694619655609131, 2.8114612102508545, 5.227729797363281, 4.177114963531494, 5.998917579650879, 3.844146251678467, 4.908090591430664, 6.558008193969727, 3.065823554992676, 6.546141147613525, 3.1328091621398926, 4.230072975158691, 4.516579627990723, 5.1663360595703125, 3.845543622970581, 5.5498738288879395], "mean_td_error": 4.717206954956055, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 24.0, "diff_num_grad_updates_vs_sampler_policy": 23.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.053574562072754, "actor_loss": -4.875785827636719, "critic_loss": 2.1898956298828125, "alpha_loss": -0.06940688192844391, "alpha_value": 0.9931200742721558, "log_alpha_value": -0.0069037023931741714, "target_entropy": -6.0, "policy_t": -0.00889065396040678, "mean_q": 0.8730202317237854, "max_q": 1.0060276985168457, "min_q": 0.7391406893730164}, "td_error": [2.595238208770752, 4.6541547775268555, 5.588418006896973, 3.383634567260742, 3.6779770851135254, 5.453025817871094, 2.536500930786133, 2.921992301940918, 2.708425998687744, 2.6529088020324707, 3.9139156341552734, 5.710561752319336, 4.891348838806152, 2.675001621246338, 2.8604736328125, 3.7740793228149414, 2.6965219974517822, 2.6223645210266113, 3.2155916690826416, 3.855746269226074, 5.340126037597656, 3.8003268241882324, 3.1174964904785156, 2.7607107162475586, 3.4366981983184814, 3.557222843170166, 2.985761880874634, 2.624406099319458, 3.6124072074890137, 3.5296125411987305, 4.031091690063477, 3.4564881324768066, 5.294882774353027, 3.0427160263061523, 3.8035740852355957, 1.7987542152404785, 1.992157220840454, 3.4075534343719482, 3.2414917945861816, 2.911407947540283, 1.9471275806427002, 2.9348859786987305, 5.189493179321289, 5.057758331298828, 3.668600559234619, 5.012967109680176, 2.5135934352874756, 3.3313779830932617, 2.6211256980895996, 2.453087329864502, 5.050283432006836, 3.5188663005828857, 2.7437334060668945, 2.163586139678955, 3.0011866092681885, 3.52962064743042, 2.7899584770202637, 4.305295944213867, 2.6157565116882324, 3.4910526275634766, 2.842276096343994, 3.239809513092041, 2.402871608734131, 4.897073268890381, 2.8041558265686035, 2.6333394050598145, 3.690380573272705, 2.7770700454711914, 1.00068199634552, 2.399265766143799, 2.5502657890319824, 3.7215561866760254, 1.735739827156067, 2.8356003761291504, 3.8824286460876465, 1.9193665981292725, 1.6654002666473389, 2.5382590293884277, 1.3295602798461914, 2.655789852142334, 1.6709909439086914, 2.0696375370025635, 3.2994890213012695, 3.1954996585845947, 3.5344672203063965, 3.959155797958374], "mean_td_error": 3.2479333877563477, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 24.0, "diff_num_grad_updates_vs_sampler_policy": 23.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.105266571044922, "actor_loss": -4.9098334312438965, "critic_loss": 1.5107917785644531, "alpha_loss": -0.0697220042347908, "alpha_value": 0.9931241869926453, "log_alpha_value": -0.006899571046233177, "target_entropy": -6.0, "policy_t": 0.003194077406078577, "mean_q": 0.8571977019309998, "max_q": 1.0249065160751343, "min_q": 0.661865770816803}, "td_error": [3.50246524810791, 3.2832894325256348, 4.4811201095581055, 4.039671897888184, 2.5510916709899902, 3.7243919372558594, 3.773871660232544, 5.2844719886779785, 4.483878135681152, 1.142185926437378, 2.1898508071899414, 1.268008828163147, 2.1704888343811035, 3.4706854820251465, 2.8285863399505615, 2.644251823425293, 1.6994082927703857, 3.481414556503296, 3.615294933319092, 4.935379981994629, 4.036120891571045, 4.623807907104492, 1.1320316791534424, 6.104557037353516, 4.4209465980529785, 4.657497406005859, 2.8938345909118652, 1.2479698657989502, 2.6204209327697754, 2.8842263221740723, 2.9484870433807373, 2.0307154655456543, 3.0454554557800293, 3.13553786277771, 3.959583282470703, 4.071012496948242, 5.414072513580322, 2.907011032104492, 2.6779651641845703, 3.9403014183044434, 3.033423900604248, 2.841310501098633, 2.5097761154174805, 5.459627151489258, 2.6961441040039062, 3.17529034614563, 2.7161715030670166, 2.6476144790649414, 4.185417175292969, 2.1442618370056152, 2.889939785003662, 2.3604226112365723, 2.5837690830230713, 3.712165355682373, 3.866595506668091, 2.533128261566162, 2.6947169303894043, 3.278916358947754, 1.3269957304000854, 0.6036505699157715, 4.3206024169921875, 3.5160341262817383, 4.633892059326172, 3.16926908493042, 4.3863301277160645, 2.2697649002075195, 3.915415048599243, 3.5970499515533447, 1.3590948581695557, 3.955839157104492, 3.330012321472168, 0.6956408023834229, 1.5832111835479736, 3.0375328063964844, 2.192411422729492, 2.643570899963379, 4.262520790100098, 3.2728023529052734, 6.254856586456299, 1.9416612386703491, 1.364421010017395, 2.207120895385742, 3.0300464630126953, 3.4373538494110107, 4.864046096801758, 2.834444046020508], "mean_td_error": 3.170414447784424, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 24.0, "diff_num_grad_updates_vs_sampler_policy": 23.0}}, "num_env_steps_sampled": 22400, "num_env_steps_trained": 6192, "num_agent_steps_sampled": 67200, "num_agent_steps_trained": 6192, "last_target_update_ts": 22400, "num_target_updates": 24}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 67200, "num_agent_steps_trained": 6192, "num_env_steps_sampled": 22400, "num_env_steps_trained": 6192, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 446.2444627861493, "num_env_steps_trained_throughput_per_sec": 128.49449932904744, "timesteps_total": 22400, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 67200, "timers": {"training_iteration_time_ms": 2076.815, "sample_time_ms": 1472.367, "load_time_ms": 0.532, "load_throughput": 485129.755, "learn_time_ms": 63.443, "learn_throughput": 4066.622, "synch_weights_time_ms": 16.627}, "counters": {"num_env_steps_sampled": 22400, "num_env_steps_trained": 6192, "num_agent_steps_sampled": 67200, "num_agent_steps_trained": 6192, "last_target_update_ts": 22400, "num_target_updates": 24}, "done": false, "episodes_total": 0, "training_iteration": 25, "trial_id": "566d8_00000", "date": "2023-11-16_22-21-08", "timestamp": 1700202068, "time_this_iter_s": 2.0225799083709717, "time_total_s": 51.830769300460815, "pid": 48481, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fb780e85af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 51.830769300460815, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 68.5, "ram_util_percent": 92.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.084869384765625, "actor_loss": -4.871794700622559, "critic_loss": 4.025350093841553, "alpha_loss": -0.07265588641166687, "alpha_value": 0.992821455001831, "log_alpha_value": -0.007204445544630289, "target_entropy": -6.0, "policy_t": -0.00881278794258833, "mean_q": 0.8300794363021851, "max_q": 1.0456305742263794, "min_q": 0.6445221304893494}, "td_error": [4.840509414672852, 4.749775409698486, 3.7193803787231445, 4.477991580963135, 4.198258876800537, 4.376745700836182, 5.41060733795166, 3.131263494491577, 6.53162956237793, 4.713438510894775, 4.974566459655762, 4.555802345275879, 2.354808807373047, 4.513084411621094, 4.185367584228516, 2.631382942199707, 4.882558822631836, 3.809359073638916, 6.611309051513672, 3.7023544311523438, 8.108110427856445, 6.365778923034668, 4.967563629150391, 3.6779723167419434, 6.0897722244262695, 4.631940841674805, 5.349802017211914, 5.215095520019531, 3.4063422679901123, 6.029252052307129, 2.6935880184173584, 2.8625664710998535, 6.617931365966797, 4.359137535095215, 4.448423385620117, 3.244262933731079, 6.461688041687012, 4.664069175720215, 5.385924816131592, 5.70665979385376, 4.130042552947998, 5.691689491271973, 5.316253185272217, 4.176154613494873, 4.238837242126465, 5.809082984924316, 3.341172218322754, 2.6791532039642334, 5.9268083572387695, 4.583556175231934, 6.502623558044434, 4.11867618560791, 5.559303283691406, 6.907717704772949, 6.734251976013184, 4.166277885437012, 5.764228820800781, 5.840373992919922, 8.957508087158203, 4.487026214599609, 4.917682647705078, 4.45224666595459, 2.8303847312927246, 6.108060836791992, 5.295754432678223, 6.552986145019531, 4.0829668045043945, 5.350493431091309, 5.6280622482299805, 5.418440818786621, 3.504861831665039, 4.362807273864746, 6.444183349609375, 5.1436944007873535, 2.741060972213745, 8.450329780578613, 6.128170490264893, 5.05426549911499, 5.413573265075684, 3.2586352825164795, 5.238264083862305, 4.822845935821533, 3.8478426933288574, 3.878061056137085, 4.721591949462891, 5.223315238952637], "mean_td_error": 4.912295341491699, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 25.0, "diff_num_grad_updates_vs_sampler_policy": 24.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.078189849853516, "actor_loss": -4.9769439697265625, "critic_loss": 2.2526156902313232, "alpha_loss": -0.0726015716791153, "alpha_value": 0.9928220510482788, "log_alpha_value": -0.00720383133739233, "target_entropy": -6.0, "policy_t": 0.02806425839662552, "mean_q": 0.941317081451416, "max_q": 1.1545101404190063, "min_q": 0.7960506081581116}, "td_error": [4.226637840270996, 5.23561954498291, 3.1265108585357666, 2.2610368728637695, 2.296372890472412, 2.448418617248535, 5.004293441772461, 3.3852949142456055, 4.13287353515625, 1.899371862411499, 4.427176475524902, 3.095283269882202, 3.2116215229034424, 5.495244979858398, 3.8068923950195312, 2.2417945861816406, 2.9443199634552, 2.9765567779541016, 1.0335170030593872, 4.571170806884766, 3.9126880168914795, 3.1861820220947266, 2.1596739292144775, 3.7499141693115234, 4.590202808380127, 4.191040515899658, 3.2105331420898438, 4.37832498550415, 0.9953995943069458, 4.038137912750244, 2.7217769622802734, 1.5465174913406372, 2.897082567214966, 2.569836139678955, 2.9448626041412354, 4.119793891906738, 4.306169509887695, 2.7484636306762695, 2.338270664215088, 3.4501380920410156, 4.866835117340088, 5.906432151794434, 4.027649402618408, 5.2408976554870605, 5.3671159744262695, 4.339495658874512, 2.337392807006836, 4.556122779846191, 4.042140960693359, 2.157150983810425, 2.7484853267669678, 1.4688901901245117, 4.537283897399902, 3.453176975250244, 3.788015365600586, 3.041062831878662, 0.5547910332679749, 2.1029224395751953, 5.046923637390137, 4.320528507232666, 3.891526222229004, 4.13458251953125, 0.7244372367858887, 5.079527378082275, 2.942277193069458, 4.3330769538879395, 2.3596832752227783, 2.804203510284424, 4.256103992462158, 4.281355857849121, 2.1083102226257324, 4.62429141998291, 3.2903079986572266, 2.995142936706543, 1.8721959590911865, 1.9631270170211792, 4.65360164642334, 2.945955753326416, 1.5016393661499023, 1.9262264966964722, 2.263899087905884, 3.436985492706299, 2.6939239501953125, 2.313530921936035, 2.7147634029388428, 3.1871113777160645], "mean_td_error": 3.314838409423828, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 25.0, "diff_num_grad_updates_vs_sampler_policy": 24.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.101839065551758, "actor_loss": -5.0056962966918945, "critic_loss": 1.6423499584197998, "alpha_loss": -0.0727296844124794, "alpha_value": 0.9928262233734131, "log_alpha_value": -0.007199648302048445, "target_entropy": -6.0, "policy_t": -0.0021250396966934204, "mean_q": 0.9208969473838806, "max_q": 1.1849192380905151, "min_q": 0.7642176151275635}, "td_error": [3.3762683868408203, 4.974757194519043, 2.3676910400390625, 1.9018443822860718, 4.153347015380859, 1.873418927192688, 5.745745658874512, 2.777462959289551, 2.039381980895996, 4.444181442260742, 2.511262893676758, 5.662174701690674, 2.931519031524658, 3.379246473312378, 5.272367477416992, 2.290797233581543, 3.528379440307617, 3.6011226177215576, 2.6396539211273193, 1.8700919151306152, 4.124546051025391, 4.67072057723999, 1.4702057838439941, 1.7443842887878418, 4.200200080871582, 2.8501977920532227, 4.533373832702637, 4.204327583312988, 2.3390345573425293, 3.230384349822998, 2.8549506664276123, 3.8788115978240967, 1.5650455951690674, 5.314018726348877, 2.795097827911377, 3.7536840438842773, 4.166319847106934, 3.737762451171875, 1.5696322917938232, 3.932804584503174, 4.423771858215332, 4.221109390258789, 3.3065404891967773, 3.5283589363098145, 4.011190414428711, 5.309095859527588, 5.134905815124512, 3.9415066242218018, 4.982766628265381, 3.6322693824768066, 4.030954360961914, 3.0313377380371094, 3.0350899696350098, 3.34727144241333, 3.8560307025909424, 3.4617905616760254, 1.5556432008743286, 1.5442960262298584, 2.644242763519287, 2.576380729675293, 5.991601943969727, 3.807797908782959, 4.914671897888184, 2.900223731994629, 4.2408671379089355, 3.9167542457580566, 2.6947014331817627, 1.9538401365280151, 3.021834373474121, 2.2896728515625, 3.5906195640563965, 1.6417031288146973, 3.472773551940918, 3.8447444438934326, 2.3448753356933594, 3.8163015842437744, 2.4888992309570312, 3.057556629180908, 2.7139177322387695, 3.1548781394958496, 3.715162754058838, 3.9480221271514893, 2.6503515243530273, 4.2125396728515625, 1.6388334035873413, 5.367287635803223], "mean_td_error": 3.4097814559936523, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 25.0, "diff_num_grad_updates_vs_sampler_policy": 24.0}}, "num_env_steps_sampled": 23296, "num_env_steps_trained": 6450, "num_agent_steps_sampled": 69888, "num_agent_steps_trained": 6450, "last_target_update_ts": 23296, "num_target_updates": 25}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 69888, "num_agent_steps_trained": 6450, "num_env_steps_sampled": 23296, "num_env_steps_trained": 6450, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 470.19186213597504, "num_env_steps_trained_throughput_per_sec": 135.39006744540353, "timesteps_total": 23296, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 69888, "timers": {"training_iteration_time_ms": 2076.582, "sample_time_ms": 1472.25, "load_time_ms": 0.53, "load_throughput": 486613.199, "learn_time_ms": 63.314, "learn_throughput": 4074.914, "synch_weights_time_ms": 16.682}, "counters": {"num_env_steps_sampled": 23296, "num_env_steps_trained": 6450, "num_agent_steps_sampled": 69888, "num_agent_steps_trained": 6450, "last_target_update_ts": 23296, "num_target_updates": 25}, "done": false, "episodes_total": 0, "training_iteration": 26, "trial_id": "566d8_00000", "date": "2023-11-16_22-21-10", "timestamp": 1700202070, "time_this_iter_s": 1.921755313873291, "time_total_s": 53.752524614334106, "pid": 48481, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fb780e85d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 53.752524614334106, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 64.2, "ram_util_percent": 92.46666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.11485481262207, "actor_loss": -4.978567123413086, "critic_loss": 3.9515132904052734, "alpha_loss": -0.07590921223163605, "alpha_value": 0.9925233721733093, "log_alpha_value": -0.0075047253631055355, "target_entropy": -6.0, "policy_t": 0.003970069345086813, "mean_q": 0.8804242610931396, "max_q": 1.1228618621826172, "min_q": 0.7208512425422668}, "td_error": [2.9267845153808594, 7.304286956787109, 3.300840377807617, 4.7744646072387695, 4.5670671463012695, 6.692654609680176, 3.950882911682129, 3.1012940406799316, 3.364292621612549, 4.927905082702637, 5.1488752365112305, 6.818058013916016, 5.053366661071777, 1.6801037788391113, 5.835452556610107, 6.817021369934082, 3.7777199745178223, 4.420680999755859, 5.129382610321045, 1.5307528972625732, 6.273431777954102, 3.722086191177368, 5.390477657318115, 5.385209083557129, 5.181570053100586, 5.2880964279174805, 6.0560712814331055, 4.000164031982422, 3.5142083168029785, 3.8640995025634766, 4.5897064208984375, 4.84837007522583, 3.626901626586914, 4.3477325439453125, 5.2952799797058105, 3.769941806793213, 5.1050567626953125, 2.672895908355713, 5.0292768478393555, 5.278017997741699, 5.280764579772949, 4.018933296203613, 5.921064376831055, 4.140745162963867, 4.866411209106445, 5.451807498931885, 6.529413223266602, 3.227428913116455, 4.542755126953125, 4.807430744171143, 3.7738566398620605, 2.507650375366211, 5.278725624084473, 4.098285675048828, 5.798501968383789, 4.20406436920166, 4.948417663574219, 5.814423561096191, 4.6899237632751465, 3.2584457397460938, 4.107572555541992, 2.91666316986084, 6.052265644073486, 6.356187343597412, 3.8980138301849365, 6.284933090209961, 6.321460247039795, 4.874960422515869, 3.3618321418762207, 3.230103015899658, 5.788718223571777, 4.597235679626465, 4.990360260009766, 5.093072891235352, 2.713167667388916, 5.9369001388549805, 8.43022346496582, 4.917519569396973, 3.8608598709106445, 3.880796432495117, 5.552130699157715, 6.380094528198242, 5.287236213684082, 5.1125569343566895, 5.646576881408691, 6.126271724700928], "mean_td_error": 4.758572578430176, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 26.0, "diff_num_grad_updates_vs_sampler_policy": 25.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.073184967041016, "actor_loss": -5.071903705596924, "critic_loss": 2.2623989582061768, "alpha_loss": -0.07558878511190414, "alpha_value": 0.9925241470336914, "log_alpha_value": -0.007503961678594351, "target_entropy": -6.0, "policy_t": -0.008009764365851879, "mean_q": 1.0452591180801392, "max_q": 1.194449543952942, "min_q": 0.8132555484771729}, "td_error": [1.7134907245635986, 3.763795852661133, 3.1538569927215576, 1.272923469543457, 2.6356539726257324, 3.922534465789795, 2.5943222045898438, 2.456026792526245, 3.8979082107543945, 3.0948684215545654, 4.392354488372803, 4.358696937561035, 4.0147271156311035, 4.190829753875732, 3.2345638275146484, 2.4726696014404297, 4.469934463500977, 3.3829588890075684, 1.3193280696868896, 2.6365609169006348, 6.793443202972412, 3.593437671661377, 2.948267936706543, 3.785369396209717, 2.96970534324646, 2.3426735401153564, 2.2030367851257324, 2.8739092350006104, 2.093794345855713, 3.3870725631713867, 3.451266050338745, 1.4450780153274536, 3.2546873092651367, 2.821920394897461, 3.7712860107421875, 1.8569414615631104, 2.7910776138305664, 1.2991039752960205, 3.4567418098449707, 2.710850715637207, 1.684371829032898, 2.248774766921997, 2.5201303958892822, 4.578549385070801, 4.053511619567871, 5.156218528747559, 3.390641212463379, 4.824735641479492, 3.9064416885375977, 3.682239532470703, 4.083499908447266, 3.618091583251953, 3.9849095344543457, 1.475566029548645, 4.592620849609375, 5.443425178527832, 2.419776439666748, 3.5726940631866455, 4.074548721313477, 1.690687894821167, 4.351412773132324, 3.3915047645568848, 4.72326135635376, 4.353280067443848, 3.85593581199646, 3.032961368560791, 4.198652267456055, 3.5337436199188232, 4.238595962524414, 3.6192524433135986, 2.046018600463867, 4.554324150085449, 2.2562928199768066, 3.1490721702575684, 3.630443572998047, 4.852268218994141, 2.8499956130981445, 2.8063066005706787, 3.777831554412842, 3.666069746017456, 4.3851165771484375, 1.4331066608428955, 2.4121663570404053, 1.0768665075302124, 3.688413381576538, 5.381349563598633], "mean_td_error": 3.3150389194488525, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 26.0, "diff_num_grad_updates_vs_sampler_policy": 25.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.087163925170898, "actor_loss": -5.1060004234313965, "critic_loss": 1.528651237487793, "alpha_loss": -0.07565116137266159, "alpha_value": 0.9925283193588257, "log_alpha_value": -0.007499746046960354, "target_entropy": -6.0, "policy_t": -0.009761960245668888, "mean_q": 1.0338752269744873, "max_q": 1.2704907655715942, "min_q": 0.8515211939811707}, "td_error": [4.356234550476074, 2.5796914100646973, 4.055438041687012, 2.4928016662597656, 2.2654385566711426, 3.189378261566162, 2.0551035404205322, 2.600414276123047, 3.557492733001709, 2.479489326477051, 2.084501266479492, 3.106070041656494, 2.2205216884613037, 5.896954536437988, 4.482612609863281, 3.1849758625030518, 3.355241298675537, 5.506437301635742, 6.482469081878662, 5.48073673248291, 3.0232419967651367, 2.1752212047576904, 0.11840933561325073, 4.582672119140625, 3.7945070266723633, 5.669604301452637, 3.0422768592834473, 3.921043872833252, 3.6509032249450684, 0.673890233039856, 4.495523929595947, 3.9958410263061523, 2.6418850421905518, 2.613762617111206, 3.5607945919036865, 1.8103784322738647, 2.447216510772705, 4.012960433959961, 2.6045615673065186, 3.0164473056793213, 3.038170337677002, 0.7890110611915588, 1.5965642929077148, 4.289125442504883, 2.911959171295166, 2.7192111015319824, 2.4527039527893066, 2.5297937393188477, 2.869476795196533, 2.7085742950439453, 2.835775136947632, 3.389432430267334, 3.9827051162719727, 3.461007833480835, 1.98768150806427, 2.483912467956543, 3.9481024742126465, 1.066277027130127, 2.586409330368042, 2.6862077713012695, 3.3059659004211426, 2.7797913551330566, 3.5370078086853027, 3.384850025177002, 3.3046765327453613, 2.524566173553467, 2.3283839225769043, 2.5231919288635254, 1.6019682884216309, 5.033903121948242, 3.1553964614868164, 4.138833045959473, 1.7559019327163696, 3.814420223236084, 3.8336069583892822, 4.421877384185791, 0.8748435974121094, 3.1805427074432373, 2.95489764213562, 2.3974647521972656, 2.3314733505249023, 4.608437538146973, 3.9879255294799805, 3.09002685546875, 4.378501892089844, 4.505880832672119], "mean_td_error": 3.1554603576660156, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 26.0, "diff_num_grad_updates_vs_sampler_policy": 25.0}}, "num_env_steps_sampled": 24192, "num_env_steps_trained": 6708, "num_agent_steps_sampled": 72576, "num_agent_steps_trained": 6708, "last_target_update_ts": 24192, "num_target_updates": 26}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72576, "num_agent_steps_trained": 6708, "num_env_steps_sampled": 24192, "num_env_steps_trained": 6708, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 468.7550449746332, "num_env_steps_trained_throughput_per_sec": 134.976341075285, "timesteps_total": 24192, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 72576, "timers": {"training_iteration_time_ms": 2074.503, "sample_time_ms": 1471.85, "load_time_ms": 0.526, "load_throughput": 490206.311, "learn_time_ms": 62.874, "learn_throughput": 4103.417, "synch_weights_time_ms": 16.347}, "counters": {"num_env_steps_sampled": 24192, "num_env_steps_trained": 6708, "num_agent_steps_sampled": 72576, "num_agent_steps_trained": 6708, "last_target_update_ts": 24192, "num_target_updates": 26}, "done": false, "episodes_total": 0, "training_iteration": 27, "trial_id": "566d8_00000", "date": "2023-11-16_22-21-12", "timestamp": 1700202072, "time_this_iter_s": 1.9264860153198242, "time_total_s": 55.67901062965393, "pid": 48481, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fb780eab790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 55.67901062965393, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 91.35, "ram_util_percent": 92.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.046570777893066, "actor_loss": -5.0156331062316895, "critic_loss": 3.9314637184143066, "alpha_loss": -0.0784137025475502, "alpha_value": 0.9922253489494324, "log_alpha_value": -0.007805021479725838, "target_entropy": -6.0, "policy_t": -0.001456715282984078, "mean_q": 0.9755380153656006, "max_q": 1.3161602020263672, "min_q": 0.7298797369003296}, "td_error": [5.064949035644531, 7.080658912658691, 5.499650955200195, 2.3748409748077393, 4.054422378540039, 4.470706939697266, 3.504167079925537, 5.0871171951293945, 3.6107735633850098, 5.826260566711426, 5.022841453552246, 3.9046339988708496, 4.1350507736206055, 4.569585800170898, 3.64504337310791, 3.776848793029785, 4.344259738922119, 3.6724555492401123, 4.795523643493652, 5.4428205490112305, 5.063955783843994, 4.134611129760742, 7.6759443283081055, 2.118864059448242, 4.796026229858398, 4.53529167175293, 3.2358388900756836, 5.536799907684326, 6.678150177001953, 5.149711608886719, 3.837174654006958, 5.110264778137207, 5.885617256164551, 4.157707214355469, 3.7544236183166504, 7.411075115203857, 3.906980037689209, 4.05143928527832, 5.560370922088623, 3.3108553886413574, 6.165410041809082, 4.8487043380737305, 4.47411584854126, 4.541868209838867, 4.2115278244018555, 6.183974266052246, 6.483293056488037, 5.52381706237793, 3.5022778511047363, 5.59171199798584, 5.134756565093994, 4.751174449920654, 5.562693119049072, 4.174276828765869, 5.764662742614746, 4.387881278991699, 5.815605163574219, 3.5370264053344727, 4.023011207580566, 6.002908706665039, 5.17413330078125, 3.687199354171753, 4.155753135681152, 4.510046005249023, 5.82251501083374, 5.94749116897583, 4.7072601318359375, 5.416755676269531, 4.727532863616943, 4.76652717590332, 6.872713088989258, 5.51240873336792, 3.9016990661621094, 5.367995262145996, 4.865785598754883, 5.597775459289551, 5.243014812469482, 4.238440990447998, 5.832319736480713, 5.076779365539551, 2.9342617988586426, 5.054084777832031, 4.249578952789307, 2.4254543781280518, 3.112053155899048, 4.572104454040527], "mean_td_error": 4.770303726196289, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 27.0, "diff_num_grad_updates_vs_sampler_policy": 26.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.060376167297363, "actor_loss": -5.157142162322998, "critic_loss": 2.080221652984619, "alpha_loss": -0.07851200550794601, "alpha_value": 0.9922263026237488, "log_alpha_value": -0.007804082706570625, "target_entropy": -6.0, "policy_t": 0.04831409826874733, "mean_q": 1.1337274312973022, "max_q": 1.3001155853271484, "min_q": 0.9306885600090027}, "td_error": [2.4952454566955566, 4.46040153503418, 4.032251358032227, 1.3000247478485107, 2.4193859100341797, 3.2539525032043457, 3.7838549613952637, 0.41260826587677, 2.4130663871765137, 2.436161518096924, 4.0451555252075195, 0.5643309354782104, 1.9336178302764893, 1.968212604522705, 2.3185572624206543, 5.033856391906738, 5.2836503982543945, 4.935758113861084, 3.373875379562378, 2.188523530960083, 5.4942169189453125, 3.417654275894165, 3.3494482040405273, 0.877445638179779, 3.936556816101074, 3.594882011413574, 2.9676449298858643, 3.6992123126983643, 3.7776412963867188, 4.554372310638428, 3.944465398788452, 4.160499572753906, 2.914200782775879, 4.2192606925964355, 1.823253870010376, 1.7599263191223145, 3.6791770458221436, 2.963322877883911, 2.927865743637085, 2.3441596031188965, 2.1184704303741455, 3.899303674697876, 3.9048290252685547, 3.839468002319336, 2.183770179748535, 4.118987083435059, 3.768805503845215, 1.8528270721435547, 4.2080278396606445, 2.084451675415039, 3.1089000701904297, 1.9774181842803955, 2.9617249965667725, 5.514524459838867, 3.148423194885254, 3.956279754638672, 3.6806774139404297, 3.612731456756592, 3.375565767288208, 4.305964946746826, 1.7403817176818848, 2.8862721920013428, 0.6151658296585083, 3.357759952545166, 0.9924063086509705, 3.3903849124908447, 0.22407948970794678, 0.5853878259658813, 4.212690353393555, 3.620887279510498, 4.172786712646484, 4.512101173400879, 3.80877423286438, 2.726583957672119, 3.3793702125549316, 2.210374593734741, 1.5690498352050781, 3.678359270095825, 2.0390992164611816, 5.357719421386719, 3.161384105682373, 4.054306507110596, 1.7097132205963135, 2.4748244285583496, 3.400542736053467, 2.3462371826171875], "mean_td_error": 3.080296277999878, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 27.0, "diff_num_grad_updates_vs_sampler_policy": 26.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.121698379516602, "actor_loss": -5.213583469390869, "critic_loss": 1.4244390726089478, "alpha_loss": -0.07894754409790039, "alpha_value": 0.9922305345535278, "log_alpha_value": -0.007799831684678793, "target_entropy": -6.0, "policy_t": -0.03688303008675575, "mean_q": 1.139565348625183, "max_q": 1.428467869758606, "min_q": 0.9395877718925476}, "td_error": [2.102627754211426, 0.6708778142929077, 3.6468000411987305, 5.165422439575195, 0.9886641502380371, 4.360529899597168, 2.057004690170288, 2.056999444961548, 3.978806972503662, 1.605128526687622, 2.9088950157165527, 4.324383735656738, 2.580049991607666, 3.575021743774414, 2.2920594215393066, 1.9524898529052734, 1.6588828563690186, 3.0741734504699707, 2.610111713409424, 3.916973114013672, 1.6738159656524658, 3.9792633056640625, 0.2959255576133728, 3.353876829147339, 3.5860087871551514, 1.7987585067749023, 2.1795387268066406, 4.522478103637695, 3.7119593620300293, 2.7565197944641113, 2.6155991554260254, 3.0147151947021484, 1.8062962293624878, 2.8686039447784424, 1.63478684425354, 3.1046128273010254, 3.656346082687378, 4.92434024810791, 1.4434435367584229, 4.562404632568359, 3.1389267444610596, 2.4913418292999268, 2.9249494075775146, 2.6299562454223633, 3.230119228363037, 2.066148281097412, 3.5959081649780273, 1.2306386232376099, 2.165393352508545, 3.1292498111724854, 3.1125943660736084, 2.303109645843506, 4.210231781005859, 3.6678900718688965, 2.983959197998047, 1.0477099418640137, 3.362617254257202, 4.987507343292236, 4.536989212036133, 1.78383207321167, 2.4351844787597656, 4.656689643859863, 2.282782554626465, 4.622752666473389, 5.1407904624938965, 4.1732587814331055, 1.8362559080123901, 2.7677149772644043, 3.0646634101867676, 3.6061716079711914, 1.4056127071380615, 2.8346309661865234, 2.2933995723724365, 2.9949069023132324, 3.984548568725586, 5.601325988769531, 3.79715633392334, 4.197237968444824, 1.2876063585281372, 0.047909319400787354, 3.1376724243164062, 2.144230604171753, 3.6142072677612305, 5.97612190246582, 0.85870760679245, 3.8454737663269043], "mean_td_error": 2.956061363220215, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 27.0, "diff_num_grad_updates_vs_sampler_policy": 26.0}}, "num_env_steps_sampled": 25088, "num_env_steps_trained": 6966, "num_agent_steps_sampled": 75264, "num_agent_steps_trained": 6966, "last_target_update_ts": 25088, "num_target_updates": 27}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 75264, "num_agent_steps_trained": 6966, "num_env_steps_sampled": 25088, "num_env_steps_trained": 6966, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 412.7765434706368, "num_env_steps_trained_throughput_per_sec": 118.8575314904289, "timesteps_total": 25088, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 75264, "timers": {"training_iteration_time_ms": 2042.68, "sample_time_ms": 1440.871, "load_time_ms": 0.527, "load_throughput": 489607.471, "learn_time_ms": 62.946, "learn_throughput": 4098.769, "synch_weights_time_ms": 16.294}, "counters": {"num_env_steps_sampled": 25088, "num_env_steps_trained": 6966, "num_agent_steps_sampled": 75264, "num_agent_steps_trained": 6966, "last_target_update_ts": 25088, "num_target_updates": 27}, "done": false, "episodes_total": 0, "training_iteration": 28, "trial_id": "566d8_00000", "date": "2023-11-16_22-21-15", "timestamp": 1700202075, "time_this_iter_s": 2.1859383583068848, "time_total_s": 57.864948987960815, "pid": 48481, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fb780e85ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 57.864948987960815, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 65.60000000000001, "ram_util_percent": 92.40000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.149852752685547, "actor_loss": -5.156722068786621, "critic_loss": 3.6242194175720215, "alpha_loss": -0.08226650208234787, "alpha_value": 0.9919275641441345, "log_alpha_value": -0.00810519140213728, "target_entropy": -6.0, "policy_t": -0.020501215010881424, "mean_q": 1.074316382408142, "max_q": 1.381996989250183, "min_q": 0.8479909300804138}, "td_error": [4.408974647521973, 4.566594123840332, 4.7184553146362305, 1.1946240663528442, 2.393225908279419, 4.180083274841309, 4.5991339683532715, 3.960581064224243, 4.162822246551514, 5.775376319885254, 2.9441895484924316, 5.139951705932617, 4.1691083908081055, 5.080188751220703, 3.8819398880004883, 3.452995538711548, 3.5033836364746094, 3.1734848022460938, 4.752113342285156, 4.01889181137085, 5.418405055999756, 5.119746208190918, 5.994665145874023, 5.538543701171875, 4.554359436035156, 4.511937141418457, 3.2332401275634766, 4.9889726638793945, 5.549347400665283, 5.126315116882324, 4.871633529663086, 4.054166793823242, 4.271702766418457, 4.66667366027832, 5.677289962768555, 6.2039570808410645, 2.5361855030059814, 4.417367935180664, 5.555063247680664, 5.174878120422363, 3.7019248008728027, 4.1608195304870605, 2.8742218017578125, 6.054413795471191, 4.447575569152832, 4.3719353675842285, 3.5029807090759277, 5.739972114562988, 4.409893989562988, 4.765152931213379, 3.1848576068878174, 4.355138778686523, 3.5790348052978516, 1.252540111541748, 3.7033658027648926, 4.2383551597595215, 5.4610443115234375, 5.3722028732299805, 2.3386731147766113, 5.27115535736084, 3.8414978981018066, 2.7247185707092285, 7.1852593421936035, 5.1525678634643555, 4.836085796356201, 5.450453758239746, 5.273976802825928, 3.7322165966033936, 4.0926384925842285, 2.266063690185547, 3.9455628395080566, 4.823737144470215, 4.934172630310059, 3.063998222351074, 2.435865879058838, 4.134603500366211, 3.4740138053894043, 5.380568504333496, 4.682168960571289, 5.385343551635742, 3.4371252059936523, 4.550703525543213, 6.072388648986816, 5.479213714599609, 3.6572914123535156, 5.848690986633301], "mean_td_error": 4.374264717102051, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 28.0, "diff_num_grad_updates_vs_sampler_policy": 27.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.123784065246582, "actor_loss": -5.314887523651123, "critic_loss": 1.6973538398742676, "alpha_loss": -0.08204484730958939, "alpha_value": 0.9919285774230957, "log_alpha_value": -0.008104168809950352, "target_entropy": -6.0, "policy_t": 0.06880698353052139, "mean_q": 1.2117633819580078, "max_q": 1.4981768131256104, "min_q": 1.0018337965011597}, "td_error": [1.9995222091674805, 2.1922640800476074, 1.416591763496399, 3.6441125869750977, 3.961308717727661, 2.677595376968384, 3.2726619243621826, 4.962976455688477, 2.5363223552703857, 3.067534923553467, 2.789689779281616, 4.545482635498047, 1.8190863132476807, 2.9129278659820557, 4.020577430725098, 2.257891893386841, 2.695945978164673, 3.427926778793335, 3.8418474197387695, 3.512338876724243, 2.0575380325317383, 4.372859954833984, 4.357026100158691, 2.031754732131958, 3.285675525665283, 3.4567198753356934, 2.9798402786254883, 3.502441883087158, 2.954402208328247, 3.4477028846740723, 2.805379867553711, 3.3937735557556152, 2.3210041522979736, 2.4946136474609375, 2.652756929397583, 1.4562864303588867, 1.368889331817627, 5.288766860961914, 2.0350961685180664, 4.514946460723877, 1.0185751914978027, 4.762364387512207, 3.8947761058807373, 4.204748153686523, 3.760679244995117, 2.6180005073547363, 2.371880292892456, 3.4209108352661133, 3.3188278675079346, 2.3649580478668213, 1.2814581394195557, 1.4235708713531494, 2.6630825996398926, 2.4919564723968506, 3.765929937362671, 0.9892602562904358, 2.974400520324707, 1.626286268234253, 2.1946678161621094, 2.9094419479370117, 2.3399205207824707, 2.664224147796631, 4.184409141540527, 4.395704746246338, 2.167891502380371, 3.6998894214630127, 5.067770957946777, 2.6668972969055176, 3.823122501373291, 3.707463502883911, 3.0261316299438477, 1.8667244911193848, 4.215481758117676, 3.8189971446990967, 2.830019950866699, 3.5553481578826904, 2.7876949310302734, 3.6418192386627197, 3.7206950187683105, 1.7425551414489746, 2.803982734680176, 3.9145944118499756, 1.669464349746704, 4.435149192810059, 4.358567237854004, 2.760706901550293], "mean_td_error": 3.0494544506073, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 28.0, "diff_num_grad_updates_vs_sampler_policy": 27.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.093620300292969, "actor_loss": -5.286654472351074, "critic_loss": 1.095900058746338, "alpha_loss": -0.08175809681415558, "alpha_value": 0.99193274974823, "log_alpha_value": -0.008099976927042007, "target_entropy": -6.0, "policy_t": -0.06217934191226959, "mean_q": 1.2206799983978271, "max_q": 1.5728472471237183, "min_q": 1.030768632888794}, "td_error": [2.4312658309936523, 3.24777889251709, 3.519672393798828, 3.054347038269043, 2.7434799671173096, 3.6412088871002197, 3.367183208465576, 2.291435956954956, 3.907032012939453, 3.4812402725219727, 1.7630674839019775, 4.017256259918213, 2.3182594776153564, 3.6857192516326904, 3.283033609390259, 3.5753707885742188, 2.6172821521759033, 1.9754550457000732, 1.4313013553619385, 2.659658670425415, 2.5212013721466064, 5.0575456619262695, 1.9917171001434326, 5.1324310302734375, 2.3409905433654785, 3.537532091140747, 2.2266416549682617, 2.6266627311706543, 3.9370169639587402, 4.110186576843262, 3.6577022075653076, 4.306550979614258, 5.0091633796691895, 3.5346007347106934, 3.3616442680358887, 2.6061654090881348, 1.2531160116195679, 1.1264896392822266, 1.4911644458770752, 2.959434986114502, 3.8511195182800293, 2.113898754119873, 2.0946593284606934, 2.9404711723327637, 2.6829235553741455, 1.9417352676391602, 2.5104312896728516, 3.9539597034454346, 2.9987049102783203, 3.4493799209594727, 3.242373466491699, 1.6604869365692139, 1.9215409755706787, 0.5438275337219238, 3.024049997329712, 2.67113995552063, 2.183621406555176, 1.9522417783737183, 2.8733010292053223, 3.4518749713897705, 4.150492191314697, 3.1816868782043457, 0.15548241138458252, 2.20212721824646, 4.290731430053711, 2.102419137954712, 0.2016105055809021, 2.900453567504883, 3.15742564201355, 3.900486707687378, 2.2843685150146484, 5.504708766937256, 2.1486191749572754, 3.1187527179718018, 1.8177412748336792, 3.8546247482299805, 2.4636030197143555, 3.7799551486968994, 3.203129291534424, 3.7066752910614014, 3.237705707550049, 4.409984588623047, 6.352995872497559, 0.9102651476860046, 2.4902634620666504, 3.6664466857910156], "mean_td_error": 2.9424824714660645, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 28.0, "diff_num_grad_updates_vs_sampler_policy": 27.0}}, "num_env_steps_sampled": 25984, "num_env_steps_trained": 7224, "num_agent_steps_sampled": 77952, "num_agent_steps_trained": 7224, "last_target_update_ts": 25984, "num_target_updates": 28}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 77952, "num_agent_steps_trained": 7224, "num_env_steps_sampled": 25984, "num_env_steps_trained": 7224, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 483.9032120537482, "num_env_steps_trained_throughput_per_sec": 139.33820168511946, "timesteps_total": 25984, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 77952, "timers": {"training_iteration_time_ms": 2014.546, "sample_time_ms": 1436.759, "load_time_ms": 0.527, "load_throughput": 489984.348, "learn_time_ms": 63.065, "learn_throughput": 4091.003, "synch_weights_time_ms": 16.027}, "counters": {"num_env_steps_sampled": 25984, "num_env_steps_trained": 7224, "num_agent_steps_sampled": 77952, "num_agent_steps_trained": 7224, "last_target_update_ts": 25984, "num_target_updates": 28}, "done": false, "episodes_total": 0, "training_iteration": 29, "trial_id": "566d8_00000", "date": "2023-11-16_22-21-16", "timestamp": 1700202076, "time_this_iter_s": 1.8675811290740967, "time_total_s": 59.73253011703491, "pid": 48481, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fb780e85d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 59.73253011703491, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 61.5, "ram_util_percent": 92.40000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.060548782348633, "actor_loss": -5.193551540374756, "critic_loss": 3.704298973083496, "alpha_loss": -0.08456357568502426, "alpha_value": 0.9916297793388367, "log_alpha_value": -0.008405463770031929, "target_entropy": -6.0, "policy_t": 0.033106330782175064, "mean_q": 1.1578450202941895, "max_q": 1.507157325744629, "min_q": 0.865984320640564}, "td_error": [4.802528381347656, 4.075851917266846, 2.924309730529785, 4.480772972106934, 4.872861862182617, 4.28895378112793, 3.6998231410980225, 1.196000337600708, 4.962333679199219, 5.914287567138672, 3.6359829902648926, 2.123119354248047, 3.494102716445923, 3.5491175651550293, 5.2145915031433105, 2.494189500808716, 2.864258050918579, 3.332575559616089, 4.656158924102783, 3.54396390914917, 3.7994935512542725, 5.0327863693237305, 3.041874647140503, 5.273380279541016, 3.907680034637451, 3.9394822120666504, 4.440865516662598, 6.985623359680176, 1.8568525314331055, 6.1709489822387695, 4.382816314697266, 4.995792388916016, 5.509557723999023, 2.924187183380127, 6.789342880249023, 6.345432281494141, 4.705304145812988, 4.702848434448242, 7.911725997924805, 3.48298978805542, 4.444314479827881, 4.09335994720459, 3.4985039234161377, 4.508179664611816, 5.1495466232299805, 5.0029296875, 5.362943649291992, 4.699506759643555, 6.836331367492676, 2.8156065940856934, 2.8305108547210693, 6.708624362945557, 5.8264265060424805, 5.753697395324707, 4.8560285568237305, 4.350098609924316, 3.5892255306243896, 3.956594228744507, 4.969023704528809, 4.670756816864014, 6.023804664611816, 4.3806352615356445, 4.95390510559082, 3.3686330318450928, 3.527109146118164, 2.7391409873962402, 4.398872375488281, 3.8215479850769043, 4.019969940185547, 4.418709754943848, 4.059478759765625, 5.130173206329346, 5.316751480102539, 2.3323776721954346, 4.538785934448242, 3.0990355014801025, 4.008110046386719, 4.004809379577637, 4.770729064941406, 7.452644348144531, 4.666657447814941, 5.750398635864258, 4.224504470825195, 5.73454475402832, 3.2794229984283447, 5.894417762756348], "mean_td_error": 4.443746089935303, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 29.0, "diff_num_grad_updates_vs_sampler_policy": 28.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.102021217346191, "actor_loss": -5.391227722167969, "critic_loss": 1.6892277002334595, "alpha_loss": -0.08490097522735596, "alpha_value": 0.9916308522224426, "log_alpha_value": -0.008404355496168137, "target_entropy": -6.0, "policy_t": -0.0008390143630094826, "mean_q": 1.3420395851135254, "max_q": 1.5416605472564697, "min_q": 1.0983115434646606}, "td_error": [4.786281108856201, 1.4455971717834473, 4.389199256896973, 4.266329765319824, 3.5537402629852295, 2.0108284950256348, 4.797817707061768, 1.8429040908813477, 2.233400344848633, 3.137990951538086, 2.7701425552368164, 2.7385048866271973, 1.7294635772705078, 3.02341890335083, 4.449893474578857, 2.5006978511810303, 2.195834159851074, 6.061166286468506, 3.026895761489868, 6.310941219329834, 3.8705787658691406, 1.8593394756317139, 4.472986221313477, 2.828984498977661, 2.6686112880706787, 2.2953433990478516, 5.578830718994141, 0.5377230644226074, 2.0600996017456055, 3.323728561401367, 3.794002056121826, 1.2052524089813232, 2.6920862197875977, 2.358229160308838, 4.094430446624756, 0.8246926069259644, 4.783161163330078, 2.6156067848205566, 0.9190095663070679, 3.860058069229126, 3.7681236267089844, 3.7758378982543945, 3.160322904586792, 2.119035243988037, 6.102370262145996, 1.368192195892334, 3.2878122329711914, 5.523796081542969, 0.13335591554641724, 1.8707947731018066, 3.088303565979004, 4.298793315887451, 1.803816556930542, 2.150587320327759, 2.539851188659668, 1.109912395477295, 2.4788711071014404, 2.8371644020080566, 5.552684307098389, 4.117737293243408, 3.4031996726989746, 2.337165355682373, 2.5167934894561768, 2.695858955383301, 1.9473333358764648, 3.1885170936584473, 2.573535919189453, 2.386664867401123, 4.414248466491699, 1.4620580673217773, 2.5616204738616943, 1.6370973587036133, 2.5865530967712402, 2.136354684829712, 4.170837879180908, 3.42787504196167, 1.8690185546875, 1.9629795551300049, 4.119156837463379, 3.7835421562194824, 4.998026371002197, 2.5975728034973145, 1.075819492340088, 3.3389244079589844, 2.1275744438171387, 3.4213790893554688], "mean_td_error": 2.9969866275787354, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 29.0, "diff_num_grad_updates_vs_sampler_policy": 28.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.099942207336426, "actor_loss": -5.407211780548096, "critic_loss": 1.006904125213623, "alpha_loss": -0.08484070003032684, "alpha_value": 0.9916350841522217, "log_alpha_value": -0.008400116115808487, "target_entropy": -6.0, "policy_t": -0.029818182811141014, "mean_q": 1.3464375734329224, "max_q": 1.6587674617767334, "min_q": 1.049021601676941}, "td_error": [2.268688440322876, 3.4213759899139404, 3.2921905517578125, 4.28415060043335, 3.230071544647217, 2.998621702194214, 1.2273932695388794, 2.316483974456787, 2.859757423400879, 0.7425942420959473, 3.1799583435058594, 1.85970938205719, 3.2324345111846924, 4.120192527770996, 2.0496292114257812, 3.7798759937286377, 2.168583869934082, 2.6658694744110107, 2.293135643005371, 1.981273889541626, 2.759032726287842, 3.4159607887268066, 4.806235313415527, 2.95426082611084, 2.790398597717285, 4.824798107147217, 1.8582518100738525, 1.6856181621551514, 3.062130928039551, 3.2298359870910645, 3.0096359252929688, 2.7272207736968994, 2.8999085426330566, 1.808131217956543, 3.0595455169677734, 0.7206850051879883, 3.362539768218994, 0.9998205304145813, 1.884462594985962, 2.1099624633789062, 4.591316223144531, 0.720215916633606, 1.90854811668396, 3.243769884109497, 2.0343620777130127, 2.027069330215454, 2.216859817504883, 2.4163389205932617, 1.4560145139694214, 3.1654629707336426, 0.1382710337638855, 2.8348145484924316, 3.2832980155944824, 2.368320941925049, 2.168260097503662, 3.268773078918457, 2.763016939163208, 1.2541944980621338, 0.9563637375831604, 2.204843521118164, 2.61492919921875, 3.3512911796569824, 2.003878593444824, 3.6543033123016357, 1.3561923503875732, 1.7847442626953125, 4.000567436218262, 2.983957290649414, 4.207456588745117, 4.16677713394165, 1.959639549255371, 3.2335402965545654, 4.169185638427734, 0.5487752556800842, 2.1044881343841553, 4.493587493896484, 2.630948066711426, 3.5614089965820312, 5.459012031555176, 0.7543946504592896, 3.6190004348754883, 4.016324520111084, 2.0749831199645996, 3.2829418182373047, 1.5010783672332764, 3.3652875423431396], "mean_td_error": 2.6727817058563232, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 29.0, "diff_num_grad_updates_vs_sampler_policy": 28.0}}, "num_env_steps_sampled": 26880, "num_env_steps_trained": 7482, "num_agent_steps_sampled": 80640, "num_agent_steps_trained": 7482, "last_target_update_ts": 26880, "num_target_updates": 29}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80640, "num_agent_steps_trained": 7482, "num_env_steps_sampled": 26880, "num_env_steps_trained": 7482, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 466.51168614077494, "num_env_steps_trained_throughput_per_sec": 134.33037391107135, "timesteps_total": 26880, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 80640, "timers": {"training_iteration_time_ms": 2021.998, "sample_time_ms": 1445.069, "load_time_ms": 0.525, "load_throughput": 491564.655, "learn_time_ms": 62.997, "learn_throughput": 4095.417, "synch_weights_time_ms": 16.036}, "counters": {"num_env_steps_sampled": 26880, "num_env_steps_trained": 7482, "num_agent_steps_sampled": 80640, "num_agent_steps_trained": 7482, "last_target_update_ts": 26880, "num_target_updates": 29}, "done": false, "episodes_total": 0, "training_iteration": 30, "trial_id": "566d8_00000", "date": "2023-11-16_22-21-18", "timestamp": 1700202078, "time_this_iter_s": 1.935558795928955, "time_total_s": 61.66808891296387, "pid": 48481, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fb780eab790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 61.66808891296387, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 65.63333333333333, "ram_util_percent": 92.46666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.144462585449219, "actor_loss": -5.37170934677124, "critic_loss": 3.71237850189209, "alpha_loss": -0.08831404149532318, "alpha_value": 0.9913321733474731, "log_alpha_value": -0.008705639280378819, "target_entropy": -6.0, "policy_t": -0.03602170944213867, "mean_q": 1.2645313739776611, "max_q": 1.5701475143432617, "min_q": 0.9730987548828125}, "td_error": [4.282890319824219, 4.0172600746154785, 2.7969446182250977, 4.061474800109863, 5.581628799438477, 5.3607048988342285, 4.360523700714111, 4.045285224914551, 3.0561141967773438, 4.5101823806762695, 5.508916854858398, 2.9568278789520264, 4.9454426765441895, 4.476548194885254, 4.267115116119385, 3.0685677528381348, 3.5551810264587402, 5.1736369132995605, 3.0062336921691895, 4.9304704666137695, 4.980203628540039, 6.122488021850586, 5.624658584594727, 3.0840768814086914, 4.507436752319336, 4.116996765136719, 4.14725399017334, 4.792167663574219, 2.9209461212158203, 2.090822696685791, 1.638056755065918, 5.294950008392334, 2.8298277854919434, 4.55864143371582, 6.104081630706787, 4.598173141479492, 4.577054977416992, 3.411914348602295, 4.863529205322266, 3.263357639312744, 4.477963447570801, 4.418709754943848, 5.500879287719727, 5.199152946472168, 3.9065260887145996, 5.885096549987793, 5.991856575012207, 6.816670894622803, 3.310272693634033, 3.3512234687805176, 5.0671586990356445, 4.775745868682861, 6.98138952255249, 3.955890417098999, 4.917552947998047, 5.588920593261719, 4.679747104644775, 6.145612716674805, 3.929018497467041, 5.5782151222229, 4.268741130828857, 2.7322640419006348, 3.7205214500427246, 3.242243528366089, 5.998214244842529, 3.999483585357666, 3.8899970054626465, 4.719476699829102, 4.368355751037598, 1.8867082595825195, 5.019755840301514, 2.910942316055298, 3.5185627937316895, 6.830328941345215, 5.638731479644775, 3.725165367126465, 4.131872177124023, 2.763176441192627, 3.522007465362549, 2.90014910697937, 4.253488540649414, 4.853511333465576, 4.545590877532959, 5.999529838562012, 3.8157689571380615, 5.693254470825195], "mean_td_error": 4.382720947265625, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 30.0, "diff_num_grad_updates_vs_sampler_policy": 29.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.055903434753418, "actor_loss": -5.488729476928711, "critic_loss": 1.3912370204925537, "alpha_loss": -0.08753245323896408, "alpha_value": 0.9913331866264343, "log_alpha_value": -0.00870458409190178, "target_entropy": -6.0, "policy_t": -0.02358206734061241, "mean_q": 1.4537771940231323, "max_q": 1.7171493768692017, "min_q": 1.140942931175232}, "td_error": [1.2944852113723755, 2.4644722938537598, 3.3413476943969727, 2.684427261352539, 4.481076717376709, 2.169445276260376, 4.276188850402832, 1.565248727798462, 2.3879120349884033, 3.1624460220336914, 2.099721670150757, 1.7490391731262207, 2.117356538772583, 3.536325454711914, 2.9736716747283936, 4.715910911560059, 1.891042947769165, 2.7290093898773193, 2.443763494491577, 2.440282106399536, 4.023820877075195, 3.7621984481811523, 3.752689838409424, 2.7408618927001953, 3.1476242542266846, 5.267127990722656, 4.0060577392578125, 2.2054030895233154, 1.571938157081604, 3.643476963043213, 3.556657075881958, 2.7466068267822266, 0.07340383529663086, 2.395148754119873, 1.7894575595855713, 2.66583251953125, 4.497074127197266, 1.3855888843536377, 2.6151742935180664, 2.4174718856811523, 2.700244903564453, 1.8225009441375732, 1.582384467124939, 4.973957538604736, 3.4250082969665527, 2.9555158615112305, 4.299924850463867, 4.125322341918945, 1.6642491817474365, 1.9982538223266602, 1.8987491130828857, 2.7502832412719727, 1.7993496656417847, 0.9064112305641174, 2.2629141807556152, 4.881899356842041, 2.4792747497558594, 1.5382909774780273, 0.8352184295654297, 4.6465959548950195, 2.650383234024048, 3.2974915504455566, 4.10530948638916, 2.0401008129119873, 5.916972637176514, 0.6475942134857178, 0.7690272927284241, 3.991161584854126, 2.895987033843994, 3.470365047454834, 3.7271928787231445, 1.9737372398376465, 3.3286631107330322, 2.4927432537078857, 4.285882949829102, 1.5211181640625, 1.8094472885131836, 2.995359420776367, 4.977299690246582, 4.65577507019043, 1.518022060394287, 1.8289616107940674, 1.959216594696045, 3.08937931060791, 2.969111919403076, 2.504882335662842], "mean_td_error": 2.811096668243408, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 30.0, "diff_num_grad_updates_vs_sampler_policy": 29.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.042369842529297, "actor_loss": -5.46111536026001, "critic_loss": 1.095592975616455, "alpha_loss": -0.08737125247716904, "alpha_value": 0.9913374781608582, "log_alpha_value": -0.008700262755155563, "target_entropy": -6.0, "policy_t": 0.017885927110910416, "mean_q": 1.4577991962432861, "max_q": 1.7778723239898682, "min_q": 1.1470110416412354}, "td_error": [2.404956817626953, 1.8445992469787598, 2.7035374641418457, 4.815944671630859, 0.9625958204269409, 1.4518101215362549, 3.3058762550354004, 2.9259190559387207, 2.825296401977539, 2.316082239151001, 4.34037971496582, 1.112992763519287, 2.292583703994751, 5.189848899841309, 2.6193015575408936, 1.6324372291564941, 2.1233975887298584, 1.6309378147125244, 3.6999671459198, 4.084169864654541, 1.4156802892684937, 3.8393609523773193, 4.819511413574219, 3.9862465858459473, 1.8547487258911133, 3.4450302124023438, 2.0759646892547607, 1.3051190376281738, 0.1701473593711853, 0.19114243984222412, 5.093600273132324, 2.9688844680786133, 2.3850502967834473, 3.535057544708252, 2.6415233612060547, 3.7959282398223877, 2.1264922618865967, 2.2526438236236572, 3.492597818374634, 3.5858540534973145, 2.9990668296813965, 2.6239173412323, 3.9784798622131348, 3.739208698272705, 2.9848556518554688, 4.451455116271973, 3.8996195793151855, 2.7246651649475098, 2.4553279876708984, 2.486642360687256, 1.800431728363037, 2.8750786781311035, 1.4751745462417603, 4.42543363571167, 1.162067174911499, 3.2003016471862793, 3.027613639831543, 3.877736806869507, 4.501748561859131, 2.9329299926757812, 4.947833061218262, 4.806818962097168, 0.7130599617958069, 2.0332272052764893, 2.6367974281311035, 3.2479515075683594, 3.4515321254730225, 1.5217461585998535, 2.5218677520751953, 3.3368961811065674, 1.8243329524993896, 3.2923450469970703, 2.0642547607421875, 4.520130157470703, 0.6068491339683533, 3.863285541534424, 1.8922383785247803, 3.618335485458374, 2.3178350925445557, 2.689718008041382, 1.508066177368164, 1.5962138175964355, 1.819596767425537, 1.9732952117919922, 3.8518967628479004, 4.866677284240723], "mean_td_error": 2.818695068359375, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 30.0, "diff_num_grad_updates_vs_sampler_policy": 29.0}}, "num_env_steps_sampled": 27776, "num_env_steps_trained": 7740, "num_agent_steps_sampled": 83328, "num_agent_steps_trained": 7740, "last_target_update_ts": 27776, "num_target_updates": 30}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 83328, "num_agent_steps_trained": 7740, "num_env_steps_sampled": 27776, "num_env_steps_trained": 7740, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 471.8561455740577, "num_env_steps_trained_throughput_per_sec": 135.86929191753, "timesteps_total": 27776, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 83328, "timers": {"training_iteration_time_ms": 2025.163, "sample_time_ms": 1449.218, "load_time_ms": 0.532, "load_throughput": 485282.045, "learn_time_ms": 62.919, "learn_throughput": 4100.507, "synch_weights_time_ms": 15.903}, "counters": {"num_env_steps_sampled": 27776, "num_env_steps_trained": 7740, "num_agent_steps_sampled": 83328, "num_agent_steps_trained": 7740, "last_target_update_ts": 27776, "num_target_updates": 30}, "done": false, "episodes_total": 0, "training_iteration": 31, "trial_id": "566d8_00000", "date": "2023-11-16_22-21-20", "timestamp": 1700202080, "time_this_iter_s": 1.9140448570251465, "time_total_s": 63.582133769989014, "pid": 48481, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fb780e85d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 63.582133769989014, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 72.2, "ram_util_percent": 92.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.030631065368652, "actor_loss": -5.349388599395752, "critic_loss": 3.5992980003356934, "alpha_loss": -0.0903349220752716, "alpha_value": 0.9910345077514648, "log_alpha_value": -0.00900590606033802, "target_entropy": -6.0, "policy_t": 0.013604613021016121, "mean_q": 1.3511353731155396, "max_q": 1.691169261932373, "min_q": 1.0929816961288452}, "td_error": [5.003052234649658, 3.6733851432800293, 3.8642544746398926, 5.053558349609375, 3.7037580013275146, 5.100396156311035, 1.7971394062042236, 3.611873149871826, 5.533961296081543, 3.5940465927124023, 5.604901313781738, 5.014275550842285, 4.539283752441406, 3.562169075012207, 3.580064296722412, 4.1794915199279785, 5.454859733581543, 5.416838645935059, 3.3654415607452393, 3.613065004348755, 3.525709629058838, 4.720942497253418, 4.343630790710449, 3.8697593212127686, 7.283658981323242, 3.2302470207214355, 5.1669511795043945, 4.813958168029785, 4.337006568908691, 1.5412929058074951, 3.5416641235351562, 4.6613688468933105, 5.654273986816406, 6.300449848175049, 1.857066035270691, 4.517596244812012, 3.7270870208740234, 3.6478376388549805, 3.3539679050445557, 2.335756778717041, 4.8881754875183105, 4.397778034210205, 3.0636775493621826, 4.889594078063965, 4.831368923187256, 5.164839744567871, 2.1767749786376953, 4.178168296813965, 4.329015731811523, 6.972946643829346, 5.54663610458374, 4.441650867462158, 4.330879211425781, 4.760990619659424, 4.598773956298828, 3.632357120513916, 4.909127235412598, 5.9578399658203125, 4.934013843536377, 5.412494659423828, 4.652876853942871, 4.988017559051514, 3.875182867050171, 4.701753616333008, 2.35701847076416, 3.5010039806365967, 2.2447075843811035, 4.309774398803711, 4.835480690002441, 3.879159927368164, 3.5289998054504395, 5.51146125793457, 6.062493324279785, 6.7726359367370605, 5.193929672241211, 5.852041244506836, 3.631192684173584, 3.8901615142822266, 1.7925002574920654, 3.382742404937744, 5.458144187927246, 5.2387895584106445, 4.234716415405273, 4.0938496589660645, 4.604449272155762, 4.748105525970459], "mean_td_error": 4.354119777679443, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 31.0, "diff_num_grad_updates_vs_sampler_policy": 30.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.106233596801758, "actor_loss": -5.608558177947998, "critic_loss": 1.0844814777374268, "alpha_loss": -0.09100412577390671, "alpha_value": 0.9910356998443604, "log_alpha_value": -0.009004751220345497, "target_entropy": -6.0, "policy_t": 0.0030489370692521334, "mean_q": 1.5683467388153076, "max_q": 1.98613703250885, "min_q": 1.2665627002716064}, "td_error": [3.221116542816162, 0.2347947359085083, 4.005232810974121, 3.6754517555236816, 3.785959243774414, 3.1853437423706055, 2.8504505157470703, 2.028545379638672, 0.043271541595458984, 3.2026541233062744, 2.023391008377075, 1.2013978958129883, 2.2776613235473633, 3.1305060386657715, 3.1802492141723633, 4.229180335998535, 4.086379051208496, 3.063962459564209, 2.014057159423828, 3.6619246006011963, 1.30295729637146, 2.545018196105957, 3.1142349243164062, 2.394322633743286, 1.8943498134613037, 1.6463775634765625, 3.600675582885742, 4.254754066467285, 3.8282365798950195, 1.3534789085388184, 3.429853916168213, 2.5505223274230957, 4.140936851501465, 1.467383623123169, 3.5247697830200195, 3.1562464237213135, 1.3494300842285156, 2.0392706394195557, 1.8016607761383057, 1.6534794569015503, 2.0387697219848633, 0.5421395897865295, 1.5490403175354004, 2.328486442565918, 1.7551651000976562, 4.731807231903076, 2.2946150302886963, 1.6657370328903198, 3.627769947052002, 3.489330768585205, 0.8591130971908569, 2.305194616317749, 4.3361711502075195, 2.3070883750915527, 2.2560181617736816, 3.3302297592163086, 3.746568202972412, 1.1477024555206299, 4.659203052520752, 2.5962491035461426, 3.2234888076782227, 1.1791858673095703, 3.703674793243408, 1.9825589656829834, 0.9962399005889893, 3.945390224456787, 2.7855374813079834, 4.641940116882324, 1.0949711799621582, 1.1796329021453857, 4.493920803070068, 1.7387473583221436, 3.1476175785064697, 3.4343857765197754, 3.425841808319092, 1.8295767307281494, 1.405578374862671, 2.1553969383239746, 5.386923313140869, 1.6034953594207764, 3.5765492916107178, 0.1588842272758484, 2.6607110500335693, 1.6926300525665283, 2.070377826690674, 2.891099214553833], "mean_td_error": 2.6060492992401123, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 31.0, "diff_num_grad_updates_vs_sampler_policy": 30.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.07581901550293, "actor_loss": -5.623399257659912, "critic_loss": 0.9863498210906982, "alpha_loss": -0.09068534523248672, "alpha_value": 0.9910401105880737, "log_alpha_value": -0.009000294841825962, "target_entropy": -6.0, "policy_t": -0.007480828557163477, "mean_q": 1.603297233581543, "max_q": 2.079585075378418, "min_q": 1.308132290840149}, "td_error": [3.210120916366577, 2.8324379920959473, 2.5720601081848145, 1.738228440284729, 1.6247107982635498, 2.8694944381713867, 1.877399206161499, 4.076310634613037, 1.2274446487426758, 2.2906455993652344, 4.312697410583496, 2.630098819732666, 0.8297966122627258, 1.9301073551177979, 2.5920169353485107, 2.11954402923584, 2.9333343505859375, 3.6724634170532227, 2.9780445098876953, 5.277817726135254, 2.7473998069763184, 4.001044273376465, 2.4111735820770264, 2.443702220916748, 3.367806911468506, 1.257249116897583, 1.2291759252548218, 2.3763911724090576, 2.1865270137786865, 3.1498801708221436, 3.1704959869384766, 2.632932662963867, 3.2956838607788086, 3.5907182693481445, 1.2154085636138916, 3.7131967544555664, 0.9706084728240967, 2.2362475395202637, 2.3905324935913086, 3.552309036254883, 3.234431505203247, 2.6613473892211914, 1.4025059938430786, 5.198488235473633, 1.4032092094421387, 2.54530930519104, 3.8840954303741455, 2.1250429153442383, 1.1132240295410156, 2.836714506149292, 2.513453960418701, 6.566896915435791, 1.8118387460708618, 2.8296008110046387, 1.3993823528289795, 1.8851652145385742, 0.7074604630470276, 2.749912738800049, 0.9580312371253967, 5.47808837890625, 2.1881937980651855, 1.9054138660430908, 2.8651394844055176, 3.959012269973755, 3.535142183303833, 4.42183256149292, 0.2408791184425354, 2.2936432361602783, 1.3506841659545898, 1.7970033884048462, 1.3308918476104736, 3.3692679405212402, 2.4680535793304443, 2.9539027214050293, 3.285867691040039, 3.9157063961029053, 2.1088616847991943, 2.5036048889160156, 0.6137169599533081, 2.9392948150634766, 2.7165300846099854, 4.007997512817383, 3.749358892440796, 2.849836826324463, 1.1904585361480713, 2.683412551879883], "mean_td_error": 2.6288506984710693, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 31.0, "diff_num_grad_updates_vs_sampler_policy": 30.0}}, "num_env_steps_sampled": 28672, "num_env_steps_trained": 7998, "num_agent_steps_sampled": 86016, "num_agent_steps_trained": 7998, "last_target_update_ts": 28672, "num_target_updates": 31}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 86016, "num_agent_steps_trained": 7998, "num_env_steps_sampled": 28672, "num_env_steps_trained": 7998, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 356.35865640112024, "num_env_steps_trained_throughput_per_sec": 102.61220240121541, "timesteps_total": 28672, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 86016, "timers": {"training_iteration_time_ms": 2079.434, "sample_time_ms": 1502.563, "load_time_ms": 0.539, "load_throughput": 478712.865, "learn_time_ms": 63.003, "learn_throughput": 4095.013, "synch_weights_time_ms": 15.66}, "counters": {"num_env_steps_sampled": 28672, "num_env_steps_trained": 7998, "num_agent_steps_sampled": 86016, "num_agent_steps_trained": 7998, "last_target_update_ts": 28672, "num_target_updates": 31}, "done": false, "episodes_total": 0, "training_iteration": 32, "trial_id": "566d8_00000", "date": "2023-11-16_22-21-23", "timestamp": 1700202083, "time_this_iter_s": 2.529623031616211, "time_total_s": 66.11175680160522, "pid": 48481, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fb780e7f940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 66.11175680160522, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 87.63333333333333, "ram_util_percent": 92.56666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.085527420043945, "actor_loss": -5.513306140899658, "critic_loss": 3.4304685592651367, "alpha_loss": -0.09385603666305542, "alpha_value": 0.9907371401786804, "log_alpha_value": -0.009306010790169239, "target_entropy": -6.0, "policy_t": 0.011960359290242195, "mean_q": 1.5031230449676514, "max_q": 1.9000424146652222, "min_q": 1.1985543966293335}, "td_error": [4.321096420288086, 4.573686122894287, 3.834355354309082, 4.183135986328125, 2.583367109298706, 5.949918746948242, 2.2005887031555176, 3.4032602310180664, 4.3820600509643555, 4.683226108551025, 4.222983360290527, 5.03496789932251, 5.198636054992676, 4.660640716552734, 2.2128896713256836, 3.1091959476470947, 3.7467899322509766, 4.774958610534668, 1.7089952230453491, 5.598209381103516, 5.757692337036133, 3.0489683151245117, 3.1503443717956543, 3.118486166000366, 5.074092864990234, 4.42280387878418, 3.9884064197540283, 4.626784324645996, 4.513040542602539, 5.155345916748047, 2.6386189460754395, 2.9280195236206055, 5.951513290405273, 5.68902587890625, 0.44550222158432007, 3.2118184566497803, 4.557049751281738, 5.487703323364258, 3.7884085178375244, 5.148881912231445, 1.0830096006393433, 3.8040149211883545, 4.038578987121582, 3.1192917823791504, 4.365900039672852, 1.871389627456665, 4.554701328277588, 5.088393688201904, 5.741207122802734, 1.7682193517684937, 8.296645164489746, 2.364250659942627, 3.0599007606506348, 4.5757880210876465, 4.212910175323486, 5.248758316040039, 4.364151954650879, 3.886608123779297, 4.122585296630859, 4.108823776245117, 3.5959246158599854, 3.759396553039551, 4.865278244018555, 4.171952247619629, 6.097253322601318, 4.405383110046387, 3.616576671600342, 4.1344757080078125, 3.395956516265869, 4.614846229553223, 3.0102264881134033, 4.906879425048828, 4.106319427490234, 5.849474906921387, 5.410275459289551, 5.20994758605957, 2.8804030418395996, 4.6720356941223145, 4.084112167358398, 4.980158805847168, 5.5946245193481445, 3.543710470199585, 3.3831169605255127, 4.064972877502441, 4.22242546081543, 1.9629247188568115], "mean_td_error": 4.10813045501709, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 32.0, "diff_num_grad_updates_vs_sampler_policy": 31.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.107282638549805, "actor_loss": -5.759335041046143, "critic_loss": 0.9729989767074585, "alpha_loss": -0.09404797106981277, "alpha_value": 0.9907382130622864, "log_alpha_value": -0.009304971434175968, "target_entropy": -6.0, "policy_t": 0.004151757340878248, "mean_q": 1.673113465309143, "max_q": 2.0030715465545654, "min_q": 1.349219799041748}, "td_error": [3.5610570907592773, 3.294064998626709, 0.3083627223968506, 3.810697555541992, 1.9734632968902588, 2.973130702972412, 2.817671298980713, 4.489836692810059, 2.1739535331726074, 1.753326416015625, 3.468515157699585, 1.0359649658203125, 2.7165651321411133, 4.220640182495117, 2.4793241024017334, 1.005087971687317, 2.0076632499694824, 3.6905746459960938, 3.941939115524292, 2.5158281326293945, 1.1996852159500122, 1.700798749923706, 2.1367294788360596, 1.1519103050231934, 1.4019725322723389, 2.258260726928711, 1.1730204820632935, 1.3408732414245605, 3.184349298477173, 2.6120429039001465, 4.232779502868652, 3.6955275535583496, 2.9911582469940186, 1.4451477527618408, 3.526665449142456, 2.270888328552246, 3.5253942012786865, 2.7209062576293945, 0.8579636216163635, 3.7145049571990967, 3.25437068939209, 4.877216339111328, 4.174683094024658, 4.188361167907715, 2.9027953147888184, 3.300283670425415, 3.240457534790039, 2.9236042499542236, 3.438957452774048, 1.8719048500061035, 1.399254322052002, 4.553447723388672, 2.3292832374572754, 3.6304497718811035, 4.306244850158691, 3.067582130432129, 0.7515882253646851, 2.2667298316955566, 2.5889830589294434, 2.2086076736450195, 4.179905891418457, 4.077322006225586, 4.0157790184021, 3.894094705581665, 2.7571306228637695, 2.4348232746124268, 2.7088325023651123, 0.996518611907959, 0.849273145198822, 3.5477356910705566, 1.9132511615753174, 4.423976898193359, 0.7559788823127747, 3.435793876647949, 3.1178297996520996, 1.0747551918029785, 1.2007794380187988, 1.314589500427246, 2.9513628482818604, 2.815735340118408, 1.9331116676330566, 3.1911613941192627, 2.9016060829162598, 1.0368272066116333, 3.581275463104248, 0.43033307790756226], "mean_td_error": 2.653404951095581, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 32.0, "diff_num_grad_updates_vs_sampler_policy": 31.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.088947296142578, "actor_loss": -5.8153791427612305, "critic_loss": 0.9196417331695557, "alpha_loss": -0.09383019804954529, "alpha_value": 0.9907428026199341, "log_alpha_value": -0.009300297126173973, "target_entropy": -6.0, "policy_t": 0.003974320366978645, "mean_q": 1.7810389995574951, "max_q": 2.1653566360473633, "min_q": 1.369283676147461}, "td_error": [2.8252601623535156, 1.02874755859375, 4.796754837036133, 0.7389212846755981, 2.160335063934326, 2.9992377758026123, 1.607649326324463, 2.81282901763916, 4.856712341308594, 1.9614825248718262, 3.2940196990966797, 1.077423334121704, 1.8751389980316162, 1.9671785831451416, 4.084462642669678, 3.160743236541748, 4.322251319885254, 1.210705041885376, 4.466322898864746, 0.3789675235748291, 1.4404041767120361, 0.39625978469848633, 0.7027673125267029, 4.866772651672363, 4.698990345001221, 3.685314178466797, 1.7100695371627808, 2.4973983764648438, 2.0373241901397705, 3.7640562057495117, 3.8712568283081055, 2.3253419399261475, 2.093702793121338, 1.6731239557266235, 0.742280900478363, 2.512643337249756, 4.134273529052734, 2.800940990447998, 0.48074930906295776, 2.251469612121582, 2.6110477447509766, 3.4016237258911133, 1.5282132625579834, 2.9842891693115234, 1.6066919565200806, 2.622537136077881, 1.7046105861663818, 3.0030465126037598, 1.5989010334014893, 1.0283457040786743, 1.3601133823394775, 2.72359037399292, 1.6727869510650635, 0.6268541812896729, 2.189499855041504, 1.834725260734558, 1.9815102815628052, 4.666869640350342, 2.984018325805664, 2.908451557159424, 2.133366584777832, 1.4473556280136108, 1.817725419998169, 1.4791569709777832, 0.19238907098770142, 3.5419235229492188, 5.169795513153076, 4.609091281890869, 1.6703517436981201, 0.7785663604736328, 1.743415355682373, 2.8364386558532715, 2.652686595916748, 3.5349485874176025, 1.669506311416626, 1.4017406702041626, 3.960773229598999, 1.9241631031036377, 3.1937737464904785, 2.5245513916015625, 1.6513850688934326, 3.5036978721618652, 2.686521291732788, 4.791963577270508, 3.427229881286621, 2.8593549728393555], "mean_td_error": 2.471510410308838, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 32.0, "diff_num_grad_updates_vs_sampler_policy": 31.0}}, "num_env_steps_sampled": 29568, "num_env_steps_trained": 8256, "num_agent_steps_sampled": 88704, "num_agent_steps_trained": 8256, "last_target_update_ts": 29568, "num_target_updates": 32}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88704, "num_agent_steps_trained": 8256, "num_env_steps_sampled": 29568, "num_env_steps_trained": 8256, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 421.56475979501573, "num_env_steps_trained_throughput_per_sec": 121.38806699454695, "timesteps_total": 29568, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 88704, "timers": {"training_iteration_time_ms": 2064.798, "sample_time_ms": 1490.326, "load_time_ms": 0.542, "load_throughput": 475661.728, "learn_time_ms": 63.002, "learn_throughput": 4095.127, "synch_weights_time_ms": 16.007}, "counters": {"num_env_steps_sampled": 29568, "num_env_steps_trained": 8256, "num_agent_steps_sampled": 88704, "num_agent_steps_trained": 8256, "last_target_update_ts": 29568, "num_target_updates": 32}, "done": false, "episodes_total": 0, "training_iteration": 33, "trial_id": "566d8_00000", "date": "2023-11-16_22-21-25", "timestamp": 1700202085, "time_this_iter_s": 2.1443562507629395, "time_total_s": 68.25611305236816, "pid": 48481, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fb780e7f310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 68.25611305236816, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 75.56666666666666, "ram_util_percent": 92.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.117040634155273, "actor_loss": -5.667224407196045, "critic_loss": 2.6400434970855713, "alpha_loss": -0.09718520939350128, "alpha_value": 0.9904398918151855, "log_alpha_value": -0.009606091305613518, "target_entropy": -6.0, "policy_t": 0.007442491129040718, "mean_q": 1.6469173431396484, "max_q": 2.1723947525024414, "min_q": 1.2490403652191162}, "td_error": [3.3769826889038086, 5.018627166748047, 4.139852523803711, 3.873577117919922, 3.719205856323242, 3.8726658821105957, 4.1004533767700195, 2.999232292175293, 5.198899269104004, 1.3125970363616943, 4.023357391357422, 2.693373441696167, 4.965874671936035, 3.6275722980499268, 3.8721964359283447, 3.2741007804870605, 5.970057487487793, 4.031851291656494, 5.057413101196289, 5.448144912719727, 3.80509614944458, 4.314435958862305, 1.3840603828430176, 4.850018501281738, 5.784928798675537, 3.4775800704956055, 0.9417062401771545, 4.857598781585693, 1.947875738143921, 4.494128227233887, 3.1473021507263184, 4.936981201171875, 2.885099411010742, 3.791081428527832, 3.1753926277160645, 3.006709098815918, 2.3064117431640625, 4.019374847412109, 4.551146507263184, 3.647456407546997, 3.7944278717041016, 3.0228042602539062, 3.601896286010742, 2.3119730949401855, 3.8612308502197266, 3.3939061164855957, 4.30640983581543, 4.877987861633301, 5.182228088378906, 3.2016515731811523, 3.9636030197143555, 5.466161727905273, 3.3371992111206055, 3.2685980796813965, 4.1498517990112305, 4.12531852722168, 3.9555563926696777, 5.58762264251709, 2.5215117931365967, 3.640157461166382, 5.482001304626465, 4.591132164001465, 3.497722864151001, 3.7572293281555176, 5.122882843017578, 2.83852481842041, 3.5023746490478516, 3.189389228820801, 4.323866844177246, 2.8849666118621826, 3.1108810901641846, 4.6915483474731445, 4.119266033172607, 3.1887736320495605, 5.1488752365112305, 4.957340240478516, 4.25019645690918, 3.7416701316833496, 3.1690292358398438, 4.248611927032471, 4.27726936340332, 4.254232406616211, 3.9462099075317383, 4.886885643005371, 2.72280216217041, 5.206776142120361], "mean_td_error": 3.8904762268066406, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 33.0, "diff_num_grad_updates_vs_sampler_policy": 32.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.021713256835938, "actor_loss": -5.796497821807861, "critic_loss": 0.9056130647659302, "alpha_loss": -0.09626097232103348, "alpha_value": 0.9904407262802124, "log_alpha_value": -0.00960524007678032, "target_entropy": -6.0, "policy_t": -0.02026962675154209, "mean_q": 1.8020739555358887, "max_q": 2.191861867904663, "min_q": 1.4353424310684204}, "td_error": [3.6424288749694824, 2.8817572593688965, 1.667665719985962, 3.97103214263916, 2.7359089851379395, 2.999373197555542, 2.366692066192627, 3.306025981903076, 1.8412706851959229, 3.396211862564087, 2.695505142211914, 1.566809058189392, 1.8464776277542114, 1.0235176086425781, 2.3953604698181152, 3.7094802856445312, 2.603668212890625, 0.5413010120391846, 2.1717028617858887, 3.6931357383728027, 1.5653784275054932, 2.0723319053649902, 2.024867534637451, 2.4299778938293457, 0.9044018983840942, 2.4750404357910156, 2.097494125366211, 1.1892070770263672, 3.7595133781433105, 2.032449245452881, 2.2728614807128906, 2.5460147857666016, 4.824523448944092, 4.407907485961914, 1.1540842056274414, 0.47014766931533813, 1.827943205833435, 0.9858546257019043, 3.2392945289611816, 2.565016746520996, 2.597158908843994, 3.6775100231170654, 0.7137280702590942, 2.5592827796936035, 6.675580024719238, 4.520640850067139, 1.3017046451568604, 4.634520530700684, 2.97379207611084, 2.203986406326294, 3.2982897758483887, 2.4646339416503906, 2.5090019702911377, 1.3433688879013062, 0.9321960806846619, 1.3705885410308838, 1.0866103172302246, 1.0656161308288574, 2.949476718902588, 3.2971878051757812, 2.4857354164123535, 2.7065865993499756, 2.075923442840576, 1.720007061958313, 2.316735029220581, 1.4598615169525146, 1.8647632598876953, 2.8959765434265137, 3.3221192359924316, 5.040437698364258, 1.8624587059020996, 3.8602347373962402, 1.6661126613616943, 5.415038585662842, 2.1336355209350586, 3.5807809829711914, 1.0394585132598877, 3.3531060218811035, 0.5075259208679199, 0.8921592235565186, 2.0403571128845215, 2.9595789909362793, 4.313012599945068, 1.5217525959014893, 2.903411388397217, 1.5042181015014648], "mean_td_error": 2.4827382564544678, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 33.0, "diff_num_grad_updates_vs_sampler_policy": 32.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.084920883178711, "actor_loss": -5.969508647918701, "critic_loss": 0.9862574934959412, "alpha_loss": -0.09681828320026398, "alpha_value": 0.990445613861084, "log_alpha_value": -0.009600302204489708, "target_entropy": -6.0, "policy_t": 0.0578220970928669, "mean_q": 1.9132671356201172, "max_q": 2.4047369956970215, "min_q": 1.437575340270996}, "td_error": [3.402205228805542, 4.8590569496154785, 2.498506546020508, 3.6005635261535645, 1.222774863243103, 5.754756927490234, 2.432126522064209, 3.534233570098877, 2.9647486209869385, 2.9387035369873047, 3.8528404235839844, 1.3991354703903198, 1.1447830200195312, 1.4039182662963867, 4.667804718017578, 2.897556781768799, 1.9031813144683838, 1.9606549739837646, 5.540014266967773, 2.801694393157959, 2.3793816566467285, 2.0553016662597656, 2.966752767562866, 1.4013804197311401, 5.765464782714844, 1.2142679691314697, 2.9355382919311523, 5.986127853393555, 1.7703170776367188, 2.9028849601745605, 3.205275058746338, 2.690852403640747, 0.39235156774520874, 3.4130592346191406, 0.09865415096282959, 3.1188738346099854, 2.5730185508728027, 3.3662233352661133, 1.2010118961334229, 1.3100497722625732, 2.8924038410186768, 2.694598436355591, 3.304536819458008, 2.448568820953369, 2.510164260864258, 4.251565933227539, 3.700584888458252, 3.3560657501220703, 4.339526653289795, 0.734433114528656, 2.9863839149475098, 3.210206985473633, 2.199138879776001, 3.438455104827881, 1.0921016931533813, 0.5181787014007568, 1.2063608169555664, 2.0204482078552246, 0.7694356441497803, 2.1901350021362305, 2.7543976306915283, 2.895112991333008, 2.578878402709961, 2.6223859786987305, 0.31663358211517334, 1.621732234954834, 2.1383814811706543, 1.9056284427642822, 2.999986171722412, 0.14746510982513428, 4.849662780761719, 3.062040090560913, 2.4568519592285156, 2.2640633583068848, 2.552006244659424, 3.481912136077881, 1.8626501560211182, 2.7334678173065186, 1.435558795928955, 3.260468006134033, 1.6469357013702393, 3.183590888977051, 0.9892184138298035, 1.0674247741699219, 1.9795112609863281, 4.703028678894043], "mean_td_error": 2.591841220855713, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 33.0, "diff_num_grad_updates_vs_sampler_policy": 32.0}}, "num_env_steps_sampled": 30464, "num_env_steps_trained": 8514, "num_agent_steps_sampled": 91392, "num_agent_steps_trained": 8514, "last_target_update_ts": 30464, "num_target_updates": 33}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 91392, "num_agent_steps_trained": 8514, "num_env_steps_sampled": 30464, "num_env_steps_trained": 8514, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 425.22879324792916, "num_env_steps_trained_throughput_per_sec": 122.4431123414796, "timesteps_total": 30464, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 91392, "timers": {"training_iteration_time_ms": 2041.291, "sample_time_ms": 1466.622, "load_time_ms": 0.544, "load_throughput": 474348.149, "learn_time_ms": 62.914, "learn_throughput": 4100.848, "synch_weights_time_ms": 15.904}, "counters": {"num_env_steps_sampled": 30464, "num_env_steps_trained": 8514, "num_agent_steps_sampled": 91392, "num_agent_steps_trained": 8514, "last_target_update_ts": 30464, "num_target_updates": 33}, "done": false, "episodes_total": 0, "training_iteration": 34, "trial_id": "566d8_00000", "date": "2023-11-16_22-21-27", "timestamp": 1700202087, "time_this_iter_s": 2.1231000423431396, "time_total_s": 70.3792130947113, "pid": 48481, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fb780e7f820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 70.3792130947113, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 75.7, "ram_util_percent": 92.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.079368591308594, "actor_loss": -5.760612964630127, "critic_loss": 2.4570813179016113, "alpha_loss": -0.09984840452671051, "alpha_value": 0.9901427030563354, "log_alpha_value": -0.009906217455863953, "target_entropy": -6.0, "policy_t": -0.039482854306697845, "mean_q": 1.723495364189148, "max_q": 2.1110317707061768, "min_q": 1.3922678232192993}, "td_error": [1.8224033117294312, 1.8064730167388916, 4.079990863800049, 4.233852386474609, 4.914316177368164, 4.231691360473633, 2.6996753215789795, 1.337805986404419, 5.470533847808838, 4.455114841461182, 3.5568084716796875, 3.9309396743774414, 3.8806827068328857, 6.448625564575195, 2.1357407569885254, 4.148102760314941, 2.1350512504577637, 6.224442005157471, 2.54455304145813, 3.663723945617676, 4.161521911621094, 6.025701522827148, 5.364526748657227, 1.4971494674682617, 3.699496030807495, 1.6312520503997803, 3.9450368881225586, 3.289219379425049, 3.483487367630005, 5.8292236328125, 4.386331081390381, 3.9894180297851562, 6.038377285003662, 3.121817111968994, 5.141253471374512, 4.213339805603027, 3.4968137741088867, 2.202885627746582, 4.104421615600586, 5.154085159301758, 3.2408149242401123, 6.545580863952637, 2.039006471633911, 3.1213035583496094, 4.062455654144287, 3.520308256149292, 5.306571960449219, 4.48161506652832, 5.227166652679443, 4.851914405822754, 1.261299729347229, 2.252257823944092, 3.149729013442993, 3.1537513732910156, 2.605874538421631, 5.191470146179199, 5.514288902282715, 1.4416751861572266, 4.3973774909973145, 2.041529417037964, 2.699624538421631, 3.2144455909729004, 5.309698581695557, 1.8539011478424072, 4.4286699295043945, 3.224519729614258, 5.494046688079834, 4.667294979095459, 4.120090484619141, 4.791254043579102, 3.437479019165039, 4.797691345214844, 1.9094516038894653, 3.628430128097534, 3.94805908203125, 2.2648613452911377, 4.040837287902832, 4.151846885681152, 3.7279257774353027, 2.854337215423584, 2.1778805255889893, 4.325439453125, 2.8731865882873535, 4.820981025695801, 3.87933087348938, 4.8690385818481445], "mean_td_error": 3.783862352371216, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 34.0, "diff_num_grad_updates_vs_sampler_policy": 33.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.139664649963379, "actor_loss": -6.026527404785156, "critic_loss": 0.8470783233642578, "alpha_loss": -0.10043709725141525, "alpha_value": 0.9901435375213623, "log_alpha_value": -0.00990536529570818, "target_entropy": -6.0, "policy_t": -0.04023883864283562, "mean_q": 1.9741668701171875, "max_q": 2.4032721519470215, "min_q": 1.4786688089370728}, "td_error": [0.5186612606048584, 2.7479844093322754, 1.865759015083313, 1.1015617847442627, 2.8356666564941406, 2.2873709201812744, 2.814683198928833, 3.2095656394958496, 4.384803771972656, 1.7759461402893066, 1.9753621816635132, 1.5129157304763794, 5.051098823547363, 1.8712495565414429, 0.1136249303817749, 4.456594467163086, 2.451840877532959, 3.004589319229126, 2.446323871612549, 3.242450714111328, 1.5499157905578613, 1.900528073310852, 2.9242935180664062, 1.9955252408981323, 2.3236045837402344, 3.2382326126098633, 2.1098785400390625, 1.2591983079910278, 2.590010643005371, 1.9999051094055176, 1.2310676574707031, 2.1379849910736084, 1.9862574338912964, 3.7465996742248535, 1.7000635862350464, 2.71947979927063, 4.052506923675537, 0.7995949387550354, 2.785747528076172, 1.7400680780410767, 3.623865842819214, 4.139944553375244, 3.985814332962036, 2.6330575942993164, 1.8807883262634277, 1.336156964302063, 1.530253529548645, 5.3709917068481445, 1.6877985000610352, 2.980940341949463, 3.752397060394287, 2.6401538848876953, 3.2788171768188477, 4.297543525695801, 1.6397384405136108, 1.4008702039718628, 2.5657546520233154, 3.4698781967163086, 1.3873205184936523, 2.9554691314697266, 1.0532457828521729, 2.395829677581787, 2.7787222862243652, 4.390108108520508, 1.8832286596298218, 0.5017907619476318, 0.2588537931442261, 4.567160606384277, 1.5486173629760742, 1.3435319662094116, 1.4371018409729004, 1.7018977403640747, 0.8010202646255493, 5.265740394592285, 4.0046162605285645, 3.4043421745300293, 0.7221801280975342, 2.2453296184539795, 0.9393512010574341, 1.4049468040466309, 0.5877199172973633, 2.9148521423339844, 0.7540048360824585, 0.4504268169403076, 2.6258206367492676, 1.4812465906143188], "mean_td_error": 2.3543922901153564, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 34.0, "diff_num_grad_updates_vs_sampler_policy": 33.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.106996536254883, "actor_loss": -6.1188836097717285, "critic_loss": 0.9079874753952026, "alpha_loss": -0.10006231814622879, "alpha_value": 0.9901485443115234, "log_alpha_value": -0.00990030076354742, "target_entropy": -6.0, "policy_t": 0.014841382391750813, "mean_q": 2.0316805839538574, "max_q": 2.5345940589904785, "min_q": 1.5350207090377808}, "td_error": [1.5258358716964722, 2.510796546936035, 1.822654366493225, 2.5056490898132324, 3.1382076740264893, 1.9545962810516357, 1.0132808685302734, 4.452388286590576, 3.717628002166748, 1.9388604164123535, 4.15589714050293, 0.9714357852935791, 4.064146995544434, 1.8964287042617798, 4.759359359741211, 2.672260284423828, 4.451667308807373, 2.090428113937378, 2.5988311767578125, 2.8138022422790527, 1.8978040218353271, 2.3205838203430176, 2.0669851303100586, 2.836601734161377, 2.0383806228637695, 3.4525513648986816, 0.6848140358924866, 3.8050880432128906, 2.3678197860717773, 2.8711228370666504, 1.8159379959106445, 3.2128987312316895, 3.336486339569092, 0.879553496837616, 2.736424207687378, 4.000991344451904, 2.1180200576782227, 3.1601762771606445, 3.1591262817382812, 0.7748080492019653, 1.9481250047683716, 2.4377663135528564, 0.0648043155670166, 1.8597593307495117, 3.560728073120117, 1.5850889682769775, 2.182490348815918, 0.4365813136100769, 2.5870046615600586, 1.6520164012908936, 3.214142084121704, 1.249411940574646, 1.009803295135498, 3.532726764678955, 1.5147175788879395, 0.6956431865692139, 2.4110360145568848, 2.7803871631622314, 2.6297874450683594, 1.8931716680526733, 2.183350086212158, 0.16095340251922607, 2.736043691635132, 2.1461682319641113, 3.4924144744873047, 2.314709186553955, 3.338740825653076, 3.0939958095550537, 1.2030171155929565, 2.1777052879333496, 2.831526041030884, 1.68269681930542, 2.2214059829711914, 3.210977554321289, 2.046316623687744, 2.278400421142578, 1.9524567127227783, 2.6226065158843994, 1.6925170421600342, 3.4705710411071777, 1.586499571800232, 6.301997184753418, 3.840799331665039, 2.8565335273742676, 1.8041446208953857, 2.2847821712493896], "mean_td_error": 2.4344980716705322, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 34.0, "diff_num_grad_updates_vs_sampler_policy": 33.0}}, "num_env_steps_sampled": 31360, "num_env_steps_trained": 8772, "num_agent_steps_sampled": 94080, "num_agent_steps_trained": 8772, "last_target_update_ts": 31360, "num_target_updates": 34}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 94080, "num_agent_steps_trained": 8772, "num_env_steps_sampled": 31360, "num_env_steps_trained": 8772, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 415.6453368731222, "num_env_steps_trained_throughput_per_sec": 119.68359030498384, "timesteps_total": 31360, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 94080, "timers": {"training_iteration_time_ms": 2056.072, "sample_time_ms": 1482.067, "load_time_ms": 0.545, "load_throughput": 473662.975, "learn_time_ms": 62.754, "learn_throughput": 4111.293, "synch_weights_time_ms": 15.674}, "counters": {"num_env_steps_sampled": 31360, "num_env_steps_trained": 8772, "num_agent_steps_sampled": 94080, "num_agent_steps_trained": 8772, "last_target_update_ts": 31360, "num_target_updates": 34}, "done": false, "episodes_total": 0, "training_iteration": 35, "trial_id": "566d8_00000", "date": "2023-11-16_22-21-29", "timestamp": 1700202089, "time_this_iter_s": 2.172231912612915, "time_total_s": 72.55144500732422, "pid": 48481, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fb780e7f8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 72.55144500732422, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 63.475, "ram_util_percent": 92.475}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.107027053833008, "actor_loss": -5.907306671142578, "critic_loss": 2.3916730880737305, "alpha_loss": -0.10315538197755814, "alpha_value": 0.9898456335067749, "log_alpha_value": -0.010206302627921104, "target_entropy": -6.0, "policy_t": -0.004642575979232788, "mean_q": 1.8726109266281128, "max_q": 2.364194869995117, "min_q": 1.4149820804595947}, "td_error": [3.6493687629699707, 3.716404438018799, 4.074312210083008, 3.4610323905944824, 3.944767951965332, 4.843283653259277, 2.228908061981201, 5.451502799987793, 5.829479217529297, 5.140993595123291, 5.540066719055176, 1.4339354038238525, 1.3686556816101074, 4.151403427124023, 3.17814302444458, 1.5258684158325195, 2.617994546890259, 3.747803211212158, 2.1579136848449707, 4.659821510314941, 4.804331302642822, 4.059149265289307, 3.2482664585113525, 2.624415874481201, 3.7742013931274414, 3.2612032890319824, 3.7974853515625, 5.025216579437256, 2.197575092315674, 1.6897790431976318, 3.90779972076416, 3.148251533508301, 3.3369719982147217, 3.5006189346313477, 2.680501937866211, 4.2242045402526855, 5.9177141189575195, 1.4253442287445068, 3.2842135429382324, 5.3509745597839355, 3.1982321739196777, 4.301449775695801, 1.4878430366516113, 3.071824550628662, 4.178518772125244, 3.434518814086914, 3.0856995582580566, 4.129256248474121, 4.78751277923584, 1.5470694303512573, 4.127394676208496, 4.111043930053711, 4.352911472320557, 2.404123067855835, 2.630080223083496, 5.855503082275391, 2.2156810760498047, 6.35623025894165, 3.108008861541748, 6.674863815307617, 4.168023109436035, 4.6637396812438965, 3.901312828063965, 2.8853254318237305, 2.968848705291748, 4.96632194519043, 5.188828468322754, 1.752557635307312, 2.718627691268921, 4.676244735717773, 3.691925048828125, 2.208469867706299, 3.667330741882324, 2.5980851650238037, 2.329775810241699, 3.596762180328369, 2.663851261138916, 4.8937578201293945, 4.31900691986084, 2.855672836303711, 2.992253303527832, 3.2217369079589844, 2.887622594833374, 5.157439231872559, 5.631747245788574, 2.97115421295166], "mean_td_error": 3.635047435760498, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 35.0, "diff_num_grad_updates_vs_sampler_policy": 34.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.143218994140625, "actor_loss": -6.12477445602417, "critic_loss": 0.7410593032836914, "alpha_loss": -0.10351784527301788, "alpha_value": 0.9898462891578674, "log_alpha_value": -0.010205620899796486, "target_entropy": -6.0, "policy_t": -0.01469290629029274, "mean_q": 2.0722148418426514, "max_q": 2.548306941986084, "min_q": 1.700271725654602}, "td_error": [3.3553528785705566, 3.3943591117858887, 4.12814998626709, 1.6923532485961914, 1.3139625787734985, 3.150783061981201, 2.3013710975646973, 4.0164899826049805, 4.233686447143555, 1.6851356029510498, 1.8277522325515747, 1.1070784330368042, 2.7918944358825684, 2.7827513217926025, 1.3760507106781006, 1.2638928890228271, 3.8107285499572754, 0.5715229511260986, 2.807626962661743, 3.960263729095459, 2.746002674102783, 3.4786276817321777, 1.429110050201416, 0.6437089443206787, 2.856982707977295, 3.5162582397460938, 3.514461040496826, 2.5787177085876465, 2.2041563987731934, 3.9712605476379395, 3.049625873565674, 1.601011872291565, 2.8134751319885254, 1.7821062803268433, 0.872089147567749, 1.5319676399230957, 1.6925921440124512, 3.28566312789917, 2.268958806991577, 1.8377079963684082, 2.5435900688171387, 3.020664930343628, 3.009779453277588, 0.4575684070587158, 4.220842361450195, 1.8864964246749878, 2.3993148803710938, 2.041748523712158, 4.147345066070557, 2.2371792793273926, 0.6432247161865234, 1.651196002960205, 0.3910290002822876, 1.6274211406707764, 0.5987422466278076, 2.0561952590942383, 3.540219783782959, 4.341680526733398, 1.3956618309020996, 3.360804557800293, 1.2547764778137207, 1.8536441326141357, 4.539642333984375, 1.4338237047195435, 1.283073902130127, 1.6135380268096924, 2.1574854850769043, 1.4625506401062012, 0.859836995601654, 1.1776621341705322, 0.311153769493103, 0.2172945737838745, 2.043044090270996, 0.9405207633972168, 1.2483899593353271, 0.9134335517883301, 5.944124221801758, 3.470762252807617, 1.358195424079895, 1.3351373672485352, 2.5700161457061768, 0.7512156963348389, 1.6815567016601562, 0.5996087789535522, 0.17202723026275635, 2.4737324714660645], "mean_td_error": 2.1916587352752686, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 35.0, "diff_num_grad_updates_vs_sampler_policy": 34.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.013357162475586, "actor_loss": -6.2115159034729, "critic_loss": 0.7803303003311157, "alpha_loss": -0.1021396741271019, "alpha_value": 0.9898515343666077, "log_alpha_value": -0.01020034123212099, "target_entropy": -6.0, "policy_t": -0.012207736261188984, "mean_q": 2.2317962646484375, "max_q": 2.895000696182251, "min_q": 1.781331181526184}, "td_error": [0.8766084313392639, 2.130873680114746, 1.9878658056259155, 1.4268800020217896, 2.0981333255767822, 0.8929444551467896, 3.387887477874756, 2.9576425552368164, 3.417043924331665, 1.8502440452575684, 2.194520950317383, 0.6633443832397461, 0.16520392894744873, 2.5845441818237305, 3.964812755584717, 2.2564492225646973, 1.9512914419174194, 2.7627243995666504, 2.729641914367676, 2.2115654945373535, 1.9598736763000488, 1.189544439315796, 1.703102469444275, 2.1344385147094727, 1.5495967864990234, 2.491368293762207, 2.5968170166015625, 1.8773236274719238, 1.743744969367981, 1.795606255531311, 2.066131114959717, 1.6360362768173218, 0.7277340888977051, 3.7916908264160156, 0.6421273946762085, 2.0390729904174805, 1.1445101499557495, 2.7442781925201416, 6.483847618103027, 1.86262047290802, 2.867966651916504, 1.2411893606185913, 0.924984335899353, 2.858452796936035, 2.979386329650879, 4.649221420288086, 4.745064735412598, 1.4586063623428345, 3.198024034500122, 3.1399312019348145, 2.0976829528808594, 0.6999568343162537, 2.2409141063690186, 1.6601066589355469, 1.8530051708221436, 2.5460104942321777, 2.2739787101745605, 3.240713119506836, 1.3379554748535156, 2.1005239486694336, 2.6861119270324707, 1.4190824031829834, 1.1733859777450562, 1.9674627780914307, 2.0114498138427734, 0.6619393825531006, 4.429543495178223, 0.654628574848175, 0.9524273872375488, 0.8978418111801147, 2.4892234802246094, 1.5224592685699463, 2.0176517963409424, 0.27855581045150757, 0.7447364926338196, 1.1737284660339355, 2.9405927658081055, 2.0449914932250977, 2.3830618858337402, 0.7847900390625, 2.192159414291382, 2.0864639282226562, 1.581023097038269, 5.0189666748046875, 4.112020492553711, 4.17752742767334], "mean_td_error": 2.1535487174987793, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 35.0, "diff_num_grad_updates_vs_sampler_policy": 34.0}}, "num_env_steps_sampled": 32256, "num_env_steps_trained": 9030, "num_agent_steps_sampled": 96768, "num_agent_steps_trained": 9030, "last_target_update_ts": 32256, "num_target_updates": 35}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96768, "num_agent_steps_trained": 9030, "num_env_steps_sampled": 32256, "num_env_steps_trained": 9030, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 429.63313198178804, "num_env_steps_trained_throughput_per_sec": 123.71132595011308, "timesteps_total": 32256, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 96768, "timers": {"training_iteration_time_ms": 2074.065, "sample_time_ms": 1499.472, "load_time_ms": 0.547, "load_throughput": 472010.133, "learn_time_ms": 62.803, "learn_throughput": 4108.09, "synch_weights_time_ms": 15.815}, "counters": {"num_env_steps_sampled": 32256, "num_env_steps_trained": 9030, "num_agent_steps_sampled": 96768, "num_agent_steps_trained": 9030, "last_target_update_ts": 32256, "num_target_updates": 35}, "done": false, "episodes_total": 0, "training_iteration": 36, "trial_id": "566d8_00000", "date": "2023-11-16_22-21-32", "timestamp": 1700202092, "time_this_iter_s": 2.0990750789642334, "time_total_s": 74.65052008628845, "pid": 48481, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fb763906a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 74.65052008628845, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 73.83333333333333, "ram_util_percent": 92.46666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.065048217773438, "actor_loss": -6.021923065185547, "critic_loss": 2.359628200531006, "alpha_loss": -0.1057475358247757, "alpha_value": 0.9895485639572144, "log_alpha_value": -0.010506411083042622, "target_entropy": -6.0, "policy_t": 0.03885159268975258, "mean_q": 2.0231096744537354, "max_q": 2.5796058177948, "min_q": 1.579237699508667}, "td_error": [3.1422011852264404, 4.606228351593018, 3.114452362060547, 5.1927170753479, 4.066891670227051, 0.8298625946044922, 6.760474681854248, 5.78339958190918, 2.314877986907959, 1.3300682306289673, 4.439120292663574, 2.5416336059570312, 1.8250950574874878, 2.459122657775879, 2.143615961074829, 4.597497940063477, 5.934198379516602, 4.362810134887695, 6.210786819458008, 2.714186429977417, 3.5382914543151855, 4.1769256591796875, 3.3300883769989014, 3.3089871406555176, 4.540450572967529, 7.860263347625732, 3.8561182022094727, 2.8550972938537598, 4.6391401290893555, 5.698870658874512, 3.204822063446045, 1.2802200317382812, 4.121248245239258, 3.8619370460510254, 2.941108465194702, 2.7318339347839355, 4.807321548461914, 5.404723644256592, 3.4010937213897705, 3.4887242317199707, 6.037428855895996, 4.572726249694824, 2.0685622692108154, 3.5196239948272705, 3.3909730911254883, 3.809906244277954, 3.5056662559509277, 2.330695152282715, 3.5455384254455566, 3.1371536254882812, 2.134129762649536, 3.411928653717041, 3.7266972064971924, 4.154758453369141, 4.30380916595459, 4.031225204467773, 3.3349344730377197, 2.184018135070801, 4.062191963195801, 1.436466932296753, 2.2543866634368896, 4.0074310302734375, 4.586949348449707, 4.512716293334961, 2.7251667976379395, 0.6204323768615723, 1.6969122886657715, 4.6977386474609375, 3.562804698944092, 2.6382346153259277, 2.271300792694092, 4.137248516082764, 3.264695167541504, 4.2474141120910645, 1.9894206523895264, 1.465096354484558, 3.1975064277648926, 3.713284492492676, 5.7164306640625, 3.3058252334594727, 1.4136674404144287, 2.6282272338867188, 3.7936811447143555, 3.47982120513916, 2.943474292755127, 3.9738340377807617], "mean_td_error": 3.5460307598114014, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 36.0, "diff_num_grad_updates_vs_sampler_policy": 35.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.142602920532227, "actor_loss": -6.317705154418945, "critic_loss": 0.7898585796356201, "alpha_loss": -0.1065581664443016, "alpha_value": 0.9895489811897278, "log_alpha_value": -0.010505998507142067, "target_entropy": -6.0, "policy_t": 0.00621695164591074, "mean_q": 2.240396499633789, "max_q": 2.648214101791382, "min_q": 1.8204498291015625}, "td_error": [0.8513470888137817, 1.453033685684204, 3.195610523223877, 2.125213384628296, 1.0734018087387085, 2.877870559692383, 2.055004119873047, 2.1645302772521973, 3.2407641410827637, 2.0881214141845703, 2.1754488945007324, 2.6044671535491943, 7.224870204925537, 1.6819027662277222, 4.223169326782227, 1.408794641494751, 1.475418210029602, 1.826051115989685, 4.910043239593506, 3.7063846588134766, 0.8070183992385864, 2.852492332458496, 0.787460446357727, 0.36953508853912354, 2.7576560974121094, 1.329797625541687, 2.087719440460205, 1.8048229217529297, 2.3693361282348633, 1.5058790445327759, 0.31914854049682617, 2.5492804050445557, 0.38352954387664795, 3.753147602081299, 2.0219473838806152, 3.463593006134033, 1.3465155363082886, 2.5702598094940186, 3.553518533706665, 2.4835824966430664, 2.4956917762756348, 1.5499224662780762, 2.747354745864868, 1.7102407217025757, 3.1510815620422363, 1.0277528762817383, 1.4060429334640503, 2.0578227043151855, 1.3161426782608032, 2.694356918334961, 3.0855844020843506, 2.5186307430267334, 0.45810389518737793, 1.3623906373977661, 1.8192331790924072, 1.0636142492294312, 1.1484570503234863, 0.5418586730957031, 2.6715641021728516, 2.0675487518310547, 3.002342939376831, 2.3310678005218506, 3.5668492317199707, 1.0788758993148804, 2.7095348834991455, 3.8095016479492188, 2.156050682067871, 2.7291736602783203, 3.7839388847351074, 2.185166597366333, 3.2152187824249268, 2.5245680809020996, 4.148196697235107, 3.546450614929199, 2.3959412574768066, 0.1658155918121338, 3.813314914703369, 2.3455629348754883, 0.3831526041030884, 2.5376691818237305, 0.8139563798904419, 2.236313819885254, 1.0733884572982788, 3.836930513381958, 2.18566632270813, 1.3462963104248047], "mean_td_error": 2.2359538078308105, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 36.0, "diff_num_grad_updates_vs_sampler_policy": 35.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.100780487060547, "actor_loss": -6.442808151245117, "critic_loss": 0.691545307636261, "alpha_loss": -0.10606037080287933, "alpha_value": 0.9895547032356262, "log_alpha_value": -0.01050021406263113, "target_entropy": -6.0, "policy_t": -0.010741875506937504, "mean_q": 2.380164384841919, "max_q": 2.961866855621338, "min_q": 1.8773953914642334}, "td_error": [2.500239849090576, 2.7526636123657227, 0.6642113924026489, 2.3541927337646484, 0.25700974464416504, 3.0386953353881836, 1.8885999917984009, 3.4280781745910645, 1.117780089378357, 1.5149593353271484, 4.1545610427856445, 1.4554263353347778, 0.8162484169006348, 2.6626670360565186, 0.3914029598236084, 4.09667444229126, 3.224475383758545, 2.0485987663269043, 2.1622891426086426, 1.8437632322311401, 1.7693616151809692, 2.010983943939209, 1.923511028289795, 0.7591934204101562, 1.1059339046478271, 1.4994961023330688, 0.9622044563293457, 0.643649697303772, 2.045215129852295, 2.1059658527374268, 0.8527920246124268, 2.6105775833129883, 0.6685205698013306, 3.1786410808563232, 0.9282571077346802, 2.026148796081543, 0.6625434160232544, 0.8053107261657715, 3.8960559368133545, 2.1566176414489746, 1.7637325525283813, 2.8924856185913086, 2.5204920768737793, 2.271458864212036, 1.963823676109314, 3.752176284790039, 3.2760565280914307, 3.2308857440948486, 0.060523033142089844, 2.085646867752075, 3.1097264289855957, 1.4171216487884521, 0.7085320949554443, 0.6617670059204102, 2.8849740028381348, 2.4539055824279785, 3.1051769256591797, 1.5343073606491089, 2.041703701019287, 0.7000837326049805, 0.9898316860198975, 0.5479940176010132, 2.199406862258911, 2.4764719009399414, 2.8544764518737793, 1.7331328392028809, 0.8357269763946533, 1.4613767862319946, 2.0742545127868652, 1.6799042224884033, 2.0676822662353516, 0.9169096946716309, 1.4098658561706543, 2.4396910667419434, 0.8215441703796387, 4.000153541564941, 2.110875129699707, 1.8179447650909424, 0.039263367652893066, 1.6522773504257202, 4.067193984985352, 2.6198296546936035, 1.9554873704910278, 2.8016457557678223, 1.9273035526275635, 2.4706225395202637], "mean_td_error": 1.9463832378387451, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 36.0, "diff_num_grad_updates_vs_sampler_policy": 35.0}}, "num_env_steps_sampled": 33152, "num_env_steps_trained": 9288, "num_agent_steps_sampled": 99456, "num_agent_steps_trained": 9288, "last_target_update_ts": 33152, "num_target_updates": 36}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 99456, "num_agent_steps_trained": 9288, "num_env_steps_sampled": 33152, "num_env_steps_trained": 9288, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 464.41093109779206, "num_env_steps_trained_throughput_per_sec": 133.72546899914101, "timesteps_total": 33152, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 99456, "timers": {"training_iteration_time_ms": 2075.856, "sample_time_ms": 1500.847, "load_time_ms": 0.548, "load_throughput": 470839.504, "learn_time_ms": 62.768, "learn_throughput": 4110.406, "synch_weights_time_ms": 15.644}, "counters": {"num_env_steps_sampled": 33152, "num_env_steps_trained": 9288, "num_agent_steps_sampled": 99456, "num_agent_steps_trained": 9288, "last_target_update_ts": 33152, "num_target_updates": 36}, "done": false, "episodes_total": 0, "training_iteration": 37, "trial_id": "566d8_00000", "date": "2023-11-16_22-21-34", "timestamp": 1700202094, "time_this_iter_s": 1.9435920715332031, "time_total_s": 76.59411215782166, "pid": 48481, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fb7906b0700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 76.59411215782166, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 92.15, "ram_util_percent": 92.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.116578102111816, "actor_loss": -6.236393928527832, "critic_loss": 2.3592066764831543, "alpha_loss": -0.10932426899671555, "alpha_value": 0.9892517328262329, "log_alpha_value": -0.010806447826325893, "target_entropy": -6.0, "policy_t": -0.012360409833490849, "mean_q": 2.202960968017578, "max_q": 2.8533787727355957, "min_q": 1.6806200742721558}, "td_error": [3.846961736679077, 5.711195945739746, 4.126503944396973, 4.690650939941406, 3.4578399658203125, 4.95326042175293, 4.109477996826172, 4.353171348571777, 3.5642220973968506, 4.208906173706055, 5.867373466491699, 3.3013596534729004, 2.9373433589935303, 2.8299362659454346, 5.9330949783325195, 3.5600509643554688, 4.43293571472168, 4.03164005279541, 2.801651954650879, 4.021871566772461, 3.1952145099639893, 4.7097883224487305, 4.011896133422852, 4.903298377990723, 4.629001617431641, 3.5318236351013184, 3.080343246459961, 3.286255359649658, 2.3565778732299805, 3.342522621154785, 4.275575637817383, 4.277903079986572, 2.308182716369629, 4.4060282707214355, 3.55484676361084, 3.8303587436676025, 2.464414596557617, 2.2202510833740234, 2.6756577491760254, 4.8704633712768555, 2.483433723449707, 4.786298751831055, 2.957390785217285, 4.400216579437256, 1.3424501419067383, 2.5433809757232666, 2.9857537746429443, 5.659874439239502, 2.6317782402038574, 2.833604335784912, 2.832118511199951, 2.637385368347168, 1.5244758129119873, 3.1592025756835938, 3.3201754093170166, 3.39642333984375, 3.650547981262207, 3.8560400009155273, 4.018136024475098, 2.608313798904419, 4.456560134887695, 2.7013001441955566, 2.961589813232422, 2.4045815467834473, 3.6270482540130615, 3.861715793609619, 4.103224754333496, 3.3186259269714355, 3.3063955307006836, 2.3935799598693848, 2.0419344902038574, 2.788228988647461, 2.2725515365600586, 2.7394096851348877, 2.608431577682495, 3.4033021926879883, 2.801954746246338, 2.059675693511963, 4.655869483947754, 2.0156590938568115, 3.5611491203308105, 4.689239501953125, 4.970937728881836, 2.2366247177124023, 6.142444133758545, 3.2209248542785645], "mean_td_error": 3.5306954383850098, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 37.0, "diff_num_grad_updates_vs_sampler_policy": 36.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.095731735229492, "actor_loss": -6.437497138977051, "critic_loss": 0.7639497518539429, "alpha_loss": -0.10909933596849442, "alpha_value": 0.9892516732215881, "log_alpha_value": -0.010806480422616005, "target_entropy": -6.0, "policy_t": 0.007409494835883379, "mean_q": 2.3783020973205566, "max_q": 2.8398971557617188, "min_q": 2.0073702335357666}, "td_error": [1.6123948097229004, 1.324743628501892, 1.8312230110168457, 1.0543047189712524, 4.23703670501709, 2.734668731689453, 4.638058185577393, 3.7860162258148193, 2.74623966217041, 3.2835636138916016, 1.9418781995773315, 2.0495429039001465, 1.556040644645691, 2.166684150695801, 2.6622416973114014, 3.896026849746704, 0.18985426425933838, 1.0544872283935547, 1.874680757522583, 1.545029878616333, 1.4668225049972534, 1.2602745294570923, 4.086295127868652, 1.4961204528808594, 1.9180519580841064, 3.579026699066162, 3.348130226135254, 1.1595981121063232, 0.07691633701324463, 1.5858192443847656, 1.823869228363037, 3.863697052001953, 2.1901566982269287, 0.7486014366149902, 3.78006649017334, 0.17585313320159912, 2.2217752933502197, 1.4495272636413574, 2.657473564147949, 1.2594170570373535, 3.5597667694091797, 4.5456767082214355, 3.8176398277282715, 4.704620361328125, 2.545238494873047, 1.4601869583129883, 0.5752639770507812, 2.790123462677002, 3.4599008560180664, 0.5086092948913574, 0.60652756690979, 0.6079905033111572, 0.28932833671569824, 2.907435655593872, 1.8736549615859985, 0.15456950664520264, 2.0995731353759766, 3.1526618003845215, 1.0279535055160522, 1.9392112493515015, 2.1600685119628906, 2.111631393432617, 0.17677879333496094, 0.8188364505767822, 1.370671272277832, 2.391672134399414, 1.3276041746139526, 0.4976997375488281, 4.034897804260254, 2.9599502086639404, 2.624481201171875, 3.6944961547851562, 1.5410659313201904, 0.5869860649108887, 5.381491661071777, 0.5993274450302124, 1.6148808002471924, 2.058333158493042, 1.231532096862793, 1.0939099788665771, 0.7198976278305054, 2.352982997894287, 2.466264247894287, 3.8900723457336426, 3.1142570972442627, 3.485891103744507], "mean_td_error": 2.130974531173706, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 37.0, "diff_num_grad_updates_vs_sampler_policy": 36.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.093487739562988, "actor_loss": -6.585825443267822, "critic_loss": 0.6994302272796631, "alpha_loss": -0.10901100933551788, "alpha_value": 0.9892579913139343, "log_alpha_value": -0.010800131596624851, "target_entropy": -6.0, "policy_t": -0.0005905348807573318, "mean_q": 2.5430142879486084, "max_q": 3.283963441848755, "min_q": 1.993713140487671}, "td_error": [0.34835028648376465, 0.9856822490692139, 3.1372275352478027, 1.2054716348648071, 3.0731124877929688, 3.4928500652313232, 1.4390408992767334, 1.621846079826355, 1.8950133323669434, 3.7741851806640625, 2.868454694747925, 1.7637441158294678, 1.3715370893478394, 1.755331039428711, 3.2797927856445312, 1.7618476152420044, 3.3553175926208496, 2.9947757720947266, 1.0577359199523926, 1.0091644525527954, 0.22747266292572021, 0.7573875188827515, 2.0369746685028076, 0.02952134609222412, 0.6587619781494141, 5.621167182922363, 1.4538490772247314, 1.904281735420227, 0.4385559558868408, 1.5437123775482178, 2.715513229370117, 2.7883222103118896, 2.154320478439331, 5.7707037925720215, 2.493891954421997, 2.1338586807250977, 1.6877479553222656, 2.7037227153778076, 3.443404197692871, 0.5427755117416382, 2.963878631591797, 1.1656643152236938, 4.069579124450684, 1.5974246263504028, 0.2790365219116211, 3.6231701374053955, 3.664128065109253, 3.4681267738342285, 0.544975757598877, 2.2352309226989746, 1.8773236274719238, 0.6794723272323608, 1.9989807605743408, 2.591130256652832, 2.7814624309539795, 0.9616894721984863, 0.6438124179840088, 0.899154782295227, 0.7935072183609009, 2.686131477355957, 1.2630056142807007, 2.852247714996338, 1.1132980585098267, 2.100677251815796, 3.041714906692505, 1.044670581817627, 1.1169193983078003, 1.786417007446289, 1.5950672626495361, 2.7952651977539062, 2.5165064334869385, 2.0163323879241943, 0.9720293283462524, 0.3418090343475342, 3.4755022525787354, 4.8235392570495605, 3.5112357139587402, 2.7612946033477783, 2.2120168209075928, 2.4860708713531494, 0.9626100063323975, 0.416955828666687, 2.408015727996826, 1.590709924697876, 2.8576650619506836, 2.373197078704834], "mean_td_error": 2.061105489730835, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 37.0, "diff_num_grad_updates_vs_sampler_policy": 36.0}}, "num_env_steps_sampled": 34048, "num_env_steps_trained": 9546, "num_agent_steps_sampled": 102144, "num_agent_steps_trained": 9546, "last_target_update_ts": 34048, "num_target_updates": 37}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 102144, "num_agent_steps_trained": 9546, "num_env_steps_sampled": 34048, "num_env_steps_trained": 9546, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 415.59211001252714, "num_env_steps_trained_throughput_per_sec": 119.66826382057144, "timesteps_total": 34048, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 102144, "timers": {"training_iteration_time_ms": 2074.385, "sample_time_ms": 1467.443, "load_time_ms": 0.547, "load_throughput": 471352.222, "learn_time_ms": 62.709, "learn_throughput": 4114.267, "synch_weights_time_ms": 15.655}, "counters": {"num_env_steps_sampled": 34048, "num_env_steps_trained": 9546, "num_agent_steps_sampled": 102144, "num_agent_steps_trained": 9546, "last_target_update_ts": 34048, "num_target_updates": 37}, "done": false, "episodes_total": 0, "training_iteration": 38, "trial_id": "566d8_00000", "date": "2023-11-16_22-21-36", "timestamp": 1700202096, "time_this_iter_s": 2.1715450286865234, "time_total_s": 78.76565718650818, "pid": 48481, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fb780eab790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 78.76565718650818, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 64.89999999999999, "ram_util_percent": 92.40000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.027647972106934, "actor_loss": -6.39361572265625, "critic_loss": 2.0135512351989746, "alpha_loss": -0.11137241870164871, "alpha_value": 0.9889549016952515, "log_alpha_value": -0.011106535792350769, "target_entropy": -6.0, "policy_t": -0.024979032576084137, "mean_q": 2.3650121688842773, "max_q": 3.1143343448638916, "min_q": 1.7787669897079468}, "td_error": [4.9686994552612305, 2.930983543395996, 2.6655774116516113, 2.114285707473755, 2.6164870262145996, 3.589388370513916, 3.236863374710083, 1.4169421195983887, 2.781550884246826, 1.9276670217514038, 4.46619987487793, 2.8298065662384033, 1.6494148969650269, 5.174659252166748, 2.7319254875183105, 3.053243637084961, 3.1215291023254395, 2.2783608436584473, 0.6683591604232788, 3.63437557220459, 4.0159149169921875, 2.7065587043762207, 1.9933007955551147, 5.206388473510742, 3.64166522026062, 2.845362424850464, 3.724720001220703, 3.4556946754455566, 4.729728698730469, 1.220448613166809, 2.134334087371826, 2.9699230194091797, 2.5096659660339355, 4.887231349945068, 1.806459903717041, 3.032276153564453, 3.6721131801605225, 3.4735512733459473, 2.9953010082244873, 3.183406352996826, 2.711670398712158, 2.9969773292541504, 0.9532383680343628, 5.389986991882324, 1.687933087348938, 4.211318016052246, 3.985661506652832, 3.553363084793091, 5.990198135375977, 0.957900881767273, 2.0620999336242676, 3.623281478881836, 2.8445539474487305, 1.8817529678344727, 1.7966536283493042, 1.747549057006836, 2.2623519897460938, 0.14713990688323975, 1.7425425052642822, 1.9015411138534546, 4.362077236175537, 4.422938823699951, 4.355477333068848, 5.011632919311523, 3.393801212310791, 2.045588493347168, 4.98472785949707, 3.665405750274658, 2.7024173736572266, 2.553226947784424, 3.265130043029785, 2.5256145000457764, 4.8802995681762695, 2.537027359008789, 6.079609394073486, 3.083190441131592, 1.6068602800369263, 3.9650204181671143, 3.5622382164001465, 2.6090807914733887, 2.871446132659912, 4.136960506439209, 4.176804542541504, 4.287785053253174, 1.0634560585021973, 1.7931562662124634], "mean_td_error": 3.074988842010498, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 38.0, "diff_num_grad_updates_vs_sampler_policy": 37.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.110482215881348, "actor_loss": -6.622471809387207, "critic_loss": 0.6457294225692749, "alpha_loss": -0.11229662597179413, "alpha_value": 0.988954484462738, "log_alpha_value": -0.011106950230896473, "target_entropy": -6.0, "policy_t": 0.010096043348312378, "mean_q": 2.5808017253875732, "max_q": 3.141493082046509, "min_q": 2.022702932357788}, "td_error": [0.829261302947998, 0.31697678565979004, 0.628630518913269, 1.3339847326278687, 2.6584510803222656, 2.4213266372680664, 0.6333160400390625, 1.2231438159942627, 1.2896567583084106, 1.4791141748428345, 3.4181711673736572, 2.807549238204956, 2.7586255073547363, 1.5562355518341064, 0.41844451427459717, 0.21505117416381836, 0.8401821851730347, 1.516037106513977, 2.892014503479004, 0.3861274719238281, 0.46693599224090576, 0.3473026752471924, 0.4753761291503906, 0.8640738725662231, 2.535924196243286, 2.4304556846618652, 1.8784587383270264, 1.7543578147888184, 2.5951387882232666, 1.8387587070465088, 0.9446659088134766, 2.589235305786133, 0.9597135782241821, 5.664770603179932, 5.168544292449951, 3.5634050369262695, 1.3667072057724, 1.869497537612915, 1.3594526052474976, 2.2383174896240234, 1.2613263130187988, 3.183945417404175, 0.989294171333313, 0.4946317672729492, 0.3263627290725708, 1.862160086631775, 1.8359413146972656, 2.181300640106201, 0.6026278734207153, 2.7247464656829834, 1.6082806587219238, 1.2310166358947754, 3.645386219024658, 0.3648033142089844, 1.5124863386154175, 2.582334041595459, 1.6409664154052734, 2.4040791988372803, 3.081019401550293, 2.7885243892669678, 0.29136109352111816, 2.666332721710205, 1.542851209640503, 3.294764518737793, 1.8044193983078003, 3.438138008117676, 0.30897998809814453, 1.5439718961715698, 2.203977108001709, 1.8888897895812988, 1.456748604774475, 1.9691855907440186, 3.0322861671447754, 2.765267848968506, 2.8673787117004395, 3.371199607849121, 2.0065064430236816, 0.036016106605529785, 3.146383762359619, 1.8780872821807861, 2.4699361324310303, 1.5405943393707275, 1.7398267984390259, 2.4889638423919678, 1.020296335220337, 3.852952003479004], "mean_td_error": 1.877673625946045, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 38.0, "diff_num_grad_updates_vs_sampler_policy": 37.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.12590503692627, "actor_loss": -6.840730667114258, "critic_loss": 0.4947226345539093, "alpha_loss": -0.11239828169345856, "alpha_value": 0.9889612793922424, "log_alpha_value": -0.011100073345005512, "target_entropy": -6.0, "policy_t": 0.0018008133629336953, "mean_q": 2.763361692428589, "max_q": 3.4539334774017334, "min_q": 2.06652569770813}, "td_error": [2.2992963790893555, 4.206137180328369, 3.824909210205078, 0.7914175987243652, 2.4840826988220215, 0.13573169708251953, 1.8066182136535645, 0.9332687854766846, 2.388084888458252, 0.11268913745880127, 1.9357672929763794, 1.1658027172088623, 1.9352622032165527, 2.0760087966918945, 0.39387285709381104, 3.3237504959106445, 0.5571485757827759, 3.8372719287872314, 0.5780609846115112, 0.78476881980896, 0.19245195388793945, 1.2989308834075928, 2.533747673034668, 2.6334080696105957, 1.0057274103164673, 0.4842737913131714, 0.8904376029968262, 2.772751569747925, 1.2553064823150635, 1.8505160808563232, 1.8635547161102295, 2.8884031772613525, 2.6026463508605957, 2.418396472930908, 2.2147841453552246, 0.3680776357650757, 2.7480385303497314, 1.6857106685638428, 1.6143033504486084, 0.3636610507965088, 2.133310317993164, 2.6499199867248535, 2.015355110168457, 0.8741523027420044, 0.44812774658203125, 1.9725673198699951, 0.4624195098876953, 2.9556174278259277, 1.860602617263794, 1.0853972434997559, 0.16063296794891357, 1.6151580810546875, 1.6596981287002563, 2.0788538455963135, 0.11339354515075684, 2.5635509490966797, 1.9432227611541748, 2.135891914367676, 1.2008136510849, 0.5039830207824707, 1.944557785987854, 0.8606864213943481, 2.150273323059082, 1.2638522386550903, 1.6430530548095703, 1.2050158977508545, 2.6685004234313965, 0.35085177421569824, 2.294490337371826, 3.308617353439331, 2.1255381107330322, 0.2369694709777832, 0.2783559560775757, 2.769829034805298, 2.9197912216186523, 1.2762044668197632, 0.584572434425354, 1.2760764360427856, 0.3643144369125366, 2.33100962638855, 4.132182598114014, 0.7674883604049683, 0.03503715991973877, 2.139167308807373, 1.6251028776168823, 1.391379714012146], "mean_td_error": 1.646868348121643, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 38.0, "diff_num_grad_updates_vs_sampler_policy": 37.0}}, "num_env_steps_sampled": 34944, "num_env_steps_trained": 9804, "num_agent_steps_sampled": 104832, "num_agent_steps_trained": 9804, "last_target_update_ts": 34944, "num_target_updates": 38}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104832, "num_agent_steps_trained": 9804, "num_env_steps_sampled": 34944, "num_env_steps_trained": 9804, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 494.60754516435475, "num_env_steps_trained_throughput_per_sec": 142.4204761745575, "timesteps_total": 34944, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 104832, "timers": {"training_iteration_time_ms": 2070.382, "sample_time_ms": 1462.348, "load_time_ms": 0.547, "load_throughput": 471249.589, "learn_time_ms": 62.701, "learn_throughput": 4114.74, "synch_weights_time_ms": 16.22}, "counters": {"num_env_steps_sampled": 34944, "num_env_steps_trained": 9804, "num_agent_steps_sampled": 104832, "num_agent_steps_trained": 9804, "last_target_update_ts": 34944, "num_target_updates": 38}, "done": false, "episodes_total": 0, "training_iteration": 39, "trial_id": "566d8_00000", "date": "2023-11-16_22-21-38", "timestamp": 1700202098, "time_this_iter_s": 1.8297641277313232, "time_total_s": 80.5954213142395, "pid": 48481, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fb780e85b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 80.5954213142395, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 63.76666666666667, "ram_util_percent": 92.39999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.11153507232666, "actor_loss": -6.578739643096924, "critic_loss": 1.4880245923995972, "alpha_loss": -0.11533690243959427, "alpha_value": 0.9886583089828491, "log_alpha_value": -0.011406470090150833, "target_entropy": -6.0, "policy_t": -0.013754324987530708, "mean_q": 2.518112897872925, "max_q": 3.287125825881958, "min_q": 1.9108636379241943}, "td_error": [4.4681243896484375, 3.9303431510925293, 2.4534685611724854, 3.982473373413086, 4.007877349853516, 3.319026470184326, 3.0674781799316406, 0.8950735330581665, 0.4134984016418457, 1.6401714086532593, 2.1417417526245117, 2.4878811836242676, 4.1055588722229, 3.865245819091797, 2.84210205078125, 1.111767292022705, 3.141172409057617, 1.2958968877792358, 3.076590061187744, 1.3282099962234497, 5.358678817749023, 2.1589417457580566, 1.2878228425979614, 5.500082969665527, 4.919731140136719, 1.5058139562606812, 4.462074279785156, 2.456932544708252, 3.6836400032043457, 3.450058937072754, 4.251119613647461, 3.5170631408691406, 5.610096454620361, 1.6020739078521729, 3.6458141803741455, 2.8794078826904297, 0.3981466293334961, 2.108560085296631, 2.784451484680176, 4.9668779373168945, 3.2003769874572754, 2.737173080444336, 2.6503400802612305, 5.214425086975098, 1.9742763042449951, 4.449024200439453, 4.088162422180176, 5.002201557159424, 2.609891891479492, 1.7593295574188232, 1.7107208967208862, 3.4203755855560303, 1.593002438545227, 5.726502418518066, 4.056624889373779, 3.0693626403808594, 1.784804105758667, 3.193265438079834, 2.5465197563171387, 3.5659403800964355, 3.0875558853149414, 2.276172161102295, 1.9350221157073975, 3.741217613220215, 4.28266716003418, 3.227755546569824, 3.5802454948425293, 2.2381787300109863, 6.38755464553833, 4.12211799621582, 3.7082395553588867, 0.6687418222427368, 1.4624894857406616, 2.852478504180908, 1.5982764959335327, 2.051987648010254, 2.227587938308716, 4.6924943923950195, 3.2885351181030273, 2.2941246032714844, 3.690730571746826, 2.5512378215789795, 0.8897379636764526, 3.146202564239502, 2.8873891830444336, 3.0809144973754883], "mean_td_error": 3.0284080505371094, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 39.0, "diff_num_grad_updates_vs_sampler_policy": 38.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.110204696655273, "actor_loss": -6.783585548400879, "critic_loss": 0.5860897302627563, "alpha_loss": -0.11533156037330627, "alpha_value": 0.9886573553085327, "log_alpha_value": -0.011407440528273582, "target_entropy": -6.0, "policy_t": -0.011041596531867981, "mean_q": 2.6901512145996094, "max_q": 3.251147508621216, "min_q": 2.1835696697235107}, "td_error": [0.49845612049102783, 1.290632963180542, 3.127929925918579, 2.0369186401367188, 3.107226848602295, 3.4989871978759766, 0.3317767381668091, 3.5120439529418945, 2.184875249862671, 2.34228515625, 1.6149052381515503, 0.8033155202865601, 0.3326073884963989, 0.2528233528137207, 1.8919447660446167, 0.028598427772521973, 0.9501668214797974, 0.18940091133117676, 3.139413595199585, 0.718230128288269, 1.3787003755569458, 2.8341164588928223, 1.9983571767807007, 1.6408519744873047, 3.0071067810058594, 4.223352432250977, 2.8085923194885254, 0.6498061418533325, 1.4791901111602783, 1.684076189994812, 3.616608142852783, 1.5864890813827515, 2.400155544281006, 0.9343310594558716, 1.21366548538208, 2.531064987182617, 1.8061785697937012, 0.31268370151519775, 2.890939712524414, 0.851265549659729, 1.5116792917251587, 2.435628652572632, 0.0933312177658081, 2.7869558334350586, 1.0021158456802368, 3.497497081756592, 3.5273115634918213, 1.5336159467697144, 1.1349173784255981, 0.284588098526001, 0.0895228385925293, 2.873093843460083, 2.7944602966308594, 2.0262322425842285, 2.487474203109741, 2.0940065383911133, 2.785639762878418, 1.3914281129837036, 3.5632805824279785, 1.5620445013046265, 2.5268454551696777, 0.6993166208267212, 0.4774901866912842, 2.0892410278320312, 2.9185705184936523, 0.8535438776016235, 4.430930137634277, 0.2657738924026489, 0.36514759063720703, 2.6300458908081055, 3.584084987640381, 2.6939167976379395, 2.86326003074646, 1.9661036729812622, 1.4770450592041016, 1.4666707515716553, 2.069340944290161, 0.8584625720977783, 1.6808456182479858, 0.6712895631790161, 3.132629871368408, 1.3762956857681274, 1.4527835845947266, 1.503699779510498, 1.5019097328186035, 0.7111884355545044], "mean_td_error": 1.8307132720947266, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 39.0, "diff_num_grad_updates_vs_sampler_policy": 38.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.151050567626953, "actor_loss": -7.004920482635498, "critic_loss": 0.4728166460990906, "alpha_loss": -0.11572308838367462, "alpha_value": 0.9886646270751953, "log_alpha_value": -0.011400108225643635, "target_entropy": -6.0, "policy_t": 0.0006054380792193115, "mean_q": 2.9674949645996094, "max_q": 3.7038052082061768, "min_q": 2.323641777038574}, "td_error": [0.20100069046020508, 1.0355159044265747, 1.7455273866653442, 3.127683162689209, 2.735323429107666, 1.1814383268356323, 0.49596869945526123, 1.226224660873413, 1.9816246032714844, 0.7176817655563354, 0.08126556873321533, 1.016015887260437, 0.5040949583053589, 2.0637450218200684, 3.6647369861602783, 0.1647779941558838, 2.8352575302124023, 1.939656138420105, 1.0955846309661865, 1.7115869522094727, 1.9309759140014648, 5.944034576416016, 2.723381757736206, 0.8255558013916016, 1.439967393875122, 2.0089406967163086, 3.105543613433838, 0.27180445194244385, 1.5291424989700317, 0.5891448259353638, 1.3079824447631836, 1.843623399734497, 0.2971987724304199, 2.397073268890381, 0.4753379821777344, 0.14781105518341064, 0.4740409851074219, 0.4265882968902588, 2.205854892730713, 0.23749017715454102, 0.07486402988433838, 0.0969076156616211, 0.4903838634490967, 1.157847285270691, 1.62031090259552, 1.9441508054733276, 1.585262656211853, 2.3001863956451416, 0.455613374710083, 3.4354023933410645, 1.7999095916748047, 1.7896121740341187, 2.4781646728515625, 1.4264683723449707, 3.5274243354797363, 1.8310977220535278, 0.3365049362182617, 1.2108384370803833, 1.0245105028152466, 1.461504578590393, 1.9012285470962524, 0.12099933624267578, 0.5282552242279053, 2.152669668197632, 2.3481874465942383, 2.4252498149871826, 1.6337791681289673, 1.4643782377243042, 0.8171207904815674, 1.472802758216858, 0.6195569038391113, 1.655093789100647, 1.1478357315063477, 3.5184218883514404, 2.4986929893493652, 2.608920097351074, 1.3141552209854126, 1.5499430894851685, 1.8614294528961182, 2.379612445831299, 0.6508815288543701, 1.446216344833374, 1.7229503393173218, 2.7459731101989746, 4.806709289550781, 0.47390544414520264], "mean_td_error": 1.5769550800323486, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 39.0, "diff_num_grad_updates_vs_sampler_policy": 38.0}}, "num_env_steps_sampled": 35840, "num_env_steps_trained": 10062, "num_agent_steps_sampled": 107520, "num_agent_steps_trained": 10062, "last_target_update_ts": 35840, "num_target_updates": 39}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 107520, "num_agent_steps_trained": 10062, "num_env_steps_sampled": 35840, "num_env_steps_trained": 10062, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 370.2632431233101, "num_env_steps_trained_throughput_per_sec": 106.6159784886317, "timesteps_total": 35840, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 107520, "timers": {"training_iteration_time_ms": 2120.312, "sample_time_ms": 1511.681, "load_time_ms": 0.549, "load_throughput": 469552.387, "learn_time_ms": 62.651, "learn_throughput": 4118.04, "synch_weights_time_ms": 16.21}, "counters": {"num_env_steps_sampled": 35840, "num_env_steps_trained": 10062, "num_agent_steps_sampled": 107520, "num_agent_steps_trained": 10062, "last_target_update_ts": 35840, "num_target_updates": 39}, "done": false, "episodes_total": 0, "training_iteration": 40, "trial_id": "566d8_00000", "date": "2023-11-16_22-21-40", "timestamp": 1700202100, "time_this_iter_s": 2.43367600440979, "time_total_s": 83.02909731864929, "pid": 48481, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fb780eabdc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 83.02909731864929, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 65.925, "ram_util_percent": 92.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.036931037902832, "actor_loss": -6.721074104309082, "critic_loss": 1.3545470237731934, "alpha_loss": -0.11749692261219025, "alpha_value": 0.9883617758750916, "log_alpha_value": -0.01170645747333765, "target_entropy": -6.0, "policy_t": -0.016599366441369057, "mean_q": 2.7279317378997803, "max_q": 3.472388982772827, "min_q": 2.105682611465454}, "td_error": [1.7258985042572021, 4.335251331329346, 3.3730554580688477, 4.446547031402588, 4.0588202476501465, 6.2318220138549805, 4.688403129577637, 2.5366244316101074, 3.712066650390625, 2.208920478820801, 2.1294450759887695, 3.7155632972717285, 1.0374375581741333, 3.7125730514526367, 2.898143768310547, 1.2135812044143677, 3.350869655609131, 1.033722996711731, 2.60793399810791, 0.27929091453552246, 4.3190999031066895, 3.235029697418213, 2.8067879676818848, 1.857743263244629, 1.7858163118362427, 0.7425225973129272, 5.6601362228393555, 1.7771497964859009, 2.708253860473633, 5.225043773651123, 2.602980852127075, 0.47234129905700684, 2.6989779472351074, 2.81424617767334, 5.281564235687256, 2.2491276264190674, 2.2015230655670166, 3.741027355194092, 5.072839736938477, 3.1879866123199463, 2.1102774143218994, 3.449817657470703, 3.3767144680023193, 1.8146229982376099, 3.1458210945129395, 3.8112215995788574, 2.0133309364318848, 2.164400815963745, 0.5066171884536743, 4.78125524520874, 2.650944948196411, 3.180957317352295, 4.304759502410889, 0.6840705871582031, 5.595831871032715, 1.698941946029663, 3.754755735397339, 0.7261219024658203, 2.6696605682373047, 4.33765983581543, 2.8162899017333984, 3.323188066482544, 2.4541049003601074, 2.625370979309082, 3.448061943054199, 1.2969930171966553, 2.777691602706909, 0.4897235631942749, 3.3287346363067627, 0.3521902561187744, 1.0394269227981567, 3.734219551086426, 2.3974204063415527, 2.852461338043213, 2.5791196823120117, 3.6580214500427246, 0.2314300537109375, 1.8291019201278687, 2.2294416427612305, 1.8986961841583252, 5.22941780090332, 3.5688862800598145, 0.6696468591690063, 4.008699417114258, 2.1919939517974854, 0.12976765632629395], "mean_td_error": 2.7636516094207764, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 40.0, "diff_num_grad_updates_vs_sampler_policy": 39.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.035362243652344, "actor_loss": -6.96076774597168, "critic_loss": 0.4655168056488037, "alpha_loss": -0.11749349534511566, "alpha_value": 0.9883603453636169, "log_alpha_value": -0.011707947589457035, "target_entropy": -6.0, "policy_t": -0.007102696690708399, "mean_q": 2.958547592163086, "max_q": 3.7789080142974854, "min_q": 2.264383554458618}, "td_error": [1.208727478981018, 1.2677721977233887, 1.6057947874069214, 0.23553049564361572, 3.1455609798431396, 3.6051788330078125, 2.2132651805877686, 1.6771973371505737, 0.3200420141220093, 2.2872889041900635, 1.7189457416534424, 0.7253330945968628, 1.0171092748641968, 0.18889617919921875, 0.27681267261505127, 1.43059504032135, 1.0325607061386108, 1.8567311763763428, 2.9337220191955566, 1.1290444135665894, 0.7242652177810669, 1.3207828998565674, 1.8836396932601929, 0.8000725507736206, 1.0966322422027588, 2.917811393737793, 1.0221190452575684, 1.610890507698059, 2.0590641498565674, 2.8744163513183594, 0.7194263935089111, 2.1889753341674805, 2.7716245651245117, 1.4435584545135498, 1.6886802911758423, 1.3068369626998901, 0.9208645820617676, 0.530606746673584, 1.6959550380706787, 1.1236815452575684, 1.3852179050445557, 2.0710511207580566, 1.1636426448822021, 0.9939893484115601, 2.1686289310455322, 1.4054183959960938, 1.0070048570632935, 0.3108861446380615, 3.2209863662719727, 4.263633728027344, 1.0316320657730103, 1.3048063516616821, 2.6930301189422607, 0.8648566007614136, 1.2705432176589966, 1.1928483247756958, 0.7387241125106812, 0.5346566438674927, 2.9036078453063965, 2.252919912338257, 0.5562101602554321, 0.3693147897720337, 1.2729072570800781, 4.773436546325684, 3.132772445678711, 0.8537589311599731, 3.0935301780700684, 1.9267675876617432, 2.379507541656494, 0.45338237285614014, 0.7915101051330566, 1.8437106609344482, 1.9998277425765991, 0.8043216466903687, 1.6649526357650757, 0.43721628189086914, 1.2858840227127075, 2.0290589332580566, 2.859455108642578, 2.167581558227539, 2.1787397861480713, 1.6180399656295776, 0.3030310869216919, 0.3008323907852173, 2.3994736671447754, 1.3719264268875122], "mean_td_error": 1.5839680433273315, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 40.0, "diff_num_grad_updates_vs_sampler_policy": 39.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.017271041870117, "actor_loss": -7.151449680328369, "critic_loss": 0.4658392071723938, "alpha_loss": -0.11720488965511322, "alpha_value": 0.9883679151535034, "log_alpha_value": -0.011700281873345375, "target_entropy": -6.0, "policy_t": 0.023042654618620872, "mean_q": 3.1741929054260254, "max_q": 4.099440574645996, "min_q": 2.525259017944336}, "td_error": [1.3905760049819946, 1.6924835443496704, 1.7088524103164673, 1.6125439405441284, 2.7143445014953613, 1.8189022541046143, 2.8267524242401123, 2.057612180709839, 3.985106945037842, 0.5777182579040527, 2.5873870849609375, 1.9046826362609863, 2.5025925636291504, 0.9253025054931641, 3.0836594104766846, 0.6816242933273315, 3.6155648231506348, 0.5847039222717285, 2.5421042442321777, 3.3760623931884766, 2.3014116287231445, 2.7593743801116943, 0.8186825513839722, 2.1584582328796387, 0.34823739528656006, 0.5669317245483398, 2.326629638671875, 0.7225236892700195, 1.3212958574295044, 3.162083148956299, 1.9237910509109497, 1.1760821342468262, 0.5218582153320312, 1.54343581199646, 1.7596009969711304, 0.7636244297027588, 0.2815593481063843, 0.3219757080078125, 0.8321553468704224, 1.0301634073257446, 2.8435230255126953, 0.6093125343322754, 2.2264204025268555, 0.1510072946548462, 0.8231260776519775, 0.3139897584915161, 0.19530868530273438, 0.3631129264831543, 2.935617208480835, 2.8722786903381348, 2.8180956840515137, 1.644748330116272, 0.40834474563598633, 0.8126058578491211, 1.2144449949264526, 0.7163026332855225, 3.718660831451416, 1.6367055177688599, 0.5715624094009399, 2.7380762100219727, 1.4384552240371704, 0.1861281394958496, 0.7289025783538818, 1.4692714214324951, 1.4515256881713867, 1.4163358211517334, 3.1789867877960205, 2.8056771755218506, 0.5897332429885864, 0.24241089820861816, 2.5935304164886475, 1.495322823524475, 1.1022511720657349, 3.231645345687866, 1.0486998558044434, 0.25418829917907715, 0.8123643398284912, 2.785419464111328, 0.31249308586120605, 0.337522029876709, 2.266274929046631, 4.207014083862305, 1.2435734272003174, 0.04690229892730713, 0.7995291948318481, 0.9675801992416382], "mean_td_error": 1.5750401020050049, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 40.0, "diff_num_grad_updates_vs_sampler_policy": 39.0}}, "num_env_steps_sampled": 36736, "num_env_steps_trained": 10320, "num_agent_steps_sampled": 110208, "num_agent_steps_trained": 10320, "last_target_update_ts": 36736, "num_target_updates": 40}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 110208, "num_agent_steps_trained": 10320, "num_env_steps_sampled": 36736, "num_env_steps_trained": 10320, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 470.5148717948718, "num_env_steps_trained_throughput_per_sec": 135.48307692307694, "timesteps_total": 36736, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 110208, "timers": {"training_iteration_time_ms": 2120.862, "sample_time_ms": 1511.823, "load_time_ms": 0.541, "load_throughput": 476856.49, "learn_time_ms": 62.517, "learn_throughput": 4126.893, "synch_weights_time_ms": 16.367}, "counters": {"num_env_steps_sampled": 36736, "num_env_steps_trained": 10320, "num_agent_steps_sampled": 110208, "num_agent_steps_trained": 10320, "last_target_update_ts": 36736, "num_target_updates": 40}, "done": false, "episodes_total": 0, "training_iteration": 41, "trial_id": "566d8_00000", "date": "2023-11-16_22-21-42", "timestamp": 1700202102, "time_this_iter_s": 1.9175889492034912, "time_total_s": 84.94668626785278, "pid": 48481, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fb780e83a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 84.94668626785278, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 90.45, "ram_util_percent": 92.45}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.08165168762207, "actor_loss": -6.909521102905273, "critic_loss": 1.3950104713439941, "alpha_loss": -0.12104357033967972, "alpha_value": 0.9880654811859131, "log_alpha_value": -0.012006323784589767, "target_entropy": -6.0, "policy_t": -0.015954365953803062, "mean_q": 2.863476037979126, "max_q": 3.9222943782806396, "min_q": 2.1480939388275146}, "td_error": [1.919339656829834, 3.5109596252441406, 2.702495574951172, 2.891266345977783, 3.229729175567627, 1.1601625680923462, 1.1875146627426147, 3.4840619564056396, 2.290933132171631, 0.7663772106170654, 3.897608757019043, 3.3917112350463867, 3.3294615745544434, 2.8350560665130615, 1.3671486377716064, 3.116518974304199, 3.6735680103302, 3.8562841415405273, 2.9923033714294434, 4.215614318847656, 4.338003635406494, 4.782745838165283, 2.840883255004883, 2.8413567543029785, 3.083850860595703, 0.639388918876648, 5.172032833099365, 3.6985368728637695, 2.41713285446167, 3.7923104763031006, 3.316089630126953, 1.3951663970947266, 1.3438258171081543, 4.709249496459961, 3.0649421215057373, 1.5070332288742065, 4.741106986999512, 1.2834293842315674, 5.091259002685547, 3.0715787410736084, 1.8388646841049194, 0.5478634834289551, 4.722892761230469, 1.8015013933181763, 2.4270246028900146, 3.7990546226501465, 2.761586904525757, 3.4289870262145996, 1.9764500856399536, 2.420836925506592, 5.818143844604492, 4.346855640411377, 2.0789895057678223, 2.455256938934326, 1.671725869178772, 1.5976532697677612, 3.211699962615967, 1.850237488746643, 2.380560874938965, 2.3417835235595703, 0.971653938293457, 3.6004533767700195, 3.5184710025787354, 2.850257158279419, 3.2520790100097656, 5.756197452545166, 0.8636188507080078, 3.0315630435943604, 4.096957683563232, 3.2945289611816406, 1.426926851272583, 3.406752109527588, 2.348452091217041, 2.7676491737365723, 2.32883882522583, 2.707217216491699, 3.0404863357543945, 4.758515357971191, 2.157304286956787, 2.5679378509521484, 4.351584434509277, 3.555851936340332, 2.7717032432556152, 3.8238930702209473, 1.8305968046188354, 1.824022889137268], "mean_td_error": 2.8991806507110596, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 41.0, "diff_num_grad_updates_vs_sampler_policy": 40.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.06882095336914, "actor_loss": -7.154965400695801, "critic_loss": 0.4279555678367615, "alpha_loss": -0.12090941518545151, "alpha_value": 0.9880635142326355, "log_alpha_value": -0.012008299119770527, "target_entropy": -6.0, "policy_t": 0.01272744033485651, "mean_q": 3.202159881591797, "max_q": 4.121448040008545, "min_q": 2.5411367416381836}, "td_error": [3.706537961959839, 1.2982712984085083, 2.9366800785064697, 1.61846125125885, 3.0105762481689453, 2.4561052322387695, 1.8701887130737305, 1.3301721811294556, 1.2454195022583008, 0.14863646030426025, 0.32492196559906006, 0.8713006973266602, 2.2851176261901855, 4.418536186218262, 1.2701528072357178, 1.8617308139801025, 3.0815513134002686, 0.30154407024383545, 0.5063869953155518, 1.9501338005065918, 0.7777023315429688, 0.5550614595413208, 0.351578950881958, 1.2812362909317017, 1.4326672554016113, 2.067169666290283, 1.9988716840744019, 0.7430276870727539, 0.7859542369842529, 0.4034770727157593, 0.7634103298187256, 0.7673391103744507, 2.8966498374938965, 1.401326298713684, 0.5361217260360718, 1.93867826461792, 2.379149913787842, 1.826664686203003, 0.7233386039733887, 1.189870834350586, 1.399820327758789, 2.6966311931610107, 1.1499207019805908, 0.8011847734451294, 0.9345752000808716, 2.3950581550598145, 3.237985610961914, 0.2582312822341919, 0.2858898639678955, 0.7475039958953857, 0.40107083320617676, 0.8569014072418213, 0.7986724376678467, 2.3388280868530273, 0.2199631929397583, 0.41876912117004395, 2.043452739715576, 0.29257500171661377, 1.2186565399169922, 0.9764562845230103, 0.30125224590301514, 1.5600180625915527, 1.975229263305664, 3.162292003631592, 2.076408863067627, 1.0234793424606323, 2.7108073234558105, 0.48867106437683105, 1.525376558303833, 0.33113574981689453, 2.452065944671631, 0.946924090385437, 1.5057117938995361, 1.9027180671691895, 3.278805732727051, 1.9130218029022217, 1.030452847480774, 0.3021836280822754, 2.818063497543335, 1.3048784732818604, 0.6221588850021362, 0.5390521287918091, 5.751564979553223, 1.5891376733779907, 1.6881588697433472, 0.976163387298584], "mean_td_error": 1.494879126548767, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 41.0, "diff_num_grad_updates_vs_sampler_policy": 40.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.052270889282227, "actor_loss": -7.358101844787598, "critic_loss": 0.3257087469100952, "alpha_loss": -0.12063001096248627, "alpha_value": 0.9880714416503906, "log_alpha_value": -0.01200027484446764, "target_entropy": -6.0, "policy_t": -0.011689982376992702, "mean_q": 3.3781845569610596, "max_q": 4.308925151824951, "min_q": 2.599377393722534}, "td_error": [2.891585350036621, 0.8091791868209839, 0.5396246910095215, 0.7982748746871948, 2.0601956844329834, 1.0770058631896973, 0.423184871673584, 0.9488770961761475, 0.2548133134841919, 0.696479320526123, 1.6800962686538696, 0.5609030723571777, 0.18290483951568604, 2.048231601715088, 1.0323374271392822, 0.4364609718322754, 2.710422992706299, 2.564578056335449, 0.9287751913070679, 1.6020182371139526, 1.0157470703125, 1.9548815488815308, 0.7642518281936646, 0.34380781650543213, 0.19342553615570068, 1.9944205284118652, 0.15871620178222656, 0.609663724899292, 0.3261289596557617, 2.178262710571289, 0.5139520168304443, 1.3235472440719604, 1.1991264820098877, 2.4838178157806396, 0.41926777362823486, 1.4787449836730957, 1.2517565488815308, 0.43892598152160645, 2.734440803527832, 3.9367270469665527, 0.6394525766372681, 2.421027898788452, 1.6831024885177612, 1.3287889957427979, 1.879231572151184, 0.8505079746246338, 1.8386955261230469, 1.055979609489441, 2.3230996131896973, 1.3644742965698242, 0.3591597080230713, 0.26040196418762207, 1.282666563987732, 1.298457384109497, 2.305889129638672, 1.5160951614379883, 1.7691802978515625, 0.5448408126831055, 2.0177412033081055, 0.6173679828643799, 0.3241689205169678, 1.3005766868591309, 0.49106287956237793, 0.6551170349121094, 1.3843002319335938, 1.0411040782928467, 0.35525965690612793, 0.472381591796875, 2.070091724395752, 0.04836869239807129, 1.0135027170181274, 0.05007755756378174, 0.5942292213439941, 1.9438488483428955, 0.5858232975006104, 1.616072654724121, 0.21930325031280518, 1.1619322299957275, 0.9820519685745239, 3.1780247688293457, 0.19053936004638672, 0.2918076515197754, 1.4987761974334717, 1.694709062576294, 0.9124919176101685, 1.4878044128417969], "mean_td_error": 1.191687822341919, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 41.0, "diff_num_grad_updates_vs_sampler_policy": 40.0}}, "num_env_steps_sampled": 37632, "num_env_steps_trained": 10578, "num_agent_steps_sampled": 112896, "num_agent_steps_trained": 10578, "last_target_update_ts": 37632, "num_target_updates": 41}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112896, "num_agent_steps_trained": 10578, "num_env_steps_sampled": 37632, "num_env_steps_trained": 10578, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 460.3034451200206, "num_env_steps_trained_throughput_per_sec": 132.5427330814345, "timesteps_total": 37632, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 112896, "timers": {"training_iteration_time_ms": 2064.083, "sample_time_ms": 1456.78, "load_time_ms": 0.533, "load_throughput": 483633.713, "learn_time_ms": 62.263, "learn_throughput": 4143.692, "synch_weights_time_ms": 16.334}, "counters": {"num_env_steps_sampled": 37632, "num_env_steps_trained": 10578, "num_agent_steps_sampled": 112896, "num_agent_steps_trained": 10578, "last_target_update_ts": 37632, "num_target_updates": 41}, "done": false, "episodes_total": 0, "training_iteration": 42, "trial_id": "566d8_00000", "date": "2023-11-16_22-21-44", "timestamp": 1700202104, "time_this_iter_s": 1.9615881443023682, "time_total_s": 86.90827441215515, "pid": 48481, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fb7725be0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 86.90827441215515, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 68.03333333333335, "ram_util_percent": 92.40000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.055973052978516, "actor_loss": -7.1299004554748535, "critic_loss": 1.2654602527618408, "alpha_loss": -0.12375065684318542, "alpha_value": 0.9877692461013794, "log_alpha_value": -0.012306184507906437, "target_entropy": -6.0, "policy_t": 0.0029719185549765825, "mean_q": 3.064641237258911, "max_q": 4.416294097900391, "min_q": 2.2940804958343506}, "td_error": [1.2598215341567993, 6.025293350219727, 3.841991424560547, 1.5874522924423218, 5.001226902008057, 3.128140926361084, 0.11504292488098145, 3.6762332916259766, 4.494830131530762, 1.2690516710281372, 0.33236515522003174, 1.9971314668655396, 3.021800994873047, 2.4942893981933594, 3.1648030281066895, 1.493539810180664, 1.4555132389068604, 2.5294442176818848, 3.743481159210205, 1.92215096950531, 2.484734058380127, 0.6951175928115845, 2.776949644088745, 3.827885627746582, 2.124080181121826, 2.087034225463867, 2.273454189300537, 2.612208127975464, 1.1719688177108765, 3.0781757831573486, 2.869997978210449, 2.0882680416107178, 4.558536529541016, 1.0943284034729004, 3.931725025177002, 3.2473721504211426, 3.714064359664917, 4.157968997955322, 3.834444284439087, 2.7415671348571777, 3.9686059951782227, 4.06305456161499, 1.1512528657913208, 4.220351219177246, 2.3578240871429443, 2.259437084197998, 3.105891704559326, 1.3919137716293335, 1.5903337001800537, 1.6086333990097046, 3.278709888458252, 3.146571397781372, 2.544027805328369, 2.0374457836151123, 3.041480541229248, 2.207637310028076, 4.171700954437256, 2.1330809593200684, 1.855075716972351, 2.652562141418457, 1.4080604314804077, 2.074965000152588, 3.6322927474975586, 0.2212127447128296, 4.299492835998535, 2.2000017166137695, 3.0781807899475098, 5.410663604736328, 3.6850128173828125, 2.8916711807250977, 1.8768329620361328, 3.360806941986084, 2.2091269493103027, 3.5034842491149902, 0.1495281457901001, 2.363931179046631, 2.761263847351074, 1.9420137405395508, 1.2926063537597656, 1.2811286449432373, 6.846226692199707, 0.8179926872253418, 3.953428268432617, 3.987307071685791, 1.7561113834381104, 2.661163806915283], "mean_td_error": 2.678762674331665, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 42.0, "diff_num_grad_updates_vs_sampler_policy": 41.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.068243980407715, "actor_loss": -7.292205333709717, "critic_loss": 0.36902904510498047, "alpha_loss": -0.12392586469650269, "alpha_value": 0.9877668619155884, "log_alpha_value": -0.012308589182794094, "target_entropy": -6.0, "policy_t": 0.0028279090765863657, "mean_q": 3.2566580772399902, "max_q": 4.146847724914551, "min_q": 2.4959089756011963}, "td_error": [0.5233502388000488, 1.3561592102050781, 1.622668743133545, 1.779383659362793, 0.3835490942001343, 2.9484291076660156, 1.2176403999328613, 0.6137335300445557, 1.4150875806808472, 0.24337470531463623, 3.401956558227539, 0.677970290184021, 0.40831148624420166, 0.8292319774627686, 0.3208531141281128, 2.3280272483825684, 0.2368255853652954, 1.9849821329116821, 1.7933075428009033, 3.0530567169189453, 1.7646170854568481, 3.1764018535614014, 1.9047574996948242, 0.22213983535766602, 2.0887246131896973, 2.4732348918914795, 1.894285798072815, 0.1383962631225586, 1.1232287883758545, 0.48587965965270996, 0.6022207736968994, 1.2071000337600708, 1.8437929153442383, 0.25572526454925537, 0.9013006687164307, 1.034847617149353, 0.46927356719970703, 1.5613998174667358, 0.49700212478637695, 1.7870848178863525, 1.7703734636306763, 0.5380395650863647, 1.079685926437378, 1.0140767097473145, 3.34893798828125, 0.9068812131881714, 2.103358745574951, 0.4031716585159302, 0.8182963132858276, 0.3260456323623657, 1.783079981803894, 1.4400306940078735, 0.5806149244308472, 2.2310895919799805, 0.5856013298034668, 1.2938578128814697, 1.6068452596664429, 2.837843656539917, 0.7041627168655396, 2.0724854469299316, 1.2233184576034546, 1.4426612854003906, 2.0283923149108887, 0.5962003469467163, 0.2112518548965454, 0.20424282550811768, 0.47957706451416016, 1.777227759361267, 2.5702857971191406, 2.3227698802948, 3.215010166168213, 3.3139195442199707, 0.7247271537780762, 1.4416190385818481, 0.17576384544372559, 1.6523627042770386, 0.5151666402816772, 0.45626068115234375, 2.344329357147217, 1.075911045074463, 1.7522644996643066, 0.16652941703796387, 0.39293813705444336, 0.6996104717254639, 0.3696613311767578, 3.3121681213378906], "mean_td_error": 1.3311392068862915, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 42.0, "diff_num_grad_updates_vs_sampler_policy": 41.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.036402702331543, "actor_loss": -7.639435291290283, "critic_loss": 0.33600854873657227, "alpha_loss": -0.1234496459364891, "alpha_value": 0.9877751469612122, "log_alpha_value": -0.012300187721848488, "target_entropy": -6.0, "policy_t": 0.04770844057202339, "mean_q": 3.5818393230438232, "max_q": 4.777502536773682, "min_q": 2.6963889598846436}, "td_error": [0.7361177206039429, 0.3456907272338867, 1.6190052032470703, 1.1997501850128174, 0.9714163541793823, 1.074321985244751, 1.08707594871521, 1.1920232772827148, 0.9251111745834351, 1.2731478214263916, 2.7280538082122803, 1.0819919109344482, 1.5785856246948242, 0.2785186767578125, 1.89788019657135, 0.10843229293823242, 0.5680873394012451, 0.14816832542419434, 0.23118722438812256, 0.36815881729125977, 0.45969247817993164, 1.2112722396850586, 1.9777437448501587, 2.5574612617492676, 0.2546684741973877, 1.238386631011963, 0.5525168180465698, 2.7890233993530273, 1.3734313249588013, 1.0738872289657593, 1.5064946413040161, 0.7013459205627441, 1.2151540517807007, 2.857898712158203, 1.205801248550415, 0.9147869348526001, 1.2397677898406982, 1.2334675788879395, 1.1663260459899902, 2.7335290908813477, 0.4506263732910156, 0.8349227905273438, 1.5431793928146362, 0.6592003107070923, 0.11811304092407227, 2.624099016189575, 1.5415008068084717, 1.20549476146698, 2.4677281379699707, 1.0467766523361206, 0.4623730182647705, 1.8474992513656616, 0.6014719009399414, 0.4489363431930542, 2.43161678314209, 1.668328881263733, 2.045856475830078, 2.5169930458068848, 1.5591434240341187, 0.6507314443588257, 0.26705074310302734, 0.5029222965240479, 2.2524573802948, 1.8554887771606445, 0.2763388156890869, 2.8821470737457275, 2.461162567138672, 0.5497932434082031, 0.8412700891494751, 0.8839054107666016, 0.40115272998809814, 1.1834335327148438, 0.503411054611206, 2.5764732360839844, 1.3846547603607178, 1.7092341184616089, 1.241173505783081, 1.78504478931427, 0.370450496673584, 1.2587361335754395, 0.19500231742858887, 1.6293671131134033, 0.23993277549743652, 1.7548694610595703, 3.3646092414855957, 0.5190300941467285], "mean_td_error": 1.2475475072860718, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 42.0, "diff_num_grad_updates_vs_sampler_policy": 41.0}}, "num_env_steps_sampled": 38528, "num_env_steps_trained": 10836, "num_agent_steps_sampled": 115584, "num_agent_steps_trained": 10836, "last_target_update_ts": 38528, "num_target_updates": 42}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 115584, "num_agent_steps_trained": 10836, "num_env_steps_sampled": 38528, "num_env_steps_trained": 10836, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 473.76751545945194, "num_env_steps_trained_throughput_per_sec": 136.41966404970825, "timesteps_total": 38528, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 115584, "timers": {"training_iteration_time_ms": 2040.664, "sample_time_ms": 1435.521, "load_time_ms": 0.533, "load_throughput": 484413.104, "learn_time_ms": 62.127, "learn_throughput": 4152.789, "synch_weights_time_ms": 16.023}, "counters": {"num_env_steps_sampled": 38528, "num_env_steps_trained": 10836, "num_agent_steps_sampled": 115584, "num_agent_steps_trained": 10836, "last_target_update_ts": 38528, "num_target_updates": 42}, "done": false, "episodes_total": 0, "training_iteration": 43, "trial_id": "566d8_00000", "date": "2023-11-16_22-21-46", "timestamp": 1700202106, "time_this_iter_s": 1.9071087837219238, "time_total_s": 88.81538319587708, "pid": 48481, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fb780e83790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 88.81538319587708, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 64.03333333333335, "ram_util_percent": 92.36666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.09511661529541, "actor_loss": -7.313113689422607, "critic_loss": 1.127880334854126, "alpha_loss": -0.12725883722305298, "alpha_value": 0.9874731302261353, "log_alpha_value": -0.012605982832610607, "target_entropy": -6.0, "policy_t": 0.01782451756298542, "mean_q": 3.2820160388946533, "max_q": 4.401250839233398, "min_q": 2.466484546661377}, "td_error": [3.67954158782959, 3.321031093597412, 0.3241478204727173, 2.92808198928833, 1.5878565311431885, 3.524901866912842, 2.5237720012664795, 0.946000337600708, 4.111559867858887, 1.913536548614502, 2.683134078979492, 1.7399671077728271, 2.4137682914733887, 2.3563783168792725, 2.3968453407287598, 3.16756010055542, 0.9431887865066528, 2.0042529106140137, 2.472095012664795, 1.8510736227035522, 0.0816735029220581, 2.3337550163269043, 1.377172827720642, 3.022785186767578, 5.331942558288574, 2.3350956439971924, 1.5347654819488525, 4.386292934417725, 4.225137710571289, 2.7013745307922363, 3.4684102535247803, 0.2046966552734375, 1.5163373947143555, 0.2263350486755371, 1.3465420007705688, 3.7714571952819824, 0.6531698703765869, 3.729952335357666, 3.7729289531707764, 1.5646917819976807, 3.1716349124908447, 1.1302496194839478, 1.0583992004394531, 3.6526246070861816, 1.6538387537002563, 1.3627638816833496, 1.0313020944595337, 3.0256519317626953, 4.448636531829834, 3.6276721954345703, 2.2843828201293945, 3.163583755493164, 2.6766762733459473, 2.407409191131592, 3.0866880416870117, 2.111752510070801, 5.811280250549316, 2.0890846252441406, 1.4818111658096313, 3.748190402984619, 2.454845428466797, 0.27108442783355713, 4.573899269104004, 2.6095266342163086, 1.61929190158844, 1.1667336225509644, 2.54909610748291, 0.952319860458374, 5.429659843444824, 3.1329128742218018, 5.4435715675354, 2.3691468238830566, 0.6766384840011597, 1.5974445343017578, 0.22332513332366943, 3.0243380069732666, 1.0424752235412598, 3.7443037033081055, 2.630049705505371, 2.5809037685394287, 3.439512252807617, 2.462198257446289, 2.710170269012451, 5.346184730529785, 2.7385811805725098, 1.2306785583496094], "mean_td_error": 2.482741117477417, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 43.0, "diff_num_grad_updates_vs_sampler_policy": 42.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.091267585754395, "actor_loss": -7.479049205780029, "critic_loss": 0.3527141213417053, "alpha_loss": -0.12723898887634277, "alpha_value": 0.9874703288078308, "log_alpha_value": -0.01260882243514061, "target_entropy": -6.0, "policy_t": 0.010561659932136536, "mean_q": 3.4071297645568848, "max_q": 4.466237545013428, "min_q": 2.4968719482421875}, "td_error": [1.2750812768936157, 0.33034491539001465, 1.7080037593841553, 2.0418829917907715, 0.9854990243911743, 0.9700782299041748, 1.8492436408996582, 2.5219266414642334, 1.4504201412200928, 0.24846744537353516, 0.5278855562210083, 0.5240315198898315, 0.4693032503128052, 0.9211112260818481, 2.17668080329895, 0.2562626600265503, 0.33555328845977783, 0.46903812885284424, 0.25566184520721436, 0.4472086429595947, 0.5897102355957031, 1.9567688703536987, 1.6277873516082764, 1.506885290145874, 0.2982790470123291, 1.7421133518218994, 0.3606855869293213, 0.8606405258178711, 1.0026484727859497, 1.196778416633606, 0.3697293996810913, 0.5908317565917969, 1.6299704313278198, 0.9812194108963013, 1.6448185443878174, 1.9754869937896729, 4.899228096008301, 1.6091852188110352, 2.031033992767334, 2.296999216079712, 1.5673197507858276, 0.47444796562194824, 3.9514217376708984, 0.4646644592285156, 1.1947907209396362, 0.054463982582092285, 1.4633070230484009, 1.2194674015045166, 0.524754524230957, 0.35066092014312744, 2.1872544288635254, 1.302966594696045, 2.9350991249084473, 0.3041708469390869, 2.3983154296875, 0.4872457981109619, 0.5133541822433472, 0.029465794563293457, 3.2183682918548584, 1.857922911643982, 0.9374350309371948, 1.679847240447998, 1.5119143724441528, 3.5056517124176025, 2.07535457611084, 0.9109628200531006, 0.22532868385314941, 0.28230583667755127, 1.1305944919586182, 2.633385181427002, 0.9516414403915405, 2.4388911724090576, 2.92793607711792, 0.9811310768127441, 1.6218441724777222, 1.5700559616088867, 1.204267978668213, 1.921371340751648, 0.5034263134002686, 1.5115724802017212, 0.2580444812774658, 0.8977048397064209, 0.19261527061462402, 1.3269063234329224, 0.7533609867095947, 0.04149901866912842], "mean_td_error": 1.2724303007125854, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 43.0, "diff_num_grad_updates_vs_sampler_policy": 42.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.086038589477539, "actor_loss": -7.909241199493408, "critic_loss": 0.26474183797836304, "alpha_loss": -0.12708401679992676, "alpha_value": 0.987479031085968, "log_alpha_value": -0.01259999442845583, "target_entropy": -6.0, "policy_t": -0.012261045165359974, "mean_q": 3.874814033508301, "max_q": 4.889308452606201, "min_q": 2.750007152557373}, "td_error": [1.9765839576721191, 1.3486307859420776, 2.1339759826660156, 0.21010637283325195, 1.3210841417312622, 1.5029137134552002, 1.0557470321655273, 0.5126762390136719, 0.9651005268096924, 0.11338543891906738, 0.7810056209564209, 0.29521751403808594, 2.5126118659973145, 0.5322277545928955, 0.18403446674346924, 0.3936460018157959, 1.8252434730529785, 0.4738039970397949, 0.6239612102508545, 0.7238140106201172, 2.8923940658569336, 1.1430230140686035, 1.6039222478866577, 0.37541651725769043, 1.8488065004348755, 1.8575060367584229, 2.451076030731201, 0.6636691093444824, 0.4271867275238037, 1.0340979099273682, 0.07767415046691895, 0.7708225250244141, 0.3711254596710205, 1.7043770551681519, 0.34350156784057617, 0.45133495330810547, 2.5748274326324463, 0.7323850393295288, 1.0329136848449707, 0.2827942371368408, 0.46851682662963867, 0.4953794479370117, 0.14598464965820312, 1.7966980934143066, 0.13192272186279297, 0.844257116317749, 1.1760776042938232, 1.4348301887512207, 2.3092241287231445, 1.1795289516448975, 2.843851089477539, 0.40889763832092285, 0.16957879066467285, 0.7038861513137817, 2.7127206325531006, 2.480741500854492, 1.6147079467773438, 0.5037984848022461, 1.5449620485305786, 1.1902062892913818, 1.1762465238571167, 0.69134521484375, 0.7638287544250488, 0.48445022106170654, 0.3859272003173828, 0.6694595813751221, 0.7933701276779175, 1.12834632396698, 0.08620834350585938, 1.1596733331680298, 2.0220749378204346, 0.1484973430633545, 1.2365751266479492, 2.1075851917266846, 0.5387017726898193, 1.3185036182403564, 0.4499601125717163, 0.5360870361328125, 2.342683792114258, 2.8064310550689697, 0.99703049659729, 0.33798158168792725, 0.1725633144378662, 0.1546543836593628, 0.2143629789352417, 1.155893325805664], "mean_td_error": 1.048358678817749, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 43.0, "diff_num_grad_updates_vs_sampler_policy": 42.0}}, "num_env_steps_sampled": 39424, "num_env_steps_trained": 11094, "num_agent_steps_sampled": 118272, "num_agent_steps_trained": 11094, "last_target_update_ts": 39424, "num_target_updates": 43}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 118272, "num_agent_steps_trained": 11094, "num_env_steps_sampled": 39424, "num_env_steps_trained": 11094, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 471.02510181050485, "num_env_steps_trained_throughput_per_sec": 135.62999583382842, "timesteps_total": 39424, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 118272, "timers": {"training_iteration_time_ms": 2020.18, "sample_time_ms": 1415.626, "load_time_ms": 0.531, "load_throughput": 486154.109, "learn_time_ms": 62.098, "learn_throughput": 4154.749, "synch_weights_time_ms": 16.191}, "counters": {"num_env_steps_sampled": 39424, "num_env_steps_trained": 11094, "num_agent_steps_sampled": 118272, "num_agent_steps_trained": 11094, "last_target_update_ts": 39424, "num_target_updates": 43}, "done": false, "episodes_total": 0, "training_iteration": 44, "trial_id": "566d8_00000", "date": "2023-11-16_22-21-48", "timestamp": 1700202108, "time_this_iter_s": 1.9186789989471436, "time_total_s": 90.73406219482422, "pid": 48481, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fb780e85e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 90.73406219482422, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 65.26666666666667, "ram_util_percent": 92.40000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.060819625854492, "actor_loss": -7.553192138671875, "critic_loss": 0.91434645652771, "alpha_loss": -0.1298430860042572, "alpha_value": 0.9871771335601807, "log_alpha_value": -0.012905815616250038, "target_entropy": -6.0, "policy_t": -0.020554445683956146, "mean_q": 3.4339914321899414, "max_q": 4.529973030090332, "min_q": 2.647437334060669}, "td_error": [2.663585901260376, 3.0357611179351807, 3.710268259048462, 2.308338165283203, 2.2447030544281006, 3.1471986770629883, 1.4266678094863892, 2.6990952491760254, 4.51878547668457, 0.9005002975463867, 1.9249532222747803, 0.9816975593566895, 1.572444200515747, 2.926827907562256, 1.2838659286499023, 2.7437381744384766, 3.897810459136963, 0.806370735168457, 0.8966799974441528, 2.3112635612487793, 2.010035514831543, 1.5336968898773193, 3.034402847290039, 1.0318330526351929, 3.911942958831787, 2.8149118423461914, 2.3477935791015625, 1.2615047693252563, 0.6007513999938965, 2.589268207550049, 1.610457181930542, 3.151416063308716, 0.7872748374938965, 0.9011577367782593, 1.1802177429199219, 1.044399380683899, 4.52883243560791, 2.4751625061035156, 5.819252967834473, 0.2961474657058716, 1.8058929443359375, 0.6358535289764404, 2.691089630126953, 1.3317519426345825, 1.1638597249984741, 2.918783187866211, 0.1956261396408081, 2.876481533050537, 0.6521683931350708, 4.377347946166992, 1.2832190990447998, 3.2514524459838867, 2.4744858741760254, 0.9636766910552979, 1.5298361778259277, 1.2621458768844604, 3.6271862983703613, 3.3045334815979004, 5.081363677978516, 1.3095829486846924, 2.632364273071289, 2.854511260986328, 5.128758430480957, 2.908702850341797, 2.3228201866149902, 0.6823040246963501, 3.024690628051758, 2.0572876930236816, 3.872427463531494, 2.9696450233459473, 1.6585440635681152, 2.935154676437378, 3.1867125034332275, 4.535074234008789, 1.6296229362487793, 1.6850745677947998, 1.7568862438201904, 3.895224094390869, 2.007897138595581, 4.01582670211792, 1.4328501224517822, 2.657047748565674, 2.190829277038574, 2.1279423236846924, 0.4820483922958374, 3.3175768852233887], "mean_td_error": 2.3213393688201904, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 44.0, "diff_num_grad_updates_vs_sampler_policy": 43.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.120787620544434, "actor_loss": -7.761050224304199, "critic_loss": 0.3473220467567444, "alpha_loss": -0.1306498497724533, "alpha_value": 0.9871739149093628, "log_alpha_value": -0.012909059412777424, "target_entropy": -6.0, "policy_t": 0.014337306842207909, "mean_q": 3.729733467102051, "max_q": 4.953729629516602, "min_q": 2.9002928733825684}, "td_error": [0.7267446517944336, 0.9111981391906738, 2.3669989109039307, 1.7256579399108887, 2.189591407775879, 1.4994601011276245, 0.8645352125167847, 3.11437726020813, 0.5788713693618774, 0.6913782358169556, 0.4616692066192627, 1.0057419538497925, 1.2429875135421753, 2.6571898460388184, 0.294880747795105, 0.6545372009277344, 0.9863512516021729, 0.3931546211242676, 1.145204782485962, 0.4692953824996948, 0.37523210048675537, 1.650293231010437, 2.1095504760742188, 3.2365386486053467, 0.4899634122848511, 0.7665402889251709, 2.6918013095855713, 1.3922885656356812, 2.3686656951904297, 1.32868492603302, 0.20877158641815186, 1.2605836391448975, 0.2955198287963867, 1.0024508237838745, 0.23587453365325928, 0.8244506120681763, 0.6336194276809692, 0.3079800605773926, 2.1449100971221924, 0.22807574272155762, 0.7570177316665649, 1.207524299621582, 0.40421080589294434, 0.20676565170288086, 1.75616455078125, 1.2379049062728882, 1.0860729217529297, 0.2052699327468872, 2.5905332565307617, 0.5650864839553833, 0.4428755044937134, 1.7474982738494873, 1.642996907234192, 3.166576385498047, 0.5263737440109253, 1.3823961019515991, 0.7878355979919434, 0.4380784034729004, 2.234330892562866, 2.2180097103118896, 1.1767247915267944, 0.38423728942871094, 0.07435488700866699, 0.6988809108734131, 4.511423110961914, 2.4941000938415527, 1.6411092281341553, 0.42408573627471924, 0.794792652130127, 1.0847258567810059, 2.857762336730957, 0.2699018716812134, 0.4211658239364624, 0.4214601516723633, 1.0072957277297974, 1.6875927448272705, 3.519127607345581, 2.648289203643799, 1.3214635848999023, 0.35599708557128906, 2.2258434295654297, 1.0266218185424805, 3.539841890335083, 0.3873497247695923, 0.49596869945526123, 1.313337802886963], "mean_td_error": 1.2664952278137207, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 44.0, "diff_num_grad_updates_vs_sampler_policy": 43.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0775728225708, "actor_loss": -8.105772972106934, "critic_loss": 0.34248483180999756, "alpha_loss": -0.12999892234802246, "alpha_value": 0.9871830344200134, "log_alpha_value": -0.012899822555482388, "target_entropy": -6.0, "policy_t": 0.029172256588935852, "mean_q": 4.091361999511719, "max_q": 5.24955940246582, "min_q": 2.9328575134277344}, "td_error": [1.1958400011062622, 1.4301786422729492, 1.5978939533233643, 0.6671154499053955, 0.3035612106323242, 1.0881013870239258, 0.32996368408203125, 0.5725479125976562, 1.283247709274292, 1.009514331817627, 1.546485185623169, 0.9555091857910156, 0.49444031715393066, 0.015354514122009277, 0.15834569931030273, 0.32280290126800537, 2.4329957962036133, 0.4484025239944458, 1.9326175451278687, 1.597747802734375, 0.6186622381210327, 0.6852151155471802, 0.4182645082473755, 2.9008984565734863, 2.025371551513672, 1.3865625858306885, 2.0083045959472656, 0.18697738647460938, 1.1584423780441284, 1.706878900527954, 0.8322328329086304, 1.2609186172485352, 0.4432440996170044, 1.6196861267089844, 1.2912421226501465, 0.10926270484924316, 0.3172415494918823, 0.168165922164917, 0.8710477352142334, 0.8897397518157959, 2.2867255210876465, 0.447928786277771, 0.1950395107269287, 2.017544984817505, 0.7821393013000488, 2.0738728046417236, 0.19706058502197266, 2.2574524879455566, 1.9084744453430176, 0.5641202926635742, 1.6490604877471924, 0.40982580184936523, 0.9395679235458374, 0.14714419841766357, 3.7982184886932373, 0.7817986011505127, 1.1186389923095703, 0.12467122077941895, 0.38152241706848145, 0.20548856258392334, 1.580306053161621, 1.4372010231018066, 1.62558913230896, 1.6518957614898682, 0.9648019075393677, 0.6584694385528564, 1.3338721990585327, 0.14734160900115967, 0.8716722726821899, 2.13321852684021, 2.957212448120117, 0.4003413915634155, 1.7025229930877686, 3.081169843673706, 1.9105610847473145, 3.0294461250305176, 1.5045034885406494, 3.663037061691284, 1.1862609386444092, 3.6165480613708496, 1.263378620147705, 0.963871955871582, 0.2244126796722412, 2.871129035949707, 0.2226269245147705, 1.05802321434021], "mean_td_error": 1.2165899276733398, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 44.0, "diff_num_grad_updates_vs_sampler_policy": 43.0}}, "num_env_steps_sampled": 40320, "num_env_steps_trained": 11352, "num_agent_steps_sampled": 120960, "num_agent_steps_trained": 11352, "last_target_update_ts": 40320, "num_target_updates": 44}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120960, "num_agent_steps_trained": 11352, "num_env_steps_sampled": 40320, "num_env_steps_trained": 11352, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 486.1354547164408, "num_env_steps_trained_throughput_per_sec": 139.98096798754656, "timesteps_total": 40320, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 120960, "timers": {"training_iteration_time_ms": 1988.922, "sample_time_ms": 1382.893, "load_time_ms": 0.531, "load_throughput": 486197.795, "learn_time_ms": 62.151, "learn_throughput": 4151.166, "synch_weights_time_ms": 16.253}, "counters": {"num_env_steps_sampled": 40320, "num_env_steps_trained": 11352, "num_agent_steps_sampled": 120960, "num_agent_steps_trained": 11352, "last_target_update_ts": 40320, "num_target_updates": 44}, "done": false, "episodes_total": 0, "training_iteration": 45, "trial_id": "566d8_00000", "date": "2023-11-16_22-21-50", "timestamp": 1700202110, "time_this_iter_s": 1.8596041202545166, "time_total_s": 92.59366631507874, "pid": 48481, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fb763906a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 92.59366631507874, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 86.05000000000001, "ram_util_percent": 92.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.133955001831055, "actor_loss": -7.834330081939697, "critic_loss": 0.7731848955154419, "alpha_loss": -0.13382497429847717, "alpha_value": 0.9868811964988708, "log_alpha_value": -0.01320559997111559, "target_entropy": -6.0, "policy_t": -0.0036448675673455, "mean_q": 3.7250077724456787, "max_q": 5.089072227478027, "min_q": 2.769458293914795}, "td_error": [1.9330382347106934, 2.7212109565734863, 1.609946846961975, 1.0320043563842773, 0.6241800785064697, 4.007949352264404, 0.40056657791137695, 0.36801981925964355, 1.3857135772705078, 1.1360303163528442, 2.7674877643585205, 0.925001859664917, 3.1233081817626953, 2.593916416168213, 1.3418471813201904, 1.9836102724075317, 2.5511152744293213, 1.6329649686813354, 1.3392364978790283, 2.79559326171875, 1.5862352848052979, 0.6998875141143799, 3.6989753246307373, 2.5720748901367188, 2.441995620727539, 1.7673113346099854, 3.746847152709961, 2.351567506790161, 2.6495394706726074, 1.1184427738189697, 2.3199310302734375, 2.346553325653076, 2.3632094860076904, 0.6767396926879883, 1.832197904586792, 1.3038089275360107, 1.7611740827560425, 0.290264368057251, 1.3315324783325195, 3.8824024200439453, 3.9439167976379395, 1.2831368446350098, 1.7937053442001343, 2.1636195182800293, 2.532273292541504, 0.2300204038619995, 0.2564854621887207, 0.294097900390625, 1.2214657068252563, 1.4632699489593506, 3.0681958198547363, 2.779711961746216, 2.982959270477295, 0.9558138847351074, 3.8030548095703125, 3.426959276199341, 3.0959296226501465, 2.111858367919922, 1.094459056854248, 1.9682172536849976, 2.369694709777832, 2.436695098876953, 2.0160913467407227, 1.2109531164169312, 0.06854534149169922, 0.7803943157196045, 4.3216447830200195, 2.1139979362487793, 3.4314045906066895, 1.1721724271774292, 0.23797833919525146, 2.1984219551086426, 0.186506986618042, 3.329244613647461, 1.8034179210662842, 0.26006078720092773, 2.4849491119384766, 0.8519606590270996, 4.486639976501465, 0.33815598487854004, 1.7578251361846924, 2.2630512714385986, 1.9696234464645386, 2.3152055740356445, 2.9280309677124023, 2.360703945159912], "mean_td_error": 1.9439061880111694, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 45.0, "diff_num_grad_updates_vs_sampler_policy": 44.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.10687255859375, "actor_loss": -7.993768215179443, "critic_loss": 0.2726883888244629, "alpha_loss": -0.13350540399551392, "alpha_value": 0.9868775010108948, "log_alpha_value": -0.013209367170929909, "target_entropy": -6.0, "policy_t": 0.017307957634329796, "mean_q": 3.9436159133911133, "max_q": 5.258291721343994, "min_q": 2.8241968154907227}, "td_error": [1.2955222129821777, 0.5749952793121338, 0.1955968141555786, 0.535454273223877, 0.7297489643096924, 2.353159189224243, 0.2252335548400879, 0.6198990345001221, 0.6262805461883545, 1.2282946109771729, 1.33663809299469, 0.24974274635314941, 0.4663769006729126, 1.1702969074249268, 0.4648662805557251, 1.9574024677276611, 0.4134819507598877, 1.0027356147766113, 1.9918817281723022, 0.2831590175628662, 1.903165578842163, 1.5454237461090088, 0.8022334575653076, 0.6635140180587769, 1.5625760555267334, 1.9629106521606445, 1.4520244598388672, 0.18447589874267578, 0.3740497827529907, 1.4637410640716553, 1.2376939058303833, 0.4244035482406616, 0.3653597831726074, 0.973021388053894, 0.29311084747314453, 0.45492100715637207, 1.3603966236114502, 2.5124616622924805, 0.7052336931228638, 1.9802534580230713, 1.281022310256958, 0.3148120641708374, 0.467670202255249, 0.3532681465148926, 0.7476600408554077, 1.3060728311538696, 1.5148775577545166, 0.6385509967803955, 0.8711512088775635, 0.3185238838195801, 1.5127568244934082, 1.5576533079147339, 2.8654794692993164, 0.17862796783447266, 0.2228708267211914, 0.5296461582183838, 0.618188738822937, 0.4754999876022339, 0.5120677947998047, 0.4392307996749878, 0.9995477199554443, 0.5415655374526978, 0.762548565864563, 0.3671600818634033, 1.6099315881729126, 0.30972564220428467, 1.4015045166015625, 2.8147220611572266, 2.504727840423584, 1.7524219751358032, 1.2653528451919556, 2.7388811111450195, 1.0912892818450928, 1.0788872241973877, 2.5064568519592285, 2.190524101257324, 1.4198861122131348, 0.5969183444976807, 0.4632885456085205, 0.24873030185699463, 1.5144152641296387, 0.6222538948059082, 2.4971048831939697, 1.6549842357635498, 0.6404154300689697, 1.6235079765319824], "mean_td_error": 1.0684200525283813, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 45.0, "diff_num_grad_updates_vs_sampler_policy": 44.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.061891555786133, "actor_loss": -8.377995491027832, "critic_loss": 0.22194303572177887, "alpha_loss": -0.1328134387731552, "alpha_value": 0.9868870973587036, "log_alpha_value": -0.01319964975118637, "target_entropy": -6.0, "policy_t": 0.0011421756353229284, "mean_q": 4.409058570861816, "max_q": 5.779879093170166, "min_q": 3.266214370727539}, "td_error": [0.1538548469543457, 0.4494321346282959, 3.894331455230713, 0.848014235496521, 0.3885214328765869, 1.8256416320800781, 0.4487278461456299, 1.1896578073501587, 1.8256341218948364, 0.40047597885131836, 0.6718833446502686, 0.24844837188720703, 0.7210748195648193, 2.226217746734619, 0.8770108222961426, 0.5089758634567261, 0.3191174268722534, 0.16808974742889404, 0.45076489448547363, 1.5961451530456543, 0.29628705978393555, 0.3651890754699707, 0.4256162643432617, 1.1389353275299072, 1.0446853637695312, 1.138871669769287, 0.26082301139831543, 0.45348310470581055, 0.29448580741882324, 1.5566861629486084, 2.019775629043579, 0.7433528900146484, 2.741529941558838, 1.509134292602539, 1.506091833114624, 1.5706576108932495, 0.03368663787841797, 1.3784898519515991, 0.4956684112548828, 0.19409823417663574, 1.9032022953033447, 0.4368375539779663, 1.6393334865570068, 1.729729413986206, 1.0300636291503906, 0.19099664688110352, 0.1842440366744995, 0.8569991588592529, 1.2755136489868164, 2.0240907669067383, 0.39260292053222656, 1.5979958772659302, 1.0184376239776611, 0.5669164657592773, 1.7540099620819092, 3.085481882095337, 0.4422423839569092, 0.21195316314697266, 0.4165445566177368, 0.10764575004577637, 1.7750506401062012, 1.757650375366211, 1.2003276348114014, 1.0330219268798828, 2.2669637203216553, 1.8217459917068481, 1.114518404006958, 0.2259829044342041, 0.13814270496368408, 1.0859978199005127, 0.5091657638549805, 1.6478919982910156, 0.9089410305023193, 2.2545108795166016, 0.3681464195251465, 2.323826789855957, 0.43320584297180176, 1.8641276359558105, 0.2715179920196533, 1.1586694717407227, 0.833195686340332, 0.239416241645813, 0.23386335372924805, 2.106388807296753, 0.48702681064605713, 0.5422060489654541], "mean_td_error": 1.0214641094207764, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 45.0, "diff_num_grad_updates_vs_sampler_policy": 44.0}}, "num_env_steps_sampled": 41216, "num_env_steps_trained": 11610, "num_agent_steps_sampled": 123648, "num_agent_steps_trained": 11610, "last_target_update_ts": 41216, "num_target_updates": 45}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 123648, "num_agent_steps_trained": 11610, "num_env_steps_sampled": 41216, "num_env_steps_trained": 11610, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 480.77848603437, "num_env_steps_trained_throughput_per_sec": 138.4384479875753, "timesteps_total": 41216, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 123648, "timers": {"training_iteration_time_ms": 1966.735, "sample_time_ms": 1360.332, "load_time_ms": 0.53, "load_throughput": 487007.395, "learn_time_ms": 62.149, "learn_throughput": 4151.301, "synch_weights_time_ms": 16.172}, "counters": {"num_env_steps_sampled": 41216, "num_env_steps_trained": 11610, "num_agent_steps_sampled": 123648, "num_agent_steps_trained": 11610, "last_target_update_ts": 41216, "num_target_updates": 45}, "done": false, "episodes_total": 0, "training_iteration": 46, "trial_id": "566d8_00000", "date": "2023-11-16_22-21-52", "timestamp": 1700202112, "time_this_iter_s": 1.8769006729125977, "time_total_s": 94.47056698799133, "pid": 48481, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fb7906b0b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 94.47056698799133, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 65.03333333333333, "ram_util_percent": 92.36666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.028255462646484, "actor_loss": -7.998550891876221, "critic_loss": 0.7267487049102783, "alpha_loss": -0.13543672859668732, "alpha_value": 0.986585259437561, "log_alpha_value": -0.013505511917173862, "target_entropy": -6.0, "policy_t": -0.01223342027515173, "mean_q": 4.0180439949035645, "max_q": 5.91093635559082, "min_q": 3.012655019760132}, "td_error": [2.8621909618377686, 0.5298949480056763, 3.0879030227661133, 2.2112388610839844, 1.7484065294265747, 0.15558266639709473, 1.6311782598495483, 1.2317618131637573, 1.0139679908752441, 0.8047319650650024, 0.09015798568725586, 2.027918815612793, 2.629242181777954, 1.5255606174468994, 0.8221595287322998, 5.08729362487793, 0.2509866952896118, 3.8449149131774902, 1.5855741500854492, 3.3193562030792236, 1.685309648513794, 2.429774284362793, 0.5235657691955566, 3.1405348777770996, 4.713691711425781, 1.2808833122253418, 0.4006061553955078, 1.1153221130371094, 4.971990585327148, 2.4288501739501953, 0.4861619472503662, 0.22134160995483398, 2.5157389640808105, 1.6272857189178467, 2.8122377395629883, 0.9618175029754639, 0.8560106754302979, 1.3085670471191406, 1.7065832614898682, 1.7012832164764404, 0.8984613418579102, 4.145818710327148, 1.7120051383972168, 2.4054903984069824, 1.5852446556091309, 1.7377204895019531, 0.4011189937591553, 0.6398015022277832, 1.8942832946777344, 6.3519206047058105, 3.7561867237091064, 2.796170711517334, 0.5812814235687256, 1.6103020906448364, 2.273514747619629, 1.900219202041626, 0.8322011232376099, 1.7647807598114014, 2.7299180030822754, 0.5625653266906738, 1.3312405347824097, 3.1240673065185547, 1.924946665763855, 2.6076297760009766, 2.0422005653381348, 2.783541679382324, 2.509664297103882, 2.893786907196045, 1.6183868646621704, 1.2492985725402832, 0.5357258319854736, 1.5067436695098877, 1.886475682258606, 1.2421456575393677, 2.560476064682007, 1.3694061040878296, 4.103713035583496, 1.4754023551940918, 0.2828634977340698, 2.822251081466675, 3.7014098167419434, 0.6660778522491455, 0.8891241550445557, 0.5233471393585205, 1.868587613105774, 4.512825012207031], "mean_td_error": 1.9297430515289307, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 46.0, "diff_num_grad_updates_vs_sampler_policy": 45.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0263090133667, "actor_loss": -8.107620239257812, "critic_loss": 0.3212500214576721, "alpha_loss": -0.13545246422290802, "alpha_value": 0.9865811467170715, "log_alpha_value": -0.013509703800082207, "target_entropy": -6.0, "policy_t": -0.030670322477817535, "mean_q": 4.055712699890137, "max_q": 5.452956199645996, "min_q": 3.107189655303955}, "td_error": [0.1248016357421875, 0.3693181276321411, 0.21349632740020752, 0.8739323616027832, 0.17014002799987793, 0.9110293388366699, 0.6128965616226196, 0.431241512298584, 2.7417681217193604, 3.83015513420105, 0.6347006559371948, 0.9156169891357422, 0.9715291261672974, 1.1565066576004028, 1.395989179611206, 1.8455183506011963, 0.6136229038238525, 1.0934196710586548, 1.717984914779663, 0.35564351081848145, 0.15789461135864258, 0.6789436340332031, 0.6137700080871582, 0.36564087867736816, 0.8072769641876221, 0.8494354486465454, 0.6394044160842896, 1.6209086179733276, 1.6857573986053467, 1.0516760349273682, 0.2737436294555664, 0.22516226768493652, 1.9193470478057861, 2.7237846851348877, 2.0750701427459717, 0.1311783790588379, 1.4646443128585815, 0.816882848739624, 0.8438336849212646, 1.7257105112075806, 0.4798433780670166, 1.7814983129501343, 0.9005429744720459, 1.8534820079803467, 0.6064612865447998, 2.815159559249878, 1.99687922000885, 1.659912109375, 0.48456501960754395, 1.1195573806762695, 0.08275961875915527, 0.17552030086517334, 1.0260978937149048, 0.14824533462524414, 3.224484920501709, 1.8973276615142822, 1.708280086517334, 0.3128542900085449, 0.8047571182250977, 2.1146726608276367, 0.18197870254516602, 0.4381307363510132, 0.47092223167419434, 2.1485226154327393, 1.227725625038147, 1.1272871494293213, 0.8580987453460693, 2.6358776092529297, 0.2756716012954712, 0.9203656911849976, 0.3536757230758667, 0.16373169422149658, 2.343731641769409, 2.3086485862731934, 0.338803768157959, 4.249338150024414, 3.5892937183380127, 2.3989202976226807, 1.393232822418213, 1.244781255722046, 1.8486552238464355, 0.8835099935531616, 1.1159437894821167, 0.6646591424942017, 0.6034154891967773, 0.6440949440002441], "mean_td_error": 1.177573323249817, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 46.0, "diff_num_grad_updates_vs_sampler_policy": 45.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.092657089233398, "actor_loss": -8.581003189086914, "critic_loss": 0.2241089940071106, "alpha_loss": -0.1362452208995819, "alpha_value": 0.9865912795066833, "log_alpha_value": -0.01349943969398737, "target_entropy": -6.0, "policy_t": 0.04073408246040344, "mean_q": 4.509513854980469, "max_q": 6.265198707580566, "min_q": 3.2848098278045654}, "td_error": [2.138699769973755, 0.686166524887085, 0.31482791900634766, 0.3316311836242676, 1.9423916339874268, 2.5534069538116455, 1.675715446472168, 1.1458765268325806, 0.567589521408081, 0.20741677284240723, 0.3065500259399414, 0.2342548370361328, 0.5249335765838623, 1.0902236700057983, 1.3780028820037842, 2.6238551139831543, 0.5397975444793701, 0.7738807201385498, 1.5190389156341553, 1.1967482566833496, 0.11491870880126953, 0.8705873489379883, 0.4900989532470703, 3.067829132080078, 1.3781845569610596, 1.014934778213501, 1.3672459125518799, 0.9170651435852051, 0.45740771293640137, 0.9526753425598145, 0.5511971712112427, 0.14659452438354492, 0.7318587303161621, 0.05459928512573242, 0.7810943126678467, 0.30339503288269043, 0.6668598651885986, 2.182271957397461, 0.814039945602417, 0.1606440544128418, 1.0121450424194336, 0.496293306350708, 0.5445084571838379, 0.9419665336608887, 0.19428610801696777, 0.45374536514282227, 0.22864007949829102, 0.9510908126831055, 2.79140305519104, 1.0908288955688477, 2.304243326187134, 1.5122570991516113, 0.8097734451293945, 0.9457321166992188, 1.7437636852264404, 0.996243953704834, 0.33044958114624023, 1.3359012603759766, 1.0172162055969238, 3.1566052436828613, 0.2225940227508545, 0.2653167247772217, 0.13563179969787598, 1.569854497909546, 1.825880765914917, 0.20565783977508545, 0.3492230176925659, 0.17129111289978027, 0.13605499267578125, 2.226074457168579, 2.4053096771240234, 0.3924436569213867, 0.5073366165161133, 0.36420321464538574, 1.1940125226974487, 2.255542516708374, 1.370166540145874, 0.9652345180511475, 2.1206893920898438, 0.281929612159729, 0.4010193347930908, 0.1368727684020996, 1.2367322444915771, 1.076691746711731, 2.2203619480133057, 0.8414132595062256], "mean_td_error": 1.0059202909469604, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 46.0, "diff_num_grad_updates_vs_sampler_policy": 45.0}}, "num_env_steps_sampled": 42112, "num_env_steps_trained": 11868, "num_agent_steps_sampled": 126336, "num_agent_steps_trained": 11868, "last_target_update_ts": 42112, "num_target_updates": 46}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 126336, "num_agent_steps_trained": 11868, "num_env_steps_sampled": 42112, "num_env_steps_trained": 11868, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 468.3301869945376, "num_env_steps_trained_throughput_per_sec": 134.8540047372664, "timesteps_total": 42112, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 126336, "timers": {"training_iteration_time_ms": 1965.122, "sample_time_ms": 1358.238, "load_time_ms": 0.53, "load_throughput": 486525.687, "learn_time_ms": 62.111, "learn_throughput": 4153.875, "synch_weights_time_ms": 16.111}, "counters": {"num_env_steps_sampled": 42112, "num_env_steps_trained": 11868, "num_agent_steps_sampled": 126336, "num_agent_steps_trained": 11868, "last_target_update_ts": 42112, "num_target_updates": 46}, "done": false, "episodes_total": 0, "training_iteration": 47, "trial_id": "566d8_00000", "date": "2023-11-16_22-21-54", "timestamp": 1700202114, "time_this_iter_s": 1.9295499324798584, "time_total_s": 96.40011692047119, "pid": 48481, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fb780e85e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 96.40011692047119, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 66.06666666666666, "ram_util_percent": 92.40000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.067570686340332, "actor_loss": -8.211228370666504, "critic_loss": 0.5217966437339783, "alpha_loss": -0.13898572325706482, "alpha_value": 0.9862895607948303, "log_alpha_value": -0.013805289752781391, "target_entropy": -6.0, "policy_t": -0.005426262505352497, "mean_q": 4.213135719299316, "max_q": 5.478323459625244, "min_q": 3.238990545272827}, "td_error": [2.374765396118164, 0.24657058715820312, 0.44393301010131836, 1.9819337129592896, 2.209733724594116, 2.3093199729919434, 1.2863645553588867, 2.214106559753418, 1.3155145645141602, 0.5098671913146973, 3.3123395442962646, 1.2379546165466309, 2.7024669647216797, 0.7427340745925903, 1.2476918697357178, 2.3603172302246094, 2.278994083404541, 1.2596065998077393, 1.1925766468048096, 0.3885164260864258, 2.5142178535461426, 1.9533274173736572, 1.0607686042785645, 1.5811121463775635, 0.20351052284240723, 2.030562400817871, 1.224130630493164, 3.163301944732666, 0.1330091953277588, 2.434252977371216, 2.404682159423828, 0.577853798866272, 4.365520477294922, 0.7711162567138672, 0.7267897129058838, 0.10993075370788574, 1.8202886581420898, 0.8612000942230225, 3.215897560119629, 4.099809169769287, 1.1062209606170654, 2.826418399810791, 2.0690059661865234, 1.924762487411499, 1.6754348278045654, 1.6300222873687744, 0.20036888122558594, 0.7066668272018433, 0.5162835121154785, 0.7997784614562988, 3.422715425491333, 1.6449840068817139, 2.6627986431121826, 0.3708913326263428, 1.7377432584762573, 1.048494815826416, 1.6444060802459717, 0.42226099967956543, 1.9564204216003418, 1.5348767042160034, 2.358114719390869, 2.4611971378326416, 1.5321447849273682, 0.5426115989685059, 2.7721164226531982, 1.311995506286621, 1.5405312776565552, 2.8006739616394043, 0.576075553894043, 0.3634965419769287, 1.3865141868591309, 1.0393919944763184, 0.7973458766937256, 0.7258048057556152, 0.5027549266815186, 1.1695423126220703, 1.2790321111679077, 0.9187595844268799, 2.0299620628356934, 1.6052043437957764, 1.064268708229065, 0.8316435813903809, 1.5472091436386108, 1.358525276184082, 0.46971893310546875, 0.6367076635360718], "mean_td_error": 1.5161453485488892, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 47.0, "diff_num_grad_updates_vs_sampler_policy": 46.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.050439834594727, "actor_loss": -8.351807594299316, "critic_loss": 0.34116849303245544, "alpha_loss": -0.13879536092281342, "alpha_value": 0.9862850308418274, "log_alpha_value": -0.013809877447783947, "target_entropy": -6.0, "policy_t": -0.015756994485855103, "mean_q": 4.317465782165527, "max_q": 5.546713352203369, "min_q": 3.3347599506378174}, "td_error": [2.896685838699341, 0.2961456775665283, 0.6255438327789307, 0.6363584995269775, 0.4519556760787964, 0.6897468566894531, 0.33196234703063965, 2.1234166622161865, 0.39638853073120117, 1.2461059093475342, 1.9020535945892334, 0.8603405952453613, 1.4820917844772339, 1.5324345827102661, 0.3501620292663574, 2.108015298843384, 0.4573620557785034, 0.8881309032440186, 2.9806721210479736, 0.6490235328674316, 3.660501480102539, 3.092586040496826, 0.17965102195739746, 1.9572081565856934, 1.15875244140625, 3.83841872215271, 1.0264701843261719, 0.38696932792663574, 1.0422580242156982, 0.5457513332366943, 2.5402042865753174, 2.267587661743164, 0.3427809476852417, 1.8211824893951416, 1.65571928024292, 0.8300809860229492, 0.6111434698104858, 0.33775854110717773, 0.559809684753418, 2.9321396350860596, 0.6173033714294434, 0.4052853584289551, 2.9001352787017822, 2.4420366287231445, 0.7394778728485107, 0.6009092330932617, 0.43405961990356445, 2.77799391746521, 0.8100063800811768, 0.38525497913360596, 1.1743264198303223, 0.1578350067138672, 1.6183140277862549, 0.39965343475341797, 1.820147156715393, 0.4007761478424072, 1.228553056716919, 0.808599591255188, 1.8058991432189941, 0.43511271476745605, 0.33509349822998047, 1.2755134105682373, 0.5009856224060059, 1.2123774290084839, 0.5791223049163818, 1.3559218645095825, 0.8335933685302734, 0.6619212627410889, 0.46385228633880615, 0.5434646606445312, 2.908015251159668, 0.9912813901901245, 2.6355879306793213, 0.2182086706161499, 0.3019895553588867, 1.2549352645874023, 2.2259883880615234, 2.9228835105895996, 1.2405385971069336, 1.081533670425415, 2.122293472290039, 0.35495948791503906, 0.30784904956817627, 0.5963764190673828, 0.3417476415634155, 2.402371644973755], "mean_td_error": 1.22467041015625, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 47.0, "diff_num_grad_updates_vs_sampler_policy": 46.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.089289665222168, "actor_loss": -8.789112091064453, "critic_loss": 0.21713736653327942, "alpha_loss": -0.1392248272895813, "alpha_value": 0.9862955212593079, "log_alpha_value": -0.013799269683659077, "target_entropy": -6.0, "policy_t": 0.013196652755141258, "mean_q": 4.764565467834473, "max_q": 6.424213886260986, "min_q": 3.417127847671509}, "td_error": [1.461533784866333, 0.9262454509735107, 1.2265336513519287, 1.005507469177246, 0.8415853977203369, 0.8245127201080322, 0.7297208309173584, 0.3357198238372803, 0.27509117126464844, 0.10179996490478516, 0.1732558012008667, 0.5493519306182861, 1.5765964984893799, 0.1154019832611084, 1.5813698768615723, 1.4369738101959229, 1.3949981927871704, 0.6636239290237427, 1.0480989217758179, 2.1660003662109375, 1.20196533203125, 0.9087584018707275, 2.4045228958129883, 0.7560157775878906, 1.616868257522583, 1.3917330503463745, 0.20008301734924316, 0.3097355365753174, 1.3966667652130127, 1.4187133312225342, 0.5978724956512451, 0.9707777500152588, 2.173725128173828, 1.8709828853607178, 1.6837787628173828, 2.2834863662719727, 0.09504961967468262, 1.0549359321594238, 1.26902174949646, 0.6157205104827881, 0.340930700302124, 2.128309726715088, 0.5670545101165771, 1.4820358753204346, 1.0361651182174683, 1.0355498790740967, 0.4598207473754883, 2.435807466506958, 2.490342855453491, 0.22351503372192383, 0.41950559616088867, 2.334310531616211, 0.21502399444580078, 1.2017333507537842, 0.7598669528961182, 0.425032377243042, 0.39001476764678955, 0.19672775268554688, 0.8794684410095215, 2.265079975128174, 0.30660414695739746, 0.31186866760253906, 1.632680892944336, 2.0156092643737793, 0.6092414855957031, 0.16556799411773682, 0.19488883018493652, 1.6895196437835693, 1.9567205905914307, 0.9267199039459229, 0.9363982677459717, 0.22301673889160156, 0.8956083059310913, 0.2209320068359375, 1.3933851718902588, 1.5353765487670898, 0.6130983829498291, 1.242921233177185, 0.42177915573120117, 0.7605116367340088, 0.5714006423950195, 0.2784855365753174, 1.0797102451324463, 0.3558318614959717, 1.4033660888671875, 1.3304718732833862], "mean_td_error": 1.0117714405059814, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 47.0, "diff_num_grad_updates_vs_sampler_policy": 46.0}}, "num_env_steps_sampled": 43008, "num_env_steps_trained": 12126, "num_agent_steps_sampled": 129024, "num_agent_steps_trained": 12126, "last_target_update_ts": 43008, "num_target_updates": 47}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 129024, "num_agent_steps_trained": 12126, "num_env_steps_sampled": 43008, "num_env_steps_trained": 12126, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 476.62509185387694, "num_env_steps_trained_throughput_per_sec": 137.24249296685295, "timesteps_total": 43008, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 129024, "timers": {"training_iteration_time_ms": 1937.517, "sample_time_ms": 1362.194, "load_time_ms": 0.531, "load_throughput": 485434.43, "learn_time_ms": 62.008, "learn_throughput": 4160.726, "synch_weights_time_ms": 15.951}, "counters": {"num_env_steps_sampled": 43008, "num_env_steps_trained": 12126, "num_agent_steps_sampled": 129024, "num_agent_steps_trained": 12126, "last_target_update_ts": 43008, "num_target_updates": 47}, "done": false, "episodes_total": 0, "training_iteration": 48, "trial_id": "566d8_00000", "date": "2023-11-16_22-21-56", "timestamp": 1700202116, "time_this_iter_s": 1.8962831497192383, "time_total_s": 98.29640007019043, "pid": 48481, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fb780e7f790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 98.29640007019043, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 65.56666666666666, "ram_util_percent": 92.40000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.025957107543945, "actor_loss": -8.38107681274414, "critic_loss": 0.5650543570518494, "alpha_loss": -0.1414165496826172, "alpha_value": 0.9859939813613892, "log_alpha_value": -0.014105042442679405, "target_entropy": -6.0, "policy_t": 0.02218569442629814, "mean_q": 4.370766639709473, "max_q": 6.067625522613525, "min_q": 3.240778684616089}, "td_error": [3.628666400909424, 1.828045129776001, 3.20249605178833, 1.815295934677124, 1.3464795351028442, 1.8595802783966064, 2.2340242862701416, 2.2507739067077637, 3.186720609664917, 0.7661838531494141, 0.8457226753234863, 0.9650177955627441, 0.3082284927368164, 3.0710086822509766, 4.198820114135742, 1.05543851852417, 2.109064817428589, 1.1420445442199707, 0.4029906988143921, 2.4688353538513184, 0.8781323432922363, 2.4425268173217773, 3.536409854888916, 3.9492130279541016, 1.4675054550170898, 0.5724899768829346, 0.5476293563842773, 0.5112674236297607, 1.2258834838867188, 1.7114391326904297, 0.27263450622558594, 1.1629886627197266, 2.3537089824676514, 3.188479423522949, 2.3051657676696777, 2.051543951034546, 0.9587409496307373, 1.7994881868362427, 0.7650771141052246, 1.155092477798462, 0.5971252918243408, 0.5304162502288818, 3.197237968444824, 0.43538200855255127, 1.9723808765411377, 0.9068764448165894, 1.4744808673858643, 0.15637636184692383, 0.19139981269836426, 1.1591668128967285, 2.2239980697631836, 0.8172030448913574, 0.8431921005249023, 1.6600327491760254, 0.8067455291748047, 1.136976957321167, 0.5313143730163574, 0.8759913444519043, 0.748140811920166, 0.3504788875579834, 0.6743183135986328, 3.149545669555664, 0.21375298500061035, 0.8164317607879639, 2.815505027770996, 1.6684499979019165, 0.9189109802246094, 3.202019214630127, 1.0160510540008545, 2.312345504760742, 0.5339527130126953, 2.845283031463623, 1.9342451095581055, 0.7548125982284546, 2.9970083236694336, 2.2823286056518555, 1.8090050220489502, 2.5780444145202637, 0.5921447277069092, 0.7618820667266846, 2.6613545417785645, 0.16193878650665283, 3.354140043258667, 0.7300503253936768, 1.7337337732315063, 3.1711888313293457], "mean_td_error": 1.6028398275375366, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 48.0, "diff_num_grad_updates_vs_sampler_policy": 47.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.087346076965332, "actor_loss": -8.422012329101562, "critic_loss": 0.2737116813659668, "alpha_loss": -0.14233209192752838, "alpha_value": 0.9859890937805176, "log_alpha_value": -0.014109963551163673, "target_entropy": -6.0, "policy_t": -0.015711085870862007, "mean_q": 4.419303894042969, "max_q": 6.064027309417725, "min_q": 3.1520028114318848}, "td_error": [0.7367312908172607, 1.4530432224273682, 2.806147575378418, 0.6827757358551025, 0.8805832862854004, 1.1649349927902222, 1.1235277652740479, 0.3546783924102783, 0.09753811359405518, 1.1246087551116943, 0.6335557699203491, 2.3762123584747314, 3.004448652267456, 0.4380471706390381, 0.41008150577545166, 0.7074508666992188, 0.08529472351074219, 0.4787609577178955, 0.22666501998901367, 0.5028719902038574, 0.3886394500732422, 2.4070303440093994, 0.8621954917907715, 1.2358269691467285, 1.5971651077270508, 0.6716477870941162, 0.41743481159210205, 1.2748690843582153, 0.6031408309936523, 0.9595613479614258, 0.28592491149902344, 1.1351181268692017, 3.4013991355895996, 0.773895263671875, 0.6810717582702637, 1.032027244567871, 0.06000089645385742, 0.9806759357452393, 0.49863433837890625, 0.6223909854888916, 1.0025006532669067, 1.4506936073303223, 0.19246411323547363, 1.6674344539642334, 3.5592598915100098, 1.8324565887451172, 0.3462100028991699, 1.8276426792144775, 0.9423341751098633, 0.6630511283874512, 0.32332372665405273, 2.430480718612671, 1.4342913627624512, 3.0330424308776855, 0.8224978446960449, 0.19107913970947266, 0.9301259517669678, 1.7504512071609497, 0.39081716537475586, 0.7163121700286865, 4.116827964782715, 1.5268032550811768, 1.2543244361877441, 0.2637448310852051, 1.3553085327148438, 1.4236023426055908, 0.13900351524353027, 1.8556764125823975, 0.626915693283081, 1.842909574508667, 1.073249101638794, 1.0080046653747559, 0.563767671585083, 0.8531842231750488, 1.7965612411499023, 0.48888659477233887, 0.5924005508422852, 0.962986946105957, 0.4187948703765869, 0.6439526081085205, 0.33055782318115234, 0.03872513771057129, 1.8575935363769531, 0.5534911155700684, 0.602121114730835, 0.4054834842681885], "mean_td_error": 1.0613716840744019, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 48.0, "diff_num_grad_updates_vs_sampler_policy": 47.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.13102912902832, "actor_loss": -9.166523933410645, "critic_loss": 0.3536199927330017, "alpha_loss": -0.14283865690231323, "alpha_value": 0.9859998226165771, "log_alpha_value": -0.014099126681685448, "target_entropy": -6.0, "policy_t": 0.022020254284143448, "mean_q": 5.162211894989014, "max_q": 6.887351989746094, "min_q": 3.7850229740142822}, "td_error": [1.0077855587005615, 1.1633198261260986, 1.461651086807251, 0.45168614387512207, 1.3326785564422607, 0.2938380241394043, 0.21899104118347168, 1.4365873336791992, 2.9259538650512695, 0.739570140838623, 0.31405162811279297, 0.77730393409729, 1.9675092697143555, 0.43230533599853516, 3.1795504093170166, 0.6889381408691406, 1.5428619384765625, 0.9783134460449219, 1.6649196147918701, 3.3935327529907227, 1.6029200553894043, 0.920295238494873, 1.5077078342437744, 1.1721127033233643, 4.229496002197266, 3.1175999641418457, 2.5296177864074707, 0.8561084270477295, 2.7493057250976562, 1.616542100906372, 2.7694690227508545, 0.5637202262878418, 2.4166758060455322, 0.8695802688598633, 1.6580462455749512, 2.175239324569702, 3.597097635269165, 0.7331140041351318, 1.6841249465942383, 2.071849822998047, 1.7911744117736816, 0.2065105438232422, 0.9601929187774658, 0.7146227359771729, 1.196929931640625, 1.7469148635864258, 2.8364317417144775, 2.102296829223633, 1.3120012283325195, 0.9774785041809082, 1.5995545387268066, 0.13840317726135254, 0.1281421184539795, 0.1762983798980713, 0.11751103401184082, 0.7004926204681396, 1.214759111404419, 0.926020622253418, 0.6123213768005371, 2.8146917819976807, 0.21951055526733398, 0.11441206932067871, 1.0985125303268433, 0.5498507022857666, 2.5514209270477295, 0.45522308349609375, 3.995929718017578, 0.12849211692810059, 0.5986285209655762, 4.5222063064575195, 1.0737695693969727, 2.3449065685272217, 0.619779109954834, 1.9181206226348877, 1.5852093696594238, 0.21852922439575195, 1.0094846487045288, 1.2005882263183594, 0.34853243827819824, 0.567471981048584, 1.3183679580688477, 1.1986117362976074, 1.5035820007324219, 0.7614665031433105, 1.3239660263061523, 2.0902304649353027], "mean_td_error": 1.4000177383422852, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 48.0, "diff_num_grad_updates_vs_sampler_policy": 47.0}}, "num_env_steps_sampled": 43904, "num_env_steps_trained": 12384, "num_agent_steps_sampled": 131712, "num_agent_steps_trained": 12384, "last_target_update_ts": 43904, "num_target_updates": 48}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 131712, "num_agent_steps_trained": 12384, "num_env_steps_sampled": 43904, "num_env_steps_trained": 12384, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 476.5169135074245, "num_env_steps_trained_throughput_per_sec": 137.21134339834322, "timesteps_total": 43904, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 131712, "timers": {"training_iteration_time_ms": 1944.394, "sample_time_ms": 1368.704, "load_time_ms": 0.533, "load_throughput": 483720.188, "learn_time_ms": 61.966, "learn_throughput": 4163.6, "synch_weights_time_ms": 15.498}, "counters": {"num_env_steps_sampled": 43904, "num_env_steps_trained": 12384, "num_agent_steps_sampled": 131712, "num_agent_steps_trained": 12384, "last_target_update_ts": 43904, "num_target_updates": 48}, "done": false, "episodes_total": 0, "training_iteration": 49, "trial_id": "566d8_00000", "date": "2023-11-16_22-21-58", "timestamp": 1700202118, "time_this_iter_s": 1.8958241939544678, "time_total_s": 100.1922242641449, "pid": 48481, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fb7906b0b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 100.1922242641449, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 89.9, "ram_util_percent": 92.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.09309196472168, "actor_loss": -8.737019538879395, "critic_loss": 0.5594921112060547, "alpha_loss": -0.1453876942396164, "alpha_value": 0.9856985807418823, "log_alpha_value": -0.01440467406064272, "target_entropy": -6.0, "policy_t": -0.007887551560997963, "mean_q": 4.734934329986572, "max_q": 6.608706951141357, "min_q": 3.270174026489258}, "td_error": [2.310713291168213, 1.9626078605651855, 0.3327646255493164, 1.2964668273925781, 1.2845206260681152, 1.5030887126922607, 1.2760040760040283, 1.0934813022613525, 0.9585132598876953, 2.2773709297180176, 1.2423348426818848, 0.8596627712249756, 0.9779293537139893, 3.296537399291992, 1.1724836826324463, 3.556767463684082, 1.5626988410949707, 0.841742992401123, 1.6813232898712158, 2.003436803817749, 1.9072797298431396, 1.4848299026489258, 2.0437276363372803, 1.5264217853546143, 2.703561544418335, 1.5305821895599365, 1.125974178314209, 0.839510440826416, 2.192129611968994, 1.4417277574539185, 2.7835488319396973, 1.108365774154663, 2.654987096786499, 2.663968801498413, 1.5538997650146484, 3.58762788772583, 0.8509225845336914, 2.2836358547210693, 0.369234561920166, 2.6398541927337646, 2.2592368125915527, 0.579085111618042, 1.8326282501220703, 1.1722767353057861, 1.307450294494629, 1.5788981914520264, 2.1360676288604736, 0.3405799865722656, 1.665208339691162, 2.002143144607544, 2.027172803878784, 2.174095392227173, 0.9777359962463379, 2.235611915588379, 0.6580908298492432, 2.5610971450805664, 2.6236677169799805, 0.5687117576599121, 0.9268331527709961, 1.4815744161605835, 2.677962064743042, 3.3650033473968506, 0.21930789947509766, 2.2964463233947754, 0.5503112077713013, 0.49528956413269043, 3.1320858001708984, 0.747791051864624, 0.9685089588165283, 0.34914684295654297, 0.8180890083312988, 0.5246636867523193, 1.071908712387085, 0.9616682529449463, 1.8897037506103516, 0.15416622161865234, 2.510519504547119, 0.4574012756347656, 1.1323909759521484, 2.798238754272461, 2.158806800842285, 1.3856382369995117, 1.378516674041748, 0.49197959899902344, 1.835222601890564, 3.067373514175415], "mean_td_error": 1.5968436002731323, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 49.0, "diff_num_grad_updates_vs_sampler_policy": 48.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.111144065856934, "actor_loss": -8.91487979888916, "critic_loss": 0.31035780906677246, "alpha_loss": -0.14570221304893494, "alpha_value": 0.9856932759284973, "log_alpha_value": -0.01441005989909172, "target_entropy": -6.0, "policy_t": -0.012067072093486786, "mean_q": 4.834690570831299, "max_q": 6.089966297149658, "min_q": 3.3640196323394775}, "td_error": [1.2569212913513184, 0.6605913639068604, 0.3260204792022705, 1.416736364364624, 1.0180943012237549, 0.7026214599609375, 0.8856048583984375, 0.5385873317718506, 1.8261075019836426, 0.21145713329315186, 2.9894068241119385, 0.9978675842285156, 0.6920228004455566, 0.2896566390991211, 0.26668500900268555, 2.32906174659729, 1.9740746021270752, 3.8495099544525146, 0.24558734893798828, 0.5483574867248535, 0.27852630615234375, 2.774683713912964, 1.576491117477417, 1.3484392166137695, 0.15299713611602783, 1.2589234113693237, 1.061138391494751, 0.5237741470336914, 0.33444786071777344, 0.714080810546875, 0.7299659252166748, 1.0678269863128662, 0.4849724769592285, 0.5727715492248535, 1.5437736511230469, 0.6910216808319092, 2.6063108444213867, 3.2931878566741943, 1.556126594543457, 0.8688496351242065, 2.662435531616211, 1.1385676860809326, 1.4871156215667725, 0.6256651878356934, 1.1704187393188477, 0.8124008178710938, 1.1320767402648926, 0.23283600807189941, 1.5009033679962158, 0.3015601634979248, 1.7421915531158447, 2.5535531044006348, 0.6220815181732178, 1.119629144668579, 1.767486810684204, 2.840492010116577, 2.7383992671966553, 0.5366415977478027, 0.4062035083770752, 0.7974255084991455, 1.0507407188415527, 0.2604408264160156, 0.3793942928314209, 0.5145368576049805, 1.0445387363433838, 2.776667594909668, 1.707448959350586, 1.4425928592681885, 0.4137539863586426, 0.5610086917877197, 0.5334079265594482, 0.22595572471618652, 2.2523727416992188, 0.31151556968688965, 0.3023505210876465, 1.8505032062530518, 1.3479286432266235, 0.45284318923950195, 0.4661448001861572, 1.4785088300704956, 0.7118411064147949, 0.8156411647796631, 2.4803245067596436, 1.014962911605835, 1.2864060401916504, 1.4590139389038086], "mean_td_error": 1.1603745222091675, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 49.0, "diff_num_grad_updates_vs_sampler_policy": 48.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.139906883239746, "actor_loss": -9.406444549560547, "critic_loss": 0.26284635066986084, "alpha_loss": -0.14600560069084167, "alpha_value": 0.9857040643692017, "log_alpha_value": -0.014399106614291668, "target_entropy": -6.0, "policy_t": -0.0049460590817034245, "mean_q": 5.402183532714844, "max_q": 7.212566375732422, "min_q": 3.9283392429351807}, "td_error": [1.2767436504364014, 0.520413875579834, 0.09214282035827637, 0.8788816928863525, 0.2011716365814209, 0.6413989067077637, 1.8797216415405273, 0.7654500007629395, 0.6823700666427612, 0.2549397945404053, 1.396615982055664, 0.7548708915710449, 1.3326632976531982, 2.4306583404541016, 0.8172085285186768, 0.5613234043121338, 1.3532202243804932, 0.5809617042541504, 2.1006925106048584, 0.14883899688720703, 2.974468946456909, 0.5205435752868652, 1.5938513278961182, 0.6353189945220947, 1.2634854316711426, 0.1688833236694336, 0.08714437484741211, 1.7742133140563965, 1.6786601543426514, 0.9616279602050781, 0.39856183528900146, 1.664046287536621, 2.4989492893218994, 0.410555362701416, 0.6234958171844482, 1.4088635444641113, 1.0930430889129639, 1.45961332321167, 0.04771780967712402, 0.6757519245147705, 1.0785155296325684, 0.34864354133605957, 0.46573424339294434, 1.4418859481811523, 3.762148857116699, 0.5186464786529541, 0.26462888717651367, 2.1530537605285645, 0.13909554481506348, 0.4218618869781494, 3.458597421646118, 1.1887400150299072, 2.4133872985839844, 0.4747891426086426, 0.7073733806610107, 0.16200780868530273, 1.7401399612426758, 1.2395548820495605, 0.044690847396850586, 1.412557601928711, 1.5066444873809814, 0.972083568572998, 2.170347213745117, 0.46889567375183105, 0.48827672004699707, 1.1247851848602295, 1.446291208267212, 1.7871809005737305, 0.553126335144043, 0.08089089393615723, 0.19252347946166992, 2.070716142654419, 1.701874017715454, 0.3142244815826416, 2.8545069694519043, 3.832636594772339, 1.6586024761199951, 1.3543121814727783, 2.547382116317749, 0.23734259605407715, 0.8576922416687012, 0.9303867816925049, 0.7623512744903564, 1.628967046737671, 0.25507497787475586, 0.8920221328735352], "mean_td_error": 1.124817132949829, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 49.0, "diff_num_grad_updates_vs_sampler_policy": 48.0}}, "num_env_steps_sampled": 44800, "num_env_steps_trained": 12642, "num_agent_steps_sampled": 134400, "num_agent_steps_trained": 12642, "last_target_update_ts": 44800, "num_target_updates": 49}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 134400, "num_agent_steps_trained": 12642, "num_env_steps_sampled": 44800, "num_env_steps_trained": 12642, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 472.9652048498456, "num_env_steps_trained_throughput_per_sec": 136.18864157506715, "timesteps_total": 44800, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 134400, "timers": {"training_iteration_time_ms": 1891.847, "sample_time_ms": 1315.48, "load_time_ms": 0.532, "load_throughput": 484695.168, "learn_time_ms": 61.955, "learn_throughput": 4164.327, "synch_weights_time_ms": 15.347}, "counters": {"num_env_steps_sampled": 44800, "num_env_steps_trained": 12642, "num_agent_steps_sampled": 134400, "num_agent_steps_trained": 12642, "last_target_update_ts": 44800, "num_target_updates": 49}, "done": false, "episodes_total": 0, "training_iteration": 50, "trial_id": "566d8_00000", "date": "2023-11-16_22-21-59", "timestamp": 1700202119, "time_this_iter_s": 1.909893274307251, "time_total_s": 102.10211753845215, "pid": 48481, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fb763906a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 102.10211753845215, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 66.1, "ram_util_percent": 92.40000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.047235488891602, "actor_loss": -8.849432945251465, "critic_loss": 0.4881443381309509, "alpha_loss": -0.14773815870285034, "alpha_value": 0.9854032397270203, "log_alpha_value": -0.014704358763992786, "target_entropy": -6.0, "policy_t": 0.02248845063149929, "mean_q": 4.860710144042969, "max_q": 6.778327465057373, "min_q": 3.547475814819336}, "td_error": [1.4071521759033203, 0.40149807929992676, 3.930408000946045, 0.22268080711364746, 4.46327018737793, 0.10853290557861328, 0.6120283603668213, 1.3940436840057373, 2.3452916145324707, 1.985811710357666, 1.535388469696045, 1.6913564205169678, 2.6819872856140137, 0.42392444610595703, 1.1578090190887451, 2.1814918518066406, 0.54891037940979, 0.8422980308532715, 0.8770217895507812, 1.8168022632598877, 0.6482555866241455, 0.13389825820922852, 0.2821991443634033, 3.195117235183716, 3.113152503967285, 1.64058256149292, 0.8762664794921875, 1.892887830734253, 0.20261645317077637, 0.11383986473083496, 0.9383549690246582, 2.4494314193725586, 1.6533071994781494, 1.4996461868286133, 2.570499897003174, 0.21792030334472656, 0.974855899810791, 2.056216239929199, 1.3408315181732178, 2.5194461345672607, 2.0871152877807617, 0.6522825956344604, 0.1791849136352539, 0.6313431262969971, 0.9921293258666992, 1.0589618682861328, 0.7727997303009033, 0.6368687152862549, 3.4616875648498535, 1.4404919147491455, 0.3888683319091797, 2.0362954139709473, 1.949278712272644, 0.871638298034668, 2.6744675636291504, 0.6618804931640625, 1.8029494285583496, 0.06360602378845215, 0.313671350479126, 1.2962419986724854, 0.3703315258026123, 0.7577600479125977, 3.071990489959717, 1.4466137886047363, 1.3376951217651367, 0.9239941835403442, 1.6545495986938477, 1.3580045700073242, 1.1263673305511475, 0.6335961818695068, 4.560600757598877, 1.3607878684997559, 2.754403829574585, 1.0940899848937988, 3.4984562397003174, 0.35405611991882324, 2.052281379699707, 1.8268632888793945, 0.23694145679473877, 0.20198488235473633, 0.039498090744018555, 3.0524628162384033, 2.9700536727905273, 0.16686224937438965, 0.9812581539154053, 1.910625696182251], "mean_td_error": 1.4262897968292236, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 50.0, "diff_num_grad_updates_vs_sampler_policy": 49.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.113151550292969, "actor_loss": -8.951217651367188, "critic_loss": 0.34275853633880615, "alpha_loss": -0.1487666815519333, "alpha_value": 0.985397458076477, "log_alpha_value": -0.014710220508277416, "target_entropy": -6.0, "policy_t": 0.018707266077399254, "mean_q": 4.944578170776367, "max_q": 6.728696346282959, "min_q": 3.5851378440856934}, "td_error": [0.2925368547439575, 2.7149949073791504, 0.36972975730895996, 1.7964119911193848, 1.3816416263580322, 1.2502307891845703, 2.463350296020508, 0.8852031230926514, 0.356781005859375, 0.9189944267272949, 0.4909322261810303, 0.1875782012939453, 0.8242948055267334, 1.8567514419555664, 0.270449161529541, 1.2457678318023682, 0.8000943660736084, 1.7451910972595215, 1.4842982292175293, 1.6471421718597412, 1.8931529521942139, 0.23901915550231934, 0.5672473907470703, 0.524641752243042, 1.047559142112732, 0.3718688488006592, 1.126291275024414, 2.9907219409942627, 0.8049767017364502, 0.9188985824584961, 0.15740251541137695, 4.079502105712891, 2.1824474334716797, 1.8024415969848633, 1.0863535404205322, 2.982003927230835, 0.41568732261657715, 1.2982463836669922, 0.9877585172653198, 0.4525916576385498, 0.5704386234283447, 0.9753954410552979, 1.086613655090332, 0.6328952312469482, 1.992654800415039, 1.2137751579284668, 0.5932743549346924, 0.10220146179199219, 0.2820436954498291, 2.8911406993865967, 2.3736562728881836, 1.2383935451507568, 2.024285316467285, 0.36146068572998047, 0.5280686616897583, 0.6997730731964111, 1.9411036968231201, 0.3020796775817871, 1.5878288745880127, 1.154407262802124, 2.028013229370117, 0.10874223709106445, 0.1356196403503418, 0.38990068435668945, 1.4702942371368408, 0.40669894218444824, 2.55450701713562, 3.535360336303711, 0.3816859722137451, 1.3666632175445557, 1.051408052444458, 0.45174527168273926, 0.5101501941680908, 0.18077754974365234, 2.6992738246917725, 2.164560317993164, 1.0711910724639893, 1.154921054840088, 1.3201243877410889, 2.755526065826416, 0.0975656509399414, 4.8844099044799805, 0.6749124526977539, 0.5883092880249023, 0.7421314716339111, 1.8666794300079346], "mean_td_error": 1.2331843376159668, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 50.0, "diff_num_grad_updates_vs_sampler_policy": 49.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.097103118896484, "actor_loss": -9.476960182189941, "critic_loss": 0.31035324931144714, "alpha_loss": -0.14841949939727783, "alpha_value": 0.9854083061218262, "log_alpha_value": -0.01469921600073576, "target_entropy": -6.0, "policy_t": 0.009794062003493309, "mean_q": 5.573790550231934, "max_q": 7.619782447814941, "min_q": 3.8692917823791504}, "td_error": [0.8717710971832275, 1.9182722568511963, 0.9421663284301758, 2.0063250064849854, 0.7267990112304688, 1.7068967819213867, 0.4289271831512451, 2.1937079429626465, 0.1585092544555664, 1.55265474319458, 2.4204907417297363, 0.2891840934753418, 1.932269811630249, 1.636014461517334, 1.6269190311431885, 1.9585332870483398, 2.812565565109253, 0.2667398452758789, 1.5026381015777588, 0.9935803413391113, 0.6907482147216797, 1.1397910118103027, 0.1632225513458252, 2.152658462524414, 1.0106487274169922, 1.4365315437316895, 0.2336432933807373, 1.386916160583496, 0.9028677940368652, 0.39440417289733887, 1.1435983180999756, 0.24013590812683105, 0.8071880340576172, 1.6572327613830566, 4.296649932861328, 4.692633152008057, 0.9568333625793457, 1.5613908767700195, 1.3001627922058105, 0.7426784038543701, 0.36819911003112793, 1.666332721710205, 0.9541969299316406, 0.6644222736358643, 1.9504945278167725, 0.7806458473205566, 0.7358436584472656, 0.25389528274536133, 1.230628490447998, 0.5750482082366943, 1.6989703178405762, 0.417705774307251, 0.24676513671875, 1.671342372894287, 0.42406487464904785, 0.9945518970489502, 3.833590507507324, 1.3801748752593994, 1.9797077178955078, 0.5849881172180176, 3.62324595451355, 2.57129168510437, 0.4700169563293457, 2.40964674949646, 0.5624189376831055, 2.3036727905273438, 0.47185659408569336, 0.24237751960754395, 3.1725850105285645, 0.21264123916625977, 0.5023589134216309, 0.37539005279541016, 0.8741476535797119, 0.0613710880279541, 2.1071696281433105, 0.8452379703521729, 1.478041648864746, 1.7382218837738037, 0.14605212211608887, 0.5379307270050049, 2.3423948287963867, 1.7411651611328125, 2.138766288757324, 0.7485408782958984, 0.6175777912139893, 0.34420156478881836], "mean_td_error": 1.2779626846313477, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 50.0, "diff_num_grad_updates_vs_sampler_policy": 49.0}}, "num_env_steps_sampled": 45696, "num_env_steps_trained": 12900, "num_agent_steps_sampled": 137088, "num_agent_steps_trained": 12900, "last_target_update_ts": 45696, "num_target_updates": 50}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 137088, "num_agent_steps_trained": 12900, "num_env_steps_sampled": 45696, "num_env_steps_trained": 12900, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 366.85274519957966, "num_env_steps_trained_throughput_per_sec": 105.63393779184325, "timesteps_total": 45696, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 137088, "timers": {"training_iteration_time_ms": 1945.656, "sample_time_ms": 1335.83, "load_time_ms": 0.531, "load_throughput": 485870.345, "learn_time_ms": 62.018, "learn_throughput": 4160.106, "synch_weights_time_ms": 15.7}, "counters": {"num_env_steps_sampled": 45696, "num_env_steps_trained": 12900, "num_agent_steps_sampled": 137088, "num_agent_steps_trained": 12900, "last_target_update_ts": 45696, "num_target_updates": 50}, "done": false, "episodes_total": 0, "training_iteration": 51, "trial_id": "566d8_00000", "date": "2023-11-16_22-22-02", "timestamp": 1700202122, "time_this_iter_s": 2.4554319381713867, "time_total_s": 104.55754947662354, "pid": 48481, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fb780e7f0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 104.55754947662354, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 59.675000000000004, "ram_util_percent": 92.55}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.08893871307373, "actor_loss": -9.08480167388916, "critic_loss": 0.3642856180667877, "alpha_loss": -0.15137426555156708, "alpha_value": 0.9851080179214478, "log_alpha_value": -0.015003982000052929, "target_entropy": -6.0, "policy_t": -0.01395449973642826, "mean_q": 5.023193836212158, "max_q": 6.710597038269043, "min_q": 3.8777551651000977}, "td_error": [3.0755839347839355, 1.326108694076538, 1.5342602729797363, 1.4391155242919922, 0.2756359577178955, 1.4899342060089111, 0.4098491668701172, 0.3813333511352539, 0.40059947967529297, 1.0205726623535156, 0.2583768367767334, 1.3727564811706543, 1.141017198562622, 2.475921154022217, 1.2847177982330322, 1.1010866165161133, 5.269869327545166, 1.5452618598937988, 2.943436622619629, 0.5013632774353027, 0.3497333526611328, 0.9986536502838135, 0.3423271179199219, 0.6273140907287598, 0.8179078102111816, 1.5450778007507324, 0.5179610252380371, 2.38095760345459, 1.8839499950408936, 0.6385047435760498, 0.5179803371429443, 1.8949253559112549, 0.20770549774169922, 3.302825450897217, 2.1372876167297363, 0.20439791679382324, 0.7623207569122314, 1.6877641677856445, 0.23224925994873047, 0.7621028423309326, 1.9144322872161865, 0.6516866683959961, 1.3359904289245605, 0.4352686405181885, 0.3213083744049072, 2.601766347885132, 1.1713919639587402, 1.8235759735107422, 0.3908731937408447, 2.0684027671813965, 0.5859761238098145, 2.435591459274292, 0.9074485301971436, 0.9044675827026367, 2.657759428024292, 1.669114351272583, 0.18589544296264648, 1.5467162132263184, 2.6336288452148438, 1.9007964134216309, 1.1097726821899414, 1.6759943962097168, 0.2762491703033447, 1.179875373840332, 0.10616135597229004, 0.8057422637939453, 1.5922205448150635, 0.9683423042297363, 1.0725045204162598, 1.0119905471801758, 3.202301025390625, 0.6078188419342041, 0.555988073348999, 0.163252592086792, 0.17483305931091309, 2.952565908432007, 0.07959842681884766, 1.0304309129714966, 2.2165567874908447, 2.1090240478515625, 1.2113170623779297, 0.789776086807251, 1.6808056831359863, 0.62587571144104, 2.0480408668518066, 1.9829676151275635], "mean_td_error": 1.284079670906067, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 51.0, "diff_num_grad_updates_vs_sampler_policy": 50.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.037538528442383, "actor_loss": -9.022736549377441, "critic_loss": 0.2841276526451111, "alpha_loss": -0.15066789090633392, "alpha_value": 0.9851016402244568, "log_alpha_value": -0.015010442584753036, "target_entropy": -6.0, "policy_t": 0.041327573359012604, "mean_q": 5.042884826660156, "max_q": 6.650804042816162, "min_q": 3.782895088195801}, "td_error": [0.6987013816833496, 3.135956048965454, 1.2691943645477295, 0.3815114498138428, 1.560779094696045, 0.21305596828460693, 0.6381978988647461, 0.9849965572357178, 0.4729948043823242, 0.35540032386779785, 1.52899169921875, 1.8731658458709717, 0.20106589794158936, 0.8063719272613525, 0.03798246383666992, 0.17639923095703125, 1.917663335800171, 2.833195924758911, 0.6850357055664062, 0.7420406341552734, 1.5121212005615234, 0.5398082733154297, 0.4009735584259033, 1.785332441329956, 0.8063347339630127, 0.2860682010650635, 3.0386104583740234, 1.3091392517089844, 0.5574820041656494, 0.04702258110046387, 2.5909199714660645, 2.516890525817871, 1.2648601531982422, 0.5913288593292236, 0.24738597869873047, 0.5777468681335449, 2.3833887577056885, 0.6832194328308105, 0.3379030227661133, 0.5766582489013672, 0.18979549407958984, 0.7395632266998291, 1.144862413406372, 1.2507634162902832, 0.6828674077987671, 1.7860193252563477, 1.0591306686401367, 0.9283237457275391, 0.35320234298706055, 1.1786651611328125, 2.074009418487549, 0.4031801223754883, 0.24295258522033691, 1.0271613597869873, 0.37953829765319824, 0.2568166255950928, 2.4738903045654297, 2.129220724105835, 0.32180023193359375, 2.4183297157287598, 2.3328969478607178, 0.2754538059234619, 0.4037303924560547, 0.8672974109649658, 0.5190441608428955, 2.473210573196411, 0.5556879043579102, 1.4351346492767334, 1.4372777938842773, 1.8724365234375, 0.765836238861084, 0.5492513179779053, 0.11361241340637207, 0.9603404998779297, 0.8639779090881348, 1.60125732421875, 3.1028761863708496, 0.8865392208099365, 0.6910078525543213, 1.2478969097137451, 0.7583472728729248, 0.6242985725402832, 0.8960931301116943, 0.04832768440246582, 0.877971887588501, 2.4517335891723633], "mean_td_error": 1.0722968578338623, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 51.0, "diff_num_grad_updates_vs_sampler_policy": 50.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.04019832611084, "actor_loss": -9.454509735107422, "critic_loss": 0.3522021770477295, "alpha_loss": -0.15059633553028107, "alpha_value": 0.9851126074790955, "log_alpha_value": -0.014999338425695896, "target_entropy": -6.0, "policy_t": -0.009343529120087624, "mean_q": 5.503945827484131, "max_q": 7.703625202178955, "min_q": 3.9693500995635986}, "td_error": [0.30915987491607666, 2.223289728164673, 1.2077701091766357, 0.7668540477752686, 2.7292473316192627, 0.3061068058013916, 2.6635982990264893, 0.4501678943634033, 1.4437122344970703, 1.4596376419067383, 0.08321356773376465, 1.4059820175170898, 0.8584098815917969, 0.3761172294616699, 1.5864617824554443, 1.7557380199432373, 0.5910189151763916, 0.4805757999420166, 0.27925968170166016, 0.8459250926971436, 1.635347604751587, 1.3786964416503906, 0.5828418731689453, 3.1685702800750732, 2.309300184249878, 0.3753631114959717, 4.797035217285156, 0.6875534057617188, 2.594130754470825, 0.5306861400604248, 0.9443192481994629, 1.1322510242462158, 3.4572012424468994, 2.0129833221435547, 0.1362004280090332, 3.4830942153930664, 2.6482503414154053, 2.2842764854431152, 1.548905372619629, 0.3281998634338379, 0.344287633895874, 0.2234203815460205, 0.618720531463623, 3.0301241874694824, 0.22398114204406738, 2.1372768878936768, 0.4715549945831299, 3.7813146114349365, 3.3314144611358643, 0.417264461517334, 1.2168605327606201, 2.3409056663513184, 1.0000696182250977, 0.2107231616973877, 1.1116533279418945, 0.33103299140930176, 0.2453010082244873, 0.17470383644104004, 0.4807472229003906, 0.8905696868896484, 0.7583224773406982, 1.0580244064331055, 1.8109805583953857, 2.0423824787139893, 0.8075144290924072, 0.48070836067199707, 4.823748588562012, 0.15844464302062988, 0.5812456607818604, 1.9849426746368408, 0.20476841926574707, 0.3274585008621216, 0.1754748821258545, 4.663848876953125, 2.6513187885284424, 1.4935381412506104, 0.5825116634368896, 1.488342523574829, 0.7977509498596191, 5.641123294830322, 0.8257029056549072, 2.99847674369812, 0.4696187973022461, 0.40316081047058105, 1.822469711303711, 0.575498104095459], "mean_td_error": 1.396125078201294, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 51.0, "diff_num_grad_updates_vs_sampler_policy": 50.0}}, "num_env_steps_sampled": 46592, "num_env_steps_trained": 13158, "num_agent_steps_sampled": 139776, "num_agent_steps_trained": 13158, "last_target_update_ts": 46592, "num_target_updates": 51}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 139776, "num_agent_steps_trained": 13158, "num_env_steps_sampled": 46592, "num_env_steps_trained": 13158, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 479.14105446322213, "num_env_steps_trained_throughput_per_sec": 137.96695541463316, "timesteps_total": 46592, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 139776, "timers": {"training_iteration_time_ms": 1938.004, "sample_time_ms": 1327.423, "load_time_ms": 0.53, "load_throughput": 486438.206, "learn_time_ms": 61.974, "learn_throughput": 4163.025, "synch_weights_time_ms": 15.803}, "counters": {"num_env_steps_sampled": 46592, "num_env_steps_trained": 13158, "num_agent_steps_sampled": 139776, "num_agent_steps_trained": 13158, "last_target_update_ts": 46592, "num_target_updates": 51}, "done": false, "episodes_total": 0, "training_iteration": 52, "trial_id": "566d8_00000", "date": "2023-11-16_22-22-04", "timestamp": 1700202124, "time_this_iter_s": 1.8863649368286133, "time_total_s": 106.44391441345215, "pid": 48481, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fb7906b0940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 106.44391441345215, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 85.8, "ram_util_percent": 92.55}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.978567123413086, "actor_loss": -9.300743103027344, "critic_loss": 0.3310769200325012, "alpha_loss": -0.152708500623703, "alpha_value": 0.98481285572052, "log_alpha_value": -0.015303650870919228, "target_entropy": -6.0, "policy_t": -0.02867397665977478, "mean_q": 5.311822414398193, "max_q": 6.725555419921875, "min_q": 3.920267105102539}, "td_error": [0.7964639663696289, 1.708338737487793, 0.23050570487976074, 0.5945394039154053, 0.5470964908599854, 2.1683764457702637, 1.453705072402954, 1.2332909107208252, 1.240846872329712, 0.6073246002197266, 1.95839524269104, 1.0217666625976562, 1.6842560768127441, 0.38791561126708984, 2.786834716796875, 1.911952018737793, 0.29761552810668945, 2.5550403594970703, 1.3428256511688232, 0.4595983028411865, 0.415130615234375, 0.29410362243652344, 0.5340642929077148, 1.0023465156555176, 0.07235264778137207, 2.1771373748779297, 3.5885796546936035, 0.7538716793060303, 0.3879578113555908, 2.533259391784668, 0.1324305534362793, 4.664507865905762, 0.7024173736572266, 1.3890087604522705, 0.5254874229431152, 1.576683759689331, 2.0807294845581055, 0.8491382598876953, 1.3307721614837646, 1.523270606994629, 1.4266831874847412, 0.27402710914611816, 2.0775797367095947, 0.73618483543396, 0.363924503326416, 1.8777668476104736, 0.557020902633667, 0.9820330142974854, 0.1834268569946289, 0.46152758598327637, 0.20748257637023926, 3.9065752029418945, 0.5072557926177979, 0.386091947555542, 1.1500418186187744, 1.9930849075317383, 0.289628267288208, 0.3238399028778076, 0.48091840744018555, 0.6532402038574219, 0.5589625835418701, 0.5474107265472412, 0.5363953113555908, 0.6201975345611572, 3.587348461151123, 0.8194239139556885, 3.0217244625091553, 0.8016910552978516, 2.201293468475342, 0.10269403457641602, 2.0190742015838623, 0.14734625816345215, 0.7592990398406982, 1.839836597442627, 2.434600591659546, 0.8678829669952393, 1.233649492263794, 1.0148367881774902, 0.4970541000366211, 0.6918823719024658, 0.12052106857299805, 1.4478867053985596, 0.3543269634246826, 1.4569523334503174, 0.9554290771484375, 0.4537789821624756], "mean_td_error": 1.1563926935195923, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 52.0, "diff_num_grad_updates_vs_sampler_policy": 51.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.078853607177734, "actor_loss": -9.230527877807617, "critic_loss": 0.3728623390197754, "alpha_loss": -0.15431270003318787, "alpha_value": 0.9848060607910156, "log_alpha_value": -0.015310538932681084, "target_entropy": -6.0, "policy_t": -0.025752970948815346, "mean_q": 5.1741204261779785, "max_q": 7.085902690887451, "min_q": 3.6354258060455322}, "td_error": [0.3164992332458496, 1.1613633632659912, 1.640648603439331, 3.495570421218872, 1.8878443241119385, 1.0855216979980469, 0.2377305030822754, 0.2950904369354248, 2.2685048580169678, 0.08763623237609863, 1.4352009296417236, 1.006310224533081, 1.792708396911621, 1.4039273262023926, 1.4052670001983643, 1.3483610153198242, 3.323819398880005, 0.6412456035614014, 1.6889750957489014, 2.6082379817962646, 0.5639662742614746, 1.9884295463562012, 0.39090847969055176, 0.9384722709655762, 0.9940392971038818, 0.5382499694824219, 0.6008186340332031, 0.18261933326721191, 0.37641239166259766, 3.0671088695526123, 0.93829345703125, 1.2870094776153564, 1.2297041416168213, 0.9035220146179199, 1.01409912109375, 0.0854940414428711, 0.8721866607666016, 0.6333866119384766, 2.5502259731292725, 0.6700789928436279, 0.5612242221832275, 2.580552577972412, 0.17633986473083496, 0.6844701766967773, 1.244248628616333, 3.0615618228912354, 0.9275248050689697, 0.2030731439590454, 0.6120560169219971, 0.44716930389404297, 0.7100377082824707, 0.39966297149658203, 4.976078987121582, 0.6957132816314697, 2.3812057971954346, 4.42008638381958, 1.3020044565200806, 1.2986042499542236, 0.5219616889953613, 1.2152361869812012, 1.6339163780212402, 0.9482426643371582, 1.173210620880127, 1.142730474472046, 1.320676326751709, 2.8627548217773438, 0.8459134101867676, 1.9174480438232422, 1.40702486038208, 2.6640214920043945, 1.064574956893921, 1.802931547164917, 0.17679929733276367, 0.24754619598388672, 2.0908725261688232, 1.8002371788024902, 1.9296321868896484, 0.2807025909423828, 1.539823055267334, 1.2069668769836426, 0.9287552833557129, 1.3082866668701172, 0.804987907409668, 2.4339752197265625, 0.6138408184051514, 2.160270929336548], "mean_td_error": 1.3218655586242676, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 52.0, "diff_num_grad_updates_vs_sampler_policy": 51.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.074594497680664, "actor_loss": -9.572267532348633, "critic_loss": 0.37759503722190857, "alpha_loss": -0.1541346162557602, "alpha_value": 0.9848170876502991, "log_alpha_value": -0.015299336053431034, "target_entropy": -6.0, "policy_t": -0.029488829895853996, "mean_q": 5.591014385223389, "max_q": 7.816922187805176, "min_q": 3.93624210357666}, "td_error": [3.2977402210235596, 0.4001302719116211, 0.9209785461425781, 1.2998054027557373, 2.0867037773132324, 0.23858356475830078, 0.4759480953216553, 3.500392198562622, 0.1349320411682129, 2.725297689437866, 5.729811191558838, 1.1136631965637207, 0.2022111415863037, 2.962613344192505, 4.012704849243164, 0.7505176067352295, 1.404968023300171, 4.534051895141602, 2.0679662227630615, 2.3405354022979736, 0.9517858028411865, 1.8331232070922852, 1.054210901260376, 0.19462847709655762, 0.45931482315063477, 1.4229700565338135, 0.43966126441955566, 0.20069217681884766, 0.3673725128173828, 1.7060377597808838, 0.1982424259185791, 1.9647047519683838, 0.18320822715759277, 0.6124680042266846, 0.926624059677124, 2.5103166103363037, 2.47627592086792, 0.4944570064544678, 0.7933638095855713, 0.8102643489837646, 1.2464804649353027, 2.6138904094696045, 1.7309093475341797, 1.0307426452636719, 0.1313920021057129, 0.5139129161834717, 2.7167108058929443, 1.0312690734863281, 0.22941851615905762, 1.039839267730713, 2.4700067043304443, 1.6071627140045166, 1.5886337757110596, 1.6652681827545166, 0.14799857139587402, 0.7226786613464355, 2.023756742477417, 2.1555967330932617, 0.48099732398986816, 1.5853564739227295, 3.5907857418060303, 0.45879554748535156, 2.5167782306671143, 2.2065508365631104, 2.90637469291687, 0.8003592491149902, 2.783590078353882, 0.4528923034667969, 1.4231703281402588, 1.4345486164093018, 2.596829652786255, 0.9752819538116455, 1.6995298862457275, 0.7093496322631836, 2.624617099761963, 0.01972484588623047, 3.1362154483795166, 1.8996572494506836, 0.33991479873657227, 0.5725162029266357, 0.3533341884613037, 1.0323901176452637, 2.635190725326538, 0.26216554641723633, 0.21196985244750977, 1.8158104419708252], "mean_td_error": 1.4649959802627563, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 52.0, "diff_num_grad_updates_vs_sampler_policy": 51.0}}, "num_env_steps_sampled": 47488, "num_env_steps_trained": 13416, "num_agent_steps_sampled": 142464, "num_agent_steps_trained": 13416, "last_target_update_ts": 47488, "num_target_updates": 52}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 142464, "num_agent_steps_trained": 13416, "num_env_steps_sampled": 47488, "num_env_steps_trained": 13416, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 467.35133298662174, "num_env_steps_trained_throughput_per_sec": 134.5721472215942, "timesteps_total": 47488, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 142464, "timers": {"training_iteration_time_ms": 1940.601, "sample_time_ms": 1329.386, "load_time_ms": 0.53, "load_throughput": 486372.615, "learn_time_ms": 62.089, "learn_throughput": 4155.301, "synch_weights_time_ms": 15.829}, "counters": {"num_env_steps_sampled": 47488, "num_env_steps_trained": 13416, "num_agent_steps_sampled": 142464, "num_agent_steps_trained": 13416, "last_target_update_ts": 47488, "num_target_updates": 52}, "done": false, "episodes_total": 0, "training_iteration": 53, "trial_id": "566d8_00000", "date": "2023-11-16_22-22-06", "timestamp": 1700202126, "time_this_iter_s": 1.9349610805511475, "time_total_s": 108.3788754940033, "pid": 48481, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fb763906a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 108.3788754940033, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 66.16666666666667, "ram_util_percent": 92.36666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.088617324829102, "actor_loss": -9.579206466674805, "critic_loss": 0.4904172420501709, "alpha_loss": -0.15741363167762756, "alpha_value": 0.9845179915428162, "log_alpha_value": -0.015603095293045044, "target_entropy": -6.0, "policy_t": 0.031298838555812836, "mean_q": 5.543712139129639, "max_q": 7.851365089416504, "min_q": 3.767256259918213}, "td_error": [1.371074914932251, 3.04728102684021, 1.4604558944702148, 2.135796546936035, 2.2910923957824707, 0.7296748161315918, 4.411614418029785, 3.9288597106933594, 0.7756209373474121, 2.1068472862243652, 0.8267874717712402, 1.5933899879455566, 1.0377440452575684, 0.9280338287353516, 2.9660425186157227, 2.049659013748169, 1.956458568572998, 0.6948790550231934, 0.4018096923828125, 1.4176087379455566, 4.249495983123779, 2.161383628845215, 0.5595684051513672, 0.795508623123169, 1.2479510307312012, 0.23816728591918945, 2.1631522178649902, 1.2640202045440674, 0.852276086807251, 1.3813836574554443, 2.172671318054199, 0.9479868412017822, 0.3032200336456299, 0.44464707374572754, 0.3482847213745117, 1.1994123458862305, 0.23517751693725586, 0.9988229274749756, 1.4649837017059326, 0.052736759185791016, 4.2662529945373535, 3.858999729156494, 1.5358779430389404, 0.26392078399658203, 1.1008069515228271, 0.6872618198394775, 0.6122055053710938, 2.8752341270446777, 0.6044995784759521, 0.5355169773101807, 2.1892194747924805, 2.2239603996276855, 0.3844454288482666, 2.47573184967041, 2.6820454597473145, 4.095346450805664, 0.5265722274780273, 1.8954265117645264, 2.9578468799591064, 0.9062998294830322, 1.6547024250030518, 1.0651311874389648, 0.06299400329589844, 2.8870770931243896, 2.26110577583313, 1.7836027145385742, 1.6064872741699219, 0.6231987476348877, 0.9335222244262695, 1.020460844039917, 1.28550124168396, 0.21257257461547852, 2.160372257232666, 0.5682127475738525, 0.6244344711303711, 1.7984530925750732, 1.5789616107940674, 1.7991127967834473, 0.9236741065979004, 0.5301828384399414, 0.7254543304443359, 3.6981418132781982, 2.368163585662842, 0.45269155502319336, 1.2686426639556885, 1.2059943675994873], "mean_td_error": 1.5231151580810547, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 53.0, "diff_num_grad_updates_vs_sampler_policy": 52.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.082891464233398, "actor_loss": -9.349407196044922, "critic_loss": 0.408332884311676, "alpha_loss": -0.1574002057313919, "alpha_value": 0.984510600566864, "log_alpha_value": -0.015610622242093086, "target_entropy": -6.0, "policy_t": -0.01343613862991333, "mean_q": 5.364035606384277, "max_q": 7.043883800506592, "min_q": 4.106205940246582}, "td_error": [0.5931284427642822, 2.987761974334717, 2.20906925201416, 0.8634564876556396, 4.125432968139648, 2.7812540531158447, 0.19814419746398926, 2.457566022872925, 0.9045681953430176, 2.4737136363983154, 3.65132212638855, 0.15067267417907715, 1.6104350090026855, 3.341332197189331, 0.5562858581542969, 0.240403413772583, 1.4364306926727295, 3.0018277168273926, 1.8647606372833252, 1.9549355506896973, 0.6194961071014404, 1.315420389175415, 0.8287439346313477, 0.8924548625946045, 0.90157151222229, 1.1113841533660889, 0.6628439426422119, 0.9050843715667725, 1.4136102199554443, 2.937046766281128, 0.3858010768890381, 1.677124261856079, 0.8043491840362549, 0.9474751949310303, 0.804394006729126, 2.5127720832824707, 3.3108134269714355, 0.9275968074798584, 0.6229896545410156, 1.8128371238708496, 0.20318150520324707, 3.667994976043701, 0.13689422607421875, 0.5475282669067383, 2.1699273586273193, 1.27089524269104, 2.0149407386779785, 3.1880624294281006, 1.2909464836120605, 0.3688209056854248, 0.9613668918609619, 0.835679292678833, 0.8737306594848633, 0.591015100479126, 1.2154114246368408, 2.8402774333953857, 0.9264662265777588, 0.7573816776275635, 0.7384297847747803, 1.0756523609161377, 0.5849001407623291, 1.4353840351104736, 1.038416862487793, 1.2765119075775146, 1.1913585662841797, 3.3419570922851562, 0.9233207702636719, 0.2670633792877197, 0.20496201515197754, 1.162355661392212, 2.553206443786621, 0.3812122344970703, 4.687487602233887, 1.3610880374908447, 0.19690275192260742, 2.1824536323547363, 1.9361531734466553, 0.4141993522644043, 2.0259406566619873, 1.7523269653320312, 0.520057201385498, 1.702038049697876, 0.3729994297027588, 0.17637419700622559, 1.9335415363311768, 0.1534113883972168], "mean_td_error": 1.421471357345581, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 53.0, "diff_num_grad_updates_vs_sampler_policy": 52.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.068222045898438, "actor_loss": -9.70665168762207, "critic_loss": 0.3233914375305176, "alpha_loss": -0.1570572555065155, "alpha_value": 0.984521746635437, "log_alpha_value": -0.015599304810166359, "target_entropy": -6.0, "policy_t": 0.00463413679972291, "mean_q": 5.812418460845947, "max_q": 7.622890472412109, "min_q": 4.237695693969727}, "td_error": [3.3766822814941406, 0.9882957935333252, 0.4846043586730957, 0.7526826858520508, 1.5884406566619873, 0.2574317455291748, 0.26174354553222656, 2.901646137237549, 0.9940590858459473, 0.26425790786743164, 0.9352371692657471, 3.512812614440918, 1.25655198097229, 0.36460232734680176, 0.7217092514038086, 1.0695302486419678, 0.48456645011901855, 0.6683402061462402, 1.9828038215637207, 4.3448805809021, 0.46506500244140625, 0.9202213287353516, 4.015641212463379, 1.1128127574920654, 1.432931661605835, 2.0458383560180664, 0.7203130722045898, 0.8459806442260742, 0.9357426166534424, 0.20186066627502441, 1.725698709487915, 0.16523170471191406, 0.8893032073974609, 1.1226770877838135, 2.5376977920532227, 4.235043525695801, 0.15218424797058105, 1.9806714057922363, 2.0833537578582764, 1.3517112731933594, 0.8244941234588623, 2.7357606887817383, 2.986124038696289, 0.5644609928131104, 2.3112590312957764, 1.9654321670532227, 0.6911120414733887, 1.2993395328521729, 2.2125813961029053, 2.1917405128479004, 3.0920627117156982, 0.22698521614074707, 1.74812650680542, 0.27303266525268555, 0.5797674655914307, 1.2288744449615479, 0.49367451667785645, 0.08736729621887207, 2.033250331878662, 0.9614379405975342, 0.24666666984558105, 0.4219021797180176, 0.5427429676055908, 1.05153226852417, 1.6313529014587402, 1.7711608409881592, 1.5770962238311768, 0.8617112636566162, 2.212109327316284, 1.110297441482544, 2.653066635131836, 0.3394782543182373, 0.4001948833465576, 1.0399041175842285, 1.3281583786010742, 2.522113561630249, 1.8921301364898682, 1.5853757858276367, 0.08971571922302246, 0.16791319847106934, 0.04917311668395996, 0.4355344772338867, 1.5747332572937012, 0.682835578918457, 0.3069140911102295, 1.359210729598999], "mean_td_error": 1.3082647323608398, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 53.0, "diff_num_grad_updates_vs_sampler_policy": 52.0}}, "num_env_steps_sampled": 48384, "num_env_steps_trained": 13674, "num_agent_steps_sampled": 145152, "num_agent_steps_trained": 13674, "last_target_update_ts": 48384, "num_target_updates": 53}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 145152, "num_agent_steps_trained": 13674, "num_env_steps_sampled": 48384, "num_env_steps_trained": 13674, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 468.07288995836274, "num_env_steps_trained_throughput_per_sec": 134.77991697461786, "timesteps_total": 48384, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 145152, "timers": {"training_iteration_time_ms": 1941.799, "sample_time_ms": 1330.226, "load_time_ms": 0.53, "load_throughput": 486919.741, "learn_time_ms": 62.191, "learn_throughput": 4148.513, "synch_weights_time_ms": 15.716}, "counters": {"num_env_steps_sampled": 48384, "num_env_steps_trained": 13674, "num_agent_steps_sampled": 145152, "num_agent_steps_trained": 13674, "last_target_update_ts": 48384, "num_target_updates": 53}, "done": false, "episodes_total": 0, "training_iteration": 54, "trial_id": "566d8_00000", "date": "2023-11-16_22-22-08", "timestamp": 1700202128, "time_this_iter_s": 1.9309141635894775, "time_total_s": 110.30978965759277, "pid": 48481, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fb780e7f430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 110.30978965759277, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 65.93333333333332, "ram_util_percent": 92.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.016358375549316, "actor_loss": -9.779772758483887, "critic_loss": 0.4266803562641144, "alpha_loss": -0.159286230802536, "alpha_value": 0.9842231869697571, "log_alpha_value": -0.015902608633041382, "target_entropy": -6.0, "policy_t": 0.015053682960569859, "mean_q": 5.77994966506958, "max_q": 8.444172859191895, "min_q": 4.216249942779541}, "td_error": [2.1274569034576416, 0.7083580493927002, 1.0262267589569092, 0.3264274597167969, 0.15599584579467773, 1.4482669830322266, 0.3159949779510498, 0.32135772705078125, 2.461148500442505, 0.5131311416625977, 0.29150819778442383, 0.21880459785461426, 0.3124990463256836, 2.155158758163452, 0.48282718658447266, 1.1296496391296387, 0.9416837692260742, 2.8393969535827637, 1.4823806285858154, 2.0197572708129883, 1.6753811836242676, 0.3760502338409424, 0.9224843978881836, 2.4563755989074707, 2.6966283321380615, 0.29880213737487793, 0.710503339767456, 0.4675304889678955, 0.9409847259521484, 1.8183026313781738, 0.13169407844543457, 0.9533467292785645, 1.1019372940063477, 0.8560268878936768, 1.9197659492492676, 0.4985828399658203, 0.355393648147583, 1.159271240234375, 0.688284158706665, 0.38718557357788086, 2.455996036529541, 0.3357100486755371, 2.3292794227600098, 1.8139979839324951, 3.526597499847412, 1.1588165760040283, 0.42366743087768555, 1.3091230392456055, 0.8977665901184082, 4.136711597442627, 1.120419979095459, 0.7965197563171387, 0.29189348220825195, 2.1017847061157227, 0.37775731086730957, 0.7463431358337402, 2.0056326389312744, 1.8493926525115967, 0.7954201698303223, 1.6868364810943604, 3.2860891819000244, 6.019392967224121, 1.0649065971374512, 0.9404711723327637, 0.24903082847595215, 0.32173609733581543, 1.4268372058868408, 0.3140604496002197, 0.7286460399627686, 4.575257301330566, 0.07393622398376465, 3.3795549869537354, 1.6378962993621826, 2.322308301925659, 0.4057142734527588, 0.9430782794952393, 1.8972158432006836, 5.769933223724365, 2.4395205974578857, 0.41347718238830566, 1.823216438293457, 2.501207113265991, 1.3272497653961182, 1.118680715560913, 0.3187999725341797, 0.21855497360229492], "mean_td_error": 1.3647558689117432, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 54.0, "diff_num_grad_updates_vs_sampler_policy": 53.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.111878395080566, "actor_loss": -9.471491813659668, "critic_loss": 0.34201377630233765, "alpha_loss": -0.16088709235191345, "alpha_value": 0.9842151999473572, "log_alpha_value": -0.01591070368885994, "target_entropy": -6.0, "policy_t": -0.009718913584947586, "mean_q": 5.508176803588867, "max_q": 7.350310325622559, "min_q": 3.9788553714752197}, "td_error": [0.7469804286956787, 0.8464484214782715, 1.0261993408203125, 0.5199739933013916, 1.4455525875091553, 0.4835829734802246, 1.0910801887512207, 0.4422492980957031, 0.8438527584075928, 1.5162584781646729, 2.4662818908691406, 0.3202023506164551, 0.7112269401550293, 1.9813339710235596, 2.0908010005950928, 0.2630650997161865, 0.8918144702911377, 0.6590323448181152, 5.000546455383301, 0.2942163944244385, 0.252910852432251, 0.5578694343566895, 1.875523567199707, 0.7856130599975586, 0.6212813854217529, 1.7652361392974854, 0.6426377296447754, 0.24112153053283691, 0.8292436599731445, 1.4703807830810547, 0.30454301834106445, 1.3856725692749023, 0.649799108505249, 0.2805142402648926, 1.1664104461669922, 1.4539425373077393, 0.5359537601470947, 1.3376402854919434, 1.421121597290039, 1.9199092388153076, 0.9754292964935303, 1.4536447525024414, 0.5595886707305908, 4.022365093231201, 1.989173412322998, 2.088987350463867, 1.68607759475708, 0.16779708862304688, 1.9862544536590576, 4.176620960235596, 2.7149581909179688, 1.1525428295135498, 1.6679096221923828, 1.4633314609527588, 0.7635462284088135, 2.292102336883545, 1.2845978736877441, 2.0853099822998047, 1.3494722843170166, 3.4784412384033203, 0.8471100330352783, 0.43344640731811523, 0.7717647552490234, 1.1287105083465576, 1.863171100616455, 1.3153998851776123, 0.5374979972839355, 2.471543788909912, 0.8364335298538208, 0.31386613845825195, 1.3108808994293213, 0.197401762008667, 0.8992066383361816, 1.7594411373138428, 0.26155662536621094, 1.0749340057373047, 2.6876630783081055, 0.282548189163208, 0.5205388069152832, 1.4463801383972168, 2.0751044750213623, 0.7894971370697021, 0.7451591491699219, 0.3927474021911621, 0.9456040859222412, 0.27970194816589355], "mean_td_error": 1.240505576133728, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 54.0, "diff_num_grad_updates_vs_sampler_policy": 53.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.113449096679688, "actor_loss": -9.84957218170166, "critic_loss": 0.36836686730384827, "alpha_loss": -0.16079609096050262, "alpha_value": 0.9842264652252197, "log_alpha_value": -0.015899233520030975, "target_entropy": -6.0, "policy_t": -0.0036937228869646788, "mean_q": 5.923238277435303, "max_q": 8.583158493041992, "min_q": 4.29954719543457}, "td_error": [0.4279811382293701, 1.0630731582641602, 1.5068013668060303, 1.1579444408416748, 0.4107487201690674, 0.06767773628234863, 5.294096946716309, 1.8557264804840088, 2.4640302658081055, 0.7068841457366943, 3.7490553855895996, 3.273707866668701, 1.403977632522583, 0.20972371101379395, 1.4722940921783447, 1.710205078125, 2.4121458530426025, 2.9558627605438232, 0.09479212760925293, 1.8946924209594727, 3.7724127769470215, 3.0830066204071045, 0.25539636611938477, 1.878603458404541, 0.9646062850952148, 0.2853057384490967, 1.8349323272705078, 1.4013886451721191, 0.4338953495025635, 0.508765459060669, 0.6828579902648926, 0.19749093055725098, 0.5821435451507568, 1.5086989402770996, 0.3656439781188965, 0.6814241409301758, 0.22966408729553223, 1.3041496276855469, 0.6037461757659912, 2.7030303478240967, 2.230297565460205, 0.4288327693939209, 1.7174005508422852, 3.099106550216675, 3.0561482906341553, 1.9203112125396729, 1.1569547653198242, 1.8676280975341797, 0.05001997947692871, 0.05015301704406738, 0.11715579032897949, 0.3624913692474365, 1.459383487701416, 2.7549057006835938, 0.7542622089385986, 2.0455288887023926, 1.1192448139190674, 0.41056108474731445, 0.6497395038604736, 1.3008677959442139, 0.42020297050476074, 1.7958285808563232, 0.9898545742034912, 0.6184930801391602, 0.2546207904815674, 4.481278896331787, 0.2018122673034668, 1.4606742858886719, 1.823713779449463, 0.20578551292419434, 0.5497715473175049, 1.3595232963562012, 0.2432091236114502, 5.942880630493164, 2.3295059204101562, 1.871267557144165, 1.0177104473114014, 1.9521610736846924, 1.2210438251495361, 0.5440208911895752, 1.6099770069122314, 1.1190931797027588, 4.046576976776123, 0.05782461166381836, 0.28119850158691406, 2.013185501098633], "mean_td_error": 1.4229161739349365, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 54.0, "diff_num_grad_updates_vs_sampler_policy": 53.0}}, "num_env_steps_sampled": 49280, "num_env_steps_trained": 13932, "num_agent_steps_sampled": 147840, "num_agent_steps_trained": 13932, "last_target_update_ts": 49280, "num_target_updates": 54}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 147840, "num_agent_steps_trained": 13932, "num_env_steps_sampled": 49280, "num_env_steps_trained": 13932, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 464.8932788027586, "num_env_steps_trained_throughput_per_sec": 133.86435929811574, "timesteps_total": 49280, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 147840, "timers": {"training_iteration_time_ms": 1950.221, "sample_time_ms": 1339.392, "load_time_ms": 0.527, "load_throughput": 489253.292, "learn_time_ms": 62.186, "learn_throughput": 4148.832, "synch_weights_time_ms": 15.842}, "counters": {"num_env_steps_sampled": 49280, "num_env_steps_trained": 13932, "num_agent_steps_sampled": 147840, "num_agent_steps_trained": 13932, "last_target_update_ts": 49280, "num_target_updates": 54}, "done": false, "episodes_total": 0, "training_iteration": 55, "trial_id": "566d8_00000", "date": "2023-11-16_22-22-10", "timestamp": 1700202130, "time_this_iter_s": 1.9411818981170654, "time_total_s": 112.25097155570984, "pid": 48481, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fb7906b0940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 112.25097155570984, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 64.66666666666667, "ram_util_percent": 92.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.978219985961914, "actor_loss": -10.057598114013672, "critic_loss": 0.5137832164764404, "alpha_loss": -0.16166719794273376, "alpha_value": 0.9839285612106323, "log_alpha_value": -0.016202006489038467, "target_entropy": -6.0, "policy_t": 0.03661603853106499, "mean_q": 6.005807399749756, "max_q": 8.074933052062988, "min_q": 4.00915002822876}, "td_error": [1.737117052078247, 2.91264271736145, 0.7331180572509766, 0.5856037139892578, 2.5430331230163574, 0.9713871479034424, 0.8235001564025879, 0.11330509185791016, 3.0194873809814453, 0.5502610206604004, 1.3608763217926025, 3.164269208908081, 1.7127289772033691, 0.978492259979248, 2.071998119354248, 2.306386947631836, 0.37029075622558594, 1.910935878753662, 1.5409009456634521, 5.414279460906982, 0.48877668380737305, 0.8193285465240479, 0.39507007598876953, 0.8239076137542725, 0.6457300186157227, 0.3778352737426758, 0.14783263206481934, 0.22339105606079102, 0.5138709545135498, 0.2038588523864746, 0.6660008430480957, 3.1163182258605957, 1.197091817855835, 0.8561310768127441, 1.7852253913879395, 0.28426623344421387, 4.540684223175049, 0.20315885543823242, 1.3155157566070557, 2.414264678955078, 1.280294418334961, 2.2491512298583984, 0.6201925277709961, 0.9786422252655029, 1.9532837867736816, 2.4309825897216797, 3.3998007774353027, 3.078181028366089, 0.5730881690979004, 0.5697324275970459, 1.5427160263061523, 0.16743803024291992, 2.8019726276397705, 1.3615808486938477, 0.5195741653442383, 2.032989263534546, 3.0391886234283447, 0.6197724342346191, 3.9945056438446045, 1.5408916473388672, 2.8930017948150635, 1.3677754402160645, 1.020566463470459, 1.3147201538085938, 2.5199930667877197, 0.3174753189086914, 3.5055904388427734, 0.5116021633148193, 1.7227082252502441, 1.4755933284759521, 1.1512441635131836, 0.96962571144104, 1.7252731323242188, 0.5062863826751709, 1.2260682582855225, 1.9942538738250732, 0.5946168899536133, 0.7600781917572021, 3.7266058921813965, 3.376715898513794, 3.5070407390594482, 2.9339523315429688, 1.9665968418121338, 0.8585777282714844, 0.2777900695800781, 3.290386915206909], "mean_td_error": 1.582639455795288, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 55.0, "diff_num_grad_updates_vs_sampler_policy": 54.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.081049919128418, "actor_loss": -9.592832565307617, "critic_loss": 0.37860119342803955, "alpha_loss": -0.16342243552207947, "alpha_value": 0.9839198589324951, "log_alpha_value": -0.016210854053497314, "target_entropy": -6.0, "policy_t": 0.028694432228803635, "mean_q": 5.62880277633667, "max_q": 7.4835524559021, "min_q": 4.00408411026001}, "td_error": [2.1547353267669678, 0.7068688869476318, 0.25810861587524414, 0.6172049045562744, 1.8184435367584229, 0.18793940544128418, 0.09711170196533203, 2.311582088470459, 0.454148530960083, 1.9689099788665771, 0.9909548759460449, 1.6841578483581543, 0.5406961441040039, 3.3741745948791504, 0.2305450439453125, 1.8261501789093018, 1.6265461444854736, 0.43929028511047363, 1.2475063800811768, 0.41350579261779785, 0.28238534927368164, 0.80104660987854, 2.022425413131714, 0.4654524326324463, 1.1656720638275146, 2.6534488201141357, 0.6919586658477783, 2.018357515335083, 2.8525359630584717, 1.345733404159546, 1.4528834819793701, 1.014460563659668, 0.5023820400238037, 4.758774757385254, 0.4298832416534424, 0.4070761203765869, 0.24147677421569824, 1.407987356185913, 0.17467713356018066, 0.6018106937408447, 0.46353840827941895, 2.3961586952209473, 0.5752162933349609, 2.4324347972869873, 0.5026452541351318, 0.27890825271606445, 0.6290426254272461, 3.829434871673584, 1.4767975807189941, 0.443772554397583, 0.8795599937438965, 0.6075150966644287, 1.4632775783538818, 0.9847698211669922, 2.341386079788208, 1.389268398284912, 2.393306016921997, 1.828202486038208, 0.9906778335571289, 0.05673646926879883, 1.2963471412658691, 4.747927188873291, 1.1873013973236084, 2.1234238147735596, 5.228915214538574, 1.2577791213989258, 2.1796762943267822, 2.0358498096466064, 0.25432610511779785, 1.063922643661499, 0.07786393165588379, 0.2571847438812256, 3.2361690998077393, 1.3508319854736328, 0.9446735382080078, 0.09183001518249512, 0.15971779823303223, 0.9533593654632568, 0.4903547763824463, 2.814945697784424, 0.5210235118865967, 1.739067792892456, 1.4425106048583984, 1.1919662952423096, 1.008788824081421, 0.6668941974639893], "mean_td_error": 1.3084222078323364, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 55.0, "diff_num_grad_updates_vs_sampler_policy": 54.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.07407283782959, "actor_loss": -9.80460262298584, "critic_loss": 0.42606544494628906, "alpha_loss": -0.1631922870874405, "alpha_value": 0.9839312434196472, "log_alpha_value": -0.01619923673570156, "target_entropy": -6.0, "policy_t": 0.009314581751823425, "mean_q": 5.883524417877197, "max_q": 8.08314037322998, "min_q": 4.171879291534424}, "td_error": [0.9916837215423584, 0.41091036796569824, 2.615384340286255, 0.6316959857940674, 0.5114071369171143, 0.9566683769226074, 0.8202769756317139, 1.7976963520050049, 0.5756688117980957, 0.3573873043060303, 0.737558126449585, 0.5652604103088379, 1.0240082740783691, 0.2744271755218506, 1.662745714187622, 0.16782093048095703, 2.1340432167053223, 0.7217252254486084, 0.8264765739440918, 0.09727883338928223, 3.418867349624634, 0.2675158977508545, 4.376142501831055, 1.6315088272094727, 1.5359206199645996, 1.8947103023529053, 0.9587991237640381, 0.26054835319519043, 1.6821091175079346, 0.2971041202545166, 1.5178442001342773, 3.147930145263672, 0.2965538501739502, 0.6132545471191406, 1.807746410369873, 1.5858514308929443, 1.6041218042373657, 1.5359995365142822, 2.8999040126800537, 2.770745277404785, 3.7077224254608154, 1.8850700855255127, 1.3469536304473877, 1.0144758224487305, 1.7215240001678467, 3.668346881866455, 0.3539447784423828, 0.1258862018585205, 2.0994064807891846, 0.16515231132507324, 2.5499532222747803, 0.4962230920791626, 1.363434076309204, 1.8671801090240479, 1.9984846115112305, 3.0987823009490967, 3.119249105453491, 5.052722930908203, 2.91823148727417, 1.8616745471954346, 1.5857596397399902, 2.550076961517334, 1.035219669342041, 2.8223955631256104, 5.563482761383057, 1.935396671295166, 1.5330443382263184, 0.6765716075897217, 0.9189150333404541, 2.3692994117736816, 1.6082792282104492, 1.9665155410766602, 0.13136672973632812, 3.933027744293213, 1.9587736129760742, 0.8598899841308594, 1.9255542755126953, 0.6331181526184082, 0.8427846431732178, 1.6997778415679932, 1.0237419605255127, 1.3062076568603516, 0.8161273002624512, 3.794022798538208, 1.8115158081054688, 0.5919854640960693], "mean_td_error": 1.6080297231674194, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 55.0, "diff_num_grad_updates_vs_sampler_policy": 54.0}}, "num_env_steps_sampled": 50176, "num_env_steps_trained": 14190, "num_agent_steps_sampled": 150528, "num_agent_steps_trained": 14190, "last_target_update_ts": 50176, "num_target_updates": 55}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 150528, "num_agent_steps_trained": 14190, "num_env_steps_sampled": 50176, "num_env_steps_trained": 14190, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 447.36451964186995, "num_env_steps_trained_throughput_per_sec": 128.81701570044916, "timesteps_total": 50176, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 150528, "timers": {"training_iteration_time_ms": 1964.142, "sample_time_ms": 1353.664, "load_time_ms": 0.527, "load_throughput": 489231.173, "learn_time_ms": 62.007, "learn_throughput": 4160.813, "synch_weights_time_ms": 15.655}, "counters": {"num_env_steps_sampled": 50176, "num_env_steps_trained": 14190, "num_agent_steps_sampled": 150528, "num_agent_steps_trained": 14190, "last_target_update_ts": 50176, "num_target_updates": 55}, "done": false, "episodes_total": 0, "training_iteration": 56, "trial_id": "566d8_00000", "date": "2023-11-16_22-22-12", "timestamp": 1700202132, "time_this_iter_s": 2.0174989700317383, "time_total_s": 114.26847052574158, "pid": 48481, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fb780e83f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 114.26847052574158, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 66.86666666666666, "ram_util_percent": 92.36666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.002408981323242, "actor_loss": -10.103466987609863, "critic_loss": 0.42678725719451904, "alpha_loss": -0.1650518774986267, "alpha_value": 0.9836341738700867, "log_alpha_value": -0.016501212492585182, "target_entropy": -6.0, "policy_t": -0.014342591166496277, "mean_q": 6.203275680541992, "max_q": 8.545999526977539, "min_q": 4.571676254272461}, "td_error": [0.185028076171875, 0.8305394649505615, 2.7763257026672363, 1.2328479290008545, 0.29903244972229004, 0.31999969482421875, 1.365760326385498, 2.919952154159546, 0.5245985984802246, 2.0525505542755127, 3.115518093109131, 2.085336685180664, 0.2992525100708008, 0.3333749771118164, 2.243887186050415, 0.8363397121429443, 0.20136570930480957, 2.842978000640869, 0.23917078971862793, 0.2509150505065918, 3.2529187202453613, 0.29685235023498535, 0.9210131168365479, 0.9013755321502686, 0.7268452644348145, 1.1385998725891113, 2.692979335784912, 3.188857078552246, 1.4438138008117676, 0.2328948974609375, 4.965010166168213, 1.053882360458374, 2.2840662002563477, 2.018800735473633, 0.3728940486907959, 1.4191975593566895, 4.0416388511657715, 2.700761318206787, 1.811577320098877, 0.8894050121307373, 1.8790130615234375, 2.2078166007995605, 3.005143165588379, 0.49422693252563477, 2.603153944015503, 0.1070244312286377, 1.4946696758270264, 0.18284940719604492, 0.15837359428405762, 0.03561115264892578, 1.1584761142730713, 3.098379135131836, 2.1291444301605225, 1.661684513092041, 1.101938009262085, 0.13451004028320312, 0.4023611545562744, 0.9802944660186768, 0.24050188064575195, 0.1965315341949463, 2.6093649864196777, 2.9359917640686035, 0.8217258453369141, 1.0298781394958496, 1.7701284885406494, 0.15468120574951172, 1.6885297298431396, 2.4024875164031982, 0.15376663208007812, 0.6197738647460938, 1.5911924839019775, 0.1507270336151123, 0.953988790512085, 1.653165340423584, 1.212435007095337, 1.3562700748443604, 3.101562976837158, 1.1102190017700195, 0.11904764175415039, 1.0548579692840576, 1.7880525588989258, 1.3248798847198486, 0.15068769454956055, 1.3208487033843994, 1.235537052154541, 0.7871642112731934], "mean_td_error": 1.3683351278305054, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 56.0, "diff_num_grad_updates_vs_sampler_policy": 55.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.955419540405273, "actor_loss": -9.561699867248535, "critic_loss": 0.3994443118572235, "alpha_loss": -0.16437384486198425, "alpha_value": 0.9836245775222778, "log_alpha_value": -0.016510989516973495, "target_entropy": -6.0, "policy_t": 0.021772045642137527, "mean_q": 5.70210599899292, "max_q": 7.571699619293213, "min_q": 3.8525469303131104}, "td_error": [0.4986422061920166, 2.2557976245880127, 2.301021099090576, 2.0911202430725098, 0.2654869556427002, 0.33646345138549805, 0.6841087341308594, 3.5211400985717773, 1.0487470626831055, 0.6739882230758667, 0.7740137577056885, 1.3185076713562012, 1.102224349975586, 0.20212388038635254, 4.390777111053467, 1.9353532791137695, 0.32412636280059814, 0.44408297538757324, 1.143026351928711, 1.1296360492706299, 1.7835147380828857, 0.4637491703033447, 1.9738037586212158, 0.43058347702026367, 0.7906694412231445, 1.0278668403625488, 0.5839383602142334, 0.5990638732910156, 0.20085549354553223, 1.809136152267456, 0.16394734382629395, 0.14964842796325684, 2.491490125656128, 3.091709852218628, 0.6971464157104492, 4.778743267059326, 0.18928265571594238, 3.5155863761901855, 0.9413704872131348, 0.752856969833374, 0.6432740688323975, 1.0164949893951416, 3.6321792602539062, 2.5405828952789307, 2.777482509613037, 1.6663293838500977, 0.822242259979248, 0.9849696159362793, 1.1480293273925781, 0.034531354904174805, 4.075374126434326, 1.7141880989074707, 3.6991233825683594, 0.33486366271972656, 1.983138084411621, 0.6912834644317627, 2.6484053134918213, 1.247894287109375, 2.148078441619873, 1.619699239730835, 0.7716271877288818, 0.5194282531738281, 1.3335652351379395, 0.3423011302947998, 2.4886372089385986, 2.9198665618896484, 0.2860722541809082, 3.265955686569214, 0.5806033611297607, 0.08093643188476562, 2.028919219970703, 1.6460697650909424, 0.2246689796447754, 0.7918879985809326, 0.27851343154907227, 0.6760764122009277, 0.5672059059143066, 1.7169368267059326, 0.6016154289245605, 3.4152989387512207, 1.3977537155151367, 0.2026519775390625, 0.051572322845458984, 0.8401505947113037, 0.5541591644287109, 0.2541511058807373], "mean_td_error": 1.3504667282104492, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 56.0, "diff_num_grad_updates_vs_sampler_policy": 55.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.994114875793457, "actor_loss": -9.514525413513184, "critic_loss": 0.36926040053367615, "alpha_loss": -0.16489502787590027, "alpha_value": 0.9836361408233643, "log_alpha_value": -0.01649921014904976, "target_entropy": -6.0, "policy_t": 0.03132716938853264, "mean_q": 5.600128650665283, "max_q": 7.623163223266602, "min_q": 4.003790378570557}, "td_error": [2.5232536792755127, 1.357131004333496, 0.1692066192626953, 0.6337909698486328, 2.0321900844573975, 2.52352237701416, 3.4795727729797363, 2.035646438598633, 2.8548903465270996, 2.11610746383667, 3.2269527912139893, 2.886497974395752, 0.2677896022796631, 2.4939374923706055, 0.1697092056274414, 2.1386878490448, 1.032681941986084, 0.2021775245666504, 1.0315299034118652, 2.5798683166503906, 1.001699447631836, 1.2039456367492676, 0.5582053661346436, 0.86177659034729, 1.3385052680969238, 4.042272090911865, 0.4941427707672119, 0.19512486457824707, 0.2768223285675049, 1.335188388824463, 1.5554938316345215, 0.9705114364624023, 0.05339765548706055, 0.4584012031555176, 0.575350284576416, 0.8053309917449951, 0.12626314163208008, 0.8433444499969482, 0.4370856285095215, 2.2883708477020264, 2.646146297454834, 0.13901638984680176, 0.74400794506073, 0.08170509338378906, 3.683014154434204, 1.0301320552825928, 2.6108617782592773, 0.6210718154907227, 2.136610507965088, 2.599360942840576, 0.2975780963897705, 4.037593364715576, 0.18503117561340332, 0.6161031723022461, 3.0959389209747314, 1.0647144317626953, 1.2239408493041992, 0.29610276222229004, 0.7541735172271729, 0.7617671489715576, 0.2913491725921631, 1.245816946029663, 0.280092716217041, 0.21146202087402344, 0.35445594787597656, 1.1002013683319092, 2.129676342010498, 2.2537827491760254, 0.6562919616699219, 0.5172321796417236, 2.411120891571045, 0.17775344848632812, 1.1802494525909424, 1.983285903930664, 0.10860013961791992, 1.5232133865356445, 4.542330741882324, 2.3113293647766113, 2.174795150756836, 3.100383996963501, 0.17773795127868652, 0.7381167411804199, 0.4725611209869385, 0.31214094161987305, 4.938911437988281, 3.31347393989563], "mean_td_error": 1.4221816062927246, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 56.0, "diff_num_grad_updates_vs_sampler_policy": 55.0}}, "num_env_steps_sampled": 51072, "num_env_steps_trained": 14448, "num_agent_steps_sampled": 153216, "num_agent_steps_trained": 14448, "last_target_update_ts": 51072, "num_target_updates": 56}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 153216, "num_agent_steps_trained": 14448, "num_env_steps_sampled": 51072, "num_env_steps_trained": 14448, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 473.1347893458519, "num_env_steps_trained_throughput_per_sec": 136.23747282503325, "timesteps_total": 51072, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 153216, "timers": {"training_iteration_time_ms": 1962.198, "sample_time_ms": 1352.642, "load_time_ms": 0.525, "load_throughput": 491274.541, "learn_time_ms": 62.1, "learn_throughput": 4154.607, "synch_weights_time_ms": 15.818}, "counters": {"num_env_steps_sampled": 51072, "num_env_steps_trained": 14448, "num_agent_steps_sampled": 153216, "num_agent_steps_trained": 14448, "last_target_update_ts": 51072, "num_target_updates": 56}, "done": false, "episodes_total": 0, "training_iteration": 57, "trial_id": "566d8_00000", "date": "2023-11-16_22-22-14", "timestamp": 1700202134, "time_this_iter_s": 1.9080588817596436, "time_total_s": 116.17652940750122, "pid": 48481, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fb780e85f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 116.17652940750122, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 87.4, "ram_util_percent": 92.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.043853759765625, "actor_loss": -10.53774642944336, "critic_loss": 0.5257160067558289, "alpha_loss": -0.16873982548713684, "alpha_value": 0.9833400249481201, "log_alpha_value": -0.016800306737422943, "target_entropy": -6.0, "policy_t": -0.012748625129461288, "mean_q": 6.481752395629883, "max_q": 8.743461608886719, "min_q": 4.159177303314209}, "td_error": [1.9620583057403564, 0.2036590576171875, 0.5149891376495361, 0.6337344646453857, 5.988763809204102, 5.241387844085693, 0.40373873710632324, 1.0669972896575928, 0.992337703704834, 0.3753011226654053, 1.1200027465820312, 0.7942535877227783, 3.0252161026000977, 3.1950128078460693, 0.40643930435180664, 0.4416923522949219, 0.3153202533721924, 0.666475772857666, 2.523853302001953, 0.8824939727783203, 0.5855731964111328, 0.18958449363708496, 4.447530269622803, 1.37520432472229, 1.0597865581512451, 4.111770153045654, 3.1018693447113037, 0.4211907386779785, 0.6393005847930908, 0.10964345932006836, 1.0725080966949463, 3.758796215057373, 0.9690876007080078, 3.5772736072540283, 0.6766414642333984, 0.4718644618988037, 1.8241667747497559, 1.1340208053588867, 0.28242063522338867, 2.579125165939331, 3.04479718208313, 1.723712682723999, 1.4442319869995117, 0.2665598392486572, 0.21666646003723145, 7.1500983238220215, 0.3467237949371338, 2.640963077545166, 1.365828275680542, 3.0030205249786377, 1.4442031383514404, 2.2519469261169434, 0.7827942371368408, 0.4618346691131592, 2.274902582168579, 1.3358135223388672, 0.060843467712402344, 1.0815837383270264, 1.5048167705535889, 1.3614025115966797, 2.0624115467071533, 1.8679301738739014, 0.7169225215911865, 0.44774699211120605, 0.9483506679534912, 0.9508867263793945, 0.09830212593078613, 0.7096884250640869, 5.129395484924316, 0.8488683700561523, 0.06876564025878906, 0.6755659580230713, 1.6517682075500488, 1.8019499778747559, 0.09923672676086426, 2.0209362506866455, 0.3712306022644043, 2.2356455326080322, 1.358872890472412, 2.8517253398895264, 0.21806883811950684, 0.13901448249816895, 4.262152194976807, 1.9273407459259033, 5.356593608856201, 2.056124448776245], "mean_td_error": 1.6020852327346802, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 57.0, "diff_num_grad_updates_vs_sampler_policy": 56.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.130126953125, "actor_loss": -9.609880447387695, "critic_loss": 0.34259724617004395, "alpha_loss": -0.1702955812215805, "alpha_value": 0.983329713344574, "log_alpha_value": -0.01681080460548401, "target_entropy": -6.0, "policy_t": -0.007526208180934191, "mean_q": 5.6873087882995605, "max_q": 7.828629016876221, "min_q": 4.217658996582031}, "td_error": [2.778595447540283, 0.9291987419128418, 1.0485825538635254, 3.263949394226074, 1.3337903022766113, 0.3734734058380127, 1.8931419849395752, 1.2337977886199951, 0.4273831844329834, 0.9503953456878662, 0.4953186511993408, 0.969820499420166, 0.6744711399078369, 2.1251261234283447, 0.821556568145752, 4.339499473571777, 2.769531011581421, 0.11077094078063965, 1.168602705001831, 3.1859219074249268, 2.1110246181488037, 1.7322113513946533, 1.1548833847045898, 0.3197183609008789, 2.381336212158203, 0.4662637710571289, 0.746274471282959, 1.2224023342132568, 1.3505043983459473, 1.2659058570861816, 0.6837377548217773, 1.1213030815124512, 2.457190990447998, 1.1817607879638672, 0.8760366439819336, 1.5814189910888672, 0.33730602264404297, 0.1397535800933838, 1.2388238906860352, 3.4162437915802, 0.33954668045043945, 0.6563472747802734, 2.0689525604248047, 1.3656115531921387, 0.1942300796508789, 0.24445343017578125, 1.8405983448028564, 1.9193668365478516, 1.4315717220306396, 2.1059842109680176, 0.19901585578918457, 0.28899574279785156, 0.2551000118255615, 2.0222225189208984, 0.3854038715362549, 0.5283799171447754, 1.7343053817749023, 1.075108528137207, 1.3400802612304688, 0.7750489711761475, 0.13207793235778809, 1.4063880443572998, 0.07883787155151367, 1.177262783050537, 1.2690348625183105, 2.3781349658966064, 2.9550418853759766, 0.7874188423156738, 0.25687217712402344, 1.3612358570098877, 1.04856276512146, 2.584502696990967, 1.589285135269165, 0.6480891704559326, 0.9398744106292725, 1.7661480903625488, 1.6014325618743896, 1.6871802806854248, 1.0721817016601562, 0.6420631408691406, 0.7112548351287842, 1.3529651165008545, 0.38245725631713867, 0.34769201278686523, 1.115574836730957, 0.6192255020141602], "mean_td_error": 1.2483505010604858, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 57.0, "diff_num_grad_updates_vs_sampler_policy": 56.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.050007820129395, "actor_loss": -9.500678062438965, "critic_loss": 0.3581312298774719, "alpha_loss": -0.16882970929145813, "alpha_value": 0.9833413362503052, "log_alpha_value": -0.0167989619076252, "target_entropy": -6.0, "policy_t": 0.05320873484015465, "mean_q": 5.587870121002197, "max_q": 8.01175308227539, "min_q": 4.1078643798828125}, "td_error": [2.2374391555786133, 2.7276434898376465, 3.0917322635650635, 2.995985269546509, 1.8301217555999756, 1.1261134147644043, 1.8245129585266113, 2.0003936290740967, 0.8535029888153076, 1.1695897579193115, 0.8124005794525146, 0.6737833023071289, 2.401346445083618, 2.071105718612671, 1.5623955726623535, 1.8601396083831787, 2.0653908252716064, 1.4744491577148438, 0.03674507141113281, 0.42385053634643555, 0.41397571563720703, 1.4439091682434082, 1.851060152053833, 1.0595488548278809, 0.9313910007476807, 1.0742976665496826, 2.597806453704834, 0.8317217826843262, 0.08735179901123047, 1.1358840465545654, 0.9495875835418701, 1.2726943492889404, 1.3975086212158203, 1.420694351196289, 1.6112616062164307, 1.0131993293762207, 1.0373780727386475, 2.184353828430176, 1.6054644584655762, 1.765829086303711, 1.2966880798339844, 1.7506113052368164, 0.534874677658081, 2.3716068267822266, 1.5366740226745605, 0.30256080627441406, 1.8516340255737305, 0.3473832607269287, 0.9884176254272461, 1.9239552021026611, 1.5016655921936035, 1.367772102355957, 2.6874170303344727, 1.6637203693389893, 5.30075740814209, 1.7657520771026611, 0.37932729721069336, 2.2100043296813965, 1.1553840637207031, 1.0545239448547363, 1.2498819828033447, 0.27170515060424805, 0.09516334533691406, 0.4254014492034912, 3.369692802429199, 1.460771083831787, 0.2744779586791992, 0.22245264053344727, 1.7796294689178467, 0.9620513916015625, 2.690096378326416, 3.36895751953125, 1.1264357566833496, 1.543694257736206, 0.4505281448364258, 0.5674593448638916, 4.574767112731934, 0.20713353157043457, 1.002971887588501, 1.4310991764068604, 0.2401261329650879, 1.7991366386413574, 1.5235884189605713, 0.7393703460693359, 1.8626763820648193, 0.8929440975189209], "mean_td_error": 1.4540292024612427, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 57.0, "diff_num_grad_updates_vs_sampler_policy": 56.0}}, "num_env_steps_sampled": 51968, "num_env_steps_trained": 14706, "num_agent_steps_sampled": 155904, "num_agent_steps_trained": 14706, "last_target_update_ts": 51968, "num_target_updates": 57}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 155904, "num_agent_steps_trained": 14706, "num_env_steps_sampled": 51968, "num_env_steps_trained": 14706, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 485.3367468756118, "num_env_steps_trained_throughput_per_sec": 139.75098291730788, "timesteps_total": 51968, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 155904, "timers": {"training_iteration_time_ms": 1958.822, "sample_time_ms": 1348.345, "load_time_ms": 0.526, "load_throughput": 490717.591, "learn_time_ms": 62.077, "learn_throughput": 4156.132, "synch_weights_time_ms": 15.891}, "counters": {"num_env_steps_sampled": 51968, "num_env_steps_trained": 14706, "num_agent_steps_sampled": 155904, "num_agent_steps_trained": 14706, "last_target_update_ts": 51968, "num_target_updates": 57}, "done": false, "episodes_total": 0, "training_iteration": 58, "trial_id": "566d8_00000", "date": "2023-11-16_22-22-16", "timestamp": 1700202136, "time_this_iter_s": 1.861999273300171, "time_total_s": 118.03852868080139, "pid": 48481, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fb7906b0940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 118.03852868080139, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 64.83333333333333, "ram_util_percent": 92.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.013265609741211, "actor_loss": -10.342183113098145, "critic_loss": 0.5031760931015015, "alpha_loss": -0.17122088372707367, "alpha_value": 0.9830459356307983, "log_alpha_value": -0.017099404707551003, "target_entropy": -6.0, "policy_t": -0.02212163805961609, "mean_q": 6.240963935852051, "max_q": 8.809535026550293, "min_q": 4.459242343902588}, "td_error": [0.8566935062408447, 0.5945615768432617, 1.6784729957580566, 1.6732661724090576, 0.33121442794799805, 2.0045294761657715, 1.5045971870422363, 3.093416213989258, 1.5641670227050781, 1.2541565895080566, 0.5660078525543213, 1.2324602603912354, 0.8438823223114014, 1.8895792961120605, 2.8755838871002197, 2.301896572113037, 3.4901785850524902, 0.49970316886901855, 1.636378288269043, 0.24931120872497559, 1.463759422302246, 2.0102906227111816, 0.2608211040496826, 0.46895289421081543, 3.986905097961426, 1.0330066680908203, 0.8605265617370605, 3.267000198364258, 2.746795415878296, 1.9879658222198486, 4.354379177093506, 0.10253667831420898, 1.2078938484191895, 1.9498167037963867, 0.29831981658935547, 3.9670093059539795, 1.6041476726531982, 0.6639456748962402, 2.3153889179229736, 0.26049160957336426, 0.6285910606384277, 0.2768700122833252, 2.1534483432769775, 3.307042121887207, 1.154458999633789, 0.9963657855987549, 0.47008657455444336, 0.617443323135376, 0.6257786750793457, 1.1277711391448975, 1.5387156009674072, 0.5490281581878662, 0.7938055992126465, 0.5968763828277588, 1.9495933055877686, 1.318650484085083, 2.938711166381836, 1.0959980487823486, 2.8658039569854736, 2.9527082443237305, 1.3593428134918213, 2.1912009716033936, 3.9557878971099854, 3.598435401916504, 1.2615163326263428, 1.2166621685028076, 1.0285146236419678, 0.36144328117370605, 2.1824371814727783, 1.167914867401123, 0.5439698696136475, 1.2237751483917236, 0.8259882926940918, 0.8225221633911133, 0.43763256072998047, 0.5714635848999023, 2.929870843887329, 0.44736266136169434, 0.7250032424926758, 0.18942618370056152, 9.07055377960205, 1.2280707359313965, 1.2144439220428467, 4.642081260681152, 1.4222850799560547, 0.27055811882019043], "mean_td_error": 1.6022791862487793, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 58.0, "diff_num_grad_updates_vs_sampler_policy": 57.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.104100227355957, "actor_loss": -9.461505889892578, "critic_loss": 0.39872992038726807, "alpha_loss": -0.1728888750076294, "alpha_value": 0.9830347895622253, "log_alpha_value": -0.017110764980316162, "target_entropy": -6.0, "policy_t": -0.025755615904927254, "mean_q": 5.6266374588012695, "max_q": 7.907088279724121, "min_q": 4.23694372177124}, "td_error": [2.996309995651245, 0.3351585865020752, 2.2654261589050293, 0.09683799743652344, 1.3869235515594482, 0.9073150157928467, 0.3758876323699951, 2.9275331497192383, 2.4593281745910645, 1.0134872198104858, 0.33954763412475586, 0.6102499961853027, 1.1888632774353027, 1.0701959133148193, 0.7349026203155518, 1.1526217460632324, 0.11174154281616211, 2.6552326679229736, 0.9596779346466064, 2.1925690174102783, 0.7913486957550049, 3.640193223953247, 1.5743236541748047, 0.6135079860687256, 1.086120367050171, 0.6491034030914307, 0.9636597633361816, 0.14556622505187988, 0.8571786880493164, 2.1047680377960205, 2.014387369155884, 0.3686549663543701, 2.1521012783050537, 1.4810678958892822, 0.7482318878173828, 1.1050240993499756, 1.4932293891906738, 1.2132794857025146, 2.0284063816070557, 1.4607670307159424, 3.3251447677612305, 1.7473855018615723, 2.373271942138672, 1.9543168544769287, 1.9862067699432373, 2.969943046569824, 2.857856512069702, 3.715742349624634, 1.1583788394927979, 0.4970259666442871, 1.0829992294311523, 0.8744268417358398, 2.2701926231384277, 0.8105134963989258, 0.16805720329284668, 1.067847490310669, 1.1484019756317139, 1.025317668914795, 0.3415515422821045, 2.4166150093078613, 1.8097596168518066, 0.15401315689086914, 4.41826868057251, 2.7003870010375977, 0.09724998474121094, 2.475100040435791, 2.070638418197632, 0.2400662899017334, 0.7674605846405029, 0.32962143421173096, 2.2749640941619873, 2.4950268268585205, 0.4296433925628662, 1.1532890796661377, 0.22404837608337402, 1.2771589756011963, 1.4172914028167725, 0.6832308769226074, 0.5171921253204346, 2.1493468284606934, 0.4677906036376953, 2.531557321548462, 0.11803030967712402, 0.2919461727142334, 0.28756701946258545, 1.1455750465393066], "mean_td_error": 1.378931999206543, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 58.0, "diff_num_grad_updates_vs_sampler_policy": 57.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.114084243774414, "actor_loss": -9.709997177124023, "critic_loss": 0.3135344684123993, "alpha_loss": -0.17293719947338104, "alpha_value": 0.9830467104911804, "log_alpha_value": -0.017098654061555862, "target_entropy": -6.0, "policy_t": 0.011665957048535347, "mean_q": 5.82436466217041, "max_q": 8.250890731811523, "min_q": 3.997973680496216}, "td_error": [2.8296825885772705, 0.8149006366729736, 0.15905427932739258, 0.2395801544189453, 1.3563106060028076, 3.44150710105896, 0.5557470321655273, 0.6873507499694824, 2.5435843467712402, 0.22735381126403809, 1.302577018737793, 5.465193271636963, 0.3934059143066406, 0.46100282669067383, 2.898869037628174, 0.5483543872833252, 0.44605374336242676, 0.3535590171813965, 0.18424272537231445, 2.79948091506958, 2.1841988563537598, 1.0728294849395752, 1.1691303253173828, 0.9666321277618408, 0.872520923614502, 0.23675847053527832, 1.4437899589538574, 1.371375322341919, 2.771881341934204, 0.9599573612213135, 0.30342936515808105, 2.234977960586548, 2.8345139026641846, 1.5468711853027344, 0.1831374168395996, 1.5001580715179443, 1.1882984638214111, 0.08640527725219727, 0.9380676746368408, 2.1815991401672363, 1.2060003280639648, 0.46902894973754883, 1.0435540676116943, 1.190798282623291, 1.5980417728424072, 0.6391899585723877, 0.7506320476531982, 0.43047547340393066, 0.16272354125976562, 1.280186653137207, 2.347003936767578, 0.19917964935302734, 0.6638748645782471, 1.5367228984832764, 0.5120959281921387, 2.4606575965881348, 1.4048261642456055, 0.20041179656982422, 1.5814993381500244, 1.5582869052886963, 0.5399346351623535, 2.425950527191162, 1.1311817169189453, 0.22638583183288574, 0.5896238088607788, 0.20495176315307617, 0.5033245086669922, 0.9878041744232178, 2.510584592819214, 0.6844165325164795, 0.7612960338592529, 1.6196086406707764, 3.2195379734039307, 0.7715907096862793, 0.957465648651123, 0.5223305225372314, 0.8664119243621826, 3.891558885574341, 1.8475582599639893, 1.8003168106079102, 0.20189571380615234, 2.6047277450561523, 1.7526817321777344, 3.293458938598633, 0.14479494094848633, 0.2665059566497803], "mean_td_error": 1.271109700202942, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 58.0, "diff_num_grad_updates_vs_sampler_policy": 57.0}}, "num_env_steps_sampled": 52864, "num_env_steps_trained": 14964, "num_agent_steps_sampled": 158592, "num_agent_steps_trained": 14964, "last_target_update_ts": 52864, "num_target_updates": 58}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 158592, "num_agent_steps_trained": 14964, "num_env_steps_sampled": 52864, "num_env_steps_trained": 14964, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 473.3764547481728, "num_env_steps_trained_throughput_per_sec": 136.30705951454084, "timesteps_total": 52864, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 158592, "timers": {"training_iteration_time_ms": 1960.069, "sample_time_ms": 1349.009, "load_time_ms": 0.524, "load_throughput": 492504.293, "learn_time_ms": 62.038, "learn_throughput": 4158.744, "synch_weights_time_ms": 15.961}, "counters": {"num_env_steps_sampled": 52864, "num_env_steps_trained": 14964, "num_agent_steps_sampled": 158592, "num_agent_steps_trained": 14964, "last_target_update_ts": 52864, "num_target_updates": 58}, "done": false, "episodes_total": 0, "training_iteration": 59, "trial_id": "566d8_00000", "date": "2023-11-16_22-22-18", "timestamp": 1700202138, "time_this_iter_s": 1.906505823135376, "time_total_s": 119.94503450393677, "pid": 48481, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fb780e83f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 119.94503450393677, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 65.66666666666667, "ram_util_percent": 92.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.04312515258789, "actor_loss": -10.47969913482666, "critic_loss": 0.5858662128448486, "alpha_loss": -0.17473465204238892, "alpha_value": 0.9827520251274109, "log_alpha_value": -0.01739843375980854, "target_entropy": -6.0, "policy_t": -0.005621651187539101, "mean_q": 6.579153537750244, "max_q": 9.428333282470703, "min_q": 4.522302627563477}, "td_error": [1.4596233367919922, 2.7479920387268066, 2.2493605613708496, 1.138819694519043, 0.39772987365722656, 0.2035982608795166, 0.24601149559020996, 0.3760526180267334, 1.1457607746124268, 1.033196210861206, 2.0976011753082275, 3.2150931358337402, 1.4865491390228271, 0.4281797409057617, 3.2926876544952393, 1.3564136028289795, 2.1007802486419678, 0.05689811706542969, 2.3043112754821777, 2.8111839294433594, 2.7612977027893066, 2.634046792984009, 2.4978461265563965, 2.27374267578125, 2.9232330322265625, 3.124143600463867, 4.673462867736816, 0.1460874080657959, 3.7039144039154053, 2.3398633003234863, 0.6833932399749756, 0.8511872291564941, 1.6410410404205322, 1.0143320560455322, 0.8047573566436768, 0.7593662738800049, 2.607997417449951, 0.8007493019104004, 0.9065723419189453, 1.774517297744751, 0.2760603427886963, 0.4623067378997803, 2.3182406425476074, 1.0214149951934814, 1.004800796508789, 1.2083508968353271, 0.2480909824371338, 1.0523741245269775, 1.6867449283599854, 0.8423609733581543, 0.8109409809112549, 1.433699607849121, 0.34300732612609863, 0.14702272415161133, 0.37816667556762695, 2.8174054622650146, 0.7989048957824707, 2.988219738006592, 1.41029691696167, 1.492354393005371, 1.7765319347381592, 2.035611391067505, 3.7294554710388184, 0.5038878917694092, 0.632537841796875, 1.7217800617218018, 2.4452996253967285, 0.58699631690979, 2.4348819255828857, 0.9290444850921631, 1.8234310150146484, 4.930887699127197, 2.5307834148406982, 5.654388427734375, 3.4254212379455566, 2.1175854206085205, 1.0984983444213867, 0.14145398139953613, 3.3902041912078857, 7.002073764801025, 1.4487934112548828, 1.905956745147705, 2.3899450302124023, 1.2121176719665527, 2.625575304031372, 1.602065086364746], "mean_td_error": 1.7663414478302002, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 59.0, "diff_num_grad_updates_vs_sampler_policy": 58.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.05035400390625, "actor_loss": -9.295056343078613, "critic_loss": 0.39691677689552307, "alpha_loss": -0.17498458921909332, "alpha_value": 0.9827399253845215, "log_alpha_value": -0.01741078868508339, "target_entropy": -6.0, "policy_t": 0.0016389465890824795, "mean_q": 5.52500057220459, "max_q": 7.428103446960449, "min_q": 3.929302453994751}, "td_error": [0.2060699462890625, 0.9064675569534302, 2.231882333755493, 3.17252254486084, 0.8609669208526611, 3.672353744506836, 0.3439764976501465, 3.158726930618286, 0.8740904331207275, 0.8497663736343384, 0.6336644887924194, 0.7378060817718506, 0.21945786476135254, 0.9498772621154785, 1.3235936164855957, 1.5905570983886719, 1.0438861846923828, 0.36020946502685547, 1.4048643112182617, 0.7646219730377197, 0.3732140064239502, 1.0089154243469238, 1.4536478519439697, 0.6537919044494629, 0.3566563129425049, 2.547077178955078, 2.9754910469055176, 1.3664605617523193, 0.7625265121459961, 0.3395848274230957, 0.7868843078613281, 1.3479681015014648, 0.7034552097320557, 0.08671760559082031, 0.489194393157959, 0.11984658241271973, 0.5162086486816406, 0.6564798355102539, 2.2699508666992188, 1.3177006244659424, 1.5517381429672241, 1.5848798751831055, 1.7291085720062256, 1.336158275604248, 1.0893833637237549, 1.5306477546691895, 2.994145631790161, 5.9093523025512695, 0.5948917865753174, 1.448500633239746, 1.293166160583496, 2.5997753143310547, 1.7626044750213623, 2.544722557067871, 0.855379581451416, 0.226617693901062, 0.962761402130127, 1.097285509109497, 0.9521956443786621, 0.4464445114135742, 1.8156037330627441, 0.3789198398590088, 2.0038557052612305, 1.7309248447418213, 1.5269145965576172, 0.43122708797454834, 3.433438301086426, 1.9972889423370361, 2.8545563220977783, 1.396523118019104, 1.5894033908843994, 5.068507194519043, 0.2906918525695801, 0.6549179553985596, 2.6141366958618164, 0.4897134304046631, 0.392608642578125, 1.9255465269088745, 1.0795209407806396, 2.116837501525879, 2.9934611320495605, 0.1694495677947998, 0.2925379276275635, 1.0827724933624268, 0.9708907604217529, 0.728154182434082], "mean_td_error": 1.3718057870864868, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 59.0, "diff_num_grad_updates_vs_sampler_policy": 58.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.069926261901855, "actor_loss": -9.33388614654541, "critic_loss": 0.32506391406059265, "alpha_loss": -0.17520113289356232, "alpha_value": 0.9827520251274109, "log_alpha_value": -0.017398450523614883, "target_entropy": -6.0, "policy_t": 0.04158277437090874, "mean_q": 5.439356803894043, "max_q": 7.836306571960449, "min_q": 3.948119640350342}, "td_error": [0.633636474609375, 0.18111324310302734, 2.4373021125793457, 0.16430330276489258, 1.974048137664795, 0.3796255588531494, 1.3156342506408691, 3.2634050846099854, 1.167829990386963, 1.9355437755584717, 0.9044603109359741, 0.7203671932220459, 0.2169785499572754, 0.7778353691101074, 0.8657560348510742, 0.6904370784759521, 0.1867527961730957, 0.1049802303314209, 1.9594404697418213, 1.9421000480651855, 0.18584370613098145, 1.0979474782943726, 1.2552368640899658, 1.3402442932128906, 0.671532154083252, 2.3502109050750732, 0.08509016036987305, 0.7784510850906372, 0.3175806999206543, 0.5721666812896729, 0.31308257579803467, 0.23970365524291992, 2.392939567565918, 0.29317331314086914, 4.925123691558838, 1.873549461364746, 0.39128804206848145, 1.512336015701294, 0.1552283763885498, 2.559157609939575, 1.0888645648956299, 2.4717485904693604, 2.361239194869995, 0.25482845306396484, 1.5157885551452637, 3.2200028896331787, 0.7539286613464355, 0.8324408531188965, 2.835923910140991, 0.19426965713500977, 0.5045535564422607, 0.3184237480163574, 2.9899747371673584, 0.5513131618499756, 1.8412914276123047, 1.716047763824463, 1.7723639011383057, 0.9737224578857422, 4.589596748352051, 1.117239236831665, 1.183420181274414, 3.3643548488616943, 1.3809623718261719, 0.7641029357910156, 0.3012049198150635, 0.3119053840637207, 1.6406173706054688, 0.08263516426086426, 1.055643081665039, 2.967503309249878, 1.0852110385894775, 0.3883485794067383, 0.4459228515625, 0.6707653999328613, 0.23061418533325195, 1.4912700653076172, 1.0095813274383545, 2.09267520904541, 5.933176040649414, 1.2041680812835693, 0.37918877601623535, 1.9155895709991455, 0.32039380073547363, 2.376448631286621, 1.785079002380371, 1.452413558959961], "mean_td_error": 1.3124208450317383, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 59.0, "diff_num_grad_updates_vs_sampler_policy": 58.0}}, "num_env_steps_sampled": 53760, "num_env_steps_trained": 15222, "num_agent_steps_sampled": 161280, "num_agent_steps_trained": 15222, "last_target_update_ts": 53760, "num_target_updates": 59}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 161280, "num_agent_steps_trained": 15222, "num_env_steps_sampled": 53760, "num_env_steps_trained": 15222, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 459.0469735435465, "num_env_steps_trained_throughput_per_sec": 132.18093657838727, "timesteps_total": 53760, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 161280, "timers": {"training_iteration_time_ms": 1965.814, "sample_time_ms": 1353.272, "load_time_ms": 0.524, "load_throughput": 492818.304, "learn_time_ms": 61.95, "learn_throughput": 4164.63, "synch_weights_time_ms": 15.793}, "counters": {"num_env_steps_sampled": 53760, "num_env_steps_trained": 15222, "num_agent_steps_sampled": 161280, "num_agent_steps_trained": 15222, "last_target_update_ts": 53760, "num_target_updates": 59}, "done": false, "episodes_total": 0, "training_iteration": 60, "trial_id": "566d8_00000", "date": "2023-11-16_22-22-20", "timestamp": 1700202140, "time_this_iter_s": 1.969069004058838, "time_total_s": 121.9141035079956, "pid": 48481, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fb780e85f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 121.9141035079956, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 66.36666666666667, "ram_util_percent": 92.39999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.002006530761719, "actor_loss": -10.712450981140137, "critic_loss": 0.5331060886383057, "alpha_loss": -0.17701026797294617, "alpha_value": 0.982458233833313, "log_alpha_value": -0.017697475850582123, "target_entropy": -6.0, "policy_t": 0.002822691574692726, "mean_q": 6.757072448730469, "max_q": 9.199764251708984, "min_q": 4.892828941345215}, "td_error": [5.684324264526367, 2.643134117126465, 0.5364408493041992, 3.2176547050476074, 3.248344898223877, 2.6237683296203613, 0.8998415470123291, 2.7761456966400146, 2.5928187370300293, 3.072183847427368, 0.9693431854248047, 1.4674718379974365, 0.39258861541748047, 0.4732069969177246, 2.1373658180236816, 1.8724803924560547, 2.8879141807556152, 0.4334592819213867, 1.7663800716400146, 0.3049178123474121, 0.33998680114746094, 3.084852695465088, 3.924928665161133, 1.9030375480651855, 2.097951889038086, 0.4161376953125, 1.5471453666687012, 1.342944622039795, 0.5711090564727783, 0.7828414440155029, 0.39267778396606445, 1.1456413269042969, 0.6300535202026367, 0.5103192329406738, 2.9510436058044434, 0.6287736892700195, 0.548647403717041, 0.6997358798980713, 0.37311482429504395, 1.0396862030029297, 2.4217851161956787, 2.330427408218384, 3.9300405979156494, 0.653386116027832, 0.6246027946472168, 0.25070714950561523, 1.5026130676269531, 2.4041762351989746, 0.5146207809448242, 0.5616455078125, 0.6911382675170898, 3.1335320472717285, 0.8314166069030762, 1.6903221607208252, 1.146871566772461, 1.1467604637145996, 0.09754753112792969, 2.281343698501587, 0.41750192642211914, 0.34702229499816895, 2.1982038021087646, 2.795610189437866, 0.29933834075927734, 2.283946990966797, 2.2156167030334473, 0.13807106018066406, 1.2001385688781738, 1.3459293842315674, 5.909073829650879, 1.3241767883300781, 6.139273643493652, 0.746901273727417, 1.4735825061798096, 1.7676124572753906, 3.2536144256591797, 0.5131652355194092, 0.8898005485534668, 0.33762121200561523, 0.28122615814208984, 4.392605781555176, 1.777219295501709, 5.676882266998291, 0.9269647598266602, 0.08926892280578613, 0.8859126567840576, 0.9862704277038574], "mean_td_error": 1.6483244895935059, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 60.0, "diff_num_grad_updates_vs_sampler_policy": 59.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.045473098754883, "actor_loss": -9.227097511291504, "critic_loss": 0.38914191722869873, "alpha_loss": -0.17791272699832916, "alpha_value": 0.9824451804161072, "log_alpha_value": -0.017710737884044647, "target_entropy": -6.0, "policy_t": 0.01605311408638954, "mean_q": 5.495687961578369, "max_q": 7.507421493530273, "min_q": 4.159143447875977}, "td_error": [3.6885735988616943, 1.0621511936187744, 0.8158442974090576, 1.5096287727355957, 0.39058923721313477, 0.7517895698547363, 1.1580495834350586, 1.1256697177886963, 1.6431159973144531, 3.1267242431640625, 0.7821910381317139, 2.267470598220825, 2.561528205871582, 0.4599510431289673, 1.6123669147491455, 1.2602591514587402, 1.1462059020996094, 0.7891373634338379, 1.5514378547668457, 2.679880380630493, 3.167778968811035, 1.485520601272583, 0.035559654235839844, 0.6810581684112549, 1.265669584274292, 2.3497397899627686, 1.35005784034729, 1.6814098358154297, 2.1879820823669434, 2.6818408966064453, 0.2565586566925049, 1.915968894958496, 0.3328535556793213, 1.482239007949829, 1.4450020790100098, 1.155677080154419, 2.675659418106079, 1.1340341567993164, 0.7703962326049805, 1.399444341659546, 1.7298638820648193, 0.8835384845733643, 1.0099952220916748, 3.139873504638672, 1.2345305681228638, 2.9568896293640137, 5.959843635559082, 0.27219176292419434, 2.08166766166687, 0.3245365619659424, 0.3875739574432373, 1.1858444213867188, 0.14046752452850342, 0.09524011611938477, 0.26708853244781494, 2.7294464111328125, 0.3090503215789795, 0.6552822589874268, 0.954815149307251, 0.5710201263427734, 1.2770044803619385, 0.3376753330230713, 0.8843348026275635, 1.577716588973999, 1.1400015354156494, 1.2183654308319092, 1.9182116985321045, 0.627385139465332, 2.5254783630371094, 0.763124942779541, 0.7109181880950928, 2.2224152088165283, 1.4089512825012207, 0.28227972984313965, 0.7193303108215332, 0.6547191143035889, 1.7090699672698975, 1.960506558418274, 1.7481257915496826, 1.5884757041931152, 1.5147373676300049, 0.5090303421020508, 0.07762479782104492, 1.7894790172576904, 0.28659486770629883, 1.033348560333252], "mean_td_error": 1.3629149198532104, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 60.0, "diff_num_grad_updates_vs_sampler_policy": 59.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.06867790222168, "actor_loss": -9.339797973632812, "critic_loss": 0.32537841796875, "alpha_loss": -0.17819780111312866, "alpha_value": 0.9824574589729309, "log_alpha_value": -0.01769823208451271, "target_entropy": -6.0, "policy_t": -0.0047860704362392426, "mean_q": 5.442856311798096, "max_q": 7.8912458419799805, "min_q": 3.6877694129943848}, "td_error": [0.3129079341888428, 1.0965332984924316, 0.7141971588134766, 2.8412089347839355, 1.717681646347046, 1.7008538246154785, 0.18503904342651367, 0.6211638450622559, 1.5811529159545898, 0.49832653999328613, 1.3585584163665771, 0.4259684085845947, 0.468325138092041, 0.8453471660614014, 1.2425835132598877, 3.685779333114624, 0.71177077293396, 1.5174510478973389, 0.5682723522186279, 0.11722517013549805, 1.0246551036834717, 0.9308257102966309, 1.0457866191864014, 0.16832351684570312, 1.3434476852416992, 0.4608631134033203, 2.507251501083374, 1.3184502124786377, 0.0942389965057373, 1.91691255569458, 0.7877187728881836, 1.0173709392547607, 1.004377841949463, 2.241986036300659, 0.17641282081604004, 1.8001930713653564, 1.1134562492370605, 2.85760760307312, 0.15369582176208496, 2.2513480186462402, 3.147634983062744, 1.1397805213928223, 0.7450628280639648, 0.552070140838623, 0.46665167808532715, 1.8347806930541992, 2.2945363521575928, 3.0341975688934326, 0.7389767169952393, 0.3290257453918457, 1.3784430027008057, 0.1816086769104004, 2.4752607345581055, 2.3865609169006348, 1.223982334136963, 1.0757806301116943, 1.2142829895019531, 0.43157851696014404, 0.08196163177490234, 1.5060076713562012, 0.6724631786346436, 1.8248167037963867, 3.2171034812927246, 2.174906015396118, 0.2377941608428955, 0.620349645614624, 2.4983251094818115, 1.1376471519470215, 0.07761979103088379, 0.13269615173339844, 0.9575133323669434, 2.7672665119171143, 3.853440284729004, 2.546309471130371, 0.7914278507232666, 0.5175807476043701, 5.370047092437744, 0.24765896797180176, 0.4196281433105469, 0.9922435283660889, 1.8148002624511719, 1.0755939483642578, 4.405272960662842, 1.0967602729797363, 0.2681257724761963, 1.3935346603393555], "mean_td_error": 1.322957992553711, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 60.0, "diff_num_grad_updates_vs_sampler_policy": 59.0}}, "num_env_steps_sampled": 54656, "num_env_steps_trained": 15480, "num_agent_steps_sampled": 163968, "num_agent_steps_trained": 15480, "last_target_update_ts": 54656, "num_target_updates": 60}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 163968, "num_agent_steps_trained": 15480, "num_env_steps_sampled": 54656, "num_env_steps_trained": 15480, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 482.7261412493937, "num_env_steps_trained_throughput_per_sec": 138.99926835082988, "timesteps_total": 54656, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 163968, "timers": {"training_iteration_time_ms": 1907.185, "sample_time_ms": 1328.526, "load_time_ms": 0.525, "load_throughput": 491586.986, "learn_time_ms": 61.965, "learn_throughput": 4163.613, "synch_weights_time_ms": 15.222}, "counters": {"num_env_steps_sampled": 54656, "num_env_steps_trained": 15480, "num_agent_steps_sampled": 163968, "num_agent_steps_trained": 15480, "last_target_update_ts": 54656, "num_target_updates": 60}, "done": false, "episodes_total": 0, "training_iteration": 61, "trial_id": "566d8_00000", "date": "2023-11-16_22-22-22", "timestamp": 1700202142, "time_this_iter_s": 1.8715896606445312, "time_total_s": 123.78569316864014, "pid": 48481, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fb780e83af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 123.78569316864014, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 85.75, "ram_util_percent": 92.45}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.007698059082031, "actor_loss": -10.566049575805664, "critic_loss": 0.5433309078216553, "alpha_loss": -0.18010282516479492, "alpha_value": 0.9821645617485046, "log_alpha_value": -0.017996428534388542, "target_entropy": -6.0, "policy_t": 0.010302359238266945, "mean_q": 6.634464740753174, "max_q": 9.277506828308105, "min_q": 4.740667819976807}, "td_error": [3.648104667663574, 1.0033481121063232, 3.6515421867370605, 0.9438183307647705, 1.6170594692230225, 1.2988390922546387, 0.8619976043701172, 0.7725915908813477, 3.3541064262390137, 2.082531213760376, 1.5265257358551025, 0.11509203910827637, 0.11654543876647949, 2.3027076721191406, 2.6880433559417725, 1.3889782428741455, 0.6178178787231445, 3.4067671298980713, 1.4002480506896973, 1.0531361103057861, 2.0854363441467285, 1.6967341899871826, 1.1143701076507568, 0.18030834197998047, 1.6834206581115723, 0.4935791492462158, 0.31686925888061523, 0.5476338863372803, 1.7599070072174072, 0.11644339561462402, 0.2195298671722412, 2.727370500564575, 3.9638242721557617, 5.208064556121826, 1.3682734966278076, 0.441300630569458, 0.42871832847595215, 2.2333834171295166, 0.30234766006469727, 1.8503358364105225, 2.607816457748413, 4.578884124755859, 2.6307153701782227, 0.5984542369842529, 1.3406074047088623, 0.3946261405944824, 2.7206437587738037, 2.4768919944763184, 1.3921737670898438, 0.7561795711517334, 1.2105357646942139, 1.0202200412750244, 2.208897113800049, 1.2883152961730957, 3.154165267944336, 3.373417615890503, 0.2765014171600342, 1.3465943336486816, 3.300915241241455, 1.9437940120697021, 0.9739964008331299, 4.5247697830200195, 2.717027187347412, 0.46342992782592773, 0.9245715141296387, 2.0315816402435303, 0.9707818031311035, 1.6592042446136475, 1.1453850269317627, 1.45418119430542, 3.1757895946502686, 2.8735203742980957, 0.43370723724365234, 1.6408612728118896, 4.450741291046143, 0.16320586204528809, 3.7339704036712646, 2.7510015964508057, 1.3597726821899414, 1.5673058032989502, 2.079522132873535, 0.12135171890258789, 0.050206661224365234, 0.1019899845123291, 1.1150352954864502, 0.5912775993347168], "mean_td_error": 1.6776999235153198, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 61.0, "diff_num_grad_updates_vs_sampler_policy": 60.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.043204307556152, "actor_loss": -9.471173286437988, "critic_loss": 0.4529356062412262, "alpha_loss": -0.1808842420578003, "alpha_value": 0.9821506142616272, "log_alpha_value": -0.018010608851909637, "target_entropy": -6.0, "policy_t": 0.037758879363536835, "mean_q": 5.725193977355957, "max_q": 7.998691082000732, "min_q": 4.040520191192627}, "td_error": [3.4602861404418945, 1.3225412368774414, 0.7641332149505615, 2.1231794357299805, 1.7787973880767822, 2.584308624267578, 0.7695472240447998, 1.9119446277618408, 1.7600829601287842, 0.9992389678955078, 0.559617280960083, 0.3766840696334839, 2.026777744293213, 1.1967334747314453, 1.375387191772461, 0.7438762187957764, 1.315504789352417, 2.24619197845459, 2.6148998737335205, 0.42289113998413086, 0.6556313037872314, 0.46877574920654297, 0.7624142169952393, 1.948380470275879, 1.6366965770721436, 0.5223701000213623, 0.2153458595275879, 4.458056449890137, 1.447221279144287, 1.3721389770507812, 1.1761579513549805, 0.7221159934997559, 1.8436589241027832, 0.4120292663574219, 1.4760746955871582, 2.948909282684326, 0.796259880065918, 1.3899762630462646, 1.840641736984253, 1.0609915256500244, 1.3231287002563477, 0.7961649894714355, 3.3178317546844482, 0.18446874618530273, 2.2889928817749023, 1.4805469512939453, 1.2442784309387207, 4.4758148193359375, 2.5205748081207275, 0.3897716999053955, 1.4555411338806152, 1.2848479747772217, 0.8145277500152588, 0.5040028095245361, 0.5109407901763916, 1.0996806621551514, 1.3240225315093994, 2.3333022594451904, 1.710922122001648, 0.3145759105682373, 2.4324488639831543, 1.0352702140808105, 1.265127420425415, 0.28336501121520996, 3.0169243812561035, 0.4352225065231323, 2.658417224884033, 0.3149566650390625, 0.20239877700805664, 2.4914798736572266, 2.171464443206787, 1.1765408515930176, 0.057219743728637695, 1.0814783573150635, 1.8906219005584717, 0.9911291599273682, 0.615882158279419, 0.7791049480438232, 0.8091704845428467, 0.48984360694885254, 2.7061800956726074, 6.323904514312744, 2.336033582687378, 3.3646817207336426, 3.439749002456665, 2.197111129760742], "mean_td_error": 1.528443455696106, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 61.0, "diff_num_grad_updates_vs_sampler_policy": 60.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.121417999267578, "actor_loss": -9.389520645141602, "critic_loss": 0.2979825735092163, "alpha_loss": -0.1821652203798294, "alpha_value": 0.9821630120277405, "log_alpha_value": -0.017997996881604195, "target_entropy": -6.0, "policy_t": 0.03321767970919609, "mean_q": 5.454763889312744, "max_q": 7.621409893035889, "min_q": 3.894765853881836}, "td_error": [0.690758466720581, 0.561551570892334, 0.1350696086883545, 0.680473804473877, 1.6961474418640137, 0.7954800128936768, 0.7261807918548584, 0.3175973892211914, 1.3904211521148682, 3.4262399673461914, 0.23058772087097168, 0.12260222434997559, 0.5423023700714111, 0.7884488105773926, 3.2498779296875, 0.12895822525024414, 1.0065195560455322, 1.439742088317871, 1.8667027950286865, 1.066169023513794, 1.1617355346679688, 1.4967868328094482, 1.1821424961090088, 2.5728254318237305, 1.478780746459961, 0.23997783660888672, 0.9998478889465332, 1.7747199535369873, 1.2734107971191406, 0.9157676696777344, 4.228398323059082, 2.7633986473083496, 0.7636897563934326, 0.8335280418395996, 4.6136956214904785, 0.9680006504058838, 2.088182210922241, 0.4194653034210205, 0.37039613723754883, 0.847840428352356, 1.49542236328125, 0.836538553237915, 1.8242857456207275, 0.5710537433624268, 0.4409745931625366, 0.12003588676452637, 2.367098808288574, 0.1090080738067627, 1.2097535133361816, 1.3831100463867188, 1.1390182971954346, 0.6478245258331299, 2.9741666316986084, 3.001574993133545, 0.14896154403686523, 0.04073786735534668, 0.7859282493591309, 0.4043135643005371, 2.6520323753356934, 0.14773941040039062, 2.0593879222869873, 0.5676968097686768, 2.6212692260742188, 1.3540582656860352, 0.3686385154724121, 0.10574769973754883, 0.7760617733001709, 1.1021244525909424, 0.2254796028137207, 0.12947893142700195, 0.9024200439453125, 0.5472393035888672, 1.0289387702941895, 0.08582162857055664, 0.38619375228881836, 0.17962408065795898, 0.4236118793487549, 0.6668548583984375, 1.9095089435577393, 1.6009306907653809, 0.4092700481414795, 2.88242244720459, 2.5373122692108154, 2.2407495975494385, 2.0487515926361084, 3.405050039291382], "mean_td_error": 1.217658519744873, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 61.0, "diff_num_grad_updates_vs_sampler_policy": 60.0}}, "num_env_steps_sampled": 55552, "num_env_steps_trained": 15738, "num_agent_steps_sampled": 166656, "num_agent_steps_trained": 15738, "last_target_update_ts": 55552, "num_target_updates": 61}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 166656, "num_agent_steps_trained": 15738, "num_env_steps_sampled": 55552, "num_env_steps_trained": 15738, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 463.50233311568934, "num_env_steps_trained_throughput_per_sec": 133.46384145518732, "timesteps_total": 55552, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 166656, "timers": {"training_iteration_time_ms": 1913.493, "sample_time_ms": 1334.842, "load_time_ms": 0.527, "load_throughput": 489917.798, "learn_time_ms": 62.001, "learn_throughput": 4161.249, "synch_weights_time_ms": 15.19}, "counters": {"num_env_steps_sampled": 55552, "num_env_steps_trained": 15738, "num_agent_steps_sampled": 166656, "num_agent_steps_trained": 15738, "last_target_update_ts": 55552, "num_target_updates": 61}, "done": false, "episodes_total": 0, "training_iteration": 62, "trial_id": "566d8_00000", "date": "2023-11-16_22-22-24", "timestamp": 1700202144, "time_this_iter_s": 1.9486658573150635, "time_total_s": 125.7343590259552, "pid": 48481, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fb7906b0700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 125.7343590259552, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 68.10000000000001, "ram_util_percent": 92.40000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.012983322143555, "actor_loss": -10.685009002685547, "critic_loss": 0.4918752908706665, "alpha_loss": -0.1831907033920288, "alpha_value": 0.9818710088729858, "log_alpha_value": -0.018295317888259888, "target_entropy": -6.0, "policy_t": -0.004759455099701881, "mean_q": 6.62324857711792, "max_q": 9.071556091308594, "min_q": 4.432559967041016}, "td_error": [2.0689525604248047, 1.1316778659820557, 2.826756477355957, 2.410740852355957, 1.18870210647583, 2.4644546508789062, 2.7125635147094727, 0.514263391494751, 3.193209648132324, 0.7383987903594971, 3.954577922821045, 0.8618528842926025, 2.1753900051116943, 0.058326005935668945, 3.228816032409668, 2.4357106685638428, 3.1384458541870117, 2.3194644451141357, 2.613307476043701, 0.2000291347503662, 2.162013292312622, 1.2834277153015137, 0.3217294216156006, 2.660571575164795, 1.0277807712554932, 1.0665044784545898, 0.8721458911895752, 0.6275248527526855, 1.058100700378418, 0.5759129524230957, 1.0940110683441162, 1.0931129455566406, 8.555004119873047, 0.2292487621307373, 0.4650237560272217, 0.84903883934021, 5.629825592041016, 0.4715909957885742, 3.7209510803222656, 1.0707814693450928, 1.6076829433441162, 1.3684139251708984, 1.2788517475128174, 2.666200637817383, 1.564702033996582, 0.47107887268066406, 0.3152351379394531, 0.5680029392242432, 0.8109891414642334, 4.374237060546875, 0.637192964553833, 3.8954906463623047, 0.8817849159240723, 2.290928363800049, 0.4582664966583252, 1.024738073348999, 2.4311609268188477, 0.9079334735870361, 0.9312570095062256, 1.9020557403564453, 0.7535040378570557, 0.6808862686157227, 1.5925483703613281, 1.0939221382141113, 1.5283079147338867, 1.3041009902954102, 0.4377024173736572, 0.3368864059448242, 0.25279951095581055, 0.9779617786407471, 1.9560086727142334, 1.0484418869018555, 0.40880322456359863, 1.3186531066894531, 0.21875476837158203, 1.770888328552246, 1.158944845199585, 3.997729539871216, 0.2776155471801758, 0.3681344985961914, 0.9951565265655518, 1.2880043983459473, 0.4072244167327881, 2.14656925201416, 1.5023808479309082, 0.42844510078430176], "mean_td_error": 1.5547270774841309, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 62.0, "diff_num_grad_updates_vs_sampler_policy": 61.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.974180221557617, "actor_loss": -9.243626594543457, "critic_loss": 0.35133862495422363, "alpha_loss": -0.182631254196167, "alpha_value": 0.9818562269210815, "log_alpha_value": -0.01831040345132351, "target_entropy": -6.0, "policy_t": 0.04523630812764168, "mean_q": 5.580278396606445, "max_q": 7.906017303466797, "min_q": 4.034356594085693}, "td_error": [0.266953706741333, 1.6243343353271484, 0.8605129718780518, 0.8684349060058594, 0.7910060882568359, 2.1161022186279297, 4.003895282745361, 1.5639796257019043, 0.2748582363128662, 0.18878793716430664, 2.6905524730682373, 0.2976505756378174, 0.7986763715744019, 4.965319633483887, 1.01521635055542, 3.1074347496032715, 1.9116017818450928, 1.240679144859314, 0.5323052406311035, 1.223203420639038, 3.844094753265381, 0.21722126007080078, 1.1495671272277832, 3.109330415725708, 1.8717586994171143, 0.681405782699585, 2.9124302864074707, 0.3476996421813965, 1.1531939506530762, 0.8081073760986328, 0.6366103887557983, 2.0160844326019287, 0.8795843124389648, 1.583627700805664, 3.2437760829925537, 0.21614336967468262, 2.994572401046753, 0.18756556510925293, 0.8209407329559326, 1.1055078506469727, 1.2397754192352295, 0.18169760704040527, 0.5770466327667236, 0.8758940696716309, 0.42390942573547363, 3.3040380477905273, 1.8222014904022217, 0.5604801177978516, 0.919827938079834, 0.45799970626831055, 1.9404444694519043, 0.33263349533081055, 1.9906413555145264, 0.4918813705444336, 0.9943604469299316, 1.047788381576538, 1.0757012367248535, 0.3914285898208618, 0.6493213176727295, 0.5697448253631592, 0.610257625579834, 0.44986629486083984, 3.8790535926818848, 0.24779963493347168, 0.7361083030700684, 0.5198434591293335, 1.966855764389038, 0.32710719108581543, 0.48486292362213135, 1.7670848369598389, 0.46300506591796875, 0.25222301483154297, 0.19482874870300293, 0.6965608596801758, 1.5648304224014282, 0.9485986232757568, 2.3996870517730713, 1.667668104171753, 0.507103443145752, 2.523348569869995, 0.37850522994995117, 0.38417625427246094, 1.699892520904541, 0.4097219705581665, 2.0997517108917236, 0.9837582111358643], "mean_td_error": 1.2573261260986328, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 62.0, "diff_num_grad_updates_vs_sampler_policy": 61.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.06014633178711, "actor_loss": -9.409991264343262, "critic_loss": 0.25458240509033203, "alpha_loss": -0.1840793341398239, "alpha_value": 0.9818685054779053, "log_alpha_value": -0.01829787902534008, "target_entropy": -6.0, "policy_t": 0.04930977150797844, "mean_q": 5.540768146514893, "max_q": 7.514969348907471, "min_q": 3.9407894611358643}, "td_error": [1.474829912185669, 1.6675214767456055, 0.3666342496871948, 0.018882274627685547, 1.5692298412322998, 0.11346602439880371, 0.45119738578796387, 0.6083648204803467, 2.1352620124816895, 0.5724480152130127, 0.8611736297607422, 0.37993621826171875, 0.10295963287353516, 0.6828403472900391, 0.11701178550720215, 1.8881497383117676, 1.3553946018218994, 1.2479093074798584, 4.058510780334473, 0.07501578330993652, 0.9648013114929199, 2.068453073501587, 0.06304335594177246, 0.5737447738647461, 2.9375555515289307, 0.758913516998291, 0.10427546501159668, 1.3740301132202148, 1.223883867263794, 0.8997360467910767, 1.4426360130310059, 1.3865103721618652, 0.24510979652404785, 0.7760634422302246, 0.1667630672454834, 0.6463882923126221, 0.25646042823791504, 2.9116082191467285, 0.9701321125030518, 0.5691463947296143, 0.4158658981323242, 1.2951624393463135, 0.594768762588501, 0.44516897201538086, 0.12851333618164062, 0.39885592460632324, 3.04189133644104, 3.094694137573242, 1.1843700408935547, 0.3698098659515381, 0.3057246208190918, 1.4663779735565186, 0.5575268268585205, 1.5915298461914062, 0.5863747596740723, 0.1328139305114746, 2.4449539184570312, 0.2659742832183838, 0.6104843616485596, 1.8186733722686768, 1.7656502723693848, 2.716430187225342, 1.8579344749450684, 0.5121171474456787, 3.3318610191345215, 0.9626951217651367, 1.177900791168213, 0.13602924346923828, 0.4946105480194092, 2.9387638568878174, 0.4797971248626709, 1.4336748123168945, 0.8952844142913818, 0.2410440444946289, 1.7413389682769775, 1.4468798637390137, 0.6009576320648193, 1.9109344482421875, 1.5336756706237793, 1.207524061203003, 2.508772611618042, 1.2894349098205566, 0.35211801528930664, 0.5801851749420166, 1.3967971801757812, 0.11269783973693848], "mean_td_error": 1.0983794927597046, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 62.0, "diff_num_grad_updates_vs_sampler_policy": 61.0}}, "num_env_steps_sampled": 56448, "num_env_steps_trained": 15996, "num_agent_steps_sampled": 169344, "num_agent_steps_trained": 15996, "last_target_update_ts": 56448, "num_target_updates": 62}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 169344, "num_agent_steps_trained": 15996, "num_env_steps_sampled": 56448, "num_env_steps_trained": 15996, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 482.2379042616778, "num_env_steps_trained_throughput_per_sec": 138.85868225392062, "timesteps_total": 56448, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 169344, "timers": {"training_iteration_time_ms": 1907.575, "sample_time_ms": 1329.383, "load_time_ms": 0.524, "load_throughput": 491944.552, "learn_time_ms": 61.963, "learn_throughput": 4163.802, "synch_weights_time_ms": 15.431}, "counters": {"num_env_steps_sampled": 56448, "num_env_steps_trained": 15996, "num_agent_steps_sampled": 169344, "num_agent_steps_trained": 15996, "last_target_update_ts": 56448, "num_target_updates": 62}, "done": false, "episodes_total": 0, "training_iteration": 63, "trial_id": "566d8_00000", "date": "2023-11-16_22-22-25", "timestamp": 1700202145, "time_this_iter_s": 1.874389886856079, "time_total_s": 127.60874891281128, "pid": 48481, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fb7906b0820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 127.60874891281128, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 65.03333333333333, "ram_util_percent": 92.33333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.079784393310547, "actor_loss": -10.538897514343262, "critic_loss": 0.5570898056030273, "alpha_loss": -0.1874251663684845, "alpha_value": 0.9815776348114014, "log_alpha_value": -0.01859416626393795, "target_entropy": -6.0, "policy_t": -0.02050362154841423, "mean_q": 6.711423873901367, "max_q": 9.663588523864746, "min_q": 4.622688293457031}, "td_error": [1.025817632675171, 1.1048803329467773, 0.5876913070678711, 0.43334388732910156, 0.7949085235595703, 3.748979091644287, 4.088581085205078, 1.9275517463684082, 2.1015782356262207, 1.6921014785766602, 0.5125706195831299, 0.5045640468597412, 1.605407953262329, 1.715564489364624, 2.6699137687683105, 0.46846723556518555, 1.7111921310424805, 1.3622336387634277, 3.3303403854370117, 3.768907308578491, 1.4995880126953125, 2.148365020751953, 1.4150958061218262, 1.7965724468231201, 1.3113670349121094, 1.340564250946045, 0.3038959503173828, 0.14464211463928223, 0.36061716079711914, 6.424616813659668, 1.8576185703277588, 2.7614448070526123, 4.037433624267578, 5.223389625549316, 1.6205456256866455, 1.150921106338501, 2.16452693939209, 0.4824256896972656, 1.0850062370300293, 3.322033166885376, 4.002471923828125, 1.045924186706543, 2.132099151611328, 0.32041120529174805, 0.9642465114593506, 0.48390936851501465, 4.974897384643555, 1.9834840297698975, 1.8200225830078125, 1.1033658981323242, 0.37737607955932617, 0.4513685703277588, 1.6208863258361816, 2.9413959980010986, 2.160983085632324, 2.840639591217041, 2.9646811485290527, 0.08779668807983398, 0.31453633308410645, 0.19086956977844238, 1.5407860279083252, 0.19243597984313965, 1.0422163009643555, 0.9538266658782959, 0.7266020774841309, 1.2231025695800781, 3.2051491737365723, 0.8460888862609863, 0.9316613674163818, 1.8879597187042236, 2.899731397628784, 2.458578586578369, 0.1469590663909912, 1.1966662406921387, 3.440260648727417, 0.5163102149963379, 2.627781867980957, 2.4655697345733643, 1.3142199516296387, 0.18564462661743164, 1.4209871292114258, 5.337014198303223, 0.6753299236297607, 0.29208898544311523, 0.07721638679504395, 0.8634963035583496], "mean_td_error": 1.7076084613800049, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 63.0, "diff_num_grad_updates_vs_sampler_policy": 62.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.036439895629883, "actor_loss": -9.150228500366211, "critic_loss": 0.36407768726348877, "alpha_loss": -0.1867777407169342, "alpha_value": 0.9815621376037598, "log_alpha_value": -0.01860995963215828, "target_entropy": -6.0, "policy_t": 0.010314413346350193, "mean_q": 5.520271301269531, "max_q": 7.896291255950928, "min_q": 3.6000375747680664}, "td_error": [1.3722254037857056, 0.26976513862609863, 0.7243623733520508, 1.8863725662231445, 1.3372619152069092, 0.6334433555603027, 1.2982702255249023, 1.1713273525238037, 1.3354895114898682, 2.951817750930786, 1.3763391971588135, 0.03818869590759277, 2.621192216873169, 0.5345457792282104, 1.2470576763153076, 0.8960464000701904, 1.7622604370117188, 0.35559868812561035, 1.5965619087219238, 0.5126450061798096, 1.1422748565673828, 2.8462750911712646, 2.821115732192993, 2.143887996673584, 2.2256898880004883, 0.9083534479141235, 0.7920815944671631, 0.7950787544250488, 1.2258446216583252, 0.3783595561981201, 0.8870794773101807, 1.2532668113708496, 0.9999372959136963, 1.1901767253875732, 1.4993648529052734, 1.5794517993927002, 1.5922698974609375, 0.193406343460083, 1.1551456451416016, 1.2524547576904297, 1.6991448402404785, 0.391385555267334, 3.9505698680877686, 0.4990652799606323, 1.3619475364685059, 1.700730323791504, 2.7694976329803467, 0.35605335235595703, 0.1769275665283203, 3.4247405529022217, 1.3416600227355957, 1.1598505973815918, 5.115171432495117, 3.6288740634918213, 1.1272432804107666, 0.9820916652679443, 1.1514177322387695, 0.453693151473999, 0.7973601818084717, 2.5307719707489014, 0.5997426509857178, 2.18015718460083, 1.8373527526855469, 0.17441487312316895, 1.270251750946045, 2.166802406311035, 1.137131929397583, 1.0169579982757568, 0.577986478805542, 0.7134838104248047, 2.134333610534668, 0.21736431121826172, 0.18025803565979004, 1.4077399969100952, 0.14396929740905762, 0.09096622467041016, 0.6684074401855469, 1.1224405765533447, 1.639890432357788, 0.3326137065887451, 0.5838582515716553, 2.067347764968872, 1.649775505065918, 0.19199514389038086, 0.2635819911956787, 1.2284271717071533], "mean_td_error": 1.2909038066864014, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 63.0, "diff_num_grad_updates_vs_sampler_policy": 62.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.017072677612305, "actor_loss": -9.121520042419434, "critic_loss": 0.33865243196487427, "alpha_loss": -0.18629464507102966, "alpha_value": 0.9815741777420044, "log_alpha_value": -0.018597712740302086, "target_entropy": -6.0, "policy_t": 0.02464292012155056, "mean_q": 5.260709762573242, "max_q": 7.252269744873047, "min_q": 3.8445136547088623}, "td_error": [0.8115136623382568, 0.0658273696899414, 0.09923338890075684, 0.8710834980010986, 1.5428327322006226, 1.6867824792861938, 0.6327552795410156, 1.6942241191864014, 1.3584740161895752, 2.259009838104248, 0.8673322200775146, 0.9765324592590332, 0.7432087659835815, 3.9842352867126465, 0.6033596992492676, 0.2625769376754761, 1.311375617980957, 0.5787177085876465, 1.5876986980438232, 0.08184421062469482, 3.4425792694091797, 0.9331657886505127, 0.6354517936706543, 3.067721128463745, 1.0238440036773682, 0.23232722282409668, 3.168691396713257, 2.616466522216797, 0.7868285179138184, 0.3501451015472412, 2.9391372203826904, 0.5271785259246826, 0.5589923858642578, 1.0318684577941895, 2.0454399585723877, 0.21458172798156738, 4.80501651763916, 0.6342830657958984, 2.0608043670654297, 1.7322371006011963, 4.770748138427734, 1.5933849811553955, 0.39550936222076416, 0.6801106929779053, 1.1233868598937988, 1.1949248313903809, 1.9787755012512207, 0.42064356803894043, 2.5855939388275146, 2.1672604084014893, 0.6111860275268555, 2.9343583583831787, 0.7674665451049805, 1.3132531642913818, 1.1353931427001953, 2.5564041137695312, 0.13220906257629395, 1.061802864074707, 1.7492961883544922, 0.5038719177246094, 0.2478320598602295, 2.0441982746124268, 0.3084104061126709, 1.649104356765747, 0.3016108274459839, 1.055349349975586, 0.8607995510101318, 0.49385714530944824, 0.7334015369415283, 0.19441819190979004, 0.33507561683654785, 0.23041987419128418, 3.595508575439453, 3.7407612800598145, 0.1660747528076172, 2.1665687561035156, 0.3593900203704834, 1.5495238304138184, 1.6366991996765137, 0.723642110824585, 4.42510461807251, 0.07142400741577148, 0.09873151779174805, 2.7277910709381104, 1.6082062721252441, 1.010321855545044], "mean_td_error": 1.358548641204834, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 63.0, "diff_num_grad_updates_vs_sampler_policy": 62.0}}, "num_env_steps_sampled": 57344, "num_env_steps_trained": 16254, "num_agent_steps_sampled": 172032, "num_agent_steps_trained": 16254, "last_target_update_ts": 57344, "num_target_updates": 63}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 172032, "num_agent_steps_trained": 16254, "num_env_steps_sampled": 57344, "num_env_steps_trained": 16254, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 448.6487499877634, "num_env_steps_trained_throughput_per_sec": 129.1868052420122, "timesteps_total": 57344, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 172032, "timers": {"training_iteration_time_ms": 1915.86, "sample_time_ms": 1338.785, "load_time_ms": 0.526, "load_throughput": 490650.842, "learn_time_ms": 62.042, "learn_throughput": 4158.472, "synch_weights_time_ms": 15.376}, "counters": {"num_env_steps_sampled": 57344, "num_env_steps_trained": 16254, "num_agent_steps_sampled": 172032, "num_agent_steps_trained": 16254, "last_target_update_ts": 57344, "num_target_updates": 63}, "done": false, "episodes_total": 0, "training_iteration": 64, "trial_id": "566d8_00000", "date": "2023-11-16_22-22-28", "timestamp": 1700202148, "time_this_iter_s": 2.0135531425476074, "time_total_s": 129.6223020553589, "pid": 48481, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fb7725be1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 129.6223020553589, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 74.8, "ram_util_percent": 92.36666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.923362731933594, "actor_loss": -10.580440521240234, "critic_loss": 0.6103700399398804, "alpha_loss": -0.18748356401920319, "alpha_value": 0.9812842011451721, "log_alpha_value": -0.018893146887421608, "target_entropy": -6.0, "policy_t": -0.05672616511583328, "mean_q": 6.791223049163818, "max_q": 9.730801582336426, "min_q": 4.58985710144043}, "td_error": [0.48131871223449707, 2.8977255821228027, 0.40354371070861816, 2.0473270416259766, 0.5230529308319092, 2.8582019805908203, 3.1796865463256836, 1.8403096199035645, 0.938417911529541, 6.889035224914551, 0.8344247341156006, 0.9910690784454346, 1.6139206886291504, 4.099738121032715, 0.21302270889282227, 2.483412265777588, 0.14186668395996094, 1.8515996932983398, 2.5617804527282715, 1.1957037448883057, 0.9835550785064697, 0.618145227432251, 0.11148524284362793, 3.644066333770752, 0.26552867889404297, 1.8278722763061523, 4.409651756286621, 1.0847160816192627, 0.26700925827026367, 2.126028537750244, 0.8568274974822998, 4.062891006469727, 0.7745797634124756, 0.8559610843658447, 3.157010793685913, 2.755545139312744, 1.7581005096435547, 0.9945104122161865, 1.7957139015197754, 1.107076644897461, 1.5393974781036377, 7.197271823883057, 1.0369577407836914, 0.26553869247436523, 0.3425929546356201, 6.577014446258545, 7.650506973266602, 0.7862622737884521, 1.9120709896087646, 4.860410213470459, 4.2592267990112305, 2.8453638553619385, 1.399050235748291, 1.75724458694458, 0.2793872356414795, 1.833134651184082, 2.549854040145874, 4.824279308319092, 0.630070686340332, 0.8693153858184814, 3.0460257530212402, 1.958575963973999, 0.9541847705841064, 0.9187703132629395, 0.9135100841522217, 0.8862636089324951, 2.169276237487793, 0.8855085372924805, 0.944911003112793, 0.7013802528381348, 1.250412940979004, 0.459230899810791, 0.33080363273620605, 0.43358278274536133, 0.0063135623931884766, 5.407345771789551, 0.7544536590576172, 1.8198528289794922, 2.1781399250030518, 1.0886833667755127, 1.397136926651001, 0.4261641502380371, 0.5669190883636475, 1.647325038909912, 0.4252784252166748, 0.9357161521911621], "mean_td_error": 1.830489993095398, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 64.0, "diff_num_grad_updates_vs_sampler_policy": 63.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.029984474182129, "actor_loss": -9.081496238708496, "critic_loss": 0.3584103584289551, "alpha_loss": -0.18966157734394073, "alpha_value": 0.9812682271003723, "log_alpha_value": -0.018909459933638573, "target_entropy": -6.0, "policy_t": 0.040501780807971954, "mean_q": 5.408604621887207, "max_q": 8.036767959594727, "min_q": 3.5736782550811768}, "td_error": [2.4131758213043213, 2.470994710922241, 1.1176745891571045, 3.678870677947998, 0.3141331672668457, 0.15012240409851074, 0.5110337734222412, 2.6070821285247803, 4.123544216156006, 2.5000131130218506, 5.115677356719971, 0.920680046081543, 1.1273021697998047, 0.7163709402084351, 1.0134868621826172, 1.140413761138916, 0.7474617958068848, 1.947394609451294, 0.5687460899353027, 0.9048919677734375, 1.3528101444244385, 0.2787456512451172, 0.18721985816955566, 0.8163895606994629, 0.6506707668304443, 2.145148754119873, 0.18427801132202148, 0.6376590728759766, 2.026437997817993, 1.1271945238113403, 3.0417792797088623, 0.25331592559814453, 1.1646153926849365, 0.1869819164276123, 1.6883785724639893, 0.7515649795532227, 0.0816183090209961, 1.0210230350494385, 0.4364955425262451, 0.22107148170471191, 0.39035487174987793, 0.18905138969421387, 0.9606101512908936, 0.31546592712402344, 0.9213144779205322, 0.07707762718200684, 1.9645042419433594, 0.9066178798675537, 0.7479283809661865, 0.45183372497558594, 0.3056161403656006, 1.827726125717163, 2.9069643020629883, 2.2956764698028564, 0.35997867584228516, 2.60280704498291, 0.4569571018218994, 0.5402247905731201, 1.3913452625274658, 0.1179354190826416, 0.8155741691589355, 0.2695579528808594, 2.990386724472046, 0.18044614791870117, 1.7665033340454102, 1.9943641424179077, 1.904127597808838, 0.2692997455596924, 3.67071533203125, 0.8065605163574219, 1.1757843494415283, 1.304485559463501, 3.1308953762054443, 0.07348859310150146, 2.0466597080230713, 0.49385643005371094, 1.164343237876892, 0.5254181623458862, 2.320317268371582, 1.9399912357330322, 0.7673897743225098, 1.6064916849136353, 0.258797287940979, 1.6746876239776611, 2.042851209640503, 2.3509058952331543], "mean_td_error": 1.2746087312698364, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 64.0, "diff_num_grad_updates_vs_sampler_policy": 63.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.118179321289062, "actor_loss": -9.196081161499023, "critic_loss": 0.3146352767944336, "alpha_loss": -0.19120724499225616, "alpha_value": 0.9812800288200378, "log_alpha_value": -0.018897395581007004, "target_entropy": -6.0, "policy_t": -0.005214915610849857, "mean_q": 5.337565898895264, "max_q": 7.474659442901611, "min_q": 3.4477458000183105}, "td_error": [4.284362316131592, 0.5187637805938721, 0.4228546619415283, 0.8638515472412109, 1.884063482284546, 0.4918748140335083, 2.8107731342315674, 0.4105890989303589, 0.6153488159179688, 0.7007403373718262, 2.9762158393859863, 1.1937274932861328, 1.2197577953338623, 1.183734655380249, 1.2637183666229248, 0.18117165565490723, 2.6035006046295166, 0.23472392559051514, 0.04735445976257324, 0.24886727333068848, 0.3427610397338867, 2.3572278022766113, 0.7893877029418945, 0.2421131134033203, 2.543623208999634, 1.680023431777954, 3.145871162414551, 1.077791452407837, 1.3709425926208496, 0.7650353908538818, 2.043585777282715, 1.4908792972564697, 0.09536552429199219, 0.7717087268829346, 1.270890235900879, 0.5234785079956055, 0.677757740020752, 1.171726942062378, 0.7615184783935547, 1.8319957256317139, 0.41375732421875, 0.7118105888366699, 0.8735318183898926, 1.5596959590911865, 0.9849035739898682, 0.29829859733581543, 0.5038542747497559, 0.6381914615631104, 0.568455696105957, 0.4197227954864502, 2.108863115310669, 0.19373846054077148, 1.1215393543243408, 1.5224082469940186, 2.026595115661621, 2.7722766399383545, 0.1855144500732422, 1.497675895690918, 5.044888496398926, 1.4453871250152588, 0.12714123725891113, 0.7279921770095825, 0.14233851432800293, 1.0885365009307861, 2.5191073417663574, 1.917377233505249, 2.5244269371032715, 0.16274702548980713, 1.1094191074371338, 0.4176979064941406, 0.14204716682434082, 1.7329094409942627, 2.3030972480773926, 1.9097726345062256, 0.6618402004241943, 0.5085105895996094, 5.144652366638184, 0.40186071395874023, 2.5299410820007324, 4.015113830566406, 0.49385619163513184, 1.1994469165802002, 0.6917157173156738, 0.20302224159240723, 2.257875919342041, 0.9502944946289062], "mean_td_error": 1.2777154445648193, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 64.0, "diff_num_grad_updates_vs_sampler_policy": 63.0}}, "num_env_steps_sampled": 58240, "num_env_steps_trained": 16512, "num_agent_steps_sampled": 174720, "num_agent_steps_trained": 16512, "last_target_update_ts": 58240, "num_target_updates": 64}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 174720, "num_agent_steps_trained": 16512, "num_env_steps_sampled": 58240, "num_env_steps_trained": 16512, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 411.5351261627239, "num_env_steps_trained_throughput_per_sec": 118.50006981024863, "timesteps_total": 58240, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 174720, "timers": {"training_iteration_time_ms": 1940.847, "sample_time_ms": 1349.712, "load_time_ms": 0.543, "load_throughput": 474764.372, "learn_time_ms": 67.346, "learn_throughput": 3830.99, "synch_weights_time_ms": 19.05}, "counters": {"num_env_steps_sampled": 58240, "num_env_steps_trained": 16512, "num_agent_steps_sampled": 174720, "num_agent_steps_trained": 16512, "last_target_update_ts": 58240, "num_target_updates": 64}, "done": false, "episodes_total": 0, "training_iteration": 65, "trial_id": "566d8_00000", "date": "2023-11-16_22-22-30", "timestamp": 1700202150, "time_this_iter_s": 2.3310842514038086, "time_total_s": 131.9533863067627, "pid": 48481, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fb780eabee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 131.9533863067627, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 77.89999999999999, "ram_util_percent": 92.43333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.081117630004883, "actor_loss": -10.489603042602539, "critic_loss": 0.30115747451782227, "alpha_loss": -0.19347532093524933, "alpha_value": 0.9809911251068115, "log_alpha_value": -0.01919185370206833, "target_entropy": -6.0, "policy_t": 0.04320058599114418, "mean_q": 6.608006000518799, "max_q": 9.118715286254883, "min_q": 4.723119735717773}, "td_error": [2.3598294258117676, 0.23898887634277344, 0.8567709922790527, 1.2646493911743164, 0.4338524341583252, 0.40084099769592285, 2.680076837539673, 1.4857864379882812, 0.47365331649780273, 0.5978586673736572, 1.0795483589172363, 1.080960750579834, 0.20703363418579102, 1.6242625713348389, 1.2247774600982666, 1.366994857788086, 2.633371353149414, 0.25826454162597656, 8.100598335266113, 1.1792352199554443, 0.8412156105041504, 3.308842658996582, 2.4815075397491455, 0.3800318241119385, 3.088226795196533, 2.3010735511779785, 0.3963198661804199, 0.31380581855773926, 2.088890314102173, 0.7277071475982666, 2.349510431289673, 0.3061535358428955, 1.41154146194458, 0.5945112705230713, 2.215552806854248, 0.6980571746826172, 0.675055742263794, 3.7938106060028076, 0.519662618637085, 0.40453338623046875, 3.514967918395996, 0.5541055202484131, 4.04948616027832, 1.5570831298828125, 2.9261350631713867, 0.8972463607788086, 0.29428601264953613, 2.3829429149627686, 0.4799380302429199, 1.108391523361206, 1.3914785385131836, 1.972947597503662, 0.09596705436706543, 1.3530826568603516, 0.91721510887146, 1.1613011360168457, 4.355007648468018, 0.9224510192871094, 0.42267394065856934, 0.9060239791870117, 0.18096113204956055, 0.1520981788635254, 1.6550312042236328, 0.5797934532165527, 0.8982107639312744, 1.6251192092895508, 1.197695255279541, 1.1467244625091553, 1.5644984245300293, 0.5202662944793701, 2.1094460487365723, 3.24129056930542, 0.5944268703460693, 0.6360368728637695, 2.433556079864502, 3.344646453857422, 0.9082682132720947, 0.15294599533081055, 1.4888265132904053, 2.021707773208618, 2.42510986328125, 1.0947203636169434, 2.915407419204712, 1.5287842750549316, 3.869509220123291, 0.8387174606323242], "mean_td_error": 1.4980220794677734, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 65.0, "diff_num_grad_updates_vs_sampler_policy": 64.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.131382942199707, "actor_loss": -9.228018760681152, "critic_loss": 0.36134856939315796, "alpha_loss": -0.19461265206336975, "alpha_value": 0.9809744358062744, "log_alpha_value": -0.019208895042538643, "target_entropy": -6.0, "policy_t": -0.027164628729224205, "mean_q": 5.50450325012207, "max_q": 7.506861686706543, "min_q": 4.0008544921875}, "td_error": [0.3846273422241211, 1.3338348865509033, 2.821270227432251, 0.021719932556152344, 0.9780237674713135, 1.5016326904296875, 0.7071754932403564, 0.6569578647613525, 2.6948184967041016, 0.48634886741638184, 0.8760488033294678, 0.44238829612731934, 0.3261479139328003, 0.8772730827331543, 0.5401461124420166, 1.164626955986023, 2.3013484477996826, 1.0569612979888916, 1.4206533432006836, 0.17533016204833984, 2.2075133323669434, 1.2263247966766357, 0.08820009231567383, 3.526939868927002, 0.34560728073120117, 2.1732215881347656, 0.6892963647842407, 3.159608840942383, 1.254652500152588, 0.9894149303436279, 2.9470410346984863, 2.2892088890075684, 4.306675910949707, 0.8581805229187012, 0.7323405742645264, 2.1114721298217773, 4.004572868347168, 0.24385714530944824, 0.2037036418914795, 0.3026769161224365, 1.1595358848571777, 1.359558343887329, 0.11189913749694824, 1.1809742450714111, 1.1681931018829346, 1.2146167755126953, 0.7964174747467041, 0.9849178791046143, 3.3606364727020264, 1.4587008953094482, 0.32089877128601074, 1.266050100326538, 2.533510208129883, 0.14233136177062988, 1.1816902160644531, 0.8498530387878418, 2.5450894832611084, 0.21481037139892578, 0.3970658779144287, 0.793210506439209, 3.8439154624938965, 0.9577903747558594, 1.619598627090454, 1.3773324489593506, 1.048799753189087, 1.752920389175415, 0.46732401847839355, 2.0170302391052246, 4.379277229309082, 0.141463041305542, 1.518815517425537, 0.7314975261688232, 0.3311004638671875, 1.1624245643615723, 0.17051386833190918, 0.5197622776031494, 0.37100911140441895, 1.8582046031951904, 0.6510617733001709, 0.982437014579773, 1.484039545059204, 0.21726536750793457, 0.13627219200134277, 1.2406201362609863, 1.4561381340026855, 0.48128414154052734], "mean_td_error": 1.2602988481521606, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 65.0, "diff_num_grad_updates_vs_sampler_policy": 64.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.10596752166748, "actor_loss": -9.082124710083008, "critic_loss": 0.3003717064857483, "alpha_loss": -0.1940062791109085, "alpha_value": 0.9809858798980713, "log_alpha_value": -0.019197197631001472, "target_entropy": -6.0, "policy_t": 0.01752709038555622, "mean_q": 5.178287982940674, "max_q": 7.521772861480713, "min_q": 3.5527091026306152}, "td_error": [1.5288326740264893, 0.1697530746459961, 0.5878750085830688, 0.791985034942627, 1.4766623973846436, 0.04270625114440918, 0.6477224826812744, 0.6881098747253418, 0.4575371742248535, 0.8477170467376709, 1.2921142578125, 0.28932929039001465, 1.2417025566101074, 1.8939330577850342, 2.352771043777466, 1.246389389038086, 2.2544894218444824, 2.4902560710906982, 0.27013158798217773, 0.551701545715332, 0.7833244800567627, 0.8612284660339355, 0.07970023155212402, 0.7846312522888184, 2.851858377456665, 0.8563296794891357, 1.0116639137268066, 0.7960621118545532, 0.08615851402282715, 0.39756083488464355, 0.9495946168899536, 0.5551247596740723, 0.4485177993774414, 0.707547664642334, 0.7654416561126709, 2.0175352096557617, 3.7327675819396973, 0.7371861934661865, 2.917402744293213, 1.4440510272979736, 0.14498281478881836, 1.3058645725250244, 0.2990431785583496, 1.2184014320373535, 0.02807903289794922, 2.5960562229156494, 2.5168495178222656, 1.7944166660308838, 3.4979236125946045, 0.8246119022369385, 1.9661865234375, 0.845433235168457, 1.2086207866668701, 3.72192645072937, 1.0597447156906128, 3.051311731338501, 1.438002109527588, 1.0930074453353882, 1.2638983726501465, 2.5532424449920654, 0.8223488330841064, 0.5625746250152588, 0.09192800521850586, 2.402378797531128, 3.699571132659912, 1.221597671508789, 2.6752219200134277, 0.8352859020233154, 3.4768457412719727, 0.22014832496643066, 0.9408602714538574, 0.04427480697631836, 0.33947741985321045, 0.267258882522583, 0.6742990016937256, 1.3311843872070312, 0.8666458129882812, 1.4778690338134766, 1.0190186500549316, 1.9347816705703735, 1.3225634098052979, 2.0493059158325195, 1.6039681434631348, 1.1152935028076172, 0.04740095138549805, 0.8218064308166504], "mean_td_error": 1.2581037282943726, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 65.0, "diff_num_grad_updates_vs_sampler_policy": 64.0}}, "num_env_steps_sampled": 59136, "num_env_steps_trained": 16770, "num_agent_steps_sampled": 177408, "num_agent_steps_trained": 16770, "last_target_update_ts": 59136, "num_target_updates": 65}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 177408, "num_agent_steps_trained": 16770, "num_env_steps_sampled": 59136, "num_env_steps_trained": 16770, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 406.46480773453055, "num_env_steps_trained_throughput_per_sec": 117.04008972713045, "timesteps_total": 59136, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 177408, "timers": {"training_iteration_time_ms": 1960.999, "sample_time_ms": 1369.477, "load_time_ms": 0.542, "load_throughput": 475745.376, "learn_time_ms": 67.335, "learn_throughput": 3831.588, "synch_weights_time_ms": 19.697}, "counters": {"num_env_steps_sampled": 59136, "num_env_steps_trained": 16770, "num_agent_steps_sampled": 177408, "num_agent_steps_trained": 16770, "last_target_update_ts": 59136, "num_target_updates": 65}, "done": false, "episodes_total": 0, "training_iteration": 66, "trial_id": "566d8_00000", "date": "2023-11-16_22-22-32", "timestamp": 1700202152, "time_this_iter_s": 2.2184178829193115, "time_total_s": 134.171804189682, "pid": 48481, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fb7906b0820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 134.171804189682, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 82.10000000000001, "ram_util_percent": 92.44999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.042179107666016, "actor_loss": -10.596113204956055, "critic_loss": 0.42563050985336304, "alpha_loss": -0.19572924077510834, "alpha_value": 0.9806979894638062, "log_alpha_value": -0.019490715116262436, "target_entropy": -6.0, "policy_t": -0.010768868960440159, "mean_q": 6.705389022827148, "max_q": 9.07803726196289, "min_q": 4.828794002532959}, "td_error": [0.4742574691772461, 1.5940585136413574, 1.2667765617370605, 1.471174955368042, 0.7697563171386719, 2.1050679683685303, 0.2755453586578369, 1.0282883644104004, 2.6166188716888428, 0.2470536231994629, 0.7213382720947266, 1.3854806423187256, 2.9183478355407715, 4.239460468292236, 2.671597957611084, 3.105741024017334, 1.0447824001312256, 1.544860601425171, 1.9789400100708008, 2.938065767288208, 1.2541327476501465, 0.4952692985534668, 1.1008713245391846, 4.997655391693115, 0.6974735260009766, 2.002105712890625, 0.3736720085144043, 1.4294555187225342, 1.7019758224487305, 0.8929157257080078, 1.6027214527130127, 0.9347739219665527, 2.6986560821533203, 1.522658348083496, 0.9574189186096191, 1.7469456195831299, 0.06307625770568848, 2.2965688705444336, 1.4033851623535156, 1.7642247676849365, 2.2885043621063232, 1.2874655723571777, 1.258735179901123, 5.253345489501953, 6.026264190673828, 3.1006875038146973, 0.7211484909057617, 0.1813342571258545, 2.8826866149902344, 1.9527931213378906, 0.5518307685852051, 1.7181761264801025, 0.7063875198364258, 4.153708457946777, 1.8616669178009033, 4.993102550506592, 1.4131267070770264, 2.5322864055633545, 0.20270919799804688, 3.9291491508483887, 0.8482298851013184, 2.1787166595458984, 6.064950466156006, 0.3727231025695801, 1.9044032096862793, 0.42549729347229004, 4.225078582763672, 5.921516418457031, 1.1622509956359863, 2.0370564460754395, 0.6654973030090332, 4.177443027496338, 1.9129395484924316, 2.483839988708496, 0.949070930480957, 0.37537312507629395, 2.820462703704834, 0.3147706985473633, 1.6370632648468018, 0.6604244709014893, 1.1936025619506836, 2.460615634918213, 0.8404862880706787, 2.125432252883911, 3.245762825012207, 2.6104629039764404], "mean_td_error": 1.9181621074676514, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 66.0, "diff_num_grad_updates_vs_sampler_policy": 65.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.042340278625488, "actor_loss": -8.741100311279297, "critic_loss": 0.2973995804786682, "alpha_loss": -0.19591131806373596, "alpha_value": 0.980680525302887, "log_alpha_value": -0.01950852945446968, "target_entropy": -6.0, "policy_t": -0.035355959087610245, "mean_q": 5.096653461456299, "max_q": 7.295866966247559, "min_q": 3.6847548484802246}, "td_error": [0.37455224990844727, 2.0695295333862305, 1.4933419227600098, 0.3955996036529541, 0.44600021839141846, 0.8351438045501709, 2.505614757537842, 0.2800569534301758, 0.30515360832214355, 1.7641332149505615, 1.27968430519104, 4.561346054077148, 1.4564127922058105, 0.028499603271484375, 1.5112054347991943, 2.2726802825927734, 0.9599490165710449, 0.19423913955688477, 2.269174814224243, 0.25576114654541016, 0.2593533992767334, 2.6160144805908203, 1.6309304237365723, 0.42439162731170654, 2.331075668334961, 0.36307477951049805, 0.8469855785369873, 1.068173885345459, 1.0649216175079346, 1.3608388900756836, 0.5416934490203857, 1.7982590198516846, 0.949718713760376, 2.6470770835876465, 0.7887990474700928, 0.08416938781738281, 1.0259642601013184, 0.6866216659545898, 1.8116822242736816, 1.7343416213989258, 1.065338373184204, 2.6386542320251465, 0.887991189956665, 0.11415386199951172, 1.597660779953003, 0.8766434192657471, 0.6274398565292358, 0.26047325134277344, 1.4584743976593018, 1.5671627521514893, 0.2933732271194458, 1.396897792816162, 0.21608996391296387, 0.6544251441955566, 2.1269397735595703, 0.36283016204833984, 0.8723087310791016, 0.0695565938949585, 2.573418617248535, 0.3529067039489746, 0.36687564849853516, 1.3589255809783936, 0.9706838130950928, 0.6425005197525024, 0.41709399223327637, 1.3164253234863281, 2.3231165409088135, 0.2815133333206177, 1.211962103843689, 2.1031296253204346, 0.14108061790466309, 0.3214637041091919, 1.0136630535125732, 0.7172746658325195, 1.9157779216766357, 0.6656869649887085, 1.473286747932434, 1.620257019996643, 0.9488847255706787, 0.26587235927581787, 2.203007221221924, 0.3906519412994385, 5.527279853820801, 1.611121654510498, 0.8315300941467285, 0.28835463523864746], "mean_td_error": 1.1654921770095825, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 66.0, "diff_num_grad_updates_vs_sampler_policy": 65.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.010089874267578, "actor_loss": -8.982559204101562, "critic_loss": 0.30873245000839233, "alpha_loss": -0.1951674520969391, "alpha_value": 0.9806917905807495, "log_alpha_value": -0.01949707604944706, "target_entropy": -6.0, "policy_t": 0.039405662566423416, "mean_q": 5.1243510246276855, "max_q": 7.513906478881836, "min_q": 3.476850986480713}, "td_error": [1.06685209274292, 0.6947102546691895, 1.7609927654266357, 1.599185824394226, 1.548330307006836, 1.0044724941253662, 1.488757848739624, 0.27094054222106934, 2.4680252075195312, 0.5819933414459229, 0.5723183155059814, 1.4338371753692627, 0.831749677658081, 2.684544563293457, 2.242990255355835, 0.8153088092803955, 0.16828703880310059, 1.9752259254455566, 2.422168254852295, 1.809126615524292, 2.777574062347412, 0.6371326446533203, 2.2970452308654785, 0.2895853519439697, 1.1879854202270508, 1.6615192890167236, 1.5073070526123047, 1.3008432388305664, 1.229499101638794, 0.6487216949462891, 0.28818511962890625, 0.508134126663208, 1.1132175922393799, 0.16890168190002441, 0.1260150671005249, 0.5354743003845215, 0.24520254135131836, 1.25840425491333, 2.3659169673919678, 0.1397113800048828, 1.074430227279663, 0.6919848918914795, 1.6545250415802002, 1.4742615222930908, 2.0689244270324707, 1.433057427406311, 2.133059501647949, 1.238915205001831, 2.222634792327881, 0.10152935981750488, 1.478682279586792, 0.26755428314208984, 0.6044061183929443, 2.8988146781921387, 0.49846553802490234, 0.2769815921783447, 1.0306098461151123, 0.5292923450469971, 2.2249059677124023, 2.22340989112854, 2.463754415512085, 0.20555567741394043, 2.2255327701568604, 2.080383539199829, 0.3688124418258667, 1.7349004745483398, 0.08531475067138672, 2.229895830154419, 0.3099021911621094, 1.4577224254608154, 0.9899697303771973, 3.2596096992492676, 0.7557713985443115, 2.5111441612243652, 0.7159239053726196, 2.1370885372161865, 1.7527832984924316, 1.4688221216201782, 1.6795718669891357, 0.08867025375366211, 1.0682342052459717, 0.4980642795562744, 0.6493864059448242, 1.646852970123291, 0.7717386484146118, 2.423198938369751], "mean_td_error": 1.2724562883377075, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 66.0, "diff_num_grad_updates_vs_sampler_policy": 65.0}}, "num_env_steps_sampled": 60032, "num_env_steps_trained": 17028, "num_agent_steps_sampled": 180096, "num_agent_steps_trained": 17028, "last_target_update_ts": 60032, "num_target_updates": 66}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180096, "num_agent_steps_trained": 17028, "num_env_steps_sampled": 60032, "num_env_steps_trained": 17028, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 373.4017942698304, "num_env_steps_trained_throughput_per_sec": 107.51971308216099, "timesteps_total": 60032, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 180096, "timers": {"training_iteration_time_ms": 2011.581, "sample_time_ms": 1381.163, "load_time_ms": 0.542, "load_throughput": 475578.11, "learn_time_ms": 67.134, "learn_throughput": 3843.085, "synch_weights_time_ms": 19.74}, "counters": {"num_env_steps_sampled": 60032, "num_env_steps_trained": 17028, "num_agent_steps_sampled": 180096, "num_agent_steps_trained": 17028, "last_target_update_ts": 60032, "num_target_updates": 66}, "done": false, "episodes_total": 0, "training_iteration": 67, "trial_id": "566d8_00000", "date": "2023-11-16_22-22-35", "timestamp": 1700202155, "time_this_iter_s": 2.4134583473205566, "time_total_s": 136.58526253700256, "pid": 48481, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fb780e7f8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 136.58526253700256, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 76.66666666666667, "ram_util_percent": 92.43333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.095454216003418, "actor_loss": -10.499957084655762, "critic_loss": 0.36524397134780884, "alpha_loss": -0.19978514313697815, "alpha_value": 0.9804049134254456, "log_alpha_value": -0.019789617508649826, "target_entropy": -6.0, "policy_t": 0.026739465072751045, "mean_q": 6.554396629333496, "max_q": 8.997570037841797, "min_q": 4.741656303405762}, "td_error": [0.026669740676879883, 1.3895809650421143, 1.898862600326538, 2.635099172592163, 0.47094297409057617, 0.8816277980804443, 2.1139001846313477, 1.1491591930389404, 0.4428439140319824, 0.3386402130126953, 0.4783501625061035, 1.7735555171966553, 0.6085069179534912, 1.903996229171753, 2.001620054244995, 0.1987781524658203, 3.458244800567627, 1.7986199855804443, 2.1960039138793945, 1.2227330207824707, 3.562758207321167, 1.9908874034881592, 1.776989221572876, 2.135226249694824, 2.3482441902160645, 4.9185686111450195, 1.2417981624603271, 3.7600293159484863, 1.4572710990905762, 1.267151117324829, 1.2470319271087646, 1.4810211658477783, 2.282956123352051, 1.8678362369537354, 0.17900562286376953, 1.515244960784912, 0.8487002849578857, 5.826908588409424, 0.492173433303833, 1.8845241069793701, 3.1327779293060303, 1.3384194374084473, 2.4832162857055664, 1.7215945720672607, 2.1284420490264893, 0.6035501956939697, 1.92252779006958, 1.636547565460205, 2.59092378616333, 0.5150434970855713, 1.3947291374206543, 0.8814175128936768, 3.466465473175049, 0.5243101119995117, 0.5929727554321289, 0.26200318336486816, 4.267739295959473, 0.5461194515228271, 1.7133281230926514, 0.1916515827178955, 4.752017498016357, 0.9459302425384521, 1.5089874267578125, 0.3678281307220459, 0.662785530090332, 0.12578225135803223, 1.9039671421051025, 1.2028238773345947, 0.08422136306762695, 3.415024995803833, 0.2784864902496338, 1.9324066638946533, 1.2041432857513428, 2.485907793045044, 2.118299961090088, 1.09785795211792, 1.8757712841033936, 0.7359066009521484, 0.8100860118865967, 0.39553213119506836, 3.4999139308929443, 2.1997365951538086, 0.9192633628845215, 1.6724579334259033, 0.8799142837524414, 6.871302604675293], "mean_td_error": 1.6852580308914185, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 67.0, "diff_num_grad_updates_vs_sampler_policy": 66.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.011150360107422, "actor_loss": -8.998259544372559, "critic_loss": 0.340053528547287, "alpha_loss": -0.1983020007610321, "alpha_value": 0.9803867936134338, "log_alpha_value": -0.01980811543762684, "target_entropy": -6.0, "policy_t": 0.03500422090291977, "mean_q": 5.338296413421631, "max_q": 7.030754566192627, "min_q": 3.6712348461151123}, "td_error": [0.7872151136398315, 2.8432371616363525, 0.6687474250793457, 1.9696431159973145, 0.6977546215057373, 1.335249423980713, 0.2198314666748047, 2.901492118835449, 0.297802209854126, 4.6799516677856445, 3.6846745014190674, 2.0087316036224365, 1.252251148223877, 1.5966871976852417, 0.5766067504882812, 2.9318673610687256, 1.634366512298584, 0.3022778034210205, 0.8434982299804688, 1.934037208557129, 3.015530824661255, 0.4935879707336426, 0.14482593536376953, 0.030773162841796875, 0.44636082649230957, 1.407989501953125, 0.8445614576339722, 0.21934938430786133, 0.24351811408996582, 1.3251183032989502, 0.6691408157348633, 2.4922637939453125, 1.152382731437683, 2.3249356746673584, 1.0326027870178223, 2.074618339538574, 2.004223108291626, 0.8311834335327148, 0.9472391605377197, 0.9722959995269775, 1.48260498046875, 0.4755079746246338, 1.0876085758209229, 0.5546891689300537, 2.0008349418640137, 2.1921586990356445, 0.5436716079711914, 0.9009037017822266, 0.8835816383361816, 2.3555634021759033, 1.5237886905670166, 1.4423294067382812, 0.7371814250946045, 1.2683804035186768, 0.9998252391815186, 1.1245841979980469, 2.640936851501465, 0.6064231395721436, 3.1234960556030273, 1.315340518951416, 1.2973418235778809, 0.638634443283081, 0.13985180854797363, 0.8577671051025391, 0.8853662014007568, 1.8904485702514648, 0.8087778091430664, 0.2656972408294678, 0.502493143081665, 0.4972364902496338, 0.8934463262557983, 2.017845869064331, 0.8554248809814453, 3.0884523391723633, 0.8052687644958496, 0.8648312091827393, 0.3660011291503906, 0.13485288619995117, 1.7574338912963867, 0.7976162433624268, 0.9054374694824219, 1.901496171951294, 3.743678092956543, 0.3865680694580078, 1.3063938617706299, 0.8068864345550537], "mean_td_error": 1.2966636419296265, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 67.0, "diff_num_grad_updates_vs_sampler_policy": 66.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.114387512207031, "actor_loss": -9.174396514892578, "critic_loss": 0.30158334970474243, "alpha_loss": -0.2002323567867279, "alpha_value": 0.9803978800773621, "log_alpha_value": -0.01979678124189377, "target_entropy": -6.0, "policy_t": 0.00927510391920805, "mean_q": 5.207573890686035, "max_q": 7.216258525848389, "min_q": 3.354661226272583}, "td_error": [1.3587591648101807, 2.1124751567840576, 0.2725999355316162, 2.0390305519104004, 2.6465003490448, 0.6782965660095215, 0.1731092929840088, 0.135239839553833, 1.3086307048797607, 0.4360651969909668, 0.39546704292297363, 0.6288862228393555, 0.7563364505767822, 2.2429370880126953, 0.6574556827545166, 1.7809313535690308, 0.4262080192565918, 2.53281307220459, 0.9191268682479858, 1.0918278694152832, 1.2326900959014893, 1.7686971426010132, 1.9013152122497559, 8.056422233581543, 1.1186180114746094, 1.557974100112915, 0.4828166961669922, 0.7504522800445557, 1.34303879737854, 3.1821560859680176, 2.596989870071411, 0.3798544406890869, 2.61895751953125, 1.451766014099121, 0.24550557136535645, 0.45836329460144043, 1.0349154472351074, 0.2465418577194214, 0.11466145515441895, 2.0311977863311768, 1.7986302375793457, 1.4849700927734375, 3.099613666534424, 0.23982882499694824, 1.4506816864013672, 0.3572920560836792, 1.354562759399414, 0.2326335906982422, 2.2619788646698, 1.2810182571411133, 0.07829904556274414, 1.869025468826294, 1.128255844116211, 1.13641357421875, 0.1141810417175293, 1.95257568359375, 1.5929794311523438, 3.8841423988342285, 1.968548059463501, 0.8619017601013184, 0.9686872959136963, 0.3262603282928467, 1.490783929824829, 1.7718344926834106, 0.1491718292236328, 0.37664544582366943, 0.8148645162582397, 0.31078648567199707, 0.6397619247436523, 1.563768982887268, 1.0024776458740234, 0.763153076171875, 0.8106193542480469, 1.5980803966522217, 0.8061366081237793, 0.3357398509979248, 0.1722090244293213, 4.31921911239624, 0.23114252090454102, 1.1696574687957764, 0.6553425788879395, 1.571812629699707, 0.8214495182037354, 1.2612754106521606, 0.30161499977111816, 0.19171595573425293], "mean_td_error": 1.2527601718902588, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 67.0, "diff_num_grad_updates_vs_sampler_policy": 66.0}}, "num_env_steps_sampled": 60928, "num_env_steps_trained": 17286, "num_agent_steps_sampled": 182784, "num_agent_steps_trained": 17286, "last_target_update_ts": 60928, "num_target_updates": 67}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 182784, "num_agent_steps_trained": 17286, "num_env_steps_sampled": 60928, "num_env_steps_trained": 17286, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 458.2614052095108, "num_env_steps_trained_throughput_per_sec": 131.9547349822029, "timesteps_total": 60928, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 182784, "timers": {"training_iteration_time_ms": 2022.489, "sample_time_ms": 1393.835, "load_time_ms": 0.542, "load_throughput": 475829.053, "learn_time_ms": 67.217, "learn_throughput": 3838.327, "synch_weights_time_ms": 19.812}, "counters": {"num_env_steps_sampled": 60928, "num_env_steps_trained": 17286, "num_agent_steps_sampled": 182784, "num_agent_steps_trained": 17286, "last_target_update_ts": 60928, "num_target_updates": 67}, "done": false, "episodes_total": 0, "training_iteration": 68, "trial_id": "566d8_00000", "date": "2023-11-16_22-22-37", "timestamp": 1700202157, "time_this_iter_s": 1.9719128608703613, "time_total_s": 138.55717539787292, "pid": 48481, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fb7725be1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 138.55717539787292, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 77.66666666666667, "ram_util_percent": 92.40000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.991059303283691, "actor_loss": -10.270007133483887, "critic_loss": 0.2858690023422241, "alpha_loss": -0.20070728659629822, "alpha_value": 0.9801117181777954, "log_alpha_value": -0.020088693127036095, "target_entropy": -6.0, "policy_t": -0.01480342447757721, "mean_q": 6.384316921234131, "max_q": 9.0184907913208, "min_q": 4.535211563110352}, "td_error": [0.23888325691223145, 0.6074087619781494, 0.5572109222412109, 2.890071392059326, 1.1636223793029785, 3.355846405029297, 0.5092353820800781, 0.4323079586029053, 1.8125429153442383, 0.4695765972137451, 0.9800641536712646, 0.400498628616333, 0.2573666572570801, 3.3871548175811768, 2.3578827381134033, 1.7434797286987305, 1.178243637084961, 3.2405102252960205, 0.7568163871765137, 1.682685375213623, 1.3649392127990723, 2.698453426361084, 2.356058359146118, 4.914355278015137, 0.34888696670532227, 0.12089300155639648, 0.6628921031951904, 0.8144183158874512, 0.12672138214111328, 1.7293789386749268, 2.0476653575897217, 0.6941189765930176, 2.1080515384674072, 0.8271136283874512, 0.19001412391662598, 1.5036141872406006, 0.8992857933044434, 1.687162160873413, 1.4629485607147217, 1.345038652420044, 1.0802347660064697, 0.33632516860961914, 1.3297171592712402, 2.582141399383545, 3.3850326538085938, 2.1480610370635986, 0.4972066879272461, 1.287560224533081, 1.7943916320800781, 1.0002334117889404, 1.8571035861968994, 2.3219876289367676, 3.3177125453948975, 0.5058689117431641, 2.0167043209075928, 0.8130152225494385, 1.6511814594268799, 0.29505395889282227, 4.157098293304443, 1.4016847610473633, 2.4917612075805664, 0.20247364044189453, 0.4565246105194092, 1.5859568119049072, 0.2615203857421875, 1.9618327617645264, 1.401106595993042, 0.12230825424194336, 2.3902230262756348, 0.05625200271606445, 1.675919532775879, 3.898888111114502, 1.9005932807922363, 1.2080719470977783, 3.1348516941070557, 1.8973374366760254, 0.41019177436828613, 0.21065235137939453, 0.22719836235046387, 0.30142998695373535, 0.10796761512756348, 1.757936954498291, 1.1811306476593018, 0.14444684982299805, 0.5034914016723633, 1.4332408905029297], "mean_td_error": 1.4026167392730713, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 68.0, "diff_num_grad_updates_vs_sampler_policy": 67.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.03681755065918, "actor_loss": -8.895546913146973, "critic_loss": 0.352179616689682, "alpha_loss": -0.2018161416053772, "alpha_value": 0.980093240737915, "log_alpha_value": -0.020107580348849297, "target_entropy": -6.0, "policy_t": 0.014632293954491615, "mean_q": 5.226993560791016, "max_q": 7.3684306144714355, "min_q": 3.698983907699585}, "td_error": [1.0714728832244873, 3.0252161026000977, 1.8196015357971191, 2.587437391281128, 1.8215467929840088, 1.6059458255767822, 1.2622489929199219, 0.5367686748504639, 1.80002760887146, 1.12178635597229, 1.4406992197036743, 1.1585769653320312, 0.20673048496246338, 2.8381683826446533, 0.318774938583374, 1.106252908706665, 1.792907953262329, 3.2126505374908447, 0.3345755338668823, 1.1113626956939697, 0.26896071434020996, 0.19190526008605957, 2.194622039794922, 1.0223252773284912, 0.6898888349533081, 0.9303333759307861, 0.21642637252807617, 2.585071563720703, 0.3062601089477539, 0.22043871879577637, 0.9980742931365967, 2.3139514923095703, 0.5816434621810913, 0.8325576782226562, 1.2972756624221802, 0.44368529319763184, 1.4124782085418701, 1.074303150177002, 1.6689133644104004, 1.078305959701538, 0.2854565382003784, 2.740626573562622, 1.285364031791687, 0.615584135055542, 1.2583725452423096, 1.9562361240386963, 1.073744773864746, 0.08323609828948975, 1.6931262016296387, 0.7897884845733643, 1.0163545608520508, 1.2416151762008667, 1.8845999240875244, 1.1497678756713867, 0.903076171875, 0.4060080051422119, 0.29757237434387207, 2.0524253845214844, 0.9443564414978027, 1.7833762168884277, 0.6959323883056641, 0.5355987548828125, 0.3485814332962036, 1.0752432346343994, 1.4138751029968262, 2.3220138549804688, 0.3071014881134033, 1.3370306491851807, 0.13219308853149414, 0.17720413208007812, 1.0298689603805542, 2.726027488708496, 0.8794653415679932, 3.3396408557891846, 2.8620262145996094, 3.124235153198242, 0.7057552337646484, 1.8002758026123047, 3.234936237335205, 0.27768731117248535, 2.657031536102295, 2.5875887870788574, 0.5053198337554932, 3.218474864959717, 1.545493245124817, 0.6755737066268921], "mean_td_error": 1.3194772005081177, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 68.0, "diff_num_grad_updates_vs_sampler_policy": 67.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.104326248168945, "actor_loss": -9.10132122039795, "critic_loss": 0.32708632946014404, "alpha_loss": -0.20306259393692017, "alpha_value": 0.9801039695739746, "log_alpha_value": -0.02009659633040428, "target_entropy": -6.0, "policy_t": -0.03822680562734604, "mean_q": 5.123298645019531, "max_q": 7.316727638244629, "min_q": 3.499138832092285}, "td_error": [2.711188316345215, 0.5601966381072998, 1.2649054527282715, 0.8531668186187744, 0.8616857528686523, 2.548560857772827, 2.043461561203003, 0.04898667335510254, 0.9695372581481934, 0.10987615585327148, 2.1714589595794678, 1.0306205749511719, 1.363112211227417, 0.9780356884002686, 2.947965621948242, 3.1532838344573975, 0.4933638572692871, 1.3566408157348633, 0.3498549461364746, 0.3271756172180176, 3.0017402172088623, 1.7002439498901367, 0.5403355360031128, 1.8543248176574707, 1.648439884185791, 0.12571501731872559, 0.5976797342300415, 0.944556474685669, 1.6451210975646973, 0.10909128189086914, 1.3108839988708496, 1.1960375308990479, 1.948033332824707, 0.25485992431640625, 2.567314624786377, 0.22884416580200195, 0.8904628753662109, 2.2689952850341797, 1.108647108078003, 0.29581785202026367, 1.2299659252166748, 0.002212047576904297, 1.8159034252166748, 0.34973621368408203, 0.08017992973327637, 0.797351598739624, 0.25704050064086914, 1.7464141845703125, 1.117548942565918, 1.1443169116973877, 2.456575870513916, 1.7435085773468018, 0.6529669761657715, 1.041421890258789, 1.2599647045135498, 1.2868902683258057, 1.0798966884613037, 2.2482175827026367, 1.4559876918792725, 0.9533934593200684, 1.7749521732330322, 0.26408886909484863, 0.17917275428771973, 1.045844316482544, 0.77951979637146, 1.5255165100097656, 1.3404722213745117, 1.203211784362793, 1.6924372911453247, 1.7612290382385254, 1.4218635559082031, 0.2452843189239502, 2.147604465484619, 4.892156600952148, 0.9445991516113281, 1.5495085716247559, 0.652061939239502, 0.13770055770874023, 1.9343881607055664, 1.598544955253601, 4.968605995178223, 0.7357611656188965, 3.0939977169036865, 1.5983209609985352, 1.1524258852005005, 2.701902151107788], "mean_td_error": 1.3307080268859863, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 68.0, "diff_num_grad_updates_vs_sampler_policy": 67.0}}, "num_env_steps_sampled": 61824, "num_env_steps_trained": 17544, "num_agent_steps_sampled": 185472, "num_agent_steps_trained": 17544, "last_target_update_ts": 61824, "num_target_updates": 68}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 185472, "num_agent_steps_trained": 17544, "num_env_steps_sampled": 61824, "num_env_steps_trained": 17544, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 409.5899109627993, "num_env_steps_trained_throughput_per_sec": 117.93995204062749, "timesteps_total": 61824, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 185472, "timers": {"training_iteration_time_ms": 2051.966, "sample_time_ms": 1425.66, "load_time_ms": 0.545, "load_throughput": 473476.452, "learn_time_ms": 67.402, "learn_throughput": 3827.771, "synch_weights_time_ms": 19.929}, "counters": {"num_env_steps_sampled": 61824, "num_env_steps_trained": 17544, "num_agent_steps_sampled": 185472, "num_agent_steps_trained": 17544, "last_target_update_ts": 61824, "num_target_updates": 68}, "done": false, "episodes_total": 0, "training_iteration": 69, "trial_id": "566d8_00000", "date": "2023-11-16_22-22-39", "timestamp": 1700202159, "time_this_iter_s": 2.2056851387023926, "time_total_s": 140.76286053657532, "pid": 48481, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fb7906b0820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 140.76286053657532, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 85.7, "ram_util_percent": 92.40000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.922296524047852, "actor_loss": -10.225075721740723, "critic_loss": 0.3459780216217041, "alpha_loss": -0.20229239761829376, "alpha_value": 0.9798187613487244, "log_alpha_value": -0.02038765884935856, "target_entropy": -6.0, "policy_t": -0.0684649720788002, "mean_q": 6.3790998458862305, "max_q": 8.919336318969727, "min_q": 4.526552200317383}, "td_error": [1.0784320831298828, 0.6067767143249512, 1.3238461017608643, 0.41265296936035156, 1.09610915184021, 1.143355131149292, 3.5197348594665527, 3.308601140975952, 0.21087312698364258, 1.096179723739624, 0.3073761463165283, 1.54288649559021, 1.1193358898162842, 1.8248646259307861, 0.6430509090423584, 1.8180875778198242, 0.23824763298034668, 2.0530412197113037, 6.237566947937012, 0.7169489860534668, 3.3679535388946533, 1.1334726810455322, 0.6333022117614746, 0.8746087551116943, 1.3339030742645264, 0.49979448318481445, 2.6770260334014893, 1.6745343208312988, 2.18833065032959, 1.24900221824646, 1.6604080200195312, 0.5111050605773926, 0.6542112827301025, 2.006072759628296, 2.5531959533691406, 1.680250883102417, 4.97472620010376, 1.6696979999542236, 2.5393199920654297, 4.362660884857178, 0.8807675838470459, 3.3385396003723145, 0.24229788780212402, 0.9323427677154541, 0.3827941417694092, 0.27104806900024414, 1.61527681350708, 1.7141952514648438, 1.306403636932373, 1.750157117843628, 1.193187952041626, 0.6440372467041016, 1.6579606533050537, 0.4347093105316162, 0.75510573387146, 0.2154843807220459, 0.8070824146270752, 0.13234496116638184, 2.3532724380493164, 0.48644447326660156, 1.2372491359710693, 3.0801844596862793, 1.6789844036102295, 2.268184185028076, 0.28050732612609863, 0.18699049949645996, 0.9090709686279297, 0.2399134635925293, 2.2007248401641846, 1.0753207206726074, 0.6260340213775635, 3.842200756072998, 1.346816062927246, 6.577343463897705, 1.1854889392852783, 5.260026931762695, 1.713991641998291, 1.7532784938812256, 3.636105537414551, 0.14150023460388184, 0.6298911571502686, 2.2930920124053955, 0.9278237819671631, 4.405688762664795, 1.0681204795837402, 0.5690505504608154], "mean_td_error": 1.6138207912445068, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 69.0, "diff_num_grad_updates_vs_sampler_policy": 68.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.07130241394043, "actor_loss": -9.082536697387695, "critic_loss": 0.35547834634780884, "alpha_loss": -0.20552511513233185, "alpha_value": 0.9797998070716858, "log_alpha_value": -0.020407002419233322, "target_entropy": -6.0, "policy_t": 0.027565481141209602, "mean_q": 5.2909393310546875, "max_q": 7.367507457733154, "min_q": 3.5857365131378174}, "td_error": [0.3895125389099121, 0.39885878562927246, 1.1557915210723877, 0.6333580017089844, 4.393168926239014, 0.5053224563598633, 1.163867473602295, 2.177769660949707, 0.5209920406341553, 0.5135288238525391, 0.31416845321655273, 0.35833466053009033, 0.29566025733947754, 3.4370005130767822, 0.7558915615081787, 1.4994362592697144, 1.619581937789917, 2.3363258838653564, 2.3757641315460205, 1.4552276134490967, 5.194270133972168, 3.4153566360473633, 1.8027915954589844, 3.1527230739593506, 1.3908205032348633, 1.7562899589538574, 0.3628978729248047, 0.25063467025756836, 0.370089054107666, 2.0789661407470703, 3.268242597579956, 0.49286818504333496, 1.4133689403533936, 0.17823255062103271, 1.0244603157043457, 1.0067188739776611, 0.10152053833007812, 0.9267066717147827, 0.6926736831665039, 2.46044659614563, 0.7665907144546509, 0.14875173568725586, 0.9268209934234619, 0.20441889762878418, 0.1903247833251953, 0.8362159729003906, 0.5144126415252686, 2.7570197582244873, 0.5688450336456299, 0.48299694061279297, 1.5547599792480469, 0.29160499572753906, 0.6528749465942383, 1.330850601196289, 0.3541138172149658, 0.9277901649475098, 1.1116392612457275, 1.209835171699524, 2.3037829399108887, 0.06289339065551758, 1.4820530414581299, 0.8186507225036621, 0.8785622119903564, 3.445590019226074, 1.7446284294128418, 1.193895697593689, 1.3145548105239868, 2.5866196155548096, 1.7904775142669678, 2.578185558319092, 1.9426355361938477, 1.7450649738311768, 0.9060906171798706, 1.4425969123840332, 1.2447065114974976, 3.279618501663208, 1.9995660781860352, 2.359818935394287, 0.32437801361083984, 1.597341775894165, 0.4335625171661377, 0.6195495128631592, 0.8610761165618896, 1.1176772117614746, 2.3225207328796387, 0.1900186538696289], "mean_td_error": 1.3378560543060303, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 69.0, "diff_num_grad_updates_vs_sampler_policy": 68.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.046025276184082, "actor_loss": -8.98562240600586, "critic_loss": 0.20947867631912231, "alpha_loss": -0.20490355789661407, "alpha_value": 0.9798101186752319, "log_alpha_value": -0.020396482199430466, "target_entropy": -6.0, "policy_t": -0.011908343061804771, "mean_q": 5.068975925445557, "max_q": 7.111608505249023, "min_q": 3.2446606159210205}, "td_error": [0.7089560031890869, 1.2226510047912598, 2.8486220836639404, 1.1357938051223755, 2.1506662368774414, 1.2924563884735107, 2.3190951347351074, 0.8124780654907227, 6.014440536499023, 1.183888554573059, 0.22880935668945312, 2.461803436279297, 1.0373406410217285, 0.024755001068115234, 0.2459573745727539, 1.0923616886138916, 0.47428369522094727, 1.2466316223144531, 1.4182896614074707, 0.24596142768859863, 1.265199899673462, 0.4378376007080078, 0.9004757404327393, 0.3114442825317383, 1.311516284942627, 0.6136037111282349, 1.330698013305664, 0.6395025253295898, 0.689990758895874, 3.2175521850585938, 1.5746958255767822, 1.4510674476623535, 2.2785804271698, 1.198817253112793, 1.9737424850463867, 2.4177682399749756, 0.9020416736602783, 1.1433439254760742, 1.9136302471160889, 4.32606315612793, 0.3747241497039795, 0.7066888809204102, 2.294827461242676, 1.0100189447402954, 0.23426580429077148, 1.7453999519348145, 1.2212765216827393, 2.0565361976623535, 0.14675283432006836, 0.8795952796936035, 0.3046081066131592, 0.31178903579711914, 1.894596815109253, 0.19383466243743896, 1.11298668384552, 1.3565759658813477, 1.6036040782928467, 2.117990255355835, 0.965416669845581, 1.3127458095550537, 0.3413797616958618, 2.521456480026245, 1.1850841045379639, 0.6439025402069092, 3.8847897052764893, 0.13833355903625488, 0.4217543601989746, 3.799189567565918, 0.2599526643753052, 0.7125693559646606, 0.33872532844543457, 2.5545167922973633, 0.4757121801376343, 1.7274911403656006, 2.3257052898406982, 1.421746015548706, 0.7559267282485962, 2.630816698074341, 3.7887516021728516, 0.2795846462249756, 1.9096825122833252, 1.3726248741149902, 1.357978343963623, 0.8323702812194824, 1.0325801372528076, 1.3559787273406982], "mean_td_error": 1.3718098402023315, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 69.0, "diff_num_grad_updates_vs_sampler_policy": 68.0}}, "num_env_steps_sampled": 62720, "num_env_steps_trained": 17802, "num_agent_steps_sampled": 188160, "num_agent_steps_trained": 17802, "last_target_update_ts": 62720, "num_target_updates": 69}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 188160, "num_agent_steps_trained": 17802, "num_env_steps_sampled": 62720, "num_env_steps_trained": 17802, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 401.051327704103, "num_env_steps_trained_throughput_per_sec": 115.48129748622608, "timesteps_total": 62720, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 188160, "timers": {"training_iteration_time_ms": 2080.193, "sample_time_ms": 1457.257, "load_time_ms": 0.544, "load_throughput": 473974.172, "learn_time_ms": 67.365, "learn_throughput": 3829.891, "synch_weights_time_ms": 20.514}, "counters": {"num_env_steps_sampled": 62720, "num_env_steps_trained": 17802, "num_agent_steps_sampled": 188160, "num_agent_steps_trained": 17802, "last_target_update_ts": 62720, "num_target_updates": 69}, "done": false, "episodes_total": 0, "training_iteration": 70, "trial_id": "566d8_00000", "date": "2023-11-16_22-22-41", "timestamp": 1700202161, "time_this_iter_s": 2.248847723007202, "time_total_s": 143.01170825958252, "pid": 48481, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fb7637bab80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 143.01170825958252, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 83.23333333333333, "ram_util_percent": 92.36666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.941141128540039, "actor_loss": -10.18574047088623, "critic_loss": 0.3468281626701355, "alpha_loss": -0.20564596354961395, "alpha_value": 0.979526162147522, "log_alpha_value": -0.020686352625489235, "target_entropy": -6.0, "policy_t": 0.008649217896163464, "mean_q": 6.3461174964904785, "max_q": 8.55355167388916, "min_q": 4.618149757385254}, "td_error": [0.33649492263793945, 2.3714048862457275, 1.6167945861816406, 0.2923002243041992, 6.431036472320557, 0.2164473533630371, 1.0528948307037354, 1.782114028930664, 0.6594715118408203, 5.326013565063477, 3.9916820526123047, 1.6788063049316406, 0.7700865268707275, 2.566167116165161, 2.0553195476531982, 1.884683609008789, 0.6608560085296631, 1.985105276107788, 3.6066205501556396, 4.0267863273620605, 2.394523859024048, 1.07810640335083, 0.19306421279907227, 0.6334841251373291, 1.1889684200286865, 0.4822568893432617, 0.8372948169708252, 0.2938106060028076, 1.8633384704589844, 0.6561031341552734, 1.108555555343628, 0.426616907119751, 4.280588150024414, 1.6331963539123535, 1.7979583740234375, 0.44011950492858887, 1.911625623703003, 0.6280949115753174, 1.2201387882232666, 3.9426939487457275, 3.7727560997009277, 2.9258387088775635, 0.6628439426422119, 3.048701286315918, 0.0753166675567627, 4.139715194702148, 0.3787555694580078, 0.6593525409698486, 1.5195786952972412, 1.45027494430542, 0.15024018287658691, 0.18632125854492188, 0.8162610530853271, 2.1419527530670166, 1.7946267127990723, 0.19854474067687988, 1.0672070980072021, 0.4068751335144043, 2.5354061126708984, 0.831899881362915, 0.158738374710083, 1.8773627281188965, 2.730700731277466, 0.23241186141967773, 2.3486039638519287, 0.5154445171356201, 0.6197082996368408, 1.506697654724121, 0.13902878761291504, 0.8450570106506348, 3.080343246459961, 2.6197190284729004, 2.6984636783599854, 2.0022263526916504, 0.05238485336303711, 0.0941469669342041, 0.4248800277709961, 2.1760106086730957, 0.12586379051208496, 1.4439506530761719, 0.8483364582061768, 1.304539442062378, 0.6416864395141602, 4.623944282531738, 1.135962963104248, 4.897977828979492], "mean_td_error": 1.607305645942688, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 70.0, "diff_num_grad_updates_vs_sampler_policy": 69.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.003702163696289, "actor_loss": -9.056863784790039, "critic_loss": 0.38567763566970825, "alpha_loss": -0.2071414291858673, "alpha_value": 0.9795064330101013, "log_alpha_value": -0.020706476643681526, "target_entropy": -6.0, "policy_t": 0.05739476531744003, "mean_q": 5.269979953765869, "max_q": 7.265714168548584, "min_q": 3.4472155570983887}, "td_error": [2.2146387100219727, 1.0329601764678955, 1.0976736545562744, 1.3382374048233032, 1.0427467823028564, 0.029913902282714844, 0.09478211402893066, 0.9435181617736816, 1.0998256206512451, 0.3369612693786621, 0.1529078483581543, 2.291045904159546, 1.0925018787384033, 0.17524337768554688, 0.2551274299621582, 2.2745327949523926, 2.62595272064209, 0.22578978538513184, 0.655667781829834, 0.19798922538757324, 7.390390396118164, 2.3377797603607178, 1.6084818840026855, 5.249562740325928, 1.8397185802459717, 1.5454261302947998, 0.4526355266571045, 2.1385953426361084, 2.845472812652588, 0.7500417232513428, 2.275543212890625, 1.4808995723724365, 1.74595308303833, 1.5277125835418701, 0.669648289680481, 1.8668437004089355, 0.9964804649353027, 3.031263589859009, 0.7654941082000732, 0.2019486427307129, 0.890500545501709, 2.0972158908843994, 0.33857107162475586, 0.12277889251708984, 1.8579809665679932, 2.7187881469726562, 2.4574832916259766, 2.4040491580963135, 2.3985939025878906, 2.4398088455200195, 1.1966116428375244, 1.8031680583953857, 3.198894500732422, 1.3538334369659424, 0.40081214904785156, 0.4770505428314209, 1.0089857578277588, 1.2562661170959473, 0.654503345489502, 0.3483622074127197, 0.8260743618011475, 0.6245983839035034, 3.5242745876312256, 0.43861818313598633, 1.4174859523773193, 0.1920466423034668, 2.432666778564453, 1.8364896774291992, 1.0004124641418457, 1.3557422161102295, 0.2647380828857422, 1.0278122425079346, 1.1004045009613037, 0.5736010074615479, 1.7657697200775146, 0.8214545249938965, 1.2789199352264404, 1.1353521347045898, 0.5852138996124268, 2.939519166946411, 0.20586729049682617, 0.07112455368041992, 4.225601673126221, 0.2546539306640625, 0.10147452354431152, 0.2649425268173218], "mean_td_error": 1.3905467987060547, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 70.0, "diff_num_grad_updates_vs_sampler_policy": 69.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.031099319458008, "actor_loss": -9.011298179626465, "critic_loss": 0.18231818079948425, "alpha_loss": -0.2076065093278885, "alpha_value": 0.9795163869857788, "log_alpha_value": -0.020696284249424934, "target_entropy": -6.0, "policy_t": 0.04893093556165695, "mean_q": 5.117367267608643, "max_q": 7.248002052307129, "min_q": 3.398299217224121}, "td_error": [1.93827486038208, 0.34932398796081543, 0.2278529405593872, 1.5933997631072998, 0.9634788036346436, 1.8687856197357178, 0.10053801536560059, 1.3213553428649902, 1.017446756362915, 0.6097829341888428, 1.0422940254211426, 0.30909276008605957, 0.6531362533569336, 0.04603219032287598, 0.5700044631958008, 0.5062884092330933, 0.37375903129577637, 2.533892869949341, 2.696932315826416, 1.6921911239624023, 2.261937379837036, 0.7134008407592773, 2.3101792335510254, 2.1032347679138184, 1.0690525770187378, 0.24036991596221924, 0.6575655937194824, 0.5625655651092529, 0.6411762237548828, 3.2403178215026855, 1.1399893760681152, 0.3558495044708252, 1.265594244003296, 1.9993350505828857, 1.8159699440002441, 1.8792176246643066, 0.5473794937133789, 0.16457033157348633, 0.23005664348602295, 2.6758852005004883, 0.20077824592590332, 1.9064979553222656, 0.05490124225616455, 0.21818017959594727, 1.5927647352218628, 1.1709239482879639, 3.053154230117798, 2.0668842792510986, 1.4817628860473633, 0.13583385944366455, 1.7155427932739258, 1.5536118745803833, 2.044602394104004, 0.44181323051452637, 1.0377037525177002, 0.7541868686676025, 0.4177544116973877, 1.066364049911499, 0.9658224582672119, 2.1363565921783447, 1.4397656917572021, 0.2034468650817871, 1.834575891494751, 0.2900536060333252, 0.21988427639007568, 3.895918846130371, 0.8891427516937256, 2.7571732997894287, 3.810575246810913, 1.7752137184143066, 1.4710557460784912, 1.9402148723602295, 1.895014762878418, 0.16280269622802734, 1.9507379531860352, 0.917178750038147, 0.15437138080596924, 1.8237683773040771, 1.0249121189117432, 0.6131806373596191, 2.40979266166687, 1.0306074619293213, 0.7243127822875977, 0.11712253093719482, 1.1902034282684326, 0.2202610969543457], "mean_td_error": 1.2216771841049194, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 70.0, "diff_num_grad_updates_vs_sampler_policy": 69.0}}, "num_env_steps_sampled": 63616, "num_env_steps_trained": 18060, "num_agent_steps_sampled": 190848, "num_agent_steps_trained": 18060, "last_target_update_ts": 63616, "num_target_updates": 70}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 190848, "num_agent_steps_trained": 18060, "num_env_steps_sampled": 63616, "num_env_steps_trained": 18060, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 445.78864893205633, "num_env_steps_trained_throughput_per_sec": 128.363249357668, "timesteps_total": 63616, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 190848, "timers": {"training_iteration_time_ms": 2095.573, "sample_time_ms": 1474.58, "load_time_ms": 0.545, "load_throughput": 473745.921, "learn_time_ms": 67.206, "learn_throughput": 3838.931, "synch_weights_time_ms": 20.56}, "counters": {"num_env_steps_sampled": 63616, "num_env_steps_trained": 18060, "num_agent_steps_sampled": 190848, "num_agent_steps_trained": 18060, "last_target_update_ts": 63616, "num_target_updates": 70}, "done": false, "episodes_total": 0, "training_iteration": 71, "trial_id": "566d8_00000", "date": "2023-11-16_22-22-43", "timestamp": 1700202163, "time_this_iter_s": 2.0260610580444336, "time_total_s": 145.03776931762695, "pid": 48481, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fb763906a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 145.03776931762695, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 80.2, "ram_util_percent": 92.46666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.972570419311523, "actor_loss": -9.963950157165527, "critic_loss": 0.305446982383728, "alpha_loss": -0.20927292108535767, "alpha_value": 0.9792338013648987, "log_alpha_value": -0.02098485454916954, "target_entropy": -6.0, "policy_t": -0.035511694848537445, "mean_q": 6.090118885040283, "max_q": 8.976383209228516, "min_q": 4.211099147796631}, "td_error": [3.632237434387207, 3.6216623783111572, 1.0684118270874023, 1.403984546661377, 2.318228244781494, 0.5231020450592041, 2.4953763484954834, 0.07500052452087402, 0.7147226333618164, 0.4556450843811035, 1.3808374404907227, 2.3828322887420654, 0.45760297775268555, 3.0799880027770996, 0.6863255500793457, 2.177741527557373, 1.6885831356048584, 4.862945079803467, 2.0095887184143066, 1.4610190391540527, 1.5686249732971191, 0.09518909454345703, 0.870133638381958, 0.7515089511871338, 0.06662368774414062, 0.9708502292633057, 2.5045006275177, 2.011577844619751, 0.2733602523803711, 1.275928258895874, 3.0162644386291504, 2.305353879928589, 0.28691840171813965, 0.7243754863739014, 1.1719613075256348, 1.5162863731384277, 0.635533332824707, 1.23667311668396, 1.1789777278900146, 0.2857701778411865, 3.0024075508117676, 1.1335349082946777, 2.4573028087615967, 0.43375635147094727, 0.1286628246307373, 0.0531463623046875, 0.23636913299560547, 1.6410598754882812, 2.2631895542144775, 4.408266067504883, 2.493546724319458, 4.534771919250488, 1.5145893096923828, 0.7157180309295654, 1.5194640159606934, 0.9856438636779785, 2.041304349899292, 0.8571460247039795, 0.8381273746490479, 1.4929440021514893, 0.496201753616333, 1.9434514045715332, 2.346637487411499, 1.7155115604400635, 0.5961768627166748, 0.7868666648864746, 0.32317233085632324, 1.0433917045593262, 3.3589837551116943, 1.0100932121276855, 0.9824762344360352, 1.2151384353637695, 2.1284945011138916, 1.8983030319213867, 2.6600046157836914, 0.3859260082244873, 1.7111029624938965, 0.854870080947876, 2.7625534534454346, 0.9190828800201416, 0.6140451431274414, 0.12122869491577148, 1.219534158706665, 1.2507514953613281, 2.7617104053497314, 1.9865872859954834], "mean_td_error": 1.500994086265564, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 71.0, "diff_num_grad_updates_vs_sampler_policy": 70.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.08741569519043, "actor_loss": -8.849836349487305, "critic_loss": 0.30733007192611694, "alpha_loss": -0.21189448237419128, "alpha_value": 0.9792132377624512, "log_alpha_value": -0.021005824208259583, "target_entropy": -6.0, "policy_t": 0.07252863049507141, "mean_q": 4.981959819793701, "max_q": 6.9898834228515625, "min_q": 3.687110185623169}, "td_error": [4.067722320556641, 0.6721024513244629, 0.4862635135650635, 1.6588544845581055, 0.7651631832122803, 0.30268120765686035, 1.167953372001648, 1.7843775749206543, 1.0260052680969238, 2.035231351852417, 0.1398451328277588, 0.938992977142334, 0.04872894287109375, 0.919611930847168, 1.3071074485778809, 0.31212759017944336, 0.5021697282791138, 0.8647420406341553, 0.10499179363250732, 0.5748410224914551, 2.2300405502319336, 0.2948709726333618, 1.407808542251587, 1.8770086765289307, 0.13460612297058105, 0.4190537929534912, 0.9986358880996704, 1.8374398946762085, 3.4598312377929688, 0.28031396865844727, 0.5383943319320679, 1.362774133682251, 1.1095662117004395, 0.7918686866760254, 4.202702045440674, 2.1718719005584717, 0.7508668899536133, 1.4102637767791748, 0.32454490661621094, 0.2056056261062622, 1.6588091850280762, 0.1678149700164795, 0.949488639831543, 0.06202578544616699, 1.0821688175201416, 1.2429286241531372, 0.08457112312316895, 0.6689913272857666, 1.0199344158172607, 0.6921007633209229, 2.4873762130737305, 0.7759580612182617, 1.5425728559494019, 0.5151705741882324, 0.6199268102645874, 0.4383077621459961, 1.635352373123169, 0.07082390785217285, 1.2829773426055908, 2.1216211318969727, 2.647836446762085, 2.1284661293029785, 0.7851898670196533, 1.410017967224121, 0.46734917163848877, 1.4602138996124268, 0.30074119567871094, 2.4507455825805664, 1.972900629043579, 1.450653314590454, 0.2808816432952881, 2.8256704807281494, 0.46572351455688477, 0.7680509090423584, 1.703188419342041, 2.5789437294006348, 0.3212435245513916, 1.4277985095977783, 3.5048649311065674, 2.3351857662200928, 1.4883880615234375, 0.09399676322937012, 0.10650765895843506, 0.40009891986846924, 2.478703498840332, 1.107334852218628], "mean_td_error": 1.181014060974121, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 71.0, "diff_num_grad_updates_vs_sampler_policy": 70.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0789794921875, "actor_loss": -8.976899147033691, "critic_loss": 0.22447669506072998, "alpha_loss": -0.21161797642707825, "alpha_value": 0.9792228937149048, "log_alpha_value": -0.02099597454071045, "target_entropy": -6.0, "policy_t": 0.012845133431255817, "mean_q": 5.003292560577393, "max_q": 7.080744743347168, "min_q": 3.330955743789673}, "td_error": [0.6352255344390869, 0.7802598476409912, 0.17308545112609863, 1.2690417766571045, 0.8399026393890381, 0.6661295890808105, 0.4863128662109375, 0.47313761711120605, 2.056706428527832, 0.03327798843383789, 1.1440577507019043, 0.10962724685668945, 0.7023587226867676, 1.1088666915893555, 0.21257662773132324, 0.24319815635681152, 1.2732608318328857, 0.6805014610290527, 0.20211195945739746, 0.1844794750213623, 1.53584885597229, 1.7626440525054932, 1.7004895210266113, 2.8092691898345947, 2.19563627243042, 0.5609822273254395, 4.619483470916748, 1.1605772972106934, 1.9656963348388672, 0.5195684432983398, 0.5055646896362305, 0.14929509162902832, 1.8710858821868896, 0.11682724952697754, 2.7730791568756104, 2.175302743911743, 4.593113422393799, 0.757280707359314, 1.054610013961792, 0.23785185813903809, 0.793891191482544, 2.0020785331726074, 0.14310145378112793, 0.48230528831481934, 5.188020706176758, 0.5288949012756348, 0.30426573753356934, 1.0883426666259766, 2.825040817260742, 2.093071937561035, 1.1492385864257812, 4.8484673500061035, 1.1439769268035889, 2.6391825675964355, 1.8330907821655273, 3.4958860874176025, 0.1942451000213623, 1.577927589416504, 0.10837936401367188, 0.2504260540008545, 1.3674945831298828, 3.606229305267334, 0.43738460540771484, 0.3037712574005127, 0.23523378372192383, 4.871779918670654, 1.0938999652862549, 2.9869868755340576, 0.1159820556640625, 0.8962445259094238, 1.6932995319366455, 0.4656529426574707, 0.24843764305114746, 0.15049195289611816, 0.2527344226837158, 0.924214243888855, 2.1471080780029297, 0.4362509250640869, 2.5474467277526855, 2.92716121673584, 2.4431798458099365, 3.79292368888855, 0.8545390367507935, 1.2038912773132324, 5.288132190704346, 1.6497600078582764], "mean_td_error": 1.4182370901107788, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 71.0, "diff_num_grad_updates_vs_sampler_policy": 70.0}}, "num_env_steps_sampled": 64512, "num_env_steps_trained": 18318, "num_agent_steps_sampled": 193536, "num_agent_steps_trained": 18318, "last_target_update_ts": 64512, "num_target_updates": 71}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 193536, "num_agent_steps_trained": 18318, "num_env_steps_sampled": 64512, "num_env_steps_trained": 18318, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 450.34972318223, "num_env_steps_trained_throughput_per_sec": 129.67659439845463, "timesteps_total": 64512, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 193536, "timers": {"training_iteration_time_ms": 2101.219, "sample_time_ms": 1480.212, "load_time_ms": 0.544, "load_throughput": 474681.069, "learn_time_ms": 67.147, "learn_throughput": 3842.332, "synch_weights_time_ms": 20.513}, "counters": {"num_env_steps_sampled": 64512, "num_env_steps_trained": 18318, "num_agent_steps_sampled": 193536, "num_agent_steps_trained": 18318, "last_target_update_ts": 64512, "num_target_updates": 71}, "done": false, "episodes_total": 0, "training_iteration": 72, "trial_id": "566d8_00000", "date": "2023-11-16_22-22-45", "timestamp": 1700202165, "time_this_iter_s": 2.0035860538482666, "time_total_s": 147.04135537147522, "pid": 48481, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fb780e80e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 147.04135537147522, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 72.33333333333333, "ram_util_percent": 92.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.124427795410156, "actor_loss": -10.14963150024414, "critic_loss": 0.34501051902770996, "alpha_loss": -0.21548090875148773, "alpha_value": 0.9789416193962097, "log_alpha_value": -0.021283268928527832, "target_entropy": -6.0, "policy_t": -0.04767751693725586, "mean_q": 6.227574348449707, "max_q": 8.683045387268066, "min_q": 4.472784042358398}, "td_error": [3.583125591278076, 2.7349541187286377, 1.3396508693695068, 0.42029237747192383, 0.861884355545044, 0.07641434669494629, 2.9128475189208984, 0.7463254928588867, 0.4312710762023926, 4.563429355621338, 0.15718436241149902, 3.873443603515625, 2.0147786140441895, 0.2956888675689697, 2.047410726547241, 0.34781980514526367, 2.0847513675689697, 1.7570831775665283, 4.474687576293945, 0.03528714179992676, 2.274120807647705, 0.8237171173095703, 1.208428144454956, 7.2927327156066895, 1.493380069732666, 0.542269229888916, 1.0440917015075684, 0.40023064613342285, 1.1719493865966797, 2.7584033012390137, 2.9746084213256836, 1.0478034019470215, 1.3609812259674072, 1.2051303386688232, 0.9281744956970215, 0.2036576271057129, 1.6858584880828857, 0.9731447696685791, 0.698868989944458, 4.997710227966309, 1.4551165103912354, 1.5365104675292969, 2.322484254837036, 0.4571502208709717, 0.4453284740447998, 0.5581514835357666, 2.609574556350708, 3.194066047668457, 2.2091782093048096, 1.6467773914337158, 2.4518845081329346, 3.166231632232666, 0.6400365829467773, 0.06469559669494629, 0.11940121650695801, 1.3884868621826172, 1.0844454765319824, 2.8496978282928467, 3.2868237495422363, 1.2961807250976562, 1.9022114276885986, 0.9635062217712402, 2.698603630065918, 4.683781147003174, 3.134982109069824, 2.8809642791748047, 0.3367018699645996, 0.2895524501800537, 1.493863821029663, 0.1416919231414795, 0.35988593101501465, 1.3096234798431396, 0.7374200820922852, 2.0086543560028076, 0.8895206451416016, 0.32929348945617676, 0.636627197265625, 0.9399271011352539, 2.1925048828125, 0.9511778354644775, 2.1517553329467773, 0.4535071849822998, 0.7869229316711426, 0.9060616493225098, 3.1922552585601807, 1.3434453010559082], "mean_td_error": 1.6318634748458862, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 72.0, "diff_num_grad_updates_vs_sampler_policy": 71.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.105035781860352, "actor_loss": -8.86769962310791, "critic_loss": 0.3627057671546936, "alpha_loss": -0.21529057621955872, "alpha_value": 0.9789201021194458, "log_alpha_value": -0.021305274218320847, "target_entropy": -6.0, "policy_t": 0.03915614262223244, "mean_q": 5.050642490386963, "max_q": 7.16025447845459, "min_q": 3.470054864883423}, "td_error": [0.3206068277359009, 0.6957230567932129, 0.18420195579528809, 2.3702597618103027, 0.9653704166412354, 0.3933391571044922, 1.4229927062988281, 0.9536905288696289, 0.9278314113616943, 0.8187136650085449, 1.040454387664795, 1.0733270645141602, 0.7334084510803223, 1.0683305263519287, 0.9973443746566772, 2.805637836456299, 2.366985559463501, 0.3084038496017456, 1.9853174686431885, 0.14505600929260254, 2.193479537963867, 2.5493366718292236, 2.9909305572509766, 2.0981521606445312, 0.36683177947998047, 0.38141918182373047, 1.101217269897461, 0.4024244546890259, 0.4594841003417969, 0.813971996307373, 2.5262651443481445, 0.5355343818664551, 0.7462925910949707, 0.07456231117248535, 0.5823390483856201, 0.5486550331115723, 1.3405020236968994, 3.38040828704834, 2.090193033218384, 1.4035362005233765, 0.3791971206665039, 0.32057905197143555, 0.935580849647522, 0.1645817756652832, 0.6532323360443115, 1.8427047729492188, 0.9269579648971558, 2.6999051570892334, 0.9767173528671265, 3.70426869392395, 3.4584107398986816, 0.9122159481048584, 0.10105681419372559, 1.471139669418335, 0.46866297721862793, 0.2958775758743286, 2.9701554775238037, 2.740499258041382, 4.409381866455078, 2.815610408782959, 3.445932149887085, 1.3508164882659912, 0.5580525398254395, 0.5589883327484131, 3.9330780506134033, 2.100670576095581, 0.7285134792327881, 1.2291367053985596, 2.0529932975769043, 2.476487636566162, 0.31403446197509766, 0.18169021606445312, 1.892838954925537, 0.5417463779449463, 0.25688910484313965, 1.9529938697814941, 0.03177809715270996, 2.228271007537842, 0.5943824052810669, 0.060434579849243164, 0.3472018241882324, 0.9954955577850342, 0.5317776203155518, 0.8646910190582275, 1.1787968873977661, 4.943594932556152], "mean_td_error": 1.346052885055542, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 72.0, "diff_num_grad_updates_vs_sampler_policy": 71.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.046957015991211, "actor_loss": -9.014244079589844, "critic_loss": 0.28017815947532654, "alpha_loss": -0.2139568328857422, "alpha_value": 0.9789294600486755, "log_alpha_value": -0.021295687183737755, "target_entropy": -6.0, "policy_t": 0.0163583867251873, "mean_q": 5.082114219665527, "max_q": 7.082674503326416, "min_q": 3.318209409713745}, "td_error": [1.757943868637085, 1.4426486492156982, 2.462984800338745, 1.5913012027740479, 1.024613380432129, 0.603583574295044, 0.41379034519195557, 2.9121296405792236, 0.35642051696777344, 3.7009763717651367, 5.833086967468262, 1.546268343925476, 1.3279755115509033, 3.8854992389678955, 1.5570545196533203, 4.8988142013549805, 0.027378201484680176, 0.25216567516326904, 1.5188584327697754, 1.7271628379821777, 5.329637050628662, 2.038125514984131, 1.1025619506835938, 0.9841827154159546, 0.7833766937255859, 1.06608247756958, 0.8153183460235596, 0.2396392822265625, 1.2361149787902832, 0.060529232025146484, 2.844475030899048, 0.18613266944885254, 2.38440203666687, 0.5440819263458252, 0.7468090057373047, 1.00191068649292, 1.9533157348632812, 0.10758757591247559, 0.3699495792388916, 3.2521932125091553, 1.7001433372497559, 0.6058206558227539, 0.9886763095855713, 2.2624411582946777, 2.274601459503174, 0.4632093906402588, 0.08914923667907715, 1.0842344760894775, 0.5533890724182129, 0.22504901885986328, 3.3152048587799072, 0.24390172958374023, 0.14319252967834473, 0.43131887912750244, 1.1583431959152222, 1.6128063201904297, 2.0615782737731934, 1.0805859565734863, 4.100857734680176, 0.2551107406616211, 0.1224222183227539, 0.7978641986846924, 1.9560883045196533, 5.884197235107422, 3.152061700820923, 2.2401833534240723, 0.6681911945343018, 2.4143424034118652, 0.11019611358642578, 0.17783617973327637, 1.9748008251190186, 0.5133581161499023, 3.0921883583068848, 1.5086781978607178, 2.164156198501587, 2.2953829765319824, 6.932854175567627, 1.9462101459503174, 0.5047764778137207, 2.797342538833618, 1.2180007696151733, 4.2172040939331055, 2.0257134437561035, 2.7236263751983643, 0.2384333610534668, 0.6207032203674316], "mean_td_error": 1.6608548164367676, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 72.0, "diff_num_grad_updates_vs_sampler_policy": 71.0}}, "num_env_steps_sampled": 65408, "num_env_steps_trained": 18576, "num_agent_steps_sampled": 196224, "num_agent_steps_trained": 18576, "last_target_update_ts": 65408, "num_target_updates": 72}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 196224, "num_agent_steps_trained": 18576, "num_env_steps_sampled": 65408, "num_env_steps_trained": 18576, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 467.6436223905707, "num_env_steps_trained_throughput_per_sec": 134.65631091157059, "timesteps_total": 65408, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 196224, "timers": {"training_iteration_time_ms": 2107.017, "sample_time_ms": 1485.772, "load_time_ms": 0.545, "load_throughput": 473041.805, "learn_time_ms": 67.101, "learn_throughput": 3844.966, "synch_weights_time_ms": 20.271}, "counters": {"num_env_steps_sampled": 65408, "num_env_steps_trained": 18576, "num_agent_steps_sampled": 196224, "num_agent_steps_trained": 18576, "last_target_update_ts": 65408, "num_target_updates": 72}, "done": false, "episodes_total": 0, "training_iteration": 73, "trial_id": "566d8_00000", "date": "2023-11-16_22-22-47", "timestamp": 1700202167, "time_this_iter_s": 1.9331481456756592, "time_total_s": 148.97450351715088, "pid": 48481, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fb7637bab80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 148.97450351715088, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 70.93333333333334, "ram_util_percent": 92.46666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.051372528076172, "actor_loss": -9.846613883972168, "critic_loss": 0.335862398147583, "alpha_loss": -0.21692870557308197, "alpha_value": 0.9786491990089417, "log_alpha_value": -0.021581996232271194, "target_entropy": -6.0, "policy_t": -0.02407160773873329, "mean_q": 5.9512434005737305, "max_q": 8.398441314697266, "min_q": 4.527186870574951}, "td_error": [1.2253532409667969, 3.544649839401245, 3.1695611476898193, 3.891371011734009, 1.340857744216919, 1.9194817543029785, 2.8437981605529785, 1.1738829612731934, 3.485785961151123, 0.3152756690979004, 0.45300841331481934, 0.38159871101379395, 0.10086655616760254, 1.516308069229126, 0.5573093891143799, 0.19546031951904297, 1.4911162853240967, 0.7624807357788086, 0.8283581733703613, 5.446846008300781, 1.2119948863983154, 2.2725579738616943, 3.8972346782684326, 1.1340112686157227, 2.484710454940796, 2.004411458969116, 2.1825318336486816, 0.4958474636077881, 0.725372314453125, 0.45624828338623047, 2.0056443214416504, 0.07134222984313965, 1.9093337059020996, 1.015077829360962, 0.41269731521606445, 2.4545562267303467, 3.4289534091949463, 2.1608328819274902, 1.083944320678711, 3.0027124881744385, 1.9153590202331543, 0.4292261600494385, 0.5758929252624512, 0.5761978626251221, 2.217254161834717, 1.6016058921813965, 1.1603972911834717, 7.476794719696045, 3.0958986282348633, 4.5710296630859375, 1.4412882328033447, 1.6836004257202148, 1.6556010246276855, 1.3798303604125977, 0.3698921203613281, 2.400343179702759, 2.555708169937134, 0.3686811923980713, 2.1167328357696533, 1.0260424613952637, 2.02877140045166, 0.41427111625671387, 1.0492374897003174, 1.6121485233306885, 1.478940486907959, 0.16971921920776367, 1.1033236980438232, 0.46094465255737305, 0.312650203704834, 1.2276763916015625, 0.7836718559265137, 1.522125005722046, 0.48812365531921387, 2.1911213397979736, 2.1255812644958496, 1.0252954959869385, 0.44058752059936523, 1.1953179836273193, 0.100555419921875, 0.9184036254882812, 2.82869291305542, 2.4377760887145996, 1.3777101039886475, 0.36190128326416016, 1.5459589958190918, 2.8370862007141113], "mean_td_error": 1.6245157718658447, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 73.0, "diff_num_grad_updates_vs_sampler_policy": 72.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.058298110961914, "actor_loss": -8.937732696533203, "critic_loss": 0.411923348903656, "alpha_loss": -0.2173081487417221, "alpha_value": 0.9786268472671509, "log_alpha_value": -0.021604862064123154, "target_entropy": -6.0, "policy_t": 0.03789521008729935, "mean_q": 5.092385768890381, "max_q": 7.194019794464111, "min_q": 3.611130952835083}, "td_error": [0.6557753086090088, 1.1935443878173828, 4.282033920288086, 1.0942599773406982, 0.5217409133911133, 4.012085437774658, 0.8204047679901123, 0.38732707500457764, 0.19935846328735352, 1.4854938983917236, 0.19324445724487305, 0.24564528465270996, 0.2924528121948242, 0.31453680992126465, 1.8222589492797852, 0.36046385765075684, 1.8654561042785645, 0.5959534645080566, 1.4077239036560059, 0.5492191314697266, 1.874814510345459, 1.2005252838134766, 2.1240501403808594, 1.1403329372406006, 0.10393035411834717, 1.5204520225524902, 4.1828932762146, 0.09493446350097656, 2.1368534564971924, 1.144038438796997, 0.41155457496643066, 1.053339958190918, 0.9752378463745117, 1.4653728008270264, 1.157219648361206, 3.3353583812713623, 1.690674066543579, 0.7736151218414307, 0.794245719909668, 2.0847225189208984, 6.228886127471924, 1.6670913696289062, 0.16092491149902344, 0.7080838680267334, 0.8863732814788818, 2.3554587364196777, 1.0358574390411377, 4.5135908126831055, 1.8975105285644531, 1.0514781475067139, 0.1149599552154541, 2.9094207286834717, 2.088489532470703, 1.3050036430358887, 1.3415381908416748, 1.0511839389801025, 1.4788553714752197, 0.7398180961608887, 2.23547625541687, 0.18277311325073242, 1.804250717163086, 2.476224660873413, 0.9297521114349365, 1.6274895668029785, 0.20122122764587402, 2.6002326011657715, 0.6996078491210938, 1.9245790243148804, 0.6183888912200928, 2.5368411540985107, 1.4060345888137817, 3.904733657836914, 0.2845315933227539, 1.446460247039795, 1.1064198017120361, 0.6150245666503906, 0.08958303928375244, 0.23636913299560547, 0.9714478254318237, 1.7234423160552979, 0.5162913799285889, 1.8004510402679443, 3.8795993328094482, 5.32672643661499, 1.3443429470062256, 1.473741054534912], "mean_td_error": 1.4774384498596191, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 73.0, "diff_num_grad_updates_vs_sampler_policy": 72.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.083305358886719, "actor_loss": -8.854157447814941, "critic_loss": 0.19722282886505127, "alpha_loss": -0.2177523970603943, "alpha_value": 0.9786361455917358, "log_alpha_value": -0.021595338359475136, "target_entropy": -6.0, "policy_t": -0.01932494342327118, "mean_q": 4.932592868804932, "max_q": 6.9515814781188965, "min_q": 3.349738359451294}, "td_error": [0.22210443019866943, 1.2851347923278809, 1.4813334941864014, 1.3634753227233887, 2.037391185760498, 1.032130241394043, 0.5584301948547363, 3.519334077835083, 2.029865264892578, 0.3918517827987671, 0.6072521209716797, 1.771554946899414, 2.5753660202026367, 1.094222068786621, 0.7227051258087158, 0.1067957878112793, 0.9992594718933105, 1.6936438083648682, 1.7323687076568604, 2.4249188899993896, 0.1974043846130371, 0.8869904279708862, 0.3274085521697998, 1.5805087089538574, 0.8054773807525635, 0.5185568332672119, 0.12615156173706055, 1.217200756072998, 0.6346688270568848, 0.6153738498687744, 2.170466423034668, 0.8690389394760132, 2.1124932765960693, 3.0846190452575684, 4.38254451751709, 1.8892383575439453, 1.11885404586792, 0.1833188533782959, 1.7050325870513916, 0.6801915168762207, 2.13016414642334, 3.262359380722046, 0.9040169715881348, 0.6948807239532471, 2.32674503326416, 1.7906391620635986, 0.3113051652908325, 0.21226346492767334, 0.28634142875671387, 1.601349115371704, 0.708343505859375, 0.7204911708831787, 2.4953255653381348, 0.9010629653930664, 0.35797953605651855, 0.361940860748291, 0.7581219673156738, 0.3317382335662842, 1.9505271911621094, 1.2052316665649414, 0.8208842277526855, 4.242114543914795, 0.45612263679504395, 3.668013572692871, 1.2098414897918701, 1.3317651748657227, 0.5324459075927734, 0.6301326751708984, 1.2262221574783325, 0.9300429821014404, 0.30216455459594727, 0.1826920509338379, 3.1442737579345703, 2.012775421142578, 2.116076946258545, 0.8766162395477295, 1.3863427639007568, 1.0500552654266357, 0.4113011360168457, 0.9799586534500122, 0.7886006832122803, 0.4485280513763428, 1.7193169593811035, 0.12879610061645508, 2.9272661209106445, 0.5772444009780884], "mean_td_error": 1.280989408493042, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 73.0, "diff_num_grad_updates_vs_sampler_policy": 72.0}}, "num_env_steps_sampled": 66304, "num_env_steps_trained": 18834, "num_agent_steps_sampled": 198912, "num_agent_steps_trained": 18834, "last_target_update_ts": 66304, "num_target_updates": 73}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 198912, "num_agent_steps_trained": 18834, "num_env_steps_sampled": 66304, "num_env_steps_trained": 18834, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 434.8680709143092, "num_env_steps_trained_throughput_per_sec": 125.21870791952207, "timesteps_total": 66304, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 198912, "timers": {"training_iteration_time_ms": 2113.348, "sample_time_ms": 1491.767, "load_time_ms": 0.545, "load_throughput": 473021.127, "learn_time_ms": 66.837, "learn_throughput": 3860.147, "synch_weights_time_ms": 20.371}, "counters": {"num_env_steps_sampled": 66304, "num_env_steps_trained": 18834, "num_agent_steps_sampled": 198912, "num_agent_steps_trained": 18834, "last_target_update_ts": 66304, "num_target_updates": 73}, "done": false, "episodes_total": 0, "training_iteration": 74, "trial_id": "566d8_00000", "date": "2023-11-16_22-22-49", "timestamp": 1700202169, "time_this_iter_s": 2.0770881175994873, "time_total_s": 151.05159163475037, "pid": 48481, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fb780e85f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 151.05159163475037, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 76.36666666666667, "ram_util_percent": 92.46666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.947803497314453, "actor_loss": -9.927868843078613, "critic_loss": 0.4191586375236511, "alpha_loss": -0.21766604483127594, "alpha_value": 0.9783568382263184, "log_alpha_value": -0.02188081480562687, "target_entropy": -6.0, "policy_t": -0.020328296348452568, "mean_q": 6.156509876251221, "max_q": 8.6465425491333, "min_q": 4.257111072540283}, "td_error": [2.39772629737854, 1.1146817207336426, 0.6225075721740723, 0.46201491355895996, 0.9779536724090576, 2.4796524047851562, 2.03568434715271, 1.7264776229858398, 3.383516311645508, 0.613135814666748, 0.7998936176300049, 2.2110629081726074, 1.4449114799499512, 0.37850379943847656, 0.4516737461090088, 0.13552427291870117, 0.7925317287445068, 0.5998077392578125, 1.0508496761322021, 1.8503329753875732, 0.586268424987793, 3.012404203414917, 7.119156837463379, 3.059948205947876, 1.1906955242156982, 0.8876762390136719, 2.0308918952941895, 6.653975963592529, 1.283883810043335, 1.1321632862091064, 1.3218975067138672, 2.897726058959961, 1.7119429111480713, 5.619687080383301, 4.272067070007324, 3.063835859298706, 3.534550905227661, 3.783351421356201, 2.5599570274353027, 5.657735824584961, 0.31926679611206055, 0.7134373188018799, 1.0361194610595703, 0.7090308666229248, 0.2603466510772705, 0.757178544998169, 2.872493267059326, 2.054626703262329, 0.6195659637451172, 0.7663247585296631, 2.28525447845459, 0.9572896957397461, 3.2374916076660156, 1.4567325115203857, 1.633218765258789, 1.7107131481170654, 0.9105958938598633, 1.5360300540924072, 0.6860933303833008, 1.8871524333953857, 2.3809826374053955, 0.34220242500305176, 2.0040783882141113, 2.295297384262085, 0.8688485622406006, 1.0181026458740234, 5.254734992980957, 0.477827787399292, 0.2662689685821533, 1.7458291053771973, 1.5214431285858154, 0.39714694023132324, 3.6321308612823486, 1.6484274864196777, 2.496187925338745, 3.5912578105926514, 1.694868564605713, 0.1443040370941162, 1.4512054920196533, 1.6367523670196533, 2.7367308139801025, 5.283481121063232, 1.0811710357666016, 2.6887214183807373, 3.0640666484832764, 0.655742883682251], "mean_td_error": 1.903430461883545, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 74.0, "diff_num_grad_updates_vs_sampler_policy": 73.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.069854736328125, "actor_loss": -8.730652809143066, "critic_loss": 0.33973556756973267, "alpha_loss": -0.22057466208934784, "alpha_value": 0.9783337116241455, "log_alpha_value": -0.02190445177257061, "target_entropy": -6.0, "policy_t": 0.07457765191793442, "mean_q": 4.868666648864746, "max_q": 6.785958766937256, "min_q": 3.4156997203826904}, "td_error": [1.0399327278137207, 1.3979852199554443, 0.7158505916595459, 0.4136178493499756, 0.7384130954742432, 0.4654819965362549, 2.9625041484832764, 2.266615867614746, 0.7143858671188354, 0.36977529525756836, 0.7975382804870605, 2.087758779525757, 0.9463595151901245, 0.8637306690216064, 0.7711012363433838, 1.4727325439453125, 2.5120580196380615, 2.1452672481536865, 1.4339138269424438, 0.6062440872192383, 1.2271370887756348, 0.17776286602020264, 0.3606466054916382, 0.7587275505065918, 1.0158495903015137, 1.6858665943145752, 3.003798484802246, 3.3212435245513916, 0.5604875087738037, 1.2563726902008057, 0.6006498336791992, 2.023937702178955, 1.847761631011963, 0.816525936126709, 0.19806194305419922, 0.8306846618652344, 4.627294540405273, 1.6247050762176514, 0.162117600440979, 0.5742630958557129, 1.9465210437774658, 2.321990966796875, 0.946426510810852, 1.2370843887329102, 0.638817310333252, 3.7836198806762695, 2.6544864177703857, 1.4037541151046753, 0.6460392475128174, 3.4839284420013428, 0.26083338260650635, 1.8659369945526123, 2.5096445083618164, 1.0600285530090332, 1.745673418045044, 2.9086289405822754, 1.1964364051818848, 0.573108434677124, 0.318434476852417, 1.6020820140838623, 2.599823236465454, 0.6909494400024414, 0.15184235572814941, 2.129546642303467, 0.25569653511047363, 0.6816219091415405, 0.21950364112854004, 1.590451717376709, 2.0620317459106445, 1.3382980823516846, 0.3333773612976074, 2.3171253204345703, 0.8605000972747803, 0.8033533096313477, 0.3342559337615967, 1.3206428289413452, 0.9034953117370605, 0.5620169639587402, 1.2237558364868164, 0.9793341159820557, 0.8090161085128784, 1.5034985542297363, 2.185404062271118, 1.2062087059020996, 0.555016040802002, 0.19349265098571777], "mean_td_error": 1.3059173822402954, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 74.0, "diff_num_grad_updates_vs_sampler_policy": 73.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.041391372680664, "actor_loss": -9.071541786193848, "critic_loss": 0.2273501455783844, "alpha_loss": -0.21985657513141632, "alpha_value": 0.9783429503440857, "log_alpha_value": -0.02189502865076065, "target_entropy": -6.0, "policy_t": -0.003729718504473567, "mean_q": 5.121514320373535, "max_q": 7.071434020996094, "min_q": 3.260911226272583}, "td_error": [1.439122200012207, 1.603236436843872, 1.1609299182891846, 0.823613166809082, 0.9179672002792358, 0.4932558536529541, 1.6680397987365723, 1.4963427782058716, 4.13380765914917, 6.979806900024414, 3.165886878967285, 6.568937301635742, 0.8745822906494141, 0.17479920387268066, 0.5399534702301025, 0.5619370937347412, 1.1814687252044678, 0.7099699974060059, 2.3169262409210205, 0.656374454498291, 0.3885624408721924, 1.2430658340454102, 1.432011365890503, 2.508833169937134, 1.2537715435028076, 0.772986888885498, 0.12867236137390137, 1.9321110248565674, 0.3220459222793579, 0.43802762031555176, 0.4668552875518799, 0.0627450942993164, 0.5844624042510986, 2.7729580402374268, 3.108210563659668, 0.5620250701904297, 1.3115637302398682, 2.6153457164764404, 1.148155689239502, 2.4539012908935547, 1.5449823141098022, 3.6300065517425537, 0.5205347537994385, 0.5124354362487793, 1.0261051654815674, 0.5574452877044678, 0.8065605163574219, 1.857133388519287, 2.943523645401001, 0.7304518222808838, 0.4097788333892822, 2.059551239013672, 1.3391757011413574, 0.895432710647583, 2.3562142848968506, 1.652277946472168, 1.7883367538452148, 0.17948698997497559, 1.3928656578063965, 1.278646469116211, 1.2168922424316406, 4.6919708251953125, 0.4124715328216553, 1.317154884338379, 0.11620593070983887, 2.6137888431549072, 0.03337597846984863, 0.10488128662109375, 1.8579084873199463, 0.6886327266693115, 1.3174606561660767, 0.16054534912109375, 0.7866995334625244, 1.4446749687194824, 3.4385316371917725, 0.6249005794525146, 3.041023015975952, 0.5735030174255371, 1.4735052585601807, 0.3643341064453125, 0.34719371795654297, 1.00404691696167, 2.1291468143463135, 0.5701416730880737, 0.3300025463104248, 1.2666277885437012], "mean_td_error": 1.4230213165283203, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 74.0, "diff_num_grad_updates_vs_sampler_policy": 73.0}}, "num_env_steps_sampled": 67200, "num_env_steps_trained": 19092, "num_agent_steps_sampled": 201600, "num_agent_steps_trained": 19092, "last_target_update_ts": 67200, "num_target_updates": 74}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 201600, "num_agent_steps_trained": 19092, "num_env_steps_sampled": 67200, "num_env_steps_trained": 19092, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 458.99926119869014, "num_env_steps_trained_throughput_per_sec": 132.16719797908712, "timesteps_total": 67200, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 201600, "timers": {"training_iteration_time_ms": 2090.837, "sample_time_ms": 1482.929, "load_time_ms": 0.53, "load_throughput": 487226.669, "learn_time_ms": 61.467, "learn_throughput": 4197.358, "synch_weights_time_ms": 16.559}, "counters": {"num_env_steps_sampled": 67200, "num_env_steps_trained": 19092, "num_agent_steps_sampled": 201600, "num_agent_steps_trained": 19092, "last_target_update_ts": 67200, "num_target_updates": 74}, "done": false, "episodes_total": 0, "training_iteration": 75, "trial_id": "566d8_00000", "date": "2023-11-16_22-22-51", "timestamp": 1700202171, "time_this_iter_s": 1.9690661430358887, "time_total_s": 153.02065777778625, "pid": 48481, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fb7725be1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 153.02065777778625, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 92.6, "ram_util_percent": 92.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.996328353881836, "actor_loss": -9.715485572814941, "critic_loss": 0.32233256101608276, "alpha_loss": -0.22171306610107422, "alpha_value": 0.9780647158622742, "log_alpha_value": -0.02217945083975792, "target_entropy": -6.0, "policy_t": -0.01437833160161972, "mean_q": 5.945007801055908, "max_q": 8.537653923034668, "min_q": 4.180073261260986}, "td_error": [5.962684154510498, 1.472092866897583, 2.8484973907470703, 1.6820440292358398, 2.1574795246124268, 1.0762484073638916, 1.2471098899841309, 0.5256383419036865, 0.42238640785217285, 2.216717481613159, 1.2535393238067627, 0.9958462715148926, 0.11543917655944824, 0.6147806644439697, 1.533830165863037, 0.31198573112487793, 0.807525634765625, 0.6573276519775391, 0.45296740531921387, 2.448467493057251, 0.6479132175445557, 2.213224411010742, 0.6381754875183105, 0.2993278503417969, 2.015369415283203, 2.2869603633880615, 2.2591373920440674, 3.207521677017212, 2.666350841522217, 0.4527261257171631, 1.372772216796875, 0.6729600429534912, 2.6027512550354004, 0.31401681900024414, 0.29819178581237793, 0.5574851036071777, 0.411898136138916, 5.326925277709961, 2.464052200317383, 0.29699182510375977, 2.7534451484680176, 3.8540380001068115, 1.336881160736084, 4.66756534576416, 1.1521072387695312, 1.33573579788208, 1.9246809482574463, 1.0377111434936523, 0.80008864402771, 1.4606037139892578, 5.3814239501953125, 0.3884396553039551, 0.26735544204711914, 0.13648271560668945, 0.2626612186431885, 0.5558109283447266, 0.13525843620300293, 3.502455711364746, 1.1192550659179688, 0.29552769660949707, 1.776472568511963, 2.9355320930480957, 1.1560640335083008, 0.5596675872802734, 0.8241467475891113, 3.1926589012145996, 1.618725299835205, 1.521611213684082, 0.0951833724975586, 0.9411382675170898, 4.61721134185791, 0.24991989135742188, 1.4633560180664062, 0.7593686580657959, 1.9423902034759521, 3.0175230503082275, 0.48732566833496094, 0.5721349716186523, 2.6571173667907715, 0.6659641265869141, 1.4340574741363525, 2.3035683631896973, 0.5241074562072754, 2.4282195568084717, 0.4517076015472412, 2.3718485832214355], "mean_td_error": 1.5435105562210083, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 75.0, "diff_num_grad_updates_vs_sampler_policy": 74.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.032476425170898, "actor_loss": -8.941210746765137, "critic_loss": 0.3561325669288635, "alpha_loss": -0.2227618247270584, "alpha_value": 0.9780406355857849, "log_alpha_value": -0.022204073145985603, "target_entropy": -6.0, "policy_t": 0.04915222153067589, "mean_q": 5.079839706420898, "max_q": 7.087258815765381, "min_q": 3.2687160968780518}, "td_error": [1.3068972826004028, 1.20858633518219, 5.857137680053711, 0.5344505310058594, 1.054339051246643, 1.6401143074035645, 0.8938767910003662, 2.7683870792388916, 0.28966641426086426, 0.6615599393844604, 0.5295896530151367, 0.8658868074417114, 2.0174126625061035, 0.7001481056213379, 1.3027255535125732, 0.15935444831848145, 0.2372133731842041, 2.4137418270111084, 1.4958457946777344, 2.8053364753723145, 1.179297685623169, 1.1780014038085938, 1.9574816226959229, 0.585860013961792, 0.6418633460998535, 0.34478771686553955, 0.09448075294494629, 0.901984691619873, 0.712491512298584, 0.1391507387161255, 0.8191070556640625, 1.079106092453003, 0.5306289196014404, 0.6851489543914795, 0.7085320949554443, 3.34507417678833, 0.274369478225708, 4.155040740966797, 3.2924704551696777, 0.4896533489227295, 2.3437392711639404, 0.6601872444152832, 0.41409242153167725, 2.599576234817505, 5.587325572967529, 0.5080007314682007, 0.6111812591552734, 0.12006354331970215, 1.0946029424667358, 0.129058837890625, 0.3174278736114502, 1.2478206157684326, 0.3074004650115967, 1.244661808013916, 3.313279628753662, 2.9557723999023438, 0.09618854522705078, 2.0644617080688477, 2.8412179946899414, 2.7374494075775146, 0.5167934894561768, 1.0460050106048584, 1.9474153518676758, 1.5515773296356201, 0.14272809028625488, 2.252624273300171, 0.8561439514160156, 0.5921299457550049, 0.8007526397705078, 2.308852195739746, 0.6091949939727783, 2.8349764347076416, 1.6156420707702637, 1.6481084823608398, 0.5630288124084473, 1.0597987174987793, 0.14296674728393555, 0.32998573780059814, 2.6712512969970703, 1.2691223621368408, 0.49077486991882324, 0.14011991024017334, 1.5243940353393555, 0.593055248260498, 2.5428900718688965, 0.3403453826904297], "mean_td_error": 1.31908118724823, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 75.0, "diff_num_grad_updates_vs_sampler_policy": 74.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.170103073120117, "actor_loss": -9.199588775634766, "critic_loss": 0.2561100721359253, "alpha_loss": -0.2257218211889267, "alpha_value": 0.9780498147010803, "log_alpha_value": -0.022194646298885345, "target_entropy": -6.0, "policy_t": 0.009587526321411133, "mean_q": 5.13477087020874, "max_q": 7.171344757080078, "min_q": 3.3146989345550537}, "td_error": [1.2522435188293457, 3.864213705062866, 1.5651534795761108, 0.9977419376373291, 2.06900954246521, 0.04481077194213867, 1.3239247798919678, 0.34305810928344727, 2.4086241722106934, 2.766958236694336, 1.890873908996582, 3.2657535076141357, 0.20648765563964844, 1.3772132396697998, 2.329345703125, 0.20017099380493164, 0.16585063934326172, 0.6257379055023193, 2.083646535873413, 2.9316720962524414, 0.17015361785888672, 0.20585298538208008, 1.8612565994262695, 0.4973945617675781, 1.1614564657211304, 0.6397932767868042, 7.148309707641602, 1.4972505569458008, 5.542162895202637, 1.0104578733444214, 0.40831542015075684, 1.1153167486190796, 0.6978597640991211, 0.7248910665512085, 2.0969932079315186, 0.6577930450439453, 0.38508009910583496, 0.9134697914123535, 3.718751907348633, 2.474403142929077, 2.772768259048462, 1.2108094692230225, 3.1564390659332275, 0.2079864740371704, 1.2290124893188477, 0.5302443504333496, 0.8078420162200928, 0.06502604484558105, 0.17216992378234863, 0.3135340213775635, 3.929137706756592, 1.4779918193817139, 0.6053259372711182, 1.6637765169143677, 0.4507484436035156, 0.16033554077148438, 2.5936498641967773, 0.618083119392395, 1.4459517002105713, 1.6266953945159912, 3.2505388259887695, 1.2768902778625488, 2.976574420928955, 0.41385316848754883, 0.11616683006286621, 1.211519718170166, 0.3033806085586548, 3.5381217002868652, 0.676223635673523, 0.16820979118347168, 3.71807861328125, 0.5440223217010498, 1.0182936191558838, 2.901703119277954, 2.2117764949798584, 0.409991979598999, 0.8626265525817871, 4.571708679199219, 2.1350855827331543, 3.9137494564056396, 3.2972397804260254, 0.6759512424468994, 0.22990882396697998, 0.8567421436309814, 0.9362466335296631, 1.0690486431121826], "mean_td_error": 1.5460538864135742, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 75.0, "diff_num_grad_updates_vs_sampler_policy": 74.0}}, "num_env_steps_sampled": 68096, "num_env_steps_trained": 19350, "num_agent_steps_sampled": 204288, "num_agent_steps_trained": 19350, "last_target_update_ts": 68096, "num_target_updates": 75}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 204288, "num_agent_steps_trained": 19350, "num_env_steps_sampled": 68096, "num_env_steps_trained": 19350, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 478.33330244653956, "num_env_steps_trained_throughput_per_sec": 137.73436610625805, "timesteps_total": 68096, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 204288, "timers": {"training_iteration_time_ms": 2057.716, "sample_time_ms": 1451.346, "load_time_ms": 0.538, "load_throughput": 479901.739, "learn_time_ms": 61.554, "learn_throughput": 4191.454, "synch_weights_time_ms": 15.93}, "counters": {"num_env_steps_sampled": 68096, "num_env_steps_trained": 19350, "num_agent_steps_sampled": 204288, "num_agent_steps_trained": 19350, "last_target_update_ts": 68096, "num_target_updates": 75}, "done": false, "episodes_total": 0, "training_iteration": 76, "trial_id": "566d8_00000", "date": "2023-11-16_22-22-53", "timestamp": 1700202173, "time_this_iter_s": 1.8895161151885986, "time_total_s": 154.91017389297485, "pid": 48481, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fb79074e940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 154.91017389297485, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 65.10000000000001, "ram_util_percent": 92.46666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.102229118347168, "actor_loss": -9.740978240966797, "critic_loss": 0.3406715393066406, "alpha_loss": -0.2270784229040146, "alpha_value": 0.9777727127075195, "log_alpha_value": -0.022478049620985985, "target_entropy": -6.0, "policy_t": -0.04054103419184685, "mean_q": 5.873693466186523, "max_q": 8.206888198852539, "min_q": 4.141942977905273}, "td_error": [3.0074501037597656, 2.624039888381958, 0.6352508068084717, 0.8234977722167969, 1.8914985656738281, 0.42040419578552246, 3.421799421310425, 6.420062065124512, 0.6107034683227539, 1.4841489791870117, 0.19149088859558105, 0.5104289054870605, 0.4080040454864502, 1.4044361114501953, 3.2736568450927734, 2.5509767532348633, 0.922588586807251, 1.8814573287963867, 2.425179958343506, 0.7923376560211182, 1.6697511672973633, 2.2064435482025146, 4.3704328536987305, 0.201035737991333, 0.8706927299499512, 1.9933862686157227, 3.486823558807373, 1.5173907279968262, 0.34229588508605957, 0.5249967575073242, 2.3262932300567627, 2.4306578636169434, 3.127394437789917, 3.2638180255889893, 0.2941875457763672, 1.1048848628997803, 1.951780080795288, 0.5115070343017578, 0.9899468421936035, 4.5945820808410645, 1.885298252105713, 3.1148288249969482, 0.5413486957550049, 3.304311990737915, 3.0870065689086914, 4.573947906494141, 0.7945966720581055, 1.2627449035644531, 0.4131965637207031, 0.7981095314025879, 1.3636529445648193, 0.5691473484039307, 2.665109395980835, 2.1767234802246094, 1.0264101028442383, 1.0081989765167236, 1.9997942447662354, 0.4712982177734375, 0.18963050842285156, 0.9175710678100586, 0.9986631870269775, 2.3584094047546387, 1.1136903762817383, 1.0642800331115723, 2.641209363937378, 1.0684995651245117, 0.2957727909088135, 0.3203260898590088, 0.4008059501647949, 1.0740408897399902, 4.900570869445801, 1.9716529846191406, 0.5303323268890381, 2.047534942626953, 0.933814525604248, 0.9709093570709229, 0.3792598247528076, 0.44475436210632324, 2.120783805847168, 3.9102115631103516, 3.9049792289733887, 1.3824148178100586, 2.2324252128601074, 0.8137366771697998, 0.8898355960845947, 1.089407205581665], "mean_td_error": 1.6918483972549438, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 76.0, "diff_num_grad_updates_vs_sampler_policy": 75.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.064838409423828, "actor_loss": -8.852222442626953, "critic_loss": 0.4412742257118225, "alpha_loss": -0.2264953851699829, "alpha_value": 0.9777476787567139, "log_alpha_value": -0.022503627464175224, "target_entropy": -6.0, "policy_t": 0.042248331010341644, "mean_q": 4.960259437561035, "max_q": 7.170527458190918, "min_q": 3.3801982402801514}, "td_error": [0.45795881748199463, 0.8555324077606201, 2.278654098510742, 1.8642151355743408, 0.16503167152404785, 2.608837842941284, 2.199892520904541, 2.4825360774993896, 1.1134700775146484, 1.0701013803482056, 5.299491882324219, 1.21415376663208, 0.0833749771118164, 3.0960450172424316, 1.437964916229248, 1.1931242942810059, 5.030240058898926, 2.6292691230773926, 2.6366729736328125, 0.15869593620300293, 0.08960199356079102, 2.7993009090423584, 0.2044053077697754, 0.593528151512146, 4.262798309326172, 0.3272761106491089, 0.6419302225112915, 0.27121877670288086, 0.22205591201782227, 4.451155662536621, 3.559589385986328, 0.8580294847488403, 0.9148814678192139, 0.49256157875061035, 3.8623673915863037, 1.9844779968261719, 1.549724817276001, 0.5450397729873657, 0.3344600200653076, 0.9397344589233398, 1.1057665348052979, 2.92676043510437, 1.1776771545410156, 2.834495782852173, 0.6656646728515625, 0.8728275299072266, 2.0214059352874756, 1.7167943716049194, 1.0213675498962402, 0.0816946029663086, 1.1433346271514893, 2.070878744125366, 0.430553674697876, 0.9482090473175049, 3.5030601024627686, 1.0319925546646118, 1.4523353576660156, 3.212226629257202, 0.8261587619781494, 0.4271981716156006, 2.5673890113830566, 1.0799720287322998, 1.1893174648284912, 2.1721861362457275, 3.4234795570373535, 0.19990825653076172, 1.0393822193145752, 0.4179648160934448, 0.2822716236114502, 2.67486572265625, 2.026326894760132, 1.5650179386138916, 1.3048399686813354, 1.4934569597244263, 0.49724626541137695, 0.9030191898345947, 1.0536048412322998, 1.5811645984649658, 1.2629506587982178, 1.1842126846313477, 2.384575366973877, 0.3712446689605713, 2.117441177368164, 2.8943026065826416, 2.620511531829834, 0.4526536464691162], "mean_td_error": 1.569873332977295, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 76.0, "diff_num_grad_updates_vs_sampler_policy": 75.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.065691947937012, "actor_loss": -8.898741722106934, "critic_loss": 0.18048501014709473, "alpha_loss": -0.2264229953289032, "alpha_value": 0.9777565598487854, "log_alpha_value": -0.02249453030526638, "target_entropy": -6.0, "policy_t": 0.02169470489025116, "mean_q": 4.987897872924805, "max_q": 7.280977725982666, "min_q": 3.146207332611084}, "td_error": [1.5688862800598145, 0.08650350570678711, 0.33730602264404297, 0.8640275001525879, 0.5956623554229736, 0.7470440864562988, 0.8729093074798584, 1.7757436037063599, 2.9724299907684326, 2.1499521732330322, 1.0810365676879883, 0.3433265686035156, 0.19942247867584229, 0.6410160064697266, 0.3823401927947998, 0.5714128017425537, 0.3486783504486084, 0.636502742767334, 2.9200801849365234, 1.2253177165985107, 1.116830587387085, 1.7044713497161865, 1.8021764755249023, 3.8168952465057373, 1.637498140335083, 0.5815873146057129, 0.28188109397888184, 0.5507007837295532, 0.054589271545410156, 0.12835955619812012, 2.549666166305542, 0.7873528003692627, 3.0228936672210693, 1.1785612106323242, 0.6119176149368286, 0.7362909317016602, 0.6727359294891357, 1.2819194793701172, 1.0245267152786255, 2.038074016571045, 0.1231229305267334, 0.11322808265686035, 0.46788954734802246, 0.4046272039413452, 1.8948204517364502, 0.17688000202178955, 1.062129020690918, 1.3798882961273193, 3.810251235961914, 0.18650507926940918, 3.1758615970611572, 2.26052188873291, 0.8528342247009277, 0.9782187938690186, 2.2063519954681396, 3.0170185565948486, 1.191950798034668, 1.2718825340270996, 1.644416332244873, 1.7026853561401367, 0.7615206241607666, 0.9604108333587646, 2.823822498321533, 0.7965707778930664, 0.08845531940460205, 0.8152581453323364, 0.8230032920837402, 1.5301337242126465, 1.6773492097854614, 0.2787308692932129, 0.7437952756881714, 2.573512554168701, 0.2918214797973633, 0.6004910469055176, 0.03493332862854004, 1.1650782823562622, 2.1959316730499268, 0.3343009948730469, 0.8930784463882446, 1.0485115051269531, 0.6667962074279785, 0.7337555885314941, 1.8062286376953125, 1.322119951248169, 3.9974591732025146, 0.8427436351776123], "mean_td_error": 1.204946756362915, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 76.0, "diff_num_grad_updates_vs_sampler_policy": 75.0}}, "num_env_steps_sampled": 68992, "num_env_steps_trained": 19608, "num_agent_steps_sampled": 206976, "num_agent_steps_trained": 19608, "last_target_update_ts": 68992, "num_target_updates": 76}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 206976, "num_agent_steps_trained": 19608, "num_env_steps_sampled": 68992, "num_env_steps_trained": 19608, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 478.2160712617836, "num_env_steps_trained_throughput_per_sec": 137.70060980529038, "timesteps_total": 68992, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 206976, "timers": {"training_iteration_time_ms": 2005.123, "sample_time_ms": 1436.994, "load_time_ms": 0.539, "load_throughput": 478924.732, "learn_time_ms": 61.71, "learn_throughput": 4180.839, "synch_weights_time_ms": 15.725}, "counters": {"num_env_steps_sampled": 68992, "num_env_steps_trained": 19608, "num_agent_steps_sampled": 206976, "num_agent_steps_trained": 19608, "last_target_update_ts": 68992, "num_target_updates": 76}, "done": false, "episodes_total": 0, "training_iteration": 77, "trial_id": "566d8_00000", "date": "2023-11-16_22-22-55", "timestamp": 1700202175, "time_this_iter_s": 1.8908770084381104, "time_total_s": 156.80105090141296, "pid": 48481, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fb780eab5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 156.80105090141296, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 64.93333333333334, "ram_util_percent": 92.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.077269554138184, "actor_loss": -9.724125862121582, "critic_loss": 0.3384060561656952, "alpha_loss": -0.22952887415885925, "alpha_value": 0.9774805307388306, "log_alpha_value": -0.02277689054608345, "target_entropy": -6.0, "policy_t": -0.016020482406020164, "mean_q": 5.870826721191406, "max_q": 8.291297912597656, "min_q": 4.220089912414551}, "td_error": [0.6206185817718506, 4.232700824737549, 2.6630208492279053, 1.1450304985046387, 0.8757603168487549, 1.9966728687286377, 1.6693525314331055, 6.352586269378662, 0.12277579307556152, 0.3036613464355469, 1.943183183670044, 0.48717832565307617, 4.098814964294434, 0.1780691146850586, 4.87537145614624, 1.0419845581054688, 0.4865708351135254, 0.13418793678283691, 1.6216840744018555, 0.3160386085510254, 0.5104131698608398, 0.2765357494354248, 1.0401136875152588, 0.7347686290740967, 1.0895447731018066, 0.2886981964111328, 0.3511066436767578, 3.0115180015563965, 0.35767054557800293, 1.5797021389007568, 3.490464925765991, 0.1773524284362793, 3.107534170150757, 0.2661912441253662, 1.8015811443328857, 2.4224066734313965, 1.8833532333374023, 1.6312739849090576, 1.1929552555084229, 1.160285472869873, 0.6743628978729248, 3.3135948181152344, 2.789088249206543, 0.6608741283416748, 2.9191930294036865, 0.624887228012085, 0.3292670249938965, 2.2443020343780518, 0.8747906684875488, 0.7979474067687988, 2.1876888275146484, 0.40358400344848633, 3.069122314453125, 1.0030198097229004, 0.5605897903442383, 3.5203986167907715, 0.6908862590789795, 1.6446247100830078, 0.11106157302856445, 0.8218188285827637, 0.38754773139953613, 0.5717976093292236, 1.6337611675262451, 1.2515232563018799, 1.502509355545044, 2.014246702194214, 1.2198917865753174, 0.6569023132324219, 0.7083263397216797, 2.650479793548584, 0.40797901153564453, 1.7736741304397583, 0.20316743850708008, 4.816864013671875, 2.6793723106384277, 2.452817440032959, 0.2641315460205078, 2.6771934032440186, 2.083271026611328, 2.219698429107666, 3.4920310974121094, 2.7260384559631348, 1.2655937671661377, 5.08343505859375, 1.0832109451293945, 0.28271937370300293], "mean_td_error": 1.5917210578918457, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 77.0, "diff_num_grad_updates_vs_sampler_policy": 76.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.058784484863281, "actor_loss": -8.972551345825195, "critic_loss": 0.3657454252243042, "alpha_loss": -0.2293725311756134, "alpha_value": 0.9774548411369324, "log_alpha_value": -0.022803205996751785, "target_entropy": -6.0, "policy_t": 0.034730054438114166, "mean_q": 5.109335422515869, "max_q": 7.241357326507568, "min_q": 3.3291561603546143}, "td_error": [2.991241931915283, 1.9306714534759521, 0.3487088680267334, 1.3742668628692627, 1.5459380149841309, 1.026761770248413, 3.8702118396759033, 2.5401415824890137, 0.8965432643890381, 1.4081859588623047, 1.6006495952606201, 0.388064980506897, 1.5141055583953857, 1.3855032920837402, 0.9288711547851562, 0.5329447984695435, 4.936038017272949, 1.5484399795532227, 0.9325523376464844, 0.7197434902191162, 0.5076513290405273, 2.2396368980407715, 0.087677001953125, 0.8106662034988403, 0.7551268339157104, 0.8279163837432861, 0.944180965423584, 1.606269359588623, 0.5374405384063721, 0.17337417602539062, 0.29765820503234863, 2.2022671699523926, 1.4593679904937744, 1.1755213737487793, 4.400795936584473, 0.7320423126220703, 0.32984352111816406, 2.6881139278411865, 1.4138121604919434, 1.2721326351165771, 0.035902976989746094, 0.6028108596801758, 2.8327980041503906, 0.33362698554992676, 0.21899652481079102, 1.13240385055542, 1.5172972679138184, 0.665337324142456, 0.26050639152526855, 3.1303751468658447, 2.2601351737976074, 3.291753053665161, 1.015824794769287, 0.9396331310272217, 5.1509294509887695, 1.9550278186798096, 0.4309072494506836, 1.451011061668396, 2.920193672180176, 0.9377052783966064, 0.19480431079864502, 1.4566562175750732, 0.6846880912780762, 1.1331560611724854, 0.6779279708862305, 0.030767202377319336, 0.77166748046875, 1.1895785331726074, 1.2799975872039795, 2.325763702392578, 1.3611663579940796, 0.7632575035095215, 1.3148536682128906, 0.9910900592803955, 1.8087739944458008, 0.11750531196594238, 3.4422826766967773, 1.1326992511749268, 2.9051010608673096, 0.23205530643463135, 0.1499042510986328, 0.2879903316497803, 1.8589215278625488, 1.1637780666351318, 0.8301520347595215, 0.2757914066314697], "mean_td_error": 1.352843999862671, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 77.0, "diff_num_grad_updates_vs_sampler_policy": 76.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.101165771484375, "actor_loss": -9.07247257232666, "critic_loss": 0.2061339020729065, "alpha_loss": -0.23024986684322357, "alpha_value": 0.97746342420578, "log_alpha_value": -0.022794384509325027, "target_entropy": -6.0, "policy_t": -0.0014740284532308578, "mean_q": 5.131990432739258, "max_q": 7.179847717285156, "min_q": 3.405574083328247}, "td_error": [1.7827725410461426, 0.8522148132324219, 0.27505791187286377, 3.5495872497558594, 1.22489595413208, 0.6299315690994263, 0.1330198049545288, 2.81911563873291, 0.18533945083618164, 3.579174757003784, 1.9667878150939941, 0.6811130046844482, 0.9942941665649414, 0.7008872032165527, 0.35104894638061523, 1.189965009689331, 1.0784308910369873, 2.497382164001465, 0.28349876403808594, 1.2936995029449463, 1.0048744678497314, 0.390439510345459, 5.081244468688965, 1.5405385494232178, 0.1952425241470337, 0.04679560661315918, 0.21152257919311523, 1.1472617387771606, 1.2973265647888184, 1.2181200981140137, 0.548084020614624, 1.4100205898284912, 1.4309799671173096, 3.1582303047180176, 1.7681275606155396, 3.9488348960876465, 0.5651466846466064, 1.7568767070770264, 2.0523147583007812, 0.26744699478149414, 0.20657896995544434, 0.16553711891174316, 1.3818156719207764, 1.8975532054901123, 0.37827229499816895, 1.8371913433074951, 2.685889720916748, 0.4793219566345215, 1.2980871200561523, 2.126300096511841, 1.8384435176849365, 0.23046374320983887, 0.8797850608825684, 1.8206908702850342, 0.3837759494781494, 0.48740625381469727, 0.16594815254211426, 0.41016364097595215, 0.23318886756896973, 0.8860834836959839, 5.6718854904174805, 1.5990828275680542, 0.3459014892578125, 0.269726037979126, 0.18033313751220703, 1.5029354095458984, 0.17604756355285645, 1.2155678272247314, 1.5161464214324951, 1.2732151746749878, 1.2842373847961426, 1.9537184238433838, 4.140610694885254, 0.34751009941101074, 2.243847608566284, 1.09329354763031, 2.0638315677642822, 1.5787394046783447, 1.6315546035766602, 1.020063877105713, 3.2552037239074707, 1.1853523254394531, 0.6974985599517822, 1.2277839183807373, 1.9395625591278076, 0.12517309188842773], "mean_td_error": 1.3306857347488403, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 77.0, "diff_num_grad_updates_vs_sampler_policy": 76.0}}, "num_env_steps_sampled": 69888, "num_env_steps_trained": 19866, "num_agent_steps_sampled": 209664, "num_agent_steps_trained": 19866, "last_target_update_ts": 69888, "num_target_updates": 77}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 209664, "num_agent_steps_trained": 19866, "num_env_steps_sampled": 69888, "num_env_steps_trained": 19866, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 461.04195803595275, "num_env_steps_trained_throughput_per_sec": 132.75538523803104, "timesteps_total": 69888, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 209664, "timers": {"training_iteration_time_ms": 2003.944, "sample_time_ms": 1435.86, "load_time_ms": 0.538, "load_throughput": 479391.5, "learn_time_ms": 61.607, "learn_throughput": 4187.805, "synch_weights_time_ms": 15.598}, "counters": {"num_env_steps_sampled": 69888, "num_env_steps_trained": 19866, "num_agent_steps_sampled": 209664, "num_agent_steps_trained": 19866, "last_target_update_ts": 69888, "num_target_updates": 77}, "done": false, "episodes_total": 0, "training_iteration": 78, "trial_id": "566d8_00000", "date": "2023-11-16_22-22-57", "timestamp": 1700202177, "time_this_iter_s": 1.9578602313995361, "time_total_s": 158.7589111328125, "pid": 48481, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fb780eabee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 158.7589111328125, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 65.1, "ram_util_percent": 92.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.995532035827637, "actor_loss": -9.754735946655273, "critic_loss": 0.3207421898841858, "alpha_loss": -0.2306557297706604, "alpha_value": 0.9771883487701416, "log_alpha_value": -0.023075884208083153, "target_entropy": -6.0, "policy_t": -0.03781510144472122, "mean_q": 5.974768161773682, "max_q": 8.025463104248047, "min_q": 4.305625915527344}, "td_error": [0.5017104148864746, 1.3326172828674316, 1.0972120761871338, 0.9580154418945312, 0.2777066230773926, 1.1236772537231445, 3.7569656372070312, 0.5348787307739258, 4.018302917480469, 2.34621262550354, 0.13297080993652344, 0.6476013660430908, 0.33765554428100586, 0.5170454978942871, 0.46561741828918457, 0.23448634147644043, 2.121124267578125, 3.925459384918213, 0.5884356498718262, 1.9372413158416748, 3.5320191383361816, 1.3169705867767334, 0.20560264587402344, 0.6452336311340332, 2.236453056335449, 1.8758838176727295, 1.2777247428894043, 1.187842607498169, 1.0912561416625977, 2.8731844425201416, 0.4861106872558594, 3.664172649383545, 2.2314579486846924, 2.7591958045959473, 4.13144588470459, 2.0161631107330322, 1.6427457332611084, 1.570857048034668, 0.9008679389953613, 1.2785193920135498, 0.8707163333892822, 0.5589466094970703, 3.0501978397369385, 2.716308832168579, 0.8473944664001465, 1.5876705646514893, 0.3477780818939209, 0.8965599536895752, 0.7591264247894287, 2.6835896968841553, 0.6514830589294434, 0.5359005928039551, 0.5563061237335205, 0.6263091564178467, 1.954089641571045, 1.1071240901947021, 3.547612428665161, 0.07268714904785156, 0.40036559104919434, 1.8720157146453857, 1.2519073486328125, 0.37523388862609863, 1.2328178882598877, 2.2395827770233154, 5.879714012145996, 1.0209071636199951, 0.9151222705841064, 0.33452343940734863, 4.280417442321777, 0.12483096122741699, 1.6221072673797607, 2.886958599090576, 3.038390874862671, 2.335496664047241, 1.187748670578003, 1.3846213817596436, 1.5966482162475586, 0.8811748027801514, 3.2146310806274414, 1.059643268585205, 1.5906398296356201, 1.1824653148651123, 0.10823607444763184, 1.561718463897705, 0.6688246726989746, 1.0019128322601318], "mean_td_error": 1.5395010709762573, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 78.0, "diff_num_grad_updates_vs_sampler_policy": 77.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.070911407470703, "actor_loss": -9.068605422973633, "critic_loss": 0.4970494508743286, "alpha_loss": -0.23266619443893433, "alpha_value": 0.9771620631217957, "log_alpha_value": -0.023102791979908943, "target_entropy": -6.0, "policy_t": 0.053962208330631256, "mean_q": 5.1371870040893555, "max_q": 7.425673961639404, "min_q": 3.4071743488311768}, "td_error": [0.5596392154693604, 4.163886070251465, 1.3178056478500366, 0.05542492866516113, 0.8013558387756348, 3.0685129165649414, 1.3701903820037842, 0.4437992572784424, 0.8628787994384766, 0.6899800300598145, 1.7936363220214844, 2.733335018157959, 4.336215019226074, 0.8605718612670898, 1.689375877380371, 3.4105451107025146, 0.40718841552734375, 0.6911959648132324, 3.4119064807891846, 1.9663362503051758, 0.07076358795166016, 4.659125804901123, 1.151848554611206, 5.69651985168457, 2.8539090156555176, 0.5244879722595215, 0.9592909812927246, 1.2691457271575928, 0.5960419178009033, 0.8201849460601807, 2.1930716037750244, 0.07238316535949707, 2.550199270248413, 2.669665575027466, 2.527463674545288, 0.5630605220794678, 0.24396181106567383, 4.816965103149414, 0.26752185821533203, 1.920285701751709, 2.8261947631835938, 0.33528757095336914, 2.873751640319824, 1.4590961933135986, 1.3645566701889038, 1.0168554782867432, 0.21892452239990234, 0.9430453777313232, 1.111644983291626, 2.643235445022583, 1.4618580341339111, 1.3121740818023682, 0.10636305809020996, 1.7189042568206787, 1.139183521270752, 0.14191293716430664, 1.5108418464660645, 3.501572847366333, 4.781484603881836, 1.395643711090088, 2.1246955394744873, 0.34372782707214355, 1.5905368328094482, 1.4490118026733398, 3.1758036613464355, 3.301809549331665, 1.338181734085083, 0.8006927967071533, 1.5086839199066162, 1.898328423500061, 1.7287516593933105, 2.586275339126587, 0.2980390787124634, 2.3422060012817383, 1.242996335029602, 0.8645291328430176, 2.5632994174957275, 3.7175354957580566, 1.2637603282928467, 2.368403434753418, 0.1549210548400879, 2.489337205886841, 1.636871099472046, 0.04469418525695801, 0.18988823890686035, 2.002899169921875], "mean_td_error": 1.697070837020874, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 78.0, "diff_num_grad_updates_vs_sampler_policy": 77.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.028732299804688, "actor_loss": -8.912460327148438, "critic_loss": 0.2192908674478531, "alpha_loss": -0.23160657286643982, "alpha_value": 0.9771703481674194, "log_alpha_value": -0.02309430204331875, "target_entropy": -6.0, "policy_t": -0.042295243591070175, "mean_q": 5.0331645011901855, "max_q": 7.251925468444824, "min_q": 3.47762393951416}, "td_error": [0.4231092929840088, 1.3052115440368652, 1.9100515842437744, 0.16406011581420898, 0.23366403579711914, 0.20663189888000488, 0.8540540933609009, 0.365250825881958, 0.3651692867279053, 2.3329455852508545, 0.5302257537841797, 1.0349323749542236, 0.3214528560638428, 0.27995002269744873, 1.1832714080810547, 0.23432600498199463, 0.3007349967956543, 1.6773228645324707, 0.5275900363922119, 0.7499966621398926, 1.378692626953125, 1.4486714601516724, 1.1420774459838867, 0.9439799785614014, 1.8817510604858398, 2.2126779556274414, 2.2337963581085205, 2.0012261867523193, 1.9383158683776855, 1.5324960947036743, 2.3547801971435547, 0.79250168800354, 0.01854872703552246, 3.3015053272247314, 1.759504795074463, 0.39912915229797363, 2.750369071960449, 0.9868206977844238, 2.1735758781433105, 1.4935379028320312, 1.4800539016723633, 0.10428929328918457, 0.9779152870178223, 0.9996602535247803, 2.3408992290496826, 1.0400092601776123, 1.8262910842895508, 0.709111213684082, 0.4201326370239258, 3.5206096172332764, 5.205580711364746, 0.483292818069458, 2.563502788543701, 2.467772960662842, 1.305443286895752, 1.7948129177093506, 2.640739917755127, 0.13552141189575195, 0.7567965984344482, 0.6699374914169312, 0.765587568283081, 1.255812644958496, 2.1091339588165283, 0.5769103765487671, 3.886375904083252, 3.9157052040100098, 4.408058166503906, 2.115976333618164, 0.755673885345459, 0.29664039611816406, 0.19271588325500488, 1.1203291416168213, 1.8033840656280518, 1.252983808517456, 0.16284584999084473, 0.5097472667694092, 3.8112952709198, 0.7179877758026123, 0.15679144859313965, 0.5846192836761475, 0.8294215202331543, 2.2719473838806152, 0.8723709583282471, 2.048973321914673, 0.7606749534606934, 3.724015474319458], "mean_td_error": 1.3964216709136963, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 78.0, "diff_num_grad_updates_vs_sampler_policy": 77.0}}, "num_env_steps_sampled": 70784, "num_env_steps_trained": 20124, "num_agent_steps_sampled": 212352, "num_agent_steps_trained": 20124, "last_target_update_ts": 70784, "num_target_updates": 78}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 212352, "num_agent_steps_trained": 20124, "num_env_steps_sampled": 70784, "num_env_steps_trained": 20124, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 465.27009784039984, "num_env_steps_trained_throughput_per_sec": 133.97286299422228, "timesteps_total": 70784, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 212352, "timers": {"training_iteration_time_ms": 1977.765, "sample_time_ms": 1409.241, "load_time_ms": 0.536, "load_throughput": 481610.411, "learn_time_ms": 61.361, "learn_throughput": 4204.649, "synch_weights_time_ms": 15.383}, "counters": {"num_env_steps_sampled": 70784, "num_env_steps_trained": 20124, "num_agent_steps_sampled": 212352, "num_agent_steps_trained": 20124, "last_target_update_ts": 70784, "num_target_updates": 78}, "done": false, "episodes_total": 0, "training_iteration": 79, "trial_id": "566d8_00000", "date": "2023-11-16_22-22-59", "timestamp": 1700202179, "time_this_iter_s": 1.9407751560211182, "time_total_s": 160.69968628883362, "pid": 48481, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fb763906a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 160.69968628883362, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 65.43333333333334, "ram_util_percent": 92.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.000349998474121, "actor_loss": -9.654509544372559, "critic_loss": 0.34205371141433716, "alpha_loss": -0.23375621438026428, "alpha_value": 0.9768962860107422, "log_alpha_value": -0.023374803364276886, "target_entropy": -6.0, "policy_t": -0.06289853155612946, "mean_q": 5.946515083312988, "max_q": 8.22396469116211, "min_q": 4.26100492477417}, "td_error": [1.6944994926452637, 0.2812917232513428, 0.6705682277679443, 0.2147538661956787, 0.42633819580078125, 0.7212395668029785, 1.4787545204162598, 1.422900676727295, 5.051881790161133, 0.7306985855102539, 0.8919601440429688, 0.7524266242980957, 0.1634974479675293, 0.2825329303741455, 1.3761708736419678, 0.1376349925994873, 0.5823283195495605, 1.6031453609466553, 0.8718950748443604, 0.35456204414367676, 0.8351309299468994, 0.16650795936584473, 4.04317045211792, 2.0545263290405273, 0.4179649353027344, 2.1211600303649902, 0.68056321144104, 1.1279399394989014, 1.6911897659301758, 0.8175010681152344, 7.916125297546387, 3.3656818866729736, 0.9777405261993408, 0.6403074264526367, 0.45413708686828613, 1.3899917602539062, 0.7471354007720947, 0.3909025192260742, 2.801866292953491, 0.6655557155609131, 2.4707915782928467, 0.7473936080932617, 4.657102584838867, 3.823967218399048, 0.16976666450500488, 2.5908560752868652, 1.1271705627441406, 1.1535236835479736, 1.7351751327514648, 1.1388273239135742, 5.634044647216797, 3.242701530456543, 1.1094856262207031, 2.3702569007873535, 1.6030359268188477, 1.6012201309204102, 4.485486030578613, 1.1772267818450928, 3.7028937339782715, 0.8828082084655762, 0.6827802658081055, 0.43544721603393555, 1.271514892578125, 0.36754751205444336, 3.166785955429077, 0.7865896224975586, 0.4463005065917969, 3.507960796356201, 0.6995298862457275, 0.3264744281768799, 2.152655601501465, 2.883157730102539, 0.645244836807251, 1.990077257156372, 2.188065528869629, 2.1341519355773926, 0.696298360824585, 0.6618044376373291, 3.955116033554077, 2.060940742492676, 1.4835147857666016, 1.3314976692199707, 0.5645289421081543, 0.6122751235961914, 4.867751121520996, 0.7908554077148438], "mean_td_error": 1.6179859638214111, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 79.0, "diff_num_grad_updates_vs_sampler_policy": 78.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.076271057128906, "actor_loss": -9.12551212310791, "critic_loss": 0.41646039485931396, "alpha_loss": -0.2358090877532959, "alpha_value": 0.9768692851066589, "log_alpha_value": -0.023402415215969086, "target_entropy": -6.0, "policy_t": 0.040606144815683365, "mean_q": 5.247547149658203, "max_q": 7.5313262939453125, "min_q": 3.707087993621826}, "td_error": [1.7198821306228638, 0.3555877208709717, 0.845390796661377, 1.1544275283813477, 0.0910482406616211, 1.3888204097747803, 1.5421996116638184, 1.4903512001037598, 1.1522668600082397, 0.9814517498016357, 0.7763617038726807, 0.9440131187438965, 1.4164937734603882, 1.0453870296478271, 1.6424202919006348, 1.2188053131103516, 0.04195380210876465, 3.228977680206299, 0.9193933010101318, 2.0231597423553467, 0.18624639511108398, 2.317009210586548, 0.7144913673400879, 1.860614538192749, 1.855771541595459, 0.39965081214904785, 1.9570558071136475, 1.5563466548919678, 3.3031702041625977, 3.0914254188537598, 0.6519753932952881, 1.1783921718597412, 1.7786860466003418, 0.9903208017349243, 3.9172630310058594, 1.8184986114501953, 1.920414686203003, 3.255784034729004, 0.12980914115905762, 1.550264835357666, 3.024303913116455, 0.5964035987854004, 0.990851879119873, 2.473191261291504, 0.7336432933807373, 0.8204408884048462, 3.248396635055542, 1.840580940246582, 1.445058822631836, 0.8637685775756836, 3.0536081790924072, 1.1211917400360107, 1.3476123809814453, 1.341200590133667, 0.8224854469299316, 0.09994113445281982, 2.1448850631713867, 0.7756646871566772, 2.713601589202881, 2.358017921447754, 0.3914637565612793, 1.6888816356658936, 0.16026520729064941, 0.2578892707824707, 1.0451716184616089, 1.5145232677459717, 1.5092136859893799, 0.6339612007141113, 0.5890192985534668, 1.1890337467193604, 1.6834862232208252, 0.3457779884338379, 3.216346263885498, 1.19997239112854, 0.7773590087890625, 2.7171359062194824, 1.2881832122802734, 0.7506320476531982, 5.258373260498047, 2.0187571048736572, 2.528949737548828, 2.9562363624572754, 1.8256967067718506, 1.8784480094909668, 1.4373350143432617, 0.07250475883483887], "mean_td_error": 1.5018727779388428, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 79.0, "diff_num_grad_updates_vs_sampler_policy": 78.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.183690071105957, "actor_loss": -9.14675235748291, "critic_loss": 0.18419098854064941, "alpha_loss": -0.2382381409406662, "alpha_value": 0.9768774509429932, "log_alpha_value": -0.023394089192152023, "target_entropy": -6.0, "policy_t": -0.017453325912356377, "mean_q": 5.130324363708496, "max_q": 7.376798629760742, "min_q": 3.424208402633667}, "td_error": [0.8830356597900391, 0.2007617950439453, 0.44490838050842285, 0.8964171409606934, 1.146596908569336, 1.7409183979034424, 1.1790754795074463, 0.24143612384796143, 1.631878137588501, 2.950565814971924, 1.2404720783233643, 0.23394536972045898, 0.5632685422897339, 2.753920078277588, 3.79822039604187, 1.240189552307129, 2.4295694828033447, 0.9524552822113037, 0.5276826620101929, 0.6955218315124512, 1.1409735679626465, 0.3051609992980957, 1.4638421535491943, 0.04684877395629883, 1.1342859268188477, 2.52445912361145, 2.4644484519958496, 0.6046183109283447, 0.4703805446624756, 2.437466621398926, 0.6935675144195557, 0.3411984443664551, 0.6306266784667969, 0.15090608596801758, 0.19261765480041504, 0.5225459337234497, 0.5776727199554443, 0.24459052085876465, 2.235147714614868, 0.8558254241943359, 2.323852777481079, 0.5561747550964355, 1.6887943744659424, 0.4055973291397095, 0.9998161792755127, 1.3696110248565674, 1.4972620010375977, 0.04044032096862793, 0.8167774677276611, 0.6312470436096191, 1.1789684295654297, 2.551175117492676, 2.2882771492004395, 7.501316547393799, 1.0456387996673584, 0.7260680198669434, 1.562443733215332, 0.7568528652191162, 0.9909801483154297, 0.6214735507965088, 1.2932558059692383, 0.8209015130996704, 0.5664494037628174, 1.2931275367736816, 1.4198641777038574, 1.7258858680725098, 1.7687098979949951, 2.206824541091919, 0.21171486377716064, 1.4150002002716064, 0.4648597240447998, 0.13002848625183105, 2.9421515464782715, 1.0998528003692627, 1.76808762550354, 1.0471081733703613, 3.3001201152801514, 0.7645385265350342, 0.9689805507659912, 0.5767755508422852, 0.14852333068847656, 0.4606013298034668, 1.2646104097366333, 0.3255261182785034, 1.9564714431762695, 1.6635615825653076], "mean_td_error": 1.2319105863571167, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 79.0, "diff_num_grad_updates_vs_sampler_policy": 78.0}}, "num_env_steps_sampled": 71680, "num_env_steps_trained": 20382, "num_agent_steps_sampled": 215040, "num_agent_steps_trained": 20382, "last_target_update_ts": 71680, "num_target_updates": 79}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 215040, "num_agent_steps_trained": 20382, "num_env_steps_sampled": 71680, "num_env_steps_trained": 20382, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 487.5214804913385, "num_env_steps_trained_throughput_per_sec": 140.3800691593363, "timesteps_total": 71680, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 215040, "timers": {"training_iteration_time_ms": 1938.139, "sample_time_ms": 1368.969, "load_time_ms": 0.536, "load_throughput": 481717.607, "learn_time_ms": 61.461, "learn_throughput": 4197.781, "synch_weights_time_ms": 15.271}, "counters": {"num_env_steps_sampled": 71680, "num_env_steps_trained": 20382, "num_agent_steps_sampled": 215040, "num_agent_steps_trained": 20382, "last_target_update_ts": 71680, "num_target_updates": 79}, "done": false, "episodes_total": 0, "training_iteration": 80, "trial_id": "566d8_00000", "date": "2023-11-16_22-23-01", "timestamp": 1700202181, "time_this_iter_s": 1.8516390323638916, "time_total_s": 162.5513253211975, "pid": 48481, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fb780eab5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 162.5513253211975, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 86.7, "ram_util_percent": 92.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.020398139953613, "actor_loss": -9.43950080871582, "critic_loss": 0.3919810652732849, "alpha_loss": -0.23721958696842194, "alpha_value": 0.9766043424606323, "log_alpha_value": -0.02367367036640644, "target_entropy": -6.0, "policy_t": -0.034566402435302734, "mean_q": 5.584985256195068, "max_q": 7.591394901275635, "min_q": 4.147003650665283}, "td_error": [0.7833843231201172, 2.6747169494628906, 0.9769480228424072, 0.9662303924560547, 3.6796064376831055, 4.513910293579102, 3.1523303985595703, 0.787853479385376, 1.722015142440796, 0.31346559524536133, 1.099766492843628, 0.9796266555786133, 0.6668643951416016, 0.8222553730010986, 1.4828529357910156, 4.072823524475098, 1.6055421829223633, 0.6849691867828369, 2.634676456451416, 0.7641620635986328, 1.61006760597229, 2.3638055324554443, 0.9185531139373779, 1.3749535083770752, 4.641021728515625, 2.652012348175049, 0.3321399688720703, 1.4471917152404785, 0.7860729694366455, 4.410073280334473, 1.587376356124878, 0.6626448631286621, 0.8199915885925293, 4.978418350219727, 0.8782970905303955, 3.9697837829589844, 0.9317760467529297, 0.8714971542358398, 0.08910584449768066, 0.4428083896636963, 0.12677621841430664, 2.0453238487243652, 2.752396821975708, 2.0166800022125244, 0.6103096008300781, 0.7613935470581055, 2.8287906646728516, 1.430832862854004, 2.5167860984802246, 2.046125650405884, 1.083207368850708, 2.5759923458099365, 1.5092952251434326, 0.21044611930847168, 0.6023130416870117, 2.063518524169922, 1.2673296928405762, 4.148991584777832, 0.866178035736084, 3.0536575317382812, 0.6374814510345459, 2.2756752967834473, 0.7741818428039551, 1.679635763168335, 0.3600280284881592, 0.33173656463623047, 3.880262613296509, 0.6447205543518066, 3.67063045501709, 1.0089151859283447, 3.5080349445343018, 0.9284605979919434, 2.401850700378418, 0.7856597900390625, 0.7753462791442871, 4.58966588973999, 3.989468574523926, 1.971745491027832, 0.7654299736022949, 3.317319393157959, 4.324993133544922, 1.2363348007202148, 2.258047342300415, 1.4655330181121826, 1.4151129722595215, 0.9380340576171875], "mean_td_error": 1.7977004051208496, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 80.0, "diff_num_grad_updates_vs_sampler_policy": 79.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0457124710083, "actor_loss": -9.100769996643066, "critic_loss": 0.38006138801574707, "alpha_loss": -0.23810435831546783, "alpha_value": 0.9765766263008118, "log_alpha_value": -0.023702086880803108, "target_entropy": -6.0, "policy_t": 0.01086258515715599, "mean_q": 5.21238374710083, "max_q": 7.158231735229492, "min_q": 3.5573575496673584}, "td_error": [1.4392452239990234, 1.305530309677124, 2.2329888343811035, 0.16859722137451172, 0.8902833461761475, 2.803030490875244, 1.2302050590515137, 0.32640838623046875, 1.0728003978729248, 1.1921919584274292, 1.966017484664917, 0.7124061584472656, 0.9462312459945679, 2.035036563873291, 4.0616960525512695, 2.1067192554473877, 2.401524782180786, 4.004968166351318, 3.173246383666992, 0.05067276954650879, 1.6008124351501465, 2.4087798595428467, 1.4779465198516846, 0.5764400959014893, 1.5301153659820557, 1.0242524147033691, 1.0883444547653198, 1.9423465728759766, 1.159681797027588, 2.989823579788208, 2.18243145942688, 2.3070566654205322, 1.152357578277588, 1.003237009048462, 3.497231960296631, 0.41045045852661133, 2.3722100257873535, 0.6232376098632812, 2.7542724609375, 2.5377488136291504, 0.19095933437347412, 0.7749125957489014, 1.2891619205474854, 0.5063543319702148, 0.0862274169921875, 0.23241806030273438, 1.1277110576629639, 0.15540790557861328, 0.5219130516052246, 0.347609281539917, 0.5402967929840088, 0.27853894233703613, 1.7133569717407227, 0.9849715232849121, 0.45252537727355957, 0.24718713760375977, 0.5667965412139893, 0.7442722320556641, 0.17193961143493652, 2.953809976577759, 0.9242610931396484, 4.081268310546875, 1.9846792221069336, 0.772651195526123, 1.0688738822937012, 1.7121214866638184, 1.0475218296051025, 1.8081305027008057, 1.7565431594848633, 0.3182051181793213, 1.552405834197998, 2.6797163486480713, 1.681389570236206, 0.40922069549560547, 0.7035400867462158, 2.9004204273223877, 0.6786999702453613, 3.871807098388672, 1.4182567596435547, 1.7382609844207764, 0.5302987098693848, 0.2626969814300537, 2.3016459941864014, 0.46313023567199707, 0.6005020141601562, 0.9289078712463379], "mean_td_error": 1.4051176309585571, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 80.0, "diff_num_grad_updates_vs_sampler_policy": 79.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.082779884338379, "actor_loss": -8.917271614074707, "critic_loss": 0.2393094152212143, "alpha_loss": -0.2389030009508133, "alpha_value": 0.9765843152999878, "log_alpha_value": -0.02369416132569313, "target_entropy": -6.0, "policy_t": -0.009273930452764034, "mean_q": 5.000145435333252, "max_q": 7.168646335601807, "min_q": 3.1672792434692383}, "td_error": [0.3825805187225342, 0.8115861415863037, 1.380812406539917, 0.6905138492584229, 4.022603988647461, 0.06222128868103027, 0.41695141792297363, 1.654278039932251, 0.36020326614379883, 0.401411771774292, 1.9585251808166504, 1.2646467685699463, 0.5508043766021729, 1.2966169118881226, 0.056391000747680664, 3.9492247104644775, 1.4238111972808838, 0.515669584274292, 0.22888505458831787, 3.636908769607544, 2.116302251815796, 5.490467071533203, 0.6961580514907837, 0.23338651657104492, 0.08632564544677734, 1.3628289699554443, 1.7906928062438965, 1.051411509513855, 1.664677381515503, 3.0284628868103027, 0.910132884979248, 2.0804097652435303, 2.0437424182891846, 1.7930166721343994, 2.098773241043091, 0.7859872579574585, 0.7590622901916504, 0.39188647270202637, 1.723895788192749, 0.9131834506988525, 3.8460259437561035, 0.313495397567749, 1.692927360534668, 2.1813485622406006, 0.9670765399932861, 6.3307671546936035, 3.541686773300171, 0.1518421173095703, 0.09596776962280273, 0.28202319145202637, 3.549996852874756, 1.1224309206008911, 0.526835560798645, 1.4564778804779053, 0.09487473964691162, 4.885901927947998, 0.30262064933776855, 2.620917797088623, 2.4779770374298096, 0.7266877889633179, 1.2102665901184082, 0.8019533157348633, 0.12418663501739502, 1.6438188552856445, 1.1503243446350098, 0.13365840911865234, 2.373070478439331, 2.4963903427124023, 1.5985665321350098, 4.173708915710449, 0.7257664203643799, 2.2245709896087646, 0.7393937110900879, 3.1924197673797607, 3.074993371963501, 0.7537746429443359, 2.1401894092559814, 0.5711708068847656, 0.7981016635894775, 0.07651448249816895, 0.5589749813079834, 0.22658193111419678, 0.8959851264953613, 0.7209705114364624, 0.4798036813735962, 0.86490797996521], "mean_td_error": 1.4767836332321167, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 80.0, "diff_num_grad_updates_vs_sampler_policy": 79.0}}, "num_env_steps_sampled": 72576, "num_env_steps_trained": 20640, "num_agent_steps_sampled": 217728, "num_agent_steps_trained": 20640, "last_target_update_ts": 72576, "num_target_updates": 80}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 217728, "num_agent_steps_trained": 20640, "num_env_steps_sampled": 72576, "num_env_steps_trained": 20640, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 460.59618393960193, "num_env_steps_trained_throughput_per_sec": 132.62702617903716, "timesteps_total": 72576, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 217728, "timers": {"training_iteration_time_ms": 1931.679, "sample_time_ms": 1361.362, "load_time_ms": 0.535, "load_throughput": 482060.955, "learn_time_ms": 61.525, "learn_throughput": 4193.386, "synch_weights_time_ms": 15.369}, "counters": {"num_env_steps_sampled": 72576, "num_env_steps_trained": 20640, "num_agent_steps_sampled": 217728, "num_agent_steps_trained": 20640, "last_target_update_ts": 72576, "num_target_updates": 80}, "done": false, "episodes_total": 0, "training_iteration": 81, "trial_id": "566d8_00000", "date": "2023-11-16_22-23-03", "timestamp": 1700202183, "time_this_iter_s": 1.9593877792358398, "time_total_s": 164.51071310043335, "pid": 48481, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fb780e80b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 164.51071310043335, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 66.56666666666668, "ram_util_percent": 92.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.017786026000977, "actor_loss": -9.590068817138672, "critic_loss": 0.340937077999115, "alpha_loss": -0.2401518076658249, "alpha_value": 0.976312518119812, "log_alpha_value": -0.023972542956471443, "target_entropy": -6.0, "policy_t": 0.0012062196619808674, "mean_q": 5.795173645019531, "max_q": 8.129697799682617, "min_q": 4.099421501159668}, "td_error": [0.9993753433227539, 1.4330523014068604, 1.8946080207824707, 3.323577404022217, 2.0875742435455322, 0.6281533241271973, 0.08351516723632812, 4.343005657196045, 1.1995198726654053, 0.35669612884521484, 2.559873342514038, 2.0939152240753174, 1.4502298831939697, 5.344566345214844, 2.743647575378418, 1.3456878662109375, 2.374384641647339, 1.3240318298339844, 3.203322172164917, 0.3375535011291504, 3.5227646827697754, 0.7269148826599121, 3.428023338317871, 4.602119445800781, 3.637979030609131, 2.091143846511841, 2.3706281185150146, 0.21411442756652832, 1.0061378479003906, 0.8271057605743408, 1.4807229042053223, 0.5595219135284424, 0.8948798179626465, 0.19851207733154297, 0.6229915618896484, 0.6173431873321533, 2.5981693267822266, 1.3479540348052979, 2.255760908126831, 0.36904382705688477, 0.6852438449859619, 2.7702972888946533, 1.0995900630950928, 0.7132086753845215, 1.6115283966064453, 0.4551990032196045, 1.5139522552490234, 0.06462693214416504, 3.4115962982177734, 2.779816150665283, 2.1875531673431396, 1.2173652648925781, 2.126786947250366, 0.1871333122253418, 1.1752972602844238, 0.2900516986846924, 0.34839892387390137, 2.3419246673583984, 0.6402196884155273, 2.664003372192383, 0.15343093872070312, 1.757251262664795, 0.603548526763916, 1.8884544372558594, 0.11577272415161133, 0.8077893257141113, 0.3152320384979248, 0.7703168392181396, 2.303487777709961, 4.154753684997559, 1.6097447872161865, 1.1403942108154297, 3.7692246437072754, 0.8501425981521606, 0.4933741092681885, 1.495126724243164, 4.160794258117676, 1.3417766094207764, 2.0674233436584473, 0.20722341537475586, 0.9655630588531494, 0.12285852432250977, 0.23781037330627441, 1.574406623840332, 1.5539190769195557, 1.3350636959075928], "mean_td_error": 1.5881024599075317, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 81.0, "diff_num_grad_updates_vs_sampler_policy": 80.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.067852020263672, "actor_loss": -9.380760192871094, "critic_loss": 0.4248475432395935, "alpha_loss": -0.24164579808712006, "alpha_value": 0.9762840270996094, "log_alpha_value": -0.024001721292734146, "target_entropy": -6.0, "policy_t": 0.019474731758236885, "mean_q": 5.468700408935547, "max_q": 7.5440473556518555, "min_q": 3.3534553050994873}, "td_error": [2.3632559776306152, 1.9870450496673584, 0.38937973976135254, 0.18276643753051758, 0.19423556327819824, 2.3889999389648438, 1.3109164237976074, 2.827563762664795, 1.0202763080596924, 0.6140446662902832, 0.34950685501098633, 0.1124734878540039, 2.0898754596710205, 0.4440741539001465, 1.5719568729400635, 0.9971761703491211, 3.407412052154541, 1.355731725692749, 2.0768184661865234, 1.5631210803985596, 2.1665830612182617, 0.6060352325439453, 0.27028799057006836, 0.7892475128173828, 0.3500887155532837, 0.9635601043701172, 2.2556490898132324, 2.5268938541412354, 0.502204418182373, 2.021721601486206, 1.215226411819458, 1.698209285736084, 0.7763309478759766, 1.2688324451446533, 1.2634596824645996, 2.208483934402466, 1.1887459754943848, 0.2605612277984619, 0.5092588663101196, 5.008660316467285, 0.24700677394866943, 0.2337644100189209, 3.2557852268218994, 0.5047175884246826, 0.18659639358520508, 0.2071239948272705, 2.1334404945373535, 1.7962208986282349, 1.1542255878448486, 0.6410882472991943, 2.249749183654785, 0.6819617748260498, 1.2004272937774658, 0.0576329231262207, 1.432779312133789, 1.4462437629699707, 0.16839969158172607, 1.8221156597137451, 0.9725323915481567, 1.34615957736969, 0.6590332984924316, 0.3133218288421631, 2.6964993476867676, 3.2416536808013916, 0.6961514949798584, 4.090720176696777, 2.4641149044036865, 0.08378326892852783, 1.6133711338043213, 1.1356227397918701, 0.07904314994812012, 5.23659086227417, 4.133859634399414, 0.3784712553024292, 0.22620868682861328, 1.4405152797698975, 4.98806095123291, 3.71501088142395, 2.886655330657959, 2.224066734313965, 0.30168986320495605, 2.081918478012085, 1.2257448434829712, 1.4359285831451416, 0.12939834594726562, 3.259699583053589], "mean_td_error": 1.4833927154541016, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 81.0, "diff_num_grad_updates_vs_sampler_policy": 80.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.095020294189453, "actor_loss": -9.20309829711914, "critic_loss": 0.22470048069953918, "alpha_loss": -0.2422221601009369, "alpha_value": 0.9762913584709167, "log_alpha_value": -0.02399422414600849, "target_entropy": -6.0, "policy_t": -0.018272634595632553, "mean_q": 5.220569610595703, "max_q": 7.17112398147583, "min_q": 3.1450088024139404}, "td_error": [0.17243075370788574, 1.2234230041503906, 0.6848881244659424, 1.1728203296661377, 0.746295690536499, 0.22442412376403809, 2.7369329929351807, 0.8220714330673218, 1.439547061920166, 0.6779701709747314, 1.9324133396148682, 0.5134663581848145, 0.7450873851776123, 0.15237021446228027, 2.325374126434326, 0.379496693611145, 0.46845531463623047, 2.4312870502471924, 0.2854173183441162, 1.9311466217041016, 0.9515042304992676, 2.705021858215332, 4.041381359100342, 0.39098167419433594, 2.8078205585479736, 0.1069788932800293, 3.755758047103882, 2.6611204147338867, 1.0034263134002686, 1.0308291912078857, 1.4146254062652588, 0.1578540802001953, 0.4999105930328369, 2.5816409587860107, 2.7864067554473877, 2.0292317867279053, 3.8407843112945557, 0.2979123592376709, 1.5007388591766357, 1.5438458919525146, 1.0062928199768066, 0.010129213333129883, 0.30112338066101074, 1.5199084281921387, 2.5217952728271484, 1.6852593421936035, 0.991898775100708, 1.3767622709274292, 1.0195591449737549, 0.5528075695037842, 1.22621750831604, 2.838866949081421, 3.2495033740997314, 1.9517238140106201, 0.5409867763519287, 1.024837851524353, 2.914869546890259, 0.1257936954498291, 2.4617812633514404, 0.1342625617980957, 1.0585901737213135, 0.6691491603851318, 0.5875093936920166, 0.439589262008667, 5.545952796936035, 1.3763182163238525, 0.5238460302352905, 0.6887636184692383, 2.5337088108062744, 1.5211188793182373, 0.6159694194793701, 0.36770105361938477, 0.2068464756011963, 0.11527347564697266, 1.6319973468780518, 1.45395827293396, 1.373779535293579, 0.8790638446807861, 5.181744575500488, 0.16114091873168945, 1.324164628982544, 1.1561558246612549, 0.7269740104675293, 1.9991252422332764, 2.7283921241760254, 2.307879686355591], "mean_td_error": 1.4163044691085815, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 81.0, "diff_num_grad_updates_vs_sampler_policy": 80.0}}, "num_env_steps_sampled": 73472, "num_env_steps_trained": 20898, "num_agent_steps_sampled": 220416, "num_agent_steps_trained": 20898, "last_target_update_ts": 73472, "num_target_updates": 81}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 220416, "num_agent_steps_trained": 20898, "num_env_steps_sampled": 73472, "num_env_steps_trained": 20898, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 461.00400908637926, "num_env_steps_trained_throughput_per_sec": 132.74445797353331, "timesteps_total": 73472, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 220416, "timers": {"training_iteration_time_ms": 1927.081, "sample_time_ms": 1357.038, "load_time_ms": 0.535, "load_throughput": 482619.941, "learn_time_ms": 61.594, "learn_throughput": 4188.687, "synch_weights_time_ms": 15.376}, "counters": {"num_env_steps_sampled": 73472, "num_env_steps_trained": 20898, "num_agent_steps_sampled": 220416, "num_agent_steps_trained": 20898, "last_target_update_ts": 73472, "num_target_updates": 81}, "done": false, "episodes_total": 0, "training_iteration": 82, "trial_id": "566d8_00000", "date": "2023-11-16_22-23-05", "timestamp": 1700202185, "time_this_iter_s": 1.958644151687622, "time_total_s": 166.46935725212097, "pid": 48481, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fb780e7f430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 166.46935725212097, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 68.76666666666667, "ram_util_percent": 92.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.183704376220703, "actor_loss": -9.679460525512695, "critic_loss": 0.27849486470222473, "alpha_loss": -0.24717290699481964, "alpha_value": 0.9760207533836365, "log_alpha_value": -0.024271415546536446, "target_entropy": -6.0, "policy_t": 0.01972842402756214, "mean_q": 5.783629417419434, "max_q": 8.050302505493164, "min_q": 3.991403818130493}, "td_error": [0.29090023040771484, 0.7199010848999023, 5.182408332824707, 0.19329524040222168, 0.9900343418121338, 0.04023385047912598, 2.082641363143921, 2.2538180351257324, 0.513803243637085, 0.14196395874023438, 1.4698302745819092, 1.8786125183105469, 1.7261037826538086, 2.1433074474334717, 0.5696206092834473, 0.8805804252624512, 1.080479383468628, 0.36257266998291016, 1.6546239852905273, 1.2095167636871338, 1.8292479515075684, 2.2338523864746094, 0.5281472206115723, 0.4113597869873047, 0.47240710258483887, 2.6438488960266113, 0.6406607627868652, 0.8854317665100098, 6.429256916046143, 0.1577165126800537, 1.3016982078552246, 1.1558866500854492, 0.17057037353515625, 0.1452035903930664, 1.7487468719482422, 0.8919219970703125, 0.9543869495391846, 1.8595359325408936, 1.7853567600250244, 0.593625545501709, 1.8835985660552979, 1.3100433349609375, 2.0636799335479736, 2.0299766063690186, 2.1585865020751953, 1.0336275100708008, 7.117340087890625, 0.2275524139404297, 0.3775763511657715, 1.9062535762786865, 1.3198447227478027, 0.3831520080566406, 0.26794934272766113, 2.0793731212615967, 0.6695995330810547, 0.8699755668640137, 0.302435040473938, 0.25949811935424805, 3.146104335784912, 2.51985239982605, 2.3245882987976074, 0.8167147636413574, 0.47377896308898926, 0.2152862548828125, 0.759002685546875, 0.299365758895874, 0.13520598411560059, 1.74299955368042, 1.0517055988311768, 1.200573205947876, 1.9326443672180176, 0.2592744827270508, 1.0065016746520996, 4.966836929321289, 1.335062026977539, 0.31069445610046387, 0.28198957443237305, 3.461341142654419, 4.207459449768066, 1.298370599746704, 0.17609310150146484, 0.44954752922058105, 0.37131428718566895, 0.6971256732940674, 2.580782175064087, 2.131525754928589], "mean_td_error": 1.3794755935668945, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 82.0, "diff_num_grad_updates_vs_sampler_policy": 81.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.099557876586914, "actor_loss": -9.039885520935059, "critic_loss": 0.3665034770965576, "alpha_loss": -0.24543321132659912, "alpha_value": 0.9759915471076965, "log_alpha_value": -0.024301381781697273, "target_entropy": -6.0, "policy_t": 0.027527259662747383, "mean_q": 5.104181289672852, "max_q": 7.438508987426758, "min_q": 3.2319464683532715}, "td_error": [1.2346222400665283, 0.2678201198577881, 2.003143310546875, 2.0584678649902344, 0.7355935573577881, 2.242081880569458, 1.082140564918518, 0.1384894847869873, 0.045269012451171875, 0.8354775905609131, 1.328031301498413, 1.969695806503296, 3.3717637062072754, 2.5377583503723145, 1.0312526226043701, 1.1699800491333008, 0.009528160095214844, 1.2690887451171875, 1.7617473602294922, 0.8846991062164307, 1.7550854682922363, 0.4363875389099121, 1.1031675338745117, 0.21160578727722168, 3.7908482551574707, 2.2333829402923584, 0.5739481449127197, 1.3372771739959717, 4.093125343322754, 0.30719244480133057, 1.5092722177505493, 0.08179855346679688, 2.6449801921844482, 2.5051279067993164, 0.40137481689453125, 1.7132668495178223, 0.7515242099761963, 0.5159039497375488, 2.617068290710449, 3.592442274093628, 1.5429917573928833, 2.3016037940979004, 0.33066391944885254, 2.9394912719726562, 1.6711714267730713, 0.3749125003814697, 0.3827230930328369, 2.1447901725769043, 0.06782054901123047, 1.3665850162506104, 0.7236080169677734, 1.0479580163955688, 1.2675246000289917, 0.10204672813415527, 0.29590415954589844, 0.6196115016937256, 1.6773126125335693, 1.136115312576294, 0.5145785808563232, 0.398881196975708, 1.3051027059555054, 0.45934629440307617, 0.6290559768676758, 2.3823401927948, 3.3340559005737305, 0.9959328174591064, 0.1058187484741211, 0.9270172119140625, 2.240206241607666, 2.1496195793151855, 2.3991262912750244, 1.7941067218780518, 3.5931613445281982, 0.08036041259765625, 3.256417751312256, 2.608196258544922, 1.34209144115448, 0.06055319309234619, 1.46404230594635, 0.9327161312103271, 1.9831490516662598, 1.690828561782837, 0.4699833393096924, 0.3621915578842163, 1.1720337867736816, 0.16904449462890625], "mean_td_error": 1.3600490093231201, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 82.0, "diff_num_grad_updates_vs_sampler_policy": 81.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.059174537658691, "actor_loss": -9.00840950012207, "critic_loss": 0.21124662458896637, "alpha_loss": -0.24438075721263885, "alpha_value": 0.9759984016418457, "log_alpha_value": -0.024294313043355942, "target_entropy": -6.0, "policy_t": -0.03615956008434296, "mean_q": 5.0849504470825195, "max_q": 7.599290370941162, "min_q": 3.161104440689087}, "td_error": [0.6877725124359131, 0.45545947551727295, 0.6170353889465332, 0.6935396194458008, 1.3009097576141357, 4.216709613800049, 0.8654351234436035, 2.721815586090088, 0.7267484664916992, 0.5139181613922119, 0.06809782981872559, 4.959906101226807, 0.26970887184143066, 1.8611493110656738, 0.6164038181304932, 1.0444505214691162, 2.390146017074585, 0.19210469722747803, 3.177029848098755, 0.3976917266845703, 3.134458303451538, 0.32579708099365234, 3.468775510787964, 1.0793638229370117, 1.3841912746429443, 0.3328218460083008, 0.29406440258026123, 0.26018404960632324, 2.1018972396850586, 0.14444899559020996, 1.7792909145355225, 0.07547259330749512, 1.5056568384170532, 2.790241003036499, 0.45916295051574707, 3.2584996223449707, 1.180132269859314, 0.5615184307098389, 2.180626392364502, 0.8439227342605591, 0.04809308052062988, 2.33162784576416, 0.32277846336364746, 0.2650587558746338, 0.5963261127471924, 1.097364902496338, 2.695068120956421, 1.5510661602020264, 0.3882269859313965, 1.4730243682861328, 0.6154992580413818, 3.196906328201294, 0.8764538764953613, 1.737239122390747, 1.8477485179901123, 0.10221505165100098, 0.35532546043395996, 2.8764822483062744, 0.7186596393585205, 0.7320165634155273, 0.702784538269043, 1.1279308795928955, 0.885418176651001, 0.08443713188171387, 1.2728075981140137, 1.8983421325683594, 1.946649193763733, 0.9392564296722412, 0.35041356086730957, 0.5706634521484375, 0.6704394817352295, 1.1341090202331543, 0.4407612085342407, 0.44643235206604004, 0.13937950134277344, 3.7975878715515137, 2.3717877864837646, 2.0768017768859863, 0.9788403511047363, 1.0673000812530518, 2.007657051086426, 2.54038667678833, 1.1795071363449097, 2.486372232437134, 2.7467377185821533, 4.228548049926758], "mean_td_error": 1.358780026435852, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 82.0, "diff_num_grad_updates_vs_sampler_policy": 81.0}}, "num_env_steps_sampled": 74368, "num_env_steps_trained": 21156, "num_agent_steps_sampled": 223104, "num_agent_steps_trained": 21156, "last_target_update_ts": 74368, "num_target_updates": 82}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 223104, "num_agent_steps_trained": 21156, "num_env_steps_sampled": 74368, "num_env_steps_trained": 21156, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 468.47473797937494, "num_env_steps_trained_throughput_per_sec": 134.8956276770968, "timesteps_total": 74368, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 223104, "timers": {"training_iteration_time_ms": 1926.739, "sample_time_ms": 1355.543, "load_time_ms": 0.533, "load_throughput": 483612.099, "learn_time_ms": 61.559, "learn_throughput": 4191.115, "synch_weights_time_ms": 15.552}, "counters": {"num_env_steps_sampled": 74368, "num_env_steps_trained": 21156, "num_agent_steps_sampled": 223104, "num_agent_steps_trained": 21156, "last_target_update_ts": 74368, "num_target_updates": 82}, "done": false, "episodes_total": 0, "training_iteration": 83, "trial_id": "566d8_00000", "date": "2023-11-16_22-23-07", "timestamp": 1700202187, "time_this_iter_s": 1.9319651126861572, "time_total_s": 168.40132236480713, "pid": 48481, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fb780eab5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 168.40132236480713, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 65.6, "ram_util_percent": 92.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.097902297973633, "actor_loss": -9.449625968933105, "critic_loss": 0.3636123538017273, "alpha_loss": -0.2481127381324768, "alpha_value": 0.9757286906242371, "log_alpha_value": -0.02457072213292122, "target_entropy": -6.0, "policy_t": 0.007091853767633438, "mean_q": 5.613680362701416, "max_q": 8.000061988830566, "min_q": 4.230245590209961}, "td_error": [0.3012068271636963, 1.593076229095459, 0.6737461090087891, 1.0806679725646973, 2.8349177837371826, 2.377391815185547, 1.8027291297912598, 1.2919418811798096, 1.475243330001831, 0.5891304016113281, 1.1161975860595703, 3.7065718173980713, 0.9990146160125732, 2.0118532180786133, 1.5930664539337158, 0.5585198402404785, 0.3747067451477051, 3.180914878845215, 0.34365320205688477, 0.6184101104736328, 1.47418212890625, 0.6956455707550049, 2.0325570106506348, 0.5061287879943848, 1.7083075046539307, 0.2898528575897217, 4.460423469543457, 0.667111873626709, 3.245464324951172, 0.09001874923706055, 3.467984676361084, 0.2940495014190674, 4.099865913391113, 0.7871785163879395, 1.9687749147415161, 4.447424411773682, 0.2109529972076416, 0.7168560028076172, 0.46789097785949707, 1.415621280670166, 0.10321450233459473, 0.5510351657867432, 0.5074644088745117, 0.9168732166290283, 0.3777024745941162, 4.784008026123047, 0.6153886318206787, 1.800814151763916, 3.1889748573303223, 0.9400386810302734, 1.3055658340454102, 1.136883020401001, 0.30463337898254395, 3.0943334102630615, 2.7663259506225586, 1.158414602279663, 1.5531344413757324, 1.1268730163574219, 1.4115700721740723, 5.825182914733887, 2.7991268634796143, 4.334922790527344, 3.86212158203125, 1.1311883926391602, 1.1843476295471191, 1.4848570823669434, 0.5028026103973389, 2.9634037017822266, 0.7040252685546875, 0.8558053970336914, 0.17567825317382812, 1.717846393585205, 1.6336569786071777, 5.230635643005371, 2.7125749588012695, 2.3558011054992676, 2.493070363998413, 0.5318045616149902, 1.7001962661743164, 2.6604063510894775, 3.3301010131835938, 0.4903676509857178, 1.541801929473877, 2.4292333126068115, 1.6767921447753906, 0.3241281509399414], "mean_td_error": 1.6960972547531128, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 83.0, "diff_num_grad_updates_vs_sampler_policy": 82.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.065655708312988, "actor_loss": -9.418471336364746, "critic_loss": 0.3172946572303772, "alpha_loss": -0.2476266771554947, "alpha_value": 0.9756990075111389, "log_alpha_value": -0.024601146578788757, "target_entropy": -6.0, "policy_t": 0.04296523705124855, "mean_q": 5.529212951660156, "max_q": 7.852359294891357, "min_q": 3.4416966438293457}, "td_error": [0.8613996505737305, 2.532667875289917, 4.185694694519043, 0.980600118637085, 0.6567853689193726, 2.906240224838257, 1.6781933307647705, 1.329695224761963, 0.3206045627593994, 1.1997032165527344, 0.49451732635498047, 1.874274492263794, 0.4698646068572998, 1.933194875717163, 2.350921392440796, 0.37299227714538574, 0.3170572519302368, 1.8798456192016602, 0.19410276412963867, 4.828417778015137, 0.3641979694366455, 3.7485499382019043, 1.4656884670257568, 2.816533088684082, 4.099373817443848, 1.0101397037506104, 2.3314967155456543, 0.8920409679412842, 2.539287567138672, 0.14700889587402344, 1.5317814350128174, 2.609377861022949, 1.7900561094284058, 1.4912614822387695, 0.35175347328186035, 3.0341110229492188, 0.2705719470977783, 1.531416416168213, 0.8547682762145996, 0.21402597427368164, 0.4502737522125244, 0.6348609924316406, 0.1461927890777588, 1.891221523284912, 0.879690408706665, 1.626774787902832, 0.9070115089416504, 0.9849812984466553, 1.9661526679992676, 2.161696672439575, 0.5305348634719849, 1.1273524761199951, 0.47516679763793945, 2.129323959350586, 1.2287228107452393, 0.528472900390625, 0.2918684482574463, 0.6066558361053467, 3.2623441219329834, 0.9036085605621338, 0.968224048614502, 0.2708730697631836, 1.9917409420013428, 2.1294591426849365, 0.5026082992553711, 0.9387848377227783, 0.2294175624847412, 1.6454439163208008, 1.0168020725250244, 2.5780065059661865, 1.5672590732574463, 0.34141016006469727, 0.9409396648406982, 0.1609877347946167, 2.062391996383667, 3.543041706085205, 0.16177868843078613, 0.9146311283111572, 5.368780136108398, 0.2936830520629883, 0.4735734462738037, 0.1376030445098877, 0.9876916408538818, 4.281071662902832, 0.2579200267791748, 0.20412731170654297], "mean_td_error": 1.4088531732559204, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 83.0, "diff_num_grad_updates_vs_sampler_policy": 82.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.055132865905762, "actor_loss": -9.152965545654297, "critic_loss": 0.2175135314464569, "alpha_loss": -0.24729925394058228, "alpha_value": 0.975705623626709, "log_alpha_value": -0.024594329297542572, "target_entropy": -6.0, "policy_t": 0.004185408353805542, "mean_q": 5.184032917022705, "max_q": 7.47993803024292, "min_q": 3.3961422443389893}, "td_error": [0.3687915802001953, 0.5039184093475342, 0.3739752769470215, 0.9342427253723145, 1.271167516708374, 0.21872758865356445, 0.7358386516571045, 1.4684789180755615, 0.04760551452636719, 2.3807904720306396, 0.30553698539733887, 2.546858072280884, 2.0881786346435547, 0.8278876543045044, 1.3545260429382324, 1.5582237243652344, 1.1635727882385254, 0.16877532005310059, 0.3283216953277588, 2.2479214668273926, 0.6490553617477417, 1.4737792015075684, 3.4125888347625732, 0.14624929428100586, 0.2836272716522217, 1.5765514373779297, 2.403421401977539, 6.217905521392822, 0.5903513431549072, 0.12645649909973145, 2.5901448726654053, 0.1030280590057373, 3.318880558013916, 0.7876434326171875, 0.6696670055389404, 0.8488259315490723, 2.1440606117248535, 4.742105007171631, 2.136533737182617, 0.08603525161743164, 2.1675124168395996, 0.22696471214294434, 0.9141011238098145, 2.6004955768585205, 0.23198509216308594, 1.3782488107681274, 2.076026201248169, 0.06359803676605225, 2.1685714721679688, 0.7056276798248291, 2.195708751678467, 0.2535440921783447, 1.6857300996780396, 2.956209421157837, 1.2953588962554932, 0.6579606533050537, 0.7160377502441406, 3.1142475605010986, 1.4199903011322021, 3.9031989574432373, 0.12390565872192383, 0.07433533668518066, 1.1281628608703613, 0.8811142444610596, 0.8338519334793091, 0.8025078773498535, 0.18825054168701172, 2.3722891807556152, 0.6458890438079834, 0.18747210502624512, 0.2628185749053955, 2.2874372005462646, 1.8986303806304932, 2.8798537254333496, 0.5316965579986572, 0.4274318218231201, 0.11113643646240234, 0.24154090881347656, 2.221193313598633, 1.5297939777374268, 0.28760409355163574, 2.951697587966919, 0.9873658418655396, 1.2026300430297852, 6.928089141845703, 0.08906137943267822], "mean_td_error": 1.372175931930542, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 83.0, "diff_num_grad_updates_vs_sampler_policy": 82.0}}, "num_env_steps_sampled": 75264, "num_env_steps_trained": 21414, "num_agent_steps_sampled": 225792, "num_agent_steps_trained": 21414, "last_target_update_ts": 75264, "num_target_updates": 83}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 225792, "num_agent_steps_trained": 21414, "num_env_steps_sampled": 75264, "num_env_steps_trained": 21414, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 458.5916160912962, "num_env_steps_trained_throughput_per_sec": 132.04981802628842, "timesteps_total": 75264, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 225792, "timers": {"training_iteration_time_ms": 1916.08, "sample_time_ms": 1344.622, "load_time_ms": 0.536, "load_throughput": 481353.335, "learn_time_ms": 61.634, "learn_throughput": 4185.981, "synch_weights_time_ms": 15.564}, "counters": {"num_env_steps_sampled": 75264, "num_env_steps_trained": 21414, "num_agent_steps_sampled": 225792, "num_agent_steps_trained": 21414, "last_target_update_ts": 75264, "num_target_updates": 83}, "done": false, "episodes_total": 0, "training_iteration": 84, "trial_id": "566d8_00000", "date": "2023-11-16_22-23-09", "timestamp": 1700202189, "time_this_iter_s": 1.967984914779663, "time_total_s": 170.3693072795868, "pid": 48481, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fb763906a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 170.3693072795868, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 91.80000000000001, "ram_util_percent": 92.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0469388961792, "actor_loss": -9.6852388381958, "critic_loss": 0.28301405906677246, "alpha_loss": -0.24986928701400757, "alpha_value": 0.9754365086555481, "log_alpha_value": -0.024870192632079124, "target_entropy": -6.0, "policy_t": -0.029279015958309174, "mean_q": 5.801008224487305, "max_q": 7.891888618469238, "min_q": 4.160423755645752}, "td_error": [2.428196668624878, 0.9261643886566162, 3.022082567214966, 0.36163330078125, 1.7341499328613281, 0.7591018676757812, 1.4630589485168457, 0.849600076675415, 1.367297887802124, 1.1967780590057373, 2.8509228229522705, 2.6153457164764404, 0.898996114730835, 1.4101369380950928, 1.1146130561828613, 3.2049386501312256, 0.5532324314117432, 1.5436208248138428, 0.5255954265594482, 0.7230451107025146, 0.23459982872009277, 0.2542259693145752, 0.7065186500549316, 1.5154082775115967, 0.9376986026763916, 0.199110746383667, 0.10404014587402344, 2.1848886013031006, 0.8475868701934814, 1.7040908336639404, 2.4126029014587402, 0.36906957626342773, 1.9077427387237549, 2.6914217472076416, 2.1140458583831787, 1.4593665599822998, 1.6000707149505615, 3.4305548667907715, 1.8709254264831543, 1.7528607845306396, 4.161559104919434, 0.824782133102417, 0.038954973220825195, 0.4327249526977539, 0.9283702373504639, 1.146151065826416, 0.652458906173706, 2.815147876739502, 2.0284581184387207, 3.9187161922454834, 2.6723501682281494, 1.7328071594238281, 1.6250152587890625, 1.5024340152740479, 0.16936063766479492, 1.8011531829833984, 0.13010311126708984, 1.3007066249847412, 0.6463255882263184, 0.6043202877044678, 5.012848854064941, 0.18802833557128906, 0.4749753475189209, 2.583414077758789, 2.734759569168091, 0.8952691555023193, 0.6838903427124023, 1.8024215698242188, 0.35608410835266113, 0.6606059074401855, 2.1841447353363037, 1.341193437576294, 0.21678972244262695, 0.36727261543273926, 0.7308924198150635, 2.065234422683716, 1.0604300498962402, 1.7708735466003418, 0.389819860458374, 0.9586949348449707, 1.5918445587158203, 0.5684795379638672, 2.8437421321868896, 0.45905041694641113, 1.1466693878173828, 1.4557240009307861], "mean_td_error": 1.4130277633666992, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 84.0, "diff_num_grad_updates_vs_sampler_policy": 83.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.977155685424805, "actor_loss": -9.43587589263916, "critic_loss": 0.30752795934677124, "alpha_loss": -0.24844032526016235, "alpha_value": 0.9754065275192261, "log_alpha_value": -0.02490091882646084, "target_entropy": -6.0, "policy_t": 0.017769232392311096, "mean_q": 5.601559162139893, "max_q": 8.187700271606445, "min_q": 3.6000492572784424}, "td_error": [3.042513608932495, 1.7625398635864258, 1.4321377277374268, 0.3224301338195801, 0.5278658866882324, 0.7154061794281006, 1.8252520561218262, 5.317115306854248, 3.2371411323547363, 2.098820209503174, 1.296290397644043, 1.656553030014038, 0.25557470321655273, 2.4643728733062744, 0.4630293846130371, 0.9091241359710693, 0.7979080677032471, 2.339860677719116, 1.748704433441162, 0.43160367012023926, 0.19806504249572754, 1.3707456588745117, 0.2464284896850586, 1.8043503761291504, 0.6818299293518066, 2.046816349029541, 1.4496703147888184, 1.495063066482544, 1.3453469276428223, 1.4763343334197998, 0.48418641090393066, 0.5972232818603516, 4.525055885314941, 0.39212489128112793, 0.3072928190231323, 4.618636608123779, 1.901178002357483, 0.19997358322143555, 0.5203053951263428, 1.140515923500061, 1.7304060459136963, 0.4640171527862549, 0.47726988792419434, 0.2748382091522217, 0.9417343139648438, 0.6821877956390381, 0.4066755771636963, 0.5669384002685547, 2.680748462677002, 0.45284461975097656, 2.319504499435425, 0.3037095069885254, 1.520047903060913, 2.7085187435150146, 0.1615607738494873, 0.7271084785461426, 2.7113142013549805, 0.3953258991241455, 3.642011880874634, 1.0543186664581299, 0.1230623722076416, 0.4528675079345703, 0.7670598030090332, 0.4702913761138916, 1.3840012550354004, 0.5850887298583984, 1.2392523288726807, 1.3992266654968262, 0.7560224533081055, 4.176319122314453, 0.11285781860351562, 2.7059504985809326, 0.5437250137329102, 1.0436253547668457, 0.7921587228775024, 1.0055208206176758, 0.9657964706420898, 0.20256340503692627, 0.7566084861755371, 1.8108925819396973, 0.6986649036407471, 3.8081271648406982, 2.143540620803833, 2.8801350593566895, 1.787980556488037, 1.7019567489624023], "mean_td_error": 1.3718575239181519, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 84.0, "diff_num_grad_updates_vs_sampler_policy": 83.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.071632385253906, "actor_loss": -9.204852104187012, "critic_loss": 0.20834842324256897, "alpha_loss": -0.25072595477104187, "alpha_value": 0.9754130244255066, "log_alpha_value": -0.024894272908568382, "target_entropy": -6.0, "policy_t": 0.05176578089594841, "mean_q": 5.278916835784912, "max_q": 7.764033317565918, "min_q": 3.2900586128234863}, "td_error": [0.27526378631591797, 0.4294700622558594, 2.744264841079712, 0.4063289165496826, 0.8593065738677979, 1.1586897373199463, 0.9007902145385742, 0.23483037948608398, 0.11991071701049805, 0.16910028457641602, 0.10550475120544434, 1.697190761566162, 0.5553746223449707, 0.9824190139770508, 3.5083231925964355, 0.8254034519195557, 1.1145710945129395, 1.0300397872924805, 1.767153263092041, 3.6078968048095703, 2.0786995887756348, 2.406545877456665, 0.11386299133300781, 2.9747636318206787, 0.5199742317199707, 1.1372981071472168, 0.20048975944519043, 0.48704075813293457, 1.2364327907562256, 0.566888689994812, 2.3124117851257324, 0.8430782556533813, 2.1004204750061035, 1.9937796592712402, 0.8619914054870605, 1.8066825866699219, 2.106050968170166, 1.4418203830718994, 1.8911759853363037, 1.4869136810302734, 1.1384902000427246, 2.0431041717529297, 0.5364627838134766, 1.32267165184021, 0.6457860469818115, 3.7895798683166504, 2.5791940689086914, 0.15013384819030762, 0.7899365425109863, 2.9107351303100586, 3.3141531944274902, 0.17479896545410156, 1.0305860042572021, 1.842203974723816, 2.373354434967041, 2.7426609992980957, 1.0879476070404053, 0.953599214553833, 0.49103498458862305, 1.0186188220977783, 1.594947338104248, 0.3329348564147949, 0.07232379913330078, 0.6908581256866455, 0.2676682472229004, 1.51338791847229, 0.3380398750305176, 2.16294527053833, 0.3841571807861328, 1.4113966226577759, 1.8295470476150513, 0.7901320457458496, 0.4061964750289917, 0.10868227481842041, 1.139153242111206, 3.425579071044922, 3.013049840927124, 0.7676937580108643, 4.8139142990112305, 0.8301713466644287, 1.8955819606781006, 1.1600680351257324, 0.7762103080749512, 0.39024317264556885, 2.2015507221221924, 1.7770304679870605], "mean_td_error": 1.349845051765442, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 84.0, "diff_num_grad_updates_vs_sampler_policy": 83.0}}, "num_env_steps_sampled": 76160, "num_env_steps_trained": 21672, "num_agent_steps_sampled": 228480, "num_agent_steps_trained": 21672, "last_target_update_ts": 76160, "num_target_updates": 84}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 228480, "num_agent_steps_trained": 21672, "num_env_steps_sampled": 76160, "num_env_steps_trained": 21672, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 479.0434550613824, "num_env_steps_trained_throughput_per_sec": 137.9388520154427, "timesteps_total": 76160, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 228480, "timers": {"training_iteration_time_ms": 1907.912, "sample_time_ms": 1336.728, "load_time_ms": 0.537, "load_throughput": 480541.068, "learn_time_ms": 61.7, "learn_throughput": 4181.55, "synch_weights_time_ms": 15.838}, "counters": {"num_env_steps_sampled": 76160, "num_env_steps_trained": 21672, "num_agent_steps_sampled": 228480, "num_agent_steps_trained": 21672, "last_target_update_ts": 76160, "num_target_updates": 84}, "done": false, "episodes_total": 0, "training_iteration": 85, "trial_id": "566d8_00000", "date": "2023-11-16_22-23-11", "timestamp": 1700202191, "time_this_iter_s": 1.8835501670837402, "time_total_s": 172.25285744667053, "pid": 48481, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fb780e80d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 172.25285744667053, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 66.93333333333332, "ram_util_percent": 92.43333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.053487777709961, "actor_loss": -9.488656044006348, "critic_loss": 0.2873883843421936, "alpha_loss": -0.253042995929718, "alpha_value": 0.9751444458961487, "log_alpha_value": -0.025169674307107925, "target_entropy": -6.0, "policy_t": 0.0011904368875548244, "mean_q": 5.710444927215576, "max_q": 7.7009968757629395, "min_q": 4.228698253631592}, "td_error": [1.3487811088562012, 0.34070658683776855, 0.4880030155181885, 0.26998376846313477, 0.9402904510498047, 2.2469043731689453, 0.34697771072387695, 0.40209436416625977, 3.412813663482666, 2.0147876739501953, 0.8465368747711182, 1.5243597030639648, 1.4638357162475586, 0.14268040657043457, 1.6829841136932373, 0.1518688201904297, 1.0232646465301514, 0.3057270050048828, 3.4303359985351562, 3.0809361934661865, 0.5414526462554932, 1.127692461013794, 0.3685436248779297, 2.139801025390625, 0.3148989677429199, 0.9029262065887451, 1.8250150680541992, 2.3317441940307617, 0.5846447944641113, 0.2997150421142578, 0.12909221649169922, 1.0136964321136475, 0.22722291946411133, 1.3593285083770752, 3.646890163421631, 2.4285268783569336, 3.9159860610961914, 1.2670588493347168, 1.3725204467773438, 2.2881195545196533, 1.4398508071899414, 5.568045139312744, 0.4021952152252197, 0.6619067192077637, 3.8265833854675293, 2.2215116024017334, 2.5779550075531006, 0.12471294403076172, 1.1533174514770508, 1.8628265857696533, 0.4092562198638916, 1.2113704681396484, 1.1088500022888184, 0.8302788734436035, 1.2599427700042725, 2.2052009105682373, 2.2545008659362793, 2.4240856170654297, 0.9684319496154785, 2.3344430923461914, 3.835447072982788, 0.7079496383666992, 1.5773611068725586, 0.2472550868988037, 0.10333871841430664, 2.5597264766693115, 2.2087395191192627, 0.328582763671875, 0.21989011764526367, 1.1400740146636963, 0.5482242107391357, 0.6176409721374512, 0.759756326675415, 0.3714590072631836, 3.5235447883605957, 1.3120150566101074, 3.044257640838623, 0.5340859889984131, 0.2524561882019043, 0.6408419609069824, 2.3079962730407715, 2.068498373031616, 2.149749517440796, 0.751384973526001, 1.0909156799316406, 1.2578809261322021], "mean_td_error": 1.4250359535217285, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 85.0, "diff_num_grad_updates_vs_sampler_policy": 84.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.079166412353516, "actor_loss": -9.570300102233887, "critic_loss": 0.3154807984828949, "alpha_loss": -0.2539996802806854, "alpha_value": 0.9751144051551819, "log_alpha_value": -0.025200463831424713, "target_entropy": -6.0, "policy_t": 0.01714874431490898, "mean_q": 5.638449192047119, "max_q": 8.155831336975098, "min_q": 3.6543502807617188}, "td_error": [0.1130685806274414, 0.3700418472290039, 1.8544764518737793, 1.3496124744415283, 1.678544521331787, 0.9145824909210205, 0.48641514778137207, 1.5022209882736206, 0.9509613513946533, 0.46486592292785645, 1.523552656173706, 0.3285512924194336, 2.537961006164551, 0.05771684646606445, 0.7971134185791016, 0.3929750919342041, 4.386707305908203, 0.5074552297592163, 0.15945744514465332, 1.7283520698547363, 1.415281057357788, 1.8501648902893066, 4.389798641204834, 2.845698118209839, 0.35373497009277344, 0.19644546508789062, 1.1723880767822266, 2.2095184326171875, 2.1958720684051514, 0.8058586120605469, 3.017730951309204, 3.9138946533203125, 0.4935038089752197, 1.6214382648468018, 0.22751736640930176, 0.2358698844909668, 1.3998699188232422, 0.8863580226898193, 0.8938446044921875, 2.508615732192993, 1.437011957168579, 0.6081581115722656, 1.2658536434173584, 0.6829147338867188, 1.492263674736023, 0.9375929832458496, 0.8003460168838501, 0.5532681941986084, 0.06917667388916016, 1.955991268157959, 0.8146904706954956, 1.7135841846466064, 0.39659833908081055, 1.4377505779266357, 0.7446653842926025, 0.9535987377166748, 3.8507308959960938, 1.9084722995758057, 0.597611665725708, 1.4535603523254395, 0.7237470149993896, 6.949435234069824, 1.0406568050384521, 1.6305997371673584, 1.3725409507751465, 3.899423837661743, 6.282918930053711, 0.19883251190185547, 3.4557723999023438, 0.25918149948120117, 0.1084892749786377, 0.47362565994262695, 0.36423730850219727, 1.3721210956573486, 0.4016282558441162, 2.6829380989074707, 2.017847776412964, 1.2633256912231445, 0.28332090377807617, 0.5458745956420898, 1.2073745727539062, 0.6010868549346924, 1.5425927639007568, 0.16094613075256348, 1.3806302547454834, 0.42357420921325684], "mean_td_error": 1.384355902671814, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 85.0, "diff_num_grad_updates_vs_sampler_policy": 84.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.02663803100586, "actor_loss": -9.23434829711914, "critic_loss": 0.1950894296169281, "alpha_loss": -0.2526130676269531, "alpha_value": 0.9751205444335938, "log_alpha_value": -0.0251941941678524, "target_entropy": -6.0, "policy_t": 0.019666368141770363, "mean_q": 5.316908836364746, "max_q": 7.784968376159668, "min_q": 3.4923014640808105}, "td_error": [1.6780669689178467, 0.03159213066101074, 3.46247935295105, 1.8313755989074707, 1.8867499828338623, 0.32372355461120605, 1.23186194896698, 1.5801985263824463, 0.1153874397277832, 3.4015052318573, 0.5376238822937012, 0.9229400157928467, 2.826286554336548, 3.6250922679901123, 1.0109894275665283, 0.1963789463043213, 0.5904572010040283, 2.3938231468200684, 0.17818856239318848, 1.5122857093811035, 0.3842501640319824, 2.784581184387207, 1.7713119983673096, 0.8569064140319824, 0.6267569065093994, 2.2674624919891357, 0.339679479598999, 2.0759737491607666, 1.748201847076416, 0.22952723503112793, 0.42315196990966797, 0.09717226028442383, 1.0857181549072266, 0.04809010028839111, 1.43461275100708, 2.1335606575012207, 2.043337345123291, 0.6899516582489014, 1.4370882511138916, 0.5167934894561768, 0.5144305229187012, 0.7634398937225342, 1.3073785305023193, 0.049666643142700195, 1.8865904808044434, 0.18166637420654297, 2.9654605388641357, 2.7385611534118652, 1.593205213546753, 2.84867787361145, 0.0953216552734375, 0.27237868309020996, 0.5313858985900879, 2.1162545680999756, 0.20211029052734375, 0.6933560371398926, 0.7670130729675293, 2.3476738929748535, 0.3943159580230713, 0.5878984928131104, 0.5151288509368896, 1.4161897897720337, 0.14719080924987793, 0.6592421531677246, 0.47923874855041504, 0.9234731197357178, 3.1246182918548584, 2.1525862216949463, 0.4882521629333496, 0.4761998653411865, 2.245044469833374, 0.7365742921829224, 0.19884967803955078, 0.8283514976501465, 2.7603132724761963, 0.6392295360565186, 2.5581698417663574, 2.297203540802002, 0.85964035987854, 1.440626859664917, 1.6205360889434814, 1.1777122020721436, 0.40136075019836426, 0.7793526649475098, 0.9082725048065186, 3.0703325271606445], "mean_td_error": 1.256879210472107, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 85.0, "diff_num_grad_updates_vs_sampler_policy": 84.0}}, "num_env_steps_sampled": 77056, "num_env_steps_trained": 21930, "num_agent_steps_sampled": 231168, "num_agent_steps_trained": 21930, "last_target_update_ts": 77056, "num_target_updates": 85}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 231168, "num_agent_steps_trained": 21930, "num_env_steps_sampled": 77056, "num_env_steps_trained": 21930, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 470.4898369665576, "num_env_steps_trained_throughput_per_sec": 135.47586823367396, "timesteps_total": 77056, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 231168, "timers": {"training_iteration_time_ms": 1911.037, "sample_time_ms": 1338.805, "load_time_ms": 0.529, "load_throughput": 487512.021, "learn_time_ms": 61.668, "learn_throughput": 4183.72, "synch_weights_time_ms": 15.82}, "counters": {"num_env_steps_sampled": 77056, "num_env_steps_trained": 21930, "num_agent_steps_sampled": 231168, "num_agent_steps_trained": 21930, "last_target_update_ts": 77056, "num_target_updates": 85}, "done": false, "episodes_total": 0, "training_iteration": 86, "trial_id": "566d8_00000", "date": "2023-11-16_22-23-13", "timestamp": 1700202193, "time_this_iter_s": 1.9203922748565674, "time_total_s": 174.1732497215271, "pid": 48481, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fb780e838b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 174.1732497215271, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 66.76666666666667, "ram_util_percent": 92.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.99010181427002, "actor_loss": -9.407753944396973, "critic_loss": 0.38491109013557434, "alpha_loss": -0.25443974137306213, "alpha_value": 0.974852442741394, "log_alpha_value": -0.025469185784459114, "target_entropy": -6.0, "policy_t": -0.03994865342974663, "mean_q": 5.546863079071045, "max_q": 8.050497055053711, "min_q": 3.956148386001587}, "td_error": [0.28328895568847656, 2.346000909805298, 2.608863115310669, 1.3728525638580322, 2.599005699157715, 2.584263324737549, 1.634721040725708, 0.8605432510375977, 0.19884109497070312, 7.090752124786377, 2.0350961685180664, 0.6711058616638184, 1.2201240062713623, 0.8604276180267334, 2.785588264465332, 2.6605372428894043, 1.1384994983673096, 2.556346893310547, 3.6734094619750977, 3.0892343521118164, 4.666677951812744, 1.4283244609832764, 1.9685871601104736, 0.81557297706604, 0.35468411445617676, 2.0826964378356934, 0.44878053665161133, 2.6124167442321777, 2.2787044048309326, 0.6902947425842285, 1.8639264106750488, 3.239802360534668, 2.5969998836517334, 0.16003084182739258, 0.5967617034912109, 2.0596985816955566, 3.286884307861328, 0.6275219917297363, 0.24953126907348633, 2.068532705307007, 2.8982954025268555, 2.029832124710083, 1.8461024761199951, 1.3162829875946045, 0.6133933067321777, 0.791114091873169, 2.124194622039795, 2.4884955883026123, 0.8018863201141357, 3.1706981658935547, 1.1898270845413208, 0.9013993740081787, 0.6218748092651367, 4.823909282684326, 0.07699131965637207, 2.2078192234039307, 3.3896212577819824, 1.5875170230865479, 1.8725507259368896, 0.9126095771789551, 1.8389816284179688, 0.5350518226623535, 1.4822280406951904, 2.12227725982666, 1.6110970973968506, 1.2337915897369385, 0.13474583625793457, 1.3625140190124512, 3.0919651985168457, 1.5094139575958252, 1.529461145401001, 3.211583137512207, 1.1040282249450684, 1.291130542755127, 1.52473783493042, 0.5410361289978027, 1.970947265625, 1.189868450164795, 2.3411524295806885, 1.205512523651123, 1.206068515777588, 0.43529820442199707, 2.523162364959717, 1.7197866439819336, 2.4228737354278564, 4.465303897857666], "mean_td_error": 1.809701919555664, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 86.0, "diff_num_grad_updates_vs_sampler_policy": 85.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.109222412109375, "actor_loss": -9.666773796081543, "critic_loss": 0.41542744636535645, "alpha_loss": -0.2577859163284302, "alpha_value": 0.9748222827911377, "log_alpha_value": -0.02550007589161396, "target_entropy": -6.0, "policy_t": 0.036485448479652405, "mean_q": 5.69102144241333, "max_q": 8.044732093811035, "min_q": 3.5854430198669434}, "td_error": [2.92219614982605, 1.0994360446929932, 1.5184593200683594, 1.2289888858795166, 0.8774867057800293, 3.9123754501342773, 4.858409881591797, 1.5034539699554443, 1.9345309734344482, 0.14186835289001465, 3.192747116088867, 1.501999855041504, 0.25029611587524414, 2.4985904693603516, 1.7172226905822754, 0.5834720134735107, 0.4396510124206543, 1.6275177001953125, 2.491422414779663, 1.4825825691223145, 1.3082034587860107, 0.3495171070098877, 2.188631534576416, 0.15518927574157715, 3.0068137645721436, 0.2737464904785156, 2.2166924476623535, 1.0715785026550293, 0.3034358024597168, 1.1065521240234375, 0.7780101299285889, 0.30490756034851074, 0.2637460231781006, 2.2700231075286865, 2.9525325298309326, 4.88321590423584, 2.5336599349975586, 3.7916884422302246, 2.8275439739227295, 1.7944576740264893, 0.5632517337799072, 3.94047474861145, 0.32572388648986816, 0.9410631656646729, 1.1575126647949219, 0.5113356113433838, 1.8678526878356934, 2.0312719345092773, 2.451218366622925, 0.14569973945617676, 3.2780330181121826, 1.514190673828125, 1.41166353225708, 0.26766371726989746, 2.750471830368042, 0.49301981925964355, 2.13651180267334, 0.872567892074585, 3.4303338527679443, 0.932934045791626, 1.678252935409546, 3.065518617630005, 0.4811887741088867, 0.07435250282287598, 2.7440576553344727, 2.9922921657562256, 0.8485407829284668, 0.40465664863586426, 3.490088701248169, 0.1609201431274414, 2.3122026920318604, 2.3916046619415283, 0.22878003120422363, 3.446969747543335, 0.35653233528137207, 1.4266600608825684, 0.5174484252929688, 1.492821455001831, 3.939208745956421, 0.7900655269622803, 4.081242561340332, 3.300039768218994, 0.9137651920318604, 1.2695791721343994, 2.6978018283843994, 1.1252758502960205], "mean_td_error": 1.714133858680725, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 86.0, "diff_num_grad_updates_vs_sampler_policy": 85.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.05212116241455, "actor_loss": -9.370885848999023, "critic_loss": 0.2769623398780823, "alpha_loss": -0.25626853108406067, "alpha_value": 0.9748282432556152, "log_alpha_value": -0.025493977591395378, "target_entropy": -6.0, "policy_t": -0.009855181910097599, "mean_q": 5.4515485763549805, "max_q": 7.855510711669922, "min_q": 3.2172110080718994}, "td_error": [2.4365766048431396, 0.8114640712738037, 0.25454187393188477, 1.0045487880706787, 0.2540329694747925, 2.4765753746032715, 1.7086970806121826, 2.814981698989868, 0.31493282318115234, 0.17190337181091309, 1.6834598779678345, 0.4972562789916992, 0.7702765464782715, 0.0775611400604248, 2.0901243686676025, 2.691830635070801, 2.417189598083496, 1.8875129222869873, 3.5751829147338867, 0.0852203369140625, 0.4321777820587158, 4.245368003845215, 1.2848083972930908, 1.0575815439224243, 0.3478429317474365, 2.045156240463257, 0.5054062604904175, 0.8934183120727539, 1.0323750972747803, 0.13008809089660645, 1.6937031745910645, 1.2404022216796875, 0.6513922214508057, 0.020875930786132812, 1.987079381942749, 1.3389604091644287, 0.2976195812225342, 1.5446908473968506, 0.3932669162750244, 0.2974405288696289, 0.051281094551086426, 1.841266393661499, 2.8027658462524414, 1.1807911396026611, 2.4163174629211426, 1.548206090927124, 2.4646389484405518, 2.1459877490997314, 3.4465787410736084, 1.786956787109375, 2.7076470851898193, 0.8979992866516113, 0.6110143661499023, 1.7014760971069336, 3.0936310291290283, 1.942444086074829, 2.322443962097168, 2.7630157470703125, 0.31037044525146484, 2.1474504470825195, 2.1191892623901367, 0.7650449275970459, 0.033987998962402344, 1.4635772705078125, 1.9740376472473145, 0.28264617919921875, 1.6504905223846436, 1.2765467166900635, 0.3482074737548828, 0.1804947853088379, 6.125643730163574, 3.761950969696045, 4.494176387786865, 7.466824531555176, 0.9143271446228027, 0.5597131252288818, 2.8925485610961914, 3.2522454261779785, 3.801584005355835, 1.7405123710632324, 2.3860273361206055, 2.8570430278778076, 0.7723875045776367, 1.6197664737701416, 1.3128957748413086, 0.5962936878204346], "mean_td_error": 1.654581069946289, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 86.0, "diff_num_grad_updates_vs_sampler_policy": 85.0}}, "num_env_steps_sampled": 77952, "num_env_steps_trained": 22188, "num_agent_steps_sampled": 233856, "num_agent_steps_trained": 22188, "last_target_update_ts": 77952, "num_target_updates": 86}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 233856, "num_agent_steps_trained": 22188, "num_env_steps_sampled": 77952, "num_env_steps_trained": 22188, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 460.8813257344234, "num_env_steps_trained_throughput_per_sec": 132.70913174049244, "timesteps_total": 77952, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 233856, "timers": {"training_iteration_time_ms": 1918.082, "sample_time_ms": 1346.549, "load_time_ms": 0.528, "load_throughput": 489076.395, "learn_time_ms": 61.533, "learn_throughput": 4192.854, "synch_weights_time_ms": 15.999}, "counters": {"num_env_steps_sampled": 77952, "num_env_steps_trained": 22188, "num_agent_steps_sampled": 233856, "num_agent_steps_trained": 22188, "last_target_update_ts": 77952, "num_target_updates": 86}, "done": false, "episodes_total": 0, "training_iteration": 87, "trial_id": "566d8_00000", "date": "2023-11-16_22-23-15", "timestamp": 1700202195, "time_this_iter_s": 1.9601788520812988, "time_total_s": 176.1334285736084, "pid": 48481, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fb763906a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 176.1334285736084, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 66.63333333333334, "ram_util_percent": 92.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.048072814941406, "actor_loss": -9.461687088012695, "critic_loss": 0.3452033996582031, "alpha_loss": -0.25892433524131775, "alpha_value": 0.9745606184005737, "log_alpha_value": -0.02576855570077896, "target_entropy": -6.0, "policy_t": -0.01337926834821701, "mean_q": 5.630890369415283, "max_q": 7.707754611968994, "min_q": 4.03407621383667}, "td_error": [1.2539472579956055, 0.8079638481140137, 0.4274559020996094, 0.8036646842956543, 0.04165768623352051, 0.4124186038970947, 2.577540397644043, 1.970928430557251, 1.825941801071167, 0.489793062210083, 5.100861549377441, 1.9552087783813477, 0.35637426376342773, 0.625540018081665, 1.2600812911987305, 1.614051103591919, 2.7298061847686768, 0.5515861511230469, 2.0047762393951416, 2.638042449951172, 0.7527198791503906, 1.7930588722229004, 2.157073974609375, 2.6975488662719727, 0.4032094478607178, 3.1041946411132812, 1.8737537860870361, 2.2880048751831055, 2.2666170597076416, 4.670445442199707, 0.7079257965087891, 1.051206111907959, 0.2856159210205078, 2.0618374347686768, 1.6163907051086426, 1.8725895881652832, 2.165877342224121, 1.1373381614685059, 3.3116660118103027, 1.0407350063323975, 0.48276543617248535, 0.6856822967529297, 2.0934531688690186, 0.15153026580810547, 1.255218744277954, 0.6287198066711426, 1.3986034393310547, 2.524501085281372, 2.1237893104553223, 1.7416343688964844, 2.077770233154297, 3.2359724044799805, 1.3823614120483398, 0.6154096126556396, 2.0158822536468506, 2.020092010498047, 1.5030725002288818, 2.1123743057250977, 3.152024507522583, 0.11955451965332031, 0.8799700736999512, 0.32807445526123047, 0.8803501129150391, 0.5973021984100342, 2.4158239364624023, 1.0302650928497314, 0.375246524810791, 2.6974639892578125, 0.6316127777099609, 1.8611857891082764, 5.9298095703125, 3.7719743251800537, 2.1519341468811035, 1.7246143817901611, 2.5158791542053223, 3.122758150100708, 0.32596731185913086, 1.0037157535552979, 1.5843563079833984, 0.8336067199707031, 2.1205592155456543, 2.669262409210205, 1.0870246887207031, 0.2535276412963867, 1.905247449874878, 1.4346485137939453], "mean_td_error": 1.6530003547668457, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 87.0, "diff_num_grad_updates_vs_sampler_policy": 86.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.121573448181152, "actor_loss": -9.80993938446045, "critic_loss": 0.30969512462615967, "alpha_loss": -0.2611348330974579, "alpha_value": 0.9745301604270935, "log_alpha_value": -0.02579982578754425, "target_entropy": -6.0, "policy_t": 0.04038403928279877, "mean_q": 5.829164028167725, "max_q": 8.574150085449219, "min_q": 3.6619670391082764}, "td_error": [2.6960551738739014, 2.1527724266052246, 0.12472939491271973, 0.12575221061706543, 0.07091045379638672, 1.0410637855529785, 0.4935648441314697, 0.47988128662109375, 1.6306347846984863, 0.9526896476745605, 1.7010118961334229, 0.3667113780975342, 0.8197760581970215, 0.4591846466064453, 0.38435864448547363, 0.8594560623168945, 0.5769906044006348, 1.1769928932189941, 0.2587711811065674, 1.0985455513000488, 0.3744378089904785, 0.7972180843353271, 3.6838178634643555, 0.6591503620147705, 4.226038455963135, 0.7186429500579834, 1.765162706375122, 2.8243746757507324, 0.14283132553100586, 4.220107078552246, 2.813472032546997, 0.26014137268066406, 0.015912294387817383, 0.5123574733734131, 2.321016788482666, 0.1535654067993164, 0.7916752099990845, 2.0918807983398438, 0.16451311111450195, 0.2736780643463135, 1.1901624202728271, 0.33126235008239746, 0.5490522384643555, 3.4641339778900146, 0.1728651523590088, 0.07023000717163086, 0.23487615585327148, 3.006772994995117, 4.225770473480225, 3.478210210800171, 1.3125286102294922, 3.8140594959259033, 1.8558483123779297, 4.3107008934021, 2.1444385051727295, 1.770862102508545, 0.568444013595581, 0.811240553855896, 1.5519704818725586, 1.0306856632232666, 2.8592185974121094, 2.1177639961242676, 1.9213519096374512, 5.827877998352051, 1.8963510990142822, 0.9084737300872803, 0.13649415969848633, 1.2696340084075928, 0.9293622970581055, 0.8539776802062988, 2.922201633453369, 3.0490453243255615, 0.6969518661499023, 1.3680379390716553, 0.2635159492492676, 0.07921123504638672, 0.6936986446380615, 0.2573542594909668, 0.5684032440185547, 0.9714590311050415, 1.2023987770080566, 1.9510564804077148, 0.21286463737487793, 1.7861199378967285, 1.1680796146392822, 0.4795968532562256], "mean_td_error": 1.3786565065383911, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 87.0, "diff_num_grad_updates_vs_sampler_policy": 86.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.994958877563477, "actor_loss": -9.044346809387207, "critic_loss": 0.21135002374649048, "alpha_loss": -0.2578069865703583, "alpha_value": 0.974536120891571, "log_alpha_value": -0.025793705135583878, "target_entropy": -6.0, "policy_t": -0.0049728648737072945, "mean_q": 5.172451496124268, "max_q": 7.591538906097412, "min_q": 3.5565249919891357}, "td_error": [0.4503803253173828, 1.6634794473648071, 2.865307331085205, 0.7276561260223389, 0.2877011299133301, 0.461475133895874, 0.4023771286010742, 1.3264601230621338, 1.0835483074188232, 0.7077128887176514, 0.3796454668045044, 1.064117193222046, 1.8889315128326416, 0.16312158107757568, 2.2124996185302734, 0.2645726203918457, 1.2530908584594727, 0.32020747661590576, 1.610806941986084, 0.3954031467437744, 0.33167076110839844, 0.3930208683013916, 0.42619407176971436, 1.2240612506866455, 2.49916410446167, 3.898580551147461, 3.359981060028076, 2.366600513458252, 1.248988389968872, 0.436082124710083, 0.599747896194458, 2.6089274883270264, 0.45846986770629883, 1.6477442979812622, 0.34111344814300537, 2.136916160583496, 1.9560515880584717, 0.37819457054138184, 0.12015104293823242, 1.0872337818145752, 0.021726369857788086, 0.21319591999053955, 1.2223882675170898, 0.18222641944885254, 2.6614410877227783, 3.7715773582458496, 1.3586738109588623, 0.6174912452697754, 2.1615359783172607, 0.4875032901763916, 1.0607872009277344, 2.865089178085327, 0.14780449867248535, 2.256455898284912, 0.0387575626373291, 1.6969573497772217, 1.3391828536987305, 2.7899973392486572, 0.1791849136352539, 1.2786684036254883, 1.967990756034851, 0.2800041437149048, 1.797102689743042, 0.6005475521087646, 3.9839813709259033, 1.74631667137146, 1.4573850631713867, 1.7254345417022705, 0.6229188442230225, 2.3579983711242676, 3.220900058746338, 0.7437853813171387, 2.921218156814575, 0.2890605926513672, 0.8194844722747803, 1.2634856700897217, 0.8534815311431885, 0.979337215423584, 3.372246265411377, 1.0384759902954102, 2.710437536239624, 3.4594485759735107, 1.784595251083374, 0.947120189666748, 0.8066387176513672, 0.8670437335968018], "mean_td_error": 1.3490054607391357, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 87.0, "diff_num_grad_updates_vs_sampler_policy": 86.0}}, "num_env_steps_sampled": 78848, "num_env_steps_trained": 22446, "num_agent_steps_sampled": 236544, "num_agent_steps_trained": 22446, "last_target_update_ts": 78848, "num_target_updates": 87}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 236544, "num_agent_steps_trained": 22446, "num_env_steps_sampled": 78848, "num_env_steps_trained": 22446, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 379.80649405958667, "num_env_steps_trained_throughput_per_sec": 109.36392351269348, "timesteps_total": 78848, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 236544, "timers": {"training_iteration_time_ms": 1959.645, "sample_time_ms": 1386.561, "load_time_ms": 0.53, "load_throughput": 486569.439, "learn_time_ms": 61.743, "learn_throughput": 4178.633, "synch_weights_time_ms": 16.352}, "counters": {"num_env_steps_sampled": 78848, "num_env_steps_trained": 22446, "num_agent_steps_sampled": 236544, "num_agent_steps_trained": 22446, "last_target_update_ts": 78848, "num_target_updates": 87}, "done": false, "episodes_total": 0, "training_iteration": 88, "trial_id": "566d8_00000", "date": "2023-11-16_22-23-17", "timestamp": 1700202197, "time_this_iter_s": 2.3778891563415527, "time_total_s": 178.51131772994995, "pid": 48481, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fb780e85e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 178.51131772994995, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 64.56666666666666, "ram_util_percent": 92.5}}
