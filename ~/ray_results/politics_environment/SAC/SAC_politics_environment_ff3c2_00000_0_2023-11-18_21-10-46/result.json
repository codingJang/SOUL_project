{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 896, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2688, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2688, "num_agent_steps_trained": 0, "num_env_steps_sampled": 896, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 723.1754833249594, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 896, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2688, "timers": {"training_iteration_time_ms": 1238.957, "sample_time_ms": 667.069}, "counters": {"num_env_steps_sampled": 896, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2688, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 1, "trial_id": "ff3c2_00000", "date": "2023-11-18_21-10-56", "timestamp": 1700370656, "time_this_iter_s": 1.2416491508483887, "time_total_s": 1.2416491508483887, "pid": 7608, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17c1aa8e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 1.2416491508483887, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 41.85, "ram_util_percent": 63.75}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.011306762695312, "actor_loss": -4.021239757537842, "critic_loss": 3.980476140975952, "alpha_loss": -0.0030033921357244253, "alpha_value": 0.9997000694274902, "log_alpha_value": -0.00029999998514540493, "target_entropy": -6.0, "policy_t": -0.01905372552573681, "mean_q": 0.01684141345322132, "max_q": 0.13115347921848297, "min_q": 0.008348665200173855}, "td_error": [4.646488189697266, 3.986909866333008, 4.992099285125732, 5.069194793701172, 2.6448919773101807, 5.257260322570801, 3.716383457183838, 4.013988971710205, 6.295595169067383, 6.083226680755615, 5.25972843170166, 3.1967005729675293, 4.117585182189941, 4.152997970581055, 5.385585784912109, 4.3694257736206055, 2.732260227203369, 3.7531275749206543, 5.53701639175415, 5.0451154708862305, 6.3097686767578125, 2.860002279281616, 3.9114928245544434, 4.872628688812256, 3.5761313438415527, 4.554027080535889, 5.364765167236328, 4.453417778015137, 5.671681880950928, 3.8905982971191406, 4.277106285095215, 6.769955635070801, 4.774239540100098, 4.450894355773926, 5.488017559051514, 5.452770709991455, 4.635184288024902, 4.623077392578125, 4.588535785675049, 4.754997253417969, 5.526364326477051, 4.212597846984863, 4.7945098876953125, 3.194003105163574, 6.380239486694336, 3.8878228664398193, 4.385530948638916, 3.9452099800109863, 3.0619916915893555, 5.507730484008789, 4.109695911407471, 2.6742029190063477, 3.7345457077026367, 5.129639625549316, 7.314114093780518, 5.175057888031006, 5.527259349822998, 5.441105842590332, 5.029518127441406, 1.5703904628753662, 4.772614002227783, 4.606958866119385, 6.216982364654541, 4.904839038848877, 4.021463394165039, 5.135365009307861, 5.256985664367676, 4.704305648803711, 5.365785598754883, 4.465329647064209, 5.409698963165283, 6.2256879806518555, 5.218459606170654, 6.05354642868042, 5.3834123611450195, 2.725360155105591, 3.5644311904907227, 3.6745505332946777, 4.288576126098633, 4.680805206298828, 4.291617393493652, 4.955254554748535, 4.697141170501709, 4.489117622375488, 2.966360092163086, 5.533591270446777], "mean_td_error": 4.648193359375, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 2.0, "diff_num_grad_updates_vs_sampler_policy": 1.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.055102348327637, "actor_loss": -4.0689377784729, "critic_loss": 1.2429447174072266, "alpha_loss": -0.0030165305361151695, "alpha_value": 0.9997000694274902, "log_alpha_value": -0.00029999998514540493, "target_entropy": -6.0, "policy_t": 0.03249315172433853, "mean_q": 0.020944923162460327, "max_q": 0.19159924983978271, "min_q": 0.015049844048917294}, "td_error": [2.5022783279418945, 0.8868888020515442, 2.5688323974609375, 3.0620203018188477, 3.0430150032043457, 1.7712860107421875, 4.617220401763916, 1.5128287076950073, 3.276087522506714, 1.8321787118911743, 2.4634976387023926, 3.9398257732391357, 2.285311222076416, 3.3116559982299805, 3.175323009490967, 0.4649113714694977, 2.974583864212036, 3.565570831298828, 2.481387138366699, 2.471330165863037, 4.490257740020752, 3.7869224548339844, 2.2176945209503174, 4.624845504760742, 3.3010640144348145, 1.9997860193252563, 1.8718851804733276, 2.189253091812134, 2.0613651275634766, 2.6722326278686523, 2.2565488815307617, 2.044328212738037, 2.1664955615997314, 2.648771286010742, 2.271300792694092, 2.806426763534546, 3.598403215408325, 2.1479098796844482, 0.620079517364502, 4.200183868408203, 3.416642665863037, 2.813488721847534, 2.345200538635254, 3.503437042236328, 3.6494693756103516, 2.9525461196899414, 4.896857738494873, 3.2547402381896973, 1.4650319814682007, 3.854496479034424, 3.2055022716522217, 3.363572120666504, 2.982750415802002, 0.6024695634841919, 3.329211950302124, 3.6165761947631836, 1.4254097938537598, 2.223552703857422, 3.5175750255584717, 2.592149019241333, 1.9032280445098877, 3.847219944000244, 1.4105970859527588, 2.7135815620422363, 2.953031063079834, 2.8046045303344727, 2.3198585510253906, 4.817959785461426, 2.452787399291992, 1.1859323978424072, 3.0115201473236084, 2.988412380218506, 3.165761709213257, 1.8487470149993896, 3.517850399017334, 1.0760784149169922, 3.3797500133514404, 3.3490896224975586, 1.5507303476333618, 3.9766242504119873, 1.0266332626342773, 4.7577667236328125, 2.043980121612549, 2.755157470703125, 2.7069954872131348, 2.7959201335906982], "mean_td_error": 2.7389800548553467, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 2.0, "diff_num_grad_updates_vs_sampler_policy": 1.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.060809135437012, "actor_loss": -4.069016456604004, "critic_loss": 1.7425740957260132, "alpha_loss": -0.0030182427726686, "alpha_value": 0.9997000694274902, "log_alpha_value": -0.00029999998514540493, "target_entropy": -6.0, "policy_t": -0.03539860621094704, "mean_q": 0.012594152241945267, "max_q": 0.11614711582660675, "min_q": 0.007587049156427383}, "td_error": [4.035369396209717, 0.3876416087150574, 3.3542847633361816, 1.7559207677841187, 4.470191955566406, 5.120204925537109, 1.56344735622406, 2.115687370300293, 0.7983505725860596, 1.9208816289901733, 2.9287705421447754, 4.475421905517578, 2.133082389831543, 3.2390408515930176, 2.575117588043213, 0.6155291199684143, 3.2309062480926514, 2.696702480316162, 2.605745315551758, 5.738607883453369, 2.6504831314086914, 1.1977299451828003, 4.2592973709106445, 2.23335599899292, 1.7675833702087402, 3.291945457458496, 2.95453143119812, 1.970022439956665, 3.576369047164917, 2.548116683959961, 3.4051976203918457, 2.1686525344848633, 2.141995906829834, 2.030606746673584, 3.353332996368408, 3.1711010932922363, 3.3177127838134766, 1.5855906009674072, 3.1665496826171875, 2.988156795501709, 4.0024261474609375, 2.372136116027832, 2.02542781829834, 2.340695381164551, 3.387664794921875, 1.415640950202942, 2.685326099395752, 2.182147979736328, 2.873340368270874, 2.810190439224243, 2.324467182159424, 1.1561617851257324, 3.4893903732299805, 2.16355037689209, 4.198031425476074, 2.379122257232666, 1.6362342834472656, 1.6974456310272217, 2.757148265838623, 4.720333099365234, 3.4593653678894043, 1.3363456726074219, 2.9786412715911865, 1.2085679769515991, 3.5663464069366455, 2.7011218070983887, 2.946298122406006, 2.310840129852295, 2.032571792602539, 2.631317615509033, 2.5232620239257812, 3.9000492095947266, 2.1646738052368164, 1.9977359771728516, 1.028151035308838, 1.9527668952941895, 1.6964170932769775, 3.882596492767334, 1.3171941041946411, 2.074892997741699, 3.3355159759521484, 4.148462295532227, 2.806617498397827, 2.0190086364746094, 2.7511773109436035, 0.06159641593694687], "mean_td_error": 2.616135597229004, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 2.0, "diff_num_grad_updates_vs_sampler_policy": 1.0}}, "num_env_steps_sampled": 2688, "num_env_steps_trained": 516, "num_agent_steps_sampled": 8064, "num_agent_steps_trained": 516, "last_target_update_ts": 2688, "num_target_updates": 2}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8064, "num_agent_steps_trained": 516, "num_env_steps_sampled": 2688, "num_env_steps_trained": 516, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 1015.746473155439, "num_env_steps_trained_throughput_per_sec": 292.48056927913314, "timesteps_total": 2688, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 8064, "timers": {"training_iteration_time_ms": 1001.043, "sample_time_ms": 618.289, "load_time_ms": 0.306, "load_throughput": 841797.302, "learn_time_ms": 30.413, "learn_throughput": 8483.172, "synch_weights_time_ms": 9.77}, "counters": {"num_env_steps_sampled": 2688, "num_env_steps_trained": 516, "num_agent_steps_sampled": 8064, "num_agent_steps_trained": 516, "last_target_update_ts": 2688, "num_target_updates": 2}, "done": false, "episodes_total": 0, "training_iteration": 2, "trial_id": "ff3c2_00000", "date": "2023-11-18_21-10-58", "timestamp": 1700370658, "time_this_iter_s": 1.7730228900909424, "time_total_s": 3.014672040939331, "pid": 7608, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17c1aae80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 3.014672040939331, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 57.23333333333333, "ram_util_percent": 64.33333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.995994567871094, "actor_loss": -4.017920970916748, "critic_loss": 3.712850570678711, "alpha_loss": -0.005996234714984894, "alpha_value": 0.9994003176689148, "log_alpha_value": -0.0005998637061566114, "target_entropy": -6.0, "policy_t": 0.012861635535955429, "mean_q": 0.03013843670487404, "max_q": 0.2710779309272766, "min_q": 0.01885882392525673}, "td_error": [5.585632801055908, 4.599871635437012, 4.1828508377075195, 5.089264392852783, 4.488104343414307, 3.4672274589538574, 3.697131872177124, 5.087713241577148, 4.935276985168457, 6.417177200317383, 3.9901957511901855, 2.6661267280578613, 5.957294940948486, 6.064318656921387, 3.5689339637756348, 5.218901634216309, 4.2623677253723145, 3.0448741912841797, 2.563009262084961, 2.679133415222168, 5.412110328674316, 3.1568922996520996, 3.828303813934326, 4.398196697235107, 4.496522903442383, 2.740513324737549, 5.658847332000732, 5.800352096557617, 4.10093879699707, 4.9296464920043945, 5.920384407043457, 5.4308271408081055, 2.442530393600464, 4.076937198638916, 2.653768539428711, 5.663524627685547, 4.9374494552612305, 4.4505486488342285, 2.6480565071105957, 3.705070734024048, 4.059826850891113, 2.9182114601135254, 4.2240753173828125, 5.914419651031494, 4.851099491119385, 4.490560531616211, 4.990162372589111, 5.191812038421631, 2.9059572219848633, 4.6335883140563965, 3.9448084831237793, 3.679046154022217, 4.625430583953857, 5.208065032958984, 3.1040868759155273, 5.540914535522461, 4.168046951293945, 5.860919952392578, 2.3658390045166016, 3.919553756713867, 4.257458686828613, 4.109041213989258, 3.713775157928467, 3.8318369388580322, 4.721681118011475, 4.686746597290039, 6.492184638977051, 5.569173812866211, 3.2907464504241943, 4.951540946960449, 5.308239459991455, 3.6699252128601074, 4.894235134124756, 4.994128704071045, 5.019851207733154, 4.981788158416748, 3.0905017852783203, 2.34993314743042, 4.8826093673706055, 5.480578422546387, 3.480372905731201, 4.652782440185547, 5.617934226989746, 3.042117118835449, 3.790229320526123, 2.8495731353759766], "mean_td_error": 4.352817058563232, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 3.0, "diff_num_grad_updates_vs_sampler_policy": 2.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.014734268188477, "actor_loss": -4.042305946350098, "critic_loss": 1.2140772342681885, "alpha_loss": -0.006009340286254883, "alpha_value": 0.9994001388549805, "log_alpha_value": -0.0006000499124638736, "target_entropy": -6.0, "policy_t": 0.004479088354855776, "mean_q": 0.046458955854177475, "max_q": 0.3346169590950012, "min_q": 0.02773304097354412}, "td_error": [2.7797634601593018, 2.8187336921691895, 1.7180500030517578, 2.6546337604522705, 1.3955214023590088, 3.751389980316162, 4.434847831726074, 2.9117648601531982, 2.7873220443725586, 2.336956739425659, 1.620680570602417, 1.8810595273971558, 1.6795916557312012, 2.6162285804748535, 3.960214614868164, 2.993244171142578, 2.649714469909668, 3.1517457962036133, 2.030369281768799, 2.336472272872925, 5.122017860412598, 1.2298320531845093, 3.599428653717041, 1.5578737258911133, 3.271605968475342, 3.1825451850891113, 2.8743977546691895, 3.725098133087158, 2.7855892181396484, 1.2122106552124023, 2.2736597061157227, 2.160088539123535, 4.748795509338379, 0.6871828436851501, 3.870339870452881, 1.6421771049499512, 3.5518312454223633, 1.8320626020431519, 2.0597352981567383, 3.1030473709106445, 2.4791722297668457, 2.94806170463562, 3.392807722091675, 2.120443820953369, 4.019813060760498, 4.619920253753662, 1.6248934268951416, 0.8453501462936401, 2.52915096282959, 2.844217300415039, 2.170175075531006, 1.01487135887146, 3.579805850982666, 1.9310147762298584, 3.6046557426452637, 0.8131264448165894, 3.2699899673461914, 0.950352668762207, 2.012601613998413, 1.9921284914016724, 1.5993825197219849, 3.5427753925323486, 3.2910475730895996, 1.852776050567627, 3.3735735416412354, 1.3371779918670654, 4.244292259216309, 2.7172436714172363, 1.6896498203277588, 3.754456043243408, 2.5139856338500977, 3.2776284217834473, 2.266902446746826, 3.5418224334716797, 3.408205270767212, 3.252688407897949, 4.2566962242126465, 4.0540876388549805, 4.1386542320251465, 2.5169248580932617, 3.654858350753784, 1.2961108684539795, 1.6318366527557373, 3.4917068481445312, 2.547494888305664, 4.393678188323975], "mean_td_error": 2.7140235900878906, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 3.0, "diff_num_grad_updates_vs_sampler_policy": 2.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.089666366577148, "actor_loss": -4.108044147491455, "critic_loss": 1.110713243484497, "alpha_loss": -0.006054243538528681, "alpha_value": 0.9994001388549805, "log_alpha_value": -0.0006000439170747995, "target_entropy": -6.0, "policy_t": -0.014995310455560684, "mean_q": 0.026250023394823074, "max_q": 0.25736263394355774, "min_q": 0.015391466207802296}, "td_error": [2.0118236541748047, 2.4131531715393066, 2.264312267303467, 1.4979082345962524, 4.106719017028809, 3.1830639839172363, 3.6937003135681152, 3.5626964569091797, 1.7177917957305908, 2.788505792617798, 2.0191235542297363, 4.419056415557861, 3.230494976043701, 3.408689022064209, 2.8123579025268555, 2.3001708984375, 2.697577953338623, 1.2333197593688965, 2.5473170280456543, 2.9180612564086914, 2.815157413482666, 3.2891592979431152, 3.3951125144958496, 2.284433603286743, 3.0679984092712402, 0.7237800359725952, 2.053948163986206, 1.6624547243118286, 3.16119122505188, 3.8627853393554688, 2.1148061752319336, 3.619748115539551, 2.475006341934204, 1.3881738185882568, 2.202662944793701, 3.053166389465332, 1.550581455230713, 1.5702781677246094, 2.9866325855255127, 2.621006965637207, 1.2548794746398926, 4.175030708312988, 2.1845998764038086, 4.9228010177612305, 2.948458433151245, 3.065469741821289, 3.5171875953674316, 2.585782051086426, 2.5858912467956543, 3.844259738922119, 2.182767152786255, 3.5564041137695312, 2.2017335891723633, 4.1249237060546875, 2.396095037460327, 3.801767349243164, 3.447543144226074, 1.3497753143310547, 3.0469460487365723, 3.2835397720336914, 1.4433143138885498, 4.073025703430176, 4.029165267944336, 2.8323111534118652, 3.4350502490997314, 3.600372791290283, 2.1805872917175293, 1.5959842205047607, 2.5727176666259766, 3.934467315673828, 1.4128751754760742, 3.1940817832946777, 0.3832515478134155, 4.11281681060791, 1.3572181463241577, 3.2589728832244873, 1.7505805492401123, 2.0467066764831543, 0.7417014241218567, 1.5910040140151978, 1.2490878105163574, 3.5630550384521484, 1.9147396087646484, 3.7512807846069336, 3.18363094329834, 3.4590635299682617], "mean_td_error": 2.6961262226104736, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 3.0, "diff_num_grad_updates_vs_sampler_policy": 2.0}}, "num_env_steps_sampled": 3584, "num_env_steps_trained": 774, "num_agent_steps_sampled": 10752, "num_agent_steps_trained": 774, "last_target_update_ts": 3584, "num_target_updates": 3}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10752, "num_agent_steps_trained": 774, "num_env_steps_sampled": 3584, "num_env_steps_trained": 774, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 877.0701250691393, "num_env_steps_trained_throughput_per_sec": 252.54921012035484, "timesteps_total": 3584, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 10752, "timers": {"training_iteration_time_ms": 1006.173, "sample_time_ms": 618.991, "load_time_ms": 0.313, "load_throughput": 825213.853, "learn_time_ms": 26.699, "learn_throughput": 9663.231, "synch_weights_time_ms": 9.881}, "counters": {"num_env_steps_sampled": 3584, "num_env_steps_trained": 774, "num_agent_steps_sampled": 10752, "num_agent_steps_trained": 774, "last_target_update_ts": 3584, "num_target_updates": 3}, "done": false, "episodes_total": 0, "training_iteration": 3, "trial_id": "ff3c2_00000", "date": "2023-11-18_21-10-59", "timestamp": 1700370659, "time_this_iter_s": 1.0306642055511475, "time_total_s": 4.0453362464904785, "pid": 7608, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17c1ab740>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 4.0453362464904785, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 74.1, "ram_util_percent": 64.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.081103324890137, "actor_loss": -4.127292156219482, "critic_loss": 3.921544313430786, "alpha_loss": -0.012092811986804008, "alpha_value": 0.9988011717796326, "log_alpha_value": -0.0011995523236691952, "target_entropy": -6.0, "policy_t": 0.0076452577486634254, "mean_q": 0.0746762603521347, "max_q": 0.6496323347091675, "min_q": 0.041146546602249146}, "td_error": [6.535953044891357, 5.772187232971191, 3.473566770553589, 2.1522433757781982, 1.8817397356033325, 3.9878592491149902, 5.611414432525635, 3.5988032817840576, 6.063694953918457, 5.650616645812988, 5.201436519622803, 6.286774158477783, 3.546858310699463, 7.083210468292236, 5.699950218200684, 3.7654170989990234, 3.584228038787842, 5.536441326141357, 3.131770610809326, 5.4328436851501465, 5.374472618103027, 3.0583596229553223, 4.350007057189941, 4.348075866699219, 5.842928409576416, 4.668484687805176, 3.56797456741333, 4.214962959289551, 5.057783603668213, 4.834491729736328, 4.809116363525391, 4.904677391052246, 3.3623080253601074, 4.46146297454834, 3.597407341003418, 5.732306480407715, 5.903594017028809, 3.5106120109558105, 6.619881629943848, 5.630291938781738, 5.048044204711914, 4.244479179382324, 3.470754623413086, 4.045573711395264, 4.633851528167725, 4.754936695098877, 4.767911911010742, 5.476898193359375, 4.041506290435791, 6.6069841384887695, 2.3182950019836426, 5.626224517822266, 4.3796844482421875, 4.6309356689453125, 5.216538429260254, 5.613968372344971, 3.2635016441345215, 5.621750831604004, 4.993657112121582, 3.75115966796875, 4.971868515014648, 3.48616361618042, 4.639039039611816, 4.264776229858398, 5.622120380401611, 4.721828460693359, 6.766965866088867, 5.054227828979492, 3.521437406539917, 4.671597003936768, 4.120037078857422, 4.990865707397461, 3.9563374519348145, 3.837512969970703, 4.491120338439941, 3.411909580230713, 5.669350624084473, 4.804592609405518, 3.816066265106201, 6.860008239746094, 4.032443523406982, 4.632359504699707, 4.96619987487793, 3.41473126411438, 2.9200494289398193, 5.124574661254883], "mean_td_error": 4.640942096710205, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 5.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.123834609985352, "actor_loss": -4.179998874664307, "critic_loss": 0.4932307004928589, "alpha_loss": -0.012150032445788383, "alpha_value": 0.9988005757331848, "log_alpha_value": -0.0012001412687823176, "target_entropy": -6.0, "policy_t": 0.005457998253405094, "mean_q": 0.07012389600276947, "max_q": 0.6031529903411865, "min_q": 0.054582979530096054}, "td_error": [0.4257623553276062, 3.5781548023223877, 4.335869789123535, 3.200488805770874, 2.135476589202881, 2.0965769290924072, 3.8902931213378906, 3.9268112182617188, 3.4387502670288086, 2.535447359085083, 2.520627021789551, 2.898548126220703, 1.1549010276794434, 4.610791206359863, 3.7169134616851807, 2.633920669555664, 2.7745113372802734, 2.9971301555633545, 2.594264030456543, 1.4649317264556885, 2.1685285568237305, 2.153640031814575, 2.417263984680176, 4.410630226135254, 0.7720600366592407, 0.7792253494262695, 2.2356619834899902, 1.4421100616455078, 4.949512481689453, 2.9024288654327393, 2.0588669776916504, 3.3103294372558594, 4.782011032104492, 3.7254629135131836, 2.3852171897888184, 3.2765791416168213, 1.7911492586135864, 1.5436701774597168, 3.3922438621520996, 0.6022268533706665, 2.6683599948883057, 2.8508968353271484, 3.080409049987793, 1.9170761108398438, 3.302426815032959, 1.6546342372894287, 1.9812678098678589, 2.7099976539611816, 2.6340551376342773, 1.4950220584869385, 3.1563920974731445, 3.18109130859375, 0.8827260732650757, 1.4929531812667847, 2.0791845321655273, 4.424492835998535, 0.952508807182312, 2.351170063018799, 2.496662139892578, 3.7273025512695312, 3.955742359161377, 4.1279168128967285, 2.5259132385253906, 0.838762640953064, 2.3047423362731934, 4.567446708679199, 3.9582788944244385, 1.2402714490890503, 3.0078115463256836, 4.077239513397217, 1.3544254302978516, 2.800973415374756, 1.2676162719726562, 1.2498047351837158, 3.5221357345581055, 2.522512435913086, 2.7425408363342285, 2.278648853302002, 2.6071105003356934, 2.0740299224853516, 1.8189398050308228, 2.2145190238952637, 1.4018528461456299, 4.371234893798828, 3.148113965988159, 3.16990327835083], "mean_td_error": 2.630419969558716, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 5.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.995494842529297, "actor_loss": -4.033860206604004, "critic_loss": 1.0461704730987549, "alpha_loss": -0.011995675973594189, "alpha_value": 0.9988006353378296, "log_alpha_value": -0.001200108090415597, "target_entropy": -6.0, "policy_t": 0.033615950495004654, "mean_q": 0.053293079137802124, "max_q": 0.5412908792495728, "min_q": 0.03125566616654396}, "td_error": [1.871788740158081, 3.0244522094726562, 0.993944525718689, 1.2527446746826172, 1.8535490036010742, 1.964107632637024, 4.596492290496826, 2.7956583499908447, 2.1448373794555664, 2.541912078857422, 2.2592151165008545, 1.3130710124969482, 1.7071490287780762, 2.905871868133545, 4.788326263427734, 2.4036335945129395, 1.486297369003296, 3.502669334411621, 2.114922046661377, 3.794496536254883, 1.921111822128296, 2.2621378898620605, 2.2475996017456055, 3.5307650566101074, 1.6820340156555176, 3.394286870956421, 3.1991076469421387, 4.988937854766846, 3.1969597339630127, 3.111984968185425, 3.7316579818725586, 2.8759799003601074, 1.2924039363861084, 2.5823445320129395, 1.4344639778137207, 3.0605900287628174, 3.350214719772339, 2.102008819580078, 2.809375762939453, 3.377586841583252, 1.1233181953430176, 3.5754027366638184, 3.844174861907959, 2.834453582763672, 1.8760006427764893, 2.2515430450439453, 2.2558183670043945, 2.3287558555603027, 1.6988186836242676, 3.526407480239868, 3.4929909706115723, 4.939116954803467, 4.0272603034973145, 3.812054395675659, 1.606222152709961, 2.4089584350585938, 3.9088540077209473, 2.6978371143341064, 3.3212594985961914, 3.6873698234558105, 0.9222530722618103, 1.750272512435913, 3.6752381324768066, 1.9671247005462646, 1.4391868114471436, 3.349544048309326, 2.773085594177246, 2.8328208923339844, 1.9055707454681396, 1.485015869140625, 3.188121795654297, 3.3266115188598633, 1.4769234657287598, 1.898238182067871, 2.8258914947509766, 3.5296287536621094, 0.7396670579910278, 1.503387212753296, 0.064958356320858, 1.586376428604126, 3.924025297164917, 0.7748863697052002, 2.255030870437622, 2.535447597503662, 2.742110252380371, 2.7500147819519043], "mean_td_error": 2.5802876949310303, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 5.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 5376, "num_env_steps_trained": 1290, "num_agent_steps_sampled": 16128, "num_agent_steps_trained": 1290, "last_target_update_ts": 5376, "num_target_updates": 5}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16128, "num_agent_steps_trained": 1290, "num_env_steps_sampled": 5376, "num_env_steps_trained": 1290, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 1036.901026776082, "num_env_steps_trained_throughput_per_sec": 298.57194744222005, "timesteps_total": 5376, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 16128, "timers": {"training_iteration_time_ms": 958.809, "sample_time_ms": 607.634, "load_time_ms": 0.309, "load_throughput": 834462.085, "learn_time_ms": 23.225, "learn_throughput": 11108.937, "synch_weights_time_ms": 9.736}, "counters": {"num_env_steps_sampled": 5376, "num_env_steps_trained": 1290, "num_agent_steps_sampled": 16128, "num_agent_steps_trained": 1290, "last_target_update_ts": 5376, "num_target_updates": 5}, "done": false, "episodes_total": 0, "training_iteration": 4, "trial_id": "ff3c2_00000", "date": "2023-11-18_21-11-01", "timestamp": 1700370661, "time_this_iter_s": 1.7370550632476807, "time_total_s": 5.782391309738159, "pid": 7608, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17c1aa520>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 5.782391309738159, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 62.03333333333333, "ram_util_percent": 64.43333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.069046020507812, "actor_loss": -4.142951965332031, "critic_loss": 3.631526470184326, "alpha_loss": -0.018118303269147873, "alpha_value": 0.9982022047042847, "log_alpha_value": -0.0017994060181081295, "target_entropy": -6.0, "policy_t": -0.01635468751192093, "mean_q": 0.12399628013372421, "max_q": 1.0527656078338623, "min_q": 0.06644086539745331}, "td_error": [3.3074827194213867, 2.789013385772705, 4.832820415496826, 3.2442116737365723, 4.459881782531738, 5.513841152191162, 5.873981475830078, 4.208284378051758, 5.210714340209961, 5.394403457641602, 5.3431854248046875, 3.7604243755340576, 4.40741491317749, 4.534903526306152, 4.4759321212768555, 2.334158182144165, 2.875866174697876, 4.285031795501709, 4.384129524230957, 4.203020095825195, 3.6937716007232666, 5.187878608703613, 3.396427631378174, 4.152056694030762, 6.679365158081055, 6.646725654602051, 4.702173233032227, 4.378849983215332, 3.6944427490234375, 6.641197204589844, 4.178736686706543, 6.473698616027832, 3.0783677101135254, 3.358919143676758, 2.1223320960998535, 5.278807640075684, 5.942317962646484, 4.211766242980957, 4.566242694854736, 3.9954285621643066, 5.134697914123535, 5.157562255859375, 4.712799072265625, 4.4483561515808105, 3.6652016639709473, 2.6986398696899414, 3.961414337158203, 5.158555030822754, 3.1327085494995117, 3.179563045501709, 4.166680335998535, 3.2240965366363525, 5.4644269943237305, 5.512938499450684, 6.061635494232178, 4.596919059753418, 5.7723236083984375, 3.2332139015197754, 5.818114757537842, 3.250196933746338, 4.640668869018555, 4.343391418457031, 3.440793037414551, 3.7276668548583984, 4.964346885681152, 4.7484612464904785, 3.7415621280670166, 4.840330123901367, 4.073642730712891, 4.169576168060303, 4.604768753051758, 3.9112868309020996, 5.02214241027832, 3.7191920280456543, 3.2878856658935547, 3.2110838890075684, 4.71442985534668, 3.057199716567993, 5.219293594360352, 4.550432205200195, 4.775752067565918, 4.945269584655762, 3.9241561889648438, 5.812926292419434, 3.9068799018859863, 3.51356840133667], "mean_td_error": 4.384127616882324, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 7.0, "diff_num_grad_updates_vs_sampler_policy": 6.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.113990783691406, "actor_loss": -4.1974053382873535, "critic_loss": 0.49489909410476685, "alpha_loss": -0.018209271132946014, "alpha_value": 0.9982011914253235, "log_alpha_value": -0.00180040393024683, "target_entropy": -6.0, "policy_t": 0.006468597799539566, "mean_q": 0.11618899554014206, "max_q": 0.9861475229263306, "min_q": 0.0819067433476448}, "td_error": [2.6650118827819824, 2.126749038696289, 1.768066644668579, 2.922545909881592, 3.109389305114746, 2.7231009006500244, 2.747361660003662, 1.865231990814209, 3.3137829303741455, 4.515805244445801, 3.600614547729492, 0.1507282257080078, 1.795433521270752, 3.831977367401123, 1.7450933456420898, 3.7093966007232666, 3.7038516998291016, 3.6043217182159424, 1.9070206880569458, 3.2146406173706055, 0.9895180463790894, 1.4907232522964478, 2.555992841720581, 4.139139175415039, 3.725337028503418, 1.1754947900772095, 3.5402355194091797, 2.0127720832824707, 1.1380505561828613, 4.141204833984375, 2.801114082336426, 3.8356869220733643, 3.6861202716827393, 3.133233070373535, 2.8091065883636475, 1.7784950733184814, 2.9434146881103516, 2.082813262939453, 3.018782615661621, 2.5648484230041504, 3.4593024253845215, 1.3680723905563354, 3.227998971939087, 2.5279483795166016, 2.2918543815612793, 2.79587984085083, 1.9174813032150269, 2.0026938915252686, 2.225335121154785, 1.8189423084259033, 3.5782699584960938, 1.8783996105194092, 1.791243553161621, 3.5415265560150146, 1.1108131408691406, 2.9705138206481934, 1.578798770904541, 2.3424108028411865, 3.1754703521728516, 2.6811060905456543, 3.2484002113342285, 2.4682369232177734, 0.3869357705116272, 2.7651350498199463, 3.0824856758117676, 3.861882209777832, 3.392158031463623, 2.6518077850341797, 1.8353495597839355, 2.971651315689087, 3.1366395950317383, 4.378619194030762, 3.226175308227539, 3.577425479888916, 0.8658398985862732, 2.2691564559936523, 3.1053414344787598, 3.2354536056518555, 4.147747993469238, 1.177290678024292, 3.7516794204711914, 1.5948247909545898, 3.101686716079712, 1.2591030597686768, 0.27368512749671936, 0.524370551109314], "mean_td_error": 2.594829559326172, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 7.0, "diff_num_grad_updates_vs_sampler_policy": 6.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.119890213012695, "actor_loss": -4.178811550140381, "critic_loss": 1.0652573108673096, "alpha_loss": -0.01821575127542019, "alpha_value": 0.9982016086578369, "log_alpha_value": -0.0017999948468059301, "target_entropy": -6.0, "policy_t": 0.028126729652285576, "mean_q": 0.08731750398874283, "max_q": 0.770665168762207, "min_q": 0.049102626740932465}, "td_error": [2.216222047805786, 2.3179426193237305, 3.7694807052612305, 3.3808043003082275, 2.1983554363250732, 2.8062260150909424, 1.7803337574005127, 1.529651165008545, 2.258474588394165, 3.9352450370788574, 2.6566226482391357, 1.5702366828918457, 3.7740578651428223, 3.7030746936798096, 1.8567297458648682, 3.568277597427368, 2.3212103843688965, 0.7988477945327759, 3.096153974533081, 1.2378349304199219, 3.4224417209625244, 2.603405237197876, 2.458061695098877, 3.31487774848938, 3.2068662643432617, 3.34891414642334, 1.5664998292922974, 5.432794570922852, 0.8653236031532288, 2.304185152053833, 2.6969525814056396, 1.2116260528564453, 0.497037410736084, 3.7999191284179688, 2.906296491622925, 3.1121153831481934, 2.675748825073242, 2.0329651832580566, 2.8941304683685303, 2.7584195137023926, 4.018577575683594, 3.894712448120117, 2.692847728729248, 3.2351343631744385, 1.9242825508117676, 2.555732250213623, 1.3159680366516113, 2.779263496398926, 2.471510410308838, 3.4148712158203125, 2.8736367225646973, 1.6417704820632935, 2.8155393600463867, 4.990069389343262, 3.3943464756011963, 1.646714448928833, 2.820929527282715, 2.144329071044922, 2.440418243408203, 3.618743419647217, 2.8696155548095703, 2.177307605743408, 1.3648357391357422, 2.433598756790161, 2.808316469192505, 2.211271286010742, 0.5257744193077087, 3.2930240631103516, 3.012758255004883, 2.2628345489501953, 4.841848373413086, 2.0299196243286133, 4.186596870422363, 3.8058176040649414, 2.4466781616210938, 0.13107497990131378, 3.219299793243408, 3.6321768760681152, 2.0666556358337402, 4.436007022857666, 3.008265495300293, 2.86326003074646, 1.5989742279052734, 2.025628089904785, 2.172783851623535, 3.2898075580596924], "mean_td_error": 2.6661384105682373, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 7.0, "diff_num_grad_updates_vs_sampler_policy": 6.0}}, "num_env_steps_sampled": 7168, "num_env_steps_trained": 1806, "num_agent_steps_sampled": 21504, "num_agent_steps_trained": 1806, "last_target_update_ts": 7168, "num_target_updates": 7}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 21504, "num_agent_steps_trained": 1806, "num_env_steps_sampled": 7168, "num_env_steps_trained": 1806, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 1006.5582320383983, "num_env_steps_trained_throughput_per_sec": 289.83484806462803, "timesteps_total": 7168, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 21504, "timers": {"training_iteration_time_ms": 941.643, "sample_time_ms": 609.939, "load_time_ms": 0.312, "load_throughput": 828221.411, "learn_time_ms": 21.794, "learn_throughput": 11838.114, "synch_weights_time_ms": 9.644}, "counters": {"num_env_steps_sampled": 7168, "num_env_steps_trained": 1806, "num_agent_steps_sampled": 21504, "num_agent_steps_trained": 1806, "last_target_update_ts": 7168, "num_target_updates": 7}, "done": false, "episodes_total": 0, "training_iteration": 5, "trial_id": "ff3c2_00000", "date": "2023-11-18_21-11-02", "timestamp": 1700370662, "time_this_iter_s": 1.7899730205535889, "time_total_s": 7.572364330291748, "pid": 7608, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17c1aa660>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 7.572364330291748, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 67.7, "ram_util_percent": 64.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.058171272277832, "actor_loss": -4.16566276550293, "critic_loss": 3.772087574005127, "alpha_loss": -0.02413249760866165, "alpha_value": 0.9976035952568054, "log_alpha_value": -0.0023992927744984627, "target_entropy": -6.0, "policy_t": 0.034147586673498154, "mean_q": 0.19575642049312592, "max_q": 1.3894065618515015, "min_q": 0.09598695486783981}, "td_error": [4.819441795349121, 4.5142951011657715, 3.3462555408477783, 5.3207926750183105, 4.689205169677734, 5.376267433166504, 3.322847366333008, 2.7499074935913086, 4.3438496589660645, 5.1958208084106445, 4.564487457275391, 5.685235500335693, 4.337098121643066, 3.952524185180664, 2.8120718002319336, 4.002564430236816, 4.9366912841796875, 5.598064422607422, 2.38954496383667, 5.112776756286621, 4.600937843322754, 1.379787564277649, 5.352720260620117, 4.832818984985352, 5.260978698730469, 5.401698112487793, 5.856542587280273, 4.640760898590088, 3.742194890975952, 5.043305397033691, 4.527705192565918, 5.4951395988464355, 4.686383247375488, 4.383420944213867, 4.737762451171875, 4.72914981842041, 6.775896072387695, 5.558202743530273, 3.2677502632141113, 4.425401210784912, 4.387622833251953, 5.452566623687744, 5.173177719116211, 4.387598514556885, 4.118800163269043, 3.414903163909912, 4.523669719696045, 4.387402534484863, 6.019883155822754, 2.126420736312866, 2.652400493621826, 4.756083011627197, 2.0360522270202637, 5.899993896484375, 4.232823371887207, 5.653423309326172, 5.676722526550293, 3.059370994567871, 2.4765686988830566, 4.041312217712402, 3.745373249053955, 2.927889347076416, 5.922495365142822, 4.0099077224731445, 4.6240386962890625, 3.588007926940918, 4.427798271179199, 4.29792594909668, 6.244278907775879, 5.010622501373291, 4.657792091369629, 4.713367462158203, 5.616209506988525, 3.786165952682495, 3.933969020843506, 4.694258689880371, 6.361420631408691, 3.8966214656829834, 3.1376261711120605, 4.712441444396973, 5.319909572601318, 4.207043170928955, 4.257275581359863, 4.566740036010742, 3.617006301879883, 5.212745666503906], "mean_td_error": 4.462023735046387, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 9.0, "diff_num_grad_updates_vs_sampler_policy": 8.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.039813995361328, "actor_loss": -4.156449317932129, "critic_loss": 0.5079357028007507, "alpha_loss": -0.0241027120500803, "alpha_value": 0.9976021647453308, "log_alpha_value": -0.0024007135070860386, "target_entropy": -6.0, "policy_t": -0.036842238157987595, "mean_q": 0.1865645796060562, "max_q": 1.4774330854415894, "min_q": 0.11170805245637894}, "td_error": [3.7586257457733154, 0.2991724908351898, 4.911142349243164, 1.2910735607147217, 3.374549388885498, 1.610482931137085, 2.0271778106689453, 3.7000441551208496, 2.926189422607422, 2.4441356658935547, 5.172913551330566, 2.3736987113952637, 2.6584572792053223, 3.2744932174682617, 1.7471280097961426, 2.5416641235351562, 1.13520348072052, 4.543328762054443, 1.0520704984664917, 2.2892751693725586, 0.32547450065612793, 2.870363235473633, 2.8174495697021484, 4.632388591766357, 3.217832326889038, 4.7413763999938965, 3.9537830352783203, 2.7313289642333984, 0.3318866789340973, 1.6317088603973389, 2.656724452972412, 2.921107530593872, 3.951620578765869, 1.9116955995559692, 2.8344531059265137, 4.968583106994629, 3.545729160308838, 1.8859572410583496, 2.2188291549682617, 1.8331236839294434, 2.2678427696228027, 1.9059455394744873, 0.3393983840942383, 2.156397819519043, 2.855811834335327, 4.468944549560547, 3.712003707885742, 4.103765964508057, 1.6228117942810059, 3.3259432315826416, 2.3110430240631104, 1.265330195426941, 2.596738338470459, 3.3423194885253906, 1.549442172050476, 2.9965758323669434, 3.1416120529174805, 2.849984645843506, 1.7303270101547241, 1.4592164754867554, 3.6465044021606445, 2.2397470474243164, 2.7685885429382324, 4.192494869232178, 3.5757579803466797, 2.6891427040100098, 3.545149087905884, 1.2179118394851685, 2.542309045791626, 2.0913538932800293, 1.3612983226776123, 3.3688979148864746, 3.5268678665161133, 1.7962020635604858, 1.3963830471038818, 4.2340898513793945, 2.3666152954101562, 2.1500871181488037, 2.089315414428711, 3.3161189556121826, 2.2471718788146973, 4.190296173095703, 1.061567783355713, 3.6675620079040527, 1.3382357358932495, 2.4809656143188477], "mean_td_error": 2.6536550521850586, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 9.0, "diff_num_grad_updates_vs_sampler_policy": 8.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.148581504821777, "actor_loss": -4.2315568923950195, "critic_loss": 1.0377297401428223, "alpha_loss": -0.024359021335840225, "alpha_value": 0.997602641582489, "log_alpha_value": -0.0024002392310649157, "target_entropy": -6.0, "policy_t": 0.0102285947650671, "mean_q": 0.09478825330734253, "max_q": 0.7213174104690552, "min_q": 0.06995920091867447}, "td_error": [3.974085807800293, 3.1409993171691895, 1.2117825746536255, 2.4276535511016846, 1.9353418350219727, 2.8393120765686035, 4.592954635620117, 0.9705536365509033, 2.3115618228912354, 0.9437206983566284, 3.418454647064209, 2.498116970062256, 2.963167190551758, 1.8142706155776978, 2.0877907276153564, 3.9089388847351074, 0.418731153011322, 3.874805450439453, 2.8111844062805176, 0.6975170969963074, 3.9950106143951416, 2.79010009765625, 3.4581222534179688, 3.2142598628997803, 2.6834628582000732, 2.8778226375579834, 2.2187399864196777, 2.1331787109375, 2.589057207107544, 4.037391662597656, 2.4586315155029297, 2.81575870513916, 1.6157315969467163, 3.370659589767456, 3.7949609756469727, 2.359745979309082, 1.6131032705307007, 2.992208957672119, 2.285656452178955, 3.2772035598754883, 2.6825666427612305, 1.209359884262085, 3.5392613410949707, 1.6546194553375244, 3.644893169403076, 3.005565643310547, 1.6004348993301392, 2.5342373847961426, 1.177577257156372, 3.870783805847168, 0.618773877620697, 2.380953788757324, 2.859809160232544, 2.4112675189971924, 3.9635441303253174, 1.8000621795654297, 2.2141664028167725, 2.076153039932251, 2.231882333755493, 2.1442134380340576, 1.5322073698043823, 1.4139153957366943, 2.6677258014678955, 1.996033787727356, 2.6760358810424805, 3.311030387878418, 4.314635753631592, 1.644754409790039, 2.1396617889404297, 1.6368744373321533, 3.4328041076660156, 4.011975288391113, 1.5555591583251953, 1.1128311157226562, 3.330561876296997, 3.2988996505737305, 3.6308979988098145, 3.635732412338257, 0.5346754789352417, 0.7646304368972778, 3.7207388877868652, 2.3747000694274902, 1.6500613689422607, 2.202760696411133, 3.1420493125915527, 3.136953353881836], "mean_td_error": 2.533843994140625, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 9.0, "diff_num_grad_updates_vs_sampler_policy": 8.0}}, "num_env_steps_sampled": 8960, "num_env_steps_trained": 2322, "num_agent_steps_sampled": 26880, "num_agent_steps_trained": 2322, "last_target_update_ts": 8960, "num_target_updates": 9}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 26880, "num_agent_steps_trained": 2322, "num_env_steps_sampled": 8960, "num_env_steps_trained": 2322, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 954.8559797528974, "num_env_steps_trained_throughput_per_sec": 274.9473691699191, "timesteps_total": 8960, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 26880, "timers": {"training_iteration_time_ms": 940.982, "sample_time_ms": 605.073, "load_time_ms": 0.309, "load_throughput": 834190.483, "learn_time_ms": 21.072, "learn_throughput": 12243.834, "synch_weights_time_ms": 9.795}, "counters": {"num_env_steps_sampled": 8960, "num_env_steps_trained": 2322, "num_agent_steps_sampled": 26880, "num_agent_steps_trained": 2322, "last_target_update_ts": 8960, "num_target_updates": 9}, "done": false, "episodes_total": 0, "training_iteration": 6, "trial_id": "ff3c2_00000", "date": "2023-11-18_21-11-04", "timestamp": 1700370664, "time_this_iter_s": 1.8841068744659424, "time_total_s": 9.45647120475769, "pid": 7608, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17c1ab9c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 9.45647120475769, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 68.7, "ram_util_percent": 64.53333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.092386245727539, "actor_loss": -4.232769012451172, "critic_loss": 3.9047579765319824, "alpha_loss": -0.030269498005509377, "alpha_value": 0.9970052242279053, "log_alpha_value": -0.002999241231009364, "target_entropy": -6.0, "policy_t": -0.018444426357746124, "mean_q": 0.25993776321411133, "max_q": 1.8921912908554077, "min_q": 0.13035070896148682}, "td_error": [4.966828346252441, 5.3800048828125, 3.910033702850342, 3.273526191711426, 4.2444963455200195, 3.129573345184326, 3.8689887523651123, 3.6995320320129395, 5.859753608703613, 6.098567008972168, 3.3617563247680664, 4.868765830993652, 5.171834945678711, 4.701123237609863, 3.8237321376800537, 4.645930290222168, 4.122482776641846, 3.8374176025390625, 4.3828887939453125, 5.366929054260254, 4.336336612701416, 5.396261215209961, 4.518688201904297, 6.370297431945801, 4.4158406257629395, 5.008692264556885, 4.955594539642334, 4.725537300109863, 2.919210433959961, 3.36287260055542, 5.095483779907227, 5.556968688964844, 3.697795867919922, 6.56390380859375, 5.364707946777344, 4.222744941711426, 5.001421928405762, 5.605531215667725, 4.936282634735107, 4.403200149536133, 3.5526790618896484, 5.1465911865234375, 4.818791389465332, 1.633826732635498, 5.780519485473633, 4.080076217651367, 3.726470470428467, 4.661083221435547, 3.8265740871429443, 4.624274253845215, 3.34702730178833, 3.406309127807617, 7.225742340087891, 4.136026382446289, 4.532912254333496, 4.615924835205078, 4.297980308532715, 4.000231742858887, 3.7600021362304688, 4.031865119934082, 6.281676769256592, 5.763926029205322, 6.626131534576416, 3.853602886199951, 3.9116082191467285, 6.17299747467041, 4.081975936889648, 3.499908924102783, 5.003178596496582, 4.249107837677002, 4.988822937011719, 4.507831573486328, 3.5165469646453857, 3.563321113586426, 3.085427761077881, 3.927225351333618, 4.114983558654785, 6.783426284790039, 5.615584373474121, 3.413454532623291, 4.140034198760986, 5.846380233764648, 3.3075637817382812, 3.955008029937744, 3.186023712158203, 5.328376293182373], "mean_td_error": 4.524425029754639, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 11.0, "diff_num_grad_updates_vs_sampler_policy": 10.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.090816497802734, "actor_loss": -4.242201328277588, "critic_loss": 0.44734469056129456, "alpha_loss": -0.030282743275165558, "alpha_value": 0.9970034956932068, "log_alpha_value": -0.003001019824296236, "target_entropy": -6.0, "policy_t": 0.01237544510513544, "mean_q": 0.20517076551914215, "max_q": 1.944389820098877, "min_q": 0.14583459496498108}, "td_error": [0.10423768311738968, 1.917794942855835, 3.593745708465576, 2.346578359603882, 3.7052407264709473, 2.001396656036377, 2.564128875732422, 4.156822204589844, 3.4393177032470703, 0.7975228428840637, 0.46657249331474304, 3.7358286380767822, 2.284837245941162, 3.6463022232055664, 0.8796343803405762, 0.971279501914978, 2.398442029953003, 1.8767783641815186, 2.0998027324676514, 0.20311051607131958, 1.652608871459961, 4.845075607299805, 2.5360488891601562, 5.572347164154053, 2.0292317867279053, 2.890693187713623, 2.885741949081421, 2.1379053592681885, 1.9493224620819092, 3.0169694423675537, 2.6094698905944824, 1.0652167797088623, 2.8160934448242188, 1.6279287338256836, 2.2251996994018555, 1.7676422595977783, 1.9215703010559082, 1.5670393705368042, 2.4053354263305664, 1.499306321144104, 3.0821874141693115, 3.2176408767700195, 1.96830153465271, 1.8725838661193848, 3.0720901489257812, 2.7810049057006836, 2.1810431480407715, 2.1399264335632324, 3.29742431640625, 1.1536586284637451, 0.9224933981895447, 2.5551161766052246, 1.447242021560669, 3.241894245147705, 2.480985403060913, 2.304123878479004, 2.7011547088623047, 2.8525328636169434, 1.5830895900726318, 3.074084520339966, 3.542843818664551, 2.4650707244873047, 1.5822551250457764, 4.613327980041504, 2.4867281913757324, 3.1975302696228027, 2.2012805938720703, 1.979234218597412, 1.9020596742630005, 2.2775371074676514, 2.307281970977783, 2.9625957012176514, 3.375645160675049, 3.7100119590759277, 2.4266834259033203, 2.898249626159668, 1.76458740234375, 0.1809573918581009, 3.049440860748291, 2.561826229095459, 2.976480484008789, 2.7043380737304688, 1.6298625469207764, 0.9344634413719177, 2.1115365028381348, 3.5670790672302246], "mean_td_error": 2.3900885581970215, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 11.0, "diff_num_grad_updates_vs_sampler_policy": 10.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.085912704467773, "actor_loss": -4.19621467590332, "critic_loss": 1.0042999982833862, "alpha_loss": -0.030264990404248238, "alpha_value": 0.9970037937164307, "log_alpha_value": -0.0030007190071046352, "target_entropy": -6.0, "policy_t": 0.028553903102874756, "mean_q": 0.1840033382177353, "max_q": 1.599600076675415, "min_q": 0.09455405920743942}, "td_error": [2.5877702236175537, 2.4974377155303955, 3.338153839111328, 3.4100043773651123, 1.1209502220153809, 3.4394829273223877, 3.3591432571411133, 3.983311653137207, 3.113407850265503, 2.074554920196533, 3.1393842697143555, 2.01781964302063, 3.3795881271362305, 2.8443894386291504, 2.806917190551758, 2.938748836517334, 3.9534361362457275, 3.6960372924804688, 2.589475631713867, 1.2655059099197388, 2.2162859439849854, 1.2596330642700195, 2.8241047859191895, 2.0898780822753906, 2.5902490615844727, 2.9539856910705566, 3.895505905151367, 1.8675382137298584, 4.574577808380127, 3.1507363319396973, 0.045005083084106445, 1.860690951347351, 3.5427427291870117, 2.368271827697754, 0.5097559094429016, 0.6506518721580505, 1.7339197397232056, 2.559854745864868, 4.135457515716553, 2.929351329803467, 1.2700698375701904, 0.27865761518478394, 3.784243106842041, 0.5053990483283997, 1.9639519453048706, 5.04837703704834, 2.3584446907043457, 2.2649307250976562, 3.823960065841675, 2.1750011444091797, 2.902310371398926, 3.1653430461883545, 4.126725196838379, 2.5445985794067383, 1.431375503540039, 3.2056121826171875, 1.5628002882003784, 2.317782402038574, 2.7188007831573486, 1.09096360206604, 2.854696273803711, 3.3204164505004883, 2.3731377124786377, 1.5146043300628662, 1.84730064868927, 1.9145498275756836, 2.8631856441497803, 2.165131092071533, 2.137134075164795, 2.0168356895446777, 3.345360517501831, 2.132669448852539, 5.472537040710449, 2.142940044403076, 1.5558514595031738, 2.35390567779541, 4.547493934631348, 2.1466941833496094, 1.7318215370178223, 2.342768907546997, 2.532270669937134, 0.9769381284713745, 2.3403403759002686, 1.8483221530914307, 2.471708297729492, 3.202571153640747], "mean_td_error": 2.534933090209961, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 11.0, "diff_num_grad_updates_vs_sampler_policy": 10.0}}, "num_env_steps_sampled": 10752, "num_env_steps_trained": 2838, "num_agent_steps_sampled": 32256, "num_agent_steps_trained": 2838, "last_target_update_ts": 10752, "num_target_updates": 11}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32256, "num_agent_steps_trained": 2838, "num_env_steps_sampled": 10752, "num_env_steps_trained": 2838, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 1031.497577497571, "num_env_steps_trained_throughput_per_sec": 297.0160435205059, "timesteps_total": 10752, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 32256, "timers": {"training_iteration_time_ms": 902.766, "sample_time_ms": 599.274, "load_time_ms": 0.313, "load_throughput": 823789.915, "learn_time_ms": 18.466, "learn_throughput": 13971.969, "synch_weights_time_ms": 9.94}, "counters": {"num_env_steps_sampled": 10752, "num_env_steps_trained": 2838, "num_agent_steps_sampled": 32256, "num_agent_steps_trained": 2838, "last_target_update_ts": 10752, "num_target_updates": 11}, "done": false, "episodes_total": 0, "training_iteration": 7, "trial_id": "ff3c2_00000", "date": "2023-11-18_21-11-06", "timestamp": 1700370666, "time_this_iter_s": 1.7465910911560059, "time_total_s": 11.203062295913696, "pid": 7608, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17c1aa520>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 11.203062295913696, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 58.13333333333333, "ram_util_percent": 64.56666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.130304336547852, "actor_loss": -4.315300941467285, "critic_loss": 3.756624460220337, "alpha_loss": -0.03646211698651314, "alpha_value": 0.996407151222229, "log_alpha_value": -0.003599311225116253, "target_entropy": -6.0, "policy_t": -0.004661623388528824, "mean_q": 0.24252399802207947, "max_q": 2.479240894317627, "min_q": 0.17013318836688995}, "td_error": [4.131617546081543, 5.2127156257629395, 4.207818984985352, 2.7724392414093018, 4.368988513946533, 4.410544395446777, 3.695722818374634, 4.4164910316467285, 3.6105194091796875, 6.625006675720215, 2.8875889778137207, 6.4533586502075195, 4.748325347900391, 4.12977409362793, 5.3238444328308105, 5.283203125, 3.623241901397705, 5.903562545776367, 4.481891632080078, 3.4930734634399414, 4.814324378967285, 3.470355987548828, 5.312302589416504, 3.447573661804199, 5.6430792808532715, 4.491658687591553, 4.7998762130737305, 3.8887181282043457, 5.721332550048828, 4.05547571182251, 6.66341495513916, 4.321066379547119, 4.3406171798706055, 5.191196441650391, 5.084682941436768, 5.489461421966553, 3.526174783706665, 3.443082809448242, 3.2460684776306152, 3.4567103385925293, 2.9021944999694824, 4.523961067199707, 3.531625747680664, 4.0065765380859375, 7.159785270690918, 3.8747670650482178, 2.79067325592041, 6.445390701293945, 4.614601135253906, 5.042606830596924, 6.2106194496154785, 4.646964073181152, 3.993530511856079, 5.2086944580078125, 3.3960118293762207, 4.615084648132324, 5.011312007904053, 5.374316215515137, 2.8298938274383545, 3.9709205627441406, 3.0981907844543457, 3.6214380264282227, 5.648617744445801, 3.9438681602478027, 3.9471797943115234, 4.31129264831543, 4.301187515258789, 4.769885540008545, 6.766327857971191, 3.85573673248291, 4.069153308868408, 4.991541862487793, 4.712010383605957, 4.813180446624756, 6.293394088745117, 1.5168482065200806, 5.2913312911987305, 3.9911952018737793, 4.078177452087402, 3.1628923416137695, 5.047905921936035, 5.191200256347656, 5.258063316345215, 7.472980499267578, 5.255434989929199, 5.0237579345703125], "mean_td_error": 4.543828010559082, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 13.0, "diff_num_grad_updates_vs_sampler_policy": 12.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.122238159179688, "actor_loss": -4.3111958503723145, "critic_loss": 0.43247127532958984, "alpha_loss": -0.03645592927932739, "alpha_value": 0.9964048862457275, "log_alpha_value": -0.0036015689838677645, "target_entropy": -6.0, "policy_t": -0.02730010263621807, "mean_q": 0.28590014576911926, "max_q": 2.0457892417907715, "min_q": 0.18476122617721558}, "td_error": [2.4079296588897705, 2.3520140647888184, 2.25911808013916, 0.09978318959474564, 3.8803348541259766, 2.116347312927246, 0.6967202425003052, 0.11047059297561646, 2.142552375793457, 1.734898567199707, 2.6355061531066895, 0.8376286029815674, 0.9131879806518555, 3.0888476371765137, 3.2146997451782227, 3.2223753929138184, 4.4229021072387695, 3.9880242347717285, 1.0632596015930176, 1.8509316444396973, 3.2421061992645264, 2.5979838371276855, 3.147797107696533, 4.207550525665283, 3.0961787700653076, 3.6563944816589355, 3.4084901809692383, 3.760343074798584, 2.4009487628936768, 2.207334280014038, 1.3948521614074707, 0.544822096824646, 1.5138938426971436, 1.0724167823791504, 1.9241445064544678, 2.0679259300231934, 0.5303864479064941, 2.2828476428985596, 3.989919662475586, 2.691425323486328, 2.0353636741638184, 3.4795608520507812, 1.1873400211334229, 2.2240593433380127, 2.39797043800354, 3.181058883666992, 0.654335618019104, 2.683974027633667, 1.7831363677978516, 2.320772409439087, 2.7004165649414062, 3.1616768836975098, 2.786182403564453, 1.444287896156311, 2.109312057495117, 1.5895663499832153, 2.567197799682617, 4.726330757141113, 2.5615339279174805, 1.2480968236923218, 2.2224345207214355, 1.9890172481536865, 2.841813087463379, 0.9051457643508911, 2.1343157291412354, 2.6529922485351562, 2.8565783500671387, 3.4503328800201416, 3.5817456245422363, 0.804577648639679, 2.832242965698242, 2.3879318237304688, 2.029656410217285, 3.727447509765625, 3.3306846618652344, 1.1629831790924072, 0.0348779633641243, 3.753260612487793, 2.257996082305908, 1.918424367904663, 1.978230595588684, 2.289785385131836, 2.240438461303711, 3.022629499435425, 2.0669443607330322, 3.977418899536133], "mean_td_error": 2.349620819091797, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 13.0, "diff_num_grad_updates_vs_sampler_policy": 12.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.13671588897705, "actor_loss": -4.2808051109313965, "critic_loss": 0.9227702617645264, "alpha_loss": -0.03650406748056412, "alpha_value": 0.996405303478241, "log_alpha_value": -0.0036011734046041965, "target_entropy": -6.0, "policy_t": 0.03460988029837608, "mean_q": 0.16207541525363922, "max_q": 1.8415354490280151, "min_q": 0.12344330549240112}, "td_error": [2.3357062339782715, 2.3722705841064453, 2.261153221130371, 0.8950724005699158, 2.844136953353882, 2.1045117378234863, 2.5272836685180664, 0.03186069801449776, 2.896986961364746, 3.054267168045044, 4.01621675491333, 2.2648303508758545, 3.2425625324249268, 3.1549034118652344, 0.9450703263282776, 2.1536405086517334, 0.9178528785705566, 1.9361180067062378, 1.7208118438720703, 3.8904500007629395, 4.131383895874023, 3.4065892696380615, 2.870948076248169, 1.9682388305664062, 2.6500344276428223, 4.863061428070068, 1.4142563343048096, 4.112102031707764, 1.7063133716583252, 3.467261791229248, 1.4375783205032349, 2.2977139949798584, 1.9730825424194336, 2.166346549987793, 3.7358126640319824, 2.3772482872009277, 2.0996336936950684, 3.2689528465270996, 3.9325976371765137, 1.5536046028137207, 2.133984088897705, 2.887411594390869, 1.4366382360458374, 0.9484440088272095, 1.1541856527328491, 2.14804744720459, 2.101053237915039, 2.4288177490234375, 1.3816437721252441, 2.2230734825134277, 2.1860718727111816, 2.8038692474365234, 3.41877818107605, 2.6433913707733154, 3.4450788497924805, 1.4102201461791992, 3.712876319885254, 0.724938690662384, 3.104891061782837, 1.7075964212417603, 2.15617036819458, 1.814162015914917, 1.413368582725525, 3.3572916984558105, 1.3849914073944092, 3.168408155441284, 2.797473430633545, 2.940206289291382, 2.0990960597991943, 0.9176013469696045, 3.672889471054077, 3.7129688262939453, 1.144735336303711, 3.7371439933776855, 3.006443500518799, 2.7557387351989746, 0.6115754842758179, 2.006861448287964, 3.532172203063965, 3.1637468338012695, 4.646030426025391, 2.1183271408081055, 3.5163025856018066, 2.6321353912353516, 3.9354381561279297, 2.9710521697998047], "mean_td_error": 2.490835189819336, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 13.0, "diff_num_grad_updates_vs_sampler_policy": 12.0}}, "num_env_steps_sampled": 12544, "num_env_steps_trained": 3354, "num_agent_steps_sampled": 37632, "num_agent_steps_trained": 3354, "last_target_update_ts": 12544, "num_target_updates": 13}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37632, "num_agent_steps_trained": 3354, "num_env_steps_sampled": 12544, "num_env_steps_trained": 3354, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 1000.6998818789029, "num_env_steps_trained_throughput_per_sec": 288.14795705888054, "timesteps_total": 12544, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 37632, "timers": {"training_iteration_time_ms": 891.307, "sample_time_ms": 600.143, "load_time_ms": 0.31, "load_throughput": 831512.55, "learn_time_ms": 18.219, "learn_throughput": 14161.212, "synch_weights_time_ms": 10.638}, "counters": {"num_env_steps_sampled": 12544, "num_env_steps_trained": 3354, "num_agent_steps_sampled": 37632, "num_agent_steps_trained": 3354, "last_target_update_ts": 12544, "num_target_updates": 13}, "done": false, "episodes_total": 0, "training_iteration": 8, "trial_id": "ff3c2_00000", "date": "2023-11-18_21-11-08", "timestamp": 1700370668, "time_this_iter_s": 1.8011736869812012, "time_total_s": 13.004235982894897, "pid": 7608, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17e234860>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 13.004235982894897, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 75.95, "ram_util_percent": 64.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.095185279846191, "actor_loss": -4.307411193847656, "critic_loss": 3.642773151397705, "alpha_loss": -0.039365530014038086, "alpha_value": 0.9961081743240356, "log_alpha_value": -0.003899435978382826, "target_entropy": -6.0, "policy_t": 0.021474938839673996, "mean_q": 0.31567034125328064, "max_q": 3.0777359008789062, "min_q": 0.1921236515045166}, "td_error": [4.969308853149414, 3.1875131130218506, 6.125316619873047, 4.992430686950684, 3.4780378341674805, 5.690478801727295, 3.399125576019287, 5.089410305023193, 4.677212715148926, 3.1605377197265625, 3.5687663555145264, 4.866421222686768, 5.671480655670166, 5.252096176147461, 3.6678099632263184, 2.2737386226654053, 5.338411331176758, 3.1954987049102783, 4.929190635681152, 3.9856009483337402, 4.529144287109375, 5.880913257598877, 4.492122650146484, 3.7570905685424805, 4.786667823791504, 3.8140783309936523, 2.6987767219543457, 3.1490585803985596, 2.5863468647003174, 3.746323585510254, 2.8932783603668213, 4.129107475280762, 4.562988758087158, 4.781293869018555, 4.60770320892334, 5.288395881652832, 4.632516860961914, 6.680352210998535, 4.261717796325684, 5.5542192459106445, 4.4856977462768555, 4.515081405639648, 3.362183094024658, 5.47962760925293, 3.853379011154175, 3.817063331604004, 4.256758689880371, 4.037119388580322, 3.1482760906219482, 3.9009616374969482, 3.2221083641052246, 6.567178726196289, 4.884037017822266, 2.491873264312744, 3.669175148010254, 4.126780986785889, 4.098431587219238, 5.278029441833496, 4.145380973815918, 5.040764808654785, 6.132732391357422, 4.122398376464844, 6.5536065101623535, 3.724264621734619, 1.0329244136810303, 4.970952033996582, 3.0915324687957764, 5.075491905212402, 3.895916223526001, 6.857300758361816, 4.868779182434082, 4.619369983673096, 4.206246852874756, 5.661153793334961, 6.605689525604248, 5.6746931076049805, 6.141807556152344, 4.177149772644043, 4.08811092376709, 2.3314900398254395, 2.9564318656921387, 4.327845573425293, 1.8311647176742554, 4.758089065551758, 5.488729953765869, 4.880603790283203], "mean_td_error": 4.381451606750488, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 14.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.176932334899902, "actor_loss": -4.385906219482422, "critic_loss": 0.4861834645271301, "alpha_loss": -0.039709705859422684, "alpha_value": 0.9961056709289551, "log_alpha_value": -0.00390193285420537, "target_entropy": -6.0, "policy_t": -0.04949704557657242, "mean_q": 0.4037897288799286, "max_q": 2.788285255432129, "min_q": 0.2062143087387085}, "td_error": [3.4176573753356934, 4.291010856628418, 1.5909826755523682, 2.9515902996063232, 1.9570518732070923, 3.318782091140747, 3.575998306274414, 3.9452991485595703, 0.1914536952972412, 2.4723665714263916, 2.994783878326416, 2.564302921295166, 3.339580774307251, 4.851285934448242, 2.766606330871582, 4.176174163818359, 1.2807141542434692, 4.407360076904297, 1.623290777206421, 3.436736583709717, 2.44803524017334, 3.9335250854492188, 2.244973659515381, 0.2699381113052368, 2.8300466537475586, 2.2465226650238037, 1.110037922859192, 2.55958890914917, 2.3576149940490723, 3.336965322494507, 3.3170623779296875, 3.2862601280212402, 1.7032523155212402, 3.7893002033233643, 2.030012607574463, 3.0913655757904053, 2.153393268585205, 2.4011893272399902, 4.137381076812744, 2.625580072402954, 2.056197166442871, 1.1214228868484497, 0.5868589282035828, 1.2775545120239258, 2.919633388519287, 3.1445467472076416, 1.5302095413208008, 1.5447068214416504, 3.12723970413208, 2.908576250076294, 1.8932991027832031, 2.492851972579956, 3.3811724185943604, 4.110045909881592, 2.185882568359375, 3.0946779251098633, 3.526829719543457, 3.449108123779297, 4.945931434631348, 2.3657050132751465, 3.163813591003418, 2.358421802520752, 2.9569079875946045, 1.7237416505813599, 0.24666465818881989, 1.7681927680969238, 0.35538995265960693, 4.0903120040893555, 2.40134334564209, 2.8681859970092773, 1.0394947528839111, 4.324857711791992, 2.3392410278320312, 2.816533088684082, 2.5160350799560547, 2.0088977813720703, 3.344072103500366, 4.460818290710449, 1.741856336593628, 1.6902552843093872, 2.411505699157715, 0.9780188798904419, 3.02551531791687, 0.7837595343589783, 3.3458542823791504, 2.2646961212158203], "mean_td_error": 2.6013011932373047, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 14.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.111430168151855, "actor_loss": -4.272655963897705, "critic_loss": 0.8695457577705383, "alpha_loss": -0.0394497849047184, "alpha_value": 0.9961060881614685, "log_alpha_value": -0.003901504445821047, "target_entropy": -6.0, "policy_t": 0.02918842062354088, "mean_q": 0.20059765875339508, "max_q": 2.2946889400482178, "min_q": 0.13967737555503845}, "td_error": [1.7056020498275757, 2.481565237045288, 2.4435880184173584, 2.3304519653320312, 1.4665638208389282, 0.9642976522445679, 5.343401908874512, 0.9459744691848755, 1.069089412689209, 3.9554924964904785, 0.957591712474823, 3.2834136486053467, 1.2735157012939453, 2.2312111854553223, 3.484916925430298, 1.9289371967315674, 0.7157959938049316, 3.560023784637451, 3.183703899383545, 1.5109132528305054, 3.967055320739746, 2.627413511276245, 3.4903383255004883, 4.594208717346191, 0.9441848993301392, 4.028099060058594, 3.548598289489746, 3.7620253562927246, 0.8642740845680237, 3.539790630340576, 1.508336067199707, 3.204679012298584, 2.8179006576538086, 1.9276905059814453, 2.933084487915039, 2.4722142219543457, 2.0501787662506104, 4.01862907409668, 1.3801733255386353, 2.229646682739258, 3.2467775344848633, 2.5728795528411865, 2.9945921897888184, 1.3393163681030273, 3.27810001373291, 1.4809346199035645, 2.5701308250427246, 3.706963062286377, 3.3705244064331055, 3.650911808013916, 3.337078332901001, 3.430464267730713, 2.0102365016937256, 2.83621883392334, 2.2202341556549072, 1.1850279569625854, 2.1348767280578613, 4.484315872192383, 0.4680861830711365, 2.3396172523498535, 1.946005940437317, 3.789438247680664, 2.667973518371582, 1.6684271097183228, 3.011521100997925, 4.427528381347656, 2.6981401443481445, 3.005582332611084, 3.2395834922790527, 5.597245216369629, 2.6336312294006348, 2.086778163909912, 1.4435571432113647, 2.1962103843688965, 1.64986252784729, 1.9194517135620117, 2.400315761566162, 2.6168270111083984, 2.2711691856384277, 0.5985301733016968, 2.0035576820373535, 2.800762176513672, 3.1828677654266357, 1.7428603172302246, 1.2302435636520386, 2.8693861961364746], "mean_td_error": 2.547666549682617, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 14.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 13440, "num_env_steps_trained": 3612, "num_agent_steps_sampled": 40320, "num_agent_steps_trained": 3612, "last_target_update_ts": 13440, "num_target_updates": 14}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40320, "num_agent_steps_trained": 3612, "num_env_steps_sampled": 13440, "num_env_steps_trained": 3612, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 895.7471416912646, "num_env_steps_trained_throughput_per_sec": 257.927190353065, "timesteps_total": 13440, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 40320, "timers": {"training_iteration_time_ms": 907.206, "sample_time_ms": 617.008, "load_time_ms": 0.311, "load_throughput": 829345.825, "learn_time_ms": 18.433, "learn_throughput": 13996.529, "synch_weights_time_ms": 11.059}, "counters": {"num_env_steps_sampled": 13440, "num_env_steps_trained": 3612, "num_agent_steps_sampled": 40320, "num_agent_steps_trained": 3612, "last_target_update_ts": 13440, "num_target_updates": 14}, "done": false, "episodes_total": 0, "training_iteration": 9, "trial_id": "ff3c2_00000", "date": "2023-11-18_21-11-09", "timestamp": 1700370669, "time_this_iter_s": 1.009634017944336, "time_total_s": 14.013870000839233, "pid": 7608, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17e2344a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 14.013870000839233, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 61.15, "ram_util_percent": 65.15}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.146610260009766, "actor_loss": -4.37611722946167, "critic_loss": 3.5584535598754883, "alpha_loss": -0.04261151701211929, "alpha_value": 0.9958091974258423, "log_alpha_value": -0.00419958122074604, "target_entropy": -6.0, "policy_t": -0.07206546515226364, "mean_q": 0.40170949697494507, "max_q": 3.4585487842559814, "min_q": 0.2156185358762741}, "td_error": [5.363406658172607, 2.2519211769104004, 4.729554653167725, 4.824676513671875, 4.335170745849609, 5.5376787185668945, 3.047199249267578, 4.694482326507568, 3.798163414001465, 2.3220064640045166, 7.006329536437988, 4.055764675140381, 4.92928409576416, 3.556920051574707, 2.748230457305908, 3.0666842460632324, 4.1086626052856445, 6.15090799331665, 3.98848295211792, 0.5832446217536926, 5.396902084350586, 3.7702064514160156, 4.499603748321533, 3.9031567573547363, 3.211331844329834, 3.910813808441162, 3.957334518432617, 5.068691253662109, 4.415136337280273, 3.3467273712158203, 4.129683494567871, 2.450162887573242, 4.0435285568237305, 5.026124954223633, 2.935976028442383, 6.1066436767578125, 3.99537992477417, 3.105408191680908, 4.006495475769043, 2.338991165161133, 5.879019737243652, 4.7524518966674805, 4.627253532409668, 5.03134822845459, 4.403258323669434, 5.524901866912842, 4.588003158569336, 5.172839164733887, 4.117517471313477, 4.2326250076293945, 6.327144622802734, 3.873354196548462, 4.310857772827148, 2.8025217056274414, 4.48085880279541, 3.6569056510925293, 5.085794925689697, 2.306258201599121, 4.35208797454834, 3.672091484069824, 4.786782264709473, 5.896025657653809, 1.658966302871704, 5.111232280731201, 3.608023166656494, 4.5662665367126465, 5.141722202301025, 1.5102870464324951, 4.487680435180664, 3.558058261871338, 3.8599281311035156, 5.258340835571289, 5.377557754516602, 5.843502044677734, 4.9093122482299805, 4.466219902038574, 4.434250831604004, 4.764512062072754, 8.178070068359375, 4.334885597229004, 5.289790153503418, 4.1836066246032715, 4.47966194152832, 3.2996344566345215, 6.189670562744141, 4.769749641418457], "mean_td_error": 4.300905704498291, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 15.0, "diff_num_grad_updates_vs_sampler_policy": 14.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.095216751098633, "actor_loss": -4.330750465393066, "critic_loss": 0.3947552442550659, "alpha_loss": -0.04242440313100815, "alpha_value": 0.9958063960075378, "log_alpha_value": -0.004202425945550203, "target_entropy": -6.0, "policy_t": -0.005332822445780039, "mean_q": 0.5677688717842102, "max_q": 3.116292953491211, "min_q": 0.2295512855052948}, "td_error": [1.9795526266098022, 1.5829415321350098, 2.1275086402893066, 3.0486912727355957, 1.813535213470459, 1.8331438302993774, 2.6708180904388428, 1.388956904411316, 1.7394514083862305, 4.159503936767578, 2.208277940750122, 1.7871180772781372, 2.9228577613830566, 3.08396315574646, 3.640413999557495, 1.5176820755004883, 3.5965800285339355, 0.9569048881530762, 3.1798057556152344, 2.1036019325256348, 3.0720787048339844, 1.1050888299942017, 2.4790830612182617, 0.441300630569458, 2.5460472106933594, 2.42451810836792, 1.14096999168396, 2.757338047027588, 2.597480297088623, 1.3899903297424316, 1.5496625900268555, 2.863860845565796, 1.094191551208496, 2.575852394104004, 0.9661645889282227, 1.9275732040405273, 0.8785529136657715, 1.8512537479400635, 0.3535308241844177, 0.2659132480621338, 1.468976378440857, 1.676175832748413, 3.206833600997925, 3.4078640937805176, 1.5992822647094727, 2.2745509147644043, 4.617823123931885, 1.4942843914031982, 1.2191364765167236, 1.6438581943511963, 2.4009759426116943, 5.034631252288818, 3.546635389328003, 3.6191787719726562, 3.9641706943511963, 0.24577975273132324, 2.2310028076171875, 3.4223127365112305, 3.040695905685425, 2.654292583465576, 2.1854171752929688, 2.082326889038086, 1.0561513900756836, 3.0045032501220703, 3.1669137477874756, 0.14105451107025146, 2.4331793785095215, 2.2163519859313965, 2.875021457672119, 2.8446555137634277, 5.671184539794922, 1.7177094221115112, 1.014519214630127, 0.16583925485610962, 2.0101146697998047, 2.3318769931793213, 1.861332893371582, 0.5759751796722412, 1.8715651035308838, 0.180161714553833, 0.47493064403533936, 5.080760478973389, 2.364133834838867, 1.7987436056137085, 0.7318359017372131, 1.9877541065216064], "mean_td_error": 2.1655144691467285, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 15.0, "diff_num_grad_updates_vs_sampler_policy": 14.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.135433197021484, "actor_loss": -4.3141632080078125, "critic_loss": 0.8262737989425659, "alpha_loss": -0.042587760835886, "alpha_value": 0.9958069324493408, "log_alpha_value": -0.004201869480311871, "target_entropy": -6.0, "policy_t": 0.03333178162574768, "mean_q": 0.29981011152267456, "max_q": 2.2945122718811035, "min_q": 0.15702442824840546}, "td_error": [2.9755592346191406, 3.8478775024414062, 1.2433842420578003, 1.7121739387512207, 2.472414970397949, 4.232633590698242, 3.6739425659179688, 2.2410216331481934, 3.481876850128174, 4.045294761657715, 0.8358275890350342, 2.4278788566589355, 3.221506118774414, 3.5398459434509277, 1.6437861919403076, 1.1259551048278809, 1.697122573852539, 3.1473121643066406, 3.772646427154541, 2.4801313877105713, 1.2400254011154175, 2.4192676544189453, 2.437979221343994, 3.222238779067993, 2.164423942565918, 0.7606487274169922, 3.7323975563049316, 0.4886273145675659, 1.873382329940796, 0.513638973236084, 1.6218266487121582, 2.179044485092163, 1.5001258850097656, 0.40329623222351074, 2.1361632347106934, 1.499664306640625, 2.5231735706329346, 3.989018201828003, 2.1713173389434814, 3.3494832515716553, 2.9772396087646484, 1.998405933380127, 2.8709938526153564, 2.131991386413574, 1.696831464767456, 2.604724407196045, 2.801109790802002, 2.0987982749938965, 2.891792058944702, 2.708010196685791, 2.462380886077881, 1.621689796447754, 3.110842704772949, 1.6947780847549438, 5.103375434875488, 2.4440884590148926, 1.6998755931854248, 0.8912191390991211, 5.256209850311279, 3.2553205490112305, 4.955893039703369, 0.5131443738937378, 4.67216682434082, 2.3356122970581055, 1.282522201538086, 2.441466808319092, 1.0321961641311646, 2.8679943084716797, 3.8758671283721924, 2.32342529296875, 2.2066428661346436, 3.485806941986084, 0.24915659427642822, 5.130273818969727, 3.248093605041504, 1.751322627067566, 1.0857901573181152, 2.1110262870788574, 3.3507394790649414, 1.83516526222229, 2.5582172870635986, 2.0043067932128906, 4.044266223907471, 2.8563969135284424, 1.5517909526824951, 1.1616621017456055], "mean_td_error": 2.456913709640503, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 15.0, "diff_num_grad_updates_vs_sampler_policy": 14.0}}, "num_env_steps_sampled": 14336, "num_env_steps_trained": 3870, "num_agent_steps_sampled": 43008, "num_agent_steps_trained": 3870, "last_target_update_ts": 14336, "num_target_updates": 15}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 43008, "num_agent_steps_trained": 3870, "num_env_steps_sampled": 14336, "num_env_steps_trained": 3870, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 740.9702012615098, "num_env_steps_trained_throughput_per_sec": 213.3597231311044, "timesteps_total": 14336, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 43008, "timers": {"training_iteration_time_ms": 939.436, "sample_time_ms": 645.042, "load_time_ms": 0.318, "load_throughput": 810827.538, "learn_time_ms": 18.634, "learn_throughput": 13845.829, "synch_weights_time_ms": 11.38}, "counters": {"num_env_steps_sampled": 14336, "num_env_steps_trained": 3870, "num_agent_steps_sampled": 43008, "num_agent_steps_trained": 3870, "last_target_update_ts": 14336, "num_target_updates": 15}, "done": false, "episodes_total": 0, "training_iteration": 10, "trial_id": "ff3c2_00000", "date": "2023-11-18_21-11-10", "timestamp": 1700370670, "time_this_iter_s": 1.2194240093231201, "time_total_s": 15.233294010162354, "pid": 7608, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17c1ab740>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 15.233294010162354, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 83.5, "ram_util_percent": 65.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.13202953338623, "actor_loss": -4.394384860992432, "critic_loss": 2.9641294479370117, "alpha_loss": -0.04559243842959404, "alpha_value": 0.9955102801322937, "log_alpha_value": -0.004499832633882761, "target_entropy": -6.0, "policy_t": 0.007933234795928001, "mean_q": 0.5150658488273621, "max_q": 3.869440793991089, "min_q": 0.2407451868057251}, "td_error": [4.644745826721191, 1.5274927616119385, 4.547940731048584, 3.6387617588043213, 2.261630058288574, 5.295010566711426, 4.086326599121094, 2.1092963218688965, 3.7994515895843506, 3.6996729373931885, 4.413669586181641, 4.037108421325684, 3.557065010070801, 4.081594944000244, 6.326442241668701, 3.0300393104553223, 2.1961817741394043, 2.690810203552246, 2.929365634918213, 5.214285850524902, 5.138088226318359, 4.024985313415527, 1.2664794921875, 3.2388734817504883, 3.4249186515808105, 4.546921730041504, 3.301969289779663, 4.720453262329102, 4.936413764953613, 3.4059407711029053, 4.337959289550781, 5.012693881988525, 2.969475269317627, 5.087718963623047, 3.8769073486328125, 4.32977294921875, 4.493679046630859, 0.2424074411392212, 4.692623138427734, 2.8554177284240723, 1.583752989768982, 3.6785433292388916, 4.503439903259277, 5.335610389709473, 2.8975701332092285, 3.77400803565979, 4.365976333618164, 5.314300537109375, 4.011435031890869, 6.008416175842285, 2.6141178607940674, 3.6056294441223145, 3.338228225708008, 3.945420503616333, 5.373254776000977, 4.196088790893555, 4.416975975036621, 5.473315238952637, 4.102055549621582, 2.5354251861572266, 5.519582748413086, 2.352034568786621, 4.2123823165893555, 5.300578594207764, 5.102572917938232, 4.2302398681640625, 4.453127861022949, 4.824916839599609, 3.3619651794433594, 4.307173728942871, 5.430765151977539, 4.041084289550781, 4.801281929016113, 5.052667617797852, 4.820651531219482, 2.801135540008545, 4.172357082366943, 5.727309226989746, 3.353464365005493, 4.132326126098633, 6.47962760925293, 5.792354583740234, 2.7229764461517334, 4.83134126663208, 3.5240752696990967, 3.9376108646392822], "mean_td_error": 4.027323246002197, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 16.0, "diff_num_grad_updates_vs_sampler_policy": 15.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.106608390808105, "actor_loss": -4.36968994140625, "critic_loss": 0.4818812310695648, "alpha_loss": -0.045508868992328644, "alpha_value": 0.9955072402954102, "log_alpha_value": -0.004502882249653339, "target_entropy": -6.0, "policy_t": -0.00030546917696483433, "mean_q": 0.3477763235569, "max_q": 3.4564218521118164, "min_q": 0.2544025778770447}, "td_error": [1.9157307147979736, 1.7069209814071655, 2.192270278930664, 2.8036997318267822, 2.488663673400879, 2.715144634246826, 1.1625394821166992, 2.080191135406494, 1.829930305480957, 2.090031147003174, 4.369073867797852, 1.797581672668457, 2.04752254486084, 0.687253475189209, 1.5181028842926025, 3.6699233055114746, 2.148317337036133, 2.9121532440185547, 1.3643064498901367, 3.5595192909240723, 3.8300693035125732, 2.350735664367676, 0.18919384479522705, 2.012213706970215, 3.779627799987793, 1.190960168838501, 3.2312116622924805, 1.0545350313186646, 2.206573486328125, 4.789108753204346, 3.529212474822998, 1.5992941856384277, 5.126201152801514, 3.430036783218384, 2.275763988494873, 2.071258544921875, 2.017765522003174, 3.0147533416748047, 2.1915018558502197, 3.123199939727783, 3.081780433654785, 2.8456485271453857, 2.034881591796875, 0.747605562210083, 2.56707763671875, 1.9067003726959229, 3.2004761695861816, 1.664477825164795, 3.509036064147949, 2.426589250564575, 0.6354665756225586, 2.7365987300872803, 3.2577314376831055, 1.935744285583496, 2.797257423400879, 2.6967358589172363, 2.8731637001037598, 3.063467502593994, 1.807753562927246, 1.0863152742385864, 2.6482625007629395, 2.541627883911133, 3.159329891204834, 2.494262218475342, 2.7261619567871094, 1.9454584121704102, 3.020677328109741, 3.5935802459716797, 1.2675895690917969, 2.4698305130004883, 6.0667338371276855, 4.929786205291748, 3.5903632640838623, 2.3182718753814697, 1.9959532022476196, 2.2288899421691895, 2.9764580726623535, 3.445744037628174, 1.885355830192566, 0.9960224628448486, 1.8684170246124268, 2.2573230266571045, 2.3898701667785645, 4.292963027954102, 2.9661827087402344, 2.3127787113189697], "mean_td_error": 2.5271453857421875, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 16.0, "diff_num_grad_updates_vs_sampler_policy": 15.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.060230255126953, "actor_loss": -4.260615348815918, "critic_loss": 0.8421634435653687, "alpha_loss": -0.04529420658946037, "alpha_value": 0.9955078363418579, "log_alpha_value": -0.004502303432673216, "target_entropy": -6.0, "policy_t": -0.009113629348576069, "mean_q": 0.30546149611473083, "max_q": 3.1008057594299316, "min_q": 0.17551608383655548}, "td_error": [1.6283183097839355, 0.19256019592285156, 1.6613844633102417, 2.9669580459594727, 2.0124149322509766, 2.420825719833374, 3.0201210975646973, 2.3864471912384033, 2.636474847793579, 4.499319076538086, 3.731642246246338, 1.1157023906707764, 3.69657039642334, 1.2962045669555664, 4.355467796325684, 0.5977746844291687, 0.86636883020401, 3.2474257946014404, 2.6382932662963867, 3.8708577156066895, 1.4915434122085571, 0.11777754873037338, 3.837019920349121, 4.5676116943359375, 1.3547630310058594, 2.3683459758758545, 2.9719038009643555, 1.1637623310089111, 3.0615501403808594, 2.617550849914551, 1.251343011856079, 1.7251029014587402, 3.147339344024658, 1.7777585983276367, 2.770270824432373, 0.7224964499473572, 1.6861451864242554, 4.467109203338623, 2.0822501182556152, 3.8791146278381348, 3.2855758666992188, 2.555274486541748, 2.06304669380188, 1.9133942127227783, 1.7458038330078125, 3.693871259689331, 2.419969081878662, 2.552755117416382, 2.8798036575317383, 1.5665311813354492, 1.9132860898971558, 2.6993579864501953, 2.3047666549682617, 1.549314260482788, 3.0558996200561523, 2.9998114109039307, 2.7533082962036133, 2.9598493576049805, 2.2768964767456055, 3.9876327514648438, 0.5504410266876221, 1.1870613098144531, 3.824556350708008, 2.36810302734375, 1.025951623916626, 3.100559711456299, 2.7573466300964355, 0.4659108519554138, 2.370265483856201, 1.9878637790679932, 5.153507232666016, 3.998927116394043, 3.4613945484161377, 3.536439895629883, 2.6955413818359375, 3.5706963539123535, 2.675539016723633, 2.681560754776001, 1.817753553390503, 4.296420097351074, 1.2986159324645996, 3.724918842315674, 3.2613868713378906, 1.976835012435913, 2.196305990219116, 1.1567010879516602], "mean_td_error": 2.4909143447875977, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 16.0, "diff_num_grad_updates_vs_sampler_policy": 15.0}}, "num_env_steps_sampled": 15232, "num_env_steps_trained": 4128, "num_agent_steps_sampled": 45696, "num_agent_steps_trained": 4128, "last_target_update_ts": 15232, "num_target_updates": 16}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 45696, "num_agent_steps_trained": 4128, "num_env_steps_sampled": 15232, "num_env_steps_trained": 4128, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 597.8570261114279, "num_env_steps_trained_throughput_per_sec": 172.150795465121, "timesteps_total": 15232, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 45696, "timers": {"training_iteration_time_ms": 1000.373, "sample_time_ms": 688.637, "load_time_ms": 0.319, "load_throughput": 808706.698, "learn_time_ms": 18.567, "learn_throughput": 13895.361, "synch_weights_time_ms": 11.292}, "counters": {"num_env_steps_sampled": 15232, "num_env_steps_trained": 4128, "num_agent_steps_sampled": 45696, "num_agent_steps_trained": 4128, "last_target_update_ts": 15232, "num_target_updates": 16}, "done": false, "episodes_total": 0, "training_iteration": 11, "trial_id": "ff3c2_00000", "date": "2023-11-18_21-11-12", "timestamp": 1700370672, "time_this_iter_s": 1.5078251361846924, "time_total_s": 16.741119146347046, "pid": 7608, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17e234860>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 16.741119146347046, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 63.5, "ram_util_percent": 65.16666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.12869644165039, "actor_loss": -4.452817440032959, "critic_loss": 2.6914992332458496, "alpha_loss": -0.05166105926036835, "alpha_value": 0.9949125051498413, "log_alpha_value": -0.005100464913994074, "target_entropy": -6.0, "policy_t": -0.02363247610628605, "mean_q": 0.3710525333881378, "max_q": 3.9233226776123047, "min_q": 0.29572856426239014}, "td_error": [5.412943363189697, 5.0406036376953125, 5.143586158752441, 2.353794813156128, 3.2618908882141113, 5.48765230178833, 7.951473236083984, 3.866182804107666, 3.600752353668213, 4.0414276123046875, 4.723624229431152, 5.644439697265625, 4.211197376251221, 4.670440673828125, 4.296778678894043, 4.9032087326049805, 4.959258079528809, 5.132074356079102, 3.662661552429199, 3.521399974822998, 4.452352046966553, 3.486912250518799, 5.578179359436035, 2.8323256969451904, 3.7899413108825684, 6.429340362548828, 3.9956107139587402, 4.868359088897705, 3.1998984813690186, 4.5063066482543945, 4.501340866088867, 7.409967422485352, 4.484607696533203, 4.578075885772705, 4.277099609375, 7.330900192260742, 6.1537322998046875, 5.573122501373291, 5.173930644989014, 4.390483856201172, 3.0571322441101074, 6.2709760665893555, 5.842896461486816, 1.4214873313903809, 3.6097187995910645, 3.5325589179992676, 4.590014457702637, 5.548770904541016, 6.613673210144043, 4.465572834014893, 3.802229881286621, 3.8056178092956543, 4.202136993408203, 2.359626293182373, 4.3381147384643555, 3.8828272819519043, 3.3339920043945312, 4.171378135681152, 4.214995384216309, 3.5059406757354736, 4.790413856506348, 5.493192672729492, 4.832129001617432, 3.1724419593811035, 4.767276763916016, 3.1161739826202393, 6.2848615646362305, 4.413386344909668, 4.168148994445801, 4.532353401184082, 3.5465147495269775, 4.689322471618652, 2.225621223449707, 3.2545394897460938, 3.6707923412323, 3.5609426498413086, 5.727560997009277, 4.621237754821777, 4.182429790496826, 4.396801948547363, 4.559506416320801, 3.4312305450439453, 4.85791015625, 3.5014686584472656, 3.64815354347229, 5.711318016052246], "mean_td_error": 4.449108123779297, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 18.0, "diff_num_grad_updates_vs_sampler_policy": 17.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.124969482421875, "actor_loss": -4.4435529708862305, "critic_loss": 0.44727277755737305, "alpha_loss": -0.05167606845498085, "alpha_value": 0.9949091672897339, "log_alpha_value": -0.005103824194520712, "target_entropy": -6.0, "policy_t": 0.03225575014948845, "mean_q": 0.5432155728340149, "max_q": 4.139937400817871, "min_q": 0.3089473843574524}, "td_error": [1.5792524814605713, 1.7622871398925781, 1.7579059600830078, 1.9176645278930664, 3.541820764541626, 2.2480082511901855, 2.656970500946045, 1.7825027704238892, 1.0004947185516357, 3.2603559494018555, 2.9823946952819824, 1.3497633934020996, 4.870112419128418, 1.4762814044952393, 2.4980878829956055, 2.5554845333099365, 2.5562005043029785, 1.5669050216674805, 3.443411350250244, 0.86725914478302, 2.783811569213867, 3.0999600887298584, 2.0029006004333496, 1.6685705184936523, 3.6721019744873047, 1.4545040130615234, 1.723162055015564, 3.638216018676758, 0.23030312359333038, 1.0627039670944214, 2.8496975898742676, 1.129258394241333, 3.137935161590576, 2.952515125274658, 3.0608110427856445, 3.1591978073120117, 4.665392875671387, 2.560809850692749, 1.8784596920013428, 1.3451564311981201, 2.5567994117736816, 2.4045498371124268, 1.98845636844635, 2.7808427810668945, 3.4740166664123535, 0.46159183979034424, 2.0893497467041016, 2.3957905769348145, 2.9423954486846924, 3.679375410079956, 1.0976557731628418, 3.1292476654052734, 0.9651029109954834, 3.6254005432128906, 2.2856478691101074, 4.899683952331543, 3.632282018661499, 0.2113049030303955, 2.179072856903076, 0.6779915690422058, 1.4704537391662598, 1.9834284782409668, 3.1317901611328125, 1.208095908164978, 1.5305448770523071, 2.9721837043762207, 4.983809471130371, 1.9338151216506958, 3.9066836833953857, 2.3840150833129883, 2.728095531463623, 2.3265223503112793, 2.55680513381958, 2.624937057495117, 2.0314764976501465, 1.0099022388458252, 2.2809643745422363, 4.600740909576416, 2.030627727508545, 2.2106566429138184, 4.012855529785156, 1.4581862688064575, 3.490412473678589, 2.8164730072021484, 2.8770217895507812, 1.7926275730133057], "mean_td_error": 2.4137015342712402, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 18.0, "diff_num_grad_updates_vs_sampler_policy": 17.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.114331245422363, "actor_loss": -4.355287551879883, "critic_loss": 0.7520592212677002, "alpha_loss": -0.051613327115774155, "alpha_value": 0.9949100017547607, "log_alpha_value": -0.005102989263832569, "target_entropy": -6.0, "policy_t": -0.05180685594677925, "mean_q": 0.3550587296485901, "max_q": 3.7017085552215576, "min_q": 0.21610945463180542}, "td_error": [3.0990121364593506, 0.6114364862442017, 3.086505889892578, 2.3821732997894287, 3.8381471633911133, 1.5365025997161865, 2.5202250480651855, 3.4738755226135254, 1.6763149499893188, 2.641498565673828, 2.5109364986419678, 2.1458992958068848, 0.5420026183128357, 1.646721363067627, 3.2237706184387207, 1.6087980270385742, 1.882771372795105, 0.42708349227905273, 1.9695982933044434, 2.657658100128174, 1.1686687469482422, 2.591641902923584, 1.3920843601226807, 1.2584000825881958, 3.355782985687256, 3.4067468643188477, 0.3949393033981323, 0.3034030795097351, 2.667210102081299, 3.233222246170044, 1.291439175605774, 1.3590731620788574, 1.080521583557129, 2.726191759109497, 0.10270270705223083, 1.7117180824279785, 2.6207942962646484, 2.325479030609131, 1.4830100536346436, 1.0382946729660034, 2.9505348205566406, 3.1180648803710938, 2.24993896484375, 3.3853659629821777, 2.5396649837493896, 3.105841636657715, 4.096052169799805, 2.0353121757507324, 4.580704689025879, 0.39796701073646545, 1.4655861854553223, 2.0206260681152344, 2.4847397804260254, 2.1427369117736816, 4.205954551696777, 1.4509780406951904, 2.7107553482055664, 3.113409996032715, 0.8744111061096191, 2.4302494525909424, 0.9568134546279907, 2.4513063430786133, 1.3587009906768799, 1.3300920724868774, 3.1548056602478027, 2.999340534210205, 1.8491637706756592, 3.840552806854248, 1.8255268335342407, 3.3187761306762695, 1.8270671367645264, 1.161823034286499, 2.6426968574523926, 4.475030899047852, 3.583165407180786, 2.363138198852539, 1.3947975635528564, 0.3010110855102539, 3.4217350482940674, 3.3830642700195312, 4.776298999786377, 2.453826427459717, 0.5497903227806091, 3.699789047241211, 3.140535354614258, 2.3722519874572754], "mean_td_error": 2.267235517501831, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 18.0, "diff_num_grad_updates_vs_sampler_policy": 17.0}}, "num_env_steps_sampled": 17024, "num_env_steps_trained": 4644, "num_agent_steps_sampled": 51072, "num_agent_steps_trained": 4644, "last_target_update_ts": 17024, "num_target_updates": 18}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51072, "num_agent_steps_trained": 4644, "num_env_steps_sampled": 17024, "num_env_steps_trained": 4644, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 998.2262903430591, "num_env_steps_trained_throughput_per_sec": 287.4356952103898, "timesteps_total": 17024, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 51072, "timers": {"training_iteration_time_ms": 1002.404, "sample_time_ms": 688.365, "load_time_ms": 0.319, "load_throughput": 810038.5, "learn_time_ms": 18.389, "learn_throughput": 14029.791, "synch_weights_time_ms": 11.257}, "counters": {"num_env_steps_sampled": 17024, "num_env_steps_trained": 4644, "num_agent_steps_sampled": 51072, "num_agent_steps_trained": 4644, "last_target_update_ts": 17024, "num_target_updates": 18}, "done": false, "episodes_total": 0, "training_iteration": 12, "trial_id": "ff3c2_00000", "date": "2023-11-18_21-11-13", "timestamp": 1700370673, "time_this_iter_s": 1.8049228191375732, "time_total_s": 18.54604196548462, "pid": 7608, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17c1aa7a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 18.54604196548462, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 79.4, "ram_util_percent": 65.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.084320068359375, "actor_loss": -4.441405773162842, "critic_loss": 2.530468463897705, "alpha_loss": -0.05446366220712662, "alpha_value": 0.9946137070655823, "log_alpha_value": -0.005400827154517174, "target_entropy": -6.0, "policy_t": -0.011613761074841022, "mean_q": 0.6545626521110535, "max_q": 5.257436752319336, "min_q": 0.32534128427505493}, "td_error": [4.645529747009277, 3.1887807846069336, 3.4774868488311768, 5.246987342834473, 2.255756378173828, 4.896244049072266, 3.760659694671631, 0.33047962188720703, 4.063227653503418, 3.69781494140625, 5.562053680419922, 3.691462993621826, 4.327699661254883, 4.620114326477051, 0.8673386573791504, 3.696997880935669, 5.094514846801758, 3.765477180480957, 4.409179210662842, 3.9726486206054688, 2.7410478591918945, 6.0272321701049805, 4.360032558441162, 3.5397229194641113, 4.756926536560059, 4.311077117919922, 4.086191177368164, 1.2788721323013306, 3.935685634613037, 2.3566794395446777, 5.375423431396484, 4.455195903778076, 4.852917671203613, 4.847720623016357, 3.0555357933044434, 3.7635388374328613, 4.982621192932129, 6.201219081878662, 4.841639518737793, 6.239871025085449, 1.753097414970398, 5.165096759796143, 3.0611448287963867, 5.633480072021484, 4.858745574951172, 6.514983177185059, 5.099884510040283, 5.9053215980529785, 4.58017635345459, 4.8997602462768555, 4.95361328125, 3.566556453704834, 3.05350661277771, 4.623164653778076, 3.5196986198425293, 3.6285300254821777, 0.9301018714904785, 4.72763729095459, 3.825754165649414, 4.3534746170043945, 5.079225540161133, 4.280549049377441, 4.96295166015625, 4.277154922485352, 3.272733211517334, 4.640893936157227, 3.6987650394439697, 6.256183624267578, 5.059292793273926, 5.350049018859863, 4.42779541015625, 4.557164192199707, 6.300370216369629, 5.047131061553955, 5.003732204437256, 5.029755115509033, 3.7637672424316406, 1.8815867900848389, 5.278621196746826, 4.773652076721191, 4.541470527648926, 2.5455312728881836, 2.8589935302734375, 4.001667022705078, 3.940103054046631, 4.400321960449219], "mean_td_error": 4.2030558586120605, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 19.0, "diff_num_grad_updates_vs_sampler_policy": 18.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.112674713134766, "actor_loss": -4.45814847946167, "critic_loss": 0.4257356524467468, "alpha_loss": -0.05465226247906685, "alpha_value": 0.9946102499961853, "log_alpha_value": -0.005404333118349314, "target_entropy": -6.0, "policy_t": -0.0111856609582901, "mean_q": 0.48787882924079895, "max_q": 3.6496236324310303, "min_q": 0.3379616439342499}, "td_error": [3.6081366539001465, 2.7324352264404297, 2.968679904937744, 1.205981969833374, 5.127635955810547, 2.7944774627685547, 1.098535418510437, 2.320120334625244, 0.7618635296821594, 1.5502359867095947, 2.7080044746398926, 3.5264949798583984, 2.0186610221862793, 1.5768091678619385, 0.8552333116531372, 2.8552541732788086, 0.4125860929489136, 3.4491894245147705, 3.3283698558807373, 2.3333706855773926, 1.8724600076675415, 2.312108039855957, 5.232656478881836, 2.3024983406066895, 0.9740176796913147, 3.3085570335388184, 2.658112049102783, 2.27327299118042, 3.1870241165161133, 1.3299932479858398, 3.399528980255127, 3.003737449645996, 3.6040570735931396, 1.6793242692947388, 2.1119565963745117, 1.8048211336135864, 1.6898375749588013, 3.0475337505340576, 2.6986913681030273, 2.0265626907348633, 1.430020809173584, 2.2228572368621826, 0.8558738827705383, 3.2404427528381348, 1.985660433769226, 4.040156841278076, 2.527939796447754, 0.49543774127960205, 1.8805248737335205, 0.5944596529006958, 1.5200741291046143, 2.1920166015625, 1.92804753780365, 2.8342888355255127, 2.1688072681427, 3.6518468856811523, 1.922018051147461, 1.3174148797988892, 3.8823671340942383, 2.7904539108276367, 3.6179208755493164, 0.49080178141593933, 2.148399829864502, 3.3329708576202393, 1.1636855602264404, 3.782778024673462, 4.466861724853516, 2.4051785469055176, 2.0487220287323, 2.0566890239715576, 2.9254322052001953, 2.442964553833008, 1.821823239326477, 1.819389820098877, 3.39795184135437, 2.299072265625, 4.527709484100342, 3.33447003364563, 2.4108941555023193, 1.124661922454834, 1.9180830717086792, 3.034701347351074, 0.7935971021652222, 2.510366678237915, 0.4572216272354126, 2.6160738468170166], "mean_td_error": 2.374162197113037, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 19.0, "diff_num_grad_updates_vs_sampler_policy": 18.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.119343757629395, "actor_loss": -4.39097261428833, "critic_loss": 0.7744165658950806, "alpha_loss": -0.05467841774225235, "alpha_value": 0.9946112036705017, "log_alpha_value": -0.00540335476398468, "target_entropy": -6.0, "policy_t": 0.0006834319210611284, "mean_q": 0.35532039403915405, "max_q": 3.2701525688171387, "min_q": 0.2382500171661377}, "td_error": [2.7483725547790527, 3.2537708282470703, 2.011749505996704, 3.148885726928711, 3.6680400371551514, 2.793095588684082, 1.7736204862594604, 1.6614201068878174, 3.277333974838257, 3.2395386695861816, 2.1402697563171387, 0.28834235668182373, 1.553438663482666, 2.1438236236572266, 0.8313723802566528, 2.648656129837036, 2.399250030517578, 1.6723084449768066, 3.2680721282958984, 3.7837443351745605, 3.2691221237182617, 0.9646992683410645, 3.7951877117156982, 3.301771640777588, 2.2016406059265137, 4.5031585693359375, 2.2691707611083984, 1.8621790409088135, 3.1099648475646973, 2.380500555038452, 1.771791696548462, 3.181791305541992, 0.3654336929321289, 2.5665836334228516, 1.5115991830825806, 4.490612983703613, 1.8136903047561646, 1.955073595046997, 1.85646390914917, 1.720509648323059, 3.0328421592712402, 2.1314430236816406, 2.0359444618225098, 1.0806118249893188, 3.676985025405884, 1.9882798194885254, 2.0518012046813965, 1.9903020858764648, 3.2237043380737305, 1.070633053779602, 0.09829056262969971, 2.6566905975341797, 1.7372207641601562, 2.48183536529541, 4.339906692504883, 1.7492897510528564, 2.8812685012817383, 2.9928722381591797, 0.11702215671539307, 2.7966156005859375, 2.160874366760254, 3.104231834411621, 3.898627281188965, 2.0877737998962402, 0.7052053213119507, 4.282017707824707, 0.937528133392334, 1.255540370941162, 3.1235575675964355, 2.059567451477051, 1.5121530294418335, 1.9769237041473389, 2.355710744857788, 1.2419602870941162, 4.196383953094482, 1.6314842700958252, 3.371610403060913, 1.6875178813934326, 2.739932060241699, 0.262001097202301, 3.0956156253814697, 3.1932196617126465, 3.3995630741119385, 2.2217814922332764, 1.391261100769043, 2.2048940658569336], "mean_td_error": 2.3421690464019775, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 19.0, "diff_num_grad_updates_vs_sampler_policy": 18.0}}, "num_env_steps_sampled": 17920, "num_env_steps_trained": 4902, "num_agent_steps_sampled": 53760, "num_agent_steps_trained": 4902, "last_target_update_ts": 17920, "num_target_updates": 19}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 53760, "num_agent_steps_trained": 4902, "num_env_steps_sampled": 17920, "num_env_steps_trained": 4902, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 797.2843773396291, "num_env_steps_trained_throughput_per_sec": 229.5751890107414, "timesteps_total": 17920, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 53760, "timers": {"training_iteration_time_ms": 1015.499, "sample_time_ms": 717.427, "load_time_ms": 0.321, "load_throughput": 802648.296, "learn_time_ms": 18.599, "learn_throughput": 13871.564, "synch_weights_time_ms": 11.566}, "counters": {"num_env_steps_sampled": 17920, "num_env_steps_trained": 4902, "num_agent_steps_sampled": 53760, "num_agent_steps_trained": 4902, "last_target_update_ts": 17920, "num_target_updates": 19}, "done": false, "episodes_total": 0, "training_iteration": 13, "trial_id": "ff3c2_00000", "date": "2023-11-18_21-11-15", "timestamp": 1700370675, "time_this_iter_s": 1.1336851119995117, "time_total_s": 19.67972707748413, "pid": 7608, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17c1ab740>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 19.67972707748413, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 63.5, "ram_util_percent": 65.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.063713073730469, "actor_loss": -4.460139274597168, "critic_loss": 2.2315495014190674, "alpha_loss": -0.057374656200408936, "alpha_value": 0.9943150877952576, "log_alpha_value": -0.005701141897588968, "target_entropy": -6.0, "policy_t": 0.000978626892901957, "mean_q": 0.7747756838798523, "max_q": 5.742287635803223, "min_q": 0.3562305271625519}, "td_error": [2.9167585372924805, 2.481204032897949, 2.1079537868499756, 2.810335874557495, 3.801102638244629, 3.596741199493408, 4.2737531661987305, 3.5211286544799805, 4.704495906829834, 1.0948351621627808, 3.673264741897583, 4.469329833984375, 3.621805429458618, 0.8077995181083679, 4.137439727783203, 4.465619087219238, 5.271725177764893, 4.418021202087402, 3.3400440216064453, 3.7974395751953125, 4.3791823387146, 4.481452941894531, 0.6287201642990112, 3.718189239501953, 3.4030535221099854, 3.6637234687805176, 2.0965728759765625, 3.945408821105957, 3.0444116592407227, 0.7729936242103577, 5.924765586853027, 4.246940612792969, 3.819202423095703, 1.6421098709106445, 4.901883125305176, 3.5109684467315674, 4.746615409851074, 3.6168086528778076, 0.8842039108276367, 3.75778865814209, 3.813619375228882, 5.8193488121032715, 2.537865161895752, 3.9616518020629883, 4.540631294250488, 2.4706759452819824, 5.021707534790039, 3.6261963844299316, 4.7033915519714355, 4.569070339202881, 4.103294372558594, 3.8675851821899414, 3.071584701538086, 2.9315338134765625, 1.9441293478012085, 4.545464515686035, 5.072961807250977, 4.591475486755371, 3.7474472522735596, 5.623611927032471, 4.324478626251221, 4.783303260803223, 4.9553985595703125, 3.500483989715576, 4.487700462341309, 4.9543914794921875, 3.613175392150879, 6.882332801818848, 5.486784934997559, 2.7573230266571045, 4.368878364562988, 4.714239120483398, 3.031233787536621, 5.6436285972595215, 6.083349227905273, 3.569878101348877, 6.497976303100586, 3.841113567352295, 4.661642074584961, 6.126733779907227, 3.658722400665283, 3.965488910675049, 4.151861190795898, 2.7712860107421875, 2.335015058517456, 0.355334997177124], "mean_td_error": 3.820706844329834, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 20.0, "diff_num_grad_updates_vs_sampler_policy": 19.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.157323837280273, "actor_loss": -4.534741401672363, "critic_loss": 0.4365658164024353, "alpha_loss": -0.057945773005485535, "alpha_value": 0.9943113923072815, "log_alpha_value": -0.005704826675355434, "target_entropy": -6.0, "policy_t": -0.04532068595290184, "mean_q": 0.39565014839172363, "max_q": 2.6355342864990234, "min_q": 0.36837005615234375}, "td_error": [2.851531505584717, 3.4164087772369385, 2.5548720359802246, 1.876579999923706, 1.970616102218628, 1.6494140625, 2.5037646293640137, 2.0659475326538086, 0.9796137809753418, 2.7472357749938965, 4.856348037719727, 2.4039926528930664, 1.1708602905273438, 1.5253446102142334, 0.5852011442184448, 2.8319168090820312, 3.1402602195739746, 1.3748669624328613, 3.484739303588867, 2.0623435974121094, 1.5667999982833862, 3.4761180877685547, 4.01982307434082, 1.5625468492507935, 2.695456027984619, 4.192139625549316, 2.363781452178955, 2.1745314598083496, 5.138859272003174, 0.5278831124305725, 1.7093284130096436, 2.6298513412475586, 2.540189266204834, 3.2557101249694824, 1.2502728700637817, 1.363018274307251, 2.5462875366210938, 0.9968840479850769, 2.6135597229003906, 2.830946445465088, 2.5258140563964844, 0.7653911709785461, 1.8624773025512695, 2.6131694316864014, 2.3580918312072754, 3.2535252571105957, 1.8906364440917969, 2.2947278022766113, 2.030210018157959, 1.8746380805969238, 3.8386802673339844, 1.3824341297149658, 4.927095413208008, 0.7852537035942078, 0.6059062480926514, 2.6665761470794678, 3.036151647567749, 0.6879218816757202, 2.0236282348632812, 2.716676712036133, 1.718226432800293, 2.357935905456543, 3.2049813270568848, 0.7024946212768555, 3.225984573364258, 2.912240743637085, 3.528756856918335, 2.7279810905456543, 3.859459638595581, 0.9494748711585999, 3.9783971309661865, 2.278143882751465, 1.0328006744384766, 2.9164161682128906, 1.6828325986862183, 4.170395851135254, 3.184196949005127, 2.722855567932129, 2.0944933891296387, 0.7153216004371643, 3.2298858165740967, 1.5938687324523926, 2.1336145401000977, 2.1743412017822266, 2.706386089324951, 3.15832781791687], "mean_td_error": 2.379124402999878, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 20.0, "diff_num_grad_updates_vs_sampler_policy": 19.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.105392456054688, "actor_loss": -4.400251388549805, "critic_loss": 0.7682663202285767, "alpha_loss": -0.05763871222734451, "alpha_value": 0.9943124651908875, "log_alpha_value": -0.005703757982701063, "target_entropy": -6.0, "policy_t": -0.06588669121265411, "mean_q": 0.4205712080001831, "max_q": 4.289007186889648, "min_q": 0.26175856590270996}, "td_error": [2.7811279296875, 2.367957830429077, 0.4936748147010803, 2.7698142528533936, 3.434499740600586, 0.8818848133087158, 2.276998996734619, 2.00337815284729, 2.534562110900879, 2.3391525745391846, 2.0763702392578125, 1.6821229457855225, 1.5807600021362305, 1.6692585945129395, 2.934891700744629, 1.4620466232299805, 2.3116977214813232, 0.17839403450489044, 0.9217613935470581, 1.8106799125671387, 1.2609809637069702, 2.5214548110961914, 3.156067371368408, 2.5230119228363037, 3.973534107208252, 2.1113932132720947, 5.174530506134033, 1.9727680683135986, 2.1801598072052, 3.3345208168029785, 1.595755934715271, 1.9522266387939453, 2.1629350185394287, 2.307644844055176, 3.2867555618286133, 3.1864724159240723, 3.1015706062316895, 0.40072178840637207, 3.752129554748535, 2.6426749229431152, 3.4855563640594482, 2.722161293029785, 2.6621012687683105, 1.0754168033599854, 3.0771267414093018, 0.5403748750686646, 2.0622122287750244, 2.8766322135925293, 4.547287940979004, 1.657069206237793, 2.8035922050476074, 2.654758930206299, 1.7638084888458252, 2.94980525970459, 1.9772509336471558, 2.366116523742676, 1.6305526494979858, 2.951371431350708, 2.5532402992248535, 1.9017876386642456, 1.4533977508544922, 4.798496246337891, 0.6672842502593994, 2.579782009124756, 1.9928278923034668, 1.8134512901306152, 1.1703431606292725, 3.2995378971099854, 1.6616895198822021, 3.0421080589294434, 3.4470362663269043, 4.0211076736450195, 3.2546613216400146, 2.9429502487182617, 1.4472324848175049, 3.1842408180236816, 1.636063814163208, 1.3652095794677734, 3.3854732513427734, 1.2389023303985596, 0.36524826288223267, 2.4792256355285645, 1.7990010976791382, 2.5083062648773193, 1.4292948246002197, 1.6741926670074463], "mean_td_error": 2.302600145339966, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 20.0, "diff_num_grad_updates_vs_sampler_policy": 19.0}}, "num_env_steps_sampled": 18816, "num_env_steps_trained": 5160, "num_agent_steps_sampled": 56448, "num_agent_steps_trained": 5160, "last_target_update_ts": 18816, "num_target_updates": 20}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56448, "num_agent_steps_trained": 5160, "num_env_steps_sampled": 18816, "num_env_steps_trained": 5160, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 888.0853069369074, "num_env_steps_trained_throughput_per_sec": 255.7209923992434, "timesteps_total": 18816, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 56448, "timers": {"training_iteration_time_ms": 1033.262, "sample_time_ms": 736.7, "load_time_ms": 0.321, "load_throughput": 802707.835, "learn_time_ms": 18.598, "learn_throughput": 13872.098, "synch_weights_time_ms": 11.536}, "counters": {"num_env_steps_sampled": 18816, "num_env_steps_trained": 5160, "num_agent_steps_sampled": 56448, "num_agent_steps_trained": 5160, "last_target_update_ts": 18816, "num_target_updates": 20}, "done": false, "episodes_total": 0, "training_iteration": 14, "trial_id": "ff3c2_00000", "date": "2023-11-18_21-11-16", "timestamp": 1700370676, "time_this_iter_s": 1.0176472663879395, "time_total_s": 20.69737434387207, "pid": 7608, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17c1aa980>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 20.69737434387207, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 77.4, "ram_util_percent": 65.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.110527992248535, "actor_loss": -4.579958438873291, "critic_loss": 2.1807258129119873, "alpha_loss": -0.0637117326259613, "alpha_value": 0.9937182664871216, "log_alpha_value": -0.00630152365192771, "target_entropy": -6.0, "policy_t": 0.028454314917325974, "mean_q": 0.7624670267105103, "max_q": 6.128567695617676, "min_q": 0.4219253361225128}, "td_error": [4.5333251953125, 4.973110675811768, 4.797277450561523, 3.497436046600342, 2.5988411903381348, 3.9376988410949707, 3.4120726585388184, 4.395993709564209, 3.205253839492798, 3.6079764366149902, 3.556976556777954, 4.270400047302246, 3.634103536605835, 4.566661357879639, 2.317864179611206, 4.754228591918945, 5.293940544128418, 2.2409591674804688, 4.326913833618164, 4.4244537353515625, 0.21670842170715332, 5.3020148277282715, 2.138978958129883, 3.355055570602417, 4.313356876373291, 2.4576990604400635, 2.624127149581909, 2.243419885635376, 5.578104496002197, 3.9229865074157715, 4.950875282287598, 3.613734245300293, 3.8102457523345947, 5.598980903625488, 2.5157546997070312, 2.4206461906433105, 3.602735757827759, 5.405956268310547, 2.462559938430786, 4.116701126098633, 2.7584030628204346, 5.030481338500977, 2.1428542137145996, 3.3757858276367188, 5.11689567565918, 2.751523733139038, 5.130812168121338, 3.782439708709717, 5.016782760620117, 2.5969362258911133, 3.018463134765625, 3.4679765701293945, 0.39179062843322754, 5.079898834228516, 4.055660724639893, 4.234380722045898, 5.350163459777832, 5.637983798980713, 4.7860822677612305, 3.362776756286621, 4.355173110961914, 3.4818625450134277, 2.865248680114746, 3.4536824226379395, 3.1266865730285645, 2.4938197135925293, 3.5863685607910156, 4.332603931427002, 5.150854587554932, 4.278109550476074, 2.0856828689575195, 3.0452277660369873, 4.114227294921875, 4.059364318847656, 4.8750410079956055, 6.310257911682129, 2.3161778450012207, 4.143738746643066, 3.052100658416748, 3.1045656204223633, 3.9170427322387695, 2.3236045837402344, 4.15760612487793, 4.705588340759277, 4.466750621795654, 2.9962399005889893], "mean_td_error": 3.7544403076171875, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 22.0, "diff_num_grad_updates_vs_sampler_policy": 21.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.173078536987305, "actor_loss": -4.624948024749756, "critic_loss": 0.3866109251976013, "alpha_loss": -0.0641508400440216, "alpha_value": 0.993713915348053, "log_alpha_value": -0.006305941846221685, "target_entropy": -6.0, "policy_t": -0.013076658360660076, "mean_q": 0.6104134321212769, "max_q": 5.2168707847595215, "min_q": 0.4342738091945648}, "td_error": [2.6348891258239746, 1.7939907312393188, 3.173579692840576, 1.0573678016662598, 1.9104747772216797, 1.408015251159668, 1.1753615140914917, 2.7150278091430664, 0.22794097661972046, 1.4826486110687256, 3.009370803833008, 3.757453680038452, 1.40913724899292, 3.740262746810913, 2.414055585861206, 2.021169662475586, 1.966778039932251, 1.9821813106536865, 0.3990025520324707, 2.317155361175537, 2.873264789581299, 2.262969493865967, 0.9612767696380615, 3.0809829235076904, 1.5305426120758057, 1.334458351135254, 4.009525775909424, 1.5410196781158447, 2.461668014526367, 2.0319314002990723, 1.0655994415283203, 1.936742901802063, 1.4976459741592407, 2.810276508331299, 2.8532302379608154, 2.2973084449768066, 0.7686668634414673, 2.244586706161499, 3.9175424575805664, 2.8662476539611816, 3.8160088062286377, 3.2485249042510986, 2.1288535594940186, 2.6094160079956055, 2.022188186645508, 2.1015710830688477, 1.98952054977417, 2.039179801940918, 2.9306249618530273, 2.9081950187683105, 1.3855186700820923, 2.649545907974243, 1.1842825412750244, 2.3798840045928955, 4.818070888519287, 1.5454144477844238, 1.7997095584869385, 0.5347362756729126, 2.6262145042419434, 2.650179624557495, 0.8366854786872864, 0.9883453845977783, 2.3489890098571777, 2.268047571182251, 2.710343837738037, 1.9889976978302002, 2.4489588737487793, 1.926161289215088, 2.80684232711792, 2.2621960639953613, 1.4572279453277588, 0.24599066376686096, 2.3903846740722656, 0.1639871597290039, 2.366753578186035, 3.7569398880004883, 4.381072044372559, 2.1532158851623535, 3.8836350440979004, 2.0546011924743652, 2.3885364532470703, 1.984123945236206, 0.9306966066360474, 0.7786018252372742, 0.12922878563404083, 2.516023635864258], "mean_td_error": 2.1450650691986084, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 22.0, "diff_num_grad_updates_vs_sampler_policy": 21.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.113481521606445, "actor_loss": -4.466580390930176, "critic_loss": 0.790483295917511, "alpha_loss": -0.06376131623983383, "alpha_value": 0.993715226650238, "log_alpha_value": -0.006304586306214333, "target_entropy": -6.0, "policy_t": 0.006637465674430132, "mean_q": 0.3962843120098114, "max_q": 2.6794373989105225, "min_q": 0.31320852041244507}, "td_error": [1.3761725425720215, 3.4773173332214355, 2.194509983062744, 2.9786651134490967, 1.4031065702438354, 2.6183576583862305, 0.20114386081695557, 3.834238052368164, 2.284238338470459, 2.710203170776367, 0.855277419090271, 2.838522434234619, 1.1634361743927002, 1.9087789058685303, 1.8019920587539673, 3.0257320404052734, 1.854914665222168, 3.7646126747131348, 3.6106221675872803, 2.512242317199707, 2.6999716758728027, 2.059262275695801, 1.0810033082962036, 0.28304362297058105, 1.606963038444519, 1.4278795719146729, 1.7781078815460205, 2.8911519050598145, 3.316249132156372, 1.3637852668762207, 4.085271835327148, 2.574711322784424, 4.614361763000488, 3.3449602127075195, 2.7724032402038574, 3.894103527069092, 1.9288345575332642, 2.392378807067871, 3.135342836380005, 2.2970075607299805, 1.2147743701934814, 4.500622749328613, 1.857816219329834, 3.156338930130005, 3.340832471847534, 4.576499938964844, 3.6447386741638184, 2.5856661796569824, 1.0650383234024048, 2.712400436401367, 0.698973536491394, 1.911637783050537, 2.147536516189575, 1.9343055486679077, 1.7888599634170532, 4.5329179763793945, 2.6926422119140625, 2.233086585998535, 1.2462427616119385, 0.028265997767448425, 3.1802659034729004, 0.8786466121673584, 2.3330960273742676, 0.7770912647247314, 2.707949161529541, 0.3613169193267822, 1.5527141094207764, 2.397705078125, 3.6612348556518555, 4.042017459869385, 3.198308229446411, 0.7527889013290405, 3.2671091556549072, 1.6644397974014282, 3.1686911582946777, 1.0663635730743408, 3.40432071685791, 3.5993027687072754, 1.9490783214569092, 1.52238929271698, 2.1571826934814453, 1.9247605800628662, 3.237612247467041, 1.679703950881958, 1.453707218170166, 3.1596622467041016], "mean_td_error": 2.3596224784851074, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 22.0, "diff_num_grad_updates_vs_sampler_policy": 21.0}}, "num_env_steps_sampled": 20608, "num_env_steps_trained": 5676, "num_agent_steps_sampled": 61824, "num_agent_steps_trained": 5676, "last_target_update_ts": 20608, "num_target_updates": 22}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 61824, "num_agent_steps_trained": 5676, "num_env_steps_sampled": 20608, "num_env_steps_trained": 5676, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 1002.3369171248925, "num_env_steps_trained_throughput_per_sec": 288.61933551140874, "timesteps_total": 20608, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 61824, "timers": {"training_iteration_time_ms": 1031.773, "sample_time_ms": 733.783, "load_time_ms": 0.323, "load_throughput": 798974.034, "learn_time_ms": 18.563, "learn_throughput": 13898.77, "synch_weights_time_ms": 11.462}, "counters": {"num_env_steps_sampled": 20608, "num_env_steps_trained": 5676, "num_agent_steps_sampled": 61824, "num_agent_steps_trained": 5676, "last_target_update_ts": 20608, "num_target_updates": 22}, "done": false, "episodes_total": 0, "training_iteration": 15, "trial_id": "ff3c2_00000", "date": "2023-11-18_21-11-17", "timestamp": 1700370677, "time_this_iter_s": 1.8059720993041992, "time_total_s": 22.50334644317627, "pid": 7608, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17e264540>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 22.50334644317627, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 67.89999999999999, "ram_util_percent": 64.83333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.047572135925293, "actor_loss": -4.564781188964844, "critic_loss": 2.4810500144958496, "alpha_loss": -0.06633111089468002, "alpha_value": 0.9934200644493103, "log_alpha_value": -0.006601704750210047, "target_entropy": -6.0, "policy_t": 0.0051437425427138805, "mean_q": 0.6696605086326599, "max_q": 6.5827460289001465, "min_q": 0.45681923627853394}, "td_error": [3.9781105518341064, 5.606664657592773, 4.460512161254883, 4.320788860321045, 1.328054428100586, 4.636853218078613, 4.146653175354004, 3.6006669998168945, 4.078874111175537, 4.267233848571777, 3.6592607498168945, 4.187830924987793, 5.180084228515625, 2.132702350616455, 5.82621955871582, 3.3717832565307617, 3.933708667755127, 3.429858684539795, 4.857288837432861, 4.890043258666992, 5.0918450355529785, 3.8782711029052734, 4.997467041015625, 4.131902694702148, 4.419128894805908, 6.009925842285156, 4.537591457366943, 1.9364972114562988, 3.76825213432312, 2.755955219268799, 4.651750564575195, 5.072192192077637, 3.797544479370117, 4.264338970184326, 4.073548316955566, 4.306760787963867, 3.16096830368042, 4.740035057067871, 4.585074424743652, 4.848658561706543, 4.920014381408691, 4.124042510986328, 3.5758330821990967, 4.640488624572754, 3.870655059814453, 3.3436527252197266, 5.544380187988281, 3.851243019104004, 2.681673049926758, 3.7250823974609375, 4.946394920349121, 4.112758636474609, 4.903796195983887, 5.720421314239502, 4.4446001052856445, 4.3368635177612305, 5.088766098022461, 3.016101598739624, 6.887419700622559, 5.472870826721191, 4.753037452697754, 2.7362780570983887, 2.9521126747131348, 1.405010461807251, 5.235784530639648, 5.581510066986084, 5.684741973876953, 3.8829267024993896, 4.400599002838135, 3.4744210243225098, 4.9159746170043945, 2.9309470653533936, 3.151057481765747, 4.547552585601807, 3.0199127197265625, 5.992039680480957, 4.901909828186035, 4.342390060424805, 4.286599636077881, 4.520859718322754, 1.222266674041748, 4.701411724090576, 4.201434135437012, 4.937469482421875, 5.564781188964844, 3.704566717147827], "mean_td_error": 4.2229719161987305, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 23.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.103353500366211, "actor_loss": -4.585911750793457, "critic_loss": 0.3790273666381836, "alpha_loss": -0.06674863398075104, "alpha_value": 0.9934151768684387, "log_alpha_value": -0.006606583017855883, "target_entropy": -6.0, "policy_t": -0.012108988128602505, "mean_q": 0.7295286655426025, "max_q": 5.434772968292236, "min_q": 0.4693997800350189}, "td_error": [2.458660125732422, 1.8221477270126343, 1.9346606731414795, 0.2214571237564087, 2.3986568450927734, 3.153388261795044, 1.8864452838897705, 2.7459263801574707, 3.51519775390625, 2.9602601528167725, 2.313159227371216, 2.2725090980529785, 1.5857199430465698, 1.629616141319275, 1.9500633478164673, 2.4194722175598145, 0.7464733719825745, 2.3177270889282227, 4.153262138366699, 1.1996049880981445, 1.5875258445739746, 2.424910306930542, 2.4916319847106934, 4.014215469360352, 2.1073760986328125, 5.063722133636475, 1.5064195394515991, 0.8186028003692627, 0.7139836549758911, 1.9581298828125, 2.5432887077331543, 2.579040288925171, 2.279005527496338, 1.3024203777313232, 1.7397197484970093, 1.5161141157150269, 2.3895342350006104, 3.3812408447265625, 2.0916216373443604, 2.376830577850342, 1.598780632019043, 1.5692074298858643, 2.243124008178711, 2.2107348442077637, 2.1454567909240723, 2.1208291053771973, 2.8459606170654297, 1.2787201404571533, 1.8356624841690063, 4.264100074768066, 2.457638740539551, 3.0209264755249023, 2.7837746143341064, 0.9422026872634888, 2.4218602180480957, 1.581817626953125, 1.448395848274231, 2.3124990463256836, 1.9505043029785156, 3.47221302986145, 0.9113502502441406, 1.7852829694747925, 2.1483404636383057, 2.7928249835968018, 3.8186726570129395, 2.9724392890930176, 0.14806127548217773, 1.9679625034332275, 0.5593788623809814, 1.9547429084777832, 2.452735662460327, 2.280869483947754, 2.353757858276367, 1.2169156074523926, 2.563936710357666, 1.0420500040054321, 2.6997148990631104, 1.0080170631408691, 1.3933494091033936, 3.3235960006713867, 2.359116554260254, 0.304368793964386, 2.1690354347229004, 0.8199242353439331, 1.798447608947754, 2.387512683868408], "mean_td_error": 2.1198434829711914, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 23.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.086097717285156, "actor_loss": -4.471737861633301, "critic_loss": 0.7009479999542236, "alpha_loss": -0.0666188970208168, "alpha_value": 0.9934167265892029, "log_alpha_value": -0.006605022121220827, "target_entropy": -6.0, "policy_t": -0.0391518734395504, "mean_q": 0.6311433911323547, "max_q": 5.22205924987793, "min_q": 0.3415432274341583}, "td_error": [2.8715529441833496, 0.5249153971672058, 3.7771527767181396, 1.701101541519165, 2.280078411102295, 3.829235553741455, 3.3830924034118652, 2.107785701751709, 2.050448417663574, 3.3195526599884033, 0.6978358030319214, 2.6921768188476562, 2.2923710346221924, 2.5144855976104736, 2.333965301513672, 2.1635384559631348, 2.3853683471679688, 1.5349702835083008, 0.5826455354690552, 3.8422670364379883, 1.746264934539795, 2.998037338256836, 2.7271111011505127, 0.6361076831817627, 2.067929267883301, 3.057065963745117, 2.2316064834594727, 2.674041271209717, 0.9049511551856995, 2.6303369998931885, 3.1883931159973145, 2.4338483810424805, 3.0811116695404053, 3.9549357891082764, 3.3027544021606445, 2.165250301361084, 2.8421788215637207, 2.236618995666504, 1.5582642555236816, 1.5827171802520752, 3.1318862438201904, 4.649875164031982, 2.383479118347168, 2.5315093994140625, 3.3314285278320312, 0.8497323989868164, 1.9859824180603027, 1.0407798290252686, 3.0452194213867188, 0.3335835933685303, 2.3899126052856445, 1.8661266565322876, 1.083770751953125, 1.7036733627319336, 3.0486698150634766, 1.1078377962112427, 1.255532145500183, 1.3926188945770264, 2.141850471496582, 2.3591084480285645, 2.9803466796875, 2.329979658126831, 3.4072136878967285, 1.4233372211456299, 1.7949650287628174, 1.5136579275131226, 2.856517791748047, 1.5455217361450195, 1.8867992162704468, 2.126095771789551, 1.1141891479492188, 2.3375792503356934, 1.2499852180480957, 0.8124971985816956, 2.683161973953247, 0.8413900136947632, 2.34568190574646, 1.076790690422058, 2.913888454437256, 0.6970850229263306, 1.1960160732269287, 2.9905905723571777, 2.407357692718506, 1.6774024963378906, 2.9181127548217773, 3.5801827907562256], "mean_td_error": 2.2004997730255127, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 23.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 21504, "num_env_steps_trained": 5934, "num_agent_steps_sampled": 64512, "num_agent_steps_trained": 5934, "last_target_update_ts": 21504, "num_target_updates": 23}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64512, "num_agent_steps_trained": 5934, "num_env_steps_sampled": 21504, "num_env_steps_trained": 5934, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 890.4373987384452, "num_env_steps_trained_throughput_per_sec": 256.39826883316834, "timesteps_total": 21504, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 64512, "timers": {"training_iteration_time_ms": 1042.99, "sample_time_ms": 744.729, "load_time_ms": 0.326, "load_throughput": 791146.682, "learn_time_ms": 18.641, "learn_throughput": 13840.746, "synch_weights_time_ms": 10.733}, "counters": {"num_env_steps_sampled": 21504, "num_env_steps_trained": 5934, "num_agent_steps_sampled": 64512, "num_agent_steps_trained": 5934, "last_target_update_ts": 21504, "num_target_updates": 23}, "done": false, "episodes_total": 0, "training_iteration": 16, "trial_id": "ff3c2_00000", "date": "2023-11-18_21-11-18", "timestamp": 1700370678, "time_this_iter_s": 1.0147173404693604, "time_total_s": 23.51806378364563, "pid": 7608, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17e264ae0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 23.51806378364563, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 77.3, "ram_util_percent": 65.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.093552589416504, "actor_loss": -4.692426681518555, "critic_loss": 2.146174430847168, "alpha_loss": -0.07269236445426941, "alpha_value": 0.9928240180015564, "log_alpha_value": -0.007201861124485731, "target_entropy": -6.0, "policy_t": 0.025537122040987015, "mean_q": 0.8864121437072754, "max_q": 8.196943283081055, "min_q": 0.5309622883796692}, "td_error": [3.048536777496338, 4.085509300231934, 3.7170004844665527, 2.4184536933898926, 2.3515491485595703, 3.417605400085449, 4.309699058532715, 4.26609992980957, 4.670720100402832, 3.5507216453552246, 4.917167663574219, 3.138094902038574, 4.635149955749512, 3.224907875061035, 5.727978706359863, 4.11752986907959, 5.612414360046387, 3.779224395751953, 3.540497064590454, 4.481632232666016, 4.2138261795043945, 3.431074619293213, 6.334025859832764, 4.308349609375, 2.8046092987060547, 5.268731117248535, 4.240760803222656, 5.141043186187744, 1.2566231489181519, 4.127725601196289, 4.164851188659668, 1.3372195959091187, 5.702492713928223, 4.949173927307129, 3.92195987701416, 2.6749649047851562, 2.639185667037964, 2.1143784523010254, 4.222536087036133, 3.253117561340332, 4.726102352142334, 4.134631633758545, 0.23117899894714355, 1.122016191482544, 2.426844835281372, 2.7825632095336914, 5.509676933288574, 3.4069182872772217, 5.938742160797119, 2.583360195159912, 2.8266942501068115, 3.430785894393921, 3.7704720497131348, 2.8119537830352783, 0.19415497779846191, 4.343426704406738, 5.219951629638672, 4.661032199859619, 5.786489009857178, 3.0337581634521484, 4.402545928955078, 1.7410997152328491, 5.182607173919678, 3.7605013847351074, 3.839414596557617, 2.9394478797912598, 5.770096778869629, 3.585688591003418, 2.3605308532714844, 4.607943534851074, 1.8402777910232544, 3.328155517578125, 1.880684733390808, 3.231194496154785, 2.6276092529296875, 2.5054759979248047, 4.248745918273926, 4.735634803771973, 4.242115020751953, 3.8650074005126953, 0.5130593776702881, 4.631341934204102, 3.3560941219329834, 3.028280735015869, 4.589961051940918, 4.591975212097168], "mean_td_error": 3.6681787967681885, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 25.0, "diff_num_grad_updates_vs_sampler_policy": 24.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.098679542541504, "actor_loss": -4.659593105316162, "critic_loss": 0.35385411977767944, "alpha_loss": -0.07278860360383987, "alpha_value": 0.9928181767463684, "log_alpha_value": -0.007207735441625118, "target_entropy": -6.0, "policy_t": 0.03399823606014252, "mean_q": 0.6729132533073425, "max_q": 4.280481338500977, "min_q": 0.5439208745956421}, "td_error": [0.501789927482605, 2.797586441040039, 2.117645263671875, 1.9892516136169434, 2.915912389755249, 0.28636980056762695, 1.7085003852844238, 1.7715821266174316, 2.8373849391937256, 0.9680092334747314, 1.9291620254516602, 2.3206214904785156, 1.0312728881835938, 2.452256679534912, 3.4588232040405273, 0.8812152147293091, 2.413074016571045, 1.9108099937438965, 2.2811975479125977, 2.3474855422973633, 1.6636122465133667, 1.5803418159484863, 2.7929532527923584, 2.4958202838897705, 2.5626235008239746, 1.4098591804504395, 0.04792451858520508, 2.530881643295288, 0.9811239242553711, 2.280148506164551, 1.7083702087402344, 1.9576971530914307, 1.424532413482666, 2.793487071990967, 0.9250612258911133, 1.5912706851959229, 2.5084471702575684, 2.599628448486328, 2.435825824737549, 0.20439618825912476, 2.345451593399048, 0.17407095432281494, 0.8042881488800049, 3.486725091934204, 2.623420476913452, 3.2190463542938232, 3.6222686767578125, 2.412832736968994, 3.776425361633301, 2.504439353942871, 1.7571864128112793, 1.8669357299804688, 2.9804606437683105, 1.3014812469482422, 3.458714485168457, 2.087310791015625, 2.34169340133667, 0.7809596061706543, 2.626901149749756, 1.9797207117080688, 1.2208199501037598, 1.757148265838623, 1.294211983680725, 2.4654228687286377, 1.5554685592651367, 1.1432117223739624, 0.9518437385559082, 3.070845603942871, 1.0169306993484497, 3.6252331733703613, 0.38836219906806946, 2.8759751319885254, 2.5817618370056152, 3.318247079849243, 2.468045234680176, 2.238792896270752, 1.2731043100357056, 1.0763559341430664, 2.082188129425049, 1.9403846263885498, 2.3524482250213623, 1.4092557430267334, 3.239400863647461, 1.9800283908843994, 1.6187973022460938, 1.1274311542510986], "mean_td_error": 1.9957674741744995, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 25.0, "diff_num_grad_updates_vs_sampler_policy": 24.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.12498664855957, "actor_loss": -4.570315837860107, "critic_loss": 0.6865994930267334, "alpha_loss": -0.07295779138803482, "alpha_value": 0.9928202033042908, "log_alpha_value": -0.0072057186625897884, "target_entropy": -6.0, "policy_t": -0.03308967873454094, "mean_q": 0.567590594291687, "max_q": 4.621257781982422, "min_q": 0.4003835916519165}, "td_error": [2.684847354888916, 0.9737387895584106, 0.47919005155563354, 2.357358932495117, 4.481931686401367, 3.2477946281433105, 1.56699538230896, 1.484025001525879, 3.270918846130371, 2.973458766937256, 2.7264294624328613, 3.694023370742798, 1.836667776107788, 2.900710105895996, 0.3253591060638428, 2.330075263977051, 0.8973650932312012, 0.44507789611816406, 0.050108402967453, 1.9646823406219482, 0.15905027091503143, 1.8867647647857666, 1.6811408996582031, 1.0567759275436401, 1.6205699443817139, 3.2013092041015625, 5.347227096557617, 0.40190619230270386, 2.3692846298217773, 3.0739870071411133, 1.8544906377792358, 2.7017765045166016, 3.9565377235412598, 2.360755443572998, 2.499509811401367, 1.4356552362442017, 2.4990427494049072, 3.7139317989349365, 1.0200839042663574, 1.5716567039489746, 3.2643656730651855, 2.5081686973571777, 3.5575742721557617, 0.5127648115158081, 1.8245902061462402, 1.94014310836792, 1.0414862632751465, 2.855844020843506, 1.9775981903076172, 2.202911376953125, 3.139679431915283, 2.5928406715393066, 1.0291855335235596, 1.131836175918579, 3.9031801223754883, 2.1712067127227783, 1.7576813697814941, 2.14705228805542, 3.094362735748291, 2.3790528774261475, 2.5188541412353516, 3.0533809661865234, 2.8157663345336914, 3.560832977294922, 2.460148334503174, 2.408776044845581, 1.5176082849502563, 0.923245370388031, 2.700016736984253, 1.1143765449523926, 2.2301979064941406, 2.7304816246032715, 1.1524243354797363, 0.8504343628883362, 0.6056345701217651, 0.7710285186767578, 0.37272024154663086, 3.3281197547912598, 2.9144816398620605, 3.008193016052246, 0.4911860227584839, 1.0187076330184937, 3.0176663398742676, 0.5112693905830383, 4.405073165893555, 2.6050333976745605], "mean_td_error": 2.130458116531372, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 25.0, "diff_num_grad_updates_vs_sampler_policy": 24.0}}, "num_env_steps_sampled": 23296, "num_env_steps_trained": 6450, "num_agent_steps_sampled": 69888, "num_agent_steps_trained": 6450, "last_target_update_ts": 23296, "num_target_updates": 25}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 69888, "num_agent_steps_trained": 6450, "num_env_steps_sampled": 23296, "num_env_steps_trained": 6450, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 887.2029646644716, "num_env_steps_trained_throughput_per_sec": 255.4669250931179, "timesteps_total": 23296, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 69888, "timers": {"training_iteration_time_ms": 1024.024, "sample_time_ms": 711.267, "load_time_ms": 0.319, "load_throughput": 807560.024, "learn_time_ms": 18.185, "learn_throughput": 14187.669, "synch_weights_time_ms": 10.072}, "counters": {"num_env_steps_sampled": 23296, "num_env_steps_trained": 6450, "num_agent_steps_sampled": 69888, "num_agent_steps_trained": 6450, "last_target_update_ts": 23296, "num_target_updates": 25}, "done": false, "episodes_total": 0, "training_iteration": 17, "trial_id": "ff3c2_00000", "date": "2023-11-18_21-11-21", "timestamp": 1700370681, "time_this_iter_s": 2.027026891708374, "time_total_s": 25.545090675354004, "pid": 7608, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17c1ab420>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 25.545090675354004, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 71.0, "ram_util_percent": 65.13333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.105401992797852, "actor_loss": -4.795684337615967, "critic_loss": 2.1379261016845703, "alpha_loss": -0.07884320616722107, "alpha_value": 0.9922282695770264, "log_alpha_value": -0.0078020840883255005, "target_entropy": -6.0, "policy_t": 0.04341839998960495, "mean_q": 1.061738133430481, "max_q": 9.074409484863281, "min_q": 0.6105163097381592}, "td_error": [5.013278961181641, 4.017672538757324, 2.917327880859375, 3.990817070007324, 3.7873640060424805, 3.9549479484558105, 3.5858030319213867, 5.029938697814941, 3.3940610885620117, 3.3899455070495605, 5.93121337890625, 4.466862678527832, 4.118399620056152, 2.7051072120666504, 2.8296384811401367, 3.0120015144348145, 5.50193977355957, 3.683544635772705, 3.4690961837768555, 2.089982032775879, 4.29591178894043, 4.069430351257324, 4.204052925109863, 5.137056350708008, 4.20635461807251, 4.403242588043213, 3.157583475112915, 3.036162853240967, 4.21090030670166, 3.878444194793701, 2.9197235107421875, 4.447572708129883, 5.9934892654418945, 2.0704805850982666, 2.35347843170166, 3.676229476928711, 4.4293060302734375, 4.122650623321533, 5.671733856201172, 4.870339393615723, 5.016254425048828, 2.0083858966827393, 2.9283957481384277, 2.8707027435302734, 3.0875394344329834, 4.181192874908447, 3.9416074752807617, 2.8495266437530518, 2.7135281562805176, 4.741435527801514, 3.998511791229248, 3.082394599914551, 4.746396541595459, 2.3917605876922607, 4.2246623039245605, 3.7135820388793945, 4.107414245605469, 4.135499954223633, 3.69476318359375, 5.255483150482178, 4.414914131164551, 4.182782173156738, 6.514922142028809, 2.922726631164551, 4.560483932495117, 3.5746328830718994, 4.735504150390625, 3.164074659347534, 3.9093501567840576, 5.301092147827148, 3.24017071723938, 4.013017654418945, 4.875494480133057, 1.9206312894821167, 4.327635765075684, 4.27651309967041, 3.9151811599731445, 2.386028528213501, 4.873417854309082, 4.142821311950684, 4.449362754821777, 3.6570918560028076, 5.193016052246094, 3.116650342941284, 5.085664749145508, 4.673256874084473], "mean_td_error": 3.94370436668396, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 27.0, "diff_num_grad_updates_vs_sampler_policy": 26.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.135970115661621, "actor_loss": -4.775733947753906, "critic_loss": 0.32606709003448486, "alpha_loss": -0.07914922386407852, "alpha_value": 0.9922216534614563, "log_alpha_value": -0.007808746304363012, "target_entropy": -6.0, "policy_t": 0.02493697591125965, "mean_q": 0.9099241495132446, "max_q": 4.529809951782227, "min_q": 0.6256398558616638}, "td_error": [0.49251502752304077, 0.3600313663482666, 3.9516284465789795, 1.858794093132019, 2.314924716949463, 2.379686117172241, 0.22400128841400146, 2.3746285438537598, 2.115420341491699, 0.34252429008483887, 1.5884190797805786, 0.2594670057296753, 1.2082544565200806, 2.4335997104644775, 1.5980334281921387, 3.245556354522705, 1.7040928602218628, 1.4027059078216553, 1.8138432502746582, 2.0737972259521484, 3.488701820373535, 3.5162148475646973, 2.1758153438568115, 3.3272557258605957, 4.133940696716309, 0.7535560131072998, 0.8398232460021973, 1.3582451343536377, 2.1455185413360596, 1.4184154272079468, 1.0209554433822632, 1.2711938619613647, 0.3627699911594391, 0.9157707691192627, 0.9088849425315857, 2.2455220222473145, 2.650914192199707, 1.4520366191864014, 1.037591814994812, 0.11076158285140991, 2.2815840244293213, 2.0133237838745117, 2.811570167541504, 0.5557621121406555, 2.118389129638672, 0.12942960858345032, 1.3041976690292358, 1.9782099723815918, 1.7841753959655762, 1.588533639907837, 1.8736642599105835, 1.4077191352844238, 2.419949531555176, 4.315644264221191, 1.922094702720642, 0.1573633849620819, 1.1967096328735352, 2.4352097511291504, 0.7180403470993042, 2.511687994003296, 1.5555627346038818, 4.307436943054199, 2.7288382053375244, 3.364166259765625, 2.3637521266937256, 1.3581082820892334, 1.2689323425292969, 0.5791410803794861, 4.17336368560791, 2.5332136154174805, 3.521799087524414, 2.5547990798950195, 2.1376490592956543, 3.02268123626709, 1.4318171739578247, 1.7730605602264404, 2.2931630611419678, 0.5081435441970825, 1.7591010332107544, 1.5800607204437256, 1.64862060546875, 2.9288454055786133, 1.0393569469451904, 0.7491000890731812, 0.32726752758026123, 1.460107445716858], "mean_td_error": 1.829850673675537, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 27.0, "diff_num_grad_updates_vs_sampler_policy": 26.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.081655502319336, "actor_loss": -4.604796886444092, "critic_loss": 0.6310872435569763, "alpha_loss": -0.07870142161846161, "alpha_value": 0.9922239780426025, "log_alpha_value": -0.007806398905813694, "target_entropy": -6.0, "policy_t": 0.006065935827791691, "mean_q": 0.5632734298706055, "max_q": 4.894013404846191, "min_q": 0.4646914005279541}, "td_error": [2.1509904861450195, 1.1688427925109863, 3.2345519065856934, 2.785630226135254, 2.095506191253662, 3.1888394355773926, 2.826655387878418, 2.873357057571411, 2.390176296234131, 0.27934640645980835, 3.1919748783111572, 1.7240920066833496, 2.639739990234375, 2.7174010276794434, 0.11242081224918365, 1.9359369277954102, 3.4009718894958496, 2.0644941329956055, 1.2480987310409546, 2.1261253356933594, 1.549251675605774, 0.23866477608680725, 1.5698463916778564, 1.3236693143844604, 2.5233492851257324, 0.6199371814727783, 2.729340076446533, 2.649357318878174, 1.1342487335205078, 2.631723642349243, 1.91810941696167, 1.4955742359161377, 2.718303680419922, 1.915458083152771, 1.4901535511016846, 2.8433074951171875, 1.6622352600097656, 2.2917277812957764, 2.933039903640747, 1.6479389667510986, 2.188798427581787, 2.788361072540283, 1.6010493040084839, 0.9875929355621338, 0.41460174322128296, 3.5496087074279785, 1.5480879545211792, 3.3111019134521484, 2.6477813720703125, 2.4404070377349854, 1.857591152191162, 0.9122939109802246, 1.701615571975708, 0.07391832768917084, 2.521338701248169, 1.0309116840362549, 2.6650307178497314, 2.27978515625, 2.923252582550049, 0.24906617403030396, 2.8576254844665527, 2.808563470840454, 2.9889607429504395, 2.188014268875122, 2.7578201293945312, 1.1520020961761475, 3.081963062286377, 3.4843268394470215, 1.95717191696167, 2.7898759841918945, 0.7743897438049316, 2.3119571208953857, 1.341963768005371, 1.7838311195373535, 1.3275517225265503, 2.7899036407470703, 2.707007884979248, 1.2727893590927124, 1.4421288967132568, 2.906926155090332, 2.274449110031128, 1.9263410568237305, 0.2858923673629761, 0.9970645904541016, 0.590133786201477, 2.2770297527313232], "mean_td_error": 2.0093984603881836, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 27.0, "diff_num_grad_updates_vs_sampler_policy": 26.0}}, "num_env_steps_sampled": 25088, "num_env_steps_trained": 6966, "num_agent_steps_sampled": 75264, "num_agent_steps_trained": 6966, "last_target_update_ts": 25088, "num_target_updates": 27}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 75264, "num_agent_steps_trained": 6966, "num_env_steps_sampled": 25088, "num_env_steps_trained": 6966, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 936.9551990829144, "num_env_steps_trained_throughput_per_sec": 269.79290330735705, "timesteps_total": 25088, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 75264, "timers": {"training_iteration_time_ms": 976.183, "sample_time_ms": 680.278, "load_time_ms": 0.323, "load_throughput": 799564.38, "learn_time_ms": 18.478, "learn_throughput": 13962.523, "synch_weights_time_ms": 10.46}, "counters": {"num_env_steps_sampled": 25088, "num_env_steps_trained": 6966, "num_agent_steps_sampled": 75264, "num_agent_steps_trained": 6966, "last_target_update_ts": 25088, "num_target_updates": 27}, "done": false, "episodes_total": 0, "training_iteration": 18, "trial_id": "ff3c2_00000", "date": "2023-11-18_21-11-22", "timestamp": 1700370682, "time_this_iter_s": 1.9226789474487305, "time_total_s": 27.467769622802734, "pid": 7608, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17c175440>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 27.467769622802734, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 61.23333333333333, "ram_util_percent": 65.10000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.110506057739258, "actor_loss": -4.879597187042236, "critic_loss": 2.1253604888916016, "alpha_loss": -0.08495327830314636, "alpha_value": 0.9916326999664307, "log_alpha_value": -0.008402475155889988, "target_entropy": -6.0, "policy_t": 0.0016953044105321169, "mean_q": 1.1896069049835205, "max_q": 9.625480651855469, "min_q": 0.6908213496208191}, "td_error": [2.4319558143615723, 3.187286376953125, 4.696597099304199, 4.664488315582275, 2.9844682216644287, 4.8417510986328125, 3.408064603805542, 4.229351997375488, 4.129299640655518, 6.9696149826049805, 4.035255432128906, 4.396634101867676, 4.149770736694336, 3.693695545196533, 3.2187743186950684, 1.5254318714141846, 3.750551462173462, 1.0640318393707275, 2.955235481262207, 4.495607376098633, 3.357926845550537, 6.1779913902282715, 2.7351198196411133, 0.3453693389892578, 5.619826316833496, 4.976329803466797, 3.6049728393554688, 8.449110984802246, 3.0724706649780273, 5.209474563598633, 4.2560272216796875, 2.885319709777832, 1.8303394317626953, 4.017358779907227, 5.960975646972656, 3.7646827697753906, 4.13997745513916, 3.7964978218078613, 4.627092361450195, 2.892537832260132, 1.8828253746032715, 3.599919557571411, 4.945899963378906, 4.107151031494141, 4.1184587478637695, 4.983314514160156, 4.396480560302734, 1.2244446277618408, 4.466150283813477, 4.630926132202148, 2.8412747383117676, 0.7757885456085205, 5.250800609588623, 4.358162879943848, 5.004534721374512, 6.0188093185424805, 3.1307907104492188, 1.6998618841171265, 3.4013118743896484, 5.248651504516602, 0.8908700942993164, 3.3373515605926514, 4.937553882598877, 3.3317909240722656, 3.149289131164551, 3.4458515644073486, 4.978372573852539, 3.329045295715332, 5.248837471008301, 3.026700973510742, 4.2639946937561035, 4.667233467102051, 0.9892681837081909, 5.535343170166016, 2.5941083431243896, 3.691040515899658, 4.166769027709961, 2.0414764881134033, 2.998767375946045, 2.9606997966766357, 4.496037483215332, 3.772840738296509, 5.053459167480469, 3.453685760498047, 2.193384885787964, 4.341895580291748], "mean_td_error": 3.785215139389038, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 29.0, "diff_num_grad_updates_vs_sampler_policy": 28.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.090158462524414, "actor_loss": -4.81953763961792, "critic_loss": 0.36462336778640747, "alpha_loss": -0.08485613018274307, "alpha_value": 0.9916254878044128, "log_alpha_value": -0.008409791626036167, "target_entropy": -6.0, "policy_t": -0.07756644487380981, "mean_q": 0.9775590300559998, "max_q": 5.760059833526611, "min_q": 0.7120869755744934}, "td_error": [2.712754964828491, 1.6181573867797852, 2.5767605304718018, 0.9351131319999695, 3.146456718444824, 1.8797968626022339, 1.9756999015808105, 3.774501323699951, 1.9704784154891968, 0.6965265274047852, 2.8294460773468018, 0.8555784225463867, 1.0230296850204468, 2.800949811935425, 2.879660129547119, 2.3229618072509766, 0.6438310146331787, 1.2504746913909912, 1.3852283954620361, 0.3265657126903534, 3.21368408203125, 2.602336883544922, 1.8431074619293213, 2.885864734649658, 2.3098435401916504, 2.6245193481445312, 2.569535732269287, 2.904097080230713, 2.7496023178100586, 1.9037394523620605, 0.301666259765625, 0.9149718284606934, 2.2112820148468018, 2.9846346378326416, 2.3644113540649414, 2.9501538276672363, 1.7846062183380127, 2.34782075881958, 3.149135112762451, 3.472773551940918, 1.309445858001709, 2.1164603233337402, 3.1704721450805664, 3.319838523864746, 1.7404589653015137, 2.2219443321228027, 2.6661791801452637, 2.238581657409668, 2.417469024658203, 2.5475754737854004, 3.1289680004119873, 1.4585456848144531, 1.952111840248108, 2.4700357913970947, 2.4410197734832764, 1.9506044387817383, 2.6949243545532227, 0.10079589486122131, 2.843477964401245, 2.651218891143799, 1.8369004726409912, 0.8998332023620605, 0.2021620273590088, 0.31492340564727783, 2.1620919704437256, 1.008175253868103, 1.4262559413909912, 1.0262082815170288, 2.4288439750671387, 2.270486354827881, 2.9500536918640137, 0.2712186872959137, 0.07279914617538452, 0.8439204692840576, 4.060037612915039, 4.161764144897461, 3.0051631927490234, 2.7467169761657715, 1.5606470108032227, 1.2908754348754883, 0.9868232607841492, 1.6718871593475342, 1.6103289127349854, 0.28584790229797363, 0.844353199005127, 1.7719250917434692], "mean_td_error": 2.0097920894622803, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 29.0, "diff_num_grad_updates_vs_sampler_policy": 28.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.183246612548828, "actor_loss": -4.763463973999023, "critic_loss": 0.5998981595039368, "alpha_loss": -0.08560995757579803, "alpha_value": 0.9916282892227173, "log_alpha_value": -0.00840694084763527, "target_entropy": -6.0, "policy_t": -0.032312843948602676, "mean_q": 0.6067684888839722, "max_q": 3.4455161094665527, "min_q": 0.5344120264053345}, "td_error": [1.921036720275879, 1.2192339897155762, 0.8929718732833862, 3.083448648452759, 0.07516670227050781, 3.00376296043396, 0.6650101542472839, 2.966874122619629, 2.5999722480773926, 2.8915693759918213, 2.117326498031616, 3.265444278717041, 2.966064691543579, 1.2281577587127686, 2.2714362144470215, 1.9801416397094727, 3.237074613571167, 0.043812841176986694, 1.3941221237182617, 1.748927116394043, 2.259214401245117, 0.21667790412902832, 2.307610034942627, 2.7468204498291016, 2.7774553298950195, 1.0287169218063354, 2.5429086685180664, 1.5132243633270264, 2.7908599376678467, 2.9351119995117188, 2.3439536094665527, 0.2564604580402374, 3.7308194637298584, 0.9740952253341675, 2.617064952850342, 1.1387238502502441, 0.7589604258537292, 2.4074230194091797, 0.1162278950214386, 0.6178742051124573, 1.1446092128753662, 2.4693684577941895, 2.671290397644043, 1.3621129989624023, 3.729938507080078, 2.239323139190674, 0.46505874395370483, 2.2044973373413086, 0.9122610688209534, 1.2040998935699463, 2.2025504112243652, 1.7839150428771973, 2.595574140548706, 2.673450231552124, 3.6350810527801514, 0.8326765298843384, 0.04386475682258606, 1.4329097270965576, 0.33283114433288574, 4.744841575622559, 2.629556894302368, 1.127588152885437, 1.5619736909866333, 2.3362512588500977, 0.2557260990142822, 1.1159921884536743, 2.250250816345215, 1.5918464660644531, 0.3506361246109009, 3.1067709922790527, 4.801608085632324, 2.2587332725524902, 0.41429585218429565, 1.1957385540008545, 1.4891438484191895, 1.7218642234802246, 4.0242204666137695, 1.6181679964065552, 2.0597543716430664, 2.0595450401306152, 2.6372694969177246, 0.8863162994384766, 0.11472415924072266, 2.74172306060791, 1.0778576135635376, 1.9212427139282227], "mean_td_error": 1.8800092935562134, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 29.0, "diff_num_grad_updates_vs_sampler_policy": 28.0}}, "num_env_steps_sampled": 26880, "num_env_steps_trained": 7482, "num_agent_steps_sampled": 80640, "num_agent_steps_trained": 7482, "last_target_update_ts": 26880, "num_target_updates": 29}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80640, "num_agent_steps_trained": 7482, "num_env_steps_sampled": 26880, "num_env_steps_trained": 7482, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 916.9278979625473, "num_env_steps_trained_throughput_per_sec": 264.02611347582274, "timesteps_total": 26880, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 80640, "timers": {"training_iteration_time_ms": 968.95, "sample_time_ms": 672.983, "load_time_ms": 0.32, "load_throughput": 805876.104, "learn_time_ms": 18.366, "learn_throughput": 14047.549, "synch_weights_time_ms": 10.398}, "counters": {"num_env_steps_sampled": 26880, "num_env_steps_trained": 7482, "num_agent_steps_sampled": 80640, "num_agent_steps_trained": 7482, "last_target_update_ts": 26880, "num_target_updates": 29}, "done": false, "episodes_total": 0, "training_iteration": 19, "trial_id": "ff3c2_00000", "date": "2023-11-18_21-11-24", "timestamp": 1700370684, "time_this_iter_s": 1.9624292850494385, "time_total_s": 29.430198907852173, "pid": 7608, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17e264540>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 29.430198907852173, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 65.33333333333333, "ram_util_percent": 65.26666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.067584991455078, "actor_loss": -4.921664714813232, "critic_loss": 2.1351027488708496, "alpha_loss": -0.09063724428415298, "alpha_value": 0.9910375475883484, "log_alpha_value": -0.00900287739932537, "target_entropy": -6.0, "policy_t": -0.03232329338788986, "mean_q": 1.14530611038208, "max_q": 9.9140625, "min_q": 0.7726225852966309}, "td_error": [6.655597686767578, 2.8627123832702637, 3.1605513095855713, 1.7074098587036133, 3.1942245960235596, 2.5171432495117188, 4.77828311920166, 3.9803147315979004, 5.35154914855957, 4.331286430358887, 4.68389892578125, 3.757075309753418, 5.572386741638184, 3.82023286819458, 3.8504905700683594, 1.6860711574554443, 2.689512252807617, 4.473870277404785, 4.790241241455078, 3.803619861602783, 4.518583297729492, 3.7176451683044434, 2.273179531097412, 5.577101707458496, 4.3210601806640625, 2.243234872817993, 4.3419904708862305, 4.953717231750488, 3.20778751373291, 3.5003280639648438, 3.6982390880584717, 3.6205103397369385, 3.189582109451294, 4.044844627380371, 4.20811128616333, 3.2398149967193604, 3.3925998210906982, 3.163120746612549, 2.8604352474212646, 3.5611348152160645, 5.012351036071777, 6.474879264831543, 2.2290053367614746, 3.9976577758789062, 4.207989692687988, 4.2867112159729, 5.140147686004639, 3.448636054992676, 1.6757256984710693, 3.667200803756714, 4.683608055114746, 3.814573049545288, 3.3722383975982666, 3.103484630584717, 4.555157661437988, 3.9383649826049805, 3.4346563816070557, 5.374481201171875, 4.543485641479492, 4.3075642585754395, 4.640108108520508, 3.556307792663574, 3.828416585922241, 5.190342903137207, 4.654711723327637, 0.7992348670959473, 3.039193630218506, 3.841459274291992, 2.444460868835449, 2.954429864883423, 2.611478567123413, 5.4037251472473145, 4.475041389465332, 3.673600673675537, 4.413812637329102, 4.661115646362305, 5.11694860458374, 5.0945234298706055, 4.291263580322266, 4.285819053649902, 3.728149890899658, 4.436023712158203, 2.4745655059814453, 1.9677631855010986, 4.084502696990967, 2.9030494689941406], "mean_td_error": 3.850435495376587, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 31.0, "diff_num_grad_updates_vs_sampler_policy": 30.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.117982864379883, "actor_loss": -4.935177803039551, "critic_loss": 0.33484339714050293, "alpha_loss": -0.09117018431425095, "alpha_value": 0.9910297393798828, "log_alpha_value": -0.009010707028210163, "target_entropy": -6.0, "policy_t": -0.026344776153564453, "mean_q": 0.9530196189880371, "max_q": 6.347556114196777, "min_q": 0.8026991486549377}, "td_error": [0.7496304512023926, 1.5485572814941406, 0.3234201669692993, 3.7424769401550293, 3.009995937347412, 2.785444736480713, 1.6712725162506104, 1.9897334575653076, 2.095738649368286, 1.6912996768951416, 3.4726169109344482, 2.1445343494415283, 1.1011321544647217, 2.4873287677764893, 1.209889531135559, 3.396141529083252, 1.9857077598571777, 0.6851874589920044, 2.12454891204834, 1.9015543460845947, 0.35483261942863464, 1.5803139209747314, 2.029965400695801, 0.9195740222930908, 1.5260367393493652, 2.5752553939819336, 2.5550384521484375, 1.448402762413025, 1.8029155731201172, 0.5768014192581177, 3.4848337173461914, 0.02069246768951416, 2.0824294090270996, 0.9583209753036499, 1.0846022367477417, 2.051494598388672, 2.128854990005493, 1.709087610244751, 1.9016319513320923, 1.314706563949585, 1.1668733358383179, 1.9106650352478027, 1.237839698791504, 2.810433864593506, 3.3571324348449707, 1.5217900276184082, 0.46867042779922485, 3.208277702331543, 4.606549263000488, 1.6402239799499512, 2.771127223968506, 1.6926355361938477, 0.9584254026412964, 4.592149257659912, 3.3208117485046387, 1.2491141557693481, 1.0191450119018555, 0.32528942823410034, 0.6817727088928223, 2.1141932010650635, 3.619951009750366, 3.268853187561035, 3.8294143676757812, 3.5584850311279297, 3.5299324989318848, 1.6904923915863037, 2.525418281555176, 1.8483667373657227, 2.7149312496185303, 2.633476734161377, 0.841161847114563, 0.39771777391433716, 2.1676855087280273, 2.280059814453125, 0.6820777654647827, 1.8780124187469482, 1.2673577070236206, 1.0170385837554932, 1.5416197776794434, 1.5324089527130127, 1.517629861831665, 3.374851703643799, 1.7365961074829102, 0.5063109397888184, 3.9650707244873047, 1.9433634281158447], "mean_td_error": 1.9621326923370361, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 31.0, "diff_num_grad_updates_vs_sampler_policy": 30.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.088114738464355, "actor_loss": -4.761667728424072, "critic_loss": 0.737898051738739, "alpha_loss": -0.09087168425321579, "alpha_value": 0.9910326600074768, "log_alpha_value": -0.00900779664516449, "target_entropy": -6.0, "policy_t": -0.01507606077939272, "mean_q": 0.8150650858879089, "max_q": 6.310894966125488, "min_q": 0.6092300415039062}, "td_error": [3.6462366580963135, 2.7829830646514893, 1.1380805969238281, 1.445238709449768, 3.2180774211883545, 3.810401201248169, 4.071766376495361, 3.1033596992492676, 0.36013156175613403, 3.014415979385376, 3.2635343074798584, 4.144659996032715, 2.3228347301483154, 2.0764598846435547, 2.7370147705078125, 2.9428443908691406, 1.5430467128753662, 0.8132081031799316, 3.20721435546875, 1.0664055347442627, 1.0529918670654297, 2.064260721206665, 3.020486354827881, 1.2063896656036377, 2.0545287132263184, 1.655203104019165, 0.7817596197128296, 2.7034504413604736, 2.092195987701416, 3.9281508922576904, 0.08515021204948425, 3.070899248123169, 2.6926302909851074, 2.016347885131836, 1.190293312072754, 1.411684274673462, 2.698641300201416, 1.2165379524230957, 1.6519237756729126, 1.6699597835540771, 1.6439995765686035, 4.030485153198242, 1.813403606414795, 3.286210536956787, 1.7068099975585938, 2.0674233436584473, 2.8192691802978516, 4.446625232696533, 1.894880771636963, 2.8978660106658936, 1.8751014471054077, 1.2150630950927734, 3.0945334434509277, 2.3532938957214355, 1.7712197303771973, 2.704174041748047, 1.1848289966583252, 2.623884677886963, 3.855745315551758, 1.359372854232788, 3.0398216247558594, 1.0810630321502686, 3.6739144325256348, 1.4221129417419434, 3.4069676399230957, 2.29103422164917, 0.2822269797325134, 1.6606042385101318, 1.836779236793518, 3.687445640563965, 1.9655579328536987, 3.7740283012390137, 2.8302760124206543, 1.4171879291534424, 3.008408784866333, 1.7404699325561523, 0.9934054613113403, 3.247924327850342, 2.0830612182617188, 1.4263246059417725, 2.5754830837249756, 2.2974963188171387, 1.8637056350708008, 3.1131489276885986, 4.475847244262695, 1.8434128761291504], "mean_td_error": 2.309922218322754, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 31.0, "diff_num_grad_updates_vs_sampler_policy": 30.0}}, "num_env_steps_sampled": 28672, "num_env_steps_trained": 7998, "num_agent_steps_sampled": 86016, "num_agent_steps_trained": 7998, "last_target_update_ts": 28672, "num_target_updates": 31}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 86016, "num_agent_steps_trained": 7998, "num_env_steps_sampled": 28672, "num_env_steps_trained": 7998, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 993.2103429712084, "num_env_steps_trained_throughput_per_sec": 285.99137107876317, "timesteps_total": 28672, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 86016, "timers": {"training_iteration_time_ms": 958.598, "sample_time_ms": 661.669, "load_time_ms": 0.319, "load_throughput": 807861.465, "learn_time_ms": 18.384, "learn_throughput": 14034.158, "synch_weights_time_ms": 10.429}, "counters": {"num_env_steps_sampled": 28672, "num_env_steps_trained": 7998, "num_agent_steps_sampled": 86016, "num_agent_steps_trained": 7998, "last_target_update_ts": 28672, "num_target_updates": 31}, "done": false, "episodes_total": 0, "training_iteration": 20, "trial_id": "ff3c2_00000", "date": "2023-11-18_21-11-26", "timestamp": 1700370686, "time_this_iter_s": 1.8132121562957764, "time_total_s": 31.24341106414795, "pid": 7608, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17e265a80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 31.24341106414795, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 69.7, "ram_util_percent": 65.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.067875862121582, "actor_loss": -5.02009916305542, "critic_loss": 1.5463404655456543, "alpha_loss": -0.09668388962745667, "alpha_value": 0.9904427528381348, "log_alpha_value": -0.009603206999599934, "target_entropy": -6.0, "policy_t": 0.02386104129254818, "mean_q": 1.4477671384811401, "max_q": 10.077491760253906, "min_q": 0.8588332533836365}, "td_error": [2.8620898723602295, 3.286134719848633, 2.1046199798583984, 3.853532075881958, 2.169086456298828, 4.006711006164551, 4.128117561340332, 4.007854461669922, 3.0938682556152344, 3.0294203758239746, 3.3621509075164795, 0.07840120792388916, 4.190525054931641, 3.761519432067871, 2.9987616539001465, 2.856564521789551, 4.995347023010254, 5.168391704559326, 4.0774970054626465, 2.737292766571045, 3.5193662643432617, 3.5572586059570312, 3.9453601837158203, 4.836151123046875, 3.0374674797058105, 1.6591200828552246, 2.8096375465393066, 2.024379253387451, 3.406644344329834, 3.2988533973693848, 3.934260845184326, 3.368727207183838, 0.8117938041687012, 4.364502906799316, 3.8967339992523193, 4.362901210784912, 3.7099180221557617, 1.3331151008605957, 3.090222120285034, 3.826232433319092, 3.6778924465179443, 4.503589630126953, 5.096985816955566, 1.2961139678955078, 3.2893333435058594, 3.028174877166748, 2.2906293869018555, 2.9042792320251465, 0.12699294090270996, 4.280261039733887, 4.182524681091309, 2.99796724319458, 4.718356132507324, 3.8298375606536865, 3.1355390548706055, 0.12696528434753418, 3.811189651489258, 2.1814780235290527, 2.366831064224243, 3.7166881561279297, 2.7209219932556152, 2.8615899085998535, 3.631837844848633, 4.775460720062256, 0.24743163585662842, 4.907846450805664, 0.9400341510772705, 3.381826639175415, 3.265277862548828, 3.2871556282043457, 3.9332919120788574, 4.115757465362549, 5.926088333129883, 2.396231174468994, 2.1958656311035156, 3.2109594345092773, 5.445076942443848, 3.861154556274414, 2.085225820541382, 1.8514047861099243, 5.103928565979004, 3.5845389366149902, 4.067783832550049, 2.5681936740875244, 4.383023262023926, 4.252052307128906], "mean_td_error": 3.280489921569824, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 33.0, "diff_num_grad_updates_vs_sampler_policy": 32.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.169999122619629, "actor_loss": -5.079894542694092, "critic_loss": 0.336125910282135, "alpha_loss": -0.09774953126907349, "alpha_value": 0.990434467792511, "log_alpha_value": -0.009611557237803936, "target_entropy": -6.0, "policy_t": 0.03911188244819641, "mean_q": 1.0300493240356445, "max_q": 5.8100810050964355, "min_q": 0.9001203775405884}, "td_error": [1.775011658668518, 1.657010793685913, 2.359400510787964, 3.5668935775756836, 0.9957164525985718, 2.111555337905884, 1.687751054763794, 1.84259033203125, 0.6845433712005615, 3.844852924346924, 2.833649158477783, 0.37481021881103516, 2.5710830688476562, 1.966062068939209, 1.6131205558776855, 2.243617296218872, 1.028586506843567, 1.6974334716796875, 2.4374780654907227, 0.8374882340431213, 1.7123711109161377, 1.7413368225097656, 2.411987781524658, 1.7231035232543945, 3.247072219848633, 1.5394811630249023, 2.004411220550537, 3.323397636413574, 3.829054832458496, 2.215433120727539, 3.2930662631988525, 2.295279026031494, 0.37516605854034424, 2.1753287315368652, 0.5700795650482178, 2.3189961910247803, 1.5949184894561768, 2.676586866378784, 1.1638174057006836, 2.9748833179473877, 2.4973464012145996, 1.5775763988494873, 2.0301666259765625, 1.8097681999206543, 1.8656468391418457, 0.8261087536811829, 1.5332555770874023, 2.2297563552856445, 1.4748766422271729, 2.324932098388672, 0.4572829604148865, 1.5981214046478271, 0.43958693742752075, 0.9354453086853027, 1.4319021701812744, 1.8701879978179932, 2.0730886459350586, 1.6811548471450806, 2.330767869949341, 1.3868075609207153, 4.0216875076293945, 1.7751085758209229, 2.129694938659668, 0.7593828439712524, 0.6877623200416565, 3.7969722747802734, 1.8443074226379395, 2.5652103424072266, 1.8962161540985107, 1.3470112085342407, 3.392770290374756, 2.6109862327575684, 1.6960012912750244, 2.702082633972168, 1.5569310188293457, 2.803128242492676, 1.941968560218811, 1.4699136018753052, 1.3345674276351929, 1.1070741415023804, 1.1407768726348877, 2.6130597591400146, 1.1943637132644653, 1.810882329940796, 0.22790491580963135, 4.490265846252441], "mean_td_error": 1.9372584819793701, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 33.0, "diff_num_grad_updates_vs_sampler_policy": 32.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.147628784179688, "actor_loss": -4.902615070343018, "critic_loss": 0.5726929903030396, "alpha_loss": -0.09750513732433319, "alpha_value": 0.9904373288154602, "log_alpha_value": -0.009608663618564606, "target_entropy": -6.0, "policy_t": 0.0030941066797822714, "mean_q": 0.8954508304595947, "max_q": 4.645539283752441, "min_q": 0.6883735656738281}, "td_error": [1.0909674167633057, 0.8126607537269592, 1.8044960498809814, 1.5014796257019043, 3.212700128555298, 1.4199161529541016, 2.18955659866333, 2.6350388526916504, 1.3805797100067139, 4.056299209594727, 1.4642400741577148, 2.9449987411499023, 3.0676965713500977, 3.5028181076049805, 0.07758128643035889, 0.0772911012172699, 1.3391658067703247, 2.9742026329040527, 2.1001110076904297, 1.865152359008789, 0.3783292770385742, 2.2985572814941406, 1.3631236553192139, 2.283543586730957, 3.713073253631592, 0.21805068850517273, 2.8748373985290527, 1.957421064376831, 0.05386808514595032, 2.620938777923584, 1.4534835815429688, 2.0147571563720703, 1.291078805923462, 2.351066827774048, 1.3591408729553223, 0.8304224014282227, 1.4528894424438477, 1.9580514430999756, 1.413921594619751, 1.708191156387329, 1.8176853656768799, 2.273744821548462, 1.8306069374084473, 1.4202247858047485, 1.52717924118042, 3.1646320819854736, 2.7904882431030273, 3.362257480621338, 1.6349374055862427, 2.3622355461120605, 2.132692337036133, 0.16603797674179077, 2.539645195007324, 2.9865641593933105, 2.6738696098327637, 1.096090316772461, 1.4588569402694702, 2.742154598236084, 1.7644755840301514, 2.3789520263671875, 0.45417776703834534, 1.5815353393554688, 1.0172483921051025, 2.8262274265289307, 1.300032377243042, 3.648690938949585, 0.10821431875228882, 1.490667462348938, 1.8144831657409668, 3.261232376098633, 2.57403302192688, 0.15291213989257812, 0.7163418531417847, 0.134660005569458, 1.8436030149459839, 2.4036409854888916, 2.5614776611328125, 0.7441062927246094, 0.938438355922699, 2.9149580001831055, 2.646728038787842, 2.2625975608825684, 1.625262975692749, 1.5171024799346924, 0.15274417400360107, 1.805055022239685], "mean_td_error": 1.8340836763381958, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 33.0, "diff_num_grad_updates_vs_sampler_policy": 32.0}}, "num_env_steps_sampled": 30464, "num_env_steps_trained": 8514, "num_agent_steps_sampled": 91392, "num_agent_steps_trained": 8514, "last_target_update_ts": 30464, "num_target_updates": 33}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 91392, "num_agent_steps_trained": 8514, "num_env_steps_sampled": 30464, "num_env_steps_trained": 8514, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 913.3518836062767, "num_env_steps_trained_throughput_per_sec": 262.9964129134145, "timesteps_total": 30464, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 91392, "timers": {"training_iteration_time_ms": 965.282, "sample_time_ms": 669.136, "load_time_ms": 0.311, "load_throughput": 828647.241, "learn_time_ms": 18.335, "learn_throughput": 14071.826, "synch_weights_time_ms": 10.128}, "counters": {"num_env_steps_sampled": 30464, "num_env_steps_trained": 8514, "num_agent_steps_sampled": 91392, "num_agent_steps_trained": 8514, "last_target_update_ts": 30464, "num_target_updates": 33}, "done": false, "episodes_total": 0, "training_iteration": 21, "trial_id": "ff3c2_00000", "date": "2023-11-18_21-11-28", "timestamp": 1700370688, "time_this_iter_s": 1.9722461700439453, "time_total_s": 33.215657234191895, "pid": 7608, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17c1aaf20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 33.215657234191895, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 69.89999999999999, "ram_util_percent": 64.89999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.09286880493164, "actor_loss": -5.138433933258057, "critic_loss": 1.6244885921478271, "alpha_loss": -0.10298336297273636, "alpha_value": 0.9898483157157898, "log_alpha_value": -0.01020357757806778, "target_entropy": -6.0, "policy_t": 0.04272947087883949, "mean_q": 1.3907519578933716, "max_q": 8.357933044433594, "min_q": 0.9472989439964294}, "td_error": [4.863975524902344, 1.9704444408416748, 3.6431615352630615, 1.387593388557434, 3.7022507190704346, 3.2094039916992188, 2.822516679763794, 4.58720064163208, 4.2778000831604, 3.8478922843933105, 4.052604675292969, 4.631175994873047, 4.5622663497924805, 5.083019256591797, 3.7492940425872803, 3.625486135482788, 2.076631784439087, 3.408473014831543, 5.985011100769043, 2.5610852241516113, 2.881117343902588, 3.8146772384643555, 0.4862423241138458, 5.372915267944336, 4.715803146362305, 3.5676417350769043, 5.003478050231934, 3.544839382171631, 3.788628101348877, 3.404324531555176, 2.908862829208374, 7.304629325866699, 5.88096809387207, 4.748488426208496, 3.2771377563476562, 3.2858667373657227, 3.3160696029663086, 2.754528284072876, 4.528677940368652, 6.591739654541016, 1.2428743839263916, 5.362136363983154, 2.5734200477600098, 4.068391799926758, 2.9394068717956543, 4.043918609619141, 3.3891549110412598, 2.962188243865967, 3.0978951454162598, 2.7866921424865723, 1.9889360666275024, 3.6588633060455322, 3.7967562675476074, 2.862168788909912, 4.504508018493652, 3.4991679191589355, 4.455674171447754, 4.451577186584473, 4.981479644775391, 4.272137641906738, 2.705265522003174, 2.4395251274108887, 6.020754337310791, 6.3098859786987305, 5.100221633911133, 4.520742416381836, 3.4136979579925537, 3.3136353492736816, 4.716221809387207, 1.1289632320404053, 4.0341386795043945, 2.8489632606506348, 2.2255983352661133, 0.4593546390533447, 3.0496230125427246, 2.495396137237549, 1.5828555822372437, 4.1048736572265625, 2.3737359046936035, 2.194340229034424, 3.2014665603637695, 2.4421424865722656, 3.9370369911193848, 3.4395694732666016, 5.1021904945373535, 0.2857999801635742], "mean_td_error": 3.6000847816467285, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 35.0, "diff_num_grad_updates_vs_sampler_policy": 34.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0849027633667, "actor_loss": -5.110179901123047, "critic_loss": 0.3067049980163574, "alpha_loss": -0.10299214720726013, "alpha_value": 0.9898394346237183, "log_alpha_value": -0.010212508030235767, "target_entropy": -6.0, "policy_t": -0.0026879352517426014, "mean_q": 1.2634782791137695, "max_q": 6.363131046295166, "min_q": 1.0070174932479858}, "td_error": [4.032732963562012, 1.250612735748291, 1.5814276933670044, 4.192133903503418, 2.1742067337036133, 0.032953083515167236, 2.821373462677002, 0.6775028705596924, 2.6478681564331055, 1.767611026763916, 1.8661532402038574, 2.628188371658325, 1.904126524925232, 0.503882884979248, 3.8540494441986084, 2.1158766746520996, 0.7411905527114868, 1.5008020401000977, 0.6153958439826965, 2.3243329524993896, 0.7761374115943909, 0.014624178409576416, 2.30808687210083, 1.6831119060516357, 1.04777193069458, 0.3175812363624573, 1.3209999799728394, 0.5709307789802551, 2.329561471939087, 0.21134346723556519, 4.121099948883057, 0.9516421556472778, 1.8272385597229004, 2.7485742568969727, 1.4743680953979492, 2.8293046951293945, 3.6207571029663086, 0.6564697027206421, 3.0636422634124756, 0.4312179684638977, 2.1468865871429443, 0.6934536695480347, 0.7699812054634094, 0.9741454124450684, 2.4460437297821045, 1.011133074760437, 1.1355030536651611, 0.9858220219612122, 1.0902423858642578, 1.6112924814224243, 1.1791778802871704, 1.3996309041976929, 3.8250651359558105, 2.882728338241577, 2.464486598968506, 1.7728333473205566, 0.9898722767829895, 1.5653995275497437, 1.878772258758545, 3.0995535850524902, 1.670213222503662, 1.2903257608413696, 1.1823842525482178, 3.6332359313964844, 1.3935892581939697, 1.7510676383972168, 1.1042174100875854, 0.6176506280899048, 2.3401150703430176, 3.787407398223877, 2.4497861862182617, 3.111499547958374, 1.4487065076828003, 1.606642246246338, 1.526134967803955, 1.1368242502212524, 0.6184952855110168, 3.552539348602295, 1.9117653369903564, 1.1815776824951172, 1.3501925468444824, 1.5061923265457153, 1.5425057411193848, 1.890699028968811, 0.15389269590377808, 1.9125957489013672], "mean_td_error": 1.757315754890442, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 35.0, "diff_num_grad_updates_vs_sampler_policy": 34.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.17271614074707, "actor_loss": -5.012985706329346, "critic_loss": 0.5871560573577881, "alpha_loss": -0.10386006534099579, "alpha_value": 0.9898422956466675, "log_alpha_value": -0.01020966935902834, "target_entropy": -6.0, "policy_t": -0.03630854934453964, "mean_q": 0.9765040278434753, "max_q": 5.809444904327393, "min_q": 0.7764239311218262}, "td_error": [2.818045139312744, 1.7347265481948853, 0.746888279914856, 1.3959836959838867, 0.07588571310043335, 2.932187557220459, 1.5750538110733032, 4.277838230133057, 1.955845594406128, 2.7387332916259766, 5.2040863037109375, 1.317016363143921, 1.0659533739089966, 2.6753358840942383, 1.9229047298431396, 2.147463798522949, 2.4910178184509277, 4.481582164764404, 2.682583808898926, 2.5162243843078613, 2.3093597888946533, 1.0775089263916016, 0.3544326722621918, 2.4210188388824463, 3.7047386169433594, 3.6498219966888428, 0.05808877944946289, 1.868363380432129, 0.6173971891403198, 1.125425100326538, 1.5275013446807861, 0.410685658454895, 2.4127655029296875, 1.9643508195877075, 0.47432941198349, 1.4788583517074585, 2.2945799827575684, 3.362335205078125, 0.7076913118362427, 1.0802077054977417, 1.8813837766647339, 3.304647445678711, 0.2199687957763672, 1.1129497289657593, 3.415416717529297, 2.9002747535705566, 1.8370027542114258, 3.7605955600738525, 1.5755014419555664, 1.5941612720489502, 0.058702558279037476, 4.964681625366211, 4.054391860961914, 2.1104235649108887, 3.293243885040283, 2.5454211235046387, 2.4090731143951416, 1.2029097080230713, 2.3514437675476074, 0.8671063184738159, 2.8857333660125732, 0.9022003412246704, 0.07348960638046265, 0.28233182430267334, 2.353426218032837, 1.158604383468628, 1.9568212032318115, 2.0249085426330566, 0.612307071685791, 0.7426352500915527, 1.8953747749328613, 1.0050263404846191, 1.419623613357544, 2.8498587608337402, 3.406269073486328, 1.1527297496795654, 2.7326176166534424, 1.1839418411254883, 0.6331279277801514, 1.9798572063446045, 0.05772027373313904, 1.824767827987671, 0.8985363841056824, 0.7393916845321655, 0.6470849514007568, 1.8546297550201416], "mean_td_error": 1.8882224559783936, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 35.0, "diff_num_grad_updates_vs_sampler_policy": 34.0}}, "num_env_steps_sampled": 32256, "num_env_steps_trained": 9030, "num_agent_steps_sampled": 96768, "num_agent_steps_trained": 9030, "last_target_update_ts": 32256, "num_target_updates": 35}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96768, "num_agent_steps_trained": 9030, "num_env_steps_sampled": 32256, "num_env_steps_trained": 9030, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 977.4156923211766, "num_env_steps_trained_throughput_per_sec": 281.4433578335531, "timesteps_total": 32256, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 96768, "timers": {"training_iteration_time_ms": 946.639, "sample_time_ms": 669.628, "load_time_ms": 0.31, "load_throughput": 832664.229, "learn_time_ms": 18.411, "learn_throughput": 14012.986, "synch_weights_time_ms": 9.879}, "counters": {"num_env_steps_sampled": 32256, "num_env_steps_trained": 9030, "num_agent_steps_sampled": 96768, "num_agent_steps_trained": 9030, "last_target_update_ts": 32256, "num_target_updates": 35}, "done": false, "episodes_total": 0, "training_iteration": 22, "trial_id": "ff3c2_00000", "date": "2023-11-18_21-11-30", "timestamp": 1700370690, "time_this_iter_s": 1.8427820205688477, "time_total_s": 35.05843925476074, "pid": 7608, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17c1aaca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 35.05843925476074, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 67.89999999999999, "ram_util_percent": 64.66666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.084301948547363, "actor_loss": -5.217029094696045, "critic_loss": 1.5231266021728516, "alpha_loss": -0.10895133763551712, "alpha_value": 0.9892541170120239, "log_alpha_value": -0.010804053395986557, "target_entropy": -6.0, "policy_t": 0.07256026566028595, "mean_q": 1.756085753440857, "max_q": 10.070253372192383, "min_q": 1.0372220277786255}, "td_error": [4.2607622146606445, 3.2002387046813965, 3.482851028442383, 3.8251752853393555, 4.036322116851807, 1.8081464767456055, 5.549018859863281, 4.988430023193359, 1.2829413414001465, 0.15326714515686035, 0.694475531578064, 3.861922264099121, 4.254636764526367, 3.8035149574279785, 3.7742536067962646, 2.0874810218811035, 3.3181209564208984, 2.60648775100708, 3.223752021789551, 2.161886215209961, 2.863574981689453, 3.5174479484558105, 4.829798221588135, 2.5229880809783936, 3.787656307220459, 2.930335760116577, 3.267052412033081, 1.5935211181640625, 1.004490852355957, 4.378424167633057, 1.3562214374542236, 4.400282382965088, 3.3945610523223877, 6.772546768188477, 5.561530590057373, 1.8175872564315796, 2.4988481998443604, 4.726480484008789, 4.564231872558594, 3.7376580238342285, 5.315315246582031, 1.4006924629211426, 1.9634076356887817, 2.296518087387085, 2.2304162979125977, 5.156904220581055, 2.116208791732788, 5.32569694519043, 2.002260684967041, 2.8220977783203125, 5.753010272979736, 4.729104995727539, 4.888277530670166, 2.306464195251465, 3.7182486057281494, 4.568412780761719, 2.7532196044921875, 0.7650127410888672, 3.9491355419158936, 2.441145420074463, 1.7436542510986328, 3.7699954509735107, 4.7482194900512695, 3.8790931701660156, 0.8249831199645996, 3.496636390686035, 3.4101943969726562, 4.453114986419678, 4.1993727684021, 3.1496028900146484, 5.750916481018066, 2.383016586303711, 3.2045347690582275, 3.320671319961548, 3.799879789352417, 5.838045597076416, 4.526233673095703, 3.304905652999878, 2.9296669960021973, 5.1027069091796875, 3.781651258468628, 5.040074348449707, 2.235029697418213, 5.029781341552734, 3.782705783843994, 5.892470359802246], "mean_td_error": 3.4650886058807373, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 37.0, "diff_num_grad_updates_vs_sampler_policy": 36.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.112678527832031, "actor_loss": -5.251016616821289, "critic_loss": 0.25651463866233826, "alpha_loss": -0.10935002565383911, "alpha_value": 0.9892451167106628, "log_alpha_value": -0.010813160799443722, "target_entropy": -6.0, "policy_t": 0.007411344908177853, "mean_q": 1.2744181156158447, "max_q": 5.794608116149902, "min_q": 1.1217656135559082}, "td_error": [2.861619472503662, 2.663565158843994, 2.3190383911132812, 1.1003162860870361, 2.9363718032836914, 0.15479683876037598, 0.37009721994400024, 1.625667691230774, 1.1205260753631592, 1.408428430557251, 2.2363433837890625, 0.9912543892860413, 2.576850175857544, 1.6486387252807617, 2.569719076156616, 1.2189059257507324, 0.5037850141525269, 1.224258303642273, 1.5571208000183105, 2.5868353843688965, 1.2091631889343262, 0.679079532623291, 3.4525959491729736, 0.15453284978866577, 0.7672678232192993, 1.0327014923095703, 1.2619556188583374, 1.937258005142212, 1.3070623874664307, 0.3771216869354248, 2.1525566577911377, 1.2357186079025269, 1.1058918237686157, 3.247225761413574, 1.3335514068603516, 1.3069639205932617, 1.541106104850769, 0.943543553352356, 0.6246553659439087, 2.237187385559082, 1.7149542570114136, 3.599684715270996, 1.4417328834533691, 2.004240036010742, 2.9901835918426514, 0.37278759479522705, 1.6892645359039307, 0.5116015672683716, 1.199345350265503, 0.14931362867355347, 1.620853066444397, 2.9543330669403076, 0.18856310844421387, 2.3750252723693848, 2.1734018325805664, 1.7529964447021484, 2.9392900466918945, 1.310652732849121, 0.24967354536056519, 2.4841670989990234, 2.4005956649780273, 2.5120716094970703, 0.7138469219207764, 0.8307167291641235, 0.6739791035652161, 0.7173431515693665, 3.6211230754852295, 0.7509828805923462, 0.37393563985824585, 0.05942213535308838, 0.6195250153541565, 2.9866533279418945, 3.2194013595581055, 0.7420718669891357, 1.0713832378387451, 1.9749747514724731, 1.7964571714401245, 2.470653533935547, 1.0313714742660522, 2.93387508392334, 2.5166475772857666, 1.5122878551483154, 2.9633467197418213, 1.2063610553741455, 2.6540021896362305, 0.8698235750198364], "mean_td_error": 1.6107697486877441, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 37.0, "diff_num_grad_updates_vs_sampler_policy": 36.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.12617301940918, "actor_loss": -5.067251682281494, "critic_loss": 0.5555301904678345, "alpha_loss": -0.10947193205356598, "alpha_value": 0.9892474412918091, "log_alpha_value": -0.010810790583491325, "target_entropy": -6.0, "policy_t": 0.029973706230521202, "mean_q": 1.0256565809249878, "max_q": 4.188852310180664, "min_q": 0.8708235621452332}, "td_error": [2.6203818321228027, 2.2073960304260254, 0.6887085437774658, 1.8636832237243652, 0.905347466468811, 1.755847692489624, 1.7940115928649902, 3.075190782546997, 0.44519296288490295, 0.22852492332458496, 2.1188554763793945, 2.144575357437134, 2.2444257736206055, 2.372265100479126, 1.5557355880737305, 2.035159111022949, 4.23602294921875, 1.5971567630767822, 0.06389987468719482, 1.3169834613800049, 1.8026058673858643, 0.06450223922729492, 2.1784472465515137, 2.726125717163086, 1.1512985229492188, 1.184262752532959, 3.794398307800293, 1.1174218654632568, 1.560983419418335, 2.2831602096557617, 2.399524688720703, 1.7041947841644287, 1.9285831451416016, 3.670098304748535, 2.790879964828491, 2.7262978553771973, 1.0287954807281494, 2.319580078125, 2.222292184829712, 0.873710572719574, 1.229929804801941, 0.46896588802337646, 0.6009373068809509, 1.5285454988479614, 1.1322901248931885, 3.319861650466919, 3.0721144676208496, 1.610223412513733, 3.419590950012207, 2.2801570892333984, 1.8058314323425293, 1.7738707065582275, 3.6327695846557617, 1.8325698375701904, 2.775371789932251, 0.8570675253868103, 2.620598793029785, 0.4228579103946686, 1.6187902688980103, 4.086905479431152, 1.7746129035949707, 0.19496870040893555, 1.0577359199523926, 0.6262645721435547, 2.7227861881256104, 1.3359845876693726, 0.837462306022644, 0.9339735507965088, 1.601534128189087, 2.3166098594665527, 0.5214787721633911, 2.2007761001586914, 0.9926552772521973, 1.3930516242980957, 4.369107246398926, 0.0999760627746582, 2.178349256515503, 1.8170024156570435, 2.874194383621216, 2.7949676513671875, 1.4931671619415283, 2.132351875305176, 1.4142041206359863, 0.21417221426963806, 0.8709025382995605, 1.6902104616165161], "mean_td_error": 1.8063286542892456, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 37.0, "diff_num_grad_updates_vs_sampler_policy": 36.0}}, "num_env_steps_sampled": 34048, "num_env_steps_trained": 9546, "num_agent_steps_sampled": 102144, "num_agent_steps_trained": 9546, "last_target_update_ts": 34048, "num_target_updates": 37}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 102144, "num_agent_steps_trained": 9546, "num_env_steps_sampled": 34048, "num_env_steps_trained": 9546, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 776.0811209066411, "num_env_steps_trained_throughput_per_sec": 223.46978704677835, "timesteps_total": 34048, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 102144, "timers": {"training_iteration_time_ms": 986.284, "sample_time_ms": 684.298, "load_time_ms": 0.308, "load_throughput": 838340.899, "learn_time_ms": 18.501, "learn_throughput": 13944.836, "synch_weights_time_ms": 9.926}, "counters": {"num_env_steps_sampled": 34048, "num_env_steps_trained": 9546, "num_agent_steps_sampled": 102144, "num_agent_steps_trained": 9546, "last_target_update_ts": 34048, "num_target_updates": 37}, "done": false, "episodes_total": 0, "training_iteration": 23, "trial_id": "ff3c2_00000", "date": "2023-11-18_21-11-32", "timestamp": 1700370692, "time_this_iter_s": 2.317178964614868, "time_total_s": 37.37561821937561, "pid": 7608, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17c1aa840>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 37.37561821937561, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 64.66666666666667, "ram_util_percent": 65.26666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.206838607788086, "actor_loss": -5.41837739944458, "critic_loss": 1.452366828918457, "alpha_loss": -0.11640484631061554, "alpha_value": 0.9886602163314819, "log_alpha_value": -0.011404593475162983, "target_entropy": -6.0, "policy_t": 0.017763178795576096, "mean_q": 1.519982099533081, "max_q": 9.080352783203125, "min_q": 1.1299314498901367}, "td_error": [4.329205513000488, 2.528383731842041, 4.676619052886963, 3.1777029037475586, 2.5100395679473877, 2.96852970123291, 3.0324630737304688, 2.6739442348480225, 2.371676445007324, 3.1948776245117188, 3.096125364303589, 4.040725231170654, 1.0307612419128418, 3.5434165000915527, 2.095108985900879, 4.110686302185059, 2.53259015083313, 4.578123092651367, 4.9305033683776855, 4.280374050140381, 2.915992259979248, 3.970864772796631, 2.770742416381836, 3.255819797515869, 4.379709243774414, 3.407130718231201, 3.9069900512695312, 2.9878129959106445, 3.7413156032562256, 3.2181572914123535, 2.7735209465026855, 1.2242051362991333, 2.997063159942627, 2.7343528270721436, 3.6184558868408203, 4.445890426635742, 3.725745677947998, 3.0039236545562744, 1.4173007011413574, 4.264279842376709, 3.5344643592834473, 1.527928113937378, 2.9598803520202637, 4.629124641418457, 3.1245081424713135, 4.630411148071289, 2.751631259918213, 1.898349404335022, 4.249283790588379, 3.596714496612549, 0.20316433906555176, 4.566662311553955, 1.6697065830230713, 0.9429328441619873, 4.129574775695801, 0.6306266784667969, 2.79415225982666, 2.9285693168640137, 4.063202857971191, 4.733521461486816, 3.510807514190674, 2.332533359527588, 1.7368242740631104, 3.0731115341186523, 3.1544125080108643, 3.814662218093872, 5.776899337768555, 5.144683361053467, 2.387338161468506, 4.482191562652588, 3.0404767990112305, 5.881174087524414, 3.8461875915527344, 3.1064257621765137, 3.2970001697540283, 2.6876072883605957, 3.9420440196990967, 3.030595064163208, 2.240067958831787, 2.1811037063598633, 4.355784893035889, 4.210393905639648, 3.9375462532043457, 4.24090576171875, 4.933326721191406, 3.8795084953308105], "mean_td_error": 3.305222511291504, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 39.0, "diff_num_grad_updates_vs_sampler_policy": 38.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.098085403442383, "actor_loss": -5.372062683105469, "critic_loss": 0.27918827533721924, "alpha_loss": -0.11525566875934601, "alpha_value": 0.9886512756347656, "log_alpha_value": -0.011413616128265858, "target_entropy": -6.0, "policy_t": -0.06561237573623657, "mean_q": 1.4387494325637817, "max_q": 6.407835006713867, "min_q": 1.2524487972259521}, "td_error": [0.020740032196044922, 2.09391450881958, 1.5672487020492554, 1.4281752109527588, 0.6450086832046509, 1.5556049346923828, 1.2308145761489868, 0.3986833095550537, 3.2119765281677246, 3.2700023651123047, 1.4070403575897217, 3.4785819053649902, 2.934933662414551, 1.771558165550232, 1.3636829853057861, 2.057555675506592, 1.8414230346679688, 1.1839410066604614, 3.7115042209625244, 0.4404999017715454, 2.415102481842041, 1.2822576761245728, 0.5853853225708008, 0.15003728866577148, 2.5753068923950195, 3.5619235038757324, 0.15916943550109863, 2.274533271789551, 2.54870343208313, 0.4004705548286438, 1.6026290655136108, 1.0785026550292969, 1.6237157583236694, 0.6830769181251526, 1.4308605194091797, 2.1819214820861816, 0.586912214756012, 0.059593141078948975, 2.6420130729675293, 1.9629110097885132, 1.484147548675537, 2.540626287460327, 1.488744854927063, 0.9125539064407349, 0.009711682796478271, 1.8143219947814941, 1.117020845413208, 0.4849770665168762, 1.9092791080474854, 1.6911612749099731, 1.9036425352096558, 0.6775328516960144, 0.8185715079307556, 3.612898349761963, 1.5115412473678589, 2.123203754425049, 2.2538883686065674, 1.146578311920166, 0.32313674688339233, 1.9955155849456787, 1.8546665906906128, 1.7683954238891602, 2.548595666885376, 0.9927685260772705, 2.9698100090026855, 2.33493709564209, 2.7392070293426514, 2.957000732421875, 0.8773462772369385, 2.0390892028808594, 0.12019526958465576, 3.484926223754883, 1.4920746088027954, 1.3911168575286865, 1.9005827903747559, 1.5903388261795044, 0.2258782982826233, 2.129533290863037, 2.300818920135498, 1.7607111930847168, 1.1565971374511719, 2.439857006072998, 0.09731578826904297, 1.3786766529083252, 1.8065028190612793, 1.2144474983215332], "mean_td_error": 1.6373063325881958, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 39.0, "diff_num_grad_updates_vs_sampler_policy": 38.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.12398624420166, "actor_loss": -5.1652703285217285, "critic_loss": 0.5429303050041199, "alpha_loss": -0.11553511768579483, "alpha_value": 0.9886528253555298, "log_alpha_value": -0.011412017978727818, "target_entropy": -6.0, "policy_t": 0.052589356899261475, "mean_q": 1.319654107093811, "max_q": 6.3883514404296875, "min_q": 0.9736956357955933}, "td_error": [1.9484902620315552, 0.13775739073753357, 0.8299170136451721, 2.318211555480957, 0.6169456243515015, 0.646167516708374, 2.207192897796631, 1.808916449546814, 0.4905550479888916, 1.043455719947815, 3.6657581329345703, 0.7088103294372559, 1.4394193887710571, 3.6692967414855957, 2.5597927570343018, 2.020493984222412, 1.6388258934020996, 2.945880889892578, 1.7650463581085205, 3.6773407459259033, 0.435062974691391, 1.5671412944793701, 2.7824301719665527, 2.084019184112549, 2.5904698371887207, 0.6624491214752197, 2.18654727935791, 1.7178345918655396, 1.9040768146514893, 0.7025418877601624, 3.141062021255493, 2.0082385540008545, 1.6828651428222656, 1.119779109954834, 2.3032121658325195, 1.040372371673584, 0.629048764705658, 4.584970474243164, 2.450294256210327, 2.832296133041382, 2.0681381225585938, 1.9547200202941895, 1.1067471504211426, 1.8269078731536865, 1.708909034729004, 3.1826400756835938, 0.9951614737510681, 2.817790985107422, 0.203718900680542, 2.2053821086883545, 2.515843391418457, 1.6459276676177979, 1.1437634229660034, 1.4469478130340576, 1.1290364265441895, 1.9198278188705444, 0.7712937593460083, 1.2305288314819336, 2.2204535007476807, 1.3351454734802246, 1.6476317644119263, 1.3148818016052246, 1.3732097148895264, 1.4066882133483887, 0.9332990050315857, 3.4317920207977295, 2.09338116645813, 1.6155717372894287, 4.605881214141846, 1.7835981845855713, 0.632538914680481, 0.2391108274459839, 1.6414185762405396, 3.229487657546997, 2.778573751449585, 2.110416889190674, 0.4318754971027374, 1.2079638242721558, 2.4371676445007324, 2.4239821434020996, 1.4697561264038086, 1.1872289180755615, 3.2561140060424805, 0.933220624923706, 0.7939621210098267, 2.127157211303711], "mean_td_error": 1.8034625053405762, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 39.0, "diff_num_grad_updates_vs_sampler_policy": 38.0}}, "num_env_steps_sampled": 35840, "num_env_steps_trained": 10062, "num_agent_steps_sampled": 107520, "num_agent_steps_trained": 10062, "last_target_update_ts": 35840, "num_target_updates": 39}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 107520, "num_agent_steps_trained": 10062, "num_env_steps_sampled": 35840, "num_env_steps_trained": 10062, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 981.0576626783179, "num_env_steps_trained_throughput_per_sec": 282.4920501908549, "timesteps_total": 35840, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 107520, "timers": {"training_iteration_time_ms": 973.508, "sample_time_ms": 671.261, "load_time_ms": 0.308, "load_throughput": 836720.353, "learn_time_ms": 18.399, "learn_throughput": 14022.447, "synch_weights_time_ms": 9.601}, "counters": {"num_env_steps_sampled": 35840, "num_env_steps_trained": 10062, "num_agent_steps_sampled": 107520, "num_agent_steps_trained": 10062, "last_target_update_ts": 35840, "num_target_updates": 39}, "done": false, "episodes_total": 0, "training_iteration": 24, "trial_id": "ff3c2_00000", "date": "2023-11-18_21-11-34", "timestamp": 1700370694, "time_this_iter_s": 1.8346421718597412, "time_total_s": 39.21026039123535, "pid": 7608, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17e264fe0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 39.21026039123535, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 68.69999999999999, "ram_util_percent": 65.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.062394142150879, "actor_loss": -5.4031572341918945, "critic_loss": 1.152665138244629, "alpha_loss": -0.12080506235361099, "alpha_value": 0.9880661964416504, "log_alpha_value": -0.012005600146949291, "target_entropy": -6.0, "policy_t": 0.04384157806634903, "mean_q": 1.3767417669296265, "max_q": 4.008347034454346, "min_q": 1.229801893234253}, "td_error": [3.7902729511260986, 6.6445088386535645, 5.076676368713379, 1.292421817779541, 4.692379951477051, 2.6838951110839844, 4.12020206451416, 4.711540222167969, 2.8580665588378906, 3.1723268032073975, 2.554765462875366, 3.365405797958374, 4.240625381469727, 2.9364187717437744, 3.310192584991455, 3.1910059452056885, 4.773864269256592, 4.004317760467529, 4.251646041870117, 3.8599488735198975, 0.24618017673492432, 3.129838705062866, 2.746797561645508, 4.23759126663208, 0.026087522506713867, 3.971395969390869, 3.0884974002838135, 2.59094500541687, 3.2633066177368164, 2.405202865600586, 3.6797666549682617, 2.591507911682129, 3.9338884353637695, 2.108663320541382, 4.629355430603027, 2.5243077278137207, 1.5102795362472534, 4.6178083419799805, 1.5574431419372559, 2.9077272415161133, 3.8978562355041504, 1.3517193794250488, 3.805306911468506, 4.669406890869141, 4.130397319793701, 4.821220397949219, 4.634721755981445, 0.6078643798828125, 4.090362071990967, 2.8545751571655273, 2.4994821548461914, 2.6947898864746094, 3.4734549522399902, 3.3970870971679688, 2.9861233234405518, 4.454225540161133, 2.759927988052368, 2.728928327560425, 1.576429843902588, 5.618621826171875, 3.4093236923217773, 4.924914360046387, 2.362412691116333, 4.277595520019531, 5.226276874542236, 4.399328231811523, 4.183681488037109, 2.955174446105957, 2.4735398292541504, 1.9122707843780518, 4.1573333740234375, 4.918323040008545, 2.7861580848693848, 3.817093849182129, 3.3052337169647217, 3.1028363704681396, 1.0066336393356323, 3.4440484046936035, 3.7634835243225098, 1.2196331024169922, 3.4071688652038574, 4.037399768829346, 3.118164300918579, 2.6087167263031006, 4.319721698760986, 2.999544858932495], "mean_td_error": 3.3312275409698486, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 41.0, "diff_num_grad_updates_vs_sampler_policy": 40.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.15254020690918, "actor_loss": -5.553960800170898, "critic_loss": 0.1913338303565979, "alpha_loss": -0.12197104096412659, "alpha_value": 0.9880580306053162, "log_alpha_value": -0.012013844214379787, "target_entropy": -6.0, "policy_t": -0.04269968345761299, "mean_q": 1.429648995399475, "max_q": 3.882413864135742, "min_q": 1.3938878774642944}, "td_error": [1.6341125965118408, 0.7516688108444214, 0.5007321834564209, 0.019229233264923096, 0.7180995345115662, 0.2867209315299988, 0.157018780708313, 1.5607969760894775, 2.3407840728759766, 0.3296559453010559, 1.1119260787963867, 1.086127519607544, 1.3342986106872559, 0.6427664756774902, 0.07562744617462158, 0.8811411261558533, 0.6644596457481384, 0.40622270107269287, 1.4940253496170044, 1.8781111240386963, 2.297243118286133, 0.21078598499298096, 1.7647604942321777, 0.025107383728027344, 0.9168407917022705, 1.110758662223816, 0.055619001388549805, 0.9656345844268799, 0.2133297324180603, 1.4367197751998901, 1.567169427871704, 0.08446139097213745, 0.7335482835769653, 1.09171462059021, 1.230074405670166, 1.5964850187301636, 1.1637060642242432, 1.3256101608276367, 1.888063907623291, 2.0353217124938965, 1.0825682878494263, 1.905552864074707, 2.1417462825775146, 0.18237507343292236, 0.40539276599884033, 1.385788917541504, 0.5482099652290344, 1.8762505054473877, 0.947508692741394, 0.6436475515365601, 1.2352330684661865, 2.6949849128723145, 0.3288981318473816, 0.4813469648361206, 1.9658334255218506, 1.6849417686462402, 3.895538806915283, 0.2793833613395691, 1.318307638168335, 0.31143397092819214, 2.875526189804077, 2.3276705741882324, 0.7710203528404236, 1.9521760940551758, 1.5634877681732178, 1.2318624258041382, 1.6997408866882324, 0.820391833782196, 0.5020562410354614, 3.1614527702331543, 2.470343589782715, 1.2931456565856934, 0.10695791244506836, 2.399150848388672, 0.8003255128860474, 2.8416755199432373, 1.233070969581604, 2.1387572288513184, 2.263901948928833, 0.8986374735832214, 1.8374419212341309, 0.9230203032493591, 2.7276384830474854, 0.39981740713119507, 1.8063220977783203, 1.0287350416183472], "mean_td_error": 1.2439039945602417, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 41.0, "diff_num_grad_updates_vs_sampler_policy": 40.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.09500503540039, "actor_loss": -5.253570079803467, "critic_loss": 0.4570605158805847, "alpha_loss": -0.1212736964225769, "alpha_value": 0.9880586266517639, "log_alpha_value": -0.012013237923383713, "target_entropy": -6.0, "policy_t": 0.06074156612157822, "mean_q": 1.1650725603103638, "max_q": 5.253933429718018, "min_q": 1.0838013887405396}, "td_error": [0.9561543464660645, 3.5511865615844727, 1.4723926782608032, 2.0226478576660156, 1.4887869358062744, 0.34934818744659424, 2.4918227195739746, 0.7883741855621338, 1.6984001398086548, 1.4433395862579346, 1.3946661949157715, 2.7702112197875977, 1.6059551239013672, 2.3636956214904785, 0.89555424451828, 2.115044116973877, 1.1708052158355713, 2.141932487487793, 2.009535551071167, 1.1549408435821533, 1.173513650894165, 1.0418438911437988, 0.0735858678817749, 0.11755251884460449, 0.5401965975761414, 1.4012022018432617, 1.8730366230010986, 2.7361133098602295, 1.6771115064620972, 1.3887135982513428, 1.3338713645935059, 0.8564162254333496, 1.4558217525482178, 0.8102784752845764, 0.7646031975746155, 0.9759043455123901, 2.206315279006958, 0.24116390943527222, 2.320777416229248, 2.0201425552368164, 0.37754350900650024, 1.3459985256195068, 1.8927550315856934, 4.419954299926758, 3.3750712871551514, 0.5234967470169067, 0.2042989730834961, 1.5479609966278076, 1.1618843078613281, 0.7562978267669678, 1.1975719928741455, 1.3019182682037354, 0.9736403822898865, 0.6978400349617004, 1.1324101686477661, 1.590187668800354, 2.559966802597046, 2.3759427070617676, 1.2904472351074219, 1.303645372390747, 3.156709671020508, 0.8446727991104126, 1.1437751054763794, 1.1096922159194946, 0.36195385456085205, 0.8648896813392639, 1.9310736656188965, 0.10557466745376587, 1.3579837083816528, 2.185680389404297, 3.049102783203125, 2.83225679397583, 2.2300472259521484, 3.6299452781677246, 1.6510734558105469, 1.5253939628601074, 0.3899303674697876, 1.3322827816009521, 2.627389907836914, 1.4519908428192139, 2.4628372192382812, 2.020237684249878, 1.7177692651748657, 3.3333160877227783, 2.0702624320983887, 1.5410258769989014], "mean_td_error": 1.5796356201171875, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 41.0, "diff_num_grad_updates_vs_sampler_policy": 40.0}}, "num_env_steps_sampled": 37632, "num_env_steps_trained": 10578, "num_agent_steps_sampled": 112896, "num_agent_steps_trained": 10578, "last_target_update_ts": 37632, "num_target_updates": 41}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112896, "num_agent_steps_trained": 10578, "num_env_steps_sampled": 37632, "num_env_steps_trained": 10578, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 954.7007349076431, "num_env_steps_trained_throughput_per_sec": 274.902666971174, "timesteps_total": 37632, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 112896, "timers": {"training_iteration_time_ms": 980.787, "sample_time_ms": 677.503, "load_time_ms": 0.309, "load_throughput": 836203.1, "learn_time_ms": 18.561, "learn_throughput": 13899.984, "synch_weights_time_ms": 9.558}, "counters": {"num_env_steps_sampled": 37632, "num_env_steps_trained": 10578, "num_agent_steps_sampled": 112896, "num_agent_steps_trained": 10578, "last_target_update_ts": 37632, "num_target_updates": 41}, "done": false, "episodes_total": 0, "training_iteration": 25, "trial_id": "ff3c2_00000", "date": "2023-11-18_21-11-36", "timestamp": 1700370696, "time_this_iter_s": 1.8859829902648926, "time_total_s": 41.096243381500244, "pid": 7608, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17c1ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 41.096243381500244, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 68.06666666666666, "ram_util_percent": 65.46666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.07242488861084, "actor_loss": -5.505294322967529, "critic_loss": 1.1181128025054932, "alpha_loss": -0.12697596848011017, "alpha_value": 0.9874728322029114, "log_alpha_value": -0.012606294825673103, "target_entropy": -6.0, "policy_t": 0.03076169453561306, "mean_q": 1.8602290153503418, "max_q": 9.905256271362305, "min_q": 1.3392390012741089}, "td_error": [2.2503671646118164, 4.199361324310303, 4.5796356201171875, 2.940610408782959, 3.6455492973327637, 3.9808614253997803, 3.1044914722442627, 2.086820602416992, 3.8232951164245605, 3.04646372795105, 4.489084720611572, 2.751251697540283, 4.527698516845703, 3.4457292556762695, 3.0893945693969727, 3.375734806060791, 2.2835917472839355, 3.7755157947540283, 6.15169095993042, 3.146012783050537, 3.3596315383911133, 3.7164711952209473, 3.206023931503296, 1.6808841228485107, 3.46938157081604, 2.909214973449707, 3.740511894226074, 3.7595298290252686, 2.5092434883117676, 2.9698634147644043, 4.383821964263916, 4.639342784881592, 3.84917950630188, 4.237658500671387, 2.927375316619873, 5.338538646697998, 4.023183822631836, 4.669346809387207, 2.129409074783325, 3.677187919616699, 3.642948627471924, 0.44541192054748535, 4.140132904052734, 2.7075462341308594, 3.739060401916504, 2.746664524078369, 4.922980308532715, 3.0308680534362793, 4.146755695343018, 2.198172092437744, 0.8384521007537842, 4.752352714538574, 0.44176697731018066, 2.118046760559082, 3.7336232662200928, 2.1923961639404297, 2.800135612487793, 2.548708438873291, 3.161849021911621, 1.9146513938903809, 3.339092493057251, 2.9684605598449707, 2.963235378265381, 2.024275779724121, 3.2200934886932373, 3.315778970718384, 3.70253586769104, 4.022158622741699, 5.118222236633301, 0.43932580947875977, 1.5980372428894043, 4.8978424072265625, 3.5448553562164307, 3.0591888427734375, 3.5831992626190186, 3.905848979949951, 3.820321559906006, 3.6416373252868652, 3.6290132999420166, 3.2830700874328613, 2.826599597930908, 5.491591453552246, 2.7256579399108887, 3.8007543087005615, 3.3874316215515137, 2.3095481395721436], "mean_td_error": 3.310805559158325, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 43.0, "diff_num_grad_updates_vs_sampler_policy": 42.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.10425090789795, "actor_loss": -5.650650501251221, "critic_loss": 0.22519880533218384, "alpha_loss": -0.1274566501379013, "alpha_value": 0.9874650835990906, "log_alpha_value": -0.012614159844815731, "target_entropy": -6.0, "policy_t": 0.033561255782842636, "mean_q": 1.825447916984558, "max_q": 6.611197471618652, "min_q": 1.547790288925171}, "td_error": [1.9719327688217163, 3.8837270736694336, 1.681790828704834, 2.1178441047668457, 2.5619378089904785, 0.6612412333488464, 0.38771212100982666, 3.09938907623291, 1.2846797704696655, 1.5152660608291626, 1.7220109701156616, 1.106818437576294, 1.6002051830291748, 0.0683019757270813, 1.3860492706298828, 1.723442792892456, 1.6835110187530518, 1.5353233814239502, 1.3439257144927979, 1.5369179248809814, 4.167747974395752, 1.6261796951293945, 1.5367876291275024, 2.6374731063842773, 0.4912031292915344, 0.8113346099853516, 2.322517156600952, 1.022823452949524, 0.13666528463363647, 0.568489670753479, 2.0698606967926025, 2.953420639038086, 1.468826174736023, 2.7331714630126953, 0.7370650768280029, 0.12621814012527466, 2.0385642051696777, 0.946690559387207, 3.2909772396087646, 1.587268590927124, 2.090646743774414, 1.661590576171875, 0.07683360576629639, 0.49965476989746094, 1.05686616897583, 0.9357632398605347, 2.055037021636963, 1.6991552114486694, 2.9450058937072754, 0.400513231754303, 1.7124873399734497, 0.6076933741569519, 0.5803321003913879, 1.1549214124679565, 0.2917814254760742, 0.6503303647041321, 1.1634409427642822, 0.293939471244812, 0.816791832447052, 0.8871197700500488, 0.8949525356292725, 2.1158270835876465, 2.230496883392334, 1.5526392459869385, 0.5614676475524902, 0.2750145196914673, 1.3455839157104492, 2.139603614807129, 1.794741153717041, 1.4795026779174805, 1.15285062789917, 1.4851634502410889, 1.124975323677063, 1.9195488691329956, 1.0963259935379028, 1.9636425971984863, 0.6357524394989014, 0.19980931282043457, 0.17428302764892578, 2.350998878479004, 0.02663475275039673, 1.8404953479766846, 0.3271045684814453, 0.41273897886276245, 1.7983522415161133, 1.8063377141952515], "mean_td_error": 1.4003496170043945, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 43.0, "diff_num_grad_updates_vs_sampler_policy": 42.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.078190803527832, "actor_loss": -5.352621555328369, "critic_loss": 0.4642835855484009, "alpha_loss": -0.1271296590566635, "alpha_value": 0.9874649047851562, "log_alpha_value": -0.012614334933459759, "target_entropy": -6.0, "policy_t": 0.01847277209162712, "mean_q": 1.3633885383605957, "max_q": 5.200231552124023, "min_q": 1.2022875547409058}, "td_error": [2.447012186050415, 0.941421389579773, 2.2662205696105957, 1.2249526977539062, 0.41632282733917236, 0.9399347305297852, 1.6314258575439453, 1.5512990951538086, 1.4827395677566528, 0.16246837377548218, 0.6750802993774414, 3.8752994537353516, 2.778562068939209, 0.1360776424407959, 1.5398190021514893, 1.5126832723617554, 1.9218456745147705, 0.3944941759109497, 3.445244312286377, 2.0709457397460938, 1.1137388944625854, 0.3068825602531433, 1.510185956954956, 2.2795050144195557, 1.0340919494628906, 0.8706004619598389, 1.8119399547576904, 2.538834571838379, 2.0244150161743164, 1.9773626327514648, 2.07848858833313, 2.483314037322998, 2.048497438430786, 0.5628556609153748, 1.493842601776123, 0.07891559600830078, 1.0454771518707275, 0.570124626159668, 2.1252622604370117, 1.418708324432373, 1.8313733339309692, 0.7376241683959961, 0.3911411166191101, 3.3901238441467285, 1.0039838552474976, 0.07539665699005127, 0.8943014144897461, 2.8536272048950195, 1.5874751806259155, 3.1804118156433105, 0.11882507801055908, 0.5089550018310547, 1.56096351146698, 1.1418826580047607, 1.8924955129623413, 2.298525333404541, 1.6953035593032837, 2.7971625328063965, 2.091669797897339, 1.2575571537017822, 0.9844712615013123, 0.31481045484542847, 2.850407123565674, 2.628690481185913, 4.126214027404785, 1.664451003074646, 2.242912769317627, 2.6141371726989746, 0.0959896445274353, 2.007321357727051, 0.18616127967834473, 2.135668992996216, 2.3160746097564697, 2.5147223472595215, 0.2792361378669739, 0.6552380323410034, 1.0226490497589111, 2.82545804977417, 2.7948951721191406, 1.3180630207061768, 0.5429127812385559, 3.6414337158203125, 1.6175892353057861, 0.8714063167572021, 1.202523946762085, 1.1011981964111328], "mean_td_error": 1.5889573097229004, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 43.0, "diff_num_grad_updates_vs_sampler_policy": 42.0}}, "num_env_steps_sampled": 39424, "num_env_steps_trained": 11094, "num_agent_steps_sampled": 118272, "num_agent_steps_trained": 11094, "last_target_update_ts": 39424, "num_target_updates": 43}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 118272, "num_agent_steps_trained": 11094, "num_env_steps_sampled": 39424, "num_env_steps_trained": 11094, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 998.3836811226241, "num_env_steps_trained_throughput_per_sec": 287.48101532325563, "timesteps_total": 39424, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 118272, "timers": {"training_iteration_time_ms": 964.074, "sample_time_ms": 661.047, "load_time_ms": 0.31, "load_throughput": 831384.782, "learn_time_ms": 18.678, "learn_throughput": 13813.132, "synch_weights_time_ms": 9.533}, "counters": {"num_env_steps_sampled": 39424, "num_env_steps_trained": 11094, "num_agent_steps_sampled": 118272, "num_agent_steps_trained": 11094, "last_target_update_ts": 39424, "num_target_updates": 43}, "done": false, "episodes_total": 0, "training_iteration": 26, "trial_id": "ff3c2_00000", "date": "2023-11-18_21-11-38", "timestamp": 1700370698, "time_this_iter_s": 1.8050758838653564, "time_total_s": 42.9013192653656, "pid": 7608, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17e265120>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 42.9013192653656, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 65.53333333333333, "ram_util_percent": 64.86666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.072412490844727, "actor_loss": -5.604571342468262, "critic_loss": 0.9131932258605957, "alpha_loss": -0.13302472233772278, "alpha_value": 0.9868800044059753, "log_alpha_value": -0.013206838630139828, "target_entropy": -6.0, "policy_t": 0.01489104051142931, "mean_q": 1.9745752811431885, "max_q": 8.253427505493164, "min_q": 1.452229619026184}, "td_error": [2.855074405670166, 2.766113519668579, 3.081834554672241, 3.708515167236328, 2.2933175563812256, 3.573503017425537, 2.910330057144165, 2.8319191932678223, 1.3455983400344849, 2.1787734031677246, 2.6545658111572266, 3.451610565185547, 3.529531955718994, 1.6682161092758179, 1.9049996137619019, 2.240669012069702, 3.6292920112609863, 2.966921806335449, 1.7462985515594482, 1.6929717063903809, 4.342747688293457, 1.2208577394485474, 2.8895983695983887, 1.9270825386047363, 2.067678451538086, 3.771416664123535, 2.5096826553344727, 3.401134729385376, 1.9697610139846802, 4.773882865905762, 1.7378212213516235, 2.0599708557128906, 3.648597240447998, 3.040492534637451, 3.615546226501465, 2.5139074325561523, 3.33795166015625, 0.09325999021530151, 2.598607063293457, 4.01406192779541, 3.558116912841797, 5.717381954193115, 2.229557514190674, 0.20216131210327148, 2.4161429405212402, 2.667125940322876, 3.099834680557251, 1.7832667827606201, 4.362279891967773, 1.5696766376495361, 1.4337060451507568, 3.385054349899292, 3.2851507663726807, 2.6305930614471436, 2.726130723953247, 4.321645736694336, 2.982974052429199, 2.5449018478393555, 3.843315601348877, 3.509768009185791, 2.606515884399414, 3.5580556392669678, 4.047765254974365, 3.031252384185791, 0.2809333801269531, 3.668679714202881, 3.0055723190307617, 3.3746211528778076, 2.8500571250915527, 3.639533281326294, 2.4515321254730225, 1.360011100769043, 1.6975111961364746, 3.109212875366211, 2.741279363632202, 2.944247245788574, 2.90260648727417, 3.451862335205078, 2.699946880340576, 2.5434117317199707, 2.4697537422180176, 2.357219696044922, 1.2696704864501953, 3.0053539276123047, 3.027665853500366, 4.112141132354736], "mean_td_error": 2.779526710510254, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 45.0, "diff_num_grad_updates_vs_sampler_policy": 44.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.074057579040527, "actor_loss": -5.77833366394043, "critic_loss": 0.1875549554824829, "alpha_loss": -0.13312192261219025, "alpha_value": 0.9868726134300232, "log_alpha_value": -0.013214330188930035, "target_entropy": -6.0, "policy_t": 0.03412514925003052, "mean_q": 1.7806148529052734, "max_q": 5.528919696807861, "min_q": 1.702548861503601}, "td_error": [1.3223044872283936, 1.2920703887939453, 1.131157398223877, 0.6574496626853943, 0.2780243158340454, 2.342341423034668, 0.7725545763969421, 2.990217924118042, 0.6839256286621094, 0.17673230171203613, 1.7270572185516357, 2.2021241188049316, 1.7552598714828491, 0.7008968591690063, 0.3976176381111145, 3.383711814880371, 0.40360593795776367, 2.4010701179504395, 0.3148629665374756, 0.9177505970001221, 0.9495607018470764, 0.5860276222229004, 1.354425072669983, 0.07104158401489258, 2.2685556411743164, 1.830466628074646, 1.5245389938354492, 2.9494197368621826, 0.3036481738090515, 0.20834112167358398, 1.2124121189117432, 0.7957577705383301, 1.0081918239593506, 0.06705081462860107, 0.1177908182144165, 0.45039254426956177, 0.7701379656791687, 0.11724799871444702, 1.8172779083251953, 0.6960935592651367, 2.2208449840545654, 0.2650306224822998, 1.1499595642089844, 0.8370099663734436, 1.332905650138855, 1.0512421131134033, 0.06610351800918579, 1.9606075286865234, 2.80427885055542, 1.0641752481460571, 3.013746738433838, 1.8105028867721558, 0.9761781692504883, 2.4246764183044434, 2.1555514335632324, 0.37978899478912354, 2.8359193801879883, 0.3836718797683716, 0.5158219933509827, 1.852049469947815, 2.0924715995788574, 1.8497005701065063, 2.9885263442993164, 0.878138542175293, 2.41204571723938, 0.2018919587135315, 0.1084132194519043, 0.7742772102355957, 0.9162337779998779, 2.542862892150879, 0.7758982181549072, 0.8974440097808838, 1.7857890129089355, 0.7078375220298767, 0.01674628257751465, 1.7597181797027588, 1.2696340084075928, 0.45103514194488525, 0.8465624451637268, 2.0671234130859375, 1.3083786964416504, 0.5546895265579224, 0.9604749083518982, 1.0100812911987305, 0.17199677228927612, 0.679852306842804], "mean_td_error": 1.2101976871490479, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 45.0, "diff_num_grad_updates_vs_sampler_policy": 44.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.104785919189453, "actor_loss": -5.510434150695801, "critic_loss": 0.43057477474212646, "alpha_loss": -0.13353785872459412, "alpha_value": 0.986871600151062, "log_alpha_value": -0.013215309008955956, "target_entropy": -6.0, "policy_t": -0.01481399405747652, "mean_q": 1.5172289609909058, "max_q": 6.153928279876709, "min_q": 1.329931616783142}, "td_error": [1.5428941249847412, 0.9668029546737671, 1.1622060537338257, 1.9225234985351562, 0.4191129803657532, 0.38183069229125977, 4.131248474121094, 0.5109768509864807, 1.8267152309417725, 1.9017956256866455, 2.1391820907592773, 2.5116024017333984, 1.4283912181854248, 2.8175437450408936, 0.5570836067199707, 0.08246350288391113, 1.6705906391143799, 2.969102382659912, 0.5701310634613037, 2.6644058227539062, 1.2316343784332275, 1.0635404586791992, 1.4369211196899414, 0.22238898277282715, 1.0677826404571533, 0.2716526389122009, 3.126277208328247, 0.7657095789909363, 1.1617207527160645, 2.9577038288116455, 0.3074052929878235, 1.818674087524414, 1.6076464653015137, 1.1177914142608643, 0.15142476558685303, 1.7599005699157715, 0.7129164934158325, 2.2710766792297363, 1.1030876636505127, 2.0450806617736816, 0.6601549983024597, 1.9392794370651245, 0.2790144085884094, 1.240457534790039, 1.0866327285766602, 0.5807304382324219, 1.4004110097885132, 4.032247066497803, 0.8800694942474365, 2.406583309173584, 3.4368605613708496, 0.44628047943115234, 0.6977747082710266, 0.8950416445732117, 2.8194522857666016, 0.391848623752594, 0.1629267930984497, 1.1022093296051025, 2.4279959201812744, 0.3612842559814453, 2.306283950805664, 0.07882708311080933, 0.3677247166633606, 0.3012082576751709, 2.481468915939331, 1.288713812828064, 1.696009635925293, 3.0189013481140137, 0.8898733854293823, 0.11398732662200928, 0.6206037402153015, 2.5981452465057373, 1.7888410091400146, 2.627260684967041, 0.8107860088348389, 1.0715770721435547, 1.837023377418518, 0.9116482734680176, 2.3643438816070557, 2.1843481063842773, 2.4484124183654785, 3.221634864807129, 0.5859907865524292, 1.5037879943847656, 1.7145729064941406, 2.605860948562622], "mean_td_error": 1.4774653911590576, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 45.0, "diff_num_grad_updates_vs_sampler_policy": 44.0}}, "num_env_steps_sampled": 41216, "num_env_steps_trained": 11610, "num_agent_steps_sampled": 123648, "num_agent_steps_trained": 11610, "last_target_update_ts": 41216, "num_target_updates": 45}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 123648, "num_agent_steps_trained": 11610, "num_env_steps_sampled": 41216, "num_env_steps_trained": 11610, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 1011.3231063507606, "num_env_steps_trained_throughput_per_sec": 291.2068766054645, "timesteps_total": 41216, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 123648, "timers": {"training_iteration_time_ms": 957.928, "sample_time_ms": 653.903, "load_time_ms": 0.312, "load_throughput": 827886.491, "learn_time_ms": 18.677, "learn_throughput": 13813.996, "synch_weights_time_ms": 9.97}, "counters": {"num_env_steps_sampled": 41216, "num_env_steps_trained": 11610, "num_agent_steps_sampled": 123648, "num_agent_steps_trained": 11610, "last_target_update_ts": 41216, "num_target_updates": 45}, "done": false, "episodes_total": 0, "training_iteration": 27, "trial_id": "ff3c2_00000", "date": "2023-11-18_21-11-40", "timestamp": 1700370700, "time_this_iter_s": 1.7793102264404297, "time_total_s": 44.68062949180603, "pid": 7608, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17e264860>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 44.68062949180603, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 71.05, "ram_util_percent": 65.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.098993301391602, "actor_loss": -5.758377552032471, "critic_loss": 0.9740222692489624, "alpha_loss": -0.13943973183631897, "alpha_value": 0.9862875938415527, "log_alpha_value": -0.01380729116499424, "target_entropy": -6.0, "policy_t": 0.034630853682756424, "mean_q": 1.805964469909668, "max_q": 9.108049392700195, "min_q": 1.569390058517456}, "td_error": [3.2242836952209473, 3.3286566734313965, 1.9499874114990234, 2.3096766471862793, 2.754753589630127, 3.901437997817993, 2.3455493450164795, 1.1905088424682617, 2.718703269958496, 5.968639373779297, 4.232644081115723, 1.1595863103866577, 2.864335298538208, 2.4737603664398193, 2.66975998878479, 3.7870187759399414, 4.060497283935547, 2.327521324157715, 2.9839131832122803, 3.4605095386505127, 2.1811957359313965, 2.139301061630249, 3.598114013671875, 2.982347011566162, 4.074860572814941, 1.8312515020370483, 3.4845597743988037, 3.355772018432617, 2.1888365745544434, 2.391918420791626, 4.609426975250244, 2.934929132461548, 3.3537352085113525, 2.5172319412231445, 2.9176416397094727, 1.889670491218567, 2.5010759830474854, 3.422361373901367, 3.4634525775909424, 3.4754576683044434, 1.7237374782562256, 2.1283555030822754, 1.006453037261963, 2.6889150142669678, 2.594573974609375, 1.5188097953796387, 4.080893516540527, 1.7580103874206543, 1.1907994747161865, 2.6689646244049072, 3.8356268405914307, 2.9173872470855713, 6.295217514038086, 2.501412868499756, 2.112114906311035, 3.4738855361938477, 4.723718643188477, 4.112504005432129, 2.503638982772827, 2.3243579864501953, 3.2011513710021973, 2.8941235542297363, 2.951842784881592, 1.9162333011627197, 1.9029028415679932, 4.180130958557129, 1.6717398166656494, 3.175510883331299, 3.9270501136779785, 1.9534235000610352, 3.862928867340088, 4.150064468383789, 3.882965326309204, 2.556365728378296, 1.8736670017242432, 4.039595127105713, 3.5199382305145264, 3.151310920715332, 2.9669620990753174, 2.773315668106079, 3.4158997535705566, 2.886559009552002, 3.9402050971984863, 3.087475299835205, 4.825044631958008, 3.1015214920043945], "mean_td_error": 2.988281011581421, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 47.0, "diff_num_grad_updates_vs_sampler_policy": 46.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.072352409362793, "actor_loss": -5.919416904449463, "critic_loss": 0.18302017450332642, "alpha_loss": -0.13914428651332855, "alpha_value": 0.9862805008888245, "log_alpha_value": -0.013814477249979973, "target_entropy": -6.0, "policy_t": 0.030459551140666008, "mean_q": 2.0355303287506104, "max_q": 5.518399238586426, "min_q": 1.8637847900390625}, "td_error": [1.5290457010269165, 1.6660280227661133, 1.0530869960784912, 1.2179219722747803, 1.608138084411621, 0.48066163063049316, 0.2498437762260437, 0.4872324466705322, 0.24038469791412354, 0.011157512664794922, 1.7478883266448975, 4.246755123138428, 2.407457113265991, 1.26364004611969, 1.577569603919983, 1.1614601612091064, 2.2085649967193604, 1.403235673904419, 0.24758362770080566, 1.0100256204605103, 1.8594801425933838, 2.7956466674804688, 0.7542096376419067, 0.5871142148971558, 0.15725576877593994, 2.214348554611206, 1.1883437633514404, 3.872154951095581, 1.0618586540222168, 0.5703343152999878, 0.4658147692680359, 1.3716000318527222, 1.8453447818756104, 2.0199544429779053, 0.23297536373138428, 1.0417983531951904, 0.7517328262329102, 0.6489145755767822, 0.4448556900024414, 0.3739151954650879, 2.263659954071045, 0.5301352739334106, 1.8698863983154297, 2.33595871925354, 1.4815447330474854, 1.075942873954773, 0.8565294742584229, 1.7704110145568848, 0.3597759008407593, 1.0525126457214355, 0.42386549711227417, 0.6794231534004211, 2.7846148014068604, 1.5914344787597656, 0.2507316470146179, 1.0071775913238525, 1.536419153213501, 0.8647302985191345, 0.8525273203849792, 1.3023113012313843, 2.7509877681732178, 1.467402458190918, 0.4735039472579956, 0.6909649968147278, 1.6011759042739868, 0.4527032971382141, 0.138289213180542, 1.9913651943206787, 1.704803705215454, 1.7011892795562744, 0.6788905262947083, 0.5240142345428467, 2.407308578491211, 0.45782577991485596, 2.0933618545532227, 1.0179442167282104, 0.13294994831085205, 0.2681170701980591, 0.10819649696350098, 1.802107334136963, 1.0540423393249512, 0.16085678339004517, 2.816716194152832, 1.3073657751083374, 0.7927070260047913, 0.20598459243774414], "mean_td_error": 1.2065778970718384, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 47.0, "diff_num_grad_updates_vs_sampler_policy": 46.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.10588550567627, "actor_loss": -5.6427788734436035, "critic_loss": 0.4308699369430542, "alpha_loss": -0.13962498307228088, "alpha_value": 0.986278772354126, "log_alpha_value": -0.013816202990710735, "target_entropy": -6.0, "policy_t": 0.019202228635549545, "mean_q": 1.5947120189666748, "max_q": 5.512957572937012, "min_q": 1.4650095701217651}, "td_error": [2.9722719192504883, 1.316017746925354, 0.1158706545829773, 2.1994447708129883, 0.886224627494812, 2.041055917739868, 0.4450937509536743, 0.7745234966278076, 2.332523822784424, 1.5139577388763428, 3.031689405441284, 2.3681681156158447, 3.828707218170166, 1.6590735912322998, 0.3504077196121216, 1.208178162574768, 1.9218801259994507, 1.6957511901855469, 1.8000173568725586, 1.053640604019165, 1.291994571685791, 3.1322309970855713, 1.2517496347427368, 2.3588926792144775, 0.6832653284072876, 1.758434534072876, 0.2944432497024536, 2.0515522956848145, 0.7834513783454895, 2.534701347351074, 2.393441677093506, 0.3114444613456726, 2.482466459274292, 1.3171147108078003, 1.1335139274597168, 2.4202094078063965, 0.8390383124351501, 2.9490251541137695, 0.08331799507141113, 0.5028919577598572, 1.4553191661834717, 1.4702157974243164, 2.1274938583374023, 1.557163953781128, 2.0354654788970947, 0.8881992697715759, 0.21589910984039307, 0.7869011163711548, 1.6456410884857178, 1.033706545829773, 2.4723286628723145, 3.0712132453918457, 0.3600102663040161, 0.5241979360580444, 3.195950508117676, 1.0536189079284668, 2.9997825622558594, 2.960330009460449, 0.20717090368270874, 1.5873534679412842, 1.9151904582977295, 0.8924698233604431, 2.3871731758117676, 1.9269676208496094, 2.5484700202941895, 0.08726125955581665, 0.976553201675415, 1.1315789222717285, 0.5734153389930725, 1.093163251876831, 0.7643578052520752, 1.0803894996643066, 2.0036661624908447, 0.791474461555481, 0.18783527612686157, 2.012509822845459, 2.1808266639709473, 0.3173835277557373, 0.9941406846046448, 2.2549498081207275, 0.8584648966789246, 0.08327507972717285, 3.2112410068511963, 0.6889540553092957, 1.7456436157226562, 0.10212922096252441], "mean_td_error": 1.4947106838226318, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 47.0, "diff_num_grad_updates_vs_sampler_policy": 46.0}}, "num_env_steps_sampled": 43008, "num_env_steps_trained": 12126, "num_agent_steps_sampled": 129024, "num_agent_steps_trained": 12126, "last_target_update_ts": 43008, "num_target_updates": 47}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 129024, "num_agent_steps_trained": 12126, "num_env_steps_sampled": 43008, "num_env_steps_trained": 12126, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 992.5443250264241, "num_env_steps_trained_throughput_per_sec": 285.799593590198, "timesteps_total": 43008, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 129024, "timers": {"training_iteration_time_ms": 907.57, "sample_time_ms": 630.268, "load_time_ms": 0.31, "load_throughput": 832408.025, "learn_time_ms": 18.295, "learn_throughput": 14101.845, "synch_weights_time_ms": 9.688}, "counters": {"num_env_steps_sampled": 43008, "num_env_steps_trained": 12126, "num_agent_steps_sampled": 129024, "num_agent_steps_trained": 12126, "last_target_update_ts": 43008, "num_target_updates": 47}, "done": false, "episodes_total": 0, "training_iteration": 28, "trial_id": "ff3c2_00000", "date": "2023-11-18_21-11-42", "timestamp": 1700370702, "time_this_iter_s": 1.8142030239105225, "time_total_s": 46.49483251571655, "pid": 7608, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17c1ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 46.49483251571655, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 65.89999999999999, "ram_util_percent": 64.96666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.161181449890137, "actor_loss": -5.928940296173096, "critic_loss": 0.9947257041931152, "alpha_loss": -0.14639876782894135, "alpha_value": 0.9856956601142883, "log_alpha_value": -0.01440765056759119, "target_entropy": -6.0, "policy_t": 0.0037542153149843216, "mean_q": 2.0331127643585205, "max_q": 10.010866165161133, "min_q": 1.6951982975006104}, "td_error": [2.7375593185424805, 3.069949150085449, 2.1853389739990234, 3.3153300285339355, 3.302294969558716, 3.2703163623809814, 1.8348147869110107, 1.247851848602295, 1.6279518604278564, 1.2745766639709473, 4.30105447769165, 4.1428141593933105, 1.827599287033081, 3.7453513145446777, 2.72949481010437, 3.8622918128967285, 3.214566230773926, 3.007375955581665, 0.45496439933776855, 1.7875336408615112, 3.033857583999634, 2.517212390899658, 2.956317901611328, 3.948028802871704, 3.8216750621795654, 3.363758087158203, 3.5554513931274414, 3.9583511352539062, 2.9878153800964355, 4.233686447143555, 3.2031824588775635, 3.56843638420105, 4.283467769622803, 2.9424843788146973, 3.2533223628997803, 1.125525712966919, 1.9074500799179077, 2.6712305545806885, 1.645760416984558, 4.505982398986816, 3.0871758460998535, 1.596562385559082, 1.0628489255905151, 1.3125085830688477, 2.2128663063049316, 3.366215229034424, 3.561624526977539, 4.245868682861328, 3.1211042404174805, 2.355191230773926, 3.05487322807312, 1.831408143043518, 4.154187202453613, 5.134649276733398, 2.0902085304260254, 3.622310161590576, 5.865775108337402, 5.77605676651001, 3.3727331161499023, 3.717010498046875, 1.5763633251190186, 3.1255831718444824, 3.2231268882751465, 3.09639573097229, 3.30583119392395, 4.935251235961914, 3.794353485107422, 2.2745180130004883, 4.015221118927002, 5.812721252441406, 2.9337263107299805, 2.473412036895752, 3.23244571685791, 2.716409206390381, 1.2762815952301025, 2.6585893630981445, 1.8174083232879639, 1.2813060283660889, 2.860201597213745, 2.8509206771850586, 3.3850202560424805, 3.039625644683838, 3.313687562942505, 3.106037139892578, 2.1223621368408203, 2.3064393997192383], "mean_td_error": 2.994144916534424, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 49.0, "diff_num_grad_updates_vs_sampler_policy": 48.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.167837142944336, "actor_loss": -6.189053535461426, "critic_loss": 0.15915781259536743, "alpha_loss": -0.14656534790992737, "alpha_value": 0.9856888055801392, "log_alpha_value": -0.014414604753255844, "target_entropy": -6.0, "policy_t": -0.010389307513833046, "mean_q": 2.2879085540771484, "max_q": 6.419267654418945, "min_q": 2.0213348865509033}, "td_error": [1.3529119491577148, 0.2917790412902832, 0.14996957778930664, 0.8287001848220825, 1.0924956798553467, 0.20139527320861816, 1.9057193994522095, 0.34568583965301514, 0.7180416584014893, 1.2588906288146973, 0.5020822286605835, 0.13764750957489014, 1.0998286008834839, 2.011813163757324, 2.0619335174560547, 0.381943941116333, 1.9523485898971558, 2.148935317993164, 0.008564233779907227, 2.168431282043457, 0.784049391746521, 2.4430532455444336, 0.7501792907714844, 0.7860029935836792, 0.7354106903076172, 0.642309308052063, 0.2816193103790283, 0.6249868869781494, 1.4385050535202026, 0.8749016523361206, 3.2989134788513184, 1.9922683238983154, 0.23385298252105713, 0.587942361831665, 1.7304298877716064, 2.1764349937438965, 0.44836950302124023, 0.9822087287902832, 0.48743653297424316, 0.41989004611968994, 0.23002660274505615, 4.244439125061035, 2.223992347717285, 1.8263378143310547, 0.8416622877120972, 0.5167052745819092, 0.7508747577667236, 0.48361289501190186, 0.636448860168457, 2.191821575164795, 0.9910387992858887, 0.0629875659942627, 0.7500591278076172, 1.3917781114578247, 1.2837539911270142, 1.776368498802185, 0.7898573875427246, 1.2641493082046509, 0.3844015598297119, 0.18398582935333252, 0.20468676090240479, 1.0920754671096802, 5.68208122253418, 0.7083384990692139, 1.0246994495391846, 1.1348329782485962, 3.1143760681152344, 0.5520882606506348, 0.1759577989578247, 0.610129714012146, 0.5277624130249023, 0.6562098264694214, 0.9731783866882324, 0.3365122079849243, 0.38215959072113037, 0.46447551250457764, 0.01012718677520752, 0.8270576000213623, 2.508450508117676, 1.3201959133148193, 0.34946954250335693, 1.0836727619171143, 0.5373784303665161, 1.080316185951233, 2.309873342514038, 1.02541983127594], "mean_td_error": 1.0913221836090088, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 49.0, "diff_num_grad_updates_vs_sampler_policy": 48.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.188920974731445, "actor_loss": -5.861218452453613, "critic_loss": 0.4260697364807129, "alpha_loss": -0.14689259231090546, "alpha_value": 0.9856865406036377, "log_alpha_value": -0.014416893012821674, "target_entropy": -6.0, "policy_t": 0.022268274798989296, "mean_q": 1.8020480871200562, "max_q": 5.817197322845459, "min_q": 1.607438564300537}, "td_error": [3.2311630249023438, 0.9537254571914673, 1.0126876831054688, 3.0716142654418945, 0.5071258544921875, 1.7285319566726685, 0.3109387755393982, 2.1987462043762207, 3.143411159515381, 0.5792486071586609, 0.8738428950309753, 1.2426952123641968, 1.843162178993225, 1.9175776243209839, 0.08892130851745605, 1.9386451244354248, 1.0964550971984863, 2.0312774181365967, 3.194683074951172, 2.3996810913085938, 1.0557076930999756, 0.21121525764465332, 1.654730200767517, 0.7262186408042908, 0.46666133403778076, 1.6893088817596436, 1.8783235549926758, 0.6132362484931946, 1.3331334590911865, 0.5163680911064148, 0.12304031848907471, 1.9428255558013916, 0.13347995281219482, 2.5044336318969727, 1.1524266004562378, 1.173774003982544, 1.1040489673614502, 0.5094984769821167, 0.30787748098373413, 1.8050107955932617, 1.9557979106903076, 5.12561559677124, 1.1408709287643433, 1.443042278289795, 2.11673641204834, 3.452815294265747, 1.752225399017334, 1.7374799251556396, 1.824575424194336, 1.3563222885131836, 1.83436918258667, 1.86068856716156, 1.4185322523117065, 1.6713905334472656, 0.3990750312805176, 0.9322314262390137, 1.4665172100067139, 0.7659735679626465, 1.8713500499725342, 2.6891446113586426, 1.0391134023666382, 2.663738489151001, 1.2471522092819214, 0.2258870005607605, 0.8451240658760071, 2.4123611450195312, 1.72173273563385, 0.6837978363037109, 1.8767800331115723, 2.1408114433288574, 2.6535489559173584, 0.663615882396698, 2.5198311805725098, 0.1848267912864685, 1.298482894897461, 0.08499312400817871, 2.126431465148926, 3.4126596450805664, 0.6526694297790527, 0.2956323027610779, 0.2300143837928772, 1.3567814826965332, 0.5694348812103271, 0.4597080945968628, 4.916637420654297, 0.6469947695732117], "mean_td_error": 1.488476276397705, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 49.0, "diff_num_grad_updates_vs_sampler_policy": 48.0}}, "num_env_steps_sampled": 44800, "num_env_steps_trained": 12642, "num_agent_steps_sampled": 134400, "num_agent_steps_trained": 12642, "last_target_update_ts": 44800, "num_target_updates": 49}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 134400, "num_agent_steps_trained": 12642, "num_env_steps_sampled": 44800, "num_env_steps_trained": 12642, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 958.7885550421851, "num_env_steps_trained_throughput_per_sec": 276.07974017955775, "timesteps_total": 44800, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 134400, "timers": {"training_iteration_time_ms": 911.811, "sample_time_ms": 634.926, "load_time_ms": 0.31, "load_throughput": 831001.714, "learn_time_ms": 18.357, "learn_throughput": 14054.664, "synch_weights_time_ms": 9.789}, "counters": {"num_env_steps_sampled": 44800, "num_env_steps_trained": 12642, "num_agent_steps_sampled": 134400, "num_agent_steps_trained": 12642, "last_target_update_ts": 44800, "num_target_updates": 49}, "done": false, "episodes_total": 0, "training_iteration": 29, "trial_id": "ff3c2_00000", "date": "2023-11-18_21-11-44", "timestamp": 1700370704, "time_this_iter_s": 1.8765788078308105, "time_total_s": 48.37141132354736, "pid": 7608, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17e265120>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 48.37141132354736, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 60.9, "ram_util_percent": 64.93333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.109186172485352, "actor_loss": -6.039788722991943, "critic_loss": 0.8807266354560852, "alpha_loss": -0.15172076225280762, "alpha_value": 0.9851038455963135, "log_alpha_value": -0.015008208341896534, "target_entropy": -6.0, "policy_t": -0.0134188337251544, "mean_q": 1.947353482246399, "max_q": 8.357131004333496, "min_q": 1.8276119232177734}, "td_error": [3.800009250640869, 4.222219467163086, 2.5746870040893555, 1.8768751621246338, 1.8521342277526855, 1.1935420036315918, 1.987154245376587, 3.730259895324707, 2.536787509918213, 3.6195549964904785, 3.7875490188598633, 1.205120325088501, 2.7025070190429688, 2.095604181289673, 2.7179393768310547, 1.3767200708389282, 2.1695809364318848, 3.173768997192383, 2.8638782501220703, 2.0877723693847656, 1.541436791419983, 3.3351755142211914, 2.5518176555633545, 3.0559842586517334, 2.791863203048706, 2.0682475566864014, 3.390974283218384, 2.500819683074951, 4.621306896209717, 0.7282452583312988, 3.4640843868255615, 2.438443183898926, 3.4581477642059326, 3.4936704635620117, 2.095386028289795, 3.894719123840332, 3.2762906551361084, 3.5373289585113525, 2.5370676517486572, 1.5829194784164429, 2.7473742961883545, 0.43384265899658203, 3.1327974796295166, 1.327662467956543, 1.540810465812683, 2.721015453338623, 3.7223153114318848, 2.1934938430786133, 1.642354965209961, 2.548124074935913, 2.416682481765747, 2.2884268760681152, 2.637883186340332, 2.4332468509674072, 2.4940266609191895, 3.4246115684509277, 3.2209277153015137, 1.9218043088912964, 4.37883186340332, 4.5899810791015625, 2.961703300476074, 2.543928861618042, 3.0123398303985596, 2.247117042541504, 2.003946542739868, 3.2176966667175293, 1.6382999420166016, 3.988058090209961, 4.293118476867676, 3.3900532722473145, 3.4849681854248047, 2.9240565299987793, 4.171182632446289, 3.5630054473876953, 4.672351837158203, 3.9158804416656494, 3.1525912284851074, 2.242016315460205, 2.8514018058776855, 0.5543109178543091, 2.5999886989593506, 1.4437735080718994, 4.053177833557129, 1.8571743965148926, 2.908702850341797, 2.141570806503296], "mean_td_error": 2.7393746376037598, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 51.0, "diff_num_grad_updates_vs_sampler_policy": 50.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.102334976196289, "actor_loss": -6.249645233154297, "critic_loss": 0.13380271196365356, "alpha_loss": -0.15168747305870056, "alpha_value": 0.9850970506668091, "log_alpha_value": -0.015015088953077793, "target_entropy": -6.0, "policy_t": 0.0127940122038126, "mean_q": 2.3044745922088623, "max_q": 6.0639190673828125, "min_q": 2.1681160926818848}, "td_error": [1.2747193574905396, 1.8045744895935059, 0.40759527683258057, 0.6576385498046875, 1.806640386581421, 1.715795636177063, 0.03990292549133301, 0.12169992923736572, 0.49577629566192627, 0.7674328088760376, 0.35148119926452637, 0.5344740152359009, 0.1200416088104248, 1.4900903701782227, 1.0180319547653198, 0.08945345878601074, 1.432938814163208, 0.5287507772445679, 1.4865161180496216, 1.3614338636398315, 1.4060266017913818, 1.124497652053833, 0.16454041004180908, 2.907748222351074, 0.11929750442504883, 0.2533226013183594, 0.06379330158233643, 0.8329821825027466, 1.275813102722168, 0.8085541725158691, 0.7558039426803589, 0.02791893482208252, 0.14099037647247314, 0.7695293426513672, 0.35812854766845703, 0.2162621021270752, 1.8738770484924316, 0.3891322612762451, 0.20217883586883545, 2.2694523334503174, 1.0518049001693726, 0.6910346746444702, 1.0532326698303223, 1.5473403930664062, 0.1567401885986328, 1.4532535076141357, 0.3317556381225586, 0.25256335735321045, 1.041461706161499, 1.764235019683838, 1.9783480167388916, 0.2264871597290039, 0.2961341142654419, 0.12519431114196777, 1.0594823360443115, 1.858256220817566, 3.3139336109161377, 0.4758256673812866, 1.2949414253234863, 0.4868278503417969, 1.11142897605896, 0.7122886180877686, 1.1596338748931885, 0.5155985355377197, 0.017046093940734863, 1.297371506690979, 1.4720240831375122, 1.5272682905197144, 3.013808250427246, 0.012828826904296875, 1.5973247289657593, 1.5029829740524292, 2.4444243907928467, 1.0311294794082642, 1.3768651485443115, 1.9074962139129639, 0.1912902593612671, 0.36534643173217773, 1.4096965789794922, 0.6892035007476807, 0.5261572599411011, 0.875485897064209, 0.8254873752593994, 1.2870965003967285, 1.0191521644592285, 1.0599846839904785], "mean_td_error": 0.9636291861534119, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 51.0, "diff_num_grad_updates_vs_sampler_policy": 50.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.131385803222656, "actor_loss": -5.9502458572387695, "critic_loss": 0.2291518747806549, "alpha_loss": -0.152150958776474, "alpha_value": 0.985094428062439, "log_alpha_value": -0.01501778606325388, "target_entropy": -6.0, "policy_t": 0.0012277864152565598, "mean_q": 1.842061996459961, "max_q": 5.574942588806152, "min_q": 1.7524596452713013}, "td_error": [0.8020912408828735, 0.9746758937835693, 0.4334843158721924, 2.2987403869628906, 0.9094895124435425, 0.24949198961257935, 0.7803021669387817, 1.803417444229126, 0.4327249526977539, 1.9505702257156372, 0.3366406559944153, 0.13720178604125977, 0.6792384386062622, 1.1686437129974365, 0.24247127771377563, 1.4843688011169434, 0.36709797382354736, 0.18949389457702637, 0.25388455390930176, 0.6498343348503113, 0.6905347108840942, 0.4841042757034302, 0.4136437177658081, 0.08764630556106567, 0.8323418498039246, 2.41562819480896, 0.4319097399711609, 0.5132148265838623, 0.0874294638633728, 1.4808509349822998, 0.19906389713287354, 1.5425596237182617, 1.4762004613876343, 1.983305811882019, 0.2280898094177246, 2.205970287322998, 0.2749556303024292, 0.4275994896888733, 0.1777755618095398, 0.42866718769073486, 0.20367830991744995, 1.8716367483139038, 1.2892489433288574, 0.5587285161018372, 1.6008827686309814, 0.20165789127349854, 0.44534730911254883, 0.08391046524047852, 0.4729006290435791, 1.8804645538330078, 1.087550401687622, 1.7702727317810059, 0.592636227607727, 0.6770939826965332, 1.236293077468872, 2.173124313354492, 0.7897305488586426, 5.0685648918151855, 0.5540022850036621, 0.6005595922470093, 1.0846590995788574, 0.2262582778930664, 1.8200392723083496, 0.5601622462272644, 1.0480438470840454, 0.6397935152053833, 0.5212633609771729, 1.4284651279449463, 2.343585968017578, 0.08349013328552246, 0.6651732325553894, 2.021432876586914, 0.5956633687019348, 0.9950730204582214, 1.9016855955123901, 1.2849280834197998, 0.08186638355255127, 0.9543212056159973, 0.6643580198287964, 1.910029649734497, 0.5129692554473877, 1.5413697957992554, 0.3408970236778259, 0.13119256496429443, 0.2617749571800232, 1.2653642892837524], "mean_td_error": 0.9368314743041992, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 51.0, "diff_num_grad_updates_vs_sampler_policy": 50.0}}, "num_env_steps_sampled": 46592, "num_env_steps_trained": 13158, "num_agent_steps_sampled": 139776, "num_agent_steps_trained": 13158, "last_target_update_ts": 46592, "num_target_updates": 51}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 139776, "num_agent_steps_trained": 13158, "num_env_steps_sampled": 46592, "num_env_steps_trained": 13158, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 835.4046860599475, "num_env_steps_trained_throughput_per_sec": 240.55179576279738, "timesteps_total": 46592, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 139776, "timers": {"training_iteration_time_ms": 938.616, "sample_time_ms": 638.541, "load_time_ms": 0.313, "load_throughput": 825360.714, "learn_time_ms": 18.176, "learn_throughput": 14194.313, "synch_weights_time_ms": 9.869}, "counters": {"num_env_steps_sampled": 46592, "num_env_steps_trained": 13158, "num_agent_steps_sampled": 139776, "num_agent_steps_trained": 13158, "last_target_update_ts": 46592, "num_target_updates": 51}, "done": false, "episodes_total": 0, "training_iteration": 30, "trial_id": "ff3c2_00000", "date": "2023-11-18_21-11-46", "timestamp": 1700370706, "time_this_iter_s": 2.1526310443878174, "time_total_s": 50.52404236793518, "pid": 7608, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17e2649a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 50.52404236793518, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 61.1, "ram_util_percent": 65.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.070517539978027, "actor_loss": -6.136597156524658, "critic_loss": 0.8570864200592041, "alpha_loss": -0.1571868360042572, "alpha_value": 0.9845125675201416, "log_alpha_value": -0.015608617104589939, "target_entropy": -6.0, "policy_t": 0.017049269750714302, "mean_q": 2.37538480758667, "max_q": 10.157389640808105, "min_q": 1.9727180004119873}, "td_error": [2.7523837089538574, 4.039298057556152, 2.1534152030944824, 1.9678763151168823, 2.1746010780334473, 3.5501184463500977, 3.6972217559814453, 2.130796194076538, 2.547776699066162, 3.3313510417938232, 3.9869959354400635, 1.149088978767395, 2.587769031524658, 0.3823728561401367, 4.001878261566162, 4.489192008972168, 2.4692416191101074, 0.5130511522293091, 0.8340694308280945, 4.042625904083252, 1.7723065614700317, 3.617330551147461, 1.5997642278671265, 1.2344502210617065, 3.415546417236328, 1.8112982511520386, 2.1380326747894287, 4.576760292053223, 1.449121117591858, 1.5800716876983643, 3.2163562774658203, 0.7056663036346436, 0.0980154275894165, 2.6975345611572266, 4.028720855712891, 1.6492294073104858, 3.3907759189605713, 2.32130765914917, 1.617205262184143, 3.1313469409942627, 2.3785791397094727, 1.4278879165649414, 1.668299674987793, 2.7484302520751953, 2.41367769241333, 4.188995361328125, 1.9658113718032837, 2.638026714324951, 4.779335021972656, 3.27897047996521, 2.3365657329559326, 3.3279361724853516, 3.545490026473999, 2.870187520980835, 1.8186248540878296, 2.4651355743408203, 1.6193128824234009, 2.3166983127593994, 1.1746716499328613, 2.7934603691101074, 1.52121901512146, 3.6917502880096436, 1.5281908512115479, 2.74729061126709, 2.0785512924194336, 1.9999715089797974, 1.6231305599212646, 3.61246657371521, 0.8034107685089111, 4.723448753356934, 4.389431953430176, 5.334000110626221, 2.3760135173797607, 4.225480556488037, 2.5534491539001465, 1.8957308530807495, 2.671299457550049, 2.3991518020629883, 4.4511823654174805, 1.764709711074829, 3.8434653282165527, 1.7825791835784912, 1.613778829574585, 3.3531765937805176, 5.515089511871338, 2.4073667526245117], "mean_td_error": 2.622248649597168, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 53.0, "diff_num_grad_updates_vs_sampler_policy": 52.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.08576488494873, "actor_loss": -6.378842353820801, "critic_loss": 0.11619565635919571, "alpha_loss": -0.1574949026107788, "alpha_value": 0.9845057129859924, "log_alpha_value": -0.01561556477099657, "target_entropy": -6.0, "policy_t": 0.0030529401265084743, "mean_q": 2.4568898677825928, "max_q": 5.68218994140625, "min_q": 2.3157174587249756}, "td_error": [0.7771179676055908, 1.586933970451355, 0.21265971660614014, 1.1607544422149658, 1.0138460397720337, 0.42090606689453125, 0.10294210910797119, 0.18374741077423096, 0.4905797243118286, 1.1170144081115723, 0.7618674039840698, 1.218210220336914, 0.8400688171386719, 1.3096367120742798, 0.5390713214874268, 0.7790168523788452, 0.22366833686828613, 0.3610527515411377, 0.5554920434951782, 1.183532953262329, 0.8047994375228882, 0.7973649501800537, 0.2354975938796997, 1.3661060333251953, 0.297929048538208, 0.3362530469894409, 1.454115867614746, 0.26009559631347656, 2.0802173614501953, 0.35381925106048584, 0.23271417617797852, 0.40679681301116943, 0.1167980432510376, 0.07585608959197998, 0.5820538997650146, 0.31712543964385986, 0.39664554595947266, 0.8665434122085571, 2.3012115955352783, 1.4523149728775024, 0.5344167947769165, 0.010402679443359375, 0.4734905958175659, 0.8104667663574219, 1.7466399669647217, 2.740776777267456, 0.06609392166137695, 1.0988795757293701, 0.10310769081115723, 0.7207040786743164, 5.175806999206543, 0.6926101446151733, 1.3103454113006592, 0.10908198356628418, 0.6475424766540527, 0.1530609130859375, 1.5048402547836304, 2.3443641662597656, 0.7196242809295654, 1.5236611366271973, 2.0156540870666504, 0.640426754951477, 2.162961721420288, 1.7420161962509155, 0.008941173553466797, 0.7111868858337402, 0.790823221206665, 0.27751100063323975, 0.11914944648742676, 0.832709789276123, 1.7070896625518799, 0.5492804050445557, 0.038594603538513184, 0.7517707347869873, 0.8783810138702393, 0.13387060165405273, 0.13171494007110596, 0.1705082654953003, 2.0341272354125977, 0.10553145408630371, 0.9900556802749634, 0.837772011756897, 1.2125024795532227, 0.6137595176696777, 1.6654417514801025, 0.965633749961853], "mean_td_error": 0.8621594905853271, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 53.0, "diff_num_grad_updates_vs_sampler_policy": 52.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.066222190856934, "actor_loss": -6.072692394256592, "critic_loss": 0.22590743005275726, "alpha_loss": -0.15722054243087769, "alpha_value": 0.9845027327537537, "log_alpha_value": -0.015618623234331608, "target_entropy": -6.0, "policy_t": -0.019320212304592133, "mean_q": 1.9643924236297607, "max_q": 3.6798295974731445, "min_q": 1.9133613109588623}, "td_error": [0.416019082069397, 0.472436785697937, 2.5610198974609375, 1.304424524307251, 1.7305866479873657, 0.12069326639175415, 0.48428601026535034, 0.09318006038665771, 0.10493612289428711, 1.3423495292663574, 1.870539665222168, 0.16323554515838623, 1.5970613956451416, 0.5570863485336304, 1.1252448558807373, 0.6531628966331482, 0.8275943994522095, 2.544961452484131, 1.040328860282898, 1.602734088897705, 1.1263271570205688, 1.0330380201339722, 1.6268789768218994, 0.22504329681396484, 0.33754962682724, 2.046916961669922, 0.18185412883758545, 0.08622395992279053, 0.5428515076637268, 0.9278687834739685, 0.8502309322357178, 0.08312106132507324, 0.6300268769264221, 0.7080593109130859, 1.0664434432983398, 1.3802422285079956, 0.08443975448608398, 0.37051528692245483, 0.7737442255020142, 0.3687777519226074, 0.9682134985923767, 0.33773040771484375, 0.5415478944778442, 1.7811872959136963, 1.8885822296142578, 0.13068944215774536, 0.22091007232666016, 0.19827449321746826, 0.22965043783187866, 2.094104290008545, 2.513373374938965, 0.21528613567352295, 0.6196034550666809, 0.9622454047203064, 0.23983162641525269, 0.71152263879776, 1.3512327671051025, 1.070912480354309, 0.5935096144676208, 0.852053165435791, 0.8133636713027954, 1.289278507232666, 0.6688867807388306, 0.20757222175598145, 0.4362025260925293, 2.907956838607788, 0.5003710985183716, 0.6053858399391174, 2.049947738647461, 0.9047583341598511, 0.6374133825302124, 0.29205816984176636, 2.95371675491333, 0.39815568923950195, 2.3051321506500244, 0.17866992950439453, 0.49387234449386597, 1.447279691696167, 1.1465140581130981, 1.6740663051605225, 0.5501571297645569, 0.8218165636062622, 0.20993351936340332, 2.29771089553833, 0.8257606029510498, 0.0789077877998352], "mean_td_error": 0.9218299388885498, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 53.0, "diff_num_grad_updates_vs_sampler_policy": 52.0}}, "num_env_steps_sampled": 48384, "num_env_steps_trained": 13674, "num_agent_steps_sampled": 145152, "num_agent_steps_trained": 13674, "last_target_update_ts": 48384, "num_target_updates": 53}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 145152, "num_agent_steps_trained": 13674, "num_env_steps_sampled": 48384, "num_env_steps_trained": 13674, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 1055.4567890278, "num_env_steps_trained_throughput_per_sec": 303.9150129120227, "timesteps_total": 48384, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 145152, "timers": {"training_iteration_time_ms": 928.91, "sample_time_ms": 625.934, "load_time_ms": 0.313, "load_throughput": 824229.136, "learn_time_ms": 17.968, "learn_throughput": 14358.756, "synch_weights_time_ms": 10.222}, "counters": {"num_env_steps_sampled": 48384, "num_env_steps_trained": 13674, "num_agent_steps_sampled": 145152, "num_agent_steps_trained": 13674, "last_target_update_ts": 48384, "num_target_updates": 53}, "done": false, "episodes_total": 0, "training_iteration": 31, "trial_id": "ff3c2_00000", "date": "2023-11-18_21-11-48", "timestamp": 1700370708, "time_this_iter_s": 1.705475091934204, "time_total_s": 52.229517459869385, "pid": 7608, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17c1ab920>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 52.229517459869385, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 70.2, "ram_util_percent": 65.15}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.08357048034668, "actor_loss": -6.3068528175354, "critic_loss": 0.7841066718101501, "alpha_loss": -0.16344162821769714, "alpha_value": 0.9839219450950623, "log_alpha_value": -0.016208704560995102, "target_entropy": -6.0, "policy_t": -0.01580653339624405, "mean_q": 2.4591047763824463, "max_q": 9.45047664642334, "min_q": 2.128108501434326}, "td_error": [2.1738147735595703, 1.6461176872253418, 1.9738795757293701, 3.493365526199341, 2.4229938983917236, 2.5937790870666504, 1.988804817199707, 2.102118968963623, 0.5491608381271362, 2.9334716796875, 3.301379919052124, 4.087218761444092, 4.081004619598389, 1.2024197578430176, 2.0054540634155273, 5.228559970855713, 2.409390449523926, 1.0614521503448486, 2.5360584259033203, 3.1211142539978027, 2.3816709518432617, 2.227579355239868, 3.2391910552978516, 3.5435492992401123, 1.251255750656128, 2.708040714263916, 1.0180796384811401, 3.958996057510376, 2.0396742820739746, 2.1893632411956787, 1.8049088716506958, 3.3313043117523193, 1.7254798412322998, 2.0701630115509033, 1.2621322870254517, 1.9225085973739624, 1.399666666984558, 0.7739695310592651, 1.530486822128296, 0.6853103637695312, 3.1456446647644043, 2.056109666824341, 4.327984809875488, 2.56489896774292, 2.8548550605773926, 0.5920193195343018, 1.8490453958511353, 3.498305082321167, 2.406205415725708, 2.3588361740112305, 3.311046600341797, 2.151754856109619, 1.3453682661056519, 2.0818982124328613, 0.11049091815948486, 1.693320870399475, 3.3314208984375, 1.8115129470825195, 1.336003065109253, 3.1671485900878906, 3.4263291358947754, 3.2980732917785645, 2.8543577194213867, 5.060868263244629, 2.1284115314483643, 2.982386589050293, 3.047114372253418, 2.6861636638641357, 2.884948968887329, 3.319775342941284, 2.3636388778686523, 2.711704969406128, 3.239948034286499, 1.6942546367645264, 0.1810452938079834, 3.374667167663574, 1.601467251777649, 3.79471755027771, 3.535512924194336, 2.659409523010254, 2.627934455871582, 1.7432113885879517, 2.6699681282043457, 0.7823548316955566, 3.2702760696411133, 5.01765775680542], "mean_td_error": 2.45261549949646, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 55.0, "diff_num_grad_updates_vs_sampler_policy": 54.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.097987174987793, "actor_loss": -6.549942493438721, "critic_loss": 0.14305219054222107, "alpha_loss": -0.16374684870243073, "alpha_value": 0.9839149713516235, "log_alpha_value": -0.016215790063142776, "target_entropy": -6.0, "policy_t": -0.021591579541563988, "mean_q": 2.5487256050109863, "max_q": 5.242738723754883, "min_q": 2.21978759765625}, "td_error": [1.334083914756775, 0.7764195203781128, 0.17723345756530762, 0.11313879489898682, 0.27181732654571533, 0.794241189956665, 0.7855693101882935, 1.0420187711715698, 0.7891101837158203, 2.104750156402588, 0.08040452003479004, 0.8056329488754272, 0.907936692237854, 1.0114634037017822, 0.5187962055206299, 0.8084149360656738, 0.3555734157562256, 3.4244818687438965, 0.4052462577819824, 0.5416214466094971, 0.6477227210998535, 0.845396876335144, 0.5073233842849731, 1.9347548484802246, 0.34674835205078125, 0.2740163803100586, 1.0515892505645752, 0.420316219329834, 0.5679440498352051, 0.33160531520843506, 0.5561723709106445, 1.5978994369506836, 0.920962929725647, 0.3365483283996582, 0.6922909021377563, 4.00200080871582, 0.15755486488342285, 0.3882981538772583, 0.2679288387298584, 0.19941890239715576, 1.9068882465362549, 1.3759956359863281, 3.649235248565674, 0.9578508138656616, 0.1626056432723999, 1.3572664260864258, 1.3132805824279785, 0.973832368850708, 0.6365580558776855, 1.9164884090423584, 1.5223379135131836, 1.8306031227111816, 1.470806360244751, 2.0377204418182373, 2.2649011611938477, 0.14016222953796387, 0.881999135017395, 0.7556833028793335, 0.8496369123458862, 1.1915465593338013, 0.4225684404373169, 0.7769886255264282, 0.3453967571258545, 0.14672863483428955, 1.5177117586135864, 1.0270782709121704, 0.021839261054992676, 0.5309281349182129, 2.475834369659424, 0.03803443908691406, 0.6311348676681519, 1.9126229286193848, 2.4245758056640625, 1.5034204721450806, 0.6471928358078003, 1.2874162197113037, 0.3981970548629761, 0.33212971687316895, 3.524655342102051, 0.35818326473236084, 0.9630308151245117, 0.41369903087615967, 1.1992344856262207, 0.3295314311981201, 2.297869920730591, 0.3776205778121948], "mean_td_error": 1.0022495985031128, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 55.0, "diff_num_grad_updates_vs_sampler_policy": 54.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.127077102661133, "actor_loss": -6.309350967407227, "critic_loss": 0.23329892754554749, "alpha_loss": -0.16425174474716187, "alpha_value": 0.9839117527008057, "log_alpha_value": -0.016219068318605423, "target_entropy": -6.0, "policy_t": -0.053054649382829666, "mean_q": 2.1654019355773926, "max_q": 4.727880477905273, "min_q": 1.9714889526367188}, "td_error": [0.749008297920227, 1.9166673421859741, 0.40152549743652344, 0.7830623388290405, 0.6079814434051514, 2.2533369064331055, 0.5550776720046997, 1.8744676113128662, 0.12894999980926514, 1.5525579452514648, 0.8759493827819824, 1.5803766250610352, 0.8841297626495361, 0.5240516662597656, 0.18102717399597168, 0.45855724811553955, 0.9108649492263794, 0.40858006477355957, 0.34191179275512695, 0.8602406978607178, 1.8242712020874023, 0.6326586008071899, 0.15228474140167236, 3.0450363159179688, 0.7835519313812256, 1.000291347503662, 1.6891664266586304, 0.4191087484359741, 0.9492366313934326, 1.2936186790466309, 1.213258147239685, 1.5199918746948242, 2.5674591064453125, 1.0197293758392334, 1.3175084590911865, 0.4951963424682617, 0.1824512481689453, 0.6291549205780029, 2.286681652069092, 1.0821325778961182, 0.4993969202041626, 2.7032036781311035, 0.0248873233795166, 1.1721341609954834, 0.9347134828567505, 1.4246679544448853, 0.4497244358062744, 0.5465459823608398, 1.622788906097412, 0.28551924228668213, 1.0959599018096924, 1.6258482933044434, 0.530805230140686, 0.711945652961731, 0.09708178043365479, 1.1083285808563232, 0.2719537019729614, 0.16675937175750732, 0.9985404014587402, 0.1265101432800293, 0.5492385625839233, 0.945772647857666, 0.15111207962036133, 1.740323543548584, 0.0821000337600708, 1.852679967880249, 0.6024922132492065, 0.11225593090057373, 0.45603489875793457, 0.0816655158996582, 2.361618995666504, 1.2982245683670044, 1.0596879720687866, 0.08066320419311523, 1.2575688362121582, 1.1948673725128174, 1.6285138130187988, 1.4719328880310059, 1.0543324947357178, 0.8793480396270752, 2.28762149810791, 0.23579645156860352, 0.3363455533981323, 0.4316478967666626, 1.7646583318710327, 0.32311928272247314], "mean_td_error": 0.9603261947631836, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 55.0, "diff_num_grad_updates_vs_sampler_policy": 54.0}}, "num_env_steps_sampled": 50176, "num_env_steps_trained": 14190, "num_agent_steps_sampled": 150528, "num_agent_steps_trained": 14190, "last_target_update_ts": 50176, "num_target_updates": 55}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 150528, "num_agent_steps_trained": 14190, "num_env_steps_sampled": 50176, "num_env_steps_trained": 14190, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 927.6553258898184, "num_env_steps_trained_throughput_per_sec": 267.1150380352379, "timesteps_total": 50176, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 150528, "timers": {"training_iteration_time_ms": 944.893, "sample_time_ms": 641.814, "load_time_ms": 0.315, "load_throughput": 820292.929, "learn_time_ms": 17.867, "learn_throughput": 14440.247, "synch_weights_time_ms": 10.074}, "counters": {"num_env_steps_sampled": 50176, "num_env_steps_trained": 14190, "num_agent_steps_sampled": 150528, "num_agent_steps_trained": 14190, "last_target_update_ts": 50176, "num_target_updates": 55}, "done": false, "episodes_total": 0, "training_iteration": 32, "trial_id": "ff3c2_00000", "date": "2023-11-18_21-11-49", "timestamp": 1700370709, "time_this_iter_s": 1.9406592845916748, "time_total_s": 54.17017674446106, "pid": 7608, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17e264fe0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 54.17017674446106, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 69.36666666666666, "ram_util_percent": 65.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.082239151000977, "actor_loss": -6.4859795570373535, "critic_loss": 0.7008417844772339, "alpha_loss": -0.16947072744369507, "alpha_value": 0.9833316206932068, "log_alpha_value": -0.01680883951485157, "target_entropy": -6.0, "policy_t": 0.014249330386519432, "mean_q": 2.4743995666503906, "max_q": 7.833275318145752, "min_q": 2.289790630340576}, "td_error": [4.402534484863281, 2.292659282684326, 1.087808609008789, 1.3929213285446167, 2.2821402549743652, 1.7231550216674805, 3.4336655139923096, 0.1133875846862793, 1.4464377164840698, 1.8715274333953857, 1.6271237134933472, 2.6100616455078125, 2.594966411590576, 0.4127802848815918, 3.4902842044830322, 3.147686243057251, 0.21725785732269287, 1.3671741485595703, 2.7956392765045166, 2.8385558128356934, 2.1702871322631836, 1.4623676538467407, 3.3809621334075928, 0.11144578456878662, 2.1312270164489746, 2.72426700592041, 2.9801583290100098, 1.936140537261963, 0.47752439975738525, 2.0643420219421387, 2.512706995010376, 4.034943103790283, 1.592733383178711, 1.1730952262878418, 2.6301610469818115, 1.923957109451294, 4.569909572601318, 2.1316897869110107, 1.8346959352493286, 3.2221693992614746, 2.084465980529785, 1.6710772514343262, 4.251501083374023, 4.070998191833496, 3.434932231903076, 2.4466934204101562, 2.851980686187744, 2.586559534072876, 3.64473557472229, 1.0961006879806519, 2.063565254211426, 2.511086940765381, 2.56538987159729, 1.1661279201507568, 1.877517580986023, 2.410656452178955, 1.7490622997283936, 3.144073963165283, 1.198325514793396, 2.992898464202881, 1.13101065158844, 2.7523155212402344, 1.6386744976043701, 1.9357295036315918, 1.6105594635009766, 1.2611873149871826, 1.8823394775390625, 2.08270263671875, 3.9082088470458984, 2.829688549041748, 1.5153672695159912, 2.8697683811187744, 1.5955016613006592, 2.6931777000427246, 1.6428215503692627, 2.143160820007324, 2.378755569458008, 2.2989678382873535, 3.9755520820617676, 0.173018217086792, 3.523621082305908, 1.5243937969207764, 1.5487111806869507, 2.7256977558135986, 1.3740363121032715, 1.5771238803863525], "mean_td_error": 2.2165396213531494, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 57.0, "diff_num_grad_updates_vs_sampler_policy": 56.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.058049201965332, "actor_loss": -6.575097560882568, "critic_loss": 0.10605452954769135, "alpha_loss": -0.16913537681102753, "alpha_value": 0.9833246469497681, "log_alpha_value": -0.016815923154354095, "target_entropy": -6.0, "policy_t": 0.006681591272354126, "mean_q": 2.6010398864746094, "max_q": 4.7280659675598145, "min_q": 2.248591899871826}, "td_error": [0.1239781379699707, 0.06927716732025146, 0.7018898725509644, 0.20984423160552979, 0.5018727779388428, 1.7950384616851807, 0.06263446807861328, 3.1588754653930664, 1.8499130010604858, 0.3225409984588623, 1.4918265342712402, 1.1867115497589111, 1.7103302478790283, 0.24665296077728271, 0.42854952812194824, 1.2660083770751953, 0.6597408056259155, 1.0148197412490845, 2.004260540008545, 1.0999654531478882, 0.539753794670105, 0.020622611045837402, 0.7234456539154053, 0.7246615886688232, 1.6806731224060059, 0.8800686597824097, 1.8040043115615845, 0.07937359809875488, 2.530686378479004, 0.9808846712112427, 0.6078001260757446, 2.1346311569213867, 0.1303223967552185, 1.0758920907974243, 0.8063609600067139, 1.6501986980438232, 0.3697826862335205, 0.010656118392944336, 0.9342505931854248, 0.6695780754089355, 0.04176819324493408, 0.28765547275543213, 0.1755458116531372, 0.1150733232498169, 1.088966727256775, 0.06547999382019043, 0.7359304428100586, 1.1198781728744507, 0.3233330249786377, 0.011055231094360352, 0.16286015510559082, 0.8010703325271606, 1.178112268447876, 0.6065075397491455, 0.05342531204223633, 0.5292375087738037, 1.7505298852920532, 0.06367957592010498, 0.12355625629425049, 0.043431758880615234, 0.7481356859207153, 0.750342845916748, 2.001293659210205, 1.14951753616333, 0.012217283248901367, 0.2386850118637085, 0.20143342018127441, 0.6002852916717529, 0.3994365930557251, 1.3137927055358887, 1.6658521890640259, 1.364242672920227, 0.8037775754928589, 0.13496005535125732, 1.3449574708938599, 1.0505653619766235, 0.8089339733123779, 0.09063255786895752, 0.9067497253417969, 0.914830207824707, 0.36446213722229004, 0.994099497795105, 1.8835440874099731, 1.1480557918548584, 0.46207404136657715, 0.026008009910583496], "mean_td_error": 0.8013297915458679, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 57.0, "diff_num_grad_updates_vs_sampler_policy": 56.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.140897750854492, "actor_loss": -6.4620466232299805, "critic_loss": 0.1627357304096222, "alpha_loss": -0.17056438326835632, "alpha_value": 0.9833211898803711, "log_alpha_value": -0.016819456592202187, "target_entropy": -6.0, "policy_t": 0.004159543663263321, "mean_q": 2.3570592403411865, "max_q": 4.903719425201416, "min_q": 2.094521999359131}, "td_error": [0.5781198740005493, 0.07208609580993652, 0.9891191720962524, 0.8036733865737915, 0.8940736055374146, 1.978878140449524, 0.9250859022140503, 0.19740962982177734, 0.33343327045440674, 0.4557480812072754, 1.0549445152282715, 0.8163368701934814, 1.4262584447860718, 0.06802308559417725, 0.36806702613830566, 0.5677921772003174, 1.1404380798339844, 0.3553931713104248, 0.7864819765090942, 0.39759325981140137, 1.4309173822402954, 2.3846402168273926, 1.4484171867370605, 0.07496607303619385, 0.4319664239883423, 0.06661415100097656, 1.8665401935577393, 2.2561192512512207, 0.06802141666412354, 0.11482858657836914, 0.23950159549713135, 0.8498339653015137, 0.2564195394515991, 0.15889286994934082, 1.3445736169815063, 0.2875525951385498, 0.38992488384246826, 0.6997617483139038, 1.0675199031829834, 0.19607961177825928, 0.08873999118804932, 0.34022724628448486, 1.0770207643508911, 0.4360095262527466, 1.9192224740982056, 0.06641232967376709, 1.0853850841522217, 0.11357975006103516, 0.1411912441253662, 0.07731866836547852, 1.5577127933502197, 0.7339843511581421, 0.7163293361663818, 0.33817338943481445, 1.4051926136016846, 0.6255786418914795, 0.3508918285369873, 0.732672929763794, 0.5468697547912598, 0.13083815574645996, 0.11531031131744385, 1.3949917554855347, 1.7587476968765259, 0.3709547519683838, 1.1370151042938232, 0.17533588409423828, 0.5125125646591187, 3.180983543395996, 0.9355373382568359, 0.48039698600769043, 0.5319609642028809, 1.0184907913208008, 0.09622859954833984, 1.6992406845092773, 1.8488218784332275, 0.152197003364563, 0.3829212188720703, 0.7445203065872192, 1.0649569034576416, 0.16205966472625732, 0.12027144432067871, 0.7233220338821411, 0.6663651466369629, 1.123901128768921, 0.23871755599975586, 1.3711504936218262], "mean_td_error": 0.7480500936508179, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 57.0, "diff_num_grad_updates_vs_sampler_policy": 56.0}}, "num_env_steps_sampled": 51968, "num_env_steps_trained": 14706, "num_agent_steps_sampled": 155904, "num_agent_steps_trained": 14706, "last_target_update_ts": 51968, "num_target_updates": 57}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 155904, "num_agent_steps_trained": 14706, "num_env_steps_sampled": 51968, "num_env_steps_trained": 14706, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 921.0379434372705, "num_env_steps_trained_throughput_per_sec": 265.2095863915355, "timesteps_total": 51968, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 155904, "timers": {"training_iteration_time_ms": 958.907, "sample_time_ms": 652.734, "load_time_ms": 0.314, "load_throughput": 821102.081, "learn_time_ms": 17.905, "learn_throughput": 14409.558, "synch_weights_time_ms": 9.975}, "counters": {"num_env_steps_sampled": 51968, "num_env_steps_trained": 14706, "num_agent_steps_sampled": 155904, "num_agent_steps_trained": 14706, "last_target_update_ts": 51968, "num_target_updates": 57}, "done": false, "episodes_total": 0, "training_iteration": 33, "trial_id": "ff3c2_00000", "date": "2023-11-18_21-11-51", "timestamp": 1700370711, "time_this_iter_s": 1.955948829650879, "time_total_s": 56.12612557411194, "pid": 7608, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17e264ae0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 56.12612557411194, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 64.73333333333333, "ram_util_percent": 65.36666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.067301750183105, "actor_loss": -6.515167713165283, "critic_loss": 0.7365853786468506, "alpha_loss": -0.1722407042980194, "alpha_value": 0.9830365777015686, "log_alpha_value": -0.017108924686908722, "target_entropy": -6.0, "policy_t": -0.011342264711856842, "mean_q": 2.456087112426758, "max_q": 8.666579246520996, "min_q": 2.374026298522949}, "td_error": [0.9049762487411499, 2.6136369705200195, 3.0208306312561035, 2.2888906002044678, 2.7377872467041016, 2.4530441761016846, 2.254246234893799, 1.9058904647827148, 4.073396682739258, 0.5325838327407837, 0.1593700647354126, 3.6932148933410645, 1.4219378232955933, 2.242567539215088, 2.8636274337768555, 4.137814044952393, 2.868948459625244, 1.2717663049697876, 2.3703970909118652, 2.7555320262908936, 1.0763379335403442, 2.2999300956726074, 2.9765286445617676, 0.530830979347229, 2.66373872756958, 1.6439794301986694, 4.266229152679443, 1.6279610395431519, 2.8517889976501465, 2.5264735221862793, 3.553255558013916, 4.208237648010254, 0.11820578575134277, 2.351611614227295, 1.1455574035644531, 1.8268957138061523, 4.412995338439941, 3.3732714653015137, 2.2444307804107666, 3.3310394287109375, 1.2349932193756104, 3.1248226165771484, 1.7409037351608276, 0.3558464050292969, 1.4088655710220337, 2.8298730850219727, 1.5613141059875488, 2.6724677085876465, 2.799278736114502, 2.6685900688171387, 2.4763712882995605, 2.924058675765991, 0.7939097881317139, 3.1758503913879395, 3.3024704456329346, 1.8288021087646484, 3.0182812213897705, 1.84942626953125, 2.9967494010925293, 1.3236587047576904, 2.3742775917053223, 3.7892541885375977, 3.616438388824463, 2.831845283508301, 0.7713775634765625, 1.9187465906143188, 0.8787305355072021, 1.868078589439392, 1.650486707687378, 3.2249817848205566, 0.12684965133666992, 1.9159209728240967, 1.3843274116516113, 1.8086929321289062, 2.774481773376465, 2.7243576049804688, 2.47147798538208, 2.865368604660034, 2.5912604331970215, 4.277238845825195, 3.5779409408569336, 3.407093048095703, 2.544623851776123, 1.8023247718811035, 3.3094046115875244, 3.349304676055908], "mean_td_error": 2.366757869720459, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 58.0, "diff_num_grad_updates_vs_sampler_policy": 57.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.097896575927734, "actor_loss": -6.709928512573242, "critic_loss": 0.12606075406074524, "alpha_loss": -0.17283442616462708, "alpha_value": 0.9830297827720642, "log_alpha_value": -0.017115885391831398, "target_entropy": -6.0, "policy_t": -0.027284806594252586, "mean_q": 2.7058563232421875, "max_q": 4.163381576538086, "min_q": 2.4458045959472656}, "td_error": [3.0719563961029053, 0.06562483310699463, 0.15648210048675537, 0.4225428104400635, 0.28102564811706543, 1.4042115211486816, 0.6055097579956055, 1.5330028533935547, 1.9466526508331299, 1.1816179752349854, 0.4902564287185669, 0.055672645568847656, 0.13486182689666748, 1.9110996723175049, 0.9022252559661865, 1.8911125659942627, 0.8249558210372925, 1.1774230003356934, 0.3354604244232178, 0.39788365364074707, 0.04911303520202637, 0.07968127727508545, 2.316580057144165, 0.4473384618759155, 0.028389692306518555, 0.9031690359115601, 1.3254051208496094, 0.4790867567062378, 0.7693353891372681, 1.4218943119049072, 1.1823676824569702, 1.9630050659179688, 0.6937240362167358, 0.46753382682800293, 0.3023369312286377, 0.9076719284057617, 1.0196287631988525, 1.1064510345458984, 1.0084060430526733, 2.459585189819336, 1.5470123291015625, 0.7436515092849731, 0.4279611110687256, 0.41562342643737793, 0.5915712118148804, 1.120056390762329, 1.5184674263000488, 1.9996850490570068, 0.10814690589904785, 1.74122953414917, 0.2678447961807251, 0.6783578395843506, 0.10967087745666504, 1.208503007888794, 0.49562931060791016, 1.3959167003631592, 0.2497262954711914, 1.0754425525665283, 0.4607661962509155, 0.6409053802490234, 1.0691821575164795, 1.0621917247772217, 0.9371933937072754, 2.2493724822998047, 0.7167955636978149, 0.9331881999969482, 0.03489363193511963, 0.9278836250305176, 1.3489701747894287, 0.016803383827209473, 0.6554173231124878, 0.20878732204437256, 0.6273921728134155, 1.0129040479660034, 0.5864681005477905, 1.063212275505066, 1.5556949377059937, 1.810455322265625, 2.657956123352051, 0.8711578845977783, 0.2697235345840454, 0.9141943454742432, 1.1132866144180298, 1.6499714851379395, 1.5331034660339355, 0.38024187088012695], "mean_td_error": 0.9386383891105652, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 58.0, "diff_num_grad_updates_vs_sampler_policy": 57.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.133938789367676, "actor_loss": -6.531000137329102, "critic_loss": 0.23451542854309082, "alpha_loss": -0.17348992824554443, "alpha_value": 0.9830260276794434, "log_alpha_value": -0.017119694501161575, "target_entropy": -6.0, "policy_t": -0.011786174029111862, "mean_q": 2.4405016899108887, "max_q": 4.796318054199219, "min_q": 2.153719425201416}, "td_error": [1.0778015851974487, 2.103782892227173, 0.5375887155532837, 0.36459124088287354, 1.1030495166778564, 3.3086583614349365, 0.24409866333007812, 0.1710362434387207, 0.06594574451446533, 0.1592087745666504, 2.937556505203247, 0.4791567325592041, 1.3885117769241333, 0.22816669940948486, 1.6691817045211792, 2.1974258422851562, 3.1728246212005615, 2.227520227432251, 0.08650779724121094, 1.3958978652954102, 0.41806864738464355, 0.22892272472381592, 0.1671428680419922, 0.6181349754333496, 0.4840940237045288, 1.3902461528778076, 0.7870761156082153, 0.0712270736694336, 0.2560584545135498, 0.4932292699813843, 1.4517183303833008, 2.4174692630767822, 1.017885684967041, 0.31005942821502686, 1.7616573572158813, 0.16638052463531494, 0.437272310256958, 1.3760346174240112, 0.2739436626434326, 0.8652944564819336, 1.1052472591400146, 1.1081774234771729, 1.4625284671783447, 1.2480034828186035, 0.07094132900238037, 0.15042650699615479, 0.06379783153533936, 0.19938361644744873, 0.1538715362548828, 0.7581537961959839, 0.3946481943130493, 0.5116547346115112, 1.393930435180664, 1.7480418682098389, 0.06795954704284668, 1.4586663246154785, 2.264681577682495, 1.2236183881759644, 0.6007145643234253, 0.6801495552062988, 0.8641923666000366, 1.3214468955993652, 0.47748899459838867, 0.06529510021209717, 0.014047026634216309, 0.5961000919342041, 0.07189738750457764, 0.29048967361450195, 2.774031162261963, 1.8633606433868408, 1.6529422998428345, 0.6859291791915894, 1.8891053199768066, 0.5881221294403076, 0.5907641649246216, 0.07927370071411133, 1.6915414333343506, 0.21617650985717773, 1.7179183959960938, 0.8771693706512451, 0.7620084285736084, 0.7241394519805908, 1.0111528635025024, 1.6886919736862183, 1.5308372974395752, 1.5587172508239746], "mean_td_error": 0.9555565714836121, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 58.0, "diff_num_grad_updates_vs_sampler_policy": 57.0}}, "num_env_steps_sampled": 52864, "num_env_steps_trained": 14964, "num_agent_steps_sampled": 158592, "num_agent_steps_trained": 14964, "last_target_update_ts": 52864, "num_target_updates": 58}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 158592, "num_agent_steps_trained": 14964, "num_env_steps_sampled": 52864, "num_env_steps_trained": 14964, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 760.1994964768347, "num_env_steps_trained_throughput_per_sec": 218.89673001230287, "timesteps_total": 52864, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 158592, "timers": {"training_iteration_time_ms": 986.123, "sample_time_ms": 679.231, "load_time_ms": 0.313, "load_throughput": 824229.136, "learn_time_ms": 17.764, "learn_throughput": 14523.408, "synch_weights_time_ms": 10.072}, "counters": {"num_env_steps_sampled": 52864, "num_env_steps_trained": 14964, "num_agent_steps_sampled": 158592, "num_agent_steps_trained": 14964, "last_target_update_ts": 52864, "num_target_updates": 58}, "done": false, "episodes_total": 0, "training_iteration": 34, "trial_id": "ff3c2_00000", "date": "2023-11-18_21-11-53", "timestamp": 1700370713, "time_this_iter_s": 1.188049077987671, "time_total_s": 57.31417465209961, "pid": 7608, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17e266520>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 57.31417465209961, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 74.1, "ram_util_percent": 65.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.063580513000488, "actor_loss": -6.744851589202881, "critic_loss": 0.6376173496246338, "alpha_loss": -0.17821551859378815, "alpha_value": 0.9824469089508057, "log_alpha_value": -0.017708955332636833, "target_entropy": -6.0, "policy_t": 0.02053186669945717, "mean_q": 2.7967746257781982, "max_q": 9.584249496459961, "min_q": 2.5533676147460938}, "td_error": [2.888819932937622, 2.0238537788391113, 0.8455651998519897, 0.6835227012634277, 1.3743174076080322, 4.010051727294922, 0.46738696098327637, 2.3933005332946777, 0.8430019617080688, 2.128385066986084, 3.8184256553649902, 0.49077272415161133, 1.186050295829773, 4.782906532287598, 1.2720084190368652, 2.3434457778930664, 0.6518435478210449, 2.442805290222168, 0.14447236061096191, 0.341680645942688, 1.914348840713501, 3.8052873611450195, 2.503122568130493, 2.24165415763855, 0.6762235164642334, 3.225710391998291, 3.836818218231201, 3.2347283363342285, 0.5430498123168945, 1.9617979526519775, 1.3767328262329102, 2.248394250869751, 2.4426238536834717, 2.5535686016082764, 1.75380539894104, 0.8029286861419678, 0.9244439601898193, 2.5556626319885254, 1.9019181728363037, 2.8053503036499023, 4.734023094177246, 0.9600560665130615, 1.625171184539795, 2.298281192779541, 1.860131025314331, 1.0482031106948853, 1.9814834594726562, 1.3436088562011719, 2.1706600189208984, 3.2955775260925293, 1.8735707998275757, 2.8045814037323, 1.616114854812622, 2.2522599697113037, 4.116755962371826, 0.8354581594467163, 2.2102723121643066, 2.0122768878936768, 0.8977465629577637, 1.5169028043746948, 0.4753851890563965, 1.5591760873794556, 1.9608389139175415, 3.907510995864868, 1.2269697189331055, 2.5152199268341064, 1.4998091459274292, 2.808831214904785, 1.470700979232788, 2.44368839263916, 2.9021155834198, 2.80922794342041, 3.409672737121582, 3.6281275749206543, 3.0648694038391113, 2.732011556625366, 2.2243361473083496, 3.930000066757202, 3.348440170288086, 1.298600673675537, 3.299921751022339, 2.8270959854125977, 0.5913921594619751, 2.6973800659179688, 1.7707711458206177, 0.8438334465026855], "mean_td_error": 2.1062772274017334, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 60.0, "diff_num_grad_updates_vs_sampler_policy": 59.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.073958396911621, "actor_loss": -6.7764458656311035, "critic_loss": 0.10449390858411789, "alpha_loss": -0.17846660315990448, "alpha_value": 0.9824403524398804, "log_alpha_value": -0.017715640366077423, "target_entropy": -6.0, "policy_t": -0.012961136177182198, "mean_q": 2.7649178504943848, "max_q": 3.429816722869873, "min_q": 2.341912269592285}, "td_error": [0.14556574821472168, 0.8607349395751953, 1.266419529914856, 0.07229745388031006, 1.14046049118042, 0.7161575555801392, 0.028423666954040527, 1.4302388429641724, 0.4925549030303955, 0.09386539459228516, 0.7775864601135254, 0.3769259452819824, 0.009685754776000977, 1.701294183731079, 0.7500925064086914, 0.2816159725189209, 1.9217647314071655, 0.9625983238220215, 0.930228590965271, 1.6728715896606445, 0.4170997142791748, 1.0780075788497925, 0.18608856201171875, 2.4414637088775635, 0.27314627170562744, 0.668262243270874, 0.5543093681335449, 1.6490507125854492, 0.9788062572479248, 1.3010101318359375, 0.7935124635696411, 1.7468057870864868, 0.18429899215698242, 0.4371069669723511, 0.5658402442932129, 0.6194123029708862, 0.6872550249099731, 0.987260103225708, 0.11536598205566406, 0.8136876821517944, 1.8691531419754028, 1.278929591178894, 2.7591781616210938, 0.3250654935836792, 1.6041085720062256, 0.03076910972595215, 0.006298184394836426, 0.5377429723739624, 0.38230061531066895, 1.1032390594482422, 0.39877140522003174, 0.18699300289154053, 0.9434776306152344, 1.215036392211914, 2.0651369094848633, 0.25905585289001465, 0.8688943386077881, 0.5320974588394165, 0.9162870645523071, 0.7489511966705322, 0.34744811058044434, 1.3160823583602905, 0.36189186573028564, 0.29984498023986816, 0.6280704736709595, 1.1378116607666016, 0.5060173273086548, 0.3427973985671997, 0.8032538890838623, 0.8761359453201294, 0.3700990676879883, 0.22716832160949707, 0.9044188261032104, 0.1597362756729126, 1.6532847881317139, 1.0362097024917603, 0.5735960006713867, 0.46746826171875, 1.9425218105316162, 1.7663885354995728, 0.5279833078384399, 0.293506383895874, 0.9934157133102417, 1.04217529296875, 1.2871313095092773, 1.1827865839004517], "mean_td_error": 0.8279988765716553, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 60.0, "diff_num_grad_updates_vs_sampler_policy": 59.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.093647956848145, "actor_loss": -6.643791198730469, "critic_loss": 0.16003940999507904, "alpha_loss": -0.1788623183965683, "alpha_value": 0.9824358224868774, "log_alpha_value": -0.017720285803079605, "target_entropy": -6.0, "policy_t": -0.0034584905952215195, "mean_q": 2.5079522132873535, "max_q": 3.4718847274780273, "min_q": 2.470804452896118}, "td_error": [0.6848434209823608, 0.15432381629943848, 0.6637333631515503, 1.6881070137023926, 0.9017144441604614, 0.8689048290252686, 2.941631317138672, 0.4778707027435303, 1.1015602350234985, 0.45731568336486816, 0.3892703056335449, 1.0887863636016846, 0.7611755132675171, 0.746918797492981, 0.3383852243423462, 2.2378268241882324, 0.25197696685791016, 1.1689738035202026, 1.7744762897491455, 1.1434407234191895, 0.10803043842315674, 0.054640889167785645, 1.2991230487823486, 1.3415577411651611, 0.10577774047851562, 1.3118454217910767, 0.1999828815460205, 0.09290599822998047, 1.791243076324463, 0.6332715749740601, 0.5007392168045044, 0.12455308437347412, 1.7978830337524414, 0.7490792274475098, 1.0102825164794922, 1.3391844034194946, 0.08388817310333252, 0.8062008619308472, 0.7263702154159546, 1.7243705987930298, 1.688181757926941, 1.2283010482788086, 0.09601712226867676, 0.18239498138427734, 1.075602412223816, 0.053479909896850586, 0.4235590696334839, 0.4888167381286621, 0.775363564491272, 1.47654390335083, 0.05315232276916504, 1.0459789037704468, 0.4204198122024536, 0.3244820833206177, 0.5874011516571045, 3.604337453842163, 1.6128489971160889, 0.900193452835083, 1.6079400777816772, 0.05226743221282959, 0.45488810539245605, 0.36975133419036865, 0.5123248100280762, 0.18094444274902344, 0.31436944007873535, 0.1758049726486206, 0.16019093990325928, 0.49563002586364746, 1.350809097290039, 0.740410327911377, 0.42229318618774414, 0.5871204137802124, 0.9227702617645264, 0.5122089385986328, 0.9740768671035767, 0.5275707244873047, 2.2664804458618164, 0.28142380714416504, 1.1011841297149658, 0.26585543155670166, 0.4308815002441406, 2.1648826599121094, 0.846451997756958, 0.058879852294921875, 0.1739816665649414, 0.7038637399673462], "mean_td_error": 0.8178430795669556, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 60.0, "diff_num_grad_updates_vs_sampler_policy": 59.0}}, "num_env_steps_sampled": 54656, "num_env_steps_trained": 15480, "num_agent_steps_sampled": 163968, "num_agent_steps_trained": 15480, "last_target_update_ts": 54656, "num_target_updates": 60}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 163968, "num_agent_steps_trained": 15480, "num_env_steps_sampled": 54656, "num_env_steps_trained": 15480, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 987.8493139972528, "num_env_steps_trained_throughput_per_sec": 284.4476819322447, "timesteps_total": 54656, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 163968, "timers": {"training_iteration_time_ms": 983.047, "sample_time_ms": 674.937, "load_time_ms": 0.313, "load_throughput": 823539.142, "learn_time_ms": 17.852, "learn_throughput": 14452.069, "synch_weights_time_ms": 9.987}, "counters": {"num_env_steps_sampled": 54656, "num_env_steps_trained": 15480, "num_agent_steps_sampled": 163968, "num_agent_steps_trained": 15480, "last_target_update_ts": 54656, "num_target_updates": 60}, "done": false, "episodes_total": 0, "training_iteration": 35, "trial_id": "ff3c2_00000", "date": "2023-11-18_21-11-54", "timestamp": 1700370714, "time_this_iter_s": 1.8229742050170898, "time_total_s": 59.1371488571167, "pid": 7608, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17c1ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 59.1371488571167, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 72.93333333333332, "ram_util_percent": 65.66666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.018909454345703, "actor_loss": -6.897432327270508, "critic_loss": 0.5205803513526917, "alpha_loss": -0.18343468010425568, "alpha_value": 0.9818577170372009, "log_alpha_value": -0.018308846279978752, "target_entropy": -6.0, "policy_t": -0.021025845780968666, "mean_q": 3.207366943359375, "max_q": 9.599355697631836, "min_q": 2.7420175075531006}, "td_error": [0.6858032941818237, 0.894024133682251, 2.288322687149048, 2.084170341491699, 3.30863094329834, 1.7069727182388306, 2.228386878967285, 2.0438883304595947, 1.3329989910125732, 0.9223637580871582, 3.3376808166503906, 2.106393814086914, 1.3542332649230957, 2.368316888809204, 1.6993709802627563, 0.48465001583099365, 1.4480327367782593, 3.0278611183166504, 0.17968499660491943, 4.072418212890625, 3.8134639263153076, 1.127537488937378, 1.916595458984375, 0.7403777837753296, 0.43390631675720215, 0.4984595775604248, 0.7535812854766846, 1.2242743968963623, 1.4552987813949585, 1.7106800079345703, 2.420031785964966, 0.37446141242980957, 2.086554765701294, 0.7414106130599976, 2.872117280960083, 2.3619027137756348, 3.740969657897949, 3.8536324501037598, 1.6812838315963745, 0.3535240888595581, 0.7012641429901123, 0.13018202781677246, 0.16771221160888672, 1.5702694654464722, 1.1459062099456787, 2.621124505996704, 1.7874668836593628, 1.8669430017471313, 2.2916862964630127, 1.5536514520645142, 0.5176408290863037, 0.6105613708496094, 5.587157249450684, 0.7987233400344849, 1.95815110206604, 2.2134928703308105, 1.6264381408691406, 2.8650832176208496, 2.772847890853882, 1.8287748098373413, 0.2944852113723755, 2.0986015796661377, 0.138930082321167, 1.6110105514526367, 5.1580610275268555, 3.004660129547119, 1.6015841960906982, 0.549659013748169, 2.3190250396728516, 1.5676926374435425, 2.2688660621643066, 1.567533254623413, 1.9341208934783936, 2.932150363922119, 1.00899076461792, 1.9078375101089478, 0.4520057439804077, 1.3516404628753662, 0.13051199913024902, 2.018749713897705, 3.1410279273986816, 4.213795185089111, 2.1627306938171387, 1.47105872631073, 1.9860436916351318, 0.9413192272186279], "mean_td_error": 1.7928074598312378, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 62.0, "diff_num_grad_updates_vs_sampler_policy": 61.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.008537292480469, "actor_loss": -6.8098859786987305, "critic_loss": 0.11047089099884033, "alpha_loss": -0.18330669403076172, "alpha_value": 0.9818516373634338, "log_alpha_value": -0.018315033987164497, "target_entropy": -6.0, "policy_t": -0.016684599220752716, "mean_q": 2.8341832160949707, "max_q": 3.052334785461426, "min_q": 2.810633897781372}, "td_error": [0.8900521993637085, 0.24650120735168457, 1.0055843591690063, 0.23653817176818848, 0.801166296005249, 0.21881771087646484, 0.3577263355255127, 0.4551398754119873, 1.558167815208435, 0.5477999448776245, 0.47128796577453613, 0.5119142532348633, 0.5970425605773926, 0.1972973346710205, 0.4979515075683594, 0.7163429260253906, 0.6516823768615723, 0.1300797462463379, 0.5214614868164062, 1.3423677682876587, 1.5177228450775146, 0.47972095012664795, 1.0560195446014404, 0.36562538146972656, 0.03503525257110596, 1.1948515176773071, 2.485245704650879, 0.7229105234146118, 0.05891072750091553, 0.8026514053344727, 0.3040487766265869, 1.7757220268249512, 0.9660401344299316, 0.7984683513641357, 0.4247407913208008, 0.9180284738540649, 1.7061142921447754, 1.3522491455078125, 0.31095433235168457, 0.16761183738708496, 0.225929856300354, 0.457690954208374, 0.022306442260742188, 1.5641708374023438, 2.1928417682647705, 2.0874345302581787, 0.10986995697021484, 0.5356646776199341, 0.7793420553207397, 1.4783965349197388, 0.2613506317138672, 1.3837144374847412, 0.7773023843765259, 1.3008549213409424, 0.6663491725921631, 0.7946137189865112, 0.9589499235153198, 0.014513015747070312, 0.43793928623199463, 0.09290122985839844, 0.6329902410507202, 0.2878432273864746, 0.6645519733428955, 0.9078116416931152, 1.168359637260437, 1.1306207180023193, 2.2776010036468506, 1.911961555480957, 1.7526519298553467, 0.2559688091278076, 0.4324791431427002, 0.29711687564849854, 1.1621971130371094, 1.5446274280548096, 0.6758430004119873, 2.5944461822509766, 0.3762403726577759, 1.2307058572769165, 0.41033637523651123, 2.2868459224700928, 0.3112938404083252, 1.3347913026809692, 0.12552523612976074, 0.4023324251174927, 1.2801755666732788, 1.8349144458770752], "mean_td_error": 0.8468600511550903, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 62.0, "diff_num_grad_updates_vs_sampler_policy": 61.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.136239051818848, "actor_loss": -6.8151350021362305, "critic_loss": 0.13087135553359985, "alpha_loss": -0.1857030838727951, "alpha_value": 0.9818460941314697, "log_alpha_value": -0.018320709466934204, "target_entropy": -6.0, "policy_t": -0.015016385354101658, "mean_q": 2.700803279876709, "max_q": 4.113134384155273, "min_q": 2.4348645210266113}, "td_error": [0.28534531593322754, 0.06946110725402832, 0.9146195650100708, 0.33417391777038574, 0.6709562540054321, 0.09757781028747559, 0.9879543781280518, 0.03945112228393555, 0.537339448928833, 0.07588696479797363, 0.3484238386154175, 0.45540904998779297, 1.0486716032028198, 0.7059190273284912, 0.3443697690963745, 0.3052750825881958, 0.04409182071685791, 0.09350454807281494, 0.4597814083099365, 0.19643843173980713, 0.49754059314727783, 0.8413960933685303, 0.8324534893035889, 0.3401317596435547, 0.7819565534591675, 0.5179610252380371, 2.169031858444214, 0.16186308860778809, 0.5207302570343018, 1.7387416362762451, 0.4588512182235718, 0.6021496057510376, 0.5001621246337891, 0.6791504621505737, 0.18350505828857422, 0.7703887224197388, 1.7416538000106812, 0.4392052888870239, 0.05070316791534424, 0.04438459873199463, 1.4886677265167236, 0.7580633163452148, 0.420485258102417, 0.26786816120147705, 0.07116782665252686, 0.05405235290527344, 0.29021573066711426, 2.8418071269989014, 1.848607063293457, 1.0885223150253296, 0.36242079734802246, 2.165930986404419, 0.03502213954925537, 0.731701135635376, 0.04307425022125244, 0.03726530075073242, 0.8306925296783447, 0.4028381109237671, 0.5270684957504272, 1.0207867622375488, 1.027868390083313, 0.08377039432525635, 0.9790652990341187, 0.920109748840332, 0.7287619113922119, 0.4574117660522461, 0.04496574401855469, 2.4391283988952637, 1.5689257383346558, 0.9074554443359375, 0.043304443359375, 1.0714991092681885, 1.4170470237731934, 2.6954662799835205, 0.8784407377243042, 0.8853051662445068, 0.2576202154159546, 1.0822054147720337, 1.4494577646255493, 0.2302701473236084, 0.1960068941116333, 0.4244292974472046, 0.9558476209640503, 1.3696682453155518, 0.4361690282821655, 0.9082530736923218], "mean_td_error": 0.7050154209136963, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 62.0, "diff_num_grad_updates_vs_sampler_policy": 61.0}}, "num_env_steps_sampled": 56448, "num_env_steps_trained": 15996, "num_agent_steps_sampled": 169344, "num_agent_steps_trained": 15996, "last_target_update_ts": 56448, "num_target_updates": 62}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 169344, "num_agent_steps_trained": 15996, "num_env_steps_sampled": 56448, "num_env_steps_trained": 15996, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 1018.8227650352139, "num_env_steps_trained_throughput_per_sec": 293.3663765391576, "timesteps_total": 56448, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 169344, "timers": {"training_iteration_time_ms": 956.78, "sample_time_ms": 674.975, "load_time_ms": 0.316, "load_throughput": 815963.227, "learn_time_ms": 17.981, "learn_throughput": 14348.171, "synch_weights_time_ms": 9.869}, "counters": {"num_env_steps_sampled": 56448, "num_env_steps_trained": 15996, "num_agent_steps_sampled": 169344, "num_agent_steps_trained": 15996, "last_target_update_ts": 56448, "num_target_updates": 62}, "done": false, "episodes_total": 0, "training_iteration": 36, "trial_id": "ff3c2_00000", "date": "2023-11-18_21-11-56", "timestamp": 1700370716, "time_this_iter_s": 1.7675740718841553, "time_total_s": 60.904722929000854, "pid": 7608, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17e266340>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 60.904722929000854, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 60.300000000000004, "ram_util_percent": 65.43333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.080240249633789, "actor_loss": -7.121102333068848, "critic_loss": 0.5287770628929138, "alpha_loss": -0.1905999481678009, "alpha_value": 0.981269359588623, "log_alpha_value": -0.018908273428678513, "target_entropy": -6.0, "policy_t": 0.029793724417686462, "mean_q": 3.2506744861602783, "max_q": 9.516946792602539, "min_q": 2.935500144958496}, "td_error": [1.6384468078613281, 1.8633508682250977, 0.28850257396698, 1.8256525993347168, 1.318472981452942, 1.0323971509933472, 0.3221738338470459, 1.3735402822494507, 0.813754677772522, 3.146066665649414, 0.9505388736724854, 1.451354742050171, 1.266202449798584, 1.2386350631713867, 1.051251769065857, 3.845829486846924, 2.2917985916137695, 0.1365870237350464, 0.26293766498565674, 1.9089477062225342, 0.7250540256500244, 0.9795281887054443, 2.170457601547241, 0.6860529184341431, 1.8081018924713135, 2.4458279609680176, 0.7625429630279541, 1.6152396202087402, 0.5893656015396118, 0.19639670848846436, 3.0178585052490234, 2.1457695960998535, 0.35819149017333984, 5.368793964385986, 2.4516475200653076, 3.482577323913574, 1.930907130241394, 0.6307237148284912, 1.6461173295974731, 2.061403512954712, 0.1361013650894165, 1.5123751163482666, 2.778618812561035, 2.2616419792175293, 0.2582155466079712, 0.7032827138900757, 0.9512004852294922, 2.6407313346862793, 2.100799560546875, 2.3069145679473877, 2.2184534072875977, 0.24698126316070557, 1.9329288005828857, 0.14577841758728027, 3.6373419761657715, 1.5991207361221313, 1.6980571746826172, 3.206509590148926, 2.2697505950927734, 2.453803539276123, 1.2942800521850586, 2.5338573455810547, 2.8836469650268555, 4.163224220275879, 2.287534236907959, 1.6092697381973267, 0.6758823394775391, 1.28291916847229, 2.6892848014831543, 3.809023857116699, 3.744558811187744, 1.6568046808242798, 1.899803638458252, 1.3492509126663208, 3.2030954360961914, 2.5773885250091553, 1.1577200889587402, 3.2326889038085938, 2.384434223175049, 1.0377986431121826, 0.8091738224029541, 1.6402626037597656, 1.1036441326141357, 3.036508321762085, 3.0091071128845215, 2.2743287086486816], "mean_td_error": 1.8081755638122559, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 64.0, "diff_num_grad_updates_vs_sampler_policy": 63.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.995034217834473, "actor_loss": -6.917036056518555, "critic_loss": 0.11415953189134598, "alpha_loss": -0.18904680013656616, "alpha_value": 0.9812636971473694, "log_alpha_value": -0.01891407184302807, "target_entropy": -6.0, "policy_t": -0.08319921791553497, "mean_q": 2.874907970428467, "max_q": 2.956092357635498, "min_q": 2.1184206008911133}, "td_error": [0.17766356468200684, 0.3356454372406006, 0.011783599853515625, 1.0588876008987427, 0.24858415126800537, 1.8536124229431152, 1.3197859525680542, 0.5644645690917969, 0.8270590305328369, 1.5892586708068848, 1.7769848108291626, 0.22011184692382812, 2.316723346710205, 1.4479146003723145, 0.2459108829498291, 0.5099294185638428, 0.37412357330322266, 0.6304152011871338, 0.49728119373321533, 1.0064040422439575, 0.4958488941192627, 0.4040658473968506, 0.5019910335540771, 0.48340749740600586, 0.6877495050430298, 0.4178128242492676, 0.39878547191619873, 2.3737244606018066, 0.9127678871154785, 0.595527172088623, 1.3079856634140015, 1.1500202417373657, 0.2590651512145996, 0.1511838436126709, 1.220008373260498, 2.3472955226898193, 0.8187795877456665, 1.3046956062316895, 0.6032623052597046, 0.5819007158279419, 0.8808525800704956, 0.13700556755065918, 1.0489619970321655, 1.1270604133605957, 0.9121830463409424, 1.2899550199508667, 0.19114863872528076, 0.9667763710021973, 0.905029296875, 1.4229570627212524, 0.5054726600646973, 2.3285739421844482, 2.435595989227295, 0.12974834442138672, 0.8820974826812744, 0.6465318202972412, 0.49336063861846924, 0.3998863697052002, 0.7240095138549805, 0.5098598003387451, 1.263157844543457, 1.503678798675537, 0.9718257188796997, 0.4590437412261963, 1.14126718044281, 0.2374194860458374, 2.1030845642089844, 2.432671546936035, 0.8635530471801758, 0.10234880447387695, 0.3461238145828247, 0.28474366664886475, 0.09314906597137451, 0.3463550806045532, 0.6126077175140381, 0.8968653678894043, 1.53322434425354, 2.1108431816101074, 0.8914825916290283, 0.7255783081054688, 0.08489584922790527, 0.3697786331176758, 2.8011691570281982, 0.6204099655151367, 0.12192022800445557, 0.3764963150024414], "mean_td_error": 0.8751068115234375, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 64.0, "diff_num_grad_updates_vs_sampler_policy": 63.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.082262992858887, "actor_loss": -6.892571926116943, "critic_loss": 0.1681327223777771, "alpha_loss": -0.19076937437057495, "alpha_value": 0.9812566041946411, "log_alpha_value": -0.01892128586769104, "target_entropy": -6.0, "policy_t": -0.04515928402543068, "mean_q": 2.744659900665283, "max_q": 3.4534316062927246, "min_q": 2.354090690612793}, "td_error": [0.8128259181976318, 0.8283610343933105, 1.6181823015213013, 0.7681410312652588, 0.890953540802002, 1.2360252141952515, 0.20256733894348145, 1.0541176795959473, 1.0018203258514404, 0.819307804107666, 0.7398368120193481, 0.21465682983398438, 0.27561450004577637, 0.6490414142608643, 1.5709480047225952, 0.969802975654602, 1.5025951862335205, 0.23912370204925537, 0.36525964736938477, 0.5479484796524048, 1.3214865922927856, 1.0077468156814575, 0.061104774475097656, 0.2241150140762329, 0.9492802619934082, 0.3728278875350952, 0.23260700702667236, 0.4089961051940918, 1.5834934711456299, 1.4221824407577515, 0.27817511558532715, 0.8360582590103149, 0.4913274049758911, 1.0872690677642822, 1.296231985092163, 2.5522265434265137, 0.5988342761993408, 2.1599950790405273, 0.46103644371032715, 0.6789062023162842, 1.0258160829544067, 0.06263852119445801, 0.07150387763977051, 1.1460134983062744, 0.5114022493362427, 2.015393018722534, 0.5120958089828491, 0.7664272785186768, 0.787379264831543, 0.3088647127151489, 1.8592454195022583, 0.8488956689834595, 1.3413112163543701, 1.8640329837799072, 0.9006240367889404, 0.1697063446044922, 0.38123488426208496, 0.8496605157852173, 0.04586303234100342, 0.4361248016357422, 0.18569982051849365, 1.6298933029174805, 0.8056797981262207, 0.033086180686950684, 0.2511775493621826, 1.0497409105300903, 0.16578781604766846, 0.1855764389038086, 0.9970647096633911, 1.5504833459854126, 1.7472690343856812, 0.08483028411865234, 0.741783618927002, 1.269400715827942, 1.994166612625122, 2.372356414794922, 0.8016165494918823, 2.133373737335205, 1.3427112102508545, 0.756335973739624, 0.24197769165039062, 0.02833855152130127, 0.6914297342300415, 0.24447095394134521, 1.0875247716903687, 0.5412517786026001], "mean_td_error": 0.8507940769195557, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 64.0, "diff_num_grad_updates_vs_sampler_policy": 63.0}}, "num_env_steps_sampled": 58240, "num_env_steps_trained": 16512, "num_agent_steps_sampled": 174720, "num_agent_steps_trained": 16512, "last_target_update_ts": 58240, "num_target_updates": 64}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 174720, "num_agent_steps_trained": 16512, "num_env_steps_sampled": 58240, "num_env_steps_trained": 16512, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 964.4270490469662, "num_env_steps_trained_throughput_per_sec": 277.7033243907559, "timesteps_total": 58240, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 174720, "timers": {"training_iteration_time_ms": 952.88, "sample_time_ms": 671.614, "load_time_ms": 0.314, "load_throughput": 820666.185, "learn_time_ms": 18.176, "learn_throughput": 14194.816, "synch_weights_time_ms": 9.715}, "counters": {"num_env_steps_sampled": 58240, "num_env_steps_trained": 16512, "num_agent_steps_sampled": 174720, "num_agent_steps_trained": 16512, "last_target_update_ts": 58240, "num_target_updates": 64}, "done": false, "episodes_total": 0, "training_iteration": 37, "trial_id": "ff3c2_00000", "date": "2023-11-18_21-11-58", "timestamp": 1700370718, "time_this_iter_s": 1.867542028427124, "time_total_s": 62.77226495742798, "pid": 7608, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17e2656c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 62.77226495742798, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 77.8, "ram_util_percent": 65.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.110946655273438, "actor_loss": -7.3693342208862305, "critic_loss": 0.4986293315887451, "alpha_loss": -0.19724038243293762, "alpha_value": 0.9806814193725586, "log_alpha_value": -0.01950760930776596, "target_entropy": -6.0, "policy_t": -0.030906282365322113, "mean_q": 3.413675308227539, "max_q": 8.607816696166992, "min_q": 3.1398208141326904}, "td_error": [1.215315580368042, 2.581624984741211, 1.0703704357147217, 4.792567729949951, 1.6421202421188354, 2.800048589706421, 3.0607643127441406, 0.5016554594039917, 2.0466887950897217, 1.0846518278121948, 4.525599479675293, 1.263993263244629, 0.514696478843689, 3.025242567062378, 0.7007284164428711, 2.2998204231262207, 1.1499967575073242, 1.2399518489837646, 1.853543996810913, 0.6955075263977051, 0.6077907085418701, 3.595879077911377, 3.7748970985412598, 0.1547377109527588, 2.880479335784912, 0.6623272895812988, 1.4577958583831787, 0.7995415925979614, 0.737684965133667, 0.14225351810455322, 0.6930080652236938, 3.291647434234619, 0.4689755439758301, 1.634498119354248, 1.0622525215148926, 1.9009761810302734, 1.3040335178375244, 3.1919360160827637, 1.2667524814605713, 1.7372450828552246, 1.3196803331375122, 2.551495313644409, 0.5961124897003174, 2.549539089202881, 0.14041733741760254, 3.618994951248169, 2.0871033668518066, 1.7233216762542725, 1.9769378900527954, 0.8044373989105225, 1.743411660194397, 3.513019561767578, 1.9106673002243042, 2.2578749656677246, 1.9127930402755737, 0.648566484451294, 1.718163013458252, 1.844177007675171, 0.35002028942108154, 1.4673200845718384, 2.9887051582336426, 1.71210515499115, 3.1071834564208984, 0.14240336418151855, 0.3466087579727173, 3.5224246978759766, 0.9721963405609131, 0.39566171169281006, 1.4850965738296509, 2.6124072074890137, 2.89752459526062, 0.9397741556167603, 1.603501319885254, 2.639779806137085, 1.8539423942565918, 0.9445085525512695, 2.1615822315216064, 1.3504412174224854, 0.5551857948303223, 0.6074626445770264, 2.478473663330078, 2.1494832038879395, 1.7069302797317505, 1.9934977293014526, 0.6902261972427368, 3.354461193084717], "mean_td_error": 1.7369210720062256, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 66.0, "diff_num_grad_updates_vs_sampler_policy": 65.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.12666130065918, "actor_loss": -7.036808967590332, "critic_loss": 0.13251185417175293, "alpha_loss": -0.19759917259216309, "alpha_value": 0.9806763529777527, "log_alpha_value": -0.019512765109539032, "target_entropy": -6.0, "policy_t": -0.05735652521252632, "mean_q": 2.8994691371917725, "max_q": 3.0016305446624756, "min_q": 1.935081124305725}, "td_error": [1.2270511388778687, 0.7665663957595825, 0.9856436252593994, 1.7174410820007324, 0.8200109004974365, 1.269242525100708, 0.5543254613876343, 0.5686848163604736, 1.4076651334762573, 0.10923027992248535, 0.897693395614624, 2.110807418823242, 1.1725554466247559, 0.24572396278381348, 1.054979681968689, 0.26380228996276855, 1.5434530973434448, 2.26519513130188, 1.0283468961715698, 0.1970731019973755, 0.05915522575378418, 1.101939082145691, 0.718341052532196, 0.12249505519866943, 1.3504667282104492, 0.4316607713699341, 0.48182523250579834, 1.5563265085220337, 0.07451581954956055, 0.28431272506713867, 1.5969434976577759, 0.28918206691741943, 1.7345539331436157, 0.6844239234924316, 1.2146425247192383, 1.218670129776001, 0.5148000121116638, 0.756637454032898, 0.5076016187667847, 0.7903766632080078, 0.03196418285369873, 1.7627243995666504, 0.9504926204681396, 0.4672495126724243, 1.1315219402313232, 1.3346643447875977, 0.5141103267669678, 0.5574625730514526, 0.5617374181747437, 1.6403517723083496, 1.2380585670471191, 0.1806962490081787, 0.2178347110748291, 2.1932945251464844, 1.0420571565628052, 1.5375776290893555, 0.21607530117034912, 2.6188433170318604, 0.8698439598083496, 1.1515740156173706, 0.0124969482421875, 0.0072879791259765625, 1.6019871234893799, 1.4514408111572266, 1.9983859062194824, 0.004089236259460449, 0.5710227489471436, 2.156937599182129, 0.4051501750946045, 0.9225276708602905, 0.42149078845977783, 1.726610541343689, 3.658792018890381, 2.223914384841919, 0.5643450021743774, 0.6481903791427612, 0.34648871421813965, 1.2618600130081177, 0.06402981281280518, 0.6656877994537354, 0.5367710590362549, 0.5453450679779053, 0.49620139598846436, 1.0518081188201904, 1.2398383617401123, 1.1691162586212158], "mean_td_error": 0.9495850205421448, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 66.0, "diff_num_grad_updates_vs_sampler_policy": 65.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.107494354248047, "actor_loss": -6.97366189956665, "critic_loss": 0.18455296754837036, "alpha_loss": -0.19731353223323822, "alpha_value": 0.9806678295135498, "log_alpha_value": -0.019521506503224373, "target_entropy": -6.0, "policy_t": -0.02891847863793373, "mean_q": 2.8339598178863525, "max_q": 2.887218952178955, "min_q": 2.3233511447906494}, "td_error": [1.7406634092330933, 0.575513482093811, 0.7934722900390625, 0.13095247745513916, 0.31238460540771484, 0.8955748081207275, 0.29476165771484375, 0.7235469818115234, 0.5570811033248901, 0.726616621017456, 1.6389445066452026, 1.4120224714279175, 0.37047719955444336, 0.933350682258606, 2.856276512145996, 0.5924084186553955, 0.17730283737182617, 0.14092564582824707, 0.6312034130096436, 2.7744381427764893, 0.8982565402984619, 0.5345288515090942, 0.19172143936157227, 0.6150779724121094, 2.0317821502685547, 1.0328937768936157, 0.08072447776794434, 0.5392335653305054, 0.37701451778411865, 1.1164333820343018, 0.010607123374938965, 1.146675944328308, 0.15552306175231934, 0.8644922971725464, 0.8163952827453613, 1.7166876792907715, 1.4482698440551758, 2.642218828201294, 0.4474684000015259, 1.8264154195785522, 1.096500039100647, 0.7917579412460327, 1.0294339656829834, 0.20326995849609375, 0.4515419006347656, 0.8347032070159912, 0.30275630950927734, 1.1103154420852661, 1.8504382371902466, 0.10889267921447754, 0.18999099731445312, 1.9692823886871338, 0.9378794431686401, 2.0912251472473145, 1.0108013153076172, 0.09606647491455078, 0.32159531116485596, 0.27236366271972656, 0.3177194595336914, 3.2811527252197266, 1.8394160270690918, 0.49645328521728516, 0.6120084524154663, 1.0328680276870728, 1.5299060344696045, 0.19810152053833008, 1.962565541267395, 1.2986955642700195, 0.5325539112091064, 0.6471179723739624, 0.8387172222137451, 1.7561079263687134, 1.723992943763733, 0.500442624092102, 0.6323367357254028, 0.3206087350845337, 0.7584472894668579, 1.657135248184204, 0.2014397382736206, 0.9815189838409424, 0.046611905097961426, 1.225861668586731, 0.24742984771728516, 0.6433899402618408, 1.2466304302215576, 0.3950986862182617], "mean_td_error": 0.9112032651901245, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 66.0, "diff_num_grad_updates_vs_sampler_policy": 65.0}}, "num_env_steps_sampled": 60032, "num_env_steps_trained": 17028, "num_agent_steps_sampled": 180096, "num_agent_steps_trained": 17028, "last_target_update_ts": 60032, "num_target_updates": 66}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180096, "num_agent_steps_trained": 17028, "num_env_steps_sampled": 60032, "num_env_steps_trained": 17028, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 887.4538506315095, "num_env_steps_trained_throughput_per_sec": 255.5391668113052, "timesteps_total": 60032, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 180096, "timers": {"training_iteration_time_ms": 969.81, "sample_time_ms": 688.973, "load_time_ms": 0.313, "load_throughput": 825423.67, "learn_time_ms": 18.19, "learn_throughput": 14183.541, "synch_weights_time_ms": 9.816}, "counters": {"num_env_steps_sampled": 60032, "num_env_steps_trained": 17028, "num_agent_steps_sampled": 180096, "num_agent_steps_trained": 17028, "last_target_update_ts": 60032, "num_target_updates": 66}, "done": false, "episodes_total": 0, "training_iteration": 38, "trial_id": "ff3c2_00000", "date": "2023-11-18_21-12-00", "timestamp": 1700370720, "time_this_iter_s": 2.029247999191284, "time_total_s": 64.80151295661926, "pid": 7608, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17c1ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 64.80151295661926, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 73.60000000000001, "ram_util_percent": 65.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.085813522338867, "actor_loss": -7.528891563415527, "critic_loss": 0.39997899532318115, "alpha_loss": -0.20279747247695923, "alpha_value": 0.9800935983657837, "log_alpha_value": -0.020107198506593704, "target_entropy": -6.0, "policy_t": 0.0036399003583937883, "mean_q": 3.409764528274536, "max_q": 6.943532943725586, "min_q": 3.3224167823791504}, "td_error": [0.8120869398117065, 0.46445178985595703, 2.2009410858154297, 2.1179039478302, 0.1482555866241455, 0.6059436798095703, 3.413154125213623, 0.2700388431549072, 2.165372371673584, 3.0961132049560547, 0.2797505855560303, 2.8484299182891846, 2.6615867614746094, 1.423429012298584, 3.1341609954833984, 0.7933123111724854, 1.1349682807922363, 2.8596911430358887, 1.2216482162475586, 2.2073965072631836, 1.670300006866455, 2.9993677139282227, 0.2523549795150757, 1.0972363948822021, 1.7454006671905518, 0.32569730281829834, 1.3517524003982544, 1.1135663986206055, 0.3884005546569824, 1.0868606567382812, 0.5839406251907349, 0.7811535596847534, 2.408259868621826, 0.5298964977264404, 3.1193318367004395, 0.14310944080352783, 0.46097612380981445, 1.5039163827896118, 2.4281697273254395, 2.894662857055664, 0.5160691738128662, 4.368098258972168, 1.0482089519500732, 0.667413592338562, 2.8602585792541504, 2.5464160442352295, 0.3717695474624634, 1.4279042482376099, 1.5105266571044922, 0.3939359188079834, 1.6048223972320557, 1.8811830282211304, 1.429513692855835, 0.633257269859314, 0.9037790298461914, 3.4339051246643066, 2.8023157119750977, 1.6540158987045288, 2.1774513721466064, 1.9086390733718872, 0.7609392404556274, 0.38320648670196533, 1.25613272190094, 0.36801767349243164, 2.6892802715301514, 0.33548223972320557, 2.1171865463256836, 2.2443599700927734, 1.549057960510254, 0.7316677570343018, 0.14751434326171875, 0.28142356872558594, 0.14267921447753906, 1.4117614030838013, 2.233515501022339, 0.1513972282409668, 1.6520450115203857, 1.138747215270996, 1.785634994506836, 0.2476189136505127, 0.6932843923568726, 0.9287431240081787, 1.432390570640564, 0.810056209564209, 1.2325899600982666, 1.8640718460083008], "mean_td_error": 1.4357125759124756, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 68.0, "diff_num_grad_updates_vs_sampler_policy": 67.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.070247650146484, "actor_loss": -6.94846773147583, "critic_loss": 0.12209891527891159, "alpha_loss": -0.20252889394760132, "alpha_value": 0.9800893068313599, "log_alpha_value": -0.020111609250307083, "target_entropy": -6.0, "policy_t": -0.03920327499508858, "mean_q": 2.894749641418457, "max_q": 3.002582550048828, "min_q": 1.806292176246643}, "td_error": [0.2807464599609375, 0.11900842189788818, 2.022308349609375, 0.7100255489349365, 0.33724546432495117, 1.4294902086257935, 0.19157588481903076, 0.08841204643249512, 1.2270406484603882, 1.7039134502410889, 1.353110432624817, 0.654166579246521, 1.7824243307113647, 1.0971711874008179, 1.5587364435195923, 0.1467803716659546, 0.10257911682128906, 1.7470154762268066, 0.739578366279602, 1.7256965637207031, 0.9310027360916138, 1.77166748046875, 0.9516167640686035, 0.04208111763000488, 0.5669772624969482, 0.07195353507995605, 1.923923373222351, 1.0459659099578857, 0.26367461681365967, 1.2165735960006714, 0.1980823278427124, 0.8436079025268555, 1.1629128456115723, 0.5119671821594238, 1.4450709819793701, 0.9009006023406982, 0.6701352596282959, 0.33761847019195557, 1.7617117166519165, 1.075873613357544, 0.9996151924133301, 0.6506322622299194, 0.4966416358947754, 0.5298762321472168, 0.12315618991851807, 1.1508911848068237, 0.00921487808227539, 2.2213339805603027, 0.5917866230010986, 0.4040689468383789, 0.24901771545410156, 1.2066770792007446, 2.3883042335510254, 0.7682547569274902, 2.459319829940796, 2.1130337715148926, 1.5672273635864258, 0.765933632850647, 1.9757691621780396, 1.7336236238479614, 1.4716861248016357, 1.4665875434875488, 1.2663465738296509, 0.19645678997039795, 0.6628351211547852, 0.3332263231277466, 0.46507012844085693, 1.8518632650375366, 0.27433478832244873, 0.24618732929229736, 0.4943387508392334, 0.383609414100647, 0.2120499610900879, 0.19222795963287354, 0.1437854766845703, 2.253025531768799, 0.6572486162185669, 0.13588368892669678, 0.20022845268249512, 0.05629885196685791, 1.1054680347442627, 0.730319619178772, 0.6949999332427979, 0.13359928131103516, 0.4956245422363281, 1.2502835988998413], "mean_td_error": 0.8893988728523254, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 68.0, "diff_num_grad_updates_vs_sampler_policy": 67.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.134105682373047, "actor_loss": -7.062568664550781, "critic_loss": 0.1593092381954193, "alpha_loss": -0.20391179621219635, "alpha_value": 0.9800797700881958, "log_alpha_value": -0.020121341571211815, "target_entropy": -6.0, "policy_t": -0.0493432879447937, "mean_q": 2.9017531871795654, "max_q": 2.9618372917175293, "min_q": 2.4648289680480957}, "td_error": [1.1092122793197632, 0.28358030319213867, 0.2584877014160156, 1.891770601272583, 0.40077197551727295, 1.0320680141448975, 0.3079712390899658, 0.10275638103485107, 0.04264402389526367, 2.1356515884399414, 1.092483639717102, 0.41967523097991943, 0.09432387351989746, 0.6208573579788208, 0.6618070602416992, 0.4245457649230957, 1.6115398406982422, 0.4018855094909668, 0.20875728130340576, 0.42302870750427246, 1.4225668907165527, 0.9211652278900146, 0.4934588670730591, 0.7768855094909668, 1.8913770914077759, 0.3897671699523926, 1.2267203330993652, 1.076168179512024, 0.19217991828918457, 3.3109970092773438, 0.1035376787185669, 0.9644885063171387, 0.6814558506011963, 0.13335227966308594, 0.2922109365463257, 0.6674087047576904, 1.4143404960632324, 0.5964092016220093, 0.30875205993652344, 0.6078058481216431, 2.2506041526794434, 0.7528872489929199, 0.3837200403213501, 2.8238372802734375, 1.1597073078155518, 0.5957094430923462, 0.48249828815460205, 1.295553207397461, 0.22147011756896973, 0.7114932537078857, 1.1075708866119385, 0.4552692174911499, 0.9433213472366333, 0.8519928455352783, 0.46753549575805664, 0.7976654767990112, 2.035900115966797, 1.0465826988220215, 0.946325421333313, 0.07883501052856445, 1.628531575202942, 0.6010937690734863, 0.880462646484375, 2.0688819885253906, 2.4240787029266357, 0.9597601890563965, 1.1459596157073975, 0.2284928560256958, 1.3498365879058838, 1.038231372833252, 0.5745296478271484, 0.3976454734802246, 0.5120147466659546, 0.826590895652771, 1.163693904876709, 1.0693919658660889, 2.0595240592956543, 0.806728720664978, 0.7417569160461426, 0.07096588611602783, 0.2858574390411377, 1.1570861339569092, 0.6044459342956543, 0.2526512145996094, 0.331487774848938, 1.5326032638549805], "mean_td_error": 0.873437762260437, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 68.0, "diff_num_grad_updates_vs_sampler_policy": 67.0}}, "num_env_steps_sampled": 61824, "num_env_steps_trained": 17544, "num_agent_steps_sampled": 185472, "num_agent_steps_trained": 17544, "last_target_update_ts": 61824, "num_target_updates": 68}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 185472, "num_agent_steps_trained": 17544, "num_env_steps_sampled": 61824, "num_env_steps_trained": 17544, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 814.0059989707139, "num_env_steps_trained_throughput_per_sec": 234.390120239335, "timesteps_total": 61824, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 185472, "timers": {"training_iteration_time_ms": 965.145, "sample_time_ms": 682.976, "load_time_ms": 0.313, "load_throughput": 824857.407, "learn_time_ms": 18.361, "learn_throughput": 14051.854, "synch_weights_time_ms": 9.59}, "counters": {"num_env_steps_sampled": 61824, "num_env_steps_trained": 17544, "num_agent_steps_sampled": 185472, "num_agent_steps_trained": 17544, "last_target_update_ts": 61824, "num_target_updates": 68}, "done": false, "episodes_total": 0, "training_iteration": 39, "trial_id": "ff3c2_00000", "date": "2023-11-18_21-12-02", "timestamp": 1700370722, "time_this_iter_s": 2.2123029232025146, "time_total_s": 67.01381587982178, "pid": 7608, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17e2642c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 67.01381587982178, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 68.43333333333334, "ram_util_percent": 65.53333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.047318458557129, "actor_loss": -7.650908946990967, "critic_loss": 0.3128112852573395, "alpha_loss": -0.2050359845161438, "alpha_value": 0.9797998070716858, "log_alpha_value": -0.02040703594684601, "target_entropy": -6.0, "policy_t": -0.01432034745812416, "mean_q": 3.7271108627319336, "max_q": 9.265350341796875, "min_q": 3.465482234954834}, "td_error": [3.018932819366455, 1.381146788597107, 0.7790677547454834, 1.4890763759613037, 0.39825499057769775, 1.5307838916778564, 0.7290091514587402, 5.323020935058594, 1.7707650661468506, 0.5615473985671997, 0.5812133550643921, 2.261411666870117, 0.16543614864349365, 3.288177013397217, 2.4451003074645996, 1.1232616901397705, 1.3209176063537598, 1.1348956823349, 1.6880215406417847, 0.5159170627593994, 1.5063025951385498, 0.14971137046813965, 0.32145917415618896, 0.14621615409851074, 1.34786057472229, 4.605729579925537, 1.3650785684585571, 0.5166612863540649, 0.7690030336380005, 0.3552861213684082, 4.202681064605713, 0.31718719005584717, 0.8789592981338501, 1.2130491733551025, 0.5626504421234131, 0.2574958801269531, 0.4286651611328125, 2.0386176109313965, 1.6779334545135498, 1.186566948890686, 0.22713124752044678, 2.2569689750671387, 2.190906047821045, 0.9571346044540405, 1.856311321258545, 0.319943904876709, 2.127498149871826, 0.9061424732208252, 0.8991178274154663, 0.30688273906707764, 0.14506840705871582, 1.1740810871124268, 1.5854899883270264, 1.726292610168457, 0.20596683025360107, 0.14396226406097412, 0.6123768091201782, 1.471375584602356, 0.7835934162139893, 1.135810375213623, 0.564757227897644, 0.149056077003479, 0.39387762546539307, 2.4728965759277344, 2.504406452178955, 1.3009843826293945, 1.674613356590271, 0.48480820655822754, 0.7595651149749756, 0.40348994731903076, 0.5542565584182739, 2.126072883605957, 1.9297561645507812, 0.1946336030960083, 0.708415150642395, 1.476503610610962, 0.47730207443237305, 0.5087487697601318, 0.1422330141067505, 1.7705743312835693, 1.3708724975585938, 0.16774404048919678, 1.1972566843032837, 0.5090831518173218, 0.15350854396820068, 0.4677097797393799], "mean_td_error": 1.1726540327072144, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 69.0, "diff_num_grad_updates_vs_sampler_policy": 68.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.034490585327148, "actor_loss": -6.9559221267700195, "critic_loss": 0.14218392968177795, "alpha_loss": -0.20481382310390472, "alpha_value": 0.9797959327697754, "log_alpha_value": -0.02041098102927208, "target_entropy": -6.0, "policy_t": -0.0728839784860611, "mean_q": 2.872722864151001, "max_q": 2.97287917137146, "min_q": 1.7412482500076294}, "td_error": [0.7743422985076904, 0.0805661678314209, 1.1244301795959473, 1.8037960529327393, 0.9465354681015015, 0.07579290866851807, 1.1913914680480957, 0.04309535026550293, 1.1768054962158203, 1.7291302680969238, 1.7186609506607056, 0.607945442199707, 1.4280266761779785, 0.3914264440536499, 1.2043691873550415, 1.1105672121047974, 0.01336371898651123, 2.3267462253570557, 1.3747018575668335, 0.5222536325454712, 0.24812757968902588, 2.4753994941711426, 0.22071492671966553, 1.1539112329483032, 0.31395745277404785, 1.8923803567886353, 0.2083491086959839, 0.5220431089401245, 2.395575523376465, 0.3829026222229004, 1.1606734991073608, 0.4029303789138794, 2.3359341621398926, 2.725430488586426, 0.3342258930206299, 0.9174771308898926, 1.6499881744384766, 0.7677698135375977, 1.2756688594818115, 1.8054338693618774, 0.14182090759277344, 1.7284232378005981, 0.49510717391967773, 1.4517793655395508, 0.2890625, 2.280374765396118, 0.973322868347168, 0.6754840612411499, 0.35368871688842773, 0.4686543941497803, 1.1453440189361572, 0.4851844310760498, 1.3214613199234009, 0.0455777645111084, 0.17071247100830078, 0.3130384683609009, 0.7704753875732422, 0.16656017303466797, 1.8177576065063477, 1.3764833211898804, 0.9449881315231323, 0.6567013263702393, 1.7547907829284668, 2.4335315227508545, 1.505422830581665, 0.4139082431793213, 0.26668429374694824, 0.6806113719940186, 0.022867202758789062, 2.308871030807495, 0.7117143869400024, 0.44083476066589355, 0.3867233991622925, 0.8443689346313477, 1.9726696014404297, 1.5287647247314453, 0.3652181625366211, 2.7911319732666016, 0.6430792808532715, 1.116316556930542, 0.8146425485610962, 0.8151943683624268, 0.6043075323104858, 0.6647591590881348, 1.6543879508972168, 0.12074315547943115], "mean_td_error": 0.9972835183143616, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 69.0, "diff_num_grad_updates_vs_sampler_policy": 68.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.102696418762207, "actor_loss": -7.007725238800049, "critic_loss": 0.1366950124502182, "alpha_loss": -0.20631004869937897, "alpha_value": 0.9797857999801636, "log_alpha_value": -0.020421285182237625, "target_entropy": -6.0, "policy_t": -0.024848023429512978, "mean_q": 2.9167892932891846, "max_q": 2.986046552658081, "min_q": 2.1596481800079346}, "td_error": [0.6806166172027588, 0.14059722423553467, 0.4959756135940552, 0.19325387477874756, 1.0535272359848022, 0.9553757905960083, 0.5758695602416992, 1.1470072269439697, 0.2825047969818115, 0.5933613777160645, 0.7820630073547363, 1.1638556718826294, 0.4256095886230469, 0.408467173576355, 1.541771650314331, 1.6775779724121094, 0.6977967023849487, 0.5623346567153931, 0.352266788482666, 0.02359640598297119, 0.027274727821350098, 0.20599889755249023, 1.8821303844451904, 0.2978346347808838, 1.3994216918945312, 0.019364356994628906, 0.8684512376785278, 0.6975593566894531, 1.0617930889129639, 0.8555972576141357, 1.21379554271698, 0.32295000553131104, 1.0364946126937866, 0.3437312841415405, 2.3804659843444824, 0.16479790210723877, 1.1503609418869019, 0.24935638904571533, 1.6634153127670288, 0.8250631093978882, 1.5468477010726929, 1.108683705329895, 1.6747455596923828, 0.5173264741897583, 0.32392406463623047, 0.4475080966949463, 0.6580512523651123, 0.587517499923706, 1.2109261751174927, 1.507509708404541, 0.9969474077224731, 0.09242963790893555, 1.4855966567993164, 0.8074641227722168, 0.30004072189331055, 0.9037623405456543, 0.026508331298828125, 0.23925209045410156, 0.07115626335144043, 1.255018949508667, 0.9630205631256104, 0.3706626892089844, 1.0858687162399292, 2.0067853927612305, 0.40957438945770264, 0.3054720163345337, 0.599825382232666, 0.1859743595123291, 0.6011263132095337, 1.207885503768921, 0.6675093173980713, 2.2415966987609863, 0.23243319988250732, 1.0570635795593262, 0.6884651184082031, 1.9071650505065918, 1.041391134262085, 1.648216962814331, 0.051038265228271484, 0.44791650772094727, 0.07748758792877197, 0.11082780361175537, 0.360584020614624, 2.317509651184082, 0.3248635530471802, 0.1222231388092041], "mean_td_error": 0.781546413898468, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 69.0, "diff_num_grad_updates_vs_sampler_policy": 68.0}}, "num_env_steps_sampled": 62720, "num_env_steps_trained": 17802, "num_agent_steps_sampled": 188160, "num_agent_steps_trained": 17802, "last_target_update_ts": 62720, "num_target_updates": 69}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 188160, "num_agent_steps_trained": 17802, "num_env_steps_sampled": 62720, "num_env_steps_trained": 17802, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 669.4936908340327, "num_env_steps_trained_throughput_per_sec": 192.77831722676387, "timesteps_total": 62720, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 188160, "timers": {"training_iteration_time_ms": 1004.321, "sample_time_ms": 723.876, "load_time_ms": 0.312, "load_throughput": 828013.185, "learn_time_ms": 18.391, "learn_throughput": 14028.409, "synch_weights_time_ms": 9.446}, "counters": {"num_env_steps_sampled": 62720, "num_env_steps_trained": 17802, "num_agent_steps_sampled": 188160, "num_agent_steps_trained": 17802, "last_target_update_ts": 62720, "num_target_updates": 69}, "done": false, "episodes_total": 0, "training_iteration": 40, "trial_id": "ff3c2_00000", "date": "2023-11-18_21-12-04", "timestamp": 1700370724, "time_this_iter_s": 1.3472070693969727, "time_total_s": 68.36102294921875, "pid": 7608, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17e2676a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 68.36102294921875, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 62.150000000000006, "ram_util_percent": 65.65}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.078269958496094, "actor_loss": -7.7710747718811035, "critic_loss": 0.2986517548561096, "alpha_loss": -0.20868851244449615, "alpha_value": 0.9795061349868774, "log_alpha_value": -0.0207067783921957, "target_entropy": -6.0, "policy_t": -0.0343128964304924, "mean_q": 3.732290267944336, "max_q": 7.620517730712891, "min_q": 3.486222505569458}, "td_error": [2.162480354309082, 0.8763444423675537, 0.7222863435745239, 1.021488904953003, 0.7782083749771118, 0.8350118398666382, 0.7710434198379517, 0.3082834482192993, 0.1464250087738037, 2.346909523010254, 0.7912981510162354, 1.8724730014801025, 2.7085816860198975, 1.5466281175613403, 1.293889045715332, 1.185119390487671, 0.5899038314819336, 1.9998751878738403, 2.1240551471710205, 1.821170449256897, 0.14856529235839844, 0.4657646417617798, 2.242673873901367, 1.4555342197418213, 1.8369405269622803, 0.8750320672988892, 0.19791960716247559, 2.116515636444092, 3.1199774742126465, 0.2791314125061035, 1.9216248989105225, 0.7053056955337524, 1.6664676666259766, 1.398858904838562, 2.0257515907287598, 0.14673399925231934, 1.1075587272644043, 1.785292148590088, 0.14606261253356934, 0.4471174478530884, 1.3712797164916992, 0.6794427633285522, 1.7518742084503174, 0.48039937019348145, 0.825824499130249, 2.3315086364746094, 0.7630207538604736, 1.7273451089859009, 0.14131081104278564, 1.7291492223739624, 0.5674517154693604, 0.14785254001617432, 0.8004117012023926, 0.14346826076507568, 1.053622841835022, 2.2212650775909424, 1.7266907691955566, 0.6772388219833374, 0.2815178632736206, 0.5358759164810181, 2.8579742908477783, 1.8802220821380615, 1.2479958534240723, 0.5162957906723022, 1.07685124874115, 0.26591944694519043, 0.1758173704147339, 1.8542232513427734, 0.41309940814971924, 1.9817206859588623, 1.7424728870391846, 0.21933841705322266, 0.40794217586517334, 0.7870156764984131, 0.14932751655578613, 0.678600549697876, 0.39494872093200684, 2.4984264373779297, 1.7555572986602783, 0.6307326555252075, 0.988184928894043, 0.9915108680725098, 2.4910054206848145, 1.8866515159606934, 1.0135034322738647, 0.8215607404708862], "mean_td_error": 1.1589971780776978, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 70.0, "diff_num_grad_updates_vs_sampler_policy": 69.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.992243766784668, "actor_loss": -6.92203950881958, "critic_loss": 0.11887261271476746, "alpha_loss": -0.2069418877363205, "alpha_value": 0.9795027375221252, "log_alpha_value": -0.020710252225399017, "target_entropy": -6.0, "policy_t": -0.08177080750465393, "mean_q": 2.8300230503082275, "max_q": 2.9673640727996826, "min_q": 1.6637730598449707}, "td_error": [1.4723584651947021, 0.7341625690460205, 1.0065271854400635, 1.5022374391555786, 0.1276416778564453, 0.964206337928772, 1.1886861324310303, 0.9811677932739258, 2.1065924167633057, 0.589470624923706, 0.26100075244903564, 0.5543099641799927, 2.2977185249328613, 0.47563469409942627, 0.852679967880249, 1.8361839056015015, 0.7779650688171387, 0.31103742122650146, 0.8901269435882568, 1.6223748922348022, 1.7252585887908936, 0.5254356861114502, 1.1555988788604736, 0.38240158557891846, 0.2618107795715332, 0.29066145420074463, 0.2458338737487793, 0.4680575132369995, 1.522681713104248, 0.3892502784729004, 2.7320542335510254, 0.5167655944824219, 0.10351848602294922, 0.9300906658172607, 1.1619027853012085, 1.076533317565918, 0.9967589378356934, 0.38486576080322266, 2.4996910095214844, 0.8998340368270874, 0.32657337188720703, 0.11036133766174316, 0.7248648405075073, 0.701993465423584, 0.07433128356933594, 0.09087848663330078, 1.9695508480072021, 0.8691169023513794, 0.6018677949905396, 1.1567260026931763, 0.5345848798751831, 1.4911400079727173, 2.021669387817383, 0.17953360080718994, 0.3381556272506714, 0.4635668992996216, 0.2011173963546753, 2.0631203651428223, 2.3006629943847656, 0.3626866340637207, 0.13029015064239502, 1.434117078781128, 0.4932820796966553, 0.6320494413375854, 1.1928339004516602, 0.8973367214202881, 0.15590250492095947, 0.22933363914489746, 1.4281766414642334, 0.24168741703033447, 0.9426255226135254, 1.6204540729522705, 0.7207664251327515, 0.8585314750671387, 0.25297343730926514, 0.09566640853881836, 0.07711219787597656, 0.629223108291626, 0.8618024587631226, 0.6771199703216553, 1.4715968370437622, 0.23205673694610596, 1.8522461652755737, 2.4680533409118652, 0.18561923503875732, 1.2116972208023071], "mean_td_error": 0.8883273005485535, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 70.0, "diff_num_grad_updates_vs_sampler_policy": 69.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.11498737335205, "actor_loss": -7.037931442260742, "critic_loss": 0.1589646339416504, "alpha_loss": -0.20959509909152985, "alpha_value": 0.9794919490814209, "log_alpha_value": -0.02072124183177948, "target_entropy": -6.0, "policy_t": -0.03074825555086136, "mean_q": 2.9349958896636963, "max_q": 3.00246524810791, "min_q": 2.1266345977783203}, "td_error": [1.8540074825286865, 2.1428911685943604, 0.672127366065979, 0.5042635202407837, 0.794905424118042, 2.5586538314819336, 1.1159634590148926, 1.2971699237823486, 0.3501863479614258, 0.9315389394760132, 0.42575132846832275, 0.5767965316772461, 2.1711719036102295, 1.2542235851287842, 1.1581645011901855, 0.42741620540618896, 0.3038802146911621, 1.1809550523757935, 0.9827017784118652, 0.19082701206207275, 1.74542236328125, 0.3427159786224365, 0.5657780170440674, 0.036364078521728516, 0.772667407989502, 0.2583855390548706, 0.18455028533935547, 0.22495722770690918, 0.012630105018615723, 0.756653904914856, 0.4125065803527832, 0.507538914680481, 0.8971620798110962, 0.1180107593536377, 2.2786853313446045, 0.2316502332687378, 1.0801267623901367, 1.5960557460784912, 1.220289707183838, 0.3217771053314209, 0.02039945125579834, 1.1824944019317627, 0.3945436477661133, 2.3470311164855957, 1.075596570968628, 0.42983460426330566, 0.41075003147125244, 0.580579400062561, 0.26518046855926514, 0.6681644916534424, 0.09835517406463623, 0.8174082040786743, 1.1160805225372314, 1.0537796020507812, 0.4170311689376831, 0.510689377784729, 0.7882746458053589, 0.8853931427001953, 1.4824812412261963, 1.0981279611587524, 1.4281455278396606, 0.9079548120498657, 1.0221798419952393, 1.7613142728805542, 1.1995434761047363, 0.4688119888305664, 1.2946875095367432, 0.02840864658355713, 2.8542733192443848, 0.9183791875839233, 0.486566424369812, 0.12475275993347168, 0.9123570919036865, 0.5757325887680054, 0.6657723188400269, 0.4515111446380615, 1.1402676105499268, 1.07460618019104, 1.787461280822754, 1.428609013557434, 0.39827215671539307, 0.7060433626174927, 0.6517809629440308, 0.7450207471847534, 1.4809417724609375, 1.1039718389511108], "mean_td_error": 0.8804311752319336, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 70.0, "diff_num_grad_updates_vs_sampler_policy": 69.0}}, "num_env_steps_sampled": 63616, "num_env_steps_trained": 18060, "num_agent_steps_sampled": 190848, "num_agent_steps_trained": 18060, "last_target_update_ts": 63616, "num_target_updates": 70}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 190848, "num_agent_steps_trained": 18060, "num_env_steps_sampled": 63616, "num_env_steps_trained": 18060, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 886.7257827195309, "num_env_steps_trained_throughput_per_sec": 255.32952225629353, "timesteps_total": 63616, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 190848, "timers": {"training_iteration_time_ms": 1018.616, "sample_time_ms": 738.332, "load_time_ms": 0.311, "load_throughput": 830364.052, "learn_time_ms": 18.448, "learn_throughput": 13985.44, "synch_weights_time_ms": 9.561}, "counters": {"num_env_steps_sampled": 63616, "num_env_steps_trained": 18060, "num_agent_steps_sampled": 190848, "num_agent_steps_trained": 18060, "last_target_update_ts": 63616, "num_target_updates": 70}, "done": false, "episodes_total": 0, "training_iteration": 41, "trial_id": "ff3c2_00000", "date": "2023-11-18_21-12-05", "timestamp": 1700370725, "time_this_iter_s": 1.0188260078430176, "time_total_s": 69.37984895706177, "pid": 7608, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17e2642c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 69.37984895706177, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 65.6, "ram_util_percent": 65.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.165698051452637, "actor_loss": -7.93992805480957, "critic_loss": 0.28338682651519775, "alpha_loss": -0.21354588866233826, "alpha_value": 0.9792125821113586, "log_alpha_value": -0.021006515249609947, "target_entropy": -6.0, "policy_t": 0.0348779559135437, "mean_q": 3.9397053718566895, "max_q": 9.897972106933594, "min_q": 3.6843788623809814}, "td_error": [2.0675723552703857, 1.4174861907958984, 1.0391480922698975, 0.4165605306625366, 0.9192682504653931, 0.14336276054382324, 1.4340587854385376, 1.0807338953018188, 0.2633326053619385, 1.2646889686584473, 0.8242917060852051, 3.278649091720581, 0.2606196403503418, 0.41821980476379395, 1.1971315145492554, 0.25869321823120117, 0.3435167074203491, 1.9383676052093506, 0.75447678565979, 1.7513747215270996, 0.14100778102874756, 1.3125925064086914, 1.7175047397613525, 0.8953146934509277, 0.2543671131134033, 0.45732295513153076, 1.3403267860412598, 2.898923873901367, 1.4493070840835571, 0.8384151458740234, 0.39001786708831787, 1.4725903272628784, 0.23938965797424316, 0.48184478282928467, 0.3624460697174072, 0.16382789611816406, 2.0986385345458984, 0.580519437789917, 2.4674220085144043, 0.19399940967559814, 0.44649219512939453, 1.2989355325698853, 4.571201324462891, 1.9471819400787354, 1.3919472694396973, 1.7170714139938354, 2.235240936279297, 1.226337194442749, 0.8151249885559082, 1.161659836769104, 5.077340126037598, 0.5404326915740967, 1.1102739572525024, 0.7193087339401245, 0.41604042053222656, 1.2845098972320557, 0.1468820571899414, 0.9225456714630127, 1.3251659870147705, 1.5450669527053833, 2.4096646308898926, 0.48256731033325195, 0.8229764699935913, 1.8689626455307007, 2.9327192306518555, 1.0367133617401123, 0.6194193363189697, 0.6326414346694946, 1.7757872343063354, 0.567925214767456, 0.6740033626556396, 0.8194608688354492, 0.2156282663345337, 0.48447132110595703, 0.34674012660980225, 0.1725839376449585, 1.0336943864822388, 0.820371150970459, 1.1968411207199097, 0.1406545639038086, 1.1301178932189941, 0.5611540079116821, 0.8034467697143555, 0.6639020442962646, 1.809218406677246, 2.0207362174987793], "mean_td_error": 1.1252150535583496, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 71.0, "diff_num_grad_updates_vs_sampler_policy": 70.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.079140663146973, "actor_loss": -6.901166915893555, "critic_loss": 0.11863791942596436, "alpha_loss": -0.21175597608089447, "alpha_value": 0.979209840297699, "log_alpha_value": -0.021009329706430435, "target_entropy": -6.0, "policy_t": -0.040426936000585556, "mean_q": 2.7834837436676025, "max_q": 2.9415900707244873, "min_q": 1.6433985233306885}, "td_error": [0.4710965156555176, 0.17206346988677979, 0.9647533893585205, 0.8516875505447388, 0.6436076164245605, 1.4689629077911377, 1.820050835609436, 0.09708106517791748, 0.26933348178863525, 0.8893855810165405, 0.6143336296081543, 1.1000186204910278, 2.8047447204589844, 0.7213118076324463, 0.25583207607269287, 0.3863368034362793, 1.6909677982330322, 0.12003719806671143, 0.2514979839324951, 0.46595263481140137, 0.7977478504180908, 0.9008985757827759, 0.8523316383361816, 0.23699069023132324, 0.33579492568969727, 3.3366360664367676, 0.2585715055465698, 2.1536738872528076, 0.5754601359367371, 2.1607275009155273, 0.508267879486084, 0.9503817558288574, 0.4478796720504761, 0.49152112007141113, 1.9056222438812256, 0.2427504062652588, 0.509597897529602, 0.49710142612457275, 1.2888363599777222, 0.560875415802002, 1.3300015926361084, 0.14832043647766113, 1.4977483749389648, 0.9972363710403442, 0.6771092414855957, 0.48513901233673096, 0.06266248226165771, 2.0012168884277344, 0.06046247482299805, 0.6579569578170776, 0.6082061529159546, 3.174621105194092, 0.8864079713821411, 1.0719873905181885, 0.6648411750793457, 0.8912996053695679, 1.3014795780181885, 0.09195506572723389, 0.8977973461151123, 1.5126270055770874, 1.296337366104126, 0.41684389114379883, 0.7842427492141724, 0.5840785503387451, 1.0164252519607544, 1.1071361303329468, 0.19613385200500488, 0.47090184688568115, 1.61336088180542, 0.09602522850036621, 1.7734194993972778, 0.01157677173614502, 1.0115848779678345, 0.5232969522476196, 0.3552283048629761, 0.3296257257461548, 1.3970917463302612, 1.584490418434143, 1.8994216918945312, 0.01107335090637207, 0.2478545904159546, 1.750319004058838, 1.0142512321472168, 0.7411074638366699, 0.6714121103286743, 1.7853795289993286], "mean_td_error": 0.8927723169326782, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 71.0, "diff_num_grad_updates_vs_sampler_policy": 70.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.009449005126953, "actor_loss": -6.9581708908081055, "critic_loss": 0.16621911525726318, "alpha_loss": -0.21041102707386017, "alpha_value": 0.979198157787323, "log_alpha_value": -0.021021241322159767, "target_entropy": -6.0, "policy_t": -0.04756375774741173, "mean_q": 2.890864610671997, "max_q": 3.00917649269104, "min_q": 2.0473039150238037}, "td_error": [0.6766586303710938, 0.2440422773361206, 0.14639043807983398, 0.35242486000061035, 0.24358582496643066, 1.1980782747268677, 1.1041523218154907, 0.8640429973602295, 0.046790361404418945, 2.726790428161621, 0.4902966022491455, 1.0042266845703125, 0.88336181640625, 0.44134390354156494, 3.3817009925842285, 0.31566286087036133, 0.050797343254089355, 0.9284427165985107, 1.2295036315917969, 0.35164451599121094, 1.2146869897842407, 0.9679219722747803, 0.9128671884536743, 1.9475550651550293, 1.4391478300094604, 0.15334105491638184, 1.733212947845459, 0.1724492311477661, 0.2816845178604126, 2.2727279663085938, 1.0276730060577393, 0.0382462739944458, 0.8240958452224731, 0.30255651473999023, 1.046082854270935, 1.3534305095672607, 2.280250310897827, 1.4698054790496826, 0.17272263765335083, 0.30978715419769287, 0.5006115436553955, 0.6850020885467529, 1.2254135608673096, 0.3423088788986206, 0.44417667388916016, 0.5493919849395752, 0.8307555913925171, 0.6541955471038818, 2.021120071411133, 0.7245892286300659, 0.16867876052856445, 0.7485246658325195, 0.8022488355636597, 1.4417003393173218, 1.265243649482727, 0.6792585849761963, 2.7508604526519775, 0.1027294397354126, 0.1821962594985962, 1.2467784881591797, 0.8774441480636597, 0.975503146648407, 0.405816912651062, 1.313193440437317, 0.3304790258407593, 0.5783988237380981, 0.07567620277404785, 0.49563562870025635, 0.7251678705215454, 0.301344633102417, 1.058326244354248, 0.31506168842315674, 0.5037405490875244, 1.243309497833252, 0.7449600696563721, 3.133103847503662, 0.8108546733856201, 0.2182772159576416, 1.0929536819458008, 0.9882781505584717, 2.5667402744293213, 0.1583627462387085, 0.032212257385253906, 1.5030109882354736, 0.5356090068817139, 1.1403197050094604], "mean_td_error": 0.884764552116394, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 71.0, "diff_num_grad_updates_vs_sampler_policy": 70.0}}, "num_env_steps_sampled": 64512, "num_env_steps_trained": 18318, "num_agent_steps_sampled": 193536, "num_agent_steps_trained": 18318, "last_target_update_ts": 64512, "num_target_updates": 71}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 193536, "num_agent_steps_trained": 18318, "num_env_steps_sampled": 64512, "num_env_steps_trained": 18318, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 879.5549406994365, "num_env_steps_trained_throughput_per_sec": 253.2647039067574, "timesteps_total": 64512, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 193536, "timers": {"training_iteration_time_ms": 1032.614, "sample_time_ms": 751.963, "load_time_ms": 0.309, "load_throughput": 835557.433, "learn_time_ms": 18.581, "learn_throughput": 13884.806, "synch_weights_time_ms": 9.742}, "counters": {"num_env_steps_sampled": 64512, "num_env_steps_trained": 18318, "num_agent_steps_sampled": 193536, "num_agent_steps_trained": 18318, "last_target_update_ts": 64512, "num_target_updates": 71}, "done": false, "episodes_total": 0, "training_iteration": 42, "trial_id": "ff3c2_00000", "date": "2023-11-18_21-12-06", "timestamp": 1700370726, "time_this_iter_s": 1.0287489891052246, "time_total_s": 70.40859794616699, "pid": 7608, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x17c1ab060>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 70.40859794616699, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 76.55000000000001, "ram_util_percent": 65.7}}
