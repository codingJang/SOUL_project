{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 896, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2688, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2688, "num_agent_steps_trained": 0, "num_env_steps_sampled": 896, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 639.7646216854556, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 896, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2688, "timers": {"training_iteration_time_ms": 1400.492, "sample_time_ms": 823.792}, "counters": {"num_env_steps_sampled": 896, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2688, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 1, "trial_id": "a2ad0_00000", "date": "2023-11-18_21-01-11", "timestamp": 1700370071, "time_this_iter_s": 1.4053549766540527, "time_total_s": 1.4053549766540527, "pid": 6505, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x154272480>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 1.4053549766540527, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 41.733333333333334, "ram_util_percent": 65.76666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.020830154418945, "actor_loss": -4.0225396156311035, "critic_loss": 4.026704788208008, "alpha_loss": 0.0, "alpha_value": 1.0, "log_alpha_value": 0.0, "target_entropy": -6.0, "policy_t": -0.01088716834783554, "mean_q": 0.0006044458714313805, "max_q": 0.0011292040580883622, "min_q": -0.009947529062628746}, "td_error": [6.021307468414307, 3.337042808532715, 4.367249488830566, 3.6378438472747803, 5.599454879760742, 3.0204100608825684, 4.101679801940918, 4.9700727462768555, 4.855508804321289, 4.668630599975586, 6.7893476486206055, 3.8389291763305664, 3.6347873210906982, 4.160717010498047, 6.253580093383789, 4.2599992752075195, 6.430886745452881, 5.777321815490723, 5.10130500793457, 6.036690711975098, 3.3326287269592285, 3.1579411029815674, 5.559935569763184, 2.498371124267578, 5.997650623321533, 4.0248918533325195, 4.852538108825684, 4.595983505249023, 4.02193546295166, 4.161336898803711, 3.6359848976135254, 5.722689628601074, 4.643864631652832, 4.546767711639404, 4.34976863861084, 4.309098243713379, 4.312810897827148, 4.575787544250488, 5.978196620941162, 3.35333251953125, 4.792177200317383, 4.182567119598389, 4.092364311218262, 4.614628791809082, 3.4284298419952393, 5.161438941955566, 4.868268013000488, 3.878993034362793, 4.145543098449707, 3.687105655670166, 2.826416254043579, 2.884425163269043, 3.796412944793701, 4.652890205383301, 2.9557809829711914, 4.279367446899414, 5.1342668533325195, 6.558525085449219, 5.929274559020996, 3.287806987762451, 4.338088035583496, 4.182966709136963, 6.241674900054932, 4.030825614929199, 4.116911888122559, 3.367126941680908, 5.632635116577148, 3.554915428161621, 2.9785096645355225, 3.369772434234619, 5.194339752197266, 8.24102783203125, 2.8381900787353516, 5.984734535217285, 5.645750999450684, 4.645306587219238, 2.683156728744507, 5.206286430358887, 5.883852005004883, 2.783116340637207, 4.386688232421875, 6.620817184448242, 2.1854310035705566, 4.931539058685303, 6.01983118057251, 4.582179069519043], "mean_td_error": 4.526704788208008, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1.0, "diff_num_grad_updates_vs_sampler_policy": 0.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.018778800964355, "actor_loss": -4.01946496963501, "critic_loss": 2.2646853923797607, "alpha_loss": 0.0, "alpha_value": 1.0, "log_alpha_value": 0.0, "target_entropy": -6.0, "policy_t": 0.05505888909101486, "mean_q": 0.003038684604689479, "max_q": 0.02913939580321312, "min_q": 0.0010642375564202666}, "td_error": [2.245914936065674, 2.2243967056274414, 3.644195556640625, 4.822321891784668, 3.749387741088867, 1.9763562679290771, 4.136731147766113, 1.541675090789795, 1.2756142616271973, 2.8454232215881348, 4.495855331420898, 3.252549648284912, 3.5706820487976074, 1.6827335357666016, 2.209599256515503, 1.8217860460281372, 4.307952880859375, 3.0262045860290527, 2.027214527130127, 3.7830028533935547, 1.7762320041656494, 1.9413399696350098, 3.2750115394592285, 3.570800542831421, 1.8200335502624512, 3.2259140014648438, 2.8282949924468994, 2.942734718322754, 0.45527732372283936, 3.424851894378662, 3.711759090423584, 1.9311116933822632, 0.14167851209640503, 3.5727481842041016, 2.3043837547302246, 2.756715774536133, 3.128302812576294, 2.466519832611084, 3.59724497795105, 0.9851872324943542, 3.2109780311584473, 1.336744785308838, 1.4043618440628052, 2.3072848320007324, 3.4898993968963623, 1.9933770895004272, 1.8712360858917236, 0.7706845998764038, 2.725436210632324, 1.7898643016815186, 3.540870189666748, 0.9770830869674683, 1.8729443550109863, 3.772456407546997, 4.260746955871582, 0.9687070846557617, 1.9947686195373535, 3.9908571243286133, 2.579864501953125, 3.7605667114257812, 3.2473177909851074, 3.549586534500122, 2.1448371410369873, 3.7829551696777344, 1.7938792705535889, 2.619515895843506, 2.331434965133667, 2.2240490913391113, 2.780813217163086, 4.638864517211914, 2.4017081260681152, 4.024102210998535, 2.3768694400787354, 4.088078498840332, 3.350924015045166, 5.087907791137695, 3.1461918354034424, 3.1784281730651855, 3.064453125, 3.1113357543945312, 4.011300563812256, 3.373185157775879, 2.595275402069092, 1.374830722808838, 4.529558181762695, 1.2771964073181152], "mean_td_error": 2.7583611011505127, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1.0, "diff_num_grad_updates_vs_sampler_policy": 0.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.04284381866455, "actor_loss": -4.0407395362854, "critic_loss": 2.26615571975708, "alpha_loss": 0.0, "alpha_value": 1.0, "log_alpha_value": 0.0, "target_entropy": -6.0, "policy_t": 0.005377253983169794, "mean_q": -0.0019095599418506026, "max_q": -0.0010674779769033194, "min_q": -0.022629350423812866}, "td_error": [3.4863476753234863, 1.398756742477417, 2.706899642944336, 2.0193185806274414, 3.8923263549804688, 4.933403015136719, 4.9778947830200195, 4.625512599945068, 1.6542994976043701, 4.908944606781006, 1.2970201969146729, 1.438549280166626, 2.3640964031219482, 1.6416106224060059, 2.4339096546173096, 1.0943667888641357, 4.346087455749512, 4.496887683868408, 3.1936044692993164, 3.7629261016845703, 1.5261703729629517, 1.8271112442016602, 2.4464199542999268, 3.2054829597473145, 2.4822845458984375, 4.129067420959473, 2.0363945960998535, 2.819453477859497, 2.753031015396118, 2.7721738815307617, 3.6692867279052734, 4.010910987854004, 2.343106746673584, 1.3069870471954346, 4.348538398742676, 1.5951683521270752, 1.769845962524414, 2.622852087020874, 3.6116323471069336, 4.564556121826172, 4.726593017578125, 3.386678695678711, 4.059334754943848, 2.916961193084717, 2.4267420768737793, 2.4732675552368164, 1.4618701934814453, 2.474424362182617, 3.1089165210723877, 3.6802845001220703, 3.180302143096924, 1.1222294569015503, 0.5426947474479675, 2.5357823371887207, 3.769275188446045, 3.8443198204040527, 2.5660858154296875, 1.6341657638549805, 0.6802404522895813, 2.9032931327819824, 3.2219300270080566, 2.404984951019287, 2.1485304832458496, 3.07309627532959, 2.9103236198425293, 3.0177507400512695, 2.323493003845215, 1.7233588695526123, 3.8996663093566895, 4.384005069732666, 1.4618569612503052, 1.5823709964752197, 2.272716999053955, 1.8886761665344238, 3.257251739501953, 1.7557973861694336, 2.428086996078491, 1.6958036422729492, 4.697628974914551, 4.946926116943359, 0.7877554893493652, 2.143756866455078, 1.7442522048950195, 3.792478084564209, 1.324317216873169, 2.8176822662353516], "mean_td_error": 2.7640836238861084, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1.0, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 1792, "num_env_steps_trained": 258, "num_agent_steps_sampled": 5376, "num_agent_steps_trained": 258, "last_target_update_ts": 1792, "num_target_updates": 1}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5376, "num_agent_steps_trained": 258, "num_env_steps_sampled": 1792, "num_env_steps_trained": 258, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 812.1827714475155, "num_env_steps_trained_throughput_per_sec": 233.86512838555691, "timesteps_total": 1792, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 5376, "timers": {"training_iteration_time_ms": 1251.822, "sample_time_ms": 818.199, "load_time_ms": 0.308, "load_throughput": 837562.254, "learn_time_ms": 42.195, "learn_throughput": 6114.491, "synch_weights_time_ms": 8.954}, "counters": {"num_env_steps_sampled": 1792, "num_env_steps_trained": 258, "num_agent_steps_sampled": 5376, "num_agent_steps_trained": 258, "last_target_update_ts": 1792, "num_target_updates": 1}, "done": false, "episodes_total": 0, "training_iteration": 2, "trial_id": "a2ad0_00000", "date": "2023-11-18_21-01-13", "timestamp": 1700370073, "time_this_iter_s": 1.1134872436523438, "time_total_s": 2.5188422203063965, "pid": 6505, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x154273740>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 2.5188422203063965, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 93.9, "ram_util_percent": 65.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.964476585388184, "actor_loss": -3.9800169467926025, "critic_loss": 3.9514780044555664, "alpha_loss": -0.002989343134686351, "alpha_value": 0.9997000694274902, "log_alpha_value": -0.00029999998514540493, "target_entropy": -6.0, "policy_t": 0.014171131886541843, "mean_q": 0.018035754561424255, "max_q": 0.15264756977558136, "min_q": 0.013323498889803886}, "td_error": [6.35573148727417, 6.4412336349487305, 4.77229642868042, 4.716662406921387, 5.967137336730957, 5.727843761444092, 4.247321605682373, 4.69356107711792, 4.80971622467041, 5.398129940032959, 5.197572231292725, 3.983689785003662, 5.646449089050293, 4.736286640167236, 6.002432823181152, 5.252184867858887, 4.916047096252441, 3.5539088249206543, 5.4554266929626465, 4.839592933654785, 5.082008361816406, 3.3262763023376465, 4.305528163909912, 5.055891036987305, 6.178958415985107, 3.500365972518921, 4.070293426513672, 5.190202713012695, 4.4462738037109375, 3.5411903858184814, 2.9717302322387695, 4.19919490814209, 5.36461877822876, 3.419097423553467, 6.366168975830078, 2.3099589347839355, 4.7199554443359375, 4.822750091552734, 5.231819152832031, 4.66801643371582, 3.10036039352417, 4.280301094055176, 5.457401275634766, 3.6918728351593018, 5.104031562805176, 4.165898323059082, 5.126971244812012, 5.062830924987793, 4.58106803894043, 4.658459186553955, 4.562129974365234, 4.223626136779785, 6.305922985076904, 5.032498359680176, 3.498985528945923, 4.661103248596191, 2.8330860137939453, 4.885048866271973, 4.411670684814453, 4.419953346252441, 3.404324531555176, 5.948651313781738, 4.181526184082031, 3.9704864025115967, 2.054743766784668, 4.514362335205078, 5.110265731811523, 4.4875383377075195, 4.142345428466797, 5.39837646484375, 2.5236849784851074, 3.5725035667419434, 2.3887128829956055, 5.338352680206299, 3.658863067626953, 5.229699611663818, 5.018304824829102, 4.907989501953125, 5.125255584716797, 4.649110794067383, 5.77164363861084, 3.5809919834136963, 5.061260223388672, 4.1590728759765625, 5.232134819030762, 3.0028493404388428], "mean_td_error": 4.581161022186279, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 2.0, "diff_num_grad_updates_vs_sampler_policy": 1.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.13094711303711, "actor_loss": -4.1450724601745605, "critic_loss": 1.2850611209869385, "alpha_loss": -0.003039283910766244, "alpha_value": 0.9997000694274902, "log_alpha_value": -0.00029999998514540493, "target_entropy": -6.0, "policy_t": 0.025861142203211784, "mean_q": 0.02268684282898903, "max_q": 0.17162758111953735, "min_q": 0.013710126280784607}, "td_error": [2.215481996536255, 3.1349081993103027, 1.0746040344238281, 2.6949400901794434, 2.373525857925415, 1.413944125175476, 4.164492607116699, 2.315225601196289, 1.2734663486480713, 2.5488762855529785, 2.845250129699707, 3.8788695335388184, 1.9810631275177002, 1.6000802516937256, 3.6520209312438965, 3.620798110961914, 0.6639766693115234, 4.575967311859131, 3.5120697021484375, 3.3145527839660645, 1.8032307624816895, 3.365920066833496, 1.8446955680847168, 2.3300352096557617, 0.88252854347229, 1.0456181764602661, 2.697077751159668, 4.017467498779297, 4.388794898986816, 3.1795005798339844, 3.0382914543151855, 0.19979453086853027, 3.0367231369018555, 2.992375612258911, 2.7537055015563965, 2.276423454284668, 2.281464099884033, 2.3364856243133545, 2.12296724319458, 2.8350086212158203, 3.46273136138916, 2.3491101264953613, 4.058475494384766, 1.843133807182312, 1.8804442882537842, 0.035894446074962616, 2.2136340141296387, 1.0389845371246338, 3.447506904602051, 1.5390013456344604, 2.283597230911255, 1.5548584461212158, 4.33965539932251, 2.7399282455444336, 3.155562400817871, 1.8057143688201904, 2.4253644943237305, 3.125856399536133, 2.1386351585388184, 3.878972053527832, 2.856445550918579, 1.650907278060913, 1.8653815984725952, 1.4185327291488647, 1.1417262554168701, 4.386126518249512, 2.3170576095581055, 2.0238523483276367, 4.397154331207275, 1.8879423141479492, 3.974184989929199, 2.4988815784454346, 1.8093472719192505, 1.571678638458252, 3.788526773452759, 4.41927433013916, 3.3466386795043945, 2.9333338737487793, 3.53490948677063, 4.069267272949219, 2.148024082183838, 1.7145881652832031, 3.34572696685791, 3.1369500160217285, 0.4364192485809326, 2.4150137901306152], "mean_td_error": 2.5661299228668213, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 2.0, "diff_num_grad_updates_vs_sampler_policy": 1.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.057341575622559, "actor_loss": -4.068741321563721, "critic_loss": 1.9140052795410156, "alpha_loss": -0.0030172027181833982, "alpha_value": 0.9997000694274902, "log_alpha_value": -0.00029999998514540493, "target_entropy": -6.0, "policy_t": -0.008956498466432095, "mean_q": 0.015861058607697487, "max_q": 0.12819617986679077, "min_q": 0.01126802060753107}, "td_error": [2.975551128387451, 1.4320261478424072, 3.005852699279785, 1.1077065467834473, 4.246825218200684, 2.7406957149505615, 3.3698487281799316, 3.2009708881378174, 3.6682307720184326, 4.575709819793701, 0.1292000114917755, 2.2330689430236816, 2.5817222595214844, 3.925206422805786, 2.7306668758392334, 2.179661273956299, 2.1888656616210938, 1.6787919998168945, 2.8426272869110107, 2.131875991821289, 3.4993362426757812, 0.92069411277771, 2.661747455596924, 3.4857311248779297, 3.365532875061035, 2.77810001373291, 3.5872573852539062, 4.144810676574707, 1.8880960941314697, 3.248098611831665, 1.8289384841918945, 1.7714428901672363, 2.6718688011169434, 2.9223062992095947, 0.8418556451797485, 1.8482258319854736, 3.49874210357666, 2.6944355964660645, 3.1891140937805176, 2.3284974098205566, 3.3266282081604004, 4.478549957275391, 2.131666421890259, 2.0013558864593506, 2.9117965698242188, 2.580695629119873, 3.0099239349365234, 2.4034056663513184, 3.029017448425293, 3.9545745849609375, 1.8720438480377197, 1.6641411781311035, 0.972130537033081, 4.608083724975586, 0.34964311122894287, 2.0243916511535645, 2.984041690826416, 4.4403767585754395, 2.3708760738372803, 2.8604049682617188, 1.1673179864883423, 2.568389892578125, 2.963858127593994, 3.742100238800049, 2.229948043823242, 3.0081965923309326, 2.802969455718994, 3.882606029510498, 1.7610046863555908, 0.7522656917572021, 3.42691707611084, 3.1015493869781494, 1.8824892044067383, 3.21303129196167, 2.433320999145508, 1.6944491863250732, 4.017393112182617, 3.414505958557129, 2.519105911254883, 4.9333906173706055, 2.356588840484619, 3.2791621685028076, 4.897332191467285, 3.976593255996704, 3.2411656379699707, 2.6280126571655273], "mean_td_error": 2.7440390586853027, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 2.0, "diff_num_grad_updates_vs_sampler_policy": 1.0}}, "num_env_steps_sampled": 2688, "num_env_steps_trained": 516, "num_agent_steps_sampled": 8064, "num_agent_steps_trained": 516, "last_target_update_ts": 2688, "num_target_updates": 2}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8064, "num_agent_steps_trained": 516, "num_env_steps_sampled": 2688, "num_env_steps_trained": 516, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 893.7413039631821, "num_env_steps_trained_throughput_per_sec": 257.34961654296984, "timesteps_total": 2688, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 8064, "timers": {"training_iteration_time_ms": 1168.713, "sample_time_ms": 792.612, "load_time_ms": 0.31, "load_throughput": 833369.605, "learn_time_ms": 30.759, "learn_throughput": 8387.828, "synch_weights_time_ms": 9.185}, "counters": {"num_env_steps_sampled": 2688, "num_env_steps_trained": 516, "num_agent_steps_sampled": 8064, "num_agent_steps_trained": 516, "last_target_update_ts": 2688, "num_target_updates": 2}, "done": false, "episodes_total": 0, "training_iteration": 3, "trial_id": "a2ad0_00000", "date": "2023-11-18_21-01-14", "timestamp": 1700370074, "time_this_iter_s": 1.0139319896697998, "time_total_s": 3.5327742099761963, "pid": 6505, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x154272de0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 3.5327742099761963, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 58.25, "ram_util_percent": 65.69999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.042583465576172, "actor_loss": -4.071438312530518, "critic_loss": 3.788466215133667, "alpha_loss": -0.006025095470249653, "alpha_value": 0.9994001984596252, "log_alpha_value": -0.0005999546847306192, "target_entropy": -6.0, "policy_t": 0.02226516231894493, "mean_q": 0.04670785367488861, "max_q": 0.3835582137107849, "min_q": 0.02566651999950409}, "td_error": [3.4120588302612305, 4.532511234283447, 5.812648773193359, 4.34179162979126, 4.906983375549316, 3.9802300930023193, 4.880216598510742, 4.933917999267578, 4.576118469238281, 5.201272964477539, 3.892167091369629, 3.1095545291900635, 4.235161781311035, 5.523892402648926, 5.399533271789551, 4.264423370361328, 6.990325927734375, 3.4193015098571777, 3.589343547821045, 6.307056427001953, 3.0352799892425537, 3.157430648803711, 4.599491119384766, 5.31793212890625, 4.154879093170166, 4.762630462646484, 4.955098628997803, 3.786774158477783, 4.992985725402832, 4.418532371520996, 3.4813153743743896, 5.344261169433594, 4.723471641540527, 4.510771751403809, 4.229226589202881, 5.4926862716674805, 3.560530662536621, 4.109475135803223, 5.431413650512695, 3.2907958030700684, 2.8922924995422363, 5.1373114585876465, 3.9832980632781982, 5.710855484008789, 3.7698068618774414, 5.718572616577148, 4.721688270568848, 5.109153747558594, 3.141817808151245, 4.49575138092041, 4.430747032165527, 3.523477077484131, 2.86415958404541, 5.291252136230469, 4.296154022216797, 4.780266761779785, 4.930139541625977, 4.913354873657227, 3.3993453979492188, 3.5328078269958496, 5.1390252113342285, 5.336328983306885, 5.333325386047363, 4.979167938232422, 4.716961860656738, 5.379017353057861, 5.536262512207031, 4.094050407409668, 4.585556507110596, 5.516860008239746, 3.8209853172302246, 2.612570285797119, 3.4298272132873535, 0.540092945098877, 4.271175384521484, 4.030218124389648, 4.907529830932617, 3.782470464706421, 3.8421294689178467, 3.1440529823303223, 2.327291488647461, 4.086684226989746, 4.019417762756348, 4.680351257324219, 5.894876480102539, 5.209873199462891], "mean_td_error": 4.401416778564453, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 3.0, "diff_num_grad_updates_vs_sampler_policy": 2.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.023300170898438, "actor_loss": -4.050302982330322, "critic_loss": 0.8943381309509277, "alpha_loss": -0.006014805752784014, "alpha_value": 0.9994000792503357, "log_alpha_value": -0.0006000824505463243, "target_entropy": -6.0, "policy_t": -0.016026778146624565, "mean_q": 0.03644505888223648, "max_q": 0.341922789812088, "min_q": 0.025938453152775764}, "td_error": [1.57247793674469, 3.675352096557617, 3.286886215209961, 1.7769782543182373, 1.8575639724731445, 0.9183630347251892, 0.6893465518951416, 3.9555771350860596, 2.576693058013916, 3.0123770236968994, 3.05574107170105, 3.0421810150146484, 2.3984169960021973, 2.483710765838623, 4.877228736877441, 3.1646313667297363, 1.446723222732544, 1.8830534219741821, 3.2851264476776123, 3.6775293350219727, 2.13873291015625, 3.18194580078125, 4.33447265625, 2.675708293914795, 3.350527763366699, 3.444990396499634, 3.1429286003112793, 1.9714325666427612, 2.891894817352295, 1.1817359924316406, 1.194894790649414, 3.148848533630371, 1.7697348594665527, 3.4289443492889404, 1.508962631225586, 1.4443165063858032, 2.755682945251465, 3.0937626361846924, 2.480587959289551, 3.3582494258880615, 2.958029270172119, 1.8204280138015747, 3.1801223754882812, 1.4010822772979736, 1.9669413566589355, 3.479336977005005, 1.4554086923599243, 1.9923384189605713, 2.627444267272949, 1.3601744174957275, 1.8351166248321533, 2.3175225257873535, 2.141798973083496, 2.557504177093506, 2.4136836528778076, 2.001039743423462, 2.4218215942382812, 3.0103464126586914, 4.524621486663818, 2.5950510501861572, 0.3030734360218048, 2.0098276138305664, 1.9909741878509521, 3.0065276622772217, 3.7743334770202637, 2.774498224258423, 1.493294358253479, 3.670841693878174, 4.0001983642578125, 1.5308505296707153, 0.5508577227592468, 2.259272813796997, 3.8360819816589355, 3.1264894008636475, 1.827970266342163, 2.975294828414917, 1.2200987339019775, 4.066897392272949, 1.9335734844207764, 1.3660333156585693, 2.5507431030273438, 3.6299943923950195, 3.6060338020324707, 1.2118823528289795, 2.6085093021392822, 2.5891427993774414], "mean_td_error": 2.524505138397217, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 3.0, "diff_num_grad_updates_vs_sampler_policy": 2.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.142637252807617, "actor_loss": -4.167009353637695, "critic_loss": 1.332535743713379, "alpha_loss": -0.006085696630179882, "alpha_value": 0.9994001984596252, "log_alpha_value": -0.0006000112043693662, "target_entropy": -6.0, "policy_t": 0.018567152321338654, "mean_q": 0.042891982942819595, "max_q": 0.3079802393913269, "min_q": 0.023692918941378593}, "td_error": [0.3916848301887512, 1.7436943054199219, 3.0934064388275146, 2.1443376541137695, 2.4763755798339844, 1.338793396949768, 4.109404563903809, 3.6788430213928223, 0.9282940626144409, 3.1097829341888428, 2.1014528274536133, 2.8596577644348145, 5.151473522186279, 3.354412078857422, 3.101106882095337, 1.7325721979141235, 3.944039821624756, 4.147410869598389, 2.2933051586151123, 1.7373608350753784, 3.4115395545959473, 4.224660873413086, 3.0928821563720703, 3.340616464614868, 1.837267279624939, 3.1761536598205566, 0.3185311257839203, 0.7319386005401611, 1.7276041507720947, 3.9631147384643555, 3.6339240074157715, 3.494845390319824, 3.119267225265503, 3.4797072410583496, 3.5363171100616455, 2.340852975845337, 4.155725479125977, 2.249516010284424, 4.649545669555664, 1.6450083255767822, 2.4705381393432617, 0.7436797618865967, 3.2153823375701904, 4.989618301391602, 4.298938274383545, 2.4253852367401123, 3.5253660678863525, 2.927224636077881, 1.2841925621032715, 2.6932854652404785, 1.738879919052124, 3.4928834438323975, 2.3653740882873535, 3.7563483715057373, 1.7394278049468994, 3.584963798522949, 3.7976975440979004, 2.207751750946045, 2.7888312339782715, 2.0443332195281982, 0.5957586765289307, 2.555903434753418, 1.824108600616455, 2.2339847087860107, 0.7038773894309998, 3.665581226348877, 1.0031743049621582, 4.316948890686035, 1.7895524501800537, 3.0190181732177734, 2.6648635864257812, 1.405813455581665, 2.76228666305542, 3.868999481201172, 2.527001142501831, 2.915283441543579, 3.710418462753296, 3.1834864616394043, 1.3653035163879395, 1.2188594341278076, 3.0842485427856445, 4.592288017272949, 2.101647138595581, 3.7389297485351562, 3.254826545715332, 3.401275157928467], "mean_td_error": 2.7344179153442383, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 3.0, "diff_num_grad_updates_vs_sampler_policy": 2.0}}, "num_env_steps_sampled": 3584, "num_env_steps_trained": 774, "num_agent_steps_sampled": 10752, "num_agent_steps_trained": 774, "last_target_update_ts": 3584, "num_target_updates": 3}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10752, "num_agent_steps_trained": 774, "num_env_steps_sampled": 3584, "num_env_steps_trained": 774, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 711.8105594520828, "num_env_steps_trained_throughput_per_sec": 204.96330841365778, "timesteps_total": 3584, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 10752, "timers": {"training_iteration_time_ms": 1191.214, "sample_time_ms": 807.81, "load_time_ms": 0.313, "load_throughput": 823330.28, "learn_time_ms": 26.603, "learn_throughput": 9698.073, "synch_weights_time_ms": 9.519}, "counters": {"num_env_steps_sampled": 3584, "num_env_steps_trained": 774, "num_agent_steps_sampled": 10752, "num_agent_steps_trained": 774, "last_target_update_ts": 3584, "num_target_updates": 3}, "done": false, "episodes_total": 0, "training_iteration": 4, "trial_id": "a2ad0_00000", "date": "2023-11-18_21-01-15", "timestamp": 1700370075, "time_this_iter_s": 1.2673041820526123, "time_total_s": 4.800078392028809, "pid": 6505, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x154272e80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 4.800078392028809, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 88.5, "ram_util_percent": 66.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.049765586853027, "actor_loss": -4.107093334197998, "critic_loss": 3.3754491806030273, "alpha_loss": -0.012061181478202343, "alpha_value": 0.9988005757331848, "log_alpha_value": -0.0012001455761492252, "target_entropy": -6.0, "policy_t": 0.006608218885958195, "mean_q": 0.11231272667646408, "max_q": 0.8086491823196411, "min_q": 0.05189231038093567}, "td_error": [4.897337913513184, 5.087681770324707, 4.729743003845215, 4.739993572235107, 3.745067596435547, 5.4373626708984375, 3.3077874183654785, 5.70927619934082, 4.135571479797363, 5.253085136413574, 4.174051284790039, 5.189601898193359, 3.3132147789001465, 6.597601890563965, 6.852140426635742, 4.486961841583252, 4.969722747802734, 5.933435916900635, 6.860202312469482, 5.0169267654418945, 5.4589948654174805, 5.225316047668457, 4.6360039710998535, 4.781474590301514, 3.4851088523864746, 3.4002597332000732, 5.263786792755127, 3.977848529815674, 6.0295562744140625, 2.3587265014648438, 5.266521453857422, 4.34946346282959, 6.323633193969727, 5.732027053833008, 4.233027458190918, 6.68935489654541, 5.189740180969238, 4.024685859680176, 5.413577079772949, 4.633559226989746, 4.512029647827148, 4.082993507385254, 3.8682355880737305, 3.9235706329345703, 6.499547958374023, 2.9925386905670166, 6.619622707366943, 6.366994857788086, 1.9827104806900024, 4.855503082275391, 3.0850255489349365, 4.162104606628418, 3.0114035606384277, 5.457151412963867, 3.9420111179351807, 3.2823474407196045, 4.407407760620117, 3.535238742828369, 4.494205951690674, 4.779002666473389, 5.097375392913818, 4.523013114929199, 4.864160537719727, 5.652148246765137, 3.4085874557495117, 4.44456672668457, 6.957559585571289, 3.000206232070923, 1.686124563217163, 5.919663429260254, 2.5985708236694336, 3.1226413249969482, 5.411553382873535, 3.9685676097869873, 4.9253997802734375, 4.055697441101074, 6.510693073272705, 4.94840669631958, 5.503520965576172, 6.3013105392456055, 5.19012451171875, 3.0708189010620117, 4.314295291900635, 4.871173858642578, 5.554862022399902, 4.0682477951049805], "mean_td_error": 4.683004379272461, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 5.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.96489143371582, "actor_loss": -4.016899585723877, "critic_loss": 0.9935961961746216, "alpha_loss": -0.011958998627960682, "alpha_value": 0.9988006353378296, "log_alpha_value": -0.0012001132126897573, "target_entropy": -6.0, "policy_t": -0.0438179150223732, "mean_q": 0.07285524159669876, "max_q": 0.6815159916877747, "min_q": 0.05037756636738777}, "td_error": [2.4049408435821533, 3.418916940689087, 2.348186731338501, 3.570913791656494, 1.266277551651001, 2.63960599899292, 3.661389112472534, 3.217247724533081, 3.860172986984253, 2.3821065425872803, 2.1887993812561035, 3.989175796508789, 1.9933805465698242, 1.3103909492492676, 2.714621067047119, 2.251829147338867, 2.658548355102539, 3.7600629329681396, 2.8067355155944824, 4.009469985961914, 4.276679515838623, 0.24535778164863586, 2.8122968673706055, 2.901315927505493, 3.0824027061462402, 0.19080063700675964, 4.153501510620117, 3.486147403717041, 4.686557769775391, 0.5976992249488831, 2.8289718627929688, 1.9563599824905396, 2.9643361568450928, 3.2240562438964844, 3.4217774868011475, 1.0851914882659912, 1.2782833576202393, 0.5694272518157959, 2.174149990081787, 5.0505499839782715, 3.2416954040527344, 0.023029297590255737, 3.912708282470703, 3.1766533851623535, 2.6083405017852783, 2.5485880374908447, 3.8672800064086914, 3.467013359069824, 3.5184597969055176, 0.6097218990325928, 4.507233619689941, 1.904454231262207, 2.491183280944824, 4.739778518676758, 2.3687801361083984, 1.6230261325836182, 3.9442319869995117, 1.8361170291900635, 2.7265892028808594, 3.751948833465576, 2.814666271209717, 3.455949306488037, 2.24674391746521, 3.8416733741760254, 4.4065022468566895, 2.907057762145996, 2.1978518962860107, 3.443054676055908, 2.8224196434020996, 2.401036500930786, 3.1863579750061035, 2.1563377380371094, 2.212508201599121, 2.9229626655578613, 2.5790576934814453, 2.99367618560791, 2.5648207664489746, 1.8799505233764648, 2.196927070617676, 3.622123956680298, 1.8788343667984009, 2.5989530086517334, 2.8610689640045166, 1.5853291749954224, 2.1635594367980957, 1.7116361856460571], "mean_td_error": 2.7204246520996094, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 5.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.11825180053711, "actor_loss": -4.169043064117432, "critic_loss": 1.331907868385315, "alpha_loss": -0.012142292223870754, "alpha_value": 0.9988006949424744, "log_alpha_value": -0.0012000384740531445, "target_entropy": -6.0, "policy_t": -0.019588587805628777, "mean_q": 0.051928531378507614, "max_q": 0.1880829930305481, "min_q": 0.04934103786945343}, "td_error": [2.7211790084838867, 3.721348762512207, 3.340304374694824, 3.8232555389404297, 1.6942012310028076, 4.784343719482422, 4.380332946777344, 4.059337615966797, 2.351680278778076, 4.362421035766602, 1.999981164932251, 2.9833693504333496, 2.3161206245422363, 2.9379286766052246, 2.8736162185668945, 2.943039894104004, 2.8362858295440674, 2.9792189598083496, 3.3420519828796387, 0.7345896363258362, 2.566359281539917, 2.6144776344299316, 1.6083691120147705, 1.8453326225280762, 0.8711541891098022, 2.2103052139282227, 1.0704271793365479, 2.01845121383667, 2.619680881500244, 1.9947584867477417, 2.491412401199341, 2.9439547061920166, 2.7291221618652344, 3.980158805847168, 3.518941879272461, 5.975342750549316, 2.043201446533203, 2.2952427864074707, 3.1016788482666016, 1.9474023580551147, 1.508255958557129, 1.8686745166778564, 1.064988374710083, 3.482393741607666, 2.5269036293029785, 4.264022350311279, 2.2749738693237305, 2.772979736328125, 2.1978113651275635, 0.838725209236145, 3.0439817905426025, 3.9139275550842285, 2.5831727981567383, 3.6454362869262695, 2.9741897583007812, 2.7560927867889404, 2.85439133644104, 0.9125486612319946, 3.499603748321533, 1.321956992149353, 1.0135996341705322, 3.7029800415039062, 4.850435256958008, 1.6387202739715576, 1.290294885635376, 1.4319512844085693, 4.291895866394043, 3.293410301208496, 1.9965437650680542, 5.486172676086426, 2.1614131927490234, 3.536033868789673, 2.292557716369629, 2.6585142612457275, 0.6667765974998474, 3.000030517578125, 3.198910713195801, 2.8877201080322266, 3.6402394771575928, 3.8850131034851074, 4.3769755363464355, 1.8382203578948975, 2.8256776332855225, 1.9851279258728027, 1.976322889328003, 4.183187961578369], "mean_td_error": 2.744699239730835, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 5.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 5376, "num_env_steps_trained": 1290, "num_agent_steps_sampled": 16128, "num_agent_steps_trained": 1290, "last_target_update_ts": 5376, "num_target_updates": 5}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16128, "num_agent_steps_trained": 1290, "num_env_steps_sampled": 5376, "num_env_steps_trained": 1290, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 963.1512804547455, "num_env_steps_trained_throughput_per_sec": 277.33597138094234, "timesteps_total": 5376, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 16128, "timers": {"training_iteration_time_ms": 1104.229, "sample_time_ms": 756.73, "load_time_ms": 0.312, "load_throughput": 827949.833, "learn_time_ms": 23.189, "learn_throughput": 11125.795, "synch_weights_time_ms": 9.459}, "counters": {"num_env_steps_sampled": 5376, "num_env_steps_trained": 1290, "num_agent_steps_sampled": 16128, "num_agent_steps_trained": 1290, "last_target_update_ts": 5376, "num_target_updates": 5}, "done": false, "episodes_total": 0, "training_iteration": 5, "trial_id": "a2ad0_00000", "date": "2023-11-18_21-01-17", "timestamp": 1700370077, "time_this_iter_s": 1.869884967803955, "time_total_s": 6.669963359832764, "pid": 6505, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x153f53ba0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 6.669963359832764, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 65.93333333333334, "ram_util_percent": 65.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.141664505004883, "actor_loss": -4.230610370635986, "critic_loss": 3.168948173522949, "alpha_loss": -0.018259374424815178, "alpha_value": 0.9982011914253235, "log_alpha_value": -0.0018004316370934248, "target_entropy": -6.0, "policy_t": 0.0006765746511518955, "mean_q": 0.14122337102890015, "max_q": 1.070319652557373, "min_q": 0.08125423640012741}, "td_error": [4.353361129760742, 4.8021087646484375, 6.0893754959106445, 5.935741424560547, 3.3088436126708984, 6.1024322509765625, 4.775510787963867, 4.633693695068359, 4.835451126098633, 5.36868143081665, 5.188225746154785, 4.533400535583496, 5.558806419372559, 4.631254196166992, 5.860729217529297, 4.9879350662231445, 3.3432164192199707, 6.194097518920898, 5.435784339904785, 3.300506114959717, 3.173424243927002, 4.63688850402832, 4.434027671813965, 4.521862030029297, 4.357038497924805, 3.9607274532318115, 2.2453160285949707, 4.306831359863281, 4.14288854598999, 4.326027870178223, 4.514106750488281, 3.110438346862793, 3.622213363647461, 3.598573684692383, 5.703083038330078, 5.103072643280029, 3.027698278427124, 5.640464782714844, 4.172457695007324, 2.3664956092834473, 4.395084381103516, 3.3866913318634033, 3.5189342498779297, 5.072043418884277, 3.8415651321411133, 4.941476821899414, 2.9048328399658203, 5.795003414154053, 4.807609558105469, 4.10129451751709, 5.976917266845703, 5.316403865814209, 3.556488513946533, 5.651114463806152, 3.5992069244384766, 2.3127970695495605, 3.6860811710357666, 3.519125461578369, 5.707088947296143, 4.378832817077637, 4.858732223510742, 4.001520156860352, 5.505537509918213, 4.816844940185547, 3.4276773929595947, 5.079166412353516, 3.227795362472534, 4.207016944885254, 3.465765953063965, 4.507458209991455, 3.6992926597595215, 3.202923536300659, 5.998558044433594, 3.092576503753662, 4.791118621826172, 5.548925876617432, 3.6002068519592285, 4.115832328796387, 3.7483296394348145, 4.8742241859436035, 3.6727185249328613, 7.029475212097168, 3.756282329559326, 4.232682228088379, 4.356215476989746, 3.2943007946014404], "mean_td_error": 4.404448509216309, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 7.0, "diff_num_grad_updates_vs_sampler_policy": 6.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.086048126220703, "actor_loss": -4.16349983215332, "critic_loss": 0.8052884340286255, "alpha_loss": -0.018154354766011238, "alpha_value": 0.9982016682624817, "log_alpha_value": -0.001799947116523981, "target_entropy": -6.0, "policy_t": -0.07844739407300949, "mean_q": 0.13576743006706238, "max_q": 1.0008474588394165, "min_q": 0.07747860252857208}, "td_error": [2.002692222595215, 3.492816925048828, 1.778531789779663, 4.84831428527832, 2.0030133724212646, 3.193899393081665, 1.3263299465179443, 3.1301686763763428, 3.469910144805908, 2.3629894256591797, 1.4580769538879395, 1.9465827941894531, 1.1754966974258423, 1.4284801483154297, 2.7505297660827637, 4.702081680297852, 1.9910011291503906, 0.575086236000061, 2.3839733600616455, 3.261073350906372, 1.0723074674606323, 2.6689114570617676, 3.7838151454925537, 2.3615317344665527, 2.448488235473633, 2.694732189178467, 3.0318949222564697, 3.5136349201202393, 0.31680846214294434, 2.9067904949188232, 2.927213191986084, 0.956365168094635, 0.6911739110946655, 2.603543281555176, 3.424133777618408, 3.7632884979248047, 4.632672309875488, 1.9906806945800781, 3.7955799102783203, 3.7422053813934326, 2.1369402408599854, 2.6306915283203125, 2.9877827167510986, 1.8867312669754028, 3.2440195083618164, 2.728837013244629, 3.3034420013427734, 3.9282467365264893, 2.300550699234009, 2.804182767868042, 2.616767406463623, 1.6197110414505005, 3.052123546600342, 0.37063589692115784, 4.152153015136719, 2.4112186431884766, 2.1706552505493164, 2.401740550994873, 2.287034273147583, 2.330009937286377, 1.5935399532318115, 2.657500982284546, 2.5399069786071777, 2.026439666748047, 2.531407594680786, 4.716098308563232, 3.101858139038086, 4.046331405639648, 1.1952240467071533, 1.1786879301071167, 3.2170214653015137, 2.5648608207702637, 1.8779104948043823, 2.516463279724121, 1.3084293603897095, 2.388258457183838, 2.9106860160827637, 2.201772689819336, 1.820535659790039, 3.691201686859131, 2.1440911293029785, 2.11916446685791, 3.001708507537842, 2.6162095069885254, 1.5755672454833984, 3.081576108932495], "mean_td_error": 2.541776418685913, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 7.0, "diff_num_grad_updates_vs_sampler_policy": 6.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.119293212890625, "actor_loss": -4.199657917022705, "critic_loss": 1.095808506011963, "alpha_loss": -0.018214618787169456, "alpha_value": 0.9982016086578369, "log_alpha_value": -0.0017999891424551606, "target_entropy": -6.0, "policy_t": -0.03143705427646637, "mean_q": 0.09697882831096649, "max_q": 0.745926022529602, "min_q": 0.0774628221988678}, "td_error": [3.6275482177734375, 4.251832008361816, 4.312532424926758, 3.5926575660705566, 2.943838119506836, 2.3537631034851074, 4.143269062042236, 1.378873348236084, 1.8018916845321655, 2.069937229156494, 3.646575689315796, 2.8650903701782227, 4.340681076049805, 3.3873910903930664, 0.6958035826683044, 3.2228965759277344, 2.517646551132202, 2.2127366065979004, 0.717538595199585, 1.2335009574890137, 3.041318416595459, 0.2286549210548401, 3.1587886810302734, 0.8133924603462219, 1.4503693580627441, 1.786003828048706, 3.0739479064941406, 3.4157016277313232, 2.571881055831909, 3.2770066261291504, 3.5853800773620605, 2.7527215480804443, 1.1797317266464233, 3.3087990283966064, 2.7534523010253906, 2.728426218032837, 3.5837602615356445, 2.0111019611358643, 2.8233327865600586, 2.5096096992492676, 1.0267237424850464, 1.731379747390747, 2.5854320526123047, 3.7214393615722656, 0.9135109186172485, 2.700584888458252, 3.8427157402038574, 1.4421097040176392, 3.0290002822875977, 1.3903346061706543, 4.753931522369385, 2.9230399131774902, 2.12332820892334, 2.321535110473633, 1.2794361114501953, 2.0275967121124268, 3.3634066581726074, 2.786893844604492, 0.4179007112979889, 3.9634506702423096, 3.7016263008117676, 2.7202107906341553, 4.434441089630127, 2.275937080383301, 3.1184000968933105, 3.066845178604126, 1.1877444982528687, 1.9544248580932617, 1.2593135833740234, 1.5072047710418701, 4.255212783813477, 3.0986428260803223, 2.8543806076049805, 3.9578094482421875, 3.100421667098999, 3.775571823120117, 1.9252524375915527, 4.172512054443359, 2.8577446937561035, 1.1876683235168457, 4.550896644592285, 1.974008321762085, 1.9105662107467651, 3.7335073947906494, 2.355787754058838, 1.9491108655929565], "mean_td_error": 2.6348648071289062, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 7.0, "diff_num_grad_updates_vs_sampler_policy": 6.0}}, "num_env_steps_sampled": 7168, "num_env_steps_trained": 1806, "num_agent_steps_sampled": 21504, "num_agent_steps_trained": 1806, "last_target_update_ts": 7168, "num_target_updates": 7}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 21504, "num_agent_steps_trained": 1806, "num_env_steps_sampled": 7168, "num_env_steps_trained": 1806, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 931.5875522966527, "num_env_steps_trained_throughput_per_sec": 268.2473085854201, "timesteps_total": 7168, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 21504, "timers": {"training_iteration_time_ms": 1068.618, "sample_time_ms": 740.001, "load_time_ms": 0.312, "load_throughput": 826053.765, "learn_time_ms": 21.847, "learn_throughput": 11809.268, "synch_weights_time_ms": 9.593}, "counters": {"num_env_steps_sampled": 7168, "num_env_steps_trained": 1806, "num_agent_steps_sampled": 21504, "num_agent_steps_trained": 1806, "last_target_update_ts": 7168, "num_target_updates": 7}, "done": false, "episodes_total": 0, "training_iteration": 6, "trial_id": "a2ad0_00000", "date": "2023-11-18_21-01-19", "timestamp": 1700370079, "time_this_iter_s": 1.9333279132843018, "time_total_s": 8.603291273117065, "pid": 6505, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x1542725c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 8.603291273117065, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 70.10000000000001, "ram_util_percent": 65.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.067188262939453, "actor_loss": -4.191993236541748, "critic_loss": 3.310701370239258, "alpha_loss": -0.024170495569705963, "alpha_value": 0.9976019859313965, "log_alpha_value": -0.0024009181652218103, "target_entropy": -6.0, "policy_t": -5.548268381971866e-05, "mean_q": 0.20343017578125, "max_q": 1.7169787883758545, "min_q": 0.11485373973846436}, "td_error": [5.264984130859375, 6.091344833374023, 5.663782119750977, 5.994701385498047, 5.175548076629639, 2.709520101547241, 6.3258562088012695, 4.569647312164307, 4.046055793762207, 3.30269718170166, 3.392122268676758, 4.816387176513672, 5.076173782348633, 3.9575517177581787, 5.669068336486816, 6.7812724113464355, 4.8307647705078125, 4.62398624420166, 3.8962342739105225, 4.095296859741211, 4.3480377197265625, 4.135377883911133, 4.833844184875488, 6.226991653442383, 4.792690277099609, 3.4928317070007324, 3.4858922958374023, 5.973220348358154, 4.732322692871094, 3.7924282550811768, 4.094038009643555, 2.5012683868408203, 4.737199306488037, 3.138613224029541, 4.791234016418457, 5.669411659240723, 4.690859794616699, 3.936434745788574, 4.549271106719971, 6.107961654663086, 3.4057798385620117, 6.164951324462891, 4.637526512145996, 4.571032524108887, 3.9909768104553223, 5.671509742736816, 5.195167541503906, 4.171893119812012, 2.7652201652526855, 5.700669288635254, 5.3557820320129395, 3.1672043800354004, 4.912707805633545, 5.265474319458008, 4.908154010772705, 5.387249946594238, 5.881496906280518, 3.925274133682251, 3.321791648864746, 6.4846086502075195, 3.9296340942382812, 4.091636657714844, 4.03427791595459, 5.080321311950684, 4.204095840454102, 4.567416191101074, 5.870185852050781, 3.729560375213623, 3.7811293601989746, 1.7235569953918457, 5.836236953735352, 5.041017532348633, 4.86810827255249, 4.467963218688965, 5.3816986083984375, 3.5839784145355225, 3.2314276695251465, 3.6059410572052, 4.65738582611084, 4.951968193054199, 3.059919834136963, 5.128983974456787, 4.591408729553223, 2.3161869049072266, 4.094498157501221, 3.6900482177734375], "mean_td_error": 4.543209075927734, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 9.0, "diff_num_grad_updates_vs_sampler_policy": 8.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.170464515686035, "actor_loss": -4.280208110809326, "critic_loss": 0.7479698657989502, "alpha_loss": -0.024409839883446693, "alpha_value": 0.9976028203964233, "log_alpha_value": -0.002400071593001485, "target_entropy": -6.0, "policy_t": 0.024996992200613022, "mean_q": 0.13065306842327118, "max_q": 1.014328956604004, "min_q": 0.10897267609834671}, "td_error": [4.065038681030273, 1.4573675394058228, 1.3500521183013916, 3.4604763984680176, 3.539072036743164, 4.1145124435424805, 0.7988219857215881, 2.8289897441864014, 3.8436286449432373, 2.9536986351013184, 1.7504266500473022, 0.9308570623397827, 2.6070401668548584, 3.003696918487549, 3.5816941261291504, 2.232038974761963, 2.511573314666748, 1.8722147941589355, 1.9016897678375244, 0.9558432698249817, 1.9693117141723633, 3.4232864379882812, 3.683774471282959, 2.4344658851623535, 2.8677797317504883, 1.3816205263137817, 1.1716575622558594, 1.2636430263519287, 1.2033696174621582, 3.130629539489746, 4.274967193603516, 0.2508598566055298, 2.4588139057159424, 2.2155227661132812, 2.9510931968688965, 3.095808506011963, 2.151961326599121, 2.1331493854522705, 3.1607658863067627, 2.3685827255249023, 1.89461350440979, 1.7953901290893555, 0.9404857158660889, 1.4012377262115479, 1.9906927347183228, 1.805431842803955, 1.844397783279419, 1.3688348531723022, 2.4630589485168457, 3.3761496543884277, 2.1867871284484863, 1.4707781076431274, 1.2544548511505127, 3.0816221237182617, 3.7997360229492188, 1.5748262405395508, 2.629420757293701, 1.6869432926177979, 1.9209784269332886, 2.1966748237609863, 4.88735294342041, 4.857510089874268, 2.0679054260253906, 2.9088215827941895, 3.4319515228271484, 1.808661699295044, 0.9460811614990234, 1.9972965717315674, 2.4501757621765137, 1.9870259761810303, 2.54403018951416, 1.5936040878295898, 2.76241397857666, 3.527597427368164, 1.5394072532653809, 2.382044792175293, 1.7030270099639893, 2.180366039276123, 1.6318104267120361, 4.401647090911865, 1.6587426662445068, 2.598127841949463, 1.90255606174469, 3.7025692462921143, 1.1162338256835938, 2.7084922790527344], "mean_td_error": 2.364276647567749, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 9.0, "diff_num_grad_updates_vs_sampler_policy": 8.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.104752540588379, "actor_loss": -4.218559265136719, "critic_loss": 1.093101978302002, "alpha_loss": -0.024252483621239662, "alpha_value": 0.9976027607917786, "log_alpha_value": -0.0024001067504286766, "target_entropy": -6.0, "policy_t": 0.03368070721626282, "mean_q": 0.15640951693058014, "max_q": 1.4387750625610352, "min_q": 0.10929916799068451}, "td_error": [0.758438766002655, 2.259016990661621, 2.3629465103149414, 3.007042646408081, 2.5103440284729004, 2.300060272216797, 3.8013482093811035, 2.1763508319854736, 1.0048940181732178, 3.583317756652832, 1.5189814567565918, 2.482485294342041, 3.3978376388549805, 3.5493974685668945, 2.9870662689208984, 2.952096700668335, 4.023927688598633, 1.3420829772949219, 2.381931781768799, 3.476728677749634, 1.4168013334274292, 1.9733637571334839, 1.9207264184951782, 0.9568257927894592, 2.1886465549468994, 0.19364002346992493, 2.0197529792785645, 1.9300057888031006, 3.032451629638672, 3.8896031379699707, 4.47904634475708, 2.7336812019348145, 4.531446933746338, 3.24599027633667, 1.1870381832122803, 1.424445390701294, 1.3334660530090332, 2.952951669692993, 1.511366605758667, 2.992664098739624, 3.4400150775909424, 1.8693084716796875, 4.10461950302124, 2.811236619949341, 1.565462350845337, 2.0017037391662598, 3.184410572052002, 4.772368431091309, 3.8136024475097656, 3.29746675491333, 3.2840678691864014, 3.0370359420776367, 1.3056056499481201, 3.1402363777160645, 1.326015830039978, 0.7970848083496094, 2.0762267112731934, 1.70358145236969, 2.2655160427093506, 3.5163328647613525, 3.5661215782165527, 2.4150054454803467, 2.170574188232422, 3.2425155639648438, 5.057235240936279, 3.0868139266967773, 5.5681962966918945, 2.9100492000579834, 4.624242305755615, 0.5060507655143738, 2.8287229537963867, 2.2170817852020264, 2.647329330444336, 2.425044536590576, 3.57118821144104, 3.2769556045532227, 0.9868365526199341, 3.3141050338745117, 1.3175809383392334, 3.0265185832977295, 4.482966423034668, 2.4417343139648438, 3.740074872970581, 0.7793551683425903, 1.1713725328445435, 4.288708209991455], "mean_td_error": 2.636796236038208, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 9.0, "diff_num_grad_updates_vs_sampler_policy": 8.0}}, "num_env_steps_sampled": 8960, "num_env_steps_trained": 2322, "num_agent_steps_sampled": 26880, "num_agent_steps_trained": 2322, "last_target_update_ts": 8960, "num_target_updates": 9}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 26880, "num_agent_steps_trained": 2322, "num_env_steps_sampled": 8960, "num_env_steps_trained": 2322, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 868.5621352675718, "num_env_steps_trained_throughput_per_sec": 250.09936484267132, "timesteps_total": 8960, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 26880, "timers": {"training_iteration_time_ms": 1061.206, "sample_time_ms": 731.103, "load_time_ms": 0.313, "load_throughput": 824585.038, "learn_time_ms": 20.894, "learn_throughput": 12348.044, "synch_weights_time_ms": 9.439}, "counters": {"num_env_steps_sampled": 8960, "num_env_steps_trained": 2322, "num_agent_steps_sampled": 26880, "num_agent_steps_trained": 2322, "last_target_update_ts": 8960, "num_target_updates": 9}, "done": false, "episodes_total": 0, "training_iteration": 7, "trial_id": "a2ad0_00000", "date": "2023-11-18_21-01-21", "timestamp": 1700370081, "time_this_iter_s": 2.0719540119171143, "time_total_s": 10.67524528503418, "pid": 6505, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x154273560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 10.67524528503418, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 63.86666666666667, "ram_util_percent": 65.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.093793869018555, "actor_loss": -4.25684118270874, "critic_loss": 3.072450876235962, "alpha_loss": -0.030295422300696373, "alpha_value": 0.9970031380653381, "log_alpha_value": -0.003001391189172864, "target_entropy": -6.0, "policy_t": -0.03953440487384796, "mean_q": 0.21995529532432556, "max_q": 2.3442981243133545, "min_q": 0.1533321738243103}, "td_error": [3.647994041442871, 3.805973529815674, 4.480548858642578, 2.805577278137207, 4.32579231262207, 5.204219818115234, 3.510934591293335, 5.171812057495117, 3.3567304611206055, 2.487684726715088, 3.891559600830078, 4.780630111694336, 5.152513027191162, 3.166677236557007, 2.085679054260254, 3.2651114463806152, 2.608865737915039, 3.6451215744018555, 5.029184341430664, 5.6244049072265625, 4.210147857666016, 4.579376220703125, 4.740389347076416, 2.3927884101867676, 6.264228820800781, 4.680190563201904, 2.475213050842285, 3.3765904903411865, 4.899486541748047, 2.947279214859009, 4.175533294677734, 5.9893798828125, 5.964073181152344, 3.8492536544799805, 3.9428582191467285, 1.8565047979354858, 5.351213455200195, 3.180327892303467, 4.063140869140625, 1.2933088541030884, 4.391345024108887, 6.783822059631348, 4.894861698150635, 5.180153846740723, 4.445741653442383, 4.538974761962891, 4.889754295349121, 4.676755905151367, 4.2174553871154785, 2.867982864379883, 5.936027526855469, 5.205802917480469, 5.786559104919434, 4.537353992462158, 4.060426712036133, 5.328806400299072, 4.953713417053223, 4.585161209106445, 3.9527859687805176, 6.766593933105469, 4.482874870300293, 3.1532340049743652, 5.019932746887207, 5.442401885986328, 5.05970573425293, 4.728821754455566, 5.152367115020752, 4.168188095092773, 3.0120506286621094, 4.741717338562012, 4.054117202758789, 3.2383062839508057, 5.199448585510254, 2.845921039581299, 3.7957632541656494, 3.4651243686676025, 3.980149745941162, 5.383873462677002, 3.4311177730560303, 4.7214035987854, 6.02010440826416, 5.359260082244873, 5.466602325439453, 3.6077749729156494, 3.9774184226989746, 4.886309623718262], "mean_td_error": 4.310143947601318, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 11.0, "diff_num_grad_updates_vs_sampler_policy": 10.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.129861831665039, "actor_loss": -4.276723384857178, "critic_loss": 0.8060693740844727, "alpha_loss": -0.03039560839533806, "alpha_value": 0.9970039129257202, "log_alpha_value": -0.0030005944427102804, "target_entropy": -6.0, "policy_t": 0.05158553645014763, "mean_q": 0.23804493248462677, "max_q": 1.812436819076538, "min_q": 0.14526847004890442}, "td_error": [1.676508903503418, 1.360687017440796, 3.1163482666015625, 4.843563556671143, 2.9442882537841797, 1.54811692237854, 2.6670384407043457, 2.6097817420959473, 4.157528400421143, 0.09241806715726852, 0.7196518182754517, 2.9341630935668945, 2.5506575107574463, 2.105294704437256, 3.9935684204101562, 4.592500686645508, 1.441681146621704, 2.683680534362793, 1.0526490211486816, 1.6936323642730713, 3.611513614654541, 2.9454445838928223, 3.4143362045288086, 2.437657356262207, 3.562044620513916, 2.793722152709961, 2.8186967372894287, 3.081045627593994, 3.195258140563965, 0.555649995803833, 2.572477340698242, 3.058711051940918, 2.144468307495117, 5.162164688110352, 1.9037275314331055, 2.75856876373291, 2.070930004119873, 3.8006110191345215, 2.6272029876708984, 2.348504066467285, 3.913433790206909, 1.9101959466934204, 3.4869041442871094, 3.0272130966186523, 3.6149916648864746, 1.8981752395629883, 3.0911929607391357, 3.010439872741699, 3.6512317657470703, 1.928978681564331, 2.390562057495117, 2.1777987480163574, 2.293275833129883, 4.30765438079834, 1.5847779512405396, 2.9137821197509766, 2.438340663909912, 2.639324903488159, 1.013938546180725, 3.9872188568115234, 3.3005714416503906, 0.08809125423431396, 1.9829144477844238, 2.332156181335449, 1.65140700340271, 1.2099316120147705, 2.812051773071289, 1.309783935546875, 2.2840819358825684, 2.6193878650665283, 0.9287992119789124, 2.635664463043213, 3.3348631858825684, 3.5338144302368164, 2.0316948890686035, 3.68510103225708, 2.2339775562286377, 2.6462836265563965, 1.751943826675415, 1.026320457458496, 2.434499740600586, 2.7861995697021484, 1.8681831359863281, 1.797511100769043, 1.9534180164337158, 3.131092071533203], "mean_td_error": 2.5383217334747314, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 11.0, "diff_num_grad_updates_vs_sampler_policy": 10.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.092355728149414, "actor_loss": -4.245250701904297, "critic_loss": 1.0404189825057983, "alpha_loss": -0.030279919505119324, "alpha_value": 0.9970042109489441, "log_alpha_value": -0.003000282682478428, "target_entropy": -6.0, "policy_t": -0.015111882239580154, "mean_q": 0.1827201098203659, "max_q": 1.2359846830368042, "min_q": 0.14569330215454102}, "td_error": [3.209998607635498, 2.241107940673828, 0.7983207702636719, 2.9537622928619385, 1.7703766822814941, 2.126448631286621, 1.5049917697906494, 2.485870361328125, 3.266181230545044, 3.5693130493164062, 3.140324115753174, 3.6667673587799072, 1.845921277999878, 2.1284449100494385, 3.4698357582092285, 1.858769416809082, 3.216742992401123, 2.2940728664398193, 2.5074284076690674, 3.7615933418273926, 2.4422073364257812, 3.2817630767822266, 2.6686806678771973, 2.0916032791137695, 2.984467029571533, 2.5422565937042236, 1.511521339416504, 3.8965392112731934, 3.936110496520996, 4.7570085525512695, 1.9272844791412354, 1.1328949928283691, 2.7456207275390625, 3.951958656311035, 1.059842824935913, 2.9698493480682373, 1.9693005084991455, 1.7760545015335083, 3.010049819946289, 1.5906922817230225, 2.294138193130493, 3.660740375518799, 4.205132484436035, 2.765151023864746, 3.843675136566162, 1.5489554405212402, 3.9663820266723633, 1.6742814779281616, 3.3346762657165527, 1.462254524230957, 2.0983972549438477, 2.1892852783203125, 3.584472179412842, 2.363083839416504, 1.600098967552185, 3.726217746734619, 4.007327079772949, 2.7448925971984863, 3.3696227073669434, 4.244239807128906, 2.573089599609375, 3.818758964538574, 2.8457555770874023, 3.2444190979003906, 2.53000807762146, 0.6812174320220947, 1.3902599811553955, 1.6876368522644043, 2.7852888107299805, 1.1889808177947998, 3.2710378170013428, 3.0077478885650635, 0.7276672124862671, 4.656145095825195, 2.1399271488189697, 2.083141803741455, 1.7514225244522095, 0.2684064507484436, 2.1401729583740234, 2.545668125152588, 2.7311148643493652, 3.060971736907959, 0.7102874517440796, 1.2918825149536133, 2.213963270187378, 2.019233226776123], "mean_td_error": 2.5594093799591064, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 11.0, "diff_num_grad_updates_vs_sampler_policy": 10.0}}, "num_env_steps_sampled": 10752, "num_env_steps_trained": 2838, "num_agent_steps_sampled": 32256, "num_agent_steps_trained": 2838, "last_target_update_ts": 10752, "num_target_updates": 11}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32256, "num_agent_steps_trained": 2838, "num_env_steps_sampled": 10752, "num_env_steps_trained": 2838, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 940.1588207238411, "num_env_steps_trained_throughput_per_sec": 270.71537471735604, "timesteps_total": 10752, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 32256, "timers": {"training_iteration_time_ms": 1001.444, "sample_time_ms": 704.407, "load_time_ms": 0.312, "load_throughput": 826369.173, "learn_time_ms": 18.187, "learn_throughput": 14185.81, "synch_weights_time_ms": 9.862}, "counters": {"num_env_steps_sampled": 10752, "num_env_steps_trained": 2838, "num_agent_steps_sampled": 32256, "num_agent_steps_trained": 2838, "last_target_update_ts": 10752, "num_target_updates": 11}, "done": false, "episodes_total": 0, "training_iteration": 8, "trial_id": "a2ad0_00000", "date": "2023-11-18_21-01-23", "timestamp": 1700370083, "time_this_iter_s": 1.9159128665924072, "time_total_s": 12.591158151626587, "pid": 6505, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x1542d82c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 12.591158151626587, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 67.3, "ram_util_percent": 64.96666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.060343742370605, "actor_loss": -4.274550914764404, "critic_loss": 3.105952739715576, "alpha_loss": -0.03623638302087784, "alpha_value": 0.9964045882225037, "log_alpha_value": -0.0036019033286720514, "target_entropy": -6.0, "policy_t": -0.023874841630458832, "mean_q": 0.3356171250343323, "max_q": 3.0649757385253906, "min_q": 0.19729933142662048}, "td_error": [3.877141237258911, 4.453948020935059, 5.227560997009277, 4.274653434753418, 1.987104892730713, 5.367745876312256, 4.051723480224609, 2.177304983139038, 3.6137442588806152, 3.8474106788635254, 3.114952564239502, 5.614670753479004, 7.374051570892334, 5.759727478027344, 3.896144390106201, 3.9987077713012695, 3.663668632507324, 3.585277557373047, 5.486033916473389, 2.550563335418701, 7.734088897705078, 3.4962778091430664, 3.6751468181610107, 5.743143081665039, 4.1178083419799805, 1.2571461200714111, 3.571118116378784, 4.527517318725586, 5.686230659484863, 3.956447124481201, 4.637119770050049, 3.0290393829345703, 4.288858413696289, 3.5413074493408203, 4.746198654174805, 4.15715217590332, 3.0305962562561035, 5.897136688232422, 4.747640609741211, 6.090693473815918, 3.8820581436157227, 4.035422325134277, 3.885369300842285, 6.535501480102539, 3.7956995964050293, 4.597831726074219, 5.040799617767334, 5.117484092712402, 3.9623048305511475, 3.0086379051208496, 5.443727493286133, 1.9693334102630615, 3.376936435699463, 5.756994724273682, 5.893082141876221, 6.188005447387695, 2.7319040298461914, 6.462721347808838, 4.165245056152344, 2.3811614513397217, 3.8000645637512207, 3.5984878540039062, 4.2742919921875, 4.048123836517334, 3.0463593006134033, 4.258920669555664, 1.964469075202942, 3.5149760246276855, 4.986743927001953, 4.0930681228637695, 3.7497143745422363, 6.671572685241699, 5.714478492736816, 3.278176784515381, 3.540531635284424, 4.0885725021362305, 4.028342247009277, 4.291656494140625, 5.291603088378906, 4.369294166564941, 6.732994079589844, 3.1933014392852783, 4.185829162597656, 6.243006706237793, 5.558216094970703, 3.8693690299987793], "mean_td_error": 4.331106662750244, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 13.0, "diff_num_grad_updates_vs_sampler_policy": 12.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.10997200012207, "actor_loss": -4.299077987670898, "critic_loss": 0.7357462644577026, "alpha_loss": -0.03640783950686455, "alpha_value": 0.996405303478241, "log_alpha_value": -0.003601181088015437, "target_entropy": -6.0, "policy_t": -0.03379565849900246, "mean_q": 0.2568195164203644, "max_q": 2.114590883255005, "min_q": 0.18758508563041687}, "td_error": [2.1342880725860596, 2.5586156845092773, 2.9385132789611816, 2.706353187561035, 2.240816593170166, 3.112898111343384, 1.629490852355957, 4.040057182312012, 1.735929012298584, 3.9694175720214844, 3.657968044281006, 2.4383933544158936, 1.5525035858154297, 1.5938115119934082, 0.7507099509239197, 1.742265224456787, 3.050905466079712, 2.8676862716674805, 2.0738282203674316, 2.0857319831848145, 2.496452808380127, 3.249833345413208, 0.7322475910186768, 3.7941970825195312, 1.0722835063934326, 3.501138687133789, 3.5760536193847656, 3.094027280807495, 1.8971912860870361, 0.08402252197265625, 2.531860589981079, 3.8048012256622314, 2.383704662322998, 1.0583546161651611, 1.6850576400756836, 1.4651527404785156, 2.102186679840088, 3.0611491203308105, 2.1330065727233887, 4.21618127822876, 2.287334442138672, 2.1082918643951416, 1.9131085872650146, 1.915113091468811, 1.4722888469696045, 1.1610132455825806, 0.0559438019990921, 3.393749237060547, 2.838038444519043, 1.9513981342315674, 2.524284839630127, 2.04386568069458, 3.5086255073547363, 1.7007668018341064, 2.2402725219726562, 2.2812201976776123, 2.7642998695373535, 1.354972004890442, 2.8467578887939453, 3.2516231536865234, 2.234623432159424, 2.6943297386169434, 2.9585561752319336, 2.4219770431518555, 2.7010133266448975, 1.244821548461914, 2.580935001373291, 1.850751280784607, 4.351612091064453, 1.745734691619873, 1.6167621612548828, 0.6360796689987183, 2.629363536834717, 3.2937586307525635, 1.7560279369354248, 1.5114636421203613, 2.4255459308624268, 2.6862587928771973, 2.6129655838012695, 2.667264938354492, 3.0813379287719727, 3.9751343727111816, 2.072235345840454, 2.783271312713623, 1.6376392841339111, 1.0286896228790283], "mean_td_error": 2.3445370197296143, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 13.0, "diff_num_grad_updates_vs_sampler_policy": 12.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.08523941040039, "actor_loss": -4.279098987579346, "critic_loss": 0.8594796657562256, "alpha_loss": -0.036311693489551544, "alpha_value": 0.9964060187339783, "log_alpha_value": -0.003600478870794177, "target_entropy": -6.0, "policy_t": -0.011266564950346947, "mean_q": 0.26630181074142456, "max_q": 2.4847569465637207, "min_q": 0.18736889958381653}, "td_error": [3.14831280708313, 1.7133585214614868, 3.072650194168091, 1.2087904214859009, 1.4341278076171875, 2.418325662612915, 2.1027944087982178, 2.0170321464538574, 1.1215449571609497, 2.330932378768921, 0.9534632563591003, 3.168518304824829, 1.601763367652893, 2.371664047241211, 4.9896745681762695, 2.666412353515625, 1.0950603485107422, 2.6230523586273193, 1.7705402374267578, 0.2987534999847412, 5.101212978363037, 2.7460920810699463, 2.6048977375030518, 2.634517192840576, 2.794227361679077, 2.7054073810577393, 2.5606913566589355, 2.151172161102295, 2.0114245414733887, 2.3197193145751953, 2.8770008087158203, 5.944342613220215, 2.5363292694091797, 2.1903345584869385, 1.650069236755371, 3.186619281768799, 2.2160823345184326, 1.037280797958374, 2.2162652015686035, 1.5037248134613037, 2.0796406269073486, 1.6432290077209473, 1.342893123626709, 4.387605667114258, 4.211415767669678, 0.6286399364471436, 3.042036533355713, 5.186008453369141, 2.5793049335479736, 2.1020946502685547, 3.8816094398498535, 3.0312693119049072, 2.558485507965088, 0.8294959664344788, 3.0863399505615234, 2.278674602508545, 0.9265797138214111, 3.4912164211273193, 2.9847874641418457, 0.14661717414855957, 3.3466439247131348, 3.395921468734741, 2.0066797733306885, 3.824453830718994, 1.8896626234054565, 0.34479647874832153, 4.096846580505371, 2.925454616546631, 3.3071117401123047, 2.288360834121704, 1.0002808570861816, 2.2800865173339844, 1.5333406925201416, 3.4886839389801025, 1.8569879531860352, 2.641627788543701, 2.481585741043091, 1.5172948837280273, 2.0173838138580322, 2.742699146270752, 0.3546978235244751, 2.8097333908081055, 3.9701249599456787, 2.5599138736724854, 3.282334327697754, 3.659322738647461], "mean_td_error": 2.4550485610961914, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 13.0, "diff_num_grad_updates_vs_sampler_policy": 12.0}}, "num_env_steps_sampled": 12544, "num_env_steps_trained": 3354, "num_agent_steps_sampled": 37632, "num_agent_steps_trained": 3354, "last_target_update_ts": 12544, "num_target_updates": 13}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37632, "num_agent_steps_trained": 3354, "num_env_steps_sampled": 12544, "num_env_steps_trained": 3354, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 929.9419739009248, "num_env_steps_trained_throughput_per_sec": 267.77347016343595, "timesteps_total": 12544, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 37632, "timers": {"training_iteration_time_ms": 968.019, "sample_time_ms": 682.984, "load_time_ms": 0.309, "load_throughput": 834719.556, "learn_time_ms": 17.842, "learn_throughput": 14460.102, "synch_weights_time_ms": 9.832}, "counters": {"num_env_steps_sampled": 12544, "num_env_steps_trained": 3354, "num_agent_steps_sampled": 37632, "num_agent_steps_trained": 3354, "last_target_update_ts": 12544, "num_target_updates": 13}, "done": false, "episodes_total": 0, "training_iteration": 9, "trial_id": "a2ad0_00000", "date": "2023-11-18_21-01-25", "timestamp": 1700370085, "time_this_iter_s": 1.9350900650024414, "time_total_s": 14.526248216629028, "pid": 6505, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x1542728e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 14.526248216629028, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 78.9, "ram_util_percent": 64.85}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.081816673278809, "actor_loss": -4.351094722747803, "critic_loss": 3.1563501358032227, "alpha_loss": -0.04236752539873123, "alpha_value": 0.9958064556121826, "log_alpha_value": -0.004202369600534439, "target_entropy": -6.0, "policy_t": -0.0342986136674881, "mean_q": 0.4124336242675781, "max_q": 3.520843029022217, "min_q": 0.24782562255859375}, "td_error": [2.5786490440368652, 7.132413387298584, 5.0128173828125, 3.757117748260498, 5.394232749938965, 4.991628646850586, 4.269344806671143, 1.5400214195251465, 2.052703857421875, 5.40776252746582, 3.4237732887268066, 7.0488786697387695, 4.033596038818359, 4.082110404968262, 5.79688835144043, 4.378307342529297, 5.265988349914551, 4.632087707519531, 4.612847328186035, 3.8886280059814453, 2.8868870735168457, 7.625906944274902, 3.4175243377685547, 3.03019380569458, 6.8280029296875, 4.3154191970825195, 4.466456413269043, 2.8671321868896484, 3.7769625186920166, 2.7597410678863525, 2.3073525428771973, 3.7876083850860596, 3.2925829887390137, 4.526420593261719, 4.328053951263428, 5.543675422668457, 4.116176605224609, 3.4021921157836914, 5.123320579528809, 2.738807201385498, 4.7451982498168945, 4.376498222351074, 2.708253860473633, 4.853398323059082, 5.84929084777832, 6.589465141296387, 4.602996826171875, 4.5187530517578125, 3.505629539489746, 5.411265850067139, 3.684591293334961, 4.008882999420166, 2.769362449645996, 1.2148807048797607, 4.0446367263793945, 3.399876117706299, 3.976050853729248, 4.525269508361816, 4.475549697875977, 5.32609748840332, 5.027231216430664, 4.971227645874023, 5.315547943115234, 3.641885995864868, 4.629889488220215, 4.90629768371582, 4.76353645324707, 3.730896472930908, 4.2613139152526855, 6.39190673828125, 6.439903259277344, 4.935036659240723, 4.254934310913086, 3.0204432010650635, 4.565443515777588, 5.029110908508301, 4.019906997680664, 3.1890625953674316, 2.940255641937256, 4.558959007263184, 3.5893867015838623, 6.676494598388672, 4.150149345397949, 4.441801071166992, 3.037571907043457, 5.869372367858887], "mean_td_error": 4.341671466827393, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 15.0, "diff_num_grad_updates_vs_sampler_policy": 14.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.096719741821289, "actor_loss": -4.337306022644043, "critic_loss": 0.6691746711730957, "alpha_loss": -0.04242352023720741, "alpha_value": 0.9958071112632751, "log_alpha_value": -0.004201713018119335, "target_entropy": -6.0, "policy_t": 0.04519373178482056, "mean_q": 0.40810510516166687, "max_q": 2.626826286315918, "min_q": 0.23613856732845306}, "td_error": [2.69033145904541, 1.4427900314331055, 3.3072309494018555, 0.6434745788574219, 2.1173086166381836, 2.4339804649353027, 3.0802197456359863, 1.9561595916748047, 2.8634257316589355, 0.027684688568115234, 1.494499921798706, 1.8566951751708984, 0.9550280570983887, 2.6787185668945312, 1.3712711334228516, 1.7688257694244385, 3.754166603088379, 2.316171646118164, 1.2700328826904297, 2.0510780811309814, 0.10511714220046997, 3.1440491676330566, 3.3717451095581055, 2.6164298057556152, 3.0145211219787598, 1.356624960899353, 1.6092665195465088, 2.275717258453369, 0.6330900192260742, 2.9157657623291016, 3.397718906402588, 1.4836398363113403, 1.4201855659484863, 2.0703110694885254, 2.302525043487549, 0.21237856149673462, 1.2369351387023926, 2.774529457092285, 2.870901584625244, 5.050701141357422, 2.5416316986083984, 0.8920528888702393, 0.776464581489563, 3.7314319610595703, 2.3998477458953857, 2.2875618934631348, 1.0658104419708252, 3.2552614212036133, 2.218151569366455, 2.374884605407715, 2.5628066062927246, 1.0700676441192627, 0.1943906545639038, 2.435405731201172, 2.081077814102173, 2.4049108028411865, 1.8047599792480469, 1.8320958614349365, 1.3732731342315674, 2.0342063903808594, 2.813937187194824, 1.600961446762085, 2.417750597000122, 2.612205982208252, 2.0879311561584473, 1.705281138420105, 3.404756546020508, 3.8772435188293457, 0.39359250664711, 2.6537909507751465, 3.768721580505371, 1.7224516868591309, 2.154069423675537, 4.134490013122559, 3.8247873783111572, 3.6116552352905273, 1.0907576084136963, 3.264064073562622, 2.8158106803894043, 2.380394458770752, 1.2696316242218018, 1.9182355403900146, 1.9079244136810303, 3.716813564300537, 1.562988519668579, 0.5284304022789001], "mean_td_error": 2.168790817260742, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 15.0, "diff_num_grad_updates_vs_sampler_policy": 14.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.093860626220703, "actor_loss": -4.337972164154053, "critic_loss": 0.8000571727752686, "alpha_loss": -0.04240139201283455, "alpha_value": 0.9958081245422363, "log_alpha_value": -0.004200711380690336, "target_entropy": -6.0, "policy_t": -0.017319058999419212, "mean_q": 0.38182684779167175, "max_q": 3.101787567138672, "min_q": 0.23439855873584747}, "td_error": [0.5903764367103577, 2.651927947998047, 3.4820685386657715, 2.6193947792053223, 5.233675003051758, 1.3307878971099854, 4.535780906677246, 2.3935375213623047, 1.8048975467681885, 1.4752013683319092, 0.6388277411460876, 1.1613245010375977, 2.1260313987731934, 2.835001230239868, 1.1170496940612793, 1.20335054397583, 2.401625156402588, 1.722776174545288, 2.6997013092041016, 1.3205995559692383, 2.917119026184082, 2.173658847808838, 2.3024027347564697, 1.9679540395736694, 3.147258996963501, 1.2850921154022217, 3.85699462890625, 0.6571536064147949, 2.3378467559814453, 2.9407591819763184, 3.3631014823913574, 4.294515609741211, 0.3165523111820221, 2.4955005645751953, 2.1271941661834717, 0.5321457386016846, 0.26111602783203125, 2.81699800491333, 2.6710901260375977, 3.480576992034912, 0.6863064765930176, 1.79996657371521, 2.4125728607177734, 1.3170816898345947, 1.566927194595337, 2.7641501426696777, 1.4680758714675903, 1.3198785781860352, 2.2767553329467773, 4.092053413391113, 0.045757412910461426, 1.8474292755126953, 2.2466001510620117, 3.512753963470459, 2.7363882064819336, 2.511340618133545, 3.440762519836426, 0.49584436416625977, 1.197513222694397, 3.7886099815368652, 3.940319299697876, 2.939445972442627, 0.6813259124755859, 2.985898494720459, 2.351439952850342, 2.5844271183013916, 3.75590443611145, 1.249442219734192, 3.481123447418213, 3.177030324935913, 2.0651016235351562, 1.6624717712402344, 3.266292095184326, 3.0789077281951904, 2.9992735385894775, 0.9841846227645874, 3.3973073959350586, 0.9805274605751038, 5.1395769119262695, 2.1045703887939453, 4.9889373779296875, 1.7364448308944702, 2.47922420501709, 2.486905574798584, 3.6011528968811035, 1.3184013366699219], "mean_td_error": 2.3285043239593506, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 15.0, "diff_num_grad_updates_vs_sampler_policy": 14.0}}, "num_env_steps_sampled": 14336, "num_env_steps_trained": 3870, "num_agent_steps_sampled": 43008, "num_agent_steps_trained": 3870, "last_target_update_ts": 14336, "num_target_updates": 15}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 43008, "num_agent_steps_trained": 3870, "num_env_steps_sampled": 14336, "num_env_steps_trained": 3870, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 922.0416107835374, "num_env_steps_trained_throughput_per_sec": 265.4985888193668, "timesteps_total": 14336, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 43008, "timers": {"training_iteration_time_ms": 976.315, "sample_time_ms": 692.736, "load_time_ms": 0.307, "load_throughput": 840685.544, "learn_time_ms": 17.751, "learn_throughput": 14534.254, "synch_weights_time_ms": 9.778}, "counters": {"num_env_steps_sampled": 14336, "num_env_steps_trained": 3870, "num_agent_steps_sampled": 43008, "num_agent_steps_trained": 3870, "last_target_update_ts": 14336, "num_target_updates": 15}, "done": false, "episodes_total": 0, "training_iteration": 10, "trial_id": "a2ad0_00000", "date": "2023-11-18_21-01-27", "timestamp": 1700370087, "time_this_iter_s": 1.9538969993591309, "time_total_s": 16.48014521598816, "pid": 6505, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x154273560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 16.48014521598816, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 75.8, "ram_util_percent": 64.96666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.090421676635742, "actor_loss": -4.391975402832031, "critic_loss": 2.9798617362976074, "alpha_loss": -0.045433346182107925, "alpha_value": 0.9955074787139893, "log_alpha_value": -0.00450262101367116, "target_entropy": -6.0, "policy_t": 0.0030043176375329494, "mean_q": 0.5492159724235535, "max_q": 4.805475234985352, "min_q": 0.27582409977912903}, "td_error": [4.490473747253418, 2.3120431900024414, 4.992493629455566, 4.228285789489746, 3.4611566066741943, 4.670811176300049, 1.2217679023742676, 5.6302924156188965, 5.278207778930664, 4.946071624755859, 4.049108505249023, 3.0807814598083496, 4.410977363586426, 0.5209527015686035, 5.574408054351807, 3.6457266807556152, 3.2372629642486572, 3.712808609008789, 4.587860107421875, 4.496175765991211, 3.578632354736328, 3.831631898880005, 6.6107072830200195, 3.2396464347839355, 4.798252105712891, 5.287652492523193, 3.5238068103790283, 5.7334818840026855, 4.113360404968262, 3.015514850616455, 5.867803573608398, 0.36683130264282227, 5.402478218078613, 4.640750885009766, 4.3020830154418945, 4.824840545654297, 4.435585975646973, 3.52506160736084, 4.079193592071533, 3.8810808658599854, 3.004824161529541, 5.791672706604004, 4.841909408569336, 5.664279460906982, 4.345323085784912, 5.244704246520996, 3.919113874435425, 4.561826229095459, 4.105298042297363, 5.265556335449219, 1.1035488843917847, 4.127252578735352, 5.3257951736450195, 4.851619720458984, 4.7793192863464355, 3.25799560546875, 3.2379870414733887, 1.6617012023925781, 2.9561519622802734, 1.3908116817474365, 4.6362714767456055, 5.442032337188721, 4.548066139221191, 4.908761978149414, 3.286787509918213, 4.815692901611328, 2.31425142288208, 3.764115810394287, 4.181338310241699, 3.459073543548584, 5.496217727661133, 1.6692943572998047, 5.1110992431640625, 5.6686248779296875, 3.240264892578125, 4.341931343078613, 3.0480120182037354, 3.3965959548950195, 4.010194778442383, 6.296871185302734, 4.466919422149658, 3.7542202472686768, 4.29750394821167, 3.8537328243255615, 6.4547882080078125, 4.576981544494629], "mean_td_error": 4.117237091064453, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 16.0, "diff_num_grad_updates_vs_sampler_policy": 15.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.087953567504883, "actor_loss": -4.354557514190674, "critic_loss": 0.6564967632293701, "alpha_loss": -0.04541543498635292, "alpha_value": 0.9955081939697266, "log_alpha_value": -0.0045019472017884254, "target_entropy": -6.0, "policy_t": -0.0321614108979702, "mean_q": 0.5174140334129333, "max_q": 3.186537981033325, "min_q": 0.26291969418525696}, "td_error": [2.997373580932617, 2.0012760162353516, 2.239710569381714, 2.5306344032287598, 2.144603729248047, 2.937007188796997, 2.7700257301330566, 3.0351836681365967, 3.7082927227020264, 3.2265737056732178, 2.4988017082214355, 3.4427428245544434, 0.04532599449157715, 0.23604696989059448, 0.8532609939575195, 0.9055372476577759, 4.216653347015381, 2.087265729904175, 2.0049376487731934, 0.8008894920349121, 1.062596082687378, 2.0432515144348145, 0.6189655065536499, 1.820772409439087, 1.7874432802200317, 0.23022425174713135, 0.458176851272583, 1.1750469207763672, 1.2742550373077393, 0.6883867383003235, 2.9875411987304688, 3.763035297393799, 2.682854175567627, 1.1740272045135498, 5.266528129577637, 1.561207890510559, 0.04532516002655029, 0.4174303412437439, 4.42333984375, 3.1265668869018555, 2.3026962280273438, 2.7075419425964355, 1.0915359258651733, 1.4324681758880615, 2.328977584838867, 2.569817543029785, 3.6156492233276367, 4.268205642700195, 0.8065551519393921, 3.3001761436462402, 2.1115059852600098, 0.8773418664932251, 0.44874274730682373, 1.6163915395736694, 2.6038055419921875, 0.9998083114624023, 3.908640146255493, 1.8359365463256836, 3.484210968017578, 3.801313877105713, 0.8840215802192688, 3.6299986839294434, 1.3670189380645752, 2.7075440883636475, 3.4950332641601562, 0.8655845522880554, 0.703713059425354, 1.7841477394104004, 0.7993074655532837, 1.9769065380096436, 2.431687116622925, 3.4162826538085938, 3.520437717437744, 1.570378065109253, 0.9647393226623535, 2.0122814178466797, 2.2862377166748047, 3.9610631465911865, 4.234687328338623, 1.3053555488586426, 1.4955719709396362, 2.1383724212646484, 2.0554139614105225, 2.913214683532715, 1.9063401222229004, 2.1759464740753174], "mean_td_error": 2.139554977416992, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 16.0, "diff_num_grad_updates_vs_sampler_policy": 15.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.098932266235352, "actor_loss": -4.36867094039917, "critic_loss": 0.8881599307060242, "alpha_loss": -0.04545370116829872, "alpha_value": 0.9955092668533325, "log_alpha_value": -0.0045008426532149315, "target_entropy": -6.0, "policy_t": 0.023683279752731323, "mean_q": 0.3924242854118347, "max_q": 3.3803749084472656, "min_q": 0.25951749086380005}, "td_error": [3.6091995239257812, 1.9121274948120117, 0.20611000061035156, 2.4062917232513428, 3.615037441253662, 2.786726474761963, 2.73946475982666, 3.557175874710083, 1.4333975315093994, 2.485969305038452, 2.4839141368865967, 1.975232481956482, 3.1497745513916016, 3.299769401550293, 2.978863000869751, 5.169582366943359, 2.6847634315490723, 2.4486546516418457, 2.1005983352661133, 1.3710293769836426, 3.162752389907837, 2.405539035797119, 2.31898832321167, 2.720489501953125, 2.7809998989105225, 1.3221750259399414, 2.310173749923706, 3.0449962615966797, 1.6443259716033936, 3.6825332641601562, 3.537388563156128, 2.724926710128784, 0.772258996963501, 2.35557222366333, 4.196659088134766, 3.1115550994873047, 2.1930463314056396, 2.38822603225708, 3.317682981491089, 1.2671003341674805, 2.5117173194885254, 3.4635348320007324, 0.9538276195526123, 3.0866575241088867, 0.868590235710144, 1.6812045574188232, 3.9247968196868896, 2.8231048583984375, 3.8362605571746826, 3.3912649154663086, 3.667794704437256, 2.9214658737182617, 4.891755104064941, 0.8527436256408691, 1.369734287261963, 3.8086605072021484, 1.6032767295837402, 2.1915388107299805, 3.592529773712158, 2.1033098697662354, 1.9329047203063965, 3.099992036819458, 1.7111730575561523, 1.919636607170105, 2.2314956188201904, 1.4164856672286987, 0.9039301872253418, 3.661268711090088, 1.651973009109497, 1.8772468566894531, 1.837504267692566, 3.1658201217651367, 2.21914005279541, 2.536159038543701, 3.4092206954956055, 3.746488094329834, 1.7375397682189941, 1.6019432544708252, 0.5585682392120361, 2.482255458831787, 0.440399169921875, 2.7884294986724854, 1.1122252941131592, 2.7772722244262695, 3.2490172386169434, 3.208261489868164], "mean_td_error": 2.4940834045410156, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 16.0, "diff_num_grad_updates_vs_sampler_policy": 15.0}}, "num_env_steps_sampled": 15232, "num_env_steps_trained": 4128, "num_agent_steps_sampled": 45696, "num_agent_steps_trained": 4128, "last_target_update_ts": 15232, "num_target_updates": 16}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 45696, "num_agent_steps_trained": 4128, "num_env_steps_sampled": 15232, "num_env_steps_trained": 4128, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 783.1119679694998, "num_env_steps_trained_throughput_per_sec": 225.49429434836046, "timesteps_total": 15232, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 45696, "timers": {"training_iteration_time_ms": 995.012, "sample_time_ms": 695.214, "load_time_ms": 0.306, "load_throughput": 842846.353, "learn_time_ms": 17.831, "learn_throughput": 14469.441, "synch_weights_time_ms": 9.782}, "counters": {"num_env_steps_sampled": 15232, "num_env_steps_trained": 4128, "num_agent_steps_sampled": 45696, "num_agent_steps_trained": 4128, "last_target_update_ts": 15232, "num_target_updates": 16}, "done": false, "episodes_total": 0, "training_iteration": 11, "trial_id": "a2ad0_00000", "date": "2023-11-18_21-01-28", "timestamp": 1700370088, "time_this_iter_s": 1.1519122123718262, "time_total_s": 17.632057428359985, "pid": 6505, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x154273240>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 17.632057428359985, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 67.85, "ram_util_percent": 65.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.12964916229248, "actor_loss": -4.496931076049805, "critic_loss": 2.849444627761841, "alpha_loss": -0.05169256776571274, "alpha_value": 0.9949098825454712, "log_alpha_value": -0.005103095900267363, "target_entropy": -6.0, "policy_t": 0.01849365234375, "mean_q": 0.5478343963623047, "max_q": 5.325413703918457, "min_q": 0.33606576919555664}, "td_error": [3.607445240020752, 4.50026798248291, 3.6842594146728516, 4.357663154602051, 3.3823132514953613, 4.129138946533203, 4.650582313537598, 3.9669411182403564, 2.690066337585449, 2.574955463409424, 2.949511766433716, 5.180446624755859, 3.732715368270874, 3.653153896331787, 4.433950424194336, 3.3016135692596436, 3.841911554336548, 3.1295464038848877, 3.396610975265503, 4.987911701202393, 0.3675076961517334, 3.136658191680908, 6.8301167488098145, 4.968919277191162, 3.8179988861083984, 5.1185760498046875, 6.6663432121276855, 4.832239151000977, 3.5272369384765625, 4.315285682678223, 1.6711738109588623, 4.690909385681152, 4.986554145812988, 5.47111701965332, 4.872304439544678, 5.417325973510742, 5.060843467712402, 4.826073169708252, 3.435962677001953, 5.41231107711792, 5.023320198059082, 4.033413887023926, 3.827057361602783, 4.066211223602295, 5.873274326324463, 2.1465234756469727, 5.107879638671875, 3.850633144378662, 5.662293434143066, 3.8984310626983643, 3.22310209274292, 4.1921281814575195, 5.72662353515625, 4.508036136627197, 0.6757549047470093, 4.2876386642456055, 6.587899208068848, 4.439427375793457, 3.8364362716674805, 2.6394851207733154, 4.09904146194458, 4.434802532196045, 5.185656547546387, 4.297031402587891, 2.9926156997680664, 4.182703495025635, 5.104636192321777, 4.102800369262695, 5.591189861297607, 4.962383270263672, 6.084863662719727, 3.486243486404419, 5.159123420715332, 1.1845448017120361, 6.259822845458984, 5.051909446716309, 3.730170726776123, 3.8118603229522705, 4.866931915283203, 3.20725154876709, 2.755941390991211, 3.9514997005462646, 3.8644509315490723, 4.8366193771362305, 4.576808929443359, 4.889361381530762], "mean_td_error": 4.207584857940674, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 18.0, "diff_num_grad_updates_vs_sampler_policy": 17.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.101391792297363, "actor_loss": -4.427598476409912, "critic_loss": 0.7173830270767212, "alpha_loss": -0.05154106393456459, "alpha_value": 0.9949105978012085, "log_alpha_value": -0.005102372728288174, "target_entropy": -6.0, "policy_t": 8.42523222672753e-05, "mean_q": 0.41383299231529236, "max_q": 3.474545478820801, "min_q": 0.3213198184967041}, "td_error": [3.0655879974365234, 3.0176684856414795, 0.3227684497833252, 2.9888010025024414, 2.5114147663116455, 1.1142147779464722, 1.9890460968017578, 2.785419464111328, 2.9899725914001465, 0.852046012878418, 2.5216586589813232, 1.6274690628051758, 1.6854161024093628, 3.6387481689453125, 4.729683876037598, 3.3603663444519043, 2.13859486579895, 3.856975555419922, 1.564269781112671, 1.3941569328308105, 2.9170355796813965, 4.013690948486328, 1.6656707525253296, 1.8541829586029053, 3.1516799926757812, 2.883906126022339, 1.582449197769165, 1.7972524166107178, 3.4642720222473145, 3.297384262084961, 1.5948631763458252, 3.0345516204833984, 2.0489845275878906, 2.7019171714782715, 2.2343270778656006, 2.3713574409484863, 2.9348368644714355, 0.8323692083358765, 1.6245629787445068, 0.9594153761863708, 2.55790114402771, 2.8097751140594482, 2.4918107986450195, 1.221353530883789, 2.7513017654418945, 1.0230813026428223, 2.182016372680664, 1.2742252349853516, 1.9520925283432007, 2.605417490005493, 3.073817729949951, 5.1014580726623535, 1.9937845468521118, 3.2247443199157715, 2.2603869438171387, 0.8639951944351196, 1.0862542390823364, 2.251919746398926, 0.21031737327575684, 3.8939719200134277, 2.144712448120117, 3.225806713104248, 1.9055120944976807, 3.759963035583496, 3.213254690170288, 1.03629732131958, 1.9979604482650757, 1.8083019256591797, 2.893533229827881, 0.6280612945556641, 0.7437870502471924, 3.164231300354004, 2.616976261138916, 1.5390974283218384, 1.976813554763794, 2.473280906677246, 5.520966053009033, 1.810806155204773, 2.4463272094726562, 1.6456546783447266, 3.3407857418060303, 1.8728736639022827, 0.8868427276611328, 2.2686381340026855, 2.5455541610717773, 2.214689254760742], "mean_td_error": 2.3212714195251465, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 18.0, "diff_num_grad_updates_vs_sampler_policy": 17.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.088289260864258, "actor_loss": -4.42005729675293, "critic_loss": 0.7767775058746338, "alpha_loss": -0.0514613576233387, "alpha_value": 0.9949119091033936, "log_alpha_value": -0.005101097747683525, "target_entropy": -6.0, "policy_t": 0.01296097133308649, "mean_q": 0.40590113401412964, "max_q": 3.9223580360412598, "min_q": 0.31388965249061584}, "td_error": [1.1962296962738037, 1.8227959871292114, 2.058537483215332, 1.289595603942871, 1.9202027320861816, 2.2602598667144775, 1.128882884979248, 1.309295415878296, 2.2833285331726074, 2.638653516769409, 1.860803484916687, 2.29154634475708, 0.9769443273544312, 3.2644643783569336, 3.120013952255249, 3.06355619430542, 1.3099339008331299, 2.065528154373169, 2.6147918701171875, 3.8788881301879883, 1.2564396858215332, 0.7691650986671448, 2.9937870502471924, 2.9257864952087402, 5.53969669342041, 1.1397963762283325, 3.0725483894348145, 2.7747385501861572, 1.6291136741638184, 3.3252296447753906, 2.9469118118286133, 1.2693639993667603, 1.442392110824585, 4.374399662017822, 3.443173408508301, 3.3528199195861816, 1.6044771671295166, 3.0679049491882324, 3.1727991104125977, 1.9313201904296875, 1.906461238861084, 1.4449243545532227, 3.7935421466827393, 2.253467559814453, 0.8689721822738647, 2.4693684577941895, 1.3642767667770386, 2.0505776405334473, 1.5782480239868164, 4.241488456726074, 1.5026893615722656, 3.251624584197998, 0.5605056881904602, 2.205434560775757, 3.2744085788726807, 2.6193246841430664, 1.533028244972229, 1.9053428173065186, 3.2675647735595703, 2.133488655090332, 2.2312138080596924, 0.12616419792175293, 3.4237775802612305, 4.153417587280273, 4.454168796539307, 2.689147472381592, 0.6015336513519287, 2.301680088043213, 0.9808460474014282, 2.953237533569336, 1.2737140655517578, 2.0499281883239746, 1.8903651237487793, 1.7818570137023926, 0.3038325309753418, 1.381626844406128, 2.1856980323791504, 4.609365463256836, 2.1748619079589844, 1.874230146408081, 3.1389005184173584, 1.6056451797485352, 2.85355806350708, 4.159412384033203, 1.4755802154541016, 2.603550434112549], "mean_td_error": 2.301025152206421, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 18.0, "diff_num_grad_updates_vs_sampler_policy": 17.0}}, "num_env_steps_sampled": 17024, "num_env_steps_trained": 4644, "num_agent_steps_sampled": 51072, "num_agent_steps_trained": 4644, "last_target_update_ts": 17024, "num_target_updates": 18}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51072, "num_agent_steps_trained": 4644, "num_env_steps_sampled": 17024, "num_env_steps_trained": 4644, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 930.8012088216788, "num_env_steps_trained_throughput_per_sec": 268.0208837901709, "timesteps_total": 17024, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 51072, "timers": {"training_iteration_time_ms": 992.435, "sample_time_ms": 692.118, "load_time_ms": 0.305, "load_throughput": 846737.427, "learn_time_ms": 17.713, "learn_throughput": 14565.379, "synch_weights_time_ms": 9.926}, "counters": {"num_env_steps_sampled": 17024, "num_env_steps_trained": 4644, "num_agent_steps_sampled": 51072, "num_agent_steps_trained": 4644, "last_target_update_ts": 17024, "num_target_updates": 18}, "done": false, "episodes_total": 0, "training_iteration": 12, "trial_id": "a2ad0_00000", "date": "2023-11-18_21-01-30", "timestamp": 1700370090, "time_this_iter_s": 1.9344162940979004, "time_total_s": 19.566473722457886, "pid": 6505, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x1542d8fe0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 19.566473722457886, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 78.35, "ram_util_percent": 65.35}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.103376388549805, "actor_loss": -4.544157028198242, "critic_loss": 2.2019095420837402, "alpha_loss": -0.05762706696987152, "alpha_value": 0.9943124651908875, "log_alpha_value": -0.005703743547201157, "target_entropy": -6.0, "policy_t": -0.014811035245656967, "mean_q": 0.8303260803222656, "max_q": 5.717256546020508, "min_q": 0.40328943729400635}, "td_error": [5.889523506164551, 4.195789337158203, 3.0705795288085938, 4.329749584197998, 1.6300218105316162, 4.322643756866455, 3.0873899459838867, 3.133575677871704, 1.0213055610656738, 4.351302146911621, 3.555661678314209, 4.168778419494629, 4.269748687744141, 3.2559609413146973, 2.445709228515625, 3.633249282836914, 5.694833755493164, 4.209410667419434, 4.306899070739746, 4.071308135986328, 3.2866716384887695, 6.023794651031494, 2.848639488220215, 3.4702396392822266, 0.6414089202880859, 4.966081619262695, 5.11614465713501, 5.937624931335449, 4.786742210388184, 5.089486598968506, 2.3844361305236816, 4.563436985015869, 1.1371709108352661, 3.7114553451538086, 3.4068732261657715, 4.981754302978516, 3.211019515991211, 4.915781021118164, 4.2607574462890625, 2.4714269638061523, 4.385784149169922, 1.8955047130584717, 4.5033860206604, 3.935720920562744, 3.7995047569274902, 4.730836868286133, 4.822523593902588, 4.241586685180664, 0.3524448871612549, 3.8774871826171875, 1.1362782716751099, 4.340264320373535, 5.132449150085449, 0.6919894218444824, 2.8294272422790527, 4.706171035766602, 5.401970386505127, 3.5480427742004395, 5.8057146072387695, 4.554325103759766, 3.3816471099853516, 5.664980888366699, 3.6620354652404785, 4.037100791931152, 4.939079284667969, 4.784426689147949, 4.525550842285156, 3.513798475265503, 4.778186798095703, 5.300332069396973, 3.5500354766845703, 4.440639495849609, 0.9291510581970215, 1.111095905303955, 2.245844602584839, 3.8236770629882812, 4.561027526855469, 5.008892059326172, 4.334884166717529, 4.7718963623046875, 5.906899929046631, 5.627643585205078, 4.244469165802002, 3.8653414249420166, 4.588865280151367, 2.779237747192383], "mean_td_error": 3.87119197845459, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 20.0, "diff_num_grad_updates_vs_sampler_policy": 19.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.112264633178711, "actor_loss": -4.499502658843994, "critic_loss": 0.5886226892471313, "alpha_loss": -0.05766779184341431, "alpha_value": 0.9943134784698486, "log_alpha_value": -0.005702757742255926, "target_entropy": -6.0, "policy_t": 0.0012118201702833176, "mean_q": 0.5603931546211243, "max_q": 4.025807857513428, "min_q": 0.38646456599235535}, "td_error": [0.02933335304260254, 2.417198657989502, 0.7889391779899597, 2.6536102294921875, 0.65511155128479, 1.6176873445510864, 3.7064902782440186, 1.7309948205947876, 2.6404876708984375, 2.569249153137207, 1.4363417625427246, 0.2716907262802124, 0.6153844594955444, 1.2754113674163818, 1.7862753868103027, 1.9225008487701416, 2.8387978076934814, 0.656846821308136, 3.2737793922424316, 2.351980686187744, 1.8465673923492432, 2.4565582275390625, 1.710377812385559, 1.5092427730560303, 3.626235008239746, 1.0325725078582764, 2.151667833328247, 2.2964463233947754, 0.7966428995132446, 0.6296383142471313, 2.0142838954925537, 1.9336296319961548, 2.244835615158081, 1.330043077468872, 4.408583641052246, 2.2315235137939453, 0.9467660188674927, 0.9396560192108154, 2.0850634574890137, 3.8600335121154785, 3.578746795654297, 2.0318856239318848, 2.4082159996032715, 1.4036979675292969, 2.156338691711426, 0.1886909157037735, 1.3495532274246216, 3.175905227661133, 3.024916648864746, 0.23758792877197266, 2.1678853034973145, 5.3753838539123535, 2.401211977005005, 2.9755759239196777, 2.9814343452453613, 1.6121244430541992, 2.346947193145752, 2.434088706970215, 2.169174909591675, 0.061763644218444824, 2.7955737113952637, 3.987638473510742, 1.6263267993927002, 2.045241355895996, 2.957137107849121, 1.4211736917495728, 2.8087592124938965, 2.11334228515625, 1.2047538757324219, 2.6074604988098145, 1.822834849357605, 3.1608309745788574, 2.2755849361419678, 0.7477716207504272, 1.2264325618743896, 2.166973114013672, 1.2935564517974854, 2.4235477447509766, 1.117855191230774, 2.1894259452819824, 2.238992691040039, 0.3631264567375183, 0.5763421058654785, 1.4100894927978516, 3.008190155029297, 1.6509549617767334], "mean_td_error": 1.983831763267517, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 20.0, "diff_num_grad_updates_vs_sampler_policy": 19.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.122732162475586, "actor_loss": -4.508610725402832, "critic_loss": 0.8189138770103455, "alpha_loss": -0.05771314725279808, "alpha_value": 0.9943149089813232, "log_alpha_value": -0.005701340734958649, "target_entropy": -6.0, "policy_t": -0.011137099005281925, "mean_q": 0.5722128748893738, "max_q": 4.485993385314941, "min_q": 0.3746143579483032}, "td_error": [1.637765645980835, 0.5734692811965942, 1.9948149919509888, 2.621694326400757, 3.0241105556488037, 2.109962224960327, 0.7052557468414307, 4.073403358459473, 1.8341624736785889, 3.2875866889953613, 2.531231641769409, 1.4301536083221436, 5.023446083068848, 0.02042841911315918, 3.1691112518310547, 1.375370979309082, 3.2527060508728027, 2.576982021331787, 2.036672592163086, 0.5838642120361328, 3.178819417953491, 1.5167065858840942, 4.990060806274414, 2.024596929550171, 3.3906593322753906, 3.4440364837646484, 2.17205810546875, 1.323744773864746, 2.20406436920166, 1.7195711135864258, 1.2149131298065186, 2.374847412109375, 2.6124980449676514, 2.202864646911621, 2.666038751602173, 2.911221504211426, 1.3681492805480957, 3.4741482734680176, 1.7090022563934326, 1.9343057870864868, 1.15144944190979, 2.1787891387939453, 5.404107570648193, 2.944967746734619, 0.3912525177001953, 2.154503107070923, 2.582505941390991, 4.001260280609131, 3.386746406555176, 2.582498073577881, 0.5836880803108215, 1.7703725099563599, 2.3841500282287598, 1.9316143989562988, 2.151761054992676, 1.9962780475616455, 2.8778364658355713, 1.783733606338501, 2.8329877853393555, 0.3682711720466614, 1.8755168914794922, 0.4877087473869324, 2.3773396015167236, 0.408419132232666, 1.3894522190093994, 0.7568775415420532, 0.9228377938270569, 3.0085806846618652, 3.004096508026123, 1.9826245307922363, 2.7347445487976074, 4.511814117431641, 2.682420015335083, 1.8335747718811035, 4.486307144165039, 2.591600179672241, 0.21888521313667297, 3.4414443969726562, 3.912504196166992, 2.7309165000915527, 3.0368118286132812, 2.3004326820373535, 3.5988028049468994, 3.947742462158203, 1.5951919555664062, 2.0303902626037598], "mean_td_error": 2.3211662769317627, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 20.0, "diff_num_grad_updates_vs_sampler_policy": 19.0}}, "num_env_steps_sampled": 18816, "num_env_steps_trained": 5160, "num_agent_steps_sampled": 56448, "num_agent_steps_trained": 5160, "last_target_update_ts": 18816, "num_target_updates": 20}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56448, "num_agent_steps_trained": 5160, "num_env_steps_sampled": 18816, "num_env_steps_trained": 5160, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 885.2635279249547, "num_env_steps_trained_throughput_per_sec": 254.90847121053386, "timesteps_total": 18816, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 56448, "timers": {"training_iteration_time_ms": 994.724, "sample_time_ms": 708.834, "load_time_ms": 0.303, "load_throughput": 850798.358, "learn_time_ms": 17.674, "learn_throughput": 14598.015, "synch_weights_time_ms": 9.752}, "counters": {"num_env_steps_sampled": 18816, "num_env_steps_trained": 5160, "num_agent_steps_sampled": 56448, "num_agent_steps_trained": 5160, "last_target_update_ts": 18816, "num_target_updates": 20}, "done": false, "episodes_total": 0, "training_iteration": 13, "trial_id": "a2ad0_00000", "date": "2023-11-18_21-01-32", "timestamp": 1700370092, "time_this_iter_s": 2.034900188446045, "time_total_s": 21.60137391090393, "pid": 6505, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x154272980>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 21.60137391090393, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 78.43333333333334, "ram_util_percent": 65.33333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.101339340209961, "actor_loss": -4.626856327056885, "critic_loss": 2.303957462310791, "alpha_loss": -0.06368235498666763, "alpha_value": 0.9937154650688171, "log_alpha_value": -0.006304347421973944, "target_entropy": -6.0, "policy_t": -0.01273315493017435, "mean_q": 0.7230855226516724, "max_q": 8.137272834777832, "min_q": 0.4769592881202698}, "td_error": [4.0464067459106445, 3.4267115592956543, 3.29652738571167, 4.223206043243408, 4.798052787780762, 4.887599945068359, 5.33423376083374, 3.292370319366455, 4.9758195877075195, 5.097695827484131, 2.5803685188293457, 3.8789939880371094, 3.9932610988616943, 3.9989542961120605, 2.489027976989746, 3.0023703575134277, 6.495051383972168, 4.926944732666016, 3.274665355682373, 3.8627262115478516, 4.102677345275879, 6.23160457611084, 3.4490156173706055, 3.467087507247925, 3.8483872413635254, 3.341099262237549, 0.935171365737915, 1.6569952964782715, 3.953549385070801, 2.7703025341033936, 3.0610668659210205, 4.565881729125977, 4.497415065765381, 7.532283306121826, 4.79896354675293, 3.5768094062805176, 3.4411568641662598, 3.8167946338653564, 4.985743522644043, 2.8187646865844727, 4.364095687866211, 3.0650558471679688, 2.1025595664978027, 6.412847518920898, 3.287478446960449, 3.4402928352355957, 3.9847755432128906, 4.127467632293701, 3.5249035358428955, 5.8864922523498535, 3.411895751953125, 4.446602821350098, 5.053492546081543, 4.785552978515625, 4.251150131225586, 0.3823432922363281, 3.489600658416748, 4.602337837219238, 3.2223119735717773, 6.40678596496582, 5.528132438659668, 4.708657264709473, 4.261839389801025, 5.967482566833496, 2.5015244483947754, 5.769330978393555, 4.420903205871582, 2.6013519763946533, 4.4117279052734375, 3.4215152263641357, 2.7258572578430176, 3.729783058166504, 3.913990020751953, 5.570078372955322, 4.117277145385742, 4.300087928771973, 3.730215311050415, 3.5512893199920654, 4.718906879425049, 3.5198402404785156, 6.534488677978516, 3.3381974697113037, 4.2806620597839355, 5.324474334716797, 4.444596290588379, 3.876709461212158], "mean_td_error": 4.072659492492676, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 22.0, "diff_num_grad_updates_vs_sampler_policy": 21.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.099013328552246, "actor_loss": -4.554867267608643, "critic_loss": 0.6693282127380371, "alpha_loss": -0.06365545839071274, "alpha_value": 0.9937167167663574, "log_alpha_value": -0.006303135771304369, "target_entropy": -6.0, "policy_t": 0.03529830649495125, "mean_q": 0.6616779565811157, "max_q": 4.996312141418457, "min_q": 0.45869067311286926}, "td_error": [0.4823165535926819, 3.9934825897216797, 2.2102813720703125, 1.5238062143325806, 3.2066757678985596, 1.7295455932617188, 3.099154472351074, 2.8782739639282227, 2.1492080688476562, 0.1293283849954605, 1.4190373420715332, 2.689734935760498, 1.8435144424438477, 1.2523940801620483, 3.011012554168701, 1.5347421169281006, 2.7141075134277344, 1.960688591003418, 0.4920596480369568, 0.4467993676662445, 3.5901870727539062, 2.586803913116455, 5.485394477844238, 0.4078088402748108, 0.20049431920051575, 2.0928385257720947, 0.6623549461364746, 0.8081377148628235, 4.306307792663574, 4.568100929260254, 3.3168859481811523, 0.90517258644104, 1.497819423675537, 2.1002159118652344, 2.1536521911621094, 2.2448678016662598, 1.9763858318328857, 2.8437843322753906, 3.6959176063537598, 2.152893304824829, 1.3939385414123535, 3.297152519226074, 2.3905704021453857, 1.8655622005462646, 2.1465821266174316, 1.1822303533554077, 2.1836729049682617, 1.9302793741226196, 2.2412428855895996, 3.868237257003784, 0.14968310296535492, 0.06076216697692871, 3.386647939682007, 0.7195998430252075, 4.232037544250488, 2.2252354621887207, 4.447046279907227, 1.6735622882843018, 1.812950611114502, 2.397888660430908, 2.7197725772857666, 2.147747755050659, 1.929124355316162, 4.2966461181640625, 1.2175943851470947, 3.789564609527588, 1.7905383110046387, 0.06412424147129059, 1.5392684936523438, 0.02268211543560028, 2.296980381011963, 2.3225910663604736, 2.9196014404296875, 2.6483030319213867, 1.9931546449661255, 1.2373428344726562, 3.3761978149414062, 1.9129154682159424, 2.9055378437042236, 2.8317694664001465, 0.8424785137176514, 4.155394077301025, 3.8203988075256348, 2.390739679336548, 2.824510097503662, 1.4936373233795166], "mean_td_error": 2.2029731273651123, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 22.0, "diff_num_grad_updates_vs_sampler_policy": 21.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.150218963623047, "actor_loss": -4.602725028991699, "critic_loss": 0.6262058615684509, "alpha_loss": -0.06396384537220001, "alpha_value": 0.9937180876731873, "log_alpha_value": -0.006301721557974815, "target_entropy": -6.0, "policy_t": -0.01980837620794773, "mean_q": 0.5462397933006287, "max_q": 3.659738302230835, "min_q": 0.44113799929618835}, "td_error": [2.630466938018799, 1.7312428951263428, 0.049356505274772644, 2.280820369720459, 1.8135483264923096, 2.7916975021362305, 4.220001220703125, 4.305206775665283, 2.332427740097046, 1.9793813228607178, 2.56085205078125, 3.075603485107422, 1.9134409427642822, 3.1332993507385254, 1.449810266494751, 2.5228395462036133, 3.750429153442383, 2.379427433013916, 3.3803672790527344, 0.23023247718811035, 0.4969499707221985, 1.8969285488128662, 3.172719955444336, 1.285717487335205, 4.1016130447387695, 2.232081651687622, 2.0132062435150146, 1.7245327234268188, 1.2717260122299194, 0.8207443952560425, 1.3130309581756592, 1.2227966785430908, 1.0904126167297363, 2.1878747940063477, 0.870184063911438, 1.812625765800476, 2.3556485176086426, 2.5705466270446777, 3.1223044395446777, 2.254037380218506, 2.560049295425415, 1.6724498271942139, 2.2036242485046387, 2.1493937969207764, 0.9218651056289673, 3.220552444458008, 2.4316940307617188, 2.077058792114258, 0.617046594619751, 1.6460685729980469, 3.696852684020996, 3.624467134475708, 2.253704309463501, 3.0581088066101074, 0.677661657333374, 1.9369800090789795, 2.773118019104004, 2.9784090518951416, 1.8365633487701416, 2.475569248199463, 3.900169610977173, 1.7432589530944824, 1.810079574584961, 2.901855945587158, 2.6979470252990723, 2.4893312454223633, 1.1084198951721191, 0.36653196811676025, 0.2634308338165283, 2.721165657043457, 1.5897634029388428, 2.1096534729003906, 1.3295643329620361, 2.2439398765563965, 2.3327136039733887, 1.0476963520050049, 2.895261764526367, 2.591547966003418, 2.1037137508392334, 1.2044657468795776, 2.0551605224609375, 2.4912476539611816, 1.7404454946517944, 2.740029811859131, 0.26166200637817383, 2.061959743499756], "mean_td_error": 2.115795373916626, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 22.0, "diff_num_grad_updates_vs_sampler_policy": 21.0}}, "num_env_steps_sampled": 20608, "num_env_steps_trained": 5676, "num_agent_steps_sampled": 61824, "num_agent_steps_trained": 5676, "last_target_update_ts": 20608, "num_target_updates": 22}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 61824, "num_agent_steps_trained": 5676, "num_env_steps_sampled": 20608, "num_env_steps_trained": 5676, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 854.8652902884744, "num_env_steps_trained_throughput_per_sec": 246.15540724824373, "timesteps_total": 20608, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 61824, "timers": {"training_iteration_time_ms": 1012.369, "sample_time_ms": 724.553, "load_time_ms": 0.304, "load_throughput": 849729.432, "learn_time_ms": 17.811, "learn_throughput": 14485.382, "synch_weights_time_ms": 9.515}, "counters": {"num_env_steps_sampled": 20608, "num_env_steps_trained": 5676, "num_agent_steps_sampled": 61824, "num_agent_steps_trained": 5676, "last_target_update_ts": 20608, "num_target_updates": 22}, "done": false, "episodes_total": 0, "training_iteration": 14, "trial_id": "a2ad0_00000", "date": "2023-11-18_21-01-34", "timestamp": 1700370094, "time_this_iter_s": 2.103940010070801, "time_total_s": 23.70531392097473, "pid": 6505, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x1542725c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 23.70531392097473, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 75.2, "ram_util_percent": 65.36666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.097047805786133, "actor_loss": -4.671551704406738, "critic_loss": 2.3957550525665283, "alpha_loss": -0.06668705493211746, "alpha_value": 0.9934171438217163, "log_alpha_value": -0.0066046095453202724, "target_entropy": -6.0, "policy_t": 0.020401736721396446, "mean_q": 0.579742968082428, "max_q": 3.270801544189453, "min_q": 0.5155656337738037}, "td_error": [4.338173866271973, 3.785020351409912, 2.0641326904296875, 6.012015342712402, 3.7542974948883057, 5.296947479248047, 4.959603309631348, 4.5066633224487305, 3.8727200031280518, 5.454608917236328, 3.436335802078247, 2.7416484355926514, 3.509601593017578, 4.399430751800537, 5.22982120513916, 2.156733989715576, 4.855912685394287, 6.150544166564941, 2.782057046890259, 4.103630065917969, 3.925954580307007, 3.9334359169006348, 3.605250120162964, 3.27048397064209, 4.177846908569336, 3.6102521419525146, 5.407949447631836, 2.6607749462127686, 6.014387130737305, 6.000765800476074, 5.277498245239258, 4.257506847381592, 4.811975479125977, 6.080384254455566, 3.671210527420044, 1.208246111869812, 4.681062698364258, 5.333353042602539, 5.071201324462891, 3.7681474685668945, 3.69484281539917, 3.8946657180786133, 5.118128299713135, 4.398216247558594, 3.6679930686950684, 4.925749778747559, 3.269299030303955, 4.345410346984863, 3.4461655616760254, 4.116164207458496, 4.432516098022461, 4.919748306274414, 5.3964738845825195, 4.770756244659424, 0.11762690544128418, 2.5819954872131348, 4.2448039054870605, 3.1813583374023438, 2.2895359992980957, 4.678853988647461, 6.514850616455078, 3.5655503273010254, 4.630864143371582, 4.199983596801758, 6.217634677886963, 4.784659385681152, 4.263435363769531, 3.656428337097168, 4.387290954589844, 3.2995986938476562, 4.482789993286133, 3.2140274047851562, 4.384530067443848, 4.420803546905518, 5.080580234527588, 3.858823299407959, 5.190086841583252, 4.681634902954102, 4.931551933288574, 3.1602277755737305, 4.602237701416016, 4.513251304626465, 2.98286771774292, 5.589051723480225, 3.0860066413879395, 2.6932320594787598], "mean_td_error": 4.186742782592773, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 23.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.108619689941406, "actor_loss": -4.611717224121094, "critic_loss": 0.7276800870895386, "alpha_loss": -0.0667504370212555, "alpha_value": 0.9934184551239014, "log_alpha_value": -0.006603318266570568, "target_entropy": -6.0, "policy_t": 0.004751209169626236, "mean_q": 0.6021888256072998, "max_q": 3.4288716316223145, "min_q": 0.49743130803108215}, "td_error": [1.9210211038589478, 3.8198904991149902, 2.6973767280578613, 3.2700371742248535, 0.9397149085998535, 1.54768705368042, 3.9477531909942627, 2.725878953933716, 2.696859836578369, 3.697221279144287, 1.0852599143981934, 1.9525024890899658, 1.7215240001678467, 2.555190086364746, 1.4696357250213623, 0.5965368747711182, 3.4525532722473145, 2.4968318939208984, 2.659972667694092, 3.123103618621826, 3.0454509258270264, 2.53167724609375, 2.597960948944092, 1.887162208557129, 3.029977560043335, 0.4168323278427124, 2.3161377906799316, 1.7192561626434326, 1.3040893077850342, 2.2755250930786133, 1.2504689693450928, 2.927246570587158, 3.6722164154052734, 3.412357807159424, 2.281085968017578, 3.7976622581481934, 3.195578098297119, 3.290421962738037, 2.242544651031494, 1.7248828411102295, 3.3151373863220215, 2.9025826454162598, 1.0258539915084839, 0.219344824552536, 0.5580192804336548, 1.251341700553894, 1.1907808780670166, 2.642345428466797, 2.764615058898926, 0.9797787666320801, 2.7232911586761475, 2.323742389678955, 3.935084819793701, 2.8426756858825684, 2.8719544410705566, 2.796815872192383, 2.724635362625122, 2.725010871887207, 4.89027738571167, 1.9474742412567139, 2.6638731956481934, 2.072781801223755, 1.6706377267837524, 1.928449034690857, 3.2682032585144043, 3.233539581298828, 1.727540135383606, 0.6618564128875732, 4.339132785797119, 1.89363694190979, 1.0366008281707764, 1.7226388454437256, 3.9110608100891113, 2.5992002487182617, 2.6776504516601562, 0.8182415962219238, 3.4419898986816406, 0.07327902317047119, 2.381713628768921, 0.4012088179588318, 1.7969157695770264, 2.83271861076355, 1.5339953899383545, 2.999788761138916, 0.8282336592674255, 3.9973137378692627], "mean_td_error": 2.330674886703491, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 23.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.103132247924805, "actor_loss": -4.590489387512207, "critic_loss": 0.6638119220733643, "alpha_loss": -0.06670103222131729, "alpha_value": 0.9934197068214417, "log_alpha_value": -0.006602015811949968, "target_entropy": -6.0, "policy_t": -0.009271003305912018, "mean_q": 0.5543043613433838, "max_q": 5.245040416717529, "min_q": 0.47682860493659973}, "td_error": [2.4631075859069824, 1.0607314109802246, 3.3181684017181396, 2.088253974914551, 1.6657354831695557, 1.7545888423919678, 1.2445695400238037, 1.3966867923736572, 0.3656339943408966, 2.978762149810791, 1.5929844379425049, 1.643204927444458, 3.2803897857666016, 2.20945405960083, 2.379575252532959, 2.321578025817871, 2.1599390506744385, 1.6025135517120361, 3.4672560691833496, 1.4372071027755737, 2.6167540550231934, 1.4445290565490723, 2.6170387268066406, 0.9607421159744263, 4.079009056091309, 1.8365559577941895, 2.815122365951538, 2.626187324523926, 3.2412705421447754, 1.3169673681259155, 1.8669986724853516, 2.0055742263793945, 1.0231590270996094, 2.826718330383301, 2.0324363708496094, 2.75946044921875, 1.378570318222046, 3.2150118350982666, 2.5210678577423096, 2.7415363788604736, 2.5120387077331543, 2.0661206245422363, 2.0995230674743652, 2.361593246459961, 1.0967953205108643, 4.259260654449463, 0.07676880061626434, 1.274446725845337, 2.548051357269287, 2.043004035949707, 1.5884068012237549, 2.0423264503479004, 3.5116636753082275, 1.7381227016448975, 3.128174304962158, 1.556300401687622, 1.9860056638717651, 2.323092460632324, 3.1403417587280273, 4.326104164123535, 2.2923500537872314, 2.3941144943237305, 2.45453143119812, 2.470954179763794, 0.4981035888195038, 1.1877920627593994, 0.588973343372345, 3.324284791946411, 1.3919639587402344, 4.597127437591553, 1.8881433010101318, 1.7401901483535767, 1.6479783058166504, 1.5607632398605347, 3.5516867637634277, 1.4056891202926636, 3.1386759281158447, 1.5169875621795654, 1.9975037574768066, 4.645721435546875, 3.021314859390259, 0.9823147058486938, 2.0709688663482666, 2.3543195724487305, 0.4493475556373596, 3.8627490997314453], "mean_td_error": 2.1984620094299316, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 23.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 21504, "num_env_steps_trained": 5934, "num_agent_steps_sampled": 64512, "num_agent_steps_trained": 5934, "last_target_update_ts": 21504, "num_target_updates": 23}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64512, "num_agent_steps_trained": 5934, "num_env_steps_sampled": 21504, "num_env_steps_trained": 5934, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 773.5514722727606, "num_env_steps_trained_throughput_per_sec": 222.7413837571119, "timesteps_total": 21504, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 64512, "timers": {"training_iteration_time_ms": 1029.146, "sample_time_ms": 740.96, "load_time_ms": 0.304, "load_throughput": 848330.536, "learn_time_ms": 18.141, "learn_throughput": 14221.885, "synch_weights_time_ms": 9.751}, "counters": {"num_env_steps_sampled": 21504, "num_env_steps_trained": 5934, "num_agent_steps_sampled": 64512, "num_agent_steps_trained": 5934, "last_target_update_ts": 21504, "num_target_updates": 23}, "done": false, "episodes_total": 0, "training_iteration": 15, "trial_id": "a2ad0_00000", "date": "2023-11-18_21-01-35", "timestamp": 1700370095, "time_this_iter_s": 1.1684858798980713, "time_total_s": 24.873799800872803, "pid": 6505, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x1542d80e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 24.873799800872803, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 76.65, "ram_util_percent": 66.19999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.102919578552246, "actor_loss": -4.723481178283691, "critic_loss": 1.8109989166259766, "alpha_loss": -0.0697593167424202, "alpha_value": 0.993118941783905, "log_alpha_value": -0.006904866546392441, "target_entropy": -6.0, "policy_t": 0.013579319231212139, "mean_q": 0.7588412165641785, "max_q": 5.933048248291016, "min_q": 0.5560646653175354}, "td_error": [2.04019832611084, 4.7310895919799805, 3.713318347930908, 2.592545509338379, 4.584026336669922, 4.996782302856445, 5.003526210784912, 5.477669715881348, 2.075939178466797, 4.264980792999268, 1.347041368484497, 3.825051784515381, 3.57087779045105, 3.74320650100708, 5.251406669616699, 3.2442128658294678, 3.6171398162841797, 4.663805961608887, 6.091615676879883, 5.207322120666504, 3.6961073875427246, 4.078873634338379, 4.691875457763672, 4.85299015045166, 4.7168192863464355, 3.1202425956726074, 4.3977460861206055, 4.765015602111816, 2.5857319831848145, 4.222357749938965, 2.696889877319336, 4.4792680740356445, 4.469862937927246, 4.139017581939697, 4.901857376098633, 3.319369077682495, 4.360774040222168, 3.7769975662231445, 2.246187448501587, 4.205739498138428, 2.972957134246826, 4.56915283203125, 1.9467737674713135, 3.7470874786376953, 2.8464226722717285, 0.3990163803100586, 3.7699568271636963, 3.4858455657958984, 4.181021690368652, 4.328526020050049, 3.3973517417907715, 2.7589030265808105, 3.536543369293213, 4.609149932861328, 3.7112112045288086, 3.5294575691223145, 0.951542854309082, 4.507809638977051, 3.050767183303833, 4.422022819519043, 3.686495304107666, 6.188916206359863, 5.016195297241211, 2.699615478515625, 3.5713143348693848, 3.985515594482422, 4.2773261070251465, 2.078127861022949, 1.7491297721862793, 4.139583587646484, 3.7933220863342285, 4.480707168579102, 2.2917532920837402, 3.2536780834198, 3.7306618690490723, 4.847209930419922, 4.613269805908203, 4.772433280944824, 1.707653284072876, 5.5030622482299805, 3.443424940109253, 0.5114026069641113, 4.64240837097168, 3.9487550258636475, 3.1085689067840576, 2.289597749710083], "mean_td_error": 3.7304317951202393, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 24.0, "diff_num_grad_updates_vs_sampler_policy": 23.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.098867416381836, "actor_loss": -4.6392822265625, "critic_loss": 0.666490375995636, "alpha_loss": -0.06971769779920578, "alpha_value": 0.9931202530860901, "log_alpha_value": -0.006903517991304398, "target_entropy": -6.0, "policy_t": 0.0200259480625391, "mean_q": 0.6738795638084412, "max_q": 5.067924976348877, "min_q": 0.5385314226150513}, "td_error": [0.6520677804946899, 1.1967337131500244, 1.757797122001648, 0.5119402408599854, 2.79672908782959, 2.2140681743621826, 2.715054750442505, 0.31672871112823486, 2.542263984680176, 1.9355747699737549, 2.6828579902648926, 2.811889171600342, 1.1808279752731323, 2.896617889404297, 0.46630555391311646, 1.6291395425796509, 2.110837936401367, 2.4628591537475586, 1.2139490842819214, 0.9003323912620544, 0.9855966567993164, 0.5418956875801086, 3.18003249168396, 0.6403101682662964, 3.095463275909424, 3.175839424133301, 2.638538122177124, 2.5357558727264404, 2.3262643814086914, 2.8103935718536377, 2.5320937633514404, 3.9832098484039307, 0.11883330345153809, 3.1835999488830566, 2.7959208488464355, 2.8731014728546143, 2.554811954498291, 2.884235382080078, 0.18555212020874023, 2.350054979324341, 2.4967730045318604, 1.5475664138793945, 2.5281825065612793, 2.677579879760742, 0.4306257367134094, 1.5908284187316895, 1.0546510219573975, 3.6929211616516113, 0.6711986064910889, 3.0265555381774902, 2.315809726715088, 1.3677741289138794, 1.2154618501663208, 1.913391351699829, 2.0820069313049316, 2.2903244495391846, 3.2670459747314453, 2.988406181335449, 2.26193904876709, 1.8227577209472656, 2.192826986312866, 1.201775074005127, 2.242161750793457, 2.035531520843506, 2.0713577270507812, 0.9549991488456726, 2.4399526119232178, 3.6323318481445312, 3.6866939067840576, 1.2587368488311768, 2.5623679161071777, 1.5214245319366455, 1.8008050918579102, 5.4517502784729, 3.2552871704101562, 2.9376111030578613, 2.668545722961426, 1.2989976406097412, 3.7891364097595215, 2.1591556072235107, 2.7084801197052, 2.666788339614868, 2.2950148582458496, 2.1216483116149902, 0.1137763261795044, 4.543478012084961], "mean_td_error": 2.1539361476898193, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 24.0, "diff_num_grad_updates_vs_sampler_policy": 23.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.111093521118164, "actor_loss": -4.643515110015869, "critic_loss": 0.6607055068016052, "alpha_loss": -0.06978999078273773, "alpha_value": 0.9931214451789856, "log_alpha_value": -0.00690231891348958, "target_entropy": -6.0, "policy_t": -0.014989526011049747, "mean_q": 0.8989393711090088, "max_q": 5.501060485839844, "min_q": 0.5143012404441833}, "td_error": [2.530595302581787, 1.5312633514404297, 0.8348725438117981, 2.248634099960327, 2.075392484664917, 0.5714888572692871, 2.6556777954101562, 2.3271100521087646, 2.062518835067749, 2.3588314056396484, 1.2922576665878296, 2.2985029220581055, 2.4545395374298096, 2.0569405555725098, 2.9871273040771484, 2.2659213542938232, 2.73207950592041, 4.2207770347595215, 2.117128849029541, 1.1457977294921875, 2.948817014694214, 2.159895420074463, 0.8636696338653564, 2.03770112991333, 2.995875835418701, 4.304643630981445, 0.00624239444732666, 2.9945461750030518, 2.2606046199798584, 2.695340156555176, 2.76361083984375, 3.5795609951019287, 1.9289594888687134, 3.18473482131958, 2.2689032554626465, 2.4056637287139893, 1.0689666271209717, 2.849499225616455, 1.8217989206314087, 0.9150431752204895, 3.1077725887298584, 1.5911049842834473, 3.6233487129211426, 2.8931593894958496, 2.836376905441284, 4.102402687072754, 0.8502160310745239, 3.694467067718506, 0.3398730158805847, 2.4521965980529785, 2.472681999206543, 2.2482011318206787, 3.117763042449951, 2.1685259342193604, 2.643399953842163, 1.9520037174224854, 2.254946708679199, 1.4767910242080688, 1.116754412651062, 0.159186452627182, 1.3776659965515137, 1.1228724718093872, 3.3020777702331543, 3.5499024391174316, 1.3398220539093018, 2.7022476196289062, 3.1228036880493164, 1.2442690134048462, 0.47572386264801025, 3.416995048522949, 0.637257993221283, 2.87324857711792, 0.3908219337463379, 2.305065631866455, 1.7420732975006104, 1.8575936555862427, 1.0422841310501099, 4.248227119445801, 2.6550118923187256, 1.6355199813842773, 2.924208402633667, 3.7596797943115234, 2.0337107181549072, 2.9110107421875, 3.41267728805542, 2.479334831237793], "mean_td_error": 2.2381954193115234, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 24.0, "diff_num_grad_updates_vs_sampler_policy": 23.0}}, "num_env_steps_sampled": 22400, "num_env_steps_trained": 6192, "num_agent_steps_sampled": 67200, "num_agent_steps_trained": 6192, "last_target_update_ts": 22400, "num_target_updates": 24}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 67200, "num_agent_steps_trained": 6192, "num_env_steps_sampled": 22400, "num_env_steps_trained": 6192, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 876.6378242024679, "num_env_steps_trained_throughput_per_sec": 252.42473062972846, "timesteps_total": 22400, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 67200, "timers": {"training_iteration_time_ms": 1035.517, "sample_time_ms": 747.254, "load_time_ms": 0.304, "load_throughput": 847466.859, "learn_time_ms": 18.137, "learn_throughput": 14225.269, "synch_weights_time_ms": 9.831}, "counters": {"num_env_steps_sampled": 22400, "num_env_steps_trained": 6192, "num_agent_steps_sampled": 67200, "num_agent_steps_trained": 6192, "last_target_update_ts": 22400, "num_target_updates": 24}, "done": false, "episodes_total": 0, "training_iteration": 16, "trial_id": "a2ad0_00000", "date": "2023-11-18_21-01-36", "timestamp": 1700370096, "time_this_iter_s": 1.0309545993804932, "time_total_s": 25.904754400253296, "pid": 6505, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x1542d9260>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 25.904754400253296, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 67.69999999999999, "ram_util_percent": 66.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.118510246276855, "actor_loss": -4.797047138214111, "critic_loss": 1.9460225105285645, "alpha_loss": -0.07290518283843994, "alpha_value": 0.9928207397460938, "log_alpha_value": -0.007205130532383919, "target_entropy": -6.0, "policy_t": 0.0482536144554615, "mean_q": 0.9605799913406372, "max_q": 9.786796569824219, "min_q": 0.5984829664230347}, "td_error": [4.0606184005737305, 2.7706875801086426, 3.383251905441284, 3.8318614959716797, 3.171410083770752, 2.4478859901428223, 3.3709003925323486, 4.242795944213867, 1.8211698532104492, 1.4997289180755615, 3.756434440612793, 3.8382654190063477, 3.4540462493896484, 2.3620402812957764, 2.97511625289917, 4.128355979919434, 5.473283290863037, 4.585751533508301, 3.5173516273498535, 3.860222816467285, 2.9973182678222656, 3.1328959465026855, 3.735210418701172, 3.237419366836548, 5.5918121337890625, 4.1439290046691895, 5.114764213562012, 1.9953956604003906, 5.8224992752075195, 4.304631233215332, 3.6108813285827637, 3.5913329124450684, 2.781686305999756, 5.458242416381836, 3.754728317260742, 4.272000312805176, 3.323686361312866, 4.991874694824219, 5.206171035766602, 4.190649032592773, 2.5306754112243652, 5.162147521972656, 4.365928649902344, 2.819314479827881, 3.9925451278686523, 4.209242820739746, 2.1270012855529785, 4.165750503540039, 4.79969596862793, 4.258000373840332, 2.368788242340088, 4.654175281524658, 4.457986831665039, 5.5944318771362305, 4.972949028015137, 5.316649436950684, 3.842919111251831, 3.924412250518799, 3.079111099243164, 4.784518241882324, 5.021149635314941, 2.420135021209717, 4.998822212219238, 3.787970781326294, 5.626350402832031, 0.9918339848518372, 5.266233444213867, 2.307701587677002, 2.6956305503845215, 3.0974082946777344, 4.005376815795898, 5.125453948974609, 2.2100236415863037, 3.3863630294799805, 4.447774887084961, 4.309962749481201, 5.848668098449707, 3.783982992172241, 4.276033401489258, 4.884514808654785, 4.365263938903809, 2.802079677581787, 4.834723949432373, 4.8924102783203125, 4.476048946380615, 2.6481518745422363], "mean_td_error": 3.880751609802246, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 25.0, "diff_num_grad_updates_vs_sampler_policy": 24.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.098174095153809, "actor_loss": -4.677731037139893, "critic_loss": 0.6822939515113831, "alpha_loss": -0.07274433970451355, "alpha_value": 0.9928221702575684, "log_alpha_value": -0.007203712593764067, "target_entropy": -6.0, "policy_t": -0.02638699673116207, "mean_q": 0.663263201713562, "max_q": 4.820608139038086, "min_q": 0.5818321704864502}, "td_error": [2.311519145965576, 3.149566650390625, 3.6644606590270996, 1.5439515113830566, 2.1155333518981934, 3.9390268325805664, 2.665468454360962, 3.2596349716186523, 3.2715611457824707, 3.2126801013946533, 1.9630122184753418, 1.3937526941299438, 1.9452598094940186, 2.4637272357940674, 2.547898292541504, 2.7524943351745605, 1.5768715143203735, 1.8193449974060059, 2.1036081314086914, 1.9569852352142334, 2.2313647270202637, 3.085193157196045, 3.1431169509887695, 2.1502525806427, 2.2031450271606445, 0.7448108196258545, 1.9055949449539185, 2.5491836071014404, 3.4346516132354736, 3.5094704627990723, 3.338709592819214, 2.117945909500122, 1.811192512512207, 1.8021948337554932, 0.8042962551116943, 1.3591880798339844, 1.7343488931655884, 0.3525393009185791, 2.9682793617248535, 2.48649263381958, 1.0747849941253662, 2.3220927715301514, 2.7660763263702393, 2.5735666751861572, 3.0209121704101562, 3.93007755279541, 3.081355333328247, 0.04990309476852417, 3.48905611038208, 2.045228958129883, 3.715129852294922, 1.3832886219024658, 3.1152501106262207, 2.4262893199920654, 0.8578871488571167, 0.37366706132888794, 1.8552733659744263, 3.2911674976348877, 0.113483726978302, 0.925788164138794, 1.797652244567871, 1.2741578817367554, 0.8760883212089539, 1.7081162929534912, 1.6079659461975098, 1.1180477142333984, 1.8570988178253174, 2.2698862552642822, 3.704843759536743, 2.7745959758758545, 4.706390380859375, 1.4785499572753906, 3.272731304168701, 1.8311481475830078, 1.2024335861206055, 2.86722469329834, 1.3716604709625244, 2.263538360595703, 2.4463391304016113, 2.80133318901062, 1.0370697975158691, 1.6308884620666504, 3.8261823654174805, 2.9023914337158203, 1.1616284847259521, 1.1686683893203735], "mean_td_error": 2.2180840969085693, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 25.0, "diff_num_grad_updates_vs_sampler_policy": 24.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.10450267791748, "actor_loss": -4.669244766235352, "critic_loss": 0.4899652600288391, "alpha_loss": -0.07277913391590118, "alpha_value": 0.9928232431411743, "log_alpha_value": -0.007202644366770983, "target_entropy": -6.0, "policy_t": -0.009682880714535713, "mean_q": 0.7487894892692566, "max_q": 5.694587707519531, "min_q": 0.5526453852653503}, "td_error": [1.0188666582107544, 3.675750494003296, 1.8177965879440308, 2.6565046310424805, 2.071392059326172, 1.583583116531372, 1.9819884300231934, 2.947878122329712, 1.3663345575332642, 2.32401704788208, 1.9489562511444092, 0.7901433706283569, 0.36616408824920654, 3.2149062156677246, 2.7561235427856445, 1.9678325653076172, 1.5428122282028198, 2.580231189727783, 3.586859703063965, 2.2253246307373047, 1.3897799253463745, 2.136963129043579, 1.5731234550476074, 1.1871631145477295, 1.2828478813171387, 3.3095755577087402, 2.189854145050049, 2.172541856765747, 1.7290644645690918, 2.502213954925537, 1.8341431617736816, 2.169051170349121, 1.2414143085479736, 2.1643004417419434, 1.1587766408920288, 2.085514545440674, 1.8250839710235596, 2.2434568405151367, 3.6763839721679688, 2.925300359725952, 3.152981996536255, 1.2582813501358032, 2.582700252532959, 2.7293944358825684, 3.5721583366394043, 4.005589485168457, 0.44646477699279785, 2.315988063812256, 0.3284425735473633, 3.0377445220947266, 1.5758874416351318, 2.5921623706817627, 2.2548365592956543, 2.534588575363159, 0.728122889995575, 3.8249754905700684, 2.9758477210998535, 0.8474782705307007, 1.8372390270233154, 3.1182949542999268, 2.907522678375244, 0.5980139374732971, 2.055108070373535, 2.5305421352386475, 3.9660568237304688, 2.9542295932769775, 0.9499529600143433, 0.48021185398101807, 2.916253089904785, 0.6814068555831909, 0.7910847663879395, 3.5087828636169434, 2.983409881591797, 1.1963398456573486, 3.1095967292785645, 2.2852416038513184, 3.918517589569092, 1.5340927839279175, 2.0178048610687256, 1.8400657176971436, 4.751075744628906, 1.4254186153411865, 1.501002311706543, 1.4879441261291504, 2.51971697807312, 3.0315628051757812], "mean_td_error": 2.173024892807007, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 25.0, "diff_num_grad_updates_vs_sampler_policy": 24.0}}, "num_env_steps_sampled": 23296, "num_env_steps_trained": 6450, "num_agent_steps_sampled": 69888, "num_agent_steps_trained": 6450, "last_target_update_ts": 23296, "num_target_updates": 25}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 69888, "num_agent_steps_trained": 6450, "num_env_steps_sampled": 23296, "num_env_steps_trained": 6450, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 757.5052440472963, "num_env_steps_trained_throughput_per_sec": 218.12092964754737, "timesteps_total": 23296, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 69888, "timers": {"training_iteration_time_ms": 1055.285, "sample_time_ms": 746.929, "load_time_ms": 0.306, "load_throughput": 843306.135, "learn_time_ms": 18.222, "learn_throughput": 14158.822, "synch_weights_time_ms": 10.018}, "counters": {"num_env_steps_sampled": 23296, "num_env_steps_trained": 6450, "num_agent_steps_sampled": 69888, "num_agent_steps_trained": 6450, "last_target_update_ts": 23296, "num_target_updates": 25}, "done": false, "episodes_total": 0, "training_iteration": 17, "trial_id": "a2ad0_00000", "date": "2023-11-18_21-01-37", "timestamp": 1700370097, "time_this_iter_s": 1.1913220882415771, "time_total_s": 27.096076488494873, "pid": 6505, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x154273380>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 27.096076488494873, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 95.4, "ram_util_percent": 66.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.114587783813477, "actor_loss": -4.876154899597168, "critic_loss": 1.9885449409484863, "alpha_loss": -0.07895147055387497, "alpha_value": 0.9922246932983398, "log_alpha_value": -0.007805703207850456, "target_entropy": -6.0, "policy_t": 0.009311032481491566, "mean_q": 1.1154911518096924, "max_q": 8.75531005859375, "min_q": 0.6843216419219971}, "td_error": [3.8206231594085693, 2.7897942066192627, 4.506080627441406, 2.055583953857422, 2.6431374549865723, 4.0117669105529785, 4.740296840667725, 3.1900181770324707, 4.1290283203125, 2.525028944015503, 3.931962728500366, 4.905723571777344, 5.0370988845825195, 3.080458879470825, 3.963967800140381, 3.343191146850586, 3.62172269821167, 2.617866039276123, 5.15451717376709, 5.585278034210205, 4.680694580078125, 3.066293716430664, 5.060727119445801, 4.185406684875488, 2.559065580368042, 6.022073268890381, 5.110476493835449, 3.3484296798706055, 5.521378517150879, 6.174648284912109, 4.024442672729492, 2.4502334594726562, 5.062099933624268, 4.357827663421631, 5.732049465179443, 4.248737335205078, 5.255390167236328, 5.708357810974121, 2.420536994934082, 3.874657154083252, 3.898406505584717, 4.106077671051025, 4.045967102050781, 1.7896183729171753, 4.058487892150879, 2.3483669757843018, 4.145473480224609, 4.521406173706055, 4.127678871154785, 4.776660919189453, 3.277270793914795, 4.157713890075684, 2.9173974990844727, 3.5948309898376465, 4.442931175231934, 4.498888969421387, 3.989391326904297, 4.091030597686768, 3.775913715362549, 2.168316602706909, 3.1007463932037354, 4.395524501800537, 0.33809638023376465, 5.553013801574707, 2.0604302883148193, 5.692864418029785, 4.752049446105957, 4.067913055419922, 3.7738780975341797, 4.1745285987854, 4.003450393676758, 3.6070432662963867, 4.421093463897705, 4.958024501800537, 1.917840600013733, 3.678178071975708, 4.535388469696045, 4.163722038269043, 4.742697715759277, 4.1751017570495605, 2.6778297424316406, 5.29400634765625, 2.70741605758667, 1.8396542072296143, 4.9920196533203125, 5.371120452880859], "mean_td_error": 3.9563040733337402, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 27.0, "diff_num_grad_updates_vs_sampler_policy": 26.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.090389251708984, "actor_loss": -4.764335632324219, "critic_loss": 0.5939613580703735, "alpha_loss": -0.07874663919210434, "alpha_value": 0.992226243019104, "log_alpha_value": -0.007804122753441334, "target_entropy": -6.0, "policy_t": 0.002908488502725959, "mean_q": 0.9557269811630249, "max_q": 6.3203020095825195, "min_q": 0.6743639707565308}, "td_error": [1.5662784576416016, 3.0557775497436523, 3.1415233612060547, 1.056596040725708, 2.666562080383301, 2.103026866912842, 1.4997482299804688, 1.3300367593765259, 2.2504796981811523, 2.4238219261169434, 0.061429738998413086, 2.6524462699890137, 1.9937326908111572, 1.1327744722366333, 2.096181869506836, 3.09220290184021, 2.6609373092651367, 0.6778559684753418, 3.6105403900146484, 2.8507132530212402, 1.8225702047348022, 0.43001842498779297, 2.705759048461914, 1.1294121742248535, 1.3417003154754639, 2.3107924461364746, 1.9670794010162354, 1.2782117128372192, 2.4547572135925293, 1.660412311553955, 2.433218479156494, 1.5847983360290527, 2.3512473106384277, 1.6549054384231567, 2.6999876499176025, 2.5017249584198, 1.2068891525268555, 3.078183174133301, 0.19657650589942932, 2.7519991397857666, 1.5436348915100098, 1.1787478923797607, 0.9879438281059265, 1.9095548391342163, 0.12718799710273743, 1.904941201210022, 2.031054735183716, 1.72335946559906, 3.2778289318084717, 0.08926194906234741, 1.2619684934616089, 1.1988182067871094, 0.9923883676528931, 2.3360137939453125, 0.37671488523483276, 1.9671741724014282, 3.519465446472168, 3.1912288665771484, 1.1921489238739014, 3.929788589477539, 2.9259395599365234, 2.273487091064453, 1.7961968183517456, 2.6379916667938232, 1.566612958908081, 3.732235908508301, 0.9470068216323853, 0.2298421859741211, 3.3779683113098145, 0.1144990622997284, 2.66660213470459, 0.19028538465499878, 3.0680387020111084, 2.330606460571289, 2.515146493911743, 3.3618950843811035, 2.256016254425049, 1.585990309715271, 2.316211700439453, 3.1327016353607178, 1.6328656673431396, 2.8904168605804443, 2.078159809112549, 1.2990002632141113, 1.2950690984725952, 2.053562641143799], "mean_td_error": 1.9592615365982056, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 27.0, "diff_num_grad_updates_vs_sampler_policy": 26.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.03352165222168, "actor_loss": -4.683331489562988, "critic_loss": 0.46119362115859985, "alpha_loss": -0.07829441875219345, "alpha_value": 0.9922270774841309, "log_alpha_value": -0.0078032854944467545, "target_entropy": -6.0, "policy_t": 0.014558748342096806, "mean_q": 0.8470655083656311, "max_q": 5.972922325134277, "min_q": 0.6312275528907776}, "td_error": [1.010848045349121, 0.792575478553772, 1.3405961990356445, 1.0638866424560547, 0.9463893175125122, 2.6060471534729004, 0.9230846166610718, 1.8866894245147705, 2.182508945465088, 5.227084159851074, 3.7801992893218994, 0.4023827016353607, 3.431487560272217, 2.7655160427093506, 3.016939878463745, 3.435333013534546, 1.9522006511688232, 0.5832482576370239, 3.519416093826294, 3.726409912109375, 0.006348133087158203, 1.8862229585647583, 3.377830743789673, 1.4275009632110596, 2.7450315952301025, 4.16257381439209, 2.0066657066345215, 0.5038535594940186, 3.3102705478668213, 1.9780185222625732, 0.3807133734226227, 1.488328218460083, 2.7348222732543945, 0.17413058876991272, 2.1893157958984375, 1.5675938129425049, 2.209406852722168, 0.9380171298980713, 1.4783976078033447, 2.68794584274292, 3.1547179222106934, 1.5342223644256592, 0.3518419861793518, 3.8596506118774414, 2.8967366218566895, 0.7042408585548401, 2.175588846206665, 3.607877731323242, 0.5594840049743652, 3.793668270111084, 3.953110694885254, 2.474909782409668, 1.677364706993103, 2.006420612335205, 1.0951341390609741, 2.067552089691162, 2.251616954803467, 0.25150543451309204, 1.677302360534668, 1.7273768186569214, 1.2435591220855713, 1.3692328929901123, 1.0435633659362793, 1.510908603668213, 3.8249154090881348, 2.0198891162872314, 3.2913966178894043, 1.7702816724777222, 3.649573802947998, 2.2361202239990234, 1.0040321350097656, 3.1685214042663574, 2.915353775024414, 3.5166635513305664, 1.899530053138733, 0.8819164037704468, 2.030507802963257, 2.622372627258301, 1.1066619157791138, 1.1032036542892456, 1.2744965553283691, 1.5065072774887085, 3.625314235687256, 0.15556609630584717, 2.2031784057617188, 3.317124128341675], "mean_td_error": 2.0692620277404785, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 27.0, "diff_num_grad_updates_vs_sampler_policy": 26.0}}, "num_env_steps_sampled": 25088, "num_env_steps_trained": 6966, "num_agent_steps_sampled": 75264, "num_agent_steps_trained": 6966, "last_target_update_ts": 25088, "num_target_updates": 27}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 75264, "num_agent_steps_trained": 6966, "num_env_steps_sampled": 25088, "num_env_steps_trained": 6966, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 938.08039027936, "num_env_steps_trained_throughput_per_sec": 270.1168980938336, "timesteps_total": 25088, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 75264, "timers": {"training_iteration_time_ms": 1036.071, "sample_time_ms": 744.5, "load_time_ms": 0.306, "load_throughput": 844293.073, "learn_time_ms": 18.181, "learn_throughput": 14190.367, "synch_weights_time_ms": 10.101}, "counters": {"num_env_steps_sampled": 25088, "num_env_steps_trained": 6966, "num_agent_steps_sampled": 75264, "num_agent_steps_trained": 6966, "last_target_update_ts": 25088, "num_target_updates": 27}, "done": false, "episodes_total": 0, "training_iteration": 18, "trial_id": "a2ad0_00000", "date": "2023-11-18_21-01-39", "timestamp": 1700370099, "time_this_iter_s": 1.9200899600982666, "time_total_s": 29.01616644859314, "pid": 6505, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x154273f60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 29.01616644859314, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 73.10000000000001, "ram_util_percent": 66.36666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.056990623474121, "actor_loss": -4.9169111251831055, "critic_loss": 1.9958584308624268, "alpha_loss": -0.08454137295484543, "alpha_value": 0.9916290044784546, "log_alpha_value": -0.008406229317188263, "target_entropy": -6.0, "policy_t": -0.025574609637260437, "mean_q": 1.2774819135665894, "max_q": 11.242304801940918, "min_q": 0.772879958152771}, "td_error": [7.586967468261719, 4.199942111968994, 3.2232303619384766, 4.425990104675293, 3.7504186630249023, 4.065093994140625, 4.258122444152832, 4.444161415100098, 4.146307945251465, 4.214364528656006, 3.939326763153076, 4.505788803100586, 3.083780527114868, 1.4528818130493164, 3.6443605422973633, 3.138690948486328, 4.124574661254883, 4.896546363830566, 3.5771303176879883, 4.342358112335205, 4.624301910400391, 4.855660438537598, 2.607483386993408, 1.826409935951233, 3.51546311378479, 3.5536632537841797, 2.722592353820801, 5.50035285949707, 4.646031379699707, 6.842922210693359, 3.9590725898742676, 4.619897365570068, 3.5705814361572266, 4.347574234008789, 1.3380893468856812, 2.867152690887451, 3.7064425945281982, 3.0849320888519287, 2.5794081687927246, 6.632146835327148, 5.894460678100586, 1.8473939895629883, 5.266963958740234, 3.2489466667175293, 2.6882777214050293, 4.151994705200195, 5.037666320800781, 3.8522181510925293, 2.7480554580688477, 3.748544931411743, 4.652597427368164, 3.7598400115966797, 2.6708035469055176, 4.201330184936523, 3.0366220474243164, 4.044408798217773, 4.447819709777832, 2.6077284812927246, 4.3613667488098145, 3.852177381515503, 4.70577335357666, 3.8943588733673096, 5.472444534301758, 4.034713268280029, 3.9007673263549805, 5.6384992599487305, 3.838984966278076, 4.040542125701904, 5.140915393829346, 4.753309726715088, 6.76224422454834, 3.0787525177001953, 3.403407335281372, 0.9217333793640137, 1.251878261566162, 4.919683456420898, 3.253082275390625, 4.179681777954102, 3.5494749546051025, 3.8625571727752686, 4.927279472351074, 4.7412614822387695, 4.597938537597656, 2.4286484718322754, 1.5978107452392578, 6.282406806945801], "mean_td_error": 3.950204610824585, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 29.0, "diff_num_grad_updates_vs_sampler_policy": 28.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.049863815307617, "actor_loss": -4.815799236297607, "critic_loss": 0.5422980785369873, "alpha_loss": -0.08446323126554489, "alpha_value": 0.9916307926177979, "log_alpha_value": -0.008404415100812912, "target_entropy": -6.0, "policy_t": -0.0070631662383675575, "mean_q": 0.8761008381843567, "max_q": 5.441281795501709, "min_q": 0.7706646919250488}, "td_error": [1.4415955543518066, 0.9281851053237915, 2.351565361022949, 2.4208168983459473, 0.41459566354751587, 2.8095998764038086, 1.400782823562622, 1.7161468267440796, 1.6173408031463623, 1.6839632987976074, 2.4058446884155273, 2.571155548095703, 1.6822330951690674, 0.7344173192977905, 2.666033983230591, 1.652945876121521, 1.9597872495651245, 0.6890060901641846, 3.2923057079315186, 0.02419668436050415, 2.8837976455688477, 2.4010868072509766, 2.830813407897949, 1.4651713371276855, 2.420839548110962, 1.6013951301574707, 1.884829044342041, 0.3583452105522156, 0.7152845859527588, 2.439743757247925, 2.1506481170654297, 0.8701646327972412, 3.3186423778533936, 0.6918039917945862, 2.407726764678955, 0.9824485778808594, 0.846800684928894, 2.0493693351745605, 1.6168644428253174, 0.49675124883651733, 1.5127060413360596, 2.2366600036621094, 2.1127371788024902, 0.7690824270248413, 4.611289024353027, 4.771579742431641, 0.8110423684120178, 3.716768503189087, 0.9096749424934387, 0.48902758955955505, 2.244460344314575, 3.114516258239746, 1.6992567777633667, 3.9406349658966064, 2.61452317237854, 4.661226272583008, 2.457026720046997, 1.1947667598724365, 1.0809385776519775, 1.448211669921875, 1.6970019340515137, 1.757164716720581, 1.1833397150039673, 0.6917746663093567, 0.47698989510536194, 0.8585243225097656, 2.975764751434326, 2.4726686477661133, 1.6089972257614136, 1.096290111541748, 2.283522844314575, 1.8837913274765015, 2.5872840881347656, 1.706796407699585, 2.446455955505371, 1.6083178520202637, 0.9225445985794067, 2.0383968353271484, 3.354400157928467, 2.313904047012329, 1.0250277519226074, 2.472522020339966, 1.9067577123641968, 2.7558813095092773, 0.6371392011642456, 1.8731577396392822], "mean_td_error": 1.8828556537628174, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 29.0, "diff_num_grad_updates_vs_sampler_policy": 28.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.03648567199707, "actor_loss": -4.769171237945557, "critic_loss": 0.43298691511154175, "alpha_loss": -0.08434299379587173, "alpha_value": 0.9916315674781799, "log_alpha_value": -0.008403639309108257, "target_entropy": -6.0, "policy_t": -0.026310669258236885, "mean_q": 0.8889724612236023, "max_q": 5.034701824188232, "min_q": 0.7116145491600037}, "td_error": [3.5023889541625977, 1.5342795848846436, 2.2077019214630127, 0.6031770706176758, 2.204132318496704, 1.6616227626800537, 0.05634117126464844, 3.079369068145752, 2.75121808052063, 2.4422407150268555, 0.9991035461425781, 2.4383533000946045, 2.6420812606811523, 1.8442420959472656, 2.8892321586608887, 1.889132022857666, 2.2120370864868164, 3.742943525314331, 2.9284658432006836, 3.24222469329834, 3.464292049407959, 2.1938109397888184, 1.4676083326339722, 2.0397558212280273, 1.5213520526885986, 0.5990803837776184, 2.1276843547821045, 0.6896681785583496, 1.640084147453308, 1.6588786840438843, 2.262819766998291, 2.377729654312134, 1.5575857162475586, 1.178934097290039, 2.08984375, 0.21021485328674316, 2.7716095447540283, 0.3793744444847107, 0.7584980726242065, 4.049554824829102, 3.1894142627716064, 0.8517666459083557, 0.8716362118721008, 2.3853116035461426, 3.0140914916992188, 3.0336427688598633, 2.7696447372436523, 2.105780601501465, 2.1696345806121826, 2.0832126140594482, 2.3544416427612305, 3.4160399436950684, 3.434396982192993, 1.0952068567276, 1.5354740619659424, 1.6370223760604858, 2.544971466064453, 3.198655128479004, 2.065082550048828, 1.8023271560668945, 0.614668071269989, 1.9500460624694824, 1.1394875049591064, 1.7353801727294922, 2.3673458099365234, 2.560016632080078, 3.485384941101074, 1.7430343627929688, 1.4638793468475342, 3.2937166690826416, 2.801706075668335, 0.2038966715335846, 1.9188891649246216, 0.7458469867706299, 3.8822519779205322, 1.4401609897613525, 0.09619510173797607, 1.680459976196289, 1.2040939331054688, 2.2626218795776367, 1.3261520862579346, 1.2492365837097168, 2.1480636596679688, 1.7315146923065186, 2.9394683837890625, 0.23637932538986206], "mean_td_error": 1.9963526725769043, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 29.0, "diff_num_grad_updates_vs_sampler_policy": 28.0}}, "num_env_steps_sampled": 26880, "num_env_steps_trained": 7482, "num_agent_steps_sampled": 80640, "num_agent_steps_trained": 7482, "last_target_update_ts": 26880, "num_target_updates": 29}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80640, "num_agent_steps_trained": 7482, "num_env_steps_sampled": 26880, "num_env_steps_trained": 7482, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 915.6184429769262, "num_env_steps_trained_throughput_per_sec": 263.6490605893381, "timesteps_total": 26880, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 80640, "timers": {"training_iteration_time_ms": 1036.059, "sample_time_ms": 745.8, "load_time_ms": 0.305, "load_throughput": 846273.897, "learn_time_ms": 18.258, "learn_throughput": 14131.032, "synch_weights_time_ms": 10.248}, "counters": {"num_env_steps_sampled": 26880, "num_env_steps_trained": 7482, "num_agent_steps_sampled": 80640, "num_agent_steps_trained": 7482, "last_target_update_ts": 26880, "num_target_updates": 29}, "done": false, "episodes_total": 0, "training_iteration": 19, "trial_id": "a2ad0_00000", "date": "2023-11-18_21-01-41", "timestamp": 1700370101, "time_this_iter_s": 1.9652831554412842, "time_total_s": 30.981449604034424, "pid": 6505, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x1542d8720>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 30.981449604034424, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 74.43333333333334, "ram_util_percent": 66.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.114995002746582, "actor_loss": -5.055849075317383, "critic_loss": 1.8165720701217651, "alpha_loss": -0.09110070019960403, "alpha_value": 0.9910339117050171, "log_alpha_value": -0.009006498381495476, "target_entropy": -6.0, "policy_t": -0.009592668153345585, "mean_q": 1.1599624156951904, "max_q": 9.511503219604492, "min_q": 0.862995445728302}, "td_error": [5.5465497970581055, 2.905331611633301, 3.3217172622680664, 2.969337224960327, 4.830781936645508, 4.550420761108398, 1.5035130977630615, 3.2973344326019287, 2.2842769622802734, 5.297423839569092, 2.2699060440063477, 3.6894707679748535, 2.612800121307373, 4.058170318603516, 5.148642063140869, 3.8684041500091553, 4.225215911865234, 3.1296701431274414, 4.2702226638793945, 4.05120849609375, 4.3530449867248535, 3.882549285888672, 3.735569477081299, 3.4145212173461914, 3.2412467002868652, 2.271082639694214, 4.557023048400879, 4.648353099822998, 6.130812644958496, 4.906299114227295, 3.5596494674682617, 2.7631454467773438, 2.8839192390441895, 4.548291206359863, 5.414875507354736, 2.242205858230591, 2.849212169647217, 5.0438127517700195, 3.0065300464630127, 4.374038219451904, 3.8747811317443848, 4.20059061050415, 3.4070167541503906, 3.5209150314331055, 4.574440956115723, 2.5333430767059326, 5.362590312957764, 3.743603229522705, 2.89688777923584, 5.759526252746582, 3.598663806915283, 5.828402519226074, 2.980311870574951, 2.9315943717956543, 4.522933006286621, 2.875533103942871, 2.6486423015594482, 4.237628936767578, 2.8426430225372314, 3.212745189666748, 4.362123966217041, 0.2602114677429199, 5.159029006958008, 2.0628674030303955, 3.821532726287842, 3.473862648010254, 3.282236099243164, 3.2022016048431396, 4.1160125732421875, 4.317131996154785, 3.9131622314453125, 2.643411874771118, 3.830667495727539, 4.850351333618164, 2.021129608154297, 0.8928488492965698, 2.500802516937256, 5.574703216552734, 3.6070375442504883, 4.479384422302246, 6.226096153259277, 2.6031856536865234, 2.339346170425415, 3.1626157760620117, 2.915583610534668, 1.793715476989746], "mean_td_error": 3.658379554748535, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 31.0, "diff_num_grad_updates_vs_sampler_policy": 30.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.081422805786133, "actor_loss": -4.947310924530029, "critic_loss": 0.5449187755584717, "alpha_loss": -0.09077773243188858, "alpha_value": 0.9910359382629395, "log_alpha_value": -0.009004455991089344, "target_entropy": -6.0, "policy_t": -0.00545581104233861, "mean_q": 1.1840198040008545, "max_q": 6.767503261566162, "min_q": 0.8748701810836792}, "td_error": [0.2300260066986084, 0.8452483415603638, 1.8821320533752441, 3.9211416244506836, 3.034733772277832, 0.8020650148391724, 0.9274755716323853, 0.885028064250946, 3.542958974838257, 2.337724208831787, 0.8729550838470459, 1.1817562580108643, 2.2659201622009277, 1.6804126501083374, 2.6170690059661865, 0.7734004259109497, 0.7445235252380371, 0.07626903057098389, 0.6881613731384277, 2.7703089714050293, 0.9837779998779297, 2.185408353805542, 2.6687347888946533, 2.1455204486846924, 1.5609064102172852, 3.072178840637207, 3.657411813735962, 3.494215250015259, 1.5703792572021484, 1.5765795707702637, 2.85196590423584, 2.2851405143737793, 1.3499860763549805, 1.7909727096557617, 1.542541265487671, 1.2417806386947632, 2.0035367012023926, 1.6504666805267334, 4.1832780838012695, 0.6499285697937012, 1.9888063669204712, 1.4852383136749268, 2.2649476528167725, 2.4722952842712402, 0.7479481101036072, 1.44011390209198, 0.9371762275695801, 0.8959200978279114, 0.8617983460426331, 2.5822277069091797, 0.3007189929485321, 2.6354284286499023, 3.2594470977783203, 1.762751817703247, 1.5658704042434692, 1.7159132957458496, 3.383575916290283, 2.6039884090423584, 2.2245283126831055, 3.611049175262451, 2.6616883277893066, 0.9887396097183228, 2.7234578132629395, 0.09657371044158936, 0.22613239288330078, 2.136312961578369, 3.2076077461242676, 2.2550110816955566, 2.40323543548584, 0.40407776832580566, 4.18289852142334, 2.74821400642395, 2.4580416679382324, 1.1147408485412598, 2.1190223693847656, 0.576818585395813, 2.9364349842071533, 1.4203259944915771, 0.8652968406677246, 2.657275915145874, 1.9083199501037598, 0.11330360174179077, 2.19183349609375, 1.9603503942489624, 2.1048285961151123, 2.0573487281799316], "mean_td_error": 1.881414771080017, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 31.0, "diff_num_grad_updates_vs_sampler_policy": 30.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.125261306762695, "actor_loss": -4.933289051055908, "critic_loss": 0.44609248638153076, "alpha_loss": -0.09116559475660324, "alpha_value": 0.9910366535186768, "log_alpha_value": -0.00900377705693245, "target_entropy": -6.0, "policy_t": 0.019145675003528595, "mean_q": 0.8986330032348633, "max_q": 4.574147701263428, "min_q": 0.7964338660240173}, "td_error": [1.5312670469284058, 2.2090229988098145, 2.8566768169403076, 0.05753964185714722, 0.6795848608016968, 2.9333701133728027, 2.656043529510498, 0.477008193731308, 1.5060162544250488, 3.2859535217285156, 0.8970339894294739, 2.177194118499756, 1.241960883140564, 3.640148401260376, 2.0913100242614746, 2.2792930603027344, 4.016904830932617, 0.0419083833694458, 2.6576457023620605, 1.2442121505737305, 2.4274978637695312, 1.509170413017273, 1.5448110103607178, 2.135016441345215, 1.9455418586730957, 0.9164215922355652, 1.806875467300415, 1.0819796323776245, 2.3680458068847656, 0.7833898067474365, 0.25720372796058655, 1.925238847732544, 5.287443161010742, 3.224219799041748, 2.5477824211120605, 0.44871899485588074, 1.2667558193206787, 3.020080804824829, 2.65470552444458, 1.5382872819900513, 3.6185872554779053, 2.8695173263549805, 0.7482177019119263, 1.7518610954284668, 3.0456838607788086, 2.245441436767578, 1.9624943733215332, 2.4066390991210938, 1.6815688610076904, 2.415283679962158, 2.7285079956054688, 1.7026445865631104, 0.9020782113075256, 2.460606098175049, 0.32194268703460693, 2.4617486000061035, 2.6301145553588867, 2.558868885040283, 2.250016689300537, 2.0370075702667236, 2.9173150062561035, 1.5899735689163208, 1.8270998001098633, 0.1979476809501648, 2.857316732406616, 0.8861613869667053, 2.834606647491455, 2.6126394271850586, 1.1974098682403564, 1.7292306423187256, 1.0774933099746704, 1.8991992473602295, 2.1078577041625977, 2.4231185913085938, 0.3303753733634949, 3.5172152519226074, 1.0890997648239136, 2.2398250102996826, 2.3825550079345703, 4.0231614112854, 1.9981708526611328, 2.8094558715820312, 3.2149910926818848, 2.9224419593811035, 1.5714049339294434, 1.4510655403137207], "mean_td_error": 2.019479513168335, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 31.0, "diff_num_grad_updates_vs_sampler_policy": 30.0}}, "num_env_steps_sampled": 28672, "num_env_steps_trained": 7998, "num_agent_steps_sampled": 86016, "num_agent_steps_trained": 7998, "last_target_update_ts": 28672, "num_target_updates": 31}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 86016, "num_agent_steps_trained": 7998, "num_env_steps_sampled": 28672, "num_env_steps_trained": 7998, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 919.9395039014422, "num_env_steps_trained_throughput_per_sec": 264.89329465019205, "timesteps_total": 28672, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 86016, "timers": {"training_iteration_time_ms": 1030.981, "sample_time_ms": 739.58, "load_time_ms": 0.305, "load_throughput": 844622.566, "learn_time_ms": 18.188, "learn_throughput": 14185.345, "synch_weights_time_ms": 10.42}, "counters": {"num_env_steps_sampled": 28672, "num_env_steps_trained": 7998, "num_agent_steps_sampled": 86016, "num_agent_steps_trained": 7998, "last_target_update_ts": 28672, "num_target_updates": 31}, "done": false, "episodes_total": 0, "training_iteration": 20, "trial_id": "a2ad0_00000", "date": "2023-11-18_21-01-43", "timestamp": 1700370103, "time_this_iter_s": 1.9565701484680176, "time_total_s": 32.93801975250244, "pid": 6505, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x1542d9940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 32.93801975250244, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 74.53333333333333, "ram_util_percent": 66.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.06724739074707, "actor_loss": -5.064879417419434, "critic_loss": 1.7803279161453247, "alpha_loss": -0.09369257837533951, "alpha_value": 0.9907364845275879, "log_alpha_value": -0.009306673891842365, "target_entropy": -6.0, "policy_t": -0.014991825446486473, "mean_q": 1.2053500413894653, "max_q": 9.617327690124512, "min_q": 0.9103479385375977}, "td_error": [5.016150951385498, 1.4574166536331177, 3.4200263023376465, 5.065858364105225, 2.259316921234131, 3.2539591789245605, 3.431863307952881, 3.2698233127593994, 5.679691314697266, 5.589676856994629, 3.646768808364868, 4.133857727050781, 4.265887260437012, 5.173880577087402, 4.295645713806152, 3.4633665084838867, 2.7824013233184814, 2.9874215126037598, 3.5291123390197754, 4.601024150848389, 5.000973701477051, 4.034632205963135, 3.7868783473968506, 4.145209789276123, 2.6679329872131348, 4.57627010345459, 3.41148042678833, 2.147512912750244, 3.753897190093994, 3.0359530448913574, 3.448258399963379, 4.887491226196289, 3.526383399963379, 4.058365821838379, 4.693415641784668, 4.39127779006958, 2.982454538345337, 2.6320619583129883, 4.0223493576049805, 2.474241256713867, 4.449425220489502, 1.0047451257705688, 2.313904285430908, 3.779892921447754, 5.28413200378418, 2.355476140975952, 3.7915761470794678, 2.5540170669555664, 3.2807838916778564, 2.5773844718933105, 2.2271153926849365, 2.7279305458068848, 4.314300537109375, 3.6850991249084473, 3.935523748397827, 2.3125362396240234, 2.8155179023742676, 3.610426425933838, 3.5945193767547607, 3.4867031574249268, 5.442008972167969, 0.6296439170837402, 6.149073600769043, 1.7512001991271973, 4.675326824188232, 5.113772392272949, 4.1468939781188965, 2.556060791015625, 1.9213800430297852, 4.504045486450195, 4.150468349456787, 3.5644266605377197, 3.5469846725463867, 1.339036464691162, 1.4067144393920898, 2.5350589752197266, 4.586662292480469, 5.428888320922852, 2.459097146987915, 5.403802394866943, 4.9580559730529785, 3.4767019748687744, 3.7432758808135986, 4.913936614990234, 5.229770183563232, 4.2332916259765625], "mean_td_error": 3.639148473739624, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 32.0, "diff_num_grad_updates_vs_sampler_policy": 31.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.140104293823242, "actor_loss": -5.052192687988281, "critic_loss": 0.494148850440979, "alpha_loss": -0.09434833377599716, "alpha_value": 0.9907386898994446, "log_alpha_value": -0.009304473176598549, "target_entropy": -6.0, "policy_t": -0.024601278826594353, "mean_q": 1.3567665815353394, "max_q": 6.83573055267334, "min_q": 0.9295006990432739}, "td_error": [0.8136399388313293, 2.069143295288086, 0.8712698221206665, 2.331671714782715, 0.5962854027748108, 2.3552494049072266, 1.8131680488586426, 2.1936326026916504, 0.27008873224258423, 0.8543863296508789, 0.6206002235412598, 0.25831538438796997, 1.4189207553863525, 2.8953757286071777, 3.643073320388794, 2.6137964725494385, 0.14146241545677185, 2.3160810470581055, 0.9998663663864136, 1.4274680614471436, 2.24534273147583, 0.10559973120689392, 1.5061249732971191, 0.4937204420566559, 2.5064444541931152, 0.7874199151992798, 3.0671262741088867, 2.747121572494507, 2.208198070526123, 1.3105206489562988, 4.672405242919922, 2.202955484390259, 0.5555564165115356, 0.11804884672164917, 1.9977531433105469, 1.450416922569275, 1.2429296970367432, 2.019893169403076, 1.729127049446106, 0.7612156867980957, 2.9455766677856445, 1.8447415828704834, 1.320972204208374, 0.24684813618659973, 0.3070841431617737, 0.2441694736480713, 2.424872398376465, 4.510282516479492, 2.6190929412841797, 0.6742578744888306, 0.5367664694786072, 2.2471938133239746, 1.410496473312378, 0.707361102104187, 2.8484890460968018, 3.188141345977783, 3.9070682525634766, 0.8723256587982178, 2.6288814544677734, 3.179539680480957, 0.4141963720321655, 2.250552177429199, 1.0223947763442993, 1.0932725667953491, 0.9754220247268677, 3.3738951683044434, 1.7942562103271484, 2.4111504554748535, 2.0599918365478516, 0.8207634687423706, 1.7453887462615967, 1.960890769958496, 1.7413939237594604, 1.3386542797088623, 0.9898232221603394, 2.3564963340759277, 1.9397846460342407, 1.6760791540145874, 1.7869508266448975, 2.2777466773986816, 0.8066375851631165, 0.314697265625, 2.7528295516967773, 2.013004779815674, 1.750976800918579, 4.599675178527832], "mean_td_error": 1.734447717666626, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 32.0, "diff_num_grad_updates_vs_sampler_policy": 31.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.11149787902832, "actor_loss": -4.97537899017334, "critic_loss": 0.3717730641365051, "alpha_loss": -0.09407668560743332, "alpha_value": 0.9907392263412476, "log_alpha_value": -0.009303932078182697, "target_entropy": -6.0, "policy_t": 0.01027865894138813, "mean_q": 1.1751203536987305, "max_q": 5.698308944702148, "min_q": 0.8418134450912476}, "td_error": [2.9416422843933105, 0.5328238010406494, 0.7612197399139404, 1.588592767715454, 0.7612171173095703, 1.6121087074279785, 0.7585164308547974, 1.922567367553711, 2.4341578483581543, 3.1661603450775146, 2.7778806686401367, 0.2741878926753998, 3.0310730934143066, 2.482034206390381, 0.8226139545440674, 0.6079350709915161, 2.269894599914551, 3.07664155960083, 1.9533582925796509, 1.607703447341919, 1.6593254804611206, 0.7372690439224243, 1.5223021507263184, 1.3381730318069458, 2.2356975078582764, 0.632418155670166, 2.5816426277160645, 0.16442054510116577, 4.058737277984619, 2.2162137031555176, 1.2649353742599487, 1.8860628604888916, 2.6776609420776367, 1.6455029249191284, 1.4974277019500732, 1.4492367506027222, 0.7051442265510559, 2.789083480834961, 2.014951229095459, 0.9960659742355347, 2.6528067588806152, 2.7365946769714355, 4.076457977294922, 2.2726879119873047, 1.3571770191192627, 2.493987798690796, 0.21837517619132996, 1.3579390048980713, 1.2532145977020264, 0.7094628214836121, 1.540710210800171, 1.1374952793121338, 1.763653039932251, 1.6472920179367065, 1.867389440536499, 1.647741675376892, 0.5309975147247314, 0.9938441514968872, 1.1686968803405762, 2.3172590732574463, 4.629513740539551, 1.6895833015441895, 1.2194764614105225, 2.564913749694824, 1.4808011054992676, 2.591512680053711, 2.1165452003479004, 1.6557343006134033, 2.3267712593078613, 3.003516674041748, 0.7776223421096802, 0.6018794775009155, 1.9015750885009766, 1.3009634017944336, 1.2105631828308105, 0.6904256343841553, 1.3677072525024414, 2.0051093101501465, 2.7083241939544678, 1.5274369716644287, 1.4612936973571777, 1.0622448921203613, 0.19956758618354797, 2.5440216064453125, 1.8223507404327393, 3.278367042541504], "mean_td_error": 1.755071997642517, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 32.0, "diff_num_grad_updates_vs_sampler_policy": 31.0}}, "num_env_steps_sampled": 29568, "num_env_steps_trained": 8256, "num_agent_steps_sampled": 88704, "num_agent_steps_trained": 8256, "last_target_update_ts": 29568, "num_target_updates": 32}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88704, "num_agent_steps_trained": 8256, "num_env_steps_sampled": 29568, "num_env_steps_trained": 8256, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 816.0567498843695, "num_env_steps_trained_throughput_per_sec": 234.98062664081178, "timesteps_total": 29568, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 88704, "timers": {"training_iteration_time_ms": 1027.634, "sample_time_ms": 738.713, "load_time_ms": 0.306, "load_throughput": 843569.093, "learn_time_ms": 18.269, "learn_throughput": 14122.309, "synch_weights_time_ms": 10.452}, "counters": {"num_env_steps_sampled": 29568, "num_env_steps_trained": 8256, "num_agent_steps_sampled": 88704, "num_agent_steps_trained": 8256, "last_target_update_ts": 29568, "num_target_updates": 32}, "done": false, "episodes_total": 0, "training_iteration": 21, "trial_id": "a2ad0_00000", "date": "2023-11-18_21-01-44", "timestamp": 1700370104, "time_this_iter_s": 1.1087470054626465, "time_total_s": 34.04676675796509, "pid": 6505, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x1542d8c20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 34.04676675796509, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 80.3, "ram_util_percent": 66.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.137313842773438, "actor_loss": -5.223111152648926, "critic_loss": 1.704516887664795, "alpha_loss": -0.10042917728424072, "alpha_value": 0.9901420474052429, "log_alpha_value": -0.009906884282827377, "target_entropy": -6.0, "policy_t": -0.018546614795923233, "mean_q": 1.380892038345337, "max_q": 11.803364753723145, "min_q": 1.0085737705230713}, "td_error": [4.322551250457764, 0.8492194414138794, 2.7028415203094482, 1.8296489715576172, 3.027872323989868, 4.498859405517578, 2.2959320545196533, 4.235821723937988, 3.9752588272094727, 3.722762107849121, 2.1916580200195312, 2.9812660217285156, 3.608382225036621, 1.8979746103286743, 1.502103567123413, 4.593214511871338, 3.740124225616455, 3.9170026779174805, 3.537158966064453, 3.437260389328003, 3.3115391731262207, 3.2356345653533936, 1.8606088161468506, 3.6180591583251953, 2.682823657989502, 3.0138936042785645, 2.1382291316986084, 5.944700241088867, 4.223615646362305, 2.161198377609253, 3.5770423412323, 2.224578857421875, 2.4632630348205566, 4.5040974617004395, 3.1517624855041504, 2.329937696456909, 1.873819351196289, 4.27803897857666, 3.8536579608917236, 5.053075790405273, 2.5107314586639404, 4.3209943771362305, 2.3377256393432617, 2.3917770385742188, 5.07393741607666, 3.5550413131713867, 2.7736642360687256, 5.162498950958252, 2.0208487510681152, 3.5719470977783203, 4.131378173828125, 4.2167768478393555, 3.8350837230682373, 2.868952512741089, 2.801754951477051, 3.680426597595215, 2.920006513595581, 2.4058589935302734, 9.255502700805664, 3.870168685913086, 2.212552070617676, 4.411392688751221, 2.23659610748291, 4.995281219482422, 3.4832544326782227, 4.186903953552246, 3.8721249103546143, 4.398828506469727, 1.3344619274139404, 6.329000949859619, 3.4008092880249023, 4.528295516967773, 2.8516619205474854, 2.895111560821533, 4.008045673370361, 3.334789752960205, 2.2174925804138184, 2.8979921340942383, 5.823614120483398, 4.501799583435059, 4.245421886444092, 3.9563751220703125, 3.918017864227295, 4.1263885498046875, 2.9606881141662598, 3.7151761054992676], "mean_td_error": 3.4757399559020996, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 34.0, "diff_num_grad_updates_vs_sampler_policy": 33.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.102831840515137, "actor_loss": -5.117580890655518, "critic_loss": 0.5146766901016235, "alpha_loss": -0.10006511211395264, "alpha_value": 0.9901442527770996, "log_alpha_value": -0.009904658421874046, "target_entropy": -6.0, "policy_t": -0.000769775069784373, "mean_q": 1.2470626831054688, "max_q": 5.686094284057617, "min_q": 1.039792537689209}, "td_error": [0.9137219190597534, 0.8198246955871582, 0.059207797050476074, 3.7266440391540527, 2.2034358978271484, 0.7692369222640991, 2.819629192352295, 0.13781028985977173, 1.5991919040679932, 1.8858578205108643, 1.0193383693695068, 1.2943509817123413, 3.464846611022949, 0.8011733293533325, 0.5789341926574707, 2.5392985343933105, 1.437709927558899, 3.3832130432128906, 2.1197457313537598, 2.3414359092712402, 2.0217061042785645, 1.224465012550354, 0.14728909730911255, 1.256272792816162, 1.4709017276763916, 2.1837618350982666, 0.6463841199874878, 3.6041054725646973, 0.3274174928665161, 0.5326128602027893, 3.0264954566955566, 2.0476810932159424, 0.8163086175918579, 3.616342782974243, 2.162476062774658, 1.2488898038864136, 0.11429375410079956, 1.2509396076202393, 1.950037956237793, 3.408149242401123, 2.5517005920410156, 4.292253494262695, 1.8160314559936523, 1.6326496601104736, 3.1129496097564697, 0.12964415550231934, 0.07137453556060791, 1.4080142974853516, 2.492957830429077, 1.0955414772033691, 0.9082093238830566, 3.397113561630249, 2.4248504638671875, 2.8145923614501953, 2.646024703979492, 2.694949150085449, 1.5593713521957397, 3.114513397216797, 0.16092485189437866, 1.9350470304489136, 2.752326011657715, 2.7299695014953613, 1.3918251991271973, 2.0298757553100586, 1.7117310762405396, 2.8130548000335693, 2.228301763534546, 1.5574421882629395, 0.21926307678222656, 1.2135319709777832, 1.1275129318237305, 0.8390180468559265, 2.2639076709747314, 1.2501060962677002, 1.515121579170227, 2.786957025527954, 2.6913607120513916, 2.1179304122924805, 1.706027865409851, 3.2937068939208984, 1.7893719673156738, 2.410446882247925, 0.9487677812576294, 0.5949416160583496, 1.3449206352233887, 0.9383203387260437], "mean_td_error": 1.78483247756958, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 34.0, "diff_num_grad_updates_vs_sampler_policy": 33.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.045124053955078, "actor_loss": -4.985299587249756, "critic_loss": 0.40888118743896484, "alpha_loss": -0.09949050098657608, "alpha_value": 0.9901445508003235, "log_alpha_value": -0.009904356673359871, "target_entropy": -6.0, "policy_t": 0.06565633416175842, "mean_q": 1.1687126159667969, "max_q": 6.251670837402344, "min_q": 0.9341102838516235}, "td_error": [1.2296695709228516, 1.4439277648925781, 1.6121294498443604, 3.5179810523986816, 1.2431206703186035, 2.261934518814087, 2.262199640274048, 1.685775876045227, 2.56301212310791, 0.15495097637176514, 2.2393875122070312, 1.0849201679229736, 2.4656262397766113, 3.516782283782959, 2.3182921409606934, 2.33701753616333, 1.3259296417236328, 2.047778844833374, 1.6619224548339844, 4.216733932495117, 0.5732132196426392, 1.4801385402679443, 2.6449666023254395, 0.6516275405883789, 1.5595204830169678, 0.20314347743988037, 1.273350477218628, 2.927264451980591, 2.1454358100891113, 1.0120875835418701, 1.7360498905181885, 1.9160587787628174, 0.38509461283683777, 0.03131166100502014, 2.102555751800537, 2.616912364959717, 1.4278901815414429, 2.8650009632110596, 1.9645415544509888, 2.4033913612365723, 2.240274429321289, 3.33026123046875, 1.5493024587631226, 0.8037984371185303, 1.0478193759918213, 2.3250584602355957, 3.580183982849121, 2.582523822784424, 3.065601110458374, 3.176990509033203, 2.555159091949463, 1.1847249269485474, 2.824857234954834, 3.0020558834075928, 1.7854031324386597, 1.3267333507537842, 0.17893850803375244, 1.0036039352416992, 2.1065258979797363, 2.5962984561920166, 1.7307432889938354, 2.9182794094085693, 2.4720206260681152, 3.1666932106018066, 3.6354918479919434, 2.1208431720733643, 3.3526625633239746, 2.4071645736694336, 0.8836245536804199, 0.18467077612876892, 0.5379936099052429, 2.95011305809021, 1.887406587600708, 1.4254708290100098, 1.6225515604019165, 1.3013173341751099, 3.3084030151367188, 0.7237098217010498, 0.4267502427101135, 1.392791748046875, 1.2982767820358276, 2.436959743499756, 0.07873165607452393, 1.8291480541229248, 1.3664129972457886, 1.6290483474731445], "mean_td_error": 1.8890933990478516, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 34.0, "diff_num_grad_updates_vs_sampler_policy": 33.0}}, "num_env_steps_sampled": 31360, "num_env_steps_trained": 8772, "num_agent_steps_sampled": 94080, "num_agent_steps_trained": 8772, "last_target_update_ts": 31360, "num_target_updates": 34}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 94080, "num_agent_steps_trained": 8772, "num_env_steps_sampled": 31360, "num_env_steps_trained": 8772, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 854.7673915285808, "num_env_steps_trained_throughput_per_sec": 246.12721764997082, "timesteps_total": 31360, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 94080, "timers": {"training_iteration_time_ms": 1019.244, "sample_time_ms": 731.334, "load_time_ms": 0.306, "load_throughput": 842452.652, "learn_time_ms": 18.082, "learn_throughput": 14268.334, "synch_weights_time_ms": 10.002}, "counters": {"num_env_steps_sampled": 31360, "num_env_steps_trained": 8772, "num_agent_steps_sampled": 94080, "num_agent_steps_trained": 8772, "last_target_update_ts": 31360, "num_target_updates": 34}, "done": false, "episodes_total": 0, "training_iteration": 22, "trial_id": "a2ad0_00000", "date": "2023-11-18_21-01-47", "timestamp": 1700370107, "time_this_iter_s": 2.104694128036499, "time_total_s": 36.15146088600159, "pid": 6505, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x154272020>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 36.15146088600159, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 77.2, "ram_util_percent": 66.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.083627700805664, "actor_loss": -5.23576021194458, "critic_loss": 1.7766227722167969, "alpha_loss": -0.1029243990778923, "alpha_value": 0.9898448586463928, "log_alpha_value": -0.010207080282270908, "target_entropy": -6.0, "policy_t": -0.015513983555138111, "mean_q": 1.757916808128357, "max_q": 10.780021667480469, "min_q": 1.059143304824829}, "td_error": [2.8027286529541016, 4.4898681640625, 4.924098491668701, 3.324507713317871, 0.3480370044708252, 2.5758180618286133, 3.650139808654785, 6.282613277435303, 3.2157273292541504, 1.8183480501174927, 3.438068389892578, 3.452570915222168, 5.056222438812256, 3.7528014183044434, 4.140581130981445, 2.5302071571350098, 2.8410162925720215, 2.7326178550720215, 5.351875305175781, 4.689207077026367, 2.257751941680908, 4.44143009185791, 4.2885661125183105, 2.3921475410461426, 4.490941047668457, 6.711901664733887, 4.4050397872924805, 3.4692766666412354, 4.367722511291504, 3.1715259552001953, 4.559618949890137, 7.123787879943848, 1.9140517711639404, 0.9515140652656555, 3.2138912677764893, 3.701533794403076, 1.3362066745758057, 4.621760368347168, 2.8417134284973145, 2.777491807937622, 3.2420897483825684, 4.192005157470703, 3.5136656761169434, 4.574449062347412, 4.360989570617676, 4.253034591674805, 3.321781635284424, 3.5952117443084717, 4.779203414916992, 1.8739283084869385, 3.8939576148986816, 2.981151580810547, 2.8448803424835205, 3.3547208309173584, 3.280855178833008, 2.8293559551239014, 2.1519997119903564, 5.83643102645874, 4.752019882202148, 5.705201148986816, 6.828336715698242, 4.454054355621338, 5.252959251403809, 4.0464558601379395, 3.8015246391296387, 3.4755966663360596, 2.8494656085968018, 2.5573315620422363, 1.8369100093841553, 3.2408361434936523, 3.15171480178833, 3.311127185821533, 2.4197216033935547, 5.020862579345703, 5.102441310882568, 3.086434841156006, 2.197509765625, 3.1230478286743164, 6.940890312194824, 3.0667595863342285, 4.97268533706665, 2.305913209915161, 2.3735551834106445, 3.0632174015045166, 3.2389750480651855, 4.732074737548828], "mean_td_error": 3.6772358417510986, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 35.0, "diff_num_grad_updates_vs_sampler_policy": 34.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.078750610351562, "actor_loss": -5.149117946624756, "critic_loss": 0.5382489562034607, "alpha_loss": -0.1028510332107544, "alpha_value": 0.9898471236228943, "log_alpha_value": -0.010204740799963474, "target_entropy": -6.0, "policy_t": -0.0005565521423704922, "mean_q": 1.4673157930374146, "max_q": 6.843191623687744, "min_q": 1.0983455181121826}, "td_error": [2.576932430267334, 0.33795952796936035, 1.1486347913742065, 2.0052623748779297, 2.0464272499084473, 2.822826623916626, 1.9059759378433228, 0.40508395433425903, 2.7658185958862305, 1.2533254623413086, 1.4518948793411255, 2.7096221446990967, 2.5217065811157227, 2.6054327487945557, 2.049140453338623, 1.1783573627471924, 2.226510524749756, 0.7403583526611328, 0.8047128915786743, 1.4373366832733154, 2.74245548248291, 0.6906468868255615, 2.403918981552124, 0.570936918258667, 5.73976993560791, 2.1110329627990723, 2.462195873260498, 4.2460455894470215, 1.7878131866455078, 0.4853324294090271, 2.209275245666504, 3.3586809635162354, 2.465752124786377, 0.9145588874816895, 1.7885452508926392, 3.4548449516296387, 0.7865694761276245, 0.720687985420227, 1.6164238452911377, 0.08706110715866089, 0.3408440947532654, 2.4621829986572266, 2.8824217319488525, 1.0372580289840698, 2.4673538208007812, 0.8751417398452759, 0.896892786026001, 1.395000696182251, 1.6119425296783447, 2.660031795501709, 1.2833788394927979, 1.222327470779419, 1.1378194093704224, 3.909358024597168, 1.671560287475586, 2.731921911239624, 2.0833230018615723, 3.088883876800537, 3.586717128753662, 2.679164409637451, 0.10388869047164917, 1.6610732078552246, 2.1307342052459717, 2.2365031242370605, 0.8273138403892517, 0.6267690062522888, 3.181148052215576, 0.6264654994010925, 3.589879274368286, 1.975028157234192, 0.5342625379562378, 2.223332405090332, 0.7183172702789307, 2.4280788898468018, 2.6510305404663086, 0.8561837077140808, 2.7696094512939453, 1.7748152017593384, 0.1644355058670044, 0.9586800336837769, 1.470978021621704, 2.431913137435913, 0.2470259666442871, 3.097464084625244, 3.380296230316162, 3.3198952674865723], "mean_td_error": 1.8795874118804932, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 35.0, "diff_num_grad_updates_vs_sampler_policy": 34.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.028852462768555, "actor_loss": -5.042995929718018, "critic_loss": 0.3758072257041931, "alpha_loss": -0.10233914852142334, "alpha_value": 0.9898474216461182, "log_alpha_value": -0.010204472579061985, "target_entropy": -6.0, "policy_t": -0.038462039083242416, "mean_q": 1.3035753965377808, "max_q": 6.234371662139893, "min_q": 0.9824144840240479}, "td_error": [3.8805975914001465, 1.542185664176941, 1.017491102218628, 0.5539060831069946, 0.8980790376663208, 2.0042898654937744, 0.957086443901062, 1.756765604019165, 0.19182491302490234, 0.5668469667434692, 1.8971173763275146, 4.048898696899414, 0.1533348560333252, 2.0046257972717285, 2.0403189659118652, 2.438544273376465, 1.8046317100524902, 1.0559699535369873, 1.7538609504699707, 1.270003318786621, 1.6768381595611572, 1.9737801551818848, 2.11297607421875, 0.23387601971626282, 2.559072971343994, 3.6620590686798096, 1.5265921354293823, 2.1101126670837402, 0.4386117458343506, 3.7494406700134277, 0.8392623662948608, 3.649631977081299, 1.7956680059432983, 3.8322787284851074, 1.6753044128417969, 1.5611968040466309, 2.5231738090515137, 1.9401512145996094, 2.641326904296875, 3.2100353240966797, 0.5446000695228577, 3.0514137744903564, 2.075833797454834, 2.0521347522735596, 3.0658044815063477, 0.11027240753173828, 4.024137496948242, 2.0720386505126953, 2.5606796741485596, 1.900935173034668, 0.4115917682647705, 3.7921929359436035, 2.546861171722412, 1.0876436233520508, 2.005152702331543, 0.48520413041114807, 0.616308331489563, 1.044473648071289, 2.0333917140960693, 2.092101812362671, 1.1442594528198242, 3.6300430297851562, 1.5426874160766602, 0.6173633337020874, 1.1163535118103027, 1.839867115020752, 1.5576796531677246, 0.05522739887237549, 0.7163282632827759, 1.3241599798202515, 1.0782743692398071, 0.7943299412727356, 1.4502222537994385, 1.8705922365188599, 2.0929057598114014, 0.8487522006034851, 1.414011836051941, 2.3915982246398926, 2.0880136489868164, 1.326812744140625, 1.5946097373962402, 2.5346381664276123, 2.036001205444336, 0.5847681760787964, 1.7901302576065063, 2.332120895385742], "mean_td_error": 1.7778174877166748, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 35.0, "diff_num_grad_updates_vs_sampler_policy": 34.0}}, "num_env_steps_sampled": 32256, "num_env_steps_trained": 9030, "num_agent_steps_sampled": 96768, "num_agent_steps_trained": 9030, "last_target_update_ts": 32256, "num_target_updates": 35}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96768, "num_agent_steps_trained": 9030, "num_env_steps_sampled": 32256, "num_env_steps_trained": 9030, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 749.4508158095367, "num_env_steps_trained_throughput_per_sec": 215.80168580229963, "timesteps_total": 32256, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 96768, "timers": {"training_iteration_time_ms": 1020.516, "sample_time_ms": 751.734, "load_time_ms": 0.305, "load_throughput": 846009.25, "learn_time_ms": 18.098, "learn_throughput": 14255.646, "synch_weights_time_ms": 10.098}, "counters": {"num_env_steps_sampled": 32256, "num_env_steps_trained": 9030, "num_agent_steps_sampled": 96768, "num_agent_steps_trained": 9030, "last_target_update_ts": 32256, "num_target_updates": 35}, "done": false, "episodes_total": 0, "training_iteration": 23, "trial_id": "a2ad0_00000", "date": "2023-11-18_21-01-48", "timestamp": 1700370108, "time_this_iter_s": 1.2046818733215332, "time_total_s": 37.35614275932312, "pid": 6505, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x154273ec0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 37.35614275932312, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 80.7, "ram_util_percent": 66.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.143080711364746, "actor_loss": -5.345868110656738, "critic_loss": 1.69775390625, "alpha_loss": -0.1065758466720581, "alpha_value": 0.9895477890968323, "log_alpha_value": -0.010507245548069477, "target_entropy": -6.0, "policy_t": 0.02665235474705696, "mean_q": 1.5623832941055298, "max_q": 10.726686477661133, "min_q": 1.1095750331878662}, "td_error": [4.6938090324401855, 4.371336460113525, 3.7196011543273926, 2.835150718688965, 4.98087739944458, 3.346987724304199, 1.5985982418060303, 3.7719967365264893, 6.354720115661621, 4.97302770614624, 2.8405346870422363, 3.1303014755249023, 3.965348243713379, 3.884106159210205, 3.4259939193725586, 3.129173517227173, 3.9146718978881836, 3.6921770572662354, 3.3731508255004883, 1.414923906326294, 4.663119316101074, 4.466327667236328, 2.5095181465148926, 4.2821502685546875, 1.7618732452392578, 3.828360080718994, 5.227606296539307, 4.037981986999512, 3.3776488304138184, 3.2381625175476074, 3.4876480102539062, 3.947601318359375, 4.583319664001465, 4.276594161987305, 3.418994426727295, 4.539249420166016, 2.6924734115600586, 3.6162261962890625, 3.4376111030578613, 3.443359375, 2.9592251777648926, 2.904984712600708, 6.244410514831543, 3.7499890327453613, 3.927055597305298, 3.3877620697021484, 1.953434944152832, 4.629207611083984, 4.116361141204834, 3.632688522338867, 5.0959954261779785, 3.581193208694458, 2.120321750640869, 3.247454881668091, 2.3352038860321045, 2.938767194747925, 3.8455119132995605, 4.76522970199585, 5.420781135559082, 3.067166805267334, 3.1104912757873535, 3.017773151397705, 3.492825508117676, 3.395022392272949, 2.51492977142334, 3.7806386947631836, 3.723928928375244, 3.6268630027770996, 2.8847670555114746, 1.8448030948638916, 0.8406592607498169, 0.6631646156311035, 0.6147382259368896, 3.2732577323913574, 2.6891286373138428, 2.995922088623047, 2.3571715354919434, 3.8746747970581055, 4.50998592376709, 3.0296781063079834, 4.415127754211426, 3.429816246032715, 2.5542542934417725, 2.636913776397705, 4.563877582550049, 2.980128765106201], "mean_td_error": 3.4766933917999268, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 36.0, "diff_num_grad_updates_vs_sampler_policy": 35.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.085225105285645, "actor_loss": -5.214047908782959, "critic_loss": 0.4755791127681732, "alpha_loss": -0.10594315826892853, "alpha_value": 0.9895501732826233, "log_alpha_value": -0.010504788719117641, "target_entropy": -6.0, "policy_t": -0.02264333888888359, "mean_q": 1.321533441543579, "max_q": 6.232434272766113, "min_q": 1.1565598249435425}, "td_error": [1.7250070571899414, 1.5993438959121704, 2.367164134979248, 2.318324089050293, 3.066196918487549, 0.9844999313354492, 1.1881396770477295, 1.0586223602294922, 0.2215864658355713, 1.4922568798065186, 1.419029951095581, 3.003325939178467, 2.1249048709869385, 2.0676236152648926, 3.6098978519439697, 0.288644015789032, 2.702003240585327, 0.15047484636306763, 0.6614693999290466, 3.9614789485931396, 0.7936632037162781, 3.5123069286346436, 1.6006736755371094, 1.0475356578826904, 0.5989960432052612, 2.208068370819092, 1.372873306274414, 2.0768027305603027, 2.3705058097839355, 1.6958932876586914, 0.329395592212677, 1.0513556003570557, 4.214433670043945, 0.5346013903617859, 0.1662600040435791, 0.4568498134613037, 2.0186872482299805, 0.08986186981201172, 1.3134548664093018, 3.4513845443725586, 1.6664116382598877, 1.4300256967544556, 0.8091832399368286, 1.7108464241027832, 1.7093535661697388, 0.1491471529006958, 3.2115652561187744, 0.8554268479347229, 1.082595944404602, 1.083984613418579, 2.4419949054718018, 2.8627877235412598, 1.7964513301849365, 0.7146726250648499, 1.7383545637130737, 0.10674333572387695, 1.6959593296051025, 0.1902923583984375, 1.4276714324951172, 2.7616190910339355, 0.8834995031356812, 1.0945841073989868, 2.85014009475708, 2.219358444213867, 0.3994547724723816, 2.5928854942321777, 4.698793411254883, 3.3671882152557373, 1.9688794612884521, 0.31213563680648804, 1.4181240797042847, 0.36387401819229126, 1.3643766641616821, 0.545978844165802, 3.090325355529785, 2.7927308082580566, 0.4896276593208313, 1.399701714515686, 2.4339897632598877, 1.2853543758392334, 1.0614714622497559, 0.720344603061676, 3.90350604057312, 1.081493616104126, 1.7299461364746094, 1.5086497068405151], "mean_td_error": 1.650408387184143, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 36.0, "diff_num_grad_updates_vs_sampler_policy": 35.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.059981346130371, "actor_loss": -5.106409072875977, "critic_loss": 0.4017840027809143, "alpha_loss": -0.1056746244430542, "alpha_value": 0.9895505309104919, "log_alpha_value": -0.010504455305635929, "target_entropy": -6.0, "policy_t": 0.026473762467503548, "mean_q": 1.1853026151657104, "max_q": 5.1192121505737305, "min_q": 1.0307193994522095}, "td_error": [1.4524221420288086, 1.0016027688980103, 1.6541799306869507, 0.3318448066711426, 2.7067394256591797, 0.7235004901885986, 1.4398367404937744, 0.30124127864837646, 0.9133844971656799, 0.886204719543457, 0.718120276927948, 0.9024136662483215, 3.209746837615967, 1.85444974899292, 1.4989738464355469, 3.9980854988098145, 1.9321731328964233, 2.730870246887207, 2.4819743633270264, 2.4597980976104736, 1.2031971216201782, 2.5055367946624756, 0.3062971830368042, 0.4594786763191223, 1.6308854818344116, 2.796712875366211, 4.951184272766113, 0.3754690885543823, 1.3898251056671143, 4.250242233276367, 1.6968276500701904, 2.719573497772217, 1.7666126489639282, 2.817490577697754, 1.7058507204055786, 1.1248624324798584, 3.485966205596924, 1.7502946853637695, 1.38706374168396, 0.8045513033866882, 0.5717620253562927, 1.6858980655670166, 1.432961344718933, 4.257984638214111, 1.4995124340057373, 2.241659641265869, 2.4360179901123047, 3.8694090843200684, 2.848395347595215, 1.6475125551223755, 2.4992527961730957, 1.8962870836257935, 0.37701159715652466, 0.380664587020874, 1.401665210723877, 2.117525100708008, 3.0019116401672363, 1.9597582817077637, 1.0044233798980713, 1.923445701599121, 0.6010333895683289, 1.02195143699646, 1.6807293891906738, 2.328479051589966, 2.7290525436401367, 0.13189178705215454, 0.058786749839782715, 4.5803985595703125, 1.0145500898361206, 4.060354232788086, 2.61043119430542, 2.307936429977417, 0.10160362720489502, 2.545746326446533, 2.179931402206421, 1.1552629470825195, 4.519965171813965, 1.2059156894683838, 2.4764416217803955, 2.2096667289733887, 1.3893494606018066, 0.7297289967536926, 2.3078198432922363, 0.9499050378799438, 0.2070251703262329, 1.474266529083252], "mean_td_error": 1.8367066383361816, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 36.0, "diff_num_grad_updates_vs_sampler_policy": 35.0}}, "num_env_steps_sampled": 33152, "num_env_steps_trained": 9288, "num_agent_steps_sampled": 99456, "num_agent_steps_trained": 9288, "last_target_update_ts": 33152, "num_target_updates": 36}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 99456, "num_agent_steps_trained": 9288, "num_env_steps_sampled": 33152, "num_env_steps_trained": 9288, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 856.4376534848234, "num_env_steps_trained_throughput_per_sec": 246.6081636150496, "timesteps_total": 33152, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 99456, "timers": {"training_iteration_time_ms": 1030.477, "sample_time_ms": 761.981, "load_time_ms": 0.306, "load_throughput": 844293.073, "learn_time_ms": 18.041, "learn_throughput": 14301.069, "synch_weights_time_ms": 9.869}, "counters": {"num_env_steps_sampled": 33152, "num_env_steps_trained": 9288, "num_agent_steps_sampled": 99456, "num_agent_steps_trained": 9288, "last_target_update_ts": 33152, "num_target_updates": 36}, "done": false, "episodes_total": 0, "training_iteration": 24, "trial_id": "a2ad0_00000", "date": "2023-11-18_21-01-49", "timestamp": 1700370109, "time_this_iter_s": 1.055898904800415, "time_total_s": 38.412041664123535, "pid": 6505, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x153f53ba0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 38.412041664123535, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 69.9, "ram_util_percent": 65.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.070358276367188, "actor_loss": -5.325915813446045, "critic_loss": 1.8139805793762207, "alpha_loss": -0.10883555561304092, "alpha_value": 0.989250659942627, "log_alpha_value": -0.010807514190673828, "target_entropy": -6.0, "policy_t": 0.016911573708057404, "mean_q": 1.343579649925232, "max_q": 11.679903984069824, "min_q": 1.1618595123291016}, "td_error": [2.8571715354919434, 3.7499208450317383, 4.763257026672363, 1.9265695810317993, 4.736050128936768, 3.708767890930176, 0.09815013408660889, 3.9390759468078613, 3.999575138092041, 2.3836631774902344, 3.805267810821533, 4.405900001525879, 2.861229419708252, 1.3621357679367065, 4.310678482055664, 7.682439804077148, 3.1164703369140625, 2.4380106925964355, 3.4110608100891113, 2.949829578399658, 2.8223628997802734, 3.778275489807129, 4.715730667114258, 4.5938286781311035, 3.4274468421936035, 4.684582233428955, 2.702029228210449, 4.4310126304626465, 4.417613506317139, 5.5189528465271, 4.223761558532715, 4.813233852386475, 4.7701826095581055, 4.560548782348633, 5.0551276206970215, 1.5881905555725098, 1.0683932304382324, 2.8993773460388184, 4.34340238571167, 5.01152229309082, 3.186830997467041, 3.496110200881958, 3.740109443664551, 2.583169460296631, 2.54646897315979, 7.068736553192139, 0.8885221481323242, 4.607837677001953, 4.898703575134277, 4.476495742797852, 4.241692066192627, 3.0283830165863037, 3.2724015712738037, 5.017974853515625, 3.7601637840270996, 2.834794044494629, 3.6427454948425293, 4.490262031555176, 4.534294128417969, 4.3225250244140625, 1.5908241271972656, 3.6978681087493896, 2.919487714767456, 3.045886993408203, 3.6701908111572266, 1.9491328001022339, 4.038705825805664, 3.26193904876709, 4.312546253204346, 4.326023101806641, 2.7253174781799316, 4.86028528213501, 2.6272921562194824, 4.430666923522949, 4.486727714538574, 4.124512672424316, 3.8272862434387207, 3.14782452583313, 5.032299518585205, 2.656252861022949, 3.4962263107299805, 4.950119495391846, 3.7382864952087402, 4.830209732055664, 2.058424949645996, 3.6797780990600586], "mean_td_error": 3.6982924938201904, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 37.0, "diff_num_grad_updates_vs_sampler_policy": 36.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.114818572998047, "actor_loss": -5.307962417602539, "critic_loss": 0.41584479808807373, "alpha_loss": -0.109288789331913, "alpha_value": 0.9892533421516418, "log_alpha_value": -0.010804819874465466, "target_entropy": -6.0, "policy_t": -0.04415547475218773, "mean_q": 1.4240416288375854, "max_q": 6.205229759216309, "min_q": 1.2172608375549316}, "td_error": [0.14544570446014404, 0.939065158367157, 1.1072944402694702, 1.6075284481048584, 2.323101043701172, 0.9865034222602844, 0.5379115343093872, 1.7468186616897583, 2.0893616676330566, 1.6050604581832886, 1.2154035568237305, 1.5859534740447998, 0.16785258054733276, 0.748185932636261, 1.5025429725646973, 1.123299479484558, 3.360732316970825, 0.7674888372421265, 2.8290207386016846, 0.4517672061920166, 1.0089510679244995, 1.261843204498291, 2.650585174560547, 2.378814220428467, 1.5206894874572754, 1.9414573907852173, 0.7970330715179443, 0.7724721431732178, 0.4776172637939453, 0.2052190899848938, 2.6728546619415283, 0.733120322227478, 0.40314507484436035, 1.4935362339019775, 1.3591254949569702, 3.088540554046631, 1.406888484954834, 2.5194668769836426, 0.340027391910553, 0.48138052225112915, 1.8880829811096191, 2.315385103225708, 0.6087924242019653, 2.244941234588623, 2.3540420532226562, 0.04211610555648804, 1.0554229021072388, 1.492114543914795, 1.644456386566162, 1.3599159717559814, 2.2562098503112793, 0.1982433795928955, 1.98744797706604, 2.802645206451416, 1.6438381671905518, 1.511546015739441, 1.4727519750595093, 0.6881077885627747, 0.6823509931564331, 1.3821388483047485, 0.9135012030601501, 3.8768460750579834, 0.373146116733551, 1.2994775772094727, 2.5225892066955566, 0.18389678001403809, 1.0979642868041992, 0.5156099796295166, 2.344309091567993, 2.467383861541748, 3.3422188758850098, 2.763017177581787, 3.298623561859131, 3.287994146347046, 1.9467017650604248, 2.2117421627044678, 2.481369733810425, 1.257082462310791, 2.5739567279815674, 1.5172350406646729, 1.4147400856018066, 1.865375280380249, 1.7760999202728271, 0.40854334831237793, 0.4804239273071289, 1.7468395233154297], "mean_td_error": 1.5343064069747925, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 37.0, "diff_num_grad_updates_vs_sampler_policy": 36.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.065614700317383, "actor_loss": -5.158857345581055, "critic_loss": 0.30459001660346985, "alpha_loss": -0.10875282436609268, "alpha_value": 0.9892537593841553, "log_alpha_value": -0.010804389603435993, "target_entropy": -6.0, "policy_t": -0.012787820771336555, "mean_q": 1.1391828060150146, "max_q": 5.083893775939941, "min_q": 1.081378698348999}, "td_error": [1.3137401342391968, 0.9117773771286011, 2.3755645751953125, 0.8040217161178589, 1.7548906803131104, 2.1868252754211426, 1.2885010242462158, 2.6203219890594482, 0.8756841421127319, 2.030463695526123, 1.2261884212493896, 1.3248248100280762, 1.5065218210220337, 2.601316213607788, 0.033833444118499756, 2.482698678970337, 1.8531745672225952, 2.1504557132720947, 1.7441046237945557, 0.11395007371902466, 0.5377702713012695, 3.5581302642822266, 1.9762533903121948, 0.8734935522079468, 0.4562421441078186, 1.3610702753067017, 3.975620746612549, 2.0851540565490723, 3.0935912132263184, 0.3595961332321167, 2.545423984527588, 0.8098446726799011, 2.1818041801452637, 2.4826526641845703, 1.1534008979797363, 1.3481462001800537, 1.1800596714019775, 1.7927175760269165, 0.8077000975608826, 0.5985088348388672, 1.4727331399917603, 0.3856217861175537, 2.7539010047912598, 1.1146750450134277, 1.3925923109054565, 0.8046692609786987, 1.6867825984954834, 1.940523386001587, 1.9755284786224365, 0.2089245319366455, 2.4242992401123047, 1.6170945167541504, 1.2108440399169922, 1.148964524269104, 3.4349262714385986, 1.2553671598434448, 1.334397315979004, 2.1072568893432617, 0.7310132384300232, 2.717137336730957, 0.5049251317977905, 1.6229937076568604, 0.28083568811416626, 2.321927070617676, 2.344119071960449, 0.3969707489013672, 0.3056235909461975, 1.6366021633148193, 1.1154000759124756, 0.18094533681869507, 1.190213918685913, 3.361137866973877, 1.8756773471832275, 2.0109639167785645, 0.8828520774841309, 1.1479593515396118, 3.050961494445801, 1.0854555368423462, 1.7627469301223755, 0.03564131259918213, 1.0675050020217896, 0.8274943828582764, 1.172667145729065, 0.39266031980514526, 2.7776455879211426, 1.3860580921173096], "mean_td_error": 1.5212937593460083, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 37.0, "diff_num_grad_updates_vs_sampler_policy": 36.0}}, "num_env_steps_sampled": 34048, "num_env_steps_trained": 9546, "num_agent_steps_sampled": 102144, "num_agent_steps_trained": 9546, "last_target_update_ts": 34048, "num_target_updates": 37}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 102144, "num_agent_steps_trained": 9546, "num_env_steps_sampled": 34048, "num_env_steps_trained": 9546, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 675.1431155313068, "num_env_steps_trained_throughput_per_sec": 194.40504889182716, "timesteps_total": 34048, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 102144, "timers": {"training_iteration_time_ms": 1066.819, "sample_time_ms": 774.894, "load_time_ms": 0.305, "load_throughput": 844754.436, "learn_time_ms": 18.182, "learn_throughput": 14189.53, "synch_weights_time_ms": 10.07}, "counters": {"num_env_steps_sampled": 34048, "num_env_steps_trained": 9546, "num_agent_steps_sampled": 102144, "num_agent_steps_trained": 9546, "last_target_update_ts": 34048, "num_target_updates": 37}, "done": false, "episodes_total": 0, "training_iteration": 25, "trial_id": "a2ad0_00000", "date": "2023-11-18_21-01-50", "timestamp": 1700370110, "time_this_iter_s": 1.3381996154785156, "time_total_s": 39.75024127960205, "pid": 6505, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x154272e80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 39.75024127960205, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 88.3, "ram_util_percent": 65.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.081469535827637, "actor_loss": -5.393362522125244, "critic_loss": 1.4704841375350952, "alpha_loss": -0.11198205500841141, "alpha_value": 0.9889537692070007, "log_alpha_value": -0.011107712052762508, "target_entropy": -6.0, "policy_t": 0.014755671843886375, "mean_q": 1.5011677742004395, "max_q": 9.650333404541016, "min_q": 1.217941164970398}, "td_error": [4.653110504150391, 3.469787359237671, 1.3257108926773071, 2.881946086883545, 4.259304523468018, 3.112976312637329, 3.6525635719299316, 1.69581937789917, 2.3646397590637207, 2.9336659908294678, 3.4140472412109375, 2.023491621017456, 2.9942798614501953, 2.246507406234741, 5.035989761352539, 0.6707882285118103, 3.490431785583496, 3.8932604789733887, 3.0672831535339355, 4.371362209320068, 5.49396276473999, 2.0820531845092773, 1.6927613019943237, 0.775390625, 4.05593729019165, 3.636481285095215, 3.9177796840667725, 1.3979803323745728, 3.5206100940704346, 2.6470866203308105, 3.0843067169189453, 3.391963481903076, 2.0899925231933594, 4.759424209594727, 4.960484504699707, 4.778675079345703, 4.118633270263672, 1.5052859783172607, 3.70835018157959, 2.6137595176696777, 2.9562366008758545, 3.489396810531616, 1.4013893604278564, 3.7301554679870605, 5.523021221160889, 2.8170528411865234, 3.545046091079712, 3.1167776584625244, 4.648055076599121, 2.3196914196014404, 3.1094675064086914, 1.400539755821228, 2.784578800201416, 2.3853516578674316, 3.1744346618652344, 3.074798107147217, 2.860267400741577, 3.5424485206604004, 2.8772566318511963, 2.048567771911621, 4.764962673187256, 3.7429933547973633, 6.573022365570068, 3.9821763038635254, 3.3229739665985107, 3.005216121673584, 3.659083843231201, 5.190225124359131, 2.5485634803771973, 1.7766600847244263, 3.00393009185791, 3.1094436645507812, 3.6285648345947266, 2.676271438598633, 3.5345349311828613, 1.8980884552001953, 2.6290650367736816, 3.715066432952881, 3.1666812896728516, 4.656735897064209, 0.8345946669578552, 4.3204345703125, 3.486147403717041, 2.766115665435791, 2.551971673965454, 4.2313690185546875], "mean_td_error": 3.2019455432891846, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 38.0, "diff_num_grad_updates_vs_sampler_policy": 37.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.085835456848145, "actor_loss": -5.321504592895508, "critic_loss": 0.4655805826187134, "alpha_loss": -0.11200221627950668, "alpha_value": 0.9889565110206604, "log_alpha_value": -0.011104902252554893, "target_entropy": -6.0, "policy_t": 0.010047783143818378, "mean_q": 1.556104063987732, "max_q": 5.620882034301758, "min_q": 1.280804991722107}, "td_error": [1.0155551433563232, 0.8968515396118164, 0.7619225978851318, 0.24840790033340454, 1.668137788772583, 1.3102011680603027, 1.642444133758545, 2.923379898071289, 3.1317694187164307, 0.9089193344116211, 2.2260289192199707, 1.5962417125701904, 1.5801198482513428, 2.709345579147339, 0.9516972303390503, 2.3009791374206543, 0.5724219083786011, 0.7025332450866699, 1.2770805358886719, 2.8045599460601807, 1.9545143842697144, 1.3275184631347656, 0.7462214827537537, 1.4510670900344849, 2.000514507293701, 1.0975500345230103, 3.2842037677764893, 1.7354763746261597, 1.4982789754867554, 1.568120002746582, 1.2021844387054443, 0.20922839641571045, 2.795644760131836, 1.363795280456543, 0.6172636151313782, 1.9789648056030273, 0.8563091158866882, 1.7720099687576294, 1.9677832126617432, 4.098058700561523, 1.8527846336364746, 3.6213879585266113, 2.480513572692871, 0.2566598057746887, 0.40869754552841187, 1.035135269165039, 0.7583743929862976, 0.2717186212539673, 0.8435324430465698, 3.2554807662963867, 1.2732553482055664, 0.11899048089981079, 2.617887020111084, 0.9595025181770325, 1.8217074871063232, 0.471423864364624, 0.3095170259475708, 1.5887850522994995, 1.874377727508545, 3.7785847187042236, 2.178769588470459, 2.174316644668579, 2.1422243118286133, 1.375985026359558, 1.2264013290405273, 2.739293098449707, 1.2770586013793945, 1.2938852310180664, 3.1751770973205566, 2.367621421813965, 2.7354342937469482, 2.7526581287384033, 0.628287672996521, 1.0911977291107178, 2.27571702003479, 1.7922760248184204, 2.749941110610962, 2.4489145278930664, 1.8713102340698242, 2.2177045345306396, 1.0965781211853027, 2.0161705017089844, 0.16956979036331177, 2.0029027462005615, 0.2632278800010681, 1.7855193614959717], "mean_td_error": 1.653485655784607, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 38.0, "diff_num_grad_updates_vs_sampler_policy": 37.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.107929229736328, "actor_loss": -5.251213073730469, "critic_loss": 0.3236066699028015, "alpha_loss": -0.11224143207073212, "alpha_value": 0.9889571070671082, "log_alpha_value": -0.01110429409891367, "target_entropy": -6.0, "policy_t": 0.04856165871024132, "mean_q": 1.4698907136917114, "max_q": 5.5781941413879395, "min_q": 1.1344592571258545}, "td_error": [1.1216161251068115, 0.10531288385391235, 1.7121849060058594, 1.8700587749481201, 1.1120573282241821, 0.47625893354415894, 2.044711112976074, 1.25734281539917, 2.1567890644073486, 0.1705264449119568, 3.8789641857147217, 1.728769302368164, 2.090501308441162, 1.029273509979248, 2.1546287536621094, 2.642946243286133, 1.6665558815002441, 0.2896084189414978, 0.31921136379241943, 2.925501585006714, 0.8662517070770264, 2.7277650833129883, 2.301274299621582, 1.2586121559143066, 2.598444938659668, 0.8856595754623413, 1.4804942607879639, 1.3828011751174927, 1.7893049716949463, 0.6047191619873047, 0.8802863955497742, 1.1635963916778564, 3.167445659637451, 0.7493783235549927, 1.7902710437774658, 0.07219016551971436, 1.8721619844436646, 1.9115537405014038, 0.15697622299194336, 0.3431991934776306, 0.1689521074295044, 2.612698793411255, 0.10167467594146729, 1.3622467517852783, 0.6513634920120239, 0.1644272804260254, 2.607220411300659, 2.9907360076904297, 3.2159385681152344, 1.4368481636047363, 1.8363358974456787, 0.056538522243499756, 0.3385234475135803, 0.962407648563385, 1.3601171970367432, 1.6018991470336914, 0.2524470090866089, 1.5733153820037842, 2.7279036045074463, 0.5973528623580933, 2.2947092056274414, 2.516526937484741, 0.16189366579055786, 2.0423638820648193, 0.10758805274963379, 1.4636409282684326, 0.10151827335357666, 1.1225613355636597, 1.636589527130127, 1.2683066129684448, 1.5948357582092285, 4.120748043060303, 1.9525251388549805, 2.399278163909912, 3.3863492012023926, 2.1419851779937744, 2.527174949645996, 0.9109065532684326, 1.0511960983276367, 0.977872371673584, 1.070378065109253, 1.0571744441986084, 4.270622253417969, 1.7707159519195557, 2.660274028778076, 2.009143590927124], "mean_td_error": 1.53477942943573, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 38.0, "diff_num_grad_updates_vs_sampler_policy": 37.0}}, "num_env_steps_sampled": 34944, "num_env_steps_trained": 9804, "num_agent_steps_sampled": 104832, "num_agent_steps_trained": 9804, "last_target_update_ts": 34944, "num_target_updates": 38}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104832, "num_agent_steps_trained": 9804, "num_env_steps_sampled": 34944, "num_env_steps_trained": 9804, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 733.1131548104879, "num_env_steps_trained_throughput_per_sec": 211.0973146664128, "timesteps_total": 34944, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 104832, "timers": {"training_iteration_time_ms": 1092.152, "sample_time_ms": 799.845, "load_time_ms": 0.306, "load_throughput": 844490.738, "learn_time_ms": 18.081, "learn_throughput": 14268.729, "synch_weights_time_ms": 10.055}, "counters": {"num_env_steps_sampled": 34944, "num_env_steps_trained": 9804, "num_agent_steps_sampled": 104832, "num_agent_steps_trained": 9804, "last_target_update_ts": 34944, "num_target_updates": 38}, "done": false, "episodes_total": 0, "training_iteration": 26, "trial_id": "a2ad0_00000", "date": "2023-11-18_21-01-51", "timestamp": 1700370111, "time_this_iter_s": 1.2314119338989258, "time_total_s": 40.98165321350098, "pid": 6505, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x154273740>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 40.98165321350098, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 69.05, "ram_util_percent": 65.69999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.023238182067871, "actor_loss": -5.410305500030518, "critic_loss": 1.491736888885498, "alpha_loss": -0.11434382945299149, "alpha_value": 0.9886569380760193, "log_alpha_value": -0.01140787173062563, "target_entropy": -6.0, "policy_t": 0.006936713587492704, "mean_q": 1.5210131406784058, "max_q": 11.708569526672363, "min_q": 1.277519941329956}, "td_error": [3.274168014526367, 2.395869731903076, 1.974810242652893, 2.9073381423950195, 3.7304415702819824, 3.808377265930176, 3.715334892272949, 1.7326641082763672, 3.630190134048462, 3.048989772796631, 3.4211461544036865, 0.043358802795410156, 4.074685573577881, 2.335456371307373, 2.2592740058898926, 3.509434700012207, 2.7280642986297607, 3.2733726501464844, 3.3184640407562256, 2.635622024536133, 2.6489367485046387, 2.403506278991699, 2.444516181945801, 2.8568029403686523, 4.476589202880859, 2.3662617206573486, 4.857840538024902, 4.223636627197266, 4.562427997589111, 3.0812759399414062, 2.316720485687256, 3.110454559326172, 2.0677709579467773, 3.37186861038208, 2.013423442840576, 4.593994617462158, 3.786689281463623, 2.7757487297058105, 2.2159299850463867, 4.4061598777771, 1.0971853733062744, 3.071699857711792, 4.002781867980957, 2.1058731079101562, 8.025214195251465, 1.6800382137298584, 3.334315299987793, 3.6590240001678467, 3.318232536315918, 4.481734752655029, 3.374361038208008, 2.476248264312744, 3.4611661434173584, 2.5642342567443848, 5.370979309082031, 4.7575483322143555, 4.06053352355957, 3.6633195877075195, 4.17311429977417, 2.120081901550293, 2.905355930328369, 3.027027130126953, 2.566213846206665, 3.021362781524658, 2.9551963806152344, 5.651116371154785, 4.35399055480957, 4.412264823913574, 4.321510314941406, 1.7635070085525513, 2.3733224868774414, 2.772653102874756, 3.061691999435425, 2.097412347793579, 3.127384662628174, 4.160996437072754, 3.2661781311035156, 3.0462398529052734, 2.919121503829956, 3.0358500480651855, 3.4628348350524902, 3.643996477127075, 3.4562342166900635, 4.125044822692871, 2.663921356201172, 3.500180721282959], "mean_td_error": 3.2428596019744873, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 39.0, "diff_num_grad_updates_vs_sampler_policy": 38.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.038468360900879, "actor_loss": -5.346609592437744, "critic_loss": 0.38443535566329956, "alpha_loss": -0.11448837071657181, "alpha_value": 0.9886597990989685, "log_alpha_value": -0.011404965072870255, "target_entropy": -6.0, "policy_t": -0.006227696780115366, "mean_q": 1.4818830490112305, "max_q": 5.028600215911865, "min_q": 1.3448209762573242}, "td_error": [0.3743212819099426, 2.0928308963775635, 2.252312183380127, 1.201230764389038, 0.8260071277618408, 1.2741312980651855, 2.0848963260650635, 0.920158326625824, 0.7381399869918823, 0.23791879415512085, 1.6908624172210693, 2.344414710998535, 1.934339165687561, 0.606910228729248, 0.3137943148612976, 1.5477166175842285, 1.4396889209747314, 3.198507070541382, 0.9402613639831543, 1.2830467224121094, 0.6189506649971008, 1.1518254280090332, 2.3211467266082764, 3.157957077026367, 0.6778271198272705, 1.9916597604751587, 2.105705738067627, 1.0421183109283447, 2.654021739959717, 2.1308751106262207, 1.8879168033599854, 0.27653348445892334, 0.48617875576019287, 1.6190043687820435, 0.4946146607398987, 1.636535406112671, 1.3457584381103516, 1.1712566614151, 0.7149728536605835, 1.4727399349212646, 2.327881336212158, 0.17220652103424072, 1.4353539943695068, 2.132162094116211, 1.6823372840881348, 1.0352931022644043, 1.8797283172607422, 1.5459187030792236, 2.714580535888672, 1.4143085479736328, 1.7543339729309082, 1.9902968406677246, 0.22071725130081177, 1.0748467445373535, 1.6388356685638428, 0.36767858266830444, 1.2741003036499023, 1.8186659812927246, 0.5197681188583374, 0.939232349395752, 0.1363469362258911, 1.1402032375335693, 3.4226431846618652, 0.8810008764266968, 2.3899474143981934, 1.2335290908813477, 3.6181492805480957, 0.6299670934677124, 3.0916428565979004, 0.4070996642112732, 2.508765697479248, 2.8775196075439453, 0.3336864709854126, 2.262598991394043, 2.506680488586426, 1.9439342021942139, 0.9306910037994385, 1.9670429229736328, 0.4964328408241272, 0.8161328434944153, 1.0602909326553345, 0.9379437565803528, 1.4932271242141724, 0.8142483234405518, 1.9478917121887207, 0.862616777420044], "mean_td_error": 1.452413558959961, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 39.0, "diff_num_grad_updates_vs_sampler_policy": 38.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.146591186523438, "actor_loss": -5.34273099899292, "critic_loss": 0.3581480383872986, "alpha_loss": -0.11571443825960159, "alpha_value": 0.9886605143547058, "log_alpha_value": -0.011404266580939293, "target_entropy": -6.0, "policy_t": 0.012709974311292171, "mean_q": 1.4785068035125732, "max_q": 6.014833927154541, "min_q": 1.1869633197784424}, "td_error": [4.980563163757324, 0.5979903340339661, 0.3793330192565918, 2.297316074371338, 2.2407703399658203, 2.3256425857543945, 2.42854642868042, 0.5988481640815735, 3.3593342304229736, 0.19517910480499268, 1.8722831010818481, 3.712334632873535, 0.387673020362854, 2.0806541442871094, 1.235904335975647, 1.274662971496582, 0.026980996131896973, 2.5953750610351562, 1.9496119022369385, 0.623209536075592, 1.2896082401275635, 1.4486266374588013, 2.2407326698303223, 1.9808626174926758, 2.575378894805908, 0.08067011833190918, 2.0310306549072266, 0.8365610837936401, 2.126357078552246, 0.830280601978302, 2.4858012199401855, 0.9313833713531494, 0.04506039619445801, 3.226647138595581, 0.6357617378234863, 0.5594046711921692, 2.6646478176116943, 1.41474449634552, 1.035302758216858, 2.135969400405884, 1.854858636856079, 2.159122943878174, 0.6117216348648071, 2.302741050720215, 1.049499273300171, 0.8562556505203247, 0.28241848945617676, 2.8510756492614746, 1.4634109735488892, 0.6766636371612549, 1.6853864192962646, 1.338075041770935, 1.4332515001296997, 0.43972527980804443, 0.7971969246864319, 2.767061233520508, 2.8592140674591064, 2.199902296066284, 0.18637675046920776, 3.0853657722473145, 1.329704761505127, 0.9665074348449707, 1.2264591455459595, 1.3690909147262573, 0.9926839470863342, 3.233582019805908, 2.8405838012695312, 0.052908122539520264, 1.4702478647232056, 1.9557056427001953, 2.7440733909606934, 1.4471286535263062, 1.0886852741241455, 0.7877350449562073, 2.7726824283599854, 0.12271606922149658, 4.0397868156433105, 1.2649751901626587, 1.0799977779388428, 4.104100227355957, 2.1680097579956055, 1.539861798286438, 3.99478816986084, 1.4368138313293457, 1.7069305181503296, 1.8975327014923096], "mean_td_error": 1.6775541305541992, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 39.0, "diff_num_grad_updates_vs_sampler_policy": 38.0}}, "num_env_steps_sampled": 35840, "num_env_steps_trained": 10062, "num_agent_steps_sampled": 107520, "num_agent_steps_trained": 10062, "last_target_update_ts": 35840, "num_target_updates": 39}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 107520, "num_agent_steps_trained": 10062, "num_env_steps_sampled": 35840, "num_env_steps_trained": 10062, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 796.2979629025355, "num_env_steps_trained_throughput_per_sec": 229.291154496489, "timesteps_total": 35840, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 107520, "timers": {"training_iteration_time_ms": 1105.844, "sample_time_ms": 813.975, "load_time_ms": 0.305, "load_throughput": 844754.436, "learn_time_ms": 18.122, "learn_throughput": 14236.61, "synch_weights_time_ms": 9.973}, "counters": {"num_env_steps_sampled": 35840, "num_env_steps_trained": 10062, "num_agent_steps_sampled": 107520, "num_agent_steps_trained": 10062, "last_target_update_ts": 35840, "num_target_updates": 39}, "done": false, "episodes_total": 0, "training_iteration": 27, "trial_id": "a2ad0_00000", "date": "2023-11-18_21-01-53", "timestamp": 1700370113, "time_this_iter_s": 1.1378059387207031, "time_total_s": 42.11945915222168, "pid": 6505, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x1542d9da0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 42.11945915222168, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 78.75, "ram_util_percent": 65.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.060378074645996, "actor_loss": -5.49983549118042, "critic_loss": 1.2197601795196533, "alpha_loss": -0.11778557300567627, "alpha_value": 0.9883604049682617, "log_alpha_value": -0.011707866564393044, "target_entropy": -6.0, "policy_t": 0.0069185830652713776, "mean_q": 1.5658347606658936, "max_q": 9.743399620056152, "min_q": 1.3397789001464844}, "td_error": [2.825425148010254, 4.40346622467041, 3.1633834838867188, 3.9461588859558105, 1.5768920183181763, 3.6113362312316895, 1.6775033473968506, 3.249262809753418, 3.4158689975738525, 3.724754571914673, 0.7526276111602783, 3.2664670944213867, 2.9805288314819336, 2.7170982360839844, 3.037682294845581, 3.6184353828430176, 2.984527349472046, 0.4232962131500244, 1.371705412864685, 1.0456265211105347, 3.44339656829834, 3.618964195251465, 4.325400352478027, 2.468597888946533, 3.6275813579559326, 2.8724915981292725, 3.862067222595215, 4.952037811279297, 1.6502333879470825, 3.7928099632263184, 2.1155667304992676, 4.41133975982666, 3.042158603668213, 2.9719338417053223, 3.203845977783203, 3.1731209754943848, 4.788577556610107, 1.2288800477981567, 1.9885883331298828, 1.455255389213562, 4.3122124671936035, 3.082634925842285, 2.9817662239074707, 1.3040509223937988, 1.8960274457931519, 4.695908546447754, 3.8767054080963135, 3.260759115219116, 2.2261452674865723, 2.990765333175659, 3.9183571338653564, 2.867156982421875, 3.7097694873809814, 2.020233631134033, 5.1535444259643555, 5.02793550491333, 4.15968132019043, 3.5674996376037598, 3.637969493865967, 2.3707289695739746, 1.5020378828048706, 5.635904312133789, 3.16361927986145, 2.772914409637451, 3.987880229949951, 1.9041292667388916, 3.9707775115966797, 4.003215789794922, 4.374200344085693, 2.5492680072784424, 2.7272613048553467, 4.425066947937012, 2.073695182800293, 3.8775100708007812, 4.9824676513671875, 2.6417222023010254, 3.83878231048584, 3.3830721378326416, 2.924433708190918, 5.0067548751831055, 5.434792518615723, 3.0583367347717285, 3.5293142795562744, 2.6705589294433594, 2.843939781188965, 4.032997131347656], "mean_td_error": 3.199528217315674, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 40.0, "diff_num_grad_updates_vs_sampler_policy": 39.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.07585620880127, "actor_loss": -5.447155952453613, "critic_loss": 0.4116312265396118, "alpha_loss": -0.11793692409992218, "alpha_value": 0.9883633255958557, "log_alpha_value": -0.011704903095960617, "target_entropy": -6.0, "policy_t": -0.060039494186639786, "mean_q": 1.6462347507476807, "max_q": 6.099671840667725, "min_q": 1.4122071266174316}, "td_error": [0.8290060758590698, 0.3688262701034546, 1.7673603296279907, 1.9321112632751465, 1.0858863592147827, 2.0661425590515137, 1.0987548828125, 1.1219260692596436, 2.53237247467041, 1.696959376335144, 2.3251395225524902, 0.5575569272041321, 0.4964727759361267, 1.9233782291412354, 0.5753706097602844, 3.214853286743164, 1.4417943954467773, 1.6971356868743896, 2.7584729194641113, 2.0082244873046875, 0.6906810998916626, 2.4249491691589355, 3.313323974609375, 2.7095553874969482, 0.4944504499435425, 0.324695885181427, 0.06283688545227051, 0.8059800863265991, 2.7958860397338867, 0.39321017265319824, 3.2257466316223145, 1.5475380420684814, 0.7890157699584961, 1.8458442687988281, 2.145026206970215, 0.2180849313735962, 1.5056405067443848, 0.9377896785736084, 0.4038904905319214, 1.4160120487213135, 1.1938316822052002, 2.182126045227051, 2.750713586807251, 1.2600103616714478, 2.069735288619995, 1.268532156944275, 0.049202919006347656, 1.8282685279846191, 1.17537522315979, 2.160034418106079, 1.6602842807769775, 1.6960175037384033, 1.7989764213562012, 1.3314290046691895, 1.334518551826477, 0.16290104389190674, 0.3675508499145508, 2.933910369873047, 1.073486328125, 0.4924796223640442, 0.35899418592453003, 1.4702025651931763, 3.4126274585723877, 1.8411656618118286, 1.3688323497772217, 1.1855292320251465, 0.09474927186965942, 1.1024518013000488, 2.24165678024292, 0.4443094730377197, 0.0776757001876831, 0.08154219388961792, 0.060363948345184326, 2.4122519493103027, 3.7121801376342773, 0.9038920998573303, 0.8425359725952148, 0.3665279150009155, 3.532457113265991, 1.7409157752990723, 0.3691638708114624, 3.186178684234619, 1.3701382875442505, 3.723203182220459, 1.154798984527588, 1.0466547012329102], "mean_td_error": 1.4702125787734985, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 40.0, "diff_num_grad_updates_vs_sampler_policy": 39.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.085721015930176, "actor_loss": -5.333183765411377, "critic_loss": 0.31837376952171326, "alpha_loss": -0.11804717034101486, "alpha_value": 0.9883638620376587, "log_alpha_value": -0.011704386211931705, "target_entropy": -6.0, "policy_t": -0.011952566914260387, "mean_q": 1.4557665586471558, "max_q": 5.908252716064453, "min_q": 1.2399001121520996}, "td_error": [2.392296552658081, 2.62127685546875, 1.3234628438949585, 1.3625073432922363, 0.27286243438720703, 0.2714961767196655, 2.1130740642547607, 2.728553295135498, 1.2090017795562744, 0.6902894377708435, 2.064279317855835, 0.5424641370773315, 1.4232816696166992, 5.715540409088135, 0.041901588439941406, 1.5570054054260254, 0.11205196380615234, 1.2702182531356812, 1.3038623332977295, 1.6758360862731934, 1.4591052532196045, 2.2702627182006836, 0.31388384103775024, 1.770612120628357, 1.8810093402862549, 0.4142414331436157, 0.09590637683868408, 1.8307580947875977, 2.717850685119629, 1.7927725315093994, 0.1657080054283142, 0.1255587935447693, 1.8661482334136963, 2.2340030670166016, 2.07896089553833, 3.664203643798828, 1.2216496467590332, 2.1829094886779785, 1.1307662725448608, 1.958617091178894, 2.597280263900757, 1.6638612747192383, 2.9611353874206543, 3.7932090759277344, 2.2431962490081787, 1.3996860980987549, 2.1253650188446045, 0.5859126448631287, 0.5192903876304626, 0.8280311226844788, 0.07397276163101196, 1.6771092414855957, 1.6427088975906372, 2.090142250061035, 2.106656074523926, 0.28257060050964355, 0.2825160026550293, 0.233323335647583, 2.0816097259521484, 1.0703846216201782, 1.6605559587478638, 1.4091662168502808, 0.11061996221542358, 1.6820095777511597, 1.270508885383606, 4.431344032287598, 1.39768648147583, 0.11775565147399902, 0.3182331323623657, 2.7037672996520996, 2.113884210586548, 0.005892813205718994, 0.904585599899292, 0.18327927589416504, 0.901247501373291, 2.0056447982788086, 1.420179843902588, 2.1901493072509766, 3.4316914081573486, 1.726944088935852, 1.4705337285995483, 0.37023913860321045, 1.831498622894287, 3.3711252212524414, 1.8432965278625488, 1.098930835723877], "mean_td_error": 1.5359874963760376, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 40.0, "diff_num_grad_updates_vs_sampler_policy": 39.0}}, "num_env_steps_sampled": 36736, "num_env_steps_trained": 10320, "num_agent_steps_sampled": 110208, "num_agent_steps_trained": 10320, "last_target_update_ts": 36736, "num_target_updates": 40}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 110208, "num_agent_steps_trained": 10320, "num_env_steps_sampled": 36736, "num_env_steps_trained": 10320, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 708.8478243852865, "num_env_steps_trained_throughput_per_sec": 204.11019943237042, "timesteps_total": 36736, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 110208, "timers": {"training_iteration_time_ms": 1134.231, "sample_time_ms": 836.916, "load_time_ms": 0.31, "load_throughput": 832600.163, "learn_time_ms": 18.313, "learn_throughput": 14088.296, "synch_weights_time_ms": 10.137}, "counters": {"num_env_steps_sampled": 36736, "num_env_steps_trained": 10320, "num_agent_steps_sampled": 110208, "num_agent_steps_trained": 10320, "last_target_update_ts": 36736, "num_target_updates": 40}, "done": false, "episodes_total": 0, "training_iteration": 28, "trial_id": "a2ad0_00000", "date": "2023-11-18_21-01-54", "timestamp": 1700370114, "time_this_iter_s": 1.272963285446167, "time_total_s": 43.39242243766785, "pid": 6505, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x1542d85e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 43.39242243766785, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 77.8, "ram_util_percent": 65.65}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.119132041931152, "actor_loss": -5.615509510040283, "critic_loss": 1.163272738456726, "alpha_loss": -0.12150852382183075, "alpha_value": 0.9880639910697937, "log_alpha_value": -0.012007800862193108, "target_entropy": -6.0, "policy_t": 0.0016947346739470959, "mean_q": 1.599325180053711, "max_q": 6.793022632598877, "min_q": 1.4042446613311768}, "td_error": [4.838216781616211, 1.6327948570251465, 0.2507443428039551, 2.7247519493103027, 2.8497085571289062, 5.609304428100586, 4.721802711486816, 2.383011817932129, 3.667776107788086, 2.987874984741211, 2.633301258087158, 3.185417890548706, 2.1817235946655273, 2.63238787651062, 2.3436481952667236, 1.5553747415542603, 2.9167585372924805, 1.9983702898025513, 2.600741386413574, 2.0030198097229004, 2.3305044174194336, 3.157090663909912, 2.9628913402557373, 3.63315749168396, 4.351808071136475, 1.3568685054779053, 3.705012321472168, 1.7104790210723877, 2.5074996948242188, 3.176936626434326, 2.9736359119415283, 3.8217201232910156, 5.779364585876465, 2.562495708465576, 3.210733413696289, 1.9590256214141846, 3.3764543533325195, 2.9281253814697266, 2.4605050086975098, 3.6852197647094727, 4.290849685668945, 0.08387744426727295, 2.7484331130981445, 3.1966609954833984, 3.434145450592041, 2.6632776260375977, 1.8787627220153809, 3.5291695594787598, 4.749917030334473, 3.984372854232788, 4.186005592346191, 1.2980782985687256, 3.650043487548828, 4.972585678100586, 3.0158047676086426, 2.327249765396118, 2.1710736751556396, 3.4341812133789062, 3.4207520484924316, 0.17679738998413086, 3.314194679260254, 2.9633116722106934, 4.410233974456787, 4.81086540222168, 3.2458791732788086, 4.441084861755371, 4.457451820373535, 4.014606475830078, 1.7205674648284912, 4.503658771514893, 3.8610427379608154, 3.0158047676086426, 3.494706392288208, 3.00614595413208, 4.158108711242676, 3.587350368499756, 2.2645630836486816, 2.2247395515441895, 3.1972460746765137, 2.212233543395996, 3.078599452972412, 3.62595534324646, 1.4743059873580933, 5.379347801208496, 1.365147590637207, 3.0845143795013428], "mean_td_error": 3.0638370513916016, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 41.0, "diff_num_grad_updates_vs_sampler_policy": 40.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.100464820861816, "actor_loss": -5.5252580642700195, "critic_loss": 0.38490182161331177, "alpha_loss": -0.12125423550605774, "alpha_value": 0.9880669713020325, "log_alpha_value": -0.01200481690466404, "target_entropy": -6.0, "policy_t": 0.026004733517766, "mean_q": 1.6253454685211182, "max_q": 5.516777515411377, "min_q": 1.4817020893096924}, "td_error": [2.3356876373291016, 2.9546055793762207, 3.519974708557129, 1.6066668033599854, 0.4456022381782532, 2.6519172191619873, 1.3646677732467651, 2.2160000801086426, 1.5550497770309448, 2.6601271629333496, 1.298163890838623, 0.1310632824897766, 1.7268760204315186, 2.4476356506347656, 0.9936410188674927, 1.561156988143921, 0.9387799501419067, 1.1365875005722046, 0.33325016498565674, 0.16524267196655273, 3.2398972511291504, 1.2274188995361328, 2.367608070373535, 0.8368688821792603, 0.5660666227340698, 0.9822556972503662, 1.0174403190612793, 0.7257063388824463, 0.8172290325164795, 2.3818254470825195, 0.8392959237098694, 1.024803876876831, 0.41536176204681396, 0.5701741576194763, 0.6926230192184448, 2.4039149284362793, 3.3096678256988525, 0.36445319652557373, 1.8338178396224976, 1.5738565921783447, 1.9666945934295654, 2.8767077922821045, 1.3230888843536377, 1.7185207605361938, 0.8382781147956848, 0.25708329677581787, 1.1398078203201294, 0.6930870413780212, 1.1643664836883545, 0.317482054233551, 1.1230593919754028, 3.0422940254211426, 3.1268796920776367, 2.167046070098877, 2.473818778991699, 1.0227539539337158, 1.992714762687683, 0.8196245431900024, 1.4486287832260132, 1.8703186511993408, 0.17219269275665283, 1.920688509941101, 0.7010574340820312, 1.4046835899353027, 2.829720973968506, 1.0399253368377686, 2.7627997398376465, 1.363486647605896, 0.07655400037765503, 1.3517963886260986, 1.4733564853668213, 0.9779049754142761, 0.39720314741134644, 1.2843281030654907, 0.8967313766479492, 1.5087153911590576, 1.0308938026428223, 1.9746387004852295, 1.1428375244140625, 0.42304474115371704, 1.6973841190338135, 1.0171388387680054, 2.0554237365722656, 0.13649052381515503, 2.2041194438934326, 0.2787964940071106], "mean_td_error": 1.4271762371063232, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 41.0, "diff_num_grad_updates_vs_sampler_policy": 40.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.110170364379883, "actor_loss": -5.412231922149658, "critic_loss": 0.3165607452392578, "alpha_loss": -0.12136752158403397, "alpha_value": 0.9880672693252563, "log_alpha_value": -0.012004497461020947, "target_entropy": -6.0, "policy_t": -0.017594343051314354, "mean_q": 1.341540813446045, "max_q": 4.343657493591309, "min_q": 1.2853243350982666}, "td_error": [0.7038642168045044, 1.991976022720337, 0.9534707069396973, 2.341362953186035, 2.0118370056152344, 1.3313301801681519, 0.8112009167671204, 1.2825255393981934, 0.7902266979217529, 2.3528473377227783, 1.0239832401275635, 2.567133903503418, 0.811420738697052, 3.5202293395996094, 3.459927558898926, 2.4928603172302246, 1.6795973777770996, 2.072265386581421, 0.7614206075668335, 0.2839800715446472, 1.7018847465515137, 0.28351980447769165, 0.4482106566429138, 1.7815557718276978, 0.49866920709609985, 2.3401565551757812, 1.8728456497192383, 1.1862804889678955, 1.4472708702087402, 1.0687916278839111, 2.216808557510376, 0.8540335893630981, 0.2992207407951355, 1.5603621006011963, 2.2036690711975098, 0.8973821401596069, 0.44262832403182983, 1.0048234462738037, 0.4129159450531006, 0.18843573331832886, 0.7698023319244385, 3.612342357635498, 1.2686598300933838, 2.8929312229156494, 1.188522219657898, 2.5148487091064453, 2.3011913299560547, 1.7032928466796875, 2.4987258911132812, 0.9791914820671082, 1.8715341091156006, 0.9470537900924683, 3.50429105758667, 2.1514220237731934, 0.21862465143203735, 0.11074668169021606, 3.4987130165100098, 3.131263256072998, 1.0778917074203491, 2.0204713344573975, 2.2647862434387207, 0.7438969016075134, 3.1545681953430176, 2.0404977798461914, 0.5690543055534363, 0.3404247760772705, 1.3462789058685303, 2.158010482788086, 2.7301652431488037, 0.48455190658569336, 0.7003920674324036, 1.726808786392212, 2.7836694717407227, 1.893987774848938, 0.2879571318626404, 1.8485983610153198, 0.39422452449798584, 2.337188482284546, 3.2757768630981445, 0.06059753894805908, 0.8173737525939941, 1.140270709991455, 2.5254151821136475, 0.8392329812049866, 2.4487082958221436, 0.8646163940429688], "mean_td_error": 1.558040738105774, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 41.0, "diff_num_grad_updates_vs_sampler_policy": 40.0}}, "num_env_steps_sampled": 37632, "num_env_steps_trained": 10578, "num_agent_steps_sampled": 112896, "num_agent_steps_trained": 10578, "last_target_update_ts": 37632, "num_target_updates": 41}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112896, "num_agent_steps_trained": 10578, "num_env_steps_sampled": 37632, "num_env_steps_trained": 10578, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 693.4458288402591, "num_env_steps_trained_throughput_per_sec": 199.67524982230677, "timesteps_total": 37632, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 112896, "timers": {"training_iteration_time_ms": 1166.661, "sample_time_ms": 865.239, "load_time_ms": 0.311, "load_throughput": 828520.352, "learn_time_ms": 18.668, "learn_throughput": 13820.594, "synch_weights_time_ms": 10.474}, "counters": {"num_env_steps_sampled": 37632, "num_env_steps_trained": 10578, "num_agent_steps_sampled": 112896, "num_agent_steps_trained": 10578, "last_target_update_ts": 37632, "num_target_updates": 41}, "done": false, "episodes_total": 0, "training_iteration": 29, "trial_id": "a2ad0_00000", "date": "2023-11-18_21-01-55", "timestamp": 1700370115, "time_this_iter_s": 1.3012380599975586, "time_total_s": 44.693660497665405, "pid": 6505, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x1542d8680>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 44.693660497665405, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 80.05, "ram_util_percent": 65.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.058008193969727, "actor_loss": -5.638420104980469, "critic_loss": 1.1308120489120483, "alpha_loss": -0.1237921267747879, "alpha_value": 0.9877676367759705, "log_alpha_value": -0.012307815253734589, "target_entropy": -6.0, "policy_t": 0.021305851638317108, "mean_q": 1.8860844373703003, "max_q": 11.966591835021973, "min_q": 1.4720218181610107}, "td_error": [2.852203369140625, 3.6956710815429688, 1.9972057342529297, 2.694958209991455, 2.216698408126831, 2.5231857299804688, 2.4448626041412354, 3.3734071254730225, 2.9661684036254883, 3.084068775177002, 5.06172513961792, 2.924511432647705, 1.6017801761627197, 2.7628488540649414, 3.3588268756866455, 3.702439308166504, 2.878359794616699, 3.947622537612915, 2.7413816452026367, 2.185990333557129, 3.9520423412323, 2.445770263671875, 3.8109827041625977, 2.897329092025757, 3.7272844314575195, 3.113140106201172, 2.0279622077941895, 4.698159217834473, 3.713897228240967, 3.937150478363037, 2.84237003326416, 3.8628220558166504, 2.5915870666503906, 1.2757039070129395, 2.492093563079834, 3.3685646057128906, 3.0616378784179688, 1.259334683418274, 2.966688871383667, 3.549506664276123, 3.251281976699829, 1.6529316902160645, 4.254469871520996, 1.8112890720367432, 2.319915771484375, 3.2086522579193115, 2.4448800086975098, 4.639540672302246, 4.274848937988281, 3.4504780769348145, 4.476393699645996, 1.7878124713897705, 3.7100188732147217, 3.48988676071167, 2.581051826477051, 3.7327771186828613, 2.0378258228302, 3.3109993934631348, 2.3501267433166504, 3.674361228942871, 1.439497470855713, 2.678199291229248, 1.8932771682739258, 3.8412868976593018, 2.475318193435669, 3.0146493911743164, 1.4699161052703857, 3.874298095703125, 3.0611722469329834, 1.457655668258667, 3.3286075592041016, 3.387559652328491, 3.474120616912842, 3.5681185722351074, 1.5934116840362549, 1.5982354879379272, 3.596475839614868, 4.282717227935791, 8.380329132080078, 1.7139630317687988, 1.9565684795379639, 0.8344831466674805, 4.668766021728516, 0.6470344066619873, 4.585191249847412, 3.094480514526367], "mean_td_error": 3.011428117752075, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 42.0, "diff_num_grad_updates_vs_sampler_policy": 41.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.098414421081543, "actor_loss": -5.597830772399902, "critic_loss": 0.3735918402671814, "alpha_loss": -0.1242586076259613, "alpha_value": 0.9877706170082092, "log_alpha_value": -0.012304765172302723, "target_entropy": -6.0, "policy_t": -0.002146201441064477, "mean_q": 1.767187476158142, "max_q": 6.030656814575195, "min_q": 1.5546519756317139}, "td_error": [0.6357247829437256, 3.0009307861328125, 0.5207690000534058, 3.5848491191864014, 0.5528944730758667, 1.3774306774139404, 0.26170217990875244, 1.93117356300354, 0.5642169117927551, 2.178704023361206, 0.8304358720779419, 0.4706360101699829, 1.692643404006958, 2.3185935020446777, 0.8879570364952087, 0.20333296060562134, 1.3869407176971436, 2.0907130241394043, 2.044612407684326, 0.5078339576721191, 2.263075828552246, 2.086484432220459, 1.6117427349090576, 0.8076607584953308, 1.6097908020019531, 1.5840275287628174, 0.3234577775001526, 0.20915621519088745, 0.1006050705909729, 3.437551975250244, 0.5330488681793213, 1.155086636543274, 0.8767839670181274, 1.3771443367004395, 1.977142095565796, 2.1069231033325195, 0.15725886821746826, 2.63712215423584, 0.14814352989196777, 0.32732653617858887, 2.0405359268188477, 2.908799171447754, 0.3996676206588745, 2.555076837539673, 1.1539487838745117, 1.224740743637085, 0.938836932182312, 0.59950190782547, 0.8107606172561646, 1.457017421722412, 1.1743885278701782, 0.47839951515197754, 0.18978887796401978, 2.069579601287842, 1.7516505718231201, 0.8535488843917847, 1.5745594501495361, 1.791654109954834, 0.14471042156219482, 1.571610927581787, 0.9020419120788574, 2.036245107650757, 1.6773732900619507, 2.8375585079193115, 1.173102855682373, 1.0394868850708008, 0.6225066781044006, 2.590885639190674, 2.211379051208496, 0.7572774291038513, 1.3003969192504883, 0.840606689453125, 3.4125213623046875, 0.4918364882469177, 0.06415742635726929, 2.7517786026000977, 0.22554659843444824, 0.9243108034133911, 0.20806431770324707, 2.79203462600708, 1.5641772747039795, 1.6075220108032227, 1.3791028261184692, 1.1056019067764282, 1.534666657447815, 4.983406066894531], "mean_td_error": 1.384813904762268, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 42.0, "diff_num_grad_updates_vs_sampler_policy": 41.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.081615447998047, "actor_loss": -5.39956521987915, "critic_loss": 0.2955780327320099, "alpha_loss": -0.1240508034825325, "alpha_value": 0.9877707362174988, "log_alpha_value": -0.012304657138884068, "target_entropy": -6.0, "policy_t": 0.06914843618869781, "mean_q": 1.4745638370513916, "max_q": 5.721843719482422, "min_q": 1.3523153066635132}, "td_error": [0.9558982253074646, 2.2849068641662598, 1.6466317176818848, 2.688481569290161, 1.6386191844940186, 1.1087342500686646, 0.05957353115081787, 1.001621127128601, 1.3700313568115234, 0.24278748035430908, 2.9731783866882324, 0.8260151147842407, 1.7436895370483398, 2.0355753898620605, 0.6743744611740112, 1.2949213981628418, 0.9392128586769104, 2.6489124298095703, 1.0037355422973633, 1.2319631576538086, 2.089900493621826, 1.5264177322387695, 0.9198614358901978, 1.900559663772583, 2.1723008155822754, 1.544389009475708, 0.6283038854598999, 1.4502226114273071, 3.4289793968200684, 2.7638678550720215, 0.41892009973526, 2.5277745723724365, 1.6626060009002686, 2.5902395248413086, 1.982975721359253, 1.2550861835479736, 0.4631919860839844, 0.4637283682823181, 1.0744905471801758, 4.347879886627197, 0.5168748497962952, 2.5202698707580566, 1.6537718772888184, 1.1768896579742432, 0.9183048009872437, 0.11449098587036133, 1.9756832122802734, 3.925705909729004, 0.8621914386749268, 3.1692123413085938, 0.9490498304367065, 1.9943656921386719, 3.3855297565460205, 1.0684970617294312, 0.12029129266738892, 0.24439609050750732, 0.9435579180717468, 0.9902787804603577, 0.150765061378479, 1.1835262775421143, 1.4071522951126099, 0.21867603063583374, 0.16703557968139648, 2.2846202850341797, 0.08120512962341309, 4.207818031311035, 0.8227445483207703, 3.980163097381592, 1.6739253997802734, 2.1844513416290283, 2.8336427211761475, 0.6686342358589172, 0.2449244260787964, 0.7563753128051758, 1.075725793838501, 0.30107057094573975, 4.3423051834106445, 1.2753043174743652, 1.514308214187622, 1.6738370656967163, 1.0283539295196533, 0.8910722136497498, 0.6217814087867737, 0.2853517532348633, 1.1428682804107666, 2.2299141883850098], "mean_td_error": 1.5041568279266357, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 42.0, "diff_num_grad_updates_vs_sampler_policy": 41.0}}, "num_env_steps_sampled": 38528, "num_env_steps_trained": 10836, "num_agent_steps_sampled": 115584, "num_agent_steps_trained": 10836, "last_target_update_ts": 38528, "num_target_updates": 42}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 115584, "num_agent_steps_trained": 10836, "num_env_steps_sampled": 38528, "num_env_steps_trained": 10836, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 704.532152219285, "num_env_steps_trained_throughput_per_sec": 202.86751704528518, "timesteps_total": 38528, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 115584, "timers": {"training_iteration_time_ms": 1184.04, "sample_time_ms": 881.761, "load_time_ms": 0.312, "load_throughput": 827949.833, "learn_time_ms": 18.653, "learn_throughput": 13831.529, "synch_weights_time_ms": 10.453}, "counters": {"num_env_steps_sampled": 38528, "num_env_steps_trained": 10836, "num_agent_steps_sampled": 115584, "num_agent_steps_trained": 10836, "last_target_update_ts": 38528, "num_target_updates": 42}, "done": false, "episodes_total": 0, "training_iteration": 30, "trial_id": "a2ad0_00000", "date": "2023-11-18_21-01-57", "timestamp": 1700370117, "time_this_iter_s": 1.2812719345092773, "time_total_s": 45.97493243217468, "pid": 6505, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x1542d8e00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 45.97493243217468, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 84.9, "ram_util_percent": 65.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.106548309326172, "actor_loss": -5.734766960144043, "critic_loss": 1.072239875793457, "alpha_loss": -0.12742093205451965, "alpha_value": 0.9874714016914368, "log_alpha_value": -0.012607760727405548, "target_entropy": -6.0, "policy_t": -0.04773663356900215, "mean_q": 2.201749563217163, "max_q": 11.051579475402832, "min_q": 1.5412050485610962}, "td_error": [1.7785234451293945, 2.48732590675354, 2.5027413368225098, 4.180079460144043, 1.9330852031707764, 2.797642707824707, 2.592660903930664, 2.5434093475341797, 2.1276073455810547, 3.3967790603637695, 3.438133955001831, 2.184682846069336, 2.481555461883545, 4.801395893096924, 3.4507150650024414, 4.442753314971924, 4.894155025482178, 0.8181674480438232, 3.7090420722961426, 1.3814921379089355, 3.269043207168579, 2.4177405834198, 2.338080883026123, 4.4914350509643555, 1.2044728994369507, 1.4567104578018188, 2.7823703289031982, 5.130464553833008, 2.8576388359069824, 2.318312644958496, 0.08484387397766113, 2.3229756355285645, 0.9655182361602783, 3.558889150619507, 3.2045469284057617, 3.397300958633423, 2.466604709625244, 2.969881057739258, 1.6810262203216553, 3.8849496841430664, 3.8122129440307617, 7.851133823394775, 3.4312777519226074, 4.283666610717773, 4.6375885009765625, 2.9722201824188232, 3.3381474018096924, 1.6276617050170898, 3.9537739753723145, 2.4074959754943848, 3.0184473991394043, 3.5723700523376465, 1.4810917377471924, 2.8574395179748535, 3.1952710151672363, 4.333532333374023, 4.827441215515137, 1.8614141941070557, 3.4589970111846924, 4.655759334564209, 5.186872482299805, 4.017862319946289, 3.960324764251709, 2.90818190574646, 3.858604907989502, 0.9902862310409546, 2.7498116493225098, 2.974555015563965, 1.318254828453064, 3.5506913661956787, 2.7929775714874268, 1.6623497009277344, 4.135300636291504, 1.6099478006362915, 3.7953593730926514, 2.150470733642578, 2.084554672241211, 4.704394340515137, 2.0900583267211914, 3.2026824951171875, 1.30678129196167, 2.5707385540008545, 2.673305034637451, 1.3573858737945557, 1.0229525566101074, 3.326784372329712], "mean_td_error": 2.9572465419769287, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 43.0, "diff_num_grad_updates_vs_sampler_policy": 42.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.081019401550293, "actor_loss": -5.644115447998047, "critic_loss": 0.3266032934188843, "alpha_loss": -0.1270686239004135, "alpha_value": 0.9874743819236755, "log_alpha_value": -0.012604738585650921, "target_entropy": -6.0, "policy_t": 0.0100762490183115, "mean_q": 1.874151587486267, "max_q": 6.5084228515625, "min_q": 1.6282944679260254}, "td_error": [2.7162208557128906, 1.9803130626678467, 0.6213271617889404, 1.6400585174560547, 1.1332811117172241, 0.6073041558265686, 0.27306127548217773, 0.5167704820632935, 1.142714262008667, 1.8915270566940308, 1.2814668416976929, 0.5998200178146362, 0.8938814401626587, 1.3432587385177612, 1.0998554229736328, 2.997114896774292, 1.8984439373016357, 0.3446831703186035, 1.0587443113327026, 1.1864686012268066, 1.2466142177581787, 2.487793207168579, 2.688655376434326, 1.0180459022521973, 1.6032612323760986, 1.809414267539978, 0.0580979585647583, 0.4231664538383484, 1.755242943763733, 1.1010231971740723, 0.7251138687133789, 2.7369139194488525, 0.15671169757843018, 0.6573988199234009, 3.39363694190979, 1.9153368473052979, 2.5052428245544434, 1.5941548347473145, 1.1523692607879639, 1.2156805992126465, 0.3521495461463928, 1.2335695028305054, 0.612908124923706, 0.4272923469543457, 0.4261680245399475, 2.352083921432495, 1.5399610996246338, 2.0862996578216553, 2.4895005226135254, 0.19984441995620728, 0.5528752207756042, 0.26837801933288574, 0.2118510603904724, 0.6283002495765686, 0.7702063918113708, 1.859333872795105, 0.17221826314926147, 0.5682402849197388, 1.556950569152832, 1.2818236351013184, 1.5507829189300537, 1.6583812236785889, 0.7478616833686829, 0.8489612936973572, 1.446666955947876, 0.3460584282875061, 1.9018460512161255, 1.7377614974975586, 1.3460800647735596, 1.2806060314178467, 2.2141952514648438, 4.156221866607666, 1.069826602935791, 0.056518614292144775, 2.332054615020752, 1.4325847625732422, 1.6329784393310547, 1.3238307237625122, 2.331895589828491, 0.7694355249404907, 1.740276575088501, 0.6482614278793335, 1.222338080406189, 1.0874780416488647, 0.6514411568641663, 0.27640247344970703], "mean_td_error": 1.289196491241455, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 43.0, "diff_num_grad_updates_vs_sampler_policy": 42.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.096080780029297, "actor_loss": -5.518326759338379, "critic_loss": 0.2471819519996643, "alpha_loss": -0.1272590160369873, "alpha_value": 0.9874743223190308, "log_alpha_value": -0.012604793533682823, "target_entropy": -6.0, "policy_t": -0.016662484034895897, "mean_q": 1.4831440448760986, "max_q": 3.7787609100341797, "min_q": 1.4117884635925293}, "td_error": [0.8972946405410767, 1.097660779953003, 0.08772152662277222, 2.132582902908325, 3.4928503036499023, 0.39822280406951904, 0.12192738056182861, 2.5473294258117676, 1.0364303588867188, 3.925734281539917, 0.41927218437194824, 1.0382463932037354, 2.291515350341797, 1.4018828868865967, 0.01179581880569458, 3.152722120285034, 1.5590026378631592, 0.988781213760376, 1.3855359554290771, 0.22254139184951782, 0.20736443996429443, 0.6939045786857605, 0.9618090391159058, 0.972180187702179, 3.162958860397339, 1.5482821464538574, 0.7728918194770813, 2.0768208503723145, 1.0460362434387207, 0.7847499847412109, 0.5600336790084839, 1.560481071472168, 0.5184673070907593, 0.2714822292327881, 1.484358549118042, 3.574775457382202, 1.3931854963302612, 1.1014224290847778, 0.7290643453598022, 1.886021614074707, 1.3315931558609009, 0.6406558156013489, 0.6178362965583801, 1.539217472076416, 1.9540345668792725, 0.6838719844818115, 1.0037500858306885, 2.813681125640869, 1.5081195831298828, 1.4138939380645752, 3.180227041244507, 0.9667288064956665, 2.1239864826202393, 1.1571495532989502, 1.6734619140625, 1.0932368040084839, 1.340261459350586, 1.1691315174102783, 1.1354646682739258, 1.6689555644989014, 1.950724482536316, 1.2169139385223389, 1.7627005577087402, 0.4181683659553528, 2.655661106109619, 0.2084064483642578, 0.7480601072311401, 0.5737652778625488, 0.44087862968444824, 1.522422194480896, 0.173994243144989, 2.6835968494415283, 0.1457613706588745, 0.6590843796730042, 1.2989846467971802, 1.2989822626113892, 1.763930320739746, 1.195082187652588, 1.9613568782806396, 0.1541004180908203, 0.038288891315460205, 3.3162527084350586, 0.7503213286399841, 0.6697166562080383, 1.2124298810958862, 2.0438318252563477], "mean_td_error": 1.3185349702835083, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 43.0, "diff_num_grad_updates_vs_sampler_policy": 42.0}}, "num_env_steps_sampled": 39424, "num_env_steps_trained": 11094, "num_agent_steps_sampled": 118272, "num_agent_steps_trained": 11094, "last_target_update_ts": 39424, "num_target_updates": 43}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 118272, "num_agent_steps_trained": 11094, "num_env_steps_sampled": 39424, "num_env_steps_trained": 11094, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 768.6482168555036, "num_env_steps_trained_throughput_per_sec": 221.3295088713392, "timesteps_total": 39424, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 118272, "timers": {"training_iteration_time_ms": 1202.982, "sample_time_ms": 898.711, "load_time_ms": 0.312, "load_throughput": 826116.827, "learn_time_ms": 18.594, "learn_throughput": 13875.353, "synch_weights_time_ms": 10.767}, "counters": {"num_env_steps_sampled": 39424, "num_env_steps_trained": 11094, "num_agent_steps_sampled": 118272, "num_agent_steps_trained": 11094, "last_target_update_ts": 39424, "num_target_updates": 43}, "done": false, "episodes_total": 0, "training_iteration": 31, "trial_id": "a2ad0_00000", "date": "2023-11-18_21-01-58", "timestamp": 1700370118, "time_this_iter_s": 1.1749417781829834, "time_total_s": 47.149874210357666, "pid": 6505, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x1542d99e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 47.149874210357666, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 83.65, "ram_util_percent": 65.80000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.138452529907227, "actor_loss": -5.831892013549805, "critic_loss": 1.035682201385498, "alpha_loss": -0.130864679813385, "alpha_value": 0.9871751666069031, "log_alpha_value": -0.012907757423818111, "target_entropy": -6.0, "policy_t": -0.05166323482990265, "mean_q": 1.9596385955810547, "max_q": 11.100378036499023, "min_q": 1.6103291511535645}, "td_error": [0.3271883726119995, 3.6083192825317383, 3.660027027130127, 5.300691604614258, 2.7562665939331055, 3.1215362548828125, 2.9146575927734375, 2.7637381553649902, 2.397878885269165, 2.3439884185791016, 3.46944522857666, 1.4889670610427856, 2.919862747192383, 3.4054489135742188, 4.242314338684082, 2.2839064598083496, 1.1845717430114746, 2.314990997314453, 1.2399585247039795, 3.375671625137329, 0.16636359691619873, 1.736042857170105, 3.6800026893615723, 2.1020164489746094, 0.9356985688209534, 2.6280264854431152, 3.098735809326172, 4.677753448486328, 4.178285598754883, 3.9708378314971924, 0.43875956535339355, 1.340973138809204, 3.8982768058776855, 4.091407775878906, 2.329172134399414, 2.4935107231140137, 1.1262379884719849, 1.6422820091247559, 3.4203991889953613, 2.9291558265686035, 3.2326877117156982, 2.7849700450897217, 3.9554367065429688, 3.2731361389160156, 1.7639273405075073, 3.3019747734069824, 2.1813912391662598, 1.9232420921325684, 5.292124271392822, 1.2703397274017334, 3.667299747467041, 3.2791738510131836, 4.654229164123535, 2.2750675678253174, 1.827162265777588, 2.5328171253204346, 2.1155762672424316, 2.2114791870117188, 1.2414897680282593, 3.8446316719055176, 4.324660778045654, 3.7144711017608643, 2.9440345764160156, 3.386103868484497, 2.0018019676208496, 1.7254887819290161, 3.403057336807251, 1.792595386505127, 3.790297508239746, 1.5117452144622803, 3.3537964820861816, 2.204390048980713, 2.5677380561828613, 2.2520956993103027, 1.7253230810165405, 2.832531452178955, 3.037665843963623, 3.298553466796875, 3.4894750118255615, 1.64878249168396, 2.856947422027588, 3.380995750427246, 2.329354763031006, 3.00093936920166, 3.0562572479248047, 6.2498579025268555], "mean_td_error": 2.7733778953552246, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 44.0, "diff_num_grad_updates_vs_sampler_policy": 43.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.043807983398438, "actor_loss": -5.690498352050781, "critic_loss": 0.254355251789093, "alpha_loss": -0.1296122968196869, "alpha_value": 0.9871782064437866, "log_alpha_value": -0.012904695235192776, "target_entropy": -6.0, "policy_t": -0.04732426628470421, "mean_q": 1.7953890562057495, "max_q": 4.370492458343506, "min_q": 1.702578067779541}, "td_error": [2.0216143131256104, 1.7565131187438965, 0.15535622835159302, 2.861774206161499, 1.6700732707977295, 0.06188702583312988, 0.747098445892334, 1.57633376121521, 2.3193225860595703, 0.0647125244140625, 1.550450325012207, 0.32235682010650635, 2.4705405235290527, 0.5005408525466919, 0.29646605253219604, 1.7420275211334229, 1.0484938621520996, 0.2556188106536865, 0.11325728893280029, 0.7295635938644409, 0.46044450998306274, 0.1375662088394165, 0.26997995376586914, 1.2972421646118164, 1.0431820154190063, 0.34808605909347534, 0.6144374012947083, 0.3045097589492798, 0.47083866596221924, 0.9466862082481384, 0.4799191951751709, 0.26427650451660156, 2.161487102508545, 1.3181049823760986, 0.0857471227645874, 1.1896533966064453, 0.34368014335632324, 1.5574572086334229, 2.47849178314209, 1.6849174499511719, 1.7206344604492188, 1.2131690979003906, 1.426283836364746, 0.6587367057800293, 1.041475534439087, 0.15733486413955688, 0.25218164920806885, 2.8348758220672607, 1.248831033706665, 1.397556185722351, 1.7225656509399414, 0.9451279044151306, 0.09369373321533203, 0.9008870124816895, 0.7442917227745056, 1.3098443746566772, 1.4978148937225342, 1.216287612915039, 1.1594047546386719, 0.08879977464675903, 0.1308220624923706, 2.491236686706543, 0.7305580377578735, 1.5941263437271118, 0.7284904718399048, 0.059248924255371094, 0.15146863460540771, 2.1661999225616455, 0.2590066194534302, 0.8104433417320251, 0.921992301940918, 2.0402045249938965, 1.9898324012756348, 1.7009284496307373, 1.844170331954956, 1.274218201637268, 0.35120344161987305, 2.7727439403533936, 0.9905354380607605, 0.25157761573791504, 0.4840109348297119, 1.0888526439666748, 0.22256147861480713, 0.46605902910232544, 2.5897116661071777, 0.08101403713226318], "mean_td_error": 1.0411828756332397, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 44.0, "diff_num_grad_updates_vs_sampler_policy": 43.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.099381446838379, "actor_loss": -5.583820343017578, "critic_loss": 0.24822074174880981, "alpha_loss": -0.13033193349838257, "alpha_value": 0.9871779680252075, "log_alpha_value": -0.012904942035675049, "target_entropy": -6.0, "policy_t": -0.028648290783166885, "mean_q": 1.5349138975143433, "max_q": 5.105713844299316, "min_q": 1.3864154815673828}, "td_error": [0.7097885608673096, 1.9676439762115479, 1.980355143547058, 0.5825175642967224, 0.9119980335235596, 0.3104814291000366, 0.14180982112884521, 0.6990190744400024, 0.7280619740486145, 2.0902652740478516, 1.5468924045562744, 1.328462839126587, 0.611858606338501, 2.217714309692383, 1.6786704063415527, 1.5769217014312744, 2.052415609359741, 1.4915493726730347, 0.47737234830856323, 1.4650839567184448, 1.3043771982192993, 2.795642852783203, 0.6998847126960754, 1.880712866783142, 1.7353737354278564, 1.2497642040252686, 0.23334884643554688, 2.301525115966797, 0.055632054805755615, 2.008903980255127, 0.9305312037467957, 0.21729010343551636, 2.362372398376465, 1.1216952800750732, 0.1913754940032959, 2.6006312370300293, 1.9529945850372314, 1.654576301574707, 2.3188328742980957, 0.9027379155158997, 2.141284704208374, 1.0743035078048706, 1.7245655059814453, 1.9536311626434326, 0.5350445508956909, 3.1436572074890137, 0.9505820274353027, 0.942388117313385, 0.17341792583465576, 1.7099775075912476, 0.00818181037902832, 1.8548657894134521, 0.36962300539016724, 1.6185657978057861, 1.2087411880493164, 1.421281337738037, 3.7125329971313477, 2.3560705184936523, 0.14667105674743652, 0.5019506216049194, 0.5432738065719604, 0.2658027410507202, 1.899570107460022, 0.5554313659667969, 2.483671188354492, 0.35135775804519653, 0.7057129144668579, 1.1937892436981201, 0.6728336811065674, 1.41494882106781, 2.370756149291992, 0.5419982671737671, 0.8186727166175842, 2.1581201553344727, 1.0194506645202637, 1.8952769041061401, 1.4701695442199707, 2.628875255584717, 2.1455025672912598, 0.09054017066955566, 1.6285161972045898, 2.4996697902679443, 0.21511602401733398, 0.40820783376693726, 0.8133719563484192, 1.6930556297302246], "mean_td_error": 1.3153268098831177, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 44.0, "diff_num_grad_updates_vs_sampler_policy": 43.0}}, "num_env_steps_sampled": 40320, "num_env_steps_trained": 11352, "num_agent_steps_sampled": 120960, "num_agent_steps_trained": 11352, "last_target_update_ts": 40320, "num_target_updates": 44}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120960, "num_agent_steps_trained": 11352, "num_env_steps_sampled": 40320, "num_env_steps_trained": 11352, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 752.7995158809982, "num_env_steps_trained_throughput_per_sec": 216.76593202823386, "timesteps_total": 40320, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 120960, "timers": {"training_iteration_time_ms": 1209.984, "sample_time_ms": 904.93, "load_time_ms": 0.314, "load_throughput": 822225.083, "learn_time_ms": 18.581, "learn_throughput": 13885.305, "synch_weights_time_ms": 10.621}, "counters": {"num_env_steps_sampled": 40320, "num_env_steps_trained": 11352, "num_agent_steps_sampled": 120960, "num_agent_steps_trained": 11352, "last_target_update_ts": 40320, "num_target_updates": 44}, "done": false, "episodes_total": 0, "training_iteration": 32, "trial_id": "a2ad0_00000", "date": "2023-11-18_21-01-59", "timestamp": 1700370119, "time_this_iter_s": 1.2083220481872559, "time_total_s": 48.35819625854492, "pid": 6505, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x154273ce0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 48.35819625854492, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 80.05000000000001, "ram_util_percent": 65.69999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.076533317565918, "actor_loss": -5.863379001617432, "critic_loss": 1.0043015480041504, "alpha_loss": -0.1330895721912384, "alpha_value": 0.9868789911270142, "log_alpha_value": -0.013207872398197651, "target_entropy": -6.0, "policy_t": 0.044131722301244736, "mean_q": 1.9299321174621582, "max_q": 10.114059448242188, "min_q": 1.681337594985962}, "td_error": [2.595137596130371, 3.032534599304199, 2.000063419342041, 4.358033180236816, 2.0641257762908936, 2.2063329219818115, 4.018780708312988, 0.5232566595077515, 2.148331642150879, 2.6701321601867676, 2.570122003555298, 4.430856704711914, 2.4553794860839844, 1.846343994140625, 3.9060659408569336, 1.435434103012085, 2.0009765625, 3.4473907947540283, 4.918064594268799, 1.3491508960723877, 2.1534385681152344, 2.0213475227355957, 4.135661602020264, 1.9943116903305054, 3.309495449066162, 2.347458839416504, 2.2106127738952637, 1.7654738426208496, 3.151364326477051, 2.3276901245117188, 0.15517336130142212, 2.3796238899230957, 3.1341869831085205, 2.615621566772461, 2.9477806091308594, 3.643380880355835, 4.466132164001465, 4.496379852294922, 3.269118309020996, 1.8228744268417358, 2.5884294509887695, 2.1944477558135986, 2.853156089782715, 1.407167673110962, 1.8257871866226196, 3.1618494987487793, 1.5862758159637451, 3.444221019744873, 3.1436119079589844, 3.511094570159912, 2.1444411277770996, 4.6556596755981445, 2.546572685241699, 0.26024603843688965, 2.514819622039795, 0.34033679962158203, 1.879434585571289, 2.5412211418151855, 3.8924801349639893, 3.2672548294067383, 3.155056953430176, 0.8764235973358154, 2.0119194984436035, 2.3538832664489746, 4.933454513549805, 2.7677745819091797, 3.1949121952056885, 2.303582191467285, 2.919262409210205, 2.087718963623047, 3.0149240493774414, 3.9569005966186523, 0.5642916560173035, 3.7762374877929688, 2.677971839904785, 2.380636692047119, 4.83558988571167, 2.74638295173645, 3.8120012283325195, 1.1697852611541748, 3.66871976852417, 3.240468978881836, 2.7597498893737793, 3.265347480773926, 4.443260192871094, 0.3334386348724365], "mean_td_error": 2.6899051666259766, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 45.0, "diff_num_grad_updates_vs_sampler_policy": 44.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.110193252563477, "actor_loss": -5.827510356903076, "critic_loss": 0.3188163638114929, "alpha_loss": -0.13350056111812592, "alpha_value": 0.9868822693824768, "log_alpha_value": -0.013204550370573997, "target_entropy": -6.0, "policy_t": -0.03775988891720772, "mean_q": 2.0090508460998535, "max_q": 6.370007514953613, "min_q": 1.7793753147125244}, "td_error": [0.14109212160110474, 4.480315685272217, 0.5226151347160339, 0.25662851333618164, 2.032200336456299, 0.4749041199684143, 1.2535196542739868, 0.5440639853477478, 0.21276593208312988, 0.622288703918457, 1.3879450559616089, 0.9134351015090942, 0.8970943093299866, 3.027280807495117, 0.1747463345527649, 1.7895514965057373, 1.3710297346115112, 2.2836532592773438, 0.8307944536209106, 1.7090405225753784, 1.4526251554489136, 0.06105828285217285, 1.137474536895752, 0.24016976356506348, 2.7574679851531982, 0.3331746459007263, 0.6023184657096863, 0.8530963063240051, 0.5230746269226074, 1.4841432571411133, 2.532820224761963, 1.2313618659973145, 4.847801685333252, 0.7409120202064514, 1.7175846099853516, 0.10114359855651855, 0.4951794147491455, 0.41080278158187866, 0.7290300130844116, 1.0507543087005615, 1.1210391521453857, 1.610776662826538, 0.3164341449737549, 2.969782829284668, 2.5679826736450195, 0.29552268981933594, 0.09165453910827637, 1.0233744382858276, 2.7879602909088135, 0.3297041654586792, 2.519958257675171, 2.1705737113952637, 1.0463542938232422, 1.0541019439697266, 0.38874804973602295, 2.1643972396850586, 0.8068444728851318, 0.7418076992034912, 1.9723416566848755, 0.8094252347946167, 0.3725261092185974, 1.2784056663513184, 0.2636535167694092, 1.1702409982681274, 1.6605026721954346, 0.15298986434936523, 1.0698390007019043, 2.3428211212158203, 1.3001543283462524, 1.4812157154083252, 0.4269963502883911, 2.315922260284424, 2.3828461170196533, 1.617773413658142, 0.06138145923614502, 0.0604703426361084, 1.8265124559402466, 1.8583695888519287, 1.25382661819458, 2.1102635860443115, 0.13034701347351074, 1.6540706157684326, 1.8775557279586792, 2.3649559020996094, 2.8254811763763428, 0.06356149911880493], "mean_td_error": 1.2667258977890015, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 45.0, "diff_num_grad_updates_vs_sampler_policy": 44.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.094512939453125, "actor_loss": -5.644968509674072, "critic_loss": 0.2819667458534241, "alpha_loss": -0.13329914212226868, "alpha_value": 0.986881673336029, "log_alpha_value": -0.013205109164118767, "target_entropy": -6.0, "policy_t": -0.021560046821832657, "mean_q": 1.6195614337921143, "max_q": 4.159026622772217, "min_q": 1.5384275913238525}, "td_error": [1.4627312421798706, 1.7322657108306885, 0.4854532480239868, 0.9266170263290405, 1.5258736610412598, 0.37684953212738037, 1.3533046245574951, 1.2923567295074463, 1.4158027172088623, 1.6579232215881348, 2.3549327850341797, 1.0879524946212769, 1.8480781316757202, 0.5723782777786255, 1.41190767288208, 2.042203187942505, 1.4293403625488281, 2.42629337310791, 2.1335668563842773, 2.178767204284668, 0.876703143119812, 2.2545485496520996, 1.4029028415679932, 1.8840649127960205, 2.3388493061065674, 2.6606063842773438, 1.2224085330963135, 2.757199764251709, 1.6768131256103516, 0.5888569355010986, 1.1147332191467285, 1.182752251625061, 1.7437007427215576, 1.7911533117294312, 0.816256046295166, 1.9781217575073242, 2.0119426250457764, 0.015397191047668457, 1.3084063529968262, 2.0109825134277344, 1.3577446937561035, 0.5780398845672607, 1.461461067199707, 2.675356864929199, 1.3644330501556396, 1.2856500148773193, 0.6690728664398193, 2.295469284057617, 3.197495460510254, 1.2332539558410645, 0.1480250358581543, 1.618398904800415, 0.9810913801193237, 2.2900094985961914, 0.3619379997253418, 0.2765352129936218, 0.5415083169937134, 1.9125961065292358, 3.78458309173584, 1.9636530876159668, 1.8643335103988647, 1.2152570486068726, 3.261960029602051, 0.019926846027374268, 0.03445100784301758, 0.4382656216621399, 0.6623685359954834, 3.190645217895508, 0.5273920297622681, 2.4779419898986816, 1.2315922975540161, 2.9998960494995117, 0.5956012010574341, 1.7024376392364502, 0.8445539474487305, 0.93184494972229, 0.04732853174209595, 1.5643126964569092, 1.0626622438430786, 0.033052921295166016, 0.11270087957382202, 2.2942094802856445, 1.895970106124878, 0.4181123375892639, 0.6486889719963074, 1.7136893272399902], "mean_td_error": 1.4318199157714844, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 45.0, "diff_num_grad_updates_vs_sampler_policy": 44.0}}, "num_env_steps_sampled": 41216, "num_env_steps_trained": 11610, "num_agent_steps_sampled": 123648, "num_agent_steps_trained": 11610, "last_target_update_ts": 41216, "num_target_updates": 45}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 123648, "num_agent_steps_trained": 11610, "num_env_steps_sampled": 41216, "num_env_steps_trained": 11610, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 595.2483647324865, "num_env_steps_trained_throughput_per_sec": 171.39964073770255, "timesteps_total": 41216, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 123648, "timers": {"training_iteration_time_ms": 1240.955, "sample_time_ms": 936.887, "load_time_ms": 0.315, "load_throughput": 817813.204, "learn_time_ms": 18.513, "learn_throughput": 13935.911, "synch_weights_time_ms": 10.604}, "counters": {"num_env_steps_sampled": 41216, "num_env_steps_trained": 11610, "num_agent_steps_sampled": 123648, "num_agent_steps_trained": 11610, "last_target_update_ts": 41216, "num_target_updates": 45}, "done": false, "episodes_total": 0, "training_iteration": 33, "trial_id": "a2ad0_00000", "date": "2023-11-18_21-02-00", "timestamp": 1700370120, "time_this_iter_s": 1.513519048690796, "time_total_s": 49.87171530723572, "pid": 6505, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x154272b60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 49.87171530723572, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 81.55000000000001, "ram_util_percent": 65.95}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.112044334411621, "actor_loss": -5.957357883453369, "critic_loss": 0.9001688957214355, "alpha_loss": -0.13659296929836273, "alpha_value": 0.98658287525177, "log_alpha_value": -0.013507947325706482, "target_entropy": -6.0, "policy_t": 0.08676446974277496, "mean_q": 2.042513608932495, "max_q": 9.139320373535156, "min_q": 1.7549502849578857}, "td_error": [1.9703882932662964, 2.4824047088623047, 3.810138702392578, 2.456268310546875, 1.2665523290634155, 1.1214702129364014, 2.2675697803497314, 1.5718474388122559, 2.7769088745117188, 1.3391262292861938, 1.891440987586975, 1.3248242139816284, 3.9459381103515625, 1.5090255737304688, 3.245791435241699, 2.704265594482422, 2.8738503456115723, 2.0017004013061523, 1.0714013576507568, 3.4405901432037354, 2.289072275161743, 2.4529314041137695, 1.2028460502624512, 4.563143253326416, 3.3432416915893555, 0.9552854299545288, 2.7441720962524414, 1.7653487920761108, 1.5503523349761963, 1.4995548725128174, 3.45082950592041, 2.795365333557129, 3.053804874420166, 1.2454662322998047, 1.735316514968872, 3.42305064201355, 1.7511522769927979, 2.781353235244751, 4.8546624183654785, 3.1637749671936035, 2.917553424835205, 3.627361297607422, 1.2701693773269653, 3.5283334255218506, 2.492920398712158, 2.184453248977661, 0.600628137588501, 2.5534918308258057, 2.623103380203247, 2.9666268825531006, 2.6563267707824707, 3.1522319316864014, 2.178818702697754, 3.667098045349121, 4.152458190917969, 0.6414971351623535, 1.8882497549057007, 2.482644557952881, 1.3907312154769897, 2.838449001312256, 1.993686318397522, 3.6786563396453857, 4.691049098968506, 3.4879043102264404, 1.404933214187622, 3.280055522918701, 2.4900705814361572, 2.7075583934783936, 1.9215716123580933, 2.545340061187744, 3.976501703262329, 2.4284508228302, 0.7341786026954651, 4.188613414764404, 3.268740653991699, 1.64927339553833, 4.714858055114746, 1.3938026428222656, 2.604351043701172, 4.9123854637146, 3.2757043838500977, 2.030758857727051, 2.736945867538452, 2.557724952697754, 1.9253802299499512, 1.3033432960510254], "mean_td_error": 2.5279908180236816, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 46.0, "diff_num_grad_updates_vs_sampler_policy": 45.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.06663703918457, "actor_loss": -5.846974849700928, "critic_loss": 0.3181250989437103, "alpha_loss": -0.13594460487365723, "alpha_value": 0.986586332321167, "log_alpha_value": -0.013504470698535442, "target_entropy": -6.0, "policy_t": 0.027033887803554535, "mean_q": 1.9814257621765137, "max_q": 5.78008508682251, "min_q": 1.8566970825195312}, "td_error": [0.42718762159347534, 0.9008069038391113, 0.0656195878982544, 1.6666789054870605, 1.9342167377471924, 0.6930727362632751, 1.6011388301849365, 2.7961926460266113, 2.4844799041748047, 0.18643438816070557, 0.8083893060684204, 0.11165231466293335, 0.6489723324775696, 1.6911954879760742, 2.1084160804748535, 1.9303343296051025, 1.6900255680084229, 0.6065296530723572, 0.9541377425193787, 1.451649785041809, 1.7167139053344727, 0.3967093825340271, 0.06325525045394897, 0.6040284633636475, 0.9408477544784546, 1.2296905517578125, 1.2387821674346924, 0.48103469610214233, 0.901852011680603, 0.6455116271972656, 0.34071779251098633, 0.29559725522994995, 1.6707446575164795, 0.5687665939331055, 1.097541332244873, 0.35701465606689453, 2.1086182594299316, 1.349589228630066, 1.5773520469665527, 0.308685839176178, 0.3078920841217041, 2.2010321617126465, 2.1433615684509277, 1.9003585577011108, 1.498450756072998, 0.1910158395767212, 0.06470131874084473, 1.3022141456604004, 0.7272731065750122, 0.5577853322029114, 1.0058214664459229, 1.977612853050232, 4.026704788208008, 2.5505869388580322, 0.8990657329559326, 3.5457448959350586, 1.7502959966659546, 0.3238571286201477, 0.5937983989715576, 0.09559613466262817, 2.58476185798645, 0.23539811372756958, 0.40406668186187744, 1.518640398979187, 0.9778541326522827, 0.860845148563385, 0.5269266963005066, 1.2807238101959229, 2.0748023986816406, 0.8193322420120239, 0.4426378607749939, 2.293311357498169, 1.1060161590576172, 1.8683419227600098, 1.98508620262146, 1.6614800691604614, 2.3126301765441895, 1.1305172443389893, 1.152450680732727, 0.4704655408859253, 0.46135735511779785, 1.3460373878479004, 3.4381561279296875, 3.8141324520111084, 0.08140164613723755, 1.4376559257507324], "mean_td_error": 1.239516019821167, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 46.0, "diff_num_grad_updates_vs_sampler_policy": 45.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.12746524810791, "actor_loss": -5.720078468322754, "critic_loss": 0.2910037636756897, "alpha_loss": -0.13677425682544708, "alpha_value": 0.9865854978561401, "log_alpha_value": -0.013505280949175358, "target_entropy": -6.0, "policy_t": 0.0199101772159338, "mean_q": 1.7848529815673828, "max_q": 4.584620475769043, "min_q": 1.6063995361328125}, "td_error": [2.860234498977661, 0.24655687808990479, 0.36081212759017944, 2.7103679180145264, 2.123734474182129, 1.9206736087799072, 1.4746168851852417, 2.007716178894043, 1.3179433345794678, 0.2976266145706177, 1.5492892265319824, 2.025543451309204, 2.5315346717834473, 1.3939502239227295, 1.2858895063400269, 1.2419650554656982, 0.6729638576507568, 0.9310527443885803, 3.720769166946411, 2.814422607421875, 1.932722806930542, 1.2846341133117676, 2.458345890045166, 0.13923180103302002, 0.7192423939704895, 2.3514699935913086, 2.751042366027832, 1.581881046295166, 1.6514701843261719, 0.6900902986526489, 1.843733787536621, 3.256253480911255, 1.4887681007385254, 0.4912683367729187, 1.8683465719223022, 1.5073890686035156, 0.7084702849388123, 0.5761846303939819, 1.7461693286895752, 1.130757451057434, 1.5490963459014893, 1.6755790710449219, 1.0948476791381836, 1.7252373695373535, 1.9281938076019287, 2.5631461143493652, 4.048755645751953, 1.850996732711792, 0.08746099472045898, 0.8000982999801636, 0.34394800662994385, 0.6357535123825073, 1.2164111137390137, 1.0084102153778076, 2.445685863494873, 0.5964957475662231, 1.993707299232483, 0.15632426738739014, 0.5563499927520752, 3.453197956085205, 0.1077340841293335, 0.3537576198577881, 1.8287876844406128, 1.8157989978790283, 0.4184483289718628, 0.7233422994613647, 1.6524450778961182, 0.5252935886383057, 1.5611484050750732, 0.03208094835281372, 0.5188592672348022, 2.4560203552246094, 2.481792449951172, 0.12199151515960693, 1.773682951927185, 2.429903030395508, 2.095889091491699, 1.0319838523864746, 2.350128173828125, 1.850740671157837, 1.7245521545410156, 1.5355548858642578, 0.3816985487937927, 2.3511836528778076, 0.7497738599777222, 1.5359117984771729], "mean_td_error": 1.4860851764678955, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 46.0, "diff_num_grad_updates_vs_sampler_policy": 45.0}}, "num_env_steps_sampled": 42112, "num_env_steps_trained": 11868, "num_agent_steps_sampled": 126336, "num_agent_steps_trained": 11868, "last_target_update_ts": 42112, "num_target_updates": 46}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 126336, "num_agent_steps_trained": 11868, "num_env_steps_sampled": 42112, "num_env_steps_trained": 11868, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 855.2337538769565, "num_env_steps_trained_throughput_per_sec": 246.26150502260577, "timesteps_total": 42112, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 126336, "timers": {"training_iteration_time_ms": 1241.1, "sample_time_ms": 936.704, "load_time_ms": 0.315, "load_throughput": 818617.469, "learn_time_ms": 18.639, "learn_throughput": 13841.72, "synch_weights_time_ms": 10.775}, "counters": {"num_env_steps_sampled": 42112, "num_env_steps_trained": 11868, "num_agent_steps_sampled": 126336, "num_agent_steps_trained": 11868, "last_target_update_ts": 42112, "num_target_updates": 46}, "done": false, "episodes_total": 0, "training_iteration": 34, "trial_id": "a2ad0_00000", "date": "2023-11-18_21-02-02", "timestamp": 1700370122, "time_this_iter_s": 1.0570590496063232, "time_total_s": 50.92877435684204, "pid": 6505, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x1542732e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 50.92877435684204, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 70.94999999999999, "ram_util_percent": 65.85}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.090903282165527, "actor_loss": -6.027392864227295, "critic_loss": 1.0005851984024048, "alpha_loss": -0.13933590054512024, "alpha_value": 0.9862868189811707, "log_alpha_value": -0.013808070681989193, "target_entropy": -6.0, "policy_t": 0.06305798888206482, "mean_q": 2.38541579246521, "max_q": 12.317468643188477, "min_q": 1.832005262374878}, "td_error": [1.55690336227417, 3.842525005340576, 3.853847026824951, 3.0128493309020996, 3.284330368041992, 3.182572841644287, 1.9160884618759155, 9.567939758300781, 0.9495692253112793, 3.761338472366333, 4.033095836639404, 3.1668996810913086, 4.837007522583008, 2.550428867340088, 6.709157466888428, 1.7158174514770508, 2.88061785697937, 2.0001931190490723, 1.4176565408706665, 3.4420011043548584, 1.9862942695617676, 2.2204930782318115, 2.1300415992736816, 3.266240119934082, 2.1936726570129395, 1.688644289970398, 3.4228744506835938, 2.7236738204956055, 2.9178500175476074, 1.2263563871383667, 0.5256174802780151, 2.246692657470703, 2.457080364227295, 2.2075910568237305, 2.221569061279297, 0.5270750522613525, 3.2826809883117676, 2.106384754180908, 1.3164393901824951, 3.522672653198242, 2.698284149169922, 3.9770851135253906, 2.567190170288086, 2.405790090560913, 3.352451801300049, 2.3950576782226562, 1.6609034538269043, 3.6366770267486572, 2.767068386077881, 4.4463396072387695, 2.8302109241485596, 2.4211556911468506, 1.9719046354293823, 2.856919050216675, 3.062587261199951, 3.3508477210998535, 2.740659236907959, 3.388824939727783, 1.3108007907867432, 4.165529251098633, 0.7347184419631958, 0.4185483455657959, 1.0931092500686646, 1.6886197328567505, 4.305903434753418, 2.484697103500366, 2.0212087631225586, 2.588075637817383, 3.785799026489258, 2.7491912841796875, 2.9791197776794434, 2.8675150871276855, 1.666192889213562, 2.989525556564331, 2.240194320678711, 3.816049098968506, 1.115669846534729, 0.699440598487854, 3.8295207023620605, 3.530618667602539, 0.7146921157836914, 3.4039998054504395, 2.818514585494995, 2.5943472385406494, 2.229870319366455, 1.9066486358642578], "mean_td_error": 2.687777519226074, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 47.0, "diff_num_grad_updates_vs_sampler_policy": 46.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.069021224975586, "actor_loss": -5.913347244262695, "critic_loss": 0.31225574016571045, "alpha_loss": -0.13899625837802887, "alpha_value": 0.9862905144691467, "log_alpha_value": -0.01380434725433588, "target_entropy": -6.0, "policy_t": 0.038275476545095444, "mean_q": 2.1535849571228027, "max_q": 6.220433235168457, "min_q": 1.928260326385498}, "td_error": [1.2447025775909424, 0.20120477676391602, 1.9266436100006104, 0.06768840551376343, 1.8764028549194336, 3.2227365970611572, 1.8196827173233032, 0.34727561473846436, 0.31157469749450684, 1.0336434841156006, 1.0375547409057617, 2.007784843444824, 1.3359383344650269, 0.7146175503730774, 1.2593591213226318, 2.1360504627227783, 0.4018893837928772, 1.4062259197235107, 1.1632132530212402, 1.4591692686080933, 0.6950579881668091, 1.1850051879882812, 2.217292070388794, 0.9898643493652344, 1.7472723722457886, 1.327131986618042, 1.7347321510314941, 0.21515589952468872, 4.276042938232422, 0.9903960227966309, 0.27469325065612793, 1.623642921447754, 1.9123425483703613, 0.06445693969726562, 1.4074344635009766, 1.812199592590332, 3.6756818294525146, 1.0596174001693726, 2.828242778778076, 0.6105315685272217, 0.6873573660850525, 1.7357454299926758, 0.06679707765579224, 1.682080626487732, 0.06772524118423462, 1.2572340965270996, 0.6234416961669922, 1.4478650093078613, 2.4062185287475586, 1.1973013877868652, 3.690242290496826, 1.0335348844528198, 0.7170319557189941, 0.9974919557571411, 1.7552858591079712, 0.536501407623291, 0.06611335277557373, 1.1701229810714722, 0.9525390863418579, 1.9395149946212769, 0.4142550230026245, 1.9962725639343262, 2.9321703910827637, 1.4172853231430054, 2.0460667610168457, 0.06767421960830688, 0.06764668226242065, 1.296734094619751, 1.632246971130371, 2.0389351844787598, 0.370941162109375, 0.5037665367126465, 0.24751025438308716, 1.1980206966400146, 0.0675012469291687, 0.3194478750228882, 0.8813034296035767, 0.4512210488319397, 1.7656198740005493, 0.36461758613586426, 0.4564603567123413, 1.1622921228408813, 0.28730159997940063, 1.147806167602539, 0.1042359471321106, 0.4523157477378845], "mean_td_error": 1.201627254486084, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 47.0, "diff_num_grad_updates_vs_sampler_policy": 46.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.10251235961914, "actor_loss": -5.7892022132873535, "critic_loss": 0.28815048933029175, "alpha_loss": -0.13947057723999023, "alpha_value": 0.9862893223762512, "log_alpha_value": -0.01380553375929594, "target_entropy": -6.0, "policy_t": -0.03934419900178909, "mean_q": 1.8359596729278564, "max_q": 4.535556316375732, "min_q": 1.6760194301605225}, "td_error": [2.0106470584869385, 0.36156243085861206, 3.124657392501831, 0.5595197677612305, 0.3186638355255127, 1.8825796842575073, 1.4103856086730957, 2.031874179840088, 0.8200595378875732, 1.6942156553268433, 3.2263684272766113, 1.7207775115966797, 1.388227939605713, 1.2174330949783325, 2.1344635486602783, 0.2449558973312378, 0.7906535267829895, 0.5913564562797546, 0.985683262348175, 1.1245076656341553, 1.1159483194351196, 1.3984694480895996, 0.4229061007499695, 0.8889886140823364, 1.752651572227478, 2.668323516845703, 2.2175791263580322, 1.3621478080749512, 1.6193311214447021, 3.288374423980713, 2.568164587020874, 1.9087164402008057, 0.13671231269836426, 1.115999460220337, 2.5024142265319824, 2.066145658493042, 2.8442368507385254, 0.46877825260162354, 0.264997661113739, 0.44515007734298706, 2.2268495559692383, 0.7620491981506348, 2.629338264465332, 0.018835783004760742, 0.423970103263855, 2.5131289958953857, 2.20798659324646, 0.17693305015563965, 2.9260306358337402, 2.739017963409424, 1.1386361122131348, 0.14923179149627686, 0.8001219630241394, 0.6889842748641968, 0.690979540348053, 0.9090410470962524, 1.133903980255127, 1.0430991649627686, 1.2418134212493896, 0.15285331010818481, 0.6981730461120605, 0.9462954998016357, 0.8031730651855469, 1.300079584121704, 1.0429437160491943, 1.469909429550171, 1.6616029739379883, 0.6375856995582581, 0.4620920419692993, 1.7287297248840332, 0.4356878399848938, 1.3201584815979004, 2.353762149810791, 2.3755316734313965, 2.477638006210327, 1.106594204902649, 1.4361180067062378, 1.630481481552124, 1.5419918298721313, 1.9659589529037476, 2.0227460861206055, 2.826906681060791, 1.3636995553970337, 2.8204989433288574, 2.3263139724731445, 3.3958749771118164], "mean_td_error": 1.4583485126495361, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 47.0, "diff_num_grad_updates_vs_sampler_policy": 46.0}}, "num_env_steps_sampled": 43008, "num_env_steps_trained": 12126, "num_agent_steps_sampled": 129024, "num_agent_steps_trained": 12126, "last_target_update_ts": 43008, "num_target_updates": 47}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 129024, "num_agent_steps_trained": 12126, "num_env_steps_sampled": 43008, "num_env_steps_trained": 12126, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 769.0129658645168, "num_env_steps_trained_throughput_per_sec": 221.43453704580952, "timesteps_total": 43008, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 129024, "timers": {"training_iteration_time_ms": 1224.902, "sample_time_ms": 941.478, "load_time_ms": 0.315, "load_throughput": 819423.317, "learn_time_ms": 18.517, "learn_throughput": 13933.506, "synch_weights_time_ms": 10.763}, "counters": {"num_env_steps_sampled": 43008, "num_env_steps_trained": 12126, "num_agent_steps_sampled": 129024, "num_agent_steps_trained": 12126, "last_target_update_ts": 43008, "num_target_updates": 47}, "done": false, "episodes_total": 0, "training_iteration": 35, "trial_id": "a2ad0_00000", "date": "2023-11-18_21-02-03", "timestamp": 1700370123, "time_this_iter_s": 1.1735200881958008, "time_total_s": 52.10229444503784, "pid": 6505, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x1542da7a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 52.10229444503784, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 94.3, "ram_util_percent": 65.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.015604972839355, "actor_loss": -6.051715850830078, "critic_loss": 0.9225678443908691, "alpha_loss": -0.14130204916000366, "alpha_value": 0.9859908819198608, "log_alpha_value": -0.014108186587691307, "target_entropy": -6.0, "policy_t": 0.0071190837770700455, "mean_q": 2.3693675994873047, "max_q": 11.313047409057617, "min_q": 1.9090770483016968}, "td_error": [2.3578648567199707, 2.4830708503723145, 1.9620426893234253, 1.95735764503479, 4.438929557800293, 1.5045397281646729, 2.707890510559082, 2.1961750984191895, 3.7823610305786133, 2.1610591411590576, 2.42905330657959, 0.8277565240859985, 2.1642580032348633, 2.62620210647583, 2.491555690765381, 2.251467704772949, 4.830018997192383, 3.961353302001953, 0.9406428337097168, 1.8893253803253174, 6.560511589050293, 2.72339129447937, 2.001487970352173, 1.7466567754745483, 1.9703989028930664, 0.9871271848678589, 2.0607361793518066, 1.349900245666504, 1.3632158041000366, 1.2381294965744019, 3.1146485805511475, 2.895660877227783, 1.7458508014678955, 1.442914605140686, 2.1112728118896484, 3.103745460510254, 4.776313304901123, 0.7996891736984253, 0.8183625340461731, 3.103849411010742, 2.034797191619873, 2.626204013824463, 1.7058372497558594, 4.00993537902832, 2.7266716957092285, 1.7901034355163574, 2.8075995445251465, 2.7445180416107178, 3.155801773071289, 2.425246238708496, 0.5324020385742188, 3.7878878116607666, 1.3290448188781738, 2.0028891563415527, 3.5541985034942627, 4.267743110656738, 3.486553430557251, 0.7534587383270264, 3.0850000381469727, 7.16646671295166, 3.491611957550049, 2.247572898864746, 1.4670840501785278, 0.5071473717689514, 3.2684600353240967, 3.051938056945801, 3.1530613899230957, 0.8609806299209595, 1.952736496925354, 1.8986897468566895, 2.510927677154541, 3.6441988945007324, 3.2669835090637207, 2.705173969268799, 3.4708690643310547, 5.366940021514893, 2.9433417320251465, 2.7373464107513428, 1.742034912109375, 2.971069812774658, 2.8523383140563965, 2.9383373260498047, 2.5860021114349365, 1.7342182397842407, 2.2635204792022705, 3.040060520172119], "mean_td_error": 2.564439535140991, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 48.0, "diff_num_grad_updates_vs_sampler_policy": 47.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.05916976928711, "actor_loss": -6.013340950012207, "critic_loss": 0.22669340670108795, "alpha_loss": -0.1418764591217041, "alpha_value": 0.985994815826416, "log_alpha_value": -0.014104191213846207, "target_entropy": -6.0, "policy_t": -0.04742654785513878, "mean_q": 2.0702178478240967, "max_q": 5.662408828735352, "min_q": 2.018484592437744}, "td_error": [0.9339190721511841, 0.6945227980613708, 0.863798975944519, 0.9078729152679443, 0.21267056465148926, 0.2837105989456177, 0.0677865743637085, 1.0134501457214355, 0.0738976001739502, 0.7182579636573792, 2.064545154571533, 1.0709437131881714, 1.628496527671814, 0.76686692237854, 2.693427801132202, 2.2779622077941895, 0.9582152366638184, 0.7915422916412354, 1.170096516609192, 1.583473801612854, 1.1898043155670166, 0.15543973445892334, 1.02116858959198, 2.104254961013794, 0.6129770874977112, 1.7911272048950195, 0.0876312255859375, 0.7651622891426086, 2.6938488483428955, 0.2897317409515381, 0.06529366970062256, 1.8782012462615967, 0.15157729387283325, 0.41805779933929443, 1.2256522178649902, 1.609299659729004, 0.27051210403442383, 0.21279919147491455, 0.5960978269577026, 0.06794476509094238, 1.4641956090927124, 1.4178664684295654, 1.107279658317566, 0.25277769565582275, 0.5964833498001099, 0.45983898639678955, 0.7820004820823669, 0.06958967447280884, 0.1661483645439148, 1.659509539604187, 0.7238556742668152, 0.5919777750968933, 0.3842555284500122, 0.3897353410720825, 2.6158132553100586, 2.047975540161133, 1.8373560905456543, 0.9274047613143921, 2.014103889465332, 0.2836712598800659, 1.9416922330856323, 0.8794506192207336, 0.7119113802909851, 0.6452820301055908, 0.34521567821502686, 0.7619466185569763, 1.0896754264831543, 0.2620917558670044, 0.7781466245651245, 0.17939633131027222, 1.3833707571029663, 1.3850460052490234, 0.285305380821228, 2.521481513977051, 1.0095508098602295, 0.6704182028770447, 2.7427761554718018, 1.0637028217315674, 0.0881267786026001, 0.24465501308441162, 0.7564584612846375, 0.9003262519836426, 1.1927902698516846, 1.1905438899993896, 0.6303682327270508, 1.3556188344955444], "mean_td_error": 0.9626653790473938, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 48.0, "diff_num_grad_updates_vs_sampler_policy": 47.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.139366149902344, "actor_loss": -5.899691104888916, "critic_loss": 0.22254613041877747, "alpha_loss": -0.14302384853363037, "alpha_value": 0.9859932065010071, "log_alpha_value": -0.014105798676609993, "target_entropy": -6.0, "policy_t": -0.026376085355877876, "mean_q": 1.8464893102645874, "max_q": 4.916563987731934, "min_q": 1.7474476099014282}, "td_error": [2.165682315826416, 2.4429140090942383, 0.218747079372406, 0.6701325178146362, 0.05434507131576538, 0.28121280670166016, 3.640212297439575, 0.41621774435043335, 1.4744324684143066, 0.14070701599121094, 1.1988680362701416, 1.0649960041046143, 0.41176265478134155, 0.5382736921310425, 0.9902956485748291, 1.6609435081481934, 2.0961241722106934, 0.5379605293273926, 0.3431045413017273, 1.378856897354126, 0.5503997206687927, 1.207911491394043, 3.079749584197998, 1.2901719808578491, 0.40178489685058594, 2.3833460807800293, 1.286642074584961, 1.711393117904663, 3.0274906158447266, 1.7780356407165527, 1.8795266151428223, 0.6352972388267517, 1.979247808456421, 0.2753962278366089, 0.5035108923912048, 1.6419544219970703, 0.568361759185791, 0.26305484771728516, 0.4268306493759155, 1.0090945959091187, 1.1821672916412354, 0.6567375063896179, 0.72297203540802, 1.5305604934692383, 0.3198627233505249, 1.0034253597259521, 0.6551532745361328, 0.19014394283294678, 1.056187391281128, 0.2521134614944458, 1.0449495315551758, 1.0159621238708496, 0.43825817108154297, 0.2386401891708374, 0.07573044300079346, 2.2761034965515137, 0.33003151416778564, 1.806817889213562, 1.4380500316619873, 1.1719967126846313, 1.7400202751159668, 1.22121262550354, 2.455667495727539, 1.0242085456848145, 1.317035436630249, 0.3764221668243408, 1.3852996826171875, 1.97268807888031, 1.0237376689910889, 3.074284076690674, 1.205556035041809, 1.8310415744781494, 3.233959913253784, 2.3105077743530273, 1.9931080341339111, 2.018061637878418, 1.3246177434921265, 1.2720227241516113, 0.7754113674163818, 2.638780117034912, 1.6500706672668457, 1.359757423400879, 0.16672611236572266, 0.9397472143173218, 0.7876654863357544, 0.2605171203613281], "mean_td_error": 1.2138253450393677, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 48.0, "diff_num_grad_updates_vs_sampler_policy": 47.0}}, "num_env_steps_sampled": 43904, "num_env_steps_trained": 12384, "num_agent_steps_sampled": 131712, "num_agent_steps_trained": 12384, "last_target_update_ts": 43904, "num_target_updates": 48}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 131712, "num_agent_steps_trained": 12384, "num_env_steps_sampled": 43904, "num_env_steps_trained": 12384, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 849.2456717941742, "num_env_steps_trained_throughput_per_sec": 244.53725817287605, "timesteps_total": 43904, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 131712, "timers": {"training_iteration_time_ms": 1208.188, "sample_time_ms": 924.065, "load_time_ms": 0.316, "load_throughput": 816825.507, "learn_time_ms": 18.634, "learn_throughput": 13845.846, "synch_weights_time_ms": 10.624}, "counters": {"num_env_steps_sampled": 43904, "num_env_steps_trained": 12384, "num_agent_steps_sampled": 131712, "num_agent_steps_trained": 12384, "last_target_update_ts": 43904, "num_target_updates": 48}, "done": false, "episodes_total": 0, "training_iteration": 36, "trial_id": "a2ad0_00000", "date": "2023-11-18_21-02-04", "timestamp": 1700370124, "time_this_iter_s": 1.0672190189361572, "time_total_s": 53.169513463974, "pid": 6505, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x1542d9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 53.169513463974, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 73.05, "ram_util_percent": 65.85}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.097235679626465, "actor_loss": -6.224776268005371, "critic_loss": 0.916650652885437, "alpha_loss": -0.1454821527004242, "alpha_value": 0.9856951832771301, "log_alpha_value": -0.014408118091523647, "target_entropy": -6.0, "policy_t": -0.03462911769747734, "mean_q": 2.2708845138549805, "max_q": 9.282791137695312, "min_q": 1.9890637397766113}, "td_error": [2.6587977409362793, 0.9177305698394775, 2.600825786590576, 3.797121524810791, 3.1814541816711426, 4.551849842071533, 2.347438335418701, 3.3264412879943848, 0.5889683961868286, 2.195918321609497, 2.4884819984436035, 4.117895126342773, 0.5511542558670044, 2.4507203102111816, 2.052039623260498, 3.034592628479004, 0.7000875473022461, 0.5936033725738525, 2.2702155113220215, 1.9234009981155396, 0.508110523223877, 2.2510013580322266, 3.956401824951172, 4.049785614013672, 1.0628478527069092, 1.3192026615142822, 3.5563254356384277, 2.6944985389709473, 0.6513365507125854, 2.59269642829895, 1.4832344055175781, 1.20870840549469, 2.941710948944092, 3.0352237224578857, 3.060145378112793, 1.8336758613586426, 2.16009521484375, 3.7515697479248047, 1.873361587524414, 3.281486988067627, 2.1509556770324707, 4.999866485595703, 3.2326323986053467, 1.3749725818634033, 1.9250197410583496, 4.521084785461426, 1.2315326929092407, 3.5993950366973877, 1.3563804626464844, 3.2320034503936768, 1.0806617736816406, 2.151698112487793, 3.01316237449646, 1.7962738275527954, 3.2714099884033203, 3.346848487854004, 2.2084193229675293, 3.523345470428467, 1.5052032470703125, 3.88308048248291, 1.219383955001831, 2.5205800533294678, 2.849825143814087, 1.6107970476150513, 3.3017232418060303, 2.5785062313079834, 2.370119094848633, 2.6642298698425293, 3.512871265411377, 2.055518627166748, 2.9356026649475098, 2.5443248748779297, 3.452291488647461, 3.4920058250427246, 2.151988983154297, 2.623767852783203, 2.2631607055664062, 3.560743808746338, 6.185551643371582, 2.882218360900879, 2.267143487930298, 1.2907564640045166, 2.218038558959961, 2.3020129203796387, 2.263505220413208, 3.7013258934020996], "mean_td_error": 2.5330474376678467, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 49.0, "diff_num_grad_updates_vs_sampler_policy": 48.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.145854949951172, "actor_loss": -6.144773483276367, "critic_loss": 0.20647889375686646, "alpha_loss": -0.1461407095193863, "alpha_value": 0.9856992363929749, "log_alpha_value": -0.01440398208796978, "target_entropy": -6.0, "policy_t": -0.00609917426481843, "mean_q": 2.321441888809204, "max_q": 5.134637355804443, "min_q": 2.100583553314209}, "td_error": [1.1920217275619507, 0.12724930047988892, 0.3575749397277832, 0.2693547010421753, 0.18943345546722412, 0.45476233959198, 0.34519457817077637, 1.6328480243682861, 0.7841438055038452, 2.339836359024048, 1.2217144966125488, 0.07081043720245361, 1.2120156288146973, 0.14148575067520142, 2.422313690185547, 0.14178210496902466, 2.061105251312256, 0.3637208342552185, 0.7373740673065186, 1.757327914237976, 1.8430876731872559, 0.37152624130249023, 1.146317481994629, 0.12132865190505981, 1.2038357257843018, 0.9091684818267822, 1.2617249488830566, 0.6411709785461426, 0.43235158920288086, 1.035930871963501, 2.262129068374634, 0.2797442674636841, 0.8624595999717712, 0.5105206966400146, 0.43542051315307617, 0.6480815410614014, 0.21909183263778687, 1.30140221118927, 1.1076593399047852, 0.9633262157440186, 2.024176836013794, 1.2656421661376953, 0.5125418305397034, 1.6790293455123901, 0.6405625343322754, 0.2457994818687439, 0.08641922473907471, 2.0441577434539795, 1.0615519285202026, 1.3205721378326416, 1.351712703704834, 0.20430457592010498, 2.0369632244110107, 0.2629969120025635, 0.08745837211608887, 0.8033862113952637, 0.9356715679168701, 0.5653709173202515, 0.41700971126556396, 1.388541579246521, 0.07676362991333008, 0.6709494590759277, 0.700264573097229, 1.1419296264648438, 1.4675381183624268, 1.202930212020874, 0.2473852038383484, 0.4419305920600891, 0.7040032148361206, 0.07065284252166748, 0.8732101917266846, 0.6298209428787231, 2.557446002960205, 1.0761823654174805, 0.4760173559188843, 2.2586896419525146, 0.36629247665405273, 1.0437803268432617, 0.0671045184135437, 0.6728559732437134, 1.2845200300216675, 1.8777694702148438, 1.3841303586959839, 0.3550906777381897, 0.582953155040741, 3.116795539855957], "mean_td_error": 0.926270067691803, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 49.0, "diff_num_grad_updates_vs_sampler_policy": 48.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.079781532287598, "actor_loss": -5.906360149383545, "critic_loss": 0.20935030281543732, "alpha_loss": -0.14521095156669617, "alpha_value": 0.9856970906257629, "log_alpha_value": -0.01440616138279438, "target_entropy": -6.0, "policy_t": -0.0241403691470623, "mean_q": 1.9567946195602417, "max_q": 4.864332675933838, "min_q": 1.601147174835205}, "td_error": [1.7301424741744995, 0.16126757860183716, 0.574472188949585, 0.907574474811554, 0.023255586624145508, 2.707688331604004, 0.08426254987716675, 0.3302153944969177, 0.7104046940803528, 1.4716267585754395, 1.8124361038208008, 0.05818420648574829, 0.7693456411361694, 0.5906696319580078, 1.5306687355041504, 1.2752121686935425, 0.561905026435852, 1.1157749891281128, 2.160953998565674, 1.1367267370224, 1.0816998481750488, 1.0322186946868896, 0.5134353041648865, 2.1066062450408936, 1.1443829536437988, 1.961202621459961, 2.660543918609619, 0.46922093629837036, 1.3508892059326172, 1.1619813442230225, 2.4354772567749023, 0.8700099587440491, 0.9891765117645264, 0.5725790858268738, 0.6545459628105164, 1.1539593935012817, 1.5656248331069946, 0.9552072882652283, 1.6104772090911865, 0.5305650234222412, 0.38851869106292725, 2.116650342941284, 0.37775349617004395, 0.8031914830207825, 2.156193733215332, 2.323349952697754, 0.4564781188964844, 2.611328601837158, 0.722575843334198, 0.9771718978881836, 0.781057596206665, 0.42621904611587524, 0.9272168874740601, 1.7465310096740723, 0.660777747631073, 1.2842837572097778, 0.8333889245986938, 1.751296043395996, 3.182631254196167, 1.9213359355926514, 2.1372132301330566, 0.34062713384628296, 1.9752695560455322, 0.713087797164917, 0.8461118936538696, 1.0107007026672363, 0.6006473898887634, 0.5401661992073059, 2.785844087600708, 0.11033523082733154, 1.5267932415008545, 0.2380375862121582, 1.0570086240768433, 2.2827212810516357, 0.08400845527648926, 0.3096722364425659, 2.4014365673065186, 0.8632058501243591, 1.8520586490631104, 0.017429471015930176, 1.080637812614441, 0.18125027418136597, 0.4291633367538452, 1.55025053024292, 2.8797876834869385, 2.165266513824463], "mean_td_error": 1.1739450693130493, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 49.0, "diff_num_grad_updates_vs_sampler_policy": 48.0}}, "num_env_steps_sampled": 44800, "num_env_steps_trained": 12642, "num_agent_steps_sampled": 134400, "num_agent_steps_trained": 12642, "last_target_update_ts": 44800, "num_target_updates": 49}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 134400, "num_agent_steps_trained": 12642, "num_env_steps_sampled": 44800, "num_env_steps_trained": 12642, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 779.1683314967299, "num_env_steps_trained_throughput_per_sec": 224.3587383104423, "timesteps_total": 44800, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 134400, "timers": {"training_iteration_time_ms": 1210.662, "sample_time_ms": 921.191, "load_time_ms": 0.324, "load_throughput": 797384.446, "learn_time_ms": 18.822, "learn_throughput": 13707.171, "synch_weights_time_ms": 10.663}, "counters": {"num_env_steps_sampled": 44800, "num_env_steps_trained": 12642, "num_agent_steps_sampled": 134400, "num_agent_steps_trained": 12642, "last_target_update_ts": 44800, "num_target_updates": 49}, "done": false, "episodes_total": 0, "training_iteration": 37, "trial_id": "a2ad0_00000", "date": "2023-11-18_21-02-05", "timestamp": 1700370125, "time_this_iter_s": 1.1594088077545166, "time_total_s": 54.328922271728516, "pid": 6505, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x1542732e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": true, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 54.328922271728516, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 75.2, "ram_util_percent": 65.7}}
