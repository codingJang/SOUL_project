{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 896, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2688, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2688, "num_agent_steps_trained": 0, "num_env_steps_sampled": 896, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 338.04190640671027, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 896, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2688, "timers": {"training_iteration_time_ms": 2650.527, "sample_time_ms": 1156.487}, "counters": {"num_env_steps_sampled": 896, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2688, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 1, "trial_id": "04288_00000", "date": "2023-11-16_21-56-32", "timestamp": 1700200592, "time_this_iter_s": 2.6543128490448, "time_total_s": 2.6543128490448, "pid": 46177, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fded86a29d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 2.6543128490448, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 46.4, "ram_util_percent": 89.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.03602409362793, "actor_loss": -4.035030841827393, "critic_loss": 4.999819278717041, "alpha_loss": 0.0, "alpha_value": 1.0, "log_alpha_value": 0.0, "target_entropy": -6.0, "policy_t": -0.02225722000002861, "mean_q": 0.0036639412865042686, "max_q": 0.009414762258529663, "min_q": -0.0026595524977892637}, "td_error": [5.641534805297852, 4.925342082977295, 6.174849510192871, 8.077079772949219, 6.359190464019775, 4.268499374389648, 6.016483306884766, 5.814958572387695, 4.3733391761779785, 5.494083404541016, 6.012539863586426, 4.374523162841797, 4.901313781738281, 5.699954509735107, 3.652010679244995, 5.318758964538574, 3.7321982383728027, 5.917696475982666, 6.572408199310303, 6.986207008361816, 5.776127815246582, 7.428027153015137, 5.207520008087158, 6.396140098571777, 6.296881675720215, 5.906298637390137, 4.378366470336914, 4.134809494018555, 5.2898993492126465, 5.8604888916015625, 5.255275726318359, 6.118375778198242, 5.588649272918701, 3.125253677368164, 7.620244979858398, 4.5028252601623535, 5.148536682128906, 6.405536651611328, 7.255969047546387, 3.0559334754943848, 6.146988868713379, 5.731823921203613, 4.912757873535156, 4.0417070388793945, 5.566869735717773, 4.706133842468262, 6.148903846740723, 5.804978370666504, 5.6690168380737305, 6.659373760223389, 5.343008041381836, 3.934093475341797, 5.96672248840332, 5.412287712097168, 5.123926162719727, 6.0969462394714355, 7.314695358276367, 6.9563188552856445, 6.151146411895752, 5.286487579345703, 5.900297164916992, 4.9464216232299805, 2.434183120727539, 4.0643720626831055, 6.658312797546387, 4.161208152770996, 5.9460225105285645, 7.571937084197998, 6.3152546882629395, 5.506922721862793, 6.1801300048828125, 6.451464653015137, 4.396711349487305, 3.158156156539917, 4.8991498947143555, 7.851016998291016, 5.039626121520996, 4.1449995040893555, 4.887212753295898, 4.601390838623047, 6.621669769287109, 7.110565662384033, 3.391732931137085, 5.542702674865723, 5.865395545959473, 5.299278259277344], "mean_td_error": 5.499818801879883, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1.0, "diff_num_grad_updates_vs_sampler_policy": 0.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.98245620727539, "actor_loss": -3.9811744689941406, "critic_loss": 3.049104928970337, "alpha_loss": 0.0, "alpha_value": 1.0, "log_alpha_value": 0.0, "target_entropy": -6.0, "policy_t": 0.0325787179172039, "mean_q": -0.000689821841660887, "max_q": 0.0017610648646950722, "min_q": -0.003582167439162731}, "td_error": [2.2139322757720947, 2.6002516746520996, 5.928940773010254, 3.607987880706787, 3.360650062561035, 4.277809143066406, 3.455699920654297, 2.971266746520996, 2.0182509422302246, 4.801377296447754, 3.479625940322876, 5.157326698303223, 2.542464256286621, 1.732515573501587, 4.915882110595703, 4.271341323852539, 4.434490203857422, 4.5530781745910645, 3.341381549835205, 2.9770796298980713, 3.5035862922668457, 3.5770320892333984, 2.475125312805176, 3.1069908142089844, 3.2386722564697266, 3.1460766792297363, 2.888117790222168, 1.8363094329833984, 6.253933429718018, 0.9025988578796387, 4.244210720062256, 1.9409552812576294, 3.7694427967071533, 6.781431198120117, 4.513521671295166, 2.987579345703125, 3.2304141521453857, 3.282571792602539, 4.065776824951172, 4.2287373542785645, 3.7161459922790527, 5.15146017074585, 3.6549525260925293, 4.70697546005249, 3.6069607734680176, 4.738922595977783, 1.1319940090179443, 3.8972511291503906, 3.395092010498047, 3.1296489238739014, 2.539400339126587, 3.3538131713867188, 3.4379825592041016, 1.6975376605987549, 4.43662166595459, 2.090815544128418, 3.255209445953369, 3.839388847351074, 3.3109142780303955, 1.7822314500808716, 3.045668125152588, 4.036751747131348, 2.981703758239746, 3.679993152618408, 4.454438209533691, 2.6552839279174805, 4.604048728942871, 1.8584853410720825, 4.772160053253174, 2.3498947620391846, 4.462717056274414, 4.647606372833252, 4.040502548217773, 2.844910144805908, 4.633805274963379, 3.2625527381896973, 4.988819122314453, 5.174079895019531, 3.808201789855957, 2.995835781097412, 3.3278555870056152, 3.1074275970458984, 2.3089301586151123, 2.167079210281372, 5.439373016357422, 4.0824127197265625], "mean_td_error": 3.5490503311157227, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1.0, "diff_num_grad_updates_vs_sampler_policy": 0.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.974532127380371, "actor_loss": -3.9741756916046143, "critic_loss": 3.125532627105713, "alpha_loss": 0.0, "alpha_value": 1.0, "log_alpha_value": 0.0, "target_entropy": -6.0, "policy_t": -0.013018104247748852, "mean_q": 0.005005958955734968, "max_q": 0.008474750444293022, "min_q": 0.00014754931908100843}, "td_error": [4.475014686584473, 2.7704920768737793, 2.791940212249756, 3.9904234409332275, 6.052788734436035, 3.8844642639160156, 4.55570125579834, 3.31658935546875, 3.5434088706970215, 3.3553075790405273, 1.319696307182312, 3.8036298751831055, 3.4357619285583496, 3.810731887817383, 3.9577014446258545, 1.6751461029052734, 2.3547589778900146, 3.4366443157196045, 2.695275068283081, 4.266043186187744, 2.831235885620117, 3.505035877227783, 3.7168421745300293, 4.5276031494140625, 5.376854419708252, 2.36257266998291, 2.8646748065948486, 5.831345558166504, 5.54632568359375, 5.194218158721924, 1.591815710067749, 1.8565418720245361, 2.956432819366455, 3.735246181488037, 4.278472900390625, 3.5514416694641113, 2.397768259048462, 3.2316761016845703, 5.7815046310424805, 2.497239589691162, 2.994504928588867, 4.397568702697754, 2.887634754180908, 3.5257768630981445, 4.335897445678711, 4.385464191436768, 3.532365083694458, 4.704867362976074, 4.223327159881592, 3.446859359741211, 5.336981296539307, 2.7954823970794678, 2.2941341400146484, 4.566932678222656, 5.650575160980225, 2.936990737915039, 4.116650581359863, 3.8046045303344727, 4.117483139038086, 0.40079981088638306, 3.9255785942077637, 2.0157394409179688, 4.719866752624512, 3.6041665077209473, 5.615561485290527, 4.121918678283691, 4.916096210479736, 4.603349685668945, 1.590528130531311, 3.2454538345336914, 3.285691976547241, 1.1329554319381714, 3.017810106277466, 4.517515182495117, 4.858885765075684, 2.475820541381836, 3.8397085666656494, 4.431361198425293, 5.379176616668701, 4.691040515899658, 2.288033962249756, 4.087619781494141, 2.5171170234680176, 3.0111827850341797, 3.093632698059082, 3.0491983890533447], "mean_td_error": 3.6234450340270996, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1.0, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 1792, "num_env_steps_trained": 258, "num_agent_steps_sampled": 5376, "num_agent_steps_trained": 258, "last_target_update_ts": 1792, "num_target_updates": 1}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5376, "num_agent_steps_trained": 258, "num_env_steps_sampled": 1792, "num_env_steps_trained": 258, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 500.070642015422, "num_env_steps_trained_throughput_per_sec": 143.99355540176214, "timesteps_total": 1792, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 5376, "timers": {"training_iteration_time_ms": 2221.122, "sample_time_ms": 1089.414, "load_time_ms": 0.524, "load_throughput": 492325.037, "learn_time_ms": 90.681, "learn_throughput": 2845.136, "synch_weights_time_ms": 22.551}, "counters": {"num_env_steps_sampled": 1792, "num_env_steps_trained": 258, "num_agent_steps_sampled": 5376, "num_agent_steps_trained": 258, "last_target_update_ts": 1792, "num_target_updates": 1}, "done": false, "episodes_total": 0, "training_iteration": 2, "trial_id": "04288_00000", "date": "2023-11-16_21-56-34", "timestamp": 1700200594, "time_this_iter_s": 1.8059346675872803, "time_total_s": 4.46024751663208, "pid": 46177, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fdea0040280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 4.46024751663208, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 45.63333333333333, "ram_util_percent": 89.66666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.1140718460083, "actor_loss": -4.125389099121094, "critic_loss": 4.976902961730957, "alpha_loss": -0.003034221474081278, "alpha_value": 0.9997000694274902, "log_alpha_value": -0.0002999999560415745, "target_entropy": -6.0, "policy_t": 0.0040551782585680485, "mean_q": 0.016907773911952972, "max_q": 0.023997260257601738, "min_q": 0.01100039854645729}, "td_error": [5.68408203125, 5.382680416107178, 5.587005615234375, 5.122828483581543, 7.200652122497559, 3.435555934906006, 4.870827674865723, 3.333921432495117, 7.587110996246338, 4.239724159240723, 6.342305660247803, 6.194184303283691, 4.789592266082764, 5.8935041427612305, 5.523780822753906, 3.744544506072998, 5.131002426147461, 4.0775146484375, 6.183650493621826, 6.620626449584961, 5.759503364562988, 7.277280807495117, 5.734100341796875, 6.673322677612305, 6.0170488357543945, 7.085977554321289, 4.668216705322266, 6.347202777862549, 5.920042991638184, 6.650606155395508, 5.136390686035156, 6.19282865524292, 4.0027875900268555, 5.561273574829102, 6.964933395385742, 4.826137542724609, 3.855856418609619, 5.810413360595703, 4.886180877685547, 6.840724945068359, 5.848973274230957, 6.286808013916016, 4.679851055145264, 4.463006019592285, 7.33854866027832, 6.071275234222412, 6.3574538230896, 5.723625183105469, 3.697495460510254, 6.426718711853027, 5.569486618041992, 4.640588283538818, 6.858942985534668, 5.538212776184082, 6.326450347900391, 6.258080959320068, 5.224181652069092, 4.5821380615234375, 4.886410713195801, 5.6848907470703125, 5.722363471984863, 4.84963321685791, 6.259249687194824, 4.617478847503662, 5.942133903503418, 5.36463737487793, 5.7676520347595215, 6.385553359985352, 5.141461372375488, 6.485440254211426, 4.95961856842041, 6.751587867736816, 3.2181472778320312, 6.088825702667236, 5.864938735961914, 4.567455291748047, 5.119419097900391, 8.128188133239746, 4.974374771118164, 6.024576187133789, 6.971260070800781, 6.833754062652588, 6.190582275390625, 5.0661940574646, 5.196805953979492, 6.423354148864746], "mean_td_error": 5.634113788604736, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 2.0, "diff_num_grad_updates_vs_sampler_policy": 1.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.018951416015625, "actor_loss": -4.0313849449157715, "critic_loss": 2.9377450942993164, "alpha_loss": -0.003005685517564416, "alpha_value": 0.9997000694274902, "log_alpha_value": -0.00029999998514540493, "target_entropy": -6.0, "policy_t": 0.005457011517137289, "mean_q": 0.016397593542933464, "max_q": 0.020184187218546867, "min_q": 0.013252614066004753}, "td_error": [3.473233699798584, 5.047438621520996, 3.7364234924316406, 4.694148063659668, 1.4914698600769043, 4.002667427062988, 4.352441310882568, 2.3758137226104736, 2.243116617202759, 3.531510591506958, 3.7607998847961426, 5.469045639038086, 3.6146440505981445, 4.009855270385742, 3.8639397621154785, 3.0432863235473633, 3.3072879314422607, 1.628821611404419, 2.9920554161071777, 4.603665828704834, 4.718289375305176, 4.1581926345825195, 3.497753143310547, 4.00493049621582, 4.586021423339844, 3.2569785118103027, 3.15120792388916, 4.974448204040527, 3.984696865081787, 4.578835487365723, 1.807071328163147, 4.797469615936279, 2.25008487701416, 4.345900535583496, 4.60660457611084, 4.505392074584961, 2.891033172607422, 3.126063346862793, 3.2948055267333984, 3.430673122406006, 5.150973320007324, 3.879086971282959, 4.492260932922363, 1.4527289867401123, 4.674192905426025, 3.8298449516296387, 4.2461347579956055, 2.44895601272583, 4.283493995666504, 3.6152071952819824, 1.9425182342529297, 2.6789145469665527, 4.39958381652832, 3.7677931785583496, 4.456778526306152, 2.2844045162200928, 3.5609488487243652, 4.629200458526611, 4.293601036071777, 3.964012622833252, 5.051008701324463, 3.293484926223755, 5.720977783203125, 3.1848678588867188, 4.00798225402832, 2.754851818084717, 3.130558967590332, 4.343790054321289, 3.076132297515869, 2.584120750427246, 3.621281385421753, 2.066065788269043, 1.4073588848114014, 2.330932140350342, 4.105703353881836, 2.197542667388916, 4.190264701843262, 2.502441167831421, 1.8264315128326416, 3.3037006855010986, 3.535083293914795, 3.017153024673462, 3.4542737007141113, 4.551896095275879, 4.236758708953857, 4.791491508483887], "mean_td_error": 3.5993592739105225, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 2.0, "diff_num_grad_updates_vs_sampler_policy": 1.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.977408409118652, "actor_loss": -3.9888689517974854, "critic_loss": 2.5467395782470703, "alpha_loss": -0.002993222326040268, "alpha_value": 0.9997000694274902, "log_alpha_value": -0.00029999998514540493, "target_entropy": -6.0, "policy_t": -0.03468024730682373, "mean_q": 0.019617833197116852, "max_q": 0.02613905631005764, "min_q": 0.01393638551235199}, "td_error": [3.852904796600342, 4.53010368347168, 3.772962808609009, 4.2783355712890625, 3.646486282348633, 1.7757244110107422, 2.9507060050964355, 4.015629768371582, 4.214153289794922, 2.2787671089172363, 6.1866912841796875, 5.286165237426758, 4.566860198974609, 5.418515205383301, 3.2562832832336426, 3.800968647003174, 4.105802536010742, 5.04339599609375, 3.9183340072631836, 3.423318862915039, 2.9227306842803955, 2.174506902694702, 3.9033725261688232, 2.9055285453796387, 2.9753661155700684, 4.74929141998291, 3.912504196166992, 2.161768913269043, 5.676430702209473, 2.0590364933013916, 0.3834432363510132, 4.053648471832275, 3.487879753112793, 4.215953826904297, 3.1214723587036133, 4.592643737792969, 2.7247047424316406, 3.227344036102295, 2.2112913131713867, 4.259232521057129, 3.3976640701293945, 4.684340000152588, 3.7739460468292236, 4.318259239196777, 5.611265182495117, 3.4209396839141846, 3.2046709060668945, 4.140868186950684, 3.1077260971069336, 4.974133491516113, 2.9919450283050537, 2.4446394443511963, 2.5737152099609375, 3.4458422660827637, 2.444077730178833, 2.7265710830688477, 4.608820915222168, 5.163174629211426, 3.1540920734405518, 2.645172595977783, 3.577816963195801, 4.150203704833984, 4.8607563972473145, 4.1405534744262695, 4.271797180175781, 4.432097434997559, 4.309931755065918, 4.320949077606201, 3.9986016750335693, 4.361380577087402, 5.448564529418945, 4.179144859313965, 3.1874327659606934, 5.411311626434326, 4.16457462310791, 2.4310543537139893, 3.6082334518432617, 3.3367903232574463, 2.4422483444213867, 3.481346607208252, 4.535977363586426, 4.016672611236572, 5.147031784057617, 4.163763999938965, 3.671295166015625, 4.437124729156494], "mean_td_error": 3.778590440750122, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 2.0, "diff_num_grad_updates_vs_sampler_policy": 1.0}}, "num_env_steps_sampled": 2688, "num_env_steps_trained": 516, "num_agent_steps_sampled": 8064, "num_agent_steps_trained": 516, "last_target_update_ts": 2688, "num_target_updates": 2}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8064, "num_agent_steps_trained": 516, "num_env_steps_sampled": 2688, "num_env_steps_trained": 516, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 572.3580079101564, "num_env_steps_trained_throughput_per_sec": 164.808444241987, "timesteps_total": 2688, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 8064, "timers": {"training_iteration_time_ms": 2002.552, "sample_time_ms": 1056.289, "load_time_ms": 0.52, "load_throughput": 496617.913, "learn_time_ms": 77.691, "learn_throughput": 3320.85, "synch_weights_time_ms": 18.354}, "counters": {"num_env_steps_sampled": 2688, "num_env_steps_trained": 516, "num_agent_steps_sampled": 8064, "num_agent_steps_trained": 516, "last_target_update_ts": 2688, "num_target_updates": 2}, "done": false, "episodes_total": 0, "training_iteration": 3, "trial_id": "04288_00000", "date": "2023-11-16_21-56-35", "timestamp": 1700200595, "time_this_iter_s": 1.583327054977417, "time_total_s": 6.043574571609497, "pid": 46177, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fdea0040d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 6.043574571609497, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 67.8, "ram_util_percent": 89.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.027772903442383, "actor_loss": -4.051893711090088, "critic_loss": 4.96754264831543, "alpha_loss": -0.006017248146235943, "alpha_value": 0.9994001388549805, "log_alpha_value": -0.0006000582943670452, "target_entropy": -6.0, "policy_t": -0.030775869265198708, "mean_q": 0.030850814655423164, "max_q": 0.04080602526664734, "min_q": 0.02359679341316223}, "td_error": [5.191745758056641, 4.883322715759277, 4.774274826049805, 4.085608005523682, 6.8277201652526855, 5.110663890838623, 4.837821006774902, 5.216010093688965, 5.169689178466797, 7.011725425720215, 7.443432807922363, 4.879246711730957, 4.874272346496582, 5.098034858703613, 5.675886154174805, 5.865713119506836, 5.564258575439453, 3.922734498977661, 4.0873284339904785, 6.115575790405273, 7.871967792510986, 5.309938430786133, 5.888166427612305, 5.707191467285156, 5.0879316329956055, 4.92082405090332, 5.4654388427734375, 4.317170143127441, 7.124161720275879, 3.6248157024383545, 6.788678169250488, 6.263870716094971, 5.791952133178711, 6.295153617858887, 6.455058574676514, 6.7248029708862305, 4.934681415557861, 5.358689308166504, 4.324315547943115, 8.269972801208496, 6.258246421813965, 6.043315410614014, 5.5998311042785645, 5.281296730041504, 3.027444839477539, 4.697967529296875, 5.341177940368652, 4.312836647033691, 7.62941312789917, 6.9877471923828125, 5.508373260498047, 4.168907642364502, 5.383133888244629, 4.226053237915039, 4.275333404541016, 6.406423091888428, 6.535358428955078, 5.797082424163818, 4.92478084564209, 5.660057067871094, 6.072519302368164, 4.931548118591309, 6.548929214477539, 6.66484260559082, 5.090424537658691, 5.470055103302002, 5.640563488006592, 6.379976272583008, 5.15864372253418, 6.132762908935547, 4.788183212280273, 4.555537223815918, 7.519950866699219, 6.670825004577637, 4.657350540161133, 6.095376014709473, 4.863892555236816, 6.896821975708008, 6.434520721435547, 4.983653545379639, 5.296453475952148, 7.664884567260742, 5.953458786010742, 5.555190563201904, 5.234411716461182, 5.412457466125488], "mean_td_error": 5.603463172912598, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 3.0, "diff_num_grad_updates_vs_sampler_policy": 2.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.07558536529541, "actor_loss": -4.1008477210998535, "critic_loss": 3.0154809951782227, "alpha_loss": -0.006045633926987648, "alpha_value": 0.9994001388549805, "log_alpha_value": -0.0006000280845910311, "target_entropy": -6.0, "policy_t": -0.00854665506631136, "mean_q": 0.03351582959294319, "max_q": 0.039253611117601395, "min_q": 0.027724964544177055}, "td_error": [4.776430130004883, 4.916247367858887, 1.6057887077331543, 3.895258665084839, 3.6413562297821045, 4.1859941482543945, 4.1009955406188965, 2.79268217086792, 4.058295249938965, 3.8607349395751953, 3.7155237197875977, 3.1215856075286865, 4.545133590698242, 2.9041733741760254, 3.35434889793396, 2.4893441200256348, 3.425565719604492, 4.574024200439453, 2.639714241027832, 5.471063613891602, 3.0062756538391113, 4.259751319885254, 2.536757469177246, 2.8590781688690186, 3.806363105773926, 2.9999046325683594, 4.397311210632324, 2.9760279655456543, 1.5439766645431519, 5.210164546966553, 2.8968911170959473, 3.861656665802002, 5.565891742706299, 2.8713250160217285, 3.283134937286377, 3.1644105911254883, 5.268524169921875, 5.343552589416504, 4.548308372497559, 4.838187217712402, 4.093894004821777, 3.7470407485961914, 3.6848199367523193, 3.129488945007324, 3.4802122116088867, 4.7616472244262695, 3.804769992828369, 1.4872946739196777, 3.5511932373046875, 3.8146438598632812, 2.7544240951538086, 3.0886030197143555, 1.9750657081604004, 6.027453422546387, 2.6694798469543457, 2.3704535961151123, 2.5167226791381836, 2.4047374725341797, 2.4481630325317383, 3.1754560470581055, 3.9611477851867676, 4.648921966552734, 4.18046236038208, 2.563565254211426, 3.5376758575439453, 3.734896183013916, 2.4391918182373047, 5.564786911010742, 4.3132219314575195, 2.530088424682617, 2.544433832168579, 3.9880785942077637, 4.927545547485352, 2.7349061965942383, 3.475296974182129, 3.9124903678894043, 5.061349868774414, 4.666888236999512, 5.007905006408691, 4.63825798034668, 4.182539939880371, 2.753263473510742, 3.8593573570251465, 3.6445462703704834, 5.584928512573242, 2.876342296600342], "mean_td_error": 3.670109510421753, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 3.0, "diff_num_grad_updates_vs_sampler_policy": 2.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.044118881225586, "actor_loss": -4.066699981689453, "critic_loss": 2.298442840576172, "alpha_loss": -0.006026494782418013, "alpha_value": 0.9994001984596252, "log_alpha_value": -0.0006000022403895855, "target_entropy": -6.0, "policy_t": 0.0012158941244706511, "mean_q": 0.03326231241226196, "max_q": 0.04226140305399895, "min_q": 0.024598948657512665}, "td_error": [3.105242967605591, 5.201630115509033, 3.508612632751465, 2.7227988243103027, 3.3243722915649414, 3.574662208557129, 3.6372928619384766, 4.021472454071045, 3.833141326904297, 4.994500160217285, 2.905761241912842, 3.55332088470459, 3.8940980434417725, 3.1230390071868896, 1.41500723361969, 3.2320241928100586, 3.238323211669922, 4.7200422286987305, 3.2830052375793457, 3.376422882080078, 2.89882755279541, 2.178737163543701, 3.6348495483398438, 3.571521282196045, 4.751713752746582, 6.460555076599121, 4.255273818969727, 2.3344016075134277, 0.5665571093559265, 4.412097454071045, 1.9237459897994995, 1.455670714378357, 2.488328695297241, 4.7556304931640625, 3.9969964027404785, 5.13316535949707, 3.45306134223938, 4.709830284118652, 3.477956771850586, 3.595737934112549, 1.8501200675964355, 2.621061325073242, 1.599250316619873, 3.4580416679382324, 5.117877960205078, 3.7759265899658203, 3.5943081378936768, 3.9537315368652344, 4.585977554321289, 3.928804397583008, 2.2789511680603027, 4.380292892456055, 3.663958787918091, 2.892214775085449, 2.9374632835388184, 3.419534206390381, 4.003667831420898, 2.1872801780700684, 3.4221439361572266, 2.0414273738861084, 3.6516342163085938, 3.447810411453247, 4.441450119018555, 3.465405225753784, 2.6112051010131836, 1.858690619468689, 3.0890464782714844, 5.825869560241699, 3.6195764541625977, 4.066134452819824, 4.389042854309082, 2.976296901702881, 4.818877220153809, 2.1224098205566406, 2.095700979232788, 6.4222211837768555, 4.1494832038879395, 4.227099418640137, 4.0370354652404785, 3.4378907680511475, 2.425318479537964, 1.7539267539978027, 3.4155216217041016, 4.453094959259033, 1.6432310342788696, 4.215951919555664], "mean_td_error": 3.477806568145752, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 3.0, "diff_num_grad_updates_vs_sampler_policy": 2.0}}, "num_env_steps_sampled": 3584, "num_env_steps_trained": 774, "num_agent_steps_sampled": 10752, "num_agent_steps_trained": 774, "last_target_update_ts": 3584, "num_target_updates": 3}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10752, "num_agent_steps_trained": 774, "num_env_steps_sampled": 3584, "num_env_steps_trained": 774, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 536.3039620972115, "num_env_steps_trained_throughput_per_sec": 154.42681051459886, "timesteps_total": 3584, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 10752, "timers": {"training_iteration_time_ms": 1919.565, "sample_time_ms": 1068.814, "load_time_ms": 0.519, "load_throughput": 496769.9, "learn_time_ms": 73.904, "learn_throughput": 3490.999, "synch_weights_time_ms": 17.095}, "counters": {"num_env_steps_sampled": 3584, "num_env_steps_trained": 774, "num_agent_steps_sampled": 10752, "num_agent_steps_trained": 774, "last_target_update_ts": 3584, "num_target_updates": 3}, "done": false, "episodes_total": 0, "training_iteration": 4, "trial_id": "04288_00000", "date": "2023-11-16_21-56-37", "timestamp": 1700200597, "time_this_iter_s": 1.6883039474487305, "time_total_s": 7.7318785190582275, "pid": 46177, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fded86a29d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 7.7318785190582275, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 54.13333333333333, "ram_util_percent": 89.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.012594223022461, "actor_loss": -4.0492682456970215, "critic_loss": 4.902416229248047, "alpha_loss": -0.00901177991181612, "alpha_value": 0.999100387096405, "log_alpha_value": -0.0009000444551929832, "target_entropy": -6.0, "policy_t": -0.012281998060643673, "mean_q": 0.045639000833034515, "max_q": 0.0584976002573967, "min_q": 0.03321186825633049}, "td_error": [4.058602333068848, 8.14964485168457, 3.8098485469818115, 3.7436423301696777, 7.190281867980957, 6.148280143737793, 4.7790913581848145, 6.009381294250488, 6.60610294342041, 5.171090126037598, 6.173539638519287, 4.820035934448242, 5.665491104125977, 4.841656684875488, 5.01826286315918, 4.808187484741211, 6.100709438323975, 6.670022487640381, 6.007691860198975, 4.608097076416016, 5.767784118652344, 5.380554676055908, 5.059861183166504, 4.378249168395996, 8.04593563079834, 7.59933614730835, 5.72972297668457, 6.913143157958984, 3.5153024196624756, 4.1454010009765625, 4.406843185424805, 6.277896881103516, 5.01807165145874, 9.011348724365234, 4.375727653503418, 7.179840087890625, 5.47291374206543, 5.756714820861816, 6.329611778259277, 5.149190902709961, 5.173554420471191, 5.9632463455200195, 5.990331172943115, 2.100335121154785, 7.2791924476623535, 4.573625564575195, 5.506075859069824, 7.497084617614746, 5.025252819061279, 8.056082725524902, 5.183810710906982, 5.581600189208984, 4.192505836486816, 7.433140754699707, 6.610135555267334, 6.8009843826293945, 6.184741020202637, 4.830188751220703, 3.766761302947998, 8.356273651123047, 6.98733377456665, 4.347605228424072, 6.36827278137207, 7.133008003234863, 5.368088245391846, 6.232032775878906, 5.314888000488281, 6.278968334197998, 7.409510612487793, 2.8930673599243164, 5.342947959899902, 6.976221084594727, 5.2898969650268555, 5.974221229553223, 4.602109909057617, 6.5192670822143555, 5.431772232055664, 4.299459934234619, 6.199318885803223, 5.650578498840332, 4.182287693023682, 5.111479759216309, 4.29326057434082, 6.151864051818848, 5.977018356323242, 5.747795104980469], "mean_td_error": 5.675352573394775, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 4.0, "diff_num_grad_updates_vs_sampler_policy": 3.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.117444038391113, "actor_loss": -4.156052589416504, "critic_loss": 3.1623475551605225, "alpha_loss": -0.009106943383812904, "alpha_value": 0.9991002678871155, "log_alpha_value": -0.0009001230355352163, "target_entropy": -6.0, "policy_t": 0.0373879112303257, "mean_q": 0.05169231444597244, "max_q": 0.060546912252902985, "min_q": 0.04407045617699623}, "td_error": [3.5560271739959717, 3.342017650604248, 4.5370683670043945, 2.7247133255004883, 0.6350494027137756, 2.1014909744262695, 3.2074472904205322, 2.749403715133667, 1.9787579774856567, 2.464547634124756, 3.8465728759765625, 3.4343643188476562, 3.798689842224121, 4.562878608703613, 4.906715393066406, 4.987186431884766, 4.935366630554199, 6.049734115600586, 4.075310230255127, 4.002357482910156, 3.8463101387023926, 4.634650707244873, 5.505293369293213, 4.053204536437988, 5.520900726318359, 3.575221300125122, 5.2672295570373535, 4.156905174255371, 2.6588306427001953, 4.399872779846191, 4.244566917419434, 6.157183647155762, 2.8626351356506348, 4.181421279907227, 3.0648553371429443, 4.974281311035156, 4.905190467834473, 4.002111911773682, 2.7460949420928955, 1.6209731101989746, 1.6413466930389404, 4.240522384643555, 3.2090861797332764, 4.05439567565918, 2.4841361045837402, 2.9734833240509033, 4.931885719299316, 5.19236946105957, 4.410978317260742, 5.428729057312012, 4.007142066955566, 3.483105182647705, 3.5779409408569336, 3.38157320022583, 4.761573314666748, 3.818650245666504, 4.600828170776367, 3.698064088821411, 4.351751327514648, 2.4740941524505615, 5.066684722900391, 3.935643196105957, 3.917163848876953, 3.2659809589385986, 3.2630090713500977, 4.104983329772949, 2.453164577484131, 2.6924917697906494, 3.6714820861816406, 4.955137252807617, 4.39921760559082, 5.91558837890625, 4.248263835906982, 4.202930450439453, 4.223923683166504, 4.1155009269714355, 3.542909622192383, 4.729951858520508, 2.8113856315612793, 3.7684192657470703, 2.5465774536132812, 4.179394721984863, 3.9772391319274902, 3.3925938606262207, 3.32698130607605, 2.371021270751953], "mean_td_error": 3.838054895401001, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 4.0, "diff_num_grad_updates_vs_sampler_policy": 3.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.075366973876953, "actor_loss": -4.110960483551025, "critic_loss": 2.311251640319824, "alpha_loss": -0.009068580344319344, "alpha_value": 0.9991003274917603, "log_alpha_value": -0.0009000743739306927, "target_entropy": -6.0, "policy_t": -0.03796584531664848, "mean_q": 0.047033537179231644, "max_q": 0.06560558825731277, "min_q": 0.0346975177526474}, "td_error": [2.404000997543335, 4.633633613586426, 2.8284168243408203, 4.202874183654785, 2.686206340789795, 3.946565628051758, 3.313136100769043, 5.103139877319336, 2.908547878265381, 2.2645530700683594, 3.6627931594848633, 3.187791347503662, 3.8187365531921387, 3.4782533645629883, 3.7353627681732178, 3.273747444152832, 2.792656898498535, 2.8148293495178223, 3.2106595039367676, 3.959106683731079, 2.8969717025756836, 4.612404823303223, 2.5729308128356934, 3.5950589179992676, 3.7417168617248535, 2.2437987327575684, 5.725580215454102, 2.8996105194091797, 2.265253782272339, 2.0305633544921875, 2.9623730182647705, 3.7113537788391113, 4.096663951873779, 2.961331844329834, 4.069360733032227, 4.108369827270508, 3.0679469108581543, 4.527836799621582, 2.9721031188964844, 3.122685432434082, 3.3360772132873535, 2.9310123920440674, 5.103242874145508, 3.0452303886413574, 3.98123836517334, 2.5106141567230225, 2.4357681274414062, 4.598543167114258, 3.936788558959961, 1.6362035274505615, 4.306624889373779, 5.668242454528809, 3.6787519454956055, 3.567439556121826, 2.334216356277466, 4.110321998596191, 2.126054286956787, 2.9865059852600098, 1.9071569442749023, 3.850315809249878, 3.0348916053771973, 4.575507164001465, 4.460391998291016, 4.647314071655273, 3.879209041595459, 4.966479778289795, 4.287058353424072, 4.248434543609619, 5.2224812507629395, 6.90138053894043, 3.3840088844299316, 4.611855506896973, 2.930898904800415, 2.5344526767730713, 2.1373202800750732, 5.226466655731201, 1.5551048517227173, 1.9842157363891602, 2.0536975860595703, 2.415469169616699, 4.832772254943848, 3.6396327018737793, 4.029167175292969, 2.814394474029541, 5.282623291015625, 4.135882377624512], "mean_td_error": 3.537795066833496, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 4.0, "diff_num_grad_updates_vs_sampler_policy": 3.0}}, "num_env_steps_sampled": 4480, "num_env_steps_trained": 1032, "num_agent_steps_sampled": 13440, "num_agent_steps_trained": 1032, "last_target_update_ts": 4480, "num_target_updates": 4}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13440, "num_agent_steps_trained": 1032, "num_env_steps_sampled": 4480, "num_env_steps_trained": 1032, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 556.886362531726, "num_env_steps_trained_throughput_per_sec": 160.35343921114432, "timesteps_total": 4480, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 13440, "timers": {"training_iteration_time_ms": 1857.429, "sample_time_ms": 1061.786, "load_time_ms": 0.522, "load_throughput": 494010.697, "learn_time_ms": 71.818, "learn_throughput": 3592.438, "synch_weights_time_ms": 16.709}, "counters": {"num_env_steps_sampled": 4480, "num_env_steps_trained": 1032, "num_agent_steps_sampled": 13440, "num_agent_steps_trained": 1032, "last_target_update_ts": 4480, "num_target_updates": 4}, "done": false, "episodes_total": 0, "training_iteration": 5, "trial_id": "04288_00000", "date": "2023-11-16_21-56-39", "timestamp": 1700200599, "time_this_iter_s": 1.6240792274475098, "time_total_s": 9.355957746505737, "pid": 46177, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fdea00400d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 9.355957746505737, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 69.5, "ram_util_percent": 89.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.05446720123291, "actor_loss": -4.103942394256592, "critic_loss": 4.851936340332031, "alpha_loss": -0.01206513587385416, "alpha_value": 0.9988007545471191, "log_alpha_value": -0.0011999777052551508, "target_entropy": -6.0, "policy_t": 0.015557452104985714, "mean_q": 0.06145992875099182, "max_q": 0.07625870406627655, "min_q": 0.049497947096824646}, "td_error": [6.780550003051758, 5.630634307861328, 4.541008949279785, 6.209621429443359, 6.951851844787598, 5.207000255584717, 3.7791991233825684, 6.1712727546691895, 5.4404401779174805, 4.69620418548584, 6.8447442054748535, 4.323936462402344, 3.3305816650390625, 7.253704071044922, 8.282052993774414, 5.582228660583496, 4.250516891479492, 6.4990434646606445, 5.986867904663086, 5.071104049682617, 6.033207893371582, 3.9122166633605957, 6.713893413543701, 5.591729164123535, 6.503666400909424, 4.697237014770508, 3.9332573413848877, 5.153908729553223, 4.872344493865967, 4.700710773468018, 7.646380424499512, 6.996826171875, 4.980422019958496, 6.362763404846191, 6.808842182159424, 6.079032897949219, 4.768105506896973, 7.542383670806885, 6.132930755615234, 4.291500091552734, 6.854968070983887, 6.095538139343262, 4.727360248565674, 5.950934410095215, 4.361937999725342, 5.421210765838623, 4.161382675170898, 6.008150577545166, 7.636241912841797, 6.59057092666626, 4.607034683227539, 4.415587425231934, 3.9709267616271973, 5.175177574157715, 5.640217304229736, 4.982665061950684, 4.60964298248291, 4.410811424255371, 6.129812240600586, 4.137317657470703, 4.77432918548584, 6.386883735656738, 6.644128799438477, 3.6193222999572754, 4.391027450561523, 4.550838470458984, 6.17674446105957, 6.533056259155273, 6.547247409820557, 5.060835838317871, 7.790656089782715, 5.742143630981445, 4.374076843261719, 5.390020370483398, 6.281583786010742, 6.511373519897461, 5.385796546936035, 6.996321678161621, 5.3401031494140625, 4.980220317840576, 6.928132057189941, 7.50282621383667, 7.207843780517578, 4.6800127029418945, 8.217957496643066, 3.9326770305633545], "mean_td_error": 5.632413864135742, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 5.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.933165550231934, "actor_loss": -3.9868454933166504, "critic_loss": 2.5747873783111572, "alpha_loss": -0.011922764591872692, "alpha_value": 0.9988003969192505, "log_alpha_value": -0.001200298429466784, "target_entropy": -6.0, "policy_t": -0.0691174641251564, "mean_q": 0.07065187394618988, "max_q": 0.08399927616119385, "min_q": 0.06041396036744118}, "td_error": [3.192021369934082, 4.1775360107421875, 1.7795219421386719, 4.614100456237793, 2.596930503845215, 2.1362357139587402, 1.401294231414795, 3.0574235916137695, 3.5197486877441406, 3.443462371826172, 2.5877513885498047, 4.8411664962768555, 3.757936954498291, 3.2613308429718018, 1.3169314861297607, 6.383636951446533, 3.9964613914489746, 3.1922645568847656, 4.0014166831970215, 4.8443603515625, 5.11388635635376, 3.6150364875793457, 2.727649211883545, 4.651151657104492, 2.425361156463623, 3.3409314155578613, 2.912951707839966, 3.8001599311828613, 3.088958501815796, 3.7466485500335693, 2.311873197555542, 4.579657554626465, 4.620691776275635, 3.188025951385498, 3.2726762294769287, 4.758988380432129, 3.8625917434692383, 3.576519012451172, 3.3956093788146973, 3.5587542057037354, 3.994696617126465, 4.115875244140625, 3.6849923133850098, 3.695758819580078, 3.2925453186035156, 2.743044376373291, 3.152153968811035, 3.039937973022461, 3.002932071685791, 3.928767204284668, 4.024030685424805, 2.81361722946167, 3.3509163856506348, 2.781369686126709, 3.134737253189087, 3.9827380180358887, 5.173515796661377, 5.172793388366699, 3.521143913269043, 2.268904447555542, 3.4762520790100098, 2.110354423522949, 5.154064178466797, 3.411306381225586, 2.809908390045166, 2.740780830383301, 2.648207187652588, 3.0439095497131348, 4.2030534744262695, 2.710117816925049, 5.232296943664551, 2.3242714405059814, 3.0221564769744873, 3.4123306274414062, 4.39387321472168, 4.143331050872803, 3.787254810333252, 1.4054956436157227, 2.7037012577056885, 3.03361177444458, 3.6800477504730225, 2.31453800201416, 2.2552342414855957, 2.2175683975219727, 5.414590835571289, 1.769970178604126], "mean_td_error": 3.4295623302459717, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 5.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.066816329956055, "actor_loss": -4.1132941246032715, "critic_loss": 2.3948941230773926, "alpha_loss": -0.012082358822226524, "alpha_value": 0.99880051612854, "log_alpha_value": -0.0012002164730802178, "target_entropy": -6.0, "policy_t": -0.01986437849700451, "mean_q": 0.06276179105043411, "max_q": 0.08094216883182526, "min_q": 0.04824772849678993}, "td_error": [3.496222496032715, 2.3071131706237793, 5.159955978393555, 3.2483468055725098, 3.7552132606506348, 4.8270769119262695, 3.738387107849121, 3.631331443786621, 0.4708321690559387, 3.9323134422302246, 4.21956205368042, 5.101463317871094, 3.2949600219726562, 2.3623528480529785, 3.1115593910217285, 3.909351348876953, 2.529120445251465, 4.049655914306641, 4.466020584106445, 4.731869697570801, 2.6616570949554443, 2.555713653564453, 3.9790825843811035, 4.34645414352417, 3.446460723876953, 4.146036148071289, 3.0884556770324707, 3.3184220790863037, 3.293583631515503, 3.8909335136413574, 4.245154857635498, 4.073054313659668, 3.56242036819458, 2.502655029296875, 3.930971145629883, 4.860070705413818, 2.004356861114502, 2.812253952026367, 1.6606707572937012, 4.847070693969727, 4.603725433349609, 3.3956351280212402, 3.4112792015075684, 4.88677978515625, 2.55730938911438, 5.440429210662842, 5.281460762023926, 3.0925967693328857, 4.050760746002197, 3.5576062202453613, 1.9717469215393066, 4.638444900512695, 3.9860000610351562, 3.1567842960357666, 4.361745834350586, 5.883889198303223, 3.826840400695801, 2.850804328918457, 4.595091819763184, 3.780604839324951, 4.119245529174805, 4.904900550842285, 1.6067215204238892, 3.3146402835845947, 3.1454756259918213, 2.8669447898864746, 6.886555194854736, 3.9610707759857178, 4.726083278656006, 4.752741813659668, 3.068665027618408, 3.0806522369384766, 2.2859039306640625, 4.215536117553711, 3.6844139099121094, 3.040879964828491, 3.730879545211792, 2.800597906112671, 1.6167619228363037, 3.592703342437744, 2.4294934272766113, 3.9942049980163574, 2.826460361480713, 3.4935765266418457, 3.837329387664795, 1.8129323720932007], "mean_td_error": 3.6127099990844727, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 5.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 5376, "num_env_steps_trained": 1290, "num_agent_steps_sampled": 16128, "num_agent_steps_trained": 1290, "last_target_update_ts": 5376, "num_target_updates": 5}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16128, "num_agent_steps_trained": 1290, "num_env_steps_sampled": 5376, "num_env_steps_trained": 1290, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 495.1094224363396, "num_env_steps_trained_throughput_per_sec": 142.56498994260673, "timesteps_total": 5376, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 16128, "timers": {"training_iteration_time_ms": 1849.465, "sample_time_ms": 1057.291, "load_time_ms": 0.527, "load_throughput": 489341.789, "learn_time_ms": 70.319, "learn_throughput": 3669.015, "synch_weights_time_ms": 16.594}, "counters": {"num_env_steps_sampled": 5376, "num_env_steps_trained": 1290, "num_agent_steps_sampled": 16128, "num_agent_steps_trained": 1290, "last_target_update_ts": 5376, "num_target_updates": 5}, "done": false, "episodes_total": 0, "training_iteration": 6, "trial_id": "04288_00000", "date": "2023-11-16_21-56-40", "timestamp": 1700200600, "time_this_iter_s": 1.8230931758880615, "time_total_s": 11.179050922393799, "pid": 46177, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fdea00408b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 11.179050922393799, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 52.26666666666667, "ram_util_percent": 89.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.00588321685791, "actor_loss": -4.070862293243408, "critic_loss": 4.628190517425537, "alpha_loss": -0.015008185990154743, "alpha_value": 0.998501181602478, "log_alpha_value": -0.001499936101026833, "target_entropy": -6.0, "policy_t": 0.036667708307504654, "mean_q": 0.07681235671043396, "max_q": 0.09339835494756699, "min_q": 0.059606004506349564}, "td_error": [5.371436595916748, 6.185976028442383, 6.436269760131836, 5.055261135101318, 6.079787254333496, 5.9947428703308105, 4.815298080444336, 5.59699821472168, 3.3886327743530273, 5.549388885498047, 4.714694023132324, 4.767696380615234, 7.4888997077941895, 4.40471076965332, 5.156558990478516, 6.777549743652344, 3.7895052433013916, 5.1402482986450195, 7.301372051239014, 5.291897773742676, 4.399684906005859, 5.717999458312988, 5.498030662536621, 5.788110733032227, 5.185297966003418, 5.054200172424316, 5.924529552459717, 6.288493633270264, 3.5322670936584473, 5.551191329956055, 5.39097261428833, 5.717450141906738, 2.2918715476989746, 4.125025749206543, 4.499632358551025, 5.917580604553223, 4.879524230957031, 4.967613220214844, 4.778314590454102, 6.000236511230469, 7.184867858886719, 4.906754493713379, 7.2965087890625, 7.855771064758301, 6.7167558670043945, 6.786266326904297, 5.940831184387207, 5.953568458557129, 4.226032257080078, 6.136021137237549, 4.510924816131592, 6.170228004455566, 4.377433776855469, 5.778165817260742, 5.910982131958008, 5.09559440612793, 6.663949966430664, 4.9983930587768555, 5.683677673339844, 7.3249006271362305, 4.3352861404418945, 6.926234245300293, 6.359858512878418, 6.063340187072754, 4.102874279022217, 3.8896377086639404, 5.0448455810546875, 3.902515172958374, 5.693490982055664, 7.433932304382324, 5.560357093811035, 3.3765978813171387, 5.660059928894043, 5.546438217163086, 5.467761993408203, 4.176090240478516, 5.1486592292785645, 4.768860816955566, 5.44537353515625, 5.6247782707214355, 6.644009113311768, 4.500158309936523, 3.9513959884643555, 5.812752723693848, 4.6088361740112305, 6.516605854034424], "mean_td_error": 5.42899227142334, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 6.0, "diff_num_grad_updates_vs_sampler_policy": 5.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.149435997009277, "actor_loss": -4.214826583862305, "critic_loss": 2.658494710922241, "alpha_loss": -0.01522696390748024, "alpha_value": 0.9985008239746094, "log_alpha_value": -0.0015002766158431768, "target_entropy": -6.0, "policy_t": 0.009359735995531082, "mean_q": 0.09133882075548172, "max_q": 0.108571358025074, "min_q": 0.07798102498054504}, "td_error": [4.823357582092285, 1.1047776937484741, 4.734988212585449, 3.7539424896240234, 3.5229783058166504, 2.3577542304992676, 2.9097704887390137, 4.163761615753174, 5.990495681762695, 2.3740479946136475, 4.322595596313477, 3.1240074634552, 3.0536255836486816, 2.5026533603668213, 2.7966811656951904, 3.394564628601074, 2.8698513507843018, 1.694823980331421, 3.3528194427490234, 5.013422012329102, 3.075301170349121, 3.6919045448303223, 2.039649248123169, 4.295644760131836, 5.085320472717285, 3.8636417388916016, 4.899023056030273, 3.7756991386413574, 4.431469440460205, 2.674304962158203, 3.2557268142700195, 2.5143985748291016, 3.79951810836792, 2.87941312789917, 3.426846742630005, 3.2197530269622803, 5.105068206787109, 3.885507106781006, 3.1559083461761475, 3.8528332710266113, 2.4045443534851074, 4.367786407470703, 5.317526817321777, 4.411773204803467, 3.743481159210205, 1.176896333694458, 4.1157331466674805, 2.2248923778533936, 2.5959620475769043, 4.3240461349487305, 1.3282461166381836, 2.57731294631958, 3.4523420333862305, 4.5728912353515625, 4.504549980163574, 5.048551559448242, 4.738909721374512, 4.172514915466309, 2.3250136375427246, 2.487377643585205, 3.0270862579345703, 2.184394359588623, 3.048022508621216, 3.559577703475952, 3.5335025787353516, 2.1968612670898438, 4.190461158752441, 4.124503135681152, 2.701455593109131, 3.8951873779296875, 3.027590274810791, 1.4861751794815063, 3.278240203857422, 6.094425201416016, 4.181178092956543, 3.1643853187561035, 3.581061840057373, 4.2051286697387695, 3.1710968017578125, 4.074457168579102, 3.4276013374328613, 4.538917541503906, 4.78099250793457, 3.2474937438964844, 2.9438235759735107, 3.8437395095825195], "mean_td_error": 3.5137858390808105, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 6.0, "diff_num_grad_updates_vs_sampler_policy": 5.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.05251407623291, "actor_loss": -4.113404750823975, "critic_loss": 2.3150691986083984, "alpha_loss": -0.01508266106247902, "alpha_value": 0.9985007643699646, "log_alpha_value": -0.0015003870939835906, "target_entropy": -6.0, "policy_t": 0.01342053897678852, "mean_q": 0.07895632833242416, "max_q": 0.11154575645923615, "min_q": 0.06106392294168472}, "td_error": [2.6629390716552734, 4.001777648925781, 1.8440589904785156, 3.8238654136657715, 2.14703631401062, 4.591551780700684, 3.041825771331787, 3.284147262573242, 4.503420829772949, 1.8110439777374268, 4.546533584594727, 2.603193998336792, 4.688855171203613, 3.565993547439575, 3.294631004333496, 4.878817558288574, 4.368466854095459, 4.480302810668945, 2.4497408866882324, 3.7300634384155273, 2.373704671859741, 3.695690631866455, 3.337557792663574, 2.469482898712158, 5.626700401306152, 4.930168628692627, 2.5762791633605957, 2.9491770267486572, 3.0750503540039062, 3.998415946960449, 3.6937575340270996, 1.5979602336883545, 4.221770286560059, 3.86879825592041, 3.8900296688079834, 4.326111793518066, 3.0584449768066406, 2.9034621715545654, 3.4835312366485596, 4.373250484466553, 4.771951675415039, 3.4853458404541016, 2.974212169647217, 2.707416534423828, 4.487797737121582, 2.7802107334136963, 4.535209655761719, 4.466193199157715, 3.0440893173217773, 4.5592193603515625, 3.6236703395843506, 3.5201311111450195, 4.404841423034668, 2.197477102279663, 2.390138626098633, 2.94500994682312, 2.0986876487731934, 2.0099639892578125, 4.810899257659912, 3.529550552368164, 3.3976123332977295, 4.836165904998779, 3.3919782638549805, 5.032186508178711, 2.8833603858947754, 1.2179741859436035, 5.898277282714844, 1.7866833209991455, 3.325880527496338, 4.526888847351074, 3.173105478286743, 2.40386962890625, 1.801600694656372, 4.377174377441406, 3.2693986892700195, 3.4208428859710693, 4.410602569580078, 4.3652544021606445, 3.1645798683166504, 4.315518379211426, 4.747198104858398, 3.4634592533111572, 4.437445640563965, 1.83396577835083, 4.205607891082764, 5.174600601196289], "mean_td_error": 3.546173095703125, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 6.0, "diff_num_grad_updates_vs_sampler_policy": 5.0}}, "num_env_steps_sampled": 6272, "num_env_steps_trained": 1548, "num_agent_steps_sampled": 18816, "num_agent_steps_trained": 1548, "last_target_update_ts": 6272, "num_target_updates": 6}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18816, "num_agent_steps_trained": 1548, "num_env_steps_sampled": 6272, "num_env_steps_trained": 1548, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 555.3489585626909, "num_env_steps_trained_throughput_per_sec": 159.91074922898912, "timesteps_total": 6272, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 18816, "timers": {"training_iteration_time_ms": 1815.738, "sample_time_ms": 1055.057, "load_time_ms": 0.532, "load_throughput": 485260.283, "learn_time_ms": 69.299, "learn_throughput": 3722.971, "synch_weights_time_ms": 16.304}, "counters": {"num_env_steps_sampled": 6272, "num_env_steps_trained": 1548, "num_agent_steps_sampled": 18816, "num_agent_steps_trained": 1548, "last_target_update_ts": 6272, "num_target_updates": 6}, "done": false, "episodes_total": 0, "training_iteration": 7, "trial_id": "04288_00000", "date": "2023-11-16_21-56-42", "timestamp": 1700200602, "time_this_iter_s": 1.6296987533569336, "time_total_s": 12.808749675750732, "pid": 46177, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fded86a29d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 12.808749675750732, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 68.4, "ram_util_percent": 89.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.06201171875, "actor_loss": -4.140538692474365, "critic_loss": 4.853714466094971, "alpha_loss": -0.018110044300556183, "alpha_value": 0.9982017874717712, "log_alpha_value": -0.0017998431576415896, "target_entropy": -6.0, "policy_t": -0.007711680140346289, "mean_q": 0.0947592630982399, "max_q": 0.11873697489500046, "min_q": 0.07396396994590759}, "td_error": [7.36299991607666, 6.026532173156738, 5.926357269287109, 5.951498508453369, 4.789327621459961, 6.332862854003906, 5.643708229064941, 5.483497619628906, 5.210912704467773, 7.346592903137207, 4.200318813323975, 4.8549604415893555, 4.487076759338379, 6.011274814605713, 6.335705757141113, 3.388007402420044, 5.612053871154785, 7.069877624511719, 5.086404800415039, 6.202846527099609, 3.3647890090942383, 6.264745712280273, 5.947606086730957, 3.543642044067383, 6.523906707763672, 6.235971927642822, 5.261221408843994, 6.45379638671875, 6.704054355621338, 5.992977619171143, 3.877102851867676, 7.405406951904297, 6.901097297668457, 6.243080139160156, 6.341909408569336, 6.261689186096191, 7.2617411613464355, 7.517134189605713, 4.736977577209473, 4.285455703735352, 6.002651691436768, 7.188634395599365, 3.4648234844207764, 6.767452239990234, 5.165116310119629, 3.887995481491089, 4.862941741943359, 5.136707782745361, 4.386743068695068, 5.039859771728516, 4.086389541625977, 4.5398454666137695, 5.41594934463501, 3.9879605770111084, 4.867432594299316, 5.702754974365234, 4.041442394256592, 5.308147430419922, 5.498143196105957, 5.058648109436035, 3.6232714653015137, 5.592708110809326, 5.7019758224487305, 6.5406904220581055, 4.086215496063232, 7.278261184692383, 4.489161968231201, 7.7357988357543945, 6.388741493225098, 4.661615371704102, 5.526797294616699, 6.346573829650879, 5.075268745422363, 6.782480239868164, 4.958886623382568, 4.625665664672852, 6.841501712799072, 7.057541370391846, 4.798266887664795, 4.283207893371582, 6.536463260650635, 4.035822868347168, 5.910628318786621, 6.108311653137207, 6.503687858581543, 6.897309303283691], "mean_td_error": 5.572600364685059, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 7.0, "diff_num_grad_updates_vs_sampler_policy": 6.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.127456665039062, "actor_loss": -4.2110915184021, "critic_loss": 2.806661367416382, "alpha_loss": -0.018233751878142357, "alpha_value": 0.9982011914253235, "log_alpha_value": -0.001800427446141839, "target_entropy": -6.0, "policy_t": 0.008759334683418274, "mean_q": 0.11455517262220383, "max_q": 0.13613879680633545, "min_q": 0.09528151899576187}, "td_error": [1.1258814334869385, 4.150030136108398, 1.6984801292419434, 3.687955617904663, 2.425816059112549, 1.4969139099121094, 3.2706198692321777, 2.6873745918273926, 4.096346378326416, 6.411203861236572, 2.604271173477173, 5.756089210510254, 4.44840145111084, 4.043079376220703, 3.252959728240967, 3.194828510284424, 3.6970174312591553, 4.7324419021606445, 4.287320137023926, 3.0039525032043457, 3.2455480098724365, 4.266802787780762, 3.428623676300049, 4.707947731018066, 3.2646470069885254, 5.084280490875244, 3.3218679428100586, 3.962597131729126, 3.832667827606201, 3.7248635292053223, 3.303838014602661, 5.2096710205078125, 5.339616775512695, 4.401945114135742, 3.8147952556610107, 3.8400204181671143, 2.4326248168945312, 4.179034233093262, 4.300616264343262, 4.100975513458252, 4.030202388763428, 4.686800956726074, 5.211888313293457, 4.813562393188477, 4.6305341720581055, 3.376631021499634, 2.749228000640869, 2.879136800765991, 3.9832005500793457, 3.167234182357788, 3.8427915573120117, 4.962871551513672, 4.438135147094727, 3.2630162239074707, 1.669351577758789, 3.809478759765625, 3.4924283027648926, 3.9394092559814453, 3.3370468616485596, 2.7535858154296875, 2.4523277282714844, 4.493568420410156, 3.5592658519744873, 3.7582430839538574, 3.0228962898254395, 3.4840919971466064, 3.171119213104248, 4.745603561401367, 3.2224037647247314, 3.564434051513672, 2.97404408454895, 2.6990506649017334, 5.026983737945557, 3.8517792224884033, 5.037280082702637, 4.357109546661377, 3.765655755996704, 3.144256830215454, 3.824620485305786, 2.9929490089416504, 5.254995346069336, 5.408987998962402, 3.428856372833252, 1.6333110332489014, 4.365540027618408, 3.3342676162719727], "mean_td_error": 3.737722635269165, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 7.0, "diff_num_grad_updates_vs_sampler_policy": 6.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.117405891418457, "actor_loss": -4.192758560180664, "critic_loss": 2.34065580368042, "alpha_loss": -0.018216948956251144, "alpha_value": 0.9982010722160339, "log_alpha_value": -0.0018005553865805268, "target_entropy": -6.0, "policy_t": -0.03101523034274578, "mean_q": 0.0962245985865593, "max_q": 0.12704531848430634, "min_q": 0.07552796602249146}, "td_error": [2.920698404312134, 2.139971971511841, 1.6277903318405151, 2.7003824710845947, 2.5549263954162598, 3.1465327739715576, 3.017911195755005, 4.0210466384887695, 3.3893117904663086, 3.9504234790802, 3.7329633235931396, 3.882338047027588, 5.583990573883057, 2.4607300758361816, 4.415796279907227, 3.928905963897705, 3.4923667907714844, 2.3759140968322754, 3.062356472015381, 2.075713634490967, 4.745762825012207, 3.526949405670166, 3.636259078979492, 4.881072998046875, 2.437169075012207, 3.4128878116607666, 3.3369836807250977, 3.189920425415039, 2.795773506164551, 3.968843698501587, 2.92388653755188, 3.5277230739593506, 2.691828966140747, 4.280951976776123, 2.3353726863861084, 2.856168746948242, 3.780508279800415, 6.0136518478393555, 3.8212244510650635, 3.881499767303467, 4.153936386108398, 4.232679843902588, 2.192523241043091, 4.281222343444824, 2.711243152618408, 2.736271381378174, 3.740391254425049, 3.7792162895202637, 5.023509979248047, 4.070934295654297, 4.053102016448975, 2.397578239440918, 2.9247608184814453, 4.351177215576172, 5.104948043823242, 3.5244290828704834, 3.7900147438049316, 3.5392417907714844, 3.791992664337158, 5.473489761352539, 2.823554039001465, 0.7516592144966125, 3.200683832168579, 1.9063348770141602, 3.6925597190856934, 4.6986565589904785, 3.9720749855041504, 3.4785261154174805, 3.5652313232421875, 4.559231758117676, 4.175334930419922, 2.825869083404541, 2.366267681121826, 4.143155574798584, 4.785564422607422, 4.185747146606445, 2.046854019165039, 3.826648712158203, 3.4089860916137695, 4.363303184509277, 6.154827117919922, 3.4607622623443604, 3.313438892364502, 4.505621433258057, 3.783360004425049, 3.7524218559265137], "mean_td_error": 3.559812307357788, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 7.0, "diff_num_grad_updates_vs_sampler_policy": 6.0}}, "num_env_steps_sampled": 7168, "num_env_steps_trained": 1806, "num_agent_steps_sampled": 21504, "num_agent_steps_trained": 1806, "last_target_update_ts": 7168, "num_target_updates": 7}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 21504, "num_agent_steps_trained": 1806, "num_env_steps_sampled": 7168, "num_env_steps_trained": 1806, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 555.9112700797086, "num_env_steps_trained_throughput_per_sec": 160.07266482205895, "timesteps_total": 7168, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 21504, "timers": {"training_iteration_time_ms": 1790.232, "sample_time_ms": 1053.841, "load_time_ms": 0.532, "load_throughput": 484949.617, "learn_time_ms": 68.433, "learn_throughput": 3770.097, "synch_weights_time_ms": 16.012}, "counters": {"num_env_steps_sampled": 7168, "num_env_steps_trained": 1806, "num_agent_steps_sampled": 21504, "num_agent_steps_trained": 1806, "last_target_update_ts": 7168, "num_target_updates": 7}, "done": false, "episodes_total": 0, "training_iteration": 8, "trial_id": "04288_00000", "date": "2023-11-16_21-56-44", "timestamp": 1700200604, "time_this_iter_s": 1.6281218528747559, "time_total_s": 14.436871528625488, "pid": 46177, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fdea00400d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 14.436871528625488, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 68.85, "ram_util_percent": 89.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.073357582092285, "actor_loss": -4.170724868774414, "critic_loss": 4.723514080047607, "alpha_loss": -0.021152006462216377, "alpha_value": 0.9979023933410645, "log_alpha_value": -0.0020997971296310425, "target_entropy": -6.0, "policy_t": 0.05755317211151123, "mean_q": 0.11401628702878952, "max_q": 0.1327933371067047, "min_q": 0.08723993599414825}, "td_error": [4.574982643127441, 4.8439226150512695, 5.260860443115234, 6.181244850158691, 4.477766036987305, 5.27284049987793, 4.926868438720703, 6.303622722625732, 4.030106544494629, 7.871376991271973, 6.437321662902832, 5.459513187408447, 4.849081516265869, 5.975157737731934, 3.9360172748565674, 5.771358489990234, 4.740095138549805, 4.893491744995117, 5.154021263122559, 5.707216262817383, 6.200982093811035, 6.625709533691406, 7.226480484008789, 6.596719264984131, 6.359724998474121, 4.671562194824219, 5.284450054168701, 6.356162071228027, 4.643641948699951, 4.631781578063965, 4.546306133270264, 5.111530303955078, 7.691585540771484, 5.351632118225098, 5.998698711395264, 4.620685577392578, 4.956881523132324, 5.089604377746582, 7.308889389038086, 4.613456726074219, 5.403942108154297, 5.836829662322998, 5.467978477478027, 6.006186485290527, 6.136487007141113, 5.549202919006348, 4.519593238830566, 5.676738262176514, 7.477861404418945, 5.698327541351318, 6.10854434967041, 4.485945701599121, 6.906976222991943, 6.28023624420166, 5.303926467895508, 5.360142707824707, 5.004405498504639, 5.116874694824219, 5.327396392822266, 4.79811954498291, 6.424619197845459, 6.490259170532227, 6.89449405670166, 7.3727946281433105, 8.995649337768555, 6.442854404449463, 4.0757832527160645, 5.017065048217773, 5.551087856292725, 6.094818115234375, 6.186100006103516, 4.335388660430908, 4.641939163208008, 5.60787296295166, 7.042285919189453, 3.7768490314483643, 5.704867362976074, 5.201578140258789, 6.1809587478637695, 5.186280250549316, 6.8126115798950195, 3.5561704635620117, 4.738203048706055, 6.24639892578125, 5.070699691772461, 4.522147178649902], "mean_td_error": 5.595219135284424, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 8.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.061187744140625, "actor_loss": -4.164756774902344, "critic_loss": 2.572384834289551, "alpha_loss": -0.021135183051228523, "alpha_value": 0.9979015588760376, "log_alpha_value": -0.0021006648894399405, "target_entropy": -6.0, "policy_t": -0.019999416545033455, "mean_q": 0.1398821920156479, "max_q": 0.16998817026615143, "min_q": 0.12342924624681473}, "td_error": [3.094212055206299, 3.789383888244629, 3.0773468017578125, 3.6112759113311768, 1.734736442565918, 1.6647183895111084, 1.2570157051086426, 2.6904120445251465, 6.506549835205078, 1.9458039999008179, 5.7695722579956055, 2.5937252044677734, 2.9652557373046875, 4.577211380004883, 3.7827770709991455, 3.459951877593994, 4.5562591552734375, 2.755910873413086, 3.0343000888824463, 2.058659791946411, 2.852757453918457, 2.1007800102233887, 2.9645888805389404, 3.50679874420166, 4.28070068359375, 3.882798910140991, 2.5892558097839355, 3.5365285873413086, 2.7006795406341553, 5.646490097045898, 3.890367031097412, 3.718106746673584, 3.424517869949341, 4.9601263999938965, 6.411323547363281, 4.366907119750977, 3.8477604389190674, 3.902055263519287, 4.235941410064697, 2.9660263061523438, 3.6989941596984863, 4.484766960144043, 3.6707444190979004, 4.308540344238281, 2.8945422172546387, 3.9759857654571533, 5.417111396789551, 4.633964538574219, 4.719174385070801, 4.566816806793213, 1.7334227561950684, 3.09993314743042, 3.8602242469787598, 3.5312118530273438, 3.120323657989502, 3.0211591720581055, 2.7977638244628906, 5.580021858215332, 3.0434629917144775, 3.057133197784424, 2.453352928161621, 2.368399143218994, 2.9013261795043945, 3.2058358192443848, 3.7708041667938232, 3.4196457862854004, 3.6761412620544434, 4.665393829345703, 0.2195659577846527, 3.407428026199341, 3.2810935974121094, 5.036118507385254, 5.214192867279053, 2.9889235496520996, 2.132784843444824, 3.4209511280059814, 4.355812072753906, 5.776589870452881, 2.4239277839660645, 3.178501844406128, 2.311150550842285, 5.222132205963135, 3.3973801136016846, 1.6888062953948975, 3.253476142883301, 3.671895980834961], "mean_td_error": 3.527517557144165, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 8.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.170772552490234, "actor_loss": -4.264509201049805, "critic_loss": 2.4797966480255127, "alpha_loss": -0.021366894245147705, "alpha_value": 0.9979013800621033, "log_alpha_value": -0.0021008134353905916, "target_entropy": -6.0, "policy_t": -0.026487279683351517, "mean_q": 0.11801290512084961, "max_q": 0.1550513058900833, "min_q": 0.08568041026592255}, "td_error": [2.401141405105591, 3.0813355445861816, 4.036213397979736, 4.0365400314331055, 3.5859079360961914, 2.110445499420166, 2.58221435546875, 4.937197208404541, 3.955264091491699, 3.014800548553467, 3.3084421157836914, 1.4020259380340576, 3.3569841384887695, 3.595822334289551, 5.279873847961426, 3.8423008918762207, 3.9195659160614014, 4.065372467041016, 3.817267894744873, 4.4747114181518555, 3.513446807861328, 3.998910903930664, 5.245170593261719, 4.016714096069336, 4.6452484130859375, 3.044604778289795, 1.855903148651123, 2.84470272064209, 2.754302978515625, 3.7845499515533447, 2.494565725326538, 2.7842230796813965, 2.93629789352417, 2.6304140090942383, 3.798997402191162, 1.955885648727417, 2.616328239440918, 3.723665714263916, 2.885141372680664, 4.667607307434082, 4.659862041473389, 5.622806072235107, 3.2106895446777344, 2.1550662517547607, 3.6965384483337402, 3.9153897762298584, 2.9508185386657715, 4.436882495880127, 2.9384498596191406, 1.5091948509216309, 4.426322937011719, 4.48635196685791, 3.041606903076172, 4.265268325805664, 3.806349039077759, 5.1467156410217285, 3.703037738800049, 2.093205451965332, 3.1754250526428223, 3.9936795234680176, 4.7338666915893555, 2.7798542976379395, 4.625916481018066, 6.269538879394531, 4.38121223449707, 2.9351139068603516, 2.767627239227295, 5.2258148193359375, 4.92201042175293, 3.6750638484954834, 4.292508125305176, 2.8610644340515137, 4.3899641036987305, 4.45445442199707, 3.5831634998321533, 4.100255012512207, 4.307183742523193, 3.737389087677002, 3.276526927947998, 4.149137020111084, 4.447153568267822, 5.378684043884277, 4.4497270584106445, 3.7025482654571533, 4.672641754150391, 3.0575742721557617], "mean_td_error": 3.6908113956451416, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 8.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 8064, "num_env_steps_trained": 2064, "num_agent_steps_sampled": 24192, "num_agent_steps_trained": 2064, "last_target_update_ts": 8064, "num_target_updates": 8}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24192, "num_agent_steps_trained": 2064, "num_env_steps_sampled": 8064, "num_env_steps_trained": 2064, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 554.1643221703101, "num_env_steps_trained_throughput_per_sec": 159.56963741064735, "timesteps_total": 8064, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 24192, "timers": {"training_iteration_time_ms": 1770.96, "sample_time_ms": 1052.847, "load_time_ms": 0.537, "load_throughput": 480226.519, "learn_time_ms": 67.747, "learn_throughput": 3808.273, "synch_weights_time_ms": 16.085}, "counters": {"num_env_steps_sampled": 8064, "num_env_steps_trained": 2064, "num_agent_steps_sampled": 24192, "num_agent_steps_trained": 2064, "last_target_update_ts": 8064, "num_target_updates": 8}, "done": false, "episodes_total": 0, "training_iteration": 9, "trial_id": "04288_00000", "date": "2023-11-16_21-56-45", "timestamp": 1700200605, "time_this_iter_s": 1.631314754486084, "time_total_s": 16.068186283111572, "pid": 46177, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fdec895e040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 16.068186283111572, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 53.56666666666667, "ram_util_percent": 89.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.058156967163086, "actor_loss": -4.173357009887695, "critic_loss": 4.69959831237793, "alpha_loss": -0.02413758635520935, "alpha_value": 0.9976030588150024, "log_alpha_value": -0.0023998019751161337, "target_entropy": -6.0, "policy_t": -0.013279526494443417, "mean_q": 0.13537894189357758, "max_q": 0.16669440269470215, "min_q": 0.10802418738603592}, "td_error": [5.621130466461182, 4.771764755249023, 5.659128189086914, 2.9511818885803223, 4.720890998840332, 6.507442474365234, 6.552237510681152, 5.526427268981934, 6.206079483032227, 5.292734146118164, 6.068108558654785, 6.588594436645508, 5.214776039123535, 5.670890808105469, 6.606876850128174, 7.376581192016602, 5.720123291015625, 3.384505033493042, 5.0608320236206055, 5.974169731140137, 6.18766975402832, 6.080421447753906, 5.531450271606445, 4.288556098937988, 5.002194881439209, 3.535050392150879, 6.055355072021484, 7.427427291870117, 4.176939964294434, 5.955159664154053, 6.632346153259277, 3.891268014907837, 5.577527046203613, 4.61441707611084, 5.087130546569824, 2.9200212955474854, 4.507414817810059, 6.647078514099121, 5.139725208282471, 4.936511039733887, 5.214266777038574, 4.748344421386719, 6.215021133422852, 4.547857761383057, 6.175972938537598, 6.916165351867676, 4.363866806030273, 8.003835678100586, 5.315368175506592, 5.890490531921387, 4.2304368019104, 6.639826774597168, 4.7408599853515625, 5.4532623291015625, 8.243453979492188, 6.306807518005371, 4.505895614624023, 4.577305316925049, 4.474026679992676, 4.504179954528809, 5.338627815246582, 6.854607105255127, 3.262686252593994, 5.451115131378174, 5.214532375335693, 5.9809980392456055, 7.203061103820801, 5.350175857543945, 3.566380500793457, 7.5303053855896, 5.034295082092285, 4.090107440948486, 4.730774879455566, 4.276065349578857, 6.4261794090271, 4.202315330505371, 7.017961502075195, 7.536864280700684, 4.6565656661987305, 5.110008239746094, 5.765549659729004, 5.995631217956543, 6.602088928222656, 6.086684703826904, 5.602898597717285, 6.345773696899414], "mean_td_error": 5.4879961013793945, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 9.0, "diff_num_grad_updates_vs_sampler_policy": 8.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.09631061553955, "actor_loss": -4.222047805786133, "critic_loss": 2.099759817123413, "alpha_loss": -0.024239884689450264, "alpha_value": 0.9976019859313965, "log_alpha_value": -0.002400865312665701, "target_entropy": -6.0, "policy_t": -0.010047992691397667, "mean_q": 0.16456039249897003, "max_q": 0.1965518742799759, "min_q": 0.14395710825920105}, "td_error": [3.888151168823242, 4.4065728187561035, 3.8274354934692383, 3.8511478900909424, 3.75174617767334, 2.252192497253418, 3.9001998901367188, 4.029455184936523, 3.396115303039551, 4.206683158874512, 2.8122525215148926, 3.9441304206848145, 4.363569259643555, 3.4810142517089844, 3.18936824798584, 3.78537654876709, 3.5484604835510254, 4.485787391662598, 4.657201290130615, 3.5425329208374023, 2.07281231880188, 3.7519679069519043, 2.531852960586548, 3.7745747566223145, 2.859140396118164, 2.0371551513671875, 2.7567052841186523, 4.270658493041992, 3.1843628883361816, 5.393633842468262, 4.102024078369141, 3.402019739151001, 3.8642849922180176, 2.660336971282959, 4.03251838684082, 5.348316192626953, 4.4798455238342285, 4.482455730438232, 2.86818528175354, 2.467155933380127, 2.8166913986206055, 3.5926897525787354, 4.146694660186768, 3.44000244140625, 4.357174396514893, 3.1294450759887695, 3.991560459136963, 3.2062363624572754, 3.660863161087036, 2.1862921714782715, 3.4464187622070312, 2.3185935020446777, 4.295586585998535, 5.45927619934082, 2.7982850074768066, 4.573483467102051, 4.86979866027832, 5.104114532470703, 3.201200008392334, 3.858138084411621, 3.2856085300445557, 3.3942484855651855, 2.2072911262512207, 3.857572078704834, 4.118132591247559, 6.542301177978516, 1.6953644752502441, 2.869999885559082, 2.3305318355560303, 2.549361228942871, 2.7933294773101807, 3.407606840133667, 3.2047667503356934, 2.4652414321899414, 3.593836784362793, 1.514736294746399, 3.414109706878662, 4.127128601074219, 3.8723411560058594, 3.9668121337890625, 3.713369607925415, 5.6558122634887695, 3.647655963897705, 4.3721513748168945, 3.9654455184936523, 3.759798526763916], "mean_td_error": 3.6097261905670166, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 9.0, "diff_num_grad_updates_vs_sampler_policy": 8.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.111438751220703, "actor_loss": -4.2187180519104, "critic_loss": 2.2493834495544434, "alpha_loss": -0.02427971549332142, "alpha_value": 0.9976016879081726, "log_alpha_value": -0.002401212463155389, "target_entropy": -6.0, "policy_t": 0.018642758950591087, "mean_q": 0.13626347482204437, "max_q": 0.17485935986042023, "min_q": 0.10339011996984482}, "td_error": [5.460940837860107, 4.6356730461120605, 4.486376762390137, 3.6649322509765625, 5.607094764709473, 4.117007255554199, 1.3685948848724365, 4.066250801086426, 3.3043150901794434, 2.795661211013794, 2.026700496673584, 4.445356369018555, 4.055119514465332, 3.2696616649627686, 1.8503414392471313, 4.183864116668701, 4.014302730560303, 2.831645965576172, 2.37557315826416, 3.005368709564209, 3.693648338317871, 3.684331178665161, 3.070168972015381, 3.223504066467285, 2.3668437004089355, 2.5258607864379883, 3.3484373092651367, 4.1405792236328125, 1.6571868658065796, 3.742647886276245, 3.3772497177124023, 5.153350830078125, 3.5922670364379883, 4.675715446472168, 4.402340888977051, 3.8044538497924805, 3.0796947479248047, 3.246399164199829, 3.263089895248413, 3.576399326324463, 5.670620918273926, 2.96475887298584, 2.3042361736297607, 3.381171703338623, 3.473738670349121, 4.646085262298584, 5.091193199157715, 3.4778411388397217, 4.582963943481445, 3.4512805938720703, 3.2534823417663574, 3.2397642135620117, 3.936784267425537, 0.5206344127655029, 5.102776527404785, 4.590851783752441, 3.645848274230957, 3.7937874794006348, 4.983617782592773, 3.0537078380584717, 2.725045680999756, 3.8764705657958984, 4.252135276794434, 2.631016969680786, 2.2755115032196045, 2.5981383323669434, 2.4948482513427734, 2.796321392059326, 3.1343677043914795, 2.942387819290161, 2.8284988403320312, 1.7794227600097656, 3.3351473808288574, 1.558367371559143, 2.154311180114746, 4.374827861785889, 3.834658145904541, 3.2433342933654785, 2.8198938369750977, 4.669383525848389, 3.0887539386749268, 2.1949682235717773, 3.9880685806274414, 3.278794288635254, 3.164921283721924, 5.218109130859375], "mean_td_error": 3.460602045059204, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 9.0, "diff_num_grad_updates_vs_sampler_policy": 8.0}}, "num_env_steps_sampled": 8960, "num_env_steps_trained": 2322, "num_agent_steps_sampled": 26880, "num_agent_steps_trained": 2322, "last_target_update_ts": 8960, "num_target_updates": 9}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 26880, "num_agent_steps_trained": 2322, "num_env_steps_sampled": 8960, "num_env_steps_trained": 2322, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 547.9891419859154, "num_env_steps_trained_throughput_per_sec": 157.7915163307658, "timesteps_total": 8960, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 26880, "timers": {"training_iteration_time_ms": 1757.365, "sample_time_ms": 1053.3, "load_time_ms": 0.535, "load_throughput": 482662.994, "learn_time_ms": 67.314, "learn_throughput": 3832.79, "synch_weights_time_ms": 15.886}, "counters": {"num_env_steps_sampled": 8960, "num_env_steps_trained": 2322, "num_agent_steps_sampled": 26880, "num_agent_steps_trained": 2322, "last_target_update_ts": 8960, "num_target_updates": 9}, "done": false, "episodes_total": 0, "training_iteration": 10, "trial_id": "04288_00000", "date": "2023-11-16_21-56-47", "timestamp": 1700200607, "time_this_iter_s": 1.6513350009918213, "time_total_s": 17.719521284103394, "pid": 46177, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fdea0040940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 17.719521284103394, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 72.6, "ram_util_percent": 89.75}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.108365058898926, "actor_loss": -4.243402004241943, "critic_loss": 5.229299068450928, "alpha_loss": -0.02729077637195587, "alpha_value": 0.99730384349823, "log_alpha_value": -0.0026998212561011314, "target_entropy": -6.0, "policy_t": -0.030225632712244987, "mean_q": 0.15815845131874084, "max_q": 0.20365938544273376, "min_q": 0.13092362880706787}, "td_error": [6.709589958190918, 5.849270820617676, 5.18160343170166, 5.224432468414307, 4.869980335235596, 5.887351989746094, 7.104552268981934, 5.493507385253906, 6.385546684265137, 3.7431249618530273, 6.17612361907959, 6.472485542297363, 4.892068862915039, 5.689332008361816, 6.183938980102539, 5.345427989959717, 6.718932151794434, 6.166441917419434, 7.032384872436523, 6.37495231628418, 5.865573406219482, 5.916468620300293, 5.0021138191223145, 4.385942459106445, 5.762853622436523, 5.245217323303223, 6.111197471618652, 6.008951187133789, 4.733534812927246, 6.993517875671387, 5.498071670532227, 6.55528450012207, 8.261833190917969, 7.058971405029297, 6.928154468536377, 5.789248466491699, 5.337434768676758, 6.005998611450195, 5.138202667236328, 5.587429046630859, 5.432941436767578, 6.3707275390625, 4.626032829284668, 6.437344551086426, 4.31475830078125, 3.9689579010009766, 4.658999443054199, 5.163590908050537, 6.241385459899902, 5.925683975219727, 6.540409088134766, 4.606971263885498, 6.8830437660217285, 7.641239166259766, 5.586639404296875, 6.677104949951172, 4.936688423156738, 5.825733661651611, 6.717616081237793, 5.81498908996582, 5.3033576011657715, 6.933467864990234, 6.116634368896484, 4.280027389526367, 6.785369873046875, 8.359197616577148, 4.6887102127075195, 6.8834052085876465, 4.713996887207031, 4.288751602172852, 5.671840667724609, 5.182600498199463, 4.298914909362793, 4.336695194244385, 6.740426063537598, 5.736159324645996, 6.671160697937012, 9.05561637878418, 6.465559005737305, 5.849095344543457, 5.741996765136719, 6.437985420227051, 5.49599552154541, 6.335074424743652, 5.022505760192871, 6.266185760498047], "mean_td_error": 5.857193470001221, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 10.0, "diff_num_grad_updates_vs_sampler_policy": 9.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.14122200012207, "actor_loss": -4.287732124328613, "critic_loss": 2.08170747756958, "alpha_loss": -0.02739236317574978, "alpha_value": 0.9973025321960449, "log_alpha_value": -0.002701090881600976, "target_entropy": -6.0, "policy_t": 0.0001689648488536477, "mean_q": 0.1933727264404297, "max_q": 0.22025105357170105, "min_q": 0.16476090252399445}, "td_error": [2.448169231414795, 3.805046558380127, 3.0558395385742188, 2.7158470153808594, 2.7375712394714355, 3.5367002487182617, 3.956347942352295, 4.07511568069458, 5.9028167724609375, 3.150472640991211, 3.419612407684326, 3.4417903423309326, 2.1960697174072266, 1.636026382446289, 4.18596887588501, 1.6575546264648438, 4.853099822998047, 3.73964786529541, 5.211719036102295, 3.211247682571411, 2.9465479850769043, 3.648796558380127, 3.4332311153411865, 4.560022354125977, 3.8677282333374023, 3.5101852416992188, 4.034136772155762, 2.533871650695801, 4.374642372131348, 2.4216432571411133, 4.36785888671875, 4.180655002593994, 3.045579433441162, 5.2391815185546875, 4.702739715576172, 4.316041946411133, 3.8291454315185547, 5.070906639099121, 3.2962417602539062, 3.142136573791504, 3.0756173133850098, 2.325894355773926, 4.264268398284912, 2.9695849418640137, 3.281630039215088, 3.8260645866394043, 2.2476353645324707, 4.328897476196289, 3.9138660430908203, 3.8490920066833496, 4.017194747924805, 1.4812525510787964, 4.764296531677246, 2.7110066413879395, 2.886826992034912, 5.728168487548828, 2.8370957374572754, 3.161630392074585, 3.8786354064941406, 3.3145406246185303, 4.238431930541992, 3.5012238025665283, 5.547532081604004, 4.861242294311523, 2.3552374839782715, 4.234210968017578, 3.7034554481506348, 3.687101364135742, 3.2307395935058594, 3.545006275177002, 4.230411529541016, 4.180434703826904, 3.4058327674865723, 5.386527061462402, 3.0181679725646973, 3.8121814727783203, 2.013112783432007, 4.611317157745361, 3.0541653633117676, 2.104593515396118, 3.674625873565674, 3.2417569160461426, 3.8915247917175293, 3.4832816123962402, 1.9248147010803223, 5.908463478088379], "mean_td_error": 3.618215560913086, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 10.0, "diff_num_grad_updates_vs_sampler_policy": 9.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.044238090515137, "actor_loss": -4.173102378845215, "critic_loss": 2.2870140075683594, "alpha_loss": -0.027135759592056274, "alpha_value": 0.9973019957542419, "log_alpha_value": -0.0027016247622668743, "target_entropy": -6.0, "policy_t": 0.029201485216617584, "mean_q": 0.1608409285545349, "max_q": 0.21211457252502441, "min_q": 0.12475597113370895}, "td_error": [4.588474750518799, 1.982574701309204, 4.832829475402832, 3.0735039710998535, 4.030084609985352, 2.503523349761963, 2.43312668800354, 4.651703834533691, 5.0479631423950195, 3.471461296081543, 2.709104061126709, 3.998875379562378, 4.0080413818359375, 4.82505989074707, 1.8261239528656006, 4.048098564147949, 2.9264512062072754, 2.2959132194519043, 2.501005172729492, 3.750756025314331, 3.510765552520752, 3.008021354675293, 3.5893819332122803, 3.1391420364379883, 4.134662628173828, 4.619086265563965, 3.8886077404022217, 3.6569855213165283, 4.3962225914001465, 4.862643241882324, 2.603675603866577, 3.125417709350586, 3.5707783699035645, 4.345463275909424, 2.017324447631836, 4.433426856994629, 2.3170785903930664, 3.302818775177002, 3.1607155799865723, 2.8907887935638428, 2.6046838760375977, 3.4157156944274902, 5.297336578369141, 3.2970523834228516, 3.985548496246338, 4.5965576171875, 2.305875301361084, 0.9061573147773743, 2.725191116333008, 4.3094282150268555, 4.64040994644165, 3.5664100646972656, 4.552889823913574, 3.9069130420684814, 3.934591770172119, 1.7446739673614502, 3.6679396629333496, 3.9146363735198975, 5.3309502601623535, 4.756258964538574, 2.532846450805664, 4.134410858154297, 2.1051292419433594, 3.2167820930480957, 2.7257556915283203, 3.855301856994629, 3.1922826766967773, 4.420942783355713, 4.501821517944336, 4.423304557800293, 4.001533508300781, 5.286026477813721, 2.0491247177124023, 2.1207966804504395, 3.267557382583618, 3.105429172515869, 3.3237645626068115, 1.8406462669372559, 4.363600254058838, 2.637537717819214, 2.4271507263183594, 2.5857889652252197, 3.6937990188598633, 3.868800640106201, 4.017109394073486, 3.6741790771484375], "mean_td_error": 3.498934030532837, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 10.0, "diff_num_grad_updates_vs_sampler_policy": 9.0}}, "num_env_steps_sampled": 9856, "num_env_steps_trained": 2580, "num_agent_steps_sampled": 29568, "num_agent_steps_trained": 2580, "last_target_update_ts": 9856, "num_target_updates": 10}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 29568, "num_agent_steps_trained": 2580, "num_env_steps_sampled": 9856, "num_env_steps_trained": 2580, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 548.8356066296122, "num_env_steps_trained_throughput_per_sec": 158.0352528018303, "timesteps_total": 9856, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 29568, "timers": {"training_iteration_time_ms": 1655.564, "sample_time_ms": 1044.662, "load_time_ms": 0.538, "load_throughput": 479837.9, "learn_time_ms": 66.86, "learn_throughput": 3858.794, "synch_weights_time_ms": 15.767}, "counters": {"num_env_steps_sampled": 9856, "num_env_steps_trained": 2580, "num_agent_steps_sampled": 29568, "num_agent_steps_trained": 2580, "last_target_update_ts": 9856, "num_target_updates": 10}, "done": false, "episodes_total": 0, "training_iteration": 11, "trial_id": "04288_00000", "date": "2023-11-16_21-56-49", "timestamp": 1700200609, "time_this_iter_s": 1.6482198238372803, "time_total_s": 19.367741107940674, "pid": 46177, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fdec895e040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 19.367741107940674, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 67.35, "ram_util_percent": 89.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.065908432006836, "actor_loss": -4.219863414764404, "critic_loss": 4.860943794250488, "alpha_loss": -0.03019702434539795, "alpha_value": 0.9970045685768127, "log_alpha_value": -0.0029999304097145796, "target_entropy": -6.0, "policy_t": -0.014489429071545601, "mean_q": 0.17943519353866577, "max_q": 0.2224787026643753, "min_q": 0.14477451145648956}, "td_error": [5.357501029968262, 3.9585118293762207, 4.147604942321777, 6.773708343505859, 5.5573906898498535, 6.013731002807617, 4.490225791931152, 5.439626693725586, 6.106488227844238, 5.944209575653076, 5.984319686889648, 5.8488054275512695, 5.514047622680664, 5.096264839172363, 6.4211015701293945, 5.3286566734313965, 6.703143119812012, 4.605588436126709, 3.659491539001465, 5.689014434814453, 5.830038070678711, 5.483936786651611, 6.08641242980957, 3.7296266555786133, 5.279703140258789, 5.46443510055542, 4.513504981994629, 4.659480571746826, 4.340213775634766, 4.333666801452637, 6.580868721008301, 5.044122695922852, 6.707993030548096, 6.741548538208008, 6.1402482986450195, 6.1033735275268555, 4.855547904968262, 5.499799728393555, 6.208727836608887, 6.046809196472168, 4.953657627105713, 2.813386917114258, 5.608003616333008, 3.237577438354492, 6.259976863861084, 6.504386901855469, 5.1107354164123535, 7.417723655700684, 5.177728652954102, 5.656582832336426, 6.52131462097168, 6.741584777832031, 3.8653769493103027, 7.00146484375, 6.508740425109863, 7.060996055603027, 6.0956807136535645, 5.393167495727539, 5.592419624328613, 5.30014705657959, 4.943370819091797, 4.411911964416504, 4.44297981262207, 6.3859357833862305, 7.101716995239258, 7.241076946258545, 4.672111988067627, 4.3770976066589355, 5.830408096313477, 6.305406093597412, 8.465763092041016, 8.00079345703125, 4.785087585449219, 5.587315559387207, 5.569425582885742, 7.396583557128906, 5.0066914558410645, 3.9176673889160156, 5.274684906005859, 6.215760231018066, 6.313748359680176, 7.577132225036621, 6.985586643218994, 6.554563522338867, 5.995744705200195, 5.807398796081543], "mean_td_error": 5.6543731689453125, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 11.0, "diff_num_grad_updates_vs_sampler_policy": 10.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.04373550415039, "actor_loss": -4.215561866760254, "critic_loss": 2.017378330230713, "alpha_loss": -0.03014531545341015, "alpha_value": 0.9970030784606934, "log_alpha_value": -0.0030014049261808395, "target_entropy": -6.0, "policy_t": 0.00734034413471818, "mean_q": 0.22750796377658844, "max_q": 0.2715422213077545, "min_q": 0.19681121408939362}, "td_error": [3.482971668243408, 4.532510280609131, 4.591500282287598, 2.9598350524902344, 2.2129197120666504, 3.8259057998657227, 5.559300899505615, 3.96062970161438, 2.9004805088043213, 2.099978446960449, 3.6138012409210205, 3.0987114906311035, 2.513223171234131, 2.5789356231689453, 2.3438897132873535, 5.317706108093262, 2.6464853286743164, 4.566911697387695, 2.4969921112060547, 2.201080799102783, 3.824803590774536, 4.645635604858398, 3.610663890838623, 3.088336944580078, 3.1624879837036133, 3.593397617340088, 4.670427322387695, 3.5954341888427734, 5.235513687133789, 3.071648120880127, 4.633537292480469, 3.4174647331237793, 3.896050453186035, 3.3688597679138184, 3.5202560424804688, 3.8285746574401855, 2.556617259979248, 4.491079330444336, 5.41110897064209, 2.49472713470459, 2.4452290534973145, 4.5308966636657715, 3.4911608695983887, 2.5887856483459473, 2.9271254539489746, 4.139411926269531, 5.971648216247559, 3.2568960189819336, 2.609346389770508, 4.158597946166992, 3.614985942840576, 6.106473922729492, 4.0253496170043945, 3.4024391174316406, 3.618227481842041, 3.598139762878418, 4.068648815155029, 2.2160868644714355, 4.727405548095703, 2.2839512825012207, 5.074885368347168, 0.9276763200759888, 2.6630706787109375, 2.867382049560547, 2.120283365249634, 3.4823102951049805, 3.297463893890381, 3.868394374847412, 3.230396270751953, 3.2284626960754395, 6.000226974487305, 2.7795841693878174, 2.9352974891662598, 3.9894869327545166, 3.3611254692077637, 3.0288472175598145, 3.527705430984497, 4.183507919311523, 2.133155345916748, 4.064511775970459, 1.9097130298614502, 4.28852653503418, 4.118314743041992, 2.3674633502960205, 4.306467056274414, 3.7467164993286133], "mean_td_error": 3.5453739166259766, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 11.0, "diff_num_grad_updates_vs_sampler_policy": 10.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.083791732788086, "actor_loss": -4.227895259857178, "critic_loss": 2.320234775543213, "alpha_loss": -0.030270932242274284, "alpha_value": 0.9970025420188904, "log_alpha_value": -0.003001939505338669, "target_entropy": -6.0, "policy_t": 0.022454991936683655, "mean_q": 0.18221515417099, "max_q": 0.24989591538906097, "min_q": 0.1435936689376831}, "td_error": [4.091261863708496, 3.9051122665405273, 4.756048679351807, 4.161549091339111, 3.7474374771118164, 3.623988389968872, 3.9382410049438477, 5.2682366371154785, 4.863386631011963, 3.660478115081787, 2.022148370742798, 4.572268486022949, 3.31333589553833, 3.9671130180358887, 3.7683863639831543, 2.5188121795654297, 4.831770896911621, 4.220091819763184, 2.581400156021118, 3.6517927646636963, 4.639336585998535, 1.9339772462844849, 1.5746078491210938, 4.123549461364746, 2.7917418479919434, 6.011739253997803, 2.5494227409362793, 2.849740982055664, 2.456585168838501, 3.505101442337036, 3.532611608505249, 3.588768482208252, 3.7433066368103027, 2.10583233833313, 4.931079864501953, 3.5021824836730957, 1.4937739372253418, 3.567208766937256, 4.159640312194824, 2.8450634479522705, 3.643418073654175, 5.544548034667969, 3.752025842666626, 3.6828341484069824, 4.436129093170166, 2.5895001888275146, 3.105961322784424, 3.2721853256225586, 5.273381233215332, 2.7225570678710938, 4.934255123138428, 5.144903182983398, 3.3236989974975586, 2.163362741470337, 5.286664962768555, 1.7817425727844238, 4.703582286834717, 4.91156005859375, 4.361989974975586, 2.799363613128662, 3.12691593170166, 2.967862367630005, 3.4256985187530518, 2.3299639225006104, 4.126751899719238, 4.714373588562012, 4.139954566955566, 3.674990653991699, 4.301602363586426, 3.8451790809631348, 4.145339012145996, 2.8651413917541504, 2.786581039428711, 4.65846061706543, 3.6142420768737793, 3.4006664752960205, 2.9644601345062256, 4.752772331237793, 1.9987215995788574, 3.193601369857788, 3.5709598064422607, 2.7048304080963135, 2.4181952476501465, 3.7479429244995117, 4.025250434875488, 2.871753692626953], "mean_td_error": 3.618302345275879, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 11.0, "diff_num_grad_updates_vs_sampler_policy": 10.0}}, "num_env_steps_sampled": 10752, "num_env_steps_trained": 2838, "num_agent_steps_sampled": 32256, "num_agent_steps_trained": 2838, "last_target_update_ts": 10752, "num_target_updates": 11}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32256, "num_agent_steps_trained": 2838, "num_env_steps_sampled": 10752, "num_env_steps_trained": 2838, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 491.62324311009263, "num_env_steps_trained_throughput_per_sec": 141.56115705625436, "timesteps_total": 10752, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 32256, "timers": {"training_iteration_time_ms": 1658.641, "sample_time_ms": 1046.222, "load_time_ms": 0.537, "load_throughput": 480840.005, "learn_time_ms": 64.232, "learn_throughput": 4016.659, "synch_weights_time_ms": 15.014}, "counters": {"num_env_steps_sampled": 10752, "num_env_steps_trained": 2838, "num_agent_steps_sampled": 32256, "num_agent_steps_trained": 2838, "last_target_update_ts": 10752, "num_target_updates": 11}, "done": false, "episodes_total": 0, "training_iteration": 12, "trial_id": "04288_00000", "date": "2023-11-16_21-56-51", "timestamp": 1700200611, "time_this_iter_s": 1.843329906463623, "time_total_s": 21.211071014404297, "pid": 46177, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7fdec895e940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 21.211071014404297, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 56.133333333333326, "ram_util_percent": 89.73333333333333}}
